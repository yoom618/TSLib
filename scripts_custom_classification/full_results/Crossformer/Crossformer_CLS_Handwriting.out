Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.929079294204712
Epoch: 1, Steps: 10 | Train Loss: 3.416 Vali Loss: 3.350 Vali Acc: 0.046 Test Loss: 3.350 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 1.8855535984039307
Epoch: 2, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.436 Vali Acc: 0.056 Test Loss: 3.436 Test Acc: 0.056
Validation loss decreased (-0.045849 --> -0.056436).  Saving model ...
Epoch: 3 cost time: 1.665447473526001
Epoch: 3, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.305 Vali Acc: 0.091 Test Loss: 3.305 Test Acc: 0.091
Validation loss decreased (-0.056436 --> -0.090555).  Saving model ...
Epoch: 4 cost time: 1.9113821983337402
Epoch: 4, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.296 Vali Acc: 0.078 Test Loss: 3.296 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5278568267822266
Epoch: 5, Steps: 10 | Train Loss: 2.727 Vali Loss: 3.296 Vali Acc: 0.105 Test Loss: 3.296 Test Acc: 0.105
Validation loss decreased (-0.090555 --> -0.104673).  Saving model ...
Epoch: 6 cost time: 1.6639187335968018
Epoch: 6, Steps: 10 | Train Loss: 2.435 Vali Loss: 3.256 Vali Acc: 0.127 Test Loss: 3.256 Test Acc: 0.127
Validation loss decreased (-0.104673 --> -0.127026).  Saving model ...
Epoch: 7 cost time: 1.6450796127319336
Epoch: 7, Steps: 10 | Train Loss: 2.132 Vali Loss: 3.291 Vali Acc: 0.153 Test Loss: 3.291 Test Acc: 0.153
Validation loss decreased (-0.127026 --> -0.152908).  Saving model ...
Epoch: 8 cost time: 1.774601936340332
Epoch: 8, Steps: 10 | Train Loss: 1.913 Vali Loss: 3.283 Vali Acc: 0.161 Test Loss: 3.283 Test Acc: 0.161
Validation loss decreased (-0.152908 --> -0.161144).  Saving model ...
Epoch: 9 cost time: 1.7647743225097656
Epoch: 9, Steps: 10 | Train Loss: 1.588 Vali Loss: 3.255 Vali Acc: 0.168 Test Loss: 3.255 Test Acc: 0.168
Validation loss decreased (-0.161144 --> -0.168203).  Saving model ...
Epoch: 10 cost time: 1.4092609882354736
Epoch: 10, Steps: 10 | Train Loss: 1.289 Vali Loss: 3.280 Vali Acc: 0.171 Test Loss: 3.280 Test Acc: 0.171
Validation loss decreased (-0.168203 --> -0.170555).  Saving model ...
Epoch: 11 cost time: 1.7217838764190674
Epoch: 11, Steps: 10 | Train Loss: 1.047 Vali Loss: 3.252 Vali Acc: 0.205 Test Loss: 3.252 Test Acc: 0.205
Validation loss decreased (-0.170555 --> -0.204673).  Saving model ...
Epoch: 12 cost time: 1.6266288757324219
Epoch: 12, Steps: 10 | Train Loss: 0.746 Vali Loss: 3.439 Vali Acc: 0.199 Test Loss: 3.439 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6496853828430176
Epoch: 13, Steps: 10 | Train Loss: 0.654 Vali Loss: 3.325 Vali Acc: 0.221 Test Loss: 3.325 Test Acc: 0.221
Validation loss decreased (-0.204673 --> -0.221143).  Saving model ...
Epoch: 14 cost time: 1.6334874629974365
Epoch: 14, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.486 Vali Acc: 0.208 Test Loss: 3.486 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8001763820648193
Epoch: 15, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.697 Vali Acc: 0.202 Test Loss: 3.697 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7803740501403809
Epoch: 16, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.624 Vali Acc: 0.221 Test Loss: 3.624 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5365698337554932
Epoch: 17, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.762 Vali Acc: 0.238 Test Loss: 3.762 Test Acc: 0.238
Validation loss decreased (-0.221143 --> -0.237609).  Saving model ...
Epoch: 18 cost time: 1.939286470413208
Epoch: 18, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.889 Vali Acc: 0.221 Test Loss: 3.889 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5408036708831787
Epoch: 19, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.067 Vali Acc: 0.220 Test Loss: 4.067 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2658495903015137
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.982 Vali Acc: 0.224 Test Loss: 3.982 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6941099166870117
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.047 Vali Acc: 0.242 Test Loss: 4.047 Test Acc: 0.242
Validation loss decreased (-0.237609 --> -0.242312).  Saving model ...
Epoch: 22 cost time: 2.1381003856658936
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.088 Vali Acc: 0.260 Test Loss: 4.088 Test Acc: 0.260
Validation loss decreased (-0.242312 --> -0.259959).  Saving model ...
Epoch: 23 cost time: 1.8663427829742432
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.097 Vali Acc: 0.265 Test Loss: 4.097 Test Acc: 0.265
Validation loss decreased (-0.259959 --> -0.264665).  Saving model ...
Epoch: 24 cost time: 1.7645413875579834
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.126 Vali Acc: 0.262 Test Loss: 4.126 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9196150302886963
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.131 Vali Acc: 0.264 Test Loss: 4.131 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6622560024261475
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.160 Vali Acc: 0.260 Test Loss: 4.160 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9401164054870605
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.162 Vali Acc: 0.255 Test Loss: 4.162 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7901055812835693
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.162 Vali Acc: 0.258 Test Loss: 4.162 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.091463327407837
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.173 Vali Acc: 0.258 Test Loss: 4.173 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6215541362762451
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.184 Vali Acc: 0.261 Test Loss: 4.184 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.772789716720581
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.189 Vali Acc: 0.261 Test Loss: 4.189 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.0100672245025635
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.198 Vali Acc: 0.259 Test Loss: 4.198 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6221504211425781
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.217 Vali Acc: 0.264 Test Loss: 4.217 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 14327894
model size : 59.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.9651007652282715
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.345 Vali Acc: 0.045 Test Loss: 3.345 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 1.7018911838531494
Epoch: 2, Steps: 10 | Train Loss: 3.260 Vali Loss: 3.384 Vali Acc: 0.069 Test Loss: 3.384 Test Acc: 0.069
Validation loss decreased (-0.044672 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 1.7306127548217773
Epoch: 3, Steps: 10 | Train Loss: 3.138 Vali Loss: 3.335 Vali Acc: 0.093 Test Loss: 3.335 Test Acc: 0.093
Validation loss decreased (-0.069378 --> -0.092908).  Saving model ...
Epoch: 4 cost time: 1.6245074272155762
Epoch: 4, Steps: 10 | Train Loss: 2.987 Vali Loss: 3.315 Vali Acc: 0.088 Test Loss: 3.315 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6501173973083496
Epoch: 5, Steps: 10 | Train Loss: 2.736 Vali Loss: 3.221 Vali Acc: 0.136 Test Loss: 3.221 Test Acc: 0.136
Validation loss decreased (-0.092908 --> -0.136438).  Saving model ...
Epoch: 6 cost time: 1.7021629810333252
Epoch: 6, Steps: 10 | Train Loss: 2.421 Vali Loss: 3.280 Vali Acc: 0.127 Test Loss: 3.280 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5327293872833252
Epoch: 7, Steps: 10 | Train Loss: 2.150 Vali Loss: 3.308 Vali Acc: 0.135 Test Loss: 3.308 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5552144050598145
Epoch: 8, Steps: 10 | Train Loss: 1.837 Vali Loss: 3.212 Vali Acc: 0.172 Test Loss: 3.212 Test Acc: 0.172
Validation loss decreased (-0.136438 --> -0.171733).  Saving model ...
Epoch: 9 cost time: 1.7235276699066162
Epoch: 9, Steps: 10 | Train Loss: 1.499 Vali Loss: 3.310 Vali Acc: 0.138 Test Loss: 3.310 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4941318035125732
Epoch: 10, Steps: 10 | Train Loss: 1.248 Vali Loss: 3.267 Vali Acc: 0.214 Test Loss: 3.267 Test Acc: 0.214
Validation loss decreased (-0.171733 --> -0.214085).  Saving model ...
Epoch: 11 cost time: 1.7325587272644043
Epoch: 11, Steps: 10 | Train Loss: 0.961 Vali Loss: 3.309 Vali Acc: 0.185 Test Loss: 3.309 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.482370138168335
Epoch: 12, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.402 Vali Acc: 0.206 Test Loss: 3.402 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.812878131866455
Epoch: 13, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.844 Vali Acc: 0.156 Test Loss: 3.844 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7436175346374512
Epoch: 14, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.574 Vali Acc: 0.189 Test Loss: 3.574 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.567223072052002
Epoch: 15, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.506 Vali Acc: 0.234 Test Loss: 3.506 Test Acc: 0.234
Validation loss decreased (-0.214085 --> -0.234083).  Saving model ...
Epoch: 16 cost time: 1.6125895977020264
Epoch: 16, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.629 Vali Acc: 0.232 Test Loss: 3.629 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5003716945648193
Epoch: 17, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.859 Vali Acc: 0.205 Test Loss: 3.859 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.469757318496704
Epoch: 18, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.838 Vali Acc: 0.227 Test Loss: 3.838 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6604981422424316
Epoch: 19, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.912 Vali Acc: 0.259 Test Loss: 3.912 Test Acc: 0.259
Validation loss decreased (-0.234083 --> -0.258784).  Saving model ...
Epoch: 20 cost time: 1.3982043266296387
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.045 Vali Acc: 0.233 Test Loss: 4.045 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.822474718093872
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.918 Vali Acc: 0.256 Test Loss: 3.918 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5909476280212402
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.972 Vali Acc: 0.261 Test Loss: 3.972 Test Acc: 0.261
Validation loss decreased (-0.258784 --> -0.261137).  Saving model ...
Epoch: 23 cost time: 1.7458317279815674
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.983 Vali Acc: 0.266 Test Loss: 3.983 Test Acc: 0.266
Validation loss decreased (-0.261137 --> -0.265843).  Saving model ...
Epoch: 24 cost time: 1.6476635932922363
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.970 Vali Acc: 0.276 Test Loss: 3.970 Test Acc: 0.276
Validation loss decreased (-0.265843 --> -0.276431).  Saving model ...
Epoch: 25 cost time: 1.8022310733795166
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.985 Vali Acc: 0.273 Test Loss: 3.985 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.652282476425171
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.052 Vali Acc: 0.274 Test Loss: 4.052 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0897645950317383
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.080 Vali Acc: 0.279 Test Loss: 4.080 Test Acc: 0.279
Validation loss decreased (-0.276431 --> -0.278783).  Saving model ...
Epoch: 28 cost time: 1.7300171852111816
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.069 Vali Acc: 0.281 Test Loss: 4.069 Test Acc: 0.281
Validation loss decreased (-0.278783 --> -0.281136).  Saving model ...
Epoch: 29 cost time: 1.5450031757354736
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.072 Vali Acc: 0.286 Test Loss: 4.072 Test Acc: 0.286
Validation loss decreased (-0.281136 --> -0.285842).  Saving model ...
Epoch: 30 cost time: 1.6164958477020264
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.078 Vali Acc: 0.285 Test Loss: 4.078 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4619605541229248
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.099 Vali Acc: 0.287 Test Loss: 4.099 Test Acc: 0.287
Validation loss decreased (-0.285842 --> -0.287018).  Saving model ...
Epoch: 32 cost time: 1.558699131011963
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.120 Vali Acc: 0.295 Test Loss: 4.120 Test Acc: 0.295
Validation loss decreased (-0.287018 --> -0.295253).  Saving model ...
Epoch: 33 cost time: 1.5593845844268799
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.132 Vali Acc: 0.289 Test Loss: 4.132 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.813396692276001
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.138 Vali Acc: 0.286 Test Loss: 4.138 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.785848617553711
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.147 Vali Acc: 0.291 Test Loss: 4.147 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6973259449005127
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.154 Vali Acc: 0.287 Test Loss: 4.154 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.8741087913513184
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.160 Vali Acc: 0.285 Test Loss: 4.160 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.7346105575561523
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.161 Vali Acc: 0.285 Test Loss: 4.161 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.7195985317230225
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.175 Vali Acc: 0.291 Test Loss: 4.175 Test Acc: 0.291
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.7028212547302246
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.191 Vali Acc: 0.289 Test Loss: 4.191 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.6026673316955566
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.196 Vali Acc: 0.291 Test Loss: 4.196 Test Acc: 0.291
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.549821376800537
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.205 Vali Acc: 0.292 Test Loss: 4.205 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2952941176470588
model parameter : 14321238
model size : 59.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.604034423828125
Epoch: 1, Steps: 10 | Train Loss: 3.384 Vali Loss: 3.366 Vali Acc: 0.052 Test Loss: 3.366 Test Acc: 0.052
Validation loss decreased (inf --> -0.051731).  Saving model ...
Epoch: 2 cost time: 1.9713447093963623
Epoch: 2, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.485 Vali Acc: 0.075 Test Loss: 3.485 Test Acc: 0.075
Validation loss decreased (-0.051731 --> -0.075259).  Saving model ...
Epoch: 3 cost time: 1.8676121234893799
Epoch: 3, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.269 Vali Acc: 0.081 Test Loss: 3.269 Test Acc: 0.081
Validation loss decreased (-0.075259 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 1.8952922821044922
Epoch: 4, Steps: 10 | Train Loss: 2.936 Vali Loss: 3.285 Vali Acc: 0.111 Test Loss: 3.285 Test Acc: 0.111
Validation loss decreased (-0.081144 --> -0.110555).  Saving model ...
Epoch: 5 cost time: 1.6163790225982666
Epoch: 5, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.348 Vali Acc: 0.099 Test Loss: 3.348 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7979650497436523
Epoch: 6, Steps: 10 | Train Loss: 2.297 Vali Loss: 3.252 Vali Acc: 0.147 Test Loss: 3.252 Test Acc: 0.147
Validation loss decreased (-0.110555 --> -0.147026).  Saving model ...
Epoch: 7 cost time: 1.6418869495391846
Epoch: 7, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.321 Vali Acc: 0.122 Test Loss: 3.321 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9460718631744385
Epoch: 8, Steps: 10 | Train Loss: 1.708 Vali Loss: 3.318 Vali Acc: 0.174 Test Loss: 3.318 Test Acc: 0.174
Validation loss decreased (-0.147026 --> -0.174084).  Saving model ...
Epoch: 9 cost time: 1.9416027069091797
Epoch: 9, Steps: 10 | Train Loss: 1.477 Vali Loss: 3.356 Vali Acc: 0.147 Test Loss: 3.356 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.706263780593872
Epoch: 10, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.291 Vali Acc: 0.192 Test Loss: 3.291 Test Acc: 0.192
Validation loss decreased (-0.174084 --> -0.191732).  Saving model ...
Epoch: 11 cost time: 2.1268904209136963
Epoch: 11, Steps: 10 | Train Loss: 0.937 Vali Loss: 3.326 Vali Acc: 0.201 Test Loss: 3.326 Test Acc: 0.201
Validation loss decreased (-0.191732 --> -0.201143).  Saving model ...
Epoch: 12 cost time: 1.9189276695251465
Epoch: 12, Steps: 10 | Train Loss: 0.787 Vali Loss: 3.344 Vali Acc: 0.224 Test Loss: 3.344 Test Acc: 0.224
Validation loss decreased (-0.201143 --> -0.223496).  Saving model ...
Epoch: 13 cost time: 1.9931414127349854
Epoch: 13, Steps: 10 | Train Loss: 0.558 Vali Loss: 3.253 Vali Acc: 0.225 Test Loss: 3.253 Test Acc: 0.225
Validation loss decreased (-0.223496 --> -0.224673).  Saving model ...
Epoch: 14 cost time: 1.810472011566162
Epoch: 14, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.677 Vali Acc: 0.187 Test Loss: 3.677 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9499893188476562
Epoch: 15, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.447 Vali Acc: 0.251 Test Loss: 3.447 Test Acc: 0.251
Validation loss decreased (-0.224673 --> -0.250554).  Saving model ...
Epoch: 16 cost time: 1.8285224437713623
Epoch: 16, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.504 Vali Acc: 0.221 Test Loss: 3.504 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8879306316375732
Epoch: 17, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.713 Vali Acc: 0.240 Test Loss: 3.713 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6060905456542969
Epoch: 18, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.677 Vali Acc: 0.262 Test Loss: 3.677 Test Acc: 0.262
Validation loss decreased (-0.250554 --> -0.262316).  Saving model ...
Epoch: 19 cost time: 1.674469232559204
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.893 Vali Acc: 0.242 Test Loss: 3.893 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7710766792297363
Epoch: 20, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.843 Vali Acc: 0.264 Test Loss: 3.843 Test Acc: 0.264
Validation loss decreased (-0.262316 --> -0.263491).  Saving model ...
Epoch: 21 cost time: 1.8403830528259277
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.909 Vali Acc: 0.262 Test Loss: 3.909 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8701682090759277
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.898 Vali Acc: 0.265 Test Loss: 3.898 Test Acc: 0.265
Validation loss decreased (-0.263491 --> -0.264667).  Saving model ...
Epoch: 23 cost time: 1.8409476280212402
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.947 Vali Acc: 0.268 Test Loss: 3.947 Test Acc: 0.268
Validation loss decreased (-0.264667 --> -0.268196).  Saving model ...
Epoch: 24 cost time: 1.762068510055542
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.944 Vali Acc: 0.274 Test Loss: 3.944 Test Acc: 0.274
Validation loss decreased (-0.268196 --> -0.274078).  Saving model ...
Epoch: 25 cost time: 1.9136159420013428
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.933 Vali Acc: 0.285 Test Loss: 3.933 Test Acc: 0.285
Validation loss decreased (-0.274078 --> -0.284667).  Saving model ...
Epoch: 26 cost time: 1.7176086902618408
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.942 Vali Acc: 0.289 Test Loss: 3.942 Test Acc: 0.289
Validation loss decreased (-0.284667 --> -0.289372).  Saving model ...
Epoch: 27 cost time: 1.857909917831421
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.970 Vali Acc: 0.289 Test Loss: 3.970 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7398715019226074
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.010 Vali Acc: 0.289 Test Loss: 4.010 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.29620361328125
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.028 Vali Acc: 0.288 Test Loss: 4.028 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.0781311988830566
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.032 Vali Acc: 0.289 Test Loss: 4.032 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.90690016746521
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.029 Vali Acc: 0.293 Test Loss: 4.029 Test Acc: 0.293
Validation loss decreased (-0.289372 --> -0.292901).  Saving model ...
Epoch: 32 cost time: 1.8953077793121338
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.032 Vali Acc: 0.293 Test Loss: 4.032 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8839261531829834
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.048 Vali Acc: 0.291 Test Loss: 4.048 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6551496982574463
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.049 Vali Acc: 0.288 Test Loss: 4.049 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5345816612243652
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.052 Vali Acc: 0.289 Test Loss: 4.052 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.8810920715332031
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.065 Vali Acc: 0.292 Test Loss: 4.065 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.651721477508545
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.073 Vali Acc: 0.294 Test Loss: 4.073 Test Acc: 0.294
Validation loss decreased (-0.292901 --> -0.294077).  Saving model ...
Epoch: 38 cost time: 1.8922030925750732
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.089 Vali Acc: 0.294 Test Loss: 4.089 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.576756238937378
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.104 Vali Acc: 0.292 Test Loss: 4.104 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.8459970951080322
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.109 Vali Acc: 0.293 Test Loss: 4.109 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.118969440460205
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.120 Vali Acc: 0.295 Test Loss: 4.120 Test Acc: 0.295
Validation loss decreased (-0.294077 --> -0.295253).  Saving model ...
Epoch: 42 cost time: 1.8263680934906006
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.129 Vali Acc: 0.292 Test Loss: 4.129 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.622180461883545
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.136 Vali Acc: 0.291 Test Loss: 4.136 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.0956764221191406
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.147 Vali Acc: 0.293 Test Loss: 4.147 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.5488145351409912
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.157 Vali Acc: 0.295 Test Loss: 4.157 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.770763874053955
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.159 Vali Acc: 0.293 Test Loss: 4.159 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.7249202728271484
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.160 Vali Acc: 0.293 Test Loss: 4.160 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.228498935699463
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.168 Vali Acc: 0.293 Test Loss: 4.168 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.8777580261230469
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.178 Vali Acc: 0.295 Test Loss: 4.178 Test Acc: 0.295
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.24311900138855
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.181 Vali Acc: 0.295 Test Loss: 4.181 Test Acc: 0.295
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.8417015075683594
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.189 Vali Acc: 0.293 Test Loss: 4.189 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2952941176470588
model parameter : 14314582
model size : 59.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6422998905181885
Epoch: 1, Steps: 10 | Train Loss: 3.464 Vali Loss: 3.362 Vali Acc: 0.058 Test Loss: 3.362 Test Acc: 0.058
Validation loss decreased (inf --> -0.057613).  Saving model ...
Epoch: 2 cost time: 1.6229751110076904
Epoch: 2, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.558 Vali Acc: 0.048 Test Loss: 3.558 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7834346294403076
Epoch: 3, Steps: 10 | Train Loss: 3.143 Vali Loss: 3.338 Vali Acc: 0.054 Test Loss: 3.338 Test Acc: 0.054
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.487272024154663
Epoch: 4, Steps: 10 | Train Loss: 2.971 Vali Loss: 3.308 Vali Acc: 0.089 Test Loss: 3.308 Test Acc: 0.089
Validation loss decreased (-0.057613 --> -0.089379).  Saving model ...
Epoch: 5 cost time: 1.443277359008789
Epoch: 5, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.294 Vali Acc: 0.102 Test Loss: 3.294 Test Acc: 0.102
Validation loss decreased (-0.089379 --> -0.102320).  Saving model ...
Epoch: 6 cost time: 1.6875600814819336
Epoch: 6, Steps: 10 | Train Loss: 2.300 Vali Loss: 3.380 Vali Acc: 0.111 Test Loss: 3.380 Test Acc: 0.111
Validation loss decreased (-0.102320 --> -0.110554).  Saving model ...
Epoch: 7 cost time: 1.5576605796813965
Epoch: 7, Steps: 10 | Train Loss: 2.166 Vali Loss: 3.287 Vali Acc: 0.128 Test Loss: 3.287 Test Acc: 0.128
Validation loss decreased (-0.110554 --> -0.128202).  Saving model ...
Epoch: 8 cost time: 1.7135803699493408
Epoch: 8, Steps: 10 | Train Loss: 1.728 Vali Loss: 3.182 Vali Acc: 0.207 Test Loss: 3.182 Test Acc: 0.207
Validation loss decreased (-0.128202 --> -0.207027).  Saving model ...
Epoch: 9 cost time: 1.489022970199585
Epoch: 9, Steps: 10 | Train Loss: 1.404 Vali Loss: 3.317 Vali Acc: 0.147 Test Loss: 3.317 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0035505294799805
Epoch: 10, Steps: 10 | Train Loss: 1.182 Vali Loss: 3.333 Vali Acc: 0.181 Test Loss: 3.333 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6508653163909912
Epoch: 11, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.381 Vali Acc: 0.174 Test Loss: 3.381 Test Acc: 0.174
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5027961730957031
Epoch: 12, Steps: 10 | Train Loss: 0.698 Vali Loss: 3.366 Vali Acc: 0.211 Test Loss: 3.366 Test Acc: 0.211
Validation loss decreased (-0.207027 --> -0.210555).  Saving model ...
Epoch: 13 cost time: 1.7611198425292969
Epoch: 13, Steps: 10 | Train Loss: 0.518 Vali Loss: 3.381 Vali Acc: 0.205 Test Loss: 3.381 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6083498001098633
Epoch: 14, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.351 Vali Acc: 0.232 Test Loss: 3.351 Test Acc: 0.232
Validation loss decreased (-0.210555 --> -0.231731).  Saving model ...
Epoch: 15 cost time: 1.8767902851104736
Epoch: 15, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.693 Vali Acc: 0.209 Test Loss: 3.693 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.520902156829834
Epoch: 16, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.608 Vali Acc: 0.239 Test Loss: 3.608 Test Acc: 0.239
Validation loss decreased (-0.231731 --> -0.238787).  Saving model ...
Epoch: 17 cost time: 1.462968111038208
Epoch: 17, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.727 Vali Acc: 0.226 Test Loss: 3.727 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5519404411315918
Epoch: 18, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.822 Vali Acc: 0.231 Test Loss: 3.822 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4892160892486572
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.817 Vali Acc: 0.239 Test Loss: 3.817 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7344458103179932
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.888 Vali Acc: 0.245 Test Loss: 3.888 Test Acc: 0.245
Validation loss decreased (-0.238787 --> -0.244667).  Saving model ...
Epoch: 21 cost time: 1.7190661430358887
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.970 Vali Acc: 0.249 Test Loss: 3.970 Test Acc: 0.249
Validation loss decreased (-0.244667 --> -0.249372).  Saving model ...
Epoch: 22 cost time: 1.6961405277252197
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.062 Vali Acc: 0.241 Test Loss: 4.062 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6546645164489746
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.013 Vali Acc: 0.244 Test Loss: 4.013 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.886610984802246
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.017 Vali Acc: 0.260 Test Loss: 4.017 Test Acc: 0.260
Validation loss decreased (-0.249372 --> -0.259960).  Saving model ...
Epoch: 25 cost time: 1.6521270275115967
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.018 Vali Acc: 0.262 Test Loss: 4.018 Test Acc: 0.262
Validation loss decreased (-0.259960 --> -0.262313).  Saving model ...
Epoch: 26 cost time: 1.687305212020874
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.999 Vali Acc: 0.262 Test Loss: 3.999 Test Acc: 0.262
Validation loss decreased (-0.262313 --> -0.262313).  Saving model ...
Epoch: 27 cost time: 1.6137123107910156
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.013 Vali Acc: 0.271 Test Loss: 4.013 Test Acc: 0.271
Validation loss decreased (-0.262313 --> -0.270548).  Saving model ...
Epoch: 28 cost time: 1.8864386081695557
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.034 Vali Acc: 0.269 Test Loss: 4.034 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.498936653137207
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.060 Vali Acc: 0.268 Test Loss: 4.060 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6618757247924805
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.080 Vali Acc: 0.272 Test Loss: 4.080 Test Acc: 0.272
Validation loss decreased (-0.270548 --> -0.271724).  Saving model ...
Epoch: 31 cost time: 1.6455206871032715
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.085 Vali Acc: 0.266 Test Loss: 4.085 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7149183750152588
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.091 Vali Acc: 0.265 Test Loss: 4.091 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.735182285308838
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.091 Vali Acc: 0.266 Test Loss: 4.091 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6221539974212646
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.111 Vali Acc: 0.272 Test Loss: 4.111 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.640709638595581
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.121 Vali Acc: 0.267 Test Loss: 4.121 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.8459742069244385
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.136 Vali Acc: 0.267 Test Loss: 4.136 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.329836368560791
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.141 Vali Acc: 0.269 Test Loss: 4.141 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.701073169708252
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.143 Vali Acc: 0.268 Test Loss: 4.143 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.4741003513336182
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.153 Vali Acc: 0.273 Test Loss: 4.153 Test Acc: 0.273
Validation loss decreased (-0.271724 --> -0.272900).  Saving model ...
Epoch: 40 cost time: 1.773308515548706
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.163 Vali Acc: 0.271 Test Loss: 4.163 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6279881000518799
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.172 Vali Acc: 0.272 Test Loss: 4.172 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7917540073394775
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.178 Vali Acc: 0.271 Test Loss: 4.178 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.6897459030151367
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.186 Vali Acc: 0.268 Test Loss: 4.186 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.7160313129425049
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.190 Vali Acc: 0.273 Test Loss: 4.190 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.5874691009521484
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.190 Vali Acc: 0.278 Test Loss: 4.190 Test Acc: 0.278
Validation loss decreased (-0.272900 --> -0.277605).  Saving model ...
Epoch: 46 cost time: 1.7649667263031006
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.189 Vali Acc: 0.272 Test Loss: 4.189 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4472284317016602
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.200 Vali Acc: 0.271 Test Loss: 4.200 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.7615489959716797
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.209 Vali Acc: 0.273 Test Loss: 4.209 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.5439777374267578
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.216 Vali Acc: 0.271 Test Loss: 4.216 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.4019553661346436
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.222 Vali Acc: 0.269 Test Loss: 4.222 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.353456735610962
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.230 Vali Acc: 0.272 Test Loss: 4.230 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.598642349243164
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.238 Vali Acc: 0.272 Test Loss: 4.238 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.64654541015625
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.248 Vali Acc: 0.272 Test Loss: 4.248 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.8581621646881104
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.257 Vali Acc: 0.271 Test Loss: 4.257 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.790123462677002
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.265 Vali Acc: 0.272 Test Loss: 4.265 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 14307926
model size : 59.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6356146335601807
Epoch: 1, Steps: 10 | Train Loss: 3.445 Vali Loss: 3.325 Vali Acc: 0.067 Test Loss: 3.325 Test Acc: 0.067
Validation loss decreased (inf --> -0.067026).  Saving model ...
Epoch: 2 cost time: 1.8657574653625488
Epoch: 2, Steps: 10 | Train Loss: 3.373 Vali Loss: 3.518 Vali Acc: 0.044 Test Loss: 3.518 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9116928577423096
Epoch: 3, Steps: 10 | Train Loss: 3.122 Vali Loss: 3.334 Vali Acc: 0.073 Test Loss: 3.334 Test Acc: 0.073
Validation loss decreased (-0.067026 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 1.9349033832550049
Epoch: 4, Steps: 10 | Train Loss: 3.032 Vali Loss: 3.281 Vali Acc: 0.081 Test Loss: 3.281 Test Acc: 0.081
Validation loss decreased (-0.072908 --> -0.081144).  Saving model ...
Epoch: 5 cost time: 1.7909204959869385
Epoch: 5, Steps: 10 | Train Loss: 2.743 Vali Loss: 3.242 Vali Acc: 0.118 Test Loss: 3.242 Test Acc: 0.118
Validation loss decreased (-0.081144 --> -0.117615).  Saving model ...
Epoch: 6 cost time: 2.1547255516052246
Epoch: 6, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.461 Vali Acc: 0.107 Test Loss: 3.461 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5858290195465088
Epoch: 7, Steps: 10 | Train Loss: 2.167 Vali Loss: 3.313 Vali Acc: 0.139 Test Loss: 3.313 Test Acc: 0.139
Validation loss decreased (-0.117615 --> -0.138790).  Saving model ...
Epoch: 8 cost time: 1.759721279144287
Epoch: 8, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.309 Vali Acc: 0.154 Test Loss: 3.309 Test Acc: 0.154
Validation loss decreased (-0.138790 --> -0.154085).  Saving model ...
Epoch: 9 cost time: 1.6759796142578125
Epoch: 9, Steps: 10 | Train Loss: 1.695 Vali Loss: 3.391 Vali Acc: 0.161 Test Loss: 3.391 Test Acc: 0.161
Validation loss decreased (-0.154085 --> -0.161143).  Saving model ...
Epoch: 10 cost time: 2.042060136795044
Epoch: 10, Steps: 10 | Train Loss: 1.338 Vali Loss: 3.279 Vali Acc: 0.180 Test Loss: 3.279 Test Acc: 0.180
Validation loss decreased (-0.161143 --> -0.179967).  Saving model ...
Epoch: 11 cost time: 1.7465169429779053
Epoch: 11, Steps: 10 | Train Loss: 1.067 Vali Loss: 3.316 Vali Acc: 0.188 Test Loss: 3.316 Test Acc: 0.188
Validation loss decreased (-0.179967 --> -0.188202).  Saving model ...
Epoch: 12 cost time: 1.92185378074646
Epoch: 12, Steps: 10 | Train Loss: 0.835 Vali Loss: 3.299 Vali Acc: 0.201 Test Loss: 3.299 Test Acc: 0.201
Validation loss decreased (-0.188202 --> -0.201143).  Saving model ...
Epoch: 13 cost time: 1.9454314708709717
Epoch: 13, Steps: 10 | Train Loss: 0.666 Vali Loss: 3.315 Vali Acc: 0.221 Test Loss: 3.315 Test Acc: 0.221
Validation loss decreased (-0.201143 --> -0.221143).  Saving model ...
Epoch: 14 cost time: 2.4798390865325928
Epoch: 14, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.425 Vali Acc: 0.205 Test Loss: 3.425 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6512532234191895
Epoch: 15, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.646 Vali Acc: 0.205 Test Loss: 3.646 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7272357940673828
Epoch: 16, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.611 Vali Acc: 0.208 Test Loss: 3.611 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6017687320709229
Epoch: 17, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.814 Vali Acc: 0.211 Test Loss: 3.814 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1544814109802246
Epoch: 18, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.895 Vali Acc: 0.214 Test Loss: 3.895 Test Acc: 0.214
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7686913013458252
Epoch: 19, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.843 Vali Acc: 0.220 Test Loss: 3.843 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7006397247314453
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.773 Vali Acc: 0.249 Test Loss: 3.773 Test Acc: 0.249
Validation loss decreased (-0.221143 --> -0.249374).  Saving model ...
Epoch: 21 cost time: 1.7541847229003906
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.938 Vali Acc: 0.242 Test Loss: 3.938 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.806354284286499
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.928 Vali Acc: 0.265 Test Loss: 3.928 Test Acc: 0.265
Validation loss decreased (-0.249374 --> -0.264667).  Saving model ...
Epoch: 23 cost time: 2.0527992248535156
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.930 Vali Acc: 0.262 Test Loss: 3.930 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.863262414932251
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.908 Vali Acc: 0.273 Test Loss: 3.908 Test Acc: 0.273
Validation loss decreased (-0.264667 --> -0.272902).  Saving model ...
Epoch: 25 cost time: 2.0325706005096436
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.916 Vali Acc: 0.273 Test Loss: 3.916 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0942201614379883
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.966 Vali Acc: 0.271 Test Loss: 3.966 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.868021011352539
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.996 Vali Acc: 0.275 Test Loss: 3.996 Test Acc: 0.275
Validation loss decreased (-0.272902 --> -0.275254).  Saving model ...
Epoch: 28 cost time: 2.191842794418335
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.999 Vali Acc: 0.273 Test Loss: 3.999 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6278085708618164
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.995 Vali Acc: 0.280 Test Loss: 3.995 Test Acc: 0.280
Validation loss decreased (-0.275254 --> -0.279960).  Saving model ...
Epoch: 30 cost time: 1.984729290008545
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.000 Vali Acc: 0.288 Test Loss: 4.000 Test Acc: 0.288
Validation loss decreased (-0.279960 --> -0.288195).  Saving model ...
Epoch: 31 cost time: 1.7778449058532715
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.019 Vali Acc: 0.291 Test Loss: 4.019 Test Acc: 0.291
Validation loss decreased (-0.288195 --> -0.290548).  Saving model ...
Epoch: 32 cost time: 1.8806145191192627
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.036 Vali Acc: 0.288 Test Loss: 4.036 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8490276336669922
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.047 Vali Acc: 0.282 Test Loss: 4.047 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8820676803588867
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.061 Vali Acc: 0.284 Test Loss: 4.061 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8127689361572266
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.069 Vali Acc: 0.288 Test Loss: 4.069 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.8655085563659668
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.058 Vali Acc: 0.286 Test Loss: 4.058 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.9614956378936768
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.064 Vali Acc: 0.286 Test Loss: 4.064 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.860395908355713
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.076 Vali Acc: 0.288 Test Loss: 4.076 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.058924436569214
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.090 Vali Acc: 0.289 Test Loss: 4.090 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.8122706413269043
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.097 Vali Acc: 0.291 Test Loss: 4.097 Test Acc: 0.291
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.11667799949646
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.105 Vali Acc: 0.287 Test Loss: 4.105 Test Acc: 0.287
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 11963990
model size : 50.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.638963937759399
Epoch: 1, Steps: 10 | Train Loss: 3.432 Vali Loss: 3.330 Vali Acc: 0.055 Test Loss: 3.330 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 2.070528745651245
Epoch: 2, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.396 Vali Acc: 0.051 Test Loss: 3.396 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7456915378570557
Epoch: 3, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.293 Vali Acc: 0.095 Test Loss: 3.293 Test Acc: 0.095
Validation loss decreased (-0.055261 --> -0.095261).  Saving model ...
Epoch: 4 cost time: 1.571082592010498
Epoch: 4, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.261 Vali Acc: 0.085 Test Loss: 3.261 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.637601613998413
Epoch: 5, Steps: 10 | Train Loss: 2.738 Vali Loss: 3.326 Vali Acc: 0.102 Test Loss: 3.326 Test Acc: 0.102
Validation loss decreased (-0.095261 --> -0.102320).  Saving model ...
Epoch: 6 cost time: 1.6066174507141113
Epoch: 6, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.236 Vali Acc: 0.151 Test Loss: 3.236 Test Acc: 0.151
Validation loss decreased (-0.102320 --> -0.150556).  Saving model ...
Epoch: 7 cost time: 1.6687350273132324
Epoch: 7, Steps: 10 | Train Loss: 2.176 Vali Loss: 3.341 Vali Acc: 0.138 Test Loss: 3.341 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8563330173492432
Epoch: 8, Steps: 10 | Train Loss: 1.837 Vali Loss: 3.187 Vali Acc: 0.200 Test Loss: 3.187 Test Acc: 0.200
Validation loss decreased (-0.150556 --> -0.199968).  Saving model ...
Epoch: 9 cost time: 1.4701671600341797
Epoch: 9, Steps: 10 | Train Loss: 1.570 Vali Loss: 3.306 Vali Acc: 0.172 Test Loss: 3.306 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0084402561187744
Epoch: 10, Steps: 10 | Train Loss: 1.296 Vali Loss: 3.269 Vali Acc: 0.204 Test Loss: 3.269 Test Acc: 0.204
Validation loss decreased (-0.199968 --> -0.203497).  Saving model ...
Epoch: 11 cost time: 1.9022934436798096
Epoch: 11, Steps: 10 | Train Loss: 1.096 Vali Loss: 3.332 Vali Acc: 0.188 Test Loss: 3.332 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8449831008911133
Epoch: 12, Steps: 10 | Train Loss: 0.830 Vali Loss: 3.476 Vali Acc: 0.188 Test Loss: 3.476 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7933094501495361
Epoch: 13, Steps: 10 | Train Loss: 0.691 Vali Loss: 3.471 Vali Acc: 0.205 Test Loss: 3.471 Test Acc: 0.205
Validation loss decreased (-0.203497 --> -0.204671).  Saving model ...
Epoch: 14 cost time: 1.7116191387176514
Epoch: 14, Steps: 10 | Train Loss: 0.488 Vali Loss: 3.536 Vali Acc: 0.188 Test Loss: 3.536 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0700573921203613
Epoch: 15, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.594 Vali Acc: 0.214 Test Loss: 3.594 Test Acc: 0.214
Validation loss decreased (-0.204671 --> -0.214082).  Saving model ...
Epoch: 16 cost time: 1.7672407627105713
Epoch: 16, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.575 Vali Acc: 0.253 Test Loss: 3.575 Test Acc: 0.253
Validation loss decreased (-0.214082 --> -0.252905).  Saving model ...
Epoch: 17 cost time: 1.961353063583374
Epoch: 17, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.674 Vali Acc: 0.247 Test Loss: 3.674 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7827718257904053
Epoch: 18, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.771 Vali Acc: 0.233 Test Loss: 3.771 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.98152494430542
Epoch: 19, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.809 Vali Acc: 0.279 Test Loss: 3.809 Test Acc: 0.279
Validation loss decreased (-0.252905 --> -0.278785).  Saving model ...
Epoch: 20 cost time: 1.9144492149353027
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.654 Vali Acc: 0.265 Test Loss: 3.654 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8182120323181152
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.891 Vali Acc: 0.256 Test Loss: 3.891 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8355846405029297
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.862 Vali Acc: 0.265 Test Loss: 3.862 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.743840217590332
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.880 Vali Acc: 0.272 Test Loss: 3.880 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2179386615753174
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.968 Vali Acc: 0.259 Test Loss: 3.968 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7969584465026855
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.950 Vali Acc: 0.273 Test Loss: 3.950 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8137693405151367
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.965 Vali Acc: 0.273 Test Loss: 3.965 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7776918411254883
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.960 Vali Acc: 0.274 Test Loss: 3.960 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.21662974357605
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.977 Vali Acc: 0.280 Test Loss: 3.977 Test Acc: 0.280
Validation loss decreased (-0.278785 --> -0.279960).  Saving model ...
Epoch: 29 cost time: 2.155726432800293
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.996 Vali Acc: 0.286 Test Loss: 3.996 Test Acc: 0.286
Validation loss decreased (-0.279960 --> -0.285842).  Saving model ...
Epoch: 30 cost time: 2.0126428604125977
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.008 Vali Acc: 0.278 Test Loss: 4.008 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.1316471099853516
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.013 Vali Acc: 0.284 Test Loss: 4.013 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.065570116043091
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.032 Vali Acc: 0.280 Test Loss: 4.032 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.775299310684204
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.048 Vali Acc: 0.282 Test Loss: 4.048 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.199788808822632
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.053 Vali Acc: 0.282 Test Loss: 4.053 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.0867881774902344
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.060 Vali Acc: 0.284 Test Loss: 4.060 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.084526777267456
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.064 Vali Acc: 0.280 Test Loss: 4.064 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.8828153610229492
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.081 Vali Acc: 0.278 Test Loss: 4.081 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.69209623336792
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.101 Vali Acc: 0.280 Test Loss: 4.101 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.8661460876464844
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.116 Vali Acc: 0.285 Test Loss: 4.116 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2858823529411765
model parameter : 11957334
model size : 50.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.922642230987549
Epoch: 1, Steps: 10 | Train Loss: 3.535 Vali Loss: 3.329 Vali Acc: 0.035 Test Loss: 3.329 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 1.8674283027648926
Epoch: 2, Steps: 10 | Train Loss: 3.343 Vali Loss: 3.498 Vali Acc: 0.048 Test Loss: 3.498 Test Acc: 0.048
Validation loss decreased (-0.035261 --> -0.048200).  Saving model ...
Epoch: 3 cost time: 1.7540643215179443
Epoch: 3, Steps: 10 | Train Loss: 3.157 Vali Loss: 3.378 Vali Acc: 0.066 Test Loss: 3.378 Test Acc: 0.066
Validation loss decreased (-0.048200 --> -0.065849).  Saving model ...
Epoch: 4 cost time: 1.7820518016815186
Epoch: 4, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.306 Vali Acc: 0.080 Test Loss: 3.306 Test Acc: 0.080
Validation loss decreased (-0.065849 --> -0.079967).  Saving model ...
Epoch: 5 cost time: 1.696927785873413
Epoch: 5, Steps: 10 | Train Loss: 2.834 Vali Loss: 3.294 Vali Acc: 0.114 Test Loss: 3.294 Test Acc: 0.114
Validation loss decreased (-0.079967 --> -0.114085).  Saving model ...
Epoch: 6 cost time: 1.7434966564178467
Epoch: 6, Steps: 10 | Train Loss: 2.522 Vali Loss: 3.346 Vali Acc: 0.109 Test Loss: 3.346 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7569053173065186
Epoch: 7, Steps: 10 | Train Loss: 2.292 Vali Loss: 3.328 Vali Acc: 0.134 Test Loss: 3.328 Test Acc: 0.134
Validation loss decreased (-0.114085 --> -0.134084).  Saving model ...
Epoch: 8 cost time: 1.495410442352295
Epoch: 8, Steps: 10 | Train Loss: 2.004 Vali Loss: 3.353 Vali Acc: 0.165 Test Loss: 3.353 Test Acc: 0.165
Validation loss decreased (-0.134084 --> -0.164672).  Saving model ...
Epoch: 9 cost time: 1.7434322834014893
Epoch: 9, Steps: 10 | Train Loss: 1.712 Vali Loss: 3.295 Vali Acc: 0.169 Test Loss: 3.295 Test Acc: 0.169
Validation loss decreased (-0.164672 --> -0.169379).  Saving model ...
Epoch: 10 cost time: 1.6489524841308594
Epoch: 10, Steps: 10 | Train Loss: 1.361 Vali Loss: 3.318 Vali Acc: 0.198 Test Loss: 3.318 Test Acc: 0.198
Validation loss decreased (-0.169379 --> -0.197614).  Saving model ...
Epoch: 11 cost time: 1.6879653930664062
Epoch: 11, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.422 Vali Acc: 0.196 Test Loss: 3.422 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7774279117584229
Epoch: 12, Steps: 10 | Train Loss: 0.871 Vali Loss: 3.359 Vali Acc: 0.184 Test Loss: 3.359 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.777048110961914
Epoch: 13, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.395 Vali Acc: 0.227 Test Loss: 3.395 Test Acc: 0.227
Validation loss decreased (-0.197614 --> -0.227025).  Saving model ...
Epoch: 14 cost time: 1.6963489055633545
Epoch: 14, Steps: 10 | Train Loss: 0.521 Vali Loss: 3.787 Vali Acc: 0.175 Test Loss: 3.787 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.697510004043579
Epoch: 15, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.517 Vali Acc: 0.224 Test Loss: 3.517 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5597074031829834
Epoch: 16, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.572 Vali Acc: 0.241 Test Loss: 3.572 Test Acc: 0.241
Validation loss decreased (-0.227025 --> -0.241141).  Saving model ...
Epoch: 17 cost time: 1.887974739074707
Epoch: 17, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.826 Vali Acc: 0.229 Test Loss: 3.826 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.737792730331421
Epoch: 18, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.788 Vali Acc: 0.234 Test Loss: 3.788 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0930120944976807
Epoch: 19, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.837 Vali Acc: 0.245 Test Loss: 3.837 Test Acc: 0.245
Validation loss decreased (-0.241141 --> -0.244668).  Saving model ...
Epoch: 20 cost time: 1.889331340789795
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.091 Vali Acc: 0.227 Test Loss: 4.091 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6132512092590332
Epoch: 21, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.220 Vali Acc: 0.216 Test Loss: 4.220 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7548186779022217
Epoch: 22, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.455 Vali Acc: 0.182 Test Loss: 4.455 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5858802795410156
Epoch: 23, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.985 Vali Acc: 0.226 Test Loss: 3.985 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.738966703414917
Epoch: 24, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.203 Vali Acc: 0.241 Test Loss: 4.203 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5804164409637451
Epoch: 25, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.304 Vali Acc: 0.221 Test Loss: 4.304 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7013118267059326
Epoch: 26, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.324 Vali Acc: 0.236 Test Loss: 4.324 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8603076934814453
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.161 Vali Acc: 0.267 Test Loss: 4.161 Test Acc: 0.267
Validation loss decreased (-0.244668 --> -0.267017).  Saving model ...
Epoch: 28 cost time: 1.6199219226837158
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.172 Vali Acc: 0.275 Test Loss: 4.172 Test Acc: 0.275
Validation loss decreased (-0.267017 --> -0.275252).  Saving model ...
Epoch: 29 cost time: 1.6460132598876953
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.160 Vali Acc: 0.284 Test Loss: 4.160 Test Acc: 0.284
Validation loss decreased (-0.275252 --> -0.283488).  Saving model ...
Epoch: 30 cost time: 1.7877838611602783
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.144 Vali Acc: 0.281 Test Loss: 4.144 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8004710674285889
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.170 Vali Acc: 0.279 Test Loss: 4.170 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6869573593139648
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.200 Vali Acc: 0.275 Test Loss: 4.200 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.598332166671753
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.222 Vali Acc: 0.278 Test Loss: 4.222 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.9611690044403076
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.230 Vali Acc: 0.281 Test Loss: 4.230 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7465794086456299
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.241 Vali Acc: 0.279 Test Loss: 4.241 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.9828541278839111
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.251 Vali Acc: 0.276 Test Loss: 4.251 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.7171118259429932
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.261 Vali Acc: 0.280 Test Loss: 4.261 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.7648406028747559
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.273 Vali Acc: 0.280 Test Loss: 4.273 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.385812759399414
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.284 Vali Acc: 0.281 Test Loss: 4.284 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 11950678
model size : 50.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.8979594707489014
Epoch: 1, Steps: 10 | Train Loss: 3.430 Vali Loss: 3.335 Vali Acc: 0.041 Test Loss: 3.335 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.7730071544647217
Epoch: 2, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.476 Vali Acc: 0.034 Test Loss: 3.476 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.61897873878479
Epoch: 3, Steps: 10 | Train Loss: 3.161 Vali Loss: 3.311 Vali Acc: 0.072 Test Loss: 3.311 Test Acc: 0.072
Validation loss decreased (-0.041143 --> -0.071732).  Saving model ...
Epoch: 4 cost time: 1.603686809539795
Epoch: 4, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.287 Vali Acc: 0.076 Test Loss: 3.287 Test Acc: 0.076
Validation loss decreased (-0.071732 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 1.7091200351715088
Epoch: 5, Steps: 10 | Train Loss: 2.735 Vali Loss: 3.311 Vali Acc: 0.114 Test Loss: 3.311 Test Acc: 0.114
Validation loss decreased (-0.076438 --> -0.114085).  Saving model ...
Epoch: 6 cost time: 1.570326566696167
Epoch: 6, Steps: 10 | Train Loss: 2.456 Vali Loss: 3.231 Vali Acc: 0.129 Test Loss: 3.231 Test Acc: 0.129
Validation loss decreased (-0.114085 --> -0.129379).  Saving model ...
Epoch: 7 cost time: 1.9421463012695312
Epoch: 7, Steps: 10 | Train Loss: 2.171 Vali Loss: 3.328 Vali Acc: 0.149 Test Loss: 3.328 Test Acc: 0.149
Validation loss decreased (-0.129379 --> -0.149378).  Saving model ...
Epoch: 8 cost time: 1.7665460109710693
Epoch: 8, Steps: 10 | Train Loss: 1.845 Vali Loss: 3.241 Vali Acc: 0.184 Test Loss: 3.241 Test Acc: 0.184
Validation loss decreased (-0.149378 --> -0.183497).  Saving model ...
Epoch: 9 cost time: 1.7042052745819092
Epoch: 9, Steps: 10 | Train Loss: 1.595 Vali Loss: 3.200 Vali Acc: 0.192 Test Loss: 3.200 Test Acc: 0.192
Validation loss decreased (-0.183497 --> -0.191733).  Saving model ...
Epoch: 10 cost time: 1.5508995056152344
Epoch: 10, Steps: 10 | Train Loss: 1.294 Vali Loss: 3.270 Vali Acc: 0.173 Test Loss: 3.270 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8239455223083496
Epoch: 11, Steps: 10 | Train Loss: 1.000 Vali Loss: 3.318 Vali Acc: 0.195 Test Loss: 3.318 Test Acc: 0.195
Validation loss decreased (-0.191733 --> -0.195261).  Saving model ...
Epoch: 12 cost time: 1.985706090927124
Epoch: 12, Steps: 10 | Train Loss: 0.814 Vali Loss: 3.340 Vali Acc: 0.194 Test Loss: 3.340 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.227175235748291
Epoch: 13, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.404 Vali Acc: 0.216 Test Loss: 3.404 Test Acc: 0.216
Validation loss decreased (-0.195261 --> -0.216437).  Saving model ...
Epoch: 14 cost time: 1.9335315227508545
Epoch: 14, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.753 Vali Acc: 0.173 Test Loss: 3.753 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7669193744659424
Epoch: 15, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.536 Vali Acc: 0.231 Test Loss: 3.536 Test Acc: 0.231
Validation loss decreased (-0.216437 --> -0.230553).  Saving model ...
Epoch: 16 cost time: 1.6298308372497559
Epoch: 16, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.679 Vali Acc: 0.239 Test Loss: 3.679 Test Acc: 0.239
Validation loss decreased (-0.230553 --> -0.238787).  Saving model ...
Epoch: 17 cost time: 1.585522174835205
Epoch: 17, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.720 Vali Acc: 0.214 Test Loss: 3.720 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.104008913040161
Epoch: 18, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.072 Vali Acc: 0.221 Test Loss: 4.072 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9704418182373047
Epoch: 19, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.810 Vali Acc: 0.252 Test Loss: 3.810 Test Acc: 0.252
Validation loss decreased (-0.238787 --> -0.251727).  Saving model ...
Epoch: 20 cost time: 2.054732322692871
Epoch: 20, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.300 Vali Acc: 0.212 Test Loss: 4.300 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6647603511810303
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.061 Vali Acc: 0.228 Test Loss: 4.061 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7587883472442627
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.959 Vali Acc: 0.254 Test Loss: 3.959 Test Acc: 0.254
Validation loss decreased (-0.251727 --> -0.254078).  Saving model ...
Epoch: 23 cost time: 1.712188959121704
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.075 Vali Acc: 0.247 Test Loss: 4.075 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9786736965179443
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.082 Vali Acc: 0.252 Test Loss: 4.082 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.917304277420044
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.068 Vali Acc: 0.265 Test Loss: 4.068 Test Acc: 0.265
Validation loss decreased (-0.254078 --> -0.264665).  Saving model ...
Epoch: 26 cost time: 1.9354641437530518
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.085 Vali Acc: 0.268 Test Loss: 4.085 Test Acc: 0.268
Validation loss decreased (-0.264665 --> -0.268194).  Saving model ...
Epoch: 27 cost time: 1.5841095447540283
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.127 Vali Acc: 0.267 Test Loss: 4.127 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8983380794525146
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.169 Vali Acc: 0.269 Test Loss: 4.169 Test Acc: 0.269
Validation loss decreased (-0.268194 --> -0.269370).  Saving model ...
Epoch: 29 cost time: 1.6276051998138428
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.154 Vali Acc: 0.272 Test Loss: 4.154 Test Acc: 0.272
Validation loss decreased (-0.269370 --> -0.271723).  Saving model ...
Epoch: 30 cost time: 1.8222970962524414
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.143 Vali Acc: 0.268 Test Loss: 4.143 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0734498500823975
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.152 Vali Acc: 0.272 Test Loss: 4.152 Test Acc: 0.272
Validation loss decreased (-0.271723 --> -0.271723).  Saving model ...
Epoch: 32 cost time: 1.9568672180175781
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.168 Vali Acc: 0.272 Test Loss: 4.168 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.103276252746582
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.174 Vali Acc: 0.271 Test Loss: 4.174 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7637794017791748
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.179 Vali Acc: 0.267 Test Loss: 4.179 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.015132188796997
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.192 Vali Acc: 0.272 Test Loss: 4.192 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.5120699405670166
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.198 Vali Acc: 0.274 Test Loss: 4.198 Test Acc: 0.274
Validation loss decreased (-0.271723 --> -0.274076).  Saving model ...
Epoch: 37 cost time: 1.7559335231781006
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.205 Vali Acc: 0.275 Test Loss: 4.205 Test Acc: 0.275
Validation loss decreased (-0.274076 --> -0.275252).  Saving model ...
Epoch: 38 cost time: 1.873948335647583
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.220 Vali Acc: 0.272 Test Loss: 4.220 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7393498420715332
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.238 Vali Acc: 0.272 Test Loss: 4.238 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.8544304370880127
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.243 Vali Acc: 0.273 Test Loss: 4.243 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.051949977874756
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.250 Vali Acc: 0.272 Test Loss: 4.250 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.4687230587005615
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.255 Vali Acc: 0.267 Test Loss: 4.255 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.8875253200531006
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.267 Vali Acc: 0.272 Test Loss: 4.267 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.8725225925445557
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.280 Vali Acc: 0.272 Test Loss: 4.280 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.954171895980835
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.286 Vali Acc: 0.274 Test Loss: 4.286 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.9016656875610352
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.293 Vali Acc: 0.273 Test Loss: 4.293 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.073923110961914
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.301 Vali Acc: 0.273 Test Loss: 4.301 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 11944022
model size : 50.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.393585681915283
Epoch: 1, Steps: 10 | Train Loss: 3.400 Vali Loss: 3.356 Vali Acc: 0.036 Test Loss: 3.356 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 2.041269302368164
Epoch: 2, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.430 Vali Acc: 0.059 Test Loss: 3.430 Test Acc: 0.059
Validation loss decreased (-0.036437 --> -0.058789).  Saving model ...
Epoch: 3 cost time: 1.6235291957855225
Epoch: 3, Steps: 10 | Train Loss: 3.212 Vali Loss: 3.309 Vali Acc: 0.068 Test Loss: 3.309 Test Acc: 0.068
Validation loss decreased (-0.058789 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 1.7781603336334229
Epoch: 4, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.330 Vali Acc: 0.075 Test Loss: 3.330 Test Acc: 0.075
Validation loss decreased (-0.068202 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 1.745776891708374
Epoch: 5, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.296 Vali Acc: 0.121 Test Loss: 3.296 Test Acc: 0.121
Validation loss decreased (-0.075261 --> -0.121144).  Saving model ...
Epoch: 6 cost time: 1.582301378250122
Epoch: 6, Steps: 10 | Train Loss: 2.512 Vali Loss: 3.259 Vali Acc: 0.119 Test Loss: 3.259 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5696783065795898
Epoch: 7, Steps: 10 | Train Loss: 2.323 Vali Loss: 3.343 Vali Acc: 0.135 Test Loss: 3.343 Test Acc: 0.135
Validation loss decreased (-0.121144 --> -0.135261).  Saving model ...
Epoch: 8 cost time: 1.5225505828857422
Epoch: 8, Steps: 10 | Train Loss: 2.026 Vali Loss: 3.253 Vali Acc: 0.166 Test Loss: 3.253 Test Acc: 0.166
Validation loss decreased (-0.135261 --> -0.165850).  Saving model ...
Epoch: 9 cost time: 1.7506978511810303
Epoch: 9, Steps: 10 | Train Loss: 1.643 Vali Loss: 3.324 Vali Acc: 0.151 Test Loss: 3.324 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7289037704467773
Epoch: 10, Steps: 10 | Train Loss: 1.361 Vali Loss: 3.275 Vali Acc: 0.199 Test Loss: 3.275 Test Acc: 0.199
Validation loss decreased (-0.165850 --> -0.198791).  Saving model ...
Epoch: 11 cost time: 1.6361486911773682
Epoch: 11, Steps: 10 | Train Loss: 1.123 Vali Loss: 3.385 Vali Acc: 0.172 Test Loss: 3.385 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.663865089416504
Epoch: 12, Steps: 10 | Train Loss: 0.955 Vali Loss: 3.451 Vali Acc: 0.176 Test Loss: 3.451 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6094152927398682
Epoch: 13, Steps: 10 | Train Loss: 0.778 Vali Loss: 3.398 Vali Acc: 0.206 Test Loss: 3.398 Test Acc: 0.206
Validation loss decreased (-0.198791 --> -0.205848).  Saving model ...
Epoch: 14 cost time: 1.9025521278381348
Epoch: 14, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.549 Vali Acc: 0.200 Test Loss: 3.549 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7298433780670166
Epoch: 15, Steps: 10 | Train Loss: 0.447 Vali Loss: 3.544 Vali Acc: 0.225 Test Loss: 3.544 Test Acc: 0.225
Validation loss decreased (-0.205848 --> -0.224670).  Saving model ...
Epoch: 16 cost time: 1.6609148979187012
Epoch: 16, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.713 Vali Acc: 0.220 Test Loss: 3.713 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9792940616607666
Epoch: 17, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.818 Vali Acc: 0.208 Test Loss: 3.818 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5407092571258545
Epoch: 18, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.963 Vali Acc: 0.236 Test Loss: 3.963 Test Acc: 0.236
Validation loss decreased (-0.224670 --> -0.236431).  Saving model ...
Epoch: 19 cost time: 1.8236713409423828
Epoch: 19, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.864 Vali Acc: 0.236 Test Loss: 3.864 Test Acc: 0.236
Validation loss decreased (-0.236431 --> -0.236432).  Saving model ...
Epoch: 20 cost time: 1.6542630195617676
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.940 Vali Acc: 0.231 Test Loss: 3.940 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.479184627532959
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.048 Vali Acc: 0.247 Test Loss: 4.048 Test Acc: 0.247
Validation loss decreased (-0.236432 --> -0.247018).  Saving model ...
Epoch: 22 cost time: 1.637993574142456
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.957 Vali Acc: 0.245 Test Loss: 3.957 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7109150886535645
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.080 Vali Acc: 0.255 Test Loss: 4.080 Test Acc: 0.255
Validation loss decreased (-0.247018 --> -0.255253).  Saving model ...
Epoch: 24 cost time: 1.7918448448181152
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.056 Vali Acc: 0.261 Test Loss: 4.056 Test Acc: 0.261
Validation loss decreased (-0.255253 --> -0.261136).  Saving model ...
Epoch: 25 cost time: 1.7447192668914795
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.077 Vali Acc: 0.260 Test Loss: 4.077 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5466725826263428
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.063 Vali Acc: 0.272 Test Loss: 4.063 Test Acc: 0.272
Validation loss decreased (-0.261136 --> -0.271724).  Saving model ...
Epoch: 27 cost time: 2.072866201400757
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.062 Vali Acc: 0.275 Test Loss: 4.062 Test Acc: 0.275
Validation loss decreased (-0.271724 --> -0.275253).  Saving model ...
Epoch: 28 cost time: 1.6249809265136719
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.078 Vali Acc: 0.273 Test Loss: 4.078 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5850157737731934
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.089 Vali Acc: 0.274 Test Loss: 4.089 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5610716342926025
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.105 Vali Acc: 0.275 Test Loss: 4.105 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6665935516357422
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.114 Vali Acc: 0.274 Test Loss: 4.114 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6428074836730957
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.122 Vali Acc: 0.274 Test Loss: 4.122 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6747920513153076
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.139 Vali Acc: 0.276 Test Loss: 4.139 Test Acc: 0.276
Validation loss decreased (-0.275253 --> -0.276429).  Saving model ...
Epoch: 34 cost time: 1.6862859725952148
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.147 Vali Acc: 0.276 Test Loss: 4.147 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5064895153045654
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.148 Vali Acc: 0.278 Test Loss: 4.148 Test Acc: 0.278
Validation loss decreased (-0.276429 --> -0.277606).  Saving model ...
Epoch: 36 cost time: 1.6440129280090332
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.155 Vali Acc: 0.280 Test Loss: 4.155 Test Acc: 0.280
Validation loss decreased (-0.277606 --> -0.279958).  Saving model ...
Epoch: 37 cost time: 1.545428991317749
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.173 Vali Acc: 0.281 Test Loss: 4.173 Test Acc: 0.281
Validation loss decreased (-0.279958 --> -0.281135).  Saving model ...
Epoch: 38 cost time: 1.7609953880310059
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.187 Vali Acc: 0.279 Test Loss: 4.187 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.873347282409668
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.193 Vali Acc: 0.274 Test Loss: 4.193 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4437661170959473
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.194 Vali Acc: 0.275 Test Loss: 4.194 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.4839279651641846
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.208 Vali Acc: 0.278 Test Loss: 4.208 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.688549280166626
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.223 Vali Acc: 0.279 Test Loss: 4.223 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.721757411956787
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.241 Vali Acc: 0.276 Test Loss: 4.241 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.6496775150299072
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.254 Vali Acc: 0.276 Test Loss: 4.254 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.8119137287139893
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.260 Vali Acc: 0.279 Test Loss: 4.260 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.858133316040039
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.272 Vali Acc: 0.280 Test Loss: 4.272 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.9277474880218506
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.274 Vali Acc: 0.281 Test Loss: 4.274 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 10782038
model size : 46.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.621032953262329
Epoch: 1, Steps: 10 | Train Loss: 3.461 Vali Loss: 3.317 Vali Acc: 0.039 Test Loss: 3.317 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.8346762657165527
Epoch: 2, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.466 Vali Acc: 0.058 Test Loss: 3.466 Test Acc: 0.058
Validation loss decreased (-0.038790 --> -0.057612).  Saving model ...
Epoch: 3 cost time: 1.7018866539001465
Epoch: 3, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.321 Vali Acc: 0.072 Test Loss: 3.321 Test Acc: 0.072
Validation loss decreased (-0.057612 --> -0.071731).  Saving model ...
Epoch: 4 cost time: 1.6604523658752441
Epoch: 4, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.273 Vali Acc: 0.069 Test Loss: 3.273 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.747107744216919
Epoch: 5, Steps: 10 | Train Loss: 2.773 Vali Loss: 3.303 Vali Acc: 0.124 Test Loss: 3.303 Test Acc: 0.124
Validation loss decreased (-0.071731 --> -0.123496).  Saving model ...
Epoch: 6 cost time: 1.7019634246826172
Epoch: 6, Steps: 10 | Train Loss: 2.528 Vali Loss: 3.334 Vali Acc: 0.109 Test Loss: 3.334 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.720963478088379
Epoch: 7, Steps: 10 | Train Loss: 2.206 Vali Loss: 3.215 Vali Acc: 0.168 Test Loss: 3.215 Test Acc: 0.168
Validation loss decreased (-0.123496 --> -0.168203).  Saving model ...
Epoch: 8 cost time: 1.7223339080810547
Epoch: 8, Steps: 10 | Train Loss: 1.992 Vali Loss: 3.301 Vali Acc: 0.138 Test Loss: 3.301 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6607885360717773
Epoch: 9, Steps: 10 | Train Loss: 1.707 Vali Loss: 3.264 Vali Acc: 0.175 Test Loss: 3.264 Test Acc: 0.175
Validation loss decreased (-0.168203 --> -0.175261).  Saving model ...
Epoch: 10 cost time: 1.6364455223083496
Epoch: 10, Steps: 10 | Train Loss: 1.467 Vali Loss: 3.326 Vali Acc: 0.167 Test Loss: 3.326 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6200416088104248
Epoch: 11, Steps: 10 | Train Loss: 1.311 Vali Loss: 3.303 Vali Acc: 0.208 Test Loss: 3.303 Test Acc: 0.208
Validation loss decreased (-0.175261 --> -0.208202).  Saving model ...
Epoch: 12 cost time: 1.8543853759765625
Epoch: 12, Steps: 10 | Train Loss: 0.977 Vali Loss: 3.329 Vali Acc: 0.195 Test Loss: 3.329 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8512866497039795
Epoch: 13, Steps: 10 | Train Loss: 0.770 Vali Loss: 3.407 Vali Acc: 0.186 Test Loss: 3.407 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6902074813842773
Epoch: 14, Steps: 10 | Train Loss: 0.597 Vali Loss: 3.453 Vali Acc: 0.212 Test Loss: 3.453 Test Acc: 0.212
Validation loss decreased (-0.208202 --> -0.211730).  Saving model ...
Epoch: 15 cost time: 1.836632490158081
Epoch: 15, Steps: 10 | Train Loss: 0.411 Vali Loss: 3.479 Vali Acc: 0.227 Test Loss: 3.479 Test Acc: 0.227
Validation loss decreased (-0.211730 --> -0.227024).  Saving model ...
Epoch: 16 cost time: 1.596595048904419
Epoch: 16, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.634 Vali Acc: 0.215 Test Loss: 3.634 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9474432468414307
Epoch: 17, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.655 Vali Acc: 0.232 Test Loss: 3.655 Test Acc: 0.232
Validation loss decreased (-0.227024 --> -0.231728).  Saving model ...
Epoch: 18 cost time: 2.4883105754852295
Epoch: 18, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.863 Vali Acc: 0.233 Test Loss: 3.863 Test Acc: 0.233
Validation loss decreased (-0.231728 --> -0.232903).  Saving model ...
Epoch: 19 cost time: 2.8308637142181396
Epoch: 19, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.155 Vali Acc: 0.226 Test Loss: 4.155 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.179124116897583
Epoch: 20, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.873 Vali Acc: 0.245 Test Loss: 3.873 Test Acc: 0.245
Validation loss decreased (-0.232903 --> -0.244667).  Saving model ...
Epoch: 21 cost time: 1.8492317199707031
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.890 Vali Acc: 0.253 Test Loss: 3.890 Test Acc: 0.253
Validation loss decreased (-0.244667 --> -0.252902).  Saving model ...
Epoch: 22 cost time: 1.7860145568847656
Epoch: 22, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.020 Vali Acc: 0.249 Test Loss: 4.020 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8891901969909668
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.108 Vali Acc: 0.247 Test Loss: 4.108 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0745911598205566
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.991 Vali Acc: 0.252 Test Loss: 3.991 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.022096872329712
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.134 Vali Acc: 0.255 Test Loss: 4.134 Test Acc: 0.255
Validation loss decreased (-0.252902 --> -0.255253).  Saving model ...
Epoch: 26 cost time: 1.9307138919830322
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.121 Vali Acc: 0.262 Test Loss: 4.121 Test Acc: 0.262
Validation loss decreased (-0.255253 --> -0.262312).  Saving model ...
Epoch: 27 cost time: 2.4204344749450684
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.095 Vali Acc: 0.266 Test Loss: 4.095 Test Acc: 0.266
Validation loss decreased (-0.262312 --> -0.265841).  Saving model ...
Epoch: 28 cost time: 1.9673337936401367
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.097 Vali Acc: 0.276 Test Loss: 4.097 Test Acc: 0.276
Validation loss decreased (-0.265841 --> -0.276430).  Saving model ...
Epoch: 29 cost time: 1.906846046447754
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.142 Vali Acc: 0.278 Test Loss: 4.142 Test Acc: 0.278
Validation loss decreased (-0.276430 --> -0.277606).  Saving model ...
Epoch: 30 cost time: 1.8533613681793213
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.166 Vali Acc: 0.282 Test Loss: 4.166 Test Acc: 0.282
Validation loss decreased (-0.277606 --> -0.282311).  Saving model ...
Epoch: 31 cost time: 1.9959783554077148
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.168 Vali Acc: 0.285 Test Loss: 4.168 Test Acc: 0.285
Validation loss decreased (-0.282311 --> -0.284664).  Saving model ...
Epoch: 32 cost time: 1.9940285682678223
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.166 Vali Acc: 0.280 Test Loss: 4.166 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9609622955322266
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.161 Vali Acc: 0.281 Test Loss: 4.161 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9353899955749512
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.166 Vali Acc: 0.282 Test Loss: 4.166 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.0206239223480225
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.179 Vali Acc: 0.285 Test Loss: 4.179 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.8636915683746338
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.190 Vali Acc: 0.284 Test Loss: 4.190 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.6134986877441406
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.219 Vali Acc: 0.280 Test Loss: 4.219 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.169746160507202
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.228 Vali Acc: 0.285 Test Loss: 4.228 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.5470852851867676
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.234 Vali Acc: 0.289 Test Loss: 4.234 Test Acc: 0.289
Validation loss decreased (-0.284664 --> -0.289369).  Saving model ...
Epoch: 40 cost time: 1.8329980373382568
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.239 Vali Acc: 0.286 Test Loss: 4.239 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9548299312591553
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.240 Vali Acc: 0.287 Test Loss: 4.240 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.712038278579712
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.252 Vali Acc: 0.291 Test Loss: 4.252 Test Acc: 0.291
Validation loss decreased (-0.289369 --> -0.290546).  Saving model ...
Epoch: 43 cost time: 1.859680414199829
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.257 Vali Acc: 0.287 Test Loss: 4.257 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.5680246353149414
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.268 Vali Acc: 0.287 Test Loss: 4.268 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.63746976852417
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.280 Vali Acc: 0.289 Test Loss: 4.280 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.1421608924865723
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.286 Vali Acc: 0.287 Test Loss: 4.286 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.06522798538208
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.291 Vali Acc: 0.287 Test Loss: 4.291 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.9909298419952393
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.296 Vali Acc: 0.285 Test Loss: 4.296 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.7743897438049316
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.297 Vali Acc: 0.287 Test Loss: 4.297 Test Acc: 0.287
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.382134437561035
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.304 Vali Acc: 0.282 Test Loss: 4.304 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.8948609828948975
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.315 Vali Acc: 0.285 Test Loss: 4.315 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.8699822425842285
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.321 Vali Acc: 0.285 Test Loss: 4.321 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 10775382
model size : 46.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.994247198104858
Epoch: 1, Steps: 10 | Train Loss: 3.367 Vali Loss: 3.365 Vali Acc: 0.026 Test Loss: 3.365 Test Acc: 0.026
Validation loss decreased (inf --> -0.025849).  Saving model ...
Epoch: 2 cost time: 2.06392240524292
Epoch: 2, Steps: 10 | Train Loss: 3.231 Vali Loss: 3.470 Vali Acc: 0.041 Test Loss: 3.470 Test Acc: 0.041
Validation loss decreased (-0.025849 --> -0.041142).  Saving model ...
Epoch: 3 cost time: 2.0266273021698
Epoch: 3, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.332 Vali Acc: 0.060 Test Loss: 3.332 Test Acc: 0.060
Validation loss decreased (-0.041142 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 2.1899521350860596
Epoch: 4, Steps: 10 | Train Loss: 2.969 Vali Loss: 3.290 Vali Acc: 0.088 Test Loss: 3.290 Test Acc: 0.088
Validation loss decreased (-0.059967 --> -0.088202).  Saving model ...
Epoch: 5 cost time: 1.7595973014831543
Epoch: 5, Steps: 10 | Train Loss: 2.674 Vali Loss: 3.351 Vali Acc: 0.080 Test Loss: 3.351 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9590685367584229
Epoch: 6, Steps: 10 | Train Loss: 2.470 Vali Loss: 3.262 Vali Acc: 0.138 Test Loss: 3.262 Test Acc: 0.138
Validation loss decreased (-0.088202 --> -0.137614).  Saving model ...
Epoch: 7 cost time: 1.9200997352600098
Epoch: 7, Steps: 10 | Train Loss: 2.210 Vali Loss: 3.324 Vali Acc: 0.125 Test Loss: 3.324 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9328815937042236
Epoch: 8, Steps: 10 | Train Loss: 1.917 Vali Loss: 3.297 Vali Acc: 0.168 Test Loss: 3.297 Test Acc: 0.168
Validation loss decreased (-0.137614 --> -0.168202).  Saving model ...
Epoch: 9 cost time: 2.2108540534973145
Epoch: 9, Steps: 10 | Train Loss: 1.680 Vali Loss: 3.315 Vali Acc: 0.171 Test Loss: 3.315 Test Acc: 0.171
Validation loss decreased (-0.168202 --> -0.170555).  Saving model ...
Epoch: 10 cost time: 1.9220130443572998
Epoch: 10, Steps: 10 | Train Loss: 1.392 Vali Loss: 3.258 Vali Acc: 0.201 Test Loss: 3.258 Test Acc: 0.201
Validation loss decreased (-0.170555 --> -0.201144).  Saving model ...
Epoch: 11 cost time: 1.8788669109344482
Epoch: 11, Steps: 10 | Train Loss: 1.146 Vali Loss: 3.300 Vali Acc: 0.194 Test Loss: 3.300 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8543274402618408
Epoch: 12, Steps: 10 | Train Loss: 1.018 Vali Loss: 3.379 Vali Acc: 0.207 Test Loss: 3.379 Test Acc: 0.207
Validation loss decreased (-0.201144 --> -0.207025).  Saving model ...
Epoch: 13 cost time: 1.832669973373413
Epoch: 13, Steps: 10 | Train Loss: 0.702 Vali Loss: 3.436 Vali Acc: 0.194 Test Loss: 3.436 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1145803928375244
Epoch: 14, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.423 Vali Acc: 0.200 Test Loss: 3.423 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1412980556488037
Epoch: 15, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.545 Vali Acc: 0.219 Test Loss: 3.545 Test Acc: 0.219
Validation loss decreased (-0.207025 --> -0.218788).  Saving model ...
Epoch: 16 cost time: 1.6123082637786865
Epoch: 16, Steps: 10 | Train Loss: 0.285 Vali Loss: 3.550 Vali Acc: 0.228 Test Loss: 3.550 Test Acc: 0.228
Validation loss decreased (-0.218788 --> -0.228200).  Saving model ...
Epoch: 17 cost time: 2.0612576007843018
Epoch: 17, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.764 Vali Acc: 0.226 Test Loss: 3.764 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.896752119064331
Epoch: 18, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.701 Vali Acc: 0.244 Test Loss: 3.701 Test Acc: 0.244
Validation loss decreased (-0.228200 --> -0.243492).  Saving model ...
Epoch: 19 cost time: 1.900162696838379
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.123 Vali Acc: 0.222 Test Loss: 4.123 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7708041667938232
Epoch: 20, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.016 Vali Acc: 0.225 Test Loss: 4.016 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7804040908813477
Epoch: 21, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.264 Vali Acc: 0.211 Test Loss: 4.264 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7554304599761963
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.195 Vali Acc: 0.227 Test Loss: 4.195 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8625576496124268
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.117 Vali Acc: 0.249 Test Loss: 4.117 Test Acc: 0.249
Validation loss decreased (-0.243492 --> -0.249371).  Saving model ...
Epoch: 24 cost time: 1.678480863571167
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.173 Vali Acc: 0.248 Test Loss: 4.173 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9842665195465088
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.277 Vali Acc: 0.248 Test Loss: 4.277 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.180342435836792
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.220 Vali Acc: 0.253 Test Loss: 4.220 Test Acc: 0.253
Validation loss decreased (-0.249371 --> -0.252899).  Saving model ...
Epoch: 27 cost time: 1.962284803390503
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.234 Vali Acc: 0.247 Test Loss: 4.234 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.254380941390991
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.276 Vali Acc: 0.255 Test Loss: 4.276 Test Acc: 0.255
Validation loss decreased (-0.252899 --> -0.255251).  Saving model ...
Epoch: 29 cost time: 2.047283172607422
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.289 Vali Acc: 0.259 Test Loss: 4.289 Test Acc: 0.259
Validation loss decreased (-0.255251 --> -0.258781).  Saving model ...
Epoch: 30 cost time: 1.970379114151001
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.298 Vali Acc: 0.261 Test Loss: 4.298 Test Acc: 0.261
Validation loss decreased (-0.258781 --> -0.261133).  Saving model ...
Epoch: 31 cost time: 2.081519842147827
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.315 Vali Acc: 0.254 Test Loss: 4.315 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6931250095367432
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.326 Vali Acc: 0.255 Test Loss: 4.326 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0284619331359863
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.333 Vali Acc: 0.259 Test Loss: 4.333 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.3373324871063232
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.345 Vali Acc: 0.260 Test Loss: 4.345 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.1653904914855957
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.357 Vali Acc: 0.265 Test Loss: 4.357 Test Acc: 0.265
Validation loss decreased (-0.261133 --> -0.264662).  Saving model ...
Epoch: 36 cost time: 2.0994362831115723
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.376 Vali Acc: 0.260 Test Loss: 4.376 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.0278220176696777
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.391 Vali Acc: 0.262 Test Loss: 4.391 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.8260548114776611
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.389 Vali Acc: 0.266 Test Loss: 4.389 Test Acc: 0.266
Validation loss decreased (-0.264662 --> -0.265838).  Saving model ...
Epoch: 39 cost time: 2.01867938041687
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.389 Vali Acc: 0.267 Test Loss: 4.389 Test Acc: 0.267
Validation loss decreased (-0.265838 --> -0.267015).  Saving model ...
Epoch: 40 cost time: 1.7762470245361328
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.402 Vali Acc: 0.265 Test Loss: 4.402 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.962799310684204
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.409 Vali Acc: 0.264 Test Loss: 4.409 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.867866039276123
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.426 Vali Acc: 0.261 Test Loss: 4.426 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.8646931648254395
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.427 Vali Acc: 0.266 Test Loss: 4.427 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.075327157974243
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.438 Vali Acc: 0.268 Test Loss: 4.438 Test Acc: 0.268
Validation loss decreased (-0.267015 --> -0.268191).  Saving model ...
Epoch: 45 cost time: 1.7273612022399902
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.442 Vali Acc: 0.265 Test Loss: 4.442 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.116086483001709
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.453 Vali Acc: 0.264 Test Loss: 4.453 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.7081382274627686
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.467 Vali Acc: 0.262 Test Loss: 4.467 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.919036865234375
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.472 Vali Acc: 0.265 Test Loss: 4.472 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.8037912845611572
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.478 Vali Acc: 0.264 Test Loss: 4.478 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.7827389240264893
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.482 Vali Acc: 0.264 Test Loss: 4.482 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.187258005142212
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.488 Vali Acc: 0.266 Test Loss: 4.488 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.8593831062316895
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.496 Vali Acc: 0.265 Test Loss: 4.496 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.0448474884033203
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.504 Vali Acc: 0.264 Test Loss: 4.504 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.6066420078277588
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.511 Vali Acc: 0.261 Test Loss: 4.511 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 10768726
model size : 46.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.640084743499756
Epoch: 1, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.355 Vali Acc: 0.039 Test Loss: 3.355 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.7705016136169434
Epoch: 2, Steps: 10 | Train Loss: 3.265 Vali Loss: 3.413 Vali Acc: 0.056 Test Loss: 3.413 Test Acc: 0.056
Validation loss decreased (-0.038790 --> -0.056436).  Saving model ...
Epoch: 3 cost time: 1.8399105072021484
Epoch: 3, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.337 Vali Acc: 0.068 Test Loss: 3.337 Test Acc: 0.068
Validation loss decreased (-0.056436 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 2.4426169395446777
Epoch: 4, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.293 Vali Acc: 0.074 Test Loss: 3.293 Test Acc: 0.074
Validation loss decreased (-0.068202 --> -0.074085).  Saving model ...
Epoch: 5 cost time: 1.8355095386505127
Epoch: 5, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.287 Vali Acc: 0.100 Test Loss: 3.287 Test Acc: 0.100
Validation loss decreased (-0.074085 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 2.217780113220215
Epoch: 6, Steps: 10 | Train Loss: 2.593 Vali Loss: 3.252 Vali Acc: 0.127 Test Loss: 3.252 Test Acc: 0.127
Validation loss decreased (-0.099967 --> -0.127026).  Saving model ...
Epoch: 7 cost time: 1.92368483543396
Epoch: 7, Steps: 10 | Train Loss: 2.173 Vali Loss: 3.228 Vali Acc: 0.156 Test Loss: 3.228 Test Acc: 0.156
Validation loss decreased (-0.127026 --> -0.156438).  Saving model ...
Epoch: 8 cost time: 1.7413530349731445
Epoch: 8, Steps: 10 | Train Loss: 1.914 Vali Loss: 3.295 Vali Acc: 0.167 Test Loss: 3.295 Test Acc: 0.167
Validation loss decreased (-0.156438 --> -0.167026).  Saving model ...
Epoch: 9 cost time: 1.7975974082946777
Epoch: 9, Steps: 10 | Train Loss: 1.631 Vali Loss: 3.368 Vali Acc: 0.180 Test Loss: 3.368 Test Acc: 0.180
Validation loss decreased (-0.167026 --> -0.179966).  Saving model ...
Epoch: 10 cost time: 1.8961849212646484
Epoch: 10, Steps: 10 | Train Loss: 1.401 Vali Loss: 3.362 Vali Acc: 0.172 Test Loss: 3.362 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.99320387840271
Epoch: 11, Steps: 10 | Train Loss: 1.153 Vali Loss: 3.291 Vali Acc: 0.206 Test Loss: 3.291 Test Acc: 0.206
Validation loss decreased (-0.179966 --> -0.205849).  Saving model ...
Epoch: 12 cost time: 2.121082067489624
Epoch: 12, Steps: 10 | Train Loss: 0.864 Vali Loss: 3.593 Vali Acc: 0.179 Test Loss: 3.593 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0451600551605225
Epoch: 13, Steps: 10 | Train Loss: 0.659 Vali Loss: 3.470 Vali Acc: 0.198 Test Loss: 3.470 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7044322490692139
Epoch: 14, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.576 Vali Acc: 0.196 Test Loss: 3.576 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.128592014312744
Epoch: 15, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.701 Vali Acc: 0.206 Test Loss: 3.701 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.815016508102417
Epoch: 16, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.712 Vali Acc: 0.214 Test Loss: 3.712 Test Acc: 0.214
Validation loss decreased (-0.205849 --> -0.214081).  Saving model ...
Epoch: 17 cost time: 1.9108848571777344
Epoch: 17, Steps: 10 | Train Loss: 0.227 Vali Loss: 4.052 Vali Acc: 0.189 Test Loss: 4.052 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8825061321258545
Epoch: 18, Steps: 10 | Train Loss: 0.165 Vali Loss: 4.018 Vali Acc: 0.209 Test Loss: 4.018 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1853673458099365
Epoch: 19, Steps: 10 | Train Loss: 0.120 Vali Loss: 4.365 Vali Acc: 0.200 Test Loss: 4.365 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.573901414871216
Epoch: 20, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.126 Vali Acc: 0.236 Test Loss: 4.126 Test Acc: 0.236
Validation loss decreased (-0.214081 --> -0.236429).  Saving model ...
Epoch: 21 cost time: 1.9148991107940674
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.101 Vali Acc: 0.239 Test Loss: 4.101 Test Acc: 0.239
Validation loss decreased (-0.236429 --> -0.238783).  Saving model ...
Epoch: 22 cost time: 2.1637258529663086
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.218 Vali Acc: 0.225 Test Loss: 4.218 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1531097888946533
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.332 Vali Acc: 0.233 Test Loss: 4.332 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.035305976867676
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.316 Vali Acc: 0.234 Test Loss: 4.316 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0346693992614746
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.364 Vali Acc: 0.242 Test Loss: 4.364 Test Acc: 0.242
Validation loss decreased (-0.238783 --> -0.242309).  Saving model ...
Epoch: 26 cost time: 2.064131259918213
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.381 Vali Acc: 0.248 Test Loss: 4.381 Test Acc: 0.248
Validation loss decreased (-0.242309 --> -0.248191).  Saving model ...
Epoch: 27 cost time: 2.3095993995666504
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.355 Vali Acc: 0.258 Test Loss: 4.355 Test Acc: 0.258
Validation loss decreased (-0.248191 --> -0.257604).  Saving model ...
Epoch: 28 cost time: 2.365955114364624
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.360 Vali Acc: 0.254 Test Loss: 4.360 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0059027671813965
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.384 Vali Acc: 0.253 Test Loss: 4.384 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.95709228515625
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.398 Vali Acc: 0.253 Test Loss: 4.398 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.17793345451355
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.406 Vali Acc: 0.258 Test Loss: 4.406 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.9319686889648438
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.410 Vali Acc: 0.259 Test Loss: 4.410 Test Acc: 0.259
Validation loss decreased (-0.257604 --> -0.258779).  Saving model ...
Epoch: 33 cost time: 1.8269801139831543
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.417 Vali Acc: 0.260 Test Loss: 4.417 Test Acc: 0.260
Validation loss decreased (-0.258779 --> -0.259956).  Saving model ...
Epoch: 34 cost time: 1.6103017330169678
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.423 Vali Acc: 0.259 Test Loss: 4.423 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8373119831085205
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.433 Vali Acc: 0.259 Test Loss: 4.433 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.3753485679626465
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.448 Vali Acc: 0.261 Test Loss: 4.448 Test Acc: 0.261
Validation loss decreased (-0.259956 --> -0.261132).  Saving model ...
Epoch: 37 cost time: 1.9390761852264404
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.451 Vali Acc: 0.265 Test Loss: 4.451 Test Acc: 0.265
Validation loss decreased (-0.261132 --> -0.264661).  Saving model ...
Epoch: 38 cost time: 2.0693466663360596
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.459 Vali Acc: 0.264 Test Loss: 4.459 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.2071640491485596
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.467 Vali Acc: 0.269 Test Loss: 4.467 Test Acc: 0.269
Validation loss decreased (-0.264661 --> -0.269367).  Saving model ...
Epoch: 40 cost time: 1.7982091903686523
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.484 Vali Acc: 0.264 Test Loss: 4.484 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.0206124782562256
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.494 Vali Acc: 0.262 Test Loss: 4.494 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8103272914886475
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.492 Vali Acc: 0.262 Test Loss: 4.492 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.9260339736938477
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.492 Vali Acc: 0.265 Test Loss: 4.492 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.8541650772094727
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.505 Vali Acc: 0.266 Test Loss: 4.505 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.2077860832214355
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.512 Vali Acc: 0.262 Test Loss: 4.512 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.8757719993591309
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.520 Vali Acc: 0.261 Test Loss: 4.520 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.9292385578155518
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.531 Vali Acc: 0.261 Test Loss: 4.531 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.7573976516723633
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.538 Vali Acc: 0.267 Test Loss: 4.538 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.023554801940918
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.539 Vali Acc: 0.262 Test Loss: 4.539 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 10762070
model size : 46.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.912210464477539
Epoch: 1, Steps: 10 | Train Loss: 3.370 Vali Loss: 3.337 Vali Acc: 0.035 Test Loss: 3.337 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 2.170846939086914
Epoch: 2, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.489 Vali Acc: 0.055 Test Loss: 3.489 Test Acc: 0.055
Validation loss decreased (-0.035261 --> -0.055259).  Saving model ...
Epoch: 3 cost time: 2.4521725177764893
Epoch: 3, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.336 Vali Acc: 0.081 Test Loss: 3.336 Test Acc: 0.081
Validation loss decreased (-0.055259 --> -0.081143).  Saving model ...
Epoch: 4 cost time: 2.2906360626220703
Epoch: 4, Steps: 10 | Train Loss: 3.104 Vali Loss: 3.270 Vali Acc: 0.073 Test Loss: 3.270 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.206956386566162
Epoch: 5, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.317 Vali Acc: 0.104 Test Loss: 3.317 Test Acc: 0.104
Validation loss decreased (-0.081143 --> -0.103496).  Saving model ...
Epoch: 6 cost time: 2.566894054412842
Epoch: 6, Steps: 10 | Train Loss: 2.639 Vali Loss: 3.286 Vali Acc: 0.114 Test Loss: 3.286 Test Acc: 0.114
Validation loss decreased (-0.103496 --> -0.114085).  Saving model ...
Epoch: 7 cost time: 2.529876232147217
Epoch: 7, Steps: 10 | Train Loss: 2.351 Vali Loss: 3.322 Vali Acc: 0.144 Test Loss: 3.322 Test Acc: 0.144
Validation loss decreased (-0.114085 --> -0.143496).  Saving model ...
Epoch: 8 cost time: 2.137695550918579
Epoch: 8, Steps: 10 | Train Loss: 1.963 Vali Loss: 3.303 Vali Acc: 0.151 Test Loss: 3.303 Test Acc: 0.151
Validation loss decreased (-0.143496 --> -0.150555).  Saving model ...
Epoch: 9 cost time: 2.1998963356018066
Epoch: 9, Steps: 10 | Train Loss: 1.751 Vali Loss: 3.368 Vali Acc: 0.148 Test Loss: 3.368 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8682198524475098
Epoch: 10, Steps: 10 | Train Loss: 1.481 Vali Loss: 3.323 Vali Acc: 0.182 Test Loss: 3.323 Test Acc: 0.182
Validation loss decreased (-0.150555 --> -0.182320).  Saving model ...
Epoch: 11 cost time: 1.9530360698699951
Epoch: 11, Steps: 10 | Train Loss: 1.213 Vali Loss: 3.389 Vali Acc: 0.171 Test Loss: 3.389 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3770687580108643
Epoch: 12, Steps: 10 | Train Loss: 1.049 Vali Loss: 3.429 Vali Acc: 0.180 Test Loss: 3.429 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6891162395477295
Epoch: 13, Steps: 10 | Train Loss: 0.796 Vali Loss: 3.529 Vali Acc: 0.188 Test Loss: 3.529 Test Acc: 0.188
Validation loss decreased (-0.182320 --> -0.188200).  Saving model ...
Epoch: 14 cost time: 2.3197689056396484
Epoch: 14, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.620 Vali Acc: 0.185 Test Loss: 3.620 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.930159330368042
Epoch: 15, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.681 Vali Acc: 0.205 Test Loss: 3.681 Test Acc: 0.205
Validation loss decreased (-0.188200 --> -0.204669).  Saving model ...
Epoch: 16 cost time: 2.2795865535736084
Epoch: 16, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.707 Vali Acc: 0.193 Test Loss: 3.707 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.019325017929077
Epoch: 17, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.777 Vali Acc: 0.201 Test Loss: 3.777 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1832501888275146
Epoch: 18, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.865 Vali Acc: 0.229 Test Loss: 3.865 Test Acc: 0.229
Validation loss decreased (-0.204669 --> -0.229373).  Saving model ...
Epoch: 19 cost time: 2.0772011280059814
Epoch: 19, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.957 Vali Acc: 0.231 Test Loss: 3.957 Test Acc: 0.231
Validation loss decreased (-0.229373 --> -0.230549).  Saving model ...
Epoch: 20 cost time: 1.9902393817901611
Epoch: 20, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.186 Vali Acc: 0.204 Test Loss: 4.186 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.388378620147705
Epoch: 21, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.153 Vali Acc: 0.238 Test Loss: 4.153 Test Acc: 0.238
Validation loss decreased (-0.230549 --> -0.237606).  Saving model ...
Epoch: 22 cost time: 1.9135518074035645
Epoch: 22, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.262 Vali Acc: 0.207 Test Loss: 4.262 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2341580390930176
Epoch: 23, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.205 Vali Acc: 0.234 Test Loss: 4.205 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2642767429351807
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.295 Vali Acc: 0.252 Test Loss: 4.295 Test Acc: 0.252
Validation loss decreased (-0.237606 --> -0.251722).  Saving model ...
Epoch: 25 cost time: 2.7655248641967773
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.229 Vali Acc: 0.245 Test Loss: 4.229 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1939761638641357
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.256 Vali Acc: 0.244 Test Loss: 4.256 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1796741485595703
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.176 Vali Acc: 0.260 Test Loss: 4.176 Test Acc: 0.260
Validation loss decreased (-0.251722 --> -0.259958).  Saving model ...
Epoch: 28 cost time: 2.890826940536499
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.380 Vali Acc: 0.241 Test Loss: 4.380 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1003689765930176
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.301 Vali Acc: 0.255 Test Loss: 4.301 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.1387710571289062
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.272 Vali Acc: 0.258 Test Loss: 4.272 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.1472885608673096
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.282 Vali Acc: 0.260 Test Loss: 4.282 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.411283016204834
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.294 Vali Acc: 0.261 Test Loss: 4.294 Test Acc: 0.261
Validation loss decreased (-0.259958 --> -0.261134).  Saving model ...
Epoch: 33 cost time: 2.3074450492858887
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.318 Vali Acc: 0.255 Test Loss: 4.318 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.234738349914551
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.336 Vali Acc: 0.260 Test Loss: 4.336 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.442769765853882
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.339 Vali Acc: 0.261 Test Loss: 4.339 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.2914698123931885
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.342 Vali Acc: 0.265 Test Loss: 4.342 Test Acc: 0.265
Validation loss decreased (-0.261134 --> -0.264662).  Saving model ...
Epoch: 37 cost time: 2.0258102416992188
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.353 Vali Acc: 0.264 Test Loss: 4.353 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.190847635269165
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.368 Vali Acc: 0.265 Test Loss: 4.368 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.3300774097442627
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.384 Vali Acc: 0.266 Test Loss: 4.384 Test Acc: 0.266
Validation loss decreased (-0.264662 --> -0.265839).  Saving model ...
Epoch: 40 cost time: 2.2710845470428467
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.396 Vali Acc: 0.265 Test Loss: 4.396 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.2797393798828125
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.404 Vali Acc: 0.265 Test Loss: 4.404 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.9757938385009766
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.409 Vali Acc: 0.261 Test Loss: 4.409 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.168843984603882
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.421 Vali Acc: 0.264 Test Loss: 4.421 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.6212043762207031
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.432 Vali Acc: 0.264 Test Loss: 4.432 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.0378706455230713
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.439 Vali Acc: 0.262 Test Loss: 4.439 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.204948663711548
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.445 Vali Acc: 0.265 Test Loss: 4.445 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.5180351734161377
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.447 Vali Acc: 0.265 Test Loss: 4.447 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.827390432357788
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.451 Vali Acc: 0.262 Test Loss: 4.451 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.417781352996826
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.451 Vali Acc: 0.266 Test Loss: 4.451 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 10191062
model size : 43.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.8742570877075195
Epoch: 1, Steps: 10 | Train Loss: 3.419 Vali Loss: 3.329 Vali Acc: 0.040 Test Loss: 3.329 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 2.2202987670898438
Epoch: 2, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.503 Vali Acc: 0.058 Test Loss: 3.503 Test Acc: 0.058
Validation loss decreased (-0.039967 --> -0.057612).  Saving model ...
Epoch: 3 cost time: 2.244776964187622
Epoch: 3, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.317 Vali Acc: 0.079 Test Loss: 3.317 Test Acc: 0.079
Validation loss decreased (-0.057612 --> -0.078790).  Saving model ...
Epoch: 4 cost time: 2.2226643562316895
Epoch: 4, Steps: 10 | Train Loss: 3.031 Vali Loss: 3.304 Vali Acc: 0.071 Test Loss: 3.304 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.11681866645813
Epoch: 5, Steps: 10 | Train Loss: 2.785 Vali Loss: 3.297 Vali Acc: 0.089 Test Loss: 3.297 Test Acc: 0.089
Validation loss decreased (-0.078790 --> -0.089379).  Saving model ...
Epoch: 6 cost time: 2.162616729736328
Epoch: 6, Steps: 10 | Train Loss: 2.529 Vali Loss: 3.303 Vali Acc: 0.107 Test Loss: 3.303 Test Acc: 0.107
Validation loss decreased (-0.089379 --> -0.107026).  Saving model ...
Epoch: 7 cost time: 2.044539451599121
Epoch: 7, Steps: 10 | Train Loss: 2.352 Vali Loss: 3.260 Vali Acc: 0.148 Test Loss: 3.260 Test Acc: 0.148
Validation loss decreased (-0.107026 --> -0.148203).  Saving model ...
Epoch: 8 cost time: 2.2518835067749023
Epoch: 8, Steps: 10 | Train Loss: 1.991 Vali Loss: 3.281 Vali Acc: 0.151 Test Loss: 3.281 Test Acc: 0.151
Validation loss decreased (-0.148203 --> -0.150555).  Saving model ...
Epoch: 9 cost time: 1.9041972160339355
Epoch: 9, Steps: 10 | Train Loss: 1.712 Vali Loss: 3.291 Vali Acc: 0.175 Test Loss: 3.291 Test Acc: 0.175
Validation loss decreased (-0.150555 --> -0.175261).  Saving model ...
Epoch: 10 cost time: 2.1050336360931396
Epoch: 10, Steps: 10 | Train Loss: 1.466 Vali Loss: 3.285 Vali Acc: 0.165 Test Loss: 3.285 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.079270601272583
Epoch: 11, Steps: 10 | Train Loss: 1.304 Vali Loss: 3.350 Vali Acc: 0.194 Test Loss: 3.350 Test Acc: 0.194
Validation loss decreased (-0.175261 --> -0.194084).  Saving model ...
Epoch: 12 cost time: 1.9726970195770264
Epoch: 12, Steps: 10 | Train Loss: 1.078 Vali Loss: 3.378 Vali Acc: 0.199 Test Loss: 3.378 Test Acc: 0.199
Validation loss decreased (-0.194084 --> -0.198790).  Saving model ...
Epoch: 13 cost time: 2.0429587364196777
Epoch: 13, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.412 Vali Acc: 0.202 Test Loss: 3.412 Test Acc: 0.202
Validation loss decreased (-0.198790 --> -0.202319).  Saving model ...
Epoch: 14 cost time: 1.8720357418060303
Epoch: 14, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.406 Vali Acc: 0.234 Test Loss: 3.406 Test Acc: 0.234
Validation loss decreased (-0.202319 --> -0.234084).  Saving model ...
Epoch: 15 cost time: 2.0543036460876465
Epoch: 15, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.593 Vali Acc: 0.193 Test Loss: 3.593 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9979853630065918
Epoch: 16, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.645 Vali Acc: 0.235 Test Loss: 3.645 Test Acc: 0.235
Validation loss decreased (-0.234084 --> -0.235258).  Saving model ...
Epoch: 17 cost time: 2.2859160900115967
Epoch: 17, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.680 Vali Acc: 0.224 Test Loss: 3.680 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.253803253173828
Epoch: 18, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.759 Vali Acc: 0.232 Test Loss: 3.759 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0319652557373047
Epoch: 19, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.765 Vali Acc: 0.238 Test Loss: 3.765 Test Acc: 0.238
Validation loss decreased (-0.235258 --> -0.237609).  Saving model ...
Epoch: 20 cost time: 2.109872341156006
Epoch: 20, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.972 Vali Acc: 0.226 Test Loss: 3.972 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9300510883331299
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.939 Vali Acc: 0.246 Test Loss: 3.939 Test Acc: 0.246
Validation loss decreased (-0.237609 --> -0.245843).  Saving model ...
Epoch: 22 cost time: 1.9400768280029297
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.061 Vali Acc: 0.249 Test Loss: 4.061 Test Acc: 0.249
Validation loss decreased (-0.245843 --> -0.249371).  Saving model ...
Epoch: 23 cost time: 1.7344307899475098
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.590 Vali Acc: 0.182 Test Loss: 4.590 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.112820625305176
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.139 Vali Acc: 0.236 Test Loss: 4.139 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8931884765625
Epoch: 25, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.285 Vali Acc: 0.229 Test Loss: 4.285 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.177440643310547
Epoch: 26, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.364 Vali Acc: 0.219 Test Loss: 4.364 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.289999485015869
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.294 Vali Acc: 0.236 Test Loss: 4.294 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0130484104156494
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.173 Vali Acc: 0.262 Test Loss: 4.173 Test Acc: 0.262
Validation loss decreased (-0.249371 --> -0.262311).  Saving model ...
Epoch: 29 cost time: 1.6464006900787354
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.258 Vali Acc: 0.269 Test Loss: 4.258 Test Acc: 0.269
Validation loss decreased (-0.262311 --> -0.269369).  Saving model ...
Epoch: 30 cost time: 1.705461025238037
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.235 Vali Acc: 0.268 Test Loss: 4.235 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9701507091522217
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.246 Vali Acc: 0.264 Test Loss: 4.246 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8799047470092773
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.269 Vali Acc: 0.266 Test Loss: 4.269 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.30184268951416
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.283 Vali Acc: 0.267 Test Loss: 4.283 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.0138120651245117
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.296 Vali Acc: 0.273 Test Loss: 4.296 Test Acc: 0.273
Validation loss decreased (-0.269369 --> -0.272898).  Saving model ...
Epoch: 35 cost time: 2.0244665145874023
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.319 Vali Acc: 0.274 Test Loss: 4.319 Test Acc: 0.274
Validation loss decreased (-0.272898 --> -0.274074).  Saving model ...
Epoch: 36 cost time: 2.1174941062927246
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.334 Vali Acc: 0.271 Test Loss: 4.334 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.9905030727386475
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.347 Vali Acc: 0.269 Test Loss: 4.347 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.9519293308258057
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.356 Vali Acc: 0.271 Test Loss: 4.356 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.517761468887329
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.362 Vali Acc: 0.269 Test Loss: 4.362 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.9560565948486328
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.373 Vali Acc: 0.269 Test Loss: 4.373 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.0020809173583984
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.382 Vali Acc: 0.272 Test Loss: 4.382 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.318709135055542
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.389 Vali Acc: 0.276 Test Loss: 4.389 Test Acc: 0.276
Validation loss decreased (-0.274074 --> -0.276427).  Saving model ...
Epoch: 43 cost time: 2.294098377227783
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.400 Vali Acc: 0.274 Test Loss: 4.400 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.1547131538391113
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.416 Vali Acc: 0.274 Test Loss: 4.416 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.0227558612823486
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.426 Vali Acc: 0.275 Test Loss: 4.426 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.8057734966278076
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.433 Vali Acc: 0.274 Test Loss: 4.433 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.2057015895843506
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.437 Vali Acc: 0.273 Test Loss: 4.437 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.0742506980895996
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.441 Vali Acc: 0.267 Test Loss: 4.441 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.221367359161377
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.447 Vali Acc: 0.268 Test Loss: 4.447 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.5037620067596436
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.467 Vali Acc: 0.267 Test Loss: 4.467 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 2.425630807876587
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.475 Vali Acc: 0.267 Test Loss: 4.475 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 2.2772598266601562
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.476 Vali Acc: 0.266 Test Loss: 4.476 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 10184406
model size : 43.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.106358528137207
Epoch: 1, Steps: 10 | Train Loss: 3.450 Vali Loss: 3.327 Vali Acc: 0.041 Test Loss: 3.327 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 2.3285694122314453
Epoch: 2, Steps: 10 | Train Loss: 3.303 Vali Loss: 3.478 Vali Acc: 0.051 Test Loss: 3.478 Test Acc: 0.051
Validation loss decreased (-0.041143 --> -0.050553).  Saving model ...
Epoch: 3 cost time: 2.1189215183258057
Epoch: 3, Steps: 10 | Train Loss: 3.226 Vali Loss: 3.355 Vali Acc: 0.041 Test Loss: 3.355 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.505944013595581
Epoch: 4, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.275 Vali Acc: 0.108 Test Loss: 3.275 Test Acc: 0.108
Validation loss decreased (-0.050553 --> -0.108203).  Saving model ...
Epoch: 5 cost time: 2.6594605445861816
Epoch: 5, Steps: 10 | Train Loss: 2.895 Vali Loss: 3.303 Vali Acc: 0.087 Test Loss: 3.303 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.288750410079956
Epoch: 6, Steps: 10 | Train Loss: 2.627 Vali Loss: 3.322 Vali Acc: 0.118 Test Loss: 3.322 Test Acc: 0.118
Validation loss decreased (-0.108203 --> -0.117614).  Saving model ...
Epoch: 7 cost time: 2.447330951690674
Epoch: 7, Steps: 10 | Train Loss: 2.313 Vali Loss: 3.219 Vali Acc: 0.144 Test Loss: 3.219 Test Acc: 0.144
Validation loss decreased (-0.117614 --> -0.143497).  Saving model ...
Epoch: 8 cost time: 2.2514708042144775
Epoch: 8, Steps: 10 | Train Loss: 1.976 Vali Loss: 3.299 Vali Acc: 0.139 Test Loss: 3.299 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1180787086486816
Epoch: 9, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.336 Vali Acc: 0.148 Test Loss: 3.336 Test Acc: 0.148
Validation loss decreased (-0.143497 --> -0.148202).  Saving model ...
Epoch: 10 cost time: 2.331660032272339
Epoch: 10, Steps: 10 | Train Loss: 1.509 Vali Loss: 3.253 Vali Acc: 0.193 Test Loss: 3.253 Test Acc: 0.193
Validation loss decreased (-0.148202 --> -0.192909).  Saving model ...
Epoch: 11 cost time: 2.1214029788970947
Epoch: 11, Steps: 10 | Train Loss: 1.354 Vali Loss: 3.271 Vali Acc: 0.191 Test Loss: 3.271 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.253649950027466
Epoch: 12, Steps: 10 | Train Loss: 1.025 Vali Loss: 3.344 Vali Acc: 0.196 Test Loss: 3.344 Test Acc: 0.196
Validation loss decreased (-0.192909 --> -0.196437).  Saving model ...
Epoch: 13 cost time: 2.016770839691162
Epoch: 13, Steps: 10 | Train Loss: 0.790 Vali Loss: 3.367 Vali Acc: 0.215 Test Loss: 3.367 Test Acc: 0.215
Validation loss decreased (-0.196437 --> -0.215260).  Saving model ...
Epoch: 14 cost time: 2.153704881668091
Epoch: 14, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.382 Vali Acc: 0.211 Test Loss: 3.382 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.146176815032959
Epoch: 15, Steps: 10 | Train Loss: 0.466 Vali Loss: 3.533 Vali Acc: 0.218 Test Loss: 3.533 Test Acc: 0.218
Validation loss decreased (-0.215260 --> -0.217612).  Saving model ...
Epoch: 16 cost time: 2.4143855571746826
Epoch: 16, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.685 Vali Acc: 0.206 Test Loss: 3.685 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.103886604309082
Epoch: 17, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.655 Vali Acc: 0.238 Test Loss: 3.655 Test Acc: 0.238
Validation loss decreased (-0.217612 --> -0.237611).  Saving model ...
Epoch: 18 cost time: 2.4395699501037598
Epoch: 18, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.896 Vali Acc: 0.220 Test Loss: 3.896 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.929598331451416
Epoch: 19, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.083 Vali Acc: 0.213 Test Loss: 4.083 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.132424831390381
Epoch: 20, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.028 Vali Acc: 0.251 Test Loss: 4.028 Test Acc: 0.251
Validation loss decreased (-0.237611 --> -0.250548).  Saving model ...
Epoch: 21 cost time: 2.630880117416382
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.011 Vali Acc: 0.251 Test Loss: 4.011 Test Acc: 0.251
Validation loss decreased (-0.250548 --> -0.250548).  Saving model ...
Epoch: 22 cost time: 2.436387538909912
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.041 Vali Acc: 0.252 Test Loss: 4.041 Test Acc: 0.252
Validation loss decreased (-0.250548 --> -0.251724).  Saving model ...
Epoch: 23 cost time: 2.504915237426758
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.099 Vali Acc: 0.276 Test Loss: 4.099 Test Acc: 0.276
Validation loss decreased (-0.251724 --> -0.276430).  Saving model ...
Epoch: 24 cost time: 1.6796672344207764
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.106 Vali Acc: 0.262 Test Loss: 4.106 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3400156497955322
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.175 Vali Acc: 0.259 Test Loss: 4.175 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.132068157196045
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.190 Vali Acc: 0.267 Test Loss: 4.190 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.064361333847046
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.215 Vali Acc: 0.266 Test Loss: 4.215 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1824123859405518
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.217 Vali Acc: 0.271 Test Loss: 4.217 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.176279067993164
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.204 Vali Acc: 0.269 Test Loss: 4.204 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.1961023807525635
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.228 Vali Acc: 0.271 Test Loss: 4.228 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.45733904838562
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.247 Vali Acc: 0.273 Test Loss: 4.247 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.1399025917053223
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.255 Vali Acc: 0.273 Test Loss: 4.255 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.2096285820007324
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.278 Vali Acc: 0.272 Test Loss: 4.278 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 10177750
model size : 43.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.234642744064331
Epoch: 1, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.344 Vali Acc: 0.035 Test Loss: 3.344 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 1.9966633319854736
Epoch: 2, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.413 Vali Acc: 0.052 Test Loss: 3.413 Test Acc: 0.052
Validation loss decreased (-0.035261 --> -0.051731).  Saving model ...
Epoch: 3 cost time: 1.991830587387085
Epoch: 3, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.311 Vali Acc: 0.064 Test Loss: 3.311 Test Acc: 0.064
Validation loss decreased (-0.051731 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 2.521360158920288
Epoch: 4, Steps: 10 | Train Loss: 3.048 Vali Loss: 3.313 Vali Acc: 0.093 Test Loss: 3.313 Test Acc: 0.093
Validation loss decreased (-0.063496 --> -0.092908).  Saving model ...
Epoch: 5 cost time: 2.43127703666687
Epoch: 5, Steps: 10 | Train Loss: 2.836 Vali Loss: 3.274 Vali Acc: 0.114 Test Loss: 3.274 Test Acc: 0.114
Validation loss decreased (-0.092908 --> -0.114085).  Saving model ...
Epoch: 6 cost time: 2.0257999897003174
Epoch: 6, Steps: 10 | Train Loss: 2.545 Vali Loss: 3.321 Vali Acc: 0.111 Test Loss: 3.321 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3422861099243164
Epoch: 7, Steps: 10 | Train Loss: 2.255 Vali Loss: 3.312 Vali Acc: 0.142 Test Loss: 3.312 Test Acc: 0.142
Validation loss decreased (-0.114085 --> -0.142320).  Saving model ...
Epoch: 8 cost time: 2.176159381866455
Epoch: 8, Steps: 10 | Train Loss: 2.026 Vali Loss: 3.297 Vali Acc: 0.156 Test Loss: 3.297 Test Acc: 0.156
Validation loss decreased (-0.142320 --> -0.156438).  Saving model ...
Epoch: 9 cost time: 2.0130550861358643
Epoch: 9, Steps: 10 | Train Loss: 1.726 Vali Loss: 3.258 Vali Acc: 0.162 Test Loss: 3.258 Test Acc: 0.162
Validation loss decreased (-0.156438 --> -0.162320).  Saving model ...
Epoch: 10 cost time: 2.011052131652832
Epoch: 10, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.355 Vali Acc: 0.169 Test Loss: 3.355 Test Acc: 0.169
Validation loss decreased (-0.162320 --> -0.169378).  Saving model ...
Epoch: 11 cost time: 2.136425256729126
Epoch: 11, Steps: 10 | Train Loss: 1.336 Vali Loss: 3.326 Vali Acc: 0.187 Test Loss: 3.326 Test Acc: 0.187
Validation loss decreased (-0.169378 --> -0.187026).  Saving model ...
Epoch: 12 cost time: 2.1400961875915527
Epoch: 12, Steps: 10 | Train Loss: 0.948 Vali Loss: 3.263 Vali Acc: 0.202 Test Loss: 3.263 Test Acc: 0.202
Validation loss decreased (-0.187026 --> -0.202320).  Saving model ...
Epoch: 13 cost time: 3.1820147037506104
Epoch: 13, Steps: 10 | Train Loss: 0.770 Vali Loss: 3.370 Vali Acc: 0.196 Test Loss: 3.370 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7337162494659424
Epoch: 14, Steps: 10 | Train Loss: 0.594 Vali Loss: 3.400 Vali Acc: 0.225 Test Loss: 3.400 Test Acc: 0.225
Validation loss decreased (-0.202320 --> -0.224672).  Saving model ...
Epoch: 15 cost time: 2.15680193901062
Epoch: 15, Steps: 10 | Train Loss: 0.470 Vali Loss: 3.372 Vali Acc: 0.253 Test Loss: 3.372 Test Acc: 0.253
Validation loss decreased (-0.224672 --> -0.252907).  Saving model ...
Epoch: 16 cost time: 2.2894821166992188
Epoch: 16, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.490 Vali Acc: 0.222 Test Loss: 3.490 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4205334186553955
Epoch: 17, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.599 Vali Acc: 0.233 Test Loss: 3.599 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0290186405181885
Epoch: 18, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.759 Vali Acc: 0.251 Test Loss: 3.759 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3116514682769775
Epoch: 19, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.782 Vali Acc: 0.242 Test Loss: 3.782 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9393715858459473
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.757 Vali Acc: 0.252 Test Loss: 3.757 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.3852362632751465
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.995 Vali Acc: 0.233 Test Loss: 3.995 Test Acc: 0.233
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9418079853057861
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.005 Vali Acc: 0.258 Test Loss: 4.005 Test Acc: 0.258
Validation loss decreased (-0.252907 --> -0.257607).  Saving model ...
Epoch: 23 cost time: 2.0353832244873047
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.055 Vali Acc: 0.240 Test Loss: 4.055 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.04263973236084
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.055 Vali Acc: 0.266 Test Loss: 4.055 Test Acc: 0.266
Validation loss decreased (-0.257607 --> -0.265842).  Saving model ...
Epoch: 25 cost time: 2.549699068069458
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.108 Vali Acc: 0.269 Test Loss: 4.108 Test Acc: 0.269
Validation loss decreased (-0.265842 --> -0.269371).  Saving model ...
Epoch: 26 cost time: 2.0331852436065674
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.114 Vali Acc: 0.266 Test Loss: 4.114 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2497143745422363
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.122 Vali Acc: 0.271 Test Loss: 4.122 Test Acc: 0.271
Validation loss decreased (-0.269371 --> -0.270547).  Saving model ...
Epoch: 28 cost time: 2.417775869369507
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.107 Vali Acc: 0.267 Test Loss: 4.107 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9867684841156006
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.120 Vali Acc: 0.269 Test Loss: 4.120 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.5463626384735107
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.154 Vali Acc: 0.278 Test Loss: 4.154 Test Acc: 0.278
Validation loss decreased (-0.270547 --> -0.277606).  Saving model ...
Epoch: 31 cost time: 1.6728253364562988
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.178 Vali Acc: 0.274 Test Loss: 4.178 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.956115484237671
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.176 Vali Acc: 0.280 Test Loss: 4.176 Test Acc: 0.280
Validation loss decreased (-0.277606 --> -0.279958).  Saving model ...
Epoch: 33 cost time: 1.7249152660369873
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.187 Vali Acc: 0.276 Test Loss: 4.187 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.2954516410827637
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.216 Vali Acc: 0.272 Test Loss: 4.216 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.1355888843536377
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.231 Vali Acc: 0.275 Test Loss: 4.231 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.3969779014587402
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.232 Vali Acc: 0.276 Test Loss: 4.232 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.4710166454315186
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.255 Vali Acc: 0.279 Test Loss: 4.255 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.3328075408935547
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.267 Vali Acc: 0.278 Test Loss: 4.267 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.6279304027557373
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.262 Vali Acc: 0.278 Test Loss: 4.262 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.410754680633545
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.265 Vali Acc: 0.280 Test Loss: 4.265 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.1074681282043457
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.289 Vali Acc: 0.278 Test Loss: 4.289 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.201491594314575
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.297 Vali Acc: 0.275 Test Loss: 4.297 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 10171094
model size : 43.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.239405632019043
Epoch: 1, Steps: 10 | Train Loss: 3.440 Vali Loss: 3.320 Vali Acc: 0.022 Test Loss: 3.320 Test Acc: 0.022
Validation loss decreased (inf --> -0.022320).  Saving model ...
Epoch: 2 cost time: 2.193706750869751
Epoch: 2, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.395 Vali Acc: 0.029 Test Loss: 3.395 Test Acc: 0.029
Validation loss decreased (-0.022320 --> -0.029378).  Saving model ...
Epoch: 3 cost time: 1.7742714881896973
Epoch: 3, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.415 Vali Acc: 0.049 Test Loss: 3.415 Test Acc: 0.049
Validation loss decreased (-0.029378 --> -0.049378).  Saving model ...
Epoch: 4 cost time: 2.0728931427001953
Epoch: 4, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.327 Vali Acc: 0.072 Test Loss: 3.327 Test Acc: 0.072
Validation loss decreased (-0.049378 --> -0.071731).  Saving model ...
Epoch: 5 cost time: 2.3226370811462402
Epoch: 5, Steps: 10 | Train Loss: 2.960 Vali Loss: 3.269 Vali Acc: 0.085 Test Loss: 3.269 Test Acc: 0.085
Validation loss decreased (-0.071731 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 2.0702688694000244
Epoch: 6, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.279 Vali Acc: 0.094 Test Loss: 3.279 Test Acc: 0.094
Validation loss decreased (-0.084673 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 1.9884560108184814
Epoch: 7, Steps: 10 | Train Loss: 2.573 Vali Loss: 3.277 Vali Acc: 0.112 Test Loss: 3.277 Test Acc: 0.112
Validation loss decreased (-0.094085 --> -0.111732).  Saving model ...
Epoch: 8 cost time: 2.0396499633789062
Epoch: 8, Steps: 10 | Train Loss: 2.391 Vali Loss: 3.231 Vali Acc: 0.135 Test Loss: 3.231 Test Acc: 0.135
Validation loss decreased (-0.111732 --> -0.135262).  Saving model ...
Epoch: 9 cost time: 1.7533955574035645
Epoch: 9, Steps: 10 | Train Loss: 2.167 Vali Loss: 3.241 Vali Acc: 0.144 Test Loss: 3.241 Test Acc: 0.144
Validation loss decreased (-0.135262 --> -0.143497).  Saving model ...
Epoch: 10 cost time: 2.3581249713897705
Epoch: 10, Steps: 10 | Train Loss: 1.942 Vali Loss: 3.277 Vali Acc: 0.145 Test Loss: 3.277 Test Acc: 0.145
Validation loss decreased (-0.143497 --> -0.144673).  Saving model ...
Epoch: 11 cost time: 1.9616005420684814
Epoch: 11, Steps: 10 | Train Loss: 1.726 Vali Loss: 3.224 Vali Acc: 0.161 Test Loss: 3.224 Test Acc: 0.161
Validation loss decreased (-0.144673 --> -0.161144).  Saving model ...
Epoch: 12 cost time: 1.8369927406311035
Epoch: 12, Steps: 10 | Train Loss: 1.515 Vali Loss: 3.226 Vali Acc: 0.188 Test Loss: 3.226 Test Acc: 0.188
Validation loss decreased (-0.161144 --> -0.188203).  Saving model ...
Epoch: 13 cost time: 2.1553921699523926
Epoch: 13, Steps: 10 | Train Loss: 1.291 Vali Loss: 3.179 Vali Acc: 0.193 Test Loss: 3.179 Test Acc: 0.193
Validation loss decreased (-0.188203 --> -0.192909).  Saving model ...
Epoch: 14 cost time: 1.8988049030303955
Epoch: 14, Steps: 10 | Train Loss: 1.165 Vali Loss: 3.188 Vali Acc: 0.195 Test Loss: 3.188 Test Acc: 0.195
Validation loss decreased (-0.192909 --> -0.195262).  Saving model ...
Epoch: 15 cost time: 2.3242790699005127
Epoch: 15, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.207 Vali Acc: 0.219 Test Loss: 3.207 Test Acc: 0.219
Validation loss decreased (-0.195262 --> -0.218791).  Saving model ...
Epoch: 16 cost time: 2.023921489715576
Epoch: 16, Steps: 10 | Train Loss: 0.854 Vali Loss: 3.211 Vali Acc: 0.194 Test Loss: 3.211 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.674880027770996
Epoch: 17, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.249 Vali Acc: 0.221 Test Loss: 3.249 Test Acc: 0.221
Validation loss decreased (-0.218791 --> -0.221144).  Saving model ...
Epoch: 18 cost time: 2.3489983081817627
Epoch: 18, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.242 Vali Acc: 0.228 Test Loss: 3.242 Test Acc: 0.228
Validation loss decreased (-0.221144 --> -0.228203).  Saving model ...
Epoch: 19 cost time: 1.8649141788482666
Epoch: 19, Steps: 10 | Train Loss: 0.509 Vali Loss: 3.422 Vali Acc: 0.204 Test Loss: 3.422 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.133028507232666
Epoch: 20, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.383 Vali Acc: 0.236 Test Loss: 3.383 Test Acc: 0.236
Validation loss decreased (-0.228203 --> -0.236437).  Saving model ...
Epoch: 21 cost time: 2.5969250202178955
Epoch: 21, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.449 Vali Acc: 0.216 Test Loss: 3.449 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6129539012908936
Epoch: 22, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.444 Vali Acc: 0.238 Test Loss: 3.444 Test Acc: 0.238
Validation loss decreased (-0.236437 --> -0.237613).  Saving model ...
Epoch: 23 cost time: 1.8510422706604004
Epoch: 23, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.550 Vali Acc: 0.228 Test Loss: 3.550 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3418002128601074
Epoch: 24, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.577 Vali Acc: 0.235 Test Loss: 3.577 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.114765167236328
Epoch: 25, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.710 Vali Acc: 0.209 Test Loss: 3.710 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.0925772190093994
Epoch: 26, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.688 Vali Acc: 0.245 Test Loss: 3.688 Test Acc: 0.245
Validation loss decreased (-0.237613 --> -0.244669).  Saving model ...
Epoch: 27 cost time: 1.8244962692260742
Epoch: 27, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.561 Vali Acc: 0.255 Test Loss: 3.561 Test Acc: 0.255
Validation loss decreased (-0.244669 --> -0.255259).  Saving model ...
Epoch: 28 cost time: 2.183267831802368
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.776 Vali Acc: 0.249 Test Loss: 3.776 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.333239793777466
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.740 Vali Acc: 0.258 Test Loss: 3.740 Test Acc: 0.258
Validation loss decreased (-0.255259 --> -0.257610).  Saving model ...
Epoch: 30 cost time: 2.3465492725372314
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.762 Vali Acc: 0.266 Test Loss: 3.762 Test Acc: 0.266
Validation loss decreased (-0.257610 --> -0.265845).  Saving model ...
Epoch: 31 cost time: 2.0953454971313477
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.757 Vali Acc: 0.260 Test Loss: 3.757 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.5105059146881104
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.809 Vali Acc: 0.254 Test Loss: 3.809 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.2502670288085938
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.812 Vali Acc: 0.264 Test Loss: 3.812 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.0521256923675537
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.831 Vali Acc: 0.272 Test Loss: 3.831 Test Acc: 0.272
Validation loss decreased (-0.265845 --> -0.271726).  Saving model ...
Epoch: 35 cost time: 2.0204989910125732
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.844 Vali Acc: 0.265 Test Loss: 3.844 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.1146371364593506
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.848 Vali Acc: 0.264 Test Loss: 3.848 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8718655109405518
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.866 Vali Acc: 0.265 Test Loss: 3.866 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.1737771034240723
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.882 Vali Acc: 0.268 Test Loss: 3.882 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.031156539916992
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.880 Vali Acc: 0.269 Test Loss: 3.880 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.7603671550750732
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.868 Vali Acc: 0.265 Test Loss: 3.868 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.4172489643096924
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.895 Vali Acc: 0.269 Test Loss: 3.895 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.2877440452575684
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.897 Vali Acc: 0.272 Test Loss: 3.897 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.000112295150757
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.906 Vali Acc: 0.268 Test Loss: 3.906 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.3012561798095703
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.931 Vali Acc: 0.267 Test Loss: 3.931 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 4809302
model size : 20.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.503687381744385
Epoch: 1, Steps: 10 | Train Loss: 3.449 Vali Loss: 3.335 Vali Acc: 0.054 Test Loss: 3.335 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 2.181959629058838
Epoch: 2, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.475 Vali Acc: 0.036 Test Loss: 3.475 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7396702766418457
Epoch: 3, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.364 Vali Acc: 0.068 Test Loss: 3.364 Test Acc: 0.068
Validation loss decreased (-0.054084 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 2.534926176071167
Epoch: 4, Steps: 10 | Train Loss: 3.089 Vali Loss: 3.329 Vali Acc: 0.086 Test Loss: 3.329 Test Acc: 0.086
Validation loss decreased (-0.068202 --> -0.085849).  Saving model ...
Epoch: 5 cost time: 2.16182279586792
Epoch: 5, Steps: 10 | Train Loss: 2.915 Vali Loss: 3.323 Vali Acc: 0.087 Test Loss: 3.323 Test Acc: 0.087
Validation loss decreased (-0.085849 --> -0.087026).  Saving model ...
Epoch: 6 cost time: 1.727940559387207
Epoch: 6, Steps: 10 | Train Loss: 2.737 Vali Loss: 3.303 Vali Acc: 0.121 Test Loss: 3.303 Test Acc: 0.121
Validation loss decreased (-0.087026 --> -0.121143).  Saving model ...
Epoch: 7 cost time: 1.8050944805145264
Epoch: 7, Steps: 10 | Train Loss: 2.445 Vali Loss: 3.278 Vali Acc: 0.121 Test Loss: 3.278 Test Acc: 0.121
Validation loss decreased (-0.121143 --> -0.121144).  Saving model ...
Epoch: 8 cost time: 1.951338291168213
Epoch: 8, Steps: 10 | Train Loss: 2.350 Vali Loss: 3.276 Vali Acc: 0.140 Test Loss: 3.276 Test Acc: 0.140
Validation loss decreased (-0.121144 --> -0.139967).  Saving model ...
Epoch: 9 cost time: 1.7064027786254883
Epoch: 9, Steps: 10 | Train Loss: 2.108 Vali Loss: 3.239 Vali Acc: 0.146 Test Loss: 3.239 Test Acc: 0.146
Validation loss decreased (-0.139967 --> -0.145850).  Saving model ...
Epoch: 10 cost time: 2.1041181087493896
Epoch: 10, Steps: 10 | Train Loss: 1.876 Vali Loss: 3.251 Vali Acc: 0.156 Test Loss: 3.251 Test Acc: 0.156
Validation loss decreased (-0.145850 --> -0.156438).  Saving model ...
Epoch: 11 cost time: 1.8360707759857178
Epoch: 11, Steps: 10 | Train Loss: 1.757 Vali Loss: 3.252 Vali Acc: 0.158 Test Loss: 3.252 Test Acc: 0.158
Validation loss decreased (-0.156438 --> -0.157615).  Saving model ...
Epoch: 12 cost time: 2.040814161300659
Epoch: 12, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.237 Vali Acc: 0.169 Test Loss: 3.237 Test Acc: 0.169
Validation loss decreased (-0.157615 --> -0.169379).  Saving model ...
Epoch: 13 cost time: 1.653998851776123
Epoch: 13, Steps: 10 | Train Loss: 1.374 Vali Loss: 3.227 Vali Acc: 0.174 Test Loss: 3.227 Test Acc: 0.174
Validation loss decreased (-0.169379 --> -0.174085).  Saving model ...
Epoch: 14 cost time: 2.1100573539733887
Epoch: 14, Steps: 10 | Train Loss: 1.160 Vali Loss: 3.216 Vali Acc: 0.195 Test Loss: 3.216 Test Acc: 0.195
Validation loss decreased (-0.174085 --> -0.195262).  Saving model ...
Epoch: 15 cost time: 2.038952112197876
Epoch: 15, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.165 Vali Acc: 0.219 Test Loss: 3.165 Test Acc: 0.219
Validation loss decreased (-0.195262 --> -0.218792).  Saving model ...
Epoch: 16 cost time: 2.1102590560913086
Epoch: 16, Steps: 10 | Train Loss: 0.872 Vali Loss: 3.300 Vali Acc: 0.193 Test Loss: 3.300 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.029507637023926
Epoch: 17, Steps: 10 | Train Loss: 0.741 Vali Loss: 3.288 Vali Acc: 0.201 Test Loss: 3.288 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6139726638793945
Epoch: 18, Steps: 10 | Train Loss: 0.628 Vali Loss: 3.249 Vali Acc: 0.206 Test Loss: 3.249 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9704794883728027
Epoch: 19, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.236 Vali Acc: 0.204 Test Loss: 3.236 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9341681003570557
Epoch: 20, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.441 Vali Acc: 0.216 Test Loss: 3.441 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.3577797412872314
Epoch: 21, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.471 Vali Acc: 0.205 Test Loss: 3.471 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.129697799682617
Epoch: 22, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.345 Vali Acc: 0.236 Test Loss: 3.345 Test Acc: 0.236
Validation loss decreased (-0.218792 --> -0.236437).  Saving model ...
Epoch: 23 cost time: 1.894489049911499
Epoch: 23, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.683 Vali Acc: 0.211 Test Loss: 3.683 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.22369647026062
Epoch: 24, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.521 Vali Acc: 0.228 Test Loss: 3.521 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7791974544525146
Epoch: 25, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.592 Vali Acc: 0.239 Test Loss: 3.592 Test Acc: 0.239
Validation loss decreased (-0.236437 --> -0.238788).  Saving model ...
Epoch: 26 cost time: 2.3028111457824707
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.567 Vali Acc: 0.255 Test Loss: 3.567 Test Acc: 0.255
Validation loss decreased (-0.238788 --> -0.255258).  Saving model ...
Epoch: 27 cost time: 2.498112201690674
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.593 Vali Acc: 0.252 Test Loss: 3.593 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0035877227783203
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.672 Vali Acc: 0.252 Test Loss: 3.672 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.042057514190674
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.682 Vali Acc: 0.253 Test Loss: 3.682 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7873327732086182
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.677 Vali Acc: 0.261 Test Loss: 3.677 Test Acc: 0.261
Validation loss decreased (-0.255258 --> -0.261140).  Saving model ...
Epoch: 31 cost time: 2.0313587188720703
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.713 Vali Acc: 0.255 Test Loss: 3.713 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.525770902633667
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.739 Vali Acc: 0.249 Test Loss: 3.739 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8850133419036865
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.706 Vali Acc: 0.261 Test Loss: 3.706 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.7341957092285156
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.731 Vali Acc: 0.262 Test Loss: 3.731 Test Acc: 0.262
Validation loss decreased (-0.261140 --> -0.262316).  Saving model ...
Epoch: 35 cost time: 2.2042412757873535
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.777 Vali Acc: 0.254 Test Loss: 3.777 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8835711479187012
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.761 Vali Acc: 0.256 Test Loss: 3.761 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.289492130279541
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.777 Vali Acc: 0.260 Test Loss: 3.777 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.4906814098358154
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.817 Vali Acc: 0.262 Test Loss: 3.817 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.037134885787964
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.845 Vali Acc: 0.259 Test Loss: 3.845 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.245589017868042
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.814 Vali Acc: 0.259 Test Loss: 3.814 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.0311436653137207
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.813 Vali Acc: 0.265 Test Loss: 3.813 Test Acc: 0.265
Validation loss decreased (-0.262316 --> -0.264668).  Saving model ...
Epoch: 42 cost time: 2.298640727996826
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.839 Vali Acc: 0.262 Test Loss: 3.839 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.217811346054077
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.831 Vali Acc: 0.262 Test Loss: 3.831 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.198117971420288
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.841 Vali Acc: 0.262 Test Loss: 3.841 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.9619600772857666
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.866 Vali Acc: 0.262 Test Loss: 3.866 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.9609251022338867
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.875 Vali Acc: 0.264 Test Loss: 3.875 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.6508078575134277
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.886 Vali Acc: 0.261 Test Loss: 3.886 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.9953532218933105
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.885 Vali Acc: 0.259 Test Loss: 3.885 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.127957344055176
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.887 Vali Acc: 0.258 Test Loss: 3.887 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.3917527198791504
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.887 Vali Acc: 0.260 Test Loss: 3.887 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.1884589195251465
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.903 Vali Acc: 0.259 Test Loss: 3.903 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 4805974
model size : 20.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.601612329483032
Epoch: 1, Steps: 10 | Train Loss: 3.416 Vali Loss: 3.315 Vali Acc: 0.036 Test Loss: 3.315 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.8531560897827148
Epoch: 2, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.381 Vali Acc: 0.041 Test Loss: 3.381 Test Acc: 0.041
Validation loss decreased (-0.036437 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 1.9027106761932373
Epoch: 3, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.364 Vali Acc: 0.044 Test Loss: 3.364 Test Acc: 0.044
Validation loss decreased (-0.041143 --> -0.043496).  Saving model ...
Epoch: 4 cost time: 1.9453089237213135
Epoch: 4, Steps: 10 | Train Loss: 3.136 Vali Loss: 3.328 Vali Acc: 0.067 Test Loss: 3.328 Test Acc: 0.067
Validation loss decreased (-0.043496 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 1.7622649669647217
Epoch: 5, Steps: 10 | Train Loss: 2.954 Vali Loss: 3.295 Vali Acc: 0.091 Test Loss: 3.295 Test Acc: 0.091
Validation loss decreased (-0.067026 --> -0.090555).  Saving model ...
Epoch: 6 cost time: 2.303145170211792
Epoch: 6, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.262 Vali Acc: 0.100 Test Loss: 3.262 Test Acc: 0.100
Validation loss decreased (-0.090555 --> -0.099967).  Saving model ...
Epoch: 7 cost time: 1.703199863433838
Epoch: 7, Steps: 10 | Train Loss: 2.557 Vali Loss: 3.245 Vali Acc: 0.121 Test Loss: 3.245 Test Acc: 0.121
Validation loss decreased (-0.099967 --> -0.121144).  Saving model ...
Epoch: 8 cost time: 2.198759078979492
Epoch: 8, Steps: 10 | Train Loss: 2.328 Vali Loss: 3.295 Vali Acc: 0.119 Test Loss: 3.295 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.994271993637085
Epoch: 9, Steps: 10 | Train Loss: 2.074 Vali Loss: 3.222 Vali Acc: 0.142 Test Loss: 3.222 Test Acc: 0.142
Validation loss decreased (-0.121144 --> -0.142321).  Saving model ...
Epoch: 10 cost time: 1.8035848140716553
Epoch: 10, Steps: 10 | Train Loss: 1.929 Vali Loss: 3.242 Vali Acc: 0.158 Test Loss: 3.242 Test Acc: 0.158
Validation loss decreased (-0.142321 --> -0.157615).  Saving model ...
Epoch: 11 cost time: 2.0499045848846436
Epoch: 11, Steps: 10 | Train Loss: 1.706 Vali Loss: 3.267 Vali Acc: 0.152 Test Loss: 3.267 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8396718502044678
Epoch: 12, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.266 Vali Acc: 0.165 Test Loss: 3.266 Test Acc: 0.165
Validation loss decreased (-0.157615 --> -0.164673).  Saving model ...
Epoch: 13 cost time: 1.9434797763824463
Epoch: 13, Steps: 10 | Train Loss: 1.372 Vali Loss: 3.242 Vali Acc: 0.156 Test Loss: 3.242 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0851376056671143
Epoch: 14, Steps: 10 | Train Loss: 1.246 Vali Loss: 3.201 Vali Acc: 0.195 Test Loss: 3.201 Test Acc: 0.195
Validation loss decreased (-0.164673 --> -0.195262).  Saving model ...
Epoch: 15 cost time: 1.8414497375488281
Epoch: 15, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.331 Vali Acc: 0.179 Test Loss: 3.331 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0330710411071777
Epoch: 16, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.258 Vali Acc: 0.208 Test Loss: 3.258 Test Acc: 0.208
Validation loss decreased (-0.195262 --> -0.208203).  Saving model ...
Epoch: 17 cost time: 2.396550416946411
Epoch: 17, Steps: 10 | Train Loss: 0.765 Vali Loss: 3.377 Vali Acc: 0.198 Test Loss: 3.377 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.502298355102539
Epoch: 18, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.421 Vali Acc: 0.186 Test Loss: 3.421 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.008436918258667
Epoch: 19, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.397 Vali Acc: 0.215 Test Loss: 3.397 Test Acc: 0.215
Validation loss decreased (-0.208203 --> -0.215260).  Saving model ...
Epoch: 20 cost time: 1.964512586593628
Epoch: 20, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.433 Vali Acc: 0.219 Test Loss: 3.433 Test Acc: 0.219
Validation loss decreased (-0.215260 --> -0.218789).  Saving model ...
Epoch: 21 cost time: 2.430906295776367
Epoch: 21, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.535 Vali Acc: 0.222 Test Loss: 3.535 Test Acc: 0.222
Validation loss decreased (-0.218789 --> -0.222318).  Saving model ...
Epoch: 22 cost time: 2.113328695297241
Epoch: 22, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.593 Vali Acc: 0.227 Test Loss: 3.593 Test Acc: 0.227
Validation loss decreased (-0.222318 --> -0.227023).  Saving model ...
Epoch: 23 cost time: 1.6022400856018066
Epoch: 23, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.592 Vali Acc: 0.238 Test Loss: 3.592 Test Acc: 0.238
Validation loss decreased (-0.227023 --> -0.237611).  Saving model ...
Epoch: 24 cost time: 2.019028663635254
Epoch: 24, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.660 Vali Acc: 0.245 Test Loss: 3.660 Test Acc: 0.245
Validation loss decreased (-0.237611 --> -0.244669).  Saving model ...
Epoch: 25 cost time: 1.908611536026001
Epoch: 25, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.695 Vali Acc: 0.249 Test Loss: 3.695 Test Acc: 0.249
Validation loss decreased (-0.244669 --> -0.249375).  Saving model ...
Epoch: 26 cost time: 1.7011308670043945
Epoch: 26, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.729 Vali Acc: 0.251 Test Loss: 3.729 Test Acc: 0.251
Validation loss decreased (-0.249375 --> -0.250551).  Saving model ...
Epoch: 27 cost time: 2.316030263900757
Epoch: 27, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.793 Vali Acc: 0.251 Test Loss: 3.793 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0879132747650146
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.864 Vali Acc: 0.240 Test Loss: 3.864 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7895946502685547
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.866 Vali Acc: 0.248 Test Loss: 3.866 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.0815184116363525
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.886 Vali Acc: 0.259 Test Loss: 3.886 Test Acc: 0.259
Validation loss decreased (-0.250551 --> -0.258785).  Saving model ...
Epoch: 31 cost time: 2.205010414123535
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.916 Vali Acc: 0.252 Test Loss: 3.916 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9453279972076416
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.900 Vali Acc: 0.267 Test Loss: 3.900 Test Acc: 0.267
Validation loss decreased (-0.258785 --> -0.267020).  Saving model ...
Epoch: 33 cost time: 1.8444054126739502
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.908 Vali Acc: 0.258 Test Loss: 3.908 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8800292015075684
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.935 Vali Acc: 0.260 Test Loss: 3.935 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.116391897201538
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.925 Vali Acc: 0.264 Test Loss: 3.925 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.1185429096221924
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.920 Vali Acc: 0.266 Test Loss: 3.920 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7601442337036133
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.956 Vali Acc: 0.259 Test Loss: 3.956 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.8206846714019775
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.970 Vali Acc: 0.259 Test Loss: 3.970 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.5597290992736816
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.982 Vali Acc: 0.256 Test Loss: 3.982 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.159186363220215
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.982 Vali Acc: 0.261 Test Loss: 3.982 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.059725284576416
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.986 Vali Acc: 0.259 Test Loss: 3.986 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.9444262981414795
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.011 Vali Acc: 0.255 Test Loss: 4.011 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 4802646
model size : 20.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.0352253913879395
Epoch: 1, Steps: 10 | Train Loss: 3.503 Vali Loss: 3.330 Vali Acc: 0.048 Test Loss: 3.330 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 2.1883420944213867
Epoch: 2, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.405 Vali Acc: 0.041 Test Loss: 3.405 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1732404232025146
Epoch: 3, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.375 Vali Acc: 0.049 Test Loss: 3.375 Test Acc: 0.049
Validation loss decreased (-0.048202 --> -0.049378).  Saving model ...
Epoch: 4 cost time: 2.1851019859313965
Epoch: 4, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.348 Vali Acc: 0.067 Test Loss: 3.348 Test Acc: 0.067
Validation loss decreased (-0.049378 --> -0.067025).  Saving model ...
Epoch: 5 cost time: 2.2042269706726074
Epoch: 5, Steps: 10 | Train Loss: 2.988 Vali Loss: 3.258 Vali Acc: 0.100 Test Loss: 3.258 Test Acc: 0.100
Validation loss decreased (-0.067025 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 2.0181727409362793
Epoch: 6, Steps: 10 | Train Loss: 2.765 Vali Loss: 3.262 Vali Acc: 0.102 Test Loss: 3.262 Test Acc: 0.102
Validation loss decreased (-0.099967 --> -0.102320).  Saving model ...
Epoch: 7 cost time: 2.039482355117798
Epoch: 7, Steps: 10 | Train Loss: 2.573 Vali Loss: 3.256 Vali Acc: 0.125 Test Loss: 3.256 Test Acc: 0.125
Validation loss decreased (-0.102320 --> -0.124673).  Saving model ...
Epoch: 8 cost time: 1.7247235774993896
Epoch: 8, Steps: 10 | Train Loss: 2.413 Vali Loss: 3.223 Vali Acc: 0.129 Test Loss: 3.223 Test Acc: 0.129
Validation loss decreased (-0.124673 --> -0.129380).  Saving model ...
Epoch: 9 cost time: 1.854980230331421
Epoch: 9, Steps: 10 | Train Loss: 2.221 Vali Loss: 3.264 Vali Acc: 0.148 Test Loss: 3.264 Test Acc: 0.148
Validation loss decreased (-0.129380 --> -0.148203).  Saving model ...
Epoch: 10 cost time: 2.4845900535583496
Epoch: 10, Steps: 10 | Train Loss: 1.951 Vali Loss: 3.186 Vali Acc: 0.168 Test Loss: 3.186 Test Acc: 0.168
Validation loss decreased (-0.148203 --> -0.168203).  Saving model ...
Epoch: 11 cost time: 1.814408302307129
Epoch: 11, Steps: 10 | Train Loss: 1.817 Vali Loss: 3.223 Vali Acc: 0.166 Test Loss: 3.223 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0637998580932617
Epoch: 12, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.203 Vali Acc: 0.168 Test Loss: 3.203 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.931018590927124
Epoch: 13, Steps: 10 | Train Loss: 1.371 Vali Loss: 3.181 Vali Acc: 0.191 Test Loss: 3.181 Test Acc: 0.191
Validation loss decreased (-0.168203 --> -0.190556).  Saving model ...
Epoch: 14 cost time: 1.9995312690734863
Epoch: 14, Steps: 10 | Train Loss: 1.160 Vali Loss: 3.172 Vali Acc: 0.195 Test Loss: 3.172 Test Acc: 0.195
Validation loss decreased (-0.190556 --> -0.195262).  Saving model ...
Epoch: 15 cost time: 2.564822196960449
Epoch: 15, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.200 Vali Acc: 0.206 Test Loss: 3.200 Test Acc: 0.206
Validation loss decreased (-0.195262 --> -0.205850).  Saving model ...
Epoch: 16 cost time: 2.3132541179656982
Epoch: 16, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.169 Vali Acc: 0.228 Test Loss: 3.169 Test Acc: 0.228
Validation loss decreased (-0.205850 --> -0.228204).  Saving model ...
Epoch: 17 cost time: 2.0656471252441406
Epoch: 17, Steps: 10 | Train Loss: 0.631 Vali Loss: 3.250 Vali Acc: 0.212 Test Loss: 3.250 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.157754898071289
Epoch: 18, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.187 Vali Acc: 0.222 Test Loss: 3.187 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7873404026031494
Epoch: 19, Steps: 10 | Train Loss: 0.411 Vali Loss: 3.410 Vali Acc: 0.188 Test Loss: 3.410 Test Acc: 0.188
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.122154474258423
Epoch: 20, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.538 Vali Acc: 0.185 Test Loss: 3.538 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0258727073669434
Epoch: 21, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.327 Vali Acc: 0.239 Test Loss: 3.327 Test Acc: 0.239
Validation loss decreased (-0.228204 --> -0.238790).  Saving model ...
Epoch: 22 cost time: 2.0049805641174316
Epoch: 22, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.505 Vali Acc: 0.212 Test Loss: 3.505 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9924795627593994
Epoch: 23, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.438 Vali Acc: 0.241 Test Loss: 3.438 Test Acc: 0.241
Validation loss decreased (-0.238790 --> -0.241142).  Saving model ...
Epoch: 24 cost time: 2.148792266845703
Epoch: 24, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.608 Vali Acc: 0.231 Test Loss: 3.608 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3835034370422363
Epoch: 25, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.535 Vali Acc: 0.246 Test Loss: 3.535 Test Acc: 0.246
Validation loss decreased (-0.241142 --> -0.245847).  Saving model ...
Epoch: 26 cost time: 1.7468054294586182
Epoch: 26, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.624 Vali Acc: 0.248 Test Loss: 3.624 Test Acc: 0.248
Validation loss decreased (-0.245847 --> -0.248199).  Saving model ...
Epoch: 27 cost time: 2.0036330223083496
Epoch: 27, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.712 Vali Acc: 0.251 Test Loss: 3.712 Test Acc: 0.251
Validation loss decreased (-0.248199 --> -0.250551).  Saving model ...
Epoch: 28 cost time: 2.3046445846557617
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.657 Vali Acc: 0.242 Test Loss: 3.657 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.339360237121582
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.673 Vali Acc: 0.261 Test Loss: 3.673 Test Acc: 0.261
Validation loss decreased (-0.250551 --> -0.261140).  Saving model ...
Epoch: 30 cost time: 1.712419033050537
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.677 Vali Acc: 0.262 Test Loss: 3.677 Test Acc: 0.262
Validation loss decreased (-0.261140 --> -0.262316).  Saving model ...
Epoch: 31 cost time: 1.7709035873413086
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.700 Vali Acc: 0.262 Test Loss: 3.700 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0118324756622314
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.717 Vali Acc: 0.262 Test Loss: 3.717 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.1810946464538574
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.732 Vali Acc: 0.266 Test Loss: 3.732 Test Acc: 0.266
Validation loss decreased (-0.262316 --> -0.265845).  Saving model ...
Epoch: 34 cost time: 1.9729881286621094
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.770 Vali Acc: 0.260 Test Loss: 3.770 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.4045400619506836
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.787 Vali Acc: 0.272 Test Loss: 3.787 Test Acc: 0.272
Validation loss decreased (-0.265845 --> -0.271727).  Saving model ...
Epoch: 36 cost time: 2.2562484741210938
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.772 Vali Acc: 0.268 Test Loss: 3.772 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.0254290103912354
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.812 Vali Acc: 0.268 Test Loss: 3.812 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.055947780609131
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.837 Vali Acc: 0.271 Test Loss: 3.837 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.2161877155303955
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.820 Vali Acc: 0.266 Test Loss: 3.820 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.8354566097259521
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.810 Vali Acc: 0.271 Test Loss: 3.810 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.9557585716247559
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.830 Vali Acc: 0.271 Test Loss: 3.830 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.8959310054779053
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.850 Vali Acc: 0.271 Test Loss: 3.850 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.777402400970459
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.865 Vali Acc: 0.264 Test Loss: 3.865 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.1300904750823975
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.862 Vali Acc: 0.267 Test Loss: 3.862 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.0337393283843994
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.866 Vali Acc: 0.269 Test Loss: 3.866 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 4799318
model size : 20.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7001960277557373
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.325 Vali Acc: 0.039 Test Loss: 3.325 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 2.3489387035369873
Epoch: 2, Steps: 10 | Train Loss: 3.311 Vali Loss: 3.393 Vali Acc: 0.056 Test Loss: 3.393 Test Acc: 0.056
Validation loss decreased (-0.038790 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 2.1339375972747803
Epoch: 3, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.362 Vali Acc: 0.062 Test Loss: 3.362 Test Acc: 0.062
Validation loss decreased (-0.056437 --> -0.062319).  Saving model ...
Epoch: 4 cost time: 2.0996763706207275
Epoch: 4, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.341 Vali Acc: 0.060 Test Loss: 3.341 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2980949878692627
Epoch: 5, Steps: 10 | Train Loss: 3.050 Vali Loss: 3.301 Vali Acc: 0.074 Test Loss: 3.301 Test Acc: 0.074
Validation loss decreased (-0.062319 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 1.8507554531097412
Epoch: 6, Steps: 10 | Train Loss: 2.902 Vali Loss: 3.288 Vali Acc: 0.089 Test Loss: 3.288 Test Acc: 0.089
Validation loss decreased (-0.074085 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 2.043332099914551
Epoch: 7, Steps: 10 | Train Loss: 2.675 Vali Loss: 3.305 Vali Acc: 0.092 Test Loss: 3.305 Test Acc: 0.092
Validation loss decreased (-0.089379 --> -0.091732).  Saving model ...
Epoch: 8 cost time: 2.1030359268188477
Epoch: 8, Steps: 10 | Train Loss: 2.473 Vali Loss: 3.272 Vali Acc: 0.118 Test Loss: 3.272 Test Acc: 0.118
Validation loss decreased (-0.091732 --> -0.117614).  Saving model ...
Epoch: 9 cost time: 2.071303129196167
Epoch: 9, Steps: 10 | Train Loss: 2.297 Vali Loss: 3.253 Vali Acc: 0.140 Test Loss: 3.253 Test Acc: 0.140
Validation loss decreased (-0.117614 --> -0.139967).  Saving model ...
Epoch: 10 cost time: 2.2352113723754883
Epoch: 10, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.224 Vali Acc: 0.162 Test Loss: 3.224 Test Acc: 0.162
Validation loss decreased (-0.139967 --> -0.162321).  Saving model ...
Epoch: 11 cost time: 2.1760661602020264
Epoch: 11, Steps: 10 | Train Loss: 1.954 Vali Loss: 3.273 Vali Acc: 0.138 Test Loss: 3.273 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.058267831802368
Epoch: 12, Steps: 10 | Train Loss: 1.762 Vali Loss: 3.205 Vali Acc: 0.181 Test Loss: 3.205 Test Acc: 0.181
Validation loss decreased (-0.162321 --> -0.181144).  Saving model ...
Epoch: 13 cost time: 2.1698975563049316
Epoch: 13, Steps: 10 | Train Loss: 1.563 Vali Loss: 3.236 Vali Acc: 0.185 Test Loss: 3.236 Test Acc: 0.185
Validation loss decreased (-0.181144 --> -0.184674).  Saving model ...
Epoch: 14 cost time: 2.118675947189331
Epoch: 14, Steps: 10 | Train Loss: 1.416 Vali Loss: 3.226 Vali Acc: 0.173 Test Loss: 3.226 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.005664110183716
Epoch: 15, Steps: 10 | Train Loss: 1.285 Vali Loss: 3.207 Vali Acc: 0.199 Test Loss: 3.207 Test Acc: 0.199
Validation loss decreased (-0.184674 --> -0.198791).  Saving model ...
Epoch: 16 cost time: 2.0237324237823486
Epoch: 16, Steps: 10 | Train Loss: 1.068 Vali Loss: 3.254 Vali Acc: 0.188 Test Loss: 3.254 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.155466079711914
Epoch: 17, Steps: 10 | Train Loss: 0.884 Vali Loss: 3.223 Vali Acc: 0.211 Test Loss: 3.223 Test Acc: 0.211
Validation loss decreased (-0.198791 --> -0.210556).  Saving model ...
Epoch: 18 cost time: 2.337766170501709
Epoch: 18, Steps: 10 | Train Loss: 0.783 Vali Loss: 3.276 Vali Acc: 0.202 Test Loss: 3.276 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.002964973449707
Epoch: 19, Steps: 10 | Train Loss: 0.635 Vali Loss: 3.318 Vali Acc: 0.207 Test Loss: 3.318 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0555362701416016
Epoch: 20, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.529 Vali Acc: 0.174 Test Loss: 3.529 Test Acc: 0.174
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1513354778289795
Epoch: 21, Steps: 10 | Train Loss: 0.494 Vali Loss: 3.394 Vali Acc: 0.206 Test Loss: 3.394 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.007434606552124
Epoch: 22, Steps: 10 | Train Loss: 0.367 Vali Loss: 3.444 Vali Acc: 0.208 Test Loss: 3.444 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7902872562408447
Epoch: 23, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.495 Vali Acc: 0.220 Test Loss: 3.495 Test Acc: 0.220
Validation loss decreased (-0.210556 --> -0.219965).  Saving model ...
Epoch: 24 cost time: 2.0941975116729736
Epoch: 24, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.539 Vali Acc: 0.236 Test Loss: 3.539 Test Acc: 0.236
Validation loss decreased (-0.219965 --> -0.236435).  Saving model ...
Epoch: 25 cost time: 1.8039004802703857
Epoch: 25, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.645 Vali Acc: 0.227 Test Loss: 3.645 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.417646646499634
Epoch: 26, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.652 Vali Acc: 0.228 Test Loss: 3.652 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.101142406463623
Epoch: 27, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.749 Vali Acc: 0.229 Test Loss: 3.749 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.206536293029785
Epoch: 28, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.776 Vali Acc: 0.235 Test Loss: 3.776 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.198150873184204
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.761 Vali Acc: 0.239 Test Loss: 3.761 Test Acc: 0.239
Validation loss decreased (-0.236435 --> -0.238786).  Saving model ...
Epoch: 30 cost time: 1.8209290504455566
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.794 Vali Acc: 0.244 Test Loss: 3.794 Test Acc: 0.244
Validation loss decreased (-0.238786 --> -0.243491).  Saving model ...
Epoch: 31 cost time: 1.9859685897827148
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.824 Vali Acc: 0.251 Test Loss: 3.824 Test Acc: 0.251
Validation loss decreased (-0.243491 --> -0.250550).  Saving model ...
Epoch: 32 cost time: 2.2527318000793457
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.823 Vali Acc: 0.253 Test Loss: 3.823 Test Acc: 0.253
Validation loss decreased (-0.250550 --> -0.252903).  Saving model ...
Epoch: 33 cost time: 2.0748207569122314
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.844 Vali Acc: 0.242 Test Loss: 3.844 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.0720441341400146
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.873 Vali Acc: 0.239 Test Loss: 3.873 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.15145206451416
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.884 Vali Acc: 0.251 Test Loss: 3.884 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.014056921005249
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.906 Vali Acc: 0.253 Test Loss: 3.906 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.489224433898926
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.945 Vali Acc: 0.242 Test Loss: 3.945 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.2003438472747803
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.946 Vali Acc: 0.245 Test Loss: 3.946 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.1901705265045166
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.929 Vali Acc: 0.248 Test Loss: 3.929 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.07000470161438
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.946 Vali Acc: 0.244 Test Loss: 3.946 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.254270315170288
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.958 Vali Acc: 0.251 Test Loss: 3.958 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.1795029640197754
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.955 Vali Acc: 0.253 Test Loss: 3.955 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 3625046
model size : 16.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.309406757354736
Epoch: 1, Steps: 10 | Train Loss: 3.478 Vali Loss: 3.342 Vali Acc: 0.038 Test Loss: 3.342 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 2.4509434700012207
Epoch: 2, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.393 Vali Acc: 0.045 Test Loss: 3.393 Test Acc: 0.045
Validation loss decreased (-0.037614 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 2.7196543216705322
Epoch: 3, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.378 Vali Acc: 0.053 Test Loss: 3.378 Test Acc: 0.053
Validation loss decreased (-0.044672 --> -0.052907).  Saving model ...
Epoch: 4 cost time: 2.0108542442321777
Epoch: 4, Steps: 10 | Train Loss: 3.119 Vali Loss: 3.318 Vali Acc: 0.076 Test Loss: 3.318 Test Acc: 0.076
Validation loss decreased (-0.052907 --> -0.076437).  Saving model ...
Epoch: 5 cost time: 2.11409854888916
Epoch: 5, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.284 Vali Acc: 0.082 Test Loss: 3.284 Test Acc: 0.082
Validation loss decreased (-0.076437 --> -0.082320).  Saving model ...
Epoch: 6 cost time: 2.2652668952941895
Epoch: 6, Steps: 10 | Train Loss: 2.940 Vali Loss: 3.288 Vali Acc: 0.093 Test Loss: 3.288 Test Acc: 0.093
Validation loss decreased (-0.082320 --> -0.092908).  Saving model ...
Epoch: 7 cost time: 2.0873138904571533
Epoch: 7, Steps: 10 | Train Loss: 2.677 Vali Loss: 3.267 Vali Acc: 0.094 Test Loss: 3.267 Test Acc: 0.094
Validation loss decreased (-0.092908 --> -0.094085).  Saving model ...
Epoch: 8 cost time: 2.226259469985962
Epoch: 8, Steps: 10 | Train Loss: 2.590 Vali Loss: 3.242 Vali Acc: 0.128 Test Loss: 3.242 Test Acc: 0.128
Validation loss decreased (-0.094085 --> -0.128203).  Saving model ...
Epoch: 9 cost time: 2.116628885269165
Epoch: 9, Steps: 10 | Train Loss: 2.307 Vali Loss: 3.256 Vali Acc: 0.126 Test Loss: 3.256 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.982023000717163
Epoch: 10, Steps: 10 | Train Loss: 2.150 Vali Loss: 3.225 Vali Acc: 0.146 Test Loss: 3.225 Test Acc: 0.146
Validation loss decreased (-0.128203 --> -0.145850).  Saving model ...
Epoch: 11 cost time: 2.5982167720794678
Epoch: 11, Steps: 10 | Train Loss: 1.923 Vali Loss: 3.238 Vali Acc: 0.175 Test Loss: 3.238 Test Acc: 0.175
Validation loss decreased (-0.145850 --> -0.175262).  Saving model ...
Epoch: 12 cost time: 2.5218214988708496
Epoch: 12, Steps: 10 | Train Loss: 1.716 Vali Loss: 3.225 Vali Acc: 0.166 Test Loss: 3.225 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.395587921142578
Epoch: 13, Steps: 10 | Train Loss: 1.548 Vali Loss: 3.221 Vali Acc: 0.184 Test Loss: 3.221 Test Acc: 0.184
Validation loss decreased (-0.175262 --> -0.183497).  Saving model ...
Epoch: 14 cost time: 2.4222726821899414
Epoch: 14, Steps: 10 | Train Loss: 1.383 Vali Loss: 3.231 Vali Acc: 0.188 Test Loss: 3.231 Test Acc: 0.188
Validation loss decreased (-0.183497 --> -0.188203).  Saving model ...
Epoch: 15 cost time: 2.3398938179016113
Epoch: 15, Steps: 10 | Train Loss: 1.161 Vali Loss: 3.305 Vali Acc: 0.182 Test Loss: 3.305 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.34385085105896
Epoch: 16, Steps: 10 | Train Loss: 0.992 Vali Loss: 3.253 Vali Acc: 0.204 Test Loss: 3.253 Test Acc: 0.204
Validation loss decreased (-0.188203 --> -0.203497).  Saving model ...
Epoch: 17 cost time: 1.9962687492370605
Epoch: 17, Steps: 10 | Train Loss: 0.915 Vali Loss: 3.324 Vali Acc: 0.199 Test Loss: 3.324 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4410295486450195
Epoch: 18, Steps: 10 | Train Loss: 0.817 Vali Loss: 3.329 Vali Acc: 0.213 Test Loss: 3.329 Test Acc: 0.213
Validation loss decreased (-0.203497 --> -0.212908).  Saving model ...
Epoch: 19 cost time: 1.9860477447509766
Epoch: 19, Steps: 10 | Train Loss: 0.637 Vali Loss: 3.426 Vali Acc: 0.174 Test Loss: 3.426 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.106308937072754
Epoch: 20, Steps: 10 | Train Loss: 0.503 Vali Loss: 3.488 Vali Acc: 0.209 Test Loss: 3.488 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.407015562057495
Epoch: 21, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.515 Vali Acc: 0.196 Test Loss: 3.515 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3910975456237793
Epoch: 22, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.445 Vali Acc: 0.220 Test Loss: 3.445 Test Acc: 0.220
Validation loss decreased (-0.212908 --> -0.219966).  Saving model ...
Epoch: 23 cost time: 2.6650006771087646
Epoch: 23, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.571 Vali Acc: 0.198 Test Loss: 3.571 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.255793333053589
Epoch: 24, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.528 Vali Acc: 0.232 Test Loss: 3.528 Test Acc: 0.232
Validation loss decreased (-0.219966 --> -0.231729).  Saving model ...
Epoch: 25 cost time: 1.9761991500854492
Epoch: 25, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.721 Vali Acc: 0.233 Test Loss: 3.721 Test Acc: 0.233
Validation loss decreased (-0.231729 --> -0.232904).  Saving model ...
Epoch: 26 cost time: 2.3539156913757324
Epoch: 26, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.612 Vali Acc: 0.234 Test Loss: 3.612 Test Acc: 0.234
Validation loss decreased (-0.232904 --> -0.234082).  Saving model ...
Epoch: 27 cost time: 2.05967116355896
Epoch: 27, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.727 Vali Acc: 0.239 Test Loss: 3.727 Test Acc: 0.239
Validation loss decreased (-0.234082 --> -0.238786).  Saving model ...
Epoch: 28 cost time: 2.1502952575683594
Epoch: 28, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.794 Vali Acc: 0.236 Test Loss: 3.794 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8215363025665283
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.725 Vali Acc: 0.244 Test Loss: 3.725 Test Acc: 0.244
Validation loss decreased (-0.238786 --> -0.243492).  Saving model ...
Epoch: 30 cost time: 1.8715667724609375
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.730 Vali Acc: 0.255 Test Loss: 3.730 Test Acc: 0.255
Validation loss decreased (-0.243492 --> -0.255257).  Saving model ...
Epoch: 31 cost time: 1.8062744140625
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.781 Vali Acc: 0.253 Test Loss: 3.781 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.1797749996185303
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.828 Vali Acc: 0.261 Test Loss: 3.828 Test Acc: 0.261
Validation loss decreased (-0.255257 --> -0.261138).  Saving model ...
Epoch: 33 cost time: 2.1890194416046143
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.846 Vali Acc: 0.258 Test Loss: 3.846 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.2519757747650146
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.844 Vali Acc: 0.255 Test Loss: 3.844 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.2789576053619385
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.871 Vali Acc: 0.262 Test Loss: 3.871 Test Acc: 0.262
Validation loss decreased (-0.261138 --> -0.262314).  Saving model ...
Epoch: 36 cost time: 2.2012248039245605
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.880 Vali Acc: 0.258 Test Loss: 3.880 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.679126024246216
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.874 Vali Acc: 0.265 Test Loss: 3.874 Test Acc: 0.265
Validation loss decreased (-0.262314 --> -0.264667).  Saving model ...
Epoch: 38 cost time: 2.4621565341949463
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.904 Vali Acc: 0.261 Test Loss: 3.904 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.3363592624664307
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.930 Vali Acc: 0.262 Test Loss: 3.930 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.1235015392303467
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.936 Vali Acc: 0.264 Test Loss: 3.936 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.3368754386901855
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.933 Vali Acc: 0.262 Test Loss: 3.933 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.963754653930664
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.942 Vali Acc: 0.259 Test Loss: 3.942 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.805500030517578
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.950 Vali Acc: 0.264 Test Loss: 3.950 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.5405728816986084
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.988 Vali Acc: 0.261 Test Loss: 3.988 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.2062828540802
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.005 Vali Acc: 0.261 Test Loss: 4.005 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.933286190032959
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.992 Vali Acc: 0.266 Test Loss: 3.992 Test Acc: 0.266
Validation loss decreased (-0.264667 --> -0.265842).  Saving model ...
Epoch: 47 cost time: 1.9131748676300049
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.021 Vali Acc: 0.258 Test Loss: 4.021 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.121574640274048
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.030 Vali Acc: 0.264 Test Loss: 4.030 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.421178102493286
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.025 Vali Acc: 0.261 Test Loss: 4.025 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.174044609069824
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.018 Vali Acc: 0.255 Test Loss: 4.018 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.9607484340667725
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.032 Vali Acc: 0.260 Test Loss: 4.032 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.8079593181610107
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.054 Vali Acc: 0.264 Test Loss: 4.054 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.8545327186584473
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.057 Vali Acc: 0.264 Test Loss: 4.057 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.9845848083496094
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.087 Vali Acc: 0.264 Test Loss: 4.087 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 2.2277779579162598
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.084 Vali Acc: 0.264 Test Loss: 4.084 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 2.416154384613037
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.086 Vali Acc: 0.262 Test Loss: 4.086 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 3621718
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.982815980911255
Epoch: 1, Steps: 10 | Train Loss: 3.402 Vali Loss: 3.326 Vali Acc: 0.038 Test Loss: 3.326 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.8961303234100342
Epoch: 2, Steps: 10 | Train Loss: 3.274 Vali Loss: 3.421 Vali Acc: 0.041 Test Loss: 3.421 Test Acc: 0.041
Validation loss decreased (-0.037614 --> -0.041142).  Saving model ...
Epoch: 3 cost time: 2.5090725421905518
Epoch: 3, Steps: 10 | Train Loss: 3.231 Vali Loss: 3.386 Vali Acc: 0.060 Test Loss: 3.386 Test Acc: 0.060
Validation loss decreased (-0.041142 --> -0.059966).  Saving model ...
Epoch: 4 cost time: 1.96067214012146
Epoch: 4, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.315 Vali Acc: 0.064 Test Loss: 3.315 Test Acc: 0.064
Validation loss decreased (-0.059966 --> -0.063496).  Saving model ...
Epoch: 5 cost time: 1.8750813007354736
Epoch: 5, Steps: 10 | Train Loss: 2.977 Vali Loss: 3.299 Vali Acc: 0.075 Test Loss: 3.299 Test Acc: 0.075
Validation loss decreased (-0.063496 --> -0.075261).  Saving model ...
Epoch: 6 cost time: 2.8536648750305176
Epoch: 6, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.265 Vali Acc: 0.094 Test Loss: 3.265 Test Acc: 0.094
Validation loss decreased (-0.075261 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 2.4420981407165527
Epoch: 7, Steps: 10 | Train Loss: 2.650 Vali Loss: 3.277 Vali Acc: 0.092 Test Loss: 3.277 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.130370855331421
Epoch: 8, Steps: 10 | Train Loss: 2.516 Vali Loss: 3.245 Vali Acc: 0.125 Test Loss: 3.245 Test Acc: 0.125
Validation loss decreased (-0.094085 --> -0.124673).  Saving model ...
Epoch: 9 cost time: 2.0977418422698975
Epoch: 9, Steps: 10 | Train Loss: 2.285 Vali Loss: 3.254 Vali Acc: 0.136 Test Loss: 3.254 Test Acc: 0.136
Validation loss decreased (-0.124673 --> -0.136438).  Saving model ...
Epoch: 10 cost time: 1.8083209991455078
Epoch: 10, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.230 Vali Acc: 0.161 Test Loss: 3.230 Test Acc: 0.161
Validation loss decreased (-0.136438 --> -0.161144).  Saving model ...
Epoch: 11 cost time: 1.7497682571411133
Epoch: 11, Steps: 10 | Train Loss: 1.926 Vali Loss: 3.223 Vali Acc: 0.162 Test Loss: 3.223 Test Acc: 0.162
Validation loss decreased (-0.161144 --> -0.162321).  Saving model ...
Epoch: 12 cost time: 2.6674747467041016
Epoch: 12, Steps: 10 | Train Loss: 1.628 Vali Loss: 3.241 Vali Acc: 0.167 Test Loss: 3.241 Test Acc: 0.167
Validation loss decreased (-0.162321 --> -0.167026).  Saving model ...
Epoch: 13 cost time: 1.7716600894927979
Epoch: 13, Steps: 10 | Train Loss: 1.576 Vali Loss: 3.274 Vali Acc: 0.155 Test Loss: 3.274 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.148667335510254
Epoch: 14, Steps: 10 | Train Loss: 1.439 Vali Loss: 3.266 Vali Acc: 0.195 Test Loss: 3.266 Test Acc: 0.195
Validation loss decreased (-0.167026 --> -0.195261).  Saving model ...
Epoch: 15 cost time: 2.1049373149871826
Epoch: 15, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.204 Vali Acc: 0.227 Test Loss: 3.204 Test Acc: 0.227
Validation loss decreased (-0.195261 --> -0.227027).  Saving model ...
Epoch: 16 cost time: 1.9510340690612793
Epoch: 16, Steps: 10 | Train Loss: 1.021 Vali Loss: 3.247 Vali Acc: 0.205 Test Loss: 3.247 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8904166221618652
Epoch: 17, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.252 Vali Acc: 0.220 Test Loss: 3.252 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8576459884643555
Epoch: 18, Steps: 10 | Train Loss: 0.714 Vali Loss: 3.282 Vali Acc: 0.224 Test Loss: 3.282 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.791200876235962
Epoch: 19, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.313 Vali Acc: 0.238 Test Loss: 3.313 Test Acc: 0.238
Validation loss decreased (-0.227027 --> -0.237614).  Saving model ...
Epoch: 20 cost time: 2.0174400806427
Epoch: 20, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.386 Vali Acc: 0.205 Test Loss: 3.386 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8584322929382324
Epoch: 21, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.445 Vali Acc: 0.219 Test Loss: 3.445 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0409975051879883
Epoch: 22, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.460 Vali Acc: 0.234 Test Loss: 3.460 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.115018367767334
Epoch: 23, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.470 Vali Acc: 0.220 Test Loss: 3.470 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.301950454711914
Epoch: 24, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.490 Vali Acc: 0.224 Test Loss: 3.490 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.044787645339966
Epoch: 25, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.571 Vali Acc: 0.245 Test Loss: 3.571 Test Acc: 0.245
Validation loss decreased (-0.237614 --> -0.244670).  Saving model ...
Epoch: 26 cost time: 2.4970016479492188
Epoch: 26, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.711 Vali Acc: 0.236 Test Loss: 3.711 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.461031675338745
Epoch: 27, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.667 Vali Acc: 0.251 Test Loss: 3.667 Test Acc: 0.251
Validation loss decreased (-0.244670 --> -0.250552).  Saving model ...
Epoch: 28 cost time: 2.6966421604156494
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.659 Vali Acc: 0.255 Test Loss: 3.659 Test Acc: 0.255
Validation loss decreased (-0.250552 --> -0.255258).  Saving model ...
Epoch: 29 cost time: 2.5394644737243652
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.684 Vali Acc: 0.255 Test Loss: 3.684 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.486802339553833
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.746 Vali Acc: 0.252 Test Loss: 3.746 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.0984532833099365
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.687 Vali Acc: 0.265 Test Loss: 3.687 Test Acc: 0.265
Validation loss decreased (-0.255258 --> -0.264669).  Saving model ...
Epoch: 32 cost time: 2.262143611907959
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.740 Vali Acc: 0.264 Test Loss: 3.740 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.241631507873535
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.724 Vali Acc: 0.267 Test Loss: 3.724 Test Acc: 0.267
Validation loss decreased (-0.264669 --> -0.267022).  Saving model ...
Epoch: 34 cost time: 2.276087999343872
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.739 Vali Acc: 0.278 Test Loss: 3.739 Test Acc: 0.278
Validation loss decreased (-0.267022 --> -0.277610).  Saving model ...
Epoch: 35 cost time: 2.0412299633026123
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.747 Vali Acc: 0.274 Test Loss: 3.747 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.3354499340057373
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.763 Vali Acc: 0.276 Test Loss: 3.763 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.9912538528442383
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.801 Vali Acc: 0.275 Test Loss: 3.801 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.5221974849700928
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.804 Vali Acc: 0.268 Test Loss: 3.804 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.1128957271575928
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.828 Vali Acc: 0.272 Test Loss: 3.828 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.381218910217285
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.808 Vali Acc: 0.271 Test Loss: 3.808 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.474644660949707
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.821 Vali Acc: 0.279 Test Loss: 3.821 Test Acc: 0.279
Validation loss decreased (-0.277610 --> -0.278785).  Saving model ...
Epoch: 42 cost time: 2.4646055698394775
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.842 Vali Acc: 0.281 Test Loss: 3.842 Test Acc: 0.281
Validation loss decreased (-0.278785 --> -0.281138).  Saving model ...
Epoch: 43 cost time: 1.9540929794311523
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.841 Vali Acc: 0.281 Test Loss: 3.841 Test Acc: 0.281
Validation loss decreased (-0.281138 --> -0.281138).  Saving model ...
Epoch: 44 cost time: 2.519185781478882
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.845 Vali Acc: 0.278 Test Loss: 3.845 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.051057815551758
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.858 Vali Acc: 0.276 Test Loss: 3.858 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.7098827362060547
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.857 Vali Acc: 0.274 Test Loss: 3.857 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.183973550796509
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.872 Vali Acc: 0.274 Test Loss: 3.872 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.4208195209503174
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.899 Vali Acc: 0.276 Test Loss: 3.899 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.452967882156372
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.901 Vali Acc: 0.282 Test Loss: 3.901 Test Acc: 0.282
Validation loss decreased (-0.281138 --> -0.282314).  Saving model ...
Epoch: 50 cost time: 2.118398904800415
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.869 Vali Acc: 0.278 Test Loss: 3.869 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.8480358123779297
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.907 Vali Acc: 0.278 Test Loss: 3.907 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.0773813724517822
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.914 Vali Acc: 0.275 Test Loss: 3.914 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 2.0810554027557373
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.913 Vali Acc: 0.280 Test Loss: 3.913 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.7796483039855957
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.936 Vali Acc: 0.289 Test Loss: 3.936 Test Acc: 0.289
Validation loss decreased (-0.282314 --> -0.289372).  Saving model ...
Epoch: 55 cost time: 2.0482280254364014
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.940 Vali Acc: 0.286 Test Loss: 3.940 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.1145362854003906
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.940 Vali Acc: 0.285 Test Loss: 3.940 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.409205436706543
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.947 Vali Acc: 0.287 Test Loss: 3.947 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.3193585872650146
Epoch: 58, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.958 Vali Acc: 0.282 Test Loss: 3.958 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.3709566593170166
Epoch: 59, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.005 Vali Acc: 0.274 Test Loss: 4.005 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 2.2798073291778564
Epoch: 60, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.996 Vali Acc: 0.280 Test Loss: 3.996 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.9501357078552246
Epoch: 61, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.968 Vali Acc: 0.287 Test Loss: 3.968 Test Acc: 0.287
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 2.7454166412353516
Epoch: 62, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.999 Vali Acc: 0.284 Test Loss: 3.999 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 2.3061540126800537
Epoch: 63, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.016 Vali Acc: 0.285 Test Loss: 4.016 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.013270616531372
Epoch: 64, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.010 Vali Acc: 0.286 Test Loss: 4.010 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28941176470588237
model parameter : 3618390
model size : 16.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.28920841217041
Epoch: 1, Steps: 10 | Train Loss: 3.409 Vali Loss: 3.341 Vali Acc: 0.040 Test Loss: 3.341 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 2.170114517211914
Epoch: 2, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.386 Vali Acc: 0.045 Test Loss: 3.386 Test Acc: 0.045
Validation loss decreased (-0.039967 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 1.9401161670684814
Epoch: 3, Steps: 10 | Train Loss: 3.203 Vali Loss: 3.346 Vali Acc: 0.040 Test Loss: 3.346 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.067277193069458
Epoch: 4, Steps: 10 | Train Loss: 3.143 Vali Loss: 3.348 Vali Acc: 0.053 Test Loss: 3.348 Test Acc: 0.053
Validation loss decreased (-0.044672 --> -0.052908).  Saving model ...
Epoch: 5 cost time: 1.669691562652588
Epoch: 5, Steps: 10 | Train Loss: 3.071 Vali Loss: 3.312 Vali Acc: 0.084 Test Loss: 3.312 Test Acc: 0.084
Validation loss decreased (-0.052908 --> -0.083496).  Saving model ...
Epoch: 6 cost time: 1.9883482456207275
Epoch: 6, Steps: 10 | Train Loss: 2.859 Vali Loss: 3.289 Vali Acc: 0.080 Test Loss: 3.289 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9879417419433594
Epoch: 7, Steps: 10 | Train Loss: 2.705 Vali Loss: 3.273 Vali Acc: 0.112 Test Loss: 3.273 Test Acc: 0.112
Validation loss decreased (-0.083496 --> -0.111732).  Saving model ...
Epoch: 8 cost time: 1.7884516716003418
Epoch: 8, Steps: 10 | Train Loss: 2.476 Vali Loss: 3.291 Vali Acc: 0.107 Test Loss: 3.291 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.388606309890747
Epoch: 9, Steps: 10 | Train Loss: 2.286 Vali Loss: 3.256 Vali Acc: 0.132 Test Loss: 3.256 Test Acc: 0.132
Validation loss decreased (-0.111732 --> -0.131732).  Saving model ...
Epoch: 10 cost time: 1.8179161548614502
Epoch: 10, Steps: 10 | Train Loss: 2.074 Vali Loss: 3.276 Vali Acc: 0.119 Test Loss: 3.276 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0163965225219727
Epoch: 11, Steps: 10 | Train Loss: 1.913 Vali Loss: 3.246 Vali Acc: 0.144 Test Loss: 3.246 Test Acc: 0.144
Validation loss decreased (-0.131732 --> -0.143497).  Saving model ...
Epoch: 12 cost time: 2.1636581420898438
Epoch: 12, Steps: 10 | Train Loss: 1.700 Vali Loss: 3.217 Vali Acc: 0.144 Test Loss: 3.217 Test Acc: 0.144
Validation loss decreased (-0.143497 --> -0.143497).  Saving model ...
Epoch: 13 cost time: 1.7105705738067627
Epoch: 13, Steps: 10 | Train Loss: 1.503 Vali Loss: 3.180 Vali Acc: 0.171 Test Loss: 3.180 Test Acc: 0.171
Validation loss decreased (-0.143497 --> -0.170556).  Saving model ...
Epoch: 14 cost time: 2.1464731693267822
Epoch: 14, Steps: 10 | Train Loss: 1.362 Vali Loss: 3.287 Vali Acc: 0.175 Test Loss: 3.287 Test Acc: 0.175
Validation loss decreased (-0.170556 --> -0.175261).  Saving model ...
Epoch: 15 cost time: 2.0575408935546875
Epoch: 15, Steps: 10 | Train Loss: 1.157 Vali Loss: 3.252 Vali Acc: 0.193 Test Loss: 3.252 Test Acc: 0.193
Validation loss decreased (-0.175261 --> -0.192909).  Saving model ...
Epoch: 16 cost time: 2.236820697784424
Epoch: 16, Steps: 10 | Train Loss: 1.091 Vali Loss: 3.228 Vali Acc: 0.199 Test Loss: 3.228 Test Acc: 0.199
Validation loss decreased (-0.192909 --> -0.198791).  Saving model ...
Epoch: 17 cost time: 2.284433603286743
Epoch: 17, Steps: 10 | Train Loss: 0.886 Vali Loss: 3.282 Vali Acc: 0.191 Test Loss: 3.282 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.113133668899536
Epoch: 18, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.287 Vali Acc: 0.221 Test Loss: 3.287 Test Acc: 0.221
Validation loss decreased (-0.198791 --> -0.221144).  Saving model ...
Epoch: 19 cost time: 1.9170520305633545
Epoch: 19, Steps: 10 | Train Loss: 0.561 Vali Loss: 3.294 Vali Acc: 0.225 Test Loss: 3.294 Test Acc: 0.225
Validation loss decreased (-0.221144 --> -0.224673).  Saving model ...
Epoch: 20 cost time: 2.3499882221221924
Epoch: 20, Steps: 10 | Train Loss: 0.469 Vali Loss: 3.339 Vali Acc: 0.225 Test Loss: 3.339 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5199365615844727
Epoch: 21, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.410 Vali Acc: 0.219 Test Loss: 3.410 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.5498054027557373
Epoch: 22, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.447 Vali Acc: 0.234 Test Loss: 3.447 Test Acc: 0.234
Validation loss decreased (-0.224673 --> -0.234083).  Saving model ...
Epoch: 23 cost time: 2.5412261486053467
Epoch: 23, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.453 Vali Acc: 0.220 Test Loss: 3.453 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.285613536834717
Epoch: 24, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.593 Vali Acc: 0.227 Test Loss: 3.593 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.093668222427368
Epoch: 25, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.629 Vali Acc: 0.240 Test Loss: 3.629 Test Acc: 0.240
Validation loss decreased (-0.234083 --> -0.239964).  Saving model ...
Epoch: 26 cost time: 2.1527910232543945
Epoch: 26, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.630 Vali Acc: 0.226 Test Loss: 3.630 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5691967010498047
Epoch: 27, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.608 Vali Acc: 0.241 Test Loss: 3.608 Test Acc: 0.241
Validation loss decreased (-0.239964 --> -0.241140).  Saving model ...
Epoch: 28 cost time: 2.666193723678589
Epoch: 28, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.700 Vali Acc: 0.253 Test Loss: 3.700 Test Acc: 0.253
Validation loss decreased (-0.241140 --> -0.252904).  Saving model ...
Epoch: 29 cost time: 1.8469078540802002
Epoch: 29, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.779 Vali Acc: 0.238 Test Loss: 3.779 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.3027455806732178
Epoch: 30, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.649 Vali Acc: 0.258 Test Loss: 3.649 Test Acc: 0.258
Validation loss decreased (-0.252904 --> -0.257611).  Saving model ...
Epoch: 31 cost time: 2.1741302013397217
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.734 Vali Acc: 0.255 Test Loss: 3.734 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.224719524383545
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.855 Vali Acc: 0.251 Test Loss: 3.855 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.128693103790283
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.804 Vali Acc: 0.267 Test Loss: 3.804 Test Acc: 0.267
Validation loss decreased (-0.257611 --> -0.267021).  Saving model ...
Epoch: 34 cost time: 2.4862968921661377
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.789 Vali Acc: 0.260 Test Loss: 3.789 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.2583823204040527
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.818 Vali Acc: 0.261 Test Loss: 3.818 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.4132637977600098
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.846 Vali Acc: 0.266 Test Loss: 3.846 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.2410342693328857
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.881 Vali Acc: 0.260 Test Loss: 3.881 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.0713493824005127
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.843 Vali Acc: 0.274 Test Loss: 3.843 Test Acc: 0.274
Validation loss decreased (-0.267021 --> -0.274079).  Saving model ...
Epoch: 39 cost time: 2.3754544258117676
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.873 Vali Acc: 0.267 Test Loss: 3.873 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.211176633834839
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.908 Vali Acc: 0.267 Test Loss: 3.908 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.3823533058166504
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.898 Vali Acc: 0.265 Test Loss: 3.898 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.3387255668640137
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.902 Vali Acc: 0.265 Test Loss: 3.902 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.5536928176879883
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.920 Vali Acc: 0.266 Test Loss: 3.920 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.2089548110961914
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.942 Vali Acc: 0.264 Test Loss: 3.942 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.751678228378296
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.949 Vali Acc: 0.265 Test Loss: 3.949 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.388840913772583
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.917 Vali Acc: 0.271 Test Loss: 3.917 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.5136897563934326
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.936 Vali Acc: 0.267 Test Loss: 3.936 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.075192928314209
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.987 Vali Acc: 0.267 Test Loss: 3.987 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 3615062
model size : 16.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.472027778625488
Epoch: 1, Steps: 10 | Train Loss: 3.447 Vali Loss: 3.323 Vali Acc: 0.051 Test Loss: 3.323 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 2.179588556289673
Epoch: 2, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.372 Vali Acc: 0.045 Test Loss: 3.372 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2110483646392822
Epoch: 3, Steps: 10 | Train Loss: 3.261 Vali Loss: 3.376 Vali Acc: 0.047 Test Loss: 3.376 Test Acc: 0.047
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1821682453155518
Epoch: 4, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.336 Vali Acc: 0.067 Test Loss: 3.336 Test Acc: 0.067
Validation loss decreased (-0.050555 --> -0.067025).  Saving model ...
Epoch: 5 cost time: 2.487006425857544
Epoch: 5, Steps: 10 | Train Loss: 3.069 Vali Loss: 3.288 Vali Acc: 0.069 Test Loss: 3.288 Test Acc: 0.069
Validation loss decreased (-0.067025 --> -0.069379).  Saving model ...
Epoch: 6 cost time: 1.8450496196746826
Epoch: 6, Steps: 10 | Train Loss: 2.966 Vali Loss: 3.287 Vali Acc: 0.093 Test Loss: 3.287 Test Acc: 0.093
Validation loss decreased (-0.069379 --> -0.092908).  Saving model ...
Epoch: 7 cost time: 2.004331350326538
Epoch: 7, Steps: 10 | Train Loss: 2.845 Vali Loss: 3.236 Vali Acc: 0.112 Test Loss: 3.236 Test Acc: 0.112
Validation loss decreased (-0.092908 --> -0.111732).  Saving model ...
Epoch: 8 cost time: 2.294102668762207
Epoch: 8, Steps: 10 | Train Loss: 2.623 Vali Loss: 3.257 Vali Acc: 0.102 Test Loss: 3.257 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6346280574798584
Epoch: 9, Steps: 10 | Train Loss: 2.576 Vali Loss: 3.252 Vali Acc: 0.120 Test Loss: 3.252 Test Acc: 0.120
Validation loss decreased (-0.111732 --> -0.119967).  Saving model ...
Epoch: 10 cost time: 1.9603333473205566
Epoch: 10, Steps: 10 | Train Loss: 2.367 Vali Loss: 3.231 Vali Acc: 0.129 Test Loss: 3.231 Test Acc: 0.129
Validation loss decreased (-0.119967 --> -0.129379).  Saving model ...
Epoch: 11 cost time: 2.0474681854248047
Epoch: 11, Steps: 10 | Train Loss: 2.079 Vali Loss: 3.224 Vali Acc: 0.146 Test Loss: 3.224 Test Acc: 0.146
Validation loss decreased (-0.129379 --> -0.145850).  Saving model ...
Epoch: 12 cost time: 2.529888868331909
Epoch: 12, Steps: 10 | Train Loss: 1.957 Vali Loss: 3.233 Vali Acc: 0.146 Test Loss: 3.233 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1629981994628906
Epoch: 13, Steps: 10 | Train Loss: 1.707 Vali Loss: 3.178 Vali Acc: 0.176 Test Loss: 3.178 Test Acc: 0.176
Validation loss decreased (-0.145850 --> -0.176439).  Saving model ...
Epoch: 14 cost time: 3.0280399322509766
Epoch: 14, Steps: 10 | Train Loss: 1.595 Vali Loss: 3.203 Vali Acc: 0.176 Test Loss: 3.203 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3021786212921143
Epoch: 15, Steps: 10 | Train Loss: 1.390 Vali Loss: 3.219 Vali Acc: 0.179 Test Loss: 3.219 Test Acc: 0.179
Validation loss decreased (-0.176439 --> -0.178791).  Saving model ...
Epoch: 16 cost time: 2.3365442752838135
Epoch: 16, Steps: 10 | Train Loss: 1.247 Vali Loss: 3.224 Vali Acc: 0.202 Test Loss: 3.224 Test Acc: 0.202
Validation loss decreased (-0.178791 --> -0.202321).  Saving model ...
Epoch: 17 cost time: 2.2140986919403076
Epoch: 17, Steps: 10 | Train Loss: 1.138 Vali Loss: 3.187 Vali Acc: 0.194 Test Loss: 3.187 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8629467487335205
Epoch: 18, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.245 Vali Acc: 0.213 Test Loss: 3.245 Test Acc: 0.213
Validation loss decreased (-0.202321 --> -0.212909).  Saving model ...
Epoch: 19 cost time: 2.122208833694458
Epoch: 19, Steps: 10 | Train Loss: 0.809 Vali Loss: 3.305 Vali Acc: 0.196 Test Loss: 3.305 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.055935859680176
Epoch: 20, Steps: 10 | Train Loss: 0.659 Vali Loss: 3.323 Vali Acc: 0.231 Test Loss: 3.323 Test Acc: 0.231
Validation loss decreased (-0.212909 --> -0.230555).  Saving model ...
Epoch: 21 cost time: 2.1194684505462646
Epoch: 21, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.379 Vali Acc: 0.218 Test Loss: 3.379 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8939650058746338
Epoch: 22, Steps: 10 | Train Loss: 0.435 Vali Loss: 3.424 Vali Acc: 0.229 Test Loss: 3.424 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.372312068939209
Epoch: 23, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.364 Vali Acc: 0.242 Test Loss: 3.364 Test Acc: 0.242
Validation loss decreased (-0.230555 --> -0.242319).  Saving model ...
Epoch: 24 cost time: 2.2545952796936035
Epoch: 24, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.595 Vali Acc: 0.222 Test Loss: 3.595 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0059146881103516
Epoch: 25, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.526 Vali Acc: 0.236 Test Loss: 3.526 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1165237426757812
Epoch: 26, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.638 Vali Acc: 0.246 Test Loss: 3.638 Test Acc: 0.246
Validation loss decreased (-0.242319 --> -0.245846).  Saving model ...
Epoch: 27 cost time: 2.107832193374634
Epoch: 27, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.576 Vali Acc: 0.251 Test Loss: 3.576 Test Acc: 0.251
Validation loss decreased (-0.245846 --> -0.250552).  Saving model ...
Epoch: 28 cost time: 2.1871211528778076
Epoch: 28, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.674 Vali Acc: 0.233 Test Loss: 3.674 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3184757232666016
Epoch: 29, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.761 Vali Acc: 0.242 Test Loss: 3.761 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.271454095840454
Epoch: 30, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.673 Vali Acc: 0.252 Test Loss: 3.673 Test Acc: 0.252
Validation loss decreased (-0.250552 --> -0.251728).  Saving model ...
Epoch: 31 cost time: 2.4324610233306885
Epoch: 31, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.766 Vali Acc: 0.236 Test Loss: 3.766 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7899363040924072
Epoch: 32, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.809 Vali Acc: 0.260 Test Loss: 3.809 Test Acc: 0.260
Validation loss decreased (-0.251728 --> -0.259962).  Saving model ...
Epoch: 33 cost time: 2.3058178424835205
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.788 Vali Acc: 0.253 Test Loss: 3.788 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.0684380531311035
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.976 Vali Acc: 0.246 Test Loss: 3.976 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.6374683380126953
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.809 Vali Acc: 0.260 Test Loss: 3.809 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.233704090118408
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.797 Vali Acc: 0.267 Test Loss: 3.797 Test Acc: 0.267
Validation loss decreased (-0.259962 --> -0.267021).  Saving model ...
Epoch: 37 cost time: 2.270509719848633
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.822 Vali Acc: 0.264 Test Loss: 3.822 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.3105084896087646
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.843 Vali Acc: 0.272 Test Loss: 3.843 Test Acc: 0.272
Validation loss decreased (-0.267021 --> -0.271726).  Saving model ...
Epoch: 39 cost time: 2.196831703186035
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.850 Vali Acc: 0.271 Test Loss: 3.850 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.367161989212036
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.899 Vali Acc: 0.269 Test Loss: 3.899 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.9731481075286865
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.908 Vali Acc: 0.272 Test Loss: 3.908 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.015273094177246
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.919 Vali Acc: 0.269 Test Loss: 3.919 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.2113637924194336
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.910 Vali Acc: 0.274 Test Loss: 3.910 Test Acc: 0.274
Validation loss decreased (-0.271726 --> -0.274079).  Saving model ...
Epoch: 44 cost time: 2.2202959060668945
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.910 Vali Acc: 0.278 Test Loss: 3.910 Test Acc: 0.278
Validation loss decreased (-0.274079 --> -0.277608).  Saving model ...
Epoch: 45 cost time: 2.532315492630005
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.935 Vali Acc: 0.275 Test Loss: 3.935 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.248659133911133
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.941 Vali Acc: 0.274 Test Loss: 3.941 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.3999478816986084
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.957 Vali Acc: 0.269 Test Loss: 3.957 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.7073276042938232
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.973 Vali Acc: 0.266 Test Loss: 3.973 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.1892716884613037
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.976 Vali Acc: 0.268 Test Loss: 3.976 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.858492136001587
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.996 Vali Acc: 0.267 Test Loss: 3.996 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.4763078689575195
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.984 Vali Acc: 0.273 Test Loss: 3.984 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.1206445693969727
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.995 Vali Acc: 0.279 Test Loss: 3.995 Test Acc: 0.279
Validation loss decreased (-0.277608 --> -0.278784).  Saving model ...
Epoch: 53 cost time: 2.325061321258545
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.031 Vali Acc: 0.274 Test Loss: 4.031 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.4111974239349365
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.031 Vali Acc: 0.272 Test Loss: 4.031 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.24324631690979
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.027 Vali Acc: 0.271 Test Loss: 4.027 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.961669683456421
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.029 Vali Acc: 0.272 Test Loss: 4.029 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.9765534400939941
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.052 Vali Acc: 0.272 Test Loss: 4.052 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.309896230697632
Epoch: 58, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.057 Vali Acc: 0.272 Test Loss: 4.057 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 2.103675603866577
Epoch: 59, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.044 Vali Acc: 0.280 Test Loss: 4.044 Test Acc: 0.280
Validation loss decreased (-0.278784 --> -0.279960).  Saving model ...
Epoch: 60 cost time: 2.4496731758117676
Epoch: 60, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.055 Vali Acc: 0.279 Test Loss: 4.055 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.8295567035675049
Epoch: 61, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.054 Vali Acc: 0.281 Test Loss: 4.054 Test Acc: 0.281
Validation loss decreased (-0.279960 --> -0.281136).  Saving model ...
Epoch: 62 cost time: 2.199329137802124
Epoch: 62, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.077 Vali Acc: 0.281 Test Loss: 4.077 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.3449227809906006
Epoch: 63, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.108 Vali Acc: 0.271 Test Loss: 4.108 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.57547664642334
Epoch: 64, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.102 Vali Acc: 0.276 Test Loss: 4.102 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.274409055709839
Epoch: 65, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.101 Vali Acc: 0.276 Test Loss: 4.101 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 2.18760085105896
Epoch: 66, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.121 Vali Acc: 0.274 Test Loss: 4.121 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 2.2856521606445312
Epoch: 67, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.119 Vali Acc: 0.272 Test Loss: 4.119 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.9669814109802246
Epoch: 68, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.122 Vali Acc: 0.276 Test Loss: 4.122 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 2.2658231258392334
Epoch: 69, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.145 Vali Acc: 0.279 Test Loss: 4.145 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 2.2889747619628906
Epoch: 70, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.152 Vali Acc: 0.275 Test Loss: 4.152 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 2.3980212211608887
Epoch: 71, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.172 Vali Acc: 0.275 Test Loss: 4.172 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 3032918
model size : 14.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.2286057472229
Epoch: 1, Steps: 10 | Train Loss: 3.400 Vali Loss: 3.346 Vali Acc: 0.046 Test Loss: 3.346 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 2.5498671531677246
Epoch: 2, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.368 Vali Acc: 0.047 Test Loss: 3.368 Test Acc: 0.047
Validation loss decreased (-0.045849 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 2.7065272331237793
Epoch: 3, Steps: 10 | Train Loss: 3.207 Vali Loss: 3.351 Vali Acc: 0.054 Test Loss: 3.351 Test Acc: 0.054
Validation loss decreased (-0.047025 --> -0.054084).  Saving model ...
Epoch: 4 cost time: 1.9402556419372559
Epoch: 4, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.331 Vali Acc: 0.066 Test Loss: 3.331 Test Acc: 0.066
Validation loss decreased (-0.054084 --> -0.065849).  Saving model ...
Epoch: 5 cost time: 2.1560535430908203
Epoch: 5, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.267 Vali Acc: 0.099 Test Loss: 3.267 Test Acc: 0.099
Validation loss decreased (-0.065849 --> -0.098791).  Saving model ...
Epoch: 6 cost time: 2.240133047103882
Epoch: 6, Steps: 10 | Train Loss: 2.869 Vali Loss: 3.271 Vali Acc: 0.096 Test Loss: 3.271 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6000447273254395
Epoch: 7, Steps: 10 | Train Loss: 2.731 Vali Loss: 3.253 Vali Acc: 0.115 Test Loss: 3.253 Test Acc: 0.115
Validation loss decreased (-0.098791 --> -0.115262).  Saving model ...
Epoch: 8 cost time: 2.0363826751708984
Epoch: 8, Steps: 10 | Train Loss: 2.544 Vali Loss: 3.263 Vali Acc: 0.119 Test Loss: 3.263 Test Acc: 0.119
Validation loss decreased (-0.115262 --> -0.118791).  Saving model ...
Epoch: 9 cost time: 2.0791103839874268
Epoch: 9, Steps: 10 | Train Loss: 2.341 Vali Loss: 3.183 Vali Acc: 0.151 Test Loss: 3.183 Test Acc: 0.151
Validation loss decreased (-0.118791 --> -0.150556).  Saving model ...
Epoch: 10 cost time: 1.6901304721832275
Epoch: 10, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.215 Vali Acc: 0.152 Test Loss: 3.215 Test Acc: 0.152
Validation loss decreased (-0.150556 --> -0.151733).  Saving model ...
Epoch: 11 cost time: 2.2734932899475098
Epoch: 11, Steps: 10 | Train Loss: 2.045 Vali Loss: 3.193 Vali Acc: 0.161 Test Loss: 3.193 Test Acc: 0.161
Validation loss decreased (-0.151733 --> -0.161145).  Saving model ...
Epoch: 12 cost time: 1.807429552078247
Epoch: 12, Steps: 10 | Train Loss: 1.789 Vali Loss: 3.170 Vali Acc: 0.179 Test Loss: 3.170 Test Acc: 0.179
Validation loss decreased (-0.161145 --> -0.178792).  Saving model ...
Epoch: 13 cost time: 2.1722164154052734
Epoch: 13, Steps: 10 | Train Loss: 1.653 Vali Loss: 3.187 Vali Acc: 0.159 Test Loss: 3.187 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1776323318481445
Epoch: 14, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.198 Vali Acc: 0.178 Test Loss: 3.198 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2060086727142334
Epoch: 15, Steps: 10 | Train Loss: 1.376 Vali Loss: 3.196 Vali Acc: 0.198 Test Loss: 3.196 Test Acc: 0.198
Validation loss decreased (-0.178792 --> -0.197615).  Saving model ...
Epoch: 16 cost time: 2.9758434295654297
Epoch: 16, Steps: 10 | Train Loss: 1.176 Vali Loss: 3.209 Vali Acc: 0.212 Test Loss: 3.209 Test Acc: 0.212
Validation loss decreased (-0.197615 --> -0.211733).  Saving model ...
Epoch: 17 cost time: 2.502810001373291
Epoch: 17, Steps: 10 | Train Loss: 1.020 Vali Loss: 3.203 Vali Acc: 0.219 Test Loss: 3.203 Test Acc: 0.219
Validation loss decreased (-0.211733 --> -0.218791).  Saving model ...
Epoch: 18 cost time: 1.6290104389190674
Epoch: 18, Steps: 10 | Train Loss: 0.895 Vali Loss: 3.210 Vali Acc: 0.222 Test Loss: 3.210 Test Acc: 0.222
Validation loss decreased (-0.218791 --> -0.222321).  Saving model ...
Epoch: 19 cost time: 2.5767853260040283
Epoch: 19, Steps: 10 | Train Loss: 0.725 Vali Loss: 3.315 Vali Acc: 0.200 Test Loss: 3.315 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2030727863311768
Epoch: 20, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.419 Vali Acc: 0.198 Test Loss: 3.419 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.8659002780914307
Epoch: 21, Steps: 10 | Train Loss: 0.459 Vali Loss: 3.361 Vali Acc: 0.224 Test Loss: 3.361 Test Acc: 0.224
Validation loss decreased (-0.222321 --> -0.223496).  Saving model ...
Epoch: 22 cost time: 2.6381688117980957
Epoch: 22, Steps: 10 | Train Loss: 0.419 Vali Loss: 3.469 Vali Acc: 0.215 Test Loss: 3.469 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.142279624938965
Epoch: 23, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.506 Vali Acc: 0.219 Test Loss: 3.506 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2806396484375
Epoch: 24, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.624 Vali Acc: 0.221 Test Loss: 3.624 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.305931329727173
Epoch: 25, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.658 Vali Acc: 0.227 Test Loss: 3.658 Test Acc: 0.227
Validation loss decreased (-0.223496 --> -0.227022).  Saving model ...
Epoch: 26 cost time: 2.395015239715576
Epoch: 26, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.645 Vali Acc: 0.231 Test Loss: 3.645 Test Acc: 0.231
Validation loss decreased (-0.227022 --> -0.230552).  Saving model ...
Epoch: 27 cost time: 2.7556393146514893
Epoch: 27, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.866 Vali Acc: 0.209 Test Loss: 3.866 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.546215057373047
Epoch: 28, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.740 Vali Acc: 0.239 Test Loss: 3.740 Test Acc: 0.239
Validation loss decreased (-0.230552 --> -0.238786).  Saving model ...
Epoch: 29 cost time: 2.5071730613708496
Epoch: 29, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.754 Vali Acc: 0.227 Test Loss: 3.754 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.254761219024658
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.879 Vali Acc: 0.234 Test Loss: 3.879 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.252052068710327
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.928 Vali Acc: 0.245 Test Loss: 3.928 Test Acc: 0.245
Validation loss decreased (-0.238786 --> -0.244667).  Saving model ...
Epoch: 32 cost time: 2.75277042388916
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.903 Vali Acc: 0.246 Test Loss: 3.903 Test Acc: 0.246
Validation loss decreased (-0.244667 --> -0.245843).  Saving model ...
Epoch: 33 cost time: 1.7751293182373047
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.982 Vali Acc: 0.247 Test Loss: 3.982 Test Acc: 0.247
Validation loss decreased (-0.245843 --> -0.247019).  Saving model ...
Epoch: 34 cost time: 1.8495004177093506
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.946 Vali Acc: 0.252 Test Loss: 3.946 Test Acc: 0.252
Validation loss decreased (-0.247019 --> -0.251725).  Saving model ...
Epoch: 35 cost time: 2.053288698196411
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.977 Vali Acc: 0.252 Test Loss: 3.977 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.843355417251587
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.983 Vali Acc: 0.241 Test Loss: 3.983 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.6998176574707031
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.985 Vali Acc: 0.258 Test Loss: 3.985 Test Acc: 0.258
Validation loss decreased (-0.251725 --> -0.257607).  Saving model ...
Epoch: 38 cost time: 2.305950164794922
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.006 Vali Acc: 0.251 Test Loss: 4.006 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.0596277713775635
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.037 Vali Acc: 0.249 Test Loss: 4.037 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.0965089797973633
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.050 Vali Acc: 0.256 Test Loss: 4.050 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8978300094604492
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.033 Vali Acc: 0.258 Test Loss: 4.033 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.396031379699707
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.035 Vali Acc: 0.255 Test Loss: 4.035 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.273533582687378
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.063 Vali Acc: 0.252 Test Loss: 4.063 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.0898821353912354
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.082 Vali Acc: 0.255 Test Loss: 4.082 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.8952596187591553
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.095 Vali Acc: 0.255 Test Loss: 4.095 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.3444952964782715
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.101 Vali Acc: 0.249 Test Loss: 4.101 Test Acc: 0.249
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.428892135620117
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.138 Vali Acc: 0.256 Test Loss: 4.138 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 3029590
model size : 14.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.419520854949951
Epoch: 1, Steps: 10 | Train Loss: 3.443 Vali Loss: 3.317 Vali Acc: 0.046 Test Loss: 3.317 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 2.515737533569336
Epoch: 2, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.378 Vali Acc: 0.040 Test Loss: 3.378 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.01098895072937
Epoch: 3, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.385 Vali Acc: 0.045 Test Loss: 3.385 Test Acc: 0.045
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.159456729888916
Epoch: 4, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.309 Vali Acc: 0.081 Test Loss: 3.309 Test Acc: 0.081
Validation loss decreased (-0.045849 --> -0.081143).  Saving model ...
Epoch: 5 cost time: 2.266126871109009
Epoch: 5, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.272 Vali Acc: 0.066 Test Loss: 3.272 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4343395233154297
Epoch: 6, Steps: 10 | Train Loss: 2.895 Vali Loss: 3.284 Vali Acc: 0.084 Test Loss: 3.284 Test Acc: 0.084
Validation loss decreased (-0.081143 --> -0.083497).  Saving model ...
Epoch: 7 cost time: 1.9980933666229248
Epoch: 7, Steps: 10 | Train Loss: 2.792 Vali Loss: 3.248 Vali Acc: 0.100 Test Loss: 3.248 Test Acc: 0.100
Validation loss decreased (-0.083497 --> -0.099968).  Saving model ...
Epoch: 8 cost time: 2.461423397064209
Epoch: 8, Steps: 10 | Train Loss: 2.607 Vali Loss: 3.259 Vali Acc: 0.119 Test Loss: 3.259 Test Acc: 0.119
Validation loss decreased (-0.099968 --> -0.118791).  Saving model ...
Epoch: 9 cost time: 2.220459222793579
Epoch: 9, Steps: 10 | Train Loss: 2.443 Vali Loss: 3.248 Vali Acc: 0.128 Test Loss: 3.248 Test Acc: 0.128
Validation loss decreased (-0.118791 --> -0.128203).  Saving model ...
Epoch: 10 cost time: 2.2845427989959717
Epoch: 10, Steps: 10 | Train Loss: 2.201 Vali Loss: 3.239 Vali Acc: 0.140 Test Loss: 3.239 Test Acc: 0.140
Validation loss decreased (-0.128203 --> -0.139968).  Saving model ...
Epoch: 11 cost time: 1.9691762924194336
Epoch: 11, Steps: 10 | Train Loss: 1.994 Vali Loss: 3.226 Vali Acc: 0.153 Test Loss: 3.226 Test Acc: 0.153
Validation loss decreased (-0.139968 --> -0.152909).  Saving model ...
Epoch: 12 cost time: 2.171570062637329
Epoch: 12, Steps: 10 | Train Loss: 1.836 Vali Loss: 3.212 Vali Acc: 0.182 Test Loss: 3.212 Test Acc: 0.182
Validation loss decreased (-0.152909 --> -0.182321).  Saving model ...
Epoch: 13 cost time: 2.109222650527954
Epoch: 13, Steps: 10 | Train Loss: 1.663 Vali Loss: 3.207 Vali Acc: 0.174 Test Loss: 3.207 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4905686378479004
Epoch: 14, Steps: 10 | Train Loss: 1.475 Vali Loss: 3.187 Vali Acc: 0.188 Test Loss: 3.187 Test Acc: 0.188
Validation loss decreased (-0.182321 --> -0.188203).  Saving model ...
Epoch: 15 cost time: 2.0002293586730957
Epoch: 15, Steps: 10 | Train Loss: 1.321 Vali Loss: 3.199 Vali Acc: 0.221 Test Loss: 3.199 Test Acc: 0.221
Validation loss decreased (-0.188203 --> -0.221144).  Saving model ...
Epoch: 16 cost time: 2.585017442703247
Epoch: 16, Steps: 10 | Train Loss: 1.172 Vali Loss: 3.246 Vali Acc: 0.178 Test Loss: 3.246 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.128532648086548
Epoch: 17, Steps: 10 | Train Loss: 1.119 Vali Loss: 3.299 Vali Acc: 0.176 Test Loss: 3.299 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.249283790588379
Epoch: 18, Steps: 10 | Train Loss: 0.880 Vali Loss: 3.229 Vali Acc: 0.212 Test Loss: 3.229 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0429418087005615
Epoch: 19, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.326 Vali Acc: 0.205 Test Loss: 3.326 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9795689582824707
Epoch: 20, Steps: 10 | Train Loss: 0.589 Vali Loss: 3.376 Vali Acc: 0.191 Test Loss: 3.376 Test Acc: 0.191
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.145108222961426
Epoch: 21, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.363 Vali Acc: 0.226 Test Loss: 3.363 Test Acc: 0.226
Validation loss decreased (-0.221144 --> -0.225849).  Saving model ...
Epoch: 22 cost time: 2.2099227905273438
Epoch: 22, Steps: 10 | Train Loss: 0.372 Vali Loss: 3.424 Vali Acc: 0.227 Test Loss: 3.424 Test Acc: 0.227
Validation loss decreased (-0.225849 --> -0.227025).  Saving model ...
Epoch: 23 cost time: 2.3972537517547607
Epoch: 23, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.419 Vali Acc: 0.249 Test Loss: 3.419 Test Acc: 0.249
Validation loss decreased (-0.227025 --> -0.249378).  Saving model ...
Epoch: 24 cost time: 2.008782148361206
Epoch: 24, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.525 Vali Acc: 0.216 Test Loss: 3.525 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.138899803161621
Epoch: 25, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.528 Vali Acc: 0.247 Test Loss: 3.528 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.3398220539093018
Epoch: 26, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.630 Vali Acc: 0.238 Test Loss: 3.630 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.105632781982422
Epoch: 27, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.658 Vali Acc: 0.253 Test Loss: 3.658 Test Acc: 0.253
Validation loss decreased (-0.249378 --> -0.252905).  Saving model ...
Epoch: 28 cost time: 2.5295846462249756
Epoch: 28, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.608 Vali Acc: 0.251 Test Loss: 3.608 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.102062940597534
Epoch: 29, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.765 Vali Acc: 0.253 Test Loss: 3.765 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.2037394046783447
Epoch: 30, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.777 Vali Acc: 0.262 Test Loss: 3.777 Test Acc: 0.262
Validation loss decreased (-0.252905 --> -0.262315).  Saving model ...
Epoch: 31 cost time: 1.8454434871673584
Epoch: 31, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.690 Vali Acc: 0.276 Test Loss: 3.690 Test Acc: 0.276
Validation loss decreased (-0.262315 --> -0.276434).  Saving model ...
Epoch: 32 cost time: 2.601534843444824
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.784 Vali Acc: 0.268 Test Loss: 3.784 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.466198205947876
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.857 Vali Acc: 0.265 Test Loss: 3.857 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.4701426029205322
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.864 Vali Acc: 0.268 Test Loss: 3.864 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.153318166732788
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.859 Vali Acc: 0.266 Test Loss: 3.859 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.2280757427215576
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.872 Vali Acc: 0.266 Test Loss: 3.872 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.1603496074676514
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.890 Vali Acc: 0.275 Test Loss: 3.890 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.5406253337860107
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.912 Vali Acc: 0.274 Test Loss: 3.912 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.2081539630889893
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.939 Vali Acc: 0.267 Test Loss: 3.939 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.181882619857788
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.945 Vali Acc: 0.271 Test Loss: 3.945 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.2512729167938232
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.939 Vali Acc: 0.282 Test Loss: 3.939 Test Acc: 0.282
Validation loss decreased (-0.276434 --> -0.282314).  Saving model ...
Epoch: 42 cost time: 2.0508389472961426
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.936 Vali Acc: 0.278 Test Loss: 3.936 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.478553056716919
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.937 Vali Acc: 0.279 Test Loss: 3.937 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.851410150527954
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.953 Vali Acc: 0.276 Test Loss: 3.953 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.2923200130462646
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.987 Vali Acc: 0.273 Test Loss: 3.987 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.5802903175354004
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.986 Vali Acc: 0.275 Test Loss: 3.986 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.118964672088623
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.993 Vali Acc: 0.276 Test Loss: 3.993 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.4554669857025146
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.009 Vali Acc: 0.278 Test Loss: 4.009 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.1458218097686768
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.027 Vali Acc: 0.284 Test Loss: 4.027 Test Acc: 0.284
Validation loss decreased (-0.282314 --> -0.283489).  Saving model ...
Epoch: 50 cost time: 2.541170120239258
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.043 Vali Acc: 0.278 Test Loss: 4.043 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.707109212875366
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.046 Vali Acc: 0.275 Test Loss: 4.046 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.5405256748199463
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.039 Vali Acc: 0.279 Test Loss: 4.039 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 2.229722738265991
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.051 Vali Acc: 0.284 Test Loss: 4.051 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.1641063690185547
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.078 Vali Acc: 0.282 Test Loss: 4.078 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.9717917442321777
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.080 Vali Acc: 0.275 Test Loss: 4.080 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 2.196410894393921
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.056 Vali Acc: 0.276 Test Loss: 4.056 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.9799270629882812
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.085 Vali Acc: 0.275 Test Loss: 4.085 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 2.0736684799194336
Epoch: 58, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.083 Vali Acc: 0.275 Test Loss: 4.083 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 2.1421151161193848
Epoch: 59, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.105 Vali Acc: 0.276 Test Loss: 4.105 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 3026262
model size : 14.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7461295127868652
Epoch: 1, Steps: 10 | Train Loss: 3.413 Vali Loss: 3.339 Vali Acc: 0.036 Test Loss: 3.339 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.7901842594146729
Epoch: 2, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.369 Vali Acc: 0.047 Test Loss: 3.369 Test Acc: 0.047
Validation loss decreased (-0.036437 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 1.8724522590637207
Epoch: 3, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.363 Vali Acc: 0.068 Test Loss: 3.363 Test Acc: 0.068
Validation loss decreased (-0.047025 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 2.106647253036499
Epoch: 4, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.336 Vali Acc: 0.060 Test Loss: 3.336 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7630112171173096
Epoch: 5, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.296 Vali Acc: 0.089 Test Loss: 3.296 Test Acc: 0.089
Validation loss decreased (-0.068202 --> -0.089379).  Saving model ...
Epoch: 6 cost time: 1.9345965385437012
Epoch: 6, Steps: 10 | Train Loss: 3.002 Vali Loss: 3.257 Vali Acc: 0.091 Test Loss: 3.257 Test Acc: 0.091
Validation loss decreased (-0.089379 --> -0.090556).  Saving model ...
Epoch: 7 cost time: 2.024473190307617
Epoch: 7, Steps: 10 | Train Loss: 2.834 Vali Loss: 3.299 Vali Acc: 0.098 Test Loss: 3.299 Test Acc: 0.098
Validation loss decreased (-0.090556 --> -0.097614).  Saving model ...
Epoch: 8 cost time: 1.8799526691436768
Epoch: 8, Steps: 10 | Train Loss: 2.689 Vali Loss: 3.262 Vali Acc: 0.118 Test Loss: 3.262 Test Acc: 0.118
Validation loss decreased (-0.097614 --> -0.117614).  Saving model ...
Epoch: 9 cost time: 1.978548288345337
Epoch: 9, Steps: 10 | Train Loss: 2.472 Vali Loss: 3.242 Vali Acc: 0.132 Test Loss: 3.242 Test Acc: 0.132
Validation loss decreased (-0.117614 --> -0.131732).  Saving model ...
Epoch: 10 cost time: 1.8510119915008545
Epoch: 10, Steps: 10 | Train Loss: 2.252 Vali Loss: 3.267 Vali Acc: 0.141 Test Loss: 3.267 Test Acc: 0.141
Validation loss decreased (-0.131732 --> -0.141144).  Saving model ...
Epoch: 11 cost time: 2.0179619789123535
Epoch: 11, Steps: 10 | Train Loss: 2.104 Vali Loss: 3.237 Vali Acc: 0.144 Test Loss: 3.237 Test Acc: 0.144
Validation loss decreased (-0.141144 --> -0.143497).  Saving model ...
Epoch: 12 cost time: 1.5630125999450684
Epoch: 12, Steps: 10 | Train Loss: 1.938 Vali Loss: 3.210 Vali Acc: 0.179 Test Loss: 3.210 Test Acc: 0.179
Validation loss decreased (-0.143497 --> -0.178791).  Saving model ...
Epoch: 13 cost time: 1.9661662578582764
Epoch: 13, Steps: 10 | Train Loss: 1.698 Vali Loss: 3.246 Vali Acc: 0.155 Test Loss: 3.246 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.063703775405884
Epoch: 14, Steps: 10 | Train Loss: 1.465 Vali Loss: 3.215 Vali Acc: 0.184 Test Loss: 3.215 Test Acc: 0.184
Validation loss decreased (-0.178791 --> -0.183497).  Saving model ...
Epoch: 15 cost time: 1.7261881828308105
Epoch: 15, Steps: 10 | Train Loss: 1.416 Vali Loss: 3.228 Vali Acc: 0.194 Test Loss: 3.228 Test Acc: 0.194
Validation loss decreased (-0.183497 --> -0.194085).  Saving model ...
Epoch: 16 cost time: 1.7135183811187744
Epoch: 16, Steps: 10 | Train Loss: 1.206 Vali Loss: 3.239 Vali Acc: 0.189 Test Loss: 3.239 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0899322032928467
Epoch: 17, Steps: 10 | Train Loss: 1.095 Vali Loss: 3.247 Vali Acc: 0.212 Test Loss: 3.247 Test Acc: 0.212
Validation loss decreased (-0.194085 --> -0.211732).  Saving model ...
Epoch: 18 cost time: 1.8730084896087646
Epoch: 18, Steps: 10 | Train Loss: 0.943 Vali Loss: 3.347 Vali Acc: 0.205 Test Loss: 3.347 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.211232900619507
Epoch: 19, Steps: 10 | Train Loss: 0.765 Vali Loss: 3.274 Vali Acc: 0.211 Test Loss: 3.274 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7027356624603271
Epoch: 20, Steps: 10 | Train Loss: 0.664 Vali Loss: 3.284 Vali Acc: 0.221 Test Loss: 3.284 Test Acc: 0.221
Validation loss decreased (-0.211732 --> -0.221144).  Saving model ...
Epoch: 21 cost time: 2.113069534301758
Epoch: 21, Steps: 10 | Train Loss: 0.573 Vali Loss: 3.471 Vali Acc: 0.193 Test Loss: 3.471 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.943692922592163
Epoch: 22, Steps: 10 | Train Loss: 0.421 Vali Loss: 3.410 Vali Acc: 0.228 Test Loss: 3.410 Test Acc: 0.228
Validation loss decreased (-0.221144 --> -0.228201).  Saving model ...
Epoch: 23 cost time: 2.00947904586792
Epoch: 23, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.431 Vali Acc: 0.247 Test Loss: 3.431 Test Acc: 0.247
Validation loss decreased (-0.228201 --> -0.247025).  Saving model ...
Epoch: 24 cost time: 2.020735740661621
Epoch: 24, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.512 Vali Acc: 0.231 Test Loss: 3.512 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5656547546386719
Epoch: 25, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.509 Vali Acc: 0.240 Test Loss: 3.509 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.262852907180786
Epoch: 26, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.633 Vali Acc: 0.253 Test Loss: 3.633 Test Acc: 0.253
Validation loss decreased (-0.247025 --> -0.252905).  Saving model ...
Epoch: 27 cost time: 1.5496747493743896
Epoch: 27, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.658 Vali Acc: 0.247 Test Loss: 3.658 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6814093589782715
Epoch: 28, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.613 Vali Acc: 0.261 Test Loss: 3.613 Test Acc: 0.261
Validation loss decreased (-0.252905 --> -0.261140).  Saving model ...
Epoch: 29 cost time: 1.8356010913848877
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.748 Vali Acc: 0.249 Test Loss: 3.748 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0757017135620117
Epoch: 30, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.751 Vali Acc: 0.261 Test Loss: 3.751 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9633474349975586
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.777 Vali Acc: 0.255 Test Loss: 3.777 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6665432453155518
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.840 Vali Acc: 0.252 Test Loss: 3.840 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7220776081085205
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.838 Vali Acc: 0.260 Test Loss: 3.838 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.9659879207611084
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.838 Vali Acc: 0.259 Test Loss: 3.838 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.857285737991333
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.857 Vali Acc: 0.264 Test Loss: 3.857 Test Acc: 0.264
Validation loss decreased (-0.261140 --> -0.263491).  Saving model ...
Epoch: 36 cost time: 1.8330445289611816
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.868 Vali Acc: 0.265 Test Loss: 3.868 Test Acc: 0.265
Validation loss decreased (-0.263491 --> -0.264667).  Saving model ...
Epoch: 37 cost time: 1.6772630214691162
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.889 Vali Acc: 0.264 Test Loss: 3.889 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.9744303226470947
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.880 Vali Acc: 0.265 Test Loss: 3.880 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.9946610927581787
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.942 Vali Acc: 0.268 Test Loss: 3.942 Test Acc: 0.268
Validation loss decreased (-0.264667 --> -0.268196).  Saving model ...
Epoch: 40 cost time: 2.1335971355438232
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.941 Vali Acc: 0.254 Test Loss: 3.941 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.795520305633545
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.947 Vali Acc: 0.262 Test Loss: 3.947 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8712725639343262
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.935 Vali Acc: 0.260 Test Loss: 3.935 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.097052574157715
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.933 Vali Acc: 0.264 Test Loss: 3.933 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.755760908126831
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.968 Vali Acc: 0.258 Test Loss: 3.968 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.6355540752410889
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.976 Vali Acc: 0.266 Test Loss: 3.976 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.6663877964019775
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.005 Vali Acc: 0.267 Test Loss: 4.005 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.0070576667785645
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.967 Vali Acc: 0.267 Test Loss: 3.967 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.5549728870391846
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.990 Vali Acc: 0.264 Test Loss: 3.990 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.2017102241516113
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.006 Vali Acc: 0.268 Test Loss: 4.006 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 3022934
model size : 14.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.118934154510498
Epoch: 1, Steps: 10 | Train Loss: 3.423 Vali Loss: 3.329 Vali Acc: 0.044 Test Loss: 3.329 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 2.221137523651123
Epoch: 2, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.349 Vali Acc: 0.041 Test Loss: 3.349 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.687434196472168
Epoch: 3, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.379 Vali Acc: 0.052 Test Loss: 3.379 Test Acc: 0.052
Validation loss decreased (-0.043496 --> -0.051731).  Saving model ...
Epoch: 4 cost time: 1.6944785118103027
Epoch: 4, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.361 Vali Acc: 0.059 Test Loss: 3.361 Test Acc: 0.059
Validation loss decreased (-0.051731 --> -0.058790).  Saving model ...
Epoch: 5 cost time: 1.712235450744629
Epoch: 5, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.343 Vali Acc: 0.074 Test Loss: 3.343 Test Acc: 0.074
Validation loss decreased (-0.058790 --> -0.074084).  Saving model ...
Epoch: 6 cost time: 1.6484105587005615
Epoch: 6, Steps: 10 | Train Loss: 2.891 Vali Loss: 3.318 Vali Acc: 0.099 Test Loss: 3.318 Test Acc: 0.099
Validation loss decreased (-0.074084 --> -0.098790).  Saving model ...
Epoch: 7 cost time: 1.9350242614746094
Epoch: 7, Steps: 10 | Train Loss: 2.695 Vali Loss: 3.289 Vali Acc: 0.109 Test Loss: 3.289 Test Acc: 0.109
Validation loss decreased (-0.098790 --> -0.109379).  Saving model ...
Epoch: 8 cost time: 1.5816092491149902
Epoch: 8, Steps: 10 | Train Loss: 2.573 Vali Loss: 3.304 Vali Acc: 0.109 Test Loss: 3.304 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5668208599090576
Epoch: 9, Steps: 10 | Train Loss: 2.388 Vali Loss: 3.302 Vali Acc: 0.126 Test Loss: 3.302 Test Acc: 0.126
Validation loss decreased (-0.109379 --> -0.125849).  Saving model ...
Epoch: 10 cost time: 1.7745707035064697
Epoch: 10, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.288 Vali Acc: 0.129 Test Loss: 3.288 Test Acc: 0.129
Validation loss decreased (-0.125849 --> -0.129379).  Saving model ...
Epoch: 11 cost time: 1.650277853012085
Epoch: 11, Steps: 10 | Train Loss: 2.043 Vali Loss: 3.260 Vali Acc: 0.156 Test Loss: 3.260 Test Acc: 0.156
Validation loss decreased (-0.129379 --> -0.156438).  Saving model ...
Epoch: 12 cost time: 2.081347942352295
Epoch: 12, Steps: 10 | Train Loss: 1.869 Vali Loss: 3.302 Vali Acc: 0.129 Test Loss: 3.302 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7928555011749268
Epoch: 13, Steps: 10 | Train Loss: 1.765 Vali Loss: 3.231 Vali Acc: 0.173 Test Loss: 3.231 Test Acc: 0.173
Validation loss decreased (-0.156438 --> -0.172909).  Saving model ...
Epoch: 14 cost time: 2.489671230316162
Epoch: 14, Steps: 10 | Train Loss: 1.558 Vali Loss: 3.296 Vali Acc: 0.165 Test Loss: 3.296 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2010440826416016
Epoch: 15, Steps: 10 | Train Loss: 1.394 Vali Loss: 3.270 Vali Acc: 0.166 Test Loss: 3.270 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1190762519836426
Epoch: 16, Steps: 10 | Train Loss: 1.226 Vali Loss: 3.266 Vali Acc: 0.172 Test Loss: 3.266 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.029792070388794
Epoch: 17, Steps: 10 | Train Loss: 1.081 Vali Loss: 3.329 Vali Acc: 0.188 Test Loss: 3.329 Test Acc: 0.188
Validation loss decreased (-0.172909 --> -0.188202).  Saving model ...
Epoch: 18 cost time: 2.0573747158050537
Epoch: 18, Steps: 10 | Train Loss: 0.941 Vali Loss: 3.366 Vali Acc: 0.192 Test Loss: 3.366 Test Acc: 0.192
Validation loss decreased (-0.188202 --> -0.191731).  Saving model ...
Epoch: 19 cost time: 2.478220224380493
Epoch: 19, Steps: 10 | Train Loss: 0.804 Vali Loss: 3.284 Vali Acc: 0.204 Test Loss: 3.284 Test Acc: 0.204
Validation loss decreased (-0.191731 --> -0.203497).  Saving model ...
Epoch: 20 cost time: 2.230046033859253
Epoch: 20, Steps: 10 | Train Loss: 0.639 Vali Loss: 3.463 Vali Acc: 0.189 Test Loss: 3.463 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.016666889190674
Epoch: 21, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.413 Vali Acc: 0.198 Test Loss: 3.413 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.330261468887329
Epoch: 22, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.588 Vali Acc: 0.198 Test Loss: 3.588 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9224860668182373
Epoch: 23, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.495 Vali Acc: 0.224 Test Loss: 3.495 Test Acc: 0.224
Validation loss decreased (-0.203497 --> -0.223494).  Saving model ...
Epoch: 24 cost time: 2.2864983081817627
Epoch: 24, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.630 Vali Acc: 0.213 Test Loss: 3.630 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.375338554382324
Epoch: 25, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.686 Vali Acc: 0.215 Test Loss: 3.686 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.291624069213867
Epoch: 26, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.686 Vali Acc: 0.211 Test Loss: 3.686 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.653238534927368
Epoch: 27, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.766 Vali Acc: 0.231 Test Loss: 3.766 Test Acc: 0.231
Validation loss decreased (-0.223494 --> -0.230551).  Saving model ...
Epoch: 28 cost time: 2.0774757862091064
Epoch: 28, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.985 Vali Acc: 0.208 Test Loss: 3.985 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2516987323760986
Epoch: 29, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.909 Vali Acc: 0.229 Test Loss: 3.909 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.5122108459472656
Epoch: 30, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.901 Vali Acc: 0.232 Test Loss: 3.901 Test Acc: 0.232
Validation loss decreased (-0.230551 --> -0.231726).  Saving model ...
Epoch: 31 cost time: 2.1624646186828613
Epoch: 31, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.934 Vali Acc: 0.222 Test Loss: 3.934 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.172013521194458
Epoch: 32, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.930 Vali Acc: 0.235 Test Loss: 3.930 Test Acc: 0.235
Validation loss decreased (-0.231726 --> -0.235255).  Saving model ...
Epoch: 33 cost time: 2.5891005992889404
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.946 Vali Acc: 0.239 Test Loss: 3.946 Test Acc: 0.239
Validation loss decreased (-0.235255 --> -0.238784).  Saving model ...
Epoch: 34 cost time: 2.2597503662109375
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.969 Vali Acc: 0.241 Test Loss: 3.969 Test Acc: 0.241
Validation loss decreased (-0.238784 --> -0.241137).  Saving model ...
Epoch: 35 cost time: 2.4730489253997803
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.963 Vali Acc: 0.249 Test Loss: 3.963 Test Acc: 0.249
Validation loss decreased (-0.241137 --> -0.249372).  Saving model ...
Epoch: 36 cost time: 2.1540284156799316
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.007 Vali Acc: 0.242 Test Loss: 4.007 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.512690544128418
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.992 Vali Acc: 0.247 Test Loss: 3.992 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.4036974906921387
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.039 Vali Acc: 0.249 Test Loss: 4.039 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.7664175033569336
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.030 Vali Acc: 0.258 Test Loss: 4.030 Test Acc: 0.258
Validation loss decreased (-0.249372 --> -0.257607).  Saving model ...
Epoch: 40 cost time: 2.2663283348083496
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.067 Vali Acc: 0.247 Test Loss: 4.067 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.5669071674346924
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.098 Vali Acc: 0.253 Test Loss: 4.098 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.4020328521728516
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.083 Vali Acc: 0.252 Test Loss: 4.083 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.404379367828369
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.094 Vali Acc: 0.254 Test Loss: 4.094 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.941739320755005
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.112 Vali Acc: 0.251 Test Loss: 4.112 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.161449670791626
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.137 Vali Acc: 0.247 Test Loss: 4.137 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.2643494606018066
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.130 Vali Acc: 0.252 Test Loss: 4.130 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.2300539016723633
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.138 Vali Acc: 0.245 Test Loss: 4.138 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.0313808917999268
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.133 Vali Acc: 0.253 Test Loss: 4.133 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.1276347637176514
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.179 Vali Acc: 0.252 Test Loss: 4.179 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 2736854
model size : 13.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.994654417037964
Epoch: 1, Steps: 10 | Train Loss: 3.452 Vali Loss: 3.306 Vali Acc: 0.048 Test Loss: 3.306 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 2.267308235168457
Epoch: 2, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.354 Vali Acc: 0.041 Test Loss: 3.354 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7832841873168945
Epoch: 3, Steps: 10 | Train Loss: 3.178 Vali Loss: 3.376 Vali Acc: 0.061 Test Loss: 3.376 Test Acc: 0.061
Validation loss decreased (-0.048202 --> -0.061143).  Saving model ...
Epoch: 4 cost time: 2.15238094329834
Epoch: 4, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.324 Vali Acc: 0.048 Test Loss: 3.324 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.148606061935425
Epoch: 5, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.275 Vali Acc: 0.081 Test Loss: 3.275 Test Acc: 0.081
Validation loss decreased (-0.061143 --> -0.081144).  Saving model ...
Epoch: 6 cost time: 2.376042127609253
Epoch: 6, Steps: 10 | Train Loss: 2.951 Vali Loss: 3.262 Vali Acc: 0.082 Test Loss: 3.262 Test Acc: 0.082
Validation loss decreased (-0.081144 --> -0.082320).  Saving model ...
Epoch: 7 cost time: 2.087897539138794
Epoch: 7, Steps: 10 | Train Loss: 2.804 Vali Loss: 3.254 Vali Acc: 0.086 Test Loss: 3.254 Test Acc: 0.086
Validation loss decreased (-0.082320 --> -0.085850).  Saving model ...
Epoch: 8 cost time: 1.9118809700012207
Epoch: 8, Steps: 10 | Train Loss: 2.629 Vali Loss: 3.234 Vali Acc: 0.105 Test Loss: 3.234 Test Acc: 0.105
Validation loss decreased (-0.085850 --> -0.104674).  Saving model ...
Epoch: 9 cost time: 2.0502877235412598
Epoch: 9, Steps: 10 | Train Loss: 2.448 Vali Loss: 3.197 Vali Acc: 0.129 Test Loss: 3.197 Test Acc: 0.129
Validation loss decreased (-0.104674 --> -0.129380).  Saving model ...
Epoch: 10 cost time: 2.0784623622894287
Epoch: 10, Steps: 10 | Train Loss: 2.273 Vali Loss: 3.173 Vali Acc: 0.135 Test Loss: 3.173 Test Acc: 0.135
Validation loss decreased (-0.129380 --> -0.135262).  Saving model ...
Epoch: 11 cost time: 1.9474575519561768
Epoch: 11, Steps: 10 | Train Loss: 2.086 Vali Loss: 3.223 Vali Acc: 0.152 Test Loss: 3.223 Test Acc: 0.152
Validation loss decreased (-0.135262 --> -0.151732).  Saving model ...
Epoch: 12 cost time: 1.9636106491088867
Epoch: 12, Steps: 10 | Train Loss: 1.908 Vali Loss: 3.179 Vali Acc: 0.168 Test Loss: 3.179 Test Acc: 0.168
Validation loss decreased (-0.151732 --> -0.168204).  Saving model ...
Epoch: 13 cost time: 1.877213478088379
Epoch: 13, Steps: 10 | Train Loss: 1.738 Vali Loss: 3.173 Vali Acc: 0.173 Test Loss: 3.173 Test Acc: 0.173
Validation loss decreased (-0.168204 --> -0.172909).  Saving model ...
Epoch: 14 cost time: 2.4365968704223633
Epoch: 14, Steps: 10 | Train Loss: 1.601 Vali Loss: 3.210 Vali Acc: 0.174 Test Loss: 3.210 Test Acc: 0.174
Validation loss decreased (-0.172909 --> -0.174086).  Saving model ...
Epoch: 15 cost time: 1.7600138187408447
Epoch: 15, Steps: 10 | Train Loss: 1.404 Vali Loss: 3.173 Vali Acc: 0.192 Test Loss: 3.173 Test Acc: 0.192
Validation loss decreased (-0.174086 --> -0.191733).  Saving model ...
Epoch: 16 cost time: 2.2682230472564697
Epoch: 16, Steps: 10 | Train Loss: 1.310 Vali Loss: 3.203 Vali Acc: 0.194 Test Loss: 3.203 Test Acc: 0.194
Validation loss decreased (-0.191733 --> -0.194086).  Saving model ...
Epoch: 17 cost time: 2.437690496444702
Epoch: 17, Steps: 10 | Train Loss: 1.114 Vali Loss: 3.245 Vali Acc: 0.194 Test Loss: 3.245 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.738396167755127
Epoch: 18, Steps: 10 | Train Loss: 0.986 Vali Loss: 3.207 Vali Acc: 0.212 Test Loss: 3.207 Test Acc: 0.212
Validation loss decreased (-0.194086 --> -0.211733).  Saving model ...
Epoch: 19 cost time: 2.2432262897491455
Epoch: 19, Steps: 10 | Train Loss: 0.782 Vali Loss: 3.232 Vali Acc: 0.206 Test Loss: 3.232 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4201254844665527
Epoch: 20, Steps: 10 | Train Loss: 0.697 Vali Loss: 3.324 Vali Acc: 0.213 Test Loss: 3.324 Test Acc: 0.213
Validation loss decreased (-0.211733 --> -0.212908).  Saving model ...
Epoch: 21 cost time: 2.2355806827545166
Epoch: 21, Steps: 10 | Train Loss: 0.615 Vali Loss: 3.318 Vali Acc: 0.216 Test Loss: 3.318 Test Acc: 0.216
Validation loss decreased (-0.212908 --> -0.216437).  Saving model ...
Epoch: 22 cost time: 1.9612698554992676
Epoch: 22, Steps: 10 | Train Loss: 0.565 Vali Loss: 3.394 Vali Acc: 0.218 Test Loss: 3.394 Test Acc: 0.218
Validation loss decreased (-0.216437 --> -0.217613).  Saving model ...
Epoch: 23 cost time: 1.9094228744506836
Epoch: 23, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.394 Vali Acc: 0.234 Test Loss: 3.394 Test Acc: 0.234
Validation loss decreased (-0.217613 --> -0.234084).  Saving model ...
Epoch: 24 cost time: 2.0412440299987793
Epoch: 24, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.449 Vali Acc: 0.215 Test Loss: 3.449 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1664535999298096
Epoch: 25, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.548 Vali Acc: 0.213 Test Loss: 3.548 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8880558013916016
Epoch: 26, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.560 Vali Acc: 0.225 Test Loss: 3.560 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0318617820739746
Epoch: 27, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.636 Vali Acc: 0.220 Test Loss: 3.636 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.6889712810516357
Epoch: 28, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.592 Vali Acc: 0.231 Test Loss: 3.592 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.083848476409912
Epoch: 29, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.623 Vali Acc: 0.271 Test Loss: 3.623 Test Acc: 0.271
Validation loss decreased (-0.234084 --> -0.270552).  Saving model ...
Epoch: 30 cost time: 1.6158313751220703
Epoch: 30, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.673 Vali Acc: 0.244 Test Loss: 3.673 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7389626502990723
Epoch: 31, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.776 Vali Acc: 0.241 Test Loss: 3.776 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8152482509613037
Epoch: 32, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.747 Vali Acc: 0.248 Test Loss: 3.747 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.2879929542541504
Epoch: 33, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.743 Vali Acc: 0.262 Test Loss: 3.743 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.9485440254211426
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.758 Vali Acc: 0.262 Test Loss: 3.758 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.3067104816436768
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.784 Vali Acc: 0.261 Test Loss: 3.784 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8548896312713623
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.797 Vali Acc: 0.264 Test Loss: 3.797 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.559894561767578
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.824 Vali Acc: 0.266 Test Loss: 3.824 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.0378410816192627
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.849 Vali Acc: 0.256 Test Loss: 3.849 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.247323989868164
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.840 Vali Acc: 0.264 Test Loss: 3.840 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 2733526
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6877269744873047
Epoch: 1, Steps: 10 | Train Loss: 3.495 Vali Loss: 3.323 Vali Acc: 0.028 Test Loss: 3.323 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 1.834575891494751
Epoch: 2, Steps: 10 | Train Loss: 3.262 Vali Loss: 3.360 Vali Acc: 0.045 Test Loss: 3.360 Test Acc: 0.045
Validation loss decreased (-0.028202 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 1.7158575057983398
Epoch: 3, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.379 Vali Acc: 0.055 Test Loss: 3.379 Test Acc: 0.055
Validation loss decreased (-0.044672 --> -0.055260).  Saving model ...
Epoch: 4 cost time: 1.6668033599853516
Epoch: 4, Steps: 10 | Train Loss: 3.162 Vali Loss: 3.337 Vali Acc: 0.051 Test Loss: 3.337 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7655105590820312
Epoch: 5, Steps: 10 | Train Loss: 3.078 Vali Loss: 3.354 Vali Acc: 0.082 Test Loss: 3.354 Test Acc: 0.082
Validation loss decreased (-0.055260 --> -0.082319).  Saving model ...
Epoch: 6 cost time: 1.5810983180999756
Epoch: 6, Steps: 10 | Train Loss: 2.978 Vali Loss: 3.291 Vali Acc: 0.085 Test Loss: 3.291 Test Acc: 0.085
Validation loss decreased (-0.082319 --> -0.084673).  Saving model ...
Epoch: 7 cost time: 2.072251558303833
Epoch: 7, Steps: 10 | Train Loss: 2.786 Vali Loss: 3.291 Vali Acc: 0.102 Test Loss: 3.291 Test Acc: 0.102
Validation loss decreased (-0.084673 --> -0.102320).  Saving model ...
Epoch: 8 cost time: 1.6838371753692627
Epoch: 8, Steps: 10 | Train Loss: 2.617 Vali Loss: 3.305 Vali Acc: 0.111 Test Loss: 3.305 Test Acc: 0.111
Validation loss decreased (-0.102320 --> -0.110555).  Saving model ...
Epoch: 9 cost time: 2.0578720569610596
Epoch: 9, Steps: 10 | Train Loss: 2.428 Vali Loss: 3.265 Vali Acc: 0.133 Test Loss: 3.265 Test Acc: 0.133
Validation loss decreased (-0.110555 --> -0.132909).  Saving model ...
Epoch: 10 cost time: 1.6398670673370361
Epoch: 10, Steps: 10 | Train Loss: 2.243 Vali Loss: 3.248 Vali Acc: 0.133 Test Loss: 3.248 Test Acc: 0.133
Validation loss decreased (-0.132909 --> -0.132909).  Saving model ...
Epoch: 11 cost time: 1.8253555297851562
Epoch: 11, Steps: 10 | Train Loss: 2.062 Vali Loss: 3.292 Vali Acc: 0.142 Test Loss: 3.292 Test Acc: 0.142
Validation loss decreased (-0.132909 --> -0.142320).  Saving model ...
Epoch: 12 cost time: 1.8913917541503906
Epoch: 12, Steps: 10 | Train Loss: 1.875 Vali Loss: 3.235 Vali Acc: 0.153 Test Loss: 3.235 Test Acc: 0.153
Validation loss decreased (-0.142320 --> -0.152909).  Saving model ...
Epoch: 13 cost time: 1.5626389980316162
Epoch: 13, Steps: 10 | Train Loss: 1.760 Vali Loss: 3.242 Vali Acc: 0.154 Test Loss: 3.242 Test Acc: 0.154
Validation loss decreased (-0.152909 --> -0.154085).  Saving model ...
Epoch: 14 cost time: 1.851464033126831
Epoch: 14, Steps: 10 | Train Loss: 1.602 Vali Loss: 3.247 Vali Acc: 0.174 Test Loss: 3.247 Test Acc: 0.174
Validation loss decreased (-0.154085 --> -0.174085).  Saving model ...
Epoch: 15 cost time: 1.6775834560394287
Epoch: 15, Steps: 10 | Train Loss: 1.376 Vali Loss: 3.232 Vali Acc: 0.186 Test Loss: 3.232 Test Acc: 0.186
Validation loss decreased (-0.174085 --> -0.185850).  Saving model ...
Epoch: 16 cost time: 2.031318187713623
Epoch: 16, Steps: 10 | Train Loss: 1.222 Vali Loss: 3.251 Vali Acc: 0.172 Test Loss: 3.251 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8944473266601562
Epoch: 17, Steps: 10 | Train Loss: 1.080 Vali Loss: 3.282 Vali Acc: 0.207 Test Loss: 3.282 Test Acc: 0.207
Validation loss decreased (-0.185850 --> -0.207026).  Saving model ...
Epoch: 18 cost time: 1.9211626052856445
Epoch: 18, Steps: 10 | Train Loss: 1.012 Vali Loss: 3.327 Vali Acc: 0.189 Test Loss: 3.327 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9579551219940186
Epoch: 19, Steps: 10 | Train Loss: 0.855 Vali Loss: 3.310 Vali Acc: 0.209 Test Loss: 3.310 Test Acc: 0.209
Validation loss decreased (-0.207026 --> -0.209379).  Saving model ...
Epoch: 20 cost time: 1.8777027130126953
Epoch: 20, Steps: 10 | Train Loss: 0.661 Vali Loss: 3.358 Vali Acc: 0.213 Test Loss: 3.358 Test Acc: 0.213
Validation loss decreased (-0.209379 --> -0.212908).  Saving model ...
Epoch: 21 cost time: 1.7866637706756592
Epoch: 21, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.391 Vali Acc: 0.201 Test Loss: 3.391 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7760999202728271
Epoch: 22, Steps: 10 | Train Loss: 0.402 Vali Loss: 3.463 Vali Acc: 0.220 Test Loss: 3.463 Test Acc: 0.220
Validation loss decreased (-0.212908 --> -0.219965).  Saving model ...
Epoch: 23 cost time: 1.633328914642334
Epoch: 23, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.472 Vali Acc: 0.225 Test Loss: 3.472 Test Acc: 0.225
Validation loss decreased (-0.219965 --> -0.224671).  Saving model ...
Epoch: 24 cost time: 1.6878688335418701
Epoch: 24, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.521 Vali Acc: 0.239 Test Loss: 3.521 Test Acc: 0.239
Validation loss decreased (-0.224671 --> -0.238788).  Saving model ...
Epoch: 25 cost time: 1.6748390197753906
Epoch: 25, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.746 Vali Acc: 0.204 Test Loss: 3.746 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8141775131225586
Epoch: 26, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.693 Vali Acc: 0.222 Test Loss: 3.693 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0210938453674316
Epoch: 27, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.953 Vali Acc: 0.222 Test Loss: 3.953 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8204023838043213
Epoch: 28, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.907 Vali Acc: 0.225 Test Loss: 3.907 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8705472946166992
Epoch: 29, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.858 Vali Acc: 0.245 Test Loss: 3.858 Test Acc: 0.245
Validation loss decreased (-0.238788 --> -0.244667).  Saving model ...
Epoch: 30 cost time: 2.0602774620056152
Epoch: 30, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.953 Vali Acc: 0.219 Test Loss: 3.953 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.069758415222168
Epoch: 31, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.866 Vali Acc: 0.240 Test Loss: 3.866 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1984171867370605
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.889 Vali Acc: 0.225 Test Loss: 3.889 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.8610544204711914
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.925 Vali Acc: 0.240 Test Loss: 3.925 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.9893040657043457
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.979 Vali Acc: 0.248 Test Loss: 3.979 Test Acc: 0.248
Validation loss decreased (-0.244667 --> -0.248196).  Saving model ...
Epoch: 35 cost time: 1.8892393112182617
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.007 Vali Acc: 0.240 Test Loss: 4.007 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8902976512908936
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.996 Vali Acc: 0.241 Test Loss: 3.996 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8516957759857178
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.031 Vali Acc: 0.239 Test Loss: 4.031 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.8838732242584229
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.067 Vali Acc: 0.248 Test Loss: 4.067 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.7671599388122559
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.054 Vali Acc: 0.247 Test Loss: 4.054 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.664522647857666
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.069 Vali Acc: 0.244 Test Loss: 4.069 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.6511523723602295
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.084 Vali Acc: 0.253 Test Loss: 4.084 Test Acc: 0.253
Validation loss decreased (-0.248196 --> -0.252900).  Saving model ...
Epoch: 42 cost time: 1.673915147781372
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.066 Vali Acc: 0.247 Test Loss: 4.066 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.9458529949188232
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.105 Vali Acc: 0.245 Test Loss: 4.105 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.8041954040527344
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.133 Vali Acc: 0.246 Test Loss: 4.133 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.7691550254821777
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.130 Vali Acc: 0.245 Test Loss: 4.130 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.9514317512512207
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.155 Vali Acc: 0.249 Test Loss: 4.155 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.840766429901123
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.148 Vali Acc: 0.247 Test Loss: 4.148 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.7137689590454102
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.163 Vali Acc: 0.252 Test Loss: 4.163 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.8685142993927002
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.178 Vali Acc: 0.256 Test Loss: 4.178 Test Acc: 0.256
Validation loss decreased (-0.252900 --> -0.256429).  Saving model ...
Epoch: 50 cost time: 1.7316827774047852
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.180 Vali Acc: 0.254 Test Loss: 4.180 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.8018152713775635
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.198 Vali Acc: 0.245 Test Loss: 4.198 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.1048696041107178
Epoch: 52, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.212 Vali Acc: 0.251 Test Loss: 4.212 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.7945082187652588
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.206 Vali Acc: 0.247 Test Loss: 4.206 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.0410027503967285
Epoch: 54, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.214 Vali Acc: 0.249 Test Loss: 4.214 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.6335046291351318
Epoch: 55, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.231 Vali Acc: 0.248 Test Loss: 4.231 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.6845688819885254
Epoch: 56, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.230 Vali Acc: 0.253 Test Loss: 4.230 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.5750389099121094
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.244 Vali Acc: 0.248 Test Loss: 4.244 Test Acc: 0.248
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.575589656829834
Epoch: 58, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.263 Vali Acc: 0.252 Test Loss: 4.263 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.8562054634094238
Epoch: 59, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.259 Vali Acc: 0.255 Test Loss: 4.259 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 2730198
model size : 13.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.657275915145874
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.349 Vali Acc: 0.044 Test Loss: 3.349 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 2.007082462310791
Epoch: 2, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.340 Vali Acc: 0.049 Test Loss: 3.340 Test Acc: 0.049
Validation loss decreased (-0.043496 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 1.9237637519836426
Epoch: 3, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.352 Vali Acc: 0.064 Test Loss: 3.352 Test Acc: 0.064
Validation loss decreased (-0.049378 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 1.980602741241455
Epoch: 4, Steps: 10 | Train Loss: 3.115 Vali Loss: 3.364 Vali Acc: 0.073 Test Loss: 3.364 Test Acc: 0.073
Validation loss decreased (-0.063496 --> -0.072908).  Saving model ...
Epoch: 5 cost time: 1.8630797863006592
Epoch: 5, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.308 Vali Acc: 0.076 Test Loss: 3.308 Test Acc: 0.076
Validation loss decreased (-0.072908 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 2.1423940658569336
Epoch: 6, Steps: 10 | Train Loss: 3.000 Vali Loss: 3.265 Vali Acc: 0.094 Test Loss: 3.265 Test Acc: 0.094
Validation loss decreased (-0.076438 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 2.075042724609375
Epoch: 7, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.282 Vali Acc: 0.099 Test Loss: 3.282 Test Acc: 0.099
Validation loss decreased (-0.094085 --> -0.098791).  Saving model ...
Epoch: 8 cost time: 2.0384414196014404
Epoch: 8, Steps: 10 | Train Loss: 2.630 Vali Loss: 3.257 Vali Acc: 0.107 Test Loss: 3.257 Test Acc: 0.107
Validation loss decreased (-0.098791 --> -0.107026).  Saving model ...
Epoch: 9 cost time: 1.9432320594787598
Epoch: 9, Steps: 10 | Train Loss: 2.422 Vali Loss: 3.257 Vali Acc: 0.120 Test Loss: 3.257 Test Acc: 0.120
Validation loss decreased (-0.107026 --> -0.119967).  Saving model ...
Epoch: 10 cost time: 2.291048526763916
Epoch: 10, Steps: 10 | Train Loss: 2.281 Vali Loss: 3.235 Vali Acc: 0.132 Test Loss: 3.235 Test Acc: 0.132
Validation loss decreased (-0.119967 --> -0.131732).  Saving model ...
Epoch: 11 cost time: 2.086731195449829
Epoch: 11, Steps: 10 | Train Loss: 2.056 Vali Loss: 3.237 Vali Acc: 0.146 Test Loss: 3.237 Test Acc: 0.146
Validation loss decreased (-0.131732 --> -0.145850).  Saving model ...
Epoch: 12 cost time: 2.2448062896728516
Epoch: 12, Steps: 10 | Train Loss: 1.912 Vali Loss: 3.225 Vali Acc: 0.152 Test Loss: 3.225 Test Acc: 0.152
Validation loss decreased (-0.145850 --> -0.151732).  Saving model ...
Epoch: 13 cost time: 1.8882899284362793
Epoch: 13, Steps: 10 | Train Loss: 1.713 Vali Loss: 3.214 Vali Acc: 0.180 Test Loss: 3.214 Test Acc: 0.180
Validation loss decreased (-0.151732 --> -0.179968).  Saving model ...
Epoch: 14 cost time: 2.182542085647583
Epoch: 14, Steps: 10 | Train Loss: 1.538 Vali Loss: 3.201 Vali Acc: 0.179 Test Loss: 3.201 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.37290620803833
Epoch: 15, Steps: 10 | Train Loss: 1.346 Vali Loss: 3.211 Vali Acc: 0.169 Test Loss: 3.211 Test Acc: 0.169
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.902287244796753
Epoch: 16, Steps: 10 | Train Loss: 1.251 Vali Loss: 3.244 Vali Acc: 0.176 Test Loss: 3.244 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7512247562408447
Epoch: 17, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.251 Vali Acc: 0.198 Test Loss: 3.251 Test Acc: 0.198
Validation loss decreased (-0.179968 --> -0.197615).  Saving model ...
Epoch: 18 cost time: 2.1032023429870605
Epoch: 18, Steps: 10 | Train Loss: 0.935 Vali Loss: 3.238 Vali Acc: 0.185 Test Loss: 3.238 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.150923728942871
Epoch: 19, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.242 Vali Acc: 0.215 Test Loss: 3.242 Test Acc: 0.215
Validation loss decreased (-0.197615 --> -0.215262).  Saving model ...
Epoch: 20 cost time: 2.063599109649658
Epoch: 20, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.322 Vali Acc: 0.216 Test Loss: 3.322 Test Acc: 0.216
Validation loss decreased (-0.215262 --> -0.216437).  Saving model ...
Epoch: 21 cost time: 1.9881858825683594
Epoch: 21, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.360 Vali Acc: 0.232 Test Loss: 3.360 Test Acc: 0.232
Validation loss decreased (-0.216437 --> -0.231731).  Saving model ...
Epoch: 22 cost time: 1.7212884426116943
Epoch: 22, Steps: 10 | Train Loss: 0.421 Vali Loss: 3.404 Vali Acc: 0.218 Test Loss: 3.404 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2901906967163086
Epoch: 23, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.369 Vali Acc: 0.241 Test Loss: 3.369 Test Acc: 0.241
Validation loss decreased (-0.231731 --> -0.241143).  Saving model ...
Epoch: 24 cost time: 1.8607509136199951
Epoch: 24, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.565 Vali Acc: 0.186 Test Loss: 3.565 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.052445888519287
Epoch: 25, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.580 Vali Acc: 0.229 Test Loss: 3.580 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1903092861175537
Epoch: 26, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.644 Vali Acc: 0.224 Test Loss: 3.644 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0757126808166504
Epoch: 27, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.589 Vali Acc: 0.246 Test Loss: 3.589 Test Acc: 0.246
Validation loss decreased (-0.241143 --> -0.245846).  Saving model ...
Epoch: 28 cost time: 1.9528582096099854
Epoch: 28, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.697 Vali Acc: 0.248 Test Loss: 3.697 Test Acc: 0.248
Validation loss decreased (-0.245846 --> -0.248198).  Saving model ...
Epoch: 29 cost time: 1.956834077835083
Epoch: 29, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.701 Vali Acc: 0.249 Test Loss: 3.701 Test Acc: 0.249
Validation loss decreased (-0.248198 --> -0.249375).  Saving model ...
Epoch: 30 cost time: 1.9744505882263184
Epoch: 30, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.748 Vali Acc: 0.248 Test Loss: 3.748 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7191195487976074
Epoch: 31, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.787 Vali Acc: 0.252 Test Loss: 3.787 Test Acc: 0.252
Validation loss decreased (-0.249375 --> -0.251727).  Saving model ...
Epoch: 32 cost time: 1.7115488052368164
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.761 Vali Acc: 0.254 Test Loss: 3.761 Test Acc: 0.254
Validation loss decreased (-0.251727 --> -0.254080).  Saving model ...
Epoch: 33 cost time: 2.1255571842193604
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.819 Vali Acc: 0.259 Test Loss: 3.819 Test Acc: 0.259
Validation loss decreased (-0.254080 --> -0.258785).  Saving model ...
Epoch: 34 cost time: 2.2905430793762207
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.848 Vali Acc: 0.254 Test Loss: 3.848 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.1257951259613037
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.850 Vali Acc: 0.259 Test Loss: 3.850 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.063387393951416
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.850 Vali Acc: 0.261 Test Loss: 3.850 Test Acc: 0.261
Validation loss decreased (-0.258785 --> -0.261138).  Saving model ...
Epoch: 37 cost time: 2.0804736614227295
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.924 Vali Acc: 0.260 Test Loss: 3.924 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.294050455093384
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.881 Vali Acc: 0.265 Test Loss: 3.881 Test Acc: 0.265
Validation loss decreased (-0.261138 --> -0.264667).  Saving model ...
Epoch: 39 cost time: 2.437955379486084
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.895 Vali Acc: 0.261 Test Loss: 3.895 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.6536471843719482
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.957 Vali Acc: 0.256 Test Loss: 3.957 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.0058889389038086
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.975 Vali Acc: 0.260 Test Loss: 3.975 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.3398518562316895
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.968 Vali Acc: 0.261 Test Loss: 3.968 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.038496255874634
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.963 Vali Acc: 0.264 Test Loss: 3.963 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.1746273040771484
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.999 Vali Acc: 0.265 Test Loss: 3.999 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.8311338424682617
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.018 Vali Acc: 0.261 Test Loss: 4.018 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.0685558319091797
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.028 Vali Acc: 0.265 Test Loss: 4.028 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.2944064140319824
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.007 Vali Acc: 0.267 Test Loss: 4.007 Test Acc: 0.267
Validation loss decreased (-0.264667 --> -0.267019).  Saving model ...
Epoch: 48 cost time: 2.045018196105957
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.035 Vali Acc: 0.266 Test Loss: 4.035 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.1697235107421875
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.026 Vali Acc: 0.267 Test Loss: 4.026 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.9985675811767578
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.051 Vali Acc: 0.262 Test Loss: 4.051 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.8749289512634277
Epoch: 51, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.070 Vali Acc: 0.261 Test Loss: 4.070 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.064380645751953
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.087 Vali Acc: 0.261 Test Loss: 4.087 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.9750444889068604
Epoch: 53, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.072 Vali Acc: 0.266 Test Loss: 4.072 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.871093988418579
Epoch: 54, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.099 Vali Acc: 0.259 Test Loss: 4.099 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 2.2257754802703857
Epoch: 55, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.126 Vali Acc: 0.259 Test Loss: 4.126 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 2.211686372756958
Epoch: 56, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.121 Vali Acc: 0.267 Test Loss: 4.121 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.292215585708618
Epoch: 57, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.122 Vali Acc: 0.267 Test Loss: 4.122 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 2726870
model size : 13.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7350075244903564
Epoch: 1, Steps: 10 | Train Loss: 3.411 Vali Loss: 3.316 Vali Acc: 0.056 Test Loss: 3.316 Test Acc: 0.056
Validation loss decreased (inf --> -0.056437).  Saving model ...
Epoch: 2 cost time: 2.0027270317077637
Epoch: 2, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.358 Vali Acc: 0.042 Test Loss: 3.358 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.187802314758301
Epoch: 3, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.361 Vali Acc: 0.039 Test Loss: 3.361 Test Acc: 0.039
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8247675895690918
Epoch: 4, Steps: 10 | Train Loss: 3.144 Vali Loss: 3.322 Vali Acc: 0.067 Test Loss: 3.322 Test Acc: 0.067
Validation loss decreased (-0.056437 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 1.7013230323791504
Epoch: 5, Steps: 10 | Train Loss: 3.098 Vali Loss: 3.292 Vali Acc: 0.078 Test Loss: 3.292 Test Acc: 0.078
Validation loss decreased (-0.067026 --> -0.077614).  Saving model ...
Epoch: 6 cost time: 1.7164433002471924
Epoch: 6, Steps: 10 | Train Loss: 2.977 Vali Loss: 3.329 Vali Acc: 0.082 Test Loss: 3.329 Test Acc: 0.082
Validation loss decreased (-0.077614 --> -0.082320).  Saving model ...
Epoch: 7 cost time: 1.7261226177215576
Epoch: 7, Steps: 10 | Train Loss: 2.856 Vali Loss: 3.262 Vali Acc: 0.096 Test Loss: 3.262 Test Acc: 0.096
Validation loss decreased (-0.082320 --> -0.096438).  Saving model ...
Epoch: 8 cost time: 1.4778010845184326
Epoch: 8, Steps: 10 | Train Loss: 2.744 Vali Loss: 3.284 Vali Acc: 0.108 Test Loss: 3.284 Test Acc: 0.108
Validation loss decreased (-0.096438 --> -0.108202).  Saving model ...
Epoch: 9 cost time: 1.556593656539917
Epoch: 9, Steps: 10 | Train Loss: 2.619 Vali Loss: 3.282 Vali Acc: 0.100 Test Loss: 3.282 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.970585823059082
Epoch: 10, Steps: 10 | Train Loss: 2.490 Vali Loss: 3.255 Vali Acc: 0.134 Test Loss: 3.255 Test Acc: 0.134
Validation loss decreased (-0.108202 --> -0.134085).  Saving model ...
Epoch: 11 cost time: 1.8945512771606445
Epoch: 11, Steps: 10 | Train Loss: 2.329 Vali Loss: 3.268 Vali Acc: 0.133 Test Loss: 3.268 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.794767141342163
Epoch: 12, Steps: 10 | Train Loss: 2.228 Vali Loss: 3.203 Vali Acc: 0.146 Test Loss: 3.203 Test Acc: 0.146
Validation loss decreased (-0.134085 --> -0.145850).  Saving model ...
Epoch: 13 cost time: 1.7996032238006592
Epoch: 13, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.224 Vali Acc: 0.151 Test Loss: 3.224 Test Acc: 0.151
Validation loss decreased (-0.145850 --> -0.150556).  Saving model ...
Epoch: 14 cost time: 1.8859829902648926
Epoch: 14, Steps: 10 | Train Loss: 1.937 Vali Loss: 3.204 Vali Acc: 0.165 Test Loss: 3.204 Test Acc: 0.165
Validation loss decreased (-0.150556 --> -0.164674).  Saving model ...
Epoch: 15 cost time: 1.9997022151947021
Epoch: 15, Steps: 10 | Train Loss: 1.855 Vali Loss: 3.173 Vali Acc: 0.182 Test Loss: 3.173 Test Acc: 0.182
Validation loss decreased (-0.164674 --> -0.182321).  Saving model ...
Epoch: 16 cost time: 2.2514524459838867
Epoch: 16, Steps: 10 | Train Loss: 1.646 Vali Loss: 3.172 Vali Acc: 0.180 Test Loss: 3.172 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7448959350585938
Epoch: 17, Steps: 10 | Train Loss: 1.554 Vali Loss: 3.163 Vali Acc: 0.182 Test Loss: 3.163 Test Acc: 0.182
Validation loss decreased (-0.182321 --> -0.182321).  Saving model ...
Epoch: 18 cost time: 2.1311752796173096
Epoch: 18, Steps: 10 | Train Loss: 1.538 Vali Loss: 3.178 Vali Acc: 0.181 Test Loss: 3.178 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0104284286499023
Epoch: 19, Steps: 10 | Train Loss: 1.351 Vali Loss: 3.166 Vali Acc: 0.195 Test Loss: 3.166 Test Acc: 0.195
Validation loss decreased (-0.182321 --> -0.195262).  Saving model ...
Epoch: 20 cost time: 1.9721825122833252
Epoch: 20, Steps: 10 | Train Loss: 1.251 Vali Loss: 3.248 Vali Acc: 0.176 Test Loss: 3.248 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8602356910705566
Epoch: 21, Steps: 10 | Train Loss: 1.164 Vali Loss: 3.172 Vali Acc: 0.184 Test Loss: 3.172 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8305785655975342
Epoch: 22, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.151 Vali Acc: 0.212 Test Loss: 3.151 Test Acc: 0.212
Validation loss decreased (-0.195262 --> -0.211733).  Saving model ...
Epoch: 23 cost time: 2.267775058746338
Epoch: 23, Steps: 10 | Train Loss: 0.953 Vali Loss: 3.166 Vali Acc: 0.215 Test Loss: 3.166 Test Acc: 0.215
Validation loss decreased (-0.211733 --> -0.215262).  Saving model ...
Epoch: 24 cost time: 2.2806811332702637
Epoch: 24, Steps: 10 | Train Loss: 0.815 Vali Loss: 3.269 Vali Acc: 0.219 Test Loss: 3.269 Test Acc: 0.219
Validation loss decreased (-0.215262 --> -0.218791).  Saving model ...
Epoch: 25 cost time: 2.1545541286468506
Epoch: 25, Steps: 10 | Train Loss: 0.725 Vali Loss: 3.149 Vali Acc: 0.226 Test Loss: 3.149 Test Acc: 0.226
Validation loss decreased (-0.218791 --> -0.225851).  Saving model ...
Epoch: 26 cost time: 2.0776588916778564
Epoch: 26, Steps: 10 | Train Loss: 0.629 Vali Loss: 3.261 Vali Acc: 0.219 Test Loss: 3.261 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7829372882843018
Epoch: 27, Steps: 10 | Train Loss: 0.563 Vali Loss: 3.257 Vali Acc: 0.232 Test Loss: 3.257 Test Acc: 0.232
Validation loss decreased (-0.225851 --> -0.231732).  Saving model ...
Epoch: 28 cost time: 1.8761661052703857
Epoch: 28, Steps: 10 | Train Loss: 0.442 Vali Loss: 3.255 Vali Acc: 0.216 Test Loss: 3.255 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.290884017944336
Epoch: 29, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.235 Vali Acc: 0.245 Test Loss: 3.235 Test Acc: 0.245
Validation loss decreased (-0.231732 --> -0.244674).  Saving model ...
Epoch: 30 cost time: 2.1777846813201904
Epoch: 30, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.236 Vali Acc: 0.246 Test Loss: 3.236 Test Acc: 0.246
Validation loss decreased (-0.244674 --> -0.245850).  Saving model ...
Epoch: 31 cost time: 2.003868341445923
Epoch: 31, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.260 Vali Acc: 0.233 Test Loss: 3.260 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0209617614746094
Epoch: 32, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.319 Vali Acc: 0.242 Test Loss: 3.319 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0178163051605225
Epoch: 33, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.503 Vali Acc: 0.227 Test Loss: 3.503 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.545290470123291
Epoch: 34, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.440 Vali Acc: 0.221 Test Loss: 3.440 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.9509451389312744
Epoch: 35, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.465 Vali Acc: 0.222 Test Loss: 3.465 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.369608163833618
Epoch: 36, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.496 Vali Acc: 0.246 Test Loss: 3.496 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.0717790126800537
Epoch: 37, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.480 Vali Acc: 0.248 Test Loss: 3.480 Test Acc: 0.248
Validation loss decreased (-0.245850 --> -0.248200).  Saving model ...
Epoch: 38 cost time: 2.0209202766418457
Epoch: 38, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.593 Vali Acc: 0.228 Test Loss: 3.593 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.135197401046753
Epoch: 39, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.427 Vali Acc: 0.238 Test Loss: 3.427 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.1093719005584717
Epoch: 40, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.590 Vali Acc: 0.229 Test Loss: 3.590 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.361936330795288
Epoch: 41, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.557 Vali Acc: 0.252 Test Loss: 3.557 Test Acc: 0.252
Validation loss decreased (-0.248200 --> -0.251729).  Saving model ...
Epoch: 42 cost time: 1.9525401592254639
Epoch: 42, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.569 Vali Acc: 0.241 Test Loss: 3.569 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.074521780014038
Epoch: 43, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.570 Vali Acc: 0.241 Test Loss: 3.570 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.267725944519043
Epoch: 44, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.618 Vali Acc: 0.253 Test Loss: 3.618 Test Acc: 0.253
Validation loss decreased (-0.251729 --> -0.252905).  Saving model ...
Epoch: 45 cost time: 2.1494266986846924
Epoch: 45, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.617 Vali Acc: 0.258 Test Loss: 3.617 Test Acc: 0.258
Validation loss decreased (-0.252905 --> -0.257611).  Saving model ...
Epoch: 46 cost time: 2.3293724060058594
Epoch: 46, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.626 Vali Acc: 0.254 Test Loss: 3.626 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.4945273399353027
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.652 Vali Acc: 0.253 Test Loss: 3.652 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.6675615310668945
Epoch: 48, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.635 Vali Acc: 0.254 Test Loss: 3.635 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.1878225803375244
Epoch: 49, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.630 Vali Acc: 0.255 Test Loss: 3.630 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.207313299179077
Epoch: 50, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.657 Vali Acc: 0.259 Test Loss: 3.657 Test Acc: 0.259
Validation loss decreased (-0.257611 --> -0.258787).  Saving model ...
Epoch: 51 cost time: 2.343360185623169
Epoch: 51, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.669 Vali Acc: 0.255 Test Loss: 3.669 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.2308454513549805
Epoch: 52, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.701 Vali Acc: 0.255 Test Loss: 3.701 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.1258280277252197
Epoch: 53, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.713 Vali Acc: 0.249 Test Loss: 3.713 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.0786194801330566
Epoch: 54, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.714 Vali Acc: 0.251 Test Loss: 3.714 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.2469983100891113
Epoch: 55, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.708 Vali Acc: 0.254 Test Loss: 3.708 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.374758720397949
Epoch: 56, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.727 Vali Acc: 0.247 Test Loss: 3.727 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.4692606925964355
Epoch: 57, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.736 Vali Acc: 0.259 Test Loss: 3.736 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 2.294971227645874
Epoch: 58, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.726 Vali Acc: 0.258 Test Loss: 3.726 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 2.404559850692749
Epoch: 59, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.752 Vali Acc: 0.256 Test Loss: 3.752 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 2.230417490005493
Epoch: 60, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.758 Vali Acc: 0.251 Test Loss: 3.758 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 1819478
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.33534836769104
Epoch: 1, Steps: 10 | Train Loss: 3.433 Vali Loss: 3.323 Vali Acc: 0.049 Test Loss: 3.323 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.9224615097045898
Epoch: 2, Steps: 10 | Train Loss: 3.301 Vali Loss: 3.321 Vali Acc: 0.046 Test Loss: 3.321 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9464597702026367
Epoch: 3, Steps: 10 | Train Loss: 3.220 Vali Loss: 3.333 Vali Acc: 0.052 Test Loss: 3.333 Test Acc: 0.052
Validation loss decreased (-0.049379 --> -0.051731).  Saving model ...
Epoch: 4 cost time: 1.9859483242034912
Epoch: 4, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.324 Vali Acc: 0.060 Test Loss: 3.324 Test Acc: 0.060
Validation loss decreased (-0.051731 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 2.217430830001831
Epoch: 5, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.317 Vali Acc: 0.084 Test Loss: 3.317 Test Acc: 0.084
Validation loss decreased (-0.059967 --> -0.083496).  Saving model ...
Epoch: 6 cost time: 1.9539575576782227
Epoch: 6, Steps: 10 | Train Loss: 2.921 Vali Loss: 3.288 Vali Acc: 0.089 Test Loss: 3.288 Test Acc: 0.089
Validation loss decreased (-0.083496 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 1.5445811748504639
Epoch: 7, Steps: 10 | Train Loss: 2.771 Vali Loss: 3.264 Vali Acc: 0.102 Test Loss: 3.264 Test Acc: 0.102
Validation loss decreased (-0.089379 --> -0.102320).  Saving model ...
Epoch: 8 cost time: 1.9628121852874756
Epoch: 8, Steps: 10 | Train Loss: 2.600 Vali Loss: 3.237 Vali Acc: 0.119 Test Loss: 3.237 Test Acc: 0.119
Validation loss decreased (-0.102320 --> -0.118791).  Saving model ...
Epoch: 9 cost time: 1.8025171756744385
Epoch: 9, Steps: 10 | Train Loss: 2.527 Vali Loss: 3.226 Vali Acc: 0.108 Test Loss: 3.226 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.815061330795288
Epoch: 10, Steps: 10 | Train Loss: 2.316 Vali Loss: 3.236 Vali Acc: 0.131 Test Loss: 3.236 Test Acc: 0.131
Validation loss decreased (-0.118791 --> -0.130556).  Saving model ...
Epoch: 11 cost time: 1.81307053565979
Epoch: 11, Steps: 10 | Train Loss: 2.248 Vali Loss: 3.227 Vali Acc: 0.115 Test Loss: 3.227 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.193143367767334
Epoch: 12, Steps: 10 | Train Loss: 2.129 Vali Loss: 3.214 Vali Acc: 0.116 Test Loss: 3.214 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.155582904815674
Epoch: 13, Steps: 10 | Train Loss: 1.965 Vali Loss: 3.205 Vali Acc: 0.146 Test Loss: 3.205 Test Acc: 0.146
Validation loss decreased (-0.130556 --> -0.145850).  Saving model ...
Epoch: 14 cost time: 1.6666724681854248
Epoch: 14, Steps: 10 | Train Loss: 1.932 Vali Loss: 3.248 Vali Acc: 0.126 Test Loss: 3.248 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6933584213256836
Epoch: 15, Steps: 10 | Train Loss: 1.741 Vali Loss: 3.182 Vali Acc: 0.151 Test Loss: 3.182 Test Acc: 0.151
Validation loss decreased (-0.145850 --> -0.150556).  Saving model ...
Epoch: 16 cost time: 1.7961342334747314
Epoch: 16, Steps: 10 | Train Loss: 1.711 Vali Loss: 3.229 Vali Acc: 0.141 Test Loss: 3.229 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.043485403060913
Epoch: 17, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.181 Vali Acc: 0.139 Test Loss: 3.181 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1062347888946533
Epoch: 18, Steps: 10 | Train Loss: 1.461 Vali Loss: 3.190 Vali Acc: 0.158 Test Loss: 3.190 Test Acc: 0.158
Validation loss decreased (-0.150556 --> -0.157615).  Saving model ...
Epoch: 19 cost time: 2.072932481765747
Epoch: 19, Steps: 10 | Train Loss: 1.287 Vali Loss: 3.196 Vali Acc: 0.158 Test Loss: 3.196 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9378852844238281
Epoch: 20, Steps: 10 | Train Loss: 1.189 Vali Loss: 3.196 Vali Acc: 0.153 Test Loss: 3.196 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.938532829284668
Epoch: 21, Steps: 10 | Train Loss: 1.146 Vali Loss: 3.219 Vali Acc: 0.169 Test Loss: 3.219 Test Acc: 0.169
Validation loss decreased (-0.157615 --> -0.169380).  Saving model ...
Epoch: 22 cost time: 2.176241397857666
Epoch: 22, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.193 Vali Acc: 0.174 Test Loss: 3.193 Test Acc: 0.174
Validation loss decreased (-0.169380 --> -0.174086).  Saving model ...
Epoch: 23 cost time: 2.0350756645202637
Epoch: 23, Steps: 10 | Train Loss: 0.889 Vali Loss: 3.239 Vali Acc: 0.179 Test Loss: 3.239 Test Acc: 0.179
Validation loss decreased (-0.174086 --> -0.178791).  Saving model ...
Epoch: 24 cost time: 1.9135217666625977
Epoch: 24, Steps: 10 | Train Loss: 0.865 Vali Loss: 3.245 Vali Acc: 0.174 Test Loss: 3.245 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8233623504638672
Epoch: 25, Steps: 10 | Train Loss: 0.800 Vali Loss: 3.290 Vali Acc: 0.181 Test Loss: 3.290 Test Acc: 0.181
Validation loss decreased (-0.178791 --> -0.181144).  Saving model ...
Epoch: 26 cost time: 1.898524522781372
Epoch: 26, Steps: 10 | Train Loss: 0.653 Vali Loss: 3.205 Vali Acc: 0.206 Test Loss: 3.205 Test Acc: 0.206
Validation loss decreased (-0.181144 --> -0.205850).  Saving model ...
Epoch: 27 cost time: 1.7396256923675537
Epoch: 27, Steps: 10 | Train Loss: 0.532 Vali Loss: 3.309 Vali Acc: 0.187 Test Loss: 3.309 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.892237663269043
Epoch: 28, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.272 Vali Acc: 0.200 Test Loss: 3.272 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5358552932739258
Epoch: 29, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.334 Vali Acc: 0.206 Test Loss: 3.334 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7995381355285645
Epoch: 30, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.402 Vali Acc: 0.189 Test Loss: 3.402 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.550964832305908
Epoch: 31, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.369 Vali Acc: 0.194 Test Loss: 3.369 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.972093105316162
Epoch: 32, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.415 Vali Acc: 0.215 Test Loss: 3.415 Test Acc: 0.215
Validation loss decreased (-0.205850 --> -0.215260).  Saving model ...
Epoch: 33 cost time: 1.974449872970581
Epoch: 33, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.540 Vali Acc: 0.193 Test Loss: 3.540 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6908440589904785
Epoch: 34, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.524 Vali Acc: 0.191 Test Loss: 3.524 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.9958055019378662
Epoch: 35, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.665 Vali Acc: 0.185 Test Loss: 3.665 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8948945999145508
Epoch: 36, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.601 Vali Acc: 0.192 Test Loss: 3.601 Test Acc: 0.192
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.005328893661499
Epoch: 37, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.554 Vali Acc: 0.222 Test Loss: 3.554 Test Acc: 0.222
Validation loss decreased (-0.215260 --> -0.222317).  Saving model ...
Epoch: 38 cost time: 1.853079080581665
Epoch: 38, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.609 Vali Acc: 0.211 Test Loss: 3.609 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7590522766113281
Epoch: 39, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.602 Vali Acc: 0.225 Test Loss: 3.602 Test Acc: 0.225
Validation loss decreased (-0.222317 --> -0.224670).  Saving model ...
Epoch: 40 cost time: 1.726468563079834
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.621 Vali Acc: 0.228 Test Loss: 3.621 Test Acc: 0.228
Validation loss decreased (-0.224670 --> -0.228199).  Saving model ...
Epoch: 41 cost time: 1.6470041275024414
Epoch: 41, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.702 Vali Acc: 0.219 Test Loss: 3.702 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.647937536239624
Epoch: 42, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.632 Vali Acc: 0.232 Test Loss: 3.632 Test Acc: 0.232
Validation loss decreased (-0.228199 --> -0.231728).  Saving model ...
Epoch: 43 cost time: 1.7202565670013428
Epoch: 43, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.684 Vali Acc: 0.228 Test Loss: 3.684 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.8545646667480469
Epoch: 44, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.734 Vali Acc: 0.227 Test Loss: 3.734 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.7572879791259766
Epoch: 45, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.743 Vali Acc: 0.229 Test Loss: 3.743 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.590343713760376
Epoch: 46, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.717 Vali Acc: 0.227 Test Loss: 3.717 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.7060093879699707
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.770 Vali Acc: 0.233 Test Loss: 3.770 Test Acc: 0.233
Validation loss decreased (-0.231728 --> -0.232903).  Saving model ...
Epoch: 48 cost time: 1.8484795093536377
Epoch: 48, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.805 Vali Acc: 0.225 Test Loss: 3.805 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.723271369934082
Epoch: 49, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.746 Vali Acc: 0.229 Test Loss: 3.746 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.8456544876098633
Epoch: 50, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.759 Vali Acc: 0.227 Test Loss: 3.759 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.653503656387329
Epoch: 51, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.817 Vali Acc: 0.227 Test Loss: 3.817 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.126311779022217
Epoch: 52, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.855 Vali Acc: 0.227 Test Loss: 3.855 Test Acc: 0.227
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.033618211746216
Epoch: 53, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.829 Vali Acc: 0.231 Test Loss: 3.829 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 2.0330018997192383
Epoch: 54, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.801 Vali Acc: 0.235 Test Loss: 3.801 Test Acc: 0.235
Validation loss decreased (-0.232903 --> -0.235256).  Saving model ...
Epoch: 55 cost time: 1.6507995128631592
Epoch: 55, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.846 Vali Acc: 0.228 Test Loss: 3.846 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.8879756927490234
Epoch: 56, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.832 Vali Acc: 0.227 Test Loss: 3.832 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.9522910118103027
Epoch: 57, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.863 Vali Acc: 0.220 Test Loss: 3.863 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.7542765140533447
Epoch: 58, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.866 Vali Acc: 0.232 Test Loss: 3.866 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.6895885467529297
Epoch: 59, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.870 Vali Acc: 0.229 Test Loss: 3.870 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.7616429328918457
Epoch: 60, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.869 Vali Acc: 0.228 Test Loss: 3.869 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.71854829788208
Epoch: 61, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.895 Vali Acc: 0.229 Test Loss: 3.895 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.6717743873596191
Epoch: 62, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.903 Vali Acc: 0.231 Test Loss: 3.903 Test Acc: 0.231
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.643570899963379
Epoch: 63, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.919 Vali Acc: 0.233 Test Loss: 3.919 Test Acc: 0.233
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.623577356338501
Epoch: 64, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.895 Vali Acc: 0.234 Test Loss: 3.895 Test Acc: 0.234
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23529411764705882
model parameter : 1817814
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4620156288146973
Epoch: 1, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.332 Vali Acc: 0.055 Test Loss: 3.332 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 1.6296799182891846
Epoch: 2, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.353 Vali Acc: 0.042 Test Loss: 3.353 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0142929553985596
Epoch: 3, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.364 Vali Acc: 0.045 Test Loss: 3.364 Test Acc: 0.045
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8011763095855713
Epoch: 4, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.357 Vali Acc: 0.053 Test Loss: 3.357 Test Acc: 0.053
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7895259857177734
Epoch: 5, Steps: 10 | Train Loss: 3.079 Vali Loss: 3.313 Vali Acc: 0.068 Test Loss: 3.313 Test Acc: 0.068
Validation loss decreased (-0.055261 --> -0.068202).  Saving model ...
Epoch: 6 cost time: 1.7807948589324951
Epoch: 6, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.294 Vali Acc: 0.066 Test Loss: 3.294 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.119715690612793
Epoch: 7, Steps: 10 | Train Loss: 2.862 Vali Loss: 3.321 Vali Acc: 0.086 Test Loss: 3.321 Test Acc: 0.086
Validation loss decreased (-0.068202 --> -0.085849).  Saving model ...
Epoch: 8 cost time: 1.979367733001709
Epoch: 8, Steps: 10 | Train Loss: 2.687 Vali Loss: 3.289 Vali Acc: 0.089 Test Loss: 3.289 Test Acc: 0.089
Validation loss decreased (-0.085849 --> -0.089379).  Saving model ...
Epoch: 9 cost time: 1.9265401363372803
Epoch: 9, Steps: 10 | Train Loss: 2.649 Vali Loss: 3.292 Vali Acc: 0.095 Test Loss: 3.292 Test Acc: 0.095
Validation loss decreased (-0.089379 --> -0.095261).  Saving model ...
Epoch: 10 cost time: 1.6986892223358154
Epoch: 10, Steps: 10 | Train Loss: 2.451 Vali Loss: 3.249 Vali Acc: 0.119 Test Loss: 3.249 Test Acc: 0.119
Validation loss decreased (-0.095261 --> -0.118791).  Saving model ...
Epoch: 11 cost time: 2.2482504844665527
Epoch: 11, Steps: 10 | Train Loss: 2.338 Vali Loss: 3.268 Vali Acc: 0.116 Test Loss: 3.268 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9277043342590332
Epoch: 12, Steps: 10 | Train Loss: 2.232 Vali Loss: 3.246 Vali Acc: 0.122 Test Loss: 3.246 Test Acc: 0.122
Validation loss decreased (-0.118791 --> -0.122320).  Saving model ...
Epoch: 13 cost time: 2.2769365310668945
Epoch: 13, Steps: 10 | Train Loss: 2.102 Vali Loss: 3.233 Vali Acc: 0.121 Test Loss: 3.233 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7478938102722168
Epoch: 14, Steps: 10 | Train Loss: 1.946 Vali Loss: 3.222 Vali Acc: 0.141 Test Loss: 3.222 Test Acc: 0.141
Validation loss decreased (-0.122320 --> -0.141144).  Saving model ...
Epoch: 15 cost time: 1.8411645889282227
Epoch: 15, Steps: 10 | Train Loss: 1.928 Vali Loss: 3.245 Vali Acc: 0.147 Test Loss: 3.245 Test Acc: 0.147
Validation loss decreased (-0.141144 --> -0.147026).  Saving model ...
Epoch: 16 cost time: 1.7714810371398926
Epoch: 16, Steps: 10 | Train Loss: 1.755 Vali Loss: 3.209 Vali Acc: 0.127 Test Loss: 3.209 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0346322059631348
Epoch: 17, Steps: 10 | Train Loss: 1.678 Vali Loss: 3.219 Vali Acc: 0.160 Test Loss: 3.219 Test Acc: 0.160
Validation loss decreased (-0.147026 --> -0.159968).  Saving model ...
Epoch: 18 cost time: 2.18266224861145
Epoch: 18, Steps: 10 | Train Loss: 1.571 Vali Loss: 3.210 Vali Acc: 0.168 Test Loss: 3.210 Test Acc: 0.168
Validation loss decreased (-0.159968 --> -0.168203).  Saving model ...
Epoch: 19 cost time: 1.9825549125671387
Epoch: 19, Steps: 10 | Train Loss: 1.420 Vali Loss: 3.197 Vali Acc: 0.167 Test Loss: 3.197 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9336066246032715
Epoch: 20, Steps: 10 | Train Loss: 1.278 Vali Loss: 3.214 Vali Acc: 0.144 Test Loss: 3.214 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1630327701568604
Epoch: 21, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.241 Vali Acc: 0.174 Test Loss: 3.241 Test Acc: 0.174
Validation loss decreased (-0.168203 --> -0.174085).  Saving model ...
Epoch: 22 cost time: 1.8223788738250732
Epoch: 22, Steps: 10 | Train Loss: 1.065 Vali Loss: 3.308 Vali Acc: 0.176 Test Loss: 3.308 Test Acc: 0.176
Validation loss decreased (-0.174085 --> -0.176438).  Saving model ...
Epoch: 23 cost time: 1.8666517734527588
Epoch: 23, Steps: 10 | Train Loss: 0.972 Vali Loss: 3.275 Vali Acc: 0.195 Test Loss: 3.275 Test Acc: 0.195
Validation loss decreased (-0.176438 --> -0.195261).  Saving model ...
Epoch: 24 cost time: 1.7077019214630127
Epoch: 24, Steps: 10 | Train Loss: 0.885 Vali Loss: 3.288 Vali Acc: 0.173 Test Loss: 3.288 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.803215742111206
Epoch: 25, Steps: 10 | Train Loss: 0.768 Vali Loss: 3.289 Vali Acc: 0.193 Test Loss: 3.289 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.007009983062744
Epoch: 26, Steps: 10 | Train Loss: 0.718 Vali Loss: 3.280 Vali Acc: 0.198 Test Loss: 3.280 Test Acc: 0.198
Validation loss decreased (-0.195261 --> -0.197614).  Saving model ...
Epoch: 27 cost time: 2.1015429496765137
Epoch: 27, Steps: 10 | Train Loss: 0.612 Vali Loss: 3.428 Vali Acc: 0.205 Test Loss: 3.428 Test Acc: 0.205
Validation loss decreased (-0.197614 --> -0.204672).  Saving model ...
Epoch: 28 cost time: 1.8534636497497559
Epoch: 28, Steps: 10 | Train Loss: 0.534 Vali Loss: 3.314 Vali Acc: 0.208 Test Loss: 3.314 Test Acc: 0.208
Validation loss decreased (-0.204672 --> -0.208202).  Saving model ...
Epoch: 29 cost time: 1.9738290309906006
Epoch: 29, Steps: 10 | Train Loss: 0.426 Vali Loss: 3.456 Vali Acc: 0.196 Test Loss: 3.456 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7344281673431396
Epoch: 30, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.518 Vali Acc: 0.176 Test Loss: 3.518 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9127082824707031
Epoch: 31, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.510 Vali Acc: 0.169 Test Loss: 3.510 Test Acc: 0.169
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.802962303161621
Epoch: 32, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.484 Vali Acc: 0.205 Test Loss: 3.484 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5276463031768799
Epoch: 33, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.519 Vali Acc: 0.196 Test Loss: 3.519 Test Acc: 0.196
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.959031343460083
Epoch: 34, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.520 Vali Acc: 0.215 Test Loss: 3.520 Test Acc: 0.215
Validation loss decreased (-0.208202 --> -0.215259).  Saving model ...
Epoch: 35 cost time: 1.843177318572998
Epoch: 35, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.704 Vali Acc: 0.202 Test Loss: 3.704 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.1229851245880127
Epoch: 36, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.596 Vali Acc: 0.207 Test Loss: 3.596 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.9070260524749756
Epoch: 37, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.763 Vali Acc: 0.201 Test Loss: 3.763 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.5672297477722168
Epoch: 38, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.664 Vali Acc: 0.191 Test Loss: 3.664 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.9283554553985596
Epoch: 39, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.753 Vali Acc: 0.208 Test Loss: 3.753 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.943159580230713
Epoch: 40, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.739 Vali Acc: 0.214 Test Loss: 3.739 Test Acc: 0.214
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.8083648681640625
Epoch: 41, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.785 Vali Acc: 0.206 Test Loss: 3.785 Test Acc: 0.206
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.029338836669922
Epoch: 42, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.783 Vali Acc: 0.212 Test Loss: 3.783 Test Acc: 0.212
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.722029447555542
Epoch: 43, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.789 Vali Acc: 0.209 Test Loss: 3.789 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.9707458019256592
Epoch: 44, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.823 Vali Acc: 0.208 Test Loss: 3.823 Test Acc: 0.208
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21529411764705883
model parameter : 1816150
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.526788711547852
Epoch: 1, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.327 Vali Acc: 0.040 Test Loss: 3.327 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 2.062723159790039
Epoch: 2, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.371 Vali Acc: 0.038 Test Loss: 3.371 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7197208404541016
Epoch: 3, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.354 Vali Acc: 0.061 Test Loss: 3.354 Test Acc: 0.061
Validation loss decreased (-0.039967 --> -0.061143).  Saving model ...
Epoch: 4 cost time: 2.09568452835083
Epoch: 4, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.331 Vali Acc: 0.066 Test Loss: 3.331 Test Acc: 0.066
Validation loss decreased (-0.061143 --> -0.065849).  Saving model ...
Epoch: 5 cost time: 1.7183656692504883
Epoch: 5, Steps: 10 | Train Loss: 3.028 Vali Loss: 3.332 Vali Acc: 0.054 Test Loss: 3.332 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2922146320343018
Epoch: 6, Steps: 10 | Train Loss: 2.963 Vali Loss: 3.287 Vali Acc: 0.080 Test Loss: 3.287 Test Acc: 0.080
Validation loss decreased (-0.065849 --> -0.079967).  Saving model ...
Epoch: 7 cost time: 1.7493717670440674
Epoch: 7, Steps: 10 | Train Loss: 2.879 Vali Loss: 3.260 Vali Acc: 0.104 Test Loss: 3.260 Test Acc: 0.104
Validation loss decreased (-0.079967 --> -0.103497).  Saving model ...
Epoch: 8 cost time: 1.76820969581604
Epoch: 8, Steps: 10 | Train Loss: 2.775 Vali Loss: 3.265 Vali Acc: 0.095 Test Loss: 3.265 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8875031471252441
Epoch: 9, Steps: 10 | Train Loss: 2.599 Vali Loss: 3.226 Vali Acc: 0.113 Test Loss: 3.226 Test Acc: 0.113
Validation loss decreased (-0.103497 --> -0.112909).  Saving model ...
Epoch: 10 cost time: 1.773881196975708
Epoch: 10, Steps: 10 | Train Loss: 2.501 Vali Loss: 3.217 Vali Acc: 0.118 Test Loss: 3.217 Test Acc: 0.118
Validation loss decreased (-0.112909 --> -0.117615).  Saving model ...
Epoch: 11 cost time: 1.8742680549621582
Epoch: 11, Steps: 10 | Train Loss: 2.352 Vali Loss: 3.182 Vali Acc: 0.149 Test Loss: 3.182 Test Acc: 0.149
Validation loss decreased (-0.117615 --> -0.149380).  Saving model ...
Epoch: 12 cost time: 1.7845790386199951
Epoch: 12, Steps: 10 | Train Loss: 2.201 Vali Loss: 3.194 Vali Acc: 0.144 Test Loss: 3.194 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7903945446014404
Epoch: 13, Steps: 10 | Train Loss: 2.129 Vali Loss: 3.179 Vali Acc: 0.162 Test Loss: 3.179 Test Acc: 0.162
Validation loss decreased (-0.149380 --> -0.162321).  Saving model ...
Epoch: 14 cost time: 1.6364490985870361
Epoch: 14, Steps: 10 | Train Loss: 1.926 Vali Loss: 3.128 Vali Acc: 0.165 Test Loss: 3.128 Test Acc: 0.165
Validation loss decreased (-0.162321 --> -0.164675).  Saving model ...
Epoch: 15 cost time: 1.5613718032836914
Epoch: 15, Steps: 10 | Train Loss: 1.876 Vali Loss: 3.166 Vali Acc: 0.151 Test Loss: 3.166 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9840452671051025
Epoch: 16, Steps: 10 | Train Loss: 1.784 Vali Loss: 3.144 Vali Acc: 0.193 Test Loss: 3.144 Test Acc: 0.193
Validation loss decreased (-0.164675 --> -0.192910).  Saving model ...
Epoch: 17 cost time: 1.8179528713226318
Epoch: 17, Steps: 10 | Train Loss: 1.586 Vali Loss: 3.134 Vali Acc: 0.174 Test Loss: 3.134 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5398681163787842
Epoch: 18, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.138 Vali Acc: 0.171 Test Loss: 3.138 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6159615516662598
Epoch: 19, Steps: 10 | Train Loss: 1.336 Vali Loss: 3.111 Vali Acc: 0.192 Test Loss: 3.111 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5544443130493164
Epoch: 20, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.155 Vali Acc: 0.186 Test Loss: 3.155 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7026476860046387
Epoch: 21, Steps: 10 | Train Loss: 1.105 Vali Loss: 3.096 Vali Acc: 0.201 Test Loss: 3.096 Test Acc: 0.201
Validation loss decreased (-0.192910 --> -0.201146).  Saving model ...
Epoch: 22 cost time: 1.6431286334991455
Epoch: 22, Steps: 10 | Train Loss: 0.946 Vali Loss: 3.098 Vali Acc: 0.218 Test Loss: 3.098 Test Acc: 0.218
Validation loss decreased (-0.201146 --> -0.217616).  Saving model ...
Epoch: 23 cost time: 1.7873682975769043
Epoch: 23, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.130 Vali Acc: 0.213 Test Loss: 3.130 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7338716983795166
Epoch: 24, Steps: 10 | Train Loss: 0.812 Vali Loss: 3.189 Vali Acc: 0.204 Test Loss: 3.189 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.804124355316162
Epoch: 25, Steps: 10 | Train Loss: 0.692 Vali Loss: 3.171 Vali Acc: 0.220 Test Loss: 3.171 Test Acc: 0.220
Validation loss decreased (-0.217616 --> -0.219968).  Saving model ...
Epoch: 26 cost time: 1.6281452178955078
Epoch: 26, Steps: 10 | Train Loss: 0.568 Vali Loss: 3.119 Vali Acc: 0.241 Test Loss: 3.119 Test Acc: 0.241
Validation loss decreased (-0.219968 --> -0.241145).  Saving model ...
Epoch: 27 cost time: 1.6825830936431885
Epoch: 27, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.242 Vali Acc: 0.233 Test Loss: 3.242 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.303424596786499
Epoch: 28, Steps: 10 | Train Loss: 0.422 Vali Loss: 3.207 Vali Acc: 0.238 Test Loss: 3.207 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6316232681274414
Epoch: 29, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.263 Vali Acc: 0.212 Test Loss: 3.263 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8385553359985352
Epoch: 30, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.313 Vali Acc: 0.225 Test Loss: 3.313 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.785776138305664
Epoch: 31, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.418 Vali Acc: 0.211 Test Loss: 3.418 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.8512859344482422
Epoch: 32, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.370 Vali Acc: 0.215 Test Loss: 3.370 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9626209735870361
Epoch: 33, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.345 Vali Acc: 0.238 Test Loss: 3.345 Test Acc: 0.238
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5858912467956543
Epoch: 34, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.385 Vali Acc: 0.240 Test Loss: 3.385 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.748948335647583
Epoch: 35, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.476 Vali Acc: 0.214 Test Loss: 3.476 Test Acc: 0.214
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.6422297954559326
Epoch: 36, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.580 Vali Acc: 0.214 Test Loss: 3.580 Test Acc: 0.214
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2411764705882353
model parameter : 1814486
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.382647514343262
Epoch: 1, Steps: 10 | Train Loss: 3.402 Vali Loss: 3.342 Vali Acc: 0.042 Test Loss: 3.342 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 2.7850515842437744
Epoch: 2, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.300 Vali Acc: 0.041 Test Loss: 3.300 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.153258800506592
Epoch: 3, Steps: 10 | Train Loss: 3.268 Vali Loss: 3.324 Vali Acc: 0.044 Test Loss: 3.324 Test Acc: 0.044
Validation loss decreased (-0.042320 --> -0.043496).  Saving model ...
Epoch: 4 cost time: 2.153249502182007
Epoch: 4, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.339 Vali Acc: 0.052 Test Loss: 3.339 Test Acc: 0.052
Validation loss decreased (-0.043496 --> -0.051731).  Saving model ...
Epoch: 5 cost time: 1.9723782539367676
Epoch: 5, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.336 Vali Acc: 0.044 Test Loss: 3.336 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6975300312042236
Epoch: 6, Steps: 10 | Train Loss: 3.074 Vali Loss: 3.320 Vali Acc: 0.062 Test Loss: 3.320 Test Acc: 0.062
Validation loss decreased (-0.051731 --> -0.062320).  Saving model ...
Epoch: 7 cost time: 2.1447877883911133
Epoch: 7, Steps: 10 | Train Loss: 3.032 Vali Loss: 3.300 Vali Acc: 0.059 Test Loss: 3.300 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5646677017211914
Epoch: 8, Steps: 10 | Train Loss: 2.948 Vali Loss: 3.295 Vali Acc: 0.073 Test Loss: 3.295 Test Acc: 0.073
Validation loss decreased (-0.062320 --> -0.072908).  Saving model ...
Epoch: 9 cost time: 2.061142683029175
Epoch: 9, Steps: 10 | Train Loss: 2.802 Vali Loss: 3.270 Vali Acc: 0.100 Test Loss: 3.270 Test Acc: 0.100
Validation loss decreased (-0.072908 --> -0.099967).  Saving model ...
Epoch: 10 cost time: 2.0043816566467285
Epoch: 10, Steps: 10 | Train Loss: 2.701 Vali Loss: 3.255 Vali Acc: 0.101 Test Loss: 3.255 Test Acc: 0.101
Validation loss decreased (-0.099967 --> -0.101144).  Saving model ...
Epoch: 11 cost time: 2.073838233947754
Epoch: 11, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.251 Vali Acc: 0.124 Test Loss: 3.251 Test Acc: 0.124
Validation loss decreased (-0.101144 --> -0.123497).  Saving model ...
Epoch: 12 cost time: 2.0950467586517334
Epoch: 12, Steps: 10 | Train Loss: 2.443 Vali Loss: 3.227 Vali Acc: 0.125 Test Loss: 3.227 Test Acc: 0.125
Validation loss decreased (-0.123497 --> -0.124674).  Saving model ...
Epoch: 13 cost time: 1.8664112091064453
Epoch: 13, Steps: 10 | Train Loss: 2.313 Vali Loss: 3.221 Vali Acc: 0.126 Test Loss: 3.221 Test Acc: 0.126
Validation loss decreased (-0.124674 --> -0.125850).  Saving model ...
Epoch: 14 cost time: 1.6683216094970703
Epoch: 14, Steps: 10 | Train Loss: 2.177 Vali Loss: 3.234 Vali Acc: 0.140 Test Loss: 3.234 Test Acc: 0.140
Validation loss decreased (-0.125850 --> -0.139968).  Saving model ...
Epoch: 15 cost time: 1.7601675987243652
Epoch: 15, Steps: 10 | Train Loss: 2.089 Vali Loss: 3.186 Vali Acc: 0.151 Test Loss: 3.186 Test Acc: 0.151
Validation loss decreased (-0.139968 --> -0.150556).  Saving model ...
Epoch: 16 cost time: 1.8470840454101562
Epoch: 16, Steps: 10 | Train Loss: 1.985 Vali Loss: 3.215 Vali Acc: 0.140 Test Loss: 3.215 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5888268947601318
Epoch: 17, Steps: 10 | Train Loss: 1.848 Vali Loss: 3.190 Vali Acc: 0.154 Test Loss: 3.190 Test Acc: 0.154
Validation loss decreased (-0.150556 --> -0.154086).  Saving model ...
Epoch: 18 cost time: 2.0295567512512207
Epoch: 18, Steps: 10 | Train Loss: 1.766 Vali Loss: 3.183 Vali Acc: 0.172 Test Loss: 3.183 Test Acc: 0.172
Validation loss decreased (-0.154086 --> -0.171733).  Saving model ...
Epoch: 19 cost time: 1.9199504852294922
Epoch: 19, Steps: 10 | Train Loss: 1.597 Vali Loss: 3.227 Vali Acc: 0.155 Test Loss: 3.227 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.951732873916626
Epoch: 20, Steps: 10 | Train Loss: 1.514 Vali Loss: 3.177 Vali Acc: 0.186 Test Loss: 3.177 Test Acc: 0.186
Validation loss decreased (-0.171733 --> -0.185851).  Saving model ...
Epoch: 21 cost time: 1.9678246974945068
Epoch: 21, Steps: 10 | Train Loss: 1.428 Vali Loss: 3.172 Vali Acc: 0.182 Test Loss: 3.172 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9565985202789307
Epoch: 22, Steps: 10 | Train Loss: 1.305 Vali Loss: 3.196 Vali Acc: 0.182 Test Loss: 3.196 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7868177890777588
Epoch: 23, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.211 Vali Acc: 0.184 Test Loss: 3.211 Test Acc: 0.184
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0474865436553955
Epoch: 24, Steps: 10 | Train Loss: 1.054 Vali Loss: 3.221 Vali Acc: 0.195 Test Loss: 3.221 Test Acc: 0.195
Validation loss decreased (-0.185851 --> -0.195262).  Saving model ...
Epoch: 25 cost time: 1.868727207183838
Epoch: 25, Steps: 10 | Train Loss: 1.000 Vali Loss: 3.253 Vali Acc: 0.201 Test Loss: 3.253 Test Acc: 0.201
Validation loss decreased (-0.195262 --> -0.201144).  Saving model ...
Epoch: 26 cost time: 1.8914799690246582
Epoch: 26, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.267 Vali Acc: 0.212 Test Loss: 3.267 Test Acc: 0.212
Validation loss decreased (-0.201144 --> -0.211732).  Saving model ...
Epoch: 27 cost time: 2.3561482429504395
Epoch: 27, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.308 Vali Acc: 0.215 Test Loss: 3.308 Test Acc: 0.215
Validation loss decreased (-0.211732 --> -0.215261).  Saving model ...
Epoch: 28 cost time: 1.922084093093872
Epoch: 28, Steps: 10 | Train Loss: 0.667 Vali Loss: 3.268 Vali Acc: 0.211 Test Loss: 3.268 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1697802543640137
Epoch: 29, Steps: 10 | Train Loss: 0.622 Vali Loss: 3.367 Vali Acc: 0.207 Test Loss: 3.367 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8047559261322021
Epoch: 30, Steps: 10 | Train Loss: 0.499 Vali Loss: 3.287 Vali Acc: 0.209 Test Loss: 3.287 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7781565189361572
Epoch: 31, Steps: 10 | Train Loss: 0.474 Vali Loss: 3.335 Vali Acc: 0.219 Test Loss: 3.335 Test Acc: 0.219
Validation loss decreased (-0.215261 --> -0.218790).  Saving model ...
Epoch: 32 cost time: 1.8354229927062988
Epoch: 32, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.527 Vali Acc: 0.226 Test Loss: 3.527 Test Acc: 0.226
Validation loss decreased (-0.218790 --> -0.225847).  Saving model ...
Epoch: 33 cost time: 2.0646798610687256
Epoch: 33, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.419 Vali Acc: 0.219 Test Loss: 3.419 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9780504703521729
Epoch: 34, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.508 Vali Acc: 0.216 Test Loss: 3.508 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.295250415802002
Epoch: 35, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.430 Vali Acc: 0.235 Test Loss: 3.430 Test Acc: 0.235
Validation loss decreased (-0.225847 --> -0.235260).  Saving model ...
Epoch: 36 cost time: 1.5712924003601074
Epoch: 36, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.503 Vali Acc: 0.220 Test Loss: 3.503 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.821648120880127
Epoch: 37, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.510 Vali Acc: 0.233 Test Loss: 3.510 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.019423007965088
Epoch: 38, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.522 Vali Acc: 0.239 Test Loss: 3.522 Test Acc: 0.239
Validation loss decreased (-0.235260 --> -0.238788).  Saving model ...
Epoch: 39 cost time: 1.8790996074676514
Epoch: 39, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.614 Vali Acc: 0.235 Test Loss: 3.614 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9966444969177246
Epoch: 40, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.649 Vali Acc: 0.236 Test Loss: 3.649 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6200315952301025
Epoch: 41, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.674 Vali Acc: 0.241 Test Loss: 3.674 Test Acc: 0.241
Validation loss decreased (-0.238788 --> -0.241140).  Saving model ...
Epoch: 42 cost time: 1.855790376663208
Epoch: 42, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.642 Vali Acc: 0.232 Test Loss: 3.642 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.0970945358276367
Epoch: 43, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.690 Vali Acc: 0.246 Test Loss: 3.690 Test Acc: 0.246
Validation loss decreased (-0.241140 --> -0.245845).  Saving model ...
Epoch: 44 cost time: 1.6778428554534912
Epoch: 44, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.707 Vali Acc: 0.242 Test Loss: 3.707 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.135951519012451
Epoch: 45, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.728 Vali Acc: 0.244 Test Loss: 3.728 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.921945333480835
Epoch: 46, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.730 Vali Acc: 0.242 Test Loss: 3.730 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.024322032928467
Epoch: 47, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.717 Vali Acc: 0.252 Test Loss: 3.717 Test Acc: 0.252
Validation loss decreased (-0.245845 --> -0.251728).  Saving model ...
Epoch: 48 cost time: 1.7686104774475098
Epoch: 48, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.781 Vali Acc: 0.238 Test Loss: 3.781 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.1049654483795166
Epoch: 49, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.814 Vali Acc: 0.235 Test Loss: 3.814 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.092116594314575
Epoch: 50, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.763 Vali Acc: 0.242 Test Loss: 3.763 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.0988852977752686
Epoch: 51, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.821 Vali Acc: 0.248 Test Loss: 3.821 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.3450686931610107
Epoch: 52, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.836 Vali Acc: 0.248 Test Loss: 3.836 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.14054799079895
Epoch: 53, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.854 Vali Acc: 0.249 Test Loss: 3.854 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 2.129847288131714
Epoch: 54, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.856 Vali Acc: 0.238 Test Loss: 3.856 Test Acc: 0.238
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 2.1465940475463867
Epoch: 55, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.857 Vali Acc: 0.246 Test Loss: 3.857 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 2.2826592922210693
Epoch: 56, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.849 Vali Acc: 0.247 Test Loss: 3.849 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.0610451698303223
Epoch: 57, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.892 Vali Acc: 0.242 Test Loss: 3.892 Test Acc: 0.242
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25176470588235295
model parameter : 1225046
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.254718542098999
Epoch: 1, Steps: 10 | Train Loss: 3.407 Vali Loss: 3.356 Vali Acc: 0.045 Test Loss: 3.356 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 1.8879261016845703
Epoch: 2, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.335 Vali Acc: 0.038 Test Loss: 3.335 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.863438606262207
Epoch: 3, Steps: 10 | Train Loss: 3.175 Vali Loss: 3.374 Vali Acc: 0.045 Test Loss: 3.374 Test Acc: 0.045
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6886045932769775
Epoch: 4, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.352 Vali Acc: 0.069 Test Loss: 3.352 Test Acc: 0.069
Validation loss decreased (-0.044672 --> -0.069378).  Saving model ...
Epoch: 5 cost time: 1.8944971561431885
Epoch: 5, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.316 Vali Acc: 0.074 Test Loss: 3.316 Test Acc: 0.074
Validation loss decreased (-0.069378 --> -0.074084).  Saving model ...
Epoch: 6 cost time: 1.5945789813995361
Epoch: 6, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.333 Vali Acc: 0.059 Test Loss: 3.333 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.854625940322876
Epoch: 7, Steps: 10 | Train Loss: 3.023 Vali Loss: 3.307 Vali Acc: 0.078 Test Loss: 3.307 Test Acc: 0.078
Validation loss decreased (-0.074084 --> -0.077614).  Saving model ...
Epoch: 8 cost time: 1.5981502532958984
Epoch: 8, Steps: 10 | Train Loss: 2.891 Vali Loss: 3.294 Vali Acc: 0.100 Test Loss: 3.294 Test Acc: 0.100
Validation loss decreased (-0.077614 --> -0.099967).  Saving model ...
Epoch: 9 cost time: 1.9225234985351562
Epoch: 9, Steps: 10 | Train Loss: 2.810 Vali Loss: 3.282 Vali Acc: 0.099 Test Loss: 3.282 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.871351718902588
Epoch: 10, Steps: 10 | Train Loss: 2.680 Vali Loss: 3.276 Vali Acc: 0.128 Test Loss: 3.276 Test Acc: 0.128
Validation loss decreased (-0.099967 --> -0.128203).  Saving model ...
Epoch: 11 cost time: 2.011720657348633
Epoch: 11, Steps: 10 | Train Loss: 2.518 Vali Loss: 3.229 Vali Acc: 0.129 Test Loss: 3.229 Test Acc: 0.129
Validation loss decreased (-0.128203 --> -0.129379).  Saving model ...
Epoch: 12 cost time: 1.804802656173706
Epoch: 12, Steps: 10 | Train Loss: 2.464 Vali Loss: 3.263 Vali Acc: 0.108 Test Loss: 3.263 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6302051544189453
Epoch: 13, Steps: 10 | Train Loss: 2.308 Vali Loss: 3.243 Vali Acc: 0.133 Test Loss: 3.243 Test Acc: 0.133
Validation loss decreased (-0.129379 --> -0.132909).  Saving model ...
Epoch: 14 cost time: 1.7684457302093506
Epoch: 14, Steps: 10 | Train Loss: 2.148 Vali Loss: 3.223 Vali Acc: 0.147 Test Loss: 3.223 Test Acc: 0.147
Validation loss decreased (-0.132909 --> -0.147027).  Saving model ...
Epoch: 15 cost time: 1.5485990047454834
Epoch: 15, Steps: 10 | Train Loss: 2.089 Vali Loss: 3.221 Vali Acc: 0.149 Test Loss: 3.221 Test Acc: 0.149
Validation loss decreased (-0.147027 --> -0.149380).  Saving model ...
Epoch: 16 cost time: 1.619368314743042
Epoch: 16, Steps: 10 | Train Loss: 2.005 Vali Loss: 3.233 Vali Acc: 0.171 Test Loss: 3.233 Test Acc: 0.171
Validation loss decreased (-0.149380 --> -0.170556).  Saving model ...
Epoch: 17 cost time: 1.9019804000854492
Epoch: 17, Steps: 10 | Train Loss: 1.877 Vali Loss: 3.194 Vali Acc: 0.158 Test Loss: 3.194 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7584223747253418
Epoch: 18, Steps: 10 | Train Loss: 1.754 Vali Loss: 3.205 Vali Acc: 0.175 Test Loss: 3.205 Test Acc: 0.175
Validation loss decreased (-0.170556 --> -0.175262).  Saving model ...
Epoch: 19 cost time: 1.6078269481658936
Epoch: 19, Steps: 10 | Train Loss: 1.613 Vali Loss: 3.202 Vali Acc: 0.182 Test Loss: 3.202 Test Acc: 0.182
Validation loss decreased (-0.175262 --> -0.182321).  Saving model ...
Epoch: 20 cost time: 1.5995242595672607
Epoch: 20, Steps: 10 | Train Loss: 1.559 Vali Loss: 3.205 Vali Acc: 0.162 Test Loss: 3.205 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8831467628479004
Epoch: 21, Steps: 10 | Train Loss: 1.422 Vali Loss: 3.217 Vali Acc: 0.186 Test Loss: 3.217 Test Acc: 0.186
Validation loss decreased (-0.182321 --> -0.185850).  Saving model ...
Epoch: 22 cost time: 1.8445441722869873
Epoch: 22, Steps: 10 | Train Loss: 1.312 Vali Loss: 3.126 Vali Acc: 0.193 Test Loss: 3.126 Test Acc: 0.193
Validation loss decreased (-0.185850 --> -0.192910).  Saving model ...
Epoch: 23 cost time: 1.7228412628173828
Epoch: 23, Steps: 10 | Train Loss: 1.166 Vali Loss: 3.217 Vali Acc: 0.200 Test Loss: 3.217 Test Acc: 0.200
Validation loss decreased (-0.192910 --> -0.199968).  Saving model ...
Epoch: 24 cost time: 1.7802948951721191
Epoch: 24, Steps: 10 | Train Loss: 1.059 Vali Loss: 3.148 Vali Acc: 0.185 Test Loss: 3.148 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8800134658813477
Epoch: 25, Steps: 10 | Train Loss: 1.008 Vali Loss: 3.333 Vali Acc: 0.174 Test Loss: 3.333 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6029551029205322
Epoch: 26, Steps: 10 | Train Loss: 0.897 Vali Loss: 3.176 Vali Acc: 0.204 Test Loss: 3.176 Test Acc: 0.204
Validation loss decreased (-0.199968 --> -0.203498).  Saving model ...
Epoch: 27 cost time: 1.6938490867614746
Epoch: 27, Steps: 10 | Train Loss: 0.826 Vali Loss: 3.280 Vali Acc: 0.192 Test Loss: 3.280 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2324578762054443
Epoch: 28, Steps: 10 | Train Loss: 0.741 Vali Loss: 3.267 Vali Acc: 0.199 Test Loss: 3.267 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.295086145401001
Epoch: 29, Steps: 10 | Train Loss: 0.639 Vali Loss: 3.257 Vali Acc: 0.205 Test Loss: 3.257 Test Acc: 0.205
Validation loss decreased (-0.203498 --> -0.204673).  Saving model ...
Epoch: 30 cost time: 1.8662636280059814
Epoch: 30, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.341 Vali Acc: 0.178 Test Loss: 3.341 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.047093629837036
Epoch: 31, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.344 Vali Acc: 0.213 Test Loss: 3.344 Test Acc: 0.213
Validation loss decreased (-0.204673 --> -0.212908).  Saving model ...
Epoch: 32 cost time: 2.3619327545166016
Epoch: 32, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.311 Vali Acc: 0.208 Test Loss: 3.311 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.869619607925415
Epoch: 33, Steps: 10 | Train Loss: 0.354 Vali Loss: 3.319 Vali Acc: 0.214 Test Loss: 3.319 Test Acc: 0.214
Validation loss decreased (-0.212908 --> -0.214084).  Saving model ...
Epoch: 34 cost time: 2.068295478820801
Epoch: 34, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.445 Vali Acc: 0.219 Test Loss: 3.445 Test Acc: 0.219
Validation loss decreased (-0.214084 --> -0.218789).  Saving model ...
Epoch: 35 cost time: 1.7166354656219482
Epoch: 35, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.372 Vali Acc: 0.206 Test Loss: 3.372 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9700291156768799
Epoch: 36, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.364 Vali Acc: 0.235 Test Loss: 3.364 Test Acc: 0.235
Validation loss decreased (-0.218789 --> -0.235260).  Saving model ...
Epoch: 37 cost time: 1.6471927165985107
Epoch: 37, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.486 Vali Acc: 0.215 Test Loss: 3.486 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7453076839447021
Epoch: 38, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.553 Vali Acc: 0.216 Test Loss: 3.553 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7729556560516357
Epoch: 39, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.544 Vali Acc: 0.222 Test Loss: 3.544 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.9745702743530273
Epoch: 40, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.514 Vali Acc: 0.227 Test Loss: 3.514 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.5939152240753174
Epoch: 41, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.468 Vali Acc: 0.249 Test Loss: 3.468 Test Acc: 0.249
Validation loss decreased (-0.235260 --> -0.249377).  Saving model ...
Epoch: 42 cost time: 2.0396623611450195
Epoch: 42, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.553 Vali Acc: 0.232 Test Loss: 3.553 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.7560601234436035
Epoch: 43, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.547 Vali Acc: 0.246 Test Loss: 3.547 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.671220302581787
Epoch: 44, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.560 Vali Acc: 0.253 Test Loss: 3.560 Test Acc: 0.253
Validation loss decreased (-0.249377 --> -0.252906).  Saving model ...
Epoch: 45 cost time: 1.8508548736572266
Epoch: 45, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.566 Vali Acc: 0.246 Test Loss: 3.566 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.8330206871032715
Epoch: 46, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.602 Vali Acc: 0.232 Test Loss: 3.602 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.7706925868988037
Epoch: 47, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.641 Vali Acc: 0.234 Test Loss: 3.641 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.023887872695923
Epoch: 48, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.619 Vali Acc: 0.245 Test Loss: 3.619 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.5568819046020508
Epoch: 49, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.634 Vali Acc: 0.251 Test Loss: 3.634 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.8953721523284912
Epoch: 50, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.678 Vali Acc: 0.248 Test Loss: 3.678 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.8884925842285156
Epoch: 51, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.677 Vali Acc: 0.251 Test Loss: 3.677 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.5939290523529053
Epoch: 52, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.663 Vali Acc: 0.252 Test Loss: 3.663 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.8497729301452637
Epoch: 53, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.713 Vali Acc: 0.247 Test Loss: 3.713 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.9352502822875977
Epoch: 54, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.735 Vali Acc: 0.236 Test Loss: 3.735 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 1223382
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7445621490478516
Epoch: 1, Steps: 10 | Train Loss: 3.475 Vali Loss: 3.432 Vali Acc: 0.036 Test Loss: 3.432 Test Acc: 0.036
Validation loss decreased (inf --> -0.036436).  Saving model ...
Epoch: 2 cost time: 1.7580273151397705
Epoch: 2, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.375 Vali Acc: 0.044 Test Loss: 3.375 Test Acc: 0.044
Validation loss decreased (-0.036436 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 1.4640748500823975
Epoch: 3, Steps: 10 | Train Loss: 3.222 Vali Loss: 3.364 Vali Acc: 0.038 Test Loss: 3.364 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.798933506011963
Epoch: 4, Steps: 10 | Train Loss: 3.133 Vali Loss: 3.360 Vali Acc: 0.049 Test Loss: 3.360 Test Acc: 0.049
Validation loss decreased (-0.043496 --> -0.049378).  Saving model ...
Epoch: 5 cost time: 1.9036362171173096
Epoch: 5, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.338 Vali Acc: 0.052 Test Loss: 3.338 Test Acc: 0.052
Validation loss decreased (-0.049378 --> -0.051731).  Saving model ...
Epoch: 6 cost time: 1.8433220386505127
Epoch: 6, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.336 Vali Acc: 0.087 Test Loss: 3.336 Test Acc: 0.087
Validation loss decreased (-0.051731 --> -0.087025).  Saving model ...
Epoch: 7 cost time: 1.7067968845367432
Epoch: 7, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.337 Vali Acc: 0.075 Test Loss: 3.337 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.756354570388794
Epoch: 8, Steps: 10 | Train Loss: 2.816 Vali Loss: 3.298 Vali Acc: 0.092 Test Loss: 3.298 Test Acc: 0.092
Validation loss decreased (-0.087025 --> -0.091732).  Saving model ...
Epoch: 9 cost time: 1.9452767372131348
Epoch: 9, Steps: 10 | Train Loss: 2.721 Vali Loss: 3.294 Vali Acc: 0.107 Test Loss: 3.294 Test Acc: 0.107
Validation loss decreased (-0.091732 --> -0.107026).  Saving model ...
Epoch: 10 cost time: 2.0811264514923096
Epoch: 10, Steps: 10 | Train Loss: 2.590 Vali Loss: 3.254 Vali Acc: 0.114 Test Loss: 3.254 Test Acc: 0.114
Validation loss decreased (-0.107026 --> -0.114085).  Saving model ...
Epoch: 11 cost time: 1.8073105812072754
Epoch: 11, Steps: 10 | Train Loss: 2.490 Vali Loss: 3.267 Vali Acc: 0.126 Test Loss: 3.267 Test Acc: 0.126
Validation loss decreased (-0.114085 --> -0.125850).  Saving model ...
Epoch: 12 cost time: 1.8279614448547363
Epoch: 12, Steps: 10 | Train Loss: 2.332 Vali Loss: 3.255 Vali Acc: 0.131 Test Loss: 3.255 Test Acc: 0.131
Validation loss decreased (-0.125850 --> -0.130556).  Saving model ...
Epoch: 13 cost time: 1.820176124572754
Epoch: 13, Steps: 10 | Train Loss: 2.187 Vali Loss: 3.240 Vali Acc: 0.134 Test Loss: 3.240 Test Acc: 0.134
Validation loss decreased (-0.130556 --> -0.134085).  Saving model ...
Epoch: 14 cost time: 1.6470155715942383
Epoch: 14, Steps: 10 | Train Loss: 2.173 Vali Loss: 3.226 Vali Acc: 0.142 Test Loss: 3.226 Test Acc: 0.142
Validation loss decreased (-0.134085 --> -0.142321).  Saving model ...
Epoch: 15 cost time: 1.9137287139892578
Epoch: 15, Steps: 10 | Train Loss: 1.986 Vali Loss: 3.262 Vali Acc: 0.139 Test Loss: 3.262 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9520254135131836
Epoch: 16, Steps: 10 | Train Loss: 1.902 Vali Loss: 3.222 Vali Acc: 0.174 Test Loss: 3.222 Test Acc: 0.174
Validation loss decreased (-0.142321 --> -0.174085).  Saving model ...
Epoch: 17 cost time: 1.8592193126678467
Epoch: 17, Steps: 10 | Train Loss: 1.737 Vali Loss: 3.228 Vali Acc: 0.174 Test Loss: 3.228 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8399779796600342
Epoch: 18, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.222 Vali Acc: 0.165 Test Loss: 3.222 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6864917278289795
Epoch: 19, Steps: 10 | Train Loss: 1.599 Vali Loss: 3.210 Vali Acc: 0.184 Test Loss: 3.210 Test Acc: 0.184
Validation loss decreased (-0.174085 --> -0.183497).  Saving model ...
Epoch: 20 cost time: 2.036937952041626
Epoch: 20, Steps: 10 | Train Loss: 1.419 Vali Loss: 3.225 Vali Acc: 0.181 Test Loss: 3.225 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.197561025619507
Epoch: 21, Steps: 10 | Train Loss: 1.336 Vali Loss: 3.232 Vali Acc: 0.178 Test Loss: 3.232 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1824769973754883
Epoch: 22, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.228 Vali Acc: 0.192 Test Loss: 3.228 Test Acc: 0.192
Validation loss decreased (-0.183497 --> -0.191732).  Saving model ...
Epoch: 23 cost time: 2.652891159057617
Epoch: 23, Steps: 10 | Train Loss: 1.088 Vali Loss: 3.215 Vali Acc: 0.196 Test Loss: 3.215 Test Acc: 0.196
Validation loss decreased (-0.191732 --> -0.196438).  Saving model ...
Epoch: 24 cost time: 1.955456256866455
Epoch: 24, Steps: 10 | Train Loss: 0.956 Vali Loss: 3.252 Vali Acc: 0.189 Test Loss: 3.252 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.364112138748169
Epoch: 25, Steps: 10 | Train Loss: 0.942 Vali Loss: 3.278 Vali Acc: 0.185 Test Loss: 3.278 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8522891998291016
Epoch: 26, Steps: 10 | Train Loss: 0.863 Vali Loss: 3.276 Vali Acc: 0.195 Test Loss: 3.276 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0949995517730713
Epoch: 27, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.270 Vali Acc: 0.209 Test Loss: 3.270 Test Acc: 0.209
Validation loss decreased (-0.196438 --> -0.209379).  Saving model ...
Epoch: 28 cost time: 2.326313018798828
Epoch: 28, Steps: 10 | Train Loss: 0.666 Vali Loss: 3.245 Vali Acc: 0.220 Test Loss: 3.245 Test Acc: 0.220
Validation loss decreased (-0.209379 --> -0.219968).  Saving model ...
Epoch: 29 cost time: 1.8837499618530273
Epoch: 29, Steps: 10 | Train Loss: 0.576 Vali Loss: 3.313 Vali Acc: 0.222 Test Loss: 3.313 Test Acc: 0.222
Validation loss decreased (-0.219968 --> -0.222320).  Saving model ...
Epoch: 30 cost time: 2.1031577587127686
Epoch: 30, Steps: 10 | Train Loss: 0.497 Vali Loss: 3.278 Vali Acc: 0.233 Test Loss: 3.278 Test Acc: 0.233
Validation loss decreased (-0.222320 --> -0.232908).  Saving model ...
Epoch: 31 cost time: 2.1983039379119873
Epoch: 31, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.379 Vali Acc: 0.211 Test Loss: 3.379 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9501924514770508
Epoch: 32, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.318 Vali Acc: 0.235 Test Loss: 3.318 Test Acc: 0.235
Validation loss decreased (-0.232908 --> -0.235261).  Saving model ...
Epoch: 33 cost time: 1.7228786945343018
Epoch: 33, Steps: 10 | Train Loss: 0.312 Vali Loss: 3.412 Vali Acc: 0.231 Test Loss: 3.412 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5543122291564941
Epoch: 34, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.385 Vali Acc: 0.233 Test Loss: 3.385 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.843665599822998
Epoch: 35, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.459 Vali Acc: 0.226 Test Loss: 3.459 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7485787868499756
Epoch: 36, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.406 Vali Acc: 0.239 Test Loss: 3.406 Test Acc: 0.239
Validation loss decreased (-0.235261 --> -0.238789).  Saving model ...
Epoch: 37 cost time: 1.6429643630981445
Epoch: 37, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.443 Vali Acc: 0.253 Test Loss: 3.443 Test Acc: 0.253
Validation loss decreased (-0.238789 --> -0.252907).  Saving model ...
Epoch: 38 cost time: 1.765906810760498
Epoch: 38, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.421 Vali Acc: 0.244 Test Loss: 3.421 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7676246166229248
Epoch: 39, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.598 Vali Acc: 0.236 Test Loss: 3.598 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.8682820796966553
Epoch: 40, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.566 Vali Acc: 0.235 Test Loss: 3.566 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8539996147155762
Epoch: 41, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.552 Vali Acc: 0.264 Test Loss: 3.552 Test Acc: 0.264
Validation loss decreased (-0.252907 --> -0.263494).  Saving model ...
Epoch: 42 cost time: 1.6649384498596191
Epoch: 42, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.582 Vali Acc: 0.234 Test Loss: 3.582 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.959247350692749
Epoch: 43, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.543 Vali Acc: 0.255 Test Loss: 3.543 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.7307209968566895
Epoch: 44, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.593 Vali Acc: 0.242 Test Loss: 3.593 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.8334600925445557
Epoch: 45, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.613 Vali Acc: 0.252 Test Loss: 3.613 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.9193222522735596
Epoch: 46, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.674 Vali Acc: 0.253 Test Loss: 3.674 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.807598352432251
Epoch: 47, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.625 Vali Acc: 0.253 Test Loss: 3.625 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.027733087539673
Epoch: 48, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.661 Vali Acc: 0.249 Test Loss: 3.661 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.7851426601409912
Epoch: 49, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.695 Vali Acc: 0.252 Test Loss: 3.695 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.8113234043121338
Epoch: 50, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.680 Vali Acc: 0.253 Test Loss: 3.680 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.7205781936645508
Epoch: 51, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.751 Vali Acc: 0.247 Test Loss: 3.751 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 1221718
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.154893159866333
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.344 Vali Acc: 0.040 Test Loss: 3.344 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 2.2186129093170166
Epoch: 2, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.308 Vali Acc: 0.044 Test Loss: 3.308 Test Acc: 0.044
Validation loss decreased (-0.039967 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 1.9275212287902832
Epoch: 3, Steps: 10 | Train Loss: 3.184 Vali Loss: 3.321 Vali Acc: 0.049 Test Loss: 3.321 Test Acc: 0.049
Validation loss decreased (-0.043496 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 1.9949114322662354
Epoch: 4, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.326 Vali Acc: 0.044 Test Loss: 3.326 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.444692850112915
Epoch: 5, Steps: 10 | Train Loss: 3.073 Vali Loss: 3.313 Vali Acc: 0.059 Test Loss: 3.313 Test Acc: 0.059
Validation loss decreased (-0.049379 --> -0.058790).  Saving model ...
Epoch: 6 cost time: 1.7433912754058838
Epoch: 6, Steps: 10 | Train Loss: 3.012 Vali Loss: 3.297 Vali Acc: 0.069 Test Loss: 3.297 Test Acc: 0.069
Validation loss decreased (-0.058790 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 1.9465439319610596
Epoch: 7, Steps: 10 | Train Loss: 2.890 Vali Loss: 3.264 Vali Acc: 0.093 Test Loss: 3.264 Test Acc: 0.093
Validation loss decreased (-0.069379 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 1.937842845916748
Epoch: 8, Steps: 10 | Train Loss: 2.801 Vali Loss: 3.266 Vali Acc: 0.101 Test Loss: 3.266 Test Acc: 0.101
Validation loss decreased (-0.092909 --> -0.101144).  Saving model ...
Epoch: 9 cost time: 2.016984224319458
Epoch: 9, Steps: 10 | Train Loss: 2.692 Vali Loss: 3.267 Vali Acc: 0.108 Test Loss: 3.267 Test Acc: 0.108
Validation loss decreased (-0.101144 --> -0.108203).  Saving model ...
Epoch: 10 cost time: 1.6049129962921143
Epoch: 10, Steps: 10 | Train Loss: 2.581 Vali Loss: 3.260 Vali Acc: 0.104 Test Loss: 3.260 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8289189338684082
Epoch: 11, Steps: 10 | Train Loss: 2.420 Vali Loss: 3.246 Vali Acc: 0.118 Test Loss: 3.246 Test Acc: 0.118
Validation loss decreased (-0.108203 --> -0.117615).  Saving model ...
Epoch: 12 cost time: 1.7716915607452393
Epoch: 12, Steps: 10 | Train Loss: 2.323 Vali Loss: 3.247 Vali Acc: 0.145 Test Loss: 3.247 Test Acc: 0.145
Validation loss decreased (-0.117615 --> -0.144673).  Saving model ...
Epoch: 13 cost time: 1.6340558528900146
Epoch: 13, Steps: 10 | Train Loss: 2.214 Vali Loss: 3.265 Vali Acc: 0.133 Test Loss: 3.265 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8263540267944336
Epoch: 14, Steps: 10 | Train Loss: 2.096 Vali Loss: 3.212 Vali Acc: 0.155 Test Loss: 3.212 Test Acc: 0.155
Validation loss decreased (-0.144673 --> -0.155262).  Saving model ...
Epoch: 15 cost time: 2.141895055770874
Epoch: 15, Steps: 10 | Train Loss: 1.982 Vali Loss: 3.255 Vali Acc: 0.148 Test Loss: 3.255 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.823718786239624
Epoch: 16, Steps: 10 | Train Loss: 1.864 Vali Loss: 3.223 Vali Acc: 0.161 Test Loss: 3.223 Test Acc: 0.161
Validation loss decreased (-0.155262 --> -0.161144).  Saving model ...
Epoch: 17 cost time: 1.8379597663879395
Epoch: 17, Steps: 10 | Train Loss: 1.745 Vali Loss: 3.237 Vali Acc: 0.155 Test Loss: 3.237 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1540157794952393
Epoch: 18, Steps: 10 | Train Loss: 1.699 Vali Loss: 3.230 Vali Acc: 0.178 Test Loss: 3.230 Test Acc: 0.178
Validation loss decreased (-0.161144 --> -0.177615).  Saving model ...
Epoch: 19 cost time: 1.9830880165100098
Epoch: 19, Steps: 10 | Train Loss: 1.587 Vali Loss: 3.204 Vali Acc: 0.201 Test Loss: 3.204 Test Acc: 0.201
Validation loss decreased (-0.177615 --> -0.201144).  Saving model ...
Epoch: 20 cost time: 2.5112733840942383
Epoch: 20, Steps: 10 | Train Loss: 1.407 Vali Loss: 3.234 Vali Acc: 0.188 Test Loss: 3.234 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.61484956741333
Epoch: 21, Steps: 10 | Train Loss: 1.337 Vali Loss: 3.277 Vali Acc: 0.185 Test Loss: 3.277 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4982693195343018
Epoch: 22, Steps: 10 | Train Loss: 1.251 Vali Loss: 3.224 Vali Acc: 0.195 Test Loss: 3.224 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5796639919281006
Epoch: 23, Steps: 10 | Train Loss: 1.096 Vali Loss: 3.216 Vali Acc: 0.207 Test Loss: 3.216 Test Acc: 0.207
Validation loss decreased (-0.201144 --> -0.207027).  Saving model ...
Epoch: 24 cost time: 1.7411584854125977
Epoch: 24, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.298 Vali Acc: 0.204 Test Loss: 3.298 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.907170295715332
Epoch: 25, Steps: 10 | Train Loss: 0.901 Vali Loss: 3.248 Vali Acc: 0.225 Test Loss: 3.248 Test Acc: 0.225
Validation loss decreased (-0.207027 --> -0.224673).  Saving model ...
Epoch: 26 cost time: 1.7858762741088867
Epoch: 26, Steps: 10 | Train Loss: 0.830 Vali Loss: 3.277 Vali Acc: 0.212 Test Loss: 3.277 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2179079055786133
Epoch: 27, Steps: 10 | Train Loss: 0.747 Vali Loss: 3.274 Vali Acc: 0.222 Test Loss: 3.274 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.064735174179077
Epoch: 28, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.301 Vali Acc: 0.220 Test Loss: 3.301 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8042514324188232
Epoch: 29, Steps: 10 | Train Loss: 0.573 Vali Loss: 3.298 Vali Acc: 0.229 Test Loss: 3.298 Test Acc: 0.229
Validation loss decreased (-0.224673 --> -0.229379).  Saving model ...
Epoch: 30 cost time: 2.0245180130004883
Epoch: 30, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.258 Vali Acc: 0.244 Test Loss: 3.258 Test Acc: 0.244
Validation loss decreased (-0.229379 --> -0.243497).  Saving model ...
Epoch: 31 cost time: 1.9707067012786865
Epoch: 31, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.278 Vali Acc: 0.247 Test Loss: 3.278 Test Acc: 0.247
Validation loss decreased (-0.243497 --> -0.247026).  Saving model ...
Epoch: 32 cost time: 1.844989538192749
Epoch: 32, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.318 Vali Acc: 0.244 Test Loss: 3.318 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8334050178527832
Epoch: 33, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.376 Vali Acc: 0.256 Test Loss: 3.376 Test Acc: 0.256
Validation loss decreased (-0.247026 --> -0.256437).  Saving model ...
Epoch: 34 cost time: 1.9591712951660156
Epoch: 34, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.366 Vali Acc: 0.229 Test Loss: 3.366 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8289265632629395
Epoch: 35, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.393 Vali Acc: 0.258 Test Loss: 3.393 Test Acc: 0.258
Validation loss decreased (-0.256437 --> -0.257613).  Saving model ...
Epoch: 36 cost time: 1.7636268138885498
Epoch: 36, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.425 Vali Acc: 0.259 Test Loss: 3.425 Test Acc: 0.259
Validation loss decreased (-0.257613 --> -0.258789).  Saving model ...
Epoch: 37 cost time: 1.890399694442749
Epoch: 37, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.435 Vali Acc: 0.249 Test Loss: 3.435 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7346258163452148
Epoch: 38, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.494 Vali Acc: 0.252 Test Loss: 3.494 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.9211244583129883
Epoch: 39, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.450 Vali Acc: 0.266 Test Loss: 3.450 Test Acc: 0.266
Validation loss decreased (-0.258789 --> -0.265848).  Saving model ...
Epoch: 40 cost time: 1.649857759475708
Epoch: 40, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.514 Vali Acc: 0.273 Test Loss: 3.514 Test Acc: 0.273
Validation loss decreased (-0.265848 --> -0.272906).  Saving model ...
Epoch: 41 cost time: 1.9527204036712646
Epoch: 41, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.520 Vali Acc: 0.255 Test Loss: 3.520 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.948904037475586
Epoch: 42, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.586 Vali Acc: 0.252 Test Loss: 3.586 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.9060792922973633
Epoch: 43, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.638 Vali Acc: 0.251 Test Loss: 3.638 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6312146186828613
Epoch: 44, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.579 Vali Acc: 0.271 Test Loss: 3.579 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.6598165035247803
Epoch: 45, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.608 Vali Acc: 0.266 Test Loss: 3.608 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.6854023933410645
Epoch: 46, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.614 Vali Acc: 0.268 Test Loss: 3.614 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.8232288360595703
Epoch: 47, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.615 Vali Acc: 0.274 Test Loss: 3.615 Test Acc: 0.274
Validation loss decreased (-0.272906 --> -0.274082).  Saving model ...
Epoch: 48 cost time: 1.7680988311767578
Epoch: 48, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.676 Vali Acc: 0.274 Test Loss: 3.676 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.6969115734100342
Epoch: 49, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.677 Vali Acc: 0.268 Test Loss: 3.677 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.9764158725738525
Epoch: 50, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.686 Vali Acc: 0.267 Test Loss: 3.686 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.9116837978363037
Epoch: 51, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.689 Vali Acc: 0.272 Test Loss: 3.689 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.6940457820892334
Epoch: 52, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.716 Vali Acc: 0.274 Test Loss: 3.716 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.319413423538208
Epoch: 53, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.742 Vali Acc: 0.267 Test Loss: 3.742 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.8535075187683105
Epoch: 54, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.728 Vali Acc: 0.269 Test Loss: 3.728 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.855921745300293
Epoch: 55, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.717 Vali Acc: 0.269 Test Loss: 3.717 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.6600685119628906
Epoch: 56, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.773 Vali Acc: 0.267 Test Loss: 3.773 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.6686525344848633
Epoch: 57, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.754 Vali Acc: 0.266 Test Loss: 3.754 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 1220054
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.208935260772705
Epoch: 1, Steps: 10 | Train Loss: 3.469 Vali Loss: 3.346 Vali Acc: 0.045 Test Loss: 3.346 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 1.7185075283050537
Epoch: 2, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.305 Vali Acc: 0.036 Test Loss: 3.305 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8271551132202148
Epoch: 3, Steps: 10 | Train Loss: 3.194 Vali Loss: 3.348 Vali Acc: 0.044 Test Loss: 3.348 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5979986190795898
Epoch: 4, Steps: 10 | Train Loss: 3.151 Vali Loss: 3.358 Vali Acc: 0.056 Test Loss: 3.358 Test Acc: 0.056
Validation loss decreased (-0.044672 --> -0.056437).  Saving model ...
Epoch: 5 cost time: 1.6809396743774414
Epoch: 5, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.345 Vali Acc: 0.056 Test Loss: 3.345 Test Acc: 0.056
Validation loss decreased (-0.056437 --> -0.056437).  Saving model ...
Epoch: 6 cost time: 1.8029694557189941
Epoch: 6, Steps: 10 | Train Loss: 3.099 Vali Loss: 3.316 Vali Acc: 0.061 Test Loss: 3.316 Test Acc: 0.061
Validation loss decreased (-0.056437 --> -0.061143).  Saving model ...
Epoch: 7 cost time: 1.8942897319793701
Epoch: 7, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.314 Vali Acc: 0.067 Test Loss: 3.314 Test Acc: 0.067
Validation loss decreased (-0.061143 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 1.8603119850158691
Epoch: 8, Steps: 10 | Train Loss: 2.974 Vali Loss: 3.275 Vali Acc: 0.069 Test Loss: 3.275 Test Acc: 0.069
Validation loss decreased (-0.067026 --> -0.069379).  Saving model ...
Epoch: 9 cost time: 2.137524127960205
Epoch: 9, Steps: 10 | Train Loss: 2.820 Vali Loss: 3.286 Vali Acc: 0.086 Test Loss: 3.286 Test Acc: 0.086
Validation loss decreased (-0.069379 --> -0.085849).  Saving model ...
Epoch: 10 cost time: 2.1969640254974365
Epoch: 10, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.284 Vali Acc: 0.088 Test Loss: 3.284 Test Acc: 0.088
Validation loss decreased (-0.085849 --> -0.088202).  Saving model ...
Epoch: 11 cost time: 1.8994693756103516
Epoch: 11, Steps: 10 | Train Loss: 2.642 Vali Loss: 3.277 Vali Acc: 0.094 Test Loss: 3.277 Test Acc: 0.094
Validation loss decreased (-0.088202 --> -0.094085).  Saving model ...
Epoch: 12 cost time: 1.8642151355743408
Epoch: 12, Steps: 10 | Train Loss: 2.528 Vali Loss: 3.256 Vali Acc: 0.114 Test Loss: 3.256 Test Acc: 0.114
Validation loss decreased (-0.094085 --> -0.114085).  Saving model ...
Epoch: 13 cost time: 1.7362635135650635
Epoch: 13, Steps: 10 | Train Loss: 2.390 Vali Loss: 3.265 Vali Acc: 0.109 Test Loss: 3.265 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8889119625091553
Epoch: 14, Steps: 10 | Train Loss: 2.286 Vali Loss: 3.224 Vali Acc: 0.128 Test Loss: 3.224 Test Acc: 0.128
Validation loss decreased (-0.114085 --> -0.128203).  Saving model ...
Epoch: 15 cost time: 1.83846116065979
Epoch: 15, Steps: 10 | Train Loss: 2.238 Vali Loss: 3.237 Vali Acc: 0.120 Test Loss: 3.237 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.121774196624756
Epoch: 16, Steps: 10 | Train Loss: 2.055 Vali Loss: 3.208 Vali Acc: 0.129 Test Loss: 3.208 Test Acc: 0.129
Validation loss decreased (-0.128203 --> -0.129380).  Saving model ...
Epoch: 17 cost time: 1.6702466011047363
Epoch: 17, Steps: 10 | Train Loss: 1.973 Vali Loss: 3.193 Vali Acc: 0.144 Test Loss: 3.193 Test Acc: 0.144
Validation loss decreased (-0.129380 --> -0.143497).  Saving model ...
Epoch: 18 cost time: 1.726384162902832
Epoch: 18, Steps: 10 | Train Loss: 1.853 Vali Loss: 3.207 Vali Acc: 0.135 Test Loss: 3.207 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.99245023727417
Epoch: 19, Steps: 10 | Train Loss: 1.760 Vali Loss: 3.212 Vali Acc: 0.155 Test Loss: 3.212 Test Acc: 0.155
Validation loss decreased (-0.143497 --> -0.155262).  Saving model ...
Epoch: 20 cost time: 2.0905539989471436
Epoch: 20, Steps: 10 | Train Loss: 1.686 Vali Loss: 3.207 Vali Acc: 0.154 Test Loss: 3.207 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.035231113433838
Epoch: 21, Steps: 10 | Train Loss: 1.664 Vali Loss: 3.188 Vali Acc: 0.165 Test Loss: 3.188 Test Acc: 0.165
Validation loss decreased (-0.155262 --> -0.164674).  Saving model ...
Epoch: 22 cost time: 1.8621256351470947
Epoch: 22, Steps: 10 | Train Loss: 1.537 Vali Loss: 3.226 Vali Acc: 0.154 Test Loss: 3.226 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9943621158599854
Epoch: 23, Steps: 10 | Train Loss: 1.404 Vali Loss: 3.175 Vali Acc: 0.185 Test Loss: 3.175 Test Acc: 0.185
Validation loss decreased (-0.164674 --> -0.184674).  Saving model ...
Epoch: 24 cost time: 1.9046308994293213
Epoch: 24, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.202 Vali Acc: 0.178 Test Loss: 3.202 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9203283786773682
Epoch: 25, Steps: 10 | Train Loss: 1.143 Vali Loss: 3.197 Vali Acc: 0.185 Test Loss: 3.197 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.003385305404663
Epoch: 26, Steps: 10 | Train Loss: 1.131 Vali Loss: 3.223 Vali Acc: 0.196 Test Loss: 3.223 Test Acc: 0.196
Validation loss decreased (-0.184674 --> -0.196438).  Saving model ...
Epoch: 27 cost time: 1.6699578762054443
Epoch: 27, Steps: 10 | Train Loss: 1.019 Vali Loss: 3.247 Vali Acc: 0.198 Test Loss: 3.247 Test Acc: 0.198
Validation loss decreased (-0.196438 --> -0.197615).  Saving model ...
Epoch: 28 cost time: 2.0252609252929688
Epoch: 28, Steps: 10 | Train Loss: 0.914 Vali Loss: 3.224 Vali Acc: 0.189 Test Loss: 3.224 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1454854011535645
Epoch: 29, Steps: 10 | Train Loss: 0.853 Vali Loss: 3.224 Vali Acc: 0.205 Test Loss: 3.224 Test Acc: 0.205
Validation loss decreased (-0.197615 --> -0.204674).  Saving model ...
Epoch: 30 cost time: 1.7812278270721436
Epoch: 30, Steps: 10 | Train Loss: 0.731 Vali Loss: 3.269 Vali Acc: 0.213 Test Loss: 3.269 Test Acc: 0.213
Validation loss decreased (-0.204674 --> -0.212908).  Saving model ...
Epoch: 31 cost time: 2.2021193504333496
Epoch: 31, Steps: 10 | Train Loss: 0.641 Vali Loss: 3.341 Vali Acc: 0.195 Test Loss: 3.341 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.077017068862915
Epoch: 32, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.343 Vali Acc: 0.208 Test Loss: 3.343 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.976149320602417
Epoch: 33, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.418 Vali Acc: 0.215 Test Loss: 3.418 Test Acc: 0.215
Validation loss decreased (-0.212908 --> -0.215260).  Saving model ...
Epoch: 34 cost time: 1.952505350112915
Epoch: 34, Steps: 10 | Train Loss: 0.498 Vali Loss: 3.310 Vali Acc: 0.212 Test Loss: 3.310 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.1039364337921143
Epoch: 35, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.411 Vali Acc: 0.220 Test Loss: 3.411 Test Acc: 0.220
Validation loss decreased (-0.215260 --> -0.219966).  Saving model ...
Epoch: 36 cost time: 1.9511234760284424
Epoch: 36, Steps: 10 | Train Loss: 0.365 Vali Loss: 3.392 Vali Acc: 0.224 Test Loss: 3.392 Test Acc: 0.224
Validation loss decreased (-0.219966 --> -0.223495).  Saving model ...
Epoch: 37 cost time: 2.345374822616577
Epoch: 37, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.468 Vali Acc: 0.227 Test Loss: 3.468 Test Acc: 0.227
Validation loss decreased (-0.223495 --> -0.227024).  Saving model ...
Epoch: 38 cost time: 1.7404160499572754
Epoch: 38, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.512 Vali Acc: 0.236 Test Loss: 3.512 Test Acc: 0.236
Validation loss decreased (-0.227024 --> -0.236435).  Saving model ...
Epoch: 39 cost time: 2.2868642807006836
Epoch: 39, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.514 Vali Acc: 0.215 Test Loss: 3.514 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9536004066467285
Epoch: 40, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.442 Vali Acc: 0.240 Test Loss: 3.442 Test Acc: 0.240
Validation loss decreased (-0.236435 --> -0.239966).  Saving model ...
Epoch: 41 cost time: 1.8846187591552734
Epoch: 41, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.563 Vali Acc: 0.242 Test Loss: 3.563 Test Acc: 0.242
Validation loss decreased (-0.239966 --> -0.242317).  Saving model ...
Epoch: 42 cost time: 2.4158806800842285
Epoch: 42, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.659 Vali Acc: 0.234 Test Loss: 3.659 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.884981632232666
Epoch: 43, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.553 Vali Acc: 0.244 Test Loss: 3.553 Test Acc: 0.244
Validation loss decreased (-0.242317 --> -0.243494).  Saving model ...
Epoch: 44 cost time: 1.9178013801574707
Epoch: 44, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.671 Vali Acc: 0.241 Test Loss: 3.671 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.898616075515747
Epoch: 45, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.631 Vali Acc: 0.248 Test Loss: 3.631 Test Acc: 0.248
Validation loss decreased (-0.243494 --> -0.248199).  Saving model ...
Epoch: 46 cost time: 1.691671371459961
Epoch: 46, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.680 Vali Acc: 0.254 Test Loss: 3.680 Test Acc: 0.254
Validation loss decreased (-0.248199 --> -0.254081).  Saving model ...
Epoch: 47 cost time: 1.6661221981048584
Epoch: 47, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.685 Vali Acc: 0.247 Test Loss: 3.685 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.1554272174835205
Epoch: 48, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.785 Vali Acc: 0.239 Test Loss: 3.785 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.9964978694915771
Epoch: 49, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.824 Vali Acc: 0.235 Test Loss: 3.824 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.7156093120574951
Epoch: 50, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.762 Vali Acc: 0.244 Test Loss: 3.762 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.0656912326812744
Epoch: 51, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.788 Vali Acc: 0.247 Test Loss: 3.788 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.035694122314453
Epoch: 52, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.816 Vali Acc: 0.247 Test Loss: 3.816 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.6855065822601318
Epoch: 53, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.786 Vali Acc: 0.256 Test Loss: 3.786 Test Acc: 0.256
Validation loss decreased (-0.254081 --> -0.256433).  Saving model ...
Epoch: 54 cost time: 1.8732614517211914
Epoch: 54, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.793 Vali Acc: 0.249 Test Loss: 3.793 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.0714571475982666
Epoch: 55, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.820 Vali Acc: 0.254 Test Loss: 3.820 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.0826516151428223
Epoch: 56, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.833 Vali Acc: 0.251 Test Loss: 3.833 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.1058499813079834
Epoch: 57, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.849 Vali Acc: 0.247 Test Loss: 3.849 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.728348970413208
Epoch: 58, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.868 Vali Acc: 0.252 Test Loss: 3.868 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.3162429332733154
Epoch: 59, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.852 Vali Acc: 0.244 Test Loss: 3.852 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.9488539695739746
Epoch: 60, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.869 Vali Acc: 0.249 Test Loss: 3.869 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.8793234825134277
Epoch: 61, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.896 Vali Acc: 0.251 Test Loss: 3.896 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.9700827598571777
Epoch: 62, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.923 Vali Acc: 0.252 Test Loss: 3.923 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.699244737625122
Epoch: 63, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.925 Vali Acc: 0.253 Test Loss: 3.925 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 927830
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.8322482109069824
Epoch: 1, Steps: 10 | Train Loss: 3.379 Vali Loss: 3.323 Vali Acc: 0.040 Test Loss: 3.323 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.8646526336669922
Epoch: 2, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.302 Vali Acc: 0.046 Test Loss: 3.302 Test Acc: 0.046
Validation loss decreased (-0.039967 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 1.8480448722839355
Epoch: 3, Steps: 10 | Train Loss: 3.226 Vali Loss: 3.319 Vali Acc: 0.042 Test Loss: 3.319 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1062636375427246
Epoch: 4, Steps: 10 | Train Loss: 3.205 Vali Loss: 3.320 Vali Acc: 0.062 Test Loss: 3.320 Test Acc: 0.062
Validation loss decreased (-0.045849 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 2.280935764312744
Epoch: 5, Steps: 10 | Train Loss: 3.122 Vali Loss: 3.332 Vali Acc: 0.061 Test Loss: 3.332 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.031020164489746
Epoch: 6, Steps: 10 | Train Loss: 3.110 Vali Loss: 3.327 Vali Acc: 0.062 Test Loss: 3.327 Test Acc: 0.062
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6244266033172607
Epoch: 7, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.302 Vali Acc: 0.078 Test Loss: 3.302 Test Acc: 0.078
Validation loss decreased (-0.062320 --> -0.077614).  Saving model ...
Epoch: 8 cost time: 1.9378407001495361
Epoch: 8, Steps: 10 | Train Loss: 2.947 Vali Loss: 3.295 Vali Acc: 0.084 Test Loss: 3.295 Test Acc: 0.084
Validation loss decreased (-0.077614 --> -0.083496).  Saving model ...
Epoch: 9 cost time: 1.6516013145446777
Epoch: 9, Steps: 10 | Train Loss: 2.888 Vali Loss: 3.313 Vali Acc: 0.068 Test Loss: 3.313 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7985730171203613
Epoch: 10, Steps: 10 | Train Loss: 2.807 Vali Loss: 3.292 Vali Acc: 0.109 Test Loss: 3.292 Test Acc: 0.109
Validation loss decreased (-0.083496 --> -0.109379).  Saving model ...
Epoch: 11 cost time: 1.6426427364349365
Epoch: 11, Steps: 10 | Train Loss: 2.642 Vali Loss: 3.274 Vali Acc: 0.119 Test Loss: 3.274 Test Acc: 0.119
Validation loss decreased (-0.109379 --> -0.118791).  Saving model ...
Epoch: 12 cost time: 1.564955472946167
Epoch: 12, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.270 Vali Acc: 0.104 Test Loss: 3.270 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.107367753982544
Epoch: 13, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.256 Vali Acc: 0.121 Test Loss: 3.256 Test Acc: 0.121
Validation loss decreased (-0.118791 --> -0.121144).  Saving model ...
Epoch: 14 cost time: 2.2469096183776855
Epoch: 14, Steps: 10 | Train Loss: 2.293 Vali Loss: 3.243 Vali Acc: 0.131 Test Loss: 3.243 Test Acc: 0.131
Validation loss decreased (-0.121144 --> -0.130556).  Saving model ...
Epoch: 15 cost time: 1.9442920684814453
Epoch: 15, Steps: 10 | Train Loss: 2.252 Vali Loss: 3.250 Vali Acc: 0.135 Test Loss: 3.250 Test Acc: 0.135
Validation loss decreased (-0.130556 --> -0.135262).  Saving model ...
Epoch: 16 cost time: 1.8413896560668945
Epoch: 16, Steps: 10 | Train Loss: 2.128 Vali Loss: 3.247 Vali Acc: 0.136 Test Loss: 3.247 Test Acc: 0.136
Validation loss decreased (-0.135262 --> -0.136438).  Saving model ...
Epoch: 17 cost time: 1.7784395217895508
Epoch: 17, Steps: 10 | Train Loss: 2.026 Vali Loss: 3.264 Vali Acc: 0.140 Test Loss: 3.264 Test Acc: 0.140
Validation loss decreased (-0.136438 --> -0.139967).  Saving model ...
Epoch: 18 cost time: 1.7472810745239258
Epoch: 18, Steps: 10 | Train Loss: 1.963 Vali Loss: 3.236 Vali Acc: 0.151 Test Loss: 3.236 Test Acc: 0.151
Validation loss decreased (-0.139967 --> -0.150556).  Saving model ...
Epoch: 19 cost time: 2.1549699306488037
Epoch: 19, Steps: 10 | Train Loss: 1.794 Vali Loss: 3.248 Vali Acc: 0.151 Test Loss: 3.248 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9370486736297607
Epoch: 20, Steps: 10 | Train Loss: 1.690 Vali Loss: 3.240 Vali Acc: 0.168 Test Loss: 3.240 Test Acc: 0.168
Validation loss decreased (-0.150556 --> -0.168203).  Saving model ...
Epoch: 21 cost time: 2.12764835357666
Epoch: 21, Steps: 10 | Train Loss: 1.550 Vali Loss: 3.242 Vali Acc: 0.164 Test Loss: 3.242 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8047399520874023
Epoch: 22, Steps: 10 | Train Loss: 1.499 Vali Loss: 3.256 Vali Acc: 0.187 Test Loss: 3.256 Test Acc: 0.187
Validation loss decreased (-0.168203 --> -0.187026).  Saving model ...
Epoch: 23 cost time: 1.8944120407104492
Epoch: 23, Steps: 10 | Train Loss: 1.341 Vali Loss: 3.247 Vali Acc: 0.172 Test Loss: 3.247 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.031521797180176
Epoch: 24, Steps: 10 | Train Loss: 1.300 Vali Loss: 3.248 Vali Acc: 0.199 Test Loss: 3.248 Test Acc: 0.199
Validation loss decreased (-0.187026 --> -0.198791).  Saving model ...
Epoch: 25 cost time: 1.60528564453125
Epoch: 25, Steps: 10 | Train Loss: 1.136 Vali Loss: 3.241 Vali Acc: 0.201 Test Loss: 3.241 Test Acc: 0.201
Validation loss decreased (-0.198791 --> -0.201144).  Saving model ...
Epoch: 26 cost time: 2.0204756259918213
Epoch: 26, Steps: 10 | Train Loss: 1.060 Vali Loss: 3.292 Vali Acc: 0.188 Test Loss: 3.292 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.757523536682129
Epoch: 27, Steps: 10 | Train Loss: 0.986 Vali Loss: 3.340 Vali Acc: 0.185 Test Loss: 3.340 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9403164386749268
Epoch: 28, Steps: 10 | Train Loss: 0.874 Vali Loss: 3.245 Vali Acc: 0.195 Test Loss: 3.245 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.786510705947876
Epoch: 29, Steps: 10 | Train Loss: 0.801 Vali Loss: 3.380 Vali Acc: 0.186 Test Loss: 3.380 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8299896717071533
Epoch: 30, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.267 Vali Acc: 0.208 Test Loss: 3.267 Test Acc: 0.208
Validation loss decreased (-0.201144 --> -0.208203).  Saving model ...
Epoch: 31 cost time: 1.9094219207763672
Epoch: 31, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.411 Vali Acc: 0.192 Test Loss: 3.411 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.1769328117370605
Epoch: 32, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.390 Vali Acc: 0.209 Test Loss: 3.390 Test Acc: 0.209
Validation loss decreased (-0.208203 --> -0.209378).  Saving model ...
Epoch: 33 cost time: 1.7932109832763672
Epoch: 33, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.403 Vali Acc: 0.229 Test Loss: 3.403 Test Acc: 0.229
Validation loss decreased (-0.209378 --> -0.229378).  Saving model ...
Epoch: 34 cost time: 2.072888135910034
Epoch: 34, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.389 Vali Acc: 0.215 Test Loss: 3.389 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9734015464782715
Epoch: 35, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.488 Vali Acc: 0.212 Test Loss: 3.488 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.1442809104919434
Epoch: 36, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.483 Vali Acc: 0.218 Test Loss: 3.483 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.157864809036255
Epoch: 37, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.458 Vali Acc: 0.231 Test Loss: 3.458 Test Acc: 0.231
Validation loss decreased (-0.229378 --> -0.230554).  Saving model ...
Epoch: 38 cost time: 2.002153158187866
Epoch: 38, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.480 Vali Acc: 0.247 Test Loss: 3.480 Test Acc: 0.247
Validation loss decreased (-0.230554 --> -0.247024).  Saving model ...
Epoch: 39 cost time: 2.1119446754455566
Epoch: 39, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.515 Vali Acc: 0.226 Test Loss: 3.515 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9278602600097656
Epoch: 40, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.525 Vali Acc: 0.234 Test Loss: 3.525 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.0698041915893555
Epoch: 41, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.660 Vali Acc: 0.232 Test Loss: 3.660 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5754671096801758
Epoch: 42, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.553 Vali Acc: 0.240 Test Loss: 3.553 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.9177374839782715
Epoch: 43, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.618 Vali Acc: 0.236 Test Loss: 3.618 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6701023578643799
Epoch: 44, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.708 Vali Acc: 0.229 Test Loss: 3.708 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.7734568119049072
Epoch: 45, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.620 Vali Acc: 0.244 Test Loss: 3.620 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.8477983474731445
Epoch: 46, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.639 Vali Acc: 0.244 Test Loss: 3.639 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.2463839054107666
Epoch: 47, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.693 Vali Acc: 0.255 Test Loss: 3.693 Test Acc: 0.255
Validation loss decreased (-0.247024 --> -0.255257).  Saving model ...
Epoch: 48 cost time: 2.3053407669067383
Epoch: 48, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.780 Vali Acc: 0.240 Test Loss: 3.780 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.9394519329071045
Epoch: 49, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.679 Vali Acc: 0.254 Test Loss: 3.679 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.8807568550109863
Epoch: 50, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.743 Vali Acc: 0.253 Test Loss: 3.743 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.894399642944336
Epoch: 51, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.752 Vali Acc: 0.255 Test Loss: 3.752 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.9380390644073486
Epoch: 52, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.718 Vali Acc: 0.259 Test Loss: 3.718 Test Acc: 0.259
Validation loss decreased (-0.255257 --> -0.258786).  Saving model ...
Epoch: 53 cost time: 1.833411693572998
Epoch: 53, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.754 Vali Acc: 0.259 Test Loss: 3.754 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.929551362991333
Epoch: 54, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.758 Vali Acc: 0.265 Test Loss: 3.758 Test Acc: 0.265
Validation loss decreased (-0.258786 --> -0.264668).  Saving model ...
Epoch: 55 cost time: 1.9690918922424316
Epoch: 55, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.780 Vali Acc: 0.261 Test Loss: 3.780 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.9931972026824951
Epoch: 56, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.779 Vali Acc: 0.260 Test Loss: 3.779 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.017348527908325
Epoch: 57, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.829 Vali Acc: 0.261 Test Loss: 3.829 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.0231270790100098
Epoch: 58, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.794 Vali Acc: 0.264 Test Loss: 3.794 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.8826920986175537
Epoch: 59, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.827 Vali Acc: 0.260 Test Loss: 3.827 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 2.2841169834136963
Epoch: 60, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.855 Vali Acc: 0.262 Test Loss: 3.855 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.9728147983551025
Epoch: 61, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.840 Vali Acc: 0.259 Test Loss: 3.840 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.8009169101715088
Epoch: 62, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.854 Vali Acc: 0.259 Test Loss: 3.854 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.7683491706848145
Epoch: 63, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.858 Vali Acc: 0.260 Test Loss: 3.858 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 2.3624467849731445
Epoch: 64, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.887 Vali Acc: 0.255 Test Loss: 3.887 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 926166
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7953429222106934
Epoch: 1, Steps: 10 | Train Loss: 3.454 Vali Loss: 3.397 Vali Acc: 0.044 Test Loss: 3.397 Test Acc: 0.044
Validation loss decreased (inf --> -0.043495).  Saving model ...
Epoch: 2 cost time: 1.7256431579589844
Epoch: 2, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.303 Vali Acc: 0.052 Test Loss: 3.303 Test Acc: 0.052
Validation loss decreased (-0.043495 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 1.9128210544586182
Epoch: 3, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.318 Vali Acc: 0.052 Test Loss: 3.318 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8425076007843018
Epoch: 4, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.345 Vali Acc: 0.060 Test Loss: 3.345 Test Acc: 0.060
Validation loss decreased (-0.051732 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 1.8856322765350342
Epoch: 5, Steps: 10 | Train Loss: 3.160 Vali Loss: 3.329 Vali Acc: 0.069 Test Loss: 3.329 Test Acc: 0.069
Validation loss decreased (-0.059967 --> -0.069378).  Saving model ...
Epoch: 6 cost time: 1.700108289718628
Epoch: 6, Steps: 10 | Train Loss: 3.154 Vali Loss: 3.330 Vali Acc: 0.073 Test Loss: 3.330 Test Acc: 0.073
Validation loss decreased (-0.069378 --> -0.072908).  Saving model ...
Epoch: 7 cost time: 1.9232964515686035
Epoch: 7, Steps: 10 | Train Loss: 3.083 Vali Loss: 3.292 Vali Acc: 0.098 Test Loss: 3.292 Test Acc: 0.098
Validation loss decreased (-0.072908 --> -0.097614).  Saving model ...
Epoch: 8 cost time: 2.0481958389282227
Epoch: 8, Steps: 10 | Train Loss: 2.987 Vali Loss: 3.289 Vali Acc: 0.085 Test Loss: 3.289 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9887499809265137
Epoch: 9, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.268 Vali Acc: 0.087 Test Loss: 3.268 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.005183696746826
Epoch: 10, Steps: 10 | Train Loss: 2.910 Vali Loss: 3.263 Vali Acc: 0.108 Test Loss: 3.263 Test Acc: 0.108
Validation loss decreased (-0.097614 --> -0.108203).  Saving model ...
Epoch: 11 cost time: 2.2904775142669678
Epoch: 11, Steps: 10 | Train Loss: 2.783 Vali Loss: 3.233 Vali Acc: 0.122 Test Loss: 3.233 Test Acc: 0.122
Validation loss decreased (-0.108203 --> -0.122321).  Saving model ...
Epoch: 12 cost time: 1.5981526374816895
Epoch: 12, Steps: 10 | Train Loss: 2.641 Vali Loss: 3.222 Vali Acc: 0.107 Test Loss: 3.222 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9606661796569824
Epoch: 13, Steps: 10 | Train Loss: 2.480 Vali Loss: 3.209 Vali Acc: 0.135 Test Loss: 3.209 Test Acc: 0.135
Validation loss decreased (-0.122321 --> -0.135262).  Saving model ...
Epoch: 14 cost time: 1.6867427825927734
Epoch: 14, Steps: 10 | Train Loss: 2.412 Vali Loss: 3.218 Vali Acc: 0.125 Test Loss: 3.218 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6960208415985107
Epoch: 15, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.201 Vali Acc: 0.135 Test Loss: 3.201 Test Acc: 0.135
Validation loss decreased (-0.135262 --> -0.135262).  Saving model ...
Epoch: 16 cost time: 1.7228586673736572
Epoch: 16, Steps: 10 | Train Loss: 2.133 Vali Loss: 3.188 Vali Acc: 0.144 Test Loss: 3.188 Test Acc: 0.144
Validation loss decreased (-0.135262 --> -0.143498).  Saving model ...
Epoch: 17 cost time: 1.9491629600524902
Epoch: 17, Steps: 10 | Train Loss: 2.109 Vali Loss: 3.177 Vali Acc: 0.146 Test Loss: 3.177 Test Acc: 0.146
Validation loss decreased (-0.143498 --> -0.145851).  Saving model ...
Epoch: 18 cost time: 1.9898350238800049
Epoch: 18, Steps: 10 | Train Loss: 1.975 Vali Loss: 3.204 Vali Acc: 0.151 Test Loss: 3.204 Test Acc: 0.151
Validation loss decreased (-0.145851 --> -0.150556).  Saving model ...
Epoch: 19 cost time: 1.6805047988891602
Epoch: 19, Steps: 10 | Train Loss: 1.934 Vali Loss: 3.160 Vali Acc: 0.167 Test Loss: 3.160 Test Acc: 0.167
Validation loss decreased (-0.150556 --> -0.167027).  Saving model ...
Epoch: 20 cost time: 1.7932155132293701
Epoch: 20, Steps: 10 | Train Loss: 1.770 Vali Loss: 3.202 Vali Acc: 0.151 Test Loss: 3.202 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6823906898498535
Epoch: 21, Steps: 10 | Train Loss: 1.641 Vali Loss: 3.132 Vali Acc: 0.184 Test Loss: 3.132 Test Acc: 0.184
Validation loss decreased (-0.167027 --> -0.183498).  Saving model ...
Epoch: 22 cost time: 1.6391925811767578
Epoch: 22, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.168 Vali Acc: 0.179 Test Loss: 3.168 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.812220811843872
Epoch: 23, Steps: 10 | Train Loss: 1.396 Vali Loss: 3.161 Vali Acc: 0.188 Test Loss: 3.161 Test Acc: 0.188
Validation loss decreased (-0.183498 --> -0.188204).  Saving model ...
Epoch: 24 cost time: 1.9845855236053467
Epoch: 24, Steps: 10 | Train Loss: 1.313 Vali Loss: 3.142 Vali Acc: 0.188 Test Loss: 3.142 Test Acc: 0.188
Validation loss decreased (-0.188204 --> -0.188204).  Saving model ...
Epoch: 25 cost time: 2.0461249351501465
Epoch: 25, Steps: 10 | Train Loss: 1.231 Vali Loss: 3.203 Vali Acc: 0.194 Test Loss: 3.203 Test Acc: 0.194
Validation loss decreased (-0.188204 --> -0.194086).  Saving model ...
Epoch: 26 cost time: 1.8059391975402832
Epoch: 26, Steps: 10 | Train Loss: 1.108 Vali Loss: 3.181 Vali Acc: 0.201 Test Loss: 3.181 Test Acc: 0.201
Validation loss decreased (-0.194086 --> -0.201145).  Saving model ...
Epoch: 27 cost time: 1.9834833145141602
Epoch: 27, Steps: 10 | Train Loss: 0.974 Vali Loss: 3.194 Vali Acc: 0.220 Test Loss: 3.194 Test Acc: 0.220
Validation loss decreased (-0.201145 --> -0.219968).  Saving model ...
Epoch: 28 cost time: 2.3358709812164307
Epoch: 28, Steps: 10 | Train Loss: 0.901 Vali Loss: 3.220 Vali Acc: 0.202 Test Loss: 3.220 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.871586561203003
Epoch: 29, Steps: 10 | Train Loss: 0.859 Vali Loss: 3.218 Vali Acc: 0.202 Test Loss: 3.218 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.970083475112915
Epoch: 30, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.221 Vali Acc: 0.227 Test Loss: 3.221 Test Acc: 0.227
Validation loss decreased (-0.219968 --> -0.227027).  Saving model ...
Epoch: 31 cost time: 2.020740270614624
Epoch: 31, Steps: 10 | Train Loss: 0.697 Vali Loss: 3.292 Vali Acc: 0.196 Test Loss: 3.292 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0762112140655518
Epoch: 32, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.261 Vali Acc: 0.218 Test Loss: 3.261 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6942410469055176
Epoch: 33, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.299 Vali Acc: 0.213 Test Loss: 3.299 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.2109568119049072
Epoch: 34, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.342 Vali Acc: 0.214 Test Loss: 3.342 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.7800264358520508
Epoch: 35, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.289 Vali Acc: 0.244 Test Loss: 3.289 Test Acc: 0.244
Validation loss decreased (-0.227027 --> -0.243497).  Saving model ...
Epoch: 36 cost time: 1.8778173923492432
Epoch: 36, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.341 Vali Acc: 0.227 Test Loss: 3.341 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.9358484745025635
Epoch: 37, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.359 Vali Acc: 0.251 Test Loss: 3.359 Test Acc: 0.251
Validation loss decreased (-0.243497 --> -0.250555).  Saving model ...
Epoch: 38 cost time: 2.0737974643707275
Epoch: 38, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.434 Vali Acc: 0.242 Test Loss: 3.434 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.2052035331726074
Epoch: 39, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.420 Vali Acc: 0.238 Test Loss: 3.420 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.293578863143921
Epoch: 40, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.492 Vali Acc: 0.231 Test Loss: 3.492 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8224661350250244
Epoch: 41, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.511 Vali Acc: 0.242 Test Loss: 3.511 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.7436072826385498
Epoch: 42, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.473 Vali Acc: 0.258 Test Loss: 3.473 Test Acc: 0.258
Validation loss decreased (-0.250555 --> -0.257612).  Saving model ...
Epoch: 43 cost time: 1.842102289199829
Epoch: 43, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.586 Vali Acc: 0.241 Test Loss: 3.586 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.070117235183716
Epoch: 44, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.537 Vali Acc: 0.252 Test Loss: 3.537 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.0676639080047607
Epoch: 45, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.558 Vali Acc: 0.255 Test Loss: 3.558 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.847423791885376
Epoch: 46, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.594 Vali Acc: 0.247 Test Loss: 3.594 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.859766960144043
Epoch: 47, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.612 Vali Acc: 0.262 Test Loss: 3.612 Test Acc: 0.262
Validation loss decreased (-0.257612 --> -0.262317).  Saving model ...
Epoch: 48 cost time: 2.0251598358154297
Epoch: 48, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.638 Vali Acc: 0.255 Test Loss: 3.638 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.9149987697601318
Epoch: 49, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.635 Vali Acc: 0.258 Test Loss: 3.635 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.1202213764190674
Epoch: 50, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.678 Vali Acc: 0.264 Test Loss: 3.678 Test Acc: 0.264
Validation loss decreased (-0.262317 --> -0.263493).  Saving model ...
Epoch: 51 cost time: 2.2631006240844727
Epoch: 51, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.677 Vali Acc: 0.260 Test Loss: 3.677 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.630859375
Epoch: 52, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.670 Vali Acc: 0.259 Test Loss: 3.670 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.248368263244629
Epoch: 53, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.721 Vali Acc: 0.255 Test Loss: 3.721 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.1610496044158936
Epoch: 54, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.750 Vali Acc: 0.259 Test Loss: 3.750 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.0631048679351807
Epoch: 55, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.703 Vali Acc: 0.253 Test Loss: 3.703 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.1865830421447754
Epoch: 56, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.746 Vali Acc: 0.255 Test Loss: 3.746 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.8085346221923828
Epoch: 57, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.770 Vali Acc: 0.255 Test Loss: 3.770 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.837341070175171
Epoch: 58, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.720 Vali Acc: 0.261 Test Loss: 3.720 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.7459919452667236
Epoch: 59, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.751 Vali Acc: 0.256 Test Loss: 3.751 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.8020434379577637
Epoch: 60, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.776 Vali Acc: 0.266 Test Loss: 3.776 Test Acc: 0.266
Validation loss decreased (-0.263493 --> -0.265845).  Saving model ...
Epoch: 61 cost time: 1.8740277290344238
Epoch: 61, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.787 Vali Acc: 0.259 Test Loss: 3.787 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.2973523139953613
Epoch: 62, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.805 Vali Acc: 0.261 Test Loss: 3.805 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.9430911540985107
Epoch: 63, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.770 Vali Acc: 0.260 Test Loss: 3.770 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 2.1606802940368652
Epoch: 64, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.853 Vali Acc: 0.260 Test Loss: 3.853 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 2.3379945755004883
Epoch: 65, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.829 Vali Acc: 0.261 Test Loss: 3.829 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 2.3063769340515137
Epoch: 66, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.783 Vali Acc: 0.267 Test Loss: 3.783 Test Acc: 0.267
Validation loss decreased (-0.265845 --> -0.267021).  Saving model ...
Epoch: 67 cost time: 1.8204171657562256
Epoch: 67, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.855 Vali Acc: 0.262 Test Loss: 3.855 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.8804056644439697
Epoch: 68, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.830 Vali Acc: 0.260 Test Loss: 3.830 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 2.1577272415161133
Epoch: 69, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.912 Vali Acc: 0.264 Test Loss: 3.912 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.7130038738250732
Epoch: 70, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.862 Vali Acc: 0.261 Test Loss: 3.862 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 2.0841965675354004
Epoch: 71, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.878 Vali Acc: 0.262 Test Loss: 3.878 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.690453052520752
Epoch: 72, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.873 Vali Acc: 0.271 Test Loss: 3.873 Test Acc: 0.271
Validation loss decreased (-0.267021 --> -0.270550).  Saving model ...
Epoch: 73 cost time: 1.7228219509124756
Epoch: 73, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.900 Vali Acc: 0.266 Test Loss: 3.900 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 2.240955352783203
Epoch: 74, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.900 Vali Acc: 0.260 Test Loss: 3.900 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.8131930828094482
Epoch: 75, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.946 Vali Acc: 0.259 Test Loss: 3.946 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 2.5584607124328613
Epoch: 76, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.898 Vali Acc: 0.268 Test Loss: 3.898 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 2.3205549716949463
Epoch: 77, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.926 Vali Acc: 0.262 Test Loss: 3.926 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 2.0665829181671143
Epoch: 78, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.924 Vali Acc: 0.268 Test Loss: 3.924 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.8778631687164307
Epoch: 79, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.914 Vali Acc: 0.265 Test Loss: 3.914 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.9826462268829346
Epoch: 80, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.979 Vali Acc: 0.267 Test Loss: 3.979 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 2.2630319595336914
Epoch: 81, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.981 Vali Acc: 0.262 Test Loss: 3.981 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 1.9708912372589111
Epoch: 82, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.965 Vali Acc: 0.258 Test Loss: 3.965 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 924502
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6625988483428955
Epoch: 1, Steps: 10 | Train Loss: 3.491 Vali Loss: 3.340 Vali Acc: 0.035 Test Loss: 3.340 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 1.7493433952331543
Epoch: 2, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.298 Vali Acc: 0.056 Test Loss: 3.298 Test Acc: 0.056
Validation loss decreased (-0.035261 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 1.8993701934814453
Epoch: 3, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.339 Vali Acc: 0.060 Test Loss: 3.339 Test Acc: 0.060
Validation loss decreased (-0.056438 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 1.9544332027435303
Epoch: 4, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.357 Vali Acc: 0.061 Test Loss: 3.357 Test Acc: 0.061
Validation loss decreased (-0.059967 --> -0.061143).  Saving model ...
Epoch: 5 cost time: 1.7083697319030762
Epoch: 5, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.344 Vali Acc: 0.071 Test Loss: 3.344 Test Acc: 0.071
Validation loss decreased (-0.061143 --> -0.070555).  Saving model ...
Epoch: 6 cost time: 1.6470868587493896
Epoch: 6, Steps: 10 | Train Loss: 3.051 Vali Loss: 3.318 Vali Acc: 0.074 Test Loss: 3.318 Test Acc: 0.074
Validation loss decreased (-0.070555 --> -0.074084).  Saving model ...
Epoch: 7 cost time: 1.6965789794921875
Epoch: 7, Steps: 10 | Train Loss: 2.974 Vali Loss: 3.314 Vali Acc: 0.080 Test Loss: 3.314 Test Acc: 0.080
Validation loss decreased (-0.074084 --> -0.079967).  Saving model ...
Epoch: 8 cost time: 1.8136930465698242
Epoch: 8, Steps: 10 | Train Loss: 2.929 Vali Loss: 3.323 Vali Acc: 0.104 Test Loss: 3.323 Test Acc: 0.104
Validation loss decreased (-0.079967 --> -0.103496).  Saving model ...
Epoch: 9 cost time: 1.9610185623168945
Epoch: 9, Steps: 10 | Train Loss: 2.842 Vali Loss: 3.284 Vali Acc: 0.105 Test Loss: 3.284 Test Acc: 0.105
Validation loss decreased (-0.103496 --> -0.104673).  Saving model ...
Epoch: 10 cost time: 1.721271276473999
Epoch: 10, Steps: 10 | Train Loss: 2.750 Vali Loss: 3.281 Vali Acc: 0.096 Test Loss: 3.281 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.000432252883911
Epoch: 11, Steps: 10 | Train Loss: 2.625 Vali Loss: 3.281 Vali Acc: 0.101 Test Loss: 3.281 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0834715366363525
Epoch: 12, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.279 Vali Acc: 0.122 Test Loss: 3.279 Test Acc: 0.122
Validation loss decreased (-0.104673 --> -0.122320).  Saving model ...
Epoch: 13 cost time: 1.628347396850586
Epoch: 13, Steps: 10 | Train Loss: 2.402 Vali Loss: 3.260 Vali Acc: 0.127 Test Loss: 3.260 Test Acc: 0.127
Validation loss decreased (-0.122320 --> -0.127026).  Saving model ...
Epoch: 14 cost time: 1.5165979862213135
Epoch: 14, Steps: 10 | Train Loss: 2.275 Vali Loss: 3.236 Vali Acc: 0.140 Test Loss: 3.236 Test Acc: 0.140
Validation loss decreased (-0.127026 --> -0.139968).  Saving model ...
Epoch: 15 cost time: 1.7212178707122803
Epoch: 15, Steps: 10 | Train Loss: 2.159 Vali Loss: 3.234 Vali Acc: 0.149 Test Loss: 3.234 Test Acc: 0.149
Validation loss decreased (-0.139968 --> -0.149379).  Saving model ...
Epoch: 16 cost time: 1.8226513862609863
Epoch: 16, Steps: 10 | Train Loss: 2.122 Vali Loss: 3.281 Vali Acc: 0.153 Test Loss: 3.281 Test Acc: 0.153
Validation loss decreased (-0.149379 --> -0.152908).  Saving model ...
Epoch: 17 cost time: 2.0066893100738525
Epoch: 17, Steps: 10 | Train Loss: 1.990 Vali Loss: 3.208 Vali Acc: 0.164 Test Loss: 3.208 Test Acc: 0.164
Validation loss decreased (-0.152908 --> -0.163497).  Saving model ...
Epoch: 18 cost time: 1.9437620639801025
Epoch: 18, Steps: 10 | Train Loss: 1.839 Vali Loss: 3.223 Vali Acc: 0.174 Test Loss: 3.223 Test Acc: 0.174
Validation loss decreased (-0.163497 --> -0.174085).  Saving model ...
Epoch: 19 cost time: 1.8034884929656982
Epoch: 19, Steps: 10 | Train Loss: 1.719 Vali Loss: 3.223 Vali Acc: 0.171 Test Loss: 3.223 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9250547885894775
Epoch: 20, Steps: 10 | Train Loss: 1.620 Vali Loss: 3.221 Vali Acc: 0.180 Test Loss: 3.221 Test Acc: 0.180
Validation loss decreased (-0.174085 --> -0.179968).  Saving model ...
Epoch: 21 cost time: 1.7177650928497314
Epoch: 21, Steps: 10 | Train Loss: 1.514 Vali Loss: 3.212 Vali Acc: 0.192 Test Loss: 3.212 Test Acc: 0.192
Validation loss decreased (-0.179968 --> -0.191733).  Saving model ...
Epoch: 22 cost time: 1.7097923755645752
Epoch: 22, Steps: 10 | Train Loss: 1.430 Vali Loss: 3.220 Vali Acc: 0.185 Test Loss: 3.220 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8274505138397217
Epoch: 23, Steps: 10 | Train Loss: 1.332 Vali Loss: 3.217 Vali Acc: 0.206 Test Loss: 3.217 Test Acc: 0.206
Validation loss decreased (-0.191733 --> -0.205850).  Saving model ...
Epoch: 24 cost time: 1.9040515422821045
Epoch: 24, Steps: 10 | Train Loss: 1.181 Vali Loss: 3.250 Vali Acc: 0.195 Test Loss: 3.250 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.814121961593628
Epoch: 25, Steps: 10 | Train Loss: 1.115 Vali Loss: 3.208 Vali Acc: 0.206 Test Loss: 3.208 Test Acc: 0.206
Validation loss decreased (-0.205850 --> -0.205850).  Saving model ...
Epoch: 26 cost time: 1.6253418922424316
Epoch: 26, Steps: 10 | Train Loss: 1.019 Vali Loss: 3.245 Vali Acc: 0.187 Test Loss: 3.245 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.012022018432617
Epoch: 27, Steps: 10 | Train Loss: 0.917 Vali Loss: 3.318 Vali Acc: 0.200 Test Loss: 3.318 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9022610187530518
Epoch: 28, Steps: 10 | Train Loss: 0.782 Vali Loss: 3.276 Vali Acc: 0.192 Test Loss: 3.276 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5981042385101318
Epoch: 29, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.249 Vali Acc: 0.212 Test Loss: 3.249 Test Acc: 0.212
Validation loss decreased (-0.205850 --> -0.211732).  Saving model ...
Epoch: 30 cost time: 1.616194248199463
Epoch: 30, Steps: 10 | Train Loss: 0.651 Vali Loss: 3.420 Vali Acc: 0.191 Test Loss: 3.420 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9374563694000244
Epoch: 31, Steps: 10 | Train Loss: 0.639 Vali Loss: 3.395 Vali Acc: 0.202 Test Loss: 3.395 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6646599769592285
Epoch: 32, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.376 Vali Acc: 0.220 Test Loss: 3.376 Test Acc: 0.220
Validation loss decreased (-0.211732 --> -0.219966).  Saving model ...
Epoch: 33 cost time: 1.8302841186523438
Epoch: 33, Steps: 10 | Train Loss: 0.446 Vali Loss: 3.395 Vali Acc: 0.224 Test Loss: 3.395 Test Acc: 0.224
Validation loss decreased (-0.219966 --> -0.223495).  Saving model ...
Epoch: 34 cost time: 1.9484763145446777
Epoch: 34, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.417 Vali Acc: 0.224 Test Loss: 3.417 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.0854296684265137
Epoch: 35, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.432 Vali Acc: 0.222 Test Loss: 3.432 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.1202685832977295
Epoch: 36, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.462 Vali Acc: 0.225 Test Loss: 3.462 Test Acc: 0.225
Validation loss decreased (-0.223495 --> -0.224671).  Saving model ...
Epoch: 37 cost time: 2.0750906467437744
Epoch: 37, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.462 Vali Acc: 0.227 Test Loss: 3.462 Test Acc: 0.227
Validation loss decreased (-0.224671 --> -0.227024).  Saving model ...
Epoch: 38 cost time: 1.8454937934875488
Epoch: 38, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.546 Vali Acc: 0.212 Test Loss: 3.546 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7786500453948975
Epoch: 39, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.569 Vali Acc: 0.189 Test Loss: 3.569 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7089402675628662
Epoch: 40, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.777 Vali Acc: 0.222 Test Loss: 3.777 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.7383911609649658
Epoch: 41, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.532 Vali Acc: 0.240 Test Loss: 3.532 Test Acc: 0.240
Validation loss decreased (-0.227024 --> -0.239965).  Saving model ...
Epoch: 42 cost time: 1.835434913635254
Epoch: 42, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.679 Vali Acc: 0.234 Test Loss: 3.679 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.7742979526519775
Epoch: 43, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.613 Vali Acc: 0.248 Test Loss: 3.613 Test Acc: 0.248
Validation loss decreased (-0.239965 --> -0.248199).  Saving model ...
Epoch: 44 cost time: 1.7687630653381348
Epoch: 44, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.717 Vali Acc: 0.234 Test Loss: 3.717 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7952466011047363
Epoch: 45, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.678 Vali Acc: 0.246 Test Loss: 3.678 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.594743013381958
Epoch: 46, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.813 Vali Acc: 0.239 Test Loss: 3.813 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.5789740085601807
Epoch: 47, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.741 Vali Acc: 0.255 Test Loss: 3.741 Test Acc: 0.255
Validation loss decreased (-0.248199 --> -0.255257).  Saving model ...
Epoch: 48 cost time: 1.4822111129760742
Epoch: 48, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.761 Vali Acc: 0.245 Test Loss: 3.761 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.7200889587402344
Epoch: 49, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.734 Vali Acc: 0.258 Test Loss: 3.734 Test Acc: 0.258
Validation loss decreased (-0.255257 --> -0.257610).  Saving model ...
Epoch: 50 cost time: 1.8489809036254883
Epoch: 50, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.753 Vali Acc: 0.252 Test Loss: 3.753 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.8777306079864502
Epoch: 51, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.824 Vali Acc: 0.251 Test Loss: 3.824 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.628199815750122
Epoch: 52, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.806 Vali Acc: 0.255 Test Loss: 3.806 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.6884009838104248
Epoch: 53, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.851 Vali Acc: 0.253 Test Loss: 3.851 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.8704698085784912
Epoch: 54, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.844 Vali Acc: 0.255 Test Loss: 3.844 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.8017544746398926
Epoch: 55, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.901 Vali Acc: 0.255 Test Loss: 3.901 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.81325364112854
Epoch: 56, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.921 Vali Acc: 0.254 Test Loss: 3.921 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.9406681060791016
Epoch: 57, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.900 Vali Acc: 0.252 Test Loss: 3.900 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.6878821849822998
Epoch: 58, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.895 Vali Acc: 0.266 Test Loss: 3.895 Test Acc: 0.266
Validation loss decreased (-0.257610 --> -0.265843).  Saving model ...
Epoch: 59 cost time: 1.9246587753295898
Epoch: 59, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.951 Vali Acc: 0.253 Test Loss: 3.951 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.8617846965789795
Epoch: 60, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.956 Vali Acc: 0.249 Test Loss: 3.956 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.6047790050506592
Epoch: 61, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.976 Vali Acc: 0.251 Test Loss: 3.976 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 2.2794859409332275
Epoch: 62, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.954 Vali Acc: 0.254 Test Loss: 3.954 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 2.041430711746216
Epoch: 63, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.944 Vali Acc: 0.252 Test Loss: 3.944 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.7991251945495605
Epoch: 64, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.969 Vali Acc: 0.256 Test Loss: 3.969 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 2.0654525756835938
Epoch: 65, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.946 Vali Acc: 0.255 Test Loss: 3.946 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 2.0786309242248535
Epoch: 66, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.005 Vali Acc: 0.253 Test Loss: 4.005 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 2.1765289306640625
Epoch: 67, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.019 Vali Acc: 0.251 Test Loss: 4.019 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 2.1211674213409424
Epoch: 68, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.985 Vali Acc: 0.254 Test Loss: 3.985 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 922838
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.179611682891846
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.309 Vali Acc: 0.041 Test Loss: 3.309 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.8035080432891846
Epoch: 2, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.287 Vali Acc: 0.060 Test Loss: 3.287 Test Acc: 0.060
Validation loss decreased (-0.041143 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 2.2535784244537354
Epoch: 3, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.314 Vali Acc: 0.054 Test Loss: 3.314 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.334139823913574
Epoch: 4, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.313 Vali Acc: 0.060 Test Loss: 3.313 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9888691902160645
Epoch: 5, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.303 Vali Acc: 0.071 Test Loss: 3.303 Test Acc: 0.071
Validation loss decreased (-0.059967 --> -0.070555).  Saving model ...
Epoch: 6 cost time: 2.306886911392212
Epoch: 6, Steps: 10 | Train Loss: 3.064 Vali Loss: 3.300 Vali Acc: 0.066 Test Loss: 3.300 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.844564437866211
Epoch: 7, Steps: 10 | Train Loss: 2.943 Vali Loss: 3.259 Vali Acc: 0.080 Test Loss: 3.259 Test Acc: 0.080
Validation loss decreased (-0.070555 --> -0.079967).  Saving model ...
Epoch: 8 cost time: 1.5205204486846924
Epoch: 8, Steps: 10 | Train Loss: 2.916 Vali Loss: 3.260 Vali Acc: 0.096 Test Loss: 3.260 Test Acc: 0.096
Validation loss decreased (-0.079967 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 1.8916845321655273
Epoch: 9, Steps: 10 | Train Loss: 2.764 Vali Loss: 3.236 Vali Acc: 0.095 Test Loss: 3.236 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9882457256317139
Epoch: 10, Steps: 10 | Train Loss: 2.679 Vali Loss: 3.224 Vali Acc: 0.108 Test Loss: 3.224 Test Acc: 0.108
Validation loss decreased (-0.096438 --> -0.108203).  Saving model ...
Epoch: 11 cost time: 1.9000933170318604
Epoch: 11, Steps: 10 | Train Loss: 2.626 Vali Loss: 3.217 Vali Acc: 0.095 Test Loss: 3.217 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.797910451889038
Epoch: 12, Steps: 10 | Train Loss: 2.485 Vali Loss: 3.211 Vali Acc: 0.113 Test Loss: 3.211 Test Acc: 0.113
Validation loss decreased (-0.108203 --> -0.112909).  Saving model ...
Epoch: 13 cost time: 1.809422254562378
Epoch: 13, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.211 Vali Acc: 0.113 Test Loss: 3.211 Test Acc: 0.113
Validation loss decreased (-0.112909 --> -0.112909).  Saving model ...
Epoch: 14 cost time: 1.879751443862915
Epoch: 14, Steps: 10 | Train Loss: 2.318 Vali Loss: 3.195 Vali Acc: 0.138 Test Loss: 3.195 Test Acc: 0.138
Validation loss decreased (-0.112909 --> -0.137615).  Saving model ...
Epoch: 15 cost time: 2.003958225250244
Epoch: 15, Steps: 10 | Train Loss: 2.197 Vali Loss: 3.187 Vali Acc: 0.118 Test Loss: 3.187 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.577728271484375
Epoch: 16, Steps: 10 | Train Loss: 2.033 Vali Loss: 3.201 Vali Acc: 0.149 Test Loss: 3.201 Test Acc: 0.149
Validation loss decreased (-0.137615 --> -0.149380).  Saving model ...
Epoch: 17 cost time: 1.7265629768371582
Epoch: 17, Steps: 10 | Train Loss: 1.927 Vali Loss: 3.174 Vali Acc: 0.147 Test Loss: 3.174 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.170281171798706
Epoch: 18, Steps: 10 | Train Loss: 1.872 Vali Loss: 3.204 Vali Acc: 0.160 Test Loss: 3.204 Test Acc: 0.160
Validation loss decreased (-0.149380 --> -0.159968).  Saving model ...
Epoch: 19 cost time: 1.7504847049713135
Epoch: 19, Steps: 10 | Train Loss: 1.742 Vali Loss: 3.201 Vali Acc: 0.168 Test Loss: 3.201 Test Acc: 0.168
Validation loss decreased (-0.159968 --> -0.168203).  Saving model ...
Epoch: 20 cost time: 2.0162646770477295
Epoch: 20, Steps: 10 | Train Loss: 1.711 Vali Loss: 3.221 Vali Acc: 0.167 Test Loss: 3.221 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0090246200561523
Epoch: 21, Steps: 10 | Train Loss: 1.548 Vali Loss: 3.195 Vali Acc: 0.173 Test Loss: 3.195 Test Acc: 0.173
Validation loss decreased (-0.168203 --> -0.172909).  Saving model ...
Epoch: 22 cost time: 1.6511867046356201
Epoch: 22, Steps: 10 | Train Loss: 1.442 Vali Loss: 3.217 Vali Acc: 0.176 Test Loss: 3.217 Test Acc: 0.176
Validation loss decreased (-0.172909 --> -0.176438).  Saving model ...
Epoch: 23 cost time: 1.738344669342041
Epoch: 23, Steps: 10 | Train Loss: 1.387 Vali Loss: 3.212 Vali Acc: 0.195 Test Loss: 3.212 Test Acc: 0.195
Validation loss decreased (-0.176438 --> -0.195262).  Saving model ...
Epoch: 24 cost time: 1.6534044742584229
Epoch: 24, Steps: 10 | Train Loss: 1.259 Vali Loss: 3.212 Vali Acc: 0.201 Test Loss: 3.212 Test Acc: 0.201
Validation loss decreased (-0.195262 --> -0.201144).  Saving model ...
Epoch: 25 cost time: 1.9737379550933838
Epoch: 25, Steps: 10 | Train Loss: 1.207 Vali Loss: 3.242 Vali Acc: 0.200 Test Loss: 3.242 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5214009284973145
Epoch: 26, Steps: 10 | Train Loss: 1.141 Vali Loss: 3.242 Vali Acc: 0.204 Test Loss: 3.242 Test Acc: 0.204
Validation loss decreased (-0.201144 --> -0.203497).  Saving model ...
Epoch: 27 cost time: 1.550156831741333
Epoch: 27, Steps: 10 | Train Loss: 1.071 Vali Loss: 3.234 Vali Acc: 0.195 Test Loss: 3.234 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6044526100158691
Epoch: 28, Steps: 10 | Train Loss: 0.940 Vali Loss: 3.248 Vali Acc: 0.218 Test Loss: 3.248 Test Acc: 0.218
Validation loss decreased (-0.203497 --> -0.217615).  Saving model ...
Epoch: 29 cost time: 1.6894218921661377
Epoch: 29, Steps: 10 | Train Loss: 0.843 Vali Loss: 3.328 Vali Acc: 0.206 Test Loss: 3.328 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8154966831207275
Epoch: 30, Steps: 10 | Train Loss: 0.763 Vali Loss: 3.320 Vali Acc: 0.214 Test Loss: 3.320 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.8017609119415283
Epoch: 31, Steps: 10 | Train Loss: 0.679 Vali Loss: 3.384 Vali Acc: 0.216 Test Loss: 3.384 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.680095911026001
Epoch: 32, Steps: 10 | Train Loss: 0.581 Vali Loss: 3.336 Vali Acc: 0.218 Test Loss: 3.336 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7775039672851562
Epoch: 33, Steps: 10 | Train Loss: 0.538 Vali Loss: 3.414 Vali Acc: 0.215 Test Loss: 3.414 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.6007554531097412
Epoch: 34, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.409 Vali Acc: 0.226 Test Loss: 3.409 Test Acc: 0.226
Validation loss decreased (-0.217615 --> -0.225848).  Saving model ...
Epoch: 35 cost time: 2.0126891136169434
Epoch: 35, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.527 Vali Acc: 0.219 Test Loss: 3.527 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.0577874183654785
Epoch: 36, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.574 Vali Acc: 0.212 Test Loss: 3.574 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7712225914001465
Epoch: 37, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.424 Vali Acc: 0.235 Test Loss: 3.424 Test Acc: 0.235
Validation loss decreased (-0.225848 --> -0.235260).  Saving model ...
Epoch: 38 cost time: 1.6016075611114502
Epoch: 38, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.483 Vali Acc: 0.232 Test Loss: 3.483 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8371860980987549
Epoch: 39, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.525 Vali Acc: 0.241 Test Loss: 3.525 Test Acc: 0.241
Validation loss decreased (-0.235260 --> -0.241141).  Saving model ...
Epoch: 40 cost time: 1.7926435470581055
Epoch: 40, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.581 Vali Acc: 0.240 Test Loss: 3.581 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6783990859985352
Epoch: 41, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.588 Vali Acc: 0.234 Test Loss: 3.588 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.9241971969604492
Epoch: 42, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.606 Vali Acc: 0.232 Test Loss: 3.606 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.191696882247925
Epoch: 43, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.634 Vali Acc: 0.240 Test Loss: 3.634 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.722381353378296
Epoch: 44, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.646 Vali Acc: 0.236 Test Loss: 3.646 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.7470996379852295
Epoch: 45, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.718 Vali Acc: 0.245 Test Loss: 3.718 Test Acc: 0.245
Validation loss decreased (-0.241141 --> -0.244669).  Saving model ...
Epoch: 46 cost time: 1.7078862190246582
Epoch: 46, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.788 Vali Acc: 0.240 Test Loss: 3.788 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.5897510051727295
Epoch: 47, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.789 Vali Acc: 0.240 Test Loss: 3.789 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.7496039867401123
Epoch: 48, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.781 Vali Acc: 0.249 Test Loss: 3.781 Test Acc: 0.249
Validation loss decreased (-0.244669 --> -0.249374).  Saving model ...
Epoch: 49 cost time: 1.7810542583465576
Epoch: 49, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.822 Vali Acc: 0.244 Test Loss: 3.822 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.5713155269622803
Epoch: 50, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.887 Vali Acc: 0.241 Test Loss: 3.887 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.1572325229644775
Epoch: 51, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.900 Vali Acc: 0.240 Test Loss: 3.900 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.8210070133209229
Epoch: 52, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.802 Vali Acc: 0.251 Test Loss: 3.802 Test Acc: 0.251
Validation loss decreased (-0.249374 --> -0.250550).  Saving model ...
Epoch: 53 cost time: 1.7165632247924805
Epoch: 53, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.904 Vali Acc: 0.249 Test Loss: 3.904 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.126258611679077
Epoch: 54, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.937 Vali Acc: 0.245 Test Loss: 3.937 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.9913427829742432
Epoch: 55, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.895 Vali Acc: 0.246 Test Loss: 3.895 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.999385118484497
Epoch: 56, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.964 Vali Acc: 0.248 Test Loss: 3.964 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.7290065288543701
Epoch: 57, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.919 Vali Acc: 0.253 Test Loss: 3.919 Test Acc: 0.253
Validation loss decreased (-0.250550 --> -0.252902).  Saving model ...
Epoch: 58 cost time: 1.8109159469604492
Epoch: 58, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.967 Vali Acc: 0.253 Test Loss: 3.967 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.223613739013672
Epoch: 59, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.019 Vali Acc: 0.247 Test Loss: 4.019 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.2702274322509766
Epoch: 60, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.010 Vali Acc: 0.252 Test Loss: 4.010 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.267526626586914
Epoch: 61, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.016 Vali Acc: 0.248 Test Loss: 4.016 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 2.1359050273895264
Epoch: 62, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.040 Vali Acc: 0.246 Test Loss: 4.040 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 2.1691603660583496
Epoch: 63, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.043 Vali Acc: 0.247 Test Loss: 4.043 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 2.09967303276062
Epoch: 64, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.042 Vali Acc: 0.249 Test Loss: 4.042 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 2.0516605377197266
Epoch: 65, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.049 Vali Acc: 0.252 Test Loss: 4.049 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 2.395987033843994
Epoch: 66, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.092 Vali Acc: 0.238 Test Loss: 4.092 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 2.3274242877960205
Epoch: 67, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.109 Vali Acc: 0.252 Test Loss: 4.109 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 779222
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.08220362663269
Epoch: 1, Steps: 10 | Train Loss: 3.419 Vali Loss: 3.446 Vali Acc: 0.038 Test Loss: 3.446 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 1.6501977443695068
Epoch: 2, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.380 Vali Acc: 0.051 Test Loss: 3.380 Test Acc: 0.051
Validation loss decreased (-0.037613 --> -0.050554).  Saving model ...
Epoch: 3 cost time: 1.7736446857452393
Epoch: 3, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.358 Vali Acc: 0.051 Test Loss: 3.358 Test Acc: 0.051
Validation loss decreased (-0.050554 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 1.6102259159088135
Epoch: 4, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.356 Vali Acc: 0.046 Test Loss: 3.356 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.910536527633667
Epoch: 5, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.345 Vali Acc: 0.060 Test Loss: 3.345 Test Acc: 0.060
Validation loss decreased (-0.050555 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 1.6704282760620117
Epoch: 6, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.352 Vali Acc: 0.064 Test Loss: 3.352 Test Acc: 0.064
Validation loss decreased (-0.059967 --> -0.063496).  Saving model ...
Epoch: 7 cost time: 1.7584080696105957
Epoch: 7, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.335 Vali Acc: 0.058 Test Loss: 3.335 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8129887580871582
Epoch: 8, Steps: 10 | Train Loss: 2.966 Vali Loss: 3.307 Vali Acc: 0.069 Test Loss: 3.307 Test Acc: 0.069
Validation loss decreased (-0.063496 --> -0.069379).  Saving model ...
Epoch: 9 cost time: 1.9349958896636963
Epoch: 9, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.305 Vali Acc: 0.088 Test Loss: 3.305 Test Acc: 0.088
Validation loss decreased (-0.069379 --> -0.088202).  Saving model ...
Epoch: 10 cost time: 1.9868066310882568
Epoch: 10, Steps: 10 | Train Loss: 2.776 Vali Loss: 3.307 Vali Acc: 0.101 Test Loss: 3.307 Test Acc: 0.101
Validation loss decreased (-0.088202 --> -0.101143).  Saving model ...
Epoch: 11 cost time: 1.954711675643921
Epoch: 11, Steps: 10 | Train Loss: 2.712 Vali Loss: 3.270 Vali Acc: 0.104 Test Loss: 3.270 Test Acc: 0.104
Validation loss decreased (-0.101143 --> -0.103497).  Saving model ...
Epoch: 12 cost time: 2.0766685009002686
Epoch: 12, Steps: 10 | Train Loss: 2.596 Vali Loss: 3.273 Vali Acc: 0.105 Test Loss: 3.273 Test Acc: 0.105
Validation loss decreased (-0.103497 --> -0.104673).  Saving model ...
Epoch: 13 cost time: 1.6639230251312256
Epoch: 13, Steps: 10 | Train Loss: 2.506 Vali Loss: 3.250 Vali Acc: 0.128 Test Loss: 3.250 Test Acc: 0.128
Validation loss decreased (-0.104673 --> -0.128203).  Saving model ...
Epoch: 14 cost time: 1.4681735038757324
Epoch: 14, Steps: 10 | Train Loss: 2.381 Vali Loss: 3.270 Vali Acc: 0.121 Test Loss: 3.270 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.741508960723877
Epoch: 15, Steps: 10 | Train Loss: 2.290 Vali Loss: 3.257 Vali Acc: 0.134 Test Loss: 3.257 Test Acc: 0.134
Validation loss decreased (-0.128203 --> -0.134085).  Saving model ...
Epoch: 16 cost time: 1.5441875457763672
Epoch: 16, Steps: 10 | Train Loss: 2.215 Vali Loss: 3.234 Vali Acc: 0.142 Test Loss: 3.234 Test Acc: 0.142
Validation loss decreased (-0.134085 --> -0.142321).  Saving model ...
Epoch: 17 cost time: 1.6957721710205078
Epoch: 17, Steps: 10 | Train Loss: 2.088 Vali Loss: 3.247 Vali Acc: 0.146 Test Loss: 3.247 Test Acc: 0.146
Validation loss decreased (-0.142321 --> -0.145850).  Saving model ...
Epoch: 18 cost time: 2.013978958129883
Epoch: 18, Steps: 10 | Train Loss: 2.047 Vali Loss: 3.221 Vali Acc: 0.151 Test Loss: 3.221 Test Acc: 0.151
Validation loss decreased (-0.145850 --> -0.150556).  Saving model ...
Epoch: 19 cost time: 1.7081034183502197
Epoch: 19, Steps: 10 | Train Loss: 1.871 Vali Loss: 3.231 Vali Acc: 0.155 Test Loss: 3.231 Test Acc: 0.155
Validation loss decreased (-0.150556 --> -0.155262).  Saving model ...
Epoch: 20 cost time: 2.066243886947632
Epoch: 20, Steps: 10 | Train Loss: 1.784 Vali Loss: 3.239 Vali Acc: 0.146 Test Loss: 3.239 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7213599681854248
Epoch: 21, Steps: 10 | Train Loss: 1.727 Vali Loss: 3.269 Vali Acc: 0.159 Test Loss: 3.269 Test Acc: 0.159
Validation loss decreased (-0.155262 --> -0.158791).  Saving model ...
Epoch: 22 cost time: 1.5128920078277588
Epoch: 22, Steps: 10 | Train Loss: 1.656 Vali Loss: 3.229 Vali Acc: 0.173 Test Loss: 3.229 Test Acc: 0.173
Validation loss decreased (-0.158791 --> -0.172909).  Saving model ...
Epoch: 23 cost time: 1.874565839767456
Epoch: 23, Steps: 10 | Train Loss: 1.484 Vali Loss: 3.238 Vali Acc: 0.162 Test Loss: 3.238 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.338770866394043
Epoch: 24, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.243 Vali Acc: 0.178 Test Loss: 3.243 Test Acc: 0.178
Validation loss decreased (-0.172909 --> -0.177615).  Saving model ...
Epoch: 25 cost time: 1.7416212558746338
Epoch: 25, Steps: 10 | Train Loss: 1.323 Vali Loss: 3.257 Vali Acc: 0.188 Test Loss: 3.257 Test Acc: 0.188
Validation loss decreased (-0.177615 --> -0.188203).  Saving model ...
Epoch: 26 cost time: 1.888035535812378
Epoch: 26, Steps: 10 | Train Loss: 1.175 Vali Loss: 3.249 Vali Acc: 0.175 Test Loss: 3.249 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7606520652770996
Epoch: 27, Steps: 10 | Train Loss: 1.173 Vali Loss: 3.278 Vali Acc: 0.189 Test Loss: 3.278 Test Acc: 0.189
Validation loss decreased (-0.188203 --> -0.189379).  Saving model ...
Epoch: 28 cost time: 1.7588036060333252
Epoch: 28, Steps: 10 | Train Loss: 1.032 Vali Loss: 3.339 Vali Acc: 0.185 Test Loss: 3.339 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8599474430084229
Epoch: 29, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.258 Vali Acc: 0.206 Test Loss: 3.258 Test Acc: 0.206
Validation loss decreased (-0.189379 --> -0.205850).  Saving model ...
Epoch: 30 cost time: 1.7227747440338135
Epoch: 30, Steps: 10 | Train Loss: 0.863 Vali Loss: 3.328 Vali Acc: 0.199 Test Loss: 3.328 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.955977439880371
Epoch: 31, Steps: 10 | Train Loss: 0.774 Vali Loss: 3.274 Vali Acc: 0.209 Test Loss: 3.274 Test Acc: 0.209
Validation loss decreased (-0.205850 --> -0.209379).  Saving model ...
Epoch: 32 cost time: 1.9023456573486328
Epoch: 32, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.356 Vali Acc: 0.213 Test Loss: 3.356 Test Acc: 0.213
Validation loss decreased (-0.209379 --> -0.212908).  Saving model ...
Epoch: 33 cost time: 1.693650245666504
Epoch: 33, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.291 Vali Acc: 0.216 Test Loss: 3.291 Test Acc: 0.216
Validation loss decreased (-0.212908 --> -0.216438).  Saving model ...
Epoch: 34 cost time: 1.9203152656555176
Epoch: 34, Steps: 10 | Train Loss: 0.637 Vali Loss: 3.335 Vali Acc: 0.231 Test Loss: 3.335 Test Acc: 0.231
Validation loss decreased (-0.216438 --> -0.230555).  Saving model ...
Epoch: 35 cost time: 2.054921865463257
Epoch: 35, Steps: 10 | Train Loss: 0.469 Vali Loss: 3.350 Vali Acc: 0.232 Test Loss: 3.350 Test Acc: 0.232
Validation loss decreased (-0.230555 --> -0.231731).  Saving model ...
Epoch: 36 cost time: 1.7443511486053467
Epoch: 36, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.388 Vali Acc: 0.229 Test Loss: 3.388 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8263144493103027
Epoch: 37, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.398 Vali Acc: 0.238 Test Loss: 3.398 Test Acc: 0.238
Validation loss decreased (-0.231731 --> -0.237613).  Saving model ...
Epoch: 38 cost time: 1.899212121963501
Epoch: 38, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.448 Vali Acc: 0.236 Test Loss: 3.448 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7109224796295166
Epoch: 39, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.418 Vali Acc: 0.234 Test Loss: 3.418 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.8699061870574951
Epoch: 40, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.536 Vali Acc: 0.227 Test Loss: 3.536 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.710456371307373
Epoch: 41, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.506 Vali Acc: 0.231 Test Loss: 3.506 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.5877692699432373
Epoch: 42, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.571 Vali Acc: 0.245 Test Loss: 3.571 Test Acc: 0.245
Validation loss decreased (-0.237613 --> -0.244670).  Saving model ...
Epoch: 43 cost time: 1.9255826473236084
Epoch: 43, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.543 Vali Acc: 0.260 Test Loss: 3.543 Test Acc: 0.260
Validation loss decreased (-0.244670 --> -0.259965).  Saving model ...
Epoch: 44 cost time: 1.9335687160491943
Epoch: 44, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.627 Vali Acc: 0.239 Test Loss: 3.627 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7474172115325928
Epoch: 45, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.618 Vali Acc: 0.260 Test Loss: 3.618 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.805067777633667
Epoch: 46, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.672 Vali Acc: 0.241 Test Loss: 3.672 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.6209940910339355
Epoch: 47, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.634 Vali Acc: 0.252 Test Loss: 3.634 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.0573508739471436
Epoch: 48, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.701 Vali Acc: 0.242 Test Loss: 3.701 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.7712976932525635
Epoch: 49, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.706 Vali Acc: 0.251 Test Loss: 3.706 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.6909997463226318
Epoch: 50, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.673 Vali Acc: 0.254 Test Loss: 3.673 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.6544015407562256
Epoch: 51, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.797 Vali Acc: 0.246 Test Loss: 3.797 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.7497868537902832
Epoch: 52, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.790 Vali Acc: 0.254 Test Loss: 3.790 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.800527572631836
Epoch: 53, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.785 Vali Acc: 0.258 Test Loss: 3.785 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 777558
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5391244888305664
Epoch: 1, Steps: 10 | Train Loss: 3.432 Vali Loss: 3.389 Vali Acc: 0.028 Test Loss: 3.389 Test Acc: 0.028
Validation loss decreased (inf --> -0.028201).  Saving model ...
Epoch: 2 cost time: 1.7423410415649414
Epoch: 2, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.318 Vali Acc: 0.042 Test Loss: 3.318 Test Acc: 0.042
Validation loss decreased (-0.028201 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 1.6713087558746338
Epoch: 3, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.312 Vali Acc: 0.032 Test Loss: 3.312 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8031344413757324
Epoch: 4, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.320 Vali Acc: 0.041 Test Loss: 3.320 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6085517406463623
Epoch: 5, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.334 Vali Acc: 0.034 Test Loss: 3.334 Test Acc: 0.034
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8746702671051025
Epoch: 6, Steps: 10 | Train Loss: 3.062 Vali Loss: 3.317 Vali Acc: 0.042 Test Loss: 3.317 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 7 cost time: 1.5536003112792969
Epoch: 7, Steps: 10 | Train Loss: 3.050 Vali Loss: 3.302 Vali Acc: 0.060 Test Loss: 3.302 Test Acc: 0.060
Validation loss decreased (-0.042320 --> -0.059967).  Saving model ...
Epoch: 8 cost time: 1.574955701828003
Epoch: 8, Steps: 10 | Train Loss: 2.897 Vali Loss: 3.304 Vali Acc: 0.062 Test Loss: 3.304 Test Acc: 0.062
Validation loss decreased (-0.059967 --> -0.062320).  Saving model ...
Epoch: 9 cost time: 1.6598374843597412
Epoch: 9, Steps: 10 | Train Loss: 2.905 Vali Loss: 3.274 Vali Acc: 0.082 Test Loss: 3.274 Test Acc: 0.082
Validation loss decreased (-0.062320 --> -0.082320).  Saving model ...
Epoch: 10 cost time: 1.7707793712615967
Epoch: 10, Steps: 10 | Train Loss: 2.803 Vali Loss: 3.259 Vali Acc: 0.078 Test Loss: 3.259 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.080667495727539
Epoch: 11, Steps: 10 | Train Loss: 2.680 Vali Loss: 3.251 Vali Acc: 0.108 Test Loss: 3.251 Test Acc: 0.108
Validation loss decreased (-0.082320 --> -0.108203).  Saving model ...
Epoch: 12 cost time: 1.6486485004425049
Epoch: 12, Steps: 10 | Train Loss: 2.546 Vali Loss: 3.265 Vali Acc: 0.111 Test Loss: 3.265 Test Acc: 0.111
Validation loss decreased (-0.108203 --> -0.110556).  Saving model ...
Epoch: 13 cost time: 1.5744943618774414
Epoch: 13, Steps: 10 | Train Loss: 2.464 Vali Loss: 3.255 Vali Acc: 0.131 Test Loss: 3.255 Test Acc: 0.131
Validation loss decreased (-0.110556 --> -0.130556).  Saving model ...
Epoch: 14 cost time: 1.6712052822113037
Epoch: 14, Steps: 10 | Train Loss: 2.328 Vali Loss: 3.218 Vali Acc: 0.142 Test Loss: 3.218 Test Acc: 0.142
Validation loss decreased (-0.130556 --> -0.142321).  Saving model ...
Epoch: 15 cost time: 1.914562702178955
Epoch: 15, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.246 Vali Acc: 0.146 Test Loss: 3.246 Test Acc: 0.146
Validation loss decreased (-0.142321 --> -0.145850).  Saving model ...
Epoch: 16 cost time: 1.6099226474761963
Epoch: 16, Steps: 10 | Train Loss: 2.142 Vali Loss: 3.244 Vali Acc: 0.149 Test Loss: 3.244 Test Acc: 0.149
Validation loss decreased (-0.145850 --> -0.149379).  Saving model ...
Epoch: 17 cost time: 1.7161035537719727
Epoch: 17, Steps: 10 | Train Loss: 2.030 Vali Loss: 3.197 Vali Acc: 0.161 Test Loss: 3.197 Test Acc: 0.161
Validation loss decreased (-0.149379 --> -0.161144).  Saving model ...
Epoch: 18 cost time: 1.730351209640503
Epoch: 18, Steps: 10 | Train Loss: 1.917 Vali Loss: 3.218 Vali Acc: 0.167 Test Loss: 3.218 Test Acc: 0.167
Validation loss decreased (-0.161144 --> -0.167027).  Saving model ...
Epoch: 19 cost time: 1.7862231731414795
Epoch: 19, Steps: 10 | Train Loss: 1.771 Vali Loss: 3.204 Vali Acc: 0.162 Test Loss: 3.204 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.894144058227539
Epoch: 20, Steps: 10 | Train Loss: 1.659 Vali Loss: 3.236 Vali Acc: 0.176 Test Loss: 3.236 Test Acc: 0.176
Validation loss decreased (-0.167027 --> -0.176438).  Saving model ...
Epoch: 21 cost time: 1.618027925491333
Epoch: 21, Steps: 10 | Train Loss: 1.568 Vali Loss: 3.191 Vali Acc: 0.181 Test Loss: 3.191 Test Acc: 0.181
Validation loss decreased (-0.176438 --> -0.181145).  Saving model ...
Epoch: 22 cost time: 1.728593111038208
Epoch: 22, Steps: 10 | Train Loss: 1.510 Vali Loss: 3.235 Vali Acc: 0.191 Test Loss: 3.235 Test Acc: 0.191
Validation loss decreased (-0.181145 --> -0.190556).  Saving model ...
Epoch: 23 cost time: 1.7599947452545166
Epoch: 23, Steps: 10 | Train Loss: 1.450 Vali Loss: 3.222 Vali Acc: 0.185 Test Loss: 3.222 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8265020847320557
Epoch: 24, Steps: 10 | Train Loss: 1.281 Vali Loss: 3.241 Vali Acc: 0.195 Test Loss: 3.241 Test Acc: 0.195
Validation loss decreased (-0.190556 --> -0.195262).  Saving model ...
Epoch: 25 cost time: 2.046442747116089
Epoch: 25, Steps: 10 | Train Loss: 1.187 Vali Loss: 3.286 Vali Acc: 0.188 Test Loss: 3.286 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6759331226348877
Epoch: 26, Steps: 10 | Train Loss: 1.193 Vali Loss: 3.284 Vali Acc: 0.172 Test Loss: 3.284 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6259253025054932
Epoch: 27, Steps: 10 | Train Loss: 1.065 Vali Loss: 3.316 Vali Acc: 0.208 Test Loss: 3.316 Test Acc: 0.208
Validation loss decreased (-0.195262 --> -0.208202).  Saving model ...
Epoch: 28 cost time: 1.733128547668457
Epoch: 28, Steps: 10 | Train Loss: 0.941 Vali Loss: 3.279 Vali Acc: 0.201 Test Loss: 3.279 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6143832206726074
Epoch: 29, Steps: 10 | Train Loss: 0.838 Vali Loss: 3.277 Vali Acc: 0.219 Test Loss: 3.277 Test Acc: 0.219
Validation loss decreased (-0.208202 --> -0.218791).  Saving model ...
Epoch: 30 cost time: 1.7349331378936768
Epoch: 30, Steps: 10 | Train Loss: 0.757 Vali Loss: 3.399 Vali Acc: 0.202 Test Loss: 3.399 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7578606605529785
Epoch: 31, Steps: 10 | Train Loss: 0.674 Vali Loss: 3.328 Vali Acc: 0.213 Test Loss: 3.328 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8202054500579834
Epoch: 32, Steps: 10 | Train Loss: 0.613 Vali Loss: 3.336 Vali Acc: 0.207 Test Loss: 3.336 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.972930908203125
Epoch: 33, Steps: 10 | Train Loss: 0.499 Vali Loss: 3.376 Vali Acc: 0.209 Test Loss: 3.376 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.938584566116333
Epoch: 34, Steps: 10 | Train Loss: 0.433 Vali Loss: 3.407 Vali Acc: 0.218 Test Loss: 3.407 Test Acc: 0.218
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7154850959777832
Epoch: 35, Steps: 10 | Train Loss: 0.433 Vali Loss: 3.432 Vali Acc: 0.205 Test Loss: 3.432 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.9277663230895996
Epoch: 36, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.421 Vali Acc: 0.225 Test Loss: 3.421 Test Acc: 0.225
Validation loss decreased (-0.218791 --> -0.224672).  Saving model ...
Epoch: 37 cost time: 1.80527925491333
Epoch: 37, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.481 Vali Acc: 0.222 Test Loss: 3.481 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7876713275909424
Epoch: 38, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.552 Vali Acc: 0.214 Test Loss: 3.552 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.8200953006744385
Epoch: 39, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.525 Vali Acc: 0.219 Test Loss: 3.525 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8402152061462402
Epoch: 40, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.603 Vali Acc: 0.222 Test Loss: 3.603 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.0226428508758545
Epoch: 41, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.595 Vali Acc: 0.222 Test Loss: 3.595 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6328706741333008
Epoch: 42, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.642 Vali Acc: 0.232 Test Loss: 3.642 Test Acc: 0.232
Validation loss decreased (-0.224672 --> -0.231728).  Saving model ...
Epoch: 43 cost time: 1.8886651992797852
Epoch: 43, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.746 Vali Acc: 0.220 Test Loss: 3.746 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.7701687812805176
Epoch: 44, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.676 Vali Acc: 0.224 Test Loss: 3.676 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.7966110706329346
Epoch: 45, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.696 Vali Acc: 0.227 Test Loss: 3.696 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.705402135848999
Epoch: 46, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.740 Vali Acc: 0.224 Test Loss: 3.740 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.8766381740570068
Epoch: 47, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.788 Vali Acc: 0.228 Test Loss: 3.788 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.6322994232177734
Epoch: 48, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.735 Vali Acc: 0.241 Test Loss: 3.735 Test Acc: 0.241
Validation loss decreased (-0.231728 --> -0.241139).  Saving model ...
Epoch: 49 cost time: 1.8911142349243164
Epoch: 49, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.815 Vali Acc: 0.220 Test Loss: 3.815 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.9144911766052246
Epoch: 50, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.793 Vali Acc: 0.236 Test Loss: 3.793 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.6413989067077637
Epoch: 51, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.842 Vali Acc: 0.238 Test Loss: 3.842 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.7819106578826904
Epoch: 52, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.851 Vali Acc: 0.235 Test Loss: 3.851 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.8431470394134521
Epoch: 53, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.825 Vali Acc: 0.236 Test Loss: 3.825 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.6326937675476074
Epoch: 54, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.860 Vali Acc: 0.231 Test Loss: 3.860 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.784313440322876
Epoch: 55, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.875 Vali Acc: 0.222 Test Loss: 3.875 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.661184549331665
Epoch: 56, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.910 Vali Acc: 0.236 Test Loss: 3.910 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.5832488536834717
Epoch: 57, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.970 Vali Acc: 0.234 Test Loss: 3.970 Test Acc: 0.234
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.455641508102417
Epoch: 58, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.927 Vali Acc: 0.228 Test Loss: 3.927 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2411764705882353
model parameter : 775894
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6937320232391357
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.367 Vali Acc: 0.026 Test Loss: 3.367 Test Acc: 0.026
Validation loss decreased (inf --> -0.025849).  Saving model ...
Epoch: 2 cost time: 1.6933963298797607
Epoch: 2, Steps: 10 | Train Loss: 3.293 Vali Loss: 3.332 Vali Acc: 0.028 Test Loss: 3.332 Test Acc: 0.028
Validation loss decreased (-0.025849 --> -0.028202).  Saving model ...
Epoch: 3 cost time: 1.5314693450927734
Epoch: 3, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.347 Vali Acc: 0.033 Test Loss: 3.347 Test Acc: 0.033
Validation loss decreased (-0.028202 --> -0.032908).  Saving model ...
Epoch: 4 cost time: 1.9539039134979248
Epoch: 4, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.351 Vali Acc: 0.036 Test Loss: 3.351 Test Acc: 0.036
Validation loss decreased (-0.032908 --> -0.036437).  Saving model ...
Epoch: 5 cost time: 1.6537446975708008
Epoch: 5, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.349 Vali Acc: 0.044 Test Loss: 3.349 Test Acc: 0.044
Validation loss decreased (-0.036437 --> -0.043496).  Saving model ...
Epoch: 6 cost time: 1.812699556350708
Epoch: 6, Steps: 10 | Train Loss: 3.115 Vali Loss: 3.344 Vali Acc: 0.059 Test Loss: 3.344 Test Acc: 0.059
Validation loss decreased (-0.043496 --> -0.058790).  Saving model ...
Epoch: 7 cost time: 1.8079133033752441
Epoch: 7, Steps: 10 | Train Loss: 3.111 Vali Loss: 3.347 Vali Acc: 0.056 Test Loss: 3.347 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9639372825622559
Epoch: 8, Steps: 10 | Train Loss: 2.953 Vali Loss: 3.344 Vali Acc: 0.059 Test Loss: 3.344 Test Acc: 0.059
Validation loss decreased (-0.058790 --> -0.058790).  Saving model ...
Epoch: 9 cost time: 1.7680888175964355
Epoch: 9, Steps: 10 | Train Loss: 2.910 Vali Loss: 3.325 Vali Acc: 0.086 Test Loss: 3.325 Test Acc: 0.086
Validation loss decreased (-0.058790 --> -0.085849).  Saving model ...
Epoch: 10 cost time: 1.6866459846496582
Epoch: 10, Steps: 10 | Train Loss: 2.807 Vali Loss: 3.310 Vali Acc: 0.076 Test Loss: 3.310 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.952085256576538
Epoch: 11, Steps: 10 | Train Loss: 2.696 Vali Loss: 3.317 Vali Acc: 0.095 Test Loss: 3.317 Test Acc: 0.095
Validation loss decreased (-0.085849 --> -0.095261).  Saving model ...
Epoch: 12 cost time: 1.8227870464324951
Epoch: 12, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.312 Vali Acc: 0.100 Test Loss: 3.312 Test Acc: 0.100
Validation loss decreased (-0.095261 --> -0.099967).  Saving model ...
Epoch: 13 cost time: 1.8269104957580566
Epoch: 13, Steps: 10 | Train Loss: 2.538 Vali Loss: 3.333 Vali Acc: 0.112 Test Loss: 3.333 Test Acc: 0.112
Validation loss decreased (-0.099967 --> -0.111731).  Saving model ...
Epoch: 14 cost time: 1.7270686626434326
Epoch: 14, Steps: 10 | Train Loss: 2.387 Vali Loss: 3.310 Vali Acc: 0.108 Test Loss: 3.310 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6095340251922607
Epoch: 15, Steps: 10 | Train Loss: 2.249 Vali Loss: 3.295 Vali Acc: 0.118 Test Loss: 3.295 Test Acc: 0.118
Validation loss decreased (-0.111731 --> -0.117614).  Saving model ...
Epoch: 16 cost time: 1.6082746982574463
Epoch: 16, Steps: 10 | Train Loss: 2.283 Vali Loss: 3.326 Vali Acc: 0.121 Test Loss: 3.326 Test Acc: 0.121
Validation loss decreased (-0.117614 --> -0.121143).  Saving model ...
Epoch: 17 cost time: 2.112121105194092
Epoch: 17, Steps: 10 | Train Loss: 2.145 Vali Loss: 3.316 Vali Acc: 0.127 Test Loss: 3.316 Test Acc: 0.127
Validation loss decreased (-0.121143 --> -0.127026).  Saving model ...
Epoch: 18 cost time: 1.6353988647460938
Epoch: 18, Steps: 10 | Train Loss: 2.055 Vali Loss: 3.334 Vali Acc: 0.131 Test Loss: 3.334 Test Acc: 0.131
Validation loss decreased (-0.127026 --> -0.130555).  Saving model ...
Epoch: 19 cost time: 1.8317453861236572
Epoch: 19, Steps: 10 | Train Loss: 1.889 Vali Loss: 3.305 Vali Acc: 0.142 Test Loss: 3.305 Test Acc: 0.142
Validation loss decreased (-0.130555 --> -0.142320).  Saving model ...
Epoch: 20 cost time: 2.0618584156036377
Epoch: 20, Steps: 10 | Train Loss: 1.787 Vali Loss: 3.358 Vali Acc: 0.139 Test Loss: 3.358 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.650545358657837
Epoch: 21, Steps: 10 | Train Loss: 1.773 Vali Loss: 3.328 Vali Acc: 0.148 Test Loss: 3.328 Test Acc: 0.148
Validation loss decreased (-0.142320 --> -0.148202).  Saving model ...
Epoch: 22 cost time: 1.898012399673462
Epoch: 22, Steps: 10 | Train Loss: 1.650 Vali Loss: 3.346 Vali Acc: 0.154 Test Loss: 3.346 Test Acc: 0.154
Validation loss decreased (-0.148202 --> -0.154084).  Saving model ...
Epoch: 23 cost time: 1.5884675979614258
Epoch: 23, Steps: 10 | Train Loss: 1.501 Vali Loss: 3.326 Vali Acc: 0.162 Test Loss: 3.326 Test Acc: 0.162
Validation loss decreased (-0.154084 --> -0.162320).  Saving model ...
Epoch: 24 cost time: 1.7411079406738281
Epoch: 24, Steps: 10 | Train Loss: 1.423 Vali Loss: 3.394 Vali Acc: 0.161 Test Loss: 3.394 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8963816165924072
Epoch: 25, Steps: 10 | Train Loss: 1.368 Vali Loss: 3.353 Vali Acc: 0.164 Test Loss: 3.353 Test Acc: 0.164
Validation loss decreased (-0.162320 --> -0.163496).  Saving model ...
Epoch: 26 cost time: 1.740652322769165
Epoch: 26, Steps: 10 | Train Loss: 1.221 Vali Loss: 3.367 Vali Acc: 0.167 Test Loss: 3.367 Test Acc: 0.167
Validation loss decreased (-0.163496 --> -0.167025).  Saving model ...
Epoch: 27 cost time: 1.6716821193695068
Epoch: 27, Steps: 10 | Train Loss: 1.149 Vali Loss: 3.341 Vali Acc: 0.182 Test Loss: 3.341 Test Acc: 0.182
Validation loss decreased (-0.167025 --> -0.182320).  Saving model ...
Epoch: 28 cost time: 1.5846595764160156
Epoch: 28, Steps: 10 | Train Loss: 1.059 Vali Loss: 3.402 Vali Acc: 0.186 Test Loss: 3.402 Test Acc: 0.186
Validation loss decreased (-0.182320 --> -0.185848).  Saving model ...
Epoch: 29 cost time: 1.864380121231079
Epoch: 29, Steps: 10 | Train Loss: 0.962 Vali Loss: 3.404 Vali Acc: 0.176 Test Loss: 3.404 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.791783332824707
Epoch: 30, Steps: 10 | Train Loss: 0.890 Vali Loss: 3.371 Vali Acc: 0.196 Test Loss: 3.371 Test Acc: 0.196
Validation loss decreased (-0.185848 --> -0.196437).  Saving model ...
Epoch: 31 cost time: 1.8423662185668945
Epoch: 31, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.382 Vali Acc: 0.194 Test Loss: 3.382 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9159727096557617
Epoch: 32, Steps: 10 | Train Loss: 0.697 Vali Loss: 3.449 Vali Acc: 0.205 Test Loss: 3.449 Test Acc: 0.205
Validation loss decreased (-0.196437 --> -0.204671).  Saving model ...
Epoch: 33 cost time: 1.7304306030273438
Epoch: 33, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.440 Vali Acc: 0.206 Test Loss: 3.440 Test Acc: 0.206
Validation loss decreased (-0.204671 --> -0.205848).  Saving model ...
Epoch: 34 cost time: 1.8206121921539307
Epoch: 34, Steps: 10 | Train Loss: 0.532 Vali Loss: 3.400 Vali Acc: 0.222 Test Loss: 3.400 Test Acc: 0.222
Validation loss decreased (-0.205848 --> -0.222319).  Saving model ...
Epoch: 35 cost time: 1.5107421875
Epoch: 35, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.450 Vali Acc: 0.228 Test Loss: 3.450 Test Acc: 0.228
Validation loss decreased (-0.222319 --> -0.228201).  Saving model ...
Epoch: 36 cost time: 1.8102617263793945
Epoch: 36, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.502 Vali Acc: 0.222 Test Loss: 3.502 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.842728853225708
Epoch: 37, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.485 Vali Acc: 0.233 Test Loss: 3.485 Test Acc: 0.233
Validation loss decreased (-0.228201 --> -0.232906).  Saving model ...
Epoch: 38 cost time: 1.7547335624694824
Epoch: 38, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.525 Vali Acc: 0.235 Test Loss: 3.525 Test Acc: 0.235
Validation loss decreased (-0.232906 --> -0.235259).  Saving model ...
Epoch: 39 cost time: 1.702308177947998
Epoch: 39, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.526 Vali Acc: 0.236 Test Loss: 3.526 Test Acc: 0.236
Validation loss decreased (-0.235259 --> -0.236435).  Saving model ...
Epoch: 40 cost time: 1.819023847579956
Epoch: 40, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.571 Vali Acc: 0.242 Test Loss: 3.571 Test Acc: 0.242
Validation loss decreased (-0.236435 --> -0.242317).  Saving model ...
Epoch: 41 cost time: 1.6965935230255127
Epoch: 41, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.626 Vali Acc: 0.244 Test Loss: 3.626 Test Acc: 0.244
Validation loss decreased (-0.242317 --> -0.243493).  Saving model ...
Epoch: 42 cost time: 2.1624295711517334
Epoch: 42, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.680 Vali Acc: 0.247 Test Loss: 3.680 Test Acc: 0.247
Validation loss decreased (-0.243493 --> -0.247022).  Saving model ...
Epoch: 43 cost time: 2.0601887702941895
Epoch: 43, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.611 Vali Acc: 0.249 Test Loss: 3.611 Test Acc: 0.249
Validation loss decreased (-0.247022 --> -0.249376).  Saving model ...
Epoch: 44 cost time: 1.7534608840942383
Epoch: 44, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.707 Vali Acc: 0.245 Test Loss: 3.707 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.108442783355713
Epoch: 45, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.807 Vali Acc: 0.231 Test Loss: 3.807 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.9886078834533691
Epoch: 46, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.728 Vali Acc: 0.258 Test Loss: 3.728 Test Acc: 0.258
Validation loss decreased (-0.249376 --> -0.257610).  Saving model ...
Epoch: 47 cost time: 1.8264784812927246
Epoch: 47, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.830 Vali Acc: 0.264 Test Loss: 3.830 Test Acc: 0.264
Validation loss decreased (-0.257610 --> -0.263491).  Saving model ...
Epoch: 48 cost time: 1.579399824142456
Epoch: 48, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.770 Vali Acc: 0.255 Test Loss: 3.770 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.7651925086975098
Epoch: 49, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.842 Vali Acc: 0.256 Test Loss: 3.842 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.5813705921173096
Epoch: 50, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.886 Vali Acc: 0.240 Test Loss: 3.886 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.8133389949798584
Epoch: 51, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.898 Vali Acc: 0.251 Test Loss: 3.898 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.9179670810699463
Epoch: 52, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.913 Vali Acc: 0.265 Test Loss: 3.913 Test Acc: 0.265
Validation loss decreased (-0.263491 --> -0.264667).  Saving model ...
Epoch: 53 cost time: 1.9850635528564453
Epoch: 53, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.942 Vali Acc: 0.248 Test Loss: 3.942 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.9447381496429443
Epoch: 54, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.907 Vali Acc: 0.259 Test Loss: 3.907 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.7234015464782715
Epoch: 55, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.934 Vali Acc: 0.251 Test Loss: 3.934 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.840881586074829
Epoch: 56, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.915 Vali Acc: 0.266 Test Loss: 3.915 Test Acc: 0.266
Validation loss decreased (-0.264667 --> -0.265843).  Saving model ...
Epoch: 57 cost time: 1.5682477951049805
Epoch: 57, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.961 Vali Acc: 0.255 Test Loss: 3.961 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.9486572742462158
Epoch: 58, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.943 Vali Acc: 0.259 Test Loss: 3.943 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.5727524757385254
Epoch: 59, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.975 Vali Acc: 0.264 Test Loss: 3.975 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.777090072631836
Epoch: 60, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.951 Vali Acc: 0.262 Test Loss: 3.951 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.9080610275268555
Epoch: 61, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.996 Vali Acc: 0.261 Test Loss: 3.996 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.7562928199768066
Epoch: 62, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.953 Vali Acc: 0.264 Test Loss: 3.953 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.679649829864502
Epoch: 63, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.998 Vali Acc: 0.260 Test Loss: 3.998 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.5873463153839111
Epoch: 64, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.002 Vali Acc: 0.268 Test Loss: 4.002 Test Acc: 0.268
Validation loss decreased (-0.265843 --> -0.268195).  Saving model ...
Epoch: 65 cost time: 2.070129632949829
Epoch: 65, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.024 Vali Acc: 0.267 Test Loss: 4.024 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.8457303047180176
Epoch: 66, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.052 Vali Acc: 0.265 Test Loss: 4.052 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.6145625114440918
Epoch: 67, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.028 Vali Acc: 0.268 Test Loss: 4.028 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.6244614124298096
Epoch: 68, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.044 Vali Acc: 0.265 Test Loss: 4.044 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.7047865390777588
Epoch: 69, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.034 Vali Acc: 0.268 Test Loss: 4.034 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.5885474681854248
Epoch: 70, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.066 Vali Acc: 0.264 Test Loss: 4.066 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.6401422023773193
Epoch: 71, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.080 Vali Acc: 0.266 Test Loss: 4.080 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.663224220275879
Epoch: 72, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.109 Vali Acc: 0.268 Test Loss: 4.109 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.7505552768707275
Epoch: 73, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.097 Vali Acc: 0.266 Test Loss: 4.097 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.7164497375488281
Epoch: 74, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.119 Vali Acc: 0.260 Test Loss: 4.119 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 774230
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0981764793395996
Epoch: 1, Steps: 10 | Train Loss: 3.483 Vali Loss: 3.406 Vali Acc: 0.035 Test Loss: 3.406 Test Acc: 0.035
Validation loss decreased (inf --> -0.035260).  Saving model ...
Epoch: 2 cost time: 1.7185695171356201
Epoch: 2, Steps: 10 | Train Loss: 3.396 Vali Loss: 3.334 Vali Acc: 0.054 Test Loss: 3.334 Test Acc: 0.054
Validation loss decreased (-0.035260 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 1.7181053161621094
Epoch: 3, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.332 Vali Acc: 0.053 Test Loss: 3.332 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.835935115814209
Epoch: 4, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.336 Vali Acc: 0.051 Test Loss: 3.336 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7576384544372559
Epoch: 5, Steps: 10 | Train Loss: 3.151 Vali Loss: 3.341 Vali Acc: 0.059 Test Loss: 3.341 Test Acc: 0.059
Validation loss decreased (-0.054084 --> -0.058790).  Saving model ...
Epoch: 6 cost time: 2.063016653060913
Epoch: 6, Steps: 10 | Train Loss: 3.155 Vali Loss: 3.315 Vali Acc: 0.076 Test Loss: 3.315 Test Acc: 0.076
Validation loss decreased (-0.058790 --> -0.076437).  Saving model ...
Epoch: 7 cost time: 1.828732967376709
Epoch: 7, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.295 Vali Acc: 0.064 Test Loss: 3.295 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6591434478759766
Epoch: 8, Steps: 10 | Train Loss: 2.966 Vali Loss: 3.287 Vali Acc: 0.084 Test Loss: 3.287 Test Acc: 0.084
Validation loss decreased (-0.076437 --> -0.083497).  Saving model ...
Epoch: 9 cost time: 1.904792308807373
Epoch: 9, Steps: 10 | Train Loss: 2.929 Vali Loss: 3.309 Vali Acc: 0.084 Test Loss: 3.309 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.927008867263794
Epoch: 10, Steps: 10 | Train Loss: 2.915 Vali Loss: 3.302 Vali Acc: 0.071 Test Loss: 3.302 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8245015144348145
Epoch: 11, Steps: 10 | Train Loss: 2.817 Vali Loss: 3.281 Vali Acc: 0.112 Test Loss: 3.281 Test Acc: 0.112
Validation loss decreased (-0.083497 --> -0.111732).  Saving model ...
Epoch: 12 cost time: 1.9439990520477295
Epoch: 12, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.278 Vali Acc: 0.107 Test Loss: 3.278 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.072486400604248
Epoch: 13, Steps: 10 | Train Loss: 2.632 Vali Loss: 3.277 Vali Acc: 0.124 Test Loss: 3.277 Test Acc: 0.124
Validation loss decreased (-0.111732 --> -0.123497).  Saving model ...
Epoch: 14 cost time: 2.3148131370544434
Epoch: 14, Steps: 10 | Train Loss: 2.609 Vali Loss: 3.254 Vali Acc: 0.108 Test Loss: 3.254 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.265660524368286
Epoch: 15, Steps: 10 | Train Loss: 2.460 Vali Loss: 3.290 Vali Acc: 0.119 Test Loss: 3.290 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8009936809539795
Epoch: 16, Steps: 10 | Train Loss: 2.461 Vali Loss: 3.244 Vali Acc: 0.138 Test Loss: 3.244 Test Acc: 0.138
Validation loss decreased (-0.123497 --> -0.137615).  Saving model ...
Epoch: 17 cost time: 1.8364219665527344
Epoch: 17, Steps: 10 | Train Loss: 2.326 Vali Loss: 3.234 Vali Acc: 0.122 Test Loss: 3.234 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9164764881134033
Epoch: 18, Steps: 10 | Train Loss: 2.232 Vali Loss: 3.195 Vali Acc: 0.155 Test Loss: 3.195 Test Acc: 0.155
Validation loss decreased (-0.137615 --> -0.155262).  Saving model ...
Epoch: 19 cost time: 1.8518073558807373
Epoch: 19, Steps: 10 | Train Loss: 2.142 Vali Loss: 3.232 Vali Acc: 0.151 Test Loss: 3.232 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8734285831451416
Epoch: 20, Steps: 10 | Train Loss: 2.150 Vali Loss: 3.181 Vali Acc: 0.139 Test Loss: 3.181 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8071656227111816
Epoch: 21, Steps: 10 | Train Loss: 2.072 Vali Loss: 3.265 Vali Acc: 0.146 Test Loss: 3.265 Test Acc: 0.146
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7104120254516602
Epoch: 22, Steps: 10 | Train Loss: 1.967 Vali Loss: 3.196 Vali Acc: 0.156 Test Loss: 3.196 Test Acc: 0.156
Validation loss decreased (-0.155262 --> -0.156439).  Saving model ...
Epoch: 23 cost time: 1.7763671875
Epoch: 23, Steps: 10 | Train Loss: 1.882 Vali Loss: 3.171 Vali Acc: 0.171 Test Loss: 3.171 Test Acc: 0.171
Validation loss decreased (-0.156439 --> -0.170557).  Saving model ...
Epoch: 24 cost time: 1.9326071739196777
Epoch: 24, Steps: 10 | Train Loss: 1.848 Vali Loss: 3.179 Vali Acc: 0.171 Test Loss: 3.179 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6820793151855469
Epoch: 25, Steps: 10 | Train Loss: 1.798 Vali Loss: 3.207 Vali Acc: 0.164 Test Loss: 3.207 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5641529560089111
Epoch: 26, Steps: 10 | Train Loss: 1.727 Vali Loss: 3.127 Vali Acc: 0.173 Test Loss: 3.127 Test Acc: 0.173
Validation loss decreased (-0.170557 --> -0.172910).  Saving model ...
Epoch: 27 cost time: 1.623060703277588
Epoch: 27, Steps: 10 | Train Loss: 1.573 Vali Loss: 3.177 Vali Acc: 0.169 Test Loss: 3.177 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8745157718658447
Epoch: 28, Steps: 10 | Train Loss: 1.572 Vali Loss: 3.166 Vali Acc: 0.167 Test Loss: 3.166 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.694417953491211
Epoch: 29, Steps: 10 | Train Loss: 1.499 Vali Loss: 3.161 Vali Acc: 0.175 Test Loss: 3.161 Test Acc: 0.175
Validation loss decreased (-0.172910 --> -0.175263).  Saving model ...
Epoch: 30 cost time: 1.7540497779846191
Epoch: 30, Steps: 10 | Train Loss: 1.479 Vali Loss: 3.160 Vali Acc: 0.186 Test Loss: 3.160 Test Acc: 0.186
Validation loss decreased (-0.175263 --> -0.185851).  Saving model ...
Epoch: 31 cost time: 1.5755209922790527
Epoch: 31, Steps: 10 | Train Loss: 1.331 Vali Loss: 3.125 Vali Acc: 0.186 Test Loss: 3.125 Test Acc: 0.186
Validation loss decreased (-0.185851 --> -0.185851).  Saving model ...
Epoch: 32 cost time: 2.0986711978912354
Epoch: 32, Steps: 10 | Train Loss: 1.251 Vali Loss: 3.160 Vali Acc: 0.186 Test Loss: 3.160 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.262485980987549
Epoch: 33, Steps: 10 | Train Loss: 1.147 Vali Loss: 3.097 Vali Acc: 0.200 Test Loss: 3.097 Test Acc: 0.200
Validation loss decreased (-0.185851 --> -0.199969).  Saving model ...
Epoch: 34 cost time: 1.877039909362793
Epoch: 34, Steps: 10 | Train Loss: 1.124 Vali Loss: 3.160 Vali Acc: 0.191 Test Loss: 3.160 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8701109886169434
Epoch: 35, Steps: 10 | Train Loss: 1.123 Vali Loss: 3.097 Vali Acc: 0.202 Test Loss: 3.097 Test Acc: 0.202
Validation loss decreased (-0.199969 --> -0.202322).  Saving model ...
Epoch: 36 cost time: 1.7059521675109863
Epoch: 36, Steps: 10 | Train Loss: 1.025 Vali Loss: 3.118 Vali Acc: 0.205 Test Loss: 3.118 Test Acc: 0.205
Validation loss decreased (-0.202322 --> -0.204675).  Saving model ...
Epoch: 37 cost time: 1.9461398124694824
Epoch: 37, Steps: 10 | Train Loss: 0.940 Vali Loss: 3.160 Vali Acc: 0.207 Test Loss: 3.160 Test Acc: 0.207
Validation loss decreased (-0.204675 --> -0.207027).  Saving model ...
Epoch: 38 cost time: 2.1023406982421875
Epoch: 38, Steps: 10 | Train Loss: 0.934 Vali Loss: 3.140 Vali Acc: 0.206 Test Loss: 3.140 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8307609558105469
Epoch: 39, Steps: 10 | Train Loss: 0.864 Vali Loss: 3.165 Vali Acc: 0.185 Test Loss: 3.165 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.8214068412780762
Epoch: 40, Steps: 10 | Train Loss: 0.771 Vali Loss: 3.158 Vali Acc: 0.201 Test Loss: 3.158 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.7484400272369385
Epoch: 41, Steps: 10 | Train Loss: 0.644 Vali Loss: 3.119 Vali Acc: 0.219 Test Loss: 3.119 Test Acc: 0.219
Validation loss decreased (-0.207027 --> -0.218792).  Saving model ...
Epoch: 42 cost time: 1.9145591259002686
Epoch: 42, Steps: 10 | Train Loss: 0.620 Vali Loss: 3.143 Vali Acc: 0.224 Test Loss: 3.143 Test Acc: 0.224
Validation loss decreased (-0.218792 --> -0.223498).  Saving model ...
Epoch: 43 cost time: 1.7287719249725342
Epoch: 43, Steps: 10 | Train Loss: 0.569 Vali Loss: 3.130 Vali Acc: 0.220 Test Loss: 3.130 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.8429172039031982
Epoch: 44, Steps: 10 | Train Loss: 0.562 Vali Loss: 3.121 Vali Acc: 0.200 Test Loss: 3.121 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.0240275859832764
Epoch: 45, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.167 Vali Acc: 0.213 Test Loss: 3.167 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.1124277114868164
Epoch: 46, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.174 Vali Acc: 0.221 Test Loss: 3.174 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.163532257080078
Epoch: 47, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.225 Vali Acc: 0.213 Test Loss: 3.225 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.042663097381592
Epoch: 48, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.192 Vali Acc: 0.195 Test Loss: 3.192 Test Acc: 0.195
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.440035104751587
Epoch: 49, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.182 Vali Acc: 0.222 Test Loss: 3.182 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.7686288356781006
Epoch: 50, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.168 Vali Acc: 0.242 Test Loss: 3.168 Test Acc: 0.242
Validation loss decreased (-0.223498 --> -0.242321).  Saving model ...
Epoch: 51 cost time: 1.8789927959442139
Epoch: 51, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.198 Vali Acc: 0.231 Test Loss: 3.198 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.9503114223480225
Epoch: 52, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.245 Vali Acc: 0.224 Test Loss: 3.245 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.760772466659546
Epoch: 53, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.256 Vali Acc: 0.245 Test Loss: 3.256 Test Acc: 0.245
Validation loss decreased (-0.242321 --> -0.244673).  Saving model ...
Epoch: 54 cost time: 1.6910841464996338
Epoch: 54, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.280 Vali Acc: 0.236 Test Loss: 3.280 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.949756383895874
Epoch: 55, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.345 Vali Acc: 0.224 Test Loss: 3.345 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.015967845916748
Epoch: 56, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.328 Vali Acc: 0.220 Test Loss: 3.328 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.970130443572998
Epoch: 57, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.339 Vali Acc: 0.229 Test Loss: 3.339 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.998154878616333
Epoch: 58, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.389 Vali Acc: 0.236 Test Loss: 3.389 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.7819318771362305
Epoch: 59, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.305 Vali Acc: 0.229 Test Loss: 3.305 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 2.0436832904815674
Epoch: 60, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.392 Vali Acc: 0.238 Test Loss: 3.392 Test Acc: 0.238
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.8959860801696777
Epoch: 61, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.356 Vali Acc: 0.238 Test Loss: 3.356 Test Acc: 0.238
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.7002818584442139
Epoch: 62, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.435 Vali Acc: 0.235 Test Loss: 3.435 Test Acc: 0.235
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 2.021454095840454
Epoch: 63, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.380 Vali Acc: 0.241 Test Loss: 3.380 Test Acc: 0.241
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2447058823529412
model parameter : 766934
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7334835529327393
Epoch: 1, Steps: 10 | Train Loss: 3.522 Vali Loss: 3.409 Vali Acc: 0.042 Test Loss: 3.409 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 1.8313255310058594
Epoch: 2, Steps: 10 | Train Loss: 3.399 Vali Loss: 3.327 Vali Acc: 0.035 Test Loss: 3.327 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9014396667480469
Epoch: 3, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.331 Vali Acc: 0.053 Test Loss: 3.331 Test Acc: 0.053
Validation loss decreased (-0.042319 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 1.7451317310333252
Epoch: 4, Steps: 10 | Train Loss: 3.162 Vali Loss: 3.345 Vali Acc: 0.059 Test Loss: 3.345 Test Acc: 0.059
Validation loss decreased (-0.052908 --> -0.058790).  Saving model ...
Epoch: 5 cost time: 1.9356167316436768
Epoch: 5, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.337 Vali Acc: 0.055 Test Loss: 3.337 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7629187107086182
Epoch: 6, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.335 Vali Acc: 0.049 Test Loss: 3.335 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7792291641235352
Epoch: 7, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.319 Vali Acc: 0.074 Test Loss: 3.319 Test Acc: 0.074
Validation loss decreased (-0.058790 --> -0.074084).  Saving model ...
Epoch: 8 cost time: 2.036837100982666
Epoch: 8, Steps: 10 | Train Loss: 3.008 Vali Loss: 3.306 Vali Acc: 0.078 Test Loss: 3.306 Test Acc: 0.078
Validation loss decreased (-0.074084 --> -0.077614).  Saving model ...
Epoch: 9 cost time: 1.8108506202697754
Epoch: 9, Steps: 10 | Train Loss: 2.920 Vali Loss: 3.277 Vali Acc: 0.076 Test Loss: 3.277 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9201688766479492
Epoch: 10, Steps: 10 | Train Loss: 2.871 Vali Loss: 3.287 Vali Acc: 0.086 Test Loss: 3.287 Test Acc: 0.086
Validation loss decreased (-0.077614 --> -0.085849).  Saving model ...
Epoch: 11 cost time: 2.0899176597595215
Epoch: 11, Steps: 10 | Train Loss: 2.760 Vali Loss: 3.283 Vali Acc: 0.101 Test Loss: 3.283 Test Acc: 0.101
Validation loss decreased (-0.085849 --> -0.101144).  Saving model ...
Epoch: 12 cost time: 1.8582804203033447
Epoch: 12, Steps: 10 | Train Loss: 2.689 Vali Loss: 3.253 Vali Acc: 0.100 Test Loss: 3.253 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8541278839111328
Epoch: 13, Steps: 10 | Train Loss: 2.569 Vali Loss: 3.248 Vali Acc: 0.109 Test Loss: 3.248 Test Acc: 0.109
Validation loss decreased (-0.101144 --> -0.109379).  Saving model ...
Epoch: 14 cost time: 2.379657745361328
Epoch: 14, Steps: 10 | Train Loss: 2.556 Vali Loss: 3.225 Vali Acc: 0.114 Test Loss: 3.225 Test Acc: 0.114
Validation loss decreased (-0.109379 --> -0.114085).  Saving model ...
Epoch: 15 cost time: 1.8775348663330078
Epoch: 15, Steps: 10 | Train Loss: 2.475 Vali Loss: 3.224 Vali Acc: 0.115 Test Loss: 3.224 Test Acc: 0.115
Validation loss decreased (-0.114085 --> -0.115262).  Saving model ...
Epoch: 16 cost time: 2.2268412113189697
Epoch: 16, Steps: 10 | Train Loss: 2.401 Vali Loss: 3.229 Vali Acc: 0.113 Test Loss: 3.229 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8065614700317383
Epoch: 17, Steps: 10 | Train Loss: 2.305 Vali Loss: 3.213 Vali Acc: 0.133 Test Loss: 3.213 Test Acc: 0.133
Validation loss decreased (-0.115262 --> -0.132909).  Saving model ...
Epoch: 18 cost time: 2.111842155456543
Epoch: 18, Steps: 10 | Train Loss: 2.283 Vali Loss: 3.185 Vali Acc: 0.122 Test Loss: 3.185 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.291682481765747
Epoch: 19, Steps: 10 | Train Loss: 2.155 Vali Loss: 3.183 Vali Acc: 0.146 Test Loss: 3.183 Test Acc: 0.146
Validation loss decreased (-0.132909 --> -0.145851).  Saving model ...
Epoch: 20 cost time: 2.4729080200195312
Epoch: 20, Steps: 10 | Train Loss: 2.071 Vali Loss: 3.177 Vali Acc: 0.139 Test Loss: 3.177 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6429359912872314
Epoch: 21, Steps: 10 | Train Loss: 1.990 Vali Loss: 3.151 Vali Acc: 0.146 Test Loss: 3.151 Test Acc: 0.146
Validation loss decreased (-0.145851 --> -0.145851).  Saving model ...
Epoch: 22 cost time: 2.127687692642212
Epoch: 22, Steps: 10 | Train Loss: 1.944 Vali Loss: 3.158 Vali Acc: 0.140 Test Loss: 3.158 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.205813407897949
Epoch: 23, Steps: 10 | Train Loss: 1.879 Vali Loss: 3.163 Vali Acc: 0.134 Test Loss: 3.163 Test Acc: 0.134
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7365822792053223
Epoch: 24, Steps: 10 | Train Loss: 1.833 Vali Loss: 3.110 Vali Acc: 0.165 Test Loss: 3.110 Test Acc: 0.165
Validation loss decreased (-0.145851 --> -0.164675).  Saving model ...
Epoch: 25 cost time: 2.0349576473236084
Epoch: 25, Steps: 10 | Train Loss: 1.695 Vali Loss: 3.102 Vali Acc: 0.178 Test Loss: 3.102 Test Acc: 0.178
Validation loss decreased (-0.164675 --> -0.177616).  Saving model ...
Epoch: 26 cost time: 2.6122500896453857
Epoch: 26, Steps: 10 | Train Loss: 1.612 Vali Loss: 3.108 Vali Acc: 0.178 Test Loss: 3.108 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.161416530609131
Epoch: 27, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.112 Vali Acc: 0.168 Test Loss: 3.112 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.4154040813446045
Epoch: 28, Steps: 10 | Train Loss: 1.557 Vali Loss: 3.088 Vali Acc: 0.186 Test Loss: 3.088 Test Acc: 0.186
Validation loss decreased (-0.177616 --> -0.185851).  Saving model ...
Epoch: 29 cost time: 2.023277759552002
Epoch: 29, Steps: 10 | Train Loss: 1.460 Vali Loss: 3.078 Vali Acc: 0.180 Test Loss: 3.078 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.4389545917510986
Epoch: 30, Steps: 10 | Train Loss: 1.359 Vali Loss: 3.088 Vali Acc: 0.180 Test Loss: 3.088 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.677119493484497
Epoch: 31, Steps: 10 | Train Loss: 1.294 Vali Loss: 3.101 Vali Acc: 0.192 Test Loss: 3.101 Test Acc: 0.192
Validation loss decreased (-0.185851 --> -0.191734).  Saving model ...
Epoch: 32 cost time: 2.5823307037353516
Epoch: 32, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.085 Vali Acc: 0.186 Test Loss: 3.085 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.896310806274414
Epoch: 33, Steps: 10 | Train Loss: 1.142 Vali Loss: 3.108 Vali Acc: 0.179 Test Loss: 3.108 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.0002920627593994
Epoch: 34, Steps: 10 | Train Loss: 1.109 Vali Loss: 3.141 Vali Acc: 0.187 Test Loss: 3.141 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.117044448852539
Epoch: 35, Steps: 10 | Train Loss: 1.094 Vali Loss: 3.127 Vali Acc: 0.204 Test Loss: 3.127 Test Acc: 0.204
Validation loss decreased (-0.191734 --> -0.203498).  Saving model ...
Epoch: 36 cost time: 2.0085880756378174
Epoch: 36, Steps: 10 | Train Loss: 0.973 Vali Loss: 3.065 Vali Acc: 0.192 Test Loss: 3.065 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.2696893215179443
Epoch: 37, Steps: 10 | Train Loss: 0.897 Vali Loss: 3.131 Vali Acc: 0.204 Test Loss: 3.131 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.268629550933838
Epoch: 38, Steps: 10 | Train Loss: 0.839 Vali Loss: 3.058 Vali Acc: 0.207 Test Loss: 3.058 Test Acc: 0.207
Validation loss decreased (-0.203498 --> -0.207028).  Saving model ...
Epoch: 39 cost time: 2.0289971828460693
Epoch: 39, Steps: 10 | Train Loss: 0.780 Vali Loss: 3.146 Vali Acc: 0.194 Test Loss: 3.146 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.2770087718963623
Epoch: 40, Steps: 10 | Train Loss: 0.778 Vali Loss: 3.118 Vali Acc: 0.185 Test Loss: 3.118 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.1618380546569824
Epoch: 41, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.066 Vali Acc: 0.208 Test Loss: 3.066 Test Acc: 0.208
Validation loss decreased (-0.207028 --> -0.208205).  Saving model ...
Epoch: 42 cost time: 2.365373373031616
Epoch: 42, Steps: 10 | Train Loss: 0.621 Vali Loss: 3.150 Vali Acc: 0.202 Test Loss: 3.150 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.013479232788086
Epoch: 43, Steps: 10 | Train Loss: 0.534 Vali Loss: 3.098 Vali Acc: 0.212 Test Loss: 3.098 Test Acc: 0.212
Validation loss decreased (-0.208205 --> -0.211734).  Saving model ...
Epoch: 44 cost time: 2.0479073524475098
Epoch: 44, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.142 Vali Acc: 0.213 Test Loss: 3.142 Test Acc: 0.213
Validation loss decreased (-0.211734 --> -0.212910).  Saving model ...
Epoch: 45 cost time: 2.3069007396698
Epoch: 45, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.170 Vali Acc: 0.226 Test Loss: 3.170 Test Acc: 0.226
Validation loss decreased (-0.212910 --> -0.225851).  Saving model ...
Epoch: 46 cost time: 2.2851476669311523
Epoch: 46, Steps: 10 | Train Loss: 0.402 Vali Loss: 3.134 Vali Acc: 0.220 Test Loss: 3.134 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.587484836578369
Epoch: 47, Steps: 10 | Train Loss: 0.365 Vali Loss: 3.187 Vali Acc: 0.211 Test Loss: 3.187 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.14711332321167
Epoch: 48, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.151 Vali Acc: 0.221 Test Loss: 3.151 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.8708877563476562
Epoch: 49, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.156 Vali Acc: 0.205 Test Loss: 3.156 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.2430226802825928
Epoch: 50, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.201 Vali Acc: 0.222 Test Loss: 3.201 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.792968511581421
Epoch: 51, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.315 Vali Acc: 0.213 Test Loss: 3.315 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.2273290157318115
Epoch: 52, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.345 Vali Acc: 0.222 Test Loss: 3.345 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.8100841045379639
Epoch: 53, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.231 Vali Acc: 0.205 Test Loss: 3.231 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 2.2788851261138916
Epoch: 54, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.403 Vali Acc: 0.207 Test Loss: 3.403 Test Acc: 0.207
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 2.802475929260254
Epoch: 55, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.290 Vali Acc: 0.219 Test Loss: 3.290 Test Acc: 0.219
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22588235294117648
model parameter : 766102
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7994346618652344
Epoch: 1, Steps: 10 | Train Loss: 3.459 Vali Loss: 3.358 Vali Acc: 0.038 Test Loss: 3.358 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 1.7394218444824219
Epoch: 2, Steps: 10 | Train Loss: 3.370 Vali Loss: 3.288 Vali Acc: 0.038 Test Loss: 3.288 Test Acc: 0.038
Validation loss decreased (-0.037613 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 1.8786780834197998
Epoch: 3, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.305 Vali Acc: 0.038 Test Loss: 3.305 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.957336187362671
Epoch: 4, Steps: 10 | Train Loss: 3.207 Vali Loss: 3.315 Vali Acc: 0.045 Test Loss: 3.315 Test Acc: 0.045
Validation loss decreased (-0.037614 --> -0.044673).  Saving model ...
Epoch: 5 cost time: 1.6578171253204346
Epoch: 5, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.325 Vali Acc: 0.035 Test Loss: 3.325 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9812889099121094
Epoch: 6, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.317 Vali Acc: 0.046 Test Loss: 3.317 Test Acc: 0.046
Validation loss decreased (-0.044673 --> -0.045849).  Saving model ...
Epoch: 7 cost time: 1.5676720142364502
Epoch: 7, Steps: 10 | Train Loss: 3.142 Vali Loss: 3.315 Vali Acc: 0.053 Test Loss: 3.315 Test Acc: 0.053
Validation loss decreased (-0.045849 --> -0.052908).  Saving model ...
Epoch: 8 cost time: 1.6331782341003418
Epoch: 8, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.302 Vali Acc: 0.069 Test Loss: 3.302 Test Acc: 0.069
Validation loss decreased (-0.052908 --> -0.069379).  Saving model ...
Epoch: 9 cost time: 1.6381919384002686
Epoch: 9, Steps: 10 | Train Loss: 3.096 Vali Loss: 3.293 Vali Acc: 0.059 Test Loss: 3.293 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0172600746154785
Epoch: 10, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.292 Vali Acc: 0.072 Test Loss: 3.292 Test Acc: 0.072
Validation loss decreased (-0.069379 --> -0.071732).  Saving model ...
Epoch: 11 cost time: 1.7445642948150635
Epoch: 11, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.279 Vali Acc: 0.095 Test Loss: 3.279 Test Acc: 0.095
Validation loss decreased (-0.071732 --> -0.095261).  Saving model ...
Epoch: 12 cost time: 1.8568198680877686
Epoch: 12, Steps: 10 | Train Loss: 2.831 Vali Loss: 3.252 Vali Acc: 0.093 Test Loss: 3.252 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6728215217590332
Epoch: 13, Steps: 10 | Train Loss: 2.750 Vali Loss: 3.243 Vali Acc: 0.086 Test Loss: 3.243 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6306238174438477
Epoch: 14, Steps: 10 | Train Loss: 2.720 Vali Loss: 3.260 Vali Acc: 0.084 Test Loss: 3.260 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.931673526763916
Epoch: 15, Steps: 10 | Train Loss: 2.605 Vali Loss: 3.232 Vali Acc: 0.105 Test Loss: 3.232 Test Acc: 0.105
Validation loss decreased (-0.095261 --> -0.104674).  Saving model ...
Epoch: 16 cost time: 1.8116505146026611
Epoch: 16, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.243 Vali Acc: 0.091 Test Loss: 3.243 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.734377384185791
Epoch: 17, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.212 Vali Acc: 0.112 Test Loss: 3.212 Test Acc: 0.112
Validation loss decreased (-0.104674 --> -0.111733).  Saving model ...
Epoch: 18 cost time: 2.0308890342712402
Epoch: 18, Steps: 10 | Train Loss: 2.404 Vali Loss: 3.241 Vali Acc: 0.106 Test Loss: 3.241 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.300321340560913
Epoch: 19, Steps: 10 | Train Loss: 2.316 Vali Loss: 3.207 Vali Acc: 0.125 Test Loss: 3.207 Test Acc: 0.125
Validation loss decreased (-0.111733 --> -0.124674).  Saving model ...
Epoch: 20 cost time: 1.701300859451294
Epoch: 20, Steps: 10 | Train Loss: 2.240 Vali Loss: 3.218 Vali Acc: 0.122 Test Loss: 3.218 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7972960472106934
Epoch: 21, Steps: 10 | Train Loss: 2.131 Vali Loss: 3.204 Vali Acc: 0.125 Test Loss: 3.204 Test Acc: 0.125
Validation loss decreased (-0.124674 --> -0.124674).  Saving model ...
Epoch: 22 cost time: 2.110649585723877
Epoch: 22, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.200 Vali Acc: 0.127 Test Loss: 3.200 Test Acc: 0.127
Validation loss decreased (-0.124674 --> -0.127027).  Saving model ...
Epoch: 23 cost time: 1.9756762981414795
Epoch: 23, Steps: 10 | Train Loss: 1.933 Vali Loss: 3.201 Vali Acc: 0.133 Test Loss: 3.201 Test Acc: 0.133
Validation loss decreased (-0.127027 --> -0.132909).  Saving model ...
Epoch: 24 cost time: 1.7191948890686035
Epoch: 24, Steps: 10 | Train Loss: 1.887 Vali Loss: 3.199 Vali Acc: 0.140 Test Loss: 3.199 Test Acc: 0.140
Validation loss decreased (-0.132909 --> -0.139968).  Saving model ...
Epoch: 25 cost time: 1.7682766914367676
Epoch: 25, Steps: 10 | Train Loss: 1.870 Vali Loss: 3.164 Vali Acc: 0.146 Test Loss: 3.164 Test Acc: 0.146
Validation loss decreased (-0.139968 --> -0.145851).  Saving model ...
Epoch: 26 cost time: 1.8276371955871582
Epoch: 26, Steps: 10 | Train Loss: 1.753 Vali Loss: 3.205 Vali Acc: 0.141 Test Loss: 3.205 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8173582553863525
Epoch: 27, Steps: 10 | Train Loss: 1.673 Vali Loss: 3.161 Vali Acc: 0.153 Test Loss: 3.161 Test Acc: 0.153
Validation loss decreased (-0.145851 --> -0.152910).  Saving model ...
Epoch: 28 cost time: 1.4771885871887207
Epoch: 28, Steps: 10 | Train Loss: 1.612 Vali Loss: 3.197 Vali Acc: 0.151 Test Loss: 3.197 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0944526195526123
Epoch: 29, Steps: 10 | Train Loss: 1.502 Vali Loss: 3.178 Vali Acc: 0.146 Test Loss: 3.178 Test Acc: 0.146
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7567949295043945
Epoch: 30, Steps: 10 | Train Loss: 1.415 Vali Loss: 3.162 Vali Acc: 0.158 Test Loss: 3.162 Test Acc: 0.158
Validation loss decreased (-0.152910 --> -0.157615).  Saving model ...
Epoch: 31 cost time: 1.6762053966522217
Epoch: 31, Steps: 10 | Train Loss: 1.390 Vali Loss: 3.192 Vali Acc: 0.145 Test Loss: 3.192 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7210259437561035
Epoch: 32, Steps: 10 | Train Loss: 1.289 Vali Loss: 3.205 Vali Acc: 0.171 Test Loss: 3.205 Test Acc: 0.171
Validation loss decreased (-0.157615 --> -0.170556).  Saving model ...
Epoch: 33 cost time: 1.762852430343628
Epoch: 33, Steps: 10 | Train Loss: 1.265 Vali Loss: 3.189 Vali Acc: 0.161 Test Loss: 3.189 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.807722568511963
Epoch: 34, Steps: 10 | Train Loss: 1.180 Vali Loss: 3.185 Vali Acc: 0.161 Test Loss: 3.185 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6398310661315918
Epoch: 35, Steps: 10 | Train Loss: 1.055 Vali Loss: 3.194 Vali Acc: 0.173 Test Loss: 3.194 Test Acc: 0.173
Validation loss decreased (-0.170556 --> -0.172909).  Saving model ...
Epoch: 36 cost time: 1.9489326477050781
Epoch: 36, Steps: 10 | Train Loss: 1.017 Vali Loss: 3.230 Vali Acc: 0.144 Test Loss: 3.230 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7718591690063477
Epoch: 37, Steps: 10 | Train Loss: 0.915 Vali Loss: 3.219 Vali Acc: 0.179 Test Loss: 3.219 Test Acc: 0.179
Validation loss decreased (-0.172909 --> -0.178791).  Saving model ...
Epoch: 38 cost time: 1.558546781539917
Epoch: 38, Steps: 10 | Train Loss: 0.893 Vali Loss: 3.193 Vali Acc: 0.168 Test Loss: 3.193 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8391692638397217
Epoch: 39, Steps: 10 | Train Loss: 0.768 Vali Loss: 3.224 Vali Acc: 0.189 Test Loss: 3.224 Test Acc: 0.189
Validation loss decreased (-0.178791 --> -0.189380).  Saving model ...
Epoch: 40 cost time: 1.4855825901031494
Epoch: 40, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.202 Vali Acc: 0.182 Test Loss: 3.202 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.0186290740966797
Epoch: 41, Steps: 10 | Train Loss: 0.685 Vali Loss: 3.268 Vali Acc: 0.168 Test Loss: 3.268 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8575162887573242
Epoch: 42, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.202 Vali Acc: 0.180 Test Loss: 3.202 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.740067481994629
Epoch: 43, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.284 Vali Acc: 0.178 Test Loss: 3.284 Test Acc: 0.178
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.6926555633544922
Epoch: 44, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.243 Vali Acc: 0.178 Test Loss: 3.243 Test Acc: 0.178
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.6111934185028076
Epoch: 45, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.272 Vali Acc: 0.178 Test Loss: 3.272 Test Acc: 0.178
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.7557744979858398
Epoch: 46, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.273 Vali Acc: 0.172 Test Loss: 3.273 Test Acc: 0.172
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.986388921737671
Epoch: 47, Steps: 10 | Train Loss: 0.398 Vali Loss: 3.318 Vali Acc: 0.187 Test Loss: 3.318 Test Acc: 0.187
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.7864885330200195
Epoch: 48, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.316 Vali Acc: 0.186 Test Loss: 3.316 Test Acc: 0.186
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.7741777896881104
Epoch: 49, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.337 Vali Acc: 0.191 Test Loss: 3.337 Test Acc: 0.191
Validation loss decreased (-0.189380 --> -0.190555).  Saving model ...
Epoch: 50 cost time: 1.8784563541412354
Epoch: 50, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.438 Vali Acc: 0.175 Test Loss: 3.438 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.7019126415252686
Epoch: 51, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.363 Vali Acc: 0.193 Test Loss: 3.363 Test Acc: 0.193
Validation loss decreased (-0.190555 --> -0.192908).  Saving model ...
Epoch: 52 cost time: 1.7877635955810547
Epoch: 52, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.450 Vali Acc: 0.192 Test Loss: 3.450 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.881378173828125
Epoch: 53, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.423 Vali Acc: 0.201 Test Loss: 3.423 Test Acc: 0.201
Validation loss decreased (-0.192908 --> -0.201142).  Saving model ...
Epoch: 54 cost time: 2.076597213745117
Epoch: 54, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.498 Vali Acc: 0.185 Test Loss: 3.498 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.547830581665039
Epoch: 55, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.435 Vali Acc: 0.195 Test Loss: 3.435 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.8649954795837402
Epoch: 56, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.579 Vali Acc: 0.188 Test Loss: 3.579 Test Acc: 0.188
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.7925338745117188
Epoch: 57, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.491 Vali Acc: 0.191 Test Loss: 3.491 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 2.1219799518585205
Epoch: 58, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.581 Vali Acc: 0.196 Test Loss: 3.581 Test Acc: 0.196
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.9826853275299072
Epoch: 59, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.536 Vali Acc: 0.205 Test Loss: 3.536 Test Acc: 0.205
Validation loss decreased (-0.201142 --> -0.204671).  Saving model ...
Epoch: 60 cost time: 1.699650526046753
Epoch: 60, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.588 Vali Acc: 0.204 Test Loss: 3.588 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.797264814376831
Epoch: 61, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.627 Vali Acc: 0.188 Test Loss: 3.627 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 2.0035347938537598
Epoch: 62, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.598 Vali Acc: 0.201 Test Loss: 3.598 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.8711798191070557
Epoch: 63, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.664 Vali Acc: 0.201 Test Loss: 3.664 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 2.0979197025299072
Epoch: 64, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.627 Vali Acc: 0.195 Test Loss: 3.627 Test Acc: 0.195
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.5760273933410645
Epoch: 65, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.648 Vali Acc: 0.201 Test Loss: 3.648 Test Acc: 0.201
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 2.235384464263916
Epoch: 66, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.667 Vali Acc: 0.193 Test Loss: 3.667 Test Acc: 0.193
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 2.0649755001068115
Epoch: 67, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.757 Vali Acc: 0.202 Test Loss: 3.757 Test Acc: 0.202
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 2.0344388484954834
Epoch: 68, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.676 Vali Acc: 0.192 Test Loss: 3.676 Test Acc: 0.192
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 2.344008445739746
Epoch: 69, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.702 Vali Acc: 0.201 Test Loss: 3.702 Test Acc: 0.201
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20470588235294118
model parameter : 765270
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.909322500228882
Epoch: 1, Steps: 10 | Train Loss: 3.464 Vali Loss: 3.431 Vali Acc: 0.034 Test Loss: 3.431 Test Acc: 0.034
Validation loss decreased (inf --> -0.034083).  Saving model ...
Epoch: 2 cost time: 1.7908923625946045
Epoch: 2, Steps: 10 | Train Loss: 3.334 Vali Loss: 3.343 Vali Acc: 0.041 Test Loss: 3.343 Test Acc: 0.041
Validation loss decreased (-0.034083 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 1.868774652481079
Epoch: 3, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.344 Vali Acc: 0.042 Test Loss: 3.344 Test Acc: 0.042
Validation loss decreased (-0.041143 --> -0.042319).  Saving model ...
Epoch: 4 cost time: 1.67055344581604
Epoch: 4, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.333 Vali Acc: 0.048 Test Loss: 3.333 Test Acc: 0.048
Validation loss decreased (-0.042319 --> -0.048202).  Saving model ...
Epoch: 5 cost time: 1.9193799495697021
Epoch: 5, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.334 Vali Acc: 0.049 Test Loss: 3.334 Test Acc: 0.049
Validation loss decreased (-0.048202 --> -0.049378).  Saving model ...
Epoch: 6 cost time: 1.7431697845458984
Epoch: 6, Steps: 10 | Train Loss: 3.071 Vali Loss: 3.338 Vali Acc: 0.060 Test Loss: 3.338 Test Acc: 0.060
Validation loss decreased (-0.049378 --> -0.059967).  Saving model ...
Epoch: 7 cost time: 1.7245566844940186
Epoch: 7, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.333 Vali Acc: 0.068 Test Loss: 3.333 Test Acc: 0.068
Validation loss decreased (-0.059967 --> -0.068202).  Saving model ...
Epoch: 8 cost time: 2.056190013885498
Epoch: 8, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.351 Vali Acc: 0.072 Test Loss: 3.351 Test Acc: 0.072
Validation loss decreased (-0.068202 --> -0.071731).  Saving model ...
Epoch: 9 cost time: 1.9681344032287598
Epoch: 9, Steps: 10 | Train Loss: 2.867 Vali Loss: 3.323 Vali Acc: 0.080 Test Loss: 3.323 Test Acc: 0.080
Validation loss decreased (-0.071731 --> -0.079967).  Saving model ...
Epoch: 10 cost time: 2.136500597000122
Epoch: 10, Steps: 10 | Train Loss: 2.795 Vali Loss: 3.323 Vali Acc: 0.074 Test Loss: 3.323 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0161616802215576
Epoch: 11, Steps: 10 | Train Loss: 2.635 Vali Loss: 3.332 Vali Acc: 0.085 Test Loss: 3.332 Test Acc: 0.085
Validation loss decreased (-0.079967 --> -0.084673).  Saving model ...
Epoch: 12 cost time: 2.094305992126465
Epoch: 12, Steps: 10 | Train Loss: 2.620 Vali Loss: 3.329 Vali Acc: 0.092 Test Loss: 3.329 Test Acc: 0.092
Validation loss decreased (-0.084673 --> -0.091731).  Saving model ...
Epoch: 13 cost time: 1.8715388774871826
Epoch: 13, Steps: 10 | Train Loss: 2.569 Vali Loss: 3.316 Vali Acc: 0.100 Test Loss: 3.316 Test Acc: 0.100
Validation loss decreased (-0.091731 --> -0.099967).  Saving model ...
Epoch: 14 cost time: 1.8692519664764404
Epoch: 14, Steps: 10 | Train Loss: 2.432 Vali Loss: 3.309 Vali Acc: 0.086 Test Loss: 3.309 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.914409875869751
Epoch: 15, Steps: 10 | Train Loss: 2.371 Vali Loss: 3.303 Vali Acc: 0.098 Test Loss: 3.303 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8278541564941406
Epoch: 16, Steps: 10 | Train Loss: 2.325 Vali Loss: 3.304 Vali Acc: 0.086 Test Loss: 3.304 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6438302993774414
Epoch: 17, Steps: 10 | Train Loss: 2.254 Vali Loss: 3.293 Vali Acc: 0.112 Test Loss: 3.293 Test Acc: 0.112
Validation loss decreased (-0.099967 --> -0.111732).  Saving model ...
Epoch: 18 cost time: 1.7984158992767334
Epoch: 18, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.308 Vali Acc: 0.102 Test Loss: 3.308 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.88578200340271
Epoch: 19, Steps: 10 | Train Loss: 2.114 Vali Loss: 3.280 Vali Acc: 0.115 Test Loss: 3.280 Test Acc: 0.115
Validation loss decreased (-0.111732 --> -0.115261).  Saving model ...
Epoch: 20 cost time: 1.7838165760040283
Epoch: 20, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.287 Vali Acc: 0.121 Test Loss: 3.287 Test Acc: 0.121
Validation loss decreased (-0.115261 --> -0.121144).  Saving model ...
Epoch: 21 cost time: 1.7157390117645264
Epoch: 21, Steps: 10 | Train Loss: 1.952 Vali Loss: 3.305 Vali Acc: 0.119 Test Loss: 3.305 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.813244104385376
Epoch: 22, Steps: 10 | Train Loss: 1.867 Vali Loss: 3.297 Vali Acc: 0.132 Test Loss: 3.297 Test Acc: 0.132
Validation loss decreased (-0.121144 --> -0.131732).  Saving model ...
Epoch: 23 cost time: 1.7244958877563477
Epoch: 23, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.286 Vali Acc: 0.125 Test Loss: 3.286 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.617389440536499
Epoch: 24, Steps: 10 | Train Loss: 1.694 Vali Loss: 3.275 Vali Acc: 0.129 Test Loss: 3.275 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9144678115844727
Epoch: 25, Steps: 10 | Train Loss: 1.687 Vali Loss: 3.299 Vali Acc: 0.146 Test Loss: 3.299 Test Acc: 0.146
Validation loss decreased (-0.131732 --> -0.145849).  Saving model ...
Epoch: 26 cost time: 1.9632914066314697
Epoch: 26, Steps: 10 | Train Loss: 1.581 Vali Loss: 3.260 Vali Acc: 0.145 Test Loss: 3.260 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0672950744628906
Epoch: 27, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.263 Vali Acc: 0.147 Test Loss: 3.263 Test Acc: 0.147
Validation loss decreased (-0.145849 --> -0.147026).  Saving model ...
Epoch: 28 cost time: 2.2881505489349365
Epoch: 28, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.279 Vali Acc: 0.149 Test Loss: 3.279 Test Acc: 0.149
Validation loss decreased (-0.147026 --> -0.149379).  Saving model ...
Epoch: 29 cost time: 1.5442004203796387
Epoch: 29, Steps: 10 | Train Loss: 1.269 Vali Loss: 3.315 Vali Acc: 0.146 Test Loss: 3.315 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7014286518096924
Epoch: 30, Steps: 10 | Train Loss: 1.336 Vali Loss: 3.260 Vali Acc: 0.160 Test Loss: 3.260 Test Acc: 0.160
Validation loss decreased (-0.149379 --> -0.159967).  Saving model ...
Epoch: 31 cost time: 1.6356711387634277
Epoch: 31, Steps: 10 | Train Loss: 1.232 Vali Loss: 3.340 Vali Acc: 0.151 Test Loss: 3.340 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7100963592529297
Epoch: 32, Steps: 10 | Train Loss: 1.135 Vali Loss: 3.289 Vali Acc: 0.179 Test Loss: 3.289 Test Acc: 0.179
Validation loss decreased (-0.159967 --> -0.178791).  Saving model ...
Epoch: 33 cost time: 1.800689458847046
Epoch: 33, Steps: 10 | Train Loss: 1.059 Vali Loss: 3.348 Vali Acc: 0.145 Test Loss: 3.348 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6401538848876953
Epoch: 34, Steps: 10 | Train Loss: 1.013 Vali Loss: 3.292 Vali Acc: 0.173 Test Loss: 3.292 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.660768747329712
Epoch: 35, Steps: 10 | Train Loss: 0.981 Vali Loss: 3.319 Vali Acc: 0.167 Test Loss: 3.319 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6451983451843262
Epoch: 36, Steps: 10 | Train Loss: 0.832 Vali Loss: 3.349 Vali Acc: 0.156 Test Loss: 3.349 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.113234758377075
Epoch: 37, Steps: 10 | Train Loss: 0.814 Vali Loss: 3.344 Vali Acc: 0.159 Test Loss: 3.344 Test Acc: 0.159
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.688948154449463
Epoch: 38, Steps: 10 | Train Loss: 0.802 Vali Loss: 3.366 Vali Acc: 0.181 Test Loss: 3.366 Test Acc: 0.181
Validation loss decreased (-0.178791 --> -0.181143).  Saving model ...
Epoch: 39 cost time: 1.8683497905731201
Epoch: 39, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.448 Vali Acc: 0.162 Test Loss: 3.448 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9758880138397217
Epoch: 40, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.393 Vali Acc: 0.165 Test Loss: 3.393 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5815887451171875
Epoch: 41, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.411 Vali Acc: 0.179 Test Loss: 3.411 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.9755003452301025
Epoch: 42, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.393 Vali Acc: 0.174 Test Loss: 3.393 Test Acc: 0.174
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7722690105438232
Epoch: 43, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.391 Vali Acc: 0.178 Test Loss: 3.391 Test Acc: 0.178
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.743452787399292
Epoch: 44, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.442 Vali Acc: 0.185 Test Loss: 3.442 Test Acc: 0.185
Validation loss decreased (-0.181143 --> -0.184671).  Saving model ...
Epoch: 45 cost time: 2.121731996536255
Epoch: 45, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.476 Vali Acc: 0.181 Test Loss: 3.476 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.8856186866760254
Epoch: 46, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.501 Vali Acc: 0.173 Test Loss: 3.501 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.670172929763794
Epoch: 47, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.492 Vali Acc: 0.182 Test Loss: 3.492 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.6915955543518066
Epoch: 48, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.502 Vali Acc: 0.182 Test Loss: 3.502 Test Acc: 0.182
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.8980441093444824
Epoch: 49, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.513 Vali Acc: 0.200 Test Loss: 3.513 Test Acc: 0.200
Validation loss decreased (-0.184671 --> -0.199965).  Saving model ...
Epoch: 50 cost time: 1.7166640758514404
Epoch: 50, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.540 Vali Acc: 0.194 Test Loss: 3.540 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.8074548244476318
Epoch: 51, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.583 Vali Acc: 0.187 Test Loss: 3.583 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.7612457275390625
Epoch: 52, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.612 Vali Acc: 0.195 Test Loss: 3.612 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.5582513809204102
Epoch: 53, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.618 Vali Acc: 0.196 Test Loss: 3.618 Test Acc: 0.196
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.0264790058135986
Epoch: 54, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.592 Vali Acc: 0.221 Test Loss: 3.592 Test Acc: 0.221
Validation loss decreased (-0.199965 --> -0.221141).  Saving model ...
Epoch: 55 cost time: 1.7758972644805908
Epoch: 55, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.675 Vali Acc: 0.193 Test Loss: 3.675 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.5052907466888428
Epoch: 56, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.636 Vali Acc: 0.202 Test Loss: 3.636 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.762174129486084
Epoch: 57, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.739 Vali Acc: 0.189 Test Loss: 3.739 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.714271068572998
Epoch: 58, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.630 Vali Acc: 0.211 Test Loss: 3.630 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.00716495513916
Epoch: 59, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.739 Vali Acc: 0.195 Test Loss: 3.739 Test Acc: 0.195
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.9491405487060547
Epoch: 60, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.711 Vali Acc: 0.214 Test Loss: 3.711 Test Acc: 0.214
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.983346700668335
Epoch: 61, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.761 Vali Acc: 0.211 Test Loss: 3.761 Test Acc: 0.211
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 2.0325520038604736
Epoch: 62, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.714 Vali Acc: 0.214 Test Loss: 3.714 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.8509798049926758
Epoch: 63, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.830 Vali Acc: 0.219 Test Loss: 3.830 Test Acc: 0.219
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.7438280582427979
Epoch: 64, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.805 Vali Acc: 0.207 Test Loss: 3.805 Test Acc: 0.207
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2211764705882353
model parameter : 764438
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.181431770324707
Epoch: 1, Steps: 10 | Train Loss: 3.357 Vali Loss: 3.311 Vali Acc: 0.046 Test Loss: 3.311 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 2.771662712097168
Epoch: 2, Steps: 10 | Train Loss: 3.265 Vali Loss: 3.305 Vali Acc: 0.059 Test Loss: 3.305 Test Acc: 0.059
Validation loss decreased (-0.045849 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 2.178894281387329
Epoch: 3, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.309 Vali Acc: 0.047 Test Loss: 3.309 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3920602798461914
Epoch: 4, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.318 Vali Acc: 0.046 Test Loss: 3.318 Test Acc: 0.046
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.049532890319824
Epoch: 5, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.313 Vali Acc: 0.055 Test Loss: 3.313 Test Acc: 0.055
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.008402109146118
Epoch: 6, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.324 Vali Acc: 0.040 Test Loss: 3.324 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2664854526519775
Epoch: 7, Steps: 10 | Train Loss: 3.172 Vali Loss: 3.310 Vali Acc: 0.051 Test Loss: 3.310 Test Acc: 0.051
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.086815118789673
Epoch: 8, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.313 Vali Acc: 0.059 Test Loss: 3.313 Test Acc: 0.059
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0509612560272217
Epoch: 9, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.327 Vali Acc: 0.047 Test Loss: 3.327 Test Acc: 0.047
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1582717895507812
Epoch: 10, Steps: 10 | Train Loss: 3.098 Vali Loss: 3.314 Vali Acc: 0.058 Test Loss: 3.314 Test Acc: 0.058
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.150054693222046
Epoch: 11, Steps: 10 | Train Loss: 3.019 Vali Loss: 3.289 Vali Acc: 0.064 Test Loss: 3.289 Test Acc: 0.064
Validation loss decreased (-0.058790 --> -0.063497).  Saving model ...
Epoch: 12 cost time: 2.083644151687622
Epoch: 12, Steps: 10 | Train Loss: 2.946 Vali Loss: 3.284 Vali Acc: 0.081 Test Loss: 3.284 Test Acc: 0.081
Validation loss decreased (-0.063497 --> -0.081144).  Saving model ...
Epoch: 13 cost time: 1.905576229095459
Epoch: 13, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.283 Vali Acc: 0.085 Test Loss: 3.283 Test Acc: 0.085
Validation loss decreased (-0.081144 --> -0.084673).  Saving model ...
Epoch: 14 cost time: 2.058812141418457
Epoch: 14, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.262 Vali Acc: 0.095 Test Loss: 3.262 Test Acc: 0.095
Validation loss decreased (-0.084673 --> -0.095261).  Saving model ...
Epoch: 15 cost time: 1.8639483451843262
Epoch: 15, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.285 Vali Acc: 0.092 Test Loss: 3.285 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.913811445236206
Epoch: 16, Steps: 10 | Train Loss: 2.667 Vali Loss: 3.263 Vali Acc: 0.093 Test Loss: 3.263 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1873795986175537
Epoch: 17, Steps: 10 | Train Loss: 2.577 Vali Loss: 3.252 Vali Acc: 0.104 Test Loss: 3.252 Test Acc: 0.104
Validation loss decreased (-0.095261 --> -0.103497).  Saving model ...
Epoch: 18 cost time: 1.8378167152404785
Epoch: 18, Steps: 10 | Train Loss: 2.558 Vali Loss: 3.248 Vali Acc: 0.111 Test Loss: 3.248 Test Acc: 0.111
Validation loss decreased (-0.103497 --> -0.110556).  Saving model ...
Epoch: 19 cost time: 2.046900987625122
Epoch: 19, Steps: 10 | Train Loss: 2.509 Vali Loss: 3.247 Vali Acc: 0.120 Test Loss: 3.247 Test Acc: 0.120
Validation loss decreased (-0.110556 --> -0.119968).  Saving model ...
Epoch: 20 cost time: 1.9376065731048584
Epoch: 20, Steps: 10 | Train Loss: 2.419 Vali Loss: 3.243 Vali Acc: 0.118 Test Loss: 3.243 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0770394802093506
Epoch: 21, Steps: 10 | Train Loss: 2.307 Vali Loss: 3.209 Vali Acc: 0.124 Test Loss: 3.209 Test Acc: 0.124
Validation loss decreased (-0.119968 --> -0.123497).  Saving model ...
Epoch: 22 cost time: 2.5514841079711914
Epoch: 22, Steps: 10 | Train Loss: 2.298 Vali Loss: 3.241 Vali Acc: 0.119 Test Loss: 3.241 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.228672504425049
Epoch: 23, Steps: 10 | Train Loss: 2.260 Vali Loss: 3.225 Vali Acc: 0.120 Test Loss: 3.225 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0372073650360107
Epoch: 24, Steps: 10 | Train Loss: 2.150 Vali Loss: 3.213 Vali Acc: 0.122 Test Loss: 3.213 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.033790349960327
Epoch: 25, Steps: 10 | Train Loss: 2.066 Vali Loss: 3.225 Vali Acc: 0.124 Test Loss: 3.225 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0161657333374023
Epoch: 26, Steps: 10 | Train Loss: 1.986 Vali Loss: 3.204 Vali Acc: 0.128 Test Loss: 3.204 Test Acc: 0.128
Validation loss decreased (-0.123497 --> -0.128203).  Saving model ...
Epoch: 27 cost time: 1.9617865085601807
Epoch: 27, Steps: 10 | Train Loss: 1.993 Vali Loss: 3.245 Vali Acc: 0.126 Test Loss: 3.245 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.160524606704712
Epoch: 28, Steps: 10 | Train Loss: 1.924 Vali Loss: 3.228 Vali Acc: 0.133 Test Loss: 3.228 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 29 cost time: 2.2906453609466553
Epoch: 29, Steps: 10 | Train Loss: 1.772 Vali Loss: 3.224 Vali Acc: 0.134 Test Loss: 3.224 Test Acc: 0.134
Validation loss decreased (-0.132909 --> -0.134085).  Saving model ...
Epoch: 30 cost time: 1.7297492027282715
Epoch: 30, Steps: 10 | Train Loss: 1.756 Vali Loss: 3.254 Vali Acc: 0.147 Test Loss: 3.254 Test Acc: 0.147
Validation loss decreased (-0.134085 --> -0.147026).  Saving model ...
Epoch: 31 cost time: 1.7407829761505127
Epoch: 31, Steps: 10 | Train Loss: 1.704 Vali Loss: 3.237 Vali Acc: 0.142 Test Loss: 3.237 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8438563346862793
Epoch: 32, Steps: 10 | Train Loss: 1.660 Vali Loss: 3.269 Vali Acc: 0.144 Test Loss: 3.269 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.791773796081543
Epoch: 33, Steps: 10 | Train Loss: 1.580 Vali Loss: 3.221 Vali Acc: 0.156 Test Loss: 3.221 Test Acc: 0.156
Validation loss decreased (-0.147026 --> -0.156438).  Saving model ...
Epoch: 34 cost time: 1.7057268619537354
Epoch: 34, Steps: 10 | Train Loss: 1.437 Vali Loss: 3.219 Vali Acc: 0.172 Test Loss: 3.219 Test Acc: 0.172
Validation loss decreased (-0.156438 --> -0.171733).  Saving model ...
Epoch: 35 cost time: 1.651334524154663
Epoch: 35, Steps: 10 | Train Loss: 1.449 Vali Loss: 3.240 Vali Acc: 0.152 Test Loss: 3.240 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.122483491897583
Epoch: 36, Steps: 10 | Train Loss: 1.386 Vali Loss: 3.260 Vali Acc: 0.162 Test Loss: 3.260 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7895305156707764
Epoch: 37, Steps: 10 | Train Loss: 1.378 Vali Loss: 3.258 Vali Acc: 0.165 Test Loss: 3.258 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.49949312210083
Epoch: 38, Steps: 10 | Train Loss: 1.269 Vali Loss: 3.295 Vali Acc: 0.164 Test Loss: 3.295 Test Acc: 0.164
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.9345955848693848
Epoch: 39, Steps: 10 | Train Loss: 1.172 Vali Loss: 3.248 Vali Acc: 0.156 Test Loss: 3.248 Test Acc: 0.156
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.2684261798858643
Epoch: 40, Steps: 10 | Train Loss: 1.093 Vali Loss: 3.237 Vali Acc: 0.184 Test Loss: 3.237 Test Acc: 0.184
Validation loss decreased (-0.171733 --> -0.183497).  Saving model ...
Epoch: 41 cost time: 1.9626672267913818
Epoch: 41, Steps: 10 | Train Loss: 1.043 Vali Loss: 3.249 Vali Acc: 0.186 Test Loss: 3.249 Test Acc: 0.186
Validation loss decreased (-0.183497 --> -0.185850).  Saving model ...
Epoch: 42 cost time: 2.0092577934265137
Epoch: 42, Steps: 10 | Train Loss: 0.973 Vali Loss: 3.283 Vali Acc: 0.187 Test Loss: 3.283 Test Acc: 0.187
Validation loss decreased (-0.185850 --> -0.187026).  Saving model ...
Epoch: 43 cost time: 1.963268518447876
Epoch: 43, Steps: 10 | Train Loss: 0.936 Vali Loss: 3.237 Vali Acc: 0.188 Test Loss: 3.237 Test Acc: 0.188
Validation loss decreased (-0.187026 --> -0.188203).  Saving model ...
Epoch: 44 cost time: 2.1893019676208496
Epoch: 44, Steps: 10 | Train Loss: 0.813 Vali Loss: 3.311 Vali Acc: 0.201 Test Loss: 3.311 Test Acc: 0.201
Validation loss decreased (-0.188203 --> -0.201143).  Saving model ...
Epoch: 45 cost time: 2.0260791778564453
Epoch: 45, Steps: 10 | Train Loss: 0.795 Vali Loss: 3.301 Vali Acc: 0.179 Test Loss: 3.301 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.3893654346466064
Epoch: 46, Steps: 10 | Train Loss: 0.733 Vali Loss: 3.275 Vali Acc: 0.209 Test Loss: 3.275 Test Acc: 0.209
Validation loss decreased (-0.201143 --> -0.209379).  Saving model ...
Epoch: 47 cost time: 1.8244330883026123
Epoch: 47, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.360 Vali Acc: 0.195 Test Loss: 3.360 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.868396520614624
Epoch: 48, Steps: 10 | Train Loss: 0.658 Vali Loss: 3.382 Vali Acc: 0.198 Test Loss: 3.382 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.5910875797271729
Epoch: 49, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.347 Vali Acc: 0.211 Test Loss: 3.347 Test Acc: 0.211
Validation loss decreased (-0.209379 --> -0.210555).  Saving model ...
Epoch: 50 cost time: 1.906954288482666
Epoch: 50, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.366 Vali Acc: 0.202 Test Loss: 3.366 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.7606570720672607
Epoch: 51, Steps: 10 | Train Loss: 0.500 Vali Loss: 3.392 Vali Acc: 0.212 Test Loss: 3.392 Test Acc: 0.212
Validation loss decreased (-0.210555 --> -0.211731).  Saving model ...
Epoch: 52 cost time: 1.984140157699585
Epoch: 52, Steps: 10 | Train Loss: 0.426 Vali Loss: 3.393 Vali Acc: 0.205 Test Loss: 3.393 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.8921427726745605
Epoch: 53, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.453 Vali Acc: 0.208 Test Loss: 3.453 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.7389304637908936
Epoch: 54, Steps: 10 | Train Loss: 0.372 Vali Loss: 3.417 Vali Acc: 0.207 Test Loss: 3.417 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.355125904083252
Epoch: 55, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.491 Vali Acc: 0.207 Test Loss: 3.491 Test Acc: 0.207
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 2.259809732437134
Epoch: 56, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.468 Vali Acc: 0.226 Test Loss: 3.468 Test Acc: 0.226
Validation loss decreased (-0.211731 --> -0.225848).  Saving model ...
Epoch: 57 cost time: 1.9232492446899414
Epoch: 57, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.552 Vali Acc: 0.195 Test Loss: 3.552 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.0545265674591064
Epoch: 58, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.483 Vali Acc: 0.219 Test Loss: 3.483 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.174283027648926
Epoch: 59, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.577 Vali Acc: 0.226 Test Loss: 3.577 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 2.0880258083343506
Epoch: 60, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.573 Vali Acc: 0.226 Test Loss: 3.573 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.718038558959961
Epoch: 61, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.571 Vali Acc: 0.224 Test Loss: 3.571 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 2.1205074787139893
Epoch: 62, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.604 Vali Acc: 0.213 Test Loss: 3.604 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.902176856994629
Epoch: 63, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.667 Vali Acc: 0.225 Test Loss: 3.667 Test Acc: 0.225
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 2.5962958335876465
Epoch: 64, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.636 Vali Acc: 0.214 Test Loss: 3.636 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 2.1461234092712402
Epoch: 65, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.582 Vali Acc: 0.229 Test Loss: 3.582 Test Acc: 0.229
Validation loss decreased (-0.225848 --> -0.229376).  Saving model ...
Epoch: 66 cost time: 1.9785358905792236
Epoch: 66, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.672 Vali Acc: 0.240 Test Loss: 3.672 Test Acc: 0.240
Validation loss decreased (-0.229376 --> -0.239963).  Saving model ...
Epoch: 67 cost time: 1.7890143394470215
Epoch: 67, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.635 Vali Acc: 0.232 Test Loss: 3.635 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.9671216011047363
Epoch: 68, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.725 Vali Acc: 0.233 Test Loss: 3.725 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 2.224709987640381
Epoch: 69, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.717 Vali Acc: 0.233 Test Loss: 3.717 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.9242234230041504
Epoch: 70, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.708 Vali Acc: 0.228 Test Loss: 3.708 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.9259943962097168
Epoch: 71, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.768 Vali Acc: 0.232 Test Loss: 3.768 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 2.166663408279419
Epoch: 72, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.745 Vali Acc: 0.232 Test Loss: 3.745 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 2.050032615661621
Epoch: 73, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.786 Vali Acc: 0.224 Test Loss: 3.786 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.724527359008789
Epoch: 74, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.768 Vali Acc: 0.233 Test Loss: 3.768 Test Acc: 0.233
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.759723424911499
Epoch: 75, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.793 Vali Acc: 0.236 Test Loss: 3.793 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.7776720523834229
Epoch: 76, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.834 Vali Acc: 0.232 Test Loss: 3.834 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24
model parameter : 467414
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.5387794971466064
Epoch: 1, Steps: 10 | Train Loss: 3.468 Vali Loss: 3.380 Vali Acc: 0.044 Test Loss: 3.380 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.7883379459381104
Epoch: 2, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.319 Vali Acc: 0.039 Test Loss: 3.319 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.057936429977417
Epoch: 3, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.305 Vali Acc: 0.049 Test Loss: 3.305 Test Acc: 0.049
Validation loss decreased (-0.043496 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 2.0553581714630127
Epoch: 4, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.319 Vali Acc: 0.045 Test Loss: 3.319 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4705536365509033
Epoch: 5, Steps: 10 | Train Loss: 3.194 Vali Loss: 3.321 Vali Acc: 0.054 Test Loss: 3.321 Test Acc: 0.054
Validation loss decreased (-0.049379 --> -0.054084).  Saving model ...
Epoch: 6 cost time: 1.621324062347412
Epoch: 6, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.312 Vali Acc: 0.066 Test Loss: 3.312 Test Acc: 0.066
Validation loss decreased (-0.054084 --> -0.065849).  Saving model ...
Epoch: 7 cost time: 2.3345868587493896
Epoch: 7, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.315 Vali Acc: 0.065 Test Loss: 3.315 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0503666400909424
Epoch: 8, Steps: 10 | Train Loss: 3.098 Vali Loss: 3.306 Vali Acc: 0.054 Test Loss: 3.306 Test Acc: 0.054
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8927381038665771
Epoch: 9, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.310 Vali Acc: 0.069 Test Loss: 3.310 Test Acc: 0.069
Validation loss decreased (-0.065849 --> -0.069379).  Saving model ...
Epoch: 10 cost time: 2.1063005924224854
Epoch: 10, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.301 Vali Acc: 0.076 Test Loss: 3.301 Test Acc: 0.076
Validation loss decreased (-0.069379 --> -0.076438).  Saving model ...
Epoch: 11 cost time: 1.8856573104858398
Epoch: 11, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.294 Vali Acc: 0.081 Test Loss: 3.294 Test Acc: 0.081
Validation loss decreased (-0.076438 --> -0.081144).  Saving model ...
Epoch: 12 cost time: 1.754077672958374
Epoch: 12, Steps: 10 | Train Loss: 2.864 Vali Loss: 3.291 Vali Acc: 0.100 Test Loss: 3.291 Test Acc: 0.100
Validation loss decreased (-0.081144 --> -0.099967).  Saving model ...
Epoch: 13 cost time: 1.627624750137329
Epoch: 13, Steps: 10 | Train Loss: 2.849 Vali Loss: 3.298 Vali Acc: 0.100 Test Loss: 3.298 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.578732490539551
Epoch: 14, Steps: 10 | Train Loss: 2.726 Vali Loss: 3.284 Vali Acc: 0.095 Test Loss: 3.284 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8564999103546143
Epoch: 15, Steps: 10 | Train Loss: 2.659 Vali Loss: 3.279 Vali Acc: 0.102 Test Loss: 3.279 Test Acc: 0.102
Validation loss decreased (-0.099967 --> -0.102320).  Saving model ...
Epoch: 16 cost time: 2.6946299076080322
Epoch: 16, Steps: 10 | Train Loss: 2.575 Vali Loss: 3.287 Vali Acc: 0.107 Test Loss: 3.287 Test Acc: 0.107
Validation loss decreased (-0.102320 --> -0.107026).  Saving model ...
Epoch: 17 cost time: 2.539257526397705
Epoch: 17, Steps: 10 | Train Loss: 2.497 Vali Loss: 3.268 Vali Acc: 0.112 Test Loss: 3.268 Test Acc: 0.112
Validation loss decreased (-0.107026 --> -0.111732).  Saving model ...
Epoch: 18 cost time: 2.2907214164733887
Epoch: 18, Steps: 10 | Train Loss: 2.499 Vali Loss: 3.277 Vali Acc: 0.122 Test Loss: 3.277 Test Acc: 0.122
Validation loss decreased (-0.111732 --> -0.122320).  Saving model ...
Epoch: 19 cost time: 2.193047523498535
Epoch: 19, Steps: 10 | Train Loss: 2.341 Vali Loss: 3.238 Vali Acc: 0.139 Test Loss: 3.238 Test Acc: 0.139
Validation loss decreased (-0.122320 --> -0.138791).  Saving model ...
Epoch: 20 cost time: 1.9630639553070068
Epoch: 20, Steps: 10 | Train Loss: 2.336 Vali Loss: 3.254 Vali Acc: 0.127 Test Loss: 3.254 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.073859930038452
Epoch: 21, Steps: 10 | Train Loss: 2.216 Vali Loss: 3.235 Vali Acc: 0.134 Test Loss: 3.235 Test Acc: 0.134
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8700506687164307
Epoch: 22, Steps: 10 | Train Loss: 2.147 Vali Loss: 3.214 Vali Acc: 0.146 Test Loss: 3.214 Test Acc: 0.146
Validation loss decreased (-0.138791 --> -0.145850).  Saving model ...
Epoch: 23 cost time: 1.8302581310272217
Epoch: 23, Steps: 10 | Train Loss: 2.140 Vali Loss: 3.215 Vali Acc: 0.151 Test Loss: 3.215 Test Acc: 0.151
Validation loss decreased (-0.145850 --> -0.150556).  Saving model ...
Epoch: 24 cost time: 1.8046622276306152
Epoch: 24, Steps: 10 | Train Loss: 2.018 Vali Loss: 3.199 Vali Acc: 0.147 Test Loss: 3.199 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4056098461151123
Epoch: 25, Steps: 10 | Train Loss: 2.021 Vali Loss: 3.207 Vali Acc: 0.147 Test Loss: 3.207 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6878550052642822
Epoch: 26, Steps: 10 | Train Loss: 1.806 Vali Loss: 3.188 Vali Acc: 0.156 Test Loss: 3.188 Test Acc: 0.156
Validation loss decreased (-0.150556 --> -0.156439).  Saving model ...
Epoch: 27 cost time: 1.4983255863189697
Epoch: 27, Steps: 10 | Train Loss: 1.793 Vali Loss: 3.194 Vali Acc: 0.145 Test Loss: 3.194 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.619013786315918
Epoch: 28, Steps: 10 | Train Loss: 1.736 Vali Loss: 3.194 Vali Acc: 0.162 Test Loss: 3.194 Test Acc: 0.162
Validation loss decreased (-0.156439 --> -0.162321).  Saving model ...
Epoch: 29 cost time: 2.0257155895233154
Epoch: 29, Steps: 10 | Train Loss: 1.631 Vali Loss: 3.194 Vali Acc: 0.165 Test Loss: 3.194 Test Acc: 0.165
Validation loss decreased (-0.162321 --> -0.164674).  Saving model ...
Epoch: 30 cost time: 1.6281933784484863
Epoch: 30, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.203 Vali Acc: 0.165 Test Loss: 3.203 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2336184978485107
Epoch: 31, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.201 Vali Acc: 0.174 Test Loss: 3.201 Test Acc: 0.174
Validation loss decreased (-0.164674 --> -0.174086).  Saving model ...
Epoch: 32 cost time: 2.197615385055542
Epoch: 32, Steps: 10 | Train Loss: 1.393 Vali Loss: 3.189 Vali Acc: 0.162 Test Loss: 3.189 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.2219181060791016
Epoch: 33, Steps: 10 | Train Loss: 1.335 Vali Loss: 3.231 Vali Acc: 0.167 Test Loss: 3.231 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.1625919342041016
Epoch: 34, Steps: 10 | Train Loss: 1.275 Vali Loss: 3.221 Vali Acc: 0.174 Test Loss: 3.221 Test Acc: 0.174
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8214669227600098
Epoch: 35, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.196 Vali Acc: 0.176 Test Loss: 3.196 Test Acc: 0.176
Validation loss decreased (-0.174086 --> -0.176439).  Saving model ...
Epoch: 36 cost time: 1.997208595275879
Epoch: 36, Steps: 10 | Train Loss: 1.172 Vali Loss: 3.174 Vali Acc: 0.194 Test Loss: 3.174 Test Acc: 0.194
Validation loss decreased (-0.176439 --> -0.194086).  Saving model ...
Epoch: 37 cost time: 2.455324172973633
Epoch: 37, Steps: 10 | Train Loss: 1.121 Vali Loss: 3.173 Vali Acc: 0.196 Test Loss: 3.173 Test Acc: 0.196
Validation loss decreased (-0.194086 --> -0.196439).  Saving model ...
Epoch: 38 cost time: 2.1290745735168457
Epoch: 38, Steps: 10 | Train Loss: 1.005 Vali Loss: 3.243 Vali Acc: 0.192 Test Loss: 3.243 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.191068172454834
Epoch: 39, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.275 Vali Acc: 0.180 Test Loss: 3.275 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.0215489864349365
Epoch: 40, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.232 Vali Acc: 0.196 Test Loss: 3.232 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8598885536193848
Epoch: 41, Steps: 10 | Train Loss: 0.864 Vali Loss: 3.211 Vali Acc: 0.209 Test Loss: 3.211 Test Acc: 0.209
Validation loss decreased (-0.196439 --> -0.209380).  Saving model ...
Epoch: 42 cost time: 1.9966614246368408
Epoch: 42, Steps: 10 | Train Loss: 0.759 Vali Loss: 3.215 Vali Acc: 0.207 Test Loss: 3.215 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.859344482421875
Epoch: 43, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.208 Vali Acc: 0.208 Test Loss: 3.208 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.9032213687896729
Epoch: 44, Steps: 10 | Train Loss: 0.645 Vali Loss: 3.283 Vali Acc: 0.213 Test Loss: 3.283 Test Acc: 0.213
Validation loss decreased (-0.209380 --> -0.212908).  Saving model ...
Epoch: 45 cost time: 2.191514015197754
Epoch: 45, Steps: 10 | Train Loss: 0.615 Vali Loss: 3.222 Vali Acc: 0.196 Test Loss: 3.222 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.983966588973999
Epoch: 46, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.315 Vali Acc: 0.201 Test Loss: 3.315 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.29150652885437
Epoch: 47, Steps: 10 | Train Loss: 0.575 Vali Loss: 3.257 Vali Acc: 0.206 Test Loss: 3.257 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.154268980026245
Epoch: 48, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.286 Vali Acc: 0.224 Test Loss: 3.286 Test Acc: 0.224
Validation loss decreased (-0.212908 --> -0.223497).  Saving model ...
Epoch: 49 cost time: 1.8506557941436768
Epoch: 49, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.303 Vali Acc: 0.207 Test Loss: 3.303 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.2854082584381104
Epoch: 50, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.340 Vali Acc: 0.212 Test Loss: 3.340 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.6950342655181885
Epoch: 51, Steps: 10 | Train Loss: 0.354 Vali Loss: 3.344 Vali Acc: 0.215 Test Loss: 3.344 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.784339427947998
Epoch: 52, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.330 Vali Acc: 0.206 Test Loss: 3.330 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.910677194595337
Epoch: 53, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.369 Vali Acc: 0.229 Test Loss: 3.369 Test Acc: 0.229
Validation loss decreased (-0.223497 --> -0.229378).  Saving model ...
Epoch: 54 cost time: 1.8358986377716064
Epoch: 54, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.436 Vali Acc: 0.214 Test Loss: 3.436 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.0348286628723145
Epoch: 55, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.365 Vali Acc: 0.222 Test Loss: 3.365 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.039912462234497
Epoch: 56, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.476 Vali Acc: 0.219 Test Loss: 3.476 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.1290109157562256
Epoch: 57, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.521 Vali Acc: 0.211 Test Loss: 3.521 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.9167921543121338
Epoch: 58, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.615 Vali Acc: 0.215 Test Loss: 3.615 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.7698345184326172
Epoch: 59, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.516 Vali Acc: 0.215 Test Loss: 3.516 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.9025208950042725
Epoch: 60, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.507 Vali Acc: 0.220 Test Loss: 3.507 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.9965722560882568
Epoch: 61, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.512 Vali Acc: 0.225 Test Loss: 3.512 Test Acc: 0.225
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.890089511871338
Epoch: 62, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.601 Vali Acc: 0.208 Test Loss: 3.601 Test Acc: 0.208
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.7517626285552979
Epoch: 63, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.578 Vali Acc: 0.224 Test Loss: 3.578 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22941176470588234
model parameter : 466582
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.71508526802063
Epoch: 1, Steps: 10 | Train Loss: 3.366 Vali Loss: 3.348 Vali Acc: 0.048 Test Loss: 3.348 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 2.0152077674865723
Epoch: 2, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.317 Vali Acc: 0.046 Test Loss: 3.317 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2233400344848633
Epoch: 3, Steps: 10 | Train Loss: 3.266 Vali Loss: 3.315 Vali Acc: 0.061 Test Loss: 3.315 Test Acc: 0.061
Validation loss decreased (-0.048202 --> -0.061143).  Saving model ...
Epoch: 4 cost time: 2.1550350189208984
Epoch: 4, Steps: 10 | Train Loss: 3.200 Vali Loss: 3.319 Vali Acc: 0.044 Test Loss: 3.319 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8374419212341309
Epoch: 5, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.328 Vali Acc: 0.051 Test Loss: 3.328 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0316660404205322
Epoch: 6, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.345 Vali Acc: 0.049 Test Loss: 3.345 Test Acc: 0.049
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2033491134643555
Epoch: 7, Steps: 10 | Train Loss: 3.125 Vali Loss: 3.330 Vali Acc: 0.055 Test Loss: 3.330 Test Acc: 0.055
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3433749675750732
Epoch: 8, Steps: 10 | Train Loss: 3.059 Vali Loss: 3.313 Vali Acc: 0.051 Test Loss: 3.313 Test Acc: 0.051
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.233259916305542
Epoch: 9, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.310 Vali Acc: 0.062 Test Loss: 3.310 Test Acc: 0.062
Validation loss decreased (-0.061143 --> -0.062320).  Saving model ...
Epoch: 10 cost time: 2.1845295429229736
Epoch: 10, Steps: 10 | Train Loss: 2.961 Vali Loss: 3.303 Vali Acc: 0.067 Test Loss: 3.303 Test Acc: 0.067
Validation loss decreased (-0.062320 --> -0.067026).  Saving model ...
Epoch: 11 cost time: 1.8907768726348877
Epoch: 11, Steps: 10 | Train Loss: 2.877 Vali Loss: 3.301 Vali Acc: 0.060 Test Loss: 3.301 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0436320304870605
Epoch: 12, Steps: 10 | Train Loss: 2.782 Vali Loss: 3.292 Vali Acc: 0.075 Test Loss: 3.292 Test Acc: 0.075
Validation loss decreased (-0.067026 --> -0.075261).  Saving model ...
Epoch: 13 cost time: 1.660966157913208
Epoch: 13, Steps: 10 | Train Loss: 2.778 Vali Loss: 3.275 Vali Acc: 0.081 Test Loss: 3.275 Test Acc: 0.081
Validation loss decreased (-0.075261 --> -0.081144).  Saving model ...
Epoch: 14 cost time: 1.5884027481079102
Epoch: 14, Steps: 10 | Train Loss: 2.685 Vali Loss: 3.306 Vali Acc: 0.079 Test Loss: 3.306 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7773895263671875
Epoch: 15, Steps: 10 | Train Loss: 2.620 Vali Loss: 3.292 Vali Acc: 0.092 Test Loss: 3.292 Test Acc: 0.092
Validation loss decreased (-0.081144 --> -0.091732).  Saving model ...
Epoch: 16 cost time: 2.186445951461792
Epoch: 16, Steps: 10 | Train Loss: 2.513 Vali Loss: 3.269 Vali Acc: 0.094 Test Loss: 3.269 Test Acc: 0.094
Validation loss decreased (-0.091732 --> -0.094085).  Saving model ...
Epoch: 17 cost time: 1.8262488842010498
Epoch: 17, Steps: 10 | Train Loss: 2.488 Vali Loss: 3.270 Vali Acc: 0.102 Test Loss: 3.270 Test Acc: 0.102
Validation loss decreased (-0.094085 --> -0.102320).  Saving model ...
Epoch: 18 cost time: 2.3630173206329346
Epoch: 18, Steps: 10 | Train Loss: 2.471 Vali Loss: 3.259 Vali Acc: 0.112 Test Loss: 3.259 Test Acc: 0.112
Validation loss decreased (-0.102320 --> -0.111732).  Saving model ...
Epoch: 19 cost time: 2.508047580718994
Epoch: 19, Steps: 10 | Train Loss: 2.383 Vali Loss: 3.267 Vali Acc: 0.112 Test Loss: 3.267 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9758427143096924
Epoch: 20, Steps: 10 | Train Loss: 2.287 Vali Loss: 3.246 Vali Acc: 0.115 Test Loss: 3.246 Test Acc: 0.115
Validation loss decreased (-0.111732 --> -0.115262).  Saving model ...
Epoch: 21 cost time: 2.0849616527557373
Epoch: 21, Steps: 10 | Train Loss: 2.256 Vali Loss: 3.255 Vali Acc: 0.115 Test Loss: 3.255 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3256313800811768
Epoch: 22, Steps: 10 | Train Loss: 2.179 Vali Loss: 3.226 Vali Acc: 0.121 Test Loss: 3.226 Test Acc: 0.121
Validation loss decreased (-0.115262 --> -0.121144).  Saving model ...
Epoch: 23 cost time: 2.2164089679718018
Epoch: 23, Steps: 10 | Train Loss: 2.030 Vali Loss: 3.235 Vali Acc: 0.129 Test Loss: 3.235 Test Acc: 0.129
Validation loss decreased (-0.121144 --> -0.129379).  Saving model ...
Epoch: 24 cost time: 2.0599842071533203
Epoch: 24, Steps: 10 | Train Loss: 2.037 Vali Loss: 3.232 Vali Acc: 0.142 Test Loss: 3.232 Test Acc: 0.142
Validation loss decreased (-0.129379 --> -0.142321).  Saving model ...
Epoch: 25 cost time: 2.07009220123291
Epoch: 25, Steps: 10 | Train Loss: 1.889 Vali Loss: 3.207 Vali Acc: 0.136 Test Loss: 3.207 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7896780967712402
Epoch: 26, Steps: 10 | Train Loss: 1.874 Vali Loss: 3.208 Vali Acc: 0.146 Test Loss: 3.208 Test Acc: 0.146
Validation loss decreased (-0.142321 --> -0.145850).  Saving model ...
Epoch: 27 cost time: 2.39727783203125
Epoch: 27, Steps: 10 | Train Loss: 1.800 Vali Loss: 3.231 Vali Acc: 0.141 Test Loss: 3.231 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0463337898254395
Epoch: 28, Steps: 10 | Train Loss: 1.732 Vali Loss: 3.170 Vali Acc: 0.144 Test Loss: 3.170 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.9324805736541748
Epoch: 29, Steps: 10 | Train Loss: 1.699 Vali Loss: 3.237 Vali Acc: 0.149 Test Loss: 3.237 Test Acc: 0.149
Validation loss decreased (-0.145850 --> -0.149379).  Saving model ...
Epoch: 30 cost time: 2.1168055534362793
Epoch: 30, Steps: 10 | Train Loss: 1.606 Vali Loss: 3.214 Vali Acc: 0.159 Test Loss: 3.214 Test Acc: 0.159
Validation loss decreased (-0.149379 --> -0.158791).  Saving model ...
Epoch: 31 cost time: 2.1932363510131836
Epoch: 31, Steps: 10 | Train Loss: 1.550 Vali Loss: 3.221 Vali Acc: 0.151 Test Loss: 3.221 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.946671724319458
Epoch: 32, Steps: 10 | Train Loss: 1.481 Vali Loss: 3.222 Vali Acc: 0.168 Test Loss: 3.222 Test Acc: 0.168
Validation loss decreased (-0.158791 --> -0.168203).  Saving model ...
Epoch: 33 cost time: 2.175889253616333
Epoch: 33, Steps: 10 | Train Loss: 1.368 Vali Loss: 3.246 Vali Acc: 0.159 Test Loss: 3.246 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.027942419052124
Epoch: 34, Steps: 10 | Train Loss: 1.272 Vali Loss: 3.243 Vali Acc: 0.168 Test Loss: 3.243 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.033844470977783
Epoch: 35, Steps: 10 | Train Loss: 1.305 Vali Loss: 3.294 Vali Acc: 0.166 Test Loss: 3.294 Test Acc: 0.166
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.1743574142456055
Epoch: 36, Steps: 10 | Train Loss: 1.194 Vali Loss: 3.227 Vali Acc: 0.171 Test Loss: 3.227 Test Acc: 0.171
Validation loss decreased (-0.168203 --> -0.170556).  Saving model ...
Epoch: 37 cost time: 2.534418821334839
Epoch: 37, Steps: 10 | Train Loss: 1.097 Vali Loss: 3.267 Vali Acc: 0.173 Test Loss: 3.267 Test Acc: 0.173
Validation loss decreased (-0.170556 --> -0.172909).  Saving model ...
Epoch: 38 cost time: 2.1466848850250244
Epoch: 38, Steps: 10 | Train Loss: 1.065 Vali Loss: 3.280 Vali Acc: 0.175 Test Loss: 3.280 Test Acc: 0.175
Validation loss decreased (-0.172909 --> -0.175261).  Saving model ...
Epoch: 39 cost time: 1.921966791152954
Epoch: 39, Steps: 10 | Train Loss: 0.994 Vali Loss: 3.289 Vali Acc: 0.181 Test Loss: 3.289 Test Acc: 0.181
Validation loss decreased (-0.175261 --> -0.181144).  Saving model ...
Epoch: 40 cost time: 1.7696590423583984
Epoch: 40, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.266 Vali Acc: 0.188 Test Loss: 3.266 Test Acc: 0.188
Validation loss decreased (-0.181144 --> -0.188203).  Saving model ...
Epoch: 41 cost time: 1.9963080883026123
Epoch: 41, Steps: 10 | Train Loss: 0.827 Vali Loss: 3.333 Vali Acc: 0.176 Test Loss: 3.333 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.0109150409698486
Epoch: 42, Steps: 10 | Train Loss: 0.792 Vali Loss: 3.286 Vali Acc: 0.191 Test Loss: 3.286 Test Acc: 0.191
Validation loss decreased (-0.188203 --> -0.190555).  Saving model ...
Epoch: 43 cost time: 1.6997365951538086
Epoch: 43, Steps: 10 | Train Loss: 0.768 Vali Loss: 3.366 Vali Acc: 0.171 Test Loss: 3.366 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.5272207260131836
Epoch: 44, Steps: 10 | Train Loss: 0.705 Vali Loss: 3.323 Vali Acc: 0.182 Test Loss: 3.323 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.6084675788879395
Epoch: 45, Steps: 10 | Train Loss: 0.672 Vali Loss: 3.341 Vali Acc: 0.175 Test Loss: 3.341 Test Acc: 0.175
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.7218313217163086
Epoch: 46, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.358 Vali Acc: 0.187 Test Loss: 3.358 Test Acc: 0.187
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.7594928741455078
Epoch: 47, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.417 Vali Acc: 0.182 Test Loss: 3.417 Test Acc: 0.182
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.880373239517212
Epoch: 48, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.367 Vali Acc: 0.186 Test Loss: 3.367 Test Acc: 0.186
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.9036188125610352
Epoch: 49, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.349 Vali Acc: 0.196 Test Loss: 3.349 Test Acc: 0.196
Validation loss decreased (-0.190555 --> -0.196437).  Saving model ...
Epoch: 50 cost time: 2.0488462448120117
Epoch: 50, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.466 Vali Acc: 0.192 Test Loss: 3.466 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.8624114990234375
Epoch: 51, Steps: 10 | Train Loss: 0.427 Vali Loss: 3.411 Vali Acc: 0.200 Test Loss: 3.411 Test Acc: 0.200
Validation loss decreased (-0.196437 --> -0.199966).  Saving model ...
Epoch: 52 cost time: 1.7562875747680664
Epoch: 52, Steps: 10 | Train Loss: 0.383 Vali Loss: 3.427 Vali Acc: 0.198 Test Loss: 3.427 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.594303607940674
Epoch: 53, Steps: 10 | Train Loss: 0.347 Vali Loss: 3.447 Vali Acc: 0.212 Test Loss: 3.447 Test Acc: 0.212
Validation loss decreased (-0.199966 --> -0.211730).  Saving model ...
Epoch: 54 cost time: 2.0826549530029297
Epoch: 54, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.438 Vali Acc: 0.201 Test Loss: 3.438 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.871541976928711
Epoch: 55, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.473 Vali Acc: 0.199 Test Loss: 3.473 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.8700976371765137
Epoch: 56, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.497 Vali Acc: 0.202 Test Loss: 3.497 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.9165410995483398
Epoch: 57, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.512 Vali Acc: 0.196 Test Loss: 3.512 Test Acc: 0.196
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 2.3576343059539795
Epoch: 58, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.532 Vali Acc: 0.209 Test Loss: 3.532 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.208317756652832
Epoch: 59, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.661 Vali Acc: 0.198 Test Loss: 3.661 Test Acc: 0.198
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.9705088138580322
Epoch: 60, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.604 Vali Acc: 0.200 Test Loss: 3.604 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 2.1177594661712646
Epoch: 61, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.689 Vali Acc: 0.205 Test Loss: 3.689 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 2.2122225761413574
Epoch: 62, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.739 Vali Acc: 0.191 Test Loss: 3.739 Test Acc: 0.191
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.9363460540771484
Epoch: 63, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.722 Vali Acc: 0.204 Test Loss: 3.722 Test Acc: 0.204
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21176470588235294
model parameter : 465750
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.18107795715332
Epoch: 1, Steps: 10 | Train Loss: 3.420 Vali Loss: 3.373 Vali Acc: 0.044 Test Loss: 3.373 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 2.075900077819824
Epoch: 2, Steps: 10 | Train Loss: 3.359 Vali Loss: 3.322 Vali Acc: 0.042 Test Loss: 3.322 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.047008991241455
Epoch: 3, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.311 Vali Acc: 0.049 Test Loss: 3.311 Test Acc: 0.049
Validation loss decreased (-0.043496 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 1.6758441925048828
Epoch: 4, Steps: 10 | Train Loss: 3.203 Vali Loss: 3.326 Vali Acc: 0.059 Test Loss: 3.326 Test Acc: 0.059
Validation loss decreased (-0.049379 --> -0.058790).  Saving model ...
Epoch: 5 cost time: 1.7418227195739746
Epoch: 5, Steps: 10 | Train Loss: 3.196 Vali Loss: 3.342 Vali Acc: 0.056 Test Loss: 3.342 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1196413040161133
Epoch: 6, Steps: 10 | Train Loss: 3.138 Vali Loss: 3.334 Vali Acc: 0.061 Test Loss: 3.334 Test Acc: 0.061
Validation loss decreased (-0.058790 --> -0.061143).  Saving model ...
Epoch: 7 cost time: 1.8978679180145264
Epoch: 7, Steps: 10 | Train Loss: 3.107 Vali Loss: 3.321 Vali Acc: 0.068 Test Loss: 3.321 Test Acc: 0.068
Validation loss decreased (-0.061143 --> -0.068202).  Saving model ...
Epoch: 8 cost time: 1.9382333755493164
Epoch: 8, Steps: 10 | Train Loss: 3.074 Vali Loss: 3.325 Vali Acc: 0.073 Test Loss: 3.325 Test Acc: 0.073
Validation loss decreased (-0.068202 --> -0.072908).  Saving model ...
Epoch: 9 cost time: 1.7510359287261963
Epoch: 9, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.323 Vali Acc: 0.074 Test Loss: 3.323 Test Acc: 0.074
Validation loss decreased (-0.072908 --> -0.074084).  Saving model ...
Epoch: 10 cost time: 1.8110458850860596
Epoch: 10, Steps: 10 | Train Loss: 2.923 Vali Loss: 3.304 Vali Acc: 0.096 Test Loss: 3.304 Test Acc: 0.096
Validation loss decreased (-0.074084 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 2.087890386581421
Epoch: 11, Steps: 10 | Train Loss: 2.883 Vali Loss: 3.307 Vali Acc: 0.099 Test Loss: 3.307 Test Acc: 0.099
Validation loss decreased (-0.096438 --> -0.098790).  Saving model ...
Epoch: 12 cost time: 1.9547605514526367
Epoch: 12, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.288 Vali Acc: 0.105 Test Loss: 3.288 Test Acc: 0.105
Validation loss decreased (-0.098790 --> -0.104673).  Saving model ...
Epoch: 13 cost time: 1.5191240310668945
Epoch: 13, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.295 Vali Acc: 0.111 Test Loss: 3.295 Test Acc: 0.111
Validation loss decreased (-0.104673 --> -0.110555).  Saving model ...
Epoch: 14 cost time: 1.7478084564208984
Epoch: 14, Steps: 10 | Train Loss: 2.693 Vali Loss: 3.276 Vali Acc: 0.104 Test Loss: 3.276 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0844528675079346
Epoch: 15, Steps: 10 | Train Loss: 2.661 Vali Loss: 3.262 Vali Acc: 0.105 Test Loss: 3.262 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6833512783050537
Epoch: 16, Steps: 10 | Train Loss: 2.574 Vali Loss: 3.266 Vali Acc: 0.118 Test Loss: 3.266 Test Acc: 0.118
Validation loss decreased (-0.110555 --> -0.117614).  Saving model ...
Epoch: 17 cost time: 1.7574007511138916
Epoch: 17, Steps: 10 | Train Loss: 2.498 Vali Loss: 3.240 Vali Acc: 0.114 Test Loss: 3.240 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.699674367904663
Epoch: 18, Steps: 10 | Train Loss: 2.410 Vali Loss: 3.240 Vali Acc: 0.119 Test Loss: 3.240 Test Acc: 0.119
Validation loss decreased (-0.117614 --> -0.118791).  Saving model ...
Epoch: 19 cost time: 1.7549221515655518
Epoch: 19, Steps: 10 | Train Loss: 2.329 Vali Loss: 3.246 Vali Acc: 0.122 Test Loss: 3.246 Test Acc: 0.122
Validation loss decreased (-0.118791 --> -0.122320).  Saving model ...
Epoch: 20 cost time: 1.775587797164917
Epoch: 20, Steps: 10 | Train Loss: 2.290 Vali Loss: 3.223 Vali Acc: 0.127 Test Loss: 3.223 Test Acc: 0.127
Validation loss decreased (-0.122320 --> -0.127027).  Saving model ...
Epoch: 21 cost time: 1.7048935890197754
Epoch: 21, Steps: 10 | Train Loss: 2.179 Vali Loss: 3.237 Vali Acc: 0.124 Test Loss: 3.237 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5916376113891602
Epoch: 22, Steps: 10 | Train Loss: 2.133 Vali Loss: 3.228 Vali Acc: 0.128 Test Loss: 3.228 Test Acc: 0.128
Validation loss decreased (-0.127027 --> -0.128203).  Saving model ...
Epoch: 23 cost time: 1.7611510753631592
Epoch: 23, Steps: 10 | Train Loss: 2.064 Vali Loss: 3.215 Vali Acc: 0.134 Test Loss: 3.215 Test Acc: 0.134
Validation loss decreased (-0.128203 --> -0.134085).  Saving model ...
Epoch: 24 cost time: 1.9673902988433838
Epoch: 24, Steps: 10 | Train Loss: 2.048 Vali Loss: 3.207 Vali Acc: 0.144 Test Loss: 3.207 Test Acc: 0.144
Validation loss decreased (-0.134085 --> -0.143497).  Saving model ...
Epoch: 25 cost time: 1.7963707447052002
Epoch: 25, Steps: 10 | Train Loss: 1.991 Vali Loss: 3.205 Vali Acc: 0.141 Test Loss: 3.205 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5791058540344238
Epoch: 26, Steps: 10 | Train Loss: 1.874 Vali Loss: 3.183 Vali Acc: 0.153 Test Loss: 3.183 Test Acc: 0.153
Validation loss decreased (-0.143497 --> -0.152909).  Saving model ...
Epoch: 27 cost time: 1.5806496143341064
Epoch: 27, Steps: 10 | Train Loss: 1.798 Vali Loss: 3.208 Vali Acc: 0.125 Test Loss: 3.208 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8741631507873535
Epoch: 28, Steps: 10 | Train Loss: 1.713 Vali Loss: 3.175 Vali Acc: 0.142 Test Loss: 3.175 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.760801076889038
Epoch: 29, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.197 Vali Acc: 0.138 Test Loss: 3.197 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.1115989685058594
Epoch: 30, Steps: 10 | Train Loss: 1.587 Vali Loss: 3.174 Vali Acc: 0.165 Test Loss: 3.174 Test Acc: 0.165
Validation loss decreased (-0.152909 --> -0.164674).  Saving model ...
Epoch: 31 cost time: 1.6603717803955078
Epoch: 31, Steps: 10 | Train Loss: 1.505 Vali Loss: 3.145 Vali Acc: 0.156 Test Loss: 3.145 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9846398830413818
Epoch: 32, Steps: 10 | Train Loss: 1.426 Vali Loss: 3.198 Vali Acc: 0.173 Test Loss: 3.198 Test Acc: 0.173
Validation loss decreased (-0.164674 --> -0.172909).  Saving model ...
Epoch: 33 cost time: 1.8465940952301025
Epoch: 33, Steps: 10 | Train Loss: 1.383 Vali Loss: 3.171 Vali Acc: 0.168 Test Loss: 3.171 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.074829339981079
Epoch: 34, Steps: 10 | Train Loss: 1.314 Vali Loss: 3.205 Vali Acc: 0.167 Test Loss: 3.205 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.726391077041626
Epoch: 35, Steps: 10 | Train Loss: 1.188 Vali Loss: 3.177 Vali Acc: 0.175 Test Loss: 3.177 Test Acc: 0.175
Validation loss decreased (-0.172909 --> -0.175262).  Saving model ...
Epoch: 36 cost time: 1.8600597381591797
Epoch: 36, Steps: 10 | Train Loss: 1.165 Vali Loss: 3.179 Vali Acc: 0.189 Test Loss: 3.179 Test Acc: 0.189
Validation loss decreased (-0.175262 --> -0.189380).  Saving model ...
Epoch: 37 cost time: 1.8727900981903076
Epoch: 37, Steps: 10 | Train Loss: 1.126 Vali Loss: 3.249 Vali Acc: 0.171 Test Loss: 3.249 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.6793107986450195
Epoch: 38, Steps: 10 | Train Loss: 1.021 Vali Loss: 3.176 Vali Acc: 0.191 Test Loss: 3.176 Test Acc: 0.191
Validation loss decreased (-0.189380 --> -0.190556).  Saving model ...
Epoch: 39 cost time: 2.045191526412964
Epoch: 39, Steps: 10 | Train Loss: 1.016 Vali Loss: 3.235 Vali Acc: 0.194 Test Loss: 3.235 Test Acc: 0.194
Validation loss decreased (-0.190556 --> -0.194085).  Saving model ...
Epoch: 40 cost time: 1.8830358982086182
Epoch: 40, Steps: 10 | Train Loss: 0.942 Vali Loss: 3.199 Vali Acc: 0.187 Test Loss: 3.199 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.901000738143921
Epoch: 41, Steps: 10 | Train Loss: 0.860 Vali Loss: 3.210 Vali Acc: 0.193 Test Loss: 3.210 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8195700645446777
Epoch: 42, Steps: 10 | Train Loss: 0.786 Vali Loss: 3.243 Vali Acc: 0.195 Test Loss: 3.243 Test Acc: 0.195
Validation loss decreased (-0.194085 --> -0.195262).  Saving model ...
Epoch: 43 cost time: 1.6604719161987305
Epoch: 43, Steps: 10 | Train Loss: 0.730 Vali Loss: 3.211 Vali Acc: 0.199 Test Loss: 3.211 Test Acc: 0.199
Validation loss decreased (-0.195262 --> -0.198791).  Saving model ...
Epoch: 44 cost time: 1.7123546600341797
Epoch: 44, Steps: 10 | Train Loss: 0.652 Vali Loss: 3.216 Vali Acc: 0.196 Test Loss: 3.216 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6408252716064453
Epoch: 45, Steps: 10 | Train Loss: 0.699 Vali Loss: 3.284 Vali Acc: 0.173 Test Loss: 3.284 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.7276225090026855
Epoch: 46, Steps: 10 | Train Loss: 0.612 Vali Loss: 3.306 Vali Acc: 0.187 Test Loss: 3.306 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.8284213542938232
Epoch: 47, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.249 Vali Acc: 0.205 Test Loss: 3.249 Test Acc: 0.205
Validation loss decreased (-0.198791 --> -0.204673).  Saving model ...
Epoch: 48 cost time: 1.5699257850646973
Epoch: 48, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.295 Vali Acc: 0.185 Test Loss: 3.295 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.682776689529419
Epoch: 49, Steps: 10 | Train Loss: 0.479 Vali Loss: 3.324 Vali Acc: 0.202 Test Loss: 3.324 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.6912815570831299
Epoch: 50, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.424 Vali Acc: 0.185 Test Loss: 3.424 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.5427823066711426
Epoch: 51, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.279 Vali Acc: 0.208 Test Loss: 3.279 Test Acc: 0.208
Validation loss decreased (-0.204673 --> -0.208203).  Saving model ...
Epoch: 52 cost time: 1.653529405593872
Epoch: 52, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.357 Vali Acc: 0.207 Test Loss: 3.357 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.5932214260101318
Epoch: 53, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.270 Vali Acc: 0.214 Test Loss: 3.270 Test Acc: 0.214
Validation loss decreased (-0.208203 --> -0.214085).  Saving model ...
Epoch: 54 cost time: 1.4556241035461426
Epoch: 54, Steps: 10 | Train Loss: 0.322 Vali Loss: 3.290 Vali Acc: 0.214 Test Loss: 3.290 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.6664371490478516
Epoch: 55, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.274 Vali Acc: 0.228 Test Loss: 3.274 Test Acc: 0.228
Validation loss decreased (-0.214085 --> -0.228203).  Saving model ...
Epoch: 56 cost time: 1.6019830703735352
Epoch: 56, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.336 Vali Acc: 0.216 Test Loss: 3.336 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.4652669429779053
Epoch: 57, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.380 Vali Acc: 0.218 Test Loss: 3.380 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.3605854511260986
Epoch: 58, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.391 Vali Acc: 0.212 Test Loss: 3.391 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.9259679317474365
Epoch: 59, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.465 Vali Acc: 0.215 Test Loss: 3.465 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.5947401523590088
Epoch: 60, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.405 Vali Acc: 0.219 Test Loss: 3.405 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.9131274223327637
Epoch: 61, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.419 Vali Acc: 0.222 Test Loss: 3.419 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.7083065509796143
Epoch: 62, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.541 Vali Acc: 0.208 Test Loss: 3.541 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 2.2855687141418457
Epoch: 63, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.502 Vali Acc: 0.227 Test Loss: 3.502 Test Acc: 0.227
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.7473711967468262
Epoch: 64, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.572 Vali Acc: 0.222 Test Loss: 3.572 Test Acc: 0.222
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.509089708328247
Epoch: 65, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.505 Vali Acc: 0.228 Test Loss: 3.505 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22823529411764706
model parameter : 464918
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7022955417633057
Epoch: 1, Steps: 10 | Train Loss: 3.358 Vali Loss: 3.416 Vali Acc: 0.027 Test Loss: 3.416 Test Acc: 0.027
Validation loss decreased (inf --> -0.027025).  Saving model ...
Epoch: 2 cost time: 1.948598861694336
Epoch: 2, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.372 Vali Acc: 0.038 Test Loss: 3.372 Test Acc: 0.038
Validation loss decreased (-0.027025 --> -0.037613).  Saving model ...
Epoch: 3 cost time: 1.7419748306274414
Epoch: 3, Steps: 10 | Train Loss: 3.267 Vali Loss: 3.340 Vali Acc: 0.047 Test Loss: 3.340 Test Acc: 0.047
Validation loss decreased (-0.037613 --> -0.047025).  Saving model ...
Epoch: 4 cost time: 1.8115944862365723
Epoch: 4, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.325 Vali Acc: 0.045 Test Loss: 3.325 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9207446575164795
Epoch: 5, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.331 Vali Acc: 0.054 Test Loss: 3.331 Test Acc: 0.054
Validation loss decreased (-0.047025 --> -0.054084).  Saving model ...
Epoch: 6 cost time: 2.3945231437683105
Epoch: 6, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.318 Vali Acc: 0.046 Test Loss: 3.318 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0425431728363037
Epoch: 7, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.328 Vali Acc: 0.054 Test Loss: 3.328 Test Acc: 0.054
Validation loss decreased (-0.054084 --> -0.054084).  Saving model ...
Epoch: 8 cost time: 1.9197251796722412
Epoch: 8, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.349 Vali Acc: 0.052 Test Loss: 3.349 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8187901973724365
Epoch: 9, Steps: 10 | Train Loss: 3.055 Vali Loss: 3.335 Vali Acc: 0.058 Test Loss: 3.335 Test Acc: 0.058
Validation loss decreased (-0.054084 --> -0.057614).  Saving model ...
Epoch: 10 cost time: 1.8029754161834717
Epoch: 10, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.313 Vali Acc: 0.065 Test Loss: 3.313 Test Acc: 0.065
Validation loss decreased (-0.057614 --> -0.064673).  Saving model ...
Epoch: 11 cost time: 1.7680928707122803
Epoch: 11, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.303 Vali Acc: 0.072 Test Loss: 3.303 Test Acc: 0.072
Validation loss decreased (-0.064673 --> -0.071732).  Saving model ...
Epoch: 12 cost time: 1.8191077709197998
Epoch: 12, Steps: 10 | Train Loss: 2.947 Vali Loss: 3.288 Vali Acc: 0.076 Test Loss: 3.288 Test Acc: 0.076
Validation loss decreased (-0.071732 --> -0.076438).  Saving model ...
Epoch: 13 cost time: 1.93357253074646
Epoch: 13, Steps: 10 | Train Loss: 2.976 Vali Loss: 3.308 Vali Acc: 0.074 Test Loss: 3.308 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8580458164215088
Epoch: 14, Steps: 10 | Train Loss: 2.887 Vali Loss: 3.294 Vali Acc: 0.080 Test Loss: 3.294 Test Acc: 0.080
Validation loss decreased (-0.076438 --> -0.079967).  Saving model ...
Epoch: 15 cost time: 1.9044220447540283
Epoch: 15, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.268 Vali Acc: 0.080 Test Loss: 3.268 Test Acc: 0.080
Validation loss decreased (-0.079967 --> -0.079967).  Saving model ...
Epoch: 16 cost time: 1.7257091999053955
Epoch: 16, Steps: 10 | Train Loss: 2.731 Vali Loss: 3.271 Vali Acc: 0.092 Test Loss: 3.271 Test Acc: 0.092
Validation loss decreased (-0.079967 --> -0.091732).  Saving model ...
Epoch: 17 cost time: 1.767397165298462
Epoch: 17, Steps: 10 | Train Loss: 2.666 Vali Loss: 3.265 Vali Acc: 0.093 Test Loss: 3.265 Test Acc: 0.093
Validation loss decreased (-0.091732 --> -0.092909).  Saving model ...
Epoch: 18 cost time: 2.168747663497925
Epoch: 18, Steps: 10 | Train Loss: 2.639 Vali Loss: 3.272 Vali Acc: 0.104 Test Loss: 3.272 Test Acc: 0.104
Validation loss decreased (-0.092909 --> -0.103497).  Saving model ...
Epoch: 19 cost time: 1.914043664932251
Epoch: 19, Steps: 10 | Train Loss: 2.481 Vali Loss: 3.266 Vali Acc: 0.093 Test Loss: 3.266 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.578904390335083
Epoch: 20, Steps: 10 | Train Loss: 2.467 Vali Loss: 3.261 Vali Acc: 0.105 Test Loss: 3.261 Test Acc: 0.105
Validation loss decreased (-0.103497 --> -0.104673).  Saving model ...
Epoch: 21 cost time: 1.9057693481445312
Epoch: 21, Steps: 10 | Train Loss: 2.381 Vali Loss: 3.265 Vali Acc: 0.102 Test Loss: 3.265 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6252822875976562
Epoch: 22, Steps: 10 | Train Loss: 2.299 Vali Loss: 3.243 Vali Acc: 0.106 Test Loss: 3.243 Test Acc: 0.106
Validation loss decreased (-0.104673 --> -0.105850).  Saving model ...
Epoch: 23 cost time: 1.7682623863220215
Epoch: 23, Steps: 10 | Train Loss: 2.281 Vali Loss: 3.261 Vali Acc: 0.107 Test Loss: 3.261 Test Acc: 0.107
Validation loss decreased (-0.105850 --> -0.107026).  Saving model ...
Epoch: 24 cost time: 2.0888290405273438
Epoch: 24, Steps: 10 | Train Loss: 2.244 Vali Loss: 3.263 Vali Acc: 0.127 Test Loss: 3.263 Test Acc: 0.127
Validation loss decreased (-0.107026 --> -0.127026).  Saving model ...
Epoch: 25 cost time: 1.7626631259918213
Epoch: 25, Steps: 10 | Train Loss: 2.185 Vali Loss: 3.225 Vali Acc: 0.118 Test Loss: 3.225 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.551915168762207
Epoch: 26, Steps: 10 | Train Loss: 2.092 Vali Loss: 3.249 Vali Acc: 0.124 Test Loss: 3.249 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6138978004455566
Epoch: 27, Steps: 10 | Train Loss: 1.998 Vali Loss: 3.225 Vali Acc: 0.125 Test Loss: 3.225 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9983017444610596
Epoch: 28, Steps: 10 | Train Loss: 1.958 Vali Loss: 3.252 Vali Acc: 0.126 Test Loss: 3.252 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.129323720932007
Epoch: 29, Steps: 10 | Train Loss: 1.899 Vali Loss: 3.251 Vali Acc: 0.142 Test Loss: 3.251 Test Acc: 0.142
Validation loss decreased (-0.127026 --> -0.142320).  Saving model ...
Epoch: 30 cost time: 1.8876073360443115
Epoch: 30, Steps: 10 | Train Loss: 1.794 Vali Loss: 3.248 Vali Acc: 0.140 Test Loss: 3.248 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7240242958068848
Epoch: 31, Steps: 10 | Train Loss: 1.764 Vali Loss: 3.212 Vali Acc: 0.139 Test Loss: 3.212 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.847778558731079
Epoch: 32, Steps: 10 | Train Loss: 1.709 Vali Loss: 3.258 Vali Acc: 0.142 Test Loss: 3.258 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7032837867736816
Epoch: 33, Steps: 10 | Train Loss: 1.602 Vali Loss: 3.231 Vali Acc: 0.147 Test Loss: 3.231 Test Acc: 0.147
Validation loss decreased (-0.142320 --> -0.147027).  Saving model ...
Epoch: 34 cost time: 1.7862093448638916
Epoch: 34, Steps: 10 | Train Loss: 1.558 Vali Loss: 3.238 Vali Acc: 0.164 Test Loss: 3.238 Test Acc: 0.164
Validation loss decreased (-0.147027 --> -0.163497).  Saving model ...
Epoch: 35 cost time: 1.5486128330230713
Epoch: 35, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.240 Vali Acc: 0.158 Test Loss: 3.240 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9220314025878906
Epoch: 36, Steps: 10 | Train Loss: 1.425 Vali Loss: 3.299 Vali Acc: 0.151 Test Loss: 3.299 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7178127765655518
Epoch: 37, Steps: 10 | Train Loss: 1.372 Vali Loss: 3.251 Vali Acc: 0.154 Test Loss: 3.251 Test Acc: 0.154
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.657972812652588
Epoch: 38, Steps: 10 | Train Loss: 1.324 Vali Loss: 3.224 Vali Acc: 0.158 Test Loss: 3.224 Test Acc: 0.158
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.8444385528564453
Epoch: 39, Steps: 10 | Train Loss: 1.278 Vali Loss: 3.277 Vali Acc: 0.146 Test Loss: 3.277 Test Acc: 0.146
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.7189068794250488
Epoch: 40, Steps: 10 | Train Loss: 1.204 Vali Loss: 3.224 Vali Acc: 0.176 Test Loss: 3.224 Test Acc: 0.176
Validation loss decreased (-0.163497 --> -0.176438).  Saving model ...
Epoch: 41 cost time: 1.767704725265503
Epoch: 41, Steps: 10 | Train Loss: 1.158 Vali Loss: 3.265 Vali Acc: 0.179 Test Loss: 3.265 Test Acc: 0.179
Validation loss decreased (-0.176438 --> -0.178791).  Saving model ...
Epoch: 42 cost time: 1.7967636585235596
Epoch: 42, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.293 Vali Acc: 0.174 Test Loss: 3.293 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5201416015625
Epoch: 43, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.266 Vali Acc: 0.189 Test Loss: 3.266 Test Acc: 0.189
Validation loss decreased (-0.178791 --> -0.189379).  Saving model ...
Epoch: 44 cost time: 1.9523117542266846
Epoch: 44, Steps: 10 | Train Loss: 0.978 Vali Loss: 3.287 Vali Acc: 0.175 Test Loss: 3.287 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.79852294921875
Epoch: 45, Steps: 10 | Train Loss: 0.854 Vali Loss: 3.302 Vali Acc: 0.181 Test Loss: 3.302 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.9591319561004639
Epoch: 46, Steps: 10 | Train Loss: 0.801 Vali Loss: 3.273 Vali Acc: 0.196 Test Loss: 3.273 Test Acc: 0.196
Validation loss decreased (-0.189379 --> -0.196438).  Saving model ...
Epoch: 47 cost time: 1.798433542251587
Epoch: 47, Steps: 10 | Train Loss: 0.786 Vali Loss: 3.320 Vali Acc: 0.178 Test Loss: 3.320 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.7377581596374512
Epoch: 48, Steps: 10 | Train Loss: 0.716 Vali Loss: 3.328 Vali Acc: 0.187 Test Loss: 3.328 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.7887341976165771
Epoch: 49, Steps: 10 | Train Loss: 0.611 Vali Loss: 3.305 Vali Acc: 0.200 Test Loss: 3.305 Test Acc: 0.200
Validation loss decreased (-0.196438 --> -0.199967).  Saving model ...
Epoch: 50 cost time: 1.841613531112671
Epoch: 50, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.299 Vali Acc: 0.200 Test Loss: 3.299 Test Acc: 0.200
Validation loss decreased (-0.199967 --> -0.199967).  Saving model ...
Epoch: 51 cost time: 1.8692166805267334
Epoch: 51, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.338 Vali Acc: 0.191 Test Loss: 3.338 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.7445423603057861
Epoch: 52, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.351 Vali Acc: 0.199 Test Loss: 3.351 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.8482377529144287
Epoch: 53, Steps: 10 | Train Loss: 0.478 Vali Loss: 3.362 Vali Acc: 0.196 Test Loss: 3.362 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.805474042892456
Epoch: 54, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.369 Vali Acc: 0.215 Test Loss: 3.369 Test Acc: 0.215
Validation loss decreased (-0.199967 --> -0.215260).  Saving model ...
Epoch: 55 cost time: 1.796600103378296
Epoch: 55, Steps: 10 | Train Loss: 0.379 Vali Loss: 3.402 Vali Acc: 0.186 Test Loss: 3.402 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.506403923034668
Epoch: 56, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.383 Vali Acc: 0.215 Test Loss: 3.383 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.9558522701263428
Epoch: 57, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.437 Vali Acc: 0.207 Test Loss: 3.437 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.8583917617797852
Epoch: 58, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.528 Vali Acc: 0.205 Test Loss: 3.528 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.8017187118530273
Epoch: 59, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.522 Vali Acc: 0.206 Test Loss: 3.522 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 2.0249667167663574
Epoch: 60, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.442 Vali Acc: 0.215 Test Loss: 3.442 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.9099338054656982
Epoch: 61, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.505 Vali Acc: 0.218 Test Loss: 3.505 Test Acc: 0.218
Validation loss decreased (-0.215260 --> -0.217612).  Saving model ...
Epoch: 62 cost time: 1.9662187099456787
Epoch: 62, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.519 Vali Acc: 0.216 Test Loss: 3.519 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.6839954853057861
Epoch: 63, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.546 Vali Acc: 0.214 Test Loss: 3.546 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.17974853515625
Epoch: 64, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.651 Vali Acc: 0.209 Test Loss: 3.651 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.8496310710906982
Epoch: 65, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.707 Vali Acc: 0.204 Test Loss: 3.707 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 2.005850076675415
Epoch: 66, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.533 Vali Acc: 0.213 Test Loss: 3.533 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.8318703174591064
Epoch: 67, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.612 Vali Acc: 0.226 Test Loss: 3.612 Test Acc: 0.226
Validation loss decreased (-0.217612 --> -0.225846).  Saving model ...
Epoch: 68 cost time: 1.6442244052886963
Epoch: 68, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.679 Vali Acc: 0.208 Test Loss: 3.679 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 2.2286934852600098
Epoch: 69, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.648 Vali Acc: 0.220 Test Loss: 3.648 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.5813324451446533
Epoch: 70, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.665 Vali Acc: 0.218 Test Loss: 3.665 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.7778561115264893
Epoch: 71, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.665 Vali Acc: 0.225 Test Loss: 3.665 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 2.0758121013641357
Epoch: 72, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.702 Vali Acc: 0.224 Test Loss: 3.702 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.9283840656280518
Epoch: 73, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.750 Vali Acc: 0.224 Test Loss: 3.750 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.7081892490386963
Epoch: 74, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.722 Vali Acc: 0.224 Test Loss: 3.722 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.8544676303863525
Epoch: 75, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.771 Vali Acc: 0.219 Test Loss: 3.771 Test Acc: 0.219
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.678654432296753
Epoch: 76, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.707 Vali Acc: 0.226 Test Loss: 3.707 Test Acc: 0.226
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.762491226196289
Epoch: 77, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.747 Vali Acc: 0.232 Test Loss: 3.747 Test Acc: 0.232
Validation loss decreased (-0.225846 --> -0.231727).  Saving model ...
Epoch: 78 cost time: 1.647186040878296
Epoch: 78, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.732 Vali Acc: 0.228 Test Loss: 3.732 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.7915160655975342
Epoch: 79, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.756 Vali Acc: 0.236 Test Loss: 3.756 Test Acc: 0.236
Validation loss decreased (-0.231727 --> -0.236433).  Saving model ...
Epoch: 80 cost time: 1.7387611865997314
Epoch: 80, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.740 Vali Acc: 0.229 Test Loss: 3.740 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.7665619850158691
Epoch: 81, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.778 Vali Acc: 0.231 Test Loss: 3.778 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.9893643856048584
Epoch: 82, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.760 Vali Acc: 0.221 Test Loss: 3.760 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.8182768821716309
Epoch: 83, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.829 Vali Acc: 0.225 Test Loss: 3.829 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.999511957168579
Epoch: 84, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.837 Vali Acc: 0.240 Test Loss: 3.837 Test Acc: 0.240
Validation loss decreased (-0.236433 --> -0.239962).  Saving model ...
Epoch: 85 cost time: 1.8708813190460205
Epoch: 85, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.811 Vali Acc: 0.232 Test Loss: 3.811 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.8351881504058838
Epoch: 86, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.842 Vali Acc: 0.241 Test Loss: 3.842 Test Acc: 0.241
Validation loss decreased (-0.239962 --> -0.241138).  Saving model ...
Epoch: 87 cost time: 1.5466058254241943
Epoch: 87, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.856 Vali Acc: 0.231 Test Loss: 3.856 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.8174858093261719
Epoch: 88, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.864 Vali Acc: 0.234 Test Loss: 3.864 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.8140974044799805
Epoch: 89, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.893 Vali Acc: 0.221 Test Loss: 3.893 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.7757811546325684
Epoch: 90, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.913 Vali Acc: 0.221 Test Loss: 3.913 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 1.6983098983764648
Epoch: 91, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.910 Vali Acc: 0.226 Test Loss: 3.910 Test Acc: 0.226
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 1.7262721061706543
Epoch: 92, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.911 Vali Acc: 0.234 Test Loss: 3.911 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 1.7216384410858154
Epoch: 93, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.902 Vali Acc: 0.225 Test Loss: 3.902 Test Acc: 0.225
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 1.7994310855865479
Epoch: 94, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.955 Vali Acc: 0.224 Test Loss: 3.955 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 1.6844253540039062
Epoch: 95, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.901 Vali Acc: 0.234 Test Loss: 3.901 Test Acc: 0.234
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 2.0388689041137695
Epoch: 96, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.948 Vali Acc: 0.227 Test Loss: 3.948 Test Acc: 0.227
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2411764705882353
model parameter : 317654
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4206650257110596
Epoch: 1, Steps: 10 | Train Loss: 3.389 Vali Loss: 3.339 Vali Acc: 0.041 Test Loss: 3.339 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.6899588108062744
Epoch: 2, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.314 Vali Acc: 0.041 Test Loss: 3.314 Test Acc: 0.041
Validation loss decreased (-0.041143 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 1.8449037075042725
Epoch: 3, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.326 Vali Acc: 0.045 Test Loss: 3.326 Test Acc: 0.045
Validation loss decreased (-0.041143 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 2.025542974472046
Epoch: 4, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.336 Vali Acc: 0.040 Test Loss: 3.336 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7519066333770752
Epoch: 5, Steps: 10 | Train Loss: 3.151 Vali Loss: 3.337 Vali Acc: 0.038 Test Loss: 3.337 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.175513505935669
Epoch: 6, Steps: 10 | Train Loss: 3.178 Vali Loss: 3.334 Vali Acc: 0.038 Test Loss: 3.334 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0506534576416016
Epoch: 7, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.332 Vali Acc: 0.051 Test Loss: 3.332 Test Acc: 0.051
Validation loss decreased (-0.044673 --> -0.050555).  Saving model ...
Epoch: 8 cost time: 1.5019798278808594
Epoch: 8, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.324 Vali Acc: 0.049 Test Loss: 3.324 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8490417003631592
Epoch: 9, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.323 Vali Acc: 0.055 Test Loss: 3.323 Test Acc: 0.055
Validation loss decreased (-0.050555 --> -0.055261).  Saving model ...
Epoch: 10 cost time: 1.6769275665283203
Epoch: 10, Steps: 10 | Train Loss: 3.044 Vali Loss: 3.335 Vali Acc: 0.048 Test Loss: 3.335 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6619422435760498
Epoch: 11, Steps: 10 | Train Loss: 3.024 Vali Loss: 3.323 Vali Acc: 0.068 Test Loss: 3.323 Test Acc: 0.068
Validation loss decreased (-0.055261 --> -0.068202).  Saving model ...
Epoch: 12 cost time: 1.8165836334228516
Epoch: 12, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.332 Vali Acc: 0.066 Test Loss: 3.332 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5825891494750977
Epoch: 13, Steps: 10 | Train Loss: 2.911 Vali Loss: 3.318 Vali Acc: 0.092 Test Loss: 3.318 Test Acc: 0.092
Validation loss decreased (-0.068202 --> -0.091732).  Saving model ...
Epoch: 14 cost time: 1.7999088764190674
Epoch: 14, Steps: 10 | Train Loss: 2.823 Vali Loss: 3.309 Vali Acc: 0.079 Test Loss: 3.309 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6193158626556396
Epoch: 15, Steps: 10 | Train Loss: 2.755 Vali Loss: 3.303 Vali Acc: 0.081 Test Loss: 3.303 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6193914413452148
Epoch: 16, Steps: 10 | Train Loss: 2.741 Vali Loss: 3.299 Vali Acc: 0.100 Test Loss: 3.299 Test Acc: 0.100
Validation loss decreased (-0.091732 --> -0.099967).  Saving model ...
Epoch: 17 cost time: 1.8067195415496826
Epoch: 17, Steps: 10 | Train Loss: 2.662 Vali Loss: 3.288 Vali Acc: 0.095 Test Loss: 3.288 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8392951488494873
Epoch: 18, Steps: 10 | Train Loss: 2.590 Vali Loss: 3.280 Vali Acc: 0.101 Test Loss: 3.280 Test Acc: 0.101
Validation loss decreased (-0.099967 --> -0.101144).  Saving model ...
Epoch: 19 cost time: 1.865478754043579
Epoch: 19, Steps: 10 | Train Loss: 2.579 Vali Loss: 3.280 Vali Acc: 0.104 Test Loss: 3.280 Test Acc: 0.104
Validation loss decreased (-0.101144 --> -0.103497).  Saving model ...
Epoch: 20 cost time: 1.840362310409546
Epoch: 20, Steps: 10 | Train Loss: 2.439 Vali Loss: 3.269 Vali Acc: 0.115 Test Loss: 3.269 Test Acc: 0.115
Validation loss decreased (-0.103497 --> -0.115261).  Saving model ...
Epoch: 21 cost time: 1.7407252788543701
Epoch: 21, Steps: 10 | Train Loss: 2.399 Vali Loss: 3.266 Vali Acc: 0.109 Test Loss: 3.266 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7620422840118408
Epoch: 22, Steps: 10 | Train Loss: 2.364 Vali Loss: 3.264 Vali Acc: 0.119 Test Loss: 3.264 Test Acc: 0.119
Validation loss decreased (-0.115261 --> -0.118791).  Saving model ...
Epoch: 23 cost time: 1.64217209815979
Epoch: 23, Steps: 10 | Train Loss: 2.261 Vali Loss: 3.282 Vali Acc: 0.111 Test Loss: 3.282 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6214947700500488
Epoch: 24, Steps: 10 | Train Loss: 2.264 Vali Loss: 3.253 Vali Acc: 0.125 Test Loss: 3.253 Test Acc: 0.125
Validation loss decreased (-0.118791 --> -0.124673).  Saving model ...
Epoch: 25 cost time: 1.9117724895477295
Epoch: 25, Steps: 10 | Train Loss: 2.175 Vali Loss: 3.261 Vali Acc: 0.136 Test Loss: 3.261 Test Acc: 0.136
Validation loss decreased (-0.124673 --> -0.136438).  Saving model ...
Epoch: 26 cost time: 1.578597068786621
Epoch: 26, Steps: 10 | Train Loss: 2.112 Vali Loss: 3.265 Vali Acc: 0.115 Test Loss: 3.265 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5773227214813232
Epoch: 27, Steps: 10 | Train Loss: 2.044 Vali Loss: 3.245 Vali Acc: 0.122 Test Loss: 3.245 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6555559635162354
Epoch: 28, Steps: 10 | Train Loss: 1.970 Vali Loss: 3.240 Vali Acc: 0.140 Test Loss: 3.240 Test Acc: 0.140
Validation loss decreased (-0.136438 --> -0.139968).  Saving model ...
Epoch: 29 cost time: 1.6365044116973877
Epoch: 29, Steps: 10 | Train Loss: 1.949 Vali Loss: 3.266 Vali Acc: 0.131 Test Loss: 3.266 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6799275875091553
Epoch: 30, Steps: 10 | Train Loss: 1.868 Vali Loss: 3.253 Vali Acc: 0.158 Test Loss: 3.253 Test Acc: 0.158
Validation loss decreased (-0.139968 --> -0.157615).  Saving model ...
Epoch: 31 cost time: 1.607079267501831
Epoch: 31, Steps: 10 | Train Loss: 1.843 Vali Loss: 3.255 Vali Acc: 0.144 Test Loss: 3.255 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6466360092163086
Epoch: 32, Steps: 10 | Train Loss: 1.728 Vali Loss: 3.245 Vali Acc: 0.138 Test Loss: 3.245 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6107540130615234
Epoch: 33, Steps: 10 | Train Loss: 1.704 Vali Loss: 3.283 Vali Acc: 0.151 Test Loss: 3.283 Test Acc: 0.151
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4759490489959717
Epoch: 34, Steps: 10 | Train Loss: 1.628 Vali Loss: 3.285 Vali Acc: 0.148 Test Loss: 3.285 Test Acc: 0.148
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6662814617156982
Epoch: 35, Steps: 10 | Train Loss: 1.566 Vali Loss: 3.293 Vali Acc: 0.154 Test Loss: 3.293 Test Acc: 0.154
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.579982042312622
Epoch: 36, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.272 Vali Acc: 0.160 Test Loss: 3.272 Test Acc: 0.160
Validation loss decreased (-0.157615 --> -0.159967).  Saving model ...
Epoch: 37 cost time: 1.6425461769104004
Epoch: 37, Steps: 10 | Train Loss: 1.456 Vali Loss: 3.262 Vali Acc: 0.169 Test Loss: 3.262 Test Acc: 0.169
Validation loss decreased (-0.159967 --> -0.169379).  Saving model ...
Epoch: 38 cost time: 1.457223653793335
Epoch: 38, Steps: 10 | Train Loss: 1.451 Vali Loss: 3.300 Vali Acc: 0.158 Test Loss: 3.300 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8829829692840576
Epoch: 39, Steps: 10 | Train Loss: 1.364 Vali Loss: 3.281 Vali Acc: 0.168 Test Loss: 3.281 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.9717199802398682
Epoch: 40, Steps: 10 | Train Loss: 1.251 Vali Loss: 3.263 Vali Acc: 0.167 Test Loss: 3.263 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.5476901531219482
Epoch: 41, Steps: 10 | Train Loss: 1.222 Vali Loss: 3.297 Vali Acc: 0.173 Test Loss: 3.297 Test Acc: 0.173
Validation loss decreased (-0.169379 --> -0.172908).  Saving model ...
Epoch: 42 cost time: 1.6732397079467773
Epoch: 42, Steps: 10 | Train Loss: 1.127 Vali Loss: 3.283 Vali Acc: 0.178 Test Loss: 3.283 Test Acc: 0.178
Validation loss decreased (-0.172908 --> -0.177614).  Saving model ...
Epoch: 43 cost time: 1.8412139415740967
Epoch: 43, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.325 Vali Acc: 0.196 Test Loss: 3.325 Test Acc: 0.196
Validation loss decreased (-0.177614 --> -0.196437).  Saving model ...
Epoch: 44 cost time: 1.845001220703125
Epoch: 44, Steps: 10 | Train Loss: 1.011 Vali Loss: 3.262 Vali Acc: 0.182 Test Loss: 3.262 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7891871929168701
Epoch: 45, Steps: 10 | Train Loss: 0.940 Vali Loss: 3.305 Vali Acc: 0.201 Test Loss: 3.305 Test Acc: 0.201
Validation loss decreased (-0.196437 --> -0.201143).  Saving model ...
Epoch: 46 cost time: 1.528653860092163
Epoch: 46, Steps: 10 | Train Loss: 0.930 Vali Loss: 3.315 Vali Acc: 0.191 Test Loss: 3.315 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.7427871227264404
Epoch: 47, Steps: 10 | Train Loss: 0.907 Vali Loss: 3.289 Vali Acc: 0.201 Test Loss: 3.289 Test Acc: 0.201
Validation loss decreased (-0.201143 --> -0.201144).  Saving model ...
Epoch: 48 cost time: 1.875547170639038
Epoch: 48, Steps: 10 | Train Loss: 0.765 Vali Loss: 3.318 Vali Acc: 0.194 Test Loss: 3.318 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.5115392208099365
Epoch: 49, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.353 Vali Acc: 0.185 Test Loss: 3.353 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.718717336654663
Epoch: 50, Steps: 10 | Train Loss: 0.734 Vali Loss: 3.283 Vali Acc: 0.189 Test Loss: 3.283 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.6051204204559326
Epoch: 51, Steps: 10 | Train Loss: 0.719 Vali Loss: 3.311 Vali Acc: 0.207 Test Loss: 3.311 Test Acc: 0.207
Validation loss decreased (-0.201144 --> -0.207026).  Saving model ...
Epoch: 52 cost time: 1.555558443069458
Epoch: 52, Steps: 10 | Train Loss: 0.587 Vali Loss: 3.388 Vali Acc: 0.192 Test Loss: 3.388 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.7749066352844238
Epoch: 53, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.344 Vali Acc: 0.189 Test Loss: 3.344 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.0260255336761475
Epoch: 54, Steps: 10 | Train Loss: 0.537 Vali Loss: 3.368 Vali Acc: 0.204 Test Loss: 3.368 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.204333543777466
Epoch: 55, Steps: 10 | Train Loss: 0.498 Vali Loss: 3.376 Vali Acc: 0.201 Test Loss: 3.376 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.898587703704834
Epoch: 56, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.390 Vali Acc: 0.208 Test Loss: 3.390 Test Acc: 0.208
Validation loss decreased (-0.207026 --> -0.208201).  Saving model ...
Epoch: 57 cost time: 1.7123358249664307
Epoch: 57, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.491 Vali Acc: 0.198 Test Loss: 3.491 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.669947624206543
Epoch: 58, Steps: 10 | Train Loss: 0.369 Vali Loss: 3.431 Vali Acc: 0.208 Test Loss: 3.431 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.063143491744995
Epoch: 59, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.503 Vali Acc: 0.206 Test Loss: 3.503 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.7369790077209473
Epoch: 60, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.461 Vali Acc: 0.200 Test Loss: 3.461 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.7107031345367432
Epoch: 61, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.474 Vali Acc: 0.194 Test Loss: 3.474 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.8128602504730225
Epoch: 62, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.600 Vali Acc: 0.199 Test Loss: 3.600 Test Acc: 0.199
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.724825382232666
Epoch: 63, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.518 Vali Acc: 0.204 Test Loss: 3.518 Test Acc: 0.204
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 2.0894157886505127
Epoch: 64, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.550 Vali Acc: 0.207 Test Loss: 3.550 Test Acc: 0.207
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.8908777236938477
Epoch: 65, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.645 Vali Acc: 0.213 Test Loss: 3.645 Test Acc: 0.213
Validation loss decreased (-0.208201 --> -0.212905).  Saving model ...
Epoch: 66 cost time: 1.6634855270385742
Epoch: 66, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.598 Vali Acc: 0.211 Test Loss: 3.598 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.711721658706665
Epoch: 67, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.642 Vali Acc: 0.218 Test Loss: 3.642 Test Acc: 0.218
Validation loss decreased (-0.212905 --> -0.217611).  Saving model ...
Epoch: 68 cost time: 2.1235949993133545
Epoch: 68, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.636 Vali Acc: 0.214 Test Loss: 3.636 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.7748959064483643
Epoch: 69, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.677 Vali Acc: 0.224 Test Loss: 3.677 Test Acc: 0.224
Validation loss decreased (-0.217611 --> -0.223493).  Saving model ...
Epoch: 70 cost time: 1.681234359741211
Epoch: 70, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.706 Vali Acc: 0.204 Test Loss: 3.706 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.741682767868042
Epoch: 71, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.733 Vali Acc: 0.204 Test Loss: 3.733 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.802093505859375
Epoch: 72, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.678 Vali Acc: 0.211 Test Loss: 3.678 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.9747204780578613
Epoch: 73, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.824 Vali Acc: 0.212 Test Loss: 3.824 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.8818273544311523
Epoch: 74, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.767 Vali Acc: 0.213 Test Loss: 3.767 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.8628954887390137
Epoch: 75, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.833 Vali Acc: 0.202 Test Loss: 3.833 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.627392053604126
Epoch: 76, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.798 Vali Acc: 0.207 Test Loss: 3.798 Test Acc: 0.207
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.959702491760254
Epoch: 77, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.825 Vali Acc: 0.208 Test Loss: 3.825 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.7413444519042969
Epoch: 78, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.792 Vali Acc: 0.218 Test Loss: 3.792 Test Acc: 0.218
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 1.5094306468963623
Epoch: 79, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.892 Vali Acc: 0.205 Test Loss: 3.892 Test Acc: 0.205
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2235294117647059
model parameter : 316822
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4893486499786377
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.405 Vali Acc: 0.048 Test Loss: 3.405 Test Acc: 0.048
Validation loss decreased (inf --> -0.048201).  Saving model ...
Epoch: 2 cost time: 1.8844282627105713
Epoch: 2, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.381 Vali Acc: 0.029 Test Loss: 3.381 Test Acc: 0.029
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.658489465713501
Epoch: 3, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.373 Vali Acc: 0.035 Test Loss: 3.373 Test Acc: 0.035
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4962818622589111
Epoch: 4, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.359 Vali Acc: 0.038 Test Loss: 3.359 Test Acc: 0.038
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6372382640838623
Epoch: 5, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.359 Vali Acc: 0.035 Test Loss: 3.359 Test Acc: 0.035
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7745747566223145
Epoch: 6, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.343 Vali Acc: 0.044 Test Loss: 3.343 Test Acc: 0.044
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6675145626068115
Epoch: 7, Steps: 10 | Train Loss: 3.126 Vali Loss: 3.337 Vali Acc: 0.042 Test Loss: 3.337 Test Acc: 0.042
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.724656105041504
Epoch: 8, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.331 Vali Acc: 0.045 Test Loss: 3.331 Test Acc: 0.045
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.543431043624878
Epoch: 9, Steps: 10 | Train Loss: 3.109 Vali Loss: 3.330 Vali Acc: 0.049 Test Loss: 3.330 Test Acc: 0.049
Validation loss decreased (-0.048201 --> -0.049378).  Saving model ...
Epoch: 10 cost time: 1.909630298614502
Epoch: 10, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.334 Vali Acc: 0.056 Test Loss: 3.334 Test Acc: 0.056
Validation loss decreased (-0.049378 --> -0.056437).  Saving model ...
Epoch: 11 cost time: 1.6813857555389404
Epoch: 11, Steps: 10 | Train Loss: 3.031 Vali Loss: 3.326 Vali Acc: 0.056 Test Loss: 3.326 Test Acc: 0.056
Validation loss decreased (-0.056437 --> -0.056437).  Saving model ...
Epoch: 12 cost time: 2.345604181289673
Epoch: 12, Steps: 10 | Train Loss: 2.993 Vali Loss: 3.321 Vali Acc: 0.053 Test Loss: 3.321 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5821423530578613
Epoch: 13, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.313 Vali Acc: 0.069 Test Loss: 3.313 Test Acc: 0.069
Validation loss decreased (-0.056437 --> -0.069379).  Saving model ...
Epoch: 14 cost time: 1.5064728260040283
Epoch: 14, Steps: 10 | Train Loss: 2.811 Vali Loss: 3.319 Vali Acc: 0.074 Test Loss: 3.319 Test Acc: 0.074
Validation loss decreased (-0.069379 --> -0.074084).  Saving model ...
Epoch: 15 cost time: 1.656087875366211
Epoch: 15, Steps: 10 | Train Loss: 2.751 Vali Loss: 3.327 Vali Acc: 0.074 Test Loss: 3.327 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6359975337982178
Epoch: 16, Steps: 10 | Train Loss: 2.699 Vali Loss: 3.299 Vali Acc: 0.084 Test Loss: 3.299 Test Acc: 0.084
Validation loss decreased (-0.074084 --> -0.083496).  Saving model ...
Epoch: 17 cost time: 1.5107882022857666
Epoch: 17, Steps: 10 | Train Loss: 2.647 Vali Loss: 3.294 Vali Acc: 0.084 Test Loss: 3.294 Test Acc: 0.084
Validation loss decreased (-0.083496 --> -0.083496).  Saving model ...
Epoch: 18 cost time: 1.669952630996704
Epoch: 18, Steps: 10 | Train Loss: 2.543 Vali Loss: 3.304 Vali Acc: 0.093 Test Loss: 3.304 Test Acc: 0.093
Validation loss decreased (-0.083496 --> -0.092908).  Saving model ...
Epoch: 19 cost time: 1.857757806777954
Epoch: 19, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.286 Vali Acc: 0.095 Test Loss: 3.286 Test Acc: 0.095
Validation loss decreased (-0.092908 --> -0.095261).  Saving model ...
Epoch: 20 cost time: 1.630401372909546
Epoch: 20, Steps: 10 | Train Loss: 2.417 Vali Loss: 3.273 Vali Acc: 0.094 Test Loss: 3.273 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6887173652648926
Epoch: 21, Steps: 10 | Train Loss: 2.379 Vali Loss: 3.289 Vali Acc: 0.106 Test Loss: 3.289 Test Acc: 0.106
Validation loss decreased (-0.095261 --> -0.105849).  Saving model ...
Epoch: 22 cost time: 1.6847124099731445
Epoch: 22, Steps: 10 | Train Loss: 2.351 Vali Loss: 3.270 Vali Acc: 0.104 Test Loss: 3.270 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5403401851654053
Epoch: 23, Steps: 10 | Train Loss: 2.219 Vali Loss: 3.288 Vali Acc: 0.108 Test Loss: 3.288 Test Acc: 0.108
Validation loss decreased (-0.105849 --> -0.108202).  Saving model ...
Epoch: 24 cost time: 1.6482737064361572
Epoch: 24, Steps: 10 | Train Loss: 2.160 Vali Loss: 3.261 Vali Acc: 0.115 Test Loss: 3.261 Test Acc: 0.115
Validation loss decreased (-0.108202 --> -0.115262).  Saving model ...
Epoch: 25 cost time: 1.5203900337219238
Epoch: 25, Steps: 10 | Train Loss: 2.153 Vali Loss: 3.295 Vali Acc: 0.115 Test Loss: 3.295 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6475613117218018
Epoch: 26, Steps: 10 | Train Loss: 1.992 Vali Loss: 3.283 Vali Acc: 0.122 Test Loss: 3.283 Test Acc: 0.122
Validation loss decreased (-0.115262 --> -0.122320).  Saving model ...
Epoch: 27 cost time: 1.7989976406097412
Epoch: 27, Steps: 10 | Train Loss: 1.921 Vali Loss: 3.265 Vali Acc: 0.132 Test Loss: 3.265 Test Acc: 0.132
Validation loss decreased (-0.122320 --> -0.131732).  Saving model ...
Epoch: 28 cost time: 1.7497031688690186
Epoch: 28, Steps: 10 | Train Loss: 1.905 Vali Loss: 3.272 Vali Acc: 0.139 Test Loss: 3.272 Test Acc: 0.139
Validation loss decreased (-0.131732 --> -0.138791).  Saving model ...
Epoch: 29 cost time: 1.8319833278656006
Epoch: 29, Steps: 10 | Train Loss: 1.867 Vali Loss: 3.322 Vali Acc: 0.118 Test Loss: 3.322 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.066307544708252
Epoch: 30, Steps: 10 | Train Loss: 1.804 Vali Loss: 3.249 Vali Acc: 0.140 Test Loss: 3.249 Test Acc: 0.140
Validation loss decreased (-0.138791 --> -0.139968).  Saving model ...
Epoch: 31 cost time: 1.6094729900360107
Epoch: 31, Steps: 10 | Train Loss: 1.702 Vali Loss: 3.317 Vali Acc: 0.134 Test Loss: 3.317 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5462827682495117
Epoch: 32, Steps: 10 | Train Loss: 1.654 Vali Loss: 3.277 Vali Acc: 0.139 Test Loss: 3.277 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5671238899230957
Epoch: 33, Steps: 10 | Train Loss: 1.534 Vali Loss: 3.305 Vali Acc: 0.138 Test Loss: 3.305 Test Acc: 0.138
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5034582614898682
Epoch: 34, Steps: 10 | Train Loss: 1.524 Vali Loss: 3.329 Vali Acc: 0.145 Test Loss: 3.329 Test Acc: 0.145
Validation loss decreased (-0.139968 --> -0.144673).  Saving model ...
Epoch: 35 cost time: 1.7413201332092285
Epoch: 35, Steps: 10 | Train Loss: 1.408 Vali Loss: 3.284 Vali Acc: 0.151 Test Loss: 3.284 Test Acc: 0.151
Validation loss decreased (-0.144673 --> -0.150555).  Saving model ...
Epoch: 36 cost time: 2.3331997394561768
Epoch: 36, Steps: 10 | Train Loss: 1.416 Vali Loss: 3.323 Vali Acc: 0.141 Test Loss: 3.323 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.591949462890625
Epoch: 37, Steps: 10 | Train Loss: 1.244 Vali Loss: 3.335 Vali Acc: 0.144 Test Loss: 3.335 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.888702154159546
Epoch: 38, Steps: 10 | Train Loss: 1.276 Vali Loss: 3.355 Vali Acc: 0.158 Test Loss: 3.355 Test Acc: 0.158
Validation loss decreased (-0.150555 --> -0.157614).  Saving model ...
Epoch: 39 cost time: 1.6967852115631104
Epoch: 39, Steps: 10 | Train Loss: 1.256 Vali Loss: 3.304 Vali Acc: 0.165 Test Loss: 3.304 Test Acc: 0.165
Validation loss decreased (-0.157614 --> -0.164673).  Saving model ...
Epoch: 40 cost time: 1.779606580734253
Epoch: 40, Steps: 10 | Train Loss: 1.106 Vali Loss: 3.328 Vali Acc: 0.161 Test Loss: 3.328 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6484291553497314
Epoch: 41, Steps: 10 | Train Loss: 1.101 Vali Loss: 3.312 Vali Acc: 0.160 Test Loss: 3.312 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.9102106094360352
Epoch: 42, Steps: 10 | Train Loss: 1.050 Vali Loss: 3.369 Vali Acc: 0.145 Test Loss: 3.369 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.0301270484924316
Epoch: 43, Steps: 10 | Train Loss: 0.945 Vali Loss: 3.362 Vali Acc: 0.175 Test Loss: 3.362 Test Acc: 0.175
Validation loss decreased (-0.164673 --> -0.175260).  Saving model ...
Epoch: 44 cost time: 2.02559232711792
Epoch: 44, Steps: 10 | Train Loss: 0.898 Vali Loss: 3.421 Vali Acc: 0.156 Test Loss: 3.421 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.803614854812622
Epoch: 45, Steps: 10 | Train Loss: 0.809 Vali Loss: 3.313 Vali Acc: 0.178 Test Loss: 3.313 Test Acc: 0.178
Validation loss decreased (-0.175260 --> -0.177614).  Saving model ...
Epoch: 46 cost time: 2.073789596557617
Epoch: 46, Steps: 10 | Train Loss: 0.818 Vali Loss: 3.369 Vali Acc: 0.175 Test Loss: 3.369 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.5805766582489014
Epoch: 47, Steps: 10 | Train Loss: 0.705 Vali Loss: 3.402 Vali Acc: 0.168 Test Loss: 3.402 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.5984563827514648
Epoch: 48, Steps: 10 | Train Loss: 0.683 Vali Loss: 3.386 Vali Acc: 0.186 Test Loss: 3.386 Test Acc: 0.186
Validation loss decreased (-0.177614 --> -0.185848).  Saving model ...
Epoch: 49 cost time: 2.2873544692993164
Epoch: 49, Steps: 10 | Train Loss: 0.645 Vali Loss: 3.485 Vali Acc: 0.174 Test Loss: 3.485 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.5243456363677979
Epoch: 50, Steps: 10 | Train Loss: 0.579 Vali Loss: 3.425 Vali Acc: 0.167 Test Loss: 3.425 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.8462731838226318
Epoch: 51, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.467 Vali Acc: 0.185 Test Loss: 3.467 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.926912784576416
Epoch: 52, Steps: 10 | Train Loss: 0.500 Vali Loss: 3.511 Vali Acc: 0.167 Test Loss: 3.511 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.1176702976226807
Epoch: 53, Steps: 10 | Train Loss: 0.497 Vali Loss: 3.541 Vali Acc: 0.181 Test Loss: 3.541 Test Acc: 0.181
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 2.1811182498931885
Epoch: 54, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.504 Vali Acc: 0.181 Test Loss: 3.504 Test Acc: 0.181
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.9850797653198242
Epoch: 55, Steps: 10 | Train Loss: 0.416 Vali Loss: 3.467 Vali Acc: 0.191 Test Loss: 3.467 Test Acc: 0.191
Validation loss decreased (-0.185848 --> -0.190554).  Saving model ...
Epoch: 56 cost time: 1.8269648551940918
Epoch: 56, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.489 Vali Acc: 0.191 Test Loss: 3.489 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.2079691886901855
Epoch: 57, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.555 Vali Acc: 0.191 Test Loss: 3.555 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.123103141784668
Epoch: 58, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.625 Vali Acc: 0.178 Test Loss: 3.625 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.5372581481933594
Epoch: 59, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.575 Vali Acc: 0.195 Test Loss: 3.575 Test Acc: 0.195
Validation loss decreased (-0.190554 --> -0.195258).  Saving model ...
Epoch: 60 cost time: 2.270519495010376
Epoch: 60, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.678 Vali Acc: 0.191 Test Loss: 3.678 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.6479876041412354
Epoch: 61, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.598 Vali Acc: 0.189 Test Loss: 3.598 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 2.1434643268585205
Epoch: 62, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.779 Vali Acc: 0.181 Test Loss: 3.779 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 2.082897663116455
Epoch: 63, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.636 Vali Acc: 0.186 Test Loss: 3.636 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 2.0413544178009033
Epoch: 64, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.693 Vali Acc: 0.200 Test Loss: 3.693 Test Acc: 0.200
Validation loss decreased (-0.195258 --> -0.199963).  Saving model ...
Epoch: 65 cost time: 2.1415679454803467
Epoch: 65, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.741 Vali Acc: 0.193 Test Loss: 3.741 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.8621611595153809
Epoch: 66, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.713 Vali Acc: 0.198 Test Loss: 3.713 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.3381266593933105
Epoch: 67, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.765 Vali Acc: 0.205 Test Loss: 3.765 Test Acc: 0.205
Validation loss decreased (-0.199963 --> -0.204668).  Saving model ...
Epoch: 68 cost time: 2.124943494796753
Epoch: 68, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.732 Vali Acc: 0.194 Test Loss: 3.732 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 2.199068307876587
Epoch: 69, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.816 Vali Acc: 0.211 Test Loss: 3.816 Test Acc: 0.211
Validation loss decreased (-0.204668 --> -0.210550).  Saving model ...
Epoch: 70 cost time: 2.606801986694336
Epoch: 70, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.831 Vali Acc: 0.207 Test Loss: 3.831 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.9202814102172852
Epoch: 71, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.856 Vali Acc: 0.205 Test Loss: 3.856 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 2.086995840072632
Epoch: 72, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.850 Vali Acc: 0.196 Test Loss: 3.850 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 2.0129270553588867
Epoch: 73, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.834 Vali Acc: 0.201 Test Loss: 3.834 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 2.0923099517822266
Epoch: 74, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.935 Vali Acc: 0.212 Test Loss: 3.935 Test Acc: 0.212
Validation loss decreased (-0.210550 --> -0.211725).  Saving model ...
Epoch: 75 cost time: 1.9855225086212158
Epoch: 75, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.852 Vali Acc: 0.219 Test Loss: 3.852 Test Acc: 0.219
Validation loss decreased (-0.211725 --> -0.218785).  Saving model ...
Epoch: 76 cost time: 2.0929830074310303
Epoch: 76, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.899 Vali Acc: 0.211 Test Loss: 3.899 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.599226951599121
Epoch: 77, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.885 Vali Acc: 0.207 Test Loss: 3.885 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 2.233778953552246
Epoch: 78, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.961 Vali Acc: 0.207 Test Loss: 3.961 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 2.0764009952545166
Epoch: 79, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.905 Vali Acc: 0.204 Test Loss: 3.905 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.9143335819244385
Epoch: 80, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.974 Vali Acc: 0.213 Test Loss: 3.974 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 2.5281782150268555
Epoch: 81, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.959 Vali Acc: 0.216 Test Loss: 3.959 Test Acc: 0.216
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 2.473294258117676
Epoch: 82, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.926 Vali Acc: 0.209 Test Loss: 3.926 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 2.2136998176574707
Epoch: 83, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.969 Vali Acc: 0.226 Test Loss: 3.969 Test Acc: 0.226
Validation loss decreased (-0.218785 --> -0.225843).  Saving model ...
Epoch: 84 cost time: 2.015537977218628
Epoch: 84, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.984 Vali Acc: 0.224 Test Loss: 3.984 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 2.159515619277954
Epoch: 85, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.984 Vali Acc: 0.226 Test Loss: 3.984 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 2.1366617679595947
Epoch: 86, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.040 Vali Acc: 0.209 Test Loss: 4.040 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 2.349736213684082
Epoch: 87, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.096 Vali Acc: 0.213 Test Loss: 4.096 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 2.124014377593994
Epoch: 88, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.039 Vali Acc: 0.208 Test Loss: 4.039 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 2.1290533542633057
Epoch: 89, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.022 Vali Acc: 0.212 Test Loss: 4.022 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 2.1919262409210205
Epoch: 90, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.067 Vali Acc: 0.216 Test Loss: 4.067 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 1.9472413063049316
Epoch: 91, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.054 Vali Acc: 0.224 Test Loss: 4.054 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 2.4401798248291016
Epoch: 92, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.113 Vali Acc: 0.215 Test Loss: 4.113 Test Acc: 0.215
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 2.1777303218841553
Epoch: 93, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.104 Vali Acc: 0.215 Test Loss: 4.104 Test Acc: 0.215
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22588235294117648
model parameter : 315990
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4299862384796143
Epoch: 1, Steps: 10 | Train Loss: 3.411 Vali Loss: 3.393 Vali Acc: 0.045 Test Loss: 3.393 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 1.7871670722961426
Epoch: 2, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.347 Vali Acc: 0.046 Test Loss: 3.347 Test Acc: 0.046
Validation loss decreased (-0.044672 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 1.673689365386963
Epoch: 3, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.328 Vali Acc: 0.047 Test Loss: 3.328 Test Acc: 0.047
Validation loss decreased (-0.045849 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 1.8088808059692383
Epoch: 4, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.319 Vali Acc: 0.041 Test Loss: 3.319 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8741772174835205
Epoch: 5, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.315 Vali Acc: 0.051 Test Loss: 3.315 Test Acc: 0.051
Validation loss decreased (-0.047026 --> -0.050555).  Saving model ...
Epoch: 6 cost time: 2.051339864730835
Epoch: 6, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.312 Vali Acc: 0.051 Test Loss: 3.312 Test Acc: 0.051
Validation loss decreased (-0.050555 --> -0.050555).  Saving model ...
Epoch: 7 cost time: 1.6782712936401367
Epoch: 7, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.310 Vali Acc: 0.069 Test Loss: 3.310 Test Acc: 0.069
Validation loss decreased (-0.050555 --> -0.069379).  Saving model ...
Epoch: 8 cost time: 1.757213830947876
Epoch: 8, Steps: 10 | Train Loss: 3.021 Vali Loss: 3.308 Vali Acc: 0.067 Test Loss: 3.308 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5830368995666504
Epoch: 9, Steps: 10 | Train Loss: 3.038 Vali Loss: 3.297 Vali Acc: 0.078 Test Loss: 3.297 Test Acc: 0.078
Validation loss decreased (-0.069379 --> -0.077614).  Saving model ...
Epoch: 10 cost time: 1.5803182125091553
Epoch: 10, Steps: 10 | Train Loss: 2.989 Vali Loss: 3.301 Vali Acc: 0.078 Test Loss: 3.301 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7263166904449463
Epoch: 11, Steps: 10 | Train Loss: 2.892 Vali Loss: 3.282 Vali Acc: 0.080 Test Loss: 3.282 Test Acc: 0.080
Validation loss decreased (-0.077614 --> -0.079967).  Saving model ...
Epoch: 12 cost time: 2.1046319007873535
Epoch: 12, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.280 Vali Acc: 0.087 Test Loss: 3.280 Test Acc: 0.087
Validation loss decreased (-0.079967 --> -0.087026).  Saving model ...
Epoch: 13 cost time: 1.586010217666626
Epoch: 13, Steps: 10 | Train Loss: 2.822 Vali Loss: 3.273 Vali Acc: 0.091 Test Loss: 3.273 Test Acc: 0.091
Validation loss decreased (-0.087026 --> -0.090556).  Saving model ...
Epoch: 14 cost time: 1.8663208484649658
Epoch: 14, Steps: 10 | Train Loss: 2.761 Vali Loss: 3.263 Vali Acc: 0.096 Test Loss: 3.263 Test Acc: 0.096
Validation loss decreased (-0.090556 --> -0.096438).  Saving model ...
Epoch: 15 cost time: 1.5586636066436768
Epoch: 15, Steps: 10 | Train Loss: 2.756 Vali Loss: 3.271 Vali Acc: 0.092 Test Loss: 3.271 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8961772918701172
Epoch: 16, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.245 Vali Acc: 0.102 Test Loss: 3.245 Test Acc: 0.102
Validation loss decreased (-0.096438 --> -0.102320).  Saving model ...
Epoch: 17 cost time: 1.8477745056152344
Epoch: 17, Steps: 10 | Train Loss: 2.543 Vali Loss: 3.247 Vali Acc: 0.109 Test Loss: 3.247 Test Acc: 0.109
Validation loss decreased (-0.102320 --> -0.109379).  Saving model ...
Epoch: 18 cost time: 1.538940668106079
Epoch: 18, Steps: 10 | Train Loss: 2.486 Vali Loss: 3.235 Vali Acc: 0.124 Test Loss: 3.235 Test Acc: 0.124
Validation loss decreased (-0.109379 --> -0.123497).  Saving model ...
Epoch: 19 cost time: 1.5853097438812256
Epoch: 19, Steps: 10 | Train Loss: 2.472 Vali Loss: 3.243 Vali Acc: 0.116 Test Loss: 3.243 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8479819297790527
Epoch: 20, Steps: 10 | Train Loss: 2.446 Vali Loss: 3.241 Vali Acc: 0.129 Test Loss: 3.241 Test Acc: 0.129
Validation loss decreased (-0.123497 --> -0.129379).  Saving model ...
Epoch: 21 cost time: 1.7090325355529785
Epoch: 21, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.249 Vali Acc: 0.125 Test Loss: 3.249 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7385952472686768
Epoch: 22, Steps: 10 | Train Loss: 2.291 Vali Loss: 3.231 Vali Acc: 0.129 Test Loss: 3.231 Test Acc: 0.129
Validation loss decreased (-0.129379 --> -0.129379).  Saving model ...
Epoch: 23 cost time: 1.794508695602417
Epoch: 23, Steps: 10 | Train Loss: 2.177 Vali Loss: 3.227 Vali Acc: 0.126 Test Loss: 3.227 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.662630319595337
Epoch: 24, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.246 Vali Acc: 0.134 Test Loss: 3.246 Test Acc: 0.134
Validation loss decreased (-0.129379 --> -0.134085).  Saving model ...
Epoch: 25 cost time: 1.6985909938812256
Epoch: 25, Steps: 10 | Train Loss: 2.098 Vali Loss: 3.210 Vali Acc: 0.138 Test Loss: 3.210 Test Acc: 0.138
Validation loss decreased (-0.134085 --> -0.137615).  Saving model ...
Epoch: 26 cost time: 1.7588562965393066
Epoch: 26, Steps: 10 | Train Loss: 2.103 Vali Loss: 3.209 Vali Acc: 0.136 Test Loss: 3.209 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7925593852996826
Epoch: 27, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.205 Vali Acc: 0.140 Test Loss: 3.205 Test Acc: 0.140
Validation loss decreased (-0.137615 --> -0.139968).  Saving model ...
Epoch: 28 cost time: 1.7765939235687256
Epoch: 28, Steps: 10 | Train Loss: 1.975 Vali Loss: 3.239 Vali Acc: 0.149 Test Loss: 3.239 Test Acc: 0.149
Validation loss decreased (-0.139968 --> -0.149379).  Saving model ...
Epoch: 29 cost time: 1.9080250263214111
Epoch: 29, Steps: 10 | Train Loss: 1.861 Vali Loss: 3.209 Vali Acc: 0.144 Test Loss: 3.209 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8779115676879883
Epoch: 30, Steps: 10 | Train Loss: 1.782 Vali Loss: 3.211 Vali Acc: 0.145 Test Loss: 3.211 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9610419273376465
Epoch: 31, Steps: 10 | Train Loss: 1.743 Vali Loss: 3.213 Vali Acc: 0.156 Test Loss: 3.213 Test Acc: 0.156
Validation loss decreased (-0.149379 --> -0.156438).  Saving model ...
Epoch: 32 cost time: 1.8169665336608887
Epoch: 32, Steps: 10 | Train Loss: 1.656 Vali Loss: 3.213 Vali Acc: 0.166 Test Loss: 3.213 Test Acc: 0.166
Validation loss decreased (-0.156438 --> -0.165850).  Saving model ...
Epoch: 33 cost time: 1.6887662410736084
Epoch: 33, Steps: 10 | Train Loss: 1.660 Vali Loss: 3.257 Vali Acc: 0.153 Test Loss: 3.257 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.196176052093506
Epoch: 34, Steps: 10 | Train Loss: 1.604 Vali Loss: 3.183 Vali Acc: 0.185 Test Loss: 3.183 Test Acc: 0.185
Validation loss decreased (-0.165850 --> -0.184674).  Saving model ...
Epoch: 35 cost time: 1.6101388931274414
Epoch: 35, Steps: 10 | Train Loss: 1.536 Vali Loss: 3.215 Vali Acc: 0.173 Test Loss: 3.215 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.157003402709961
Epoch: 36, Steps: 10 | Train Loss: 1.451 Vali Loss: 3.270 Vali Acc: 0.166 Test Loss: 3.270 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.698634386062622
Epoch: 37, Steps: 10 | Train Loss: 1.454 Vali Loss: 3.208 Vali Acc: 0.187 Test Loss: 3.208 Test Acc: 0.187
Validation loss decreased (-0.184674 --> -0.187027).  Saving model ...
Epoch: 38 cost time: 1.7997636795043945
Epoch: 38, Steps: 10 | Train Loss: 1.312 Vali Loss: 3.235 Vali Acc: 0.174 Test Loss: 3.235 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.9655630588531494
Epoch: 39, Steps: 10 | Train Loss: 1.233 Vali Loss: 3.205 Vali Acc: 0.195 Test Loss: 3.205 Test Acc: 0.195
Validation loss decreased (-0.187027 --> -0.195262).  Saving model ...
Epoch: 40 cost time: 1.9200634956359863
Epoch: 40, Steps: 10 | Train Loss: 1.171 Vali Loss: 3.240 Vali Acc: 0.185 Test Loss: 3.240 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7067844867706299
Epoch: 41, Steps: 10 | Train Loss: 1.143 Vali Loss: 3.214 Vali Acc: 0.187 Test Loss: 3.214 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8878445625305176
Epoch: 42, Steps: 10 | Train Loss: 1.050 Vali Loss: 3.261 Vali Acc: 0.185 Test Loss: 3.261 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.763350009918213
Epoch: 43, Steps: 10 | Train Loss: 1.030 Vali Loss: 3.252 Vali Acc: 0.191 Test Loss: 3.252 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.788057804107666
Epoch: 44, Steps: 10 | Train Loss: 1.031 Vali Loss: 3.253 Vali Acc: 0.198 Test Loss: 3.253 Test Acc: 0.198
Validation loss decreased (-0.195262 --> -0.197615).  Saving model ...
Epoch: 45 cost time: 1.8205630779266357
Epoch: 45, Steps: 10 | Train Loss: 0.998 Vali Loss: 3.325 Vali Acc: 0.179 Test Loss: 3.325 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.808128833770752
Epoch: 46, Steps: 10 | Train Loss: 0.874 Vali Loss: 3.308 Vali Acc: 0.199 Test Loss: 3.308 Test Acc: 0.199
Validation loss decreased (-0.197615 --> -0.198790).  Saving model ...
Epoch: 47 cost time: 1.8418939113616943
Epoch: 47, Steps: 10 | Train Loss: 0.803 Vali Loss: 3.270 Vali Acc: 0.214 Test Loss: 3.270 Test Acc: 0.214
Validation loss decreased (-0.198790 --> -0.214085).  Saving model ...
Epoch: 48 cost time: 2.0078980922698975
Epoch: 48, Steps: 10 | Train Loss: 0.773 Vali Loss: 3.308 Vali Acc: 0.207 Test Loss: 3.308 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8365442752838135
Epoch: 49, Steps: 10 | Train Loss: 0.664 Vali Loss: 3.273 Vali Acc: 0.222 Test Loss: 3.273 Test Acc: 0.222
Validation loss decreased (-0.214085 --> -0.222320).  Saving model ...
Epoch: 50 cost time: 1.680164098739624
Epoch: 50, Steps: 10 | Train Loss: 0.716 Vali Loss: 3.354 Vali Acc: 0.206 Test Loss: 3.354 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.5956220626831055
Epoch: 51, Steps: 10 | Train Loss: 0.586 Vali Loss: 3.360 Vali Acc: 0.212 Test Loss: 3.360 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.913806438446045
Epoch: 52, Steps: 10 | Train Loss: 0.620 Vali Loss: 3.388 Vali Acc: 0.215 Test Loss: 3.388 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.8794283866882324
Epoch: 53, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.395 Vali Acc: 0.208 Test Loss: 3.395 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.042484998703003
Epoch: 54, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.429 Vali Acc: 0.211 Test Loss: 3.429 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.651529312133789
Epoch: 55, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.415 Vali Acc: 0.224 Test Loss: 3.415 Test Acc: 0.224
Validation loss decreased (-0.222320 --> -0.223495).  Saving model ...
Epoch: 56 cost time: 1.5706169605255127
Epoch: 56, Steps: 10 | Train Loss: 0.411 Vali Loss: 3.413 Vali Acc: 0.234 Test Loss: 3.413 Test Acc: 0.234
Validation loss decreased (-0.223495 --> -0.234084).  Saving model ...
Epoch: 57 cost time: 2.301607131958008
Epoch: 57, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.441 Vali Acc: 0.222 Test Loss: 3.441 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.8236455917358398
Epoch: 58, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.434 Vali Acc: 0.225 Test Loss: 3.434 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.953465461730957
Epoch: 59, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.558 Vali Acc: 0.229 Test Loss: 3.558 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.6794862747192383
Epoch: 60, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.483 Vali Acc: 0.254 Test Loss: 3.483 Test Acc: 0.254
Validation loss decreased (-0.234084 --> -0.254083).  Saving model ...
Epoch: 61 cost time: 1.542278528213501
Epoch: 61, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.520 Vali Acc: 0.235 Test Loss: 3.520 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.8140580654144287
Epoch: 62, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.564 Vali Acc: 0.241 Test Loss: 3.564 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.889704704284668
Epoch: 63, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.597 Vali Acc: 0.233 Test Loss: 3.597 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 2.0317296981811523
Epoch: 64, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.606 Vali Acc: 0.248 Test Loss: 3.606 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.516998529434204
Epoch: 65, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.618 Vali Acc: 0.244 Test Loss: 3.618 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.8643991947174072
Epoch: 66, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.608 Vali Acc: 0.241 Test Loss: 3.608 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.9836461544036865
Epoch: 67, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.632 Vali Acc: 0.245 Test Loss: 3.632 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.5181922912597656
Epoch: 68, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.715 Vali Acc: 0.235 Test Loss: 3.715 Test Acc: 0.235
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.7214529514312744
Epoch: 69, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.696 Vali Acc: 0.233 Test Loss: 3.696 Test Acc: 0.233
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 1.77229642868042
Epoch: 70, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.781 Vali Acc: 0.240 Test Loss: 3.781 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 315158
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5151078701019287
Epoch: 1, Steps: 10 | Train Loss: 3.414 Vali Loss: 3.410 Vali Acc: 0.049 Test Loss: 3.410 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 1.5366902351379395
Epoch: 2, Steps: 10 | Train Loss: 3.382 Vali Loss: 3.360 Vali Acc: 0.047 Test Loss: 3.360 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.772676944732666
Epoch: 3, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.322 Vali Acc: 0.056 Test Loss: 3.322 Test Acc: 0.056
Validation loss decreased (-0.049378 --> -0.056437).  Saving model ...
Epoch: 4 cost time: 1.7238974571228027
Epoch: 4, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.297 Vali Acc: 0.056 Test Loss: 3.297 Test Acc: 0.056
Validation loss decreased (-0.056437 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 1.7550897598266602
Epoch: 5, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.293 Vali Acc: 0.062 Test Loss: 3.293 Test Acc: 0.062
Validation loss decreased (-0.056438 --> -0.062320).  Saving model ...
Epoch: 6 cost time: 1.6055834293365479
Epoch: 6, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.291 Vali Acc: 0.067 Test Loss: 3.291 Test Acc: 0.067
Validation loss decreased (-0.062320 --> -0.067026).  Saving model ...
Epoch: 7 cost time: 2.038093090057373
Epoch: 7, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.299 Vali Acc: 0.060 Test Loss: 3.299 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8081307411193848
Epoch: 8, Steps: 10 | Train Loss: 3.125 Vali Loss: 3.305 Vali Acc: 0.073 Test Loss: 3.305 Test Acc: 0.073
Validation loss decreased (-0.067026 --> -0.072908).  Saving model ...
Epoch: 9 cost time: 1.5989103317260742
Epoch: 9, Steps: 10 | Train Loss: 3.044 Vali Loss: 3.298 Vali Acc: 0.074 Test Loss: 3.298 Test Acc: 0.074
Validation loss decreased (-0.072908 --> -0.074085).  Saving model ...
Epoch: 10 cost time: 1.6281018257141113
Epoch: 10, Steps: 10 | Train Loss: 3.054 Vali Loss: 3.292 Vali Acc: 0.085 Test Loss: 3.292 Test Acc: 0.085
Validation loss decreased (-0.074085 --> -0.084673).  Saving model ...
Epoch: 11 cost time: 1.8075382709503174
Epoch: 11, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.295 Vali Acc: 0.073 Test Loss: 3.295 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.083404779434204
Epoch: 12, Steps: 10 | Train Loss: 2.973 Vali Loss: 3.282 Vali Acc: 0.081 Test Loss: 3.282 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6880629062652588
Epoch: 13, Steps: 10 | Train Loss: 2.889 Vali Loss: 3.281 Vali Acc: 0.082 Test Loss: 3.281 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.538426399230957
Epoch: 14, Steps: 10 | Train Loss: 2.867 Vali Loss: 3.262 Vali Acc: 0.086 Test Loss: 3.262 Test Acc: 0.086
Validation loss decreased (-0.084673 --> -0.085850).  Saving model ...
Epoch: 15 cost time: 1.4814608097076416
Epoch: 15, Steps: 10 | Train Loss: 2.850 Vali Loss: 3.259 Vali Acc: 0.095 Test Loss: 3.259 Test Acc: 0.095
Validation loss decreased (-0.085850 --> -0.095262).  Saving model ...
Epoch: 16 cost time: 1.574355125427246
Epoch: 16, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.245 Vali Acc: 0.098 Test Loss: 3.245 Test Acc: 0.098
Validation loss decreased (-0.095262 --> -0.097615).  Saving model ...
Epoch: 17 cost time: 1.803584337234497
Epoch: 17, Steps: 10 | Train Loss: 2.609 Vali Loss: 3.235 Vali Acc: 0.101 Test Loss: 3.235 Test Acc: 0.101
Validation loss decreased (-0.097615 --> -0.101144).  Saving model ...
Epoch: 18 cost time: 1.545724630355835
Epoch: 18, Steps: 10 | Train Loss: 2.588 Vali Loss: 3.242 Vali Acc: 0.111 Test Loss: 3.242 Test Acc: 0.111
Validation loss decreased (-0.101144 --> -0.110556).  Saving model ...
Epoch: 19 cost time: 1.4283196926116943
Epoch: 19, Steps: 10 | Train Loss: 2.529 Vali Loss: 3.237 Vali Acc: 0.112 Test Loss: 3.237 Test Acc: 0.112
Validation loss decreased (-0.110556 --> -0.111732).  Saving model ...
Epoch: 20 cost time: 1.831742286682129
Epoch: 20, Steps: 10 | Train Loss: 2.514 Vali Loss: 3.244 Vali Acc: 0.109 Test Loss: 3.244 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8121800422668457
Epoch: 21, Steps: 10 | Train Loss: 2.411 Vali Loss: 3.214 Vali Acc: 0.109 Test Loss: 3.214 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.77394700050354
Epoch: 22, Steps: 10 | Train Loss: 2.446 Vali Loss: 3.216 Vali Acc: 0.112 Test Loss: 3.216 Test Acc: 0.112
Validation loss decreased (-0.111732 --> -0.111733).  Saving model ...
Epoch: 23 cost time: 1.860252857208252
Epoch: 23, Steps: 10 | Train Loss: 2.317 Vali Loss: 3.204 Vali Acc: 0.119 Test Loss: 3.204 Test Acc: 0.119
Validation loss decreased (-0.111733 --> -0.118791).  Saving model ...
Epoch: 24 cost time: 1.8866090774536133
Epoch: 24, Steps: 10 | Train Loss: 2.242 Vali Loss: 3.212 Vali Acc: 0.131 Test Loss: 3.212 Test Acc: 0.131
Validation loss decreased (-0.118791 --> -0.130556).  Saving model ...
Epoch: 25 cost time: 1.658637523651123
Epoch: 25, Steps: 10 | Train Loss: 2.254 Vali Loss: 3.214 Vali Acc: 0.128 Test Loss: 3.214 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8238494396209717
Epoch: 26, Steps: 10 | Train Loss: 2.132 Vali Loss: 3.218 Vali Acc: 0.122 Test Loss: 3.218 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5102629661560059
Epoch: 27, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.198 Vali Acc: 0.126 Test Loss: 3.198 Test Acc: 0.126
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8058207035064697
Epoch: 28, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.209 Vali Acc: 0.126 Test Loss: 3.209 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8308379650115967
Epoch: 29, Steps: 10 | Train Loss: 1.971 Vali Loss: 3.196 Vali Acc: 0.149 Test Loss: 3.196 Test Acc: 0.149
Validation loss decreased (-0.130556 --> -0.149380).  Saving model ...
Epoch: 30 cost time: 1.8383128643035889
Epoch: 30, Steps: 10 | Train Loss: 1.971 Vali Loss: 3.221 Vali Acc: 0.142 Test Loss: 3.221 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8711791038513184
Epoch: 31, Steps: 10 | Train Loss: 1.855 Vali Loss: 3.192 Vali Acc: 0.147 Test Loss: 3.192 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6519699096679688
Epoch: 32, Steps: 10 | Train Loss: 1.815 Vali Loss: 3.204 Vali Acc: 0.145 Test Loss: 3.204 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6060574054718018
Epoch: 33, Steps: 10 | Train Loss: 1.747 Vali Loss: 3.209 Vali Acc: 0.148 Test Loss: 3.209 Test Acc: 0.148
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.9709973335266113
Epoch: 34, Steps: 10 | Train Loss: 1.684 Vali Loss: 3.229 Vali Acc: 0.156 Test Loss: 3.229 Test Acc: 0.156
Validation loss decreased (-0.149380 --> -0.156438).  Saving model ...
Epoch: 35 cost time: 1.747025966644287
Epoch: 35, Steps: 10 | Train Loss: 1.602 Vali Loss: 3.226 Vali Acc: 0.145 Test Loss: 3.226 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8823566436767578
Epoch: 36, Steps: 10 | Train Loss: 1.536 Vali Loss: 3.212 Vali Acc: 0.164 Test Loss: 3.212 Test Acc: 0.164
Validation loss decreased (-0.156438 --> -0.163497).  Saving model ...
Epoch: 37 cost time: 1.672020435333252
Epoch: 37, Steps: 10 | Train Loss: 1.515 Vali Loss: 3.237 Vali Acc: 0.166 Test Loss: 3.237 Test Acc: 0.166
Validation loss decreased (-0.163497 --> -0.165850).  Saving model ...
Epoch: 38 cost time: 1.6649434566497803
Epoch: 38, Steps: 10 | Train Loss: 1.379 Vali Loss: 3.244 Vali Acc: 0.158 Test Loss: 3.244 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.9491868019104004
Epoch: 39, Steps: 10 | Train Loss: 1.370 Vali Loss: 3.240 Vali Acc: 0.156 Test Loss: 3.240 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.870323657989502
Epoch: 40, Steps: 10 | Train Loss: 1.333 Vali Loss: 3.286 Vali Acc: 0.166 Test Loss: 3.286 Test Acc: 0.166
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.7278273105621338
Epoch: 41, Steps: 10 | Train Loss: 1.287 Vali Loss: 3.239 Vali Acc: 0.168 Test Loss: 3.239 Test Acc: 0.168
Validation loss decreased (-0.165850 --> -0.168203).  Saving model ...
Epoch: 42 cost time: 1.651505947113037
Epoch: 42, Steps: 10 | Train Loss: 1.190 Vali Loss: 3.272 Vali Acc: 0.153 Test Loss: 3.272 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.6612718105316162
Epoch: 43, Steps: 10 | Train Loss: 1.133 Vali Loss: 3.324 Vali Acc: 0.169 Test Loss: 3.324 Test Acc: 0.169
Validation loss decreased (-0.168203 --> -0.169379).  Saving model ...
Epoch: 44 cost time: 1.9530003070831299
Epoch: 44, Steps: 10 | Train Loss: 1.132 Vali Loss: 3.366 Vali Acc: 0.160 Test Loss: 3.366 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6212074756622314
Epoch: 45, Steps: 10 | Train Loss: 1.082 Vali Loss: 3.328 Vali Acc: 0.173 Test Loss: 3.328 Test Acc: 0.173
Validation loss decreased (-0.169379 --> -0.172908).  Saving model ...
Epoch: 46 cost time: 1.7093374729156494
Epoch: 46, Steps: 10 | Train Loss: 0.916 Vali Loss: 3.302 Vali Acc: 0.169 Test Loss: 3.302 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.58609938621521
Epoch: 47, Steps: 10 | Train Loss: 0.895 Vali Loss: 3.372 Vali Acc: 0.173 Test Loss: 3.372 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.6552484035491943
Epoch: 48, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.331 Vali Acc: 0.194 Test Loss: 3.331 Test Acc: 0.194
Validation loss decreased (-0.172908 --> -0.194084).  Saving model ...
Epoch: 49 cost time: 1.6662311553955078
Epoch: 49, Steps: 10 | Train Loss: 0.838 Vali Loss: 3.396 Vali Acc: 0.173 Test Loss: 3.396 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.7180533409118652
Epoch: 50, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.344 Vali Acc: 0.180 Test Loss: 3.344 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.8073573112487793
Epoch: 51, Steps: 10 | Train Loss: 0.712 Vali Loss: 3.397 Vali Acc: 0.180 Test Loss: 3.397 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.700711727142334
Epoch: 52, Steps: 10 | Train Loss: 0.638 Vali Loss: 3.367 Vali Acc: 0.188 Test Loss: 3.367 Test Acc: 0.188
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.9243206977844238
Epoch: 53, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.437 Vali Acc: 0.195 Test Loss: 3.437 Test Acc: 0.195
Validation loss decreased (-0.194084 --> -0.195260).  Saving model ...
Epoch: 54 cost time: 1.5818138122558594
Epoch: 54, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.401 Vali Acc: 0.188 Test Loss: 3.401 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.5778539180755615
Epoch: 55, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.440 Vali Acc: 0.201 Test Loss: 3.440 Test Acc: 0.201
Validation loss decreased (-0.195260 --> -0.201142).  Saving model ...
Epoch: 56 cost time: 1.509634017944336
Epoch: 56, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.450 Vali Acc: 0.174 Test Loss: 3.450 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.7136034965515137
Epoch: 57, Steps: 10 | Train Loss: 0.463 Vali Loss: 3.472 Vali Acc: 0.182 Test Loss: 3.472 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.6762018203735352
Epoch: 58, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.496 Vali Acc: 0.193 Test Loss: 3.496 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.5462727546691895
Epoch: 59, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.522 Vali Acc: 0.189 Test Loss: 3.522 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.7047274112701416
Epoch: 60, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.521 Vali Acc: 0.199 Test Loss: 3.521 Test Acc: 0.199
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.6127490997314453
Epoch: 61, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.593 Vali Acc: 0.186 Test Loss: 3.593 Test Acc: 0.186
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.6505162715911865
Epoch: 62, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.586 Vali Acc: 0.189 Test Loss: 3.586 Test Acc: 0.189
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.6051356792449951
Epoch: 63, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.630 Vali Acc: 0.186 Test Loss: 3.630 Test Acc: 0.186
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.5978143215179443
Epoch: 64, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.623 Vali Acc: 0.194 Test Loss: 3.623 Test Acc: 0.194
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.737262487411499
Epoch: 65, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.663 Vali Acc: 0.206 Test Loss: 3.663 Test Acc: 0.206
Validation loss decreased (-0.201142 --> -0.205846).  Saving model ...
Epoch: 66 cost time: 1.878230333328247
Epoch: 66, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.727 Vali Acc: 0.200 Test Loss: 3.727 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.9157018661499023
Epoch: 67, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.720 Vali Acc: 0.202 Test Loss: 3.720 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.9279794692993164
Epoch: 68, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.719 Vali Acc: 0.195 Test Loss: 3.719 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.5991580486297607
Epoch: 69, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.749 Vali Acc: 0.202 Test Loss: 3.749 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.9230701923370361
Epoch: 70, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.773 Vali Acc: 0.207 Test Loss: 3.773 Test Acc: 0.207
Validation loss decreased (-0.205846 --> -0.207021).  Saving model ...
Epoch: 71 cost time: 1.620431661605835
Epoch: 71, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.783 Vali Acc: 0.191 Test Loss: 3.783 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.7096278667449951
Epoch: 72, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.849 Vali Acc: 0.199 Test Loss: 3.849 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 2.2818150520324707
Epoch: 73, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.907 Vali Acc: 0.186 Test Loss: 3.907 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.9054136276245117
Epoch: 74, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.877 Vali Acc: 0.198 Test Loss: 3.877 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 2.419808864593506
Epoch: 75, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.903 Vali Acc: 0.207 Test Loss: 3.903 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 2.3022713661193848
Epoch: 76, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.933 Vali Acc: 0.202 Test Loss: 3.933 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 2.453653335571289
Epoch: 77, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.936 Vali Acc: 0.201 Test Loss: 3.936 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 2.673877716064453
Epoch: 78, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.971 Vali Acc: 0.200 Test Loss: 3.971 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 2.2144408226013184
Epoch: 79, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.946 Vali Acc: 0.202 Test Loss: 3.946 Test Acc: 0.202
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 2.5927274227142334
Epoch: 80, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.962 Vali Acc: 0.212 Test Loss: 3.962 Test Acc: 0.212
Validation loss decreased (-0.207021 --> -0.211725).  Saving model ...
Epoch: 81 cost time: 2.244694232940674
Epoch: 81, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.028 Vali Acc: 0.212 Test Loss: 4.028 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 2.3107755184173584
Epoch: 82, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.999 Vali Acc: 0.208 Test Loss: 3.999 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 2.0916662216186523
Epoch: 83, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.982 Vali Acc: 0.213 Test Loss: 3.982 Test Acc: 0.213
Validation loss decreased (-0.211725 --> -0.212901).  Saving model ...
Epoch: 84 cost time: 2.353142023086548
Epoch: 84, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.014 Vali Acc: 0.218 Test Loss: 4.014 Test Acc: 0.218
Validation loss decreased (-0.212901 --> -0.217607).  Saving model ...
Epoch: 85 cost time: 2.043555736541748
Epoch: 85, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.071 Vali Acc: 0.208 Test Loss: 4.071 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 2.427302122116089
Epoch: 86, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.060 Vali Acc: 0.214 Test Loss: 4.060 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.978672981262207
Epoch: 87, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.115 Vali Acc: 0.206 Test Loss: 4.115 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 2.2605206966400146
Epoch: 88, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.127 Vali Acc: 0.211 Test Loss: 4.127 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 2.1141388416290283
Epoch: 89, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.092 Vali Acc: 0.211 Test Loss: 4.092 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 2.3367679119110107
Epoch: 90, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.098 Vali Acc: 0.208 Test Loss: 4.098 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 2.4562718868255615
Epoch: 91, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.159 Vali Acc: 0.202 Test Loss: 4.159 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 1.7471678256988525
Epoch: 92, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.188 Vali Acc: 0.209 Test Loss: 4.188 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 2.302598237991333
Epoch: 93, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.189 Vali Acc: 0.201 Test Loss: 4.189 Test Acc: 0.201
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 2.3181240558624268
Epoch: 94, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.186 Vali Acc: 0.195 Test Loss: 4.186 Test Acc: 0.195
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21764705882352942
model parameter : 242774
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.8733890056610107
Epoch: 1, Steps: 10 | Train Loss: 3.447 Vali Loss: 3.413 Vali Acc: 0.042 Test Loss: 3.413 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 2.03021502494812
Epoch: 2, Steps: 10 | Train Loss: 3.375 Vali Loss: 3.350 Vali Acc: 0.044 Test Loss: 3.350 Test Acc: 0.044
Validation loss decreased (-0.042319 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 1.7221882343292236
Epoch: 3, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.324 Vali Acc: 0.056 Test Loss: 3.324 Test Acc: 0.056
Validation loss decreased (-0.043496 --> -0.056437).  Saving model ...
Epoch: 4 cost time: 1.880375623703003
Epoch: 4, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.322 Vali Acc: 0.051 Test Loss: 3.322 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.847153902053833
Epoch: 5, Steps: 10 | Train Loss: 3.143 Vali Loss: 3.323 Vali Acc: 0.046 Test Loss: 3.323 Test Acc: 0.046
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.174065351486206
Epoch: 6, Steps: 10 | Train Loss: 3.194 Vali Loss: 3.324 Vali Acc: 0.048 Test Loss: 3.324 Test Acc: 0.048
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9164948463439941
Epoch: 7, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.320 Vali Acc: 0.051 Test Loss: 3.320 Test Acc: 0.051
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2798914909362793
Epoch: 8, Steps: 10 | Train Loss: 3.105 Vali Loss: 3.326 Vali Acc: 0.051 Test Loss: 3.326 Test Acc: 0.051
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2272732257843018
Epoch: 9, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.337 Vali Acc: 0.052 Test Loss: 3.337 Test Acc: 0.052
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1399877071380615
Epoch: 10, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.314 Vali Acc: 0.061 Test Loss: 3.314 Test Acc: 0.061
Validation loss decreased (-0.056437 --> -0.061143).  Saving model ...
Epoch: 11 cost time: 2.2459089756011963
Epoch: 11, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.313 Vali Acc: 0.071 Test Loss: 3.313 Test Acc: 0.071
Validation loss decreased (-0.061143 --> -0.070555).  Saving model ...
Epoch: 12 cost time: 2.6474156379699707
Epoch: 12, Steps: 10 | Train Loss: 2.987 Vali Loss: 3.310 Vali Acc: 0.071 Test Loss: 3.310 Test Acc: 0.071
Validation loss decreased (-0.070555 --> -0.070555).  Saving model ...
Epoch: 13 cost time: 2.369788408279419
Epoch: 13, Steps: 10 | Train Loss: 2.952 Vali Loss: 3.318 Vali Acc: 0.071 Test Loss: 3.318 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9628803730010986
Epoch: 14, Steps: 10 | Train Loss: 2.839 Vali Loss: 3.320 Vali Acc: 0.076 Test Loss: 3.320 Test Acc: 0.076
Validation loss decreased (-0.070555 --> -0.076437).  Saving model ...
Epoch: 15 cost time: 1.9504706859588623
Epoch: 15, Steps: 10 | Train Loss: 2.818 Vali Loss: 3.312 Vali Acc: 0.081 Test Loss: 3.312 Test Acc: 0.081
Validation loss decreased (-0.076437 --> -0.081143).  Saving model ...
Epoch: 16 cost time: 2.1476757526397705
Epoch: 16, Steps: 10 | Train Loss: 2.817 Vali Loss: 3.290 Vali Acc: 0.076 Test Loss: 3.290 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.270500898361206
Epoch: 17, Steps: 10 | Train Loss: 2.784 Vali Loss: 3.291 Vali Acc: 0.078 Test Loss: 3.291 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9908549785614014
Epoch: 18, Steps: 10 | Train Loss: 2.707 Vali Loss: 3.298 Vali Acc: 0.085 Test Loss: 3.298 Test Acc: 0.085
Validation loss decreased (-0.081143 --> -0.084673).  Saving model ...
Epoch: 19 cost time: 2.583395481109619
Epoch: 19, Steps: 10 | Train Loss: 2.629 Vali Loss: 3.298 Vali Acc: 0.087 Test Loss: 3.298 Test Acc: 0.087
Validation loss decreased (-0.084673 --> -0.087026).  Saving model ...
Epoch: 20 cost time: 1.8002874851226807
Epoch: 20, Steps: 10 | Train Loss: 2.553 Vali Loss: 3.294 Vali Acc: 0.098 Test Loss: 3.294 Test Acc: 0.098
Validation loss decreased (-0.087026 --> -0.097614).  Saving model ...
Epoch: 21 cost time: 2.2373569011688232
Epoch: 21, Steps: 10 | Train Loss: 2.535 Vali Loss: 3.292 Vali Acc: 0.107 Test Loss: 3.292 Test Acc: 0.107
Validation loss decreased (-0.097614 --> -0.107026).  Saving model ...
Epoch: 22 cost time: 1.5767700672149658
Epoch: 22, Steps: 10 | Train Loss: 2.486 Vali Loss: 3.303 Vali Acc: 0.104 Test Loss: 3.303 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7752299308776855
Epoch: 23, Steps: 10 | Train Loss: 2.409 Vali Loss: 3.292 Vali Acc: 0.104 Test Loss: 3.292 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9863154888153076
Epoch: 24, Steps: 10 | Train Loss: 2.331 Vali Loss: 3.299 Vali Acc: 0.102 Test Loss: 3.299 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9276113510131836
Epoch: 25, Steps: 10 | Train Loss: 2.267 Vali Loss: 3.283 Vali Acc: 0.105 Test Loss: 3.283 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0427119731903076
Epoch: 26, Steps: 10 | Train Loss: 2.213 Vali Loss: 3.282 Vali Acc: 0.109 Test Loss: 3.282 Test Acc: 0.109
Validation loss decreased (-0.107026 --> -0.109379).  Saving model ...
Epoch: 27 cost time: 2.123124122619629
Epoch: 27, Steps: 10 | Train Loss: 2.184 Vali Loss: 3.295 Vali Acc: 0.114 Test Loss: 3.295 Test Acc: 0.114
Validation loss decreased (-0.109379 --> -0.114085).  Saving model ...
Epoch: 28 cost time: 2.477783679962158
Epoch: 28, Steps: 10 | Train Loss: 2.110 Vali Loss: 3.298 Vali Acc: 0.121 Test Loss: 3.298 Test Acc: 0.121
Validation loss decreased (-0.114085 --> -0.121143).  Saving model ...
Epoch: 29 cost time: 1.960348129272461
Epoch: 29, Steps: 10 | Train Loss: 2.028 Vali Loss: 3.276 Vali Acc: 0.132 Test Loss: 3.276 Test Acc: 0.132
Validation loss decreased (-0.121143 --> -0.131732).  Saving model ...
Epoch: 30 cost time: 1.9000029563903809
Epoch: 30, Steps: 10 | Train Loss: 1.984 Vali Loss: 3.259 Vali Acc: 0.126 Test Loss: 3.259 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9382481575012207
Epoch: 31, Steps: 10 | Train Loss: 1.927 Vali Loss: 3.296 Vali Acc: 0.128 Test Loss: 3.296 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.799220085144043
Epoch: 32, Steps: 10 | Train Loss: 1.812 Vali Loss: 3.293 Vali Acc: 0.136 Test Loss: 3.293 Test Acc: 0.136
Validation loss decreased (-0.131732 --> -0.136438).  Saving model ...
Epoch: 33 cost time: 1.8495450019836426
Epoch: 33, Steps: 10 | Train Loss: 1.774 Vali Loss: 3.280 Vali Acc: 0.132 Test Loss: 3.280 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.009361982345581
Epoch: 34, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.302 Vali Acc: 0.138 Test Loss: 3.302 Test Acc: 0.138
Validation loss decreased (-0.136438 --> -0.137614).  Saving model ...
Epoch: 35 cost time: 2.0335469245910645
Epoch: 35, Steps: 10 | Train Loss: 1.639 Vali Loss: 3.267 Vali Acc: 0.152 Test Loss: 3.267 Test Acc: 0.152
Validation loss decreased (-0.137614 --> -0.151732).  Saving model ...
Epoch: 36 cost time: 1.8351209163665771
Epoch: 36, Steps: 10 | Train Loss: 1.576 Vali Loss: 3.287 Vali Acc: 0.151 Test Loss: 3.287 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4071202278137207
Epoch: 37, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.320 Vali Acc: 0.147 Test Loss: 3.320 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.681802749633789
Epoch: 38, Steps: 10 | Train Loss: 1.446 Vali Loss: 3.295 Vali Acc: 0.159 Test Loss: 3.295 Test Acc: 0.159
Validation loss decreased (-0.151732 --> -0.158791).  Saving model ...
Epoch: 39 cost time: 2.024571657180786
Epoch: 39, Steps: 10 | Train Loss: 1.417 Vali Loss: 3.330 Vali Acc: 0.155 Test Loss: 3.330 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.083242416381836
Epoch: 40, Steps: 10 | Train Loss: 1.311 Vali Loss: 3.314 Vali Acc: 0.164 Test Loss: 3.314 Test Acc: 0.164
Validation loss decreased (-0.158791 --> -0.163496).  Saving model ...
Epoch: 41 cost time: 2.021080255508423
Epoch: 41, Steps: 10 | Train Loss: 1.280 Vali Loss: 3.323 Vali Acc: 0.173 Test Loss: 3.323 Test Acc: 0.173
Validation loss decreased (-0.163496 --> -0.172908).  Saving model ...
Epoch: 42 cost time: 1.7108404636383057
Epoch: 42, Steps: 10 | Train Loss: 1.195 Vali Loss: 3.321 Vali Acc: 0.164 Test Loss: 3.321 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.0525851249694824
Epoch: 43, Steps: 10 | Train Loss: 1.118 Vali Loss: 3.305 Vali Acc: 0.175 Test Loss: 3.305 Test Acc: 0.175
Validation loss decreased (-0.172908 --> -0.175261).  Saving model ...
Epoch: 44 cost time: 2.1141114234924316
Epoch: 44, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.306 Vali Acc: 0.185 Test Loss: 3.306 Test Acc: 0.185
Validation loss decreased (-0.175261 --> -0.184673).  Saving model ...
Epoch: 45 cost time: 1.8660366535186768
Epoch: 45, Steps: 10 | Train Loss: 1.032 Vali Loss: 3.361 Vali Acc: 0.186 Test Loss: 3.361 Test Acc: 0.186
Validation loss decreased (-0.184673 --> -0.185849).  Saving model ...
Epoch: 46 cost time: 1.7396631240844727
Epoch: 46, Steps: 10 | Train Loss: 1.005 Vali Loss: 3.380 Vali Acc: 0.178 Test Loss: 3.380 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.1464381217956543
Epoch: 47, Steps: 10 | Train Loss: 0.907 Vali Loss: 3.347 Vali Acc: 0.189 Test Loss: 3.347 Test Acc: 0.189
Validation loss decreased (-0.185849 --> -0.189378).  Saving model ...
Epoch: 48 cost time: 1.8710203170776367
Epoch: 48, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.420 Vali Acc: 0.168 Test Loss: 3.420 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.7310817241668701
Epoch: 49, Steps: 10 | Train Loss: 0.747 Vali Loss: 3.424 Vali Acc: 0.187 Test Loss: 3.424 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.562859296798706
Epoch: 50, Steps: 10 | Train Loss: 0.806 Vali Loss: 3.405 Vali Acc: 0.184 Test Loss: 3.405 Test Acc: 0.184
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.9875741004943848
Epoch: 51, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.484 Vali Acc: 0.186 Test Loss: 3.484 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.0167593955993652
Epoch: 52, Steps: 10 | Train Loss: 0.664 Vali Loss: 3.449 Vali Acc: 0.204 Test Loss: 3.449 Test Acc: 0.204
Validation loss decreased (-0.189378 --> -0.203495).  Saving model ...
Epoch: 53 cost time: 1.9434318542480469
Epoch: 53, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.432 Vali Acc: 0.189 Test Loss: 3.432 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.7845008373260498
Epoch: 54, Steps: 10 | Train Loss: 0.576 Vali Loss: 3.480 Vali Acc: 0.207 Test Loss: 3.480 Test Acc: 0.207
Validation loss decreased (-0.203495 --> -0.207024).  Saving model ...
Epoch: 55 cost time: 1.7200672626495361
Epoch: 55, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.462 Vali Acc: 0.205 Test Loss: 3.462 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.6659815311431885
Epoch: 56, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.552 Vali Acc: 0.209 Test Loss: 3.552 Test Acc: 0.209
Validation loss decreased (-0.207024 --> -0.209376).  Saving model ...
Epoch: 57 cost time: 1.8221971988677979
Epoch: 57, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.520 Vali Acc: 0.212 Test Loss: 3.520 Test Acc: 0.212
Validation loss decreased (-0.209376 --> -0.211730).  Saving model ...
Epoch: 58 cost time: 1.889864444732666
Epoch: 58, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.534 Vali Acc: 0.205 Test Loss: 3.534 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.8903019428253174
Epoch: 59, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.544 Vali Acc: 0.204 Test Loss: 3.544 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.112863540649414
Epoch: 60, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.576 Vali Acc: 0.208 Test Loss: 3.576 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.80839204788208
Epoch: 61, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.621 Vali Acc: 0.207 Test Loss: 3.621 Test Acc: 0.207
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 2.642191171646118
Epoch: 62, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.627 Vali Acc: 0.213 Test Loss: 3.627 Test Acc: 0.213
Validation loss decreased (-0.211730 --> -0.212905).  Saving model ...
Epoch: 63 cost time: 1.9918601512908936
Epoch: 63, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.652 Vali Acc: 0.211 Test Loss: 3.652 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.74977445602417
Epoch: 64, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.730 Vali Acc: 0.215 Test Loss: 3.730 Test Acc: 0.215
Validation loss decreased (-0.212905 --> -0.215257).  Saving model ...
Epoch: 65 cost time: 1.9409079551696777
Epoch: 65, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.736 Vali Acc: 0.213 Test Loss: 3.736 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.9201464653015137
Epoch: 66, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.804 Vali Acc: 0.213 Test Loss: 3.804 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.246310234069824
Epoch: 67, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.795 Vali Acc: 0.212 Test Loss: 3.795 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.9112701416015625
Epoch: 68, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.923 Vali Acc: 0.211 Test Loss: 3.923 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.8918142318725586
Epoch: 69, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.839 Vali Acc: 0.224 Test Loss: 3.839 Test Acc: 0.224
Validation loss decreased (-0.215257 --> -0.223491).  Saving model ...
Epoch: 70 cost time: 1.8493156433105469
Epoch: 70, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.909 Vali Acc: 0.216 Test Loss: 3.909 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.523998737335205
Epoch: 71, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.898 Vali Acc: 0.213 Test Loss: 3.898 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.678008794784546
Epoch: 72, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.911 Vali Acc: 0.226 Test Loss: 3.911 Test Acc: 0.226
Validation loss decreased (-0.223491 --> -0.225843).  Saving model ...
Epoch: 73 cost time: 1.692337989807129
Epoch: 73, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.883 Vali Acc: 0.208 Test Loss: 3.883 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.720963954925537
Epoch: 74, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.912 Vali Acc: 0.222 Test Loss: 3.912 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 2.392080307006836
Epoch: 75, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.970 Vali Acc: 0.222 Test Loss: 3.970 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 2.1498703956604004
Epoch: 76, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.950 Vali Acc: 0.225 Test Loss: 3.950 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.8373565673828125
Epoch: 77, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.983 Vali Acc: 0.222 Test Loss: 3.983 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 2.160923719406128
Epoch: 78, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.996 Vali Acc: 0.224 Test Loss: 3.996 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 2.2642693519592285
Epoch: 79, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.057 Vali Acc: 0.222 Test Loss: 4.057 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 2.1207478046417236
Epoch: 80, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.077 Vali Acc: 0.222 Test Loss: 4.077 Test Acc: 0.222
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 2.12080454826355
Epoch: 81, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.030 Vali Acc: 0.224 Test Loss: 4.030 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 1.8299014568328857
Epoch: 82, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.039 Vali Acc: 0.229 Test Loss: 4.039 Test Acc: 0.229
Validation loss decreased (-0.225843 --> -0.229371).  Saving model ...
Epoch: 83 cost time: 2.0110154151916504
Epoch: 83, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.060 Vali Acc: 0.224 Test Loss: 4.060 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 2.1542880535125732
Epoch: 84, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.101 Vali Acc: 0.228 Test Loss: 4.101 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 2.2192537784576416
Epoch: 85, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.126 Vali Acc: 0.229 Test Loss: 4.126 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 1.853031873703003
Epoch: 86, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.204 Vali Acc: 0.218 Test Loss: 4.204 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 1.8123583793640137
Epoch: 87, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.100 Vali Acc: 0.222 Test Loss: 4.100 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 2.3273489475250244
Epoch: 88, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.165 Vali Acc: 0.225 Test Loss: 4.165 Test Acc: 0.225
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 1.7011380195617676
Epoch: 89, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.133 Vali Acc: 0.227 Test Loss: 4.133 Test Acc: 0.227
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 1.8600170612335205
Epoch: 90, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.201 Vali Acc: 0.221 Test Loss: 4.201 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 2.2063708305358887
Epoch: 91, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.160 Vali Acc: 0.229 Test Loss: 4.160 Test Acc: 0.229
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 2.691049098968506
Epoch: 92, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.179 Vali Acc: 0.229 Test Loss: 4.179 Test Acc: 0.229
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22941176470588234
model parameter : 241942
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.429469108581543
Epoch: 1, Steps: 10 | Train Loss: 3.448 Vali Loss: 3.405 Vali Acc: 0.039 Test Loss: 3.405 Test Acc: 0.039
Validation loss decreased (inf --> -0.038789).  Saving model ...
Epoch: 2 cost time: 1.823364019393921
Epoch: 2, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.355 Vali Acc: 0.040 Test Loss: 3.355 Test Acc: 0.040
Validation loss decreased (-0.038789 --> -0.039966).  Saving model ...
Epoch: 3 cost time: 1.5590627193450928
Epoch: 3, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.318 Vali Acc: 0.036 Test Loss: 3.318 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8147497177124023
Epoch: 4, Steps: 10 | Train Loss: 3.268 Vali Loss: 3.310 Vali Acc: 0.047 Test Loss: 3.310 Test Acc: 0.047
Validation loss decreased (-0.039966 --> -0.047026).  Saving model ...
Epoch: 5 cost time: 2.3480634689331055
Epoch: 5, Steps: 10 | Train Loss: 3.161 Vali Loss: 3.312 Vali Acc: 0.048 Test Loss: 3.312 Test Acc: 0.048
Validation loss decreased (-0.047026 --> -0.048202).  Saving model ...
Epoch: 6 cost time: 1.6336300373077393
Epoch: 6, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.323 Vali Acc: 0.051 Test Loss: 3.323 Test Acc: 0.051
Validation loss decreased (-0.048202 --> -0.050555).  Saving model ...
Epoch: 7 cost time: 1.9783656597137451
Epoch: 7, Steps: 10 | Train Loss: 3.181 Vali Loss: 3.327 Vali Acc: 0.048 Test Loss: 3.327 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8155226707458496
Epoch: 8, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.316 Vali Acc: 0.049 Test Loss: 3.316 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9511406421661377
Epoch: 9, Steps: 10 | Train Loss: 3.068 Vali Loss: 3.311 Vali Acc: 0.059 Test Loss: 3.311 Test Acc: 0.059
Validation loss decreased (-0.050555 --> -0.058790).  Saving model ...
Epoch: 10 cost time: 2.4700193405151367
Epoch: 10, Steps: 10 | Train Loss: 3.121 Vali Loss: 3.309 Vali Acc: 0.068 Test Loss: 3.309 Test Acc: 0.068
Validation loss decreased (-0.058790 --> -0.068202).  Saving model ...
Epoch: 11 cost time: 1.7063958644866943
Epoch: 11, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.312 Vali Acc: 0.073 Test Loss: 3.312 Test Acc: 0.073
Validation loss decreased (-0.068202 --> -0.072908).  Saving model ...
Epoch: 12 cost time: 1.6887006759643555
Epoch: 12, Steps: 10 | Train Loss: 2.956 Vali Loss: 3.305 Vali Acc: 0.082 Test Loss: 3.305 Test Acc: 0.082
Validation loss decreased (-0.072908 --> -0.082320).  Saving model ...
Epoch: 13 cost time: 1.7969024181365967
Epoch: 13, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.305 Vali Acc: 0.098 Test Loss: 3.305 Test Acc: 0.098
Validation loss decreased (-0.082320 --> -0.097614).  Saving model ...
Epoch: 14 cost time: 1.9914524555206299
Epoch: 14, Steps: 10 | Train Loss: 2.850 Vali Loss: 3.292 Vali Acc: 0.092 Test Loss: 3.292 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7226319313049316
Epoch: 15, Steps: 10 | Train Loss: 2.887 Vali Loss: 3.294 Vali Acc: 0.084 Test Loss: 3.294 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7209343910217285
Epoch: 16, Steps: 10 | Train Loss: 2.789 Vali Loss: 3.293 Vali Acc: 0.086 Test Loss: 3.293 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.79880690574646
Epoch: 17, Steps: 10 | Train Loss: 2.752 Vali Loss: 3.283 Vali Acc: 0.086 Test Loss: 3.283 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.032358407974243
Epoch: 18, Steps: 10 | Train Loss: 2.686 Vali Loss: 3.276 Vali Acc: 0.093 Test Loss: 3.276 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0545101165771484
Epoch: 19, Steps: 10 | Train Loss: 2.675 Vali Loss: 3.271 Vali Acc: 0.094 Test Loss: 3.271 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.745474100112915
Epoch: 20, Steps: 10 | Train Loss: 2.545 Vali Loss: 3.278 Vali Acc: 0.101 Test Loss: 3.278 Test Acc: 0.101
Validation loss decreased (-0.097614 --> -0.101144).  Saving model ...
Epoch: 21 cost time: 1.5723469257354736
Epoch: 21, Steps: 10 | Train Loss: 2.506 Vali Loss: 3.265 Vali Acc: 0.098 Test Loss: 3.265 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3584141731262207
Epoch: 22, Steps: 10 | Train Loss: 2.479 Vali Loss: 3.271 Vali Acc: 0.101 Test Loss: 3.271 Test Acc: 0.101
Validation loss decreased (-0.101144 --> -0.101144).  Saving model ...
Epoch: 23 cost time: 1.9957561492919922
Epoch: 23, Steps: 10 | Train Loss: 2.320 Vali Loss: 3.253 Vali Acc: 0.111 Test Loss: 3.253 Test Acc: 0.111
Validation loss decreased (-0.101144 --> -0.110556).  Saving model ...
Epoch: 24 cost time: 2.089890718460083
Epoch: 24, Steps: 10 | Train Loss: 2.328 Vali Loss: 3.257 Vali Acc: 0.109 Test Loss: 3.257 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1837193965911865
Epoch: 25, Steps: 10 | Train Loss: 2.282 Vali Loss: 3.285 Vali Acc: 0.119 Test Loss: 3.285 Test Acc: 0.119
Validation loss decreased (-0.110556 --> -0.118791).  Saving model ...
Epoch: 26 cost time: 2.1173269748687744
Epoch: 26, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.249 Vali Acc: 0.120 Test Loss: 3.249 Test Acc: 0.120
Validation loss decreased (-0.118791 --> -0.119968).  Saving model ...
Epoch: 27 cost time: 1.896522045135498
Epoch: 27, Steps: 10 | Train Loss: 2.112 Vali Loss: 3.255 Vali Acc: 0.126 Test Loss: 3.255 Test Acc: 0.126
Validation loss decreased (-0.119968 --> -0.125850).  Saving model ...
Epoch: 28 cost time: 2.102943181991577
Epoch: 28, Steps: 10 | Train Loss: 2.075 Vali Loss: 3.255 Vali Acc: 0.133 Test Loss: 3.255 Test Acc: 0.133
Validation loss decreased (-0.125850 --> -0.132909).  Saving model ...
Epoch: 29 cost time: 2.0079128742218018
Epoch: 29, Steps: 10 | Train Loss: 2.018 Vali Loss: 3.242 Vali Acc: 0.139 Test Loss: 3.242 Test Acc: 0.139
Validation loss decreased (-0.132909 --> -0.138791).  Saving model ...
Epoch: 30 cost time: 2.0384631156921387
Epoch: 30, Steps: 10 | Train Loss: 1.950 Vali Loss: 3.255 Vali Acc: 0.139 Test Loss: 3.255 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9480104446411133
Epoch: 31, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.246 Vali Acc: 0.142 Test Loss: 3.246 Test Acc: 0.142
Validation loss decreased (-0.138791 --> -0.142320).  Saving model ...
Epoch: 32 cost time: 2.14536452293396
Epoch: 32, Steps: 10 | Train Loss: 1.838 Vali Loss: 3.274 Vali Acc: 0.141 Test Loss: 3.274 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.2980828285217285
Epoch: 33, Steps: 10 | Train Loss: 1.727 Vali Loss: 3.267 Vali Acc: 0.166 Test Loss: 3.267 Test Acc: 0.166
Validation loss decreased (-0.142320 --> -0.165850).  Saving model ...
Epoch: 34 cost time: 2.2043709754943848
Epoch: 34, Steps: 10 | Train Loss: 1.650 Vali Loss: 3.286 Vali Acc: 0.149 Test Loss: 3.286 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.026822090148926
Epoch: 35, Steps: 10 | Train Loss: 1.672 Vali Loss: 3.263 Vali Acc: 0.153 Test Loss: 3.263 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.276460886001587
Epoch: 36, Steps: 10 | Train Loss: 1.588 Vali Loss: 3.293 Vali Acc: 0.154 Test Loss: 3.293 Test Acc: 0.154
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.2771494388580322
Epoch: 37, Steps: 10 | Train Loss: 1.447 Vali Loss: 3.284 Vali Acc: 0.153 Test Loss: 3.284 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.1001603603363037
Epoch: 38, Steps: 10 | Train Loss: 1.449 Vali Loss: 3.332 Vali Acc: 0.151 Test Loss: 3.332 Test Acc: 0.151
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.498568296432495
Epoch: 39, Steps: 10 | Train Loss: 1.365 Vali Loss: 3.299 Vali Acc: 0.165 Test Loss: 3.299 Test Acc: 0.165
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.4948835372924805
Epoch: 40, Steps: 10 | Train Loss: 1.286 Vali Loss: 3.348 Vali Acc: 0.153 Test Loss: 3.348 Test Acc: 0.153
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.691307783126831
Epoch: 41, Steps: 10 | Train Loss: 1.286 Vali Loss: 3.302 Vali Acc: 0.176 Test Loss: 3.302 Test Acc: 0.176
Validation loss decreased (-0.165850 --> -0.176438).  Saving model ...
Epoch: 42 cost time: 2.1931097507476807
Epoch: 42, Steps: 10 | Train Loss: 1.227 Vali Loss: 3.323 Vali Acc: 0.165 Test Loss: 3.323 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.47640061378479
Epoch: 43, Steps: 10 | Train Loss: 1.142 Vali Loss: 3.321 Vali Acc: 0.167 Test Loss: 3.321 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.342240333557129
Epoch: 44, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.335 Vali Acc: 0.159 Test Loss: 3.335 Test Acc: 0.159
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.8578028678894043
Epoch: 45, Steps: 10 | Train Loss: 1.069 Vali Loss: 3.384 Vali Acc: 0.164 Test Loss: 3.384 Test Acc: 0.164
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.0774576663970947
Epoch: 46, Steps: 10 | Train Loss: 1.012 Vali Loss: 3.349 Vali Acc: 0.160 Test Loss: 3.349 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.448101758956909
Epoch: 47, Steps: 10 | Train Loss: 0.963 Vali Loss: 3.377 Vali Acc: 0.181 Test Loss: 3.377 Test Acc: 0.181
Validation loss decreased (-0.176438 --> -0.181143).  Saving model ...
Epoch: 48 cost time: 1.831556797027588
Epoch: 48, Steps: 10 | Train Loss: 0.953 Vali Loss: 3.358 Vali Acc: 0.182 Test Loss: 3.358 Test Acc: 0.182
Validation loss decreased (-0.181143 --> -0.182319).  Saving model ...
Epoch: 49 cost time: 2.189544200897217
Epoch: 49, Steps: 10 | Train Loss: 0.789 Vali Loss: 3.429 Vali Acc: 0.173 Test Loss: 3.429 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.4860129356384277
Epoch: 50, Steps: 10 | Train Loss: 0.820 Vali Loss: 3.396 Vali Acc: 0.175 Test Loss: 3.396 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.040767192840576
Epoch: 51, Steps: 10 | Train Loss: 0.807 Vali Loss: 3.406 Vali Acc: 0.194 Test Loss: 3.406 Test Acc: 0.194
Validation loss decreased (-0.182319 --> -0.194084).  Saving model ...
Epoch: 52 cost time: 2.4872984886169434
Epoch: 52, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.376 Vali Acc: 0.174 Test Loss: 3.376 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.1532347202301025
Epoch: 53, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.395 Vali Acc: 0.188 Test Loss: 3.395 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.387647867202759
Epoch: 54, Steps: 10 | Train Loss: 0.639 Vali Loss: 3.414 Vali Acc: 0.191 Test Loss: 3.414 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.3076765537261963
Epoch: 55, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.436 Vali Acc: 0.204 Test Loss: 3.436 Test Acc: 0.204
Validation loss decreased (-0.194084 --> -0.203495).  Saving model ...
Epoch: 56 cost time: 2.4211461544036865
Epoch: 56, Steps: 10 | Train Loss: 0.534 Vali Loss: 3.458 Vali Acc: 0.180 Test Loss: 3.458 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.3375775814056396
Epoch: 57, Steps: 10 | Train Loss: 0.537 Vali Loss: 3.484 Vali Acc: 0.189 Test Loss: 3.484 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.2938106060028076
Epoch: 58, Steps: 10 | Train Loss: 0.471 Vali Loss: 3.477 Vali Acc: 0.194 Test Loss: 3.477 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.493378162384033
Epoch: 59, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.543 Vali Acc: 0.181 Test Loss: 3.543 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 2.494536876678467
Epoch: 60, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.521 Vali Acc: 0.201 Test Loss: 3.521 Test Acc: 0.201
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.9601738452911377
Epoch: 61, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.481 Vali Acc: 0.213 Test Loss: 3.481 Test Acc: 0.213
Validation loss decreased (-0.203495 --> -0.212906).  Saving model ...
Epoch: 62 cost time: 2.00742769241333
Epoch: 62, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.628 Vali Acc: 0.192 Test Loss: 3.628 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.414328098297119
Epoch: 63, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.630 Vali Acc: 0.192 Test Loss: 3.630 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.9909038543701172
Epoch: 64, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.589 Vali Acc: 0.207 Test Loss: 3.589 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.934227705001831
Epoch: 65, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.579 Vali Acc: 0.214 Test Loss: 3.579 Test Acc: 0.214
Validation loss decreased (-0.212906 --> -0.214082).  Saving model ...
Epoch: 66 cost time: 2.2375264167785645
Epoch: 66, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.654 Vali Acc: 0.205 Test Loss: 3.654 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.122574806213379
Epoch: 67, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.660 Vali Acc: 0.207 Test Loss: 3.660 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 2.023906707763672
Epoch: 68, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.732 Vali Acc: 0.204 Test Loss: 3.732 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 2.3017942905426025
Epoch: 69, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.752 Vali Acc: 0.195 Test Loss: 3.752 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 2.744084358215332
Epoch: 70, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.722 Vali Acc: 0.219 Test Loss: 3.722 Test Acc: 0.219
Validation loss decreased (-0.214082 --> -0.218786).  Saving model ...
Epoch: 71 cost time: 2.118839979171753
Epoch: 71, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.755 Vali Acc: 0.196 Test Loss: 3.755 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.364030122756958
Epoch: 72, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.771 Vali Acc: 0.215 Test Loss: 3.771 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 2.5105977058410645
Epoch: 73, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.794 Vali Acc: 0.216 Test Loss: 3.794 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 2.609684467315674
Epoch: 74, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.795 Vali Acc: 0.209 Test Loss: 3.795 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 2.3936638832092285
Epoch: 75, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.890 Vali Acc: 0.202 Test Loss: 3.890 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 2.443364143371582
Epoch: 76, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.938 Vali Acc: 0.196 Test Loss: 3.938 Test Acc: 0.196
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.8934738636016846
Epoch: 77, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.932 Vali Acc: 0.208 Test Loss: 3.932 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 2.2203667163848877
Epoch: 78, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.867 Vali Acc: 0.215 Test Loss: 3.867 Test Acc: 0.215
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 1.7783231735229492
Epoch: 79, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.921 Vali Acc: 0.209 Test Loss: 3.921 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 2.244333267211914
Epoch: 80, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.978 Vali Acc: 0.216 Test Loss: 3.978 Test Acc: 0.216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2188235294117647
model parameter : 241110
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5799663066864014
Epoch: 1, Steps: 10 | Train Loss: 3.477 Vali Loss: 3.371 Vali Acc: 0.025 Test Loss: 3.371 Test Acc: 0.025
Validation loss decreased (inf --> -0.024672).  Saving model ...
Epoch: 2 cost time: 1.6482317447662354
Epoch: 2, Steps: 10 | Train Loss: 3.373 Vali Loss: 3.335 Vali Acc: 0.025 Test Loss: 3.335 Test Acc: 0.025
Validation loss decreased (-0.024672 --> -0.024673).  Saving model ...
Epoch: 3 cost time: 1.6617088317871094
Epoch: 3, Steps: 10 | Train Loss: 3.292 Vali Loss: 3.325 Vali Acc: 0.051 Test Loss: 3.325 Test Acc: 0.051
Validation loss decreased (-0.024673 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 1.642141580581665
Epoch: 4, Steps: 10 | Train Loss: 3.262 Vali Loss: 3.323 Vali Acc: 0.052 Test Loss: 3.323 Test Acc: 0.052
Validation loss decreased (-0.050555 --> -0.051731).  Saving model ...
Epoch: 5 cost time: 1.8453595638275146
Epoch: 5, Steps: 10 | Train Loss: 3.261 Vali Loss: 3.320 Vali Acc: 0.056 Test Loss: 3.320 Test Acc: 0.056
Validation loss decreased (-0.051731 --> -0.056437).  Saving model ...
Epoch: 6 cost time: 1.6892714500427246
Epoch: 6, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.311 Vali Acc: 0.039 Test Loss: 3.311 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6138629913330078
Epoch: 7, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.310 Vali Acc: 0.054 Test Loss: 3.310 Test Acc: 0.054
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4261326789855957
Epoch: 8, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.321 Vali Acc: 0.056 Test Loss: 3.321 Test Acc: 0.056
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7161228656768799
Epoch: 9, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.316 Vali Acc: 0.059 Test Loss: 3.316 Test Acc: 0.059
Validation loss decreased (-0.056437 --> -0.058790).  Saving model ...
Epoch: 10 cost time: 1.6398561000823975
Epoch: 10, Steps: 10 | Train Loss: 3.079 Vali Loss: 3.319 Vali Acc: 0.060 Test Loss: 3.319 Test Acc: 0.060
Validation loss decreased (-0.058790 --> -0.059967).  Saving model ...
Epoch: 11 cost time: 1.640904188156128
Epoch: 11, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.316 Vali Acc: 0.068 Test Loss: 3.316 Test Acc: 0.068
Validation loss decreased (-0.059967 --> -0.068202).  Saving model ...
Epoch: 12 cost time: 1.6944010257720947
Epoch: 12, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.304 Vali Acc: 0.080 Test Loss: 3.304 Test Acc: 0.080
Validation loss decreased (-0.068202 --> -0.079967).  Saving model ...
Epoch: 13 cost time: 1.8153841495513916
Epoch: 13, Steps: 10 | Train Loss: 2.911 Vali Loss: 3.316 Vali Acc: 0.085 Test Loss: 3.316 Test Acc: 0.085
Validation loss decreased (-0.079967 --> -0.084673).  Saving model ...
Epoch: 14 cost time: 1.7103044986724854
Epoch: 14, Steps: 10 | Train Loss: 2.846 Vali Loss: 3.320 Vali Acc: 0.094 Test Loss: 3.320 Test Acc: 0.094
Validation loss decreased (-0.084673 --> -0.094084).  Saving model ...
Epoch: 15 cost time: 1.7052323818206787
Epoch: 15, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.292 Vali Acc: 0.094 Test Loss: 3.292 Test Acc: 0.094
Validation loss decreased (-0.094084 --> -0.094085).  Saving model ...
Epoch: 16 cost time: 1.482816457748413
Epoch: 16, Steps: 10 | Train Loss: 2.786 Vali Loss: 3.306 Vali Acc: 0.084 Test Loss: 3.306 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5766081809997559
Epoch: 17, Steps: 10 | Train Loss: 2.645 Vali Loss: 3.311 Vali Acc: 0.095 Test Loss: 3.311 Test Acc: 0.095
Validation loss decreased (-0.094085 --> -0.095261).  Saving model ...
Epoch: 18 cost time: 1.7029283046722412
Epoch: 18, Steps: 10 | Train Loss: 2.604 Vali Loss: 3.303 Vali Acc: 0.105 Test Loss: 3.303 Test Acc: 0.105
Validation loss decreased (-0.095261 --> -0.104673).  Saving model ...
Epoch: 19 cost time: 1.6327245235443115
Epoch: 19, Steps: 10 | Train Loss: 2.598 Vali Loss: 3.311 Vali Acc: 0.107 Test Loss: 3.311 Test Acc: 0.107
Validation loss decreased (-0.104673 --> -0.107026).  Saving model ...
Epoch: 20 cost time: 1.608564853668213
Epoch: 20, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.326 Vali Acc: 0.105 Test Loss: 3.326 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7952229976654053
Epoch: 21, Steps: 10 | Train Loss: 2.477 Vali Loss: 3.292 Vali Acc: 0.120 Test Loss: 3.292 Test Acc: 0.120
Validation loss decreased (-0.107026 --> -0.119967).  Saving model ...
Epoch: 22 cost time: 1.7373380661010742
Epoch: 22, Steps: 10 | Train Loss: 2.397 Vali Loss: 3.309 Vali Acc: 0.109 Test Loss: 3.309 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5822155475616455
Epoch: 23, Steps: 10 | Train Loss: 2.292 Vali Loss: 3.308 Vali Acc: 0.133 Test Loss: 3.308 Test Acc: 0.133
Validation loss decreased (-0.119967 --> -0.132908).  Saving model ...
Epoch: 24 cost time: 1.3633034229278564
Epoch: 24, Steps: 10 | Train Loss: 2.279 Vali Loss: 3.298 Vali Acc: 0.122 Test Loss: 3.298 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7648749351501465
Epoch: 25, Steps: 10 | Train Loss: 2.235 Vali Loss: 3.282 Vali Acc: 0.131 Test Loss: 3.282 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6866888999938965
Epoch: 26, Steps: 10 | Train Loss: 2.106 Vali Loss: 3.294 Vali Acc: 0.139 Test Loss: 3.294 Test Acc: 0.139
Validation loss decreased (-0.132908 --> -0.138791).  Saving model ...
Epoch: 27 cost time: 1.845637321472168
Epoch: 27, Steps: 10 | Train Loss: 2.099 Vali Loss: 3.306 Vali Acc: 0.139 Test Loss: 3.306 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7574422359466553
Epoch: 28, Steps: 10 | Train Loss: 2.030 Vali Loss: 3.302 Vali Acc: 0.139 Test Loss: 3.302 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.446850061416626
Epoch: 29, Steps: 10 | Train Loss: 1.987 Vali Loss: 3.299 Vali Acc: 0.147 Test Loss: 3.299 Test Acc: 0.147
Validation loss decreased (-0.138791 --> -0.147026).  Saving model ...
Epoch: 30 cost time: 1.6612956523895264
Epoch: 30, Steps: 10 | Train Loss: 1.911 Vali Loss: 3.317 Vali Acc: 0.153 Test Loss: 3.317 Test Acc: 0.153
Validation loss decreased (-0.147026 --> -0.152908).  Saving model ...
Epoch: 31 cost time: 1.4277303218841553
Epoch: 31, Steps: 10 | Train Loss: 1.808 Vali Loss: 3.311 Vali Acc: 0.141 Test Loss: 3.311 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7511403560638428
Epoch: 32, Steps: 10 | Train Loss: 1.756 Vali Loss: 3.297 Vali Acc: 0.154 Test Loss: 3.297 Test Acc: 0.154
Validation loss decreased (-0.152908 --> -0.154085).  Saving model ...
Epoch: 33 cost time: 1.5369675159454346
Epoch: 33, Steps: 10 | Train Loss: 1.744 Vali Loss: 3.309 Vali Acc: 0.162 Test Loss: 3.309 Test Acc: 0.162
Validation loss decreased (-0.154085 --> -0.162320).  Saving model ...
Epoch: 34 cost time: 1.384739875793457
Epoch: 34, Steps: 10 | Train Loss: 1.646 Vali Loss: 3.307 Vali Acc: 0.156 Test Loss: 3.307 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.047952890396118
Epoch: 35, Steps: 10 | Train Loss: 1.661 Vali Loss: 3.299 Vali Acc: 0.160 Test Loss: 3.299 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4940710067749023
Epoch: 36, Steps: 10 | Train Loss: 1.549 Vali Loss: 3.314 Vali Acc: 0.160 Test Loss: 3.314 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7421643733978271
Epoch: 37, Steps: 10 | Train Loss: 1.499 Vali Loss: 3.292 Vali Acc: 0.162 Test Loss: 3.292 Test Acc: 0.162
Validation loss decreased (-0.162320 --> -0.162320).  Saving model ...
Epoch: 38 cost time: 1.9156179428100586
Epoch: 38, Steps: 10 | Train Loss: 1.421 Vali Loss: 3.320 Vali Acc: 0.175 Test Loss: 3.320 Test Acc: 0.175
Validation loss decreased (-0.162320 --> -0.175261).  Saving model ...
Epoch: 39 cost time: 1.737041711807251
Epoch: 39, Steps: 10 | Train Loss: 1.378 Vali Loss: 3.286 Vali Acc: 0.185 Test Loss: 3.286 Test Acc: 0.185
Validation loss decreased (-0.175261 --> -0.184673).  Saving model ...
Epoch: 40 cost time: 1.501131534576416
Epoch: 40, Steps: 10 | Train Loss: 1.271 Vali Loss: 3.289 Vali Acc: 0.182 Test Loss: 3.289 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9558961391448975
Epoch: 41, Steps: 10 | Train Loss: 1.210 Vali Loss: 3.305 Vali Acc: 0.184 Test Loss: 3.305 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7992804050445557
Epoch: 42, Steps: 10 | Train Loss: 1.183 Vali Loss: 3.331 Vali Acc: 0.188 Test Loss: 3.331 Test Acc: 0.188
Validation loss decreased (-0.184673 --> -0.188202).  Saving model ...
Epoch: 43 cost time: 1.6132235527038574
Epoch: 43, Steps: 10 | Train Loss: 1.144 Vali Loss: 3.324 Vali Acc: 0.192 Test Loss: 3.324 Test Acc: 0.192
Validation loss decreased (-0.188202 --> -0.191731).  Saving model ...
Epoch: 44 cost time: 1.7074732780456543
Epoch: 44, Steps: 10 | Train Loss: 1.096 Vali Loss: 3.311 Vali Acc: 0.187 Test Loss: 3.311 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.8942532539367676
Epoch: 45, Steps: 10 | Train Loss: 1.051 Vali Loss: 3.337 Vali Acc: 0.194 Test Loss: 3.337 Test Acc: 0.194
Validation loss decreased (-0.191731 --> -0.194084).  Saving model ...
Epoch: 46 cost time: 1.551673412322998
Epoch: 46, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.300 Vali Acc: 0.182 Test Loss: 3.300 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.8271522521972656
Epoch: 47, Steps: 10 | Train Loss: 0.977 Vali Loss: 3.342 Vali Acc: 0.201 Test Loss: 3.342 Test Acc: 0.201
Validation loss decreased (-0.194084 --> -0.201143).  Saving model ...
Epoch: 48 cost time: 1.6407668590545654
Epoch: 48, Steps: 10 | Train Loss: 0.860 Vali Loss: 3.320 Vali Acc: 0.195 Test Loss: 3.320 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.6009104251861572
Epoch: 49, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.325 Vali Acc: 0.198 Test Loss: 3.325 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.9686455726623535
Epoch: 50, Steps: 10 | Train Loss: 0.729 Vali Loss: 3.327 Vali Acc: 0.195 Test Loss: 3.327 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.733064889907837
Epoch: 51, Steps: 10 | Train Loss: 0.696 Vali Loss: 3.336 Vali Acc: 0.199 Test Loss: 3.336 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.7785594463348389
Epoch: 52, Steps: 10 | Train Loss: 0.703 Vali Loss: 3.365 Vali Acc: 0.215 Test Loss: 3.365 Test Acc: 0.215
Validation loss decreased (-0.201143 --> -0.215260).  Saving model ...
Epoch: 53 cost time: 1.659724473953247
Epoch: 53, Steps: 10 | Train Loss: 0.655 Vali Loss: 3.406 Vali Acc: 0.211 Test Loss: 3.406 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.8215901851654053
Epoch: 54, Steps: 10 | Train Loss: 0.585 Vali Loss: 3.341 Vali Acc: 0.214 Test Loss: 3.341 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.6959707736968994
Epoch: 55, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.360 Vali Acc: 0.208 Test Loss: 3.360 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.5510766506195068
Epoch: 56, Steps: 10 | Train Loss: 0.511 Vali Loss: 3.371 Vali Acc: 0.206 Test Loss: 3.371 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 2.1912593841552734
Epoch: 57, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.431 Vali Acc: 0.222 Test Loss: 3.431 Test Acc: 0.222
Validation loss decreased (-0.215260 --> -0.222319).  Saving model ...
Epoch: 58 cost time: 1.5615441799163818
Epoch: 58, Steps: 10 | Train Loss: 0.476 Vali Loss: 3.362 Vali Acc: 0.218 Test Loss: 3.362 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.6991255283355713
Epoch: 59, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.453 Vali Acc: 0.213 Test Loss: 3.453 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.5502049922943115
Epoch: 60, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.447 Vali Acc: 0.220 Test Loss: 3.447 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.4861445426940918
Epoch: 61, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.462 Vali Acc: 0.224 Test Loss: 3.462 Test Acc: 0.224
Validation loss decreased (-0.222319 --> -0.223495).  Saving model ...
Epoch: 62 cost time: 1.5531744956970215
Epoch: 62, Steps: 10 | Train Loss: 0.331 Vali Loss: 3.448 Vali Acc: 0.229 Test Loss: 3.448 Test Acc: 0.229
Validation loss decreased (-0.223495 --> -0.229377).  Saving model ...
Epoch: 63 cost time: 1.6067194938659668
Epoch: 63, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.487 Vali Acc: 0.235 Test Loss: 3.487 Test Acc: 0.235
Validation loss decreased (-0.229377 --> -0.235259).  Saving model ...
Epoch: 64 cost time: 1.871962070465088
Epoch: 64, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.518 Vali Acc: 0.219 Test Loss: 3.518 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 2.069073438644409
Epoch: 65, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.516 Vali Acc: 0.225 Test Loss: 3.516 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.7910335063934326
Epoch: 66, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.529 Vali Acc: 0.234 Test Loss: 3.529 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.7818958759307861
Epoch: 67, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.563 Vali Acc: 0.234 Test Loss: 3.563 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.7582857608795166
Epoch: 68, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.554 Vali Acc: 0.219 Test Loss: 3.554 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.6383984088897705
Epoch: 69, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.582 Vali Acc: 0.231 Test Loss: 3.582 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.8293070793151855
Epoch: 70, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.596 Vali Acc: 0.228 Test Loss: 3.596 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.5384604930877686
Epoch: 71, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.675 Vali Acc: 0.222 Test Loss: 3.675 Test Acc: 0.222
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.4997584819793701
Epoch: 72, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.655 Vali Acc: 0.236 Test Loss: 3.655 Test Acc: 0.236
Validation loss decreased (-0.235259 --> -0.236434).  Saving model ...
Epoch: 73 cost time: 1.7504327297210693
Epoch: 73, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.652 Vali Acc: 0.232 Test Loss: 3.652 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.6175851821899414
Epoch: 74, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.664 Vali Acc: 0.241 Test Loss: 3.664 Test Acc: 0.241
Validation loss decreased (-0.236434 --> -0.241140).  Saving model ...
Epoch: 75 cost time: 1.7249860763549805
Epoch: 75, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.705 Vali Acc: 0.222 Test Loss: 3.705 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.725989818572998
Epoch: 76, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.767 Vali Acc: 0.238 Test Loss: 3.767 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.788949966430664
Epoch: 77, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.748 Vali Acc: 0.236 Test Loss: 3.748 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.5423941612243652
Epoch: 78, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.734 Vali Acc: 0.229 Test Loss: 3.734 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.6596200466156006
Epoch: 79, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.790 Vali Acc: 0.239 Test Loss: 3.790 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.83762526512146
Epoch: 80, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.762 Vali Acc: 0.244 Test Loss: 3.762 Test Acc: 0.244
Validation loss decreased (-0.241140 --> -0.243492).  Saving model ...
Epoch: 81 cost time: 1.8161535263061523
Epoch: 81, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.786 Vali Acc: 0.239 Test Loss: 3.786 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.6797738075256348
Epoch: 82, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.811 Vali Acc: 0.236 Test Loss: 3.811 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.3877038955688477
Epoch: 83, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.890 Vali Acc: 0.236 Test Loss: 3.890 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.7180109024047852
Epoch: 84, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.795 Vali Acc: 0.241 Test Loss: 3.795 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.798780918121338
Epoch: 85, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.863 Vali Acc: 0.244 Test Loss: 3.863 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.8046658039093018
Epoch: 86, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.904 Vali Acc: 0.238 Test Loss: 3.904 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.47908353805542
Epoch: 87, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.891 Vali Acc: 0.236 Test Loss: 3.891 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 2.0031492710113525
Epoch: 88, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.908 Vali Acc: 0.246 Test Loss: 3.908 Test Acc: 0.246
Validation loss decreased (-0.243492 --> -0.245843).  Saving model ...
Epoch: 89 cost time: 1.6105778217315674
Epoch: 89, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.948 Vali Acc: 0.244 Test Loss: 3.948 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 2.017765998840332
Epoch: 90, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.941 Vali Acc: 0.256 Test Loss: 3.941 Test Acc: 0.256
Validation loss decreased (-0.245843 --> -0.256431).  Saving model ...
Epoch: 91 cost time: 1.768787145614624
Epoch: 91, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.929 Vali Acc: 0.253 Test Loss: 3.929 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.7162857055664062
Epoch: 92, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.934 Vali Acc: 0.249 Test Loss: 3.934 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.9059267044067383
Epoch: 93, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.958 Vali Acc: 0.241 Test Loss: 3.958 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 2.061061382293701
Epoch: 94, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.961 Vali Acc: 0.246 Test Loss: 3.961 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 2.044529676437378
Epoch: 95, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.996 Vali Acc: 0.247 Test Loss: 3.996 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 2.4984023571014404
Epoch: 96, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.988 Vali Acc: 0.244 Test Loss: 3.988 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 2.0906121730804443
Epoch: 97, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.958 Vali Acc: 0.246 Test Loss: 3.958 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 2.268224000930786
Epoch: 98, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.973 Vali Acc: 0.249 Test Loss: 3.973 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 2.103616237640381
Epoch: 99, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.020 Vali Acc: 0.261 Test Loss: 4.020 Test Acc: 0.261
Validation loss decreased (-0.256431 --> -0.261136).  Saving model ...
Epoch: 100 cost time: 1.8817627429962158
Epoch: 100, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.986 Vali Acc: 0.258 Test Loss: 3.986 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 240278
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.825213670730591
Epoch: 1, Steps: 10 | Train Loss: 3.378 Vali Loss: 3.358 Vali Acc: 0.031 Test Loss: 3.358 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 1.7388019561767578
Epoch: 2, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.466 Vali Acc: 0.061 Test Loss: 3.466 Test Acc: 0.061
Validation loss decreased (-0.030555 --> -0.061142).  Saving model ...
Epoch: 3 cost time: 1.6943271160125732
Epoch: 3, Steps: 10 | Train Loss: 3.104 Vali Loss: 3.335 Vali Acc: 0.047 Test Loss: 3.335 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.20698618888855
Epoch: 4, Steps: 10 | Train Loss: 3.034 Vali Loss: 3.297 Vali Acc: 0.101 Test Loss: 3.297 Test Acc: 0.101
Validation loss decreased (-0.061142 --> -0.101143).  Saving model ...
Epoch: 5 cost time: 2.007457733154297
Epoch: 5, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.271 Vali Acc: 0.104 Test Loss: 3.271 Test Acc: 0.104
Validation loss decreased (-0.101143 --> -0.103497).  Saving model ...
Epoch: 6 cost time: 1.4199745655059814
Epoch: 6, Steps: 10 | Train Loss: 2.501 Vali Loss: 3.392 Vali Acc: 0.105 Test Loss: 3.392 Test Acc: 0.105
Validation loss decreased (-0.103497 --> -0.104672).  Saving model ...
Epoch: 7 cost time: 1.829406499862671
Epoch: 7, Steps: 10 | Train Loss: 2.246 Vali Loss: 3.380 Vali Acc: 0.124 Test Loss: 3.380 Test Acc: 0.124
Validation loss decreased (-0.104672 --> -0.123496).  Saving model ...
Epoch: 8 cost time: 1.5558385848999023
Epoch: 8, Steps: 10 | Train Loss: 1.917 Vali Loss: 3.353 Vali Acc: 0.145 Test Loss: 3.353 Test Acc: 0.145
Validation loss decreased (-0.123496 --> -0.144672).  Saving model ...
Epoch: 9 cost time: 1.5030932426452637
Epoch: 9, Steps: 10 | Train Loss: 1.640 Vali Loss: 3.276 Vali Acc: 0.175 Test Loss: 3.276 Test Acc: 0.175
Validation loss decreased (-0.144672 --> -0.175261).  Saving model ...
Epoch: 10 cost time: 1.5270617008209229
Epoch: 10, Steps: 10 | Train Loss: 1.285 Vali Loss: 3.363 Vali Acc: 0.192 Test Loss: 3.363 Test Acc: 0.192
Validation loss decreased (-0.175261 --> -0.191731).  Saving model ...
Epoch: 11 cost time: 1.5006229877471924
Epoch: 11, Steps: 10 | Train Loss: 1.133 Vali Loss: 3.351 Vali Acc: 0.188 Test Loss: 3.351 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6276915073394775
Epoch: 12, Steps: 10 | Train Loss: 0.893 Vali Loss: 3.490 Vali Acc: 0.199 Test Loss: 3.490 Test Acc: 0.199
Validation loss decreased (-0.191731 --> -0.198789).  Saving model ...
Epoch: 13 cost time: 1.9504368305206299
Epoch: 13, Steps: 10 | Train Loss: 0.715 Vali Loss: 3.544 Vali Acc: 0.187 Test Loss: 3.544 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7189218997955322
Epoch: 14, Steps: 10 | Train Loss: 0.653 Vali Loss: 3.634 Vali Acc: 0.225 Test Loss: 3.634 Test Acc: 0.225
Validation loss decreased (-0.198789 --> -0.224670).  Saving model ...
Epoch: 15 cost time: 1.6767213344573975
Epoch: 15, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.802 Vali Acc: 0.205 Test Loss: 3.802 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4233903884887695
Epoch: 16, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.661 Vali Acc: 0.232 Test Loss: 3.661 Test Acc: 0.232
Validation loss decreased (-0.224670 --> -0.231728).  Saving model ...
Epoch: 17 cost time: 1.668755292892456
Epoch: 17, Steps: 10 | Train Loss: 0.210 Vali Loss: 4.085 Vali Acc: 0.184 Test Loss: 4.085 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8592326641082764
Epoch: 18, Steps: 10 | Train Loss: 0.197 Vali Loss: 4.108 Vali Acc: 0.214 Test Loss: 4.108 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5143470764160156
Epoch: 19, Steps: 10 | Train Loss: 0.116 Vali Loss: 4.050 Vali Acc: 0.232 Test Loss: 4.050 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9130170345306396
Epoch: 20, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.937 Vali Acc: 0.252 Test Loss: 3.937 Test Acc: 0.252
Validation loss decreased (-0.231728 --> -0.251725).  Saving model ...
Epoch: 21 cost time: 1.5766267776489258
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.124 Vali Acc: 0.252 Test Loss: 4.124 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8616876602172852
Epoch: 22, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.259 Vali Acc: 0.267 Test Loss: 4.259 Test Acc: 0.267
Validation loss decreased (-0.251725 --> -0.267016).  Saving model ...
Epoch: 23 cost time: 1.7310261726379395
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.330 Vali Acc: 0.236 Test Loss: 4.330 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2607109546661377
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.158 Vali Acc: 0.274 Test Loss: 4.158 Test Acc: 0.274
Validation loss decreased (-0.267016 --> -0.274076).  Saving model ...
Epoch: 25 cost time: 1.7089042663574219
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.217 Vali Acc: 0.259 Test Loss: 4.217 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6877493858337402
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.157 Vali Acc: 0.285 Test Loss: 4.157 Test Acc: 0.285
Validation loss decreased (-0.274076 --> -0.284664).  Saving model ...
Epoch: 27 cost time: 1.4817609786987305
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.219 Vali Acc: 0.278 Test Loss: 4.219 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5537006855010986
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.193 Vali Acc: 0.287 Test Loss: 4.193 Test Acc: 0.287
Validation loss decreased (-0.284664 --> -0.287017).  Saving model ...
Epoch: 29 cost time: 1.6161680221557617
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.206 Vali Acc: 0.289 Test Loss: 4.206 Test Acc: 0.289
Validation loss decreased (-0.287017 --> -0.289370).  Saving model ...
Epoch: 30 cost time: 1.5363190174102783
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.231 Vali Acc: 0.282 Test Loss: 4.231 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7155671119689941
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.253 Vali Acc: 0.287 Test Loss: 4.253 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8519611358642578
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.263 Vali Acc: 0.288 Test Loss: 4.263 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4002494812011719
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.272 Vali Acc: 0.289 Test Loss: 4.272 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.5474951267242432
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.289 Vali Acc: 0.292 Test Loss: 4.289 Test Acc: 0.292
Validation loss decreased (-0.289370 --> -0.291722).  Saving model ...
Epoch: 35 cost time: 1.4126994609832764
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.315 Vali Acc: 0.289 Test Loss: 4.315 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.502650499343872
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.335 Vali Acc: 0.288 Test Loss: 4.335 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.6400654315948486
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.346 Vali Acc: 0.291 Test Loss: 4.346 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.6377995014190674
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.351 Vali Acc: 0.289 Test Loss: 4.351 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.4937257766723633
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.360 Vali Acc: 0.288 Test Loss: 4.360 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.7489542961120605
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.366 Vali Acc: 0.288 Test Loss: 4.366 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.650491714477539
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.381 Vali Acc: 0.292 Test Loss: 4.381 Test Acc: 0.292
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.094019651412964
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.394 Vali Acc: 0.292 Test Loss: 4.394 Test Acc: 0.292
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.973203420639038
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.406 Vali Acc: 0.292 Test Loss: 4.406 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.61612868309021
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.413 Vali Acc: 0.291 Test Loss: 4.413 Test Acc: 0.291
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2917647058823529
model parameter : 11199818
model size : 47.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.92314076423645
Epoch: 1, Steps: 10 | Train Loss: 3.434 Vali Loss: 3.331 Vali Acc: 0.047 Test Loss: 3.331 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.860119342803955
Epoch: 2, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.479 Vali Acc: 0.047 Test Loss: 3.479 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7550585269927979
Epoch: 3, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.252 Vali Acc: 0.108 Test Loss: 3.252 Test Acc: 0.108
Validation loss decreased (-0.047026 --> -0.108203).  Saving model ...
Epoch: 4 cost time: 1.4275014400482178
Epoch: 4, Steps: 10 | Train Loss: 3.006 Vali Loss: 3.287 Vali Acc: 0.093 Test Loss: 3.287 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5889878273010254
Epoch: 5, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.238 Vali Acc: 0.121 Test Loss: 3.238 Test Acc: 0.121
Validation loss decreased (-0.108203 --> -0.121144).  Saving model ...
Epoch: 6 cost time: 1.6677906513214111
Epoch: 6, Steps: 10 | Train Loss: 2.442 Vali Loss: 3.345 Vali Acc: 0.140 Test Loss: 3.345 Test Acc: 0.140
Validation loss decreased (-0.121144 --> -0.139967).  Saving model ...
Epoch: 7 cost time: 2.4785265922546387
Epoch: 7, Steps: 10 | Train Loss: 2.048 Vali Loss: 3.338 Vali Acc: 0.129 Test Loss: 3.338 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9776992797851562
Epoch: 8, Steps: 10 | Train Loss: 1.786 Vali Loss: 3.444 Vali Acc: 0.114 Test Loss: 3.444 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9245452880859375
Epoch: 9, Steps: 10 | Train Loss: 1.563 Vali Loss: 3.413 Vali Acc: 0.165 Test Loss: 3.413 Test Acc: 0.165
Validation loss decreased (-0.139967 --> -0.164672).  Saving model ...
Epoch: 10 cost time: 1.6939034461975098
Epoch: 10, Steps: 10 | Train Loss: 1.335 Vali Loss: 3.326 Vali Acc: 0.175 Test Loss: 3.326 Test Acc: 0.175
Validation loss decreased (-0.164672 --> -0.175261).  Saving model ...
Epoch: 11 cost time: 1.7410011291503906
Epoch: 11, Steps: 10 | Train Loss: 1.044 Vali Loss: 3.401 Vali Acc: 0.202 Test Loss: 3.401 Test Acc: 0.202
Validation loss decreased (-0.175261 --> -0.202319).  Saving model ...
Epoch: 12 cost time: 1.7579677104949951
Epoch: 12, Steps: 10 | Train Loss: 0.841 Vali Loss: 3.404 Vali Acc: 0.206 Test Loss: 3.404 Test Acc: 0.206
Validation loss decreased (-0.202319 --> -0.205848).  Saving model ...
Epoch: 13 cost time: 1.7056643962860107
Epoch: 13, Steps: 10 | Train Loss: 0.590 Vali Loss: 3.556 Vali Acc: 0.186 Test Loss: 3.556 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.665184497833252
Epoch: 14, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.513 Vali Acc: 0.212 Test Loss: 3.513 Test Acc: 0.212
Validation loss decreased (-0.205848 --> -0.211730).  Saving model ...
Epoch: 15 cost time: 1.5210397243499756
Epoch: 15, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.621 Vali Acc: 0.214 Test Loss: 3.621 Test Acc: 0.214
Validation loss decreased (-0.211730 --> -0.214081).  Saving model ...
Epoch: 16 cost time: 1.48610258102417
Epoch: 16, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.665 Vali Acc: 0.235 Test Loss: 3.665 Test Acc: 0.235
Validation loss decreased (-0.214081 --> -0.235257).  Saving model ...
Epoch: 17 cost time: 1.579831838607788
Epoch: 17, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.839 Vali Acc: 0.228 Test Loss: 3.839 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5298027992248535
Epoch: 18, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.832 Vali Acc: 0.240 Test Loss: 3.832 Test Acc: 0.240
Validation loss decreased (-0.235257 --> -0.239962).  Saving model ...
Epoch: 19 cost time: 1.6015653610229492
Epoch: 19, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.992 Vali Acc: 0.236 Test Loss: 3.992 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5943782329559326
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.069 Vali Acc: 0.246 Test Loss: 4.069 Test Acc: 0.246
Validation loss decreased (-0.239962 --> -0.245842).  Saving model ...
Epoch: 21 cost time: 1.6230242252349854
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.067 Vali Acc: 0.248 Test Loss: 4.067 Test Acc: 0.248
Validation loss decreased (-0.245842 --> -0.248195).  Saving model ...
Epoch: 22 cost time: 1.8646531105041504
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.105 Vali Acc: 0.265 Test Loss: 4.105 Test Acc: 0.265
Validation loss decreased (-0.248195 --> -0.264665).  Saving model ...
Epoch: 23 cost time: 1.666275978088379
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.159 Vali Acc: 0.258 Test Loss: 4.159 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8047537803649902
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.169 Vali Acc: 0.253 Test Loss: 4.169 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.622690200805664
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.113 Vali Acc: 0.262 Test Loss: 4.113 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6150236129760742
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.187 Vali Acc: 0.264 Test Loss: 4.187 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.105029344558716
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.183 Vali Acc: 0.269 Test Loss: 4.183 Test Acc: 0.269
Validation loss decreased (-0.264665 --> -0.269370).  Saving model ...
Epoch: 28 cost time: 1.631742000579834
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.175 Vali Acc: 0.275 Test Loss: 4.175 Test Acc: 0.275
Validation loss decreased (-0.269370 --> -0.275252).  Saving model ...
Epoch: 29 cost time: 1.6116037368774414
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.185 Vali Acc: 0.276 Test Loss: 4.185 Test Acc: 0.276
Validation loss decreased (-0.275252 --> -0.276429).  Saving model ...
Epoch: 30 cost time: 1.7389757633209229
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.193 Vali Acc: 0.276 Test Loss: 4.193 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7261273860931396
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.227 Vali Acc: 0.276 Test Loss: 4.227 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.549541711807251
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.230 Vali Acc: 0.275 Test Loss: 4.230 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6457655429840088
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.232 Vali Acc: 0.276 Test Loss: 4.232 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.6487629413604736
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.242 Vali Acc: 0.278 Test Loss: 4.242 Test Acc: 0.278
Validation loss decreased (-0.276429 --> -0.277605).  Saving model ...
Epoch: 35 cost time: 1.7328424453735352
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.247 Vali Acc: 0.278 Test Loss: 4.247 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4705657958984375
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.256 Vali Acc: 0.276 Test Loss: 4.256 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7247240543365479
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.270 Vali Acc: 0.279 Test Loss: 4.270 Test Acc: 0.279
Validation loss decreased (-0.277605 --> -0.278781).  Saving model ...
Epoch: 38 cost time: 1.6899826526641846
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.286 Vali Acc: 0.276 Test Loss: 4.286 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6556117534637451
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.292 Vali Acc: 0.280 Test Loss: 4.292 Test Acc: 0.280
Validation loss decreased (-0.278781 --> -0.279957).  Saving model ...
Epoch: 40 cost time: 1.9187591075897217
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.302 Vali Acc: 0.279 Test Loss: 4.302 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.5451991558074951
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.320 Vali Acc: 0.278 Test Loss: 4.320 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.756817102432251
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.333 Vali Acc: 0.280 Test Loss: 4.333 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.132207155227661
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.336 Vali Acc: 0.276 Test Loss: 4.336 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.5511474609375
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.339 Vali Acc: 0.276 Test Loss: 4.339 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.610377311706543
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.346 Vali Acc: 0.275 Test Loss: 4.346 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.569288969039917
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.346 Vali Acc: 0.276 Test Loss: 4.346 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.7972686290740967
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.355 Vali Acc: 0.279 Test Loss: 4.355 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.033518075942993
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.371 Vali Acc: 0.276 Test Loss: 4.371 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.3531303405761719
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.384 Vali Acc: 0.274 Test Loss: 4.384 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 11193674
model size : 47.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3172924518585205
Epoch: 1, Steps: 10 | Train Loss: 3.459 Vali Loss: 3.357 Vali Acc: 0.044 Test Loss: 3.357 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.671135663986206
Epoch: 2, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.497 Vali Acc: 0.052 Test Loss: 3.497 Test Acc: 0.052
Validation loss decreased (-0.043496 --> -0.051730).  Saving model ...
Epoch: 3 cost time: 1.6695234775543213
Epoch: 3, Steps: 10 | Train Loss: 3.235 Vali Loss: 3.351 Vali Acc: 0.071 Test Loss: 3.351 Test Acc: 0.071
Validation loss decreased (-0.051730 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 1.3403334617614746
Epoch: 4, Steps: 10 | Train Loss: 2.944 Vali Loss: 3.296 Vali Acc: 0.094 Test Loss: 3.296 Test Acc: 0.094
Validation loss decreased (-0.070555 --> -0.094085).  Saving model ...
Epoch: 5 cost time: 1.4866986274719238
Epoch: 5, Steps: 10 | Train Loss: 2.735 Vali Loss: 3.243 Vali Acc: 0.107 Test Loss: 3.243 Test Acc: 0.107
Validation loss decreased (-0.094085 --> -0.107026).  Saving model ...
Epoch: 6 cost time: 1.4325189590454102
Epoch: 6, Steps: 10 | Train Loss: 2.422 Vali Loss: 3.221 Vali Acc: 0.124 Test Loss: 3.221 Test Acc: 0.124
Validation loss decreased (-0.107026 --> -0.123497).  Saving model ...
Epoch: 7 cost time: 1.4307670593261719
Epoch: 7, Steps: 10 | Train Loss: 2.166 Vali Loss: 3.263 Vali Acc: 0.156 Test Loss: 3.263 Test Acc: 0.156
Validation loss decreased (-0.123497 --> -0.156438).  Saving model ...
Epoch: 8 cost time: 1.5232865810394287
Epoch: 8, Steps: 10 | Train Loss: 1.886 Vali Loss: 3.251 Vali Acc: 0.199 Test Loss: 3.251 Test Acc: 0.199
Validation loss decreased (-0.156438 --> -0.198791).  Saving model ...
Epoch: 9 cost time: 1.4744079113006592
Epoch: 9, Steps: 10 | Train Loss: 1.614 Vali Loss: 3.312 Vali Acc: 0.168 Test Loss: 3.312 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.503779411315918
Epoch: 10, Steps: 10 | Train Loss: 1.286 Vali Loss: 3.468 Vali Acc: 0.171 Test Loss: 3.468 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6072402000427246
Epoch: 11, Steps: 10 | Train Loss: 1.132 Vali Loss: 3.392 Vali Acc: 0.187 Test Loss: 3.392 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.682950496673584
Epoch: 12, Steps: 10 | Train Loss: 0.894 Vali Loss: 3.374 Vali Acc: 0.208 Test Loss: 3.374 Test Acc: 0.208
Validation loss decreased (-0.198791 --> -0.208202).  Saving model ...
Epoch: 13 cost time: 1.3491268157958984
Epoch: 13, Steps: 10 | Train Loss: 0.639 Vali Loss: 3.611 Vali Acc: 0.186 Test Loss: 3.611 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4628372192382812
Epoch: 14, Steps: 10 | Train Loss: 0.463 Vali Loss: 3.501 Vali Acc: 0.220 Test Loss: 3.501 Test Acc: 0.220
Validation loss decreased (-0.208202 --> -0.219965).  Saving model ...
Epoch: 15 cost time: 1.5664687156677246
Epoch: 15, Steps: 10 | Train Loss: 0.446 Vali Loss: 3.842 Vali Acc: 0.172 Test Loss: 3.842 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6323764324188232
Epoch: 16, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.568 Vali Acc: 0.242 Test Loss: 3.568 Test Acc: 0.242
Validation loss decreased (-0.219965 --> -0.242317).  Saving model ...
Epoch: 17 cost time: 1.6375868320465088
Epoch: 17, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.919 Vali Acc: 0.224 Test Loss: 3.919 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5601599216461182
Epoch: 18, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.900 Vali Acc: 0.245 Test Loss: 3.900 Test Acc: 0.245
Validation loss decreased (-0.242317 --> -0.244667).  Saving model ...
Epoch: 19 cost time: 1.5405569076538086
Epoch: 19, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.003 Vali Acc: 0.227 Test Loss: 4.003 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5686523914337158
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.092 Vali Acc: 0.229 Test Loss: 4.092 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5130212306976318
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.056 Vali Acc: 0.253 Test Loss: 4.056 Test Acc: 0.253
Validation loss decreased (-0.244667 --> -0.252901).  Saving model ...
Epoch: 22 cost time: 1.5359323024749756
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.174 Vali Acc: 0.259 Test Loss: 4.174 Test Acc: 0.259
Validation loss decreased (-0.252901 --> -0.258782).  Saving model ...
Epoch: 23 cost time: 1.5529026985168457
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.101 Vali Acc: 0.246 Test Loss: 4.101 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4599573612213135
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.113 Vali Acc: 0.252 Test Loss: 4.113 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5756168365478516
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.146 Vali Acc: 0.264 Test Loss: 4.146 Test Acc: 0.264
Validation loss decreased (-0.258782 --> -0.263488).  Saving model ...
Epoch: 26 cost time: 1.564601182937622
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.189 Vali Acc: 0.267 Test Loss: 4.189 Test Acc: 0.267
Validation loss decreased (-0.263488 --> -0.267017).  Saving model ...
Epoch: 27 cost time: 1.4312937259674072
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.205 Vali Acc: 0.264 Test Loss: 4.205 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7190477848052979
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.206 Vali Acc: 0.271 Test Loss: 4.206 Test Acc: 0.271
Validation loss decreased (-0.267017 --> -0.270546).  Saving model ...
Epoch: 29 cost time: 1.606252670288086
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.218 Vali Acc: 0.269 Test Loss: 4.218 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6817476749420166
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.253 Vali Acc: 0.265 Test Loss: 4.253 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5445263385772705
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.267 Vali Acc: 0.265 Test Loss: 4.267 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5491323471069336
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.269 Vali Acc: 0.269 Test Loss: 4.269 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.472447156906128
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.278 Vali Acc: 0.272 Test Loss: 4.278 Test Acc: 0.272
Validation loss decreased (-0.270546 --> -0.271722).  Saving model ...
Epoch: 34 cost time: 1.4159917831420898
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.293 Vali Acc: 0.275 Test Loss: 4.293 Test Acc: 0.275
Validation loss decreased (-0.271722 --> -0.275251).  Saving model ...
Epoch: 35 cost time: 1.509678840637207
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.317 Vali Acc: 0.272 Test Loss: 4.317 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.765232801437378
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.329 Vali Acc: 0.274 Test Loss: 4.329 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.529287576675415
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.330 Vali Acc: 0.275 Test Loss: 4.330 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3538730144500732
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.346 Vali Acc: 0.278 Test Loss: 4.346 Test Acc: 0.278
Validation loss decreased (-0.275251 --> -0.277604).  Saving model ...
Epoch: 39 cost time: 1.4823524951934814
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.368 Vali Acc: 0.272 Test Loss: 4.368 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5361478328704834
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.381 Vali Acc: 0.276 Test Loss: 4.381 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5352039337158203
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.383 Vali Acc: 0.269 Test Loss: 4.383 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5731310844421387
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.390 Vali Acc: 0.268 Test Loss: 4.390 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.4545624256134033
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.400 Vali Acc: 0.269 Test Loss: 4.400 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.509552001953125
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.413 Vali Acc: 0.271 Test Loss: 4.413 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.4089922904968262
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.430 Vali Acc: 0.271 Test Loss: 4.430 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.4638707637786865
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.445 Vali Acc: 0.273 Test Loss: 4.445 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.475951910018921
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.457 Vali Acc: 0.269 Test Loss: 4.457 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.3838999271392822
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.464 Vali Acc: 0.273 Test Loss: 4.464 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 11187530
model size : 47.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.9966931343078613
Epoch: 1, Steps: 10 | Train Loss: 3.410 Vali Loss: 3.327 Vali Acc: 0.044 Test Loss: 3.327 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.4194538593292236
Epoch: 2, Steps: 10 | Train Loss: 3.274 Vali Loss: 3.508 Vali Acc: 0.058 Test Loss: 3.508 Test Acc: 0.058
Validation loss decreased (-0.043496 --> -0.057612).  Saving model ...
Epoch: 3 cost time: 1.920356273651123
Epoch: 3, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.314 Vali Acc: 0.076 Test Loss: 3.314 Test Acc: 0.076
Validation loss decreased (-0.057612 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 1.3736512660980225
Epoch: 4, Steps: 10 | Train Loss: 2.978 Vali Loss: 3.296 Vali Acc: 0.095 Test Loss: 3.296 Test Acc: 0.095
Validation loss decreased (-0.076437 --> -0.095261).  Saving model ...
Epoch: 5 cost time: 1.5523405075073242
Epoch: 5, Steps: 10 | Train Loss: 2.721 Vali Loss: 3.286 Vali Acc: 0.126 Test Loss: 3.286 Test Acc: 0.126
Validation loss decreased (-0.095261 --> -0.125849).  Saving model ...
Epoch: 6 cost time: 1.6918292045593262
Epoch: 6, Steps: 10 | Train Loss: 2.415 Vali Loss: 3.350 Vali Acc: 0.131 Test Loss: 3.350 Test Acc: 0.131
Validation loss decreased (-0.125849 --> -0.130555).  Saving model ...
Epoch: 7 cost time: 1.53480863571167
Epoch: 7, Steps: 10 | Train Loss: 2.292 Vali Loss: 3.318 Vali Acc: 0.155 Test Loss: 3.318 Test Acc: 0.155
Validation loss decreased (-0.130555 --> -0.155261).  Saving model ...
Epoch: 8 cost time: 1.3625597953796387
Epoch: 8, Steps: 10 | Train Loss: 1.869 Vali Loss: 3.340 Vali Acc: 0.152 Test Loss: 3.340 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8436529636383057
Epoch: 9, Steps: 10 | Train Loss: 1.524 Vali Loss: 3.395 Vali Acc: 0.174 Test Loss: 3.395 Test Acc: 0.174
Validation loss decreased (-0.155261 --> -0.174084).  Saving model ...
Epoch: 10 cost time: 1.5379908084869385
Epoch: 10, Steps: 10 | Train Loss: 1.381 Vali Loss: 3.308 Vali Acc: 0.207 Test Loss: 3.308 Test Acc: 0.207
Validation loss decreased (-0.174084 --> -0.207026).  Saving model ...
Epoch: 11 cost time: 1.5748770236968994
Epoch: 11, Steps: 10 | Train Loss: 1.157 Vali Loss: 3.454 Vali Acc: 0.195 Test Loss: 3.454 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7935817241668701
Epoch: 12, Steps: 10 | Train Loss: 0.932 Vali Loss: 3.568 Vali Acc: 0.193 Test Loss: 3.568 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9474201202392578
Epoch: 13, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.514 Vali Acc: 0.194 Test Loss: 3.514 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7666304111480713
Epoch: 14, Steps: 10 | Train Loss: 0.486 Vali Loss: 3.560 Vali Acc: 0.225 Test Loss: 3.560 Test Acc: 0.225
Validation loss decreased (-0.207026 --> -0.224670).  Saving model ...
Epoch: 15 cost time: 1.6289384365081787
Epoch: 15, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.741 Vali Acc: 0.193 Test Loss: 3.741 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9112498760223389
Epoch: 16, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.669 Vali Acc: 0.224 Test Loss: 3.669 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4944822788238525
Epoch: 17, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.997 Vali Acc: 0.229 Test Loss: 3.997 Test Acc: 0.229
Validation loss decreased (-0.224670 --> -0.229372).  Saving model ...
Epoch: 18 cost time: 1.581758975982666
Epoch: 18, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.196 Vali Acc: 0.206 Test Loss: 4.196 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.556304931640625
Epoch: 19, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.900 Vali Acc: 0.261 Test Loss: 3.900 Test Acc: 0.261
Validation loss decreased (-0.229372 --> -0.261137).  Saving model ...
Epoch: 20 cost time: 1.6488912105560303
Epoch: 20, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.048 Vali Acc: 0.235 Test Loss: 4.048 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6970834732055664
Epoch: 21, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.137 Vali Acc: 0.241 Test Loss: 4.137 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4760732650756836
Epoch: 22, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.159 Vali Acc: 0.253 Test Loss: 4.159 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5836598873138428
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.085 Vali Acc: 0.253 Test Loss: 4.085 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4434716701507568
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.243 Vali Acc: 0.234 Test Loss: 4.243 Test Acc: 0.234
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.407235622406006
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.323 Vali Acc: 0.246 Test Loss: 4.323 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7779686450958252
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.287 Vali Acc: 0.260 Test Loss: 4.287 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6414620876312256
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.263 Vali Acc: 0.264 Test Loss: 4.263 Test Acc: 0.264
Validation loss decreased (-0.261137 --> -0.263487).  Saving model ...
Epoch: 28 cost time: 1.6675500869750977
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.263 Vali Acc: 0.265 Test Loss: 4.263 Test Acc: 0.265
Validation loss decreased (-0.263487 --> -0.264663).  Saving model ...
Epoch: 29 cost time: 1.5752100944519043
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.286 Vali Acc: 0.262 Test Loss: 4.286 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7668390274047852
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.296 Vali Acc: 0.267 Test Loss: 4.296 Test Acc: 0.267
Validation loss decreased (-0.264663 --> -0.267016).  Saving model ...
Epoch: 31 cost time: 1.6085598468780518
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.305 Vali Acc: 0.267 Test Loss: 4.305 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8421308994293213
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.318 Vali Acc: 0.269 Test Loss: 4.318 Test Acc: 0.269
Validation loss decreased (-0.267016 --> -0.269369).  Saving model ...
Epoch: 33 cost time: 1.8838543891906738
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.334 Vali Acc: 0.271 Test Loss: 4.334 Test Acc: 0.271
Validation loss decreased (-0.269369 --> -0.270545).  Saving model ...
Epoch: 34 cost time: 1.7928895950317383
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.345 Vali Acc: 0.271 Test Loss: 4.345 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.418703317642212
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.353 Vali Acc: 0.272 Test Loss: 4.353 Test Acc: 0.272
Validation loss decreased (-0.270545 --> -0.271721).  Saving model ...
Epoch: 36 cost time: 2.237017869949341
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.361 Vali Acc: 0.272 Test Loss: 4.361 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.0050408840179443
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.364 Vali Acc: 0.272 Test Loss: 4.364 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5526924133300781
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.373 Vali Acc: 0.271 Test Loss: 4.373 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.863002061843872
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.384 Vali Acc: 0.273 Test Loss: 4.384 Test Acc: 0.273
Validation loss decreased (-0.271721 --> -0.272897).  Saving model ...
Epoch: 40 cost time: 1.7418115139007568
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.395 Vali Acc: 0.269 Test Loss: 4.395 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6528735160827637
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.404 Vali Acc: 0.272 Test Loss: 4.404 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.4589602947235107
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.417 Vali Acc: 0.271 Test Loss: 4.417 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.6773064136505127
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.427 Vali Acc: 0.269 Test Loss: 4.427 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.3285140991210938
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.436 Vali Acc: 0.274 Test Loss: 4.436 Test Acc: 0.274
Validation loss decreased (-0.272897 --> -0.274073).  Saving model ...
Epoch: 45 cost time: 1.7415459156036377
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.442 Vali Acc: 0.273 Test Loss: 4.442 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.5069866180419922
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.457 Vali Acc: 0.276 Test Loss: 4.457 Test Acc: 0.276
Validation loss decreased (-0.274073 --> -0.276426).  Saving model ...
Epoch: 47 cost time: 1.77250337600708
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.466 Vali Acc: 0.276 Test Loss: 4.466 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.9539861679077148
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.469 Vali Acc: 0.276 Test Loss: 4.469 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.475538730621338
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.476 Vali Acc: 0.275 Test Loss: 4.476 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.8116519451141357
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.482 Vali Acc: 0.274 Test Loss: 4.482 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.0960631370544434
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.492 Vali Acc: 0.278 Test Loss: 4.492 Test Acc: 0.278
Validation loss decreased (-0.276426 --> -0.277602).  Saving model ...
Epoch: 52 cost time: 1.7839760780334473
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.501 Vali Acc: 0.275 Test Loss: 4.501 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.8455007076263428
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.511 Vali Acc: 0.275 Test Loss: 4.511 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.6281871795654297
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.513 Vali Acc: 0.278 Test Loss: 4.513 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.3735542297363281
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.516 Vali Acc: 0.278 Test Loss: 4.516 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.318816900253296
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.522 Vali Acc: 0.278 Test Loss: 4.522 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.067521333694458
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.526 Vali Acc: 0.276 Test Loss: 4.526 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.4549927711486816
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.536 Vali Acc: 0.276 Test Loss: 4.536 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.551123857498169
Epoch: 59, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.543 Vali Acc: 0.275 Test Loss: 4.543 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.5413947105407715
Epoch: 60, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.555 Vali Acc: 0.275 Test Loss: 4.555 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.743225336074829
Epoch: 61, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.565 Vali Acc: 0.274 Test Loss: 4.565 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 11181386
model size : 47.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4312705993652344
Epoch: 1, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.317 Vali Acc: 0.054 Test Loss: 3.317 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 1.7628593444824219
Epoch: 2, Steps: 10 | Train Loss: 3.298 Vali Loss: 3.427 Vali Acc: 0.071 Test Loss: 3.427 Test Acc: 0.071
Validation loss decreased (-0.054084 --> -0.070554).  Saving model ...
Epoch: 3 cost time: 1.548243522644043
Epoch: 3, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.290 Vali Acc: 0.072 Test Loss: 3.290 Test Acc: 0.072
Validation loss decreased (-0.070554 --> -0.071732).  Saving model ...
Epoch: 4 cost time: 1.851820945739746
Epoch: 4, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.257 Vali Acc: 0.088 Test Loss: 3.257 Test Acc: 0.088
Validation loss decreased (-0.071732 --> -0.088203).  Saving model ...
Epoch: 5 cost time: 1.4126005172729492
Epoch: 5, Steps: 10 | Train Loss: 2.797 Vali Loss: 3.410 Vali Acc: 0.076 Test Loss: 3.410 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6186668872833252
Epoch: 6, Steps: 10 | Train Loss: 2.531 Vali Loss: 3.205 Vali Acc: 0.120 Test Loss: 3.205 Test Acc: 0.120
Validation loss decreased (-0.088203 --> -0.119968).  Saving model ...
Epoch: 7 cost time: 1.5986778736114502
Epoch: 7, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.227 Vali Acc: 0.132 Test Loss: 3.227 Test Acc: 0.132
Validation loss decreased (-0.119968 --> -0.131732).  Saving model ...
Epoch: 8 cost time: 1.8444159030914307
Epoch: 8, Steps: 10 | Train Loss: 2.008 Vali Loss: 3.343 Vali Acc: 0.147 Test Loss: 3.343 Test Acc: 0.147
Validation loss decreased (-0.131732 --> -0.147025).  Saving model ...
Epoch: 9 cost time: 1.5162453651428223
Epoch: 9, Steps: 10 | Train Loss: 1.767 Vali Loss: 3.273 Vali Acc: 0.165 Test Loss: 3.273 Test Acc: 0.165
Validation loss decreased (-0.147025 --> -0.164673).  Saving model ...
Epoch: 10 cost time: 1.3541193008422852
Epoch: 10, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.396 Vali Acc: 0.180 Test Loss: 3.396 Test Acc: 0.180
Validation loss decreased (-0.164673 --> -0.179966).  Saving model ...
Epoch: 11 cost time: 1.6025257110595703
Epoch: 11, Steps: 10 | Train Loss: 1.223 Vali Loss: 3.344 Vali Acc: 0.198 Test Loss: 3.344 Test Acc: 0.198
Validation loss decreased (-0.179966 --> -0.197614).  Saving model ...
Epoch: 12 cost time: 1.8355674743652344
Epoch: 12, Steps: 10 | Train Loss: 0.960 Vali Loss: 3.529 Vali Acc: 0.192 Test Loss: 3.529 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6687026023864746
Epoch: 13, Steps: 10 | Train Loss: 0.764 Vali Loss: 3.467 Vali Acc: 0.200 Test Loss: 3.467 Test Acc: 0.200
Validation loss decreased (-0.197614 --> -0.199965).  Saving model ...
Epoch: 14 cost time: 1.5059473514556885
Epoch: 14, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.479 Vali Acc: 0.208 Test Loss: 3.479 Test Acc: 0.208
Validation loss decreased (-0.199965 --> -0.208201).  Saving model ...
Epoch: 15 cost time: 1.6409080028533936
Epoch: 15, Steps: 10 | Train Loss: 0.431 Vali Loss: 3.670 Vali Acc: 0.220 Test Loss: 3.670 Test Acc: 0.220
Validation loss decreased (-0.208201 --> -0.219963).  Saving model ...
Epoch: 16 cost time: 1.466151237487793
Epoch: 16, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.677 Vali Acc: 0.227 Test Loss: 3.677 Test Acc: 0.227
Validation loss decreased (-0.219963 --> -0.227022).  Saving model ...
Epoch: 17 cost time: 1.6804018020629883
Epoch: 17, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.786 Vali Acc: 0.220 Test Loss: 3.786 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3865041732788086
Epoch: 18, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.991 Vali Acc: 0.231 Test Loss: 3.991 Test Acc: 0.231
Validation loss decreased (-0.227022 --> -0.230548).  Saving model ...
Epoch: 19 cost time: 1.398268222808838
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.913 Vali Acc: 0.253 Test Loss: 3.913 Test Acc: 0.253
Validation loss decreased (-0.230548 --> -0.252902).  Saving model ...
Epoch: 20 cost time: 1.771752119064331
Epoch: 20, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.064 Vali Acc: 0.253 Test Loss: 4.064 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5421700477600098
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.113 Vali Acc: 0.231 Test Loss: 4.113 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.437831163406372
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.039 Vali Acc: 0.258 Test Loss: 4.039 Test Acc: 0.258
Validation loss decreased (-0.252902 --> -0.257607).  Saving model ...
Epoch: 23 cost time: 1.614729642868042
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.052 Vali Acc: 0.266 Test Loss: 4.052 Test Acc: 0.266
Validation loss decreased (-0.257607 --> -0.265842).  Saving model ...
Epoch: 24 cost time: 1.674821138381958
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.123 Vali Acc: 0.262 Test Loss: 4.123 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5249042510986328
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.160 Vali Acc: 0.262 Test Loss: 4.160 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4034278392791748
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.178 Vali Acc: 0.267 Test Loss: 4.178 Test Acc: 0.267
Validation loss decreased (-0.265842 --> -0.267017).  Saving model ...
Epoch: 27 cost time: 1.4501128196716309
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.188 Vali Acc: 0.265 Test Loss: 4.188 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5113506317138672
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.193 Vali Acc: 0.268 Test Loss: 4.193 Test Acc: 0.268
Validation loss decreased (-0.267017 --> -0.268193).  Saving model ...
Epoch: 29 cost time: 1.6641554832458496
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.207 Vali Acc: 0.268 Test Loss: 4.207 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3842353820800781
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.218 Vali Acc: 0.266 Test Loss: 4.218 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6289763450622559
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.224 Vali Acc: 0.268 Test Loss: 4.224 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3676860332489014
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.231 Vali Acc: 0.273 Test Loss: 4.231 Test Acc: 0.273
Validation loss decreased (-0.268193 --> -0.272899).  Saving model ...
Epoch: 33 cost time: 1.615734577178955
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.244 Vali Acc: 0.273 Test Loss: 4.244 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4615721702575684
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.258 Vali Acc: 0.272 Test Loss: 4.258 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3875620365142822
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.269 Vali Acc: 0.272 Test Loss: 4.269 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8317584991455078
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.279 Vali Acc: 0.279 Test Loss: 4.279 Test Acc: 0.279
Validation loss decreased (-0.272899 --> -0.278781).  Saving model ...
Epoch: 37 cost time: 1.494621753692627
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.287 Vali Acc: 0.278 Test Loss: 4.287 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.106999397277832
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.293 Vali Acc: 0.275 Test Loss: 4.293 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.8595983982086182
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.304 Vali Acc: 0.275 Test Loss: 4.304 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.7648727893829346
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.315 Vali Acc: 0.274 Test Loss: 4.315 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.6264128684997559
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.328 Vali Acc: 0.274 Test Loss: 4.328 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.8943846225738525
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.330 Vali Acc: 0.275 Test Loss: 4.330 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.8172354698181152
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.349 Vali Acc: 0.274 Test Loss: 4.349 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.8000597953796387
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.368 Vali Acc: 0.274 Test Loss: 4.368 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.846869707107544
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.372 Vali Acc: 0.275 Test Loss: 4.372 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4958000183105469
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.376 Vali Acc: 0.275 Test Loss: 4.376 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 9361226
model size : 40.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3178606033325195
Epoch: 1, Steps: 10 | Train Loss: 3.367 Vali Loss: 3.343 Vali Acc: 0.036 Test Loss: 3.343 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.6935811042785645
Epoch: 2, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.413 Vali Acc: 0.046 Test Loss: 3.413 Test Acc: 0.046
Validation loss decreased (-0.036437 --> -0.045848).  Saving model ...
Epoch: 3 cost time: 1.4020023345947266
Epoch: 3, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.361 Vali Acc: 0.055 Test Loss: 3.361 Test Acc: 0.055
Validation loss decreased (-0.045848 --> -0.055261).  Saving model ...
Epoch: 4 cost time: 1.5165438652038574
Epoch: 4, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.337 Vali Acc: 0.076 Test Loss: 3.337 Test Acc: 0.076
Validation loss decreased (-0.055261 --> -0.076437).  Saving model ...
Epoch: 5 cost time: 1.6398301124572754
Epoch: 5, Steps: 10 | Train Loss: 2.869 Vali Loss: 3.292 Vali Acc: 0.096 Test Loss: 3.292 Test Acc: 0.096
Validation loss decreased (-0.076437 --> -0.096438).  Saving model ...
Epoch: 6 cost time: 1.4705753326416016
Epoch: 6, Steps: 10 | Train Loss: 2.639 Vali Loss: 3.318 Vali Acc: 0.105 Test Loss: 3.318 Test Acc: 0.105
Validation loss decreased (-0.096438 --> -0.104673).  Saving model ...
Epoch: 7 cost time: 1.6797666549682617
Epoch: 7, Steps: 10 | Train Loss: 2.347 Vali Loss: 3.293 Vali Acc: 0.132 Test Loss: 3.293 Test Acc: 0.132
Validation loss decreased (-0.104673 --> -0.131732).  Saving model ...
Epoch: 8 cost time: 1.5396273136138916
Epoch: 8, Steps: 10 | Train Loss: 1.994 Vali Loss: 3.261 Vali Acc: 0.160 Test Loss: 3.261 Test Acc: 0.160
Validation loss decreased (-0.131732 --> -0.159967).  Saving model ...
Epoch: 9 cost time: 1.6503932476043701
Epoch: 9, Steps: 10 | Train Loss: 1.703 Vali Loss: 3.291 Vali Acc: 0.187 Test Loss: 3.291 Test Acc: 0.187
Validation loss decreased (-0.159967 --> -0.187026).  Saving model ...
Epoch: 10 cost time: 1.503464698791504
Epoch: 10, Steps: 10 | Train Loss: 1.491 Vali Loss: 3.298 Vali Acc: 0.195 Test Loss: 3.298 Test Acc: 0.195
Validation loss decreased (-0.187026 --> -0.195261).  Saving model ...
Epoch: 11 cost time: 1.4997286796569824
Epoch: 11, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.402 Vali Acc: 0.182 Test Loss: 3.402 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5154078006744385
Epoch: 12, Steps: 10 | Train Loss: 0.901 Vali Loss: 3.469 Vali Acc: 0.176 Test Loss: 3.469 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5647976398468018
Epoch: 13, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.480 Vali Acc: 0.208 Test Loss: 3.480 Test Acc: 0.208
Validation loss decreased (-0.195261 --> -0.208200).  Saving model ...
Epoch: 14 cost time: 1.5902040004730225
Epoch: 14, Steps: 10 | Train Loss: 0.566 Vali Loss: 3.525 Vali Acc: 0.218 Test Loss: 3.525 Test Acc: 0.218
Validation loss decreased (-0.208200 --> -0.217612).  Saving model ...
Epoch: 15 cost time: 1.7807457447052002
Epoch: 15, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.616 Vali Acc: 0.229 Test Loss: 3.616 Test Acc: 0.229
Validation loss decreased (-0.217612 --> -0.229376).  Saving model ...
Epoch: 16 cost time: 1.7888448238372803
Epoch: 16, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.758 Vali Acc: 0.216 Test Loss: 3.758 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6589000225067139
Epoch: 17, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.908 Vali Acc: 0.234 Test Loss: 3.908 Test Acc: 0.234
Validation loss decreased (-0.229376 --> -0.234079).  Saving model ...
Epoch: 18 cost time: 1.6014108657836914
Epoch: 18, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.912 Vali Acc: 0.244 Test Loss: 3.912 Test Acc: 0.244
Validation loss decreased (-0.234079 --> -0.243490).  Saving model ...
Epoch: 19 cost time: 1.8609204292297363
Epoch: 19, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.986 Vali Acc: 0.242 Test Loss: 3.986 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.413794755935669
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.083 Vali Acc: 0.244 Test Loss: 4.083 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7066667079925537
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.975 Vali Acc: 0.275 Test Loss: 3.975 Test Acc: 0.275
Validation loss decreased (-0.243490 --> -0.275254).  Saving model ...
Epoch: 22 cost time: 1.894730806350708
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.128 Vali Acc: 0.265 Test Loss: 4.128 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5821690559387207
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.172 Vali Acc: 0.272 Test Loss: 4.172 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6479244232177734
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.091 Vali Acc: 0.278 Test Loss: 4.091 Test Acc: 0.278
Validation loss decreased (-0.275254 --> -0.277606).  Saving model ...
Epoch: 25 cost time: 1.4540863037109375
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.121 Vali Acc: 0.280 Test Loss: 4.121 Test Acc: 0.280
Validation loss decreased (-0.277606 --> -0.279959).  Saving model ...
Epoch: 26 cost time: 1.255204439163208
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.180 Vali Acc: 0.282 Test Loss: 4.180 Test Acc: 0.282
Validation loss decreased (-0.279959 --> -0.282311).  Saving model ...
Epoch: 27 cost time: 1.634941577911377
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.193 Vali Acc: 0.284 Test Loss: 4.193 Test Acc: 0.284
Validation loss decreased (-0.282311 --> -0.283487).  Saving model ...
Epoch: 28 cost time: 1.6198694705963135
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.183 Vali Acc: 0.285 Test Loss: 4.183 Test Acc: 0.285
Validation loss decreased (-0.283487 --> -0.284664).  Saving model ...
Epoch: 29 cost time: 1.4283263683319092
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.193 Vali Acc: 0.286 Test Loss: 4.193 Test Acc: 0.286
Validation loss decreased (-0.284664 --> -0.285840).  Saving model ...
Epoch: 30 cost time: 1.4259965419769287
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.198 Vali Acc: 0.282 Test Loss: 4.198 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4601960182189941
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.221 Vali Acc: 0.284 Test Loss: 4.221 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4951224327087402
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.250 Vali Acc: 0.285 Test Loss: 4.250 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6246750354766846
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.271 Vali Acc: 0.282 Test Loss: 4.271 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.472357988357544
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.276 Vali Acc: 0.282 Test Loss: 4.276 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.8870973587036133
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.286 Vali Acc: 0.286 Test Loss: 4.286 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.4246439933776855
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.296 Vali Acc: 0.286 Test Loss: 4.296 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.5553367137908936
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.311 Vali Acc: 0.285 Test Loss: 4.311 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.4981796741485596
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.320 Vali Acc: 0.284 Test Loss: 4.320 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.4694364070892334
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.328 Vali Acc: 0.285 Test Loss: 4.328 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2858823529411765
model parameter : 9355082
model size : 40.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.410191774368286
Epoch: 1, Steps: 10 | Train Loss: 3.292 Vali Loss: 3.335 Vali Acc: 0.041 Test Loss: 3.335 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.4062755107879639
Epoch: 2, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.393 Vali Acc: 0.066 Test Loss: 3.393 Test Acc: 0.066
Validation loss decreased (-0.041143 --> -0.065848).  Saving model ...
Epoch: 3 cost time: 1.488487720489502
Epoch: 3, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.284 Vali Acc: 0.055 Test Loss: 3.284 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.47186279296875
Epoch: 4, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.321 Vali Acc: 0.098 Test Loss: 3.321 Test Acc: 0.098
Validation loss decreased (-0.065848 --> -0.097614).  Saving model ...
Epoch: 5 cost time: 1.3153040409088135
Epoch: 5, Steps: 10 | Train Loss: 2.779 Vali Loss: 3.260 Vali Acc: 0.107 Test Loss: 3.260 Test Acc: 0.107
Validation loss decreased (-0.097614 --> -0.107026).  Saving model ...
Epoch: 6 cost time: 1.4225313663482666
Epoch: 6, Steps: 10 | Train Loss: 2.615 Vali Loss: 3.349 Vali Acc: 0.099 Test Loss: 3.349 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7804882526397705
Epoch: 7, Steps: 10 | Train Loss: 2.224 Vali Loss: 3.254 Vali Acc: 0.148 Test Loss: 3.254 Test Acc: 0.148
Validation loss decreased (-0.107026 --> -0.148203).  Saving model ...
Epoch: 8 cost time: 1.714043378829956
Epoch: 8, Steps: 10 | Train Loss: 2.002 Vali Loss: 3.316 Vali Acc: 0.146 Test Loss: 3.316 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6586036682128906
Epoch: 9, Steps: 10 | Train Loss: 1.692 Vali Loss: 3.402 Vali Acc: 0.167 Test Loss: 3.402 Test Acc: 0.167
Validation loss decreased (-0.148203 --> -0.167025).  Saving model ...
Epoch: 10 cost time: 1.560443639755249
Epoch: 10, Steps: 10 | Train Loss: 1.455 Vali Loss: 3.320 Vali Acc: 0.200 Test Loss: 3.320 Test Acc: 0.200
Validation loss decreased (-0.167025 --> -0.199967).  Saving model ...
Epoch: 11 cost time: 1.751887559890747
Epoch: 11, Steps: 10 | Train Loss: 1.187 Vali Loss: 3.347 Vali Acc: 0.214 Test Loss: 3.347 Test Acc: 0.214
Validation loss decreased (-0.199967 --> -0.214084).  Saving model ...
Epoch: 12 cost time: 1.3884460926055908
Epoch: 12, Steps: 10 | Train Loss: 0.869 Vali Loss: 3.391 Vali Acc: 0.205 Test Loss: 3.391 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5825245380401611
Epoch: 13, Steps: 10 | Train Loss: 0.721 Vali Loss: 3.438 Vali Acc: 0.211 Test Loss: 3.438 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.634307861328125
Epoch: 14, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.582 Vali Acc: 0.231 Test Loss: 3.582 Test Acc: 0.231
Validation loss decreased (-0.214084 --> -0.230552).  Saving model ...
Epoch: 15 cost time: 1.4496455192565918
Epoch: 15, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.842 Vali Acc: 0.201 Test Loss: 3.842 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7026622295379639
Epoch: 16, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.820 Vali Acc: 0.219 Test Loss: 3.820 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3713715076446533
Epoch: 17, Steps: 10 | Train Loss: 0.195 Vali Loss: 4.043 Vali Acc: 0.188 Test Loss: 4.043 Test Acc: 0.188
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5491089820861816
Epoch: 18, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.704 Vali Acc: 0.244 Test Loss: 3.704 Test Acc: 0.244
Validation loss decreased (-0.230552 --> -0.243492).  Saving model ...
Epoch: 19 cost time: 1.6830661296844482
Epoch: 19, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.052 Vali Acc: 0.249 Test Loss: 4.052 Test Acc: 0.249
Validation loss decreased (-0.243492 --> -0.249371).  Saving model ...
Epoch: 20 cost time: 1.2978339195251465
Epoch: 20, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.952 Vali Acc: 0.258 Test Loss: 3.952 Test Acc: 0.258
Validation loss decreased (-0.249371 --> -0.257608).  Saving model ...
Epoch: 21 cost time: 1.408262014389038
Epoch: 21, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.197 Vali Acc: 0.241 Test Loss: 4.197 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4248387813568115
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.040 Vali Acc: 0.256 Test Loss: 4.040 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8061792850494385
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.157 Vali Acc: 0.267 Test Loss: 4.157 Test Acc: 0.267
Validation loss decreased (-0.257608 --> -0.267017).  Saving model ...
Epoch: 24 cost time: 1.6074316501617432
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.158 Vali Acc: 0.254 Test Loss: 4.158 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6148700714111328
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.221 Vali Acc: 0.274 Test Loss: 4.221 Test Acc: 0.274
Validation loss decreased (-0.267017 --> -0.274075).  Saving model ...
Epoch: 26 cost time: 1.5901234149932861
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.167 Vali Acc: 0.276 Test Loss: 4.167 Test Acc: 0.276
Validation loss decreased (-0.274075 --> -0.276429).  Saving model ...
Epoch: 27 cost time: 1.8757374286651611
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.209 Vali Acc: 0.275 Test Loss: 4.209 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5275921821594238
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.277 Vali Acc: 0.268 Test Loss: 4.277 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6417956352233887
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.284 Vali Acc: 0.280 Test Loss: 4.284 Test Acc: 0.280
Validation loss decreased (-0.276429 --> -0.279957).  Saving model ...
Epoch: 30 cost time: 1.3720366954803467
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.297 Vali Acc: 0.281 Test Loss: 4.297 Test Acc: 0.281
Validation loss decreased (-0.279957 --> -0.281133).  Saving model ...
Epoch: 31 cost time: 1.5334792137145996
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.308 Vali Acc: 0.280 Test Loss: 4.308 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4913833141326904
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.319 Vali Acc: 0.281 Test Loss: 4.319 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3512239456176758
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.328 Vali Acc: 0.281 Test Loss: 4.328 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5652291774749756
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.340 Vali Acc: 0.286 Test Loss: 4.340 Test Acc: 0.286
Validation loss decreased (-0.281133 --> -0.285839).  Saving model ...
Epoch: 35 cost time: 1.5232532024383545
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.348 Vali Acc: 0.288 Test Loss: 4.348 Test Acc: 0.288
Validation loss decreased (-0.285839 --> -0.288192).  Saving model ...
Epoch: 36 cost time: 1.7506234645843506
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.349 Vali Acc: 0.287 Test Loss: 4.349 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7978925704956055
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.357 Vali Acc: 0.288 Test Loss: 4.357 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6055123805999756
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.359 Vali Acc: 0.287 Test Loss: 4.359 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.8576347827911377
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.368 Vali Acc: 0.288 Test Loss: 4.368 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.5873260498046875
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.370 Vali Acc: 0.288 Test Loss: 4.370 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.5157322883605957
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.375 Vali Acc: 0.287 Test Loss: 4.375 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.7407755851745605
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.383 Vali Acc: 0.291 Test Loss: 4.383 Test Acc: 0.291
Validation loss decreased (-0.288192 --> -0.290544).  Saving model ...
Epoch: 43 cost time: 1.6297826766967773
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.397 Vali Acc: 0.288 Test Loss: 4.397 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.5952746868133545
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.407 Vali Acc: 0.289 Test Loss: 4.407 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.539480209350586
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.418 Vali Acc: 0.291 Test Loss: 4.418 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.5411841869354248
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.422 Vali Acc: 0.292 Test Loss: 4.422 Test Acc: 0.292
Validation loss decreased (-0.290544 --> -0.291720).  Saving model ...
Epoch: 47 cost time: 1.624279499053955
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.434 Vali Acc: 0.293 Test Loss: 4.434 Test Acc: 0.293
Validation loss decreased (-0.291720 --> -0.292897).  Saving model ...
Epoch: 48 cost time: 2.0050108432769775
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.441 Vali Acc: 0.293 Test Loss: 4.441 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.5502915382385254
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.446 Vali Acc: 0.292 Test Loss: 4.446 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.489457130432129
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.454 Vali Acc: 0.291 Test Loss: 4.454 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.4512808322906494
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.464 Vali Acc: 0.292 Test Loss: 4.464 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.7642459869384766
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.471 Vali Acc: 0.293 Test Loss: 4.471 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.663433313369751
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.478 Vali Acc: 0.291 Test Loss: 4.478 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.6226954460144043
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.488 Vali Acc: 0.292 Test Loss: 4.488 Test Acc: 0.292
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.7083659172058105
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.496 Vali Acc: 0.292 Test Loss: 4.496 Test Acc: 0.292
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.649155616760254
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.501 Vali Acc: 0.292 Test Loss: 4.501 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.5227904319763184
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.506 Vali Acc: 0.292 Test Loss: 4.506 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29294117647058826
model parameter : 9348938
model size : 40.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.543464422225952
Epoch: 1, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.320 Vali Acc: 0.054 Test Loss: 3.320 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 1.633301019668579
Epoch: 2, Steps: 10 | Train Loss: 3.221 Vali Loss: 3.434 Vali Acc: 0.045 Test Loss: 3.434 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5946648120880127
Epoch: 3, Steps: 10 | Train Loss: 3.105 Vali Loss: 3.288 Vali Acc: 0.073 Test Loss: 3.288 Test Acc: 0.073
Validation loss decreased (-0.054084 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 1.5894441604614258
Epoch: 4, Steps: 10 | Train Loss: 3.096 Vali Loss: 3.335 Vali Acc: 0.111 Test Loss: 3.335 Test Acc: 0.111
Validation loss decreased (-0.072908 --> -0.110555).  Saving model ...
Epoch: 5 cost time: 1.992823600769043
Epoch: 5, Steps: 10 | Train Loss: 2.826 Vali Loss: 3.228 Vali Acc: 0.121 Test Loss: 3.228 Test Acc: 0.121
Validation loss decreased (-0.110555 --> -0.121144).  Saving model ...
Epoch: 6 cost time: 1.6777584552764893
Epoch: 6, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.305 Vali Acc: 0.144 Test Loss: 3.305 Test Acc: 0.144
Validation loss decreased (-0.121144 --> -0.143496).  Saving model ...
Epoch: 7 cost time: 1.5144922733306885
Epoch: 7, Steps: 10 | Train Loss: 2.300 Vali Loss: 3.223 Vali Acc: 0.148 Test Loss: 3.223 Test Acc: 0.148
Validation loss decreased (-0.143496 --> -0.148203).  Saving model ...
Epoch: 8 cost time: 1.5276691913604736
Epoch: 8, Steps: 10 | Train Loss: 2.039 Vali Loss: 3.267 Vali Acc: 0.165 Test Loss: 3.267 Test Acc: 0.165
Validation loss decreased (-0.148203 --> -0.164673).  Saving model ...
Epoch: 9 cost time: 1.5141243934631348
Epoch: 9, Steps: 10 | Train Loss: 1.681 Vali Loss: 3.281 Vali Acc: 0.182 Test Loss: 3.281 Test Acc: 0.182
Validation loss decreased (-0.164673 --> -0.182320).  Saving model ...
Epoch: 10 cost time: 1.4139885902404785
Epoch: 10, Steps: 10 | Train Loss: 1.481 Vali Loss: 3.276 Vali Acc: 0.178 Test Loss: 3.276 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6802785396575928
Epoch: 11, Steps: 10 | Train Loss: 1.274 Vali Loss: 3.437 Vali Acc: 0.185 Test Loss: 3.437 Test Acc: 0.185
Validation loss decreased (-0.182320 --> -0.184672).  Saving model ...
Epoch: 12 cost time: 1.5383572578430176
Epoch: 12, Steps: 10 | Train Loss: 1.028 Vali Loss: 3.474 Vali Acc: 0.172 Test Loss: 3.474 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5782296657562256
Epoch: 13, Steps: 10 | Train Loss: 0.754 Vali Loss: 3.519 Vali Acc: 0.192 Test Loss: 3.519 Test Acc: 0.192
Validation loss decreased (-0.184672 --> -0.191730).  Saving model ...
Epoch: 14 cost time: 1.5054798126220703
Epoch: 14, Steps: 10 | Train Loss: 0.574 Vali Loss: 3.683 Vali Acc: 0.212 Test Loss: 3.683 Test Acc: 0.212
Validation loss decreased (-0.191730 --> -0.211728).  Saving model ...
Epoch: 15 cost time: 1.4372425079345703
Epoch: 15, Steps: 10 | Train Loss: 0.426 Vali Loss: 3.596 Vali Acc: 0.222 Test Loss: 3.596 Test Acc: 0.222
Validation loss decreased (-0.211728 --> -0.222317).  Saving model ...
Epoch: 16 cost time: 1.5088465213775635
Epoch: 16, Steps: 10 | Train Loss: 0.381 Vali Loss: 3.834 Vali Acc: 0.213 Test Loss: 3.834 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4262230396270752
Epoch: 17, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.787 Vali Acc: 0.215 Test Loss: 3.787 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3467776775360107
Epoch: 18, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.173 Vali Acc: 0.194 Test Loss: 4.173 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.524916648864746
Epoch: 19, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.154 Vali Acc: 0.211 Test Loss: 4.154 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3232197761535645
Epoch: 20, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.120 Vali Acc: 0.246 Test Loss: 4.120 Test Acc: 0.246
Validation loss decreased (-0.222317 --> -0.245841).  Saving model ...
Epoch: 21 cost time: 1.3602685928344727
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.029 Vali Acc: 0.249 Test Loss: 4.029 Test Acc: 0.249
Validation loss decreased (-0.245841 --> -0.249371).  Saving model ...
Epoch: 22 cost time: 1.4613161087036133
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.131 Vali Acc: 0.256 Test Loss: 4.131 Test Acc: 0.256
Validation loss decreased (-0.249371 --> -0.256429).  Saving model ...
Epoch: 23 cost time: 1.7172260284423828
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.147 Vali Acc: 0.260 Test Loss: 4.147 Test Acc: 0.260
Validation loss decreased (-0.256429 --> -0.259959).  Saving model ...
Epoch: 24 cost time: 1.3847217559814453
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.198 Vali Acc: 0.264 Test Loss: 4.198 Test Acc: 0.264
Validation loss decreased (-0.259959 --> -0.263487).  Saving model ...
Epoch: 25 cost time: 1.292083978652954
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.252 Vali Acc: 0.264 Test Loss: 4.252 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.578815221786499
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.231 Vali Acc: 0.265 Test Loss: 4.231 Test Acc: 0.265
Validation loss decreased (-0.263487 --> -0.264664).  Saving model ...
Epoch: 27 cost time: 1.5633347034454346
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.229 Vali Acc: 0.264 Test Loss: 4.229 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3682422637939453
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.401 Vali Acc: 0.265 Test Loss: 4.401 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4694983959197998
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.324 Vali Acc: 0.268 Test Loss: 4.324 Test Acc: 0.268
Validation loss decreased (-0.264664 --> -0.268192).  Saving model ...
Epoch: 30 cost time: 1.1971566677093506
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.352 Vali Acc: 0.262 Test Loss: 4.352 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5891709327697754
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.356 Vali Acc: 0.266 Test Loss: 4.356 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4168078899383545
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.379 Vali Acc: 0.265 Test Loss: 4.379 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2632222175598145
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.402 Vali Acc: 0.269 Test Loss: 4.402 Test Acc: 0.269
Validation loss decreased (-0.268192 --> -0.269368).  Saving model ...
Epoch: 34 cost time: 1.6380698680877686
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.422 Vali Acc: 0.271 Test Loss: 4.422 Test Acc: 0.271
Validation loss decreased (-0.269368 --> -0.270544).  Saving model ...
Epoch: 35 cost time: 2.1332998275756836
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.436 Vali Acc: 0.274 Test Loss: 4.436 Test Acc: 0.274
Validation loss decreased (-0.270544 --> -0.274073).  Saving model ...
Epoch: 36 cost time: 1.4015002250671387
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.433 Vali Acc: 0.275 Test Loss: 4.433 Test Acc: 0.275
Validation loss decreased (-0.274073 --> -0.275250).  Saving model ...
Epoch: 37 cost time: 1.5541894435882568
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.438 Vali Acc: 0.268 Test Loss: 4.438 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3149023056030273
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.452 Vali Acc: 0.274 Test Loss: 4.452 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.482274055480957
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.464 Vali Acc: 0.273 Test Loss: 4.464 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.616868019104004
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.474 Vali Acc: 0.271 Test Loss: 4.474 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.5461599826812744
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.487 Vali Acc: 0.275 Test Loss: 4.487 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6238923072814941
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.504 Vali Acc: 0.274 Test Loss: 4.504 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.328658103942871
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.513 Vali Acc: 0.273 Test Loss: 4.513 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.588503122329712
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.526 Vali Acc: 0.275 Test Loss: 4.526 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.4084057807922363
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.543 Vali Acc: 0.278 Test Loss: 4.543 Test Acc: 0.278
Validation loss decreased (-0.275250 --> -0.277602).  Saving model ...
Epoch: 46 cost time: 1.449946641921997
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.543 Vali Acc: 0.274 Test Loss: 4.543 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.5036065578460693
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.543 Vali Acc: 0.273 Test Loss: 4.543 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.4160950183868408
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.550 Vali Acc: 0.276 Test Loss: 4.550 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.585860252380371
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.560 Vali Acc: 0.279 Test Loss: 4.560 Test Acc: 0.279
Validation loss decreased (-0.277602 --> -0.278778).  Saving model ...
Epoch: 50 cost time: 1.5191314220428467
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.575 Vali Acc: 0.279 Test Loss: 4.575 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.7241535186767578
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.578 Vali Acc: 0.276 Test Loss: 4.578 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.3246314525604248
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.583 Vali Acc: 0.274 Test Loss: 4.583 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.655432939529419
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.593 Vali Acc: 0.278 Test Loss: 4.593 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.6497845649719238
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.597 Vali Acc: 0.276 Test Loss: 4.597 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.8130550384521484
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.600 Vali Acc: 0.275 Test Loss: 4.600 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.433950662612915
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.613 Vali Acc: 0.280 Test Loss: 4.613 Test Acc: 0.280
Validation loss decreased (-0.278778 --> -0.279954).  Saving model ...
Epoch: 57 cost time: 1.2251973152160645
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.628 Vali Acc: 0.280 Test Loss: 4.628 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.4778039455413818
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.636 Vali Acc: 0.280 Test Loss: 4.636 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.41054368019104
Epoch: 59, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.641 Vali Acc: 0.279 Test Loss: 4.641 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.5287790298461914
Epoch: 60, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.652 Vali Acc: 0.279 Test Loss: 4.652 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.5093448162078857
Epoch: 61, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.656 Vali Acc: 0.274 Test Loss: 4.656 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.4726433753967285
Epoch: 62, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.662 Vali Acc: 0.276 Test Loss: 4.662 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.470773458480835
Epoch: 63, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.667 Vali Acc: 0.275 Test Loss: 4.667 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.4943232536315918
Epoch: 64, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.675 Vali Acc: 0.275 Test Loss: 4.675 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.2406792640686035
Epoch: 65, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.681 Vali Acc: 0.278 Test Loss: 4.681 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.396021842956543
Epoch: 66, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.692 Vali Acc: 0.278 Test Loss: 4.692 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 9342794
model size : 40.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.206996440887451
Epoch: 1, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.316 Vali Acc: 0.055 Test Loss: 3.316 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 1.7604804039001465
Epoch: 2, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.513 Vali Acc: 0.041 Test Loss: 3.513 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.649080753326416
Epoch: 3, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.333 Vali Acc: 0.081 Test Loss: 3.333 Test Acc: 0.081
Validation loss decreased (-0.055261 --> -0.081143).  Saving model ...
Epoch: 4 cost time: 2.4780380725860596
Epoch: 4, Steps: 10 | Train Loss: 3.114 Vali Loss: 3.290 Vali Acc: 0.078 Test Loss: 3.290 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6746556758880615
Epoch: 5, Steps: 10 | Train Loss: 2.812 Vali Loss: 3.360 Vali Acc: 0.101 Test Loss: 3.360 Test Acc: 0.101
Validation loss decreased (-0.081143 --> -0.101143).  Saving model ...
Epoch: 6 cost time: 1.6933491230010986
Epoch: 6, Steps: 10 | Train Loss: 2.572 Vali Loss: 3.237 Vali Acc: 0.115 Test Loss: 3.237 Test Acc: 0.115
Validation loss decreased (-0.101143 --> -0.115262).  Saving model ...
Epoch: 7 cost time: 1.9539203643798828
Epoch: 7, Steps: 10 | Train Loss: 2.336 Vali Loss: 3.311 Vali Acc: 0.125 Test Loss: 3.311 Test Acc: 0.125
Validation loss decreased (-0.115262 --> -0.124673).  Saving model ...
Epoch: 8 cost time: 1.7961277961730957
Epoch: 8, Steps: 10 | Train Loss: 2.107 Vali Loss: 3.304 Vali Acc: 0.148 Test Loss: 3.304 Test Acc: 0.148
Validation loss decreased (-0.124673 --> -0.148202).  Saving model ...
Epoch: 9 cost time: 1.7929737567901611
Epoch: 9, Steps: 10 | Train Loss: 1.785 Vali Loss: 3.306 Vali Acc: 0.171 Test Loss: 3.306 Test Acc: 0.171
Validation loss decreased (-0.148202 --> -0.170555).  Saving model ...
Epoch: 10 cost time: 1.5772120952606201
Epoch: 10, Steps: 10 | Train Loss: 1.515 Vali Loss: 3.414 Vali Acc: 0.164 Test Loss: 3.414 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5179393291473389
Epoch: 11, Steps: 10 | Train Loss: 1.290 Vali Loss: 3.482 Vali Acc: 0.186 Test Loss: 3.482 Test Acc: 0.186
Validation loss decreased (-0.170555 --> -0.185848).  Saving model ...
Epoch: 12 cost time: 1.5844228267669678
Epoch: 12, Steps: 10 | Train Loss: 1.044 Vali Loss: 3.416 Vali Acc: 0.202 Test Loss: 3.416 Test Acc: 0.202
Validation loss decreased (-0.185848 --> -0.202319).  Saving model ...
Epoch: 13 cost time: 1.5149986743927002
Epoch: 13, Steps: 10 | Train Loss: 0.894 Vali Loss: 3.520 Vali Acc: 0.219 Test Loss: 3.520 Test Acc: 0.219
Validation loss decreased (-0.202319 --> -0.218788).  Saving model ...
Epoch: 14 cost time: 1.6868658065795898
Epoch: 14, Steps: 10 | Train Loss: 0.669 Vali Loss: 3.594 Vali Acc: 0.204 Test Loss: 3.594 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6229305267333984
Epoch: 15, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.703 Vali Acc: 0.206 Test Loss: 3.703 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6492974758148193
Epoch: 16, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.809 Vali Acc: 0.216 Test Loss: 3.809 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7437801361083984
Epoch: 17, Steps: 10 | Train Loss: 0.217 Vali Loss: 3.940 Vali Acc: 0.211 Test Loss: 3.940 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1182827949523926
Epoch: 18, Steps: 10 | Train Loss: 0.172 Vali Loss: 4.213 Vali Acc: 0.209 Test Loss: 4.213 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7069082260131836
Epoch: 19, Steps: 10 | Train Loss: 0.112 Vali Loss: 4.064 Vali Acc: 0.239 Test Loss: 4.064 Test Acc: 0.239
Validation loss decreased (-0.218788 --> -0.238783).  Saving model ...
Epoch: 20 cost time: 1.8974106311798096
Epoch: 20, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.425 Vali Acc: 0.227 Test Loss: 4.425 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9110314846038818
Epoch: 21, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.213 Vali Acc: 0.242 Test Loss: 4.213 Test Acc: 0.242
Validation loss decreased (-0.238783 --> -0.242311).  Saving model ...
Epoch: 22 cost time: 1.9522764682769775
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.317 Vali Acc: 0.239 Test Loss: 4.317 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.858048915863037
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.509 Vali Acc: 0.221 Test Loss: 4.509 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8045461177825928
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.493 Vali Acc: 0.233 Test Loss: 4.493 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.5711307525634766
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.489 Vali Acc: 0.241 Test Loss: 4.489 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.4071297645568848
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.510 Vali Acc: 0.246 Test Loss: 4.510 Test Acc: 0.246
Validation loss decreased (-0.242311 --> -0.245837).  Saving model ...
Epoch: 27 cost time: 1.7186415195465088
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.555 Vali Acc: 0.249 Test Loss: 4.555 Test Acc: 0.249
Validation loss decreased (-0.245837 --> -0.249366).  Saving model ...
Epoch: 28 cost time: 1.8287618160247803
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.568 Vali Acc: 0.254 Test Loss: 4.568 Test Acc: 0.254
Validation loss decreased (-0.249366 --> -0.254072).  Saving model ...
Epoch: 29 cost time: 1.4592745304107666
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.586 Vali Acc: 0.255 Test Loss: 4.586 Test Acc: 0.255
Validation loss decreased (-0.254072 --> -0.255248).  Saving model ...
Epoch: 30 cost time: 1.702599048614502
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.586 Vali Acc: 0.252 Test Loss: 4.586 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5794007778167725
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.587 Vali Acc: 0.253 Test Loss: 4.587 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7447474002838135
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.599 Vali Acc: 0.253 Test Loss: 4.599 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6081466674804688
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.623 Vali Acc: 0.255 Test Loss: 4.623 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.0606846809387207
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.635 Vali Acc: 0.254 Test Loss: 4.635 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.9182460308074951
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.637 Vali Acc: 0.258 Test Loss: 4.637 Test Acc: 0.258
Validation loss decreased (-0.255248 --> -0.257601).  Saving model ...
Epoch: 36 cost time: 1.7005681991577148
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.651 Vali Acc: 0.256 Test Loss: 4.651 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.748337984085083
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.667 Vali Acc: 0.261 Test Loss: 4.667 Test Acc: 0.261
Validation loss decreased (-0.257601 --> -0.261130).  Saving model ...
Epoch: 38 cost time: 2.0236940383911133
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.676 Vali Acc: 0.262 Test Loss: 4.676 Test Acc: 0.262
Validation loss decreased (-0.261130 --> -0.262306).  Saving model ...
Epoch: 39 cost time: 1.4828383922576904
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.675 Vali Acc: 0.261 Test Loss: 4.675 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6804969310760498
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.674 Vali Acc: 0.255 Test Loss: 4.674 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5694167613983154
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.686 Vali Acc: 0.259 Test Loss: 4.686 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.263841152191162
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.704 Vali Acc: 0.261 Test Loss: 4.704 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.6883628368377686
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.725 Vali Acc: 0.261 Test Loss: 4.725 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6753242015838623
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.732 Vali Acc: 0.260 Test Loss: 4.732 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.0911707878112793
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.740 Vali Acc: 0.258 Test Loss: 4.740 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.5635631084442139
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.746 Vali Acc: 0.255 Test Loss: 4.746 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.7839710712432861
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.748 Vali Acc: 0.255 Test Loss: 4.748 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.7377471923828125
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.758 Vali Acc: 0.254 Test Loss: 4.758 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26235294117647057
model parameter : 8441930
model size : 37.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1352486610412598
Epoch: 1, Steps: 10 | Train Loss: 3.459 Vali Loss: 3.329 Vali Acc: 0.047 Test Loss: 3.329 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.5216729640960693
Epoch: 2, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.502 Vali Acc: 0.036 Test Loss: 3.502 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5868942737579346
Epoch: 3, Steps: 10 | Train Loss: 3.212 Vali Loss: 3.372 Vali Acc: 0.065 Test Loss: 3.372 Test Acc: 0.065
Validation loss decreased (-0.047026 --> -0.064672).  Saving model ...
Epoch: 4 cost time: 1.79738450050354
Epoch: 4, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.266 Vali Acc: 0.088 Test Loss: 3.266 Test Acc: 0.088
Validation loss decreased (-0.064672 --> -0.088203).  Saving model ...
Epoch: 5 cost time: 1.5517282485961914
Epoch: 5, Steps: 10 | Train Loss: 2.820 Vali Loss: 3.260 Vali Acc: 0.094 Test Loss: 3.260 Test Acc: 0.094
Validation loss decreased (-0.088203 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 1.6445872783660889
Epoch: 6, Steps: 10 | Train Loss: 2.653 Vali Loss: 3.321 Vali Acc: 0.115 Test Loss: 3.321 Test Acc: 0.115
Validation loss decreased (-0.094085 --> -0.115261).  Saving model ...
Epoch: 7 cost time: 1.6060481071472168
Epoch: 7, Steps: 10 | Train Loss: 2.373 Vali Loss: 3.213 Vali Acc: 0.131 Test Loss: 3.213 Test Acc: 0.131
Validation loss decreased (-0.115261 --> -0.130556).  Saving model ...
Epoch: 8 cost time: 1.8381335735321045
Epoch: 8, Steps: 10 | Train Loss: 2.133 Vali Loss: 3.370 Vali Acc: 0.140 Test Loss: 3.370 Test Acc: 0.140
Validation loss decreased (-0.130556 --> -0.139966).  Saving model ...
Epoch: 9 cost time: 1.2700347900390625
Epoch: 9, Steps: 10 | Train Loss: 1.846 Vali Loss: 3.291 Vali Acc: 0.176 Test Loss: 3.291 Test Acc: 0.176
Validation loss decreased (-0.139966 --> -0.176438).  Saving model ...
Epoch: 10 cost time: 1.2775447368621826
Epoch: 10, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.419 Vali Acc: 0.174 Test Loss: 3.419 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.44606614112854
Epoch: 11, Steps: 10 | Train Loss: 1.513 Vali Loss: 3.453 Vali Acc: 0.171 Test Loss: 3.453 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4646110534667969
Epoch: 12, Steps: 10 | Train Loss: 1.156 Vali Loss: 3.374 Vali Acc: 0.208 Test Loss: 3.374 Test Acc: 0.208
Validation loss decreased (-0.176438 --> -0.208202).  Saving model ...
Epoch: 13 cost time: 1.7281818389892578
Epoch: 13, Steps: 10 | Train Loss: 0.904 Vali Loss: 3.553 Vali Acc: 0.193 Test Loss: 3.553 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.382617473602295
Epoch: 14, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.638 Vali Acc: 0.199 Test Loss: 3.638 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.434403657913208
Epoch: 15, Steps: 10 | Train Loss: 0.594 Vali Loss: 3.707 Vali Acc: 0.220 Test Loss: 3.707 Test Acc: 0.220
Validation loss decreased (-0.208202 --> -0.219963).  Saving model ...
Epoch: 16 cost time: 1.7103064060211182
Epoch: 16, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.772 Vali Acc: 0.225 Test Loss: 3.772 Test Acc: 0.225
Validation loss decreased (-0.219963 --> -0.224668).  Saving model ...
Epoch: 17 cost time: 1.4935879707336426
Epoch: 17, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.774 Vali Acc: 0.233 Test Loss: 3.774 Test Acc: 0.233
Validation loss decreased (-0.224668 --> -0.232903).  Saving model ...
Epoch: 18 cost time: 1.6811413764953613
Epoch: 18, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.857 Vali Acc: 0.238 Test Loss: 3.857 Test Acc: 0.238
Validation loss decreased (-0.232903 --> -0.237608).  Saving model ...
Epoch: 19 cost time: 1.3370840549468994
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.960 Vali Acc: 0.247 Test Loss: 3.960 Test Acc: 0.247
Validation loss decreased (-0.237608 --> -0.247019).  Saving model ...
Epoch: 20 cost time: 1.762096643447876
Epoch: 20, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.085 Vali Acc: 0.235 Test Loss: 4.085 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5168638229370117
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.125 Vali Acc: 0.236 Test Loss: 4.125 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.637793779373169
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.226 Vali Acc: 0.255 Test Loss: 4.226 Test Acc: 0.255
Validation loss decreased (-0.247019 --> -0.255252).  Saving model ...
Epoch: 23 cost time: 1.7345221042633057
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.166 Vali Acc: 0.258 Test Loss: 4.166 Test Acc: 0.258
Validation loss decreased (-0.255252 --> -0.257605).  Saving model ...
Epoch: 24 cost time: 1.6057612895965576
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.232 Vali Acc: 0.259 Test Loss: 4.232 Test Acc: 0.259
Validation loss decreased (-0.257605 --> -0.258781).  Saving model ...
Epoch: 25 cost time: 1.4916646480560303
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.367 Vali Acc: 0.253 Test Loss: 4.367 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7185933589935303
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.291 Vali Acc: 0.272 Test Loss: 4.291 Test Acc: 0.272
Validation loss decreased (-0.258781 --> -0.271722).  Saving model ...
Epoch: 27 cost time: 1.510019302368164
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.303 Vali Acc: 0.275 Test Loss: 4.303 Test Acc: 0.275
Validation loss decreased (-0.271722 --> -0.275251).  Saving model ...
Epoch: 28 cost time: 1.431286096572876
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.318 Vali Acc: 0.268 Test Loss: 4.318 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4417901039123535
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.316 Vali Acc: 0.269 Test Loss: 4.316 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6883981227874756
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.329 Vali Acc: 0.268 Test Loss: 4.329 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4798336029052734
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.326 Vali Acc: 0.274 Test Loss: 4.326 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6644368171691895
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.335 Vali Acc: 0.273 Test Loss: 4.335 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4037983417510986
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.351 Vali Acc: 0.279 Test Loss: 4.351 Test Acc: 0.279
Validation loss decreased (-0.275251 --> -0.278780).  Saving model ...
Epoch: 34 cost time: 1.5487298965454102
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.368 Vali Acc: 0.274 Test Loss: 4.368 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8318967819213867
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.377 Vali Acc: 0.275 Test Loss: 4.377 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4964072704315186
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.399 Vali Acc: 0.275 Test Loss: 4.399 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4860689640045166
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.408 Vali Acc: 0.273 Test Loss: 4.408 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.5748076438903809
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.418 Vali Acc: 0.275 Test Loss: 4.418 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4208734035491943
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.426 Vali Acc: 0.278 Test Loss: 4.426 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.0322341918945312
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.440 Vali Acc: 0.276 Test Loss: 4.440 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.6071462631225586
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.448 Vali Acc: 0.276 Test Loss: 4.448 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.7635083198547363
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.459 Vali Acc: 0.279 Test Loss: 4.459 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4668662548065186
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.454 Vali Acc: 0.282 Test Loss: 4.454 Test Acc: 0.282
Validation loss decreased (-0.278780 --> -0.282308).  Saving model ...
Epoch: 44 cost time: 1.7317335605621338
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.477 Vali Acc: 0.280 Test Loss: 4.477 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5493688583374023
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.473 Vali Acc: 0.282 Test Loss: 4.473 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4976630210876465
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.488 Vali Acc: 0.280 Test Loss: 4.488 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.4223551750183105
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.510 Vali Acc: 0.276 Test Loss: 4.510 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.4800121784210205
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.508 Vali Acc: 0.282 Test Loss: 4.508 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3701543807983398
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.516 Vali Acc: 0.280 Test Loss: 4.516 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.288853406906128
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.527 Vali Acc: 0.279 Test Loss: 4.527 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.6962687969207764
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.536 Vali Acc: 0.280 Test Loss: 4.536 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.5366253852844238
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.533 Vali Acc: 0.284 Test Loss: 4.533 Test Acc: 0.284
Validation loss decreased (-0.282308 --> -0.283484).  Saving model ...
Epoch: 53 cost time: 1.6352593898773193
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.542 Vali Acc: 0.280 Test Loss: 4.542 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.4059348106384277
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.554 Vali Acc: 0.279 Test Loss: 4.554 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.6623866558074951
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.566 Vali Acc: 0.281 Test Loss: 4.566 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.562281608581543
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.569 Vali Acc: 0.282 Test Loss: 4.569 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.5758922100067139
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.568 Vali Acc: 0.284 Test Loss: 4.568 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.6796753406524658
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.568 Vali Acc: 0.285 Test Loss: 4.568 Test Acc: 0.285
Validation loss decreased (-0.283484 --> -0.284660).  Saving model ...
Epoch: 59 cost time: 1.4196465015411377
Epoch: 59, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.582 Vali Acc: 0.285 Test Loss: 4.582 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.5252535343170166
Epoch: 60, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.595 Vali Acc: 0.282 Test Loss: 4.595 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.629812240600586
Epoch: 61, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.609 Vali Acc: 0.284 Test Loss: 4.609 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.3774244785308838
Epoch: 62, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.611 Vali Acc: 0.285 Test Loss: 4.611 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.5628159046173096
Epoch: 63, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.616 Vali Acc: 0.285 Test Loss: 4.616 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.54490065574646
Epoch: 64, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.618 Vali Acc: 0.285 Test Loss: 4.618 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.8568496704101562
Epoch: 65, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.623 Vali Acc: 0.285 Test Loss: 4.623 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.4370813369750977
Epoch: 66, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.637 Vali Acc: 0.286 Test Loss: 4.637 Test Acc: 0.286
Validation loss decreased (-0.284660 --> -0.285836).  Saving model ...
Epoch: 67 cost time: 1.469515085220337
Epoch: 67, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.641 Vali Acc: 0.287 Test Loss: 4.641 Test Acc: 0.287
Validation loss decreased (-0.285836 --> -0.287012).  Saving model ...
Epoch: 68 cost time: 1.4893074035644531
Epoch: 68, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.628 Vali Acc: 0.284 Test Loss: 4.628 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.41668701171875
Epoch: 69, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.637 Vali Acc: 0.285 Test Loss: 4.637 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.287667989730835
Epoch: 70, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.646 Vali Acc: 0.282 Test Loss: 4.646 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.359818458557129
Epoch: 71, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.655 Vali Acc: 0.284 Test Loss: 4.655 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.3042793273925781
Epoch: 72, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.642 Vali Acc: 0.282 Test Loss: 4.642 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.3305253982543945
Epoch: 73, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.658 Vali Acc: 0.286 Test Loss: 4.658 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.4241797924041748
Epoch: 74, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.668 Vali Acc: 0.284 Test Loss: 4.668 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.5452518463134766
Epoch: 75, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.665 Vali Acc: 0.286 Test Loss: 4.665 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.3493108749389648
Epoch: 76, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.678 Vali Acc: 0.286 Test Loss: 4.678 Test Acc: 0.286
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.605665683746338
Epoch: 77, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.679 Vali Acc: 0.285 Test Loss: 4.679 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 8435786
model size : 37.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.236645221710205
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.376 Vali Acc: 0.044 Test Loss: 3.376 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.6549627780914307
Epoch: 2, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.404 Vali Acc: 0.069 Test Loss: 3.404 Test Acc: 0.069
Validation loss decreased (-0.043496 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 1.5835182666778564
Epoch: 3, Steps: 10 | Train Loss: 3.180 Vali Loss: 3.356 Vali Acc: 0.054 Test Loss: 3.356 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4181087017059326
Epoch: 4, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.332 Vali Acc: 0.089 Test Loss: 3.332 Test Acc: 0.089
Validation loss decreased (-0.069378 --> -0.089378).  Saving model ...
Epoch: 5 cost time: 1.6384825706481934
Epoch: 5, Steps: 10 | Train Loss: 2.933 Vali Loss: 3.252 Vali Acc: 0.093 Test Loss: 3.252 Test Acc: 0.093
Validation loss decreased (-0.089378 --> -0.092909).  Saving model ...
Epoch: 6 cost time: 1.6975836753845215
Epoch: 6, Steps: 10 | Train Loss: 2.553 Vali Loss: 3.357 Vali Acc: 0.112 Test Loss: 3.357 Test Acc: 0.112
Validation loss decreased (-0.092909 --> -0.111731).  Saving model ...
Epoch: 7 cost time: 1.6865999698638916
Epoch: 7, Steps: 10 | Train Loss: 2.300 Vali Loss: 3.300 Vali Acc: 0.136 Test Loss: 3.300 Test Acc: 0.136
Validation loss decreased (-0.111731 --> -0.136438).  Saving model ...
Epoch: 8 cost time: 1.5013439655303955
Epoch: 8, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.299 Vali Acc: 0.162 Test Loss: 3.299 Test Acc: 0.162
Validation loss decreased (-0.136438 --> -0.162320).  Saving model ...
Epoch: 9 cost time: 1.6596977710723877
Epoch: 9, Steps: 10 | Train Loss: 1.738 Vali Loss: 3.414 Vali Acc: 0.152 Test Loss: 3.414 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3496334552764893
Epoch: 10, Steps: 10 | Train Loss: 1.513 Vali Loss: 3.369 Vali Acc: 0.178 Test Loss: 3.369 Test Acc: 0.178
Validation loss decreased (-0.162320 --> -0.177613).  Saving model ...
Epoch: 11 cost time: 1.5963947772979736
Epoch: 11, Steps: 10 | Train Loss: 1.234 Vali Loss: 3.428 Vali Acc: 0.189 Test Loss: 3.428 Test Acc: 0.189
Validation loss decreased (-0.177613 --> -0.189377).  Saving model ...
Epoch: 12 cost time: 1.7623460292816162
Epoch: 12, Steps: 10 | Train Loss: 1.128 Vali Loss: 3.463 Vali Acc: 0.174 Test Loss: 3.463 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5791771411895752
Epoch: 13, Steps: 10 | Train Loss: 0.773 Vali Loss: 3.662 Vali Acc: 0.180 Test Loss: 3.662 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5912823677062988
Epoch: 14, Steps: 10 | Train Loss: 0.638 Vali Loss: 3.521 Vali Acc: 0.234 Test Loss: 3.521 Test Acc: 0.234
Validation loss decreased (-0.189377 --> -0.234082).  Saving model ...
Epoch: 15 cost time: 1.6625850200653076
Epoch: 15, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.720 Vali Acc: 0.200 Test Loss: 3.720 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.716097354888916
Epoch: 16, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.738 Vali Acc: 0.215 Test Loss: 3.738 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.588975429534912
Epoch: 17, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.953 Vali Acc: 0.244 Test Loss: 3.953 Test Acc: 0.244
Validation loss decreased (-0.234082 --> -0.243490).  Saving model ...
Epoch: 18 cost time: 1.4680490493774414
Epoch: 18, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.937 Vali Acc: 0.241 Test Loss: 3.937 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6032848358154297
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.012 Vali Acc: 0.251 Test Loss: 4.012 Test Acc: 0.251
Validation loss decreased (-0.243490 --> -0.250548).  Saving model ...
Epoch: 20 cost time: 1.4803731441497803
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.158 Vali Acc: 0.246 Test Loss: 4.158 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8589026927947998
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.225 Vali Acc: 0.254 Test Loss: 4.225 Test Acc: 0.254
Validation loss decreased (-0.250548 --> -0.254075).  Saving model ...
Epoch: 22 cost time: 1.5739390850067139
Epoch: 22, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.193 Vali Acc: 0.266 Test Loss: 4.193 Test Acc: 0.266
Validation loss decreased (-0.254075 --> -0.265840).  Saving model ...
Epoch: 23 cost time: 1.5009212493896484
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.155 Vali Acc: 0.267 Test Loss: 4.155 Test Acc: 0.267
Validation loss decreased (-0.265840 --> -0.267017).  Saving model ...
Epoch: 24 cost time: 1.5304505825042725
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.163 Vali Acc: 0.266 Test Loss: 4.163 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.577601432800293
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.202 Vali Acc: 0.267 Test Loss: 4.202 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.427527666091919
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.237 Vali Acc: 0.273 Test Loss: 4.237 Test Acc: 0.273
Validation loss decreased (-0.267017 --> -0.272899).  Saving model ...
Epoch: 27 cost time: 1.2298662662506104
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.264 Vali Acc: 0.275 Test Loss: 4.264 Test Acc: 0.275
Validation loss decreased (-0.272899 --> -0.275251).  Saving model ...
Epoch: 28 cost time: 1.472980260848999
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.281 Vali Acc: 0.268 Test Loss: 4.281 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3281502723693848
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.304 Vali Acc: 0.267 Test Loss: 4.304 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.632293462753296
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.305 Vali Acc: 0.272 Test Loss: 4.305 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3964347839355469
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.325 Vali Acc: 0.266 Test Loss: 4.325 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5296525955200195
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.332 Vali Acc: 0.273 Test Loss: 4.332 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6138756275177002
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.347 Vali Acc: 0.267 Test Loss: 4.347 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.56052827835083
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.359 Vali Acc: 0.269 Test Loss: 4.359 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4067409038543701
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.373 Vali Acc: 0.272 Test Loss: 4.373 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3226380348205566
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.385 Vali Acc: 0.271 Test Loss: 4.385 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4277632236480713
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.398 Vali Acc: 0.273 Test Loss: 4.398 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 8429642
model size : 37.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.927536964416504
Epoch: 1, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.314 Vali Acc: 0.049 Test Loss: 3.314 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.6070685386657715
Epoch: 2, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.454 Vali Acc: 0.069 Test Loss: 3.454 Test Acc: 0.069
Validation loss decreased (-0.049379 --> -0.069377).  Saving model ...
Epoch: 3 cost time: 1.5140843391418457
Epoch: 3, Steps: 10 | Train Loss: 3.156 Vali Loss: 3.324 Vali Acc: 0.073 Test Loss: 3.324 Test Acc: 0.073
Validation loss decreased (-0.069377 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 1.6200895309448242
Epoch: 4, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.304 Vali Acc: 0.078 Test Loss: 3.304 Test Acc: 0.078
Validation loss decreased (-0.072908 --> -0.077614).  Saving model ...
Epoch: 5 cost time: 1.711423635482788
Epoch: 5, Steps: 10 | Train Loss: 2.833 Vali Loss: 3.261 Vali Acc: 0.087 Test Loss: 3.261 Test Acc: 0.087
Validation loss decreased (-0.077614 --> -0.087026).  Saving model ...
Epoch: 6 cost time: 1.6821942329406738
Epoch: 6, Steps: 10 | Train Loss: 2.528 Vali Loss: 3.254 Vali Acc: 0.144 Test Loss: 3.254 Test Acc: 0.144
Validation loss decreased (-0.087026 --> -0.143497).  Saving model ...
Epoch: 7 cost time: 1.4512145519256592
Epoch: 7, Steps: 10 | Train Loss: 2.305 Vali Loss: 3.257 Vali Acc: 0.131 Test Loss: 3.257 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.601548671722412
Epoch: 8, Steps: 10 | Train Loss: 2.065 Vali Loss: 3.311 Vali Acc: 0.153 Test Loss: 3.311 Test Acc: 0.153
Validation loss decreased (-0.143497 --> -0.152908).  Saving model ...
Epoch: 9 cost time: 1.2913806438446045
Epoch: 9, Steps: 10 | Train Loss: 1.736 Vali Loss: 3.238 Vali Acc: 0.172 Test Loss: 3.238 Test Acc: 0.172
Validation loss decreased (-0.152908 --> -0.171732).  Saving model ...
Epoch: 10 cost time: 1.5251128673553467
Epoch: 10, Steps: 10 | Train Loss: 1.550 Vali Loss: 3.456 Vali Acc: 0.182 Test Loss: 3.456 Test Acc: 0.182
Validation loss decreased (-0.171732 --> -0.182318).  Saving model ...
Epoch: 11 cost time: 1.5152244567871094
Epoch: 11, Steps: 10 | Train Loss: 1.256 Vali Loss: 3.412 Vali Acc: 0.189 Test Loss: 3.412 Test Acc: 0.189
Validation loss decreased (-0.182318 --> -0.189378).  Saving model ...
Epoch: 12 cost time: 1.3614933490753174
Epoch: 12, Steps: 10 | Train Loss: 1.062 Vali Loss: 3.472 Vali Acc: 0.179 Test Loss: 3.472 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8530223369598389
Epoch: 13, Steps: 10 | Train Loss: 0.871 Vali Loss: 3.444 Vali Acc: 0.220 Test Loss: 3.444 Test Acc: 0.220
Validation loss decreased (-0.189378 --> -0.219966).  Saving model ...
Epoch: 14 cost time: 1.469825267791748
Epoch: 14, Steps: 10 | Train Loss: 0.656 Vali Loss: 3.553 Vali Acc: 0.218 Test Loss: 3.553 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9527337551116943
Epoch: 15, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.780 Vali Acc: 0.194 Test Loss: 3.780 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.729712724685669
Epoch: 16, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.717 Vali Acc: 0.220 Test Loss: 3.717 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6166222095489502
Epoch: 17, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.775 Vali Acc: 0.241 Test Loss: 3.775 Test Acc: 0.241
Validation loss decreased (-0.219966 --> -0.241139).  Saving model ...
Epoch: 18 cost time: 1.6202421188354492
Epoch: 18, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.932 Vali Acc: 0.233 Test Loss: 3.932 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6243400573730469
Epoch: 19, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.928 Vali Acc: 0.240 Test Loss: 3.928 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5243487358093262
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.110 Vali Acc: 0.249 Test Loss: 4.110 Test Acc: 0.249
Validation loss decreased (-0.241139 --> -0.249371).  Saving model ...
Epoch: 21 cost time: 1.4970269203186035
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.087 Vali Acc: 0.255 Test Loss: 4.087 Test Acc: 0.255
Validation loss decreased (-0.249371 --> -0.255253).  Saving model ...
Epoch: 22 cost time: 1.3171074390411377
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.151 Vali Acc: 0.259 Test Loss: 4.151 Test Acc: 0.259
Validation loss decreased (-0.255253 --> -0.258782).  Saving model ...
Epoch: 23 cost time: 1.7871077060699463
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.160 Vali Acc: 0.262 Test Loss: 4.160 Test Acc: 0.262
Validation loss decreased (-0.258782 --> -0.262311).  Saving model ...
Epoch: 24 cost time: 1.9861433506011963
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.182 Vali Acc: 0.255 Test Loss: 4.182 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.611900806427002
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.232 Vali Acc: 0.266 Test Loss: 4.232 Test Acc: 0.266
Validation loss decreased (-0.262311 --> -0.265840).  Saving model ...
Epoch: 26 cost time: 1.8005073070526123
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.268 Vali Acc: 0.268 Test Loss: 4.268 Test Acc: 0.268
Validation loss decreased (-0.265840 --> -0.268193).  Saving model ...
Epoch: 27 cost time: 1.5949995517730713
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.252 Vali Acc: 0.264 Test Loss: 4.252 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.332481861114502
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.249 Vali Acc: 0.264 Test Loss: 4.249 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3639700412750244
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.276 Vali Acc: 0.267 Test Loss: 4.276 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.0448029041290283
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.296 Vali Acc: 0.269 Test Loss: 4.296 Test Acc: 0.269
Validation loss decreased (-0.268193 --> -0.269369).  Saving model ...
Epoch: 31 cost time: 1.844247579574585
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.307 Vali Acc: 0.274 Test Loss: 4.307 Test Acc: 0.274
Validation loss decreased (-0.269369 --> -0.274075).  Saving model ...
Epoch: 32 cost time: 1.5915191173553467
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.319 Vali Acc: 0.278 Test Loss: 4.319 Test Acc: 0.278
Validation loss decreased (-0.274075 --> -0.277604).  Saving model ...
Epoch: 33 cost time: 1.207641363143921
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.346 Vali Acc: 0.269 Test Loss: 4.346 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.824577808380127
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.366 Vali Acc: 0.268 Test Loss: 4.366 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6299965381622314
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.372 Vali Acc: 0.269 Test Loss: 4.372 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6549065113067627
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.392 Vali Acc: 0.273 Test Loss: 4.392 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7056324481964111
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.405 Vali Acc: 0.274 Test Loss: 4.405 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.7577314376831055
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.428 Vali Acc: 0.274 Test Loss: 4.428 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.6805033683776855
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.430 Vali Acc: 0.272 Test Loss: 4.430 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.4931519031524658
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.426 Vali Acc: 0.274 Test Loss: 4.426 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.6433091163635254
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.445 Vali Acc: 0.279 Test Loss: 4.445 Test Acc: 0.279
Validation loss decreased (-0.277604 --> -0.278779).  Saving model ...
Epoch: 42 cost time: 1.585371971130371
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.466 Vali Acc: 0.274 Test Loss: 4.466 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.7712295055389404
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.473 Vali Acc: 0.272 Test Loss: 4.473 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.6642446517944336
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.482 Vali Acc: 0.269 Test Loss: 4.482 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.5588979721069336
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.499 Vali Acc: 0.269 Test Loss: 4.499 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.6306235790252686
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.508 Vali Acc: 0.271 Test Loss: 4.508 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.4523606300354004
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.514 Vali Acc: 0.278 Test Loss: 4.514 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3978967666625977
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.521 Vali Acc: 0.276 Test Loss: 4.521 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.6409404277801514
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.535 Vali Acc: 0.271 Test Loss: 4.535 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.6837575435638428
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.541 Vali Acc: 0.276 Test Loss: 4.541 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.4976515769958496
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.545 Vali Acc: 0.280 Test Loss: 4.545 Test Acc: 0.280
Validation loss decreased (-0.278779 --> -0.279955).  Saving model ...
Epoch: 52 cost time: 1.7803940773010254
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.556 Vali Acc: 0.285 Test Loss: 4.556 Test Acc: 0.285
Validation loss decreased (-0.279955 --> -0.284660).  Saving model ...
Epoch: 53 cost time: 1.52032470703125
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.574 Vali Acc: 0.282 Test Loss: 4.574 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.7842977046966553
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.594 Vali Acc: 0.279 Test Loss: 4.594 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.3029820919036865
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.600 Vali Acc: 0.276 Test Loss: 4.600 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.4093279838562012
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.596 Vali Acc: 0.274 Test Loss: 4.596 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.5239968299865723
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.595 Vali Acc: 0.275 Test Loss: 4.595 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.772568941116333
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.605 Vali Acc: 0.272 Test Loss: 4.605 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.770735740661621
Epoch: 59, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.620 Vali Acc: 0.275 Test Loss: 4.620 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.3326568603515625
Epoch: 60, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.633 Vali Acc: 0.274 Test Loss: 4.633 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.7923316955566406
Epoch: 61, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.652 Vali Acc: 0.275 Test Loss: 4.652 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.5653748512268066
Epoch: 62, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.665 Vali Acc: 0.273 Test Loss: 4.665 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2847058823529412
model parameter : 8423498
model size : 37.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.332904100418091
Epoch: 1, Steps: 10 | Train Loss: 3.413 Vali Loss: 3.334 Vali Acc: 0.032 Test Loss: 3.334 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 1.5103225708007812
Epoch: 2, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.421 Vali Acc: 0.042 Test Loss: 3.421 Test Acc: 0.042
Validation loss decreased (-0.031731 --> -0.042319).  Saving model ...
Epoch: 3 cost time: 1.447488784790039
Epoch: 3, Steps: 10 | Train Loss: 3.160 Vali Loss: 3.346 Vali Acc: 0.074 Test Loss: 3.346 Test Acc: 0.074
Validation loss decreased (-0.042319 --> -0.074084).  Saving model ...
Epoch: 4 cost time: 1.5011138916015625
Epoch: 4, Steps: 10 | Train Loss: 3.048 Vali Loss: 3.308 Vali Acc: 0.071 Test Loss: 3.308 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.380838394165039
Epoch: 5, Steps: 10 | Train Loss: 2.870 Vali Loss: 3.232 Vali Acc: 0.095 Test Loss: 3.232 Test Acc: 0.095
Validation loss decreased (-0.074084 --> -0.095262).  Saving model ...
Epoch: 6 cost time: 1.6099426746368408
Epoch: 6, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.338 Vali Acc: 0.128 Test Loss: 3.338 Test Acc: 0.128
Validation loss decreased (-0.095262 --> -0.128202).  Saving model ...
Epoch: 7 cost time: 1.2509205341339111
Epoch: 7, Steps: 10 | Train Loss: 2.352 Vali Loss: 3.270 Vali Acc: 0.113 Test Loss: 3.270 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5532894134521484
Epoch: 8, Steps: 10 | Train Loss: 2.130 Vali Loss: 3.292 Vali Acc: 0.158 Test Loss: 3.292 Test Acc: 0.158
Validation loss decreased (-0.128202 --> -0.157614).  Saving model ...
Epoch: 9 cost time: 1.5721266269683838
Epoch: 9, Steps: 10 | Train Loss: 1.772 Vali Loss: 3.374 Vali Acc: 0.140 Test Loss: 3.374 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4163196086883545
Epoch: 10, Steps: 10 | Train Loss: 1.567 Vali Loss: 3.347 Vali Acc: 0.175 Test Loss: 3.347 Test Acc: 0.175
Validation loss decreased (-0.157614 --> -0.175261).  Saving model ...
Epoch: 11 cost time: 1.2462365627288818
Epoch: 11, Steps: 10 | Train Loss: 1.382 Vali Loss: 3.438 Vali Acc: 0.192 Test Loss: 3.438 Test Acc: 0.192
Validation loss decreased (-0.175261 --> -0.191730).  Saving model ...
Epoch: 12 cost time: 1.4210000038146973
Epoch: 12, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.489 Vali Acc: 0.188 Test Loss: 3.489 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6974053382873535
Epoch: 13, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.527 Vali Acc: 0.222 Test Loss: 3.527 Test Acc: 0.222
Validation loss decreased (-0.191730 --> -0.222318).  Saving model ...
Epoch: 14 cost time: 1.5249524116516113
Epoch: 14, Steps: 10 | Train Loss: 0.654 Vali Loss: 3.645 Vali Acc: 0.195 Test Loss: 3.645 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4371497631072998
Epoch: 15, Steps: 10 | Train Loss: 0.594 Vali Loss: 3.909 Vali Acc: 0.191 Test Loss: 3.909 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.445789098739624
Epoch: 16, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.845 Vali Acc: 0.206 Test Loss: 3.845 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6118898391723633
Epoch: 17, Steps: 10 | Train Loss: 0.281 Vali Loss: 4.043 Vali Acc: 0.185 Test Loss: 4.043 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7736997604370117
Epoch: 18, Steps: 10 | Train Loss: 0.222 Vali Loss: 4.064 Vali Acc: 0.224 Test Loss: 4.064 Test Acc: 0.224
Validation loss decreased (-0.222318 --> -0.223489).  Saving model ...
Epoch: 19 cost time: 1.668276309967041
Epoch: 19, Steps: 10 | Train Loss: 0.167 Vali Loss: 4.197 Vali Acc: 0.221 Test Loss: 4.197 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.681445837020874
Epoch: 20, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.099 Vali Acc: 0.235 Test Loss: 4.099 Test Acc: 0.235
Validation loss decreased (-0.223489 --> -0.235253).  Saving model ...
Epoch: 21 cost time: 1.6291723251342773
Epoch: 21, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.219 Vali Acc: 0.233 Test Loss: 4.219 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8361108303070068
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.280 Vali Acc: 0.246 Test Loss: 4.280 Test Acc: 0.246
Validation loss decreased (-0.235253 --> -0.245840).  Saving model ...
Epoch: 23 cost time: 1.591367483139038
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.322 Vali Acc: 0.245 Test Loss: 4.322 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4264955520629883
Epoch: 24, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.305 Vali Acc: 0.256 Test Loss: 4.305 Test Acc: 0.256
Validation loss decreased (-0.245840 --> -0.256428).  Saving model ...
Epoch: 25 cost time: 1.5601887702941895
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.368 Vali Acc: 0.259 Test Loss: 4.368 Test Acc: 0.259
Validation loss decreased (-0.256428 --> -0.258780).  Saving model ...
Epoch: 26 cost time: 1.4626283645629883
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.324 Vali Acc: 0.259 Test Loss: 4.324 Test Acc: 0.259
Validation loss decreased (-0.258780 --> -0.258780).  Saving model ...
Epoch: 27 cost time: 1.4347152709960938
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.340 Vali Acc: 0.267 Test Loss: 4.340 Test Acc: 0.267
Validation loss decreased (-0.258780 --> -0.267015).  Saving model ...
Epoch: 28 cost time: 1.3806092739105225
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.387 Vali Acc: 0.269 Test Loss: 4.387 Test Acc: 0.269
Validation loss decreased (-0.267015 --> -0.269368).  Saving model ...
Epoch: 29 cost time: 1.9725737571716309
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.425 Vali Acc: 0.269 Test Loss: 4.425 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6743552684783936
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.414 Vali Acc: 0.269 Test Loss: 4.414 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7789311408996582
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.417 Vali Acc: 0.259 Test Loss: 4.417 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.8154337406158447
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.443 Vali Acc: 0.262 Test Loss: 4.443 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.54243803024292
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.468 Vali Acc: 0.267 Test Loss: 4.468 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.4656250476837158
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.468 Vali Acc: 0.266 Test Loss: 4.468 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.716780662536621
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.471 Vali Acc: 0.271 Test Loss: 4.471 Test Acc: 0.271
Validation loss decreased (-0.269368 --> -0.270544).  Saving model ...
Epoch: 36 cost time: 1.7449431419372559
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.485 Vali Acc: 0.266 Test Loss: 4.485 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5055387020111084
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.497 Vali Acc: 0.267 Test Loss: 4.497 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5683388710021973
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.514 Vali Acc: 0.265 Test Loss: 4.514 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5843744277954102
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.522 Vali Acc: 0.266 Test Loss: 4.522 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.5582406520843506
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.535 Vali Acc: 0.268 Test Loss: 4.535 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.335416555404663
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.553 Vali Acc: 0.262 Test Loss: 4.553 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.528078317642212
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.560 Vali Acc: 0.265 Test Loss: 4.560 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1957006454467773
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.567 Vali Acc: 0.265 Test Loss: 4.567 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.8492050170898438
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.571 Vali Acc: 0.265 Test Loss: 4.571 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.6581885814666748
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.578 Vali Acc: 0.266 Test Loss: 4.578 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 7982282
model size : 35.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.72776198387146
Epoch: 1, Steps: 10 | Train Loss: 3.430 Vali Loss: 3.324 Vali Acc: 0.035 Test Loss: 3.324 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 1.4771125316619873
Epoch: 2, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.426 Vali Acc: 0.082 Test Loss: 3.426 Test Acc: 0.082
Validation loss decreased (-0.035261 --> -0.082319).  Saving model ...
Epoch: 3 cost time: 1.4337453842163086
Epoch: 3, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.343 Vali Acc: 0.079 Test Loss: 3.343 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.500669240951538
Epoch: 4, Steps: 10 | Train Loss: 2.986 Vali Loss: 3.338 Vali Acc: 0.044 Test Loss: 3.338 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3502960205078125
Epoch: 5, Steps: 10 | Train Loss: 2.828 Vali Loss: 3.286 Vali Acc: 0.122 Test Loss: 3.286 Test Acc: 0.122
Validation loss decreased (-0.082319 --> -0.122320).  Saving model ...
Epoch: 6 cost time: 1.5672669410705566
Epoch: 6, Steps: 10 | Train Loss: 2.587 Vali Loss: 3.257 Vali Acc: 0.119 Test Loss: 3.257 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8771460056304932
Epoch: 7, Steps: 10 | Train Loss: 2.359 Vali Loss: 3.305 Vali Acc: 0.120 Test Loss: 3.305 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5268354415893555
Epoch: 8, Steps: 10 | Train Loss: 2.074 Vali Loss: 3.286 Vali Acc: 0.152 Test Loss: 3.286 Test Acc: 0.152
Validation loss decreased (-0.122320 --> -0.151732).  Saving model ...
Epoch: 9 cost time: 1.3942618370056152
Epoch: 9, Steps: 10 | Train Loss: 1.728 Vali Loss: 3.296 Vali Acc: 0.171 Test Loss: 3.296 Test Acc: 0.171
Validation loss decreased (-0.151732 --> -0.170555).  Saving model ...
Epoch: 10 cost time: 1.4463648796081543
Epoch: 10, Steps: 10 | Train Loss: 1.556 Vali Loss: 3.388 Vali Acc: 0.186 Test Loss: 3.388 Test Acc: 0.186
Validation loss decreased (-0.170555 --> -0.185848).  Saving model ...
Epoch: 11 cost time: 1.3432199954986572
Epoch: 11, Steps: 10 | Train Loss: 1.258 Vali Loss: 3.409 Vali Acc: 0.173 Test Loss: 3.409 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3332312107086182
Epoch: 12, Steps: 10 | Train Loss: 1.068 Vali Loss: 3.361 Vali Acc: 0.221 Test Loss: 3.361 Test Acc: 0.221
Validation loss decreased (-0.185848 --> -0.221143).  Saving model ...
Epoch: 13 cost time: 1.4146413803100586
Epoch: 13, Steps: 10 | Train Loss: 0.880 Vali Loss: 3.508 Vali Acc: 0.211 Test Loss: 3.508 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4967396259307861
Epoch: 14, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.555 Vali Acc: 0.198 Test Loss: 3.555 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4831633567810059
Epoch: 15, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.816 Vali Acc: 0.182 Test Loss: 3.816 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5768146514892578
Epoch: 16, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.836 Vali Acc: 0.204 Test Loss: 3.836 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3843886852264404
Epoch: 17, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.789 Vali Acc: 0.231 Test Loss: 3.789 Test Acc: 0.231
Validation loss decreased (-0.221143 --> -0.230550).  Saving model ...
Epoch: 18 cost time: 1.596083402633667
Epoch: 18, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.762 Vali Acc: 0.267 Test Loss: 3.762 Test Acc: 0.267
Validation loss decreased (-0.230550 --> -0.267021).  Saving model ...
Epoch: 19 cost time: 1.2808520793914795
Epoch: 19, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.096 Vali Acc: 0.238 Test Loss: 4.096 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6041555404663086
Epoch: 20, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.139 Vali Acc: 0.246 Test Loss: 4.139 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4382617473602295
Epoch: 21, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.321 Vali Acc: 0.234 Test Loss: 4.321 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.427786111831665
Epoch: 22, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.317 Vali Acc: 0.227 Test Loss: 4.317 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4764773845672607
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.660 Vali Acc: 0.208 Test Loss: 4.660 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6215898990631104
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.519 Vali Acc: 0.220 Test Loss: 4.519 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.429020643234253
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.648 Vali Acc: 0.258 Test Loss: 4.648 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.478499412536621
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.564 Vali Acc: 0.255 Test Loss: 4.564 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5072059631347656
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.513 Vali Acc: 0.265 Test Loss: 4.513 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5143680572509766
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.647 Vali Acc: 0.265 Test Loss: 4.647 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 7976138
model size : 35.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.358849287033081
Epoch: 1, Steps: 10 | Train Loss: 3.448 Vali Loss: 3.348 Vali Acc: 0.042 Test Loss: 3.348 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 1.5816221237182617
Epoch: 2, Steps: 10 | Train Loss: 3.402 Vali Loss: 3.455 Vali Acc: 0.044 Test Loss: 3.455 Test Acc: 0.044
Validation loss decreased (-0.042319 --> -0.043495).  Saving model ...
Epoch: 3 cost time: 1.3673880100250244
Epoch: 3, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.357 Vali Acc: 0.058 Test Loss: 3.357 Test Acc: 0.058
Validation loss decreased (-0.043495 --> -0.057613).  Saving model ...
Epoch: 4 cost time: 1.376314401626587
Epoch: 4, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.347 Vali Acc: 0.065 Test Loss: 3.347 Test Acc: 0.065
Validation loss decreased (-0.057613 --> -0.064672).  Saving model ...
Epoch: 5 cost time: 1.5636358261108398
Epoch: 5, Steps: 10 | Train Loss: 2.883 Vali Loss: 3.242 Vali Acc: 0.121 Test Loss: 3.242 Test Acc: 0.121
Validation loss decreased (-0.064672 --> -0.121144).  Saving model ...
Epoch: 6 cost time: 1.449373722076416
Epoch: 6, Steps: 10 | Train Loss: 2.667 Vali Loss: 3.320 Vali Acc: 0.100 Test Loss: 3.320 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3289804458618164
Epoch: 7, Steps: 10 | Train Loss: 2.391 Vali Loss: 3.259 Vali Acc: 0.142 Test Loss: 3.259 Test Acc: 0.142
Validation loss decreased (-0.121144 --> -0.142320).  Saving model ...
Epoch: 8 cost time: 1.1729662418365479
Epoch: 8, Steps: 10 | Train Loss: 2.201 Vali Loss: 3.307 Vali Acc: 0.151 Test Loss: 3.307 Test Acc: 0.151
Validation loss decreased (-0.142320 --> -0.150555).  Saving model ...
Epoch: 9 cost time: 1.7032339572906494
Epoch: 9, Steps: 10 | Train Loss: 1.928 Vali Loss: 3.325 Vali Acc: 0.164 Test Loss: 3.325 Test Acc: 0.164
Validation loss decreased (-0.150555 --> -0.163496).  Saving model ...
Epoch: 10 cost time: 1.445840835571289
Epoch: 10, Steps: 10 | Train Loss: 1.710 Vali Loss: 3.315 Vali Acc: 0.180 Test Loss: 3.315 Test Acc: 0.180
Validation loss decreased (-0.163496 --> -0.179967).  Saving model ...
Epoch: 11 cost time: 1.4120402336120605
Epoch: 11, Steps: 10 | Train Loss: 1.315 Vali Loss: 3.459 Vali Acc: 0.185 Test Loss: 3.459 Test Acc: 0.185
Validation loss decreased (-0.179967 --> -0.184671).  Saving model ...
Epoch: 12 cost time: 1.3937468528747559
Epoch: 12, Steps: 10 | Train Loss: 1.142 Vali Loss: 3.431 Vali Acc: 0.208 Test Loss: 3.431 Test Acc: 0.208
Validation loss decreased (-0.184671 --> -0.208201).  Saving model ...
Epoch: 13 cost time: 1.394606590270996
Epoch: 13, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.457 Vali Acc: 0.204 Test Loss: 3.457 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3107409477233887
Epoch: 14, Steps: 10 | Train Loss: 0.689 Vali Loss: 3.584 Vali Acc: 0.207 Test Loss: 3.584 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.351729393005371
Epoch: 15, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.610 Vali Acc: 0.220 Test Loss: 3.610 Test Acc: 0.220
Validation loss decreased (-0.208201 --> -0.219964).  Saving model ...
Epoch: 16 cost time: 1.4048879146575928
Epoch: 16, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.746 Vali Acc: 0.226 Test Loss: 3.746 Test Acc: 0.226
Validation loss decreased (-0.219964 --> -0.225845).  Saving model ...
Epoch: 17 cost time: 1.7712340354919434
Epoch: 17, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.971 Vali Acc: 0.222 Test Loss: 3.971 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.644425868988037
Epoch: 18, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.950 Vali Acc: 0.241 Test Loss: 3.950 Test Acc: 0.241
Validation loss decreased (-0.225845 --> -0.241137).  Saving model ...
Epoch: 19 cost time: 1.5046706199645996
Epoch: 19, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.040 Vali Acc: 0.246 Test Loss: 4.040 Test Acc: 0.246
Validation loss decreased (-0.241137 --> -0.245842).  Saving model ...
Epoch: 20 cost time: 1.3352563381195068
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.203 Vali Acc: 0.236 Test Loss: 4.203 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4703068733215332
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.182 Vali Acc: 0.249 Test Loss: 4.182 Test Acc: 0.249
Validation loss decreased (-0.245842 --> -0.249370).  Saving model ...
Epoch: 22 cost time: 1.3917546272277832
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.379 Vali Acc: 0.255 Test Loss: 4.379 Test Acc: 0.255
Validation loss decreased (-0.249370 --> -0.255250).  Saving model ...
Epoch: 23 cost time: 1.3119394779205322
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.369 Vali Acc: 0.262 Test Loss: 4.369 Test Acc: 0.262
Validation loss decreased (-0.255250 --> -0.262309).  Saving model ...
Epoch: 24 cost time: 1.2250347137451172
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.356 Vali Acc: 0.253 Test Loss: 4.356 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2638542652130127
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.380 Vali Acc: 0.272 Test Loss: 4.380 Test Acc: 0.272
Validation loss decreased (-0.262309 --> -0.271721).  Saving model ...
Epoch: 26 cost time: 1.4595444202423096
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.391 Vali Acc: 0.278 Test Loss: 4.391 Test Acc: 0.278
Validation loss decreased (-0.271721 --> -0.277603).  Saving model ...
Epoch: 27 cost time: 1.4448637962341309
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.409 Vali Acc: 0.280 Test Loss: 4.409 Test Acc: 0.280
Validation loss decreased (-0.277603 --> -0.279956).  Saving model ...
Epoch: 28 cost time: 1.275963306427002
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.428 Vali Acc: 0.278 Test Loss: 4.428 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7733137607574463
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.448 Vali Acc: 0.278 Test Loss: 4.448 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4988114833831787
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.463 Vali Acc: 0.278 Test Loss: 4.463 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.402165412902832
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.478 Vali Acc: 0.276 Test Loss: 4.478 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.802177906036377
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.472 Vali Acc: 0.278 Test Loss: 4.472 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5707719326019287
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.487 Vali Acc: 0.278 Test Loss: 4.487 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6194708347320557
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.495 Vali Acc: 0.276 Test Loss: 4.495 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.417405366897583
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.511 Vali Acc: 0.273 Test Loss: 4.511 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.5208501815795898
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.524 Vali Acc: 0.276 Test Loss: 4.524 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.466919183731079
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.538 Vali Acc: 0.276 Test Loss: 4.538 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 7969994
model size : 35.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.168281555175781
Epoch: 1, Steps: 10 | Train Loss: 3.471 Vali Loss: 3.343 Vali Acc: 0.040 Test Loss: 3.343 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.5954313278198242
Epoch: 2, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.462 Vali Acc: 0.039 Test Loss: 3.462 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7618968486785889
Epoch: 3, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.338 Vali Acc: 0.069 Test Loss: 3.338 Test Acc: 0.069
Validation loss decreased (-0.039967 --> -0.069378).  Saving model ...
Epoch: 4 cost time: 1.6861836910247803
Epoch: 4, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.328 Vali Acc: 0.065 Test Loss: 3.328 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3433771133422852
Epoch: 5, Steps: 10 | Train Loss: 2.915 Vali Loss: 3.280 Vali Acc: 0.101 Test Loss: 3.280 Test Acc: 0.101
Validation loss decreased (-0.069378 --> -0.101144).  Saving model ...
Epoch: 6 cost time: 1.553501844406128
Epoch: 6, Steps: 10 | Train Loss: 2.576 Vali Loss: 3.304 Vali Acc: 0.108 Test Loss: 3.304 Test Acc: 0.108
Validation loss decreased (-0.101144 --> -0.108202).  Saving model ...
Epoch: 7 cost time: 1.920987606048584
Epoch: 7, Steps: 10 | Train Loss: 2.331 Vali Loss: 3.283 Vali Acc: 0.125 Test Loss: 3.283 Test Acc: 0.125
Validation loss decreased (-0.108202 --> -0.124673).  Saving model ...
Epoch: 8 cost time: 1.4737513065338135
Epoch: 8, Steps: 10 | Train Loss: 2.186 Vali Loss: 3.373 Vali Acc: 0.145 Test Loss: 3.373 Test Acc: 0.145
Validation loss decreased (-0.124673 --> -0.144672).  Saving model ...
Epoch: 9 cost time: 1.6656913757324219
Epoch: 9, Steps: 10 | Train Loss: 1.878 Vali Loss: 3.322 Vali Acc: 0.145 Test Loss: 3.322 Test Acc: 0.145
Validation loss decreased (-0.144672 --> -0.144673).  Saving model ...
Epoch: 10 cost time: 1.6787409782409668
Epoch: 10, Steps: 10 | Train Loss: 1.564 Vali Loss: 3.391 Vali Acc: 0.171 Test Loss: 3.391 Test Acc: 0.171
Validation loss decreased (-0.144673 --> -0.170554).  Saving model ...
Epoch: 11 cost time: 1.8766686916351318
Epoch: 11, Steps: 10 | Train Loss: 1.294 Vali Loss: 3.333 Vali Acc: 0.196 Test Loss: 3.333 Test Acc: 0.196
Validation loss decreased (-0.170554 --> -0.196437).  Saving model ...
Epoch: 12 cost time: 1.6293017864227295
Epoch: 12, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.390 Vali Acc: 0.208 Test Loss: 3.390 Test Acc: 0.208
Validation loss decreased (-0.196437 --> -0.208201).  Saving model ...
Epoch: 13 cost time: 1.757732629776001
Epoch: 13, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.503 Vali Acc: 0.200 Test Loss: 3.503 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6521506309509277
Epoch: 14, Steps: 10 | Train Loss: 0.683 Vali Loss: 3.538 Vali Acc: 0.201 Test Loss: 3.538 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.380500078201294
Epoch: 15, Steps: 10 | Train Loss: 0.517 Vali Loss: 3.823 Vali Acc: 0.186 Test Loss: 3.823 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7710235118865967
Epoch: 16, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.801 Vali Acc: 0.220 Test Loss: 3.801 Test Acc: 0.220
Validation loss decreased (-0.208201 --> -0.219962).  Saving model ...
Epoch: 17 cost time: 1.569326639175415
Epoch: 17, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.752 Vali Acc: 0.251 Test Loss: 3.752 Test Acc: 0.251
Validation loss decreased (-0.219962 --> -0.250551).  Saving model ...
Epoch: 18 cost time: 1.5887091159820557
Epoch: 18, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.999 Vali Acc: 0.242 Test Loss: 3.999 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6903982162475586
Epoch: 19, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.017 Vali Acc: 0.235 Test Loss: 4.017 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8626227378845215
Epoch: 20, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.028 Vali Acc: 0.245 Test Loss: 4.028 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7766640186309814
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.238 Vali Acc: 0.232 Test Loss: 4.238 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7935254573822021
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.192 Vali Acc: 0.255 Test Loss: 4.192 Test Acc: 0.255
Validation loss decreased (-0.250551 --> -0.255252).  Saving model ...
Epoch: 23 cost time: 1.7032506465911865
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.192 Vali Acc: 0.254 Test Loss: 4.192 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7778103351593018
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.235 Vali Acc: 0.254 Test Loss: 4.235 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5065248012542725
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.248 Vali Acc: 0.273 Test Loss: 4.248 Test Acc: 0.273
Validation loss decreased (-0.255252 --> -0.272899).  Saving model ...
Epoch: 26 cost time: 1.84837007522583
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.276 Vali Acc: 0.276 Test Loss: 4.276 Test Acc: 0.276
Validation loss decreased (-0.272899 --> -0.276428).  Saving model ...
Epoch: 27 cost time: 1.396371603012085
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.301 Vali Acc: 0.272 Test Loss: 4.301 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6852457523345947
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.295 Vali Acc: 0.276 Test Loss: 4.295 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.540210485458374
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.299 Vali Acc: 0.276 Test Loss: 4.299 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8271379470825195
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.327 Vali Acc: 0.282 Test Loss: 4.327 Test Acc: 0.282
Validation loss decreased (-0.276428 --> -0.282310).  Saving model ...
Epoch: 31 cost time: 1.4900164604187012
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.357 Vali Acc: 0.280 Test Loss: 4.357 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5978095531463623
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.367 Vali Acc: 0.278 Test Loss: 4.367 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.470400094985962
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.367 Vali Acc: 0.279 Test Loss: 4.367 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3649089336395264
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.379 Vali Acc: 0.278 Test Loss: 4.379 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5322256088256836
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.397 Vali Acc: 0.279 Test Loss: 4.397 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6151337623596191
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.411 Vali Acc: 0.276 Test Loss: 4.411 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5716309547424316
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.424 Vali Acc: 0.274 Test Loss: 4.424 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.6636199951171875
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.444 Vali Acc: 0.280 Test Loss: 4.444 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.9674115180969238
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.462 Vali Acc: 0.272 Test Loss: 4.462 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.9452812671661377
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.478 Vali Acc: 0.275 Test Loss: 4.478 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 7963850
model size : 35.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3660781383514404
Epoch: 1, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.335 Vali Acc: 0.039 Test Loss: 3.335 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.3988745212554932
Epoch: 2, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.376 Vali Acc: 0.046 Test Loss: 3.376 Test Acc: 0.046
Validation loss decreased (-0.038790 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 1.549612283706665
Epoch: 3, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.352 Vali Acc: 0.072 Test Loss: 3.352 Test Acc: 0.072
Validation loss decreased (-0.045849 --> -0.071731).  Saving model ...
Epoch: 4 cost time: 1.6469202041625977
Epoch: 4, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.325 Vali Acc: 0.056 Test Loss: 3.325 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4503264427185059
Epoch: 5, Steps: 10 | Train Loss: 3.019 Vali Loss: 3.309 Vali Acc: 0.092 Test Loss: 3.309 Test Acc: 0.092
Validation loss decreased (-0.071731 --> -0.091732).  Saving model ...
Epoch: 6 cost time: 1.4108014106750488
Epoch: 6, Steps: 10 | Train Loss: 2.841 Vali Loss: 3.296 Vali Acc: 0.099 Test Loss: 3.296 Test Acc: 0.099
Validation loss decreased (-0.091732 --> -0.098791).  Saving model ...
Epoch: 7 cost time: 1.2294402122497559
Epoch: 7, Steps: 10 | Train Loss: 2.603 Vali Loss: 3.261 Vali Acc: 0.113 Test Loss: 3.261 Test Acc: 0.113
Validation loss decreased (-0.098791 --> -0.112909).  Saving model ...
Epoch: 8 cost time: 1.4247629642486572
Epoch: 8, Steps: 10 | Train Loss: 2.464 Vali Loss: 3.299 Vali Acc: 0.132 Test Loss: 3.299 Test Acc: 0.132
Validation loss decreased (-0.112909 --> -0.131732).  Saving model ...
Epoch: 9 cost time: 1.5684175491333008
Epoch: 9, Steps: 10 | Train Loss: 2.231 Vali Loss: 3.255 Vali Acc: 0.152 Test Loss: 3.255 Test Acc: 0.152
Validation loss decreased (-0.131732 --> -0.151732).  Saving model ...
Epoch: 10 cost time: 1.2240419387817383
Epoch: 10, Steps: 10 | Train Loss: 2.041 Vali Loss: 3.292 Vali Acc: 0.153 Test Loss: 3.292 Test Acc: 0.153
Validation loss decreased (-0.151732 --> -0.152908).  Saving model ...
Epoch: 11 cost time: 1.3635473251342773
Epoch: 11, Steps: 10 | Train Loss: 1.860 Vali Loss: 3.220 Vali Acc: 0.171 Test Loss: 3.220 Test Acc: 0.171
Validation loss decreased (-0.152908 --> -0.170556).  Saving model ...
Epoch: 12 cost time: 1.2195932865142822
Epoch: 12, Steps: 10 | Train Loss: 1.634 Vali Loss: 3.289 Vali Acc: 0.185 Test Loss: 3.289 Test Acc: 0.185
Validation loss decreased (-0.170556 --> -0.184673).  Saving model ...
Epoch: 13 cost time: 1.3440399169921875
Epoch: 13, Steps: 10 | Train Loss: 1.495 Vali Loss: 3.296 Vali Acc: 0.167 Test Loss: 3.296 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3319745063781738
Epoch: 14, Steps: 10 | Train Loss: 1.357 Vali Loss: 3.306 Vali Acc: 0.185 Test Loss: 3.306 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5145163536071777
Epoch: 15, Steps: 10 | Train Loss: 1.150 Vali Loss: 3.311 Vali Acc: 0.176 Test Loss: 3.311 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4033119678497314
Epoch: 16, Steps: 10 | Train Loss: 0.913 Vali Loss: 3.271 Vali Acc: 0.207 Test Loss: 3.271 Test Acc: 0.207
Validation loss decreased (-0.184673 --> -0.207026).  Saving model ...
Epoch: 17 cost time: 1.5829658508300781
Epoch: 17, Steps: 10 | Train Loss: 0.787 Vali Loss: 3.321 Vali Acc: 0.221 Test Loss: 3.321 Test Acc: 0.221
Validation loss decreased (-0.207026 --> -0.221143).  Saving model ...
Epoch: 18 cost time: 1.6344537734985352
Epoch: 18, Steps: 10 | Train Loss: 0.679 Vali Loss: 3.343 Vali Acc: 0.200 Test Loss: 3.343 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.554396152496338
Epoch: 19, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.465 Vali Acc: 0.198 Test Loss: 3.465 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3689475059509277
Epoch: 20, Steps: 10 | Train Loss: 0.463 Vali Loss: 3.460 Vali Acc: 0.220 Test Loss: 3.460 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6102488040924072
Epoch: 21, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.462 Vali Acc: 0.208 Test Loss: 3.462 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7328386306762695
Epoch: 22, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.494 Vali Acc: 0.235 Test Loss: 3.494 Test Acc: 0.235
Validation loss decreased (-0.221143 --> -0.235259).  Saving model ...
Epoch: 23 cost time: 1.583158254623413
Epoch: 23, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.616 Vali Acc: 0.224 Test Loss: 3.616 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4330039024353027
Epoch: 24, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.644 Vali Acc: 0.234 Test Loss: 3.644 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6348001956939697
Epoch: 25, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.688 Vali Acc: 0.235 Test Loss: 3.688 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3737409114837646
Epoch: 26, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.653 Vali Acc: 0.253 Test Loss: 3.653 Test Acc: 0.253
Validation loss decreased (-0.235259 --> -0.252905).  Saving model ...
Epoch: 27 cost time: 1.3334922790527344
Epoch: 27, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.793 Vali Acc: 0.219 Test Loss: 3.793 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2959208488464355
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.773 Vali Acc: 0.239 Test Loss: 3.773 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6668660640716553
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.789 Vali Acc: 0.251 Test Loss: 3.789 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2015855312347412
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.755 Vali Acc: 0.265 Test Loss: 3.755 Test Acc: 0.265
Validation loss decreased (-0.252905 --> -0.264668).  Saving model ...
Epoch: 31 cost time: 1.502457618713379
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.767 Vali Acc: 0.268 Test Loss: 3.767 Test Acc: 0.268
Validation loss decreased (-0.264668 --> -0.268198).  Saving model ...
Epoch: 32 cost time: 1.4963421821594238
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.835 Vali Acc: 0.268 Test Loss: 3.835 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4209585189819336
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.848 Vali Acc: 0.261 Test Loss: 3.848 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.328115701675415
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.851 Vali Acc: 0.260 Test Loss: 3.851 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.52764892578125
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.848 Vali Acc: 0.273 Test Loss: 3.848 Test Acc: 0.273
Validation loss decreased (-0.268198 --> -0.272903).  Saving model ...
Epoch: 36 cost time: 1.5684008598327637
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.873 Vali Acc: 0.268 Test Loss: 3.873 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2607183456420898
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.930 Vali Acc: 0.255 Test Loss: 3.930 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5208613872528076
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.916 Vali Acc: 0.258 Test Loss: 3.916 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.3622756004333496
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.922 Vali Acc: 0.261 Test Loss: 3.922 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3310890197753906
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.961 Vali Acc: 0.264 Test Loss: 3.961 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2578933238983154
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.945 Vali Acc: 0.272 Test Loss: 3.945 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.706789493560791
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.969 Vali Acc: 0.264 Test Loss: 3.969 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.52406907081604
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.980 Vali Acc: 0.267 Test Loss: 3.980 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.494441032409668
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.980 Vali Acc: 0.262 Test Loss: 3.980 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.3425731658935547
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.004 Vali Acc: 0.272 Test Loss: 4.004 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 3768522
model size : 16.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1448075771331787
Epoch: 1, Steps: 10 | Train Loss: 3.471 Vali Loss: 3.303 Vali Acc: 0.054 Test Loss: 3.303 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 1.4714078903198242
Epoch: 2, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.444 Vali Acc: 0.033 Test Loss: 3.444 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3427081108093262
Epoch: 3, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.402 Vali Acc: 0.058 Test Loss: 3.402 Test Acc: 0.058
Validation loss decreased (-0.054085 --> -0.057613).  Saving model ...
Epoch: 4 cost time: 1.546379566192627
Epoch: 4, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.330 Vali Acc: 0.073 Test Loss: 3.330 Test Acc: 0.073
Validation loss decreased (-0.057613 --> -0.072908).  Saving model ...
Epoch: 5 cost time: 1.7694599628448486
Epoch: 5, Steps: 10 | Train Loss: 2.948 Vali Loss: 3.287 Vali Acc: 0.044 Test Loss: 3.287 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4532339572906494
Epoch: 6, Steps: 10 | Train Loss: 2.806 Vali Loss: 3.250 Vali Acc: 0.107 Test Loss: 3.250 Test Acc: 0.107
Validation loss decreased (-0.072908 --> -0.107026).  Saving model ...
Epoch: 7 cost time: 1.3940296173095703
Epoch: 7, Steps: 10 | Train Loss: 2.620 Vali Loss: 3.249 Vali Acc: 0.125 Test Loss: 3.249 Test Acc: 0.125
Validation loss decreased (-0.107026 --> -0.124673).  Saving model ...
Epoch: 8 cost time: 1.5527927875518799
Epoch: 8, Steps: 10 | Train Loss: 2.485 Vali Loss: 3.268 Vali Acc: 0.128 Test Loss: 3.268 Test Acc: 0.128
Validation loss decreased (-0.124673 --> -0.128203).  Saving model ...
Epoch: 9 cost time: 1.4699780941009521
Epoch: 9, Steps: 10 | Train Loss: 2.288 Vali Loss: 3.250 Vali Acc: 0.133 Test Loss: 3.250 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 10 cost time: 1.5940546989440918
Epoch: 10, Steps: 10 | Train Loss: 2.047 Vali Loss: 3.218 Vali Acc: 0.184 Test Loss: 3.218 Test Acc: 0.184
Validation loss decreased (-0.132909 --> -0.183497).  Saving model ...
Epoch: 11 cost time: 1.3363215923309326
Epoch: 11, Steps: 10 | Train Loss: 1.838 Vali Loss: 3.257 Vali Acc: 0.155 Test Loss: 3.257 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5297980308532715
Epoch: 12, Steps: 10 | Train Loss: 1.645 Vali Loss: 3.226 Vali Acc: 0.186 Test Loss: 3.226 Test Acc: 0.186
Validation loss decreased (-0.183497 --> -0.185850).  Saving model ...
Epoch: 13 cost time: 1.6608455181121826
Epoch: 13, Steps: 10 | Train Loss: 1.363 Vali Loss: 3.300 Vali Acc: 0.176 Test Loss: 3.300 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3765265941619873
Epoch: 14, Steps: 10 | Train Loss: 1.304 Vali Loss: 3.255 Vali Acc: 0.205 Test Loss: 3.255 Test Acc: 0.205
Validation loss decreased (-0.185850 --> -0.204673).  Saving model ...
Epoch: 15 cost time: 1.6485271453857422
Epoch: 15, Steps: 10 | Train Loss: 1.087 Vali Loss: 3.395 Vali Acc: 0.200 Test Loss: 3.395 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3905103206634521
Epoch: 16, Steps: 10 | Train Loss: 0.933 Vali Loss: 3.258 Vali Acc: 0.200 Test Loss: 3.258 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.467188835144043
Epoch: 17, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.380 Vali Acc: 0.209 Test Loss: 3.380 Test Acc: 0.209
Validation loss decreased (-0.204673 --> -0.209378).  Saving model ...
Epoch: 18 cost time: 1.3149752616882324
Epoch: 18, Steps: 10 | Train Loss: 0.667 Vali Loss: 3.519 Vali Acc: 0.204 Test Loss: 3.519 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5179316997528076
Epoch: 19, Steps: 10 | Train Loss: 0.500 Vali Loss: 3.423 Vali Acc: 0.204 Test Loss: 3.423 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3842017650604248
Epoch: 20, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.493 Vali Acc: 0.212 Test Loss: 3.493 Test Acc: 0.212
Validation loss decreased (-0.209378 --> -0.211730).  Saving model ...
Epoch: 21 cost time: 1.4675877094268799
Epoch: 21, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.610 Vali Acc: 0.234 Test Loss: 3.610 Test Acc: 0.234
Validation loss decreased (-0.211730 --> -0.234082).  Saving model ...
Epoch: 22 cost time: 1.5739762783050537
Epoch: 22, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.523 Vali Acc: 0.228 Test Loss: 3.523 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4937479496002197
Epoch: 23, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.681 Vali Acc: 0.228 Test Loss: 3.681 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4475078582763672
Epoch: 24, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.697 Vali Acc: 0.227 Test Loss: 3.697 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3892755508422852
Epoch: 25, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.759 Vali Acc: 0.239 Test Loss: 3.759 Test Acc: 0.239
Validation loss decreased (-0.234082 --> -0.238786).  Saving model ...
Epoch: 26 cost time: 1.2989368438720703
Epoch: 26, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.761 Vali Acc: 0.235 Test Loss: 3.761 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4764442443847656
Epoch: 27, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.820 Vali Acc: 0.242 Test Loss: 3.820 Test Acc: 0.242
Validation loss decreased (-0.238786 --> -0.242315).  Saving model ...
Epoch: 28 cost time: 1.426496982574463
Epoch: 28, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.783 Vali Acc: 0.265 Test Loss: 3.783 Test Acc: 0.265
Validation loss decreased (-0.242315 --> -0.264668).  Saving model ...
Epoch: 29 cost time: 1.392256498336792
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.808 Vali Acc: 0.249 Test Loss: 3.808 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3089938163757324
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.913 Vali Acc: 0.238 Test Loss: 3.913 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.428025245666504
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.883 Vali Acc: 0.245 Test Loss: 3.883 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.628159523010254
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.895 Vali Acc: 0.247 Test Loss: 3.895 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3058335781097412
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.932 Vali Acc: 0.254 Test Loss: 3.932 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.4809327125549316
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.941 Vali Acc: 0.256 Test Loss: 3.941 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.320662021636963
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.931 Vali Acc: 0.255 Test Loss: 3.931 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.6528832912445068
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.962 Vali Acc: 0.256 Test Loss: 3.962 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.286299467086792
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.992 Vali Acc: 0.256 Test Loss: 3.992 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.33201265335083
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.987 Vali Acc: 0.254 Test Loss: 3.987 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 3765450
model size : 16.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.873168706893921
Epoch: 1, Steps: 10 | Train Loss: 3.453 Vali Loss: 3.331 Vali Acc: 0.034 Test Loss: 3.331 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 1.3826119899749756
Epoch: 2, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.379 Vali Acc: 0.042 Test Loss: 3.379 Test Acc: 0.042
Validation loss decreased (-0.034084 --> -0.042319).  Saving model ...
Epoch: 3 cost time: 1.8231122493743896
Epoch: 3, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.361 Vali Acc: 0.053 Test Loss: 3.361 Test Acc: 0.053
Validation loss decreased (-0.042319 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 1.2605228424072266
Epoch: 4, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.313 Vali Acc: 0.062 Test Loss: 3.313 Test Acc: 0.062
Validation loss decreased (-0.052908 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 1.258584976196289
Epoch: 5, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.330 Vali Acc: 0.085 Test Loss: 3.330 Test Acc: 0.085
Validation loss decreased (-0.062320 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 1.442107915878296
Epoch: 6, Steps: 10 | Train Loss: 2.834 Vali Loss: 3.274 Vali Acc: 0.091 Test Loss: 3.274 Test Acc: 0.091
Validation loss decreased (-0.084673 --> -0.090555).  Saving model ...
Epoch: 7 cost time: 1.2217063903808594
Epoch: 7, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.275 Vali Acc: 0.118 Test Loss: 3.275 Test Acc: 0.118
Validation loss decreased (-0.090555 --> -0.117614).  Saving model ...
Epoch: 8 cost time: 1.3686535358428955
Epoch: 8, Steps: 10 | Train Loss: 2.504 Vali Loss: 3.294 Vali Acc: 0.111 Test Loss: 3.294 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5729236602783203
Epoch: 9, Steps: 10 | Train Loss: 2.301 Vali Loss: 3.210 Vali Acc: 0.131 Test Loss: 3.210 Test Acc: 0.131
Validation loss decreased (-0.117614 --> -0.130556).  Saving model ...
Epoch: 10 cost time: 1.2804009914398193
Epoch: 10, Steps: 10 | Train Loss: 2.009 Vali Loss: 3.290 Vali Acc: 0.136 Test Loss: 3.290 Test Acc: 0.136
Validation loss decreased (-0.130556 --> -0.136438).  Saving model ...
Epoch: 11 cost time: 1.4941401481628418
Epoch: 11, Steps: 10 | Train Loss: 1.895 Vali Loss: 3.172 Vali Acc: 0.158 Test Loss: 3.172 Test Acc: 0.158
Validation loss decreased (-0.136438 --> -0.157615).  Saving model ...
Epoch: 12 cost time: 1.4983415603637695
Epoch: 12, Steps: 10 | Train Loss: 1.670 Vali Loss: 3.301 Vali Acc: 0.154 Test Loss: 3.301 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4907987117767334
Epoch: 13, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.263 Vali Acc: 0.168 Test Loss: 3.263 Test Acc: 0.168
Validation loss decreased (-0.157615 --> -0.168203).  Saving model ...
Epoch: 14 cost time: 1.3311951160430908
Epoch: 14, Steps: 10 | Train Loss: 1.278 Vali Loss: 3.253 Vali Acc: 0.176 Test Loss: 3.253 Test Acc: 0.176
Validation loss decreased (-0.168203 --> -0.176438).  Saving model ...
Epoch: 15 cost time: 1.6617310047149658
Epoch: 15, Steps: 10 | Train Loss: 1.151 Vali Loss: 3.251 Vali Acc: 0.200 Test Loss: 3.251 Test Acc: 0.200
Validation loss decreased (-0.176438 --> -0.199967).  Saving model ...
Epoch: 16 cost time: 1.5793092250823975
Epoch: 16, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.269 Vali Acc: 0.193 Test Loss: 3.269 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1867246627807617
Epoch: 17, Steps: 10 | Train Loss: 0.868 Vali Loss: 3.339 Vali Acc: 0.191 Test Loss: 3.339 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2744312286376953
Epoch: 18, Steps: 10 | Train Loss: 0.677 Vali Loss: 3.322 Vali Acc: 0.208 Test Loss: 3.322 Test Acc: 0.208
Validation loss decreased (-0.199967 --> -0.208202).  Saving model ...
Epoch: 19 cost time: 1.22688627243042
Epoch: 19, Steps: 10 | Train Loss: 0.480 Vali Loss: 3.358 Vali Acc: 0.215 Test Loss: 3.358 Test Acc: 0.215
Validation loss decreased (-0.208202 --> -0.215261).  Saving model ...
Epoch: 20 cost time: 1.214012622833252
Epoch: 20, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.384 Vali Acc: 0.226 Test Loss: 3.384 Test Acc: 0.226
Validation loss decreased (-0.215261 --> -0.225849).  Saving model ...
Epoch: 21 cost time: 1.5386898517608643
Epoch: 21, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.598 Vali Acc: 0.194 Test Loss: 3.598 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3595271110534668
Epoch: 22, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.410 Vali Acc: 0.244 Test Loss: 3.410 Test Acc: 0.244
Validation loss decreased (-0.225849 --> -0.243495).  Saving model ...
Epoch: 23 cost time: 1.3735425472259521
Epoch: 23, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.626 Vali Acc: 0.226 Test Loss: 3.626 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3188037872314453
Epoch: 24, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.659 Vali Acc: 0.232 Test Loss: 3.659 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6065621376037598
Epoch: 25, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.647 Vali Acc: 0.238 Test Loss: 3.647 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.291013240814209
Epoch: 26, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.708 Vali Acc: 0.253 Test Loss: 3.708 Test Acc: 0.253
Validation loss decreased (-0.243495 --> -0.252904).  Saving model ...
Epoch: 27 cost time: 1.4054527282714844
Epoch: 27, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.728 Vali Acc: 0.251 Test Loss: 3.728 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.499499797821045
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.668 Vali Acc: 0.253 Test Loss: 3.668 Test Acc: 0.253
Validation loss decreased (-0.252904 --> -0.252904).  Saving model ...
Epoch: 29 cost time: 1.5148546695709229
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.725 Vali Acc: 0.265 Test Loss: 3.725 Test Acc: 0.265
Validation loss decreased (-0.252904 --> -0.264669).  Saving model ...
Epoch: 30 cost time: 1.5801374912261963
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.780 Vali Acc: 0.255 Test Loss: 3.780 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5835659503936768
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.756 Vali Acc: 0.274 Test Loss: 3.756 Test Acc: 0.274
Validation loss decreased (-0.264669 --> -0.274080).  Saving model ...
Epoch: 32 cost time: 1.5112924575805664
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.771 Vali Acc: 0.274 Test Loss: 3.771 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4259822368621826
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.810 Vali Acc: 0.272 Test Loss: 3.810 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4749996662139893
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.825 Vali Acc: 0.276 Test Loss: 3.825 Test Acc: 0.276
Validation loss decreased (-0.274080 --> -0.276432).  Saving model ...
Epoch: 35 cost time: 1.528569221496582
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.827 Vali Acc: 0.276 Test Loss: 3.827 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2794501781463623
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.862 Vali Acc: 0.279 Test Loss: 3.862 Test Acc: 0.279
Validation loss decreased (-0.276432 --> -0.278785).  Saving model ...
Epoch: 37 cost time: 1.278730869293213
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.883 Vali Acc: 0.272 Test Loss: 3.883 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.451646089553833
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.896 Vali Acc: 0.272 Test Loss: 3.896 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.62056303024292
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.888 Vali Acc: 0.274 Test Loss: 3.888 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2985763549804688
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.902 Vali Acc: 0.279 Test Loss: 3.902 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.606335163116455
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.921 Vali Acc: 0.280 Test Loss: 3.921 Test Acc: 0.280
Validation loss decreased (-0.278785 --> -0.279961).  Saving model ...
Epoch: 42 cost time: 1.6199955940246582
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.924 Vali Acc: 0.278 Test Loss: 3.924 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5289525985717773
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.929 Vali Acc: 0.285 Test Loss: 3.929 Test Acc: 0.285
Validation loss decreased (-0.279961 --> -0.284667).  Saving model ...
Epoch: 44 cost time: 1.4053142070770264
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.946 Vali Acc: 0.288 Test Loss: 3.946 Test Acc: 0.288
Validation loss decreased (-0.284667 --> -0.288196).  Saving model ...
Epoch: 45 cost time: 1.5585079193115234
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.965 Vali Acc: 0.281 Test Loss: 3.965 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.4136230945587158
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.977 Vali Acc: 0.282 Test Loss: 3.977 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.5016939640045166
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.985 Vali Acc: 0.287 Test Loss: 3.985 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.72273588180542
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.993 Vali Acc: 0.280 Test Loss: 3.993 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.348454236984253
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.025 Vali Acc: 0.282 Test Loss: 4.025 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.2298963069915771
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.038 Vali Acc: 0.280 Test Loss: 4.038 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.184126615524292
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.025 Vali Acc: 0.276 Test Loss: 4.025 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.300011157989502
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.036 Vali Acc: 0.282 Test Loss: 4.036 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.4791522026062012
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.073 Vali Acc: 0.275 Test Loss: 4.073 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.391831398010254
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.078 Vali Acc: 0.284 Test Loss: 4.078 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28823529411764703
model parameter : 3762378
model size : 16.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0583126544952393
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.335 Vali Acc: 0.042 Test Loss: 3.335 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.4318315982818604
Epoch: 2, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.404 Vali Acc: 0.042 Test Loss: 3.404 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.33658766746521
Epoch: 3, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.364 Vali Acc: 0.062 Test Loss: 3.364 Test Acc: 0.062
Validation loss decreased (-0.042320 --> -0.062319).  Saving model ...
Epoch: 4 cost time: 1.3090660572052002
Epoch: 4, Steps: 10 | Train Loss: 3.089 Vali Loss: 3.330 Vali Acc: 0.062 Test Loss: 3.330 Test Acc: 0.062
Validation loss decreased (-0.062319 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 1.223050594329834
Epoch: 5, Steps: 10 | Train Loss: 2.958 Vali Loss: 3.274 Vali Acc: 0.081 Test Loss: 3.274 Test Acc: 0.081
Validation loss decreased (-0.062320 --> -0.081144).  Saving model ...
Epoch: 6 cost time: 1.4545419216156006
Epoch: 6, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.296 Vali Acc: 0.098 Test Loss: 3.296 Test Acc: 0.098
Validation loss decreased (-0.081144 --> -0.097614).  Saving model ...
Epoch: 7 cost time: 1.6055433750152588
Epoch: 7, Steps: 10 | Train Loss: 2.587 Vali Loss: 3.274 Vali Acc: 0.116 Test Loss: 3.274 Test Acc: 0.116
Validation loss decreased (-0.097614 --> -0.116438).  Saving model ...
Epoch: 8 cost time: 1.2124958038330078
Epoch: 8, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.240 Vali Acc: 0.128 Test Loss: 3.240 Test Acc: 0.128
Validation loss decreased (-0.116438 --> -0.128203).  Saving model ...
Epoch: 9 cost time: 1.5455029010772705
Epoch: 9, Steps: 10 | Train Loss: 2.153 Vali Loss: 3.247 Vali Acc: 0.134 Test Loss: 3.247 Test Acc: 0.134
Validation loss decreased (-0.128203 --> -0.134085).  Saving model ...
Epoch: 10 cost time: 1.551746129989624
Epoch: 10, Steps: 10 | Train Loss: 2.033 Vali Loss: 3.287 Vali Acc: 0.148 Test Loss: 3.287 Test Acc: 0.148
Validation loss decreased (-0.134085 --> -0.148202).  Saving model ...
Epoch: 11 cost time: 1.8590583801269531
Epoch: 11, Steps: 10 | Train Loss: 1.852 Vali Loss: 3.223 Vali Acc: 0.182 Test Loss: 3.223 Test Acc: 0.182
Validation loss decreased (-0.148202 --> -0.182321).  Saving model ...
Epoch: 12 cost time: 1.3300352096557617
Epoch: 12, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.271 Vali Acc: 0.165 Test Loss: 3.271 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3089563846588135
Epoch: 13, Steps: 10 | Train Loss: 1.425 Vali Loss: 3.237 Vali Acc: 0.185 Test Loss: 3.237 Test Acc: 0.185
Validation loss decreased (-0.182321 --> -0.184674).  Saving model ...
Epoch: 14 cost time: 1.386749029159546
Epoch: 14, Steps: 10 | Train Loss: 1.248 Vali Loss: 3.288 Vali Acc: 0.195 Test Loss: 3.288 Test Acc: 0.195
Validation loss decreased (-0.184674 --> -0.195261).  Saving model ...
Epoch: 15 cost time: 1.4123637676239014
Epoch: 15, Steps: 10 | Train Loss: 1.065 Vali Loss: 3.304 Vali Acc: 0.193 Test Loss: 3.304 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3203988075256348
Epoch: 16, Steps: 10 | Train Loss: 0.960 Vali Loss: 3.338 Vali Acc: 0.207 Test Loss: 3.338 Test Acc: 0.207
Validation loss decreased (-0.195261 --> -0.207025).  Saving model ...
Epoch: 17 cost time: 1.4674139022827148
Epoch: 17, Steps: 10 | Train Loss: 0.746 Vali Loss: 3.382 Vali Acc: 0.195 Test Loss: 3.382 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.40128493309021
Epoch: 18, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.396 Vali Acc: 0.207 Test Loss: 3.396 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.797818660736084
Epoch: 19, Steps: 10 | Train Loss: 0.508 Vali Loss: 3.432 Vali Acc: 0.209 Test Loss: 3.432 Test Acc: 0.209
Validation loss decreased (-0.207025 --> -0.209377).  Saving model ...
Epoch: 20 cost time: 1.77748703956604
Epoch: 20, Steps: 10 | Train Loss: 0.442 Vali Loss: 3.592 Vali Acc: 0.196 Test Loss: 3.592 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6296031475067139
Epoch: 21, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.522 Vali Acc: 0.225 Test Loss: 3.522 Test Acc: 0.225
Validation loss decreased (-0.209377 --> -0.224671).  Saving model ...
Epoch: 22 cost time: 1.5298357009887695
Epoch: 22, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.583 Vali Acc: 0.225 Test Loss: 3.583 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0106234550476074
Epoch: 23, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.709 Vali Acc: 0.225 Test Loss: 3.709 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9850270748138428
Epoch: 24, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.675 Vali Acc: 0.241 Test Loss: 3.675 Test Acc: 0.241
Validation loss decreased (-0.224671 --> -0.241140).  Saving model ...
Epoch: 25 cost time: 1.8194985389709473
Epoch: 25, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.780 Vali Acc: 0.232 Test Loss: 3.780 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8937909603118896
Epoch: 26, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.766 Vali Acc: 0.245 Test Loss: 3.766 Test Acc: 0.245
Validation loss decreased (-0.241140 --> -0.244668).  Saving model ...
Epoch: 27 cost time: 1.4938993453979492
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.834 Vali Acc: 0.229 Test Loss: 3.834 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2564170360565186
Epoch: 28, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.852 Vali Acc: 0.233 Test Loss: 3.852 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7895026206970215
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.918 Vali Acc: 0.240 Test Loss: 3.918 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8932807445526123
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.026 Vali Acc: 0.225 Test Loss: 4.026 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6841113567352295
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.965 Vali Acc: 0.242 Test Loss: 3.965 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.9665558338165283
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.041 Vali Acc: 0.246 Test Loss: 4.041 Test Acc: 0.246
Validation loss decreased (-0.244668 --> -0.245842).  Saving model ...
Epoch: 33 cost time: 1.7125132083892822
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.955 Vali Acc: 0.249 Test Loss: 3.955 Test Acc: 0.249
Validation loss decreased (-0.245842 --> -0.249372).  Saving model ...
Epoch: 34 cost time: 1.6896536350250244
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.075 Vali Acc: 0.245 Test Loss: 4.075 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8147456645965576
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.077 Vali Acc: 0.249 Test Loss: 4.077 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6246473789215088
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.043 Vali Acc: 0.254 Test Loss: 4.043 Test Acc: 0.254
Validation loss decreased (-0.249372 --> -0.254077).  Saving model ...
Epoch: 37 cost time: 1.6209592819213867
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.038 Vali Acc: 0.252 Test Loss: 4.038 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8073859214782715
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.060 Vali Acc: 0.256 Test Loss: 4.060 Test Acc: 0.256
Validation loss decreased (-0.254077 --> -0.256430).  Saving model ...
Epoch: 39 cost time: 2.1838111877441406
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.095 Vali Acc: 0.259 Test Loss: 4.095 Test Acc: 0.259
Validation loss decreased (-0.256430 --> -0.258783).  Saving model ...
Epoch: 40 cost time: 1.8363862037658691
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.113 Vali Acc: 0.255 Test Loss: 4.113 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7560808658599854
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.119 Vali Acc: 0.254 Test Loss: 4.119 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.10457706451416
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.112 Vali Acc: 0.259 Test Loss: 4.112 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.7213001251220703
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.131 Vali Acc: 0.258 Test Loss: 4.131 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.6842315196990967
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.137 Vali Acc: 0.261 Test Loss: 4.137 Test Acc: 0.261
Validation loss decreased (-0.258783 --> -0.261135).  Saving model ...
Epoch: 45 cost time: 1.5879895687103271
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.172 Vali Acc: 0.259 Test Loss: 4.172 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.6617646217346191
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.177 Vali Acc: 0.262 Test Loss: 4.177 Test Acc: 0.262
Validation loss decreased (-0.261135 --> -0.262311).  Saving model ...
Epoch: 47 cost time: 1.6007068157196045
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.188 Vali Acc: 0.260 Test Loss: 4.188 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.609196662902832
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.208 Vali Acc: 0.259 Test Loss: 4.208 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.058150291442871
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.191 Vali Acc: 0.264 Test Loss: 4.191 Test Acc: 0.264
Validation loss decreased (-0.262311 --> -0.263487).  Saving model ...
Epoch: 50 cost time: 1.4458625316619873
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.205 Vali Acc: 0.262 Test Loss: 4.205 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.4403808116912842
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.214 Vali Acc: 0.260 Test Loss: 4.214 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.7107360363006592
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.217 Vali Acc: 0.262 Test Loss: 4.217 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.6221156120300293
Epoch: 53, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.234 Vali Acc: 0.264 Test Loss: 4.234 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.5548815727233887
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.239 Vali Acc: 0.260 Test Loss: 4.239 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.7716681957244873
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.253 Vali Acc: 0.262 Test Loss: 4.253 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.968637466430664
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.275 Vali Acc: 0.262 Test Loss: 4.275 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.648346185684204
Epoch: 57, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.266 Vali Acc: 0.261 Test Loss: 4.266 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.3742222785949707
Epoch: 58, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.267 Vali Acc: 0.259 Test Loss: 4.267 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.7063238620758057
Epoch: 59, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.277 Vali Acc: 0.260 Test Loss: 4.277 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 3759306
model size : 16.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3654041290283203
Epoch: 1, Steps: 10 | Train Loss: 3.472 Vali Loss: 3.311 Vali Acc: 0.046 Test Loss: 3.311 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 1.424605131149292
Epoch: 2, Steps: 10 | Train Loss: 3.293 Vali Loss: 3.394 Vali Acc: 0.044 Test Loss: 3.394 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5716280937194824
Epoch: 3, Steps: 10 | Train Loss: 3.151 Vali Loss: 3.364 Vali Acc: 0.074 Test Loss: 3.364 Test Acc: 0.074
Validation loss decreased (-0.045849 --> -0.074084).  Saving model ...
Epoch: 4 cost time: 1.3979051113128662
Epoch: 4, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.356 Vali Acc: 0.067 Test Loss: 3.356 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5431022644042969
Epoch: 5, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.328 Vali Acc: 0.061 Test Loss: 3.328 Test Acc: 0.061
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3139586448669434
Epoch: 6, Steps: 10 | Train Loss: 2.876 Vali Loss: 3.262 Vali Acc: 0.086 Test Loss: 3.262 Test Acc: 0.086
Validation loss decreased (-0.074084 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 1.5205814838409424
Epoch: 7, Steps: 10 | Train Loss: 2.798 Vali Loss: 3.293 Vali Acc: 0.091 Test Loss: 3.293 Test Acc: 0.091
Validation loss decreased (-0.085850 --> -0.090555).  Saving model ...
Epoch: 8 cost time: 1.2798614501953125
Epoch: 8, Steps: 10 | Train Loss: 2.608 Vali Loss: 3.255 Vali Acc: 0.113 Test Loss: 3.255 Test Acc: 0.113
Validation loss decreased (-0.090555 --> -0.112909).  Saving model ...
Epoch: 9 cost time: 1.3989856243133545
Epoch: 9, Steps: 10 | Train Loss: 2.331 Vali Loss: 3.260 Vali Acc: 0.127 Test Loss: 3.260 Test Acc: 0.127
Validation loss decreased (-0.112909 --> -0.127026).  Saving model ...
Epoch: 10 cost time: 1.4947915077209473
Epoch: 10, Steps: 10 | Train Loss: 2.201 Vali Loss: 3.223 Vali Acc: 0.138 Test Loss: 3.223 Test Acc: 0.138
Validation loss decreased (-0.127026 --> -0.137615).  Saving model ...
Epoch: 11 cost time: 1.4548208713531494
Epoch: 11, Steps: 10 | Train Loss: 2.014 Vali Loss: 3.259 Vali Acc: 0.142 Test Loss: 3.259 Test Acc: 0.142
Validation loss decreased (-0.137615 --> -0.142320).  Saving model ...
Epoch: 12 cost time: 1.46714186668396
Epoch: 12, Steps: 10 | Train Loss: 1.804 Vali Loss: 3.291 Vali Acc: 0.145 Test Loss: 3.291 Test Acc: 0.145
Validation loss decreased (-0.142320 --> -0.144673).  Saving model ...
Epoch: 13 cost time: 1.7206947803497314
Epoch: 13, Steps: 10 | Train Loss: 1.588 Vali Loss: 3.263 Vali Acc: 0.154 Test Loss: 3.263 Test Acc: 0.154
Validation loss decreased (-0.144673 --> -0.154085).  Saving model ...
Epoch: 14 cost time: 1.6965813636779785
Epoch: 14, Steps: 10 | Train Loss: 1.411 Vali Loss: 3.289 Vali Acc: 0.181 Test Loss: 3.289 Test Acc: 0.181
Validation loss decreased (-0.154085 --> -0.181144).  Saving model ...
Epoch: 15 cost time: 1.3498592376708984
Epoch: 15, Steps: 10 | Train Loss: 1.270 Vali Loss: 3.289 Vali Acc: 0.174 Test Loss: 3.289 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2986640930175781
Epoch: 16, Steps: 10 | Train Loss: 1.063 Vali Loss: 3.317 Vali Acc: 0.175 Test Loss: 3.317 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4149293899536133
Epoch: 17, Steps: 10 | Train Loss: 0.909 Vali Loss: 3.275 Vali Acc: 0.207 Test Loss: 3.275 Test Acc: 0.207
Validation loss decreased (-0.181144 --> -0.207026).  Saving model ...
Epoch: 18 cost time: 1.1625945568084717
Epoch: 18, Steps: 10 | Train Loss: 0.770 Vali Loss: 3.417 Vali Acc: 0.191 Test Loss: 3.417 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5426056385040283
Epoch: 19, Steps: 10 | Train Loss: 0.674 Vali Loss: 3.368 Vali Acc: 0.200 Test Loss: 3.368 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3258187770843506
Epoch: 20, Steps: 10 | Train Loss: 0.483 Vali Loss: 3.428 Vali Acc: 0.211 Test Loss: 3.428 Test Acc: 0.211
Validation loss decreased (-0.207026 --> -0.210554).  Saving model ...
Epoch: 21 cost time: 1.461280107498169
Epoch: 21, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.538 Vali Acc: 0.191 Test Loss: 3.538 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4535505771636963
Epoch: 22, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.489 Vali Acc: 0.208 Test Loss: 3.489 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.561398983001709
Epoch: 23, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.580 Vali Acc: 0.219 Test Loss: 3.580 Test Acc: 0.219
Validation loss decreased (-0.210554 --> -0.218788).  Saving model ...
Epoch: 24 cost time: 1.2346422672271729
Epoch: 24, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.613 Vali Acc: 0.218 Test Loss: 3.613 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5471885204315186
Epoch: 25, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.698 Vali Acc: 0.222 Test Loss: 3.698 Test Acc: 0.222
Validation loss decreased (-0.218788 --> -0.222316).  Saving model ...
Epoch: 26 cost time: 1.5373117923736572
Epoch: 26, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.737 Vali Acc: 0.228 Test Loss: 3.737 Test Acc: 0.228
Validation loss decreased (-0.222316 --> -0.228198).  Saving model ...
Epoch: 27 cost time: 1.3932220935821533
Epoch: 27, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.834 Vali Acc: 0.239 Test Loss: 3.834 Test Acc: 0.239
Validation loss decreased (-0.228198 --> -0.238785).  Saving model ...
Epoch: 28 cost time: 1.26521635055542
Epoch: 28, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.877 Vali Acc: 0.226 Test Loss: 3.877 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4523088932037354
Epoch: 29, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.904 Vali Acc: 0.219 Test Loss: 3.904 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.359424114227295
Epoch: 30, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.036 Vali Acc: 0.227 Test Loss: 4.036 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.462883472442627
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.888 Vali Acc: 0.252 Test Loss: 3.888 Test Acc: 0.252
Validation loss decreased (-0.238785 --> -0.251726).  Saving model ...
Epoch: 32 cost time: 1.3799231052398682
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.891 Vali Acc: 0.247 Test Loss: 3.891 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.454831600189209
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.936 Vali Acc: 0.248 Test Loss: 3.936 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4235985279083252
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.933 Vali Acc: 0.254 Test Loss: 3.933 Test Acc: 0.254
Validation loss decreased (-0.251726 --> -0.254078).  Saving model ...
Epoch: 35 cost time: 1.466181993484497
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.933 Vali Acc: 0.255 Test Loss: 3.933 Test Acc: 0.255
Validation loss decreased (-0.254078 --> -0.255255).  Saving model ...
Epoch: 36 cost time: 1.3965260982513428
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.945 Vali Acc: 0.254 Test Loss: 3.945 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3907182216644287
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.966 Vali Acc: 0.253 Test Loss: 3.966 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4266138076782227
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.974 Vali Acc: 0.253 Test Loss: 3.974 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4406163692474365
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.996 Vali Acc: 0.256 Test Loss: 3.996 Test Acc: 0.256
Validation loss decreased (-0.255255 --> -0.256431).  Saving model ...
Epoch: 40 cost time: 1.424853801727295
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.056 Vali Acc: 0.251 Test Loss: 4.056 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3344316482543945
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.038 Vali Acc: 0.254 Test Loss: 4.038 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.513193130493164
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.059 Vali Acc: 0.254 Test Loss: 4.059 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.919952154159546
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.056 Vali Acc: 0.252 Test Loss: 4.056 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.5031933784484863
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.046 Vali Acc: 0.255 Test Loss: 4.046 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.4708678722381592
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.055 Vali Acc: 0.260 Test Loss: 4.055 Test Acc: 0.260
Validation loss decreased (-0.256431 --> -0.259959).  Saving model ...
Epoch: 46 cost time: 1.4474024772644043
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.069 Vali Acc: 0.248 Test Loss: 4.069 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.5480554103851318
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.089 Vali Acc: 0.258 Test Loss: 4.089 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.3655154705047607
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.098 Vali Acc: 0.264 Test Loss: 4.098 Test Acc: 0.264
Validation loss decreased (-0.259959 --> -0.263488).  Saving model ...
Epoch: 49 cost time: 1.2504284381866455
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.103 Vali Acc: 0.261 Test Loss: 4.103 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2666394710540771
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.108 Vali Acc: 0.260 Test Loss: 4.108 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.4642257690429688
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.124 Vali Acc: 0.265 Test Loss: 4.124 Test Acc: 0.265
Validation loss decreased (-0.263488 --> -0.264665).  Saving model ...
Epoch: 52 cost time: 1.2404515743255615
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.125 Vali Acc: 0.265 Test Loss: 4.125 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.7527856826782227
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.132 Vali Acc: 0.266 Test Loss: 4.132 Test Acc: 0.266
Validation loss decreased (-0.264665 --> -0.265841).  Saving model ...
Epoch: 54 cost time: 1.3721282482147217
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.144 Vali Acc: 0.265 Test Loss: 4.144 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.3417637348175049
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.159 Vali Acc: 0.266 Test Loss: 4.159 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.6637535095214844
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.151 Vali Acc: 0.266 Test Loss: 4.151 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.6026062965393066
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.175 Vali Acc: 0.268 Test Loss: 4.175 Test Acc: 0.268
Validation loss decreased (-0.265841 --> -0.268194).  Saving model ...
Epoch: 58 cost time: 1.4296045303344727
Epoch: 58, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.195 Vali Acc: 0.261 Test Loss: 4.195 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.3602304458618164
Epoch: 59, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.190 Vali Acc: 0.268 Test Loss: 4.190 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.5563676357269287
Epoch: 60, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.193 Vali Acc: 0.259 Test Loss: 4.193 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.516050100326538
Epoch: 61, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.216 Vali Acc: 0.262 Test Loss: 4.216 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.4583728313446045
Epoch: 62, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.231 Vali Acc: 0.262 Test Loss: 4.231 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.5015718936920166
Epoch: 63, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.233 Vali Acc: 0.264 Test Loss: 4.233 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.4552390575408936
Epoch: 64, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.227 Vali Acc: 0.260 Test Loss: 4.227 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.315124750137329
Epoch: 65, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.231 Vali Acc: 0.267 Test Loss: 4.231 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.45487380027771
Epoch: 66, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.235 Vali Acc: 0.266 Test Loss: 4.235 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.2313511371612549
Epoch: 67, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.257 Vali Acc: 0.265 Test Loss: 4.257 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 2847434
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4920241832733154
Epoch: 1, Steps: 10 | Train Loss: 3.373 Vali Loss: 3.327 Vali Acc: 0.041 Test Loss: 3.327 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.3730218410491943
Epoch: 2, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.369 Vali Acc: 0.048 Test Loss: 3.369 Test Acc: 0.048
Validation loss decreased (-0.041143 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 1.5834450721740723
Epoch: 3, Steps: 10 | Train Loss: 3.200 Vali Loss: 3.391 Vali Acc: 0.052 Test Loss: 3.391 Test Acc: 0.052
Validation loss decreased (-0.048202 --> -0.051731).  Saving model ...
Epoch: 4 cost time: 1.4835364818572998
Epoch: 4, Steps: 10 | Train Loss: 3.203 Vali Loss: 3.329 Vali Acc: 0.068 Test Loss: 3.329 Test Acc: 0.068
Validation loss decreased (-0.051731 --> -0.068202).  Saving model ...
Epoch: 5 cost time: 1.2908904552459717
Epoch: 5, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.307 Vali Acc: 0.068 Test Loss: 3.307 Test Acc: 0.068
Validation loss decreased (-0.068202 --> -0.068202).  Saving model ...
Epoch: 6 cost time: 1.35677170753479
Epoch: 6, Steps: 10 | Train Loss: 2.853 Vali Loss: 3.285 Vali Acc: 0.087 Test Loss: 3.285 Test Acc: 0.087
Validation loss decreased (-0.068202 --> -0.087026).  Saving model ...
Epoch: 7 cost time: 1.449190378189087
Epoch: 7, Steps: 10 | Train Loss: 2.762 Vali Loss: 3.259 Vali Acc: 0.108 Test Loss: 3.259 Test Acc: 0.108
Validation loss decreased (-0.087026 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 1.3878984451293945
Epoch: 8, Steps: 10 | Train Loss: 2.545 Vali Loss: 3.236 Vali Acc: 0.113 Test Loss: 3.236 Test Acc: 0.113
Validation loss decreased (-0.108203 --> -0.112909).  Saving model ...
Epoch: 9 cost time: 1.3451616764068604
Epoch: 9, Steps: 10 | Train Loss: 2.346 Vali Loss: 3.284 Vali Acc: 0.145 Test Loss: 3.284 Test Acc: 0.145
Validation loss decreased (-0.112909 --> -0.144673).  Saving model ...
Epoch: 10 cost time: 1.3785040378570557
Epoch: 10, Steps: 10 | Train Loss: 2.193 Vali Loss: 3.236 Vali Acc: 0.113 Test Loss: 3.236 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5288801193237305
Epoch: 11, Steps: 10 | Train Loss: 1.939 Vali Loss: 3.285 Vali Acc: 0.151 Test Loss: 3.285 Test Acc: 0.151
Validation loss decreased (-0.144673 --> -0.150555).  Saving model ...
Epoch: 12 cost time: 1.4416391849517822
Epoch: 12, Steps: 10 | Train Loss: 1.763 Vali Loss: 3.302 Vali Acc: 0.144 Test Loss: 3.302 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5423150062561035
Epoch: 13, Steps: 10 | Train Loss: 1.553 Vali Loss: 3.318 Vali Acc: 0.175 Test Loss: 3.318 Test Acc: 0.175
Validation loss decreased (-0.150555 --> -0.175261).  Saving model ...
Epoch: 14 cost time: 1.3145349025726318
Epoch: 14, Steps: 10 | Train Loss: 1.411 Vali Loss: 3.256 Vali Acc: 0.193 Test Loss: 3.256 Test Acc: 0.193
Validation loss decreased (-0.175261 --> -0.192909).  Saving model ...
Epoch: 15 cost time: 1.39400315284729
Epoch: 15, Steps: 10 | Train Loss: 1.170 Vali Loss: 3.338 Vali Acc: 0.191 Test Loss: 3.338 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2408490180969238
Epoch: 16, Steps: 10 | Train Loss: 1.032 Vali Loss: 3.355 Vali Acc: 0.201 Test Loss: 3.355 Test Acc: 0.201
Validation loss decreased (-0.192909 --> -0.201143).  Saving model ...
Epoch: 17 cost time: 1.2365779876708984
Epoch: 17, Steps: 10 | Train Loss: 0.900 Vali Loss: 3.403 Vali Acc: 0.205 Test Loss: 3.403 Test Acc: 0.205
Validation loss decreased (-0.201143 --> -0.204672).  Saving model ...
Epoch: 18 cost time: 1.4973175525665283
Epoch: 18, Steps: 10 | Train Loss: 0.790 Vali Loss: 3.405 Vali Acc: 0.199 Test Loss: 3.405 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3905043601989746
Epoch: 19, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.570 Vali Acc: 0.196 Test Loss: 3.570 Test Acc: 0.196
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.368567943572998
Epoch: 20, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.499 Vali Acc: 0.222 Test Loss: 3.499 Test Acc: 0.222
Validation loss decreased (-0.204672 --> -0.222318).  Saving model ...
Epoch: 21 cost time: 1.4201085567474365
Epoch: 21, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.638 Vali Acc: 0.207 Test Loss: 3.638 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3985552787780762
Epoch: 22, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.718 Vali Acc: 0.206 Test Loss: 3.718 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4168808460235596
Epoch: 23, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.754 Vali Acc: 0.206 Test Loss: 3.754 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4559319019317627
Epoch: 24, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.932 Vali Acc: 0.209 Test Loss: 3.932 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5862650871276855
Epoch: 25, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.930 Vali Acc: 0.219 Test Loss: 3.930 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.39780855178833
Epoch: 26, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.838 Vali Acc: 0.229 Test Loss: 3.838 Test Acc: 0.229
Validation loss decreased (-0.222318 --> -0.229373).  Saving model ...
Epoch: 27 cost time: 1.30014967918396
Epoch: 27, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.057 Vali Acc: 0.234 Test Loss: 4.057 Test Acc: 0.234
Validation loss decreased (-0.229373 --> -0.234077).  Saving model ...
Epoch: 28 cost time: 1.2400593757629395
Epoch: 28, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.013 Vali Acc: 0.227 Test Loss: 4.013 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2560184001922607
Epoch: 29, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.096 Vali Acc: 0.228 Test Loss: 4.096 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4075541496276855
Epoch: 30, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.028 Vali Acc: 0.252 Test Loss: 4.028 Test Acc: 0.252
Validation loss decreased (-0.234077 --> -0.251724).  Saving model ...
Epoch: 31 cost time: 1.4739229679107666
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.144 Vali Acc: 0.251 Test Loss: 4.144 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.171968936920166
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.129 Vali Acc: 0.256 Test Loss: 4.129 Test Acc: 0.256
Validation loss decreased (-0.251724 --> -0.256429).  Saving model ...
Epoch: 33 cost time: 1.3254566192626953
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.103 Vali Acc: 0.251 Test Loss: 4.103 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3311402797698975
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.142 Vali Acc: 0.256 Test Loss: 4.142 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4495692253112793
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.156 Vali Acc: 0.249 Test Loss: 4.156 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3526241779327393
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.172 Vali Acc: 0.256 Test Loss: 4.172 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2413642406463623
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.189 Vali Acc: 0.247 Test Loss: 4.189 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3218567371368408
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.207 Vali Acc: 0.258 Test Loss: 4.207 Test Acc: 0.258
Validation loss decreased (-0.256429 --> -0.257605).  Saving model ...
Epoch: 39 cost time: 1.4002354145050049
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.209 Vali Acc: 0.255 Test Loss: 4.209 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2845385074615479
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.217 Vali Acc: 0.254 Test Loss: 4.217 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5109903812408447
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.234 Vali Acc: 0.259 Test Loss: 4.234 Test Acc: 0.259
Validation loss decreased (-0.257605 --> -0.258781).  Saving model ...
Epoch: 42 cost time: 1.162431240081787
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.238 Vali Acc: 0.254 Test Loss: 4.238 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4002084732055664
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.261 Vali Acc: 0.247 Test Loss: 4.261 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.270479440689087
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.271 Vali Acc: 0.259 Test Loss: 4.271 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.356482982635498
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.264 Vali Acc: 0.253 Test Loss: 4.264 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.3660552501678467
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.285 Vali Acc: 0.253 Test Loss: 4.285 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1931819915771484
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.286 Vali Acc: 0.254 Test Loss: 4.286 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2307138442993164
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.300 Vali Acc: 0.256 Test Loss: 4.300 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.4835431575775146
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.316 Vali Acc: 0.256 Test Loss: 4.316 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.4427247047424316
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.340 Vali Acc: 0.256 Test Loss: 4.340 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.2556233406066895
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.370 Vali Acc: 0.253 Test Loss: 4.370 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 2844362
model size : 13.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.079024076461792
Epoch: 1, Steps: 10 | Train Loss: 3.396 Vali Loss: 3.309 Vali Acc: 0.051 Test Loss: 3.309 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.3754286766052246
Epoch: 2, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.350 Vali Acc: 0.054 Test Loss: 3.350 Test Acc: 0.054
Validation loss decreased (-0.050555 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 1.3970680236816406
Epoch: 3, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.362 Vali Acc: 0.048 Test Loss: 3.362 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.259286642074585
Epoch: 4, Steps: 10 | Train Loss: 3.109 Vali Loss: 3.324 Vali Acc: 0.062 Test Loss: 3.324 Test Acc: 0.062
Validation loss decreased (-0.054084 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 1.5254621505737305
Epoch: 5, Steps: 10 | Train Loss: 3.014 Vali Loss: 3.263 Vali Acc: 0.065 Test Loss: 3.263 Test Acc: 0.065
Validation loss decreased (-0.062320 --> -0.064673).  Saving model ...
Epoch: 6 cost time: 1.5520052909851074
Epoch: 6, Steps: 10 | Train Loss: 2.917 Vali Loss: 3.278 Vali Acc: 0.071 Test Loss: 3.278 Test Acc: 0.071
Validation loss decreased (-0.064673 --> -0.070555).  Saving model ...
Epoch: 7 cost time: 1.4155356884002686
Epoch: 7, Steps: 10 | Train Loss: 2.718 Vali Loss: 3.247 Vali Acc: 0.106 Test Loss: 3.247 Test Acc: 0.106
Validation loss decreased (-0.070555 --> -0.105850).  Saving model ...
Epoch: 8 cost time: 1.3385543823242188
Epoch: 8, Steps: 10 | Train Loss: 2.561 Vali Loss: 3.237 Vali Acc: 0.121 Test Loss: 3.237 Test Acc: 0.121
Validation loss decreased (-0.105850 --> -0.121144).  Saving model ...
Epoch: 9 cost time: 1.5139577388763428
Epoch: 9, Steps: 10 | Train Loss: 2.365 Vali Loss: 3.215 Vali Acc: 0.127 Test Loss: 3.215 Test Acc: 0.127
Validation loss decreased (-0.121144 --> -0.127027).  Saving model ...
Epoch: 10 cost time: 1.1836891174316406
Epoch: 10, Steps: 10 | Train Loss: 2.180 Vali Loss: 3.196 Vali Acc: 0.161 Test Loss: 3.196 Test Acc: 0.161
Validation loss decreased (-0.127027 --> -0.161145).  Saving model ...
Epoch: 11 cost time: 1.3311288356781006
Epoch: 11, Steps: 10 | Train Loss: 1.987 Vali Loss: 3.208 Vali Acc: 0.148 Test Loss: 3.208 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4493389129638672
Epoch: 12, Steps: 10 | Train Loss: 1.789 Vali Loss: 3.214 Vali Acc: 0.181 Test Loss: 3.214 Test Acc: 0.181
Validation loss decreased (-0.161145 --> -0.181144).  Saving model ...
Epoch: 13 cost time: 1.358992099761963
Epoch: 13, Steps: 10 | Train Loss: 1.615 Vali Loss: 3.216 Vali Acc: 0.191 Test Loss: 3.216 Test Acc: 0.191
Validation loss decreased (-0.181144 --> -0.190556).  Saving model ...
Epoch: 14 cost time: 1.5226032733917236
Epoch: 14, Steps: 10 | Train Loss: 1.365 Vali Loss: 3.229 Vali Acc: 0.187 Test Loss: 3.229 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4655051231384277
Epoch: 15, Steps: 10 | Train Loss: 1.243 Vali Loss: 3.273 Vali Acc: 0.198 Test Loss: 3.273 Test Acc: 0.198
Validation loss decreased (-0.190556 --> -0.197614).  Saving model ...
Epoch: 16 cost time: 1.2984139919281006
Epoch: 16, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.290 Vali Acc: 0.195 Test Loss: 3.290 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8618285655975342
Epoch: 17, Steps: 10 | Train Loss: 0.947 Vali Loss: 3.365 Vali Acc: 0.213 Test Loss: 3.365 Test Acc: 0.213
Validation loss decreased (-0.197614 --> -0.212908).  Saving model ...
Epoch: 18 cost time: 1.561877965927124
Epoch: 18, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.330 Vali Acc: 0.209 Test Loss: 3.330 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5427539348602295
Epoch: 19, Steps: 10 | Train Loss: 0.570 Vali Loss: 3.443 Vali Acc: 0.214 Test Loss: 3.443 Test Acc: 0.214
Validation loss decreased (-0.212908 --> -0.214083).  Saving model ...
Epoch: 20 cost time: 1.5390944480895996
Epoch: 20, Steps: 10 | Train Loss: 0.534 Vali Loss: 3.496 Vali Acc: 0.213 Test Loss: 3.496 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.74582839012146
Epoch: 21, Steps: 10 | Train Loss: 0.422 Vali Loss: 3.401 Vali Acc: 0.212 Test Loss: 3.401 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7390940189361572
Epoch: 22, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.607 Vali Acc: 0.234 Test Loss: 3.607 Test Acc: 0.234
Validation loss decreased (-0.214083 --> -0.234082).  Saving model ...
Epoch: 23 cost time: 1.771742343902588
Epoch: 23, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.570 Vali Acc: 0.213 Test Loss: 3.570 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.74363374710083
Epoch: 24, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.609 Vali Acc: 0.236 Test Loss: 3.609 Test Acc: 0.236
Validation loss decreased (-0.234082 --> -0.236434).  Saving model ...
Epoch: 25 cost time: 1.7443056106567383
Epoch: 25, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.709 Vali Acc: 0.233 Test Loss: 3.709 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.760242223739624
Epoch: 26, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.872 Vali Acc: 0.218 Test Loss: 3.872 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.594219446182251
Epoch: 27, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.817 Vali Acc: 0.246 Test Loss: 3.817 Test Acc: 0.246
Validation loss decreased (-0.236434 --> -0.245844).  Saving model ...
Epoch: 28 cost time: 2.2171108722686768
Epoch: 28, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.806 Vali Acc: 0.253 Test Loss: 3.806 Test Acc: 0.253
Validation loss decreased (-0.245844 --> -0.252903).  Saving model ...
Epoch: 29 cost time: 1.4890003204345703
Epoch: 29, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.863 Vali Acc: 0.267 Test Loss: 3.863 Test Acc: 0.267
Validation loss decreased (-0.252903 --> -0.267020).  Saving model ...
Epoch: 30 cost time: 1.4898440837860107
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.937 Vali Acc: 0.253 Test Loss: 3.937 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6008434295654297
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.902 Vali Acc: 0.260 Test Loss: 3.902 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4778728485107422
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.917 Vali Acc: 0.262 Test Loss: 3.917 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9949133396148682
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.932 Vali Acc: 0.267 Test Loss: 3.932 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.663057565689087
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.953 Vali Acc: 0.265 Test Loss: 3.953 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.505523681640625
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.010 Vali Acc: 0.259 Test Loss: 4.010 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.4370789527893066
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.027 Vali Acc: 0.260 Test Loss: 4.027 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.4679679870605469
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.030 Vali Acc: 0.268 Test Loss: 4.030 Test Acc: 0.268
Validation loss decreased (-0.267020 --> -0.268195).  Saving model ...
Epoch: 38 cost time: 1.5847222805023193
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.046 Vali Acc: 0.264 Test Loss: 4.046 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.460824728012085
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.046 Vali Acc: 0.262 Test Loss: 4.046 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.740919828414917
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.055 Vali Acc: 0.264 Test Loss: 4.055 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.490281105041504
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.095 Vali Acc: 0.268 Test Loss: 4.095 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.6630709171295166
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.096 Vali Acc: 0.272 Test Loss: 4.096 Test Acc: 0.272
Validation loss decreased (-0.268195 --> -0.271724).  Saving model ...
Epoch: 43 cost time: 1.5766007900238037
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.122 Vali Acc: 0.265 Test Loss: 4.122 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.6156044006347656
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.115 Vali Acc: 0.266 Test Loss: 4.115 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.658992052078247
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.128 Vali Acc: 0.268 Test Loss: 4.128 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.596097707748413
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.183 Vali Acc: 0.262 Test Loss: 4.183 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.6692945957183838
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.205 Vali Acc: 0.259 Test Loss: 4.205 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.4950876235961914
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.190 Vali Acc: 0.267 Test Loss: 4.190 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.8336026668548584
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.192 Vali Acc: 0.268 Test Loss: 4.192 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.545665979385376
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.207 Vali Acc: 0.269 Test Loss: 4.207 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.5554440021514893
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.243 Vali Acc: 0.264 Test Loss: 4.243 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.4701135158538818
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.259 Vali Acc: 0.266 Test Loss: 4.259 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 2841290
model size : 13.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.166651725769043
Epoch: 1, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.336 Vali Acc: 0.045 Test Loss: 3.336 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.3932533264160156
Epoch: 2, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.356 Vali Acc: 0.042 Test Loss: 3.356 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3834550380706787
Epoch: 3, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.387 Vali Acc: 0.045 Test Loss: 3.387 Test Acc: 0.045
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6704201698303223
Epoch: 4, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.319 Vali Acc: 0.076 Test Loss: 3.319 Test Acc: 0.076
Validation loss decreased (-0.044673 --> -0.076437).  Saving model ...
Epoch: 5 cost time: 1.3481924533843994
Epoch: 5, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.280 Vali Acc: 0.089 Test Loss: 3.280 Test Acc: 0.089
Validation loss decreased (-0.076437 --> -0.089379).  Saving model ...
Epoch: 6 cost time: 1.5589485168457031
Epoch: 6, Steps: 10 | Train Loss: 2.926 Vali Loss: 3.276 Vali Acc: 0.082 Test Loss: 3.276 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7786519527435303
Epoch: 7, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.245 Vali Acc: 0.126 Test Loss: 3.245 Test Acc: 0.126
Validation loss decreased (-0.089379 --> -0.125850).  Saving model ...
Epoch: 8 cost time: 1.3532335758209229
Epoch: 8, Steps: 10 | Train Loss: 2.620 Vali Loss: 3.283 Vali Acc: 0.115 Test Loss: 3.283 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5638306140899658
Epoch: 9, Steps: 10 | Train Loss: 2.448 Vali Loss: 3.221 Vali Acc: 0.121 Test Loss: 3.221 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.042381525039673
Epoch: 10, Steps: 10 | Train Loss: 2.183 Vali Loss: 3.235 Vali Acc: 0.155 Test Loss: 3.235 Test Acc: 0.155
Validation loss decreased (-0.125850 --> -0.155262).  Saving model ...
Epoch: 11 cost time: 1.2623779773712158
Epoch: 11, Steps: 10 | Train Loss: 1.997 Vali Loss: 3.200 Vali Acc: 0.162 Test Loss: 3.200 Test Acc: 0.162
Validation loss decreased (-0.155262 --> -0.162321).  Saving model ...
Epoch: 12 cost time: 1.606412649154663
Epoch: 12, Steps: 10 | Train Loss: 1.807 Vali Loss: 3.236 Vali Acc: 0.148 Test Loss: 3.236 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8160102367401123
Epoch: 13, Steps: 10 | Train Loss: 1.672 Vali Loss: 3.208 Vali Acc: 0.173 Test Loss: 3.208 Test Acc: 0.173
Validation loss decreased (-0.162321 --> -0.172909).  Saving model ...
Epoch: 14 cost time: 1.8730096817016602
Epoch: 14, Steps: 10 | Train Loss: 1.474 Vali Loss: 3.302 Vali Acc: 0.178 Test Loss: 3.302 Test Acc: 0.178
Validation loss decreased (-0.172909 --> -0.177614).  Saving model ...
Epoch: 15 cost time: 1.5777721405029297
Epoch: 15, Steps: 10 | Train Loss: 1.346 Vali Loss: 3.239 Vali Acc: 0.180 Test Loss: 3.239 Test Acc: 0.180
Validation loss decreased (-0.177614 --> -0.179968).  Saving model ...
Epoch: 16 cost time: 1.5410640239715576
Epoch: 16, Steps: 10 | Train Loss: 1.070 Vali Loss: 3.276 Vali Acc: 0.202 Test Loss: 3.276 Test Acc: 0.202
Validation loss decreased (-0.179968 --> -0.202320).  Saving model ...
Epoch: 17 cost time: 1.4595768451690674
Epoch: 17, Steps: 10 | Train Loss: 0.968 Vali Loss: 3.251 Vali Acc: 0.216 Test Loss: 3.251 Test Acc: 0.216
Validation loss decreased (-0.202320 --> -0.216438).  Saving model ...
Epoch: 18 cost time: 1.4056828022003174
Epoch: 18, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.262 Vali Acc: 0.219 Test Loss: 3.262 Test Acc: 0.219
Validation loss decreased (-0.216438 --> -0.218791).  Saving model ...
Epoch: 19 cost time: 1.3957176208496094
Epoch: 19, Steps: 10 | Train Loss: 0.661 Vali Loss: 3.288 Vali Acc: 0.236 Test Loss: 3.288 Test Acc: 0.236
Validation loss decreased (-0.218791 --> -0.236438).  Saving model ...
Epoch: 20 cost time: 1.6576178073883057
Epoch: 20, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.368 Vali Acc: 0.239 Test Loss: 3.368 Test Acc: 0.239
Validation loss decreased (-0.236438 --> -0.238790).  Saving model ...
Epoch: 21 cost time: 1.4039514064788818
Epoch: 21, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.376 Vali Acc: 0.242 Test Loss: 3.376 Test Acc: 0.242
Validation loss decreased (-0.238790 --> -0.242319).  Saving model ...
Epoch: 22 cost time: 1.711681842803955
Epoch: 22, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.452 Vali Acc: 0.240 Test Loss: 3.452 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5748729705810547
Epoch: 23, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.467 Vali Acc: 0.247 Test Loss: 3.467 Test Acc: 0.247
Validation loss decreased (-0.242319 --> -0.247024).  Saving model ...
Epoch: 24 cost time: 1.324470043182373
Epoch: 24, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.601 Vali Acc: 0.235 Test Loss: 3.601 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5570356845855713
Epoch: 25, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.624 Vali Acc: 0.236 Test Loss: 3.624 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.634359359741211
Epoch: 26, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.739 Vali Acc: 0.225 Test Loss: 3.739 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5357122421264648
Epoch: 27, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.686 Vali Acc: 0.253 Test Loss: 3.686 Test Acc: 0.253
Validation loss decreased (-0.247024 --> -0.252904).  Saving model ...
Epoch: 28 cost time: 1.571305513381958
Epoch: 28, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.678 Vali Acc: 0.265 Test Loss: 3.678 Test Acc: 0.265
Validation loss decreased (-0.252904 --> -0.264669).  Saving model ...
Epoch: 29 cost time: 1.2783927917480469
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.741 Vali Acc: 0.269 Test Loss: 3.741 Test Acc: 0.269
Validation loss decreased (-0.264669 --> -0.269374).  Saving model ...
Epoch: 30 cost time: 1.372565507888794
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.722 Vali Acc: 0.271 Test Loss: 3.722 Test Acc: 0.271
Validation loss decreased (-0.269374 --> -0.270551).  Saving model ...
Epoch: 31 cost time: 1.4416143894195557
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.715 Vali Acc: 0.280 Test Loss: 3.715 Test Acc: 0.280
Validation loss decreased (-0.270551 --> -0.279963).  Saving model ...
Epoch: 32 cost time: 1.283069372177124
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.752 Vali Acc: 0.276 Test Loss: 3.752 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1407537460327148
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.759 Vali Acc: 0.284 Test Loss: 3.759 Test Acc: 0.284
Validation loss decreased (-0.279963 --> -0.283492).  Saving model ...
Epoch: 34 cost time: 1.589796543121338
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.766 Vali Acc: 0.279 Test Loss: 3.766 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2444491386413574
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.800 Vali Acc: 0.276 Test Loss: 3.800 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.401554822921753
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.829 Vali Acc: 0.280 Test Loss: 3.829 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.9056708812713623
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.863 Vali Acc: 0.284 Test Loss: 3.863 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.6359386444091797
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.856 Vali Acc: 0.284 Test Loss: 3.856 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.5313611030578613
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.872 Vali Acc: 0.284 Test Loss: 3.872 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.9226586818695068
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.866 Vali Acc: 0.282 Test Loss: 3.866 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.5986008644104004
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.908 Vali Acc: 0.284 Test Loss: 3.908 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.738962173461914
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.915 Vali Acc: 0.279 Test Loss: 3.915 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4647507667541504
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.919 Vali Acc: 0.284 Test Loss: 3.919 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 2838218
model size : 13.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0680017471313477
Epoch: 1, Steps: 10 | Train Loss: 3.436 Vali Loss: 3.363 Vali Acc: 0.041 Test Loss: 3.363 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.4840757846832275
Epoch: 2, Steps: 10 | Train Loss: 3.293 Vali Loss: 3.349 Vali Acc: 0.049 Test Loss: 3.349 Test Acc: 0.049
Validation loss decreased (-0.041143 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 1.5797438621520996
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.364 Vali Acc: 0.056 Test Loss: 3.364 Test Acc: 0.056
Validation loss decreased (-0.049378 --> -0.056437).  Saving model ...
Epoch: 4 cost time: 1.3407082557678223
Epoch: 4, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.342 Vali Acc: 0.074 Test Loss: 3.342 Test Acc: 0.074
Validation loss decreased (-0.056437 --> -0.074084).  Saving model ...
Epoch: 5 cost time: 1.2575175762176514
Epoch: 5, Steps: 10 | Train Loss: 3.038 Vali Loss: 3.289 Vali Acc: 0.082 Test Loss: 3.289 Test Acc: 0.082
Validation loss decreased (-0.074084 --> -0.082320).  Saving model ...
Epoch: 6 cost time: 1.316711187362671
Epoch: 6, Steps: 10 | Train Loss: 2.915 Vali Loss: 3.287 Vali Acc: 0.111 Test Loss: 3.287 Test Acc: 0.111
Validation loss decreased (-0.082320 --> -0.110555).  Saving model ...
Epoch: 7 cost time: 1.4298365116119385
Epoch: 7, Steps: 10 | Train Loss: 2.807 Vali Loss: 3.271 Vali Acc: 0.107 Test Loss: 3.271 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5355033874511719
Epoch: 8, Steps: 10 | Train Loss: 2.633 Vali Loss: 3.281 Vali Acc: 0.113 Test Loss: 3.281 Test Acc: 0.113
Validation loss decreased (-0.110555 --> -0.112908).  Saving model ...
Epoch: 9 cost time: 1.2216763496398926
Epoch: 9, Steps: 10 | Train Loss: 2.414 Vali Loss: 3.205 Vali Acc: 0.141 Test Loss: 3.205 Test Acc: 0.141
Validation loss decreased (-0.112908 --> -0.141144).  Saving model ...
Epoch: 10 cost time: 1.4247715473175049
Epoch: 10, Steps: 10 | Train Loss: 2.311 Vali Loss: 3.224 Vali Acc: 0.152 Test Loss: 3.224 Test Acc: 0.152
Validation loss decreased (-0.141144 --> -0.151732).  Saving model ...
Epoch: 11 cost time: 1.6769821643829346
Epoch: 11, Steps: 10 | Train Loss: 2.049 Vali Loss: 3.208 Vali Acc: 0.155 Test Loss: 3.208 Test Acc: 0.155
Validation loss decreased (-0.151732 --> -0.155262).  Saving model ...
Epoch: 12 cost time: 1.372307300567627
Epoch: 12, Steps: 10 | Train Loss: 1.894 Vali Loss: 3.202 Vali Acc: 0.171 Test Loss: 3.202 Test Acc: 0.171
Validation loss decreased (-0.155262 --> -0.170556).  Saving model ...
Epoch: 13 cost time: 1.4535629749298096
Epoch: 13, Steps: 10 | Train Loss: 1.795 Vali Loss: 3.209 Vali Acc: 0.180 Test Loss: 3.209 Test Acc: 0.180
Validation loss decreased (-0.170556 --> -0.179968).  Saving model ...
Epoch: 14 cost time: 1.245863437652588
Epoch: 14, Steps: 10 | Train Loss: 1.623 Vali Loss: 3.264 Vali Acc: 0.182 Test Loss: 3.264 Test Acc: 0.182
Validation loss decreased (-0.179968 --> -0.182320).  Saving model ...
Epoch: 15 cost time: 1.544018030166626
Epoch: 15, Steps: 10 | Train Loss: 1.427 Vali Loss: 3.250 Vali Acc: 0.198 Test Loss: 3.250 Test Acc: 0.198
Validation loss decreased (-0.182320 --> -0.197615).  Saving model ...
Epoch: 16 cost time: 1.5792837142944336
Epoch: 16, Steps: 10 | Train Loss: 1.260 Vali Loss: 3.277 Vali Acc: 0.193 Test Loss: 3.277 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5472891330718994
Epoch: 17, Steps: 10 | Train Loss: 1.114 Vali Loss: 3.290 Vali Acc: 0.218 Test Loss: 3.290 Test Acc: 0.218
Validation loss decreased (-0.197615 --> -0.217614).  Saving model ...
Epoch: 18 cost time: 1.9417884349822998
Epoch: 18, Steps: 10 | Train Loss: 0.925 Vali Loss: 3.278 Vali Acc: 0.219 Test Loss: 3.278 Test Acc: 0.219
Validation loss decreased (-0.217614 --> -0.218791).  Saving model ...
Epoch: 19 cost time: 1.7240715026855469
Epoch: 19, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.330 Vali Acc: 0.208 Test Loss: 3.330 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5436615943908691
Epoch: 20, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.399 Vali Acc: 0.211 Test Loss: 3.399 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7180390357971191
Epoch: 21, Steps: 10 | Train Loss: 0.524 Vali Loss: 3.448 Vali Acc: 0.226 Test Loss: 3.448 Test Acc: 0.226
Validation loss decreased (-0.218791 --> -0.225848).  Saving model ...
Epoch: 22 cost time: 1.362365961074829
Epoch: 22, Steps: 10 | Train Loss: 0.419 Vali Loss: 3.459 Vali Acc: 0.227 Test Loss: 3.459 Test Acc: 0.227
Validation loss decreased (-0.225848 --> -0.227024).  Saving model ...
Epoch: 23 cost time: 1.2449285984039307
Epoch: 23, Steps: 10 | Train Loss: 0.331 Vali Loss: 3.597 Vali Acc: 0.229 Test Loss: 3.597 Test Acc: 0.229
Validation loss decreased (-0.227024 --> -0.229376).  Saving model ...
Epoch: 24 cost time: 1.5618069171905518
Epoch: 24, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.577 Vali Acc: 0.234 Test Loss: 3.577 Test Acc: 0.234
Validation loss decreased (-0.229376 --> -0.234082).  Saving model ...
Epoch: 25 cost time: 1.4926812648773193
Epoch: 25, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.700 Vali Acc: 0.228 Test Loss: 3.700 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5277090072631836
Epoch: 26, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.847 Vali Acc: 0.218 Test Loss: 3.847 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6641945838928223
Epoch: 27, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.734 Vali Acc: 0.253 Test Loss: 3.734 Test Acc: 0.253
Validation loss decreased (-0.234082 --> -0.252904).  Saving model ...
Epoch: 28 cost time: 1.3813879489898682
Epoch: 28, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.793 Vali Acc: 0.261 Test Loss: 3.793 Test Acc: 0.261
Validation loss decreased (-0.252904 --> -0.261139).  Saving model ...
Epoch: 29 cost time: 1.384835958480835
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.769 Vali Acc: 0.261 Test Loss: 3.769 Test Acc: 0.261
Validation loss decreased (-0.261139 --> -0.261139).  Saving model ...
Epoch: 30 cost time: 1.321988821029663
Epoch: 30, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.877 Vali Acc: 0.255 Test Loss: 3.877 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5124144554138184
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.960 Vali Acc: 0.252 Test Loss: 3.960 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4296119213104248
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.937 Vali Acc: 0.265 Test Loss: 3.937 Test Acc: 0.265
Validation loss decreased (-0.261139 --> -0.264667).  Saving model ...
Epoch: 33 cost time: 1.4661824703216553
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.961 Vali Acc: 0.265 Test Loss: 3.961 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5572173595428467
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.959 Vali Acc: 0.268 Test Loss: 3.959 Test Acc: 0.268
Validation loss decreased (-0.264667 --> -0.268196).  Saving model ...
Epoch: 35 cost time: 1.2515413761138916
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.990 Vali Acc: 0.266 Test Loss: 3.990 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2480268478393555
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.984 Vali Acc: 0.272 Test Loss: 3.984 Test Acc: 0.272
Validation loss decreased (-0.268196 --> -0.271725).  Saving model ...
Epoch: 37 cost time: 1.4858205318450928
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.018 Vali Acc: 0.271 Test Loss: 4.018 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3508470058441162
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.037 Vali Acc: 0.268 Test Loss: 4.037 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3928601741790771
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.041 Vali Acc: 0.273 Test Loss: 4.041 Test Acc: 0.273
Validation loss decreased (-0.271725 --> -0.272901).  Saving model ...
Epoch: 40 cost time: 1.2272770404815674
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.071 Vali Acc: 0.261 Test Loss: 4.071 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2752366065979004
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.064 Vali Acc: 0.274 Test Loss: 4.064 Test Acc: 0.274
Validation loss decreased (-0.272901 --> -0.274077).  Saving model ...
Epoch: 42 cost time: 1.5056626796722412
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.052 Vali Acc: 0.281 Test Loss: 4.052 Test Acc: 0.281
Validation loss decreased (-0.274077 --> -0.281136).  Saving model ...
Epoch: 43 cost time: 1.5515449047088623
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.087 Vali Acc: 0.282 Test Loss: 4.087 Test Acc: 0.282
Validation loss decreased (-0.281136 --> -0.282312).  Saving model ...
Epoch: 44 cost time: 1.5143847465515137
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.103 Vali Acc: 0.279 Test Loss: 4.103 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7994287014007568
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.095 Vali Acc: 0.276 Test Loss: 4.095 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.5103707313537598
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.118 Vali Acc: 0.276 Test Loss: 4.118 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3394496440887451
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.135 Vali Acc: 0.278 Test Loss: 4.135 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.354245901107788
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.148 Vali Acc: 0.272 Test Loss: 4.148 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3059914112091064
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.155 Vali Acc: 0.274 Test Loss: 4.155 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.581390619277954
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.162 Vali Acc: 0.279 Test Loss: 4.162 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.4381837844848633
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.173 Vali Acc: 0.278 Test Loss: 4.173 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.7188994884490967
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.167 Vali Acc: 0.280 Test Loss: 4.167 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.766430377960205
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.189 Vali Acc: 0.284 Test Loss: 4.189 Test Acc: 0.284
Validation loss decreased (-0.282312 --> -0.283488).  Saving model ...
Epoch: 54 cost time: 1.595578670501709
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.209 Vali Acc: 0.276 Test Loss: 4.209 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.7271060943603516
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.203 Vali Acc: 0.286 Test Loss: 4.203 Test Acc: 0.286
Validation loss decreased (-0.283488 --> -0.285840).  Saving model ...
Epoch: 56 cost time: 1.2427637577056885
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.208 Vali Acc: 0.286 Test Loss: 4.208 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3975694179534912
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.240 Vali Acc: 0.281 Test Loss: 4.240 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.6452369689941406
Epoch: 58, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.260 Vali Acc: 0.280 Test Loss: 4.260 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.5492749214172363
Epoch: 59, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.254 Vali Acc: 0.286 Test Loss: 4.254 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.47210693359375
Epoch: 60, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.252 Vali Acc: 0.281 Test Loss: 4.252 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.76497483253479
Epoch: 61, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.247 Vali Acc: 0.286 Test Loss: 4.247 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.628159761428833
Epoch: 62, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.274 Vali Acc: 0.284 Test Loss: 4.274 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.553426742553711
Epoch: 63, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.294 Vali Acc: 0.285 Test Loss: 4.294 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.7213923931121826
Epoch: 64, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.288 Vali Acc: 0.288 Test Loss: 4.288 Test Acc: 0.288
Validation loss decreased (-0.285840 --> -0.288192).  Saving model ...
Epoch: 65 cost time: 1.5026562213897705
Epoch: 65, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.288 Vali Acc: 0.281 Test Loss: 4.288 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.4686667919158936
Epoch: 66, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.299 Vali Acc: 0.286 Test Loss: 4.299 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.6544859409332275
Epoch: 67, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.301 Vali Acc: 0.288 Test Loss: 4.301 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.5878169536590576
Epoch: 68, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.316 Vali Acc: 0.285 Test Loss: 4.316 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.7350471019744873
Epoch: 69, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.312 Vali Acc: 0.280 Test Loss: 4.312 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.6247789859771729
Epoch: 70, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.330 Vali Acc: 0.291 Test Loss: 4.330 Test Acc: 0.291
Validation loss decreased (-0.288192 --> -0.290545).  Saving model ...
Epoch: 71 cost time: 1.4322638511657715
Epoch: 71, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.338 Vali Acc: 0.287 Test Loss: 4.338 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.4442524909973145
Epoch: 72, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.359 Vali Acc: 0.288 Test Loss: 4.359 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.3936853408813477
Epoch: 73, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.362 Vali Acc: 0.286 Test Loss: 4.362 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.3290951251983643
Epoch: 74, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.363 Vali Acc: 0.281 Test Loss: 4.363 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.5371661186218262
Epoch: 75, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.374 Vali Acc: 0.284 Test Loss: 4.374 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.241647720336914
Epoch: 76, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.384 Vali Acc: 0.285 Test Loss: 4.384 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.3307018280029297
Epoch: 77, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.398 Vali Acc: 0.282 Test Loss: 4.398 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.4168033599853516
Epoch: 78, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.384 Vali Acc: 0.286 Test Loss: 4.384 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 1.9953656196594238
Epoch: 79, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.391 Vali Acc: 0.287 Test Loss: 4.391 Test Acc: 0.287
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 1.5461304187774658
Epoch: 80, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.399 Vali Acc: 0.286 Test Loss: 4.399 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 2386890
model size : 11.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8979227542877197
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.302 Vali Acc: 0.045 Test Loss: 3.302 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.2595341205596924
Epoch: 2, Steps: 10 | Train Loss: 3.228 Vali Loss: 3.380 Vali Acc: 0.040 Test Loss: 3.380 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3156037330627441
Epoch: 3, Steps: 10 | Train Loss: 3.124 Vali Loss: 3.338 Vali Acc: 0.055 Test Loss: 3.338 Test Acc: 0.055
Validation loss decreased (-0.044673 --> -0.055261).  Saving model ...
Epoch: 4 cost time: 1.2598261833190918
Epoch: 4, Steps: 10 | Train Loss: 3.104 Vali Loss: 3.295 Vali Acc: 0.076 Test Loss: 3.295 Test Acc: 0.076
Validation loss decreased (-0.055261 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 1.2751133441925049
Epoch: 5, Steps: 10 | Train Loss: 3.048 Vali Loss: 3.303 Vali Acc: 0.066 Test Loss: 3.303 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3938183784484863
Epoch: 6, Steps: 10 | Train Loss: 2.908 Vali Loss: 3.259 Vali Acc: 0.105 Test Loss: 3.259 Test Acc: 0.105
Validation loss decreased (-0.076438 --> -0.104673).  Saving model ...
Epoch: 7 cost time: 1.386507272720337
Epoch: 7, Steps: 10 | Train Loss: 2.739 Vali Loss: 3.286 Vali Acc: 0.082 Test Loss: 3.286 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4318268299102783
Epoch: 8, Steps: 10 | Train Loss: 2.595 Vali Loss: 3.238 Vali Acc: 0.128 Test Loss: 3.238 Test Acc: 0.128
Validation loss decreased (-0.104673 --> -0.128203).  Saving model ...
Epoch: 9 cost time: 1.2464594841003418
Epoch: 9, Steps: 10 | Train Loss: 2.403 Vali Loss: 3.227 Vali Acc: 0.115 Test Loss: 3.227 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.339643955230713
Epoch: 10, Steps: 10 | Train Loss: 2.308 Vali Loss: 3.277 Vali Acc: 0.147 Test Loss: 3.277 Test Acc: 0.147
Validation loss decreased (-0.128203 --> -0.147026).  Saving model ...
Epoch: 11 cost time: 1.3602592945098877
Epoch: 11, Steps: 10 | Train Loss: 2.040 Vali Loss: 3.222 Vali Acc: 0.169 Test Loss: 3.222 Test Acc: 0.169
Validation loss decreased (-0.147026 --> -0.169380).  Saving model ...
Epoch: 12 cost time: 1.3810513019561768
Epoch: 12, Steps: 10 | Train Loss: 1.895 Vali Loss: 3.206 Vali Acc: 0.175 Test Loss: 3.206 Test Acc: 0.175
Validation loss decreased (-0.169380 --> -0.175262).  Saving model ...
Epoch: 13 cost time: 1.6411511898040771
Epoch: 13, Steps: 10 | Train Loss: 1.683 Vali Loss: 3.230 Vali Acc: 0.180 Test Loss: 3.230 Test Acc: 0.180
Validation loss decreased (-0.175262 --> -0.179968).  Saving model ...
Epoch: 14 cost time: 1.312715768814087
Epoch: 14, Steps: 10 | Train Loss: 1.480 Vali Loss: 3.275 Vali Acc: 0.192 Test Loss: 3.275 Test Acc: 0.192
Validation loss decreased (-0.179968 --> -0.191732).  Saving model ...
Epoch: 15 cost time: 1.4310226440429688
Epoch: 15, Steps: 10 | Train Loss: 1.261 Vali Loss: 3.268 Vali Acc: 0.194 Test Loss: 3.268 Test Acc: 0.194
Validation loss decreased (-0.191732 --> -0.194085).  Saving model ...
Epoch: 16 cost time: 1.4117662906646729
Epoch: 16, Steps: 10 | Train Loss: 1.118 Vali Loss: 3.329 Vali Acc: 0.194 Test Loss: 3.329 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5809657573699951
Epoch: 17, Steps: 10 | Train Loss: 0.950 Vali Loss: 3.278 Vali Acc: 0.213 Test Loss: 3.278 Test Acc: 0.213
Validation loss decreased (-0.194085 --> -0.212908).  Saving model ...
Epoch: 18 cost time: 1.3329014778137207
Epoch: 18, Steps: 10 | Train Loss: 0.828 Vali Loss: 3.381 Vali Acc: 0.208 Test Loss: 3.381 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4857120513916016
Epoch: 19, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.350 Vali Acc: 0.222 Test Loss: 3.350 Test Acc: 0.222
Validation loss decreased (-0.212908 --> -0.222319).  Saving model ...
Epoch: 20 cost time: 1.3976926803588867
Epoch: 20, Steps: 10 | Train Loss: 0.565 Vali Loss: 3.454 Vali Acc: 0.214 Test Loss: 3.454 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2675464153289795
Epoch: 21, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.472 Vali Acc: 0.222 Test Loss: 3.472 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3047657012939453
Epoch: 22, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.568 Vali Acc: 0.220 Test Loss: 3.568 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4877750873565674
Epoch: 23, Steps: 10 | Train Loss: 0.285 Vali Loss: 3.643 Vali Acc: 0.229 Test Loss: 3.643 Test Acc: 0.229
Validation loss decreased (-0.222319 --> -0.229375).  Saving model ...
Epoch: 24 cost time: 1.408400535583496
Epoch: 24, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.611 Vali Acc: 0.205 Test Loss: 3.611 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.235076904296875
Epoch: 25, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.773 Vali Acc: 0.221 Test Loss: 3.773 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.37424898147583
Epoch: 26, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.731 Vali Acc: 0.232 Test Loss: 3.731 Test Acc: 0.232
Validation loss decreased (-0.229375 --> -0.231727).  Saving model ...
Epoch: 27 cost time: 1.3153698444366455
Epoch: 27, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.860 Vali Acc: 0.238 Test Loss: 3.860 Test Acc: 0.238
Validation loss decreased (-0.231727 --> -0.237608).  Saving model ...
Epoch: 28 cost time: 1.4569709300994873
Epoch: 28, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.915 Vali Acc: 0.248 Test Loss: 3.915 Test Acc: 0.248
Validation loss decreased (-0.237608 --> -0.248196).  Saving model ...
Epoch: 29 cost time: 1.3242623805999756
Epoch: 29, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.911 Vali Acc: 0.242 Test Loss: 3.911 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3524715900421143
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.889 Vali Acc: 0.254 Test Loss: 3.889 Test Acc: 0.254
Validation loss decreased (-0.248196 --> -0.254079).  Saving model ...
Epoch: 31 cost time: 1.2135248184204102
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.014 Vali Acc: 0.248 Test Loss: 4.014 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5006601810455322
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.986 Vali Acc: 0.264 Test Loss: 3.986 Test Acc: 0.264
Validation loss decreased (-0.254079 --> -0.263490).  Saving model ...
Epoch: 33 cost time: 1.3345680236816406
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.008 Vali Acc: 0.256 Test Loss: 4.008 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.364549160003662
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.044 Vali Acc: 0.251 Test Loss: 4.044 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4555342197418213
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.046 Vali Acc: 0.256 Test Loss: 4.046 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7752487659454346
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.056 Vali Acc: 0.253 Test Loss: 4.056 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.53336763381958
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.054 Vali Acc: 0.266 Test Loss: 4.054 Test Acc: 0.266
Validation loss decreased (-0.263490 --> -0.265842).  Saving model ...
Epoch: 38 cost time: 1.5328164100646973
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.081 Vali Acc: 0.267 Test Loss: 4.081 Test Acc: 0.267
Validation loss decreased (-0.265842 --> -0.267018).  Saving model ...
Epoch: 39 cost time: 1.7727997303009033
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.112 Vali Acc: 0.251 Test Loss: 4.112 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4070203304290771
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.112 Vali Acc: 0.262 Test Loss: 4.112 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4694695472717285
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.144 Vali Acc: 0.259 Test Loss: 4.144 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.6158547401428223
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.165 Vali Acc: 0.267 Test Loss: 4.165 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.408019781112671
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.178 Vali Acc: 0.256 Test Loss: 4.178 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.3633301258087158
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.188 Vali Acc: 0.255 Test Loss: 4.188 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.3140742778778076
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.198 Vali Acc: 0.262 Test Loss: 4.198 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.2961108684539795
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.233 Vali Acc: 0.264 Test Loss: 4.233 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.286607265472412
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.225 Vali Acc: 0.267 Test Loss: 4.225 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.5840752124786377
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.240 Vali Acc: 0.261 Test Loss: 4.240 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 2383818
model size : 11.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0595693588256836
Epoch: 1, Steps: 10 | Train Loss: 3.426 Vali Loss: 3.340 Vali Acc: 0.048 Test Loss: 3.340 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 1.1778810024261475
Epoch: 2, Steps: 10 | Train Loss: 3.267 Vali Loss: 3.383 Vali Acc: 0.061 Test Loss: 3.383 Test Acc: 0.061
Validation loss decreased (-0.048202 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 1.4212210178375244
Epoch: 3, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.375 Vali Acc: 0.047 Test Loss: 3.375 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4874687194824219
Epoch: 4, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.343 Vali Acc: 0.069 Test Loss: 3.343 Test Acc: 0.069
Validation loss decreased (-0.061143 --> -0.069378).  Saving model ...
Epoch: 5 cost time: 1.0639493465423584
Epoch: 5, Steps: 10 | Train Loss: 3.024 Vali Loss: 3.298 Vali Acc: 0.094 Test Loss: 3.298 Test Acc: 0.094
Validation loss decreased (-0.069378 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 1.317758321762085
Epoch: 6, Steps: 10 | Train Loss: 2.898 Vali Loss: 3.266 Vali Acc: 0.082 Test Loss: 3.266 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4095301628112793
Epoch: 7, Steps: 10 | Train Loss: 2.843 Vali Loss: 3.265 Vali Acc: 0.122 Test Loss: 3.265 Test Acc: 0.122
Validation loss decreased (-0.094085 --> -0.122320).  Saving model ...
Epoch: 8 cost time: 1.513838768005371
Epoch: 8, Steps: 10 | Train Loss: 2.696 Vali Loss: 3.289 Vali Acc: 0.079 Test Loss: 3.289 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.636214017868042
Epoch: 9, Steps: 10 | Train Loss: 2.584 Vali Loss: 3.256 Vali Acc: 0.107 Test Loss: 3.256 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2593936920166016
Epoch: 10, Steps: 10 | Train Loss: 2.410 Vali Loss: 3.244 Vali Acc: 0.144 Test Loss: 3.244 Test Acc: 0.144
Validation loss decreased (-0.122320 --> -0.143497).  Saving model ...
Epoch: 11 cost time: 1.4382867813110352
Epoch: 11, Steps: 10 | Train Loss: 2.233 Vali Loss: 3.233 Vali Acc: 0.161 Test Loss: 3.233 Test Acc: 0.161
Validation loss decreased (-0.143497 --> -0.161144).  Saving model ...
Epoch: 12 cost time: 1.333009958267212
Epoch: 12, Steps: 10 | Train Loss: 2.016 Vali Loss: 3.241 Vali Acc: 0.155 Test Loss: 3.241 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5811738967895508
Epoch: 13, Steps: 10 | Train Loss: 1.880 Vali Loss: 3.238 Vali Acc: 0.181 Test Loss: 3.238 Test Acc: 0.181
Validation loss decreased (-0.161144 --> -0.181144).  Saving model ...
Epoch: 14 cost time: 1.438511610031128
Epoch: 14, Steps: 10 | Train Loss: 1.577 Vali Loss: 3.262 Vali Acc: 0.180 Test Loss: 3.262 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3277323246002197
Epoch: 15, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.323 Vali Acc: 0.189 Test Loss: 3.323 Test Acc: 0.189
Validation loss decreased (-0.181144 --> -0.189379).  Saving model ...
Epoch: 16 cost time: 1.8369550704956055
Epoch: 16, Steps: 10 | Train Loss: 1.257 Vali Loss: 3.292 Vali Acc: 0.194 Test Loss: 3.292 Test Acc: 0.194
Validation loss decreased (-0.189379 --> -0.194085).  Saving model ...
Epoch: 17 cost time: 1.8521373271942139
Epoch: 17, Steps: 10 | Train Loss: 1.037 Vali Loss: 3.300 Vali Acc: 0.205 Test Loss: 3.300 Test Acc: 0.205
Validation loss decreased (-0.194085 --> -0.204673).  Saving model ...
Epoch: 18 cost time: 1.425769329071045
Epoch: 18, Steps: 10 | Train Loss: 0.902 Vali Loss: 3.355 Vali Acc: 0.202 Test Loss: 3.355 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3175184726715088
Epoch: 19, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.402 Vali Acc: 0.206 Test Loss: 3.402 Test Acc: 0.206
Validation loss decreased (-0.204673 --> -0.205848).  Saving model ...
Epoch: 20 cost time: 1.5568773746490479
Epoch: 20, Steps: 10 | Train Loss: 0.671 Vali Loss: 3.470 Vali Acc: 0.198 Test Loss: 3.470 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4355683326721191
Epoch: 21, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.374 Vali Acc: 0.234 Test Loss: 3.374 Test Acc: 0.234
Validation loss decreased (-0.205848 --> -0.234084).  Saving model ...
Epoch: 22 cost time: 1.1981868743896484
Epoch: 22, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.564 Vali Acc: 0.214 Test Loss: 3.564 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4125926494598389
Epoch: 23, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.658 Vali Acc: 0.226 Test Loss: 3.658 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.484952449798584
Epoch: 24, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.619 Vali Acc: 0.211 Test Loss: 3.619 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2669010162353516
Epoch: 25, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.677 Vali Acc: 0.238 Test Loss: 3.677 Test Acc: 0.238
Validation loss decreased (-0.234084 --> -0.237610).  Saving model ...
Epoch: 26 cost time: 1.2957470417022705
Epoch: 26, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.741 Vali Acc: 0.252 Test Loss: 3.741 Test Acc: 0.252
Validation loss decreased (-0.237610 --> -0.251727).  Saving model ...
Epoch: 27 cost time: 1.7479689121246338
Epoch: 27, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.780 Vali Acc: 0.232 Test Loss: 3.780 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.655576467514038
Epoch: 28, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.838 Vali Acc: 0.246 Test Loss: 3.838 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7697083950042725
Epoch: 29, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.845 Vali Acc: 0.251 Test Loss: 3.845 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6151549816131592
Epoch: 30, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.973 Vali Acc: 0.240 Test Loss: 3.973 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.659721851348877
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.980 Vali Acc: 0.247 Test Loss: 3.980 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5346317291259766
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.116 Vali Acc: 0.231 Test Loss: 4.116 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.177732229232788
Epoch: 33, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.980 Vali Acc: 0.251 Test Loss: 3.980 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.722088098526001
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.042 Vali Acc: 0.254 Test Loss: 4.042 Test Acc: 0.254
Validation loss decreased (-0.251727 --> -0.254077).  Saving model ...
Epoch: 35 cost time: 1.3624482154846191
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.009 Vali Acc: 0.255 Test Loss: 4.009 Test Acc: 0.255
Validation loss decreased (-0.254077 --> -0.255254).  Saving model ...
Epoch: 36 cost time: 1.460284948348999
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.005 Vali Acc: 0.261 Test Loss: 4.005 Test Acc: 0.261
Validation loss decreased (-0.255254 --> -0.261136).  Saving model ...
Epoch: 37 cost time: 1.3026375770568848
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.031 Vali Acc: 0.260 Test Loss: 4.031 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.377563238143921
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.060 Vali Acc: 0.260 Test Loss: 4.060 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2186028957366943
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.080 Vali Acc: 0.262 Test Loss: 4.080 Test Acc: 0.262
Validation loss decreased (-0.261136 --> -0.262312).  Saving model ...
Epoch: 40 cost time: 1.536665439605713
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.071 Vali Acc: 0.264 Test Loss: 4.071 Test Acc: 0.264
Validation loss decreased (-0.262312 --> -0.263489).  Saving model ...
Epoch: 41 cost time: 1.7520644664764404
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.104 Vali Acc: 0.261 Test Loss: 4.104 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.409040927886963
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.117 Vali Acc: 0.265 Test Loss: 4.117 Test Acc: 0.265
Validation loss decreased (-0.263489 --> -0.264665).  Saving model ...
Epoch: 43 cost time: 1.3554127216339111
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.147 Vali Acc: 0.259 Test Loss: 4.147 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.4175925254821777
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.130 Vali Acc: 0.259 Test Loss: 4.130 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3569011688232422
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.148 Vali Acc: 0.260 Test Loss: 4.148 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.634162425994873
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.171 Vali Acc: 0.258 Test Loss: 4.171 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.3199832439422607
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.187 Vali Acc: 0.259 Test Loss: 4.187 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2997705936431885
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.175 Vali Acc: 0.256 Test Loss: 4.175 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.638777494430542
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.192 Vali Acc: 0.259 Test Loss: 4.192 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.830991506576538
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.219 Vali Acc: 0.259 Test Loss: 4.219 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.2136015892028809
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.221 Vali Acc: 0.256 Test Loss: 4.221 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.727473258972168
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.223 Vali Acc: 0.256 Test Loss: 4.223 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 2380746
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.13716459274292
Epoch: 1, Steps: 10 | Train Loss: 3.371 Vali Loss: 3.326 Vali Acc: 0.047 Test Loss: 3.326 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.1720328330993652
Epoch: 2, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.343 Vali Acc: 0.036 Test Loss: 3.343 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.186610460281372
Epoch: 3, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.317 Vali Acc: 0.051 Test Loss: 3.317 Test Acc: 0.051
Validation loss decreased (-0.047026 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 1.4054393768310547
Epoch: 4, Steps: 10 | Train Loss: 3.133 Vali Loss: 3.305 Vali Acc: 0.058 Test Loss: 3.305 Test Acc: 0.058
Validation loss decreased (-0.050555 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 1.1823248863220215
Epoch: 5, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.266 Vali Acc: 0.073 Test Loss: 3.266 Test Acc: 0.073
Validation loss decreased (-0.057614 --> -0.072909).  Saving model ...
Epoch: 6 cost time: 1.5930876731872559
Epoch: 6, Steps: 10 | Train Loss: 2.915 Vali Loss: 3.262 Vali Acc: 0.086 Test Loss: 3.262 Test Acc: 0.086
Validation loss decreased (-0.072909 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 1.4785349369049072
Epoch: 7, Steps: 10 | Train Loss: 2.803 Vali Loss: 3.258 Vali Acc: 0.080 Test Loss: 3.258 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4823477268218994
Epoch: 8, Steps: 10 | Train Loss: 2.666 Vali Loss: 3.217 Vali Acc: 0.102 Test Loss: 3.217 Test Acc: 0.102
Validation loss decreased (-0.085850 --> -0.102321).  Saving model ...
Epoch: 9 cost time: 1.4507927894592285
Epoch: 9, Steps: 10 | Train Loss: 2.460 Vali Loss: 3.233 Vali Acc: 0.120 Test Loss: 3.233 Test Acc: 0.120
Validation loss decreased (-0.102321 --> -0.119968).  Saving model ...
Epoch: 10 cost time: 1.2945780754089355
Epoch: 10, Steps: 10 | Train Loss: 2.277 Vali Loss: 3.264 Vali Acc: 0.106 Test Loss: 3.264 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.248892068862915
Epoch: 11, Steps: 10 | Train Loss: 2.125 Vali Loss: 3.253 Vali Acc: 0.126 Test Loss: 3.253 Test Acc: 0.126
Validation loss decreased (-0.119968 --> -0.125850).  Saving model ...
Epoch: 12 cost time: 1.519174337387085
Epoch: 12, Steps: 10 | Train Loss: 2.017 Vali Loss: 3.276 Vali Acc: 0.151 Test Loss: 3.276 Test Acc: 0.151
Validation loss decreased (-0.125850 --> -0.150555).  Saving model ...
Epoch: 13 cost time: 1.2256975173950195
Epoch: 13, Steps: 10 | Train Loss: 1.839 Vali Loss: 3.218 Vali Acc: 0.156 Test Loss: 3.218 Test Acc: 0.156
Validation loss decreased (-0.150555 --> -0.156438).  Saving model ...
Epoch: 14 cost time: 1.397571086883545
Epoch: 14, Steps: 10 | Train Loss: 1.579 Vali Loss: 3.333 Vali Acc: 0.154 Test Loss: 3.333 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2699506282806396
Epoch: 15, Steps: 10 | Train Loss: 1.420 Vali Loss: 3.232 Vali Acc: 0.191 Test Loss: 3.232 Test Acc: 0.191
Validation loss decreased (-0.156438 --> -0.190556).  Saving model ...
Epoch: 16 cost time: 1.2847607135772705
Epoch: 16, Steps: 10 | Train Loss: 1.259 Vali Loss: 3.274 Vali Acc: 0.194 Test Loss: 3.274 Test Acc: 0.194
Validation loss decreased (-0.190556 --> -0.194085).  Saving model ...
Epoch: 17 cost time: 1.2328321933746338
Epoch: 17, Steps: 10 | Train Loss: 1.077 Vali Loss: 3.268 Vali Acc: 0.206 Test Loss: 3.268 Test Acc: 0.206
Validation loss decreased (-0.194085 --> -0.205850).  Saving model ...
Epoch: 18 cost time: 1.3584258556365967
Epoch: 18, Steps: 10 | Train Loss: 0.944 Vali Loss: 3.288 Vali Acc: 0.212 Test Loss: 3.288 Test Acc: 0.212
Validation loss decreased (-0.205850 --> -0.211732).  Saving model ...
Epoch: 19 cost time: 1.500220775604248
Epoch: 19, Steps: 10 | Train Loss: 0.801 Vali Loss: 3.414 Vali Acc: 0.206 Test Loss: 3.414 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3003003597259521
Epoch: 20, Steps: 10 | Train Loss: 0.698 Vali Loss: 3.419 Vali Acc: 0.219 Test Loss: 3.419 Test Acc: 0.219
Validation loss decreased (-0.211732 --> -0.218789).  Saving model ...
Epoch: 21 cost time: 1.3950989246368408
Epoch: 21, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.438 Vali Acc: 0.234 Test Loss: 3.438 Test Acc: 0.234
Validation loss decreased (-0.218789 --> -0.234083).  Saving model ...
Epoch: 22 cost time: 1.4955065250396729
Epoch: 22, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.465 Vali Acc: 0.241 Test Loss: 3.465 Test Acc: 0.241
Validation loss decreased (-0.234083 --> -0.241142).  Saving model ...
Epoch: 23 cost time: 1.2268261909484863
Epoch: 23, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.449 Vali Acc: 0.249 Test Loss: 3.449 Test Acc: 0.249
Validation loss decreased (-0.241142 --> -0.249377).  Saving model ...
Epoch: 24 cost time: 1.3613379001617432
Epoch: 24, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.561 Vali Acc: 0.247 Test Loss: 3.561 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4535431861877441
Epoch: 25, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.667 Vali Acc: 0.235 Test Loss: 3.667 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.485243320465088
Epoch: 26, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.682 Vali Acc: 0.252 Test Loss: 3.682 Test Acc: 0.252
Validation loss decreased (-0.249377 --> -0.251728).  Saving model ...
Epoch: 27 cost time: 1.5258166790008545
Epoch: 27, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.735 Vali Acc: 0.238 Test Loss: 3.735 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.797895908355713
Epoch: 28, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.724 Vali Acc: 0.259 Test Loss: 3.724 Test Acc: 0.259
Validation loss decreased (-0.251728 --> -0.258786).  Saving model ...
Epoch: 29 cost time: 1.4605770111083984
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.813 Vali Acc: 0.255 Test Loss: 3.813 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4722638130187988
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.776 Vali Acc: 0.259 Test Loss: 3.776 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5434155464172363
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.885 Vali Acc: 0.261 Test Loss: 3.885 Test Acc: 0.261
Validation loss decreased (-0.258786 --> -0.261138).  Saving model ...
Epoch: 32 cost time: 1.2889502048492432
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.809 Vali Acc: 0.285 Test Loss: 3.809 Test Acc: 0.285
Validation loss decreased (-0.261138 --> -0.284668).  Saving model ...
Epoch: 33 cost time: 1.2640717029571533
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.855 Vali Acc: 0.272 Test Loss: 3.855 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.189584493637085
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.890 Vali Acc: 0.271 Test Loss: 3.890 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5469510555267334
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.848 Vali Acc: 0.279 Test Loss: 3.848 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0718307495117188
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.902 Vali Acc: 0.272 Test Loss: 3.902 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2948882579803467
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.955 Vali Acc: 0.272 Test Loss: 3.955 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.369382619857788
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.936 Vali Acc: 0.278 Test Loss: 3.936 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3715898990631104
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.928 Vali Acc: 0.280 Test Loss: 3.928 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3281638622283936
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.941 Vali Acc: 0.275 Test Loss: 3.941 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.3578050136566162
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.978 Vali Acc: 0.275 Test Loss: 3.978 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.3799221515655518
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.983 Vali Acc: 0.278 Test Loss: 3.983 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2847058823529412
model parameter : 2377674
model size : 11.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.240993022918701
Epoch: 1, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.352 Vali Acc: 0.032 Test Loss: 3.352 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 1.5572857856750488
Epoch: 2, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.351 Vali Acc: 0.049 Test Loss: 3.351 Test Acc: 0.049
Validation loss decreased (-0.031731 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 1.2677154541015625
Epoch: 3, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.416 Vali Acc: 0.042 Test Loss: 3.416 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1945576667785645
Epoch: 4, Steps: 10 | Train Loss: 3.111 Vali Loss: 3.338 Vali Acc: 0.058 Test Loss: 3.338 Test Acc: 0.058
Validation loss decreased (-0.049378 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 1.5978033542633057
Epoch: 5, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.305 Vali Acc: 0.082 Test Loss: 3.305 Test Acc: 0.082
Validation loss decreased (-0.057614 --> -0.082320).  Saving model ...
Epoch: 6 cost time: 1.3291237354278564
Epoch: 6, Steps: 10 | Train Loss: 2.902 Vali Loss: 3.272 Vali Acc: 0.098 Test Loss: 3.272 Test Acc: 0.098
Validation loss decreased (-0.082320 --> -0.097614).  Saving model ...
Epoch: 7 cost time: 1.3765316009521484
Epoch: 7, Steps: 10 | Train Loss: 2.720 Vali Loss: 3.299 Vali Acc: 0.094 Test Loss: 3.299 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1912915706634521
Epoch: 8, Steps: 10 | Train Loss: 2.558 Vali Loss: 3.252 Vali Acc: 0.120 Test Loss: 3.252 Test Acc: 0.120
Validation loss decreased (-0.097614 --> -0.119967).  Saving model ...
Epoch: 9 cost time: 1.2007486820220947
Epoch: 9, Steps: 10 | Train Loss: 2.464 Vali Loss: 3.275 Vali Acc: 0.125 Test Loss: 3.275 Test Acc: 0.125
Validation loss decreased (-0.119967 --> -0.124673).  Saving model ...
Epoch: 10 cost time: 1.2468912601470947
Epoch: 10, Steps: 10 | Train Loss: 2.304 Vali Loss: 3.235 Vali Acc: 0.138 Test Loss: 3.235 Test Acc: 0.138
Validation loss decreased (-0.124673 --> -0.137615).  Saving model ...
Epoch: 11 cost time: 1.5046567916870117
Epoch: 11, Steps: 10 | Train Loss: 2.065 Vali Loss: 3.261 Vali Acc: 0.127 Test Loss: 3.261 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2438445091247559
Epoch: 12, Steps: 10 | Train Loss: 1.903 Vali Loss: 3.301 Vali Acc: 0.167 Test Loss: 3.301 Test Acc: 0.167
Validation loss decreased (-0.137615 --> -0.167026).  Saving model ...
Epoch: 13 cost time: 1.3191053867340088
Epoch: 13, Steps: 10 | Train Loss: 1.714 Vali Loss: 3.306 Vali Acc: 0.165 Test Loss: 3.306 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2713449001312256
Epoch: 14, Steps: 10 | Train Loss: 1.512 Vali Loss: 3.354 Vali Acc: 0.164 Test Loss: 3.354 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.251946210861206
Epoch: 15, Steps: 10 | Train Loss: 1.392 Vali Loss: 3.320 Vali Acc: 0.175 Test Loss: 3.320 Test Acc: 0.175
Validation loss decreased (-0.167026 --> -0.175261).  Saving model ...
Epoch: 16 cost time: 1.2127745151519775
Epoch: 16, Steps: 10 | Train Loss: 1.213 Vali Loss: 3.354 Vali Acc: 0.185 Test Loss: 3.354 Test Acc: 0.185
Validation loss decreased (-0.175261 --> -0.184672).  Saving model ...
Epoch: 17 cost time: 1.2992608547210693
Epoch: 17, Steps: 10 | Train Loss: 1.047 Vali Loss: 3.309 Vali Acc: 0.191 Test Loss: 3.309 Test Acc: 0.191
Validation loss decreased (-0.184672 --> -0.190555).  Saving model ...
Epoch: 18 cost time: 1.2396495342254639
Epoch: 18, Steps: 10 | Train Loss: 0.938 Vali Loss: 3.434 Vali Acc: 0.195 Test Loss: 3.434 Test Acc: 0.195
Validation loss decreased (-0.190555 --> -0.195260).  Saving model ...
Epoch: 19 cost time: 1.1556055545806885
Epoch: 19, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.444 Vali Acc: 0.184 Test Loss: 3.444 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.570134162902832
Epoch: 20, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.430 Vali Acc: 0.206 Test Loss: 3.430 Test Acc: 0.206
Validation loss decreased (-0.195260 --> -0.205848).  Saving model ...
Epoch: 21 cost time: 1.296156644821167
Epoch: 21, Steps: 10 | Train Loss: 0.538 Vali Loss: 3.585 Vali Acc: 0.186 Test Loss: 3.585 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.320979118347168
Epoch: 22, Steps: 10 | Train Loss: 0.478 Vali Loss: 3.571 Vali Acc: 0.221 Test Loss: 3.571 Test Acc: 0.221
Validation loss decreased (-0.205848 --> -0.221141).  Saving model ...
Epoch: 23 cost time: 1.349090814590454
Epoch: 23, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.603 Vali Acc: 0.209 Test Loss: 3.603 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2313003540039062
Epoch: 24, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.688 Vali Acc: 0.225 Test Loss: 3.688 Test Acc: 0.225
Validation loss decreased (-0.221141 --> -0.224669).  Saving model ...
Epoch: 25 cost time: 1.3292577266693115
Epoch: 25, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.868 Vali Acc: 0.195 Test Loss: 3.868 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.204972743988037
Epoch: 26, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.694 Vali Acc: 0.236 Test Loss: 3.694 Test Acc: 0.236
Validation loss decreased (-0.224669 --> -0.236434).  Saving model ...
Epoch: 27 cost time: 1.523590326309204
Epoch: 27, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.022 Vali Acc: 0.224 Test Loss: 4.022 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.469508171081543
Epoch: 28, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.865 Vali Acc: 0.228 Test Loss: 3.865 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.248002290725708
Epoch: 29, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.979 Vali Acc: 0.231 Test Loss: 3.979 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2926018238067627
Epoch: 30, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.150 Vali Acc: 0.226 Test Loss: 4.150 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3633124828338623
Epoch: 31, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.147 Vali Acc: 0.225 Test Loss: 4.147 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4032626152038574
Epoch: 32, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.126 Vali Acc: 0.234 Test Loss: 4.126 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.542384386062622
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.059 Vali Acc: 0.235 Test Loss: 4.059 Test Acc: 0.235
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.4392895698547363
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.094 Vali Acc: 0.239 Test Loss: 4.094 Test Acc: 0.239
Validation loss decreased (-0.236434 --> -0.238783).  Saving model ...
Epoch: 35 cost time: 1.5060248374938965
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.140 Vali Acc: 0.244 Test Loss: 4.140 Test Acc: 0.244
Validation loss decreased (-0.238783 --> -0.243488).  Saving model ...
Epoch: 36 cost time: 1.4799129962921143
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.157 Vali Acc: 0.245 Test Loss: 4.157 Test Acc: 0.245
Validation loss decreased (-0.243488 --> -0.244664).  Saving model ...
Epoch: 37 cost time: 1.5121276378631592
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.165 Vali Acc: 0.242 Test Loss: 4.165 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2111990451812744
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.178 Vali Acc: 0.246 Test Loss: 4.178 Test Acc: 0.246
Validation loss decreased (-0.244664 --> -0.245841).  Saving model ...
Epoch: 39 cost time: 1.2374773025512695
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.191 Vali Acc: 0.245 Test Loss: 4.191 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4705214500427246
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.197 Vali Acc: 0.242 Test Loss: 4.197 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.699735403060913
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.244 Vali Acc: 0.242 Test Loss: 4.244 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2633132934570312
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.234 Vali Acc: 0.247 Test Loss: 4.234 Test Acc: 0.247
Validation loss decreased (-0.245841 --> -0.247016).  Saving model ...
Epoch: 43 cost time: 1.2266836166381836
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.243 Vali Acc: 0.251 Test Loss: 4.243 Test Acc: 0.251
Validation loss decreased (-0.247016 --> -0.250546).  Saving model ...
Epoch: 44 cost time: 1.2746613025665283
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.285 Vali Acc: 0.249 Test Loss: 4.285 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2327368259429932
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.284 Vali Acc: 0.245 Test Loss: 4.284 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3427283763885498
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.290 Vali Acc: 0.251 Test Loss: 4.290 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2567274570465088
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.310 Vali Acc: 0.249 Test Loss: 4.310 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.2061924934387207
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.305 Vali Acc: 0.249 Test Loss: 4.305 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.1665618419647217
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.340 Vali Acc: 0.248 Test Loss: 4.340 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.3730418682098389
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.368 Vali Acc: 0.246 Test Loss: 4.368 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.230799674987793
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.358 Vali Acc: 0.247 Test Loss: 4.358 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.1474692821502686
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.392 Vali Acc: 0.251 Test Loss: 4.392 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.3505878448486328
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.398 Vali Acc: 0.248 Test Loss: 4.398 Test Acc: 0.248
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25058823529411767
model parameter : 2156618
model size : 10.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6137802600860596
Epoch: 1, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.339 Vali Acc: 0.042 Test Loss: 3.339 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.3272898197174072
Epoch: 2, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.385 Vali Acc: 0.045 Test Loss: 3.385 Test Acc: 0.045
Validation loss decreased (-0.042320 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 1.1959381103515625
Epoch: 3, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.365 Vali Acc: 0.039 Test Loss: 3.365 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3434231281280518
Epoch: 4, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.331 Vali Acc: 0.058 Test Loss: 3.331 Test Acc: 0.058
Validation loss decreased (-0.044672 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 1.0914108753204346
Epoch: 5, Steps: 10 | Train Loss: 3.027 Vali Loss: 3.310 Vali Acc: 0.061 Test Loss: 3.310 Test Acc: 0.061
Validation loss decreased (-0.057614 --> -0.061143).  Saving model ...
Epoch: 6 cost time: 1.293032169342041
Epoch: 6, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.325 Vali Acc: 0.065 Test Loss: 3.325 Test Acc: 0.065
Validation loss decreased (-0.061143 --> -0.064673).  Saving model ...
Epoch: 7 cost time: 1.5332014560699463
Epoch: 7, Steps: 10 | Train Loss: 2.789 Vali Loss: 3.259 Vali Acc: 0.104 Test Loss: 3.259 Test Acc: 0.104
Validation loss decreased (-0.064673 --> -0.103497).  Saving model ...
Epoch: 8 cost time: 1.1245808601379395
Epoch: 8, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.249 Vali Acc: 0.104 Test Loss: 3.249 Test Acc: 0.104
Validation loss decreased (-0.103497 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 1.3041765689849854
Epoch: 9, Steps: 10 | Train Loss: 2.547 Vali Loss: 3.325 Vali Acc: 0.113 Test Loss: 3.325 Test Acc: 0.113
Validation loss decreased (-0.103497 --> -0.112908).  Saving model ...
Epoch: 10 cost time: 1.2219059467315674
Epoch: 10, Steps: 10 | Train Loss: 2.368 Vali Loss: 3.244 Vali Acc: 0.121 Test Loss: 3.244 Test Acc: 0.121
Validation loss decreased (-0.112908 --> -0.121144).  Saving model ...
Epoch: 11 cost time: 1.3264048099517822
Epoch: 11, Steps: 10 | Train Loss: 2.176 Vali Loss: 3.256 Vali Acc: 0.141 Test Loss: 3.256 Test Acc: 0.141
Validation loss decreased (-0.121144 --> -0.141144).  Saving model ...
Epoch: 12 cost time: 1.2530004978179932
Epoch: 12, Steps: 10 | Train Loss: 1.981 Vali Loss: 3.252 Vali Acc: 0.158 Test Loss: 3.252 Test Acc: 0.158
Validation loss decreased (-0.141144 --> -0.157615).  Saving model ...
Epoch: 13 cost time: 1.4374051094055176
Epoch: 13, Steps: 10 | Train Loss: 1.796 Vali Loss: 3.293 Vali Acc: 0.141 Test Loss: 3.293 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.410264492034912
Epoch: 14, Steps: 10 | Train Loss: 1.617 Vali Loss: 3.299 Vali Acc: 0.180 Test Loss: 3.299 Test Acc: 0.180
Validation loss decreased (-0.157615 --> -0.179967).  Saving model ...
Epoch: 15 cost time: 1.2446668148040771
Epoch: 15, Steps: 10 | Train Loss: 1.413 Vali Loss: 3.311 Vali Acc: 0.169 Test Loss: 3.311 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.601285457611084
Epoch: 16, Steps: 10 | Train Loss: 1.234 Vali Loss: 3.333 Vali Acc: 0.195 Test Loss: 3.333 Test Acc: 0.195
Validation loss decreased (-0.179967 --> -0.195261).  Saving model ...
Epoch: 17 cost time: 1.2905950546264648
Epoch: 17, Steps: 10 | Train Loss: 1.122 Vali Loss: 3.341 Vali Acc: 0.194 Test Loss: 3.341 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4594740867614746
Epoch: 18, Steps: 10 | Train Loss: 0.893 Vali Loss: 3.374 Vali Acc: 0.200 Test Loss: 3.374 Test Acc: 0.200
Validation loss decreased (-0.195261 --> -0.199966).  Saving model ...
Epoch: 19 cost time: 1.2977807521820068
Epoch: 19, Steps: 10 | Train Loss: 0.797 Vali Loss: 3.403 Vali Acc: 0.215 Test Loss: 3.403 Test Acc: 0.215
Validation loss decreased (-0.199966 --> -0.215260).  Saving model ...
Epoch: 20 cost time: 1.2622427940368652
Epoch: 20, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.437 Vali Acc: 0.201 Test Loss: 3.437 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.554246187210083
Epoch: 21, Steps: 10 | Train Loss: 0.544 Vali Loss: 3.450 Vali Acc: 0.193 Test Loss: 3.450 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.372668981552124
Epoch: 22, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.515 Vali Acc: 0.233 Test Loss: 3.515 Test Acc: 0.233
Validation loss decreased (-0.215260 --> -0.232906).  Saving model ...
Epoch: 23 cost time: 1.1945035457611084
Epoch: 23, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.604 Vali Acc: 0.207 Test Loss: 3.604 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3603811264038086
Epoch: 24, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.732 Vali Acc: 0.214 Test Loss: 3.732 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6085002422332764
Epoch: 25, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.772 Vali Acc: 0.204 Test Loss: 3.772 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5682151317596436
Epoch: 26, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.768 Vali Acc: 0.245 Test Loss: 3.768 Test Acc: 0.245
Validation loss decreased (-0.232906 --> -0.244668).  Saving model ...
Epoch: 27 cost time: 1.3422577381134033
Epoch: 27, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.883 Vali Acc: 0.222 Test Loss: 3.883 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3528063297271729
Epoch: 28, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.912 Vali Acc: 0.233 Test Loss: 3.912 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.374204397201538
Epoch: 29, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.001 Vali Acc: 0.239 Test Loss: 4.001 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4526102542877197
Epoch: 30, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.956 Vali Acc: 0.231 Test Loss: 3.956 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5026347637176514
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.065 Vali Acc: 0.239 Test Loss: 4.065 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4913709163665771
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.015 Vali Acc: 0.244 Test Loss: 4.015 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.469372034072876
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.037 Vali Acc: 0.242 Test Loss: 4.037 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.27724027633667
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.139 Vali Acc: 0.238 Test Loss: 4.139 Test Acc: 0.238
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6092407703399658
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.097 Vali Acc: 0.242 Test Loss: 4.097 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2661230564117432
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.100 Vali Acc: 0.247 Test Loss: 4.100 Test Acc: 0.247
Validation loss decreased (-0.244668 --> -0.247018).  Saving model ...
Epoch: 37 cost time: 1.5131328105926514
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.149 Vali Acc: 0.248 Test Loss: 4.149 Test Acc: 0.248
Validation loss decreased (-0.247018 --> -0.248194).  Saving model ...
Epoch: 38 cost time: 1.424640417098999
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.141 Vali Acc: 0.251 Test Loss: 4.141 Test Acc: 0.251
Validation loss decreased (-0.248194 --> -0.250547).  Saving model ...
Epoch: 39 cost time: 1.4606587886810303
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.175 Vali Acc: 0.249 Test Loss: 4.175 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2430291175842285
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.235 Vali Acc: 0.245 Test Loss: 4.235 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.315974473953247
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.236 Vali Acc: 0.247 Test Loss: 4.236 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4364004135131836
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.248 Vali Acc: 0.245 Test Loss: 4.248 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.169273853302002
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.236 Vali Acc: 0.246 Test Loss: 4.236 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5165114402770996
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.239 Vali Acc: 0.249 Test Loss: 4.239 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.3002023696899414
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.251 Vali Acc: 0.255 Test Loss: 4.251 Test Acc: 0.255
Validation loss decreased (-0.250547 --> -0.255252).  Saving model ...
Epoch: 46 cost time: 1.3717260360717773
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.289 Vali Acc: 0.244 Test Loss: 4.289 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2887678146362305
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.296 Vali Acc: 0.247 Test Loss: 4.296 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.3259787559509277
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.301 Vali Acc: 0.246 Test Loss: 4.301 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.21443772315979
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.338 Vali Acc: 0.249 Test Loss: 4.338 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.2712256908416748
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.333 Vali Acc: 0.249 Test Loss: 4.333 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.5819191932678223
Epoch: 51, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.349 Vali Acc: 0.252 Test Loss: 4.349 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.2121086120605469
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.373 Vali Acc: 0.252 Test Loss: 4.373 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.420698642730713
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.368 Vali Acc: 0.252 Test Loss: 4.368 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.3486182689666748
Epoch: 54, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.366 Vali Acc: 0.252 Test Loss: 4.366 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.4418110847473145
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.370 Vali Acc: 0.254 Test Loss: 4.370 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 2153546
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9313712120056152
Epoch: 1, Steps: 10 | Train Loss: 3.477 Vali Loss: 3.366 Vali Acc: 0.044 Test Loss: 3.366 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.4207096099853516
Epoch: 2, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.362 Vali Acc: 0.055 Test Loss: 3.362 Test Acc: 0.055
Validation loss decreased (-0.043496 --> -0.055260).  Saving model ...
Epoch: 3 cost time: 1.573507308959961
Epoch: 3, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.389 Vali Acc: 0.041 Test Loss: 3.389 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2483868598937988
Epoch: 4, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.330 Vali Acc: 0.062 Test Loss: 3.330 Test Acc: 0.062
Validation loss decreased (-0.055260 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 1.7509443759918213
Epoch: 5, Steps: 10 | Train Loss: 3.079 Vali Loss: 3.304 Vali Acc: 0.076 Test Loss: 3.304 Test Acc: 0.076
Validation loss decreased (-0.062320 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 1.3568916320800781
Epoch: 6, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.290 Vali Acc: 0.079 Test Loss: 3.290 Test Acc: 0.079
Validation loss decreased (-0.076438 --> -0.078791).  Saving model ...
Epoch: 7 cost time: 1.4491162300109863
Epoch: 7, Steps: 10 | Train Loss: 2.836 Vali Loss: 3.292 Vali Acc: 0.094 Test Loss: 3.292 Test Acc: 0.094
Validation loss decreased (-0.078791 --> -0.094085).  Saving model ...
Epoch: 8 cost time: 1.3681566715240479
Epoch: 8, Steps: 10 | Train Loss: 2.695 Vali Loss: 3.247 Vali Acc: 0.108 Test Loss: 3.247 Test Acc: 0.108
Validation loss decreased (-0.094085 --> -0.108203).  Saving model ...
Epoch: 9 cost time: 1.5803031921386719
Epoch: 9, Steps: 10 | Train Loss: 2.508 Vali Loss: 3.214 Vali Acc: 0.138 Test Loss: 3.214 Test Acc: 0.138
Validation loss decreased (-0.108203 --> -0.137615).  Saving model ...
Epoch: 10 cost time: 1.6501178741455078
Epoch: 10, Steps: 10 | Train Loss: 2.336 Vali Loss: 3.235 Vali Acc: 0.109 Test Loss: 3.235 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5569112300872803
Epoch: 11, Steps: 10 | Train Loss: 2.160 Vali Loss: 3.264 Vali Acc: 0.139 Test Loss: 3.264 Test Acc: 0.139
Validation loss decreased (-0.137615 --> -0.138791).  Saving model ...
Epoch: 12 cost time: 1.4543085098266602
Epoch: 12, Steps: 10 | Train Loss: 1.969 Vali Loss: 3.241 Vali Acc: 0.162 Test Loss: 3.241 Test Acc: 0.162
Validation loss decreased (-0.138791 --> -0.162321).  Saving model ...
Epoch: 13 cost time: 1.4246208667755127
Epoch: 13, Steps: 10 | Train Loss: 1.784 Vali Loss: 3.240 Vali Acc: 0.180 Test Loss: 3.240 Test Acc: 0.180
Validation loss decreased (-0.162321 --> -0.179968).  Saving model ...
Epoch: 14 cost time: 1.5960440635681152
Epoch: 14, Steps: 10 | Train Loss: 1.544 Vali Loss: 3.248 Vali Acc: 0.180 Test Loss: 3.248 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5622670650482178
Epoch: 15, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.291 Vali Acc: 0.192 Test Loss: 3.291 Test Acc: 0.192
Validation loss decreased (-0.179968 --> -0.191732).  Saving model ...
Epoch: 16 cost time: 1.6110165119171143
Epoch: 16, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.248 Vali Acc: 0.216 Test Loss: 3.248 Test Acc: 0.216
Validation loss decreased (-0.191732 --> -0.216438).  Saving model ...
Epoch: 17 cost time: 1.87770414352417
Epoch: 17, Steps: 10 | Train Loss: 1.046 Vali Loss: 3.341 Vali Acc: 0.218 Test Loss: 3.341 Test Acc: 0.218
Validation loss decreased (-0.216438 --> -0.217614).  Saving model ...
Epoch: 18 cost time: 1.5365190505981445
Epoch: 18, Steps: 10 | Train Loss: 0.900 Vali Loss: 3.297 Vali Acc: 0.236 Test Loss: 3.297 Test Acc: 0.236
Validation loss decreased (-0.217614 --> -0.236438).  Saving model ...
Epoch: 19 cost time: 1.519277811050415
Epoch: 19, Steps: 10 | Train Loss: 0.796 Vali Loss: 3.339 Vali Acc: 0.218 Test Loss: 3.339 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.698514461517334
Epoch: 20, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.390 Vali Acc: 0.233 Test Loss: 3.390 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.633082389831543
Epoch: 21, Steps: 10 | Train Loss: 0.526 Vali Loss: 3.443 Vali Acc: 0.245 Test Loss: 3.443 Test Acc: 0.245
Validation loss decreased (-0.236438 --> -0.244671).  Saving model ...
Epoch: 22 cost time: 1.4012458324432373
Epoch: 22, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.533 Vali Acc: 0.226 Test Loss: 3.533 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7321288585662842
Epoch: 23, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.571 Vali Acc: 0.239 Test Loss: 3.571 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6402921676635742
Epoch: 24, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.577 Vali Acc: 0.239 Test Loss: 3.577 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5655896663665771
Epoch: 25, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.775 Vali Acc: 0.232 Test Loss: 3.775 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5198113918304443
Epoch: 26, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.638 Vali Acc: 0.265 Test Loss: 3.638 Test Acc: 0.265
Validation loss decreased (-0.244671 --> -0.264670).  Saving model ...
Epoch: 27 cost time: 1.8340530395507812
Epoch: 27, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.833 Vali Acc: 0.244 Test Loss: 3.833 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.475480556488037
Epoch: 28, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.795 Vali Acc: 0.256 Test Loss: 3.795 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.04590106010437
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.789 Vali Acc: 0.271 Test Loss: 3.789 Test Acc: 0.271
Validation loss decreased (-0.264670 --> -0.270550).  Saving model ...
Epoch: 30 cost time: 1.374253273010254
Epoch: 30, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.880 Vali Acc: 0.267 Test Loss: 3.880 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7933354377746582
Epoch: 31, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.903 Vali Acc: 0.269 Test Loss: 3.903 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7544186115264893
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.911 Vali Acc: 0.258 Test Loss: 3.911 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4166090488433838
Epoch: 33, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.946 Vali Acc: 0.284 Test Loss: 3.946 Test Acc: 0.284
Validation loss decreased (-0.270550 --> -0.283490).  Saving model ...
Epoch: 34 cost time: 1.5465497970581055
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.959 Vali Acc: 0.279 Test Loss: 3.959 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.251983404159546
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.998 Vali Acc: 0.274 Test Loss: 3.998 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4195749759674072
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.012 Vali Acc: 0.292 Test Loss: 4.012 Test Acc: 0.292
Validation loss decreased (-0.283490 --> -0.291725).  Saving model ...
Epoch: 37 cost time: 1.250720500946045
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.010 Vali Acc: 0.280 Test Loss: 4.010 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4619784355163574
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.012 Vali Acc: 0.284 Test Loss: 4.012 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3901643753051758
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.054 Vali Acc: 0.285 Test Loss: 4.054 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.5297093391418457
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.051 Vali Acc: 0.279 Test Loss: 4.051 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.5106663703918457
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.104 Vali Acc: 0.282 Test Loss: 4.104 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4013864994049072
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.101 Vali Acc: 0.282 Test Loss: 4.101 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.4001867771148682
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.104 Vali Acc: 0.287 Test Loss: 4.104 Test Acc: 0.287
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.443603515625
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.118 Vali Acc: 0.286 Test Loss: 4.118 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.4380786418914795
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.143 Vali Acc: 0.288 Test Loss: 4.143 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.3595309257507324
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.165 Vali Acc: 0.288 Test Loss: 4.165 Test Acc: 0.288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2917647058823529
model parameter : 2150474
model size : 10.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9433577060699463
Epoch: 1, Steps: 10 | Train Loss: 3.464 Vali Loss: 3.338 Vali Acc: 0.041 Test Loss: 3.338 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.3419737815856934
Epoch: 2, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.371 Vali Acc: 0.042 Test Loss: 3.371 Test Acc: 0.042
Validation loss decreased (-0.041143 --> -0.042319).  Saving model ...
Epoch: 3 cost time: 1.4157533645629883
Epoch: 3, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.391 Vali Acc: 0.048 Test Loss: 3.391 Test Acc: 0.048
Validation loss decreased (-0.042319 --> -0.048201).  Saving model ...
Epoch: 4 cost time: 1.541837453842163
Epoch: 4, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.352 Vali Acc: 0.071 Test Loss: 3.352 Test Acc: 0.071
Validation loss decreased (-0.048201 --> -0.070555).  Saving model ...
Epoch: 5 cost time: 1.276071310043335
Epoch: 5, Steps: 10 | Train Loss: 3.031 Vali Loss: 3.322 Vali Acc: 0.075 Test Loss: 3.322 Test Acc: 0.075
Validation loss decreased (-0.070555 --> -0.075261).  Saving model ...
Epoch: 6 cost time: 1.2624952793121338
Epoch: 6, Steps: 10 | Train Loss: 2.944 Vali Loss: 3.268 Vali Acc: 0.088 Test Loss: 3.268 Test Acc: 0.088
Validation loss decreased (-0.075261 --> -0.088203).  Saving model ...
Epoch: 7 cost time: 1.2590446472167969
Epoch: 7, Steps: 10 | Train Loss: 2.874 Vali Loss: 3.300 Vali Acc: 0.092 Test Loss: 3.300 Test Acc: 0.092
Validation loss decreased (-0.088203 --> -0.091732).  Saving model ...
Epoch: 8 cost time: 1.366217851638794
Epoch: 8, Steps: 10 | Train Loss: 2.673 Vali Loss: 3.264 Vali Acc: 0.107 Test Loss: 3.264 Test Acc: 0.107
Validation loss decreased (-0.091732 --> -0.107026).  Saving model ...
Epoch: 9 cost time: 1.4383890628814697
Epoch: 9, Steps: 10 | Train Loss: 2.493 Vali Loss: 3.244 Vali Acc: 0.124 Test Loss: 3.244 Test Acc: 0.124
Validation loss decreased (-0.107026 --> -0.123497).  Saving model ...
Epoch: 10 cost time: 1.3150875568389893
Epoch: 10, Steps: 10 | Train Loss: 2.284 Vali Loss: 3.230 Vali Acc: 0.116 Test Loss: 3.230 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.302126169204712
Epoch: 11, Steps: 10 | Train Loss: 2.134 Vali Loss: 3.254 Vali Acc: 0.139 Test Loss: 3.254 Test Acc: 0.139
Validation loss decreased (-0.123497 --> -0.138791).  Saving model ...
Epoch: 12 cost time: 1.4591178894042969
Epoch: 12, Steps: 10 | Train Loss: 1.910 Vali Loss: 3.230 Vali Acc: 0.153 Test Loss: 3.230 Test Acc: 0.153
Validation loss decreased (-0.138791 --> -0.152909).  Saving model ...
Epoch: 13 cost time: 1.316056251525879
Epoch: 13, Steps: 10 | Train Loss: 1.783 Vali Loss: 3.248 Vali Acc: 0.189 Test Loss: 3.248 Test Acc: 0.189
Validation loss decreased (-0.152909 --> -0.189379).  Saving model ...
Epoch: 14 cost time: 1.2418186664581299
Epoch: 14, Steps: 10 | Train Loss: 1.568 Vali Loss: 3.238 Vali Acc: 0.175 Test Loss: 3.238 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.671248435974121
Epoch: 15, Steps: 10 | Train Loss: 1.420 Vali Loss: 3.266 Vali Acc: 0.194 Test Loss: 3.266 Test Acc: 0.194
Validation loss decreased (-0.189379 --> -0.194085).  Saving model ...
Epoch: 16 cost time: 1.290398120880127
Epoch: 16, Steps: 10 | Train Loss: 1.259 Vali Loss: 3.315 Vali Acc: 0.182 Test Loss: 3.315 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4428343772888184
Epoch: 17, Steps: 10 | Train Loss: 1.066 Vali Loss: 3.228 Vali Acc: 0.216 Test Loss: 3.228 Test Acc: 0.216
Validation loss decreased (-0.194085 --> -0.216438).  Saving model ...
Epoch: 18 cost time: 1.738809585571289
Epoch: 18, Steps: 10 | Train Loss: 0.904 Vali Loss: 3.325 Vali Acc: 0.205 Test Loss: 3.325 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5363075733184814
Epoch: 19, Steps: 10 | Train Loss: 0.726 Vali Loss: 3.295 Vali Acc: 0.226 Test Loss: 3.295 Test Acc: 0.226
Validation loss decreased (-0.216438 --> -0.225849).  Saving model ...
Epoch: 20 cost time: 1.270512580871582
Epoch: 20, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.443 Vali Acc: 0.205 Test Loss: 3.443 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3327887058258057
Epoch: 21, Steps: 10 | Train Loss: 0.521 Vali Loss: 3.420 Vali Acc: 0.229 Test Loss: 3.420 Test Acc: 0.229
Validation loss decreased (-0.225849 --> -0.229378).  Saving model ...
Epoch: 22 cost time: 1.1363658905029297
Epoch: 22, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.627 Vali Acc: 0.212 Test Loss: 3.627 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3313493728637695
Epoch: 23, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.497 Vali Acc: 0.235 Test Loss: 3.497 Test Acc: 0.235
Validation loss decreased (-0.229378 --> -0.235259).  Saving model ...
Epoch: 24 cost time: 1.2535767555236816
Epoch: 24, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.626 Vali Acc: 0.229 Test Loss: 3.626 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4297454357147217
Epoch: 25, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.546 Vali Acc: 0.232 Test Loss: 3.546 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3400931358337402
Epoch: 26, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.705 Vali Acc: 0.234 Test Loss: 3.705 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2470166683197021
Epoch: 27, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.713 Vali Acc: 0.228 Test Loss: 3.713 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.484262466430664
Epoch: 28, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.775 Vali Acc: 0.239 Test Loss: 3.775 Test Acc: 0.239
Validation loss decreased (-0.235259 --> -0.238786).  Saving model ...
Epoch: 29 cost time: 1.2398326396942139
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.774 Vali Acc: 0.249 Test Loss: 3.774 Test Acc: 0.249
Validation loss decreased (-0.238786 --> -0.249374).  Saving model ...
Epoch: 30 cost time: 1.2983722686767578
Epoch: 30, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.830 Vali Acc: 0.234 Test Loss: 3.830 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3695616722106934
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.875 Vali Acc: 0.248 Test Loss: 3.875 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2748680114746094
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.839 Vali Acc: 0.255 Test Loss: 3.839 Test Acc: 0.255
Validation loss decreased (-0.249374 --> -0.255256).  Saving model ...
Epoch: 33 cost time: 1.6132493019104004
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.888 Vali Acc: 0.261 Test Loss: 3.888 Test Acc: 0.261
Validation loss decreased (-0.255256 --> -0.261138).  Saving model ...
Epoch: 34 cost time: 1.3944478034973145
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.897 Vali Acc: 0.261 Test Loss: 3.897 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5222060680389404
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.954 Vali Acc: 0.262 Test Loss: 3.954 Test Acc: 0.262
Validation loss decreased (-0.261138 --> -0.262313).  Saving model ...
Epoch: 36 cost time: 1.373918056488037
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.956 Vali Acc: 0.258 Test Loss: 3.956 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2935967445373535
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.963 Vali Acc: 0.256 Test Loss: 3.963 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1428635120391846
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.984 Vali Acc: 0.256 Test Loss: 3.984 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.374772310256958
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.001 Vali Acc: 0.267 Test Loss: 4.001 Test Acc: 0.267
Validation loss decreased (-0.262313 --> -0.267019).  Saving model ...
Epoch: 40 cost time: 1.3014521598815918
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.024 Vali Acc: 0.260 Test Loss: 4.024 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3006083965301514
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.046 Vali Acc: 0.259 Test Loss: 4.046 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2137579917907715
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.053 Vali Acc: 0.261 Test Loss: 4.053 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3810744285583496
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.049 Vali Acc: 0.262 Test Loss: 4.049 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.3104705810546875
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.062 Vali Acc: 0.262 Test Loss: 4.062 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2912347316741943
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.081 Vali Acc: 0.264 Test Loss: 4.081 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.4488391876220703
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.099 Vali Acc: 0.266 Test Loss: 4.099 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.3922338485717773
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.118 Vali Acc: 0.265 Test Loss: 4.118 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.2574832439422607
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.127 Vali Acc: 0.256 Test Loss: 4.127 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.3019380569458008
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.134 Vali Acc: 0.260 Test Loss: 4.134 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 2147402
model size : 10.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.062410354614258
Epoch: 1, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.300 Vali Acc: 0.038 Test Loss: 3.300 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.3759987354278564
Epoch: 2, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.327 Vali Acc: 0.060 Test Loss: 3.327 Test Acc: 0.060
Validation loss decreased (-0.037614 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 1.3420498371124268
Epoch: 3, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.353 Vali Acc: 0.061 Test Loss: 3.353 Test Acc: 0.061
Validation loss decreased (-0.059967 --> -0.061143).  Saving model ...
Epoch: 4 cost time: 1.079519510269165
Epoch: 4, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.346 Vali Acc: 0.060 Test Loss: 3.346 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.716017484664917
Epoch: 5, Steps: 10 | Train Loss: 3.071 Vali Loss: 3.311 Vali Acc: 0.064 Test Loss: 3.311 Test Acc: 0.064
Validation loss decreased (-0.061143 --> -0.063496).  Saving model ...
Epoch: 6 cost time: 1.4420373439788818
Epoch: 6, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.279 Vali Acc: 0.076 Test Loss: 3.279 Test Acc: 0.076
Validation loss decreased (-0.063496 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 1.450016975402832
Epoch: 7, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.270 Vali Acc: 0.096 Test Loss: 3.270 Test Acc: 0.096
Validation loss decreased (-0.076438 --> -0.096438).  Saving model ...
Epoch: 8 cost time: 1.220116138458252
Epoch: 8, Steps: 10 | Train Loss: 2.846 Vali Loss: 3.299 Vali Acc: 0.071 Test Loss: 3.299 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3896000385284424
Epoch: 9, Steps: 10 | Train Loss: 2.675 Vali Loss: 3.259 Vali Acc: 0.107 Test Loss: 3.259 Test Acc: 0.107
Validation loss decreased (-0.096438 --> -0.107026).  Saving model ...
Epoch: 10 cost time: 1.229752779006958
Epoch: 10, Steps: 10 | Train Loss: 2.604 Vali Loss: 3.245 Vali Acc: 0.118 Test Loss: 3.245 Test Acc: 0.118
Validation loss decreased (-0.107026 --> -0.117615).  Saving model ...
Epoch: 11 cost time: 1.3480796813964844
Epoch: 11, Steps: 10 | Train Loss: 2.442 Vali Loss: 3.247 Vali Acc: 0.127 Test Loss: 3.247 Test Acc: 0.127
Validation loss decreased (-0.117615 --> -0.127026).  Saving model ...
Epoch: 12 cost time: 1.6294136047363281
Epoch: 12, Steps: 10 | Train Loss: 2.342 Vali Loss: 3.214 Vali Acc: 0.124 Test Loss: 3.214 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3335134983062744
Epoch: 13, Steps: 10 | Train Loss: 2.250 Vali Loss: 3.215 Vali Acc: 0.142 Test Loss: 3.215 Test Acc: 0.142
Validation loss decreased (-0.127026 --> -0.142321).  Saving model ...
Epoch: 14 cost time: 1.318392038345337
Epoch: 14, Steps: 10 | Train Loss: 2.086 Vali Loss: 3.196 Vali Acc: 0.134 Test Loss: 3.196 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4361248016357422
Epoch: 15, Steps: 10 | Train Loss: 1.975 Vali Loss: 3.173 Vali Acc: 0.140 Test Loss: 3.173 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1967082023620605
Epoch: 16, Steps: 10 | Train Loss: 1.778 Vali Loss: 3.174 Vali Acc: 0.179 Test Loss: 3.174 Test Acc: 0.179
Validation loss decreased (-0.142321 --> -0.178792).  Saving model ...
Epoch: 17 cost time: 1.339763879776001
Epoch: 17, Steps: 10 | Train Loss: 1.611 Vali Loss: 3.171 Vali Acc: 0.171 Test Loss: 3.171 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.457089900970459
Epoch: 18, Steps: 10 | Train Loss: 1.502 Vali Loss: 3.165 Vali Acc: 0.179 Test Loss: 3.165 Test Acc: 0.179
Validation loss decreased (-0.178792 --> -0.178792).  Saving model ...
Epoch: 19 cost time: 1.3587043285369873
Epoch: 19, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.166 Vali Acc: 0.185 Test Loss: 3.166 Test Acc: 0.185
Validation loss decreased (-0.178792 --> -0.184674).  Saving model ...
Epoch: 20 cost time: 1.5799658298492432
Epoch: 20, Steps: 10 | Train Loss: 1.233 Vali Loss: 3.161 Vali Acc: 0.187 Test Loss: 3.161 Test Acc: 0.187
Validation loss decreased (-0.184674 --> -0.187027).  Saving model ...
Epoch: 21 cost time: 1.5236775875091553
Epoch: 21, Steps: 10 | Train Loss: 1.170 Vali Loss: 3.254 Vali Acc: 0.202 Test Loss: 3.254 Test Acc: 0.202
Validation loss decreased (-0.187027 --> -0.202320).  Saving model ...
Epoch: 22 cost time: 1.5139567852020264
Epoch: 22, Steps: 10 | Train Loss: 1.093 Vali Loss: 3.176 Vali Acc: 0.204 Test Loss: 3.176 Test Acc: 0.204
Validation loss decreased (-0.202320 --> -0.203498).  Saving model ...
Epoch: 23 cost time: 1.3876631259918213
Epoch: 23, Steps: 10 | Train Loss: 0.973 Vali Loss: 3.251 Vali Acc: 0.204 Test Loss: 3.251 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2551331520080566
Epoch: 24, Steps: 10 | Train Loss: 0.832 Vali Loss: 3.208 Vali Acc: 0.213 Test Loss: 3.208 Test Acc: 0.213
Validation loss decreased (-0.203498 --> -0.212909).  Saving model ...
Epoch: 25 cost time: 1.3148131370544434
Epoch: 25, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.230 Vali Acc: 0.212 Test Loss: 3.230 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4382994174957275
Epoch: 26, Steps: 10 | Train Loss: 0.644 Vali Loss: 3.216 Vali Acc: 0.236 Test Loss: 3.216 Test Acc: 0.236
Validation loss decreased (-0.212909 --> -0.236438).  Saving model ...
Epoch: 27 cost time: 1.3081915378570557
Epoch: 27, Steps: 10 | Train Loss: 0.564 Vali Loss: 3.312 Vali Acc: 0.224 Test Loss: 3.312 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4054641723632812
Epoch: 28, Steps: 10 | Train Loss: 0.499 Vali Loss: 3.233 Vali Acc: 0.228 Test Loss: 3.233 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.327986717224121
Epoch: 29, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.387 Vali Acc: 0.206 Test Loss: 3.387 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2948527336120605
Epoch: 30, Steps: 10 | Train Loss: 0.333 Vali Loss: 3.339 Vali Acc: 0.248 Test Loss: 3.339 Test Acc: 0.248
Validation loss decreased (-0.236438 --> -0.248202).  Saving model ...
Epoch: 31 cost time: 1.307922601699829
Epoch: 31, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.458 Vali Acc: 0.195 Test Loss: 3.458 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2351419925689697
Epoch: 32, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.424 Vali Acc: 0.240 Test Loss: 3.424 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2675800323486328
Epoch: 33, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.457 Vali Acc: 0.245 Test Loss: 3.457 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3150949478149414
Epoch: 34, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.516 Vali Acc: 0.235 Test Loss: 3.516 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4501776695251465
Epoch: 35, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.521 Vali Acc: 0.232 Test Loss: 3.521 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.220384120941162
Epoch: 36, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.554 Vali Acc: 0.239 Test Loss: 3.554 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1966404914855957
Epoch: 37, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.537 Vali Acc: 0.233 Test Loss: 3.537 Test Acc: 0.233
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.290795087814331
Epoch: 38, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.603 Vali Acc: 0.252 Test Loss: 3.603 Test Acc: 0.252
Validation loss decreased (-0.248202 --> -0.251729).  Saving model ...
Epoch: 39 cost time: 1.4394276142120361
Epoch: 39, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.604 Vali Acc: 0.247 Test Loss: 3.604 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.142808198928833
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.601 Vali Acc: 0.245 Test Loss: 3.601 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1741328239440918
Epoch: 41, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.611 Vali Acc: 0.248 Test Loss: 3.611 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.3187508583068848
Epoch: 42, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.630 Vali Acc: 0.247 Test Loss: 3.630 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2838704586029053
Epoch: 43, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.638 Vali Acc: 0.258 Test Loss: 3.638 Test Acc: 0.258
Validation loss decreased (-0.251729 --> -0.257611).  Saving model ...
Epoch: 44 cost time: 1.2204604148864746
Epoch: 44, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.731 Vali Acc: 0.236 Test Loss: 3.731 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.159247875213623
Epoch: 45, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.679 Vali Acc: 0.242 Test Loss: 3.679 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1978306770324707
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.679 Vali Acc: 0.264 Test Loss: 3.679 Test Acc: 0.264
Validation loss decreased (-0.257611 --> -0.263493).  Saving model ...
Epoch: 47 cost time: 1.2038443088531494
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.728 Vali Acc: 0.245 Test Loss: 3.728 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3797667026519775
Epoch: 48, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.745 Vali Acc: 0.252 Test Loss: 3.745 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3029754161834717
Epoch: 49, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.743 Vali Acc: 0.255 Test Loss: 3.743 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.169804573059082
Epoch: 50, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.754 Vali Acc: 0.252 Test Loss: 3.754 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.4282279014587402
Epoch: 51, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.798 Vali Acc: 0.253 Test Loss: 3.798 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.3384020328521729
Epoch: 52, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.825 Vali Acc: 0.254 Test Loss: 3.825 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.3455824851989746
Epoch: 53, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.819 Vali Acc: 0.251 Test Loss: 3.819 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.2832534313201904
Epoch: 54, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.799 Vali Acc: 0.255 Test Loss: 3.799 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.2157244682312012
Epoch: 55, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.780 Vali Acc: 0.254 Test Loss: 3.780 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.2806966304779053
Epoch: 56, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.802 Vali Acc: 0.251 Test Loss: 3.802 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 1429130
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6411895751953125
Epoch: 1, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.419 Vali Acc: 0.040 Test Loss: 3.419 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 1.2982683181762695
Epoch: 2, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.368 Vali Acc: 0.056 Test Loss: 3.368 Test Acc: 0.056
Validation loss decreased (-0.039966 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 1.1883304119110107
Epoch: 3, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.349 Vali Acc: 0.041 Test Loss: 3.349 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4209301471710205
Epoch: 4, Steps: 10 | Train Loss: 3.194 Vali Loss: 3.336 Vali Acc: 0.060 Test Loss: 3.336 Test Acc: 0.060
Validation loss decreased (-0.056437 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 1.6044652462005615
Epoch: 5, Steps: 10 | Train Loss: 3.111 Vali Loss: 3.338 Vali Acc: 0.078 Test Loss: 3.338 Test Acc: 0.078
Validation loss decreased (-0.059967 --> -0.077614).  Saving model ...
Epoch: 6 cost time: 1.2970468997955322
Epoch: 6, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.328 Vali Acc: 0.067 Test Loss: 3.328 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.445730447769165
Epoch: 7, Steps: 10 | Train Loss: 2.929 Vali Loss: 3.286 Vali Acc: 0.087 Test Loss: 3.286 Test Acc: 0.087
Validation loss decreased (-0.077614 --> -0.087026).  Saving model ...
Epoch: 8 cost time: 1.5413575172424316
Epoch: 8, Steps: 10 | Train Loss: 2.832 Vali Loss: 3.263 Vali Acc: 0.106 Test Loss: 3.263 Test Acc: 0.106
Validation loss decreased (-0.087026 --> -0.105850).  Saving model ...
Epoch: 9 cost time: 1.8441057205200195
Epoch: 9, Steps: 10 | Train Loss: 2.784 Vali Loss: 3.305 Vali Acc: 0.113 Test Loss: 3.305 Test Acc: 0.113
Validation loss decreased (-0.105850 --> -0.112908).  Saving model ...
Epoch: 10 cost time: 1.6008601188659668
Epoch: 10, Steps: 10 | Train Loss: 2.599 Vali Loss: 3.228 Vali Acc: 0.131 Test Loss: 3.228 Test Acc: 0.131
Validation loss decreased (-0.112908 --> -0.130556).  Saving model ...
Epoch: 11 cost time: 1.3294172286987305
Epoch: 11, Steps: 10 | Train Loss: 2.479 Vali Loss: 3.225 Vali Acc: 0.125 Test Loss: 3.225 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.554849624633789
Epoch: 12, Steps: 10 | Train Loss: 2.340 Vali Loss: 3.251 Vali Acc: 0.136 Test Loss: 3.251 Test Acc: 0.136
Validation loss decreased (-0.130556 --> -0.136438).  Saving model ...
Epoch: 13 cost time: 1.5078861713409424
Epoch: 13, Steps: 10 | Train Loss: 2.188 Vali Loss: 3.218 Vali Acc: 0.168 Test Loss: 3.218 Test Acc: 0.168
Validation loss decreased (-0.136438 --> -0.168203).  Saving model ...
Epoch: 14 cost time: 1.2946786880493164
Epoch: 14, Steps: 10 | Train Loss: 2.144 Vali Loss: 3.201 Vali Acc: 0.142 Test Loss: 3.201 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7237334251403809
Epoch: 15, Steps: 10 | Train Loss: 1.926 Vali Loss: 3.221 Vali Acc: 0.162 Test Loss: 3.221 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.529374122619629
Epoch: 16, Steps: 10 | Train Loss: 1.837 Vali Loss: 3.199 Vali Acc: 0.160 Test Loss: 3.199 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7093863487243652
Epoch: 17, Steps: 10 | Train Loss: 1.641 Vali Loss: 3.169 Vali Acc: 0.180 Test Loss: 3.169 Test Acc: 0.180
Validation loss decreased (-0.168203 --> -0.179968).  Saving model ...
Epoch: 18 cost time: 1.6706202030181885
Epoch: 18, Steps: 10 | Train Loss: 1.536 Vali Loss: 3.162 Vali Acc: 0.179 Test Loss: 3.162 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4267258644104004
Epoch: 19, Steps: 10 | Train Loss: 1.380 Vali Loss: 3.214 Vali Acc: 0.176 Test Loss: 3.214 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2723288536071777
Epoch: 20, Steps: 10 | Train Loss: 1.319 Vali Loss: 3.194 Vali Acc: 0.181 Test Loss: 3.194 Test Acc: 0.181
Validation loss decreased (-0.179968 --> -0.181145).  Saving model ...
Epoch: 21 cost time: 1.2314152717590332
Epoch: 21, Steps: 10 | Train Loss: 1.169 Vali Loss: 3.231 Vali Acc: 0.193 Test Loss: 3.231 Test Acc: 0.193
Validation loss decreased (-0.181145 --> -0.192909).  Saving model ...
Epoch: 22 cost time: 1.5259408950805664
Epoch: 22, Steps: 10 | Train Loss: 1.069 Vali Loss: 3.181 Vali Acc: 0.188 Test Loss: 3.181 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3511600494384766
Epoch: 23, Steps: 10 | Train Loss: 0.946 Vali Loss: 3.255 Vali Acc: 0.198 Test Loss: 3.255 Test Acc: 0.198
Validation loss decreased (-0.192909 --> -0.197615).  Saving model ...
Epoch: 24 cost time: 1.3025920391082764
Epoch: 24, Steps: 10 | Train Loss: 0.815 Vali Loss: 3.202 Vali Acc: 0.202 Test Loss: 3.202 Test Acc: 0.202
Validation loss decreased (-0.197615 --> -0.202321).  Saving model ...
Epoch: 25 cost time: 1.3070614337921143
Epoch: 25, Steps: 10 | Train Loss: 0.762 Vali Loss: 3.232 Vali Acc: 0.211 Test Loss: 3.232 Test Acc: 0.211
Validation loss decreased (-0.202321 --> -0.210556).  Saving model ...
Epoch: 26 cost time: 1.4834883213043213
Epoch: 26, Steps: 10 | Train Loss: 0.633 Vali Loss: 3.219 Vali Acc: 0.218 Test Loss: 3.219 Test Acc: 0.218
Validation loss decreased (-0.210556 --> -0.217615).  Saving model ...
Epoch: 27 cost time: 1.5472526550292969
Epoch: 27, Steps: 10 | Train Loss: 0.542 Vali Loss: 3.316 Vali Acc: 0.213 Test Loss: 3.316 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2878634929656982
Epoch: 28, Steps: 10 | Train Loss: 0.459 Vali Loss: 3.316 Vali Acc: 0.199 Test Loss: 3.316 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.586538314819336
Epoch: 29, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.441 Vali Acc: 0.212 Test Loss: 3.441 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7768347263336182
Epoch: 30, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.362 Vali Acc: 0.225 Test Loss: 3.362 Test Acc: 0.225
Validation loss decreased (-0.217615 --> -0.224672).  Saving model ...
Epoch: 31 cost time: 1.3891844749450684
Epoch: 31, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.457 Vali Acc: 0.219 Test Loss: 3.457 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2977709770202637
Epoch: 32, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.431 Vali Acc: 0.232 Test Loss: 3.431 Test Acc: 0.232
Validation loss decreased (-0.224672 --> -0.231730).  Saving model ...
Epoch: 33 cost time: 1.6290407180786133
Epoch: 33, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.432 Vali Acc: 0.224 Test Loss: 3.432 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.36440110206604
Epoch: 34, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.452 Vali Acc: 0.239 Test Loss: 3.452 Test Acc: 0.239
Validation loss decreased (-0.231730 --> -0.238789).  Saving model ...
Epoch: 35 cost time: 1.3971688747406006
Epoch: 35, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.567 Vali Acc: 0.222 Test Loss: 3.567 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.489090919494629
Epoch: 36, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.515 Vali Acc: 0.246 Test Loss: 3.515 Test Acc: 0.246
Validation loss decreased (-0.238789 --> -0.245847).  Saving model ...
Epoch: 37 cost time: 1.4083843231201172
Epoch: 37, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.611 Vali Acc: 0.246 Test Loss: 3.611 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4395174980163574
Epoch: 38, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.601 Vali Acc: 0.256 Test Loss: 3.601 Test Acc: 0.256
Validation loss decreased (-0.245847 --> -0.256435).  Saving model ...
Epoch: 39 cost time: 1.6410942077636719
Epoch: 39, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.580 Vali Acc: 0.245 Test Loss: 3.580 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.458526611328125
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.634 Vali Acc: 0.252 Test Loss: 3.634 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4710302352905273
Epoch: 41, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.691 Vali Acc: 0.238 Test Loss: 3.691 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5333161354064941
Epoch: 42, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.668 Vali Acc: 0.251 Test Loss: 3.668 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.4786956310272217
Epoch: 43, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.659 Vali Acc: 0.256 Test Loss: 3.659 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.329685926437378
Epoch: 44, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.693 Vali Acc: 0.259 Test Loss: 3.693 Test Acc: 0.259
Validation loss decreased (-0.256435 --> -0.258787).  Saving model ...
Epoch: 45 cost time: 1.5323312282562256
Epoch: 45, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.724 Vali Acc: 0.255 Test Loss: 3.724 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.3365669250488281
Epoch: 46, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.733 Vali Acc: 0.256 Test Loss: 3.733 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.7453198432922363
Epoch: 47, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.751 Vali Acc: 0.254 Test Loss: 3.751 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.6864056587219238
Epoch: 48, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.749 Vali Acc: 0.256 Test Loss: 3.749 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.5430285930633545
Epoch: 49, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.759 Vali Acc: 0.254 Test Loss: 3.759 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.5356338024139404
Epoch: 50, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.771 Vali Acc: 0.266 Test Loss: 3.771 Test Acc: 0.266
Validation loss decreased (-0.258787 --> -0.265845).  Saving model ...
Epoch: 51 cost time: 1.5183396339416504
Epoch: 51, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.788 Vali Acc: 0.254 Test Loss: 3.788 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3550355434417725
Epoch: 52, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.824 Vali Acc: 0.258 Test Loss: 3.824 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.251063585281372
Epoch: 53, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.824 Vali Acc: 0.256 Test Loss: 3.824 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.5776267051696777
Epoch: 54, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.823 Vali Acc: 0.262 Test Loss: 3.823 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.3140311241149902
Epoch: 55, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.826 Vali Acc: 0.255 Test Loss: 3.826 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.3418941497802734
Epoch: 56, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.830 Vali Acc: 0.261 Test Loss: 3.830 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.8434443473815918
Epoch: 57, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.852 Vali Acc: 0.261 Test Loss: 3.852 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.7798631191253662
Epoch: 58, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.837 Vali Acc: 0.264 Test Loss: 3.837 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.5269606113433838
Epoch: 59, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.869 Vali Acc: 0.258 Test Loss: 3.869 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.4941396713256836
Epoch: 60, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.860 Vali Acc: 0.261 Test Loss: 3.860 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 1427594
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8994300365448
Epoch: 1, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.367 Vali Acc: 0.036 Test Loss: 3.367 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.306166648864746
Epoch: 2, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.340 Vali Acc: 0.056 Test Loss: 3.340 Test Acc: 0.056
Validation loss decreased (-0.036437 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 1.4382789134979248
Epoch: 3, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.348 Vali Acc: 0.065 Test Loss: 3.348 Test Acc: 0.065
Validation loss decreased (-0.056437 --> -0.064672).  Saving model ...
Epoch: 4 cost time: 1.4015722274780273
Epoch: 4, Steps: 10 | Train Loss: 3.119 Vali Loss: 3.331 Vali Acc: 0.064 Test Loss: 3.331 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3387460708618164
Epoch: 5, Steps: 10 | Train Loss: 3.071 Vali Loss: 3.338 Vali Acc: 0.076 Test Loss: 3.338 Test Acc: 0.076
Validation loss decreased (-0.064672 --> -0.076437).  Saving model ...
Epoch: 6 cost time: 1.2869296073913574
Epoch: 6, Steps: 10 | Train Loss: 2.957 Vali Loss: 3.329 Vali Acc: 0.081 Test Loss: 3.329 Test Acc: 0.081
Validation loss decreased (-0.076437 --> -0.081143).  Saving model ...
Epoch: 7 cost time: 1.3116707801818848
Epoch: 7, Steps: 10 | Train Loss: 2.874 Vali Loss: 3.277 Vali Acc: 0.096 Test Loss: 3.277 Test Acc: 0.096
Validation loss decreased (-0.081143 --> -0.096438).  Saving model ...
Epoch: 8 cost time: 1.090261697769165
Epoch: 8, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.298 Vali Acc: 0.106 Test Loss: 3.298 Test Acc: 0.106
Validation loss decreased (-0.096438 --> -0.105849).  Saving model ...
Epoch: 9 cost time: 1.1951487064361572
Epoch: 9, Steps: 10 | Train Loss: 2.690 Vali Loss: 3.281 Vali Acc: 0.108 Test Loss: 3.281 Test Acc: 0.108
Validation loss decreased (-0.105849 --> -0.108202).  Saving model ...
Epoch: 10 cost time: 1.3143117427825928
Epoch: 10, Steps: 10 | Train Loss: 2.507 Vali Loss: 3.298 Vali Acc: 0.114 Test Loss: 3.298 Test Acc: 0.114
Validation loss decreased (-0.108202 --> -0.114085).  Saving model ...
Epoch: 11 cost time: 1.2564027309417725
Epoch: 11, Steps: 10 | Train Loss: 2.368 Vali Loss: 3.256 Vali Acc: 0.128 Test Loss: 3.256 Test Acc: 0.128
Validation loss decreased (-0.114085 --> -0.128203).  Saving model ...
Epoch: 12 cost time: 1.2764084339141846
Epoch: 12, Steps: 10 | Train Loss: 2.220 Vali Loss: 3.268 Vali Acc: 0.127 Test Loss: 3.268 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2069385051727295
Epoch: 13, Steps: 10 | Train Loss: 2.131 Vali Loss: 3.217 Vali Acc: 0.147 Test Loss: 3.217 Test Acc: 0.147
Validation loss decreased (-0.128203 --> -0.147027).  Saving model ...
Epoch: 14 cost time: 1.1780929565429688
Epoch: 14, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.280 Vali Acc: 0.144 Test Loss: 3.280 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2140893936157227
Epoch: 15, Steps: 10 | Train Loss: 1.914 Vali Loss: 3.234 Vali Acc: 0.151 Test Loss: 3.234 Test Acc: 0.151
Validation loss decreased (-0.147027 --> -0.150556).  Saving model ...
Epoch: 16 cost time: 1.0598649978637695
Epoch: 16, Steps: 10 | Train Loss: 1.762 Vali Loss: 3.254 Vali Acc: 0.152 Test Loss: 3.254 Test Acc: 0.152
Validation loss decreased (-0.150556 --> -0.151732).  Saving model ...
Epoch: 17 cost time: 1.3721818923950195
Epoch: 17, Steps: 10 | Train Loss: 1.624 Vali Loss: 3.231 Vali Acc: 0.159 Test Loss: 3.231 Test Acc: 0.159
Validation loss decreased (-0.151732 --> -0.158791).  Saving model ...
Epoch: 18 cost time: 1.4611032009124756
Epoch: 18, Steps: 10 | Train Loss: 1.521 Vali Loss: 3.246 Vali Acc: 0.186 Test Loss: 3.246 Test Acc: 0.186
Validation loss decreased (-0.158791 --> -0.185850).  Saving model ...
Epoch: 19 cost time: 1.3495218753814697
Epoch: 19, Steps: 10 | Train Loss: 1.359 Vali Loss: 3.251 Vali Acc: 0.166 Test Loss: 3.251 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2705621719360352
Epoch: 20, Steps: 10 | Train Loss: 1.261 Vali Loss: 3.254 Vali Acc: 0.171 Test Loss: 3.254 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3556745052337646
Epoch: 21, Steps: 10 | Train Loss: 1.161 Vali Loss: 3.261 Vali Acc: 0.181 Test Loss: 3.261 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3440721035003662
Epoch: 22, Steps: 10 | Train Loss: 1.065 Vali Loss: 3.281 Vali Acc: 0.191 Test Loss: 3.281 Test Acc: 0.191
Validation loss decreased (-0.185850 --> -0.190555).  Saving model ...
Epoch: 23 cost time: 1.1458871364593506
Epoch: 23, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.258 Vali Acc: 0.206 Test Loss: 3.258 Test Acc: 0.206
Validation loss decreased (-0.190555 --> -0.205850).  Saving model ...
Epoch: 24 cost time: 1.1833148002624512
Epoch: 24, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.318 Vali Acc: 0.208 Test Loss: 3.318 Test Acc: 0.208
Validation loss decreased (-0.205850 --> -0.208202).  Saving model ...
Epoch: 25 cost time: 1.2233598232269287
Epoch: 25, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.336 Vali Acc: 0.212 Test Loss: 3.336 Test Acc: 0.212
Validation loss decreased (-0.208202 --> -0.211731).  Saving model ...
Epoch: 26 cost time: 1.272411823272705
Epoch: 26, Steps: 10 | Train Loss: 0.676 Vali Loss: 3.327 Vali Acc: 0.205 Test Loss: 3.327 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2506344318389893
Epoch: 27, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.351 Vali Acc: 0.213 Test Loss: 3.351 Test Acc: 0.213
Validation loss decreased (-0.211731 --> -0.212908).  Saving model ...
Epoch: 28 cost time: 1.3838996887207031
Epoch: 28, Steps: 10 | Train Loss: 0.457 Vali Loss: 3.329 Vali Acc: 0.231 Test Loss: 3.329 Test Acc: 0.231
Validation loss decreased (-0.212908 --> -0.230555).  Saving model ...
Epoch: 29 cost time: 1.222470760345459
Epoch: 29, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.381 Vali Acc: 0.219 Test Loss: 3.381 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2704575061798096
Epoch: 30, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.573 Vali Acc: 0.215 Test Loss: 3.573 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2978742122650146
Epoch: 31, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.432 Vali Acc: 0.228 Test Loss: 3.432 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2930054664611816
Epoch: 32, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.533 Vali Acc: 0.218 Test Loss: 3.533 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1844029426574707
Epoch: 33, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.526 Vali Acc: 0.231 Test Loss: 3.526 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2156031131744385
Epoch: 34, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.492 Vali Acc: 0.236 Test Loss: 3.492 Test Acc: 0.236
Validation loss decreased (-0.230555 --> -0.236436).  Saving model ...
Epoch: 35 cost time: 1.1240808963775635
Epoch: 35, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.571 Vali Acc: 0.246 Test Loss: 3.571 Test Acc: 0.246
Validation loss decreased (-0.236436 --> -0.245847).  Saving model ...
Epoch: 36 cost time: 1.3394434452056885
Epoch: 36, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.573 Vali Acc: 0.240 Test Loss: 3.573 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.152256965637207
Epoch: 37, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.686 Vali Acc: 0.234 Test Loss: 3.686 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3952701091766357
Epoch: 38, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.629 Vali Acc: 0.242 Test Loss: 3.629 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4565272331237793
Epoch: 39, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.675 Vali Acc: 0.238 Test Loss: 3.675 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.451340675354004
Epoch: 40, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.685 Vali Acc: 0.248 Test Loss: 3.685 Test Acc: 0.248
Validation loss decreased (-0.245847 --> -0.248198).  Saving model ...
Epoch: 41 cost time: 1.6788814067840576
Epoch: 41, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.701 Vali Acc: 0.241 Test Loss: 3.701 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3995857238769531
Epoch: 42, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.802 Vali Acc: 0.247 Test Loss: 3.802 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.415102243423462
Epoch: 43, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.733 Vali Acc: 0.254 Test Loss: 3.733 Test Acc: 0.254
Validation loss decreased (-0.248198 --> -0.254080).  Saving model ...
Epoch: 44 cost time: 1.4673357009887695
Epoch: 44, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.791 Vali Acc: 0.248 Test Loss: 3.791 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3177642822265625
Epoch: 45, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.731 Vali Acc: 0.245 Test Loss: 3.731 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6314351558685303
Epoch: 46, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.841 Vali Acc: 0.247 Test Loss: 3.841 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.4645700454711914
Epoch: 47, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.831 Vali Acc: 0.254 Test Loss: 3.831 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.4317538738250732
Epoch: 48, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.860 Vali Acc: 0.249 Test Loss: 3.860 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3104708194732666
Epoch: 49, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.830 Vali Acc: 0.254 Test Loss: 3.830 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.3572404384613037
Epoch: 50, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.872 Vali Acc: 0.251 Test Loss: 3.872 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.2583415508270264
Epoch: 51, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.900 Vali Acc: 0.247 Test Loss: 3.900 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.286332368850708
Epoch: 52, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.897 Vali Acc: 0.245 Test Loss: 3.897 Test Acc: 0.245
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.446946144104004
Epoch: 53, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.913 Vali Acc: 0.244 Test Loss: 3.913 Test Acc: 0.244
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 1426058
model size : 6.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9620258808135986
Epoch: 1, Steps: 10 | Train Loss: 3.498 Vali Loss: 3.406 Vali Acc: 0.031 Test Loss: 3.406 Test Acc: 0.031
Validation loss decreased (inf --> -0.030554).  Saving model ...
Epoch: 2 cost time: 1.4910528659820557
Epoch: 2, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.336 Vali Acc: 0.056 Test Loss: 3.336 Test Acc: 0.056
Validation loss decreased (-0.030554 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 1.449124813079834
Epoch: 3, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.387 Vali Acc: 0.067 Test Loss: 3.387 Test Acc: 0.067
Validation loss decreased (-0.056437 --> -0.067025).  Saving model ...
Epoch: 4 cost time: 1.3347790241241455
Epoch: 4, Steps: 10 | Train Loss: 3.179 Vali Loss: 3.340 Vali Acc: 0.079 Test Loss: 3.340 Test Acc: 0.079
Validation loss decreased (-0.067025 --> -0.078790).  Saving model ...
Epoch: 5 cost time: 1.4183051586151123
Epoch: 5, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.299 Vali Acc: 0.074 Test Loss: 3.299 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2539401054382324
Epoch: 6, Steps: 10 | Train Loss: 3.013 Vali Loss: 3.292 Vali Acc: 0.076 Test Loss: 3.292 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3925375938415527
Epoch: 7, Steps: 10 | Train Loss: 2.941 Vali Loss: 3.300 Vali Acc: 0.076 Test Loss: 3.300 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.339160680770874
Epoch: 8, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.301 Vali Acc: 0.096 Test Loss: 3.301 Test Acc: 0.096
Validation loss decreased (-0.078790 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 1.4336307048797607
Epoch: 9, Steps: 10 | Train Loss: 2.727 Vali Loss: 3.241 Vali Acc: 0.104 Test Loss: 3.241 Test Acc: 0.104
Validation loss decreased (-0.096438 --> -0.103497).  Saving model ...
Epoch: 10 cost time: 1.191507339477539
Epoch: 10, Steps: 10 | Train Loss: 2.558 Vali Loss: 3.276 Vali Acc: 0.095 Test Loss: 3.276 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2693283557891846
Epoch: 11, Steps: 10 | Train Loss: 2.472 Vali Loss: 3.245 Vali Acc: 0.128 Test Loss: 3.245 Test Acc: 0.128
Validation loss decreased (-0.103497 --> -0.128203).  Saving model ...
Epoch: 12 cost time: 1.22123122215271
Epoch: 12, Steps: 10 | Train Loss: 2.287 Vali Loss: 3.247 Vali Acc: 0.126 Test Loss: 3.247 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3581490516662598
Epoch: 13, Steps: 10 | Train Loss: 2.152 Vali Loss: 3.221 Vali Acc: 0.136 Test Loss: 3.221 Test Acc: 0.136
Validation loss decreased (-0.128203 --> -0.136438).  Saving model ...
Epoch: 14 cost time: 1.4381043910980225
Epoch: 14, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.196 Vali Acc: 0.149 Test Loss: 3.196 Test Acc: 0.149
Validation loss decreased (-0.136438 --> -0.149380).  Saving model ...
Epoch: 15 cost time: 1.194115161895752
Epoch: 15, Steps: 10 | Train Loss: 1.890 Vali Loss: 3.232 Vali Acc: 0.138 Test Loss: 3.232 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4006292819976807
Epoch: 16, Steps: 10 | Train Loss: 1.754 Vali Loss: 3.172 Vali Acc: 0.187 Test Loss: 3.172 Test Acc: 0.187
Validation loss decreased (-0.149380 --> -0.187027).  Saving model ...
Epoch: 17 cost time: 1.2825026512145996
Epoch: 17, Steps: 10 | Train Loss: 1.605 Vali Loss: 3.251 Vali Acc: 0.162 Test Loss: 3.251 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.379019021987915
Epoch: 18, Steps: 10 | Train Loss: 1.496 Vali Loss: 3.170 Vali Acc: 0.187 Test Loss: 3.170 Test Acc: 0.187
Validation loss decreased (-0.187027 --> -0.187027).  Saving model ...
Epoch: 19 cost time: 1.135077714920044
Epoch: 19, Steps: 10 | Train Loss: 1.376 Vali Loss: 3.180 Vali Acc: 0.193 Test Loss: 3.180 Test Acc: 0.193
Validation loss decreased (-0.187027 --> -0.192909).  Saving model ...
Epoch: 20 cost time: 1.371166467666626
Epoch: 20, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.183 Vali Acc: 0.196 Test Loss: 3.183 Test Acc: 0.196
Validation loss decreased (-0.192909 --> -0.196439).  Saving model ...
Epoch: 21 cost time: 1.4017553329467773
Epoch: 21, Steps: 10 | Train Loss: 1.140 Vali Loss: 3.204 Vali Acc: 0.198 Test Loss: 3.204 Test Acc: 0.198
Validation loss decreased (-0.196439 --> -0.197615).  Saving model ...
Epoch: 22 cost time: 1.4841699600219727
Epoch: 22, Steps: 10 | Train Loss: 1.116 Vali Loss: 3.196 Vali Acc: 0.213 Test Loss: 3.196 Test Acc: 0.213
Validation loss decreased (-0.197615 --> -0.212909).  Saving model ...
Epoch: 23 cost time: 1.183699131011963
Epoch: 23, Steps: 10 | Train Loss: 0.934 Vali Loss: 3.232 Vali Acc: 0.218 Test Loss: 3.232 Test Acc: 0.218
Validation loss decreased (-0.212909 --> -0.217615).  Saving model ...
Epoch: 24 cost time: 1.3643276691436768
Epoch: 24, Steps: 10 | Train Loss: 0.834 Vali Loss: 3.200 Vali Acc: 0.212 Test Loss: 3.200 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4550933837890625
Epoch: 25, Steps: 10 | Train Loss: 0.714 Vali Loss: 3.248 Vali Acc: 0.224 Test Loss: 3.248 Test Acc: 0.224
Validation loss decreased (-0.217615 --> -0.223497).  Saving model ...
Epoch: 26 cost time: 1.5649306774139404
Epoch: 26, Steps: 10 | Train Loss: 0.582 Vali Loss: 3.283 Vali Acc: 0.211 Test Loss: 3.283 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.375929832458496
Epoch: 27, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.345 Vali Acc: 0.221 Test Loss: 3.345 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5245561599731445
Epoch: 28, Steps: 10 | Train Loss: 0.466 Vali Loss: 3.300 Vali Acc: 0.218 Test Loss: 3.300 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3014438152313232
Epoch: 29, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.353 Vali Acc: 0.232 Test Loss: 3.353 Test Acc: 0.232
Validation loss decreased (-0.223497 --> -0.231731).  Saving model ...
Epoch: 30 cost time: 1.3101341724395752
Epoch: 30, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.375 Vali Acc: 0.228 Test Loss: 3.375 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.151322841644287
Epoch: 31, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.449 Vali Acc: 0.236 Test Loss: 3.449 Test Acc: 0.236
Validation loss decreased (-0.231731 --> -0.236436).  Saving model ...
Epoch: 32 cost time: 1.3168387413024902
Epoch: 32, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.430 Vali Acc: 0.232 Test Loss: 3.430 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1036453247070312
Epoch: 33, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.417 Vali Acc: 0.242 Test Loss: 3.417 Test Acc: 0.242
Validation loss decreased (-0.236436 --> -0.242319).  Saving model ...
Epoch: 34 cost time: 1.2791552543640137
Epoch: 34, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.430 Vali Acc: 0.256 Test Loss: 3.430 Test Acc: 0.256
Validation loss decreased (-0.242319 --> -0.256436).  Saving model ...
Epoch: 35 cost time: 1.1186318397521973
Epoch: 35, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.418 Vali Acc: 0.244 Test Loss: 3.418 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6259477138519287
Epoch: 36, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.503 Vali Acc: 0.238 Test Loss: 3.503 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4226102828979492
Epoch: 37, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.518 Vali Acc: 0.253 Test Loss: 3.518 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.201054573059082
Epoch: 38, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.563 Vali Acc: 0.247 Test Loss: 3.563 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2829840183258057
Epoch: 39, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.524 Vali Acc: 0.251 Test Loss: 3.524 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.3351609706878662
Epoch: 40, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.578 Vali Acc: 0.242 Test Loss: 3.578 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.5226545333862305
Epoch: 41, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.585 Vali Acc: 0.258 Test Loss: 3.585 Test Acc: 0.258
Validation loss decreased (-0.256436 --> -0.257611).  Saving model ...
Epoch: 42 cost time: 1.2792167663574219
Epoch: 42, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.609 Vali Acc: 0.249 Test Loss: 3.609 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3921053409576416
Epoch: 43, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.631 Vali Acc: 0.264 Test Loss: 3.631 Test Acc: 0.264
Validation loss decreased (-0.257611 --> -0.263493).  Saving model ...
Epoch: 44 cost time: 1.5004796981811523
Epoch: 44, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.650 Vali Acc: 0.264 Test Loss: 3.650 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.347883939743042
Epoch: 45, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.626 Vali Acc: 0.268 Test Loss: 3.626 Test Acc: 0.268
Validation loss decreased (-0.263493 --> -0.268199).  Saving model ...
Epoch: 46 cost time: 1.4805290699005127
Epoch: 46, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.698 Vali Acc: 0.261 Test Loss: 3.698 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.5426385402679443
Epoch: 47, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.683 Vali Acc: 0.269 Test Loss: 3.683 Test Acc: 0.269
Validation loss decreased (-0.268199 --> -0.269375).  Saving model ...
Epoch: 48 cost time: 1.2414495944976807
Epoch: 48, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.674 Vali Acc: 0.265 Test Loss: 3.674 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.4370312690734863
Epoch: 49, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.758 Vali Acc: 0.262 Test Loss: 3.758 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1902375221252441
Epoch: 50, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.711 Vali Acc: 0.273 Test Loss: 3.711 Test Acc: 0.273
Validation loss decreased (-0.269375 --> -0.272904).  Saving model ...
Epoch: 51 cost time: 1.1671028137207031
Epoch: 51, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.758 Vali Acc: 0.269 Test Loss: 3.758 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3118600845336914
Epoch: 52, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.707 Vali Acc: 0.274 Test Loss: 3.707 Test Acc: 0.274
Validation loss decreased (-0.272904 --> -0.274081).  Saving model ...
Epoch: 53 cost time: 1.326796054840088
Epoch: 53, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.734 Vali Acc: 0.266 Test Loss: 3.734 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.3015100955963135
Epoch: 54, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.760 Vali Acc: 0.269 Test Loss: 3.760 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.4360506534576416
Epoch: 55, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.795 Vali Acc: 0.268 Test Loss: 3.795 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.3625001907348633
Epoch: 56, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.744 Vali Acc: 0.275 Test Loss: 3.744 Test Acc: 0.275
Validation loss decreased (-0.274081 --> -0.275257).  Saving model ...
Epoch: 57 cost time: 1.6920583248138428
Epoch: 57, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.784 Vali Acc: 0.266 Test Loss: 3.784 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.2838826179504395
Epoch: 58, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.803 Vali Acc: 0.260 Test Loss: 3.803 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.266019582748413
Epoch: 59, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.833 Vali Acc: 0.266 Test Loss: 3.833 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.2871818542480469
Epoch: 60, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.805 Vali Acc: 0.267 Test Loss: 3.805 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.366947889328003
Epoch: 61, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.831 Vali Acc: 0.260 Test Loss: 3.831 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.521944522857666
Epoch: 62, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.826 Vali Acc: 0.269 Test Loss: 3.826 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.2642288208007812
Epoch: 63, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.862 Vali Acc: 0.269 Test Loss: 3.862 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.2606217861175537
Epoch: 64, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.851 Vali Acc: 0.269 Test Loss: 3.851 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.4420700073242188
Epoch: 65, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.847 Vali Acc: 0.271 Test Loss: 3.847 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.2653546333312988
Epoch: 66, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.861 Vali Acc: 0.269 Test Loss: 3.861 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 1424522
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.248704433441162
Epoch: 1, Steps: 10 | Train Loss: 3.332 Vali Loss: 3.320 Vali Acc: 0.024 Test Loss: 3.320 Test Acc: 0.024
Validation loss decreased (inf --> -0.023496).  Saving model ...
Epoch: 2 cost time: 1.3389320373535156
Epoch: 2, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.315 Vali Acc: 0.034 Test Loss: 3.315 Test Acc: 0.034
Validation loss decreased (-0.023496 --> -0.034084).  Saving model ...
Epoch: 3 cost time: 1.3277270793914795
Epoch: 3, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.357 Vali Acc: 0.052 Test Loss: 3.357 Test Acc: 0.052
Validation loss decreased (-0.034084 --> -0.051731).  Saving model ...
Epoch: 4 cost time: 1.2076268196105957
Epoch: 4, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.354 Vali Acc: 0.048 Test Loss: 3.354 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4168012142181396
Epoch: 5, Steps: 10 | Train Loss: 3.074 Vali Loss: 3.320 Vali Acc: 0.072 Test Loss: 3.320 Test Acc: 0.072
Validation loss decreased (-0.051731 --> -0.071732).  Saving model ...
Epoch: 6 cost time: 1.1970312595367432
Epoch: 6, Steps: 10 | Train Loss: 2.979 Vali Loss: 3.299 Vali Acc: 0.078 Test Loss: 3.299 Test Acc: 0.078
Validation loss decreased (-0.071732 --> -0.077614).  Saving model ...
Epoch: 7 cost time: 1.1957037448883057
Epoch: 7, Steps: 10 | Train Loss: 2.918 Vali Loss: 3.301 Vali Acc: 0.085 Test Loss: 3.301 Test Acc: 0.085
Validation loss decreased (-0.077614 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 1.294619083404541
Epoch: 8, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.268 Vali Acc: 0.101 Test Loss: 3.268 Test Acc: 0.101
Validation loss decreased (-0.084673 --> -0.101144).  Saving model ...
Epoch: 9 cost time: 1.6446356773376465
Epoch: 9, Steps: 10 | Train Loss: 2.708 Vali Loss: 3.271 Vali Acc: 0.101 Test Loss: 3.271 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1960690021514893
Epoch: 10, Steps: 10 | Train Loss: 2.621 Vali Loss: 3.262 Vali Acc: 0.112 Test Loss: 3.262 Test Acc: 0.112
Validation loss decreased (-0.101144 --> -0.111732).  Saving model ...
Epoch: 11 cost time: 1.4173729419708252
Epoch: 11, Steps: 10 | Train Loss: 2.488 Vali Loss: 3.234 Vali Acc: 0.120 Test Loss: 3.234 Test Acc: 0.120
Validation loss decreased (-0.111732 --> -0.119968).  Saving model ...
Epoch: 12 cost time: 1.2006423473358154
Epoch: 12, Steps: 10 | Train Loss: 2.340 Vali Loss: 3.238 Vali Acc: 0.113 Test Loss: 3.238 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4308383464813232
Epoch: 13, Steps: 10 | Train Loss: 2.232 Vali Loss: 3.209 Vali Acc: 0.131 Test Loss: 3.209 Test Acc: 0.131
Validation loss decreased (-0.119968 --> -0.130556).  Saving model ...
Epoch: 14 cost time: 1.5402555465698242
Epoch: 14, Steps: 10 | Train Loss: 2.088 Vali Loss: 3.223 Vali Acc: 0.132 Test Loss: 3.223 Test Acc: 0.132
Validation loss decreased (-0.130556 --> -0.131732).  Saving model ...
Epoch: 15 cost time: 1.522587776184082
Epoch: 15, Steps: 10 | Train Loss: 2.004 Vali Loss: 3.206 Vali Acc: 0.142 Test Loss: 3.206 Test Acc: 0.142
Validation loss decreased (-0.131732 --> -0.142321).  Saving model ...
Epoch: 16 cost time: 1.265031099319458
Epoch: 16, Steps: 10 | Train Loss: 1.848 Vali Loss: 3.203 Vali Acc: 0.160 Test Loss: 3.203 Test Acc: 0.160
Validation loss decreased (-0.142321 --> -0.159968).  Saving model ...
Epoch: 17 cost time: 1.5585978031158447
Epoch: 17, Steps: 10 | Train Loss: 1.740 Vali Loss: 3.194 Vali Acc: 0.155 Test Loss: 3.194 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5807783603668213
Epoch: 18, Steps: 10 | Train Loss: 1.640 Vali Loss: 3.211 Vali Acc: 0.166 Test Loss: 3.211 Test Acc: 0.166
Validation loss decreased (-0.159968 --> -0.165850).  Saving model ...
Epoch: 19 cost time: 1.3167731761932373
Epoch: 19, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.205 Vali Acc: 0.182 Test Loss: 3.205 Test Acc: 0.182
Validation loss decreased (-0.165850 --> -0.182321).  Saving model ...
Epoch: 20 cost time: 1.4276783466339111
Epoch: 20, Steps: 10 | Train Loss: 1.389 Vali Loss: 3.206 Vali Acc: 0.179 Test Loss: 3.206 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3794116973876953
Epoch: 21, Steps: 10 | Train Loss: 1.267 Vali Loss: 3.230 Vali Acc: 0.194 Test Loss: 3.230 Test Acc: 0.194
Validation loss decreased (-0.182321 --> -0.194085).  Saving model ...
Epoch: 22 cost time: 1.3857002258300781
Epoch: 22, Steps: 10 | Train Loss: 1.138 Vali Loss: 3.225 Vali Acc: 0.194 Test Loss: 3.225 Test Acc: 0.194
Validation loss decreased (-0.194085 --> -0.194085).  Saving model ...
Epoch: 23 cost time: 1.283275842666626
Epoch: 23, Steps: 10 | Train Loss: 1.125 Vali Loss: 3.241 Vali Acc: 0.208 Test Loss: 3.241 Test Acc: 0.208
Validation loss decreased (-0.194085 --> -0.208203).  Saving model ...
Epoch: 24 cost time: 1.304887056350708
Epoch: 24, Steps: 10 | Train Loss: 0.931 Vali Loss: 3.279 Vali Acc: 0.196 Test Loss: 3.279 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4257681369781494
Epoch: 25, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.223 Vali Acc: 0.211 Test Loss: 3.223 Test Acc: 0.211
Validation loss decreased (-0.208203 --> -0.210556).  Saving model ...
Epoch: 26 cost time: 1.366748571395874
Epoch: 26, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.258 Vali Acc: 0.229 Test Loss: 3.258 Test Acc: 0.229
Validation loss decreased (-0.210556 --> -0.229379).  Saving model ...
Epoch: 27 cost time: 1.3918180465698242
Epoch: 27, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.315 Vali Acc: 0.215 Test Loss: 3.315 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3740851879119873
Epoch: 28, Steps: 10 | Train Loss: 0.556 Vali Loss: 3.305 Vali Acc: 0.240 Test Loss: 3.305 Test Acc: 0.240
Validation loss decreased (-0.229379 --> -0.239967).  Saving model ...
Epoch: 29 cost time: 1.3034708499908447
Epoch: 29, Steps: 10 | Train Loss: 0.492 Vali Loss: 3.394 Vali Acc: 0.225 Test Loss: 3.394 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4979171752929688
Epoch: 30, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.410 Vali Acc: 0.228 Test Loss: 3.410 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1309902667999268
Epoch: 31, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.448 Vali Acc: 0.233 Test Loss: 3.448 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4012620449066162
Epoch: 32, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.526 Vali Acc: 0.215 Test Loss: 3.526 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3221862316131592
Epoch: 33, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.526 Vali Acc: 0.228 Test Loss: 3.526 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2432780265808105
Epoch: 34, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.519 Vali Acc: 0.228 Test Loss: 3.519 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.339939832687378
Epoch: 35, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.576 Vali Acc: 0.242 Test Loss: 3.576 Test Acc: 0.242
Validation loss decreased (-0.239967 --> -0.242317).  Saving model ...
Epoch: 36 cost time: 1.2848024368286133
Epoch: 36, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.577 Vali Acc: 0.242 Test Loss: 3.577 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2799217700958252
Epoch: 37, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.629 Vali Acc: 0.235 Test Loss: 3.629 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4951708316802979
Epoch: 38, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.653 Vali Acc: 0.239 Test Loss: 3.653 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4469521045684814
Epoch: 39, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.677 Vali Acc: 0.255 Test Loss: 3.677 Test Acc: 0.255
Validation loss decreased (-0.242317 --> -0.255257).  Saving model ...
Epoch: 40 cost time: 1.3737633228302002
Epoch: 40, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.703 Vali Acc: 0.245 Test Loss: 3.703 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2185053825378418
Epoch: 41, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.716 Vali Acc: 0.256 Test Loss: 3.716 Test Acc: 0.256
Validation loss decreased (-0.255257 --> -0.256433).  Saving model ...
Epoch: 42 cost time: 1.451188564300537
Epoch: 42, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.759 Vali Acc: 0.256 Test Loss: 3.759 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3182744979858398
Epoch: 43, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.774 Vali Acc: 0.258 Test Loss: 3.774 Test Acc: 0.258
Validation loss decreased (-0.256433 --> -0.257609).  Saving model ...
Epoch: 44 cost time: 1.3318839073181152
Epoch: 44, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.761 Vali Acc: 0.256 Test Loss: 3.761 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2934279441833496
Epoch: 45, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.813 Vali Acc: 0.261 Test Loss: 3.813 Test Acc: 0.261
Validation loss decreased (-0.257609 --> -0.261138).  Saving model ...
Epoch: 46 cost time: 1.4034459590911865
Epoch: 46, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.826 Vali Acc: 0.261 Test Loss: 3.826 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.6293838024139404
Epoch: 47, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.814 Vali Acc: 0.266 Test Loss: 3.814 Test Acc: 0.266
Validation loss decreased (-0.261138 --> -0.265844).  Saving model ...
Epoch: 48 cost time: 1.2996797561645508
Epoch: 48, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.864 Vali Acc: 0.266 Test Loss: 3.864 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.3158354759216309
Epoch: 49, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.858 Vali Acc: 0.261 Test Loss: 3.858 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3405566215515137
Epoch: 50, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.855 Vali Acc: 0.255 Test Loss: 3.855 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.5825841426849365
Epoch: 51, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.883 Vali Acc: 0.264 Test Loss: 3.883 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.4870166778564453
Epoch: 52, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.907 Vali Acc: 0.265 Test Loss: 3.907 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.3384556770324707
Epoch: 53, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.903 Vali Acc: 0.267 Test Loss: 3.903 Test Acc: 0.267
Validation loss decreased (-0.265844 --> -0.267020).  Saving model ...
Epoch: 54 cost time: 1.5601770877838135
Epoch: 54, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.940 Vali Acc: 0.265 Test Loss: 3.940 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.4810843467712402
Epoch: 55, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.945 Vali Acc: 0.262 Test Loss: 3.945 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.6356585025787354
Epoch: 56, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.982 Vali Acc: 0.260 Test Loss: 3.982 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.0962955951690674
Epoch: 57, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.960 Vali Acc: 0.256 Test Loss: 3.960 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.5734891891479492
Epoch: 58, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.969 Vali Acc: 0.265 Test Loss: 3.969 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.4358577728271484
Epoch: 59, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.997 Vali Acc: 0.256 Test Loss: 3.997 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.9370653629302979
Epoch: 60, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.002 Vali Acc: 0.264 Test Loss: 4.002 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.6478652954101562
Epoch: 61, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.012 Vali Acc: 0.267 Test Loss: 4.012 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.5317058563232422
Epoch: 62, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.022 Vali Acc: 0.262 Test Loss: 4.022 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.7636427879333496
Epoch: 63, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.027 Vali Acc: 0.265 Test Loss: 4.027 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 966794
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0211164951324463
Epoch: 1, Steps: 10 | Train Loss: 3.535 Vali Loss: 3.386 Vali Acc: 0.045 Test Loss: 3.386 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 1.4516541957855225
Epoch: 2, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.300 Vali Acc: 0.065 Test Loss: 3.300 Test Acc: 0.065
Validation loss decreased (-0.044672 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 1.420637607574463
Epoch: 3, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.321 Vali Acc: 0.051 Test Loss: 3.321 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3133563995361328
Epoch: 4, Steps: 10 | Train Loss: 3.099 Vali Loss: 3.325 Vali Acc: 0.076 Test Loss: 3.325 Test Acc: 0.076
Validation loss decreased (-0.064673 --> -0.076437).  Saving model ...
Epoch: 5 cost time: 1.2424211502075195
Epoch: 5, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.306 Vali Acc: 0.085 Test Loss: 3.306 Test Acc: 0.085
Validation loss decreased (-0.076437 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 1.1819777488708496
Epoch: 6, Steps: 10 | Train Loss: 3.008 Vali Loss: 3.278 Vali Acc: 0.086 Test Loss: 3.278 Test Acc: 0.086
Validation loss decreased (-0.084673 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 1.423952579498291
Epoch: 7, Steps: 10 | Train Loss: 2.905 Vali Loss: 3.244 Vali Acc: 0.078 Test Loss: 3.244 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5393316745758057
Epoch: 8, Steps: 10 | Train Loss: 2.810 Vali Loss: 3.254 Vali Acc: 0.104 Test Loss: 3.254 Test Acc: 0.104
Validation loss decreased (-0.085850 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 1.3610665798187256
Epoch: 9, Steps: 10 | Train Loss: 2.738 Vali Loss: 3.238 Vali Acc: 0.112 Test Loss: 3.238 Test Acc: 0.112
Validation loss decreased (-0.103497 --> -0.111732).  Saving model ...
Epoch: 10 cost time: 1.2733230590820312
Epoch: 10, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.228 Vali Acc: 0.118 Test Loss: 3.228 Test Acc: 0.118
Validation loss decreased (-0.111732 --> -0.117615).  Saving model ...
Epoch: 11 cost time: 1.5708208084106445
Epoch: 11, Steps: 10 | Train Loss: 2.490 Vali Loss: 3.228 Vali Acc: 0.109 Test Loss: 3.228 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7214465141296387
Epoch: 12, Steps: 10 | Train Loss: 2.434 Vali Loss: 3.217 Vali Acc: 0.129 Test Loss: 3.217 Test Acc: 0.129
Validation loss decreased (-0.117615 --> -0.129380).  Saving model ...
Epoch: 13 cost time: 1.7277674674987793
Epoch: 13, Steps: 10 | Train Loss: 2.295 Vali Loss: 3.201 Vali Acc: 0.153 Test Loss: 3.201 Test Acc: 0.153
Validation loss decreased (-0.129380 --> -0.152909).  Saving model ...
Epoch: 14 cost time: 1.686143159866333
Epoch: 14, Steps: 10 | Train Loss: 2.208 Vali Loss: 3.211 Vali Acc: 0.142 Test Loss: 3.211 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4902551174163818
Epoch: 15, Steps: 10 | Train Loss: 2.087 Vali Loss: 3.208 Vali Acc: 0.142 Test Loss: 3.208 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4770195484161377
Epoch: 16, Steps: 10 | Train Loss: 1.912 Vali Loss: 3.200 Vali Acc: 0.169 Test Loss: 3.200 Test Acc: 0.169
Validation loss decreased (-0.152909 --> -0.169380).  Saving model ...
Epoch: 17 cost time: 1.5588674545288086
Epoch: 17, Steps: 10 | Train Loss: 1.823 Vali Loss: 3.211 Vali Acc: 0.162 Test Loss: 3.211 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.385256290435791
Epoch: 18, Steps: 10 | Train Loss: 1.662 Vali Loss: 3.194 Vali Acc: 0.175 Test Loss: 3.194 Test Acc: 0.175
Validation loss decreased (-0.169380 --> -0.175262).  Saving model ...
Epoch: 19 cost time: 1.2357866764068604
Epoch: 19, Steps: 10 | Train Loss: 1.601 Vali Loss: 3.224 Vali Acc: 0.179 Test Loss: 3.224 Test Acc: 0.179
Validation loss decreased (-0.175262 --> -0.178791).  Saving model ...
Epoch: 20 cost time: 1.1479291915893555
Epoch: 20, Steps: 10 | Train Loss: 1.439 Vali Loss: 3.195 Vali Acc: 0.192 Test Loss: 3.195 Test Acc: 0.192
Validation loss decreased (-0.178791 --> -0.191733).  Saving model ...
Epoch: 21 cost time: 1.5301289558410645
Epoch: 21, Steps: 10 | Train Loss: 1.366 Vali Loss: 3.204 Vali Acc: 0.198 Test Loss: 3.204 Test Acc: 0.198
Validation loss decreased (-0.191733 --> -0.197615).  Saving model ...
Epoch: 22 cost time: 1.3324670791625977
Epoch: 22, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.227 Vali Acc: 0.196 Test Loss: 3.227 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6938297748565674
Epoch: 23, Steps: 10 | Train Loss: 1.125 Vali Loss: 3.249 Vali Acc: 0.188 Test Loss: 3.249 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5478227138519287
Epoch: 24, Steps: 10 | Train Loss: 1.015 Vali Loss: 3.226 Vali Acc: 0.214 Test Loss: 3.226 Test Acc: 0.214
Validation loss decreased (-0.197615 --> -0.214085).  Saving model ...
Epoch: 25 cost time: 1.4216253757476807
Epoch: 25, Steps: 10 | Train Loss: 0.917 Vali Loss: 3.282 Vali Acc: 0.191 Test Loss: 3.282 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5128352642059326
Epoch: 26, Steps: 10 | Train Loss: 0.813 Vali Loss: 3.262 Vali Acc: 0.221 Test Loss: 3.262 Test Acc: 0.221
Validation loss decreased (-0.214085 --> -0.221144).  Saving model ...
Epoch: 27 cost time: 1.434100866317749
Epoch: 27, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.318 Vali Acc: 0.207 Test Loss: 3.318 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.320587158203125
Epoch: 28, Steps: 10 | Train Loss: 0.578 Vali Loss: 3.315 Vali Acc: 0.225 Test Loss: 3.315 Test Acc: 0.225
Validation loss decreased (-0.221144 --> -0.224673).  Saving model ...
Epoch: 29 cost time: 1.272796869277954
Epoch: 29, Steps: 10 | Train Loss: 0.552 Vali Loss: 3.337 Vali Acc: 0.226 Test Loss: 3.337 Test Acc: 0.226
Validation loss decreased (-0.224673 --> -0.225849).  Saving model ...
Epoch: 30 cost time: 1.205578327178955
Epoch: 30, Steps: 10 | Train Loss: 0.466 Vali Loss: 3.343 Vali Acc: 0.232 Test Loss: 3.343 Test Acc: 0.232
Validation loss decreased (-0.225849 --> -0.231731).  Saving model ...
Epoch: 31 cost time: 1.377821445465088
Epoch: 31, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.478 Vali Acc: 0.215 Test Loss: 3.478 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.24068284034729
Epoch: 32, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.391 Vali Acc: 0.240 Test Loss: 3.391 Test Acc: 0.240
Validation loss decreased (-0.231731 --> -0.239966).  Saving model ...
Epoch: 33 cost time: 1.2894086837768555
Epoch: 33, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.445 Vali Acc: 0.236 Test Loss: 3.445 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.422264814376831
Epoch: 34, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.452 Vali Acc: 0.238 Test Loss: 3.452 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2305235862731934
Epoch: 35, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.565 Vali Acc: 0.251 Test Loss: 3.565 Test Acc: 0.251
Validation loss decreased (-0.239966 --> -0.250553).  Saving model ...
Epoch: 36 cost time: 1.2527830600738525
Epoch: 36, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.542 Vali Acc: 0.242 Test Loss: 3.542 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2075166702270508
Epoch: 37, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.678 Vali Acc: 0.245 Test Loss: 3.678 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3573706150054932
Epoch: 38, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.648 Vali Acc: 0.259 Test Loss: 3.648 Test Acc: 0.259
Validation loss decreased (-0.250553 --> -0.258787).  Saving model ...
Epoch: 39 cost time: 1.0963776111602783
Epoch: 39, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.602 Vali Acc: 0.249 Test Loss: 3.602 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.406189203262329
Epoch: 40, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.654 Vali Acc: 0.253 Test Loss: 3.654 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4251728057861328
Epoch: 41, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.661 Vali Acc: 0.258 Test Loss: 3.661 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.3472449779510498
Epoch: 42, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.732 Vali Acc: 0.258 Test Loss: 3.732 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5594398975372314
Epoch: 43, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.708 Vali Acc: 0.258 Test Loss: 3.708 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2364146709442139
Epoch: 44, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.753 Vali Acc: 0.258 Test Loss: 3.753 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.5142297744750977
Epoch: 45, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.776 Vali Acc: 0.252 Test Loss: 3.776 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.4459259510040283
Epoch: 46, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.763 Vali Acc: 0.259 Test Loss: 3.763 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.61411452293396
Epoch: 47, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.799 Vali Acc: 0.254 Test Loss: 3.799 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.7248318195343018
Epoch: 48, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.808 Vali Acc: 0.261 Test Loss: 3.808 Test Acc: 0.261
Validation loss decreased (-0.258787 --> -0.261138).  Saving model ...
Epoch: 49 cost time: 1.514484167098999
Epoch: 49, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.840 Vali Acc: 0.271 Test Loss: 3.840 Test Acc: 0.271
Validation loss decreased (-0.261138 --> -0.270550).  Saving model ...
Epoch: 50 cost time: 1.428567886352539
Epoch: 50, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.855 Vali Acc: 0.265 Test Loss: 3.855 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.9145238399505615
Epoch: 51, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.853 Vali Acc: 0.256 Test Loss: 3.853 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.4204792976379395
Epoch: 52, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.860 Vali Acc: 0.258 Test Loss: 3.860 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.2553400993347168
Epoch: 53, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.865 Vali Acc: 0.269 Test Loss: 3.865 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.4154016971588135
Epoch: 54, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.884 Vali Acc: 0.264 Test Loss: 3.884 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.5088281631469727
Epoch: 55, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.914 Vali Acc: 0.268 Test Loss: 3.914 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.7048628330230713
Epoch: 56, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.941 Vali Acc: 0.267 Test Loss: 3.941 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.6947181224822998
Epoch: 57, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.953 Vali Acc: 0.269 Test Loss: 3.953 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.4305922985076904
Epoch: 58, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.948 Vali Acc: 0.266 Test Loss: 3.948 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.5201427936553955
Epoch: 59, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.964 Vali Acc: 0.266 Test Loss: 3.964 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 965258
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4008867740631104
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.330 Vali Acc: 0.034 Test Loss: 3.330 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 1.3849892616271973
Epoch: 2, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.296 Vali Acc: 0.049 Test Loss: 3.296 Test Acc: 0.049
Validation loss decreased (-0.034084 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 1.6082432270050049
Epoch: 3, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.317 Vali Acc: 0.048 Test Loss: 3.317 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6650142669677734
Epoch: 4, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.332 Vali Acc: 0.047 Test Loss: 3.332 Test Acc: 0.047
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3075857162475586
Epoch: 5, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.286 Vali Acc: 0.064 Test Loss: 3.286 Test Acc: 0.064
Validation loss decreased (-0.049379 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 1.9356179237365723
Epoch: 6, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.289 Vali Acc: 0.068 Test Loss: 3.289 Test Acc: 0.068
Validation loss decreased (-0.063497 --> -0.068202).  Saving model ...
Epoch: 7 cost time: 1.4454014301300049
Epoch: 7, Steps: 10 | Train Loss: 2.935 Vali Loss: 3.246 Vali Acc: 0.084 Test Loss: 3.246 Test Acc: 0.084
Validation loss decreased (-0.068202 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 1.29270601272583
Epoch: 8, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.248 Vali Acc: 0.099 Test Loss: 3.248 Test Acc: 0.099
Validation loss decreased (-0.083497 --> -0.098791).  Saving model ...
Epoch: 9 cost time: 1.2514550685882568
Epoch: 9, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.242 Vali Acc: 0.091 Test Loss: 3.242 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2772274017333984
Epoch: 10, Steps: 10 | Train Loss: 2.642 Vali Loss: 3.208 Vali Acc: 0.108 Test Loss: 3.208 Test Acc: 0.108
Validation loss decreased (-0.098791 --> -0.108203).  Saving model ...
Epoch: 11 cost time: 1.2213032245635986
Epoch: 11, Steps: 10 | Train Loss: 2.529 Vali Loss: 3.186 Vali Acc: 0.122 Test Loss: 3.186 Test Acc: 0.122
Validation loss decreased (-0.108203 --> -0.122321).  Saving model ...
Epoch: 12 cost time: 1.3136754035949707
Epoch: 12, Steps: 10 | Train Loss: 2.456 Vali Loss: 3.231 Vali Acc: 0.113 Test Loss: 3.231 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1737868785858154
Epoch: 13, Steps: 10 | Train Loss: 2.358 Vali Loss: 3.180 Vali Acc: 0.135 Test Loss: 3.180 Test Acc: 0.135
Validation loss decreased (-0.122321 --> -0.135262).  Saving model ...
Epoch: 14 cost time: 1.489438772201538
Epoch: 14, Steps: 10 | Train Loss: 2.187 Vali Loss: 3.167 Vali Acc: 0.155 Test Loss: 3.167 Test Acc: 0.155
Validation loss decreased (-0.135262 --> -0.155262).  Saving model ...
Epoch: 15 cost time: 1.3101444244384766
Epoch: 15, Steps: 10 | Train Loss: 2.043 Vali Loss: 3.171 Vali Acc: 0.147 Test Loss: 3.171 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6539068222045898
Epoch: 16, Steps: 10 | Train Loss: 1.905 Vali Loss: 3.179 Vali Acc: 0.161 Test Loss: 3.179 Test Acc: 0.161
Validation loss decreased (-0.155262 --> -0.161145).  Saving model ...
Epoch: 17 cost time: 1.2744014263153076
Epoch: 17, Steps: 10 | Train Loss: 1.805 Vali Loss: 3.163 Vali Acc: 0.173 Test Loss: 3.163 Test Acc: 0.173
Validation loss decreased (-0.161145 --> -0.172910).  Saving model ...
Epoch: 18 cost time: 1.2772974967956543
Epoch: 18, Steps: 10 | Train Loss: 1.677 Vali Loss: 3.181 Vali Acc: 0.173 Test Loss: 3.181 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2976047992706299
Epoch: 19, Steps: 10 | Train Loss: 1.565 Vali Loss: 3.171 Vali Acc: 0.178 Test Loss: 3.171 Test Acc: 0.178
Validation loss decreased (-0.172910 --> -0.177615).  Saving model ...
Epoch: 20 cost time: 1.4868974685668945
Epoch: 20, Steps: 10 | Train Loss: 1.430 Vali Loss: 3.161 Vali Acc: 0.192 Test Loss: 3.161 Test Acc: 0.192
Validation loss decreased (-0.177615 --> -0.191733).  Saving model ...
Epoch: 21 cost time: 1.39131498336792
Epoch: 21, Steps: 10 | Train Loss: 1.309 Vali Loss: 3.201 Vali Acc: 0.187 Test Loss: 3.201 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3465023040771484
Epoch: 22, Steps: 10 | Train Loss: 1.207 Vali Loss: 3.193 Vali Acc: 0.196 Test Loss: 3.193 Test Acc: 0.196
Validation loss decreased (-0.191733 --> -0.196439).  Saving model ...
Epoch: 23 cost time: 1.3167214393615723
Epoch: 23, Steps: 10 | Train Loss: 1.100 Vali Loss: 3.262 Vali Acc: 0.181 Test Loss: 3.262 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.518263816833496
Epoch: 24, Steps: 10 | Train Loss: 1.030 Vali Loss: 3.218 Vali Acc: 0.193 Test Loss: 3.218 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3763322830200195
Epoch: 25, Steps: 10 | Train Loss: 0.886 Vali Loss: 3.246 Vali Acc: 0.214 Test Loss: 3.246 Test Acc: 0.214
Validation loss decreased (-0.196439 --> -0.214085).  Saving model ...
Epoch: 26 cost time: 1.5365920066833496
Epoch: 26, Steps: 10 | Train Loss: 0.792 Vali Loss: 3.267 Vali Acc: 0.205 Test Loss: 3.267 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2920939922332764
Epoch: 27, Steps: 10 | Train Loss: 0.728 Vali Loss: 3.263 Vali Acc: 0.227 Test Loss: 3.263 Test Acc: 0.227
Validation loss decreased (-0.214085 --> -0.227026).  Saving model ...
Epoch: 28 cost time: 1.3585262298583984
Epoch: 28, Steps: 10 | Train Loss: 0.651 Vali Loss: 3.351 Vali Acc: 0.221 Test Loss: 3.351 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2397119998931885
Epoch: 29, Steps: 10 | Train Loss: 0.552 Vali Loss: 3.410 Vali Acc: 0.221 Test Loss: 3.410 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3735191822052002
Epoch: 30, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.425 Vali Acc: 0.212 Test Loss: 3.425 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4347541332244873
Epoch: 31, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.374 Vali Acc: 0.219 Test Loss: 3.374 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3990845680236816
Epoch: 32, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.422 Vali Acc: 0.221 Test Loss: 3.422 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.692460060119629
Epoch: 33, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.451 Vali Acc: 0.221 Test Loss: 3.451 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6859526634216309
Epoch: 34, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.547 Vali Acc: 0.216 Test Loss: 3.547 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.6175591945648193
Epoch: 35, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.572 Vali Acc: 0.239 Test Loss: 3.572 Test Acc: 0.239
Validation loss decreased (-0.227026 --> -0.238788).  Saving model ...
Epoch: 36 cost time: 1.3235301971435547
Epoch: 36, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.544 Vali Acc: 0.231 Test Loss: 3.544 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8522324562072754
Epoch: 37, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.667 Vali Acc: 0.252 Test Loss: 3.667 Test Acc: 0.252
Validation loss decreased (-0.238788 --> -0.251728).  Saving model ...
Epoch: 38 cost time: 1.69102144241333
Epoch: 38, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.568 Vali Acc: 0.244 Test Loss: 3.568 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4030849933624268
Epoch: 39, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.615 Vali Acc: 0.246 Test Loss: 3.615 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.337980031967163
Epoch: 40, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.703 Vali Acc: 0.239 Test Loss: 3.703 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.6449334621429443
Epoch: 41, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.638 Vali Acc: 0.251 Test Loss: 3.638 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.4060018062591553
Epoch: 42, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.710 Vali Acc: 0.254 Test Loss: 3.710 Test Acc: 0.254
Validation loss decreased (-0.251728 --> -0.254081).  Saving model ...
Epoch: 43 cost time: 1.3397395610809326
Epoch: 43, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.711 Vali Acc: 0.255 Test Loss: 3.711 Test Acc: 0.255
Validation loss decreased (-0.254081 --> -0.255257).  Saving model ...
Epoch: 44 cost time: 1.3220844268798828
Epoch: 44, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.724 Vali Acc: 0.256 Test Loss: 3.724 Test Acc: 0.256
Validation loss decreased (-0.255257 --> -0.256433).  Saving model ...
Epoch: 45 cost time: 1.4499237537384033
Epoch: 45, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.799 Vali Acc: 0.259 Test Loss: 3.799 Test Acc: 0.259
Validation loss decreased (-0.256433 --> -0.258786).  Saving model ...
Epoch: 46 cost time: 1.6573116779327393
Epoch: 46, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.795 Vali Acc: 0.242 Test Loss: 3.795 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.6421098709106445
Epoch: 47, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.806 Vali Acc: 0.261 Test Loss: 3.806 Test Acc: 0.261
Validation loss decreased (-0.258786 --> -0.261138).  Saving model ...
Epoch: 48 cost time: 1.5930695533752441
Epoch: 48, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.810 Vali Acc: 0.254 Test Loss: 3.810 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.7689850330352783
Epoch: 49, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.844 Vali Acc: 0.253 Test Loss: 3.844 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.4717695713043213
Epoch: 50, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.821 Vali Acc: 0.266 Test Loss: 3.821 Test Acc: 0.266
Validation loss decreased (-0.261138 --> -0.265844).  Saving model ...
Epoch: 51 cost time: 1.8440971374511719
Epoch: 51, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.803 Vali Acc: 0.255 Test Loss: 3.803 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.716766595840454
Epoch: 52, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.879 Vali Acc: 0.256 Test Loss: 3.879 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.3506627082824707
Epoch: 53, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.904 Vali Acc: 0.261 Test Loss: 3.904 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.778594732284546
Epoch: 54, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.892 Vali Acc: 0.259 Test Loss: 3.892 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.4133708477020264
Epoch: 55, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.881 Vali Acc: 0.259 Test Loss: 3.881 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.2852156162261963
Epoch: 56, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.905 Vali Acc: 0.265 Test Loss: 3.905 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.1949265003204346
Epoch: 57, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.917 Vali Acc: 0.260 Test Loss: 3.917 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.5956556797027588
Epoch: 58, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.906 Vali Acc: 0.264 Test Loss: 3.906 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.3592288494110107
Epoch: 59, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.920 Vali Acc: 0.269 Test Loss: 3.920 Test Acc: 0.269
Validation loss decreased (-0.265844 --> -0.269373).  Saving model ...
Epoch: 60 cost time: 1.3771240711212158
Epoch: 60, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.940 Vali Acc: 0.266 Test Loss: 3.940 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.4258732795715332
Epoch: 61, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.975 Vali Acc: 0.266 Test Loss: 3.975 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.4512577056884766
Epoch: 62, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.983 Vali Acc: 0.274 Test Loss: 3.983 Test Acc: 0.274
Validation loss decreased (-0.269373 --> -0.274078).  Saving model ...
Epoch: 63 cost time: 1.4257996082305908
Epoch: 63, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.978 Vali Acc: 0.269 Test Loss: 3.978 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.3025784492492676
Epoch: 64, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.972 Vali Acc: 0.266 Test Loss: 3.972 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.6487019062042236
Epoch: 65, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.004 Vali Acc: 0.266 Test Loss: 4.004 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.4510114192962646
Epoch: 66, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.025 Vali Acc: 0.262 Test Loss: 4.025 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.8414452075958252
Epoch: 67, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.034 Vali Acc: 0.267 Test Loss: 4.034 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.6923489570617676
Epoch: 68, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.035 Vali Acc: 0.262 Test Loss: 4.035 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.678818702697754
Epoch: 69, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.031 Vali Acc: 0.266 Test Loss: 4.031 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.6885087490081787
Epoch: 70, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.042 Vali Acc: 0.269 Test Loss: 4.042 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.4159364700317383
Epoch: 71, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.082 Vali Acc: 0.268 Test Loss: 4.082 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.746462106704712
Epoch: 72, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.060 Vali Acc: 0.267 Test Loss: 4.060 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 963722
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7305080890655518
Epoch: 1, Steps: 10 | Train Loss: 3.383 Vali Loss: 3.314 Vali Acc: 0.033 Test Loss: 3.314 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 1.3990263938903809
Epoch: 2, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.310 Vali Acc: 0.045 Test Loss: 3.310 Test Acc: 0.045
Validation loss decreased (-0.032908 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 1.2277731895446777
Epoch: 3, Steps: 10 | Train Loss: 3.191 Vali Loss: 3.357 Vali Acc: 0.045 Test Loss: 3.357 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.628415822982788
Epoch: 4, Steps: 10 | Train Loss: 3.143 Vali Loss: 3.362 Vali Acc: 0.060 Test Loss: 3.362 Test Acc: 0.060
Validation loss decreased (-0.044673 --> -0.059966).  Saving model ...
Epoch: 5 cost time: 1.2920169830322266
Epoch: 5, Steps: 10 | Train Loss: 3.109 Vali Loss: 3.303 Vali Acc: 0.082 Test Loss: 3.303 Test Acc: 0.082
Validation loss decreased (-0.059966 --> -0.082320).  Saving model ...
Epoch: 6 cost time: 1.544583797454834
Epoch: 6, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.296 Vali Acc: 0.055 Test Loss: 3.296 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5519967079162598
Epoch: 7, Steps: 10 | Train Loss: 2.965 Vali Loss: 3.289 Vali Acc: 0.069 Test Loss: 3.289 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4983906745910645
Epoch: 8, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.282 Vali Acc: 0.092 Test Loss: 3.282 Test Acc: 0.092
Validation loss decreased (-0.082320 --> -0.091732).  Saving model ...
Epoch: 9 cost time: 1.7209415435791016
Epoch: 9, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.246 Vali Acc: 0.106 Test Loss: 3.246 Test Acc: 0.106
Validation loss decreased (-0.091732 --> -0.105850).  Saving model ...
Epoch: 10 cost time: 1.53865385055542
Epoch: 10, Steps: 10 | Train Loss: 2.680 Vali Loss: 3.264 Vali Acc: 0.108 Test Loss: 3.264 Test Acc: 0.108
Validation loss decreased (-0.105850 --> -0.108203).  Saving model ...
Epoch: 11 cost time: 1.315392255783081
Epoch: 11, Steps: 10 | Train Loss: 2.546 Vali Loss: 3.242 Vali Acc: 0.111 Test Loss: 3.242 Test Acc: 0.111
Validation loss decreased (-0.108203 --> -0.110556).  Saving model ...
Epoch: 12 cost time: 1.5904195308685303
Epoch: 12, Steps: 10 | Train Loss: 2.457 Vali Loss: 3.224 Vali Acc: 0.129 Test Loss: 3.224 Test Acc: 0.129
Validation loss decreased (-0.110556 --> -0.129380).  Saving model ...
Epoch: 13 cost time: 1.4070632457733154
Epoch: 13, Steps: 10 | Train Loss: 2.297 Vali Loss: 3.217 Vali Acc: 0.146 Test Loss: 3.217 Test Acc: 0.146
Validation loss decreased (-0.129380 --> -0.145850).  Saving model ...
Epoch: 14 cost time: 1.5063071250915527
Epoch: 14, Steps: 10 | Train Loss: 2.144 Vali Loss: 3.207 Vali Acc: 0.125 Test Loss: 3.207 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.606003761291504
Epoch: 15, Steps: 10 | Train Loss: 2.025 Vali Loss: 3.214 Vali Acc: 0.159 Test Loss: 3.214 Test Acc: 0.159
Validation loss decreased (-0.145850 --> -0.158791).  Saving model ...
Epoch: 16 cost time: 1.4870049953460693
Epoch: 16, Steps: 10 | Train Loss: 1.952 Vali Loss: 3.181 Vali Acc: 0.169 Test Loss: 3.181 Test Acc: 0.169
Validation loss decreased (-0.158791 --> -0.169380).  Saving model ...
Epoch: 17 cost time: 1.4299492835998535
Epoch: 17, Steps: 10 | Train Loss: 1.818 Vali Loss: 3.244 Vali Acc: 0.156 Test Loss: 3.244 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.349660873413086
Epoch: 18, Steps: 10 | Train Loss: 1.716 Vali Loss: 3.169 Vali Acc: 0.184 Test Loss: 3.169 Test Acc: 0.184
Validation loss decreased (-0.169380 --> -0.183498).  Saving model ...
Epoch: 19 cost time: 1.210928201675415
Epoch: 19, Steps: 10 | Train Loss: 1.544 Vali Loss: 3.191 Vali Acc: 0.188 Test Loss: 3.191 Test Acc: 0.188
Validation loss decreased (-0.183498 --> -0.188203).  Saving model ...
Epoch: 20 cost time: 1.2926933765411377
Epoch: 20, Steps: 10 | Train Loss: 1.442 Vali Loss: 3.203 Vali Acc: 0.180 Test Loss: 3.203 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5910351276397705
Epoch: 21, Steps: 10 | Train Loss: 1.305 Vali Loss: 3.160 Vali Acc: 0.212 Test Loss: 3.160 Test Acc: 0.212
Validation loss decreased (-0.188203 --> -0.211733).  Saving model ...
Epoch: 22 cost time: 1.3743999004364014
Epoch: 22, Steps: 10 | Train Loss: 1.227 Vali Loss: 3.210 Vali Acc: 0.206 Test Loss: 3.210 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5499727725982666
Epoch: 23, Steps: 10 | Train Loss: 1.145 Vali Loss: 3.224 Vali Acc: 0.211 Test Loss: 3.224 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3238284587860107
Epoch: 24, Steps: 10 | Train Loss: 1.016 Vali Loss: 3.224 Vali Acc: 0.206 Test Loss: 3.224 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4938201904296875
Epoch: 25, Steps: 10 | Train Loss: 0.897 Vali Loss: 3.199 Vali Acc: 0.234 Test Loss: 3.199 Test Acc: 0.234
Validation loss decreased (-0.211733 --> -0.234086).  Saving model ...
Epoch: 26 cost time: 1.293259859085083
Epoch: 26, Steps: 10 | Train Loss: 0.780 Vali Loss: 3.247 Vali Acc: 0.214 Test Loss: 3.247 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7166037559509277
Epoch: 27, Steps: 10 | Train Loss: 0.728 Vali Loss: 3.288 Vali Acc: 0.224 Test Loss: 3.288 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1233994960784912
Epoch: 28, Steps: 10 | Train Loss: 0.627 Vali Loss: 3.324 Vali Acc: 0.224 Test Loss: 3.324 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1904551982879639
Epoch: 29, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.322 Vali Acc: 0.228 Test Loss: 3.322 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7972197532653809
Epoch: 30, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.323 Vali Acc: 0.227 Test Loss: 3.323 Test Acc: 0.227
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.482301950454712
Epoch: 31, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.408 Vali Acc: 0.225 Test Loss: 3.408 Test Acc: 0.225
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2956011295318604
Epoch: 32, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.451 Vali Acc: 0.244 Test Loss: 3.451 Test Acc: 0.244
Validation loss decreased (-0.234086 --> -0.243495).  Saving model ...
Epoch: 33 cost time: 1.2915277481079102
Epoch: 33, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.479 Vali Acc: 0.232 Test Loss: 3.479 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1456410884857178
Epoch: 34, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.507 Vali Acc: 0.231 Test Loss: 3.507 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1401536464691162
Epoch: 35, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.433 Vali Acc: 0.256 Test Loss: 3.433 Test Acc: 0.256
Validation loss decreased (-0.243495 --> -0.256436).  Saving model ...
Epoch: 36 cost time: 1.1887438297271729
Epoch: 36, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.654 Vali Acc: 0.236 Test Loss: 3.654 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6096374988555908
Epoch: 37, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.533 Vali Acc: 0.240 Test Loss: 3.533 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2447857856750488
Epoch: 38, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.670 Vali Acc: 0.253 Test Loss: 3.670 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2091729640960693
Epoch: 39, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.594 Vali Acc: 0.253 Test Loss: 3.594 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.727522611618042
Epoch: 40, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.614 Vali Acc: 0.254 Test Loss: 3.614 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3765771389007568
Epoch: 41, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.755 Vali Acc: 0.245 Test Loss: 3.755 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.6552112102508545
Epoch: 42, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.654 Vali Acc: 0.248 Test Loss: 3.654 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.2468950748443604
Epoch: 43, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.737 Vali Acc: 0.256 Test Loss: 3.737 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.340010404586792
Epoch: 44, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.691 Vali Acc: 0.266 Test Loss: 3.691 Test Acc: 0.266
Validation loss decreased (-0.256436 --> -0.265845).  Saving model ...
Epoch: 45 cost time: 1.6199967861175537
Epoch: 45, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.711 Vali Acc: 0.267 Test Loss: 3.711 Test Acc: 0.267
Validation loss decreased (-0.265845 --> -0.267022).  Saving model ...
Epoch: 46 cost time: 1.2010605335235596
Epoch: 46, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.779 Vali Acc: 0.269 Test Loss: 3.779 Test Acc: 0.269
Validation loss decreased (-0.267022 --> -0.269374).  Saving model ...
Epoch: 47 cost time: 1.215416669845581
Epoch: 47, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.795 Vali Acc: 0.254 Test Loss: 3.795 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.7161250114440918
Epoch: 48, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.783 Vali Acc: 0.264 Test Loss: 3.783 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2606346607208252
Epoch: 49, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.795 Vali Acc: 0.262 Test Loss: 3.795 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1592261791229248
Epoch: 50, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.807 Vali Acc: 0.259 Test Loss: 3.807 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.273076057434082
Epoch: 51, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.830 Vali Acc: 0.260 Test Loss: 3.830 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.3090951442718506
Epoch: 52, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.852 Vali Acc: 0.266 Test Loss: 3.852 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.4390616416931152
Epoch: 53, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.862 Vali Acc: 0.261 Test Loss: 3.862 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.1532559394836426
Epoch: 54, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.835 Vali Acc: 0.267 Test Loss: 3.835 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.615705966949463
Epoch: 55, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.837 Vali Acc: 0.261 Test Loss: 3.837 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.320166826248169
Epoch: 56, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.864 Vali Acc: 0.264 Test Loss: 3.864 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 962186
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8354480266571045
Epoch: 1, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.329 Vali Acc: 0.039 Test Loss: 3.329 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.0371580123901367
Epoch: 2, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.314 Vali Acc: 0.044 Test Loss: 3.314 Test Acc: 0.044
Validation loss decreased (-0.038790 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 1.2456934452056885
Epoch: 3, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.334 Vali Acc: 0.045 Test Loss: 3.334 Test Acc: 0.045
Validation loss decreased (-0.043496 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 1.2930412292480469
Epoch: 4, Steps: 10 | Train Loss: 3.114 Vali Loss: 3.341 Vali Acc: 0.046 Test Loss: 3.341 Test Acc: 0.046
Validation loss decreased (-0.044673 --> -0.045849).  Saving model ...
Epoch: 5 cost time: 1.2523846626281738
Epoch: 5, Steps: 10 | Train Loss: 3.121 Vali Loss: 3.332 Vali Acc: 0.045 Test Loss: 3.332 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.174379825592041
Epoch: 6, Steps: 10 | Train Loss: 3.096 Vali Loss: 3.309 Vali Acc: 0.071 Test Loss: 3.309 Test Acc: 0.071
Validation loss decreased (-0.045849 --> -0.070555).  Saving model ...
Epoch: 7 cost time: 1.2544691562652588
Epoch: 7, Steps: 10 | Train Loss: 2.971 Vali Loss: 3.298 Vali Acc: 0.071 Test Loss: 3.298 Test Acc: 0.071
Validation loss decreased (-0.070555 --> -0.070555).  Saving model ...
Epoch: 8 cost time: 1.3007261753082275
Epoch: 8, Steps: 10 | Train Loss: 2.956 Vali Loss: 3.292 Vali Acc: 0.064 Test Loss: 3.292 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.231520652770996
Epoch: 9, Steps: 10 | Train Loss: 2.828 Vali Loss: 3.285 Vali Acc: 0.072 Test Loss: 3.285 Test Acc: 0.072
Validation loss decreased (-0.070555 --> -0.071732).  Saving model ...
Epoch: 10 cost time: 1.0879976749420166
Epoch: 10, Steps: 10 | Train Loss: 2.770 Vali Loss: 3.269 Vali Acc: 0.095 Test Loss: 3.269 Test Acc: 0.095
Validation loss decreased (-0.071732 --> -0.095261).  Saving model ...
Epoch: 11 cost time: 1.3113341331481934
Epoch: 11, Steps: 10 | Train Loss: 2.602 Vali Loss: 3.263 Vali Acc: 0.095 Test Loss: 3.263 Test Acc: 0.095
Validation loss decreased (-0.095261 --> -0.095261).  Saving model ...
Epoch: 12 cost time: 1.2224514484405518
Epoch: 12, Steps: 10 | Train Loss: 2.616 Vali Loss: 3.261 Vali Acc: 0.109 Test Loss: 3.261 Test Acc: 0.109
Validation loss decreased (-0.095261 --> -0.109379).  Saving model ...
Epoch: 13 cost time: 1.052469253540039
Epoch: 13, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.269 Vali Acc: 0.105 Test Loss: 3.269 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4043254852294922
Epoch: 14, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.232 Vali Acc: 0.120 Test Loss: 3.232 Test Acc: 0.120
Validation loss decreased (-0.109379 --> -0.119968).  Saving model ...
Epoch: 15 cost time: 1.2987627983093262
Epoch: 15, Steps: 10 | Train Loss: 2.238 Vali Loss: 3.216 Vali Acc: 0.132 Test Loss: 3.216 Test Acc: 0.132
Validation loss decreased (-0.119968 --> -0.131733).  Saving model ...
Epoch: 16 cost time: 1.3234834671020508
Epoch: 16, Steps: 10 | Train Loss: 2.119 Vali Loss: 3.223 Vali Acc: 0.134 Test Loss: 3.223 Test Acc: 0.134
Validation loss decreased (-0.131733 --> -0.134085).  Saving model ...
Epoch: 17 cost time: 1.2765698432922363
Epoch: 17, Steps: 10 | Train Loss: 1.987 Vali Loss: 3.238 Vali Acc: 0.148 Test Loss: 3.238 Test Acc: 0.148
Validation loss decreased (-0.134085 --> -0.148203).  Saving model ...
Epoch: 18 cost time: 1.1920647621154785
Epoch: 18, Steps: 10 | Train Loss: 1.861 Vali Loss: 3.190 Vali Acc: 0.155 Test Loss: 3.190 Test Acc: 0.155
Validation loss decreased (-0.148203 --> -0.155262).  Saving model ...
Epoch: 19 cost time: 1.2351293563842773
Epoch: 19, Steps: 10 | Train Loss: 1.736 Vali Loss: 3.202 Vali Acc: 0.159 Test Loss: 3.202 Test Acc: 0.159
Validation loss decreased (-0.155262 --> -0.158792).  Saving model ...
Epoch: 20 cost time: 1.1084423065185547
Epoch: 20, Steps: 10 | Train Loss: 1.607 Vali Loss: 3.194 Vali Acc: 0.180 Test Loss: 3.194 Test Acc: 0.180
Validation loss decreased (-0.158792 --> -0.179968).  Saving model ...
Epoch: 21 cost time: 1.104548454284668
Epoch: 21, Steps: 10 | Train Loss: 1.537 Vali Loss: 3.244 Vali Acc: 0.168 Test Loss: 3.244 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2936618328094482
Epoch: 22, Steps: 10 | Train Loss: 1.394 Vali Loss: 3.193 Vali Acc: 0.194 Test Loss: 3.193 Test Acc: 0.194
Validation loss decreased (-0.179968 --> -0.194086).  Saving model ...
Epoch: 23 cost time: 1.3639779090881348
Epoch: 23, Steps: 10 | Train Loss: 1.290 Vali Loss: 3.215 Vali Acc: 0.188 Test Loss: 3.215 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.19073486328125
Epoch: 24, Steps: 10 | Train Loss: 1.175 Vali Loss: 3.270 Vali Acc: 0.184 Test Loss: 3.270 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2490010261535645
Epoch: 25, Steps: 10 | Train Loss: 1.097 Vali Loss: 3.239 Vali Acc: 0.205 Test Loss: 3.239 Test Acc: 0.205
Validation loss decreased (-0.194086 --> -0.204673).  Saving model ...
Epoch: 26 cost time: 1.2583754062652588
Epoch: 26, Steps: 10 | Train Loss: 1.004 Vali Loss: 3.290 Vali Acc: 0.207 Test Loss: 3.290 Test Acc: 0.207
Validation loss decreased (-0.204673 --> -0.207026).  Saving model ...
Epoch: 27 cost time: 1.041128158569336
Epoch: 27, Steps: 10 | Train Loss: 0.884 Vali Loss: 3.294 Vali Acc: 0.209 Test Loss: 3.294 Test Acc: 0.209
Validation loss decreased (-0.207026 --> -0.209379).  Saving model ...
Epoch: 28 cost time: 1.1297874450683594
Epoch: 28, Steps: 10 | Train Loss: 0.803 Vali Loss: 3.313 Vali Acc: 0.224 Test Loss: 3.313 Test Acc: 0.224
Validation loss decreased (-0.209379 --> -0.223496).  Saving model ...
Epoch: 29 cost time: 1.0284855365753174
Epoch: 29, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.311 Vali Acc: 0.220 Test Loss: 3.311 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2324223518371582
Epoch: 30, Steps: 10 | Train Loss: 0.628 Vali Loss: 3.302 Vali Acc: 0.225 Test Loss: 3.302 Test Acc: 0.225
Validation loss decreased (-0.223496 --> -0.224673).  Saving model ...
Epoch: 31 cost time: 1.220362901687622
Epoch: 31, Steps: 10 | Train Loss: 0.592 Vali Loss: 3.375 Vali Acc: 0.228 Test Loss: 3.375 Test Acc: 0.228
Validation loss decreased (-0.224673 --> -0.228202).  Saving model ...
Epoch: 32 cost time: 1.1625909805297852
Epoch: 32, Steps: 10 | Train Loss: 0.472 Vali Loss: 3.375 Vali Acc: 0.231 Test Loss: 3.375 Test Acc: 0.231
Validation loss decreased (-0.228202 --> -0.230554).  Saving model ...
Epoch: 33 cost time: 1.207900047302246
Epoch: 33, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.393 Vali Acc: 0.242 Test Loss: 3.393 Test Acc: 0.242
Validation loss decreased (-0.230554 --> -0.242319).  Saving model ...
Epoch: 34 cost time: 1.395465612411499
Epoch: 34, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.479 Vali Acc: 0.232 Test Loss: 3.479 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.199099063873291
Epoch: 35, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.431 Vali Acc: 0.239 Test Loss: 3.431 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2513453960418701
Epoch: 36, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.527 Vali Acc: 0.254 Test Loss: 3.527 Test Acc: 0.254
Validation loss decreased (-0.242319 --> -0.254082).  Saving model ...
Epoch: 37 cost time: 1.0911743640899658
Epoch: 37, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.491 Vali Acc: 0.254 Test Loss: 3.491 Test Acc: 0.254
Validation loss decreased (-0.254082 --> -0.254083).  Saving model ...
Epoch: 38 cost time: 1.256152868270874
Epoch: 38, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.557 Vali Acc: 0.235 Test Loss: 3.557 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1593773365020752
Epoch: 39, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.599 Vali Acc: 0.255 Test Loss: 3.599 Test Acc: 0.255
Validation loss decreased (-0.254083 --> -0.255258).  Saving model ...
Epoch: 40 cost time: 1.2164180278778076
Epoch: 40, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.691 Vali Acc: 0.239 Test Loss: 3.691 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.176753282546997
Epoch: 41, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.658 Vali Acc: 0.252 Test Loss: 3.658 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.226440191268921
Epoch: 42, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.738 Vali Acc: 0.251 Test Loss: 3.738 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3880023956298828
Epoch: 43, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.731 Vali Acc: 0.258 Test Loss: 3.731 Test Acc: 0.258
Validation loss decreased (-0.255258 --> -0.257610).  Saving model ...
Epoch: 44 cost time: 1.1865782737731934
Epoch: 44, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.727 Vali Acc: 0.269 Test Loss: 3.727 Test Acc: 0.269
Validation loss decreased (-0.257610 --> -0.269374).  Saving model ...
Epoch: 45 cost time: 1.2213363647460938
Epoch: 45, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.771 Vali Acc: 0.271 Test Loss: 3.771 Test Acc: 0.271
Validation loss decreased (-0.269374 --> -0.270551).  Saving model ...
Epoch: 46 cost time: 1.3093981742858887
Epoch: 46, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.758 Vali Acc: 0.261 Test Loss: 3.758 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1264500617980957
Epoch: 47, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.794 Vali Acc: 0.272 Test Loss: 3.794 Test Acc: 0.272
Validation loss decreased (-0.270551 --> -0.271727).  Saving model ...
Epoch: 48 cost time: 1.0534818172454834
Epoch: 48, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.812 Vali Acc: 0.258 Test Loss: 3.812 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.440849781036377
Epoch: 49, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.794 Vali Acc: 0.268 Test Loss: 3.794 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3504931926727295
Epoch: 50, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.871 Vali Acc: 0.260 Test Loss: 3.871 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.2379074096679688
Epoch: 51, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.863 Vali Acc: 0.271 Test Loss: 3.863 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.1198787689208984
Epoch: 52, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.874 Vali Acc: 0.266 Test Loss: 3.874 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.372478723526001
Epoch: 53, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.889 Vali Acc: 0.272 Test Loss: 3.889 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.1909399032592773
Epoch: 54, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.918 Vali Acc: 0.266 Test Loss: 3.918 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.307462453842163
Epoch: 55, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.914 Vali Acc: 0.265 Test Loss: 3.914 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.258885383605957
Epoch: 56, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.915 Vali Acc: 0.265 Test Loss: 3.915 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.3142902851104736
Epoch: 57, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.949 Vali Acc: 0.260 Test Loss: 3.949 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 735626
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8216447830200195
Epoch: 1, Steps: 10 | Train Loss: 3.386 Vali Loss: 3.393 Vali Acc: 0.036 Test Loss: 3.393 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.1630051136016846
Epoch: 2, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.337 Vali Acc: 0.049 Test Loss: 3.337 Test Acc: 0.049
Validation loss decreased (-0.036437 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 1.0627620220184326
Epoch: 3, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.356 Vali Acc: 0.042 Test Loss: 3.356 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.16025972366333
Epoch: 4, Steps: 10 | Train Loss: 3.144 Vali Loss: 3.350 Vali Acc: 0.060 Test Loss: 3.350 Test Acc: 0.060
Validation loss decreased (-0.049378 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 1.1217999458312988
Epoch: 5, Steps: 10 | Train Loss: 3.122 Vali Loss: 3.344 Vali Acc: 0.069 Test Loss: 3.344 Test Acc: 0.069
Validation loss decreased (-0.059967 --> -0.069378).  Saving model ...
Epoch: 6 cost time: 1.1166210174560547
Epoch: 6, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.307 Vali Acc: 0.069 Test Loss: 3.307 Test Acc: 0.069
Validation loss decreased (-0.069378 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 1.121462106704712
Epoch: 7, Steps: 10 | Train Loss: 2.965 Vali Loss: 3.317 Vali Acc: 0.073 Test Loss: 3.317 Test Acc: 0.073
Validation loss decreased (-0.069379 --> -0.072908).  Saving model ...
Epoch: 8 cost time: 1.1936016082763672
Epoch: 8, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.296 Vali Acc: 0.074 Test Loss: 3.296 Test Acc: 0.074
Validation loss decreased (-0.072908 --> -0.074085).  Saving model ...
Epoch: 9 cost time: 1.3915290832519531
Epoch: 9, Steps: 10 | Train Loss: 2.848 Vali Loss: 3.273 Vali Acc: 0.109 Test Loss: 3.273 Test Acc: 0.109
Validation loss decreased (-0.074085 --> -0.109379).  Saving model ...
Epoch: 10 cost time: 1.045867681503296
Epoch: 10, Steps: 10 | Train Loss: 2.685 Vali Loss: 3.297 Vali Acc: 0.119 Test Loss: 3.297 Test Acc: 0.119
Validation loss decreased (-0.109379 --> -0.118791).  Saving model ...
Epoch: 11 cost time: 1.2389922142028809
Epoch: 11, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.264 Vali Acc: 0.114 Test Loss: 3.264 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1041171550750732
Epoch: 12, Steps: 10 | Train Loss: 2.465 Vali Loss: 3.250 Vali Acc: 0.135 Test Loss: 3.250 Test Acc: 0.135
Validation loss decreased (-0.118791 --> -0.135262).  Saving model ...
Epoch: 13 cost time: 1.6315863132476807
Epoch: 13, Steps: 10 | Train Loss: 2.333 Vali Loss: 3.250 Vali Acc: 0.135 Test Loss: 3.250 Test Acc: 0.135
Validation loss decreased (-0.135262 --> -0.135262).  Saving model ...
Epoch: 14 cost time: 1.2368695735931396
Epoch: 14, Steps: 10 | Train Loss: 2.237 Vali Loss: 3.244 Vali Acc: 0.147 Test Loss: 3.244 Test Acc: 0.147
Validation loss decreased (-0.135262 --> -0.147026).  Saving model ...
Epoch: 15 cost time: 1.2370855808258057
Epoch: 15, Steps: 10 | Train Loss: 2.085 Vali Loss: 3.286 Vali Acc: 0.142 Test Loss: 3.286 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3385324478149414
Epoch: 16, Steps: 10 | Train Loss: 1.957 Vali Loss: 3.247 Vali Acc: 0.152 Test Loss: 3.247 Test Acc: 0.152
Validation loss decreased (-0.147026 --> -0.151732).  Saving model ...
Epoch: 17 cost time: 1.2754921913146973
Epoch: 17, Steps: 10 | Train Loss: 1.845 Vali Loss: 3.268 Vali Acc: 0.155 Test Loss: 3.268 Test Acc: 0.155
Validation loss decreased (-0.151732 --> -0.155261).  Saving model ...
Epoch: 18 cost time: 1.303412675857544
Epoch: 18, Steps: 10 | Train Loss: 1.731 Vali Loss: 3.254 Vali Acc: 0.162 Test Loss: 3.254 Test Acc: 0.162
Validation loss decreased (-0.155261 --> -0.162320).  Saving model ...
Epoch: 19 cost time: 1.124680995941162
Epoch: 19, Steps: 10 | Train Loss: 1.560 Vali Loss: 3.268 Vali Acc: 0.176 Test Loss: 3.268 Test Acc: 0.176
Validation loss decreased (-0.162320 --> -0.176438).  Saving model ...
Epoch: 20 cost time: 1.542935848236084
Epoch: 20, Steps: 10 | Train Loss: 1.502 Vali Loss: 3.294 Vali Acc: 0.171 Test Loss: 3.294 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3893990516662598
Epoch: 21, Steps: 10 | Train Loss: 1.379 Vali Loss: 3.291 Vali Acc: 0.179 Test Loss: 3.291 Test Acc: 0.179
Validation loss decreased (-0.176438 --> -0.178791).  Saving model ...
Epoch: 22 cost time: 1.0480496883392334
Epoch: 22, Steps: 10 | Train Loss: 1.222 Vali Loss: 3.331 Vali Acc: 0.182 Test Loss: 3.331 Test Acc: 0.182
Validation loss decreased (-0.178791 --> -0.182320).  Saving model ...
Epoch: 23 cost time: 1.4068031311035156
Epoch: 23, Steps: 10 | Train Loss: 1.172 Vali Loss: 3.341 Vali Acc: 0.184 Test Loss: 3.341 Test Acc: 0.184
Validation loss decreased (-0.182320 --> -0.183496).  Saving model ...
Epoch: 24 cost time: 1.257190227508545
Epoch: 24, Steps: 10 | Train Loss: 1.059 Vali Loss: 3.345 Vali Acc: 0.186 Test Loss: 3.345 Test Acc: 0.186
Validation loss decreased (-0.183496 --> -0.185849).  Saving model ...
Epoch: 25 cost time: 1.3456032276153564
Epoch: 25, Steps: 10 | Train Loss: 0.962 Vali Loss: 3.346 Vali Acc: 0.198 Test Loss: 3.346 Test Acc: 0.198
Validation loss decreased (-0.185849 --> -0.197614).  Saving model ...
Epoch: 26 cost time: 1.1867244243621826
Epoch: 26, Steps: 10 | Train Loss: 0.887 Vali Loss: 3.443 Vali Acc: 0.172 Test Loss: 3.443 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.325521469116211
Epoch: 27, Steps: 10 | Train Loss: 0.737 Vali Loss: 3.417 Vali Acc: 0.202 Test Loss: 3.417 Test Acc: 0.202
Validation loss decreased (-0.197614 --> -0.202319).  Saving model ...
Epoch: 28 cost time: 1.2873871326446533
Epoch: 28, Steps: 10 | Train Loss: 0.698 Vali Loss: 3.456 Vali Acc: 0.192 Test Loss: 3.456 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.184523105621338
Epoch: 29, Steps: 10 | Train Loss: 0.603 Vali Loss: 3.454 Vali Acc: 0.216 Test Loss: 3.454 Test Acc: 0.216
Validation loss decreased (-0.202319 --> -0.216436).  Saving model ...
Epoch: 30 cost time: 1.1236522197723389
Epoch: 30, Steps: 10 | Train Loss: 0.538 Vali Loss: 3.492 Vali Acc: 0.205 Test Loss: 3.492 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3635132312774658
Epoch: 31, Steps: 10 | Train Loss: 0.441 Vali Loss: 3.532 Vali Acc: 0.208 Test Loss: 3.532 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.209181547164917
Epoch: 32, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.572 Vali Acc: 0.219 Test Loss: 3.572 Test Acc: 0.219
Validation loss decreased (-0.216436 --> -0.218788).  Saving model ...
Epoch: 33 cost time: 1.8439786434173584
Epoch: 33, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.625 Vali Acc: 0.211 Test Loss: 3.625 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3113596439361572
Epoch: 34, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.586 Vali Acc: 0.220 Test Loss: 3.586 Test Acc: 0.220
Validation loss decreased (-0.218788 --> -0.219964).  Saving model ...
Epoch: 35 cost time: 1.607536792755127
Epoch: 35, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.652 Vali Acc: 0.232 Test Loss: 3.652 Test Acc: 0.232
Validation loss decreased (-0.219964 --> -0.231728).  Saving model ...
Epoch: 36 cost time: 1.58595609664917
Epoch: 36, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.738 Vali Acc: 0.229 Test Loss: 3.738 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3843929767608643
Epoch: 37, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.673 Vali Acc: 0.229 Test Loss: 3.673 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.505988359451294
Epoch: 38, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.798 Vali Acc: 0.224 Test Loss: 3.798 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.509958267211914
Epoch: 39, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.820 Vali Acc: 0.231 Test Loss: 3.820 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.5451202392578125
Epoch: 40, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.766 Vali Acc: 0.239 Test Loss: 3.766 Test Acc: 0.239
Validation loss decreased (-0.231728 --> -0.238786).  Saving model ...
Epoch: 41 cost time: 1.3128297328948975
Epoch: 41, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.894 Vali Acc: 0.235 Test Loss: 3.894 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6449506282806396
Epoch: 42, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.843 Vali Acc: 0.236 Test Loss: 3.843 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2164273262023926
Epoch: 43, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.935 Vali Acc: 0.232 Test Loss: 3.935 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.66843581199646
Epoch: 44, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.955 Vali Acc: 0.226 Test Loss: 3.955 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2356765270233154
Epoch: 45, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.960 Vali Acc: 0.236 Test Loss: 3.960 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.256908655166626
Epoch: 46, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.974 Vali Acc: 0.240 Test Loss: 3.974 Test Acc: 0.240
Validation loss decreased (-0.238786 --> -0.239960).  Saving model ...
Epoch: 47 cost time: 1.2862098217010498
Epoch: 47, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.953 Vali Acc: 0.240 Test Loss: 3.953 Test Acc: 0.240
Validation loss decreased (-0.239960 --> -0.239960).  Saving model ...
Epoch: 48 cost time: 1.2092862129211426
Epoch: 48, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.001 Vali Acc: 0.242 Test Loss: 4.001 Test Acc: 0.242
Validation loss decreased (-0.239960 --> -0.242313).  Saving model ...
Epoch: 49 cost time: 1.2797267436981201
Epoch: 49, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.962 Vali Acc: 0.241 Test Loss: 3.962 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.177597999572754
Epoch: 50, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.011 Vali Acc: 0.245 Test Loss: 4.011 Test Acc: 0.245
Validation loss decreased (-0.242313 --> -0.244666).  Saving model ...
Epoch: 51 cost time: 1.3548839092254639
Epoch: 51, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.014 Vali Acc: 0.242 Test Loss: 4.014 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.312105417251587
Epoch: 52, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.054 Vali Acc: 0.240 Test Loss: 4.054 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.499495029449463
Epoch: 53, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.058 Vali Acc: 0.245 Test Loss: 4.058 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.3583948612213135
Epoch: 54, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.092 Vali Acc: 0.239 Test Loss: 4.092 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.164738655090332
Epoch: 55, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.092 Vali Acc: 0.248 Test Loss: 4.092 Test Acc: 0.248
Validation loss decreased (-0.244666 --> -0.248194).  Saving model ...
Epoch: 56 cost time: 1.270040512084961
Epoch: 56, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.126 Vali Acc: 0.247 Test Loss: 4.126 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3898084163665771
Epoch: 57, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.140 Vali Acc: 0.245 Test Loss: 4.140 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.5490386486053467
Epoch: 58, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.134 Vali Acc: 0.241 Test Loss: 4.134 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.1768720149993896
Epoch: 59, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.155 Vali Acc: 0.238 Test Loss: 4.155 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.3623390197753906
Epoch: 60, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.162 Vali Acc: 0.245 Test Loss: 4.162 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.0530424118041992
Epoch: 61, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.137 Vali Acc: 0.246 Test Loss: 4.137 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.3541853427886963
Epoch: 62, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.173 Vali Acc: 0.244 Test Loss: 4.173 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.3027031421661377
Epoch: 63, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.175 Vali Acc: 0.244 Test Loss: 4.175 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.3254568576812744
Epoch: 64, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.188 Vali Acc: 0.247 Test Loss: 4.188 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.4605484008789062
Epoch: 65, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.200 Vali Acc: 0.241 Test Loss: 4.200 Test Acc: 0.241
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24823529411764705
model parameter : 734090
model size : 4.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.277850389480591
Epoch: 1, Steps: 10 | Train Loss: 3.506 Vali Loss: 3.381 Vali Acc: 0.035 Test Loss: 3.381 Test Acc: 0.035
Validation loss decreased (inf --> -0.035260).  Saving model ...
Epoch: 2 cost time: 1.2915680408477783
Epoch: 2, Steps: 10 | Train Loss: 3.364 Vali Loss: 3.295 Vali Acc: 0.038 Test Loss: 3.295 Test Acc: 0.038
Validation loss decreased (-0.035260 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 1.218207836151123
Epoch: 3, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.314 Vali Acc: 0.040 Test Loss: 3.314 Test Acc: 0.040
Validation loss decreased (-0.037614 --> -0.039967).  Saving model ...
Epoch: 4 cost time: 1.4997928142547607
Epoch: 4, Steps: 10 | Train Loss: 3.162 Vali Loss: 3.346 Vali Acc: 0.060 Test Loss: 3.346 Test Acc: 0.060
Validation loss decreased (-0.039967 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 1.298593521118164
Epoch: 5, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.347 Vali Acc: 0.060 Test Loss: 3.347 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1457371711730957
Epoch: 6, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.324 Vali Acc: 0.065 Test Loss: 3.324 Test Acc: 0.065
Validation loss decreased (-0.059967 --> -0.064673).  Saving model ...
Epoch: 7 cost time: 1.1326379776000977
Epoch: 7, Steps: 10 | Train Loss: 3.032 Vali Loss: 3.280 Vali Acc: 0.066 Test Loss: 3.280 Test Acc: 0.066
Validation loss decreased (-0.064673 --> -0.065850).  Saving model ...
Epoch: 8 cost time: 1.218113899230957
Epoch: 8, Steps: 10 | Train Loss: 2.931 Vali Loss: 3.277 Vali Acc: 0.082 Test Loss: 3.277 Test Acc: 0.082
Validation loss decreased (-0.065850 --> -0.082320).  Saving model ...
Epoch: 9 cost time: 1.131554126739502
Epoch: 9, Steps: 10 | Train Loss: 2.874 Vali Loss: 3.275 Vali Acc: 0.085 Test Loss: 3.275 Test Acc: 0.085
Validation loss decreased (-0.082320 --> -0.084673).  Saving model ...
Epoch: 10 cost time: 1.1028203964233398
Epoch: 10, Steps: 10 | Train Loss: 2.781 Vali Loss: 3.260 Vali Acc: 0.089 Test Loss: 3.260 Test Acc: 0.089
Validation loss decreased (-0.084673 --> -0.089379).  Saving model ...
Epoch: 11 cost time: 1.33294677734375
Epoch: 11, Steps: 10 | Train Loss: 2.678 Vali Loss: 3.231 Vali Acc: 0.109 Test Loss: 3.231 Test Acc: 0.109
Validation loss decreased (-0.089379 --> -0.109379).  Saving model ...
Epoch: 12 cost time: 1.2398970127105713
Epoch: 12, Steps: 10 | Train Loss: 2.504 Vali Loss: 3.226 Vali Acc: 0.121 Test Loss: 3.226 Test Acc: 0.121
Validation loss decreased (-0.109379 --> -0.121144).  Saving model ...
Epoch: 13 cost time: 1.1553113460540771
Epoch: 13, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.231 Vali Acc: 0.118 Test Loss: 3.231 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4326863288879395
Epoch: 14, Steps: 10 | Train Loss: 2.311 Vali Loss: 3.221 Vali Acc: 0.142 Test Loss: 3.221 Test Acc: 0.142
Validation loss decreased (-0.121144 --> -0.142321).  Saving model ...
Epoch: 15 cost time: 1.5623273849487305
Epoch: 15, Steps: 10 | Train Loss: 2.186 Vali Loss: 3.190 Vali Acc: 0.151 Test Loss: 3.190 Test Acc: 0.151
Validation loss decreased (-0.142321 --> -0.150556).  Saving model ...
Epoch: 16 cost time: 1.2149829864501953
Epoch: 16, Steps: 10 | Train Loss: 2.040 Vali Loss: 3.199 Vali Acc: 0.155 Test Loss: 3.199 Test Acc: 0.155
Validation loss decreased (-0.150556 --> -0.155262).  Saving model ...
Epoch: 17 cost time: 1.5460309982299805
Epoch: 17, Steps: 10 | Train Loss: 1.891 Vali Loss: 3.218 Vali Acc: 0.154 Test Loss: 3.218 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2121903896331787
Epoch: 18, Steps: 10 | Train Loss: 1.793 Vali Loss: 3.181 Vali Acc: 0.176 Test Loss: 3.181 Test Acc: 0.176
Validation loss decreased (-0.155262 --> -0.176439).  Saving model ...
Epoch: 19 cost time: 1.4023492336273193
Epoch: 19, Steps: 10 | Train Loss: 1.641 Vali Loss: 3.220 Vali Acc: 0.174 Test Loss: 3.220 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2600247859954834
Epoch: 20, Steps: 10 | Train Loss: 1.554 Vali Loss: 3.207 Vali Acc: 0.199 Test Loss: 3.207 Test Acc: 0.199
Validation loss decreased (-0.176439 --> -0.198791).  Saving model ...
Epoch: 21 cost time: 1.3910622596740723
Epoch: 21, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.229 Vali Acc: 0.196 Test Loss: 3.229 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3014824390411377
Epoch: 22, Steps: 10 | Train Loss: 1.329 Vali Loss: 3.232 Vali Acc: 0.195 Test Loss: 3.232 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3293755054473877
Epoch: 23, Steps: 10 | Train Loss: 1.227 Vali Loss: 3.227 Vali Acc: 0.207 Test Loss: 3.227 Test Acc: 0.207
Validation loss decreased (-0.198791 --> -0.207027).  Saving model ...
Epoch: 24 cost time: 1.2428243160247803
Epoch: 24, Steps: 10 | Train Loss: 1.135 Vali Loss: 3.292 Vali Acc: 0.209 Test Loss: 3.292 Test Acc: 0.209
Validation loss decreased (-0.207027 --> -0.209379).  Saving model ...
Epoch: 25 cost time: 1.3667235374450684
Epoch: 25, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.266 Vali Acc: 0.212 Test Loss: 3.266 Test Acc: 0.212
Validation loss decreased (-0.209379 --> -0.211732).  Saving model ...
Epoch: 26 cost time: 1.219921588897705
Epoch: 26, Steps: 10 | Train Loss: 0.931 Vali Loss: 3.258 Vali Acc: 0.216 Test Loss: 3.258 Test Acc: 0.216
Validation loss decreased (-0.211732 --> -0.216438).  Saving model ...
Epoch: 27 cost time: 1.1337511539459229
Epoch: 27, Steps: 10 | Train Loss: 0.848 Vali Loss: 3.290 Vali Acc: 0.231 Test Loss: 3.290 Test Acc: 0.231
Validation loss decreased (-0.216438 --> -0.230555).  Saving model ...
Epoch: 28 cost time: 1.1399719715118408
Epoch: 28, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.340 Vali Acc: 0.218 Test Loss: 3.340 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4153122901916504
Epoch: 29, Steps: 10 | Train Loss: 0.662 Vali Loss: 3.361 Vali Acc: 0.233 Test Loss: 3.361 Test Acc: 0.233
Validation loss decreased (-0.230555 --> -0.232908).  Saving model ...
Epoch: 30 cost time: 1.597494125366211
Epoch: 30, Steps: 10 | Train Loss: 0.570 Vali Loss: 3.368 Vali Acc: 0.224 Test Loss: 3.368 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4574096202850342
Epoch: 31, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.373 Vali Acc: 0.239 Test Loss: 3.373 Test Acc: 0.239
Validation loss decreased (-0.232908 --> -0.238790).  Saving model ...
Epoch: 32 cost time: 1.261530876159668
Epoch: 32, Steps: 10 | Train Loss: 0.418 Vali Loss: 3.440 Vali Acc: 0.228 Test Loss: 3.440 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2350707054138184
Epoch: 33, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.425 Vali Acc: 0.247 Test Loss: 3.425 Test Acc: 0.247
Validation loss decreased (-0.238790 --> -0.247025).  Saving model ...
Epoch: 34 cost time: 1.435823678970337
Epoch: 34, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.509 Vali Acc: 0.233 Test Loss: 3.509 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1877708435058594
Epoch: 35, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.512 Vali Acc: 0.238 Test Loss: 3.512 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2668638229370117
Epoch: 36, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.608 Vali Acc: 0.240 Test Loss: 3.608 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.195986270904541
Epoch: 37, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.574 Vali Acc: 0.249 Test Loss: 3.574 Test Acc: 0.249
Validation loss decreased (-0.247025 --> -0.249376).  Saving model ...
Epoch: 38 cost time: 1.286635398864746
Epoch: 38, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.632 Vali Acc: 0.249 Test Loss: 3.632 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0783357620239258
Epoch: 39, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.674 Vali Acc: 0.256 Test Loss: 3.674 Test Acc: 0.256
Validation loss decreased (-0.249376 --> -0.256434).  Saving model ...
Epoch: 40 cost time: 1.0661141872406006
Epoch: 40, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.713 Vali Acc: 0.240 Test Loss: 3.713 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1359739303588867
Epoch: 41, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.763 Vali Acc: 0.265 Test Loss: 3.763 Test Acc: 0.265
Validation loss decreased (-0.256434 --> -0.264668).  Saving model ...
Epoch: 42 cost time: 1.0627467632293701
Epoch: 42, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.718 Vali Acc: 0.256 Test Loss: 3.718 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1527674198150635
Epoch: 43, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.756 Vali Acc: 0.261 Test Loss: 3.756 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1671350002288818
Epoch: 44, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.781 Vali Acc: 0.264 Test Loss: 3.781 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2730813026428223
Epoch: 45, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.800 Vali Acc: 0.264 Test Loss: 3.800 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.17177414894104
Epoch: 46, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.806 Vali Acc: 0.266 Test Loss: 3.806 Test Acc: 0.266
Validation loss decreased (-0.264668 --> -0.265844).  Saving model ...
Epoch: 47 cost time: 1.3099820613861084
Epoch: 47, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.829 Vali Acc: 0.264 Test Loss: 3.829 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3400392532348633
Epoch: 48, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.864 Vali Acc: 0.265 Test Loss: 3.864 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2372567653656006
Epoch: 49, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.886 Vali Acc: 0.266 Test Loss: 3.886 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.231161117553711
Epoch: 50, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.906 Vali Acc: 0.261 Test Loss: 3.906 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.47898530960083
Epoch: 51, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.934 Vali Acc: 0.258 Test Loss: 3.934 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.400862693786621
Epoch: 52, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.921 Vali Acc: 0.267 Test Loss: 3.921 Test Acc: 0.267
Validation loss decreased (-0.265844 --> -0.267020).  Saving model ...
Epoch: 53 cost time: 1.2420201301574707
Epoch: 53, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.957 Vali Acc: 0.265 Test Loss: 3.957 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.3513689041137695
Epoch: 54, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.948 Vali Acc: 0.266 Test Loss: 3.948 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2613844871520996
Epoch: 55, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.949 Vali Acc: 0.268 Test Loss: 3.949 Test Acc: 0.268
Validation loss decreased (-0.267020 --> -0.268196).  Saving model ...
Epoch: 56 cost time: 1.2348225116729736
Epoch: 56, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.006 Vali Acc: 0.266 Test Loss: 4.006 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0697352886199951
Epoch: 57, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.968 Vali Acc: 0.279 Test Loss: 3.968 Test Acc: 0.279
Validation loss decreased (-0.268196 --> -0.278784).  Saving model ...
Epoch: 58 cost time: 1.1400814056396484
Epoch: 58, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.018 Vali Acc: 0.269 Test Loss: 4.018 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2796308994293213
Epoch: 59, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.049 Vali Acc: 0.267 Test Loss: 4.049 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.246260643005371
Epoch: 60, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.061 Vali Acc: 0.265 Test Loss: 4.061 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.4401986598968506
Epoch: 61, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.058 Vali Acc: 0.265 Test Loss: 4.058 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.2804298400878906
Epoch: 62, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.089 Vali Acc: 0.259 Test Loss: 4.089 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.3043198585510254
Epoch: 63, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.100 Vali Acc: 0.266 Test Loss: 4.100 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.3295092582702637
Epoch: 64, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.074 Vali Acc: 0.264 Test Loss: 4.074 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.579732894897461
Epoch: 65, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.117 Vali Acc: 0.264 Test Loss: 4.117 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.3512403964996338
Epoch: 66, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.101 Vali Acc: 0.265 Test Loss: 4.101 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.48394775390625
Epoch: 67, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.129 Vali Acc: 0.266 Test Loss: 4.129 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 732554
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.768681526184082
Epoch: 1, Steps: 10 | Train Loss: 3.378 Vali Loss: 3.337 Vali Acc: 0.048 Test Loss: 3.337 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 1.0930190086364746
Epoch: 2, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.308 Vali Acc: 0.040 Test Loss: 3.308 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1408438682556152
Epoch: 3, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.366 Vali Acc: 0.040 Test Loss: 3.366 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1886203289031982
Epoch: 4, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.361 Vali Acc: 0.051 Test Loss: 3.361 Test Acc: 0.051
Validation loss decreased (-0.048202 --> -0.050555).  Saving model ...
Epoch: 5 cost time: 1.1102538108825684
Epoch: 5, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.326 Vali Acc: 0.066 Test Loss: 3.326 Test Acc: 0.066
Validation loss decreased (-0.050555 --> -0.065849).  Saving model ...
Epoch: 6 cost time: 1.1516838073730469
Epoch: 6, Steps: 10 | Train Loss: 3.082 Vali Loss: 3.330 Vali Acc: 0.048 Test Loss: 3.330 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1425063610076904
Epoch: 7, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.313 Vali Acc: 0.059 Test Loss: 3.313 Test Acc: 0.059
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2076761722564697
Epoch: 8, Steps: 10 | Train Loss: 2.882 Vali Loss: 3.295 Vali Acc: 0.067 Test Loss: 3.295 Test Acc: 0.067
Validation loss decreased (-0.065849 --> -0.067026).  Saving model ...
Epoch: 9 cost time: 1.1705217361450195
Epoch: 9, Steps: 10 | Train Loss: 2.847 Vali Loss: 3.289 Vali Acc: 0.082 Test Loss: 3.289 Test Acc: 0.082
Validation loss decreased (-0.067026 --> -0.082320).  Saving model ...
Epoch: 10 cost time: 1.1040937900543213
Epoch: 10, Steps: 10 | Train Loss: 2.781 Vali Loss: 3.277 Vali Acc: 0.092 Test Loss: 3.277 Test Acc: 0.092
Validation loss decreased (-0.082320 --> -0.091732).  Saving model ...
Epoch: 11 cost time: 1.193207025527954
Epoch: 11, Steps: 10 | Train Loss: 2.617 Vali Loss: 3.284 Vali Acc: 0.092 Test Loss: 3.284 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1051740646362305
Epoch: 12, Steps: 10 | Train Loss: 2.529 Vali Loss: 3.272 Vali Acc: 0.096 Test Loss: 3.272 Test Acc: 0.096
Validation loss decreased (-0.091732 --> -0.096438).  Saving model ...
Epoch: 13 cost time: 1.2055549621582031
Epoch: 13, Steps: 10 | Train Loss: 2.370 Vali Loss: 3.266 Vali Acc: 0.112 Test Loss: 3.266 Test Acc: 0.112
Validation loss decreased (-0.096438 --> -0.111732).  Saving model ...
Epoch: 14 cost time: 1.294344186782837
Epoch: 14, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.264 Vali Acc: 0.122 Test Loss: 3.264 Test Acc: 0.122
Validation loss decreased (-0.111732 --> -0.122320).  Saving model ...
Epoch: 15 cost time: 1.4322946071624756
Epoch: 15, Steps: 10 | Train Loss: 2.168 Vali Loss: 3.251 Vali Acc: 0.115 Test Loss: 3.251 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3516290187835693
Epoch: 16, Steps: 10 | Train Loss: 2.098 Vali Loss: 3.291 Vali Acc: 0.128 Test Loss: 3.291 Test Acc: 0.128
Validation loss decreased (-0.122320 --> -0.128202).  Saving model ...
Epoch: 17 cost time: 1.131511926651001
Epoch: 17, Steps: 10 | Train Loss: 1.953 Vali Loss: 3.272 Vali Acc: 0.145 Test Loss: 3.272 Test Acc: 0.145
Validation loss decreased (-0.128202 --> -0.144673).  Saving model ...
Epoch: 18 cost time: 1.3955237865447998
Epoch: 18, Steps: 10 | Train Loss: 1.842 Vali Loss: 3.266 Vali Acc: 0.136 Test Loss: 3.266 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2438292503356934
Epoch: 19, Steps: 10 | Train Loss: 1.681 Vali Loss: 3.256 Vali Acc: 0.154 Test Loss: 3.256 Test Acc: 0.154
Validation loss decreased (-0.144673 --> -0.154085).  Saving model ...
Epoch: 20 cost time: 1.0933256149291992
Epoch: 20, Steps: 10 | Train Loss: 1.570 Vali Loss: 3.282 Vali Acc: 0.155 Test Loss: 3.282 Test Acc: 0.155
Validation loss decreased (-0.154085 --> -0.155261).  Saving model ...
Epoch: 21 cost time: 1.1155595779418945
Epoch: 21, Steps: 10 | Train Loss: 1.477 Vali Loss: 3.285 Vali Acc: 0.171 Test Loss: 3.285 Test Acc: 0.171
Validation loss decreased (-0.155261 --> -0.170555).  Saving model ...
Epoch: 22 cost time: 1.1760649681091309
Epoch: 22, Steps: 10 | Train Loss: 1.360 Vali Loss: 3.289 Vali Acc: 0.165 Test Loss: 3.289 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2225370407104492
Epoch: 23, Steps: 10 | Train Loss: 1.260 Vali Loss: 3.286 Vali Acc: 0.182 Test Loss: 3.286 Test Acc: 0.182
Validation loss decreased (-0.170555 --> -0.182320).  Saving model ...
Epoch: 24 cost time: 1.0512642860412598
Epoch: 24, Steps: 10 | Train Loss: 1.135 Vali Loss: 3.285 Vali Acc: 0.181 Test Loss: 3.285 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3269798755645752
Epoch: 25, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.319 Vali Acc: 0.186 Test Loss: 3.319 Test Acc: 0.186
Validation loss decreased (-0.182320 --> -0.185849).  Saving model ...
Epoch: 26 cost time: 1.2439262866973877
Epoch: 26, Steps: 10 | Train Loss: 0.935 Vali Loss: 3.313 Vali Acc: 0.193 Test Loss: 3.313 Test Acc: 0.193
Validation loss decreased (-0.185849 --> -0.192908).  Saving model ...
Epoch: 27 cost time: 1.2413280010223389
Epoch: 27, Steps: 10 | Train Loss: 0.894 Vali Loss: 3.371 Vali Acc: 0.189 Test Loss: 3.371 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2273814678192139
Epoch: 28, Steps: 10 | Train Loss: 0.831 Vali Loss: 3.341 Vali Acc: 0.194 Test Loss: 3.341 Test Acc: 0.194
Validation loss decreased (-0.192908 --> -0.194084).  Saving model ...
Epoch: 29 cost time: 1.1483514308929443
Epoch: 29, Steps: 10 | Train Loss: 0.666 Vali Loss: 3.338 Vali Acc: 0.208 Test Loss: 3.338 Test Acc: 0.208
Validation loss decreased (-0.194084 --> -0.208202).  Saving model ...
Epoch: 30 cost time: 1.340010643005371
Epoch: 30, Steps: 10 | Train Loss: 0.569 Vali Loss: 3.380 Vali Acc: 0.207 Test Loss: 3.380 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2906594276428223
Epoch: 31, Steps: 10 | Train Loss: 0.499 Vali Loss: 3.426 Vali Acc: 0.194 Test Loss: 3.426 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4428868293762207
Epoch: 32, Steps: 10 | Train Loss: 0.442 Vali Loss: 3.376 Vali Acc: 0.218 Test Loss: 3.376 Test Acc: 0.218
Validation loss decreased (-0.208202 --> -0.217613).  Saving model ...
Epoch: 33 cost time: 1.1752605438232422
Epoch: 33, Steps: 10 | Train Loss: 0.411 Vali Loss: 3.461 Vali Acc: 0.214 Test Loss: 3.461 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2030184268951416
Epoch: 34, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.434 Vali Acc: 0.208 Test Loss: 3.434 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.080254316329956
Epoch: 35, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.531 Vali Acc: 0.200 Test Loss: 3.531 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.148181438446045
Epoch: 36, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.548 Vali Acc: 0.228 Test Loss: 3.548 Test Acc: 0.228
Validation loss decreased (-0.217613 --> -0.228200).  Saving model ...
Epoch: 37 cost time: 1.1060612201690674
Epoch: 37, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.577 Vali Acc: 0.228 Test Loss: 3.577 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1002635955810547
Epoch: 38, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.647 Vali Acc: 0.228 Test Loss: 3.647 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3195483684539795
Epoch: 39, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.571 Vali Acc: 0.232 Test Loss: 3.571 Test Acc: 0.232
Validation loss decreased (-0.228200 --> -0.231729).  Saving model ...
Epoch: 40 cost time: 1.35551118850708
Epoch: 40, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.624 Vali Acc: 0.244 Test Loss: 3.624 Test Acc: 0.244
Validation loss decreased (-0.231729 --> -0.243493).  Saving model ...
Epoch: 41 cost time: 1.1602504253387451
Epoch: 41, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.729 Vali Acc: 0.228 Test Loss: 3.729 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.208319902420044
Epoch: 42, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.656 Vali Acc: 0.216 Test Loss: 3.656 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.342076063156128
Epoch: 43, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.699 Vali Acc: 0.228 Test Loss: 3.699 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5790653228759766
Epoch: 44, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.712 Vali Acc: 0.247 Test Loss: 3.712 Test Acc: 0.247
Validation loss decreased (-0.243493 --> -0.247022).  Saving model ...
Epoch: 45 cost time: 1.2540953159332275
Epoch: 45, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.745 Vali Acc: 0.246 Test Loss: 3.745 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1952810287475586
Epoch: 46, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.848 Vali Acc: 0.228 Test Loss: 3.848 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2702727317810059
Epoch: 47, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.827 Vali Acc: 0.245 Test Loss: 3.827 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1242916584014893
Epoch: 48, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.840 Vali Acc: 0.249 Test Loss: 3.840 Test Acc: 0.249
Validation loss decreased (-0.247022 --> -0.249373).  Saving model ...
Epoch: 49 cost time: 1.265873908996582
Epoch: 49, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.828 Vali Acc: 0.248 Test Loss: 3.828 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1260101795196533
Epoch: 50, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.802 Vali Acc: 0.252 Test Loss: 3.802 Test Acc: 0.252
Validation loss decreased (-0.249373 --> -0.251727).  Saving model ...
Epoch: 51 cost time: 1.1721620559692383
Epoch: 51, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.858 Vali Acc: 0.248 Test Loss: 3.858 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.134997844696045
Epoch: 52, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.916 Vali Acc: 0.248 Test Loss: 3.916 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1227011680603027
Epoch: 53, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.912 Vali Acc: 0.246 Test Loss: 3.912 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.1857409477233887
Epoch: 54, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.919 Vali Acc: 0.251 Test Loss: 3.919 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.1692273616790771
Epoch: 55, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.913 Vali Acc: 0.258 Test Loss: 3.913 Test Acc: 0.258
Validation loss decreased (-0.251727 --> -0.257608).  Saving model ...
Epoch: 56 cost time: 1.1635327339172363
Epoch: 56, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.967 Vali Acc: 0.249 Test Loss: 3.967 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0501129627227783
Epoch: 57, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.984 Vali Acc: 0.259 Test Loss: 3.984 Test Acc: 0.259
Validation loss decreased (-0.257608 --> -0.258784).  Saving model ...
Epoch: 58 cost time: 1.0646960735321045
Epoch: 58, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.971 Vali Acc: 0.255 Test Loss: 3.971 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.5294747352600098
Epoch: 59, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.986 Vali Acc: 0.254 Test Loss: 3.986 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.2810134887695312
Epoch: 60, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.021 Vali Acc: 0.255 Test Loss: 4.021 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.1554741859436035
Epoch: 61, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.021 Vali Acc: 0.253 Test Loss: 4.021 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.237950325012207
Epoch: 62, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.036 Vali Acc: 0.256 Test Loss: 4.036 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.0934391021728516
Epoch: 63, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.033 Vali Acc: 0.254 Test Loss: 4.033 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.2596728801727295
Epoch: 64, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.050 Vali Acc: 0.246 Test Loss: 4.050 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.2470431327819824
Epoch: 65, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.061 Vali Acc: 0.245 Test Loss: 4.061 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.3463032245635986
Epoch: 66, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.056 Vali Acc: 0.264 Test Loss: 4.056 Test Acc: 0.264
Validation loss decreased (-0.258784 --> -0.263489).  Saving model ...
Epoch: 67 cost time: 1.331585168838501
Epoch: 67, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.081 Vali Acc: 0.266 Test Loss: 4.081 Test Acc: 0.266
Validation loss decreased (-0.263489 --> -0.265842).  Saving model ...
Epoch: 68 cost time: 1.1399946212768555
Epoch: 68, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.119 Vali Acc: 0.258 Test Loss: 4.119 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.2553226947784424
Epoch: 69, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.140 Vali Acc: 0.252 Test Loss: 4.140 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.321394443511963
Epoch: 70, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.121 Vali Acc: 0.251 Test Loss: 4.121 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.2664716243743896
Epoch: 71, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.106 Vali Acc: 0.254 Test Loss: 4.106 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.1567435264587402
Epoch: 72, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.128 Vali Acc: 0.258 Test Loss: 4.128 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.172013521194458
Epoch: 73, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.170 Vali Acc: 0.262 Test Loss: 4.170 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.251309871673584
Epoch: 74, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.180 Vali Acc: 0.259 Test Loss: 4.180 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.9716389179229736
Epoch: 75, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.154 Vali Acc: 0.254 Test Loss: 4.154 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.3974168300628662
Epoch: 76, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.169 Vali Acc: 0.258 Test Loss: 4.169 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.2458994388580322
Epoch: 77, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.185 Vali Acc: 0.260 Test Loss: 4.185 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 731018
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2459750175476074
Epoch: 1, Steps: 10 | Train Loss: 3.424 Vali Loss: 3.345 Vali Acc: 0.038 Test Loss: 3.345 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.1399190425872803
Epoch: 2, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.306 Vali Acc: 0.056 Test Loss: 3.306 Test Acc: 0.056
Validation loss decreased (-0.037614 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 1.065185785293579
Epoch: 3, Steps: 10 | Train Loss: 3.191 Vali Loss: 3.334 Vali Acc: 0.054 Test Loss: 3.334 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.18619704246521
Epoch: 4, Steps: 10 | Train Loss: 3.192 Vali Loss: 3.356 Vali Acc: 0.072 Test Loss: 3.356 Test Acc: 0.072
Validation loss decreased (-0.056438 --> -0.071731).  Saving model ...
Epoch: 5 cost time: 1.3046786785125732
Epoch: 5, Steps: 10 | Train Loss: 3.109 Vali Loss: 3.339 Vali Acc: 0.084 Test Loss: 3.339 Test Acc: 0.084
Validation loss decreased (-0.071731 --> -0.083496).  Saving model ...
Epoch: 6 cost time: 1.1326615810394287
Epoch: 6, Steps: 10 | Train Loss: 3.034 Vali Loss: 3.315 Vali Acc: 0.079 Test Loss: 3.315 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3119726181030273
Epoch: 7, Steps: 10 | Train Loss: 2.959 Vali Loss: 3.296 Vali Acc: 0.089 Test Loss: 3.296 Test Acc: 0.089
Validation loss decreased (-0.083496 --> -0.089379).  Saving model ...
Epoch: 8 cost time: 1.0824220180511475
Epoch: 8, Steps: 10 | Train Loss: 2.968 Vali Loss: 3.294 Vali Acc: 0.082 Test Loss: 3.294 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5354571342468262
Epoch: 9, Steps: 10 | Train Loss: 2.839 Vali Loss: 3.260 Vali Acc: 0.112 Test Loss: 3.260 Test Acc: 0.112
Validation loss decreased (-0.089379 --> -0.111732).  Saving model ...
Epoch: 10 cost time: 0.975959062576294
Epoch: 10, Steps: 10 | Train Loss: 2.748 Vali Loss: 3.257 Vali Acc: 0.100 Test Loss: 3.257 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1820404529571533
Epoch: 11, Steps: 10 | Train Loss: 2.685 Vali Loss: 3.254 Vali Acc: 0.115 Test Loss: 3.254 Test Acc: 0.115
Validation loss decreased (-0.111732 --> -0.115262).  Saving model ...
Epoch: 12 cost time: 1.1422145366668701
Epoch: 12, Steps: 10 | Train Loss: 2.581 Vali Loss: 3.234 Vali Acc: 0.119 Test Loss: 3.234 Test Acc: 0.119
Validation loss decreased (-0.115262 --> -0.118791).  Saving model ...
Epoch: 13 cost time: 1.1324868202209473
Epoch: 13, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.246 Vali Acc: 0.109 Test Loss: 3.246 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1049721240997314
Epoch: 14, Steps: 10 | Train Loss: 2.351 Vali Loss: 3.246 Vali Acc: 0.145 Test Loss: 3.246 Test Acc: 0.145
Validation loss decreased (-0.118791 --> -0.144673).  Saving model ...
Epoch: 15 cost time: 1.178837537765503
Epoch: 15, Steps: 10 | Train Loss: 2.305 Vali Loss: 3.243 Vali Acc: 0.146 Test Loss: 3.243 Test Acc: 0.146
Validation loss decreased (-0.144673 --> -0.145850).  Saving model ...
Epoch: 16 cost time: 1.1497561931610107
Epoch: 16, Steps: 10 | Train Loss: 2.063 Vali Loss: 3.239 Vali Acc: 0.135 Test Loss: 3.239 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.187380313873291
Epoch: 17, Steps: 10 | Train Loss: 1.944 Vali Loss: 3.246 Vali Acc: 0.145 Test Loss: 3.246 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2628018856048584
Epoch: 18, Steps: 10 | Train Loss: 1.938 Vali Loss: 3.230 Vali Acc: 0.153 Test Loss: 3.230 Test Acc: 0.153
Validation loss decreased (-0.145850 --> -0.152909).  Saving model ...
Epoch: 19 cost time: 1.4200587272644043
Epoch: 19, Steps: 10 | Train Loss: 1.740 Vali Loss: 3.226 Vali Acc: 0.161 Test Loss: 3.226 Test Acc: 0.161
Validation loss decreased (-0.152909 --> -0.161144).  Saving model ...
Epoch: 20 cost time: 1.3002862930297852
Epoch: 20, Steps: 10 | Train Loss: 1.657 Vali Loss: 3.237 Vali Acc: 0.168 Test Loss: 3.237 Test Acc: 0.168
Validation loss decreased (-0.161144 --> -0.168203).  Saving model ...
Epoch: 21 cost time: 1.1746361255645752
Epoch: 21, Steps: 10 | Train Loss: 1.547 Vali Loss: 3.268 Vali Acc: 0.169 Test Loss: 3.268 Test Acc: 0.169
Validation loss decreased (-0.168203 --> -0.169379).  Saving model ...
Epoch: 22 cost time: 1.138627529144287
Epoch: 22, Steps: 10 | Train Loss: 1.428 Vali Loss: 3.225 Vali Acc: 0.186 Test Loss: 3.225 Test Acc: 0.186
Validation loss decreased (-0.169379 --> -0.185850).  Saving model ...
Epoch: 23 cost time: 1.3986661434173584
Epoch: 23, Steps: 10 | Train Loss: 1.315 Vali Loss: 3.276 Vali Acc: 0.175 Test Loss: 3.276 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4107613563537598
Epoch: 24, Steps: 10 | Train Loss: 1.244 Vali Loss: 3.254 Vali Acc: 0.182 Test Loss: 3.254 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1180198192596436
Epoch: 25, Steps: 10 | Train Loss: 1.124 Vali Loss: 3.320 Vali Acc: 0.206 Test Loss: 3.320 Test Acc: 0.206
Validation loss decreased (-0.185850 --> -0.205849).  Saving model ...
Epoch: 26 cost time: 1.1223220825195312
Epoch: 26, Steps: 10 | Train Loss: 1.011 Vali Loss: 3.275 Vali Acc: 0.199 Test Loss: 3.275 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1752305030822754
Epoch: 27, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.325 Vali Acc: 0.211 Test Loss: 3.325 Test Acc: 0.211
Validation loss decreased (-0.205849 --> -0.210555).  Saving model ...
Epoch: 28 cost time: 1.1638085842132568
Epoch: 28, Steps: 10 | Train Loss: 0.865 Vali Loss: 3.306 Vali Acc: 0.205 Test Loss: 3.306 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9783422946929932
Epoch: 29, Steps: 10 | Train Loss: 0.788 Vali Loss: 3.342 Vali Acc: 0.209 Test Loss: 3.342 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1086091995239258
Epoch: 30, Steps: 10 | Train Loss: 0.684 Vali Loss: 3.401 Vali Acc: 0.206 Test Loss: 3.401 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1346745491027832
Epoch: 31, Steps: 10 | Train Loss: 0.639 Vali Loss: 3.373 Vali Acc: 0.194 Test Loss: 3.373 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.319871425628662
Epoch: 32, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.417 Vali Acc: 0.215 Test Loss: 3.417 Test Acc: 0.215
Validation loss decreased (-0.210555 --> -0.215260).  Saving model ...
Epoch: 33 cost time: 1.2829854488372803
Epoch: 33, Steps: 10 | Train Loss: 0.465 Vali Loss: 3.385 Vali Acc: 0.207 Test Loss: 3.385 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.308333158493042
Epoch: 34, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.473 Vali Acc: 0.212 Test Loss: 3.473 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2896971702575684
Epoch: 35, Steps: 10 | Train Loss: 0.303 Vali Loss: 3.505 Vali Acc: 0.211 Test Loss: 3.505 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1703295707702637
Epoch: 36, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.502 Vali Acc: 0.224 Test Loss: 3.502 Test Acc: 0.224
Validation loss decreased (-0.215260 --> -0.223494).  Saving model ...
Epoch: 37 cost time: 1.2118558883666992
Epoch: 37, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.543 Vali Acc: 0.226 Test Loss: 3.543 Test Acc: 0.226
Validation loss decreased (-0.223494 --> -0.225847).  Saving model ...
Epoch: 38 cost time: 1.5777256488800049
Epoch: 38, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.544 Vali Acc: 0.220 Test Loss: 3.544 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.265075445175171
Epoch: 39, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.589 Vali Acc: 0.215 Test Loss: 3.589 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4417548179626465
Epoch: 40, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.654 Vali Acc: 0.222 Test Loss: 3.654 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.5232937335968018
Epoch: 41, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.666 Vali Acc: 0.235 Test Loss: 3.666 Test Acc: 0.235
Validation loss decreased (-0.225847 --> -0.235257).  Saving model ...
Epoch: 42 cost time: 1.5080432891845703
Epoch: 42, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.644 Vali Acc: 0.224 Test Loss: 3.644 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.449195384979248
Epoch: 43, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.751 Vali Acc: 0.231 Test Loss: 3.751 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3119354248046875
Epoch: 44, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.681 Vali Acc: 0.235 Test Loss: 3.681 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2880160808563232
Epoch: 45, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.830 Vali Acc: 0.240 Test Loss: 3.830 Test Acc: 0.240
Validation loss decreased (-0.235257 --> -0.239962).  Saving model ...
Epoch: 46 cost time: 1.6287336349487305
Epoch: 46, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.759 Vali Acc: 0.233 Test Loss: 3.759 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.438199758529663
Epoch: 47, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.819 Vali Acc: 0.224 Test Loss: 3.819 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2003626823425293
Epoch: 48, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.825 Vali Acc: 0.229 Test Loss: 3.825 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.3707900047302246
Epoch: 49, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.822 Vali Acc: 0.239 Test Loss: 3.822 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.5336899757385254
Epoch: 50, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.903 Vali Acc: 0.234 Test Loss: 3.903 Test Acc: 0.234
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.2820208072662354
Epoch: 51, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.854 Vali Acc: 0.232 Test Loss: 3.854 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.437828540802002
Epoch: 52, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.908 Vali Acc: 0.244 Test Loss: 3.908 Test Acc: 0.244
Validation loss decreased (-0.239962 --> -0.243490).  Saving model ...
Epoch: 53 cost time: 1.4312715530395508
Epoch: 53, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.903 Vali Acc: 0.232 Test Loss: 3.903 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.3006658554077148
Epoch: 54, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.955 Vali Acc: 0.239 Test Loss: 3.955 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.4722836017608643
Epoch: 55, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.901 Vali Acc: 0.234 Test Loss: 3.901 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.5118327140808105
Epoch: 56, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.996 Vali Acc: 0.235 Test Loss: 3.996 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.367051124572754
Epoch: 57, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.941 Vali Acc: 0.234 Test Loss: 3.941 Test Acc: 0.234
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.3675730228424072
Epoch: 58, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.964 Vali Acc: 0.238 Test Loss: 3.964 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.58549165725708
Epoch: 59, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.008 Vali Acc: 0.238 Test Loss: 4.008 Test Acc: 0.238
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.3710885047912598
Epoch: 60, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.973 Vali Acc: 0.240 Test Loss: 3.973 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.2775158882141113
Epoch: 61, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.029 Vali Acc: 0.234 Test Loss: 4.029 Test Acc: 0.234
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.5400738716125488
Epoch: 62, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.040 Vali Acc: 0.229 Test Loss: 4.040 Test Acc: 0.229
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24352941176470588
model parameter : 620042
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.829357147216797
Epoch: 1, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.289 Vali Acc: 0.038 Test Loss: 3.289 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.2982513904571533
Epoch: 2, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.290 Vali Acc: 0.041 Test Loss: 3.290 Test Acc: 0.041
Validation loss decreased (-0.037614 --> -0.041144).  Saving model ...
Epoch: 3 cost time: 1.0663034915924072
Epoch: 3, Steps: 10 | Train Loss: 3.148 Vali Loss: 3.318 Vali Acc: 0.047 Test Loss: 3.318 Test Acc: 0.047
Validation loss decreased (-0.041144 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 1.3053956031799316
Epoch: 4, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.334 Vali Acc: 0.051 Test Loss: 3.334 Test Acc: 0.051
Validation loss decreased (-0.047026 --> -0.050555).  Saving model ...
Epoch: 5 cost time: 1.5170209407806396
Epoch: 5, Steps: 10 | Train Loss: 3.080 Vali Loss: 3.322 Vali Acc: 0.061 Test Loss: 3.322 Test Acc: 0.061
Validation loss decreased (-0.050555 --> -0.061143).  Saving model ...
Epoch: 6 cost time: 1.42091703414917
Epoch: 6, Steps: 10 | Train Loss: 3.050 Vali Loss: 3.308 Vali Acc: 0.071 Test Loss: 3.308 Test Acc: 0.071
Validation loss decreased (-0.061143 --> -0.070555).  Saving model ...
Epoch: 7 cost time: 1.2178966999053955
Epoch: 7, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.311 Vali Acc: 0.055 Test Loss: 3.311 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3907763957977295
Epoch: 8, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.288 Vali Acc: 0.079 Test Loss: 3.288 Test Acc: 0.079
Validation loss decreased (-0.070555 --> -0.078791).  Saving model ...
Epoch: 9 cost time: 1.3084254264831543
Epoch: 9, Steps: 10 | Train Loss: 2.844 Vali Loss: 3.266 Vali Acc: 0.084 Test Loss: 3.266 Test Acc: 0.084
Validation loss decreased (-0.078791 --> -0.083497).  Saving model ...
Epoch: 10 cost time: 1.1052472591400146
Epoch: 10, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.280 Vali Acc: 0.091 Test Loss: 3.280 Test Acc: 0.091
Validation loss decreased (-0.083497 --> -0.090555).  Saving model ...
Epoch: 11 cost time: 1.146420955657959
Epoch: 11, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.302 Vali Acc: 0.101 Test Loss: 3.302 Test Acc: 0.101
Validation loss decreased (-0.090555 --> -0.101143).  Saving model ...
Epoch: 12 cost time: 1.0057835578918457
Epoch: 12, Steps: 10 | Train Loss: 2.555 Vali Loss: 3.237 Vali Acc: 0.118 Test Loss: 3.237 Test Acc: 0.118
Validation loss decreased (-0.101143 --> -0.117615).  Saving model ...
Epoch: 13 cost time: 1.0457208156585693
Epoch: 13, Steps: 10 | Train Loss: 2.497 Vali Loss: 3.226 Vali Acc: 0.116 Test Loss: 3.226 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1189243793487549
Epoch: 14, Steps: 10 | Train Loss: 2.336 Vali Loss: 3.253 Vali Acc: 0.128 Test Loss: 3.253 Test Acc: 0.128
Validation loss decreased (-0.117615 --> -0.128203).  Saving model ...
Epoch: 15 cost time: 1.184457778930664
Epoch: 15, Steps: 10 | Train Loss: 2.228 Vali Loss: 3.262 Vali Acc: 0.135 Test Loss: 3.262 Test Acc: 0.135
Validation loss decreased (-0.128203 --> -0.135262).  Saving model ...
Epoch: 16 cost time: 1.1338930130004883
Epoch: 16, Steps: 10 | Train Loss: 2.125 Vali Loss: 3.211 Vali Acc: 0.156 Test Loss: 3.211 Test Acc: 0.156
Validation loss decreased (-0.135262 --> -0.156438).  Saving model ...
Epoch: 17 cost time: 1.0421867370605469
Epoch: 17, Steps: 10 | Train Loss: 2.011 Vali Loss: 3.229 Vali Acc: 0.161 Test Loss: 3.229 Test Acc: 0.161
Validation loss decreased (-0.156438 --> -0.161144).  Saving model ...
Epoch: 18 cost time: 1.3316607475280762
Epoch: 18, Steps: 10 | Train Loss: 1.861 Vali Loss: 3.256 Vali Acc: 0.154 Test Loss: 3.256 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3498237133026123
Epoch: 19, Steps: 10 | Train Loss: 1.782 Vali Loss: 3.242 Vali Acc: 0.161 Test Loss: 3.242 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4053137302398682
Epoch: 20, Steps: 10 | Train Loss: 1.665 Vali Loss: 3.232 Vali Acc: 0.172 Test Loss: 3.232 Test Acc: 0.172
Validation loss decreased (-0.161144 --> -0.171732).  Saving model ...
Epoch: 21 cost time: 1.1170759201049805
Epoch: 21, Steps: 10 | Train Loss: 1.484 Vali Loss: 3.260 Vali Acc: 0.178 Test Loss: 3.260 Test Acc: 0.178
Validation loss decreased (-0.171732 --> -0.177614).  Saving model ...
Epoch: 22 cost time: 1.2542445659637451
Epoch: 22, Steps: 10 | Train Loss: 1.385 Vali Loss: 3.240 Vali Acc: 0.180 Test Loss: 3.240 Test Acc: 0.180
Validation loss decreased (-0.177614 --> -0.179968).  Saving model ...
Epoch: 23 cost time: 1.1287364959716797
Epoch: 23, Steps: 10 | Train Loss: 1.273 Vali Loss: 3.265 Vali Acc: 0.195 Test Loss: 3.265 Test Acc: 0.195
Validation loss decreased (-0.179968 --> -0.195261).  Saving model ...
Epoch: 24 cost time: 1.1003196239471436
Epoch: 24, Steps: 10 | Train Loss: 1.157 Vali Loss: 3.266 Vali Acc: 0.199 Test Loss: 3.266 Test Acc: 0.199
Validation loss decreased (-0.195261 --> -0.198791).  Saving model ...
Epoch: 25 cost time: 1.1070897579193115
Epoch: 25, Steps: 10 | Train Loss: 1.060 Vali Loss: 3.294 Vali Acc: 0.205 Test Loss: 3.294 Test Acc: 0.205
Validation loss decreased (-0.198791 --> -0.204673).  Saving model ...
Epoch: 26 cost time: 1.2132794857025146
Epoch: 26, Steps: 10 | Train Loss: 0.930 Vali Loss: 3.278 Vali Acc: 0.213 Test Loss: 3.278 Test Acc: 0.213
Validation loss decreased (-0.204673 --> -0.212908).  Saving model ...
Epoch: 27 cost time: 1.3658196926116943
Epoch: 27, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.345 Vali Acc: 0.212 Test Loss: 3.345 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0890617370605469
Epoch: 28, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.311 Vali Acc: 0.231 Test Loss: 3.311 Test Acc: 0.231
Validation loss decreased (-0.212908 --> -0.230555).  Saving model ...
Epoch: 29 cost time: 1.1258575916290283
Epoch: 29, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.335 Vali Acc: 0.226 Test Loss: 3.335 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2124176025390625
Epoch: 30, Steps: 10 | Train Loss: 0.594 Vali Loss: 3.342 Vali Acc: 0.235 Test Loss: 3.342 Test Acc: 0.235
Validation loss decreased (-0.230555 --> -0.235261).  Saving model ...
Epoch: 31 cost time: 1.0785632133483887
Epoch: 31, Steps: 10 | Train Loss: 0.517 Vali Loss: 3.379 Vali Acc: 0.229 Test Loss: 3.379 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1529817581176758
Epoch: 32, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.428 Vali Acc: 0.232 Test Loss: 3.428 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2761716842651367
Epoch: 33, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.468 Vali Acc: 0.222 Test Loss: 3.468 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1843361854553223
Epoch: 34, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.509 Vali Acc: 0.234 Test Loss: 3.509 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0663163661956787
Epoch: 35, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.454 Vali Acc: 0.244 Test Loss: 3.454 Test Acc: 0.244
Validation loss decreased (-0.235261 --> -0.243495).  Saving model ...
Epoch: 36 cost time: 1.1144967079162598
Epoch: 36, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.687 Vali Acc: 0.227 Test Loss: 3.687 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.400909423828125
Epoch: 37, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.604 Vali Acc: 0.233 Test Loss: 3.604 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2962732315063477
Epoch: 38, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.656 Vali Acc: 0.244 Test Loss: 3.656 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.336336612701416
Epoch: 39, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.629 Vali Acc: 0.251 Test Loss: 3.629 Test Acc: 0.251
Validation loss decreased (-0.243495 --> -0.250552).  Saving model ...
Epoch: 40 cost time: 1.2746102809906006
Epoch: 40, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.631 Vali Acc: 0.265 Test Loss: 3.631 Test Acc: 0.265
Validation loss decreased (-0.250552 --> -0.264670).  Saving model ...
Epoch: 41 cost time: 1.378760576248169
Epoch: 41, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.777 Vali Acc: 0.252 Test Loss: 3.777 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1714026927947998
Epoch: 42, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.686 Vali Acc: 0.258 Test Loss: 3.686 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.413759469985962
Epoch: 43, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.763 Vali Acc: 0.254 Test Loss: 3.763 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3088021278381348
Epoch: 44, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.738 Vali Acc: 0.267 Test Loss: 3.738 Test Acc: 0.267
Validation loss decreased (-0.264670 --> -0.267021).  Saving model ...
Epoch: 45 cost time: 1.1627728939056396
Epoch: 45, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.775 Vali Acc: 0.267 Test Loss: 3.775 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2092664241790771
Epoch: 46, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.807 Vali Acc: 0.259 Test Loss: 3.807 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2317306995391846
Epoch: 47, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.839 Vali Acc: 0.266 Test Loss: 3.839 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0364782810211182
Epoch: 48, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.844 Vali Acc: 0.273 Test Loss: 3.844 Test Acc: 0.273
Validation loss decreased (-0.267021 --> -0.272903).  Saving model ...
Epoch: 49 cost time: 1.277909517288208
Epoch: 49, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.866 Vali Acc: 0.273 Test Loss: 3.866 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2030563354492188
Epoch: 50, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.912 Vali Acc: 0.267 Test Loss: 3.912 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.1684904098510742
Epoch: 51, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.872 Vali Acc: 0.271 Test Loss: 3.872 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.2698988914489746
Epoch: 52, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.901 Vali Acc: 0.267 Test Loss: 3.901 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.0747911930084229
Epoch: 53, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.930 Vali Acc: 0.269 Test Loss: 3.930 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.1874816417694092
Epoch: 54, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.980 Vali Acc: 0.260 Test Loss: 3.980 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.3238704204559326
Epoch: 55, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.928 Vali Acc: 0.267 Test Loss: 3.928 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.4200870990753174
Epoch: 56, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.994 Vali Acc: 0.264 Test Loss: 3.994 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.218653917312622
Epoch: 57, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.015 Vali Acc: 0.268 Test Loss: 4.015 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.121647596359253
Epoch: 58, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.997 Vali Acc: 0.271 Test Loss: 3.997 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 618506
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3823230266571045
Epoch: 1, Steps: 10 | Train Loss: 3.375 Vali Loss: 3.320 Vali Acc: 0.049 Test Loss: 3.320 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.0261814594268799
Epoch: 2, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.299 Vali Acc: 0.046 Test Loss: 3.299 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.07431960105896
Epoch: 3, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.328 Vali Acc: 0.041 Test Loss: 3.328 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0884339809417725
Epoch: 4, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.348 Vali Acc: 0.046 Test Loss: 3.348 Test Acc: 0.046
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.113853931427002
Epoch: 5, Steps: 10 | Train Loss: 3.119 Vali Loss: 3.328 Vali Acc: 0.038 Test Loss: 3.328 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.099463939666748
Epoch: 6, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.310 Vali Acc: 0.065 Test Loss: 3.310 Test Acc: 0.065
Validation loss decreased (-0.049379 --> -0.064673).  Saving model ...
Epoch: 7 cost time: 1.0137126445770264
Epoch: 7, Steps: 10 | Train Loss: 2.997 Vali Loss: 3.289 Vali Acc: 0.082 Test Loss: 3.289 Test Acc: 0.082
Validation loss decreased (-0.064673 --> -0.082320).  Saving model ...
Epoch: 8 cost time: 1.109490156173706
Epoch: 8, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.279 Vali Acc: 0.073 Test Loss: 3.279 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0306389331817627
Epoch: 9, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.256 Vali Acc: 0.099 Test Loss: 3.256 Test Acc: 0.099
Validation loss decreased (-0.082320 --> -0.098791).  Saving model ...
Epoch: 10 cost time: 1.0608136653900146
Epoch: 10, Steps: 10 | Train Loss: 2.782 Vali Loss: 3.239 Vali Acc: 0.109 Test Loss: 3.239 Test Acc: 0.109
Validation loss decreased (-0.098791 --> -0.109379).  Saving model ...
Epoch: 11 cost time: 1.175492525100708
Epoch: 11, Steps: 10 | Train Loss: 2.637 Vali Loss: 3.248 Vali Acc: 0.106 Test Loss: 3.248 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0931155681610107
Epoch: 12, Steps: 10 | Train Loss: 2.530 Vali Loss: 3.278 Vali Acc: 0.124 Test Loss: 3.278 Test Acc: 0.124
Validation loss decreased (-0.109379 --> -0.123497).  Saving model ...
Epoch: 13 cost time: 1.0126540660858154
Epoch: 13, Steps: 10 | Train Loss: 2.397 Vali Loss: 3.240 Vali Acc: 0.136 Test Loss: 3.240 Test Acc: 0.136
Validation loss decreased (-0.123497 --> -0.136438).  Saving model ...
Epoch: 14 cost time: 1.1404166221618652
Epoch: 14, Steps: 10 | Train Loss: 2.305 Vali Loss: 3.181 Vali Acc: 0.139 Test Loss: 3.181 Test Acc: 0.139
Validation loss decreased (-0.136438 --> -0.138792).  Saving model ...
Epoch: 15 cost time: 1.2265305519104004
Epoch: 15, Steps: 10 | Train Loss: 2.191 Vali Loss: 3.223 Vali Acc: 0.152 Test Loss: 3.223 Test Acc: 0.152
Validation loss decreased (-0.138792 --> -0.151732).  Saving model ...
Epoch: 16 cost time: 1.111623764038086
Epoch: 16, Steps: 10 | Train Loss: 2.099 Vali Loss: 3.235 Vali Acc: 0.158 Test Loss: 3.235 Test Acc: 0.158
Validation loss decreased (-0.151732 --> -0.157615).  Saving model ...
Epoch: 17 cost time: 1.3482859134674072
Epoch: 17, Steps: 10 | Train Loss: 1.958 Vali Loss: 3.215 Vali Acc: 0.175 Test Loss: 3.215 Test Acc: 0.175
Validation loss decreased (-0.157615 --> -0.175262).  Saving model ...
Epoch: 18 cost time: 1.1017298698425293
Epoch: 18, Steps: 10 | Train Loss: 1.856 Vali Loss: 3.209 Vali Acc: 0.174 Test Loss: 3.209 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2477242946624756
Epoch: 19, Steps: 10 | Train Loss: 1.754 Vali Loss: 3.222 Vali Acc: 0.180 Test Loss: 3.222 Test Acc: 0.180
Validation loss decreased (-0.175262 --> -0.179968).  Saving model ...
Epoch: 20 cost time: 1.10784912109375
Epoch: 20, Steps: 10 | Train Loss: 1.606 Vali Loss: 3.226 Vali Acc: 0.175 Test Loss: 3.226 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0402922630310059
Epoch: 21, Steps: 10 | Train Loss: 1.582 Vali Loss: 3.204 Vali Acc: 0.196 Test Loss: 3.204 Test Acc: 0.196
Validation loss decreased (-0.179968 --> -0.196439).  Saving model ...
Epoch: 22 cost time: 1.2144572734832764
Epoch: 22, Steps: 10 | Train Loss: 1.399 Vali Loss: 3.281 Vali Acc: 0.192 Test Loss: 3.281 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0433528423309326
Epoch: 23, Steps: 10 | Train Loss: 1.389 Vali Loss: 3.240 Vali Acc: 0.207 Test Loss: 3.240 Test Acc: 0.207
Validation loss decreased (-0.196439 --> -0.207026).  Saving model ...
Epoch: 24 cost time: 0.9917938709259033
Epoch: 24, Steps: 10 | Train Loss: 1.203 Vali Loss: 3.258 Vali Acc: 0.200 Test Loss: 3.258 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1058502197265625
Epoch: 25, Steps: 10 | Train Loss: 1.118 Vali Loss: 3.270 Vali Acc: 0.206 Test Loss: 3.270 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.38093900680542
Epoch: 26, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.263 Vali Acc: 0.221 Test Loss: 3.263 Test Acc: 0.221
Validation loss decreased (-0.207026 --> -0.221144).  Saving model ...
Epoch: 27 cost time: 1.3862016201019287
Epoch: 27, Steps: 10 | Train Loss: 0.939 Vali Loss: 3.307 Vali Acc: 0.219 Test Loss: 3.307 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.17747163772583
Epoch: 28, Steps: 10 | Train Loss: 0.820 Vali Loss: 3.306 Vali Acc: 0.218 Test Loss: 3.306 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3816804885864258
Epoch: 29, Steps: 10 | Train Loss: 0.782 Vali Loss: 3.295 Vali Acc: 0.224 Test Loss: 3.295 Test Acc: 0.224
Validation loss decreased (-0.221144 --> -0.223496).  Saving model ...
Epoch: 30 cost time: 1.23405122756958
Epoch: 30, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.319 Vali Acc: 0.239 Test Loss: 3.319 Test Acc: 0.239
Validation loss decreased (-0.223496 --> -0.238790).  Saving model ...
Epoch: 31 cost time: 1.1652965545654297
Epoch: 31, Steps: 10 | Train Loss: 0.570 Vali Loss: 3.372 Vali Acc: 0.232 Test Loss: 3.372 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1148877143859863
Epoch: 32, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.410 Vali Acc: 0.221 Test Loss: 3.410 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4662530422210693
Epoch: 33, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.405 Vali Acc: 0.228 Test Loss: 3.405 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.207880973815918
Epoch: 34, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.429 Vali Acc: 0.238 Test Loss: 3.429 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1665594577789307
Epoch: 35, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.412 Vali Acc: 0.240 Test Loss: 3.412 Test Acc: 0.240
Validation loss decreased (-0.238790 --> -0.239966).  Saving model ...
Epoch: 36 cost time: 1.2786407470703125
Epoch: 36, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.513 Vali Acc: 0.245 Test Loss: 3.513 Test Acc: 0.245
Validation loss decreased (-0.239966 --> -0.244671).  Saving model ...
Epoch: 37 cost time: 1.2503316402435303
Epoch: 37, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.478 Vali Acc: 0.246 Test Loss: 3.478 Test Acc: 0.246
Validation loss decreased (-0.244671 --> -0.245848).  Saving model ...
Epoch: 38 cost time: 1.0601823329925537
Epoch: 38, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.557 Vali Acc: 0.246 Test Loss: 3.557 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9806497097015381
Epoch: 39, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.577 Vali Acc: 0.235 Test Loss: 3.577 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1673998832702637
Epoch: 40, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.611 Vali Acc: 0.248 Test Loss: 3.611 Test Acc: 0.248
Validation loss decreased (-0.245848 --> -0.248199).  Saving model ...
Epoch: 41 cost time: 1.049055576324463
Epoch: 41, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.666 Vali Acc: 0.248 Test Loss: 3.666 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1501436233520508
Epoch: 42, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.652 Vali Acc: 0.251 Test Loss: 3.652 Test Acc: 0.251
Validation loss decreased (-0.248199 --> -0.250552).  Saving model ...
Epoch: 43 cost time: 1.116037130355835
Epoch: 43, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.723 Vali Acc: 0.248 Test Loss: 3.723 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2193241119384766
Epoch: 44, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.753 Vali Acc: 0.255 Test Loss: 3.753 Test Acc: 0.255
Validation loss decreased (-0.250552 --> -0.255257).  Saving model ...
Epoch: 45 cost time: 1.0902626514434814
Epoch: 45, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.730 Vali Acc: 0.254 Test Loss: 3.730 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.39447021484375
Epoch: 46, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.780 Vali Acc: 0.253 Test Loss: 3.780 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0955047607421875
Epoch: 47, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.819 Vali Acc: 0.252 Test Loss: 3.819 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.248317003250122
Epoch: 48, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.824 Vali Acc: 0.255 Test Loss: 3.824 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1684191226959229
Epoch: 49, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.824 Vali Acc: 0.264 Test Loss: 3.824 Test Acc: 0.264
Validation loss decreased (-0.255257 --> -0.263491).  Saving model ...
Epoch: 50 cost time: 1.0495514869689941
Epoch: 50, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.882 Vali Acc: 0.251 Test Loss: 3.882 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0001161098480225
Epoch: 51, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.859 Vali Acc: 0.260 Test Loss: 3.859 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0232610702514648
Epoch: 52, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.898 Vali Acc: 0.256 Test Loss: 3.898 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.2407450675964355
Epoch: 53, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.918 Vali Acc: 0.251 Test Loss: 3.918 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.1872031688690186
Epoch: 54, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.940 Vali Acc: 0.253 Test Loss: 3.940 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.0977232456207275
Epoch: 55, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.927 Vali Acc: 0.259 Test Loss: 3.927 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.2202739715576172
Epoch: 56, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.956 Vali Acc: 0.253 Test Loss: 3.956 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.0749199390411377
Epoch: 57, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.965 Vali Acc: 0.258 Test Loss: 3.965 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.176060676574707
Epoch: 58, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.960 Vali Acc: 0.253 Test Loss: 3.960 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.104572057723999
Epoch: 59, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.970 Vali Acc: 0.255 Test Loss: 3.970 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 616970
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.631204605102539
Epoch: 1, Steps: 10 | Train Loss: 3.426 Vali Loss: 3.340 Vali Acc: 0.051 Test Loss: 3.340 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.1069293022155762
Epoch: 2, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.308 Vali Acc: 0.041 Test Loss: 3.308 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4303598403930664
Epoch: 3, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.347 Vali Acc: 0.036 Test Loss: 3.347 Test Acc: 0.036
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1470718383789062
Epoch: 4, Steps: 10 | Train Loss: 3.153 Vali Loss: 3.365 Vali Acc: 0.044 Test Loss: 3.365 Test Acc: 0.044
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2505030632019043
Epoch: 5, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.323 Vali Acc: 0.062 Test Loss: 3.323 Test Acc: 0.062
Validation loss decreased (-0.050555 --> -0.062320).  Saving model ...
Epoch: 6 cost time: 1.1362905502319336
Epoch: 6, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.317 Vali Acc: 0.064 Test Loss: 3.317 Test Acc: 0.064
Validation loss decreased (-0.062320 --> -0.063496).  Saving model ...
Epoch: 7 cost time: 1.0451903343200684
Epoch: 7, Steps: 10 | Train Loss: 3.019 Vali Loss: 3.326 Vali Acc: 0.060 Test Loss: 3.326 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0450596809387207
Epoch: 8, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.276 Vali Acc: 0.076 Test Loss: 3.276 Test Acc: 0.076
Validation loss decreased (-0.063496 --> -0.076438).  Saving model ...
Epoch: 9 cost time: 1.2481637001037598
Epoch: 9, Steps: 10 | Train Loss: 2.926 Vali Loss: 3.307 Vali Acc: 0.079 Test Loss: 3.307 Test Acc: 0.079
Validation loss decreased (-0.076438 --> -0.078790).  Saving model ...
Epoch: 10 cost time: 1.0604257583618164
Epoch: 10, Steps: 10 | Train Loss: 2.800 Vali Loss: 3.272 Vali Acc: 0.095 Test Loss: 3.272 Test Acc: 0.095
Validation loss decreased (-0.078790 --> -0.095261).  Saving model ...
Epoch: 11 cost time: 1.0524330139160156
Epoch: 11, Steps: 10 | Train Loss: 2.674 Vali Loss: 3.244 Vali Acc: 0.108 Test Loss: 3.244 Test Acc: 0.108
Validation loss decreased (-0.095261 --> -0.108203).  Saving model ...
Epoch: 12 cost time: 1.0653510093688965
Epoch: 12, Steps: 10 | Train Loss: 2.557 Vali Loss: 3.248 Vali Acc: 0.115 Test Loss: 3.248 Test Acc: 0.115
Validation loss decreased (-0.108203 --> -0.115262).  Saving model ...
Epoch: 13 cost time: 1.0650005340576172
Epoch: 13, Steps: 10 | Train Loss: 2.460 Vali Loss: 3.249 Vali Acc: 0.119 Test Loss: 3.249 Test Acc: 0.119
Validation loss decreased (-0.115262 --> -0.118791).  Saving model ...
Epoch: 14 cost time: 1.2416541576385498
Epoch: 14, Steps: 10 | Train Loss: 2.315 Vali Loss: 3.245 Vali Acc: 0.134 Test Loss: 3.245 Test Acc: 0.134
Validation loss decreased (-0.118791 --> -0.134085).  Saving model ...
Epoch: 15 cost time: 1.269958257675171
Epoch: 15, Steps: 10 | Train Loss: 2.251 Vali Loss: 3.239 Vali Acc: 0.146 Test Loss: 3.239 Test Acc: 0.146
Validation loss decreased (-0.134085 --> -0.145850).  Saving model ...
Epoch: 16 cost time: 1.3391354084014893
Epoch: 16, Steps: 10 | Train Loss: 2.105 Vali Loss: 3.232 Vali Acc: 0.149 Test Loss: 3.232 Test Acc: 0.149
Validation loss decreased (-0.145850 --> -0.149379).  Saving model ...
Epoch: 17 cost time: 1.2252724170684814
Epoch: 17, Steps: 10 | Train Loss: 1.929 Vali Loss: 3.264 Vali Acc: 0.153 Test Loss: 3.264 Test Acc: 0.153
Validation loss decreased (-0.149379 --> -0.152909).  Saving model ...
Epoch: 18 cost time: 1.2472751140594482
Epoch: 18, Steps: 10 | Train Loss: 1.816 Vali Loss: 3.239 Vali Acc: 0.164 Test Loss: 3.239 Test Acc: 0.164
Validation loss decreased (-0.152909 --> -0.163497).  Saving model ...
Epoch: 19 cost time: 1.2428224086761475
Epoch: 19, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.271 Vali Acc: 0.168 Test Loss: 3.271 Test Acc: 0.168
Validation loss decreased (-0.163497 --> -0.168203).  Saving model ...
Epoch: 20 cost time: 1.3634822368621826
Epoch: 20, Steps: 10 | Train Loss: 1.609 Vali Loss: 3.253 Vali Acc: 0.172 Test Loss: 3.253 Test Acc: 0.172
Validation loss decreased (-0.168203 --> -0.171732).  Saving model ...
Epoch: 21 cost time: 1.3669157028198242
Epoch: 21, Steps: 10 | Train Loss: 1.495 Vali Loss: 3.232 Vali Acc: 0.192 Test Loss: 3.232 Test Acc: 0.192
Validation loss decreased (-0.171732 --> -0.191732).  Saving model ...
Epoch: 22 cost time: 1.4320311546325684
Epoch: 22, Steps: 10 | Train Loss: 1.347 Vali Loss: 3.271 Vali Acc: 0.175 Test Loss: 3.271 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1875572204589844
Epoch: 23, Steps: 10 | Train Loss: 1.272 Vali Loss: 3.292 Vali Acc: 0.192 Test Loss: 3.292 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2357659339904785
Epoch: 24, Steps: 10 | Train Loss: 1.198 Vali Loss: 3.268 Vali Acc: 0.201 Test Loss: 3.268 Test Acc: 0.201
Validation loss decreased (-0.191732 --> -0.201144).  Saving model ...
Epoch: 25 cost time: 1.2582745552062988
Epoch: 25, Steps: 10 | Train Loss: 1.081 Vali Loss: 3.331 Vali Acc: 0.194 Test Loss: 3.331 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1616675853729248
Epoch: 26, Steps: 10 | Train Loss: 0.973 Vali Loss: 3.325 Vali Acc: 0.202 Test Loss: 3.325 Test Acc: 0.202
Validation loss decreased (-0.201144 --> -0.202320).  Saving model ...
Epoch: 27 cost time: 1.0225064754486084
Epoch: 27, Steps: 10 | Train Loss: 0.879 Vali Loss: 3.381 Vali Acc: 0.209 Test Loss: 3.381 Test Acc: 0.209
Validation loss decreased (-0.202320 --> -0.209378).  Saving model ...
Epoch: 28 cost time: 1.1698088645935059
Epoch: 28, Steps: 10 | Train Loss: 0.776 Vali Loss: 3.348 Vali Acc: 0.216 Test Loss: 3.348 Test Acc: 0.216
Validation loss decreased (-0.209378 --> -0.216437).  Saving model ...
Epoch: 29 cost time: 1.284376621246338
Epoch: 29, Steps: 10 | Train Loss: 0.643 Vali Loss: 3.422 Vali Acc: 0.231 Test Loss: 3.422 Test Acc: 0.231
Validation loss decreased (-0.216437 --> -0.230554).  Saving model ...
Epoch: 30 cost time: 1.0923995971679688
Epoch: 30, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.407 Vali Acc: 0.216 Test Loss: 3.407 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0727710723876953
Epoch: 31, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.563 Vali Acc: 0.199 Test Loss: 3.563 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.427422046661377
Epoch: 32, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.473 Vali Acc: 0.209 Test Loss: 3.473 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3094277381896973
Epoch: 33, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.600 Vali Acc: 0.220 Test Loss: 3.600 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0698676109313965
Epoch: 34, Steps: 10 | Train Loss: 0.328 Vali Loss: 3.534 Vali Acc: 0.238 Test Loss: 3.534 Test Acc: 0.238
Validation loss decreased (-0.230554 --> -0.237612).  Saving model ...
Epoch: 35 cost time: 1.1848866939544678
Epoch: 35, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.629 Vali Acc: 0.229 Test Loss: 3.629 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1732876300811768
Epoch: 36, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.663 Vali Acc: 0.235 Test Loss: 3.663 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3738512992858887
Epoch: 37, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.687 Vali Acc: 0.220 Test Loss: 3.687 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1312775611877441
Epoch: 38, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.729 Vali Acc: 0.227 Test Loss: 3.729 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.417473554611206
Epoch: 39, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.721 Vali Acc: 0.231 Test Loss: 3.721 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.129166603088379
Epoch: 40, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.808 Vali Acc: 0.246 Test Loss: 3.808 Test Acc: 0.246
Validation loss decreased (-0.237612 --> -0.245844).  Saving model ...
Epoch: 41 cost time: 1.1617920398712158
Epoch: 41, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.767 Vali Acc: 0.247 Test Loss: 3.767 Test Acc: 0.247
Validation loss decreased (-0.245844 --> -0.247021).  Saving model ...
Epoch: 42 cost time: 1.312424659729004
Epoch: 42, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.837 Vali Acc: 0.232 Test Loss: 3.837 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9238851070404053
Epoch: 43, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.925 Vali Acc: 0.236 Test Loss: 3.925 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.200040578842163
Epoch: 44, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.879 Vali Acc: 0.249 Test Loss: 3.879 Test Acc: 0.249
Validation loss decreased (-0.247021 --> -0.249373).  Saving model ...
Epoch: 45 cost time: 1.1266322135925293
Epoch: 45, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.894 Vali Acc: 0.246 Test Loss: 3.894 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.299924612045288
Epoch: 46, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.915 Vali Acc: 0.252 Test Loss: 3.915 Test Acc: 0.252
Validation loss decreased (-0.249373 --> -0.251726).  Saving model ...
Epoch: 47 cost time: 1.1189088821411133
Epoch: 47, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.929 Vali Acc: 0.258 Test Loss: 3.929 Test Acc: 0.258
Validation loss decreased (-0.251726 --> -0.257608).  Saving model ...
Epoch: 48 cost time: 1.2822930812835693
Epoch: 48, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.952 Vali Acc: 0.245 Test Loss: 3.952 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.273071050643921
Epoch: 49, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.984 Vali Acc: 0.245 Test Loss: 3.984 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1394376754760742
Epoch: 50, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.008 Vali Acc: 0.248 Test Loss: 4.008 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.3393499851226807
Epoch: 51, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.009 Vali Acc: 0.247 Test Loss: 4.009 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2545428276062012
Epoch: 52, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.035 Vali Acc: 0.258 Test Loss: 4.035 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1866533756256104
Epoch: 53, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.029 Vali Acc: 0.256 Test Loss: 4.029 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.3050687313079834
Epoch: 54, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.057 Vali Acc: 0.256 Test Loss: 4.057 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.2511677742004395
Epoch: 55, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.091 Vali Acc: 0.245 Test Loss: 4.091 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.1088473796844482
Epoch: 56, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.087 Vali Acc: 0.254 Test Loss: 4.087 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.186206579208374
Epoch: 57, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.103 Vali Acc: 0.252 Test Loss: 4.103 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 615434
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5333406925201416
Epoch: 1, Steps: 10 | Train Loss: 3.445 Vali Loss: 3.334 Vali Acc: 0.031 Test Loss: 3.334 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 1.097438097000122
Epoch: 2, Steps: 10 | Train Loss: 3.359 Vali Loss: 3.298 Vali Acc: 0.049 Test Loss: 3.298 Test Acc: 0.049
Validation loss decreased (-0.030555 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 1.1346194744110107
Epoch: 3, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.317 Vali Acc: 0.047 Test Loss: 3.317 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9469237327575684
Epoch: 4, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.333 Vali Acc: 0.040 Test Loss: 3.333 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1126394271850586
Epoch: 5, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.316 Vali Acc: 0.046 Test Loss: 3.316 Test Acc: 0.046
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1525936126708984
Epoch: 6, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.307 Vali Acc: 0.060 Test Loss: 3.307 Test Acc: 0.060
Validation loss decreased (-0.049379 --> -0.059967).  Saving model ...
Epoch: 7 cost time: 1.3901965618133545
Epoch: 7, Steps: 10 | Train Loss: 3.105 Vali Loss: 3.303 Vali Acc: 0.065 Test Loss: 3.303 Test Acc: 0.065
Validation loss decreased (-0.059967 --> -0.064673).  Saving model ...
Epoch: 8 cost time: 1.0950777530670166
Epoch: 8, Steps: 10 | Train Loss: 3.115 Vali Loss: 3.292 Vali Acc: 0.071 Test Loss: 3.292 Test Acc: 0.071
Validation loss decreased (-0.064673 --> -0.070555).  Saving model ...
Epoch: 9 cost time: 1.2262892723083496
Epoch: 9, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.295 Vali Acc: 0.068 Test Loss: 3.295 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1128714084625244
Epoch: 10, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.267 Vali Acc: 0.080 Test Loss: 3.267 Test Acc: 0.080
Validation loss decreased (-0.070555 --> -0.079967).  Saving model ...
Epoch: 11 cost time: 1.2188241481781006
Epoch: 11, Steps: 10 | Train Loss: 2.893 Vali Loss: 3.272 Vali Acc: 0.079 Test Loss: 3.272 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.164842128753662
Epoch: 12, Steps: 10 | Train Loss: 2.834 Vali Loss: 3.245 Vali Acc: 0.093 Test Loss: 3.245 Test Acc: 0.093
Validation loss decreased (-0.079967 --> -0.092909).  Saving model ...
Epoch: 13 cost time: 1.266937017440796
Epoch: 13, Steps: 10 | Train Loss: 2.726 Vali Loss: 3.255 Vali Acc: 0.096 Test Loss: 3.255 Test Acc: 0.096
Validation loss decreased (-0.092909 --> -0.096438).  Saving model ...
Epoch: 14 cost time: 1.1570415496826172
Epoch: 14, Steps: 10 | Train Loss: 2.655 Vali Loss: 3.234 Vali Acc: 0.113 Test Loss: 3.234 Test Acc: 0.113
Validation loss decreased (-0.096438 --> -0.112909).  Saving model ...
Epoch: 15 cost time: 1.113725185394287
Epoch: 15, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.222 Vali Acc: 0.113 Test Loss: 3.222 Test Acc: 0.113
Validation loss decreased (-0.112909 --> -0.112909).  Saving model ...
Epoch: 16 cost time: 1.2721147537231445
Epoch: 16, Steps: 10 | Train Loss: 2.445 Vali Loss: 3.206 Vali Acc: 0.120 Test Loss: 3.206 Test Acc: 0.120
Validation loss decreased (-0.112909 --> -0.119968).  Saving model ...
Epoch: 17 cost time: 1.2790284156799316
Epoch: 17, Steps: 10 | Train Loss: 2.397 Vali Loss: 3.218 Vali Acc: 0.124 Test Loss: 3.218 Test Acc: 0.124
Validation loss decreased (-0.119968 --> -0.123497).  Saving model ...
Epoch: 18 cost time: 1.0719590187072754
Epoch: 18, Steps: 10 | Train Loss: 2.310 Vali Loss: 3.176 Vali Acc: 0.129 Test Loss: 3.176 Test Acc: 0.129
Validation loss decreased (-0.123497 --> -0.129380).  Saving model ...
Epoch: 19 cost time: 1.3990609645843506
Epoch: 19, Steps: 10 | Train Loss: 2.242 Vali Loss: 3.215 Vali Acc: 0.124 Test Loss: 3.215 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1551659107208252
Epoch: 20, Steps: 10 | Train Loss: 2.160 Vali Loss: 3.171 Vali Acc: 0.152 Test Loss: 3.171 Test Acc: 0.152
Validation loss decreased (-0.129380 --> -0.151733).  Saving model ...
Epoch: 21 cost time: 1.1873774528503418
Epoch: 21, Steps: 10 | Train Loss: 2.079 Vali Loss: 3.207 Vali Acc: 0.135 Test Loss: 3.207 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.298882246017456
Epoch: 22, Steps: 10 | Train Loss: 1.950 Vali Loss: 3.164 Vali Acc: 0.152 Test Loss: 3.164 Test Acc: 0.152
Validation loss decreased (-0.151733 --> -0.151733).  Saving model ...
Epoch: 23 cost time: 1.2176945209503174
Epoch: 23, Steps: 10 | Train Loss: 1.937 Vali Loss: 3.223 Vali Acc: 0.135 Test Loss: 3.223 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4275975227355957
Epoch: 24, Steps: 10 | Train Loss: 1.806 Vali Loss: 3.168 Vali Acc: 0.168 Test Loss: 3.168 Test Acc: 0.168
Validation loss decreased (-0.151733 --> -0.168204).  Saving model ...
Epoch: 25 cost time: 1.2451934814453125
Epoch: 25, Steps: 10 | Train Loss: 1.746 Vali Loss: 3.229 Vali Acc: 0.138 Test Loss: 3.229 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.250365972518921
Epoch: 26, Steps: 10 | Train Loss: 1.695 Vali Loss: 3.163 Vali Acc: 0.167 Test Loss: 3.163 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1760952472686768
Epoch: 27, Steps: 10 | Train Loss: 1.629 Vali Loss: 3.173 Vali Acc: 0.167 Test Loss: 3.173 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4782578945159912
Epoch: 28, Steps: 10 | Train Loss: 1.515 Vali Loss: 3.210 Vali Acc: 0.147 Test Loss: 3.210 Test Acc: 0.147
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0824518203735352
Epoch: 29, Steps: 10 | Train Loss: 1.500 Vali Loss: 3.158 Vali Acc: 0.167 Test Loss: 3.158 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1263272762298584
Epoch: 30, Steps: 10 | Train Loss: 1.362 Vali Loss: 3.182 Vali Acc: 0.174 Test Loss: 3.182 Test Acc: 0.174
Validation loss decreased (-0.168204 --> -0.174086).  Saving model ...
Epoch: 31 cost time: 1.3467154502868652
Epoch: 31, Steps: 10 | Train Loss: 1.297 Vali Loss: 3.234 Vali Acc: 0.166 Test Loss: 3.234 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.381460189819336
Epoch: 32, Steps: 10 | Train Loss: 1.180 Vali Loss: 3.181 Vali Acc: 0.188 Test Loss: 3.181 Test Acc: 0.188
Validation loss decreased (-0.174086 --> -0.188203).  Saving model ...
Epoch: 33 cost time: 1.3274264335632324
Epoch: 33, Steps: 10 | Train Loss: 1.090 Vali Loss: 3.201 Vali Acc: 0.181 Test Loss: 3.201 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3181562423706055
Epoch: 34, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.229 Vali Acc: 0.187 Test Loss: 3.229 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4842069149017334
Epoch: 35, Steps: 10 | Train Loss: 0.978 Vali Loss: 3.215 Vali Acc: 0.196 Test Loss: 3.215 Test Acc: 0.196
Validation loss decreased (-0.188203 --> -0.196438).  Saving model ...
Epoch: 36 cost time: 1.3073923587799072
Epoch: 36, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.258 Vali Acc: 0.185 Test Loss: 3.258 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5606083869934082
Epoch: 37, Steps: 10 | Train Loss: 0.837 Vali Loss: 3.258 Vali Acc: 0.198 Test Loss: 3.258 Test Acc: 0.198
Validation loss decreased (-0.196438 --> -0.197614).  Saving model ...
Epoch: 38 cost time: 1.2534716129302979
Epoch: 38, Steps: 10 | Train Loss: 0.727 Vali Loss: 3.287 Vali Acc: 0.192 Test Loss: 3.287 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3049676418304443
Epoch: 39, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.306 Vali Acc: 0.202 Test Loss: 3.306 Test Acc: 0.202
Validation loss decreased (-0.197614 --> -0.202320).  Saving model ...
Epoch: 40 cost time: 1.1329472064971924
Epoch: 40, Steps: 10 | Train Loss: 0.638 Vali Loss: 3.289 Vali Acc: 0.196 Test Loss: 3.289 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1664819717407227
Epoch: 41, Steps: 10 | Train Loss: 0.567 Vali Loss: 3.335 Vali Acc: 0.202 Test Loss: 3.335 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2851109504699707
Epoch: 42, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.389 Vali Acc: 0.198 Test Loss: 3.389 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2435929775238037
Epoch: 43, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.284 Vali Acc: 0.221 Test Loss: 3.284 Test Acc: 0.221
Validation loss decreased (-0.202320 --> -0.221144).  Saving model ...
Epoch: 44 cost time: 1.0915820598602295
Epoch: 44, Steps: 10 | Train Loss: 0.398 Vali Loss: 3.371 Vali Acc: 0.205 Test Loss: 3.371 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1998608112335205
Epoch: 45, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.449 Vali Acc: 0.201 Test Loss: 3.449 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3642311096191406
Epoch: 46, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.451 Vali Acc: 0.201 Test Loss: 3.451 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3322176933288574
Epoch: 47, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.399 Vali Acc: 0.206 Test Loss: 3.399 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.4194676876068115
Epoch: 48, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.482 Vali Acc: 0.211 Test Loss: 3.482 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3825440406799316
Epoch: 49, Steps: 10 | Train Loss: 0.217 Vali Loss: 3.485 Vali Acc: 0.212 Test Loss: 3.485 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.064774751663208
Epoch: 50, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.598 Vali Acc: 0.200 Test Loss: 3.598 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.2241747379302979
Epoch: 51, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.511 Vali Acc: 0.219 Test Loss: 3.511 Test Acc: 0.219
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.3173537254333496
Epoch: 52, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.581 Vali Acc: 0.201 Test Loss: 3.581 Test Acc: 0.201
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.2262184619903564
Epoch: 53, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.645 Vali Acc: 0.206 Test Loss: 3.645 Test Acc: 0.206
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2211764705882353
model parameter : 603498
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6653048992156982
Epoch: 1, Steps: 10 | Train Loss: 3.466 Vali Loss: 3.450 Vali Acc: 0.035 Test Loss: 3.450 Test Acc: 0.035
Validation loss decreased (inf --> -0.035260).  Saving model ...
Epoch: 2 cost time: 1.2626721858978271
Epoch: 2, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.357 Vali Acc: 0.041 Test Loss: 3.357 Test Acc: 0.041
Validation loss decreased (-0.035260 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 1.0652673244476318
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.356 Vali Acc: 0.035 Test Loss: 3.356 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.030564308166504
Epoch: 4, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.341 Vali Acc: 0.055 Test Loss: 3.341 Test Acc: 0.055
Validation loss decreased (-0.041143 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 1.052039623260498
Epoch: 5, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.358 Vali Acc: 0.053 Test Loss: 3.358 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3935894966125488
Epoch: 6, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.357 Vali Acc: 0.051 Test Loss: 3.357 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.121060848236084
Epoch: 7, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.333 Vali Acc: 0.069 Test Loss: 3.333 Test Acc: 0.069
Validation loss decreased (-0.055261 --> -0.069378).  Saving model ...
Epoch: 8 cost time: 1.2627215385437012
Epoch: 8, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.312 Vali Acc: 0.068 Test Loss: 3.312 Test Acc: 0.068
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3237814903259277
Epoch: 9, Steps: 10 | Train Loss: 3.053 Vali Loss: 3.308 Vali Acc: 0.075 Test Loss: 3.308 Test Acc: 0.075
Validation loss decreased (-0.069378 --> -0.075261).  Saving model ...
Epoch: 10 cost time: 1.2483999729156494
Epoch: 10, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.324 Vali Acc: 0.087 Test Loss: 3.324 Test Acc: 0.087
Validation loss decreased (-0.075261 --> -0.087026).  Saving model ...
Epoch: 11 cost time: 1.09763503074646
Epoch: 11, Steps: 10 | Train Loss: 2.925 Vali Loss: 3.300 Vali Acc: 0.085 Test Loss: 3.300 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2978577613830566
Epoch: 12, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.292 Vali Acc: 0.104 Test Loss: 3.292 Test Acc: 0.104
Validation loss decreased (-0.087026 --> -0.103496).  Saving model ...
Epoch: 13 cost time: 1.2916932106018066
Epoch: 13, Steps: 10 | Train Loss: 2.762 Vali Loss: 3.307 Vali Acc: 0.100 Test Loss: 3.307 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0380682945251465
Epoch: 14, Steps: 10 | Train Loss: 2.641 Vali Loss: 3.267 Vali Acc: 0.115 Test Loss: 3.267 Test Acc: 0.115
Validation loss decreased (-0.103496 --> -0.115261).  Saving model ...
Epoch: 15 cost time: 1.1016685962677002
Epoch: 15, Steps: 10 | Train Loss: 2.589 Vali Loss: 3.258 Vali Acc: 0.109 Test Loss: 3.258 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1379518508911133
Epoch: 16, Steps: 10 | Train Loss: 2.497 Vali Loss: 3.246 Vali Acc: 0.114 Test Loss: 3.246 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3090198040008545
Epoch: 17, Steps: 10 | Train Loss: 2.379 Vali Loss: 3.223 Vali Acc: 0.119 Test Loss: 3.223 Test Acc: 0.119
Validation loss decreased (-0.115261 --> -0.118791).  Saving model ...
Epoch: 18 cost time: 0.9954845905303955
Epoch: 18, Steps: 10 | Train Loss: 2.292 Vali Loss: 3.229 Vali Acc: 0.120 Test Loss: 3.229 Test Acc: 0.120
Validation loss decreased (-0.118791 --> -0.119968).  Saving model ...
Epoch: 19 cost time: 1.1404898166656494
Epoch: 19, Steps: 10 | Train Loss: 2.200 Vali Loss: 3.227 Vali Acc: 0.124 Test Loss: 3.227 Test Acc: 0.124
Validation loss decreased (-0.119968 --> -0.123497).  Saving model ...
Epoch: 20 cost time: 1.2966179847717285
Epoch: 20, Steps: 10 | Train Loss: 2.140 Vali Loss: 3.223 Vali Acc: 0.134 Test Loss: 3.223 Test Acc: 0.134
Validation loss decreased (-0.123497 --> -0.134085).  Saving model ...
Epoch: 21 cost time: 1.1955747604370117
Epoch: 21, Steps: 10 | Train Loss: 1.982 Vali Loss: 3.196 Vali Acc: 0.138 Test Loss: 3.196 Test Acc: 0.138
Validation loss decreased (-0.134085 --> -0.137615).  Saving model ...
Epoch: 22 cost time: 1.1177537441253662
Epoch: 22, Steps: 10 | Train Loss: 1.919 Vali Loss: 3.224 Vali Acc: 0.144 Test Loss: 3.224 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143497).  Saving model ...
Epoch: 23 cost time: 1.1759064197540283
Epoch: 23, Steps: 10 | Train Loss: 1.797 Vali Loss: 3.184 Vali Acc: 0.158 Test Loss: 3.184 Test Acc: 0.158
Validation loss decreased (-0.143497 --> -0.157615).  Saving model ...
Epoch: 24 cost time: 1.3347153663635254
Epoch: 24, Steps: 10 | Train Loss: 1.794 Vali Loss: 3.185 Vali Acc: 0.161 Test Loss: 3.185 Test Acc: 0.161
Validation loss decreased (-0.157615 --> -0.161145).  Saving model ...
Epoch: 25 cost time: 1.0881845951080322
Epoch: 25, Steps: 10 | Train Loss: 1.650 Vali Loss: 3.227 Vali Acc: 0.165 Test Loss: 3.227 Test Acc: 0.165
Validation loss decreased (-0.161145 --> -0.164674).  Saving model ...
Epoch: 26 cost time: 1.062910795211792
Epoch: 26, Steps: 10 | Train Loss: 1.620 Vali Loss: 3.187 Vali Acc: 0.169 Test Loss: 3.187 Test Acc: 0.169
Validation loss decreased (-0.164674 --> -0.169380).  Saving model ...
Epoch: 27 cost time: 1.274254560470581
Epoch: 27, Steps: 10 | Train Loss: 1.541 Vali Loss: 3.197 Vali Acc: 0.164 Test Loss: 3.197 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2138252258300781
Epoch: 28, Steps: 10 | Train Loss: 1.433 Vali Loss: 3.234 Vali Acc: 0.180 Test Loss: 3.234 Test Acc: 0.180
Validation loss decreased (-0.169380 --> -0.179968).  Saving model ...
Epoch: 29 cost time: 1.2120511531829834
Epoch: 29, Steps: 10 | Train Loss: 1.358 Vali Loss: 3.205 Vali Acc: 0.187 Test Loss: 3.205 Test Acc: 0.187
Validation loss decreased (-0.179968 --> -0.187027).  Saving model ...
Epoch: 30 cost time: 1.1657993793487549
Epoch: 30, Steps: 10 | Train Loss: 1.243 Vali Loss: 3.195 Vali Acc: 0.179 Test Loss: 3.195 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.326310634613037
Epoch: 31, Steps: 10 | Train Loss: 1.192 Vali Loss: 3.291 Vali Acc: 0.173 Test Loss: 3.291 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0353996753692627
Epoch: 32, Steps: 10 | Train Loss: 1.195 Vali Loss: 3.219 Vali Acc: 0.199 Test Loss: 3.219 Test Acc: 0.199
Validation loss decreased (-0.187027 --> -0.198791).  Saving model ...
Epoch: 33 cost time: 1.1828343868255615
Epoch: 33, Steps: 10 | Train Loss: 1.020 Vali Loss: 3.242 Vali Acc: 0.199 Test Loss: 3.242 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1723976135253906
Epoch: 34, Steps: 10 | Train Loss: 0.985 Vali Loss: 3.242 Vali Acc: 0.188 Test Loss: 3.242 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1740927696228027
Epoch: 35, Steps: 10 | Train Loss: 0.858 Vali Loss: 3.274 Vali Acc: 0.212 Test Loss: 3.274 Test Acc: 0.212
Validation loss decreased (-0.198791 --> -0.211732).  Saving model ...
Epoch: 36 cost time: 1.0686094760894775
Epoch: 36, Steps: 10 | Train Loss: 0.774 Vali Loss: 3.297 Vali Acc: 0.198 Test Loss: 3.297 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1354780197143555
Epoch: 37, Steps: 10 | Train Loss: 0.775 Vali Loss: 3.320 Vali Acc: 0.200 Test Loss: 3.320 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.007777214050293
Epoch: 38, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.311 Vali Acc: 0.220 Test Loss: 3.311 Test Acc: 0.220
Validation loss decreased (-0.211732 --> -0.219967).  Saving model ...
Epoch: 39 cost time: 1.1989939212799072
Epoch: 39, Steps: 10 | Train Loss: 0.629 Vali Loss: 3.312 Vali Acc: 0.198 Test Loss: 3.312 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3635680675506592
Epoch: 40, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.371 Vali Acc: 0.211 Test Loss: 3.371 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2859492301940918
Epoch: 41, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.334 Vali Acc: 0.216 Test Loss: 3.334 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2130861282348633
Epoch: 42, Steps: 10 | Train Loss: 0.449 Vali Loss: 3.359 Vali Acc: 0.229 Test Loss: 3.359 Test Acc: 0.229
Validation loss decreased (-0.219967 --> -0.229378).  Saving model ...
Epoch: 43 cost time: 1.118394136428833
Epoch: 43, Steps: 10 | Train Loss: 0.437 Vali Loss: 3.374 Vali Acc: 0.221 Test Loss: 3.374 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1715214252471924
Epoch: 44, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.397 Vali Acc: 0.214 Test Loss: 3.397 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2863750457763672
Epoch: 45, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.418 Vali Acc: 0.229 Test Loss: 3.418 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1785883903503418
Epoch: 46, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.444 Vali Acc: 0.238 Test Loss: 3.444 Test Acc: 0.238
Validation loss decreased (-0.229378 --> -0.237613).  Saving model ...
Epoch: 47 cost time: 1.141028642654419
Epoch: 47, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.489 Vali Acc: 0.229 Test Loss: 3.489 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2122602462768555
Epoch: 48, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.537 Vali Acc: 0.224 Test Loss: 3.537 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3081481456756592
Epoch: 49, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.481 Vali Acc: 0.235 Test Loss: 3.481 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1939888000488281
Epoch: 50, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.667 Vali Acc: 0.215 Test Loss: 3.667 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.1169137954711914
Epoch: 51, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.549 Vali Acc: 0.227 Test Loss: 3.549 Test Acc: 0.227
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.1127772331237793
Epoch: 52, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.592 Vali Acc: 0.238 Test Loss: 3.592 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.1148993968963623
Epoch: 53, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.640 Vali Acc: 0.236 Test Loss: 3.640 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.1452581882476807
Epoch: 54, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.616 Vali Acc: 0.245 Test Loss: 3.616 Test Acc: 0.245
Validation loss decreased (-0.237613 --> -0.244670).  Saving model ...
Epoch: 55 cost time: 1.1315667629241943
Epoch: 55, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.613 Vali Acc: 0.229 Test Loss: 3.613 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0891342163085938
Epoch: 56, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.713 Vali Acc: 0.236 Test Loss: 3.713 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.2824420928955078
Epoch: 57, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.703 Vali Acc: 0.239 Test Loss: 3.703 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.198413372039795
Epoch: 58, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.683 Vali Acc: 0.242 Test Loss: 3.683 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.1194474697113037
Epoch: 59, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.761 Vali Acc: 0.236 Test Loss: 3.761 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.060798168182373
Epoch: 60, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.748 Vali Acc: 0.239 Test Loss: 3.748 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.210521936416626
Epoch: 61, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.751 Vali Acc: 0.240 Test Loss: 3.751 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.1040198802947998
Epoch: 62, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.770 Vali Acc: 0.245 Test Loss: 3.770 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.0827398300170898
Epoch: 63, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.775 Vali Acc: 0.249 Test Loss: 3.775 Test Acc: 0.249
Validation loss decreased (-0.244670 --> -0.249374).  Saving model ...
Epoch: 64 cost time: 1.1802327632904053
Epoch: 64, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.824 Vali Acc: 0.247 Test Loss: 3.824 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.1914656162261963
Epoch: 65, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.815 Vali Acc: 0.232 Test Loss: 3.815 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.0781912803649902
Epoch: 66, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.778 Vali Acc: 0.240 Test Loss: 3.778 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.2145631313323975
Epoch: 67, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.869 Vali Acc: 0.239 Test Loss: 3.869 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.0439088344573975
Epoch: 68, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.881 Vali Acc: 0.251 Test Loss: 3.881 Test Acc: 0.251
Validation loss decreased (-0.249374 --> -0.250549).  Saving model ...
Epoch: 69 cost time: 1.1033506393432617
Epoch: 69, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.845 Vali Acc: 0.245 Test Loss: 3.845 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.1117053031921387
Epoch: 70, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.899 Vali Acc: 0.255 Test Loss: 3.899 Test Acc: 0.255
Validation loss decreased (-0.250549 --> -0.255255).  Saving model ...
Epoch: 71 cost time: 1.1317024230957031
Epoch: 71, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.915 Vali Acc: 0.241 Test Loss: 3.915 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.2005655765533447
Epoch: 72, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.875 Vali Acc: 0.254 Test Loss: 3.875 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.1351163387298584
Epoch: 73, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.886 Vali Acc: 0.249 Test Loss: 3.886 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.0191144943237305
Epoch: 74, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.966 Vali Acc: 0.248 Test Loss: 3.966 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.2475159168243408
Epoch: 75, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.920 Vali Acc: 0.249 Test Loss: 3.920 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.1190927028656006
Epoch: 76, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.964 Vali Acc: 0.253 Test Loss: 3.964 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.0411360263824463
Epoch: 77, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.934 Vali Acc: 0.256 Test Loss: 3.934 Test Acc: 0.256
Validation loss decreased (-0.255255 --> -0.256431).  Saving model ...
Epoch: 78 cost time: 1.12099027633667
Epoch: 78, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.948 Vali Acc: 0.252 Test Loss: 3.948 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.2407379150390625
Epoch: 79, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.947 Vali Acc: 0.249 Test Loss: 3.947 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.0661118030548096
Epoch: 80, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.010 Vali Acc: 0.242 Test Loss: 4.010 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.1113269329071045
Epoch: 81, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.016 Vali Acc: 0.254 Test Loss: 4.016 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.123462200164795
Epoch: 82, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.982 Vali Acc: 0.253 Test Loss: 3.982 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 1.1104793548583984
Epoch: 83, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.984 Vali Acc: 0.252 Test Loss: 3.984 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 1.1045880317687988
Epoch: 84, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.036 Vali Acc: 0.245 Test Loss: 4.036 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.9378907680511475
Epoch: 85, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.051 Vali Acc: 0.254 Test Loss: 4.051 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 1.3277161121368408
Epoch: 86, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.081 Vali Acc: 0.245 Test Loss: 4.081 Test Acc: 0.245
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 1.0373690128326416
Epoch: 87, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.017 Vali Acc: 0.256 Test Loss: 4.017 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 602730
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6502797603607178
Epoch: 1, Steps: 10 | Train Loss: 3.345 Vali Loss: 3.332 Vali Acc: 0.038 Test Loss: 3.332 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.082033395767212
Epoch: 2, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.304 Vali Acc: 0.056 Test Loss: 3.304 Test Acc: 0.056
Validation loss decreased (-0.037614 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 1.2441859245300293
Epoch: 3, Steps: 10 | Train Loss: 3.261 Vali Loss: 3.325 Vali Acc: 0.047 Test Loss: 3.325 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2176940441131592
Epoch: 4, Steps: 10 | Train Loss: 3.175 Vali Loss: 3.321 Vali Acc: 0.051 Test Loss: 3.321 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1625001430511475
Epoch: 5, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.318 Vali Acc: 0.051 Test Loss: 3.318 Test Acc: 0.051
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0010302066802979
Epoch: 6, Steps: 10 | Train Loss: 3.118 Vali Loss: 3.313 Vali Acc: 0.068 Test Loss: 3.313 Test Acc: 0.068
Validation loss decreased (-0.056438 --> -0.068202).  Saving model ...
Epoch: 7 cost time: 1.2999813556671143
Epoch: 7, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.312 Vali Acc: 0.059 Test Loss: 3.312 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2782533168792725
Epoch: 8, Steps: 10 | Train Loss: 3.019 Vali Loss: 3.282 Vali Acc: 0.081 Test Loss: 3.282 Test Acc: 0.081
Validation loss decreased (-0.068202 --> -0.081144).  Saving model ...
Epoch: 9 cost time: 1.053619384765625
Epoch: 9, Steps: 10 | Train Loss: 2.972 Vali Loss: 3.270 Vali Acc: 0.081 Test Loss: 3.270 Test Acc: 0.081
Validation loss decreased (-0.081144 --> -0.081144).  Saving model ...
Epoch: 10 cost time: 1.1444599628448486
Epoch: 10, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.276 Vali Acc: 0.073 Test Loss: 3.276 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1097228527069092
Epoch: 11, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.248 Vali Acc: 0.086 Test Loss: 3.248 Test Acc: 0.086
Validation loss decreased (-0.081144 --> -0.085850).  Saving model ...
Epoch: 12 cost time: 1.0509006977081299
Epoch: 12, Steps: 10 | Train Loss: 2.755 Vali Loss: 3.246 Vali Acc: 0.098 Test Loss: 3.246 Test Acc: 0.098
Validation loss decreased (-0.085850 --> -0.097615).  Saving model ...
Epoch: 13 cost time: 0.9474153518676758
Epoch: 13, Steps: 10 | Train Loss: 2.664 Vali Loss: 3.236 Vali Acc: 0.088 Test Loss: 3.236 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.235196828842163
Epoch: 14, Steps: 10 | Train Loss: 2.586 Vali Loss: 3.246 Vali Acc: 0.102 Test Loss: 3.246 Test Acc: 0.102
Validation loss decreased (-0.097615 --> -0.102320).  Saving model ...
Epoch: 15 cost time: 1.0590276718139648
Epoch: 15, Steps: 10 | Train Loss: 2.477 Vali Loss: 3.230 Vali Acc: 0.116 Test Loss: 3.230 Test Acc: 0.116
Validation loss decreased (-0.102320 --> -0.116438).  Saving model ...
Epoch: 16 cost time: 1.1928303241729736
Epoch: 16, Steps: 10 | Train Loss: 2.377 Vali Loss: 3.212 Vali Acc: 0.121 Test Loss: 3.212 Test Acc: 0.121
Validation loss decreased (-0.116438 --> -0.121144).  Saving model ...
Epoch: 17 cost time: 1.151120662689209
Epoch: 17, Steps: 10 | Train Loss: 2.284 Vali Loss: 3.212 Vali Acc: 0.128 Test Loss: 3.212 Test Acc: 0.128
Validation loss decreased (-0.121144 --> -0.128203).  Saving model ...
Epoch: 18 cost time: 1.1346018314361572
Epoch: 18, Steps: 10 | Train Loss: 2.228 Vali Loss: 3.237 Vali Acc: 0.136 Test Loss: 3.237 Test Acc: 0.136
Validation loss decreased (-0.128203 --> -0.136438).  Saving model ...
Epoch: 19 cost time: 1.0556120872497559
Epoch: 19, Steps: 10 | Train Loss: 2.112 Vali Loss: 3.213 Vali Acc: 0.140 Test Loss: 3.213 Test Acc: 0.140
Validation loss decreased (-0.136438 --> -0.139968).  Saving model ...
Epoch: 20 cost time: 1.0344209671020508
Epoch: 20, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.168 Vali Acc: 0.158 Test Loss: 3.168 Test Acc: 0.158
Validation loss decreased (-0.139968 --> -0.157615).  Saving model ...
Epoch: 21 cost time: 1.1897101402282715
Epoch: 21, Steps: 10 | Train Loss: 2.014 Vali Loss: 3.235 Vali Acc: 0.148 Test Loss: 3.235 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1801695823669434
Epoch: 22, Steps: 10 | Train Loss: 1.895 Vali Loss: 3.190 Vali Acc: 0.171 Test Loss: 3.190 Test Acc: 0.171
Validation loss decreased (-0.157615 --> -0.170556).  Saving model ...
Epoch: 23 cost time: 1.0907607078552246
Epoch: 23, Steps: 10 | Train Loss: 1.830 Vali Loss: 3.200 Vali Acc: 0.166 Test Loss: 3.200 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2886316776275635
Epoch: 24, Steps: 10 | Train Loss: 1.674 Vali Loss: 3.210 Vali Acc: 0.186 Test Loss: 3.210 Test Acc: 0.186
Validation loss decreased (-0.170556 --> -0.185850).  Saving model ...
Epoch: 25 cost time: 1.047903299331665
Epoch: 25, Steps: 10 | Train Loss: 1.637 Vali Loss: 3.201 Vali Acc: 0.149 Test Loss: 3.201 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1817843914031982
Epoch: 26, Steps: 10 | Train Loss: 1.599 Vali Loss: 3.234 Vali Acc: 0.180 Test Loss: 3.234 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1248114109039307
Epoch: 27, Steps: 10 | Train Loss: 1.494 Vali Loss: 3.237 Vali Acc: 0.176 Test Loss: 3.237 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.096174716949463
Epoch: 28, Steps: 10 | Train Loss: 1.441 Vali Loss: 3.207 Vali Acc: 0.200 Test Loss: 3.207 Test Acc: 0.200
Validation loss decreased (-0.185850 --> -0.199968).  Saving model ...
Epoch: 29 cost time: 1.0350539684295654
Epoch: 29, Steps: 10 | Train Loss: 1.335 Vali Loss: 3.211 Vali Acc: 0.193 Test Loss: 3.211 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0041444301605225
Epoch: 30, Steps: 10 | Train Loss: 1.264 Vali Loss: 3.221 Vali Acc: 0.201 Test Loss: 3.221 Test Acc: 0.201
Validation loss decreased (-0.199968 --> -0.201144).  Saving model ...
Epoch: 31 cost time: 1.066413402557373
Epoch: 31, Steps: 10 | Train Loss: 1.183 Vali Loss: 3.236 Vali Acc: 0.181 Test Loss: 3.236 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0037403106689453
Epoch: 32, Steps: 10 | Train Loss: 1.074 Vali Loss: 3.276 Vali Acc: 0.196 Test Loss: 3.276 Test Acc: 0.196
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2857837677001953
Epoch: 33, Steps: 10 | Train Loss: 1.023 Vali Loss: 3.260 Vali Acc: 0.188 Test Loss: 3.260 Test Acc: 0.188
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0648844242095947
Epoch: 34, Steps: 10 | Train Loss: 0.985 Vali Loss: 3.288 Vali Acc: 0.205 Test Loss: 3.288 Test Acc: 0.205
Validation loss decreased (-0.201144 --> -0.204673).  Saving model ...
Epoch: 35 cost time: 1.101531982421875
Epoch: 35, Steps: 10 | Train Loss: 0.990 Vali Loss: 3.306 Vali Acc: 0.196 Test Loss: 3.306 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.095489740371704
Epoch: 36, Steps: 10 | Train Loss: 0.872 Vali Loss: 3.273 Vali Acc: 0.232 Test Loss: 3.273 Test Acc: 0.232
Validation loss decreased (-0.204673 --> -0.231732).  Saving model ...
Epoch: 37 cost time: 1.121699571609497
Epoch: 37, Steps: 10 | Train Loss: 0.769 Vali Loss: 3.295 Vali Acc: 0.208 Test Loss: 3.295 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.094592571258545
Epoch: 38, Steps: 10 | Train Loss: 0.757 Vali Loss: 3.375 Vali Acc: 0.202 Test Loss: 3.375 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.205418586730957
Epoch: 39, Steps: 10 | Train Loss: 0.645 Vali Loss: 3.269 Vali Acc: 0.224 Test Loss: 3.269 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.12760329246521
Epoch: 40, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.367 Vali Acc: 0.222 Test Loss: 3.367 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0463151931762695
Epoch: 41, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.290 Vali Acc: 0.239 Test Loss: 3.290 Test Acc: 0.239
Validation loss decreased (-0.231732 --> -0.238791).  Saving model ...
Epoch: 42 cost time: 0.9571161270141602
Epoch: 42, Steps: 10 | Train Loss: 0.480 Vali Loss: 3.324 Vali Acc: 0.219 Test Loss: 3.324 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0734546184539795
Epoch: 43, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.417 Vali Acc: 0.224 Test Loss: 3.417 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0131139755249023
Epoch: 44, Steps: 10 | Train Loss: 0.416 Vali Loss: 3.341 Vali Acc: 0.224 Test Loss: 3.341 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1453235149383545
Epoch: 45, Steps: 10 | Train Loss: 0.346 Vali Loss: 3.349 Vali Acc: 0.227 Test Loss: 3.349 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.135998249053955
Epoch: 46, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.397 Vali Acc: 0.226 Test Loss: 3.397 Test Acc: 0.226
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0759167671203613
Epoch: 47, Steps: 10 | Train Loss: 0.275 Vali Loss: 3.472 Vali Acc: 0.234 Test Loss: 3.472 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2073719501495361
Epoch: 48, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.413 Vali Acc: 0.245 Test Loss: 3.413 Test Acc: 0.245
Validation loss decreased (-0.238791 --> -0.244672).  Saving model ...
Epoch: 49 cost time: 1.1464648246765137
Epoch: 49, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.465 Vali Acc: 0.238 Test Loss: 3.465 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1772465705871582
Epoch: 50, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.465 Vali Acc: 0.248 Test Loss: 3.465 Test Acc: 0.248
Validation loss decreased (-0.244672 --> -0.248201).  Saving model ...
Epoch: 51 cost time: 1.1693124771118164
Epoch: 51, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.494 Vali Acc: 0.244 Test Loss: 3.494 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1417250633239746
Epoch: 52, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.534 Vali Acc: 0.245 Test Loss: 3.534 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1034917831420898
Epoch: 53, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.531 Vali Acc: 0.234 Test Loss: 3.531 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.366995096206665
Epoch: 54, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.541 Vali Acc: 0.247 Test Loss: 3.541 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.1175193786621094
Epoch: 55, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.522 Vali Acc: 0.244 Test Loss: 3.522 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.162545919418335
Epoch: 56, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.646 Vali Acc: 0.234 Test Loss: 3.646 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.146252155303955
Epoch: 57, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.597 Vali Acc: 0.241 Test Loss: 3.597 Test Acc: 0.241
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.232234001159668
Epoch: 58, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.792 Vali Acc: 0.215 Test Loss: 3.792 Test Acc: 0.215
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.1329448223114014
Epoch: 59, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.695 Vali Acc: 0.239 Test Loss: 3.695 Test Acc: 0.239
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.1786727905273438
Epoch: 60, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.615 Vali Acc: 0.246 Test Loss: 3.615 Test Acc: 0.246
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24823529411764705
model parameter : 601962
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5826776027679443
Epoch: 1, Steps: 10 | Train Loss: 3.468 Vali Loss: 3.329 Vali Acc: 0.028 Test Loss: 3.329 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 1.0968623161315918
Epoch: 2, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.305 Vali Acc: 0.032 Test Loss: 3.305 Test Acc: 0.032
Validation loss decreased (-0.028202 --> -0.031732).  Saving model ...
Epoch: 3 cost time: 0.9855399131774902
Epoch: 3, Steps: 10 | Train Loss: 3.239 Vali Loss: 3.344 Vali Acc: 0.048 Test Loss: 3.344 Test Acc: 0.048
Validation loss decreased (-0.031732 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 1.04183030128479
Epoch: 4, Steps: 10 | Train Loss: 3.201 Vali Loss: 3.362 Vali Acc: 0.048 Test Loss: 3.362 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1787354946136475
Epoch: 5, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.349 Vali Acc: 0.055 Test Loss: 3.349 Test Acc: 0.055
Validation loss decreased (-0.048202 --> -0.055261).  Saving model ...
Epoch: 6 cost time: 1.2643554210662842
Epoch: 6, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.348 Vali Acc: 0.061 Test Loss: 3.348 Test Acc: 0.061
Validation loss decreased (-0.055261 --> -0.061143).  Saving model ...
Epoch: 7 cost time: 1.103667974472046
Epoch: 7, Steps: 10 | Train Loss: 3.104 Vali Loss: 3.354 Vali Acc: 0.053 Test Loss: 3.354 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2106904983520508
Epoch: 8, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.330 Vali Acc: 0.065 Test Loss: 3.330 Test Acc: 0.065
Validation loss decreased (-0.061143 --> -0.064673).  Saving model ...
Epoch: 9 cost time: 0.9804832935333252
Epoch: 9, Steps: 10 | Train Loss: 2.956 Vali Loss: 3.326 Vali Acc: 0.065 Test Loss: 3.326 Test Acc: 0.065
Validation loss decreased (-0.064673 --> -0.064673).  Saving model ...
Epoch: 10 cost time: 0.9929299354553223
Epoch: 10, Steps: 10 | Train Loss: 2.903 Vali Loss: 3.320 Vali Acc: 0.074 Test Loss: 3.320 Test Acc: 0.074
Validation loss decreased (-0.064673 --> -0.074084).  Saving model ...
Epoch: 11 cost time: 1.0724422931671143
Epoch: 11, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.317 Vali Acc: 0.071 Test Loss: 3.317 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0388405323028564
Epoch: 12, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.304 Vali Acc: 0.075 Test Loss: 3.304 Test Acc: 0.075
Validation loss decreased (-0.074084 --> -0.075261).  Saving model ...
Epoch: 13 cost time: 1.097292184829712
Epoch: 13, Steps: 10 | Train Loss: 2.638 Vali Loss: 3.310 Vali Acc: 0.075 Test Loss: 3.310 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0642545223236084
Epoch: 14, Steps: 10 | Train Loss: 2.632 Vali Loss: 3.301 Vali Acc: 0.086 Test Loss: 3.301 Test Acc: 0.086
Validation loss decreased (-0.075261 --> -0.085849).  Saving model ...
Epoch: 15 cost time: 1.1908988952636719
Epoch: 15, Steps: 10 | Train Loss: 2.571 Vali Loss: 3.287 Vali Acc: 0.091 Test Loss: 3.287 Test Acc: 0.091
Validation loss decreased (-0.085849 --> -0.090555).  Saving model ...
Epoch: 16 cost time: 1.1127805709838867
Epoch: 16, Steps: 10 | Train Loss: 2.438 Vali Loss: 3.268 Vali Acc: 0.099 Test Loss: 3.268 Test Acc: 0.099
Validation loss decreased (-0.090555 --> -0.098791).  Saving model ...
Epoch: 17 cost time: 0.9831674098968506
Epoch: 17, Steps: 10 | Train Loss: 2.345 Vali Loss: 3.280 Vali Acc: 0.107 Test Loss: 3.280 Test Acc: 0.107
Validation loss decreased (-0.098791 --> -0.107026).  Saving model ...
Epoch: 18 cost time: 1.0018162727355957
Epoch: 18, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.259 Vali Acc: 0.116 Test Loss: 3.259 Test Acc: 0.116
Validation loss decreased (-0.107026 --> -0.116438).  Saving model ...
Epoch: 19 cost time: 0.8675441741943359
Epoch: 19, Steps: 10 | Train Loss: 2.146 Vali Loss: 3.238 Vali Acc: 0.127 Test Loss: 3.238 Test Acc: 0.127
Validation loss decreased (-0.116438 --> -0.127026).  Saving model ...
Epoch: 20 cost time: 1.0268709659576416
Epoch: 20, Steps: 10 | Train Loss: 2.095 Vali Loss: 3.235 Vali Acc: 0.124 Test Loss: 3.235 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0151581764221191
Epoch: 21, Steps: 10 | Train Loss: 2.026 Vali Loss: 3.258 Vali Acc: 0.120 Test Loss: 3.258 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9446661472320557
Epoch: 22, Steps: 10 | Train Loss: 1.886 Vali Loss: 3.238 Vali Acc: 0.119 Test Loss: 3.238 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.147245168685913
Epoch: 23, Steps: 10 | Train Loss: 1.885 Vali Loss: 3.220 Vali Acc: 0.153 Test Loss: 3.220 Test Acc: 0.153
Validation loss decreased (-0.127026 --> -0.152909).  Saving model ...
Epoch: 24 cost time: 1.0209898948669434
Epoch: 24, Steps: 10 | Train Loss: 1.789 Vali Loss: 3.249 Vali Acc: 0.136 Test Loss: 3.249 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9893903732299805
Epoch: 25, Steps: 10 | Train Loss: 1.707 Vali Loss: 3.203 Vali Acc: 0.155 Test Loss: 3.203 Test Acc: 0.155
Validation loss decreased (-0.152909 --> -0.155262).  Saving model ...
Epoch: 26 cost time: 0.9769206047058105
Epoch: 26, Steps: 10 | Train Loss: 1.609 Vali Loss: 3.236 Vali Acc: 0.148 Test Loss: 3.236 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0523440837860107
Epoch: 27, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.249 Vali Acc: 0.149 Test Loss: 3.249 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.029646873474121
Epoch: 28, Steps: 10 | Train Loss: 1.402 Vali Loss: 3.236 Vali Acc: 0.161 Test Loss: 3.236 Test Acc: 0.161
Validation loss decreased (-0.155262 --> -0.161144).  Saving model ...
Epoch: 29 cost time: 1.097031831741333
Epoch: 29, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.254 Vali Acc: 0.151 Test Loss: 3.254 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9955201148986816
Epoch: 30, Steps: 10 | Train Loss: 1.227 Vali Loss: 3.252 Vali Acc: 0.167 Test Loss: 3.252 Test Acc: 0.167
Validation loss decreased (-0.161144 --> -0.167026).  Saving model ...
Epoch: 31 cost time: 1.374321460723877
Epoch: 31, Steps: 10 | Train Loss: 1.220 Vali Loss: 3.247 Vali Acc: 0.180 Test Loss: 3.247 Test Acc: 0.180
Validation loss decreased (-0.167026 --> -0.179968).  Saving model ...
Epoch: 32 cost time: 1.1002917289733887
Epoch: 32, Steps: 10 | Train Loss: 1.160 Vali Loss: 3.222 Vali Acc: 0.176 Test Loss: 3.222 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9740493297576904
Epoch: 33, Steps: 10 | Train Loss: 1.089 Vali Loss: 3.245 Vali Acc: 0.180 Test Loss: 3.245 Test Acc: 0.180
Validation loss decreased (-0.179968 --> -0.179968).  Saving model ...
Epoch: 34 cost time: 0.9765574932098389
Epoch: 34, Steps: 10 | Train Loss: 1.034 Vali Loss: 3.254 Vali Acc: 0.182 Test Loss: 3.254 Test Acc: 0.182
Validation loss decreased (-0.179968 --> -0.182320).  Saving model ...
Epoch: 35 cost time: 1.0230801105499268
Epoch: 35, Steps: 10 | Train Loss: 0.882 Vali Loss: 3.220 Vali Acc: 0.191 Test Loss: 3.220 Test Acc: 0.191
Validation loss decreased (-0.182320 --> -0.190556).  Saving model ...
Epoch: 36 cost time: 1.0780696868896484
Epoch: 36, Steps: 10 | Train Loss: 0.853 Vali Loss: 3.272 Vali Acc: 0.192 Test Loss: 3.272 Test Acc: 0.192
Validation loss decreased (-0.190556 --> -0.191732).  Saving model ...
Epoch: 37 cost time: 1.047353982925415
Epoch: 37, Steps: 10 | Train Loss: 0.780 Vali Loss: 3.279 Vali Acc: 0.195 Test Loss: 3.279 Test Acc: 0.195
Validation loss decreased (-0.191732 --> -0.195261).  Saving model ...
Epoch: 38 cost time: 1.0963490009307861
Epoch: 38, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.250 Vali Acc: 0.214 Test Loss: 3.250 Test Acc: 0.214
Validation loss decreased (-0.195261 --> -0.214085).  Saving model ...
Epoch: 39 cost time: 1.0431580543518066
Epoch: 39, Steps: 10 | Train Loss: 0.654 Vali Loss: 3.371 Vali Acc: 0.189 Test Loss: 3.371 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1766939163208008
Epoch: 40, Steps: 10 | Train Loss: 0.603 Vali Loss: 3.350 Vali Acc: 0.180 Test Loss: 3.350 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0374171733856201
Epoch: 41, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.441 Vali Acc: 0.188 Test Loss: 3.441 Test Acc: 0.188
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1758434772491455
Epoch: 42, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.305 Vali Acc: 0.206 Test Loss: 3.305 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2474462985992432
Epoch: 43, Steps: 10 | Train Loss: 0.473 Vali Loss: 3.280 Vali Acc: 0.219 Test Loss: 3.280 Test Acc: 0.219
Validation loss decreased (-0.214085 --> -0.218791).  Saving model ...
Epoch: 44 cost time: 1.0913372039794922
Epoch: 44, Steps: 10 | Train Loss: 0.409 Vali Loss: 3.301 Vali Acc: 0.226 Test Loss: 3.301 Test Acc: 0.226
Validation loss decreased (-0.218791 --> -0.225849).  Saving model ...
Epoch: 45 cost time: 1.0427782535552979
Epoch: 45, Steps: 10 | Train Loss: 0.372 Vali Loss: 3.395 Vali Acc: 0.209 Test Loss: 3.395 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1045758724212646
Epoch: 46, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.409 Vali Acc: 0.209 Test Loss: 3.409 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1409165859222412
Epoch: 47, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.341 Vali Acc: 0.224 Test Loss: 3.341 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0209145545959473
Epoch: 48, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.446 Vali Acc: 0.228 Test Loss: 3.446 Test Acc: 0.228
Validation loss decreased (-0.225849 --> -0.228201).  Saving model ...
Epoch: 49 cost time: 1.2031142711639404
Epoch: 49, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.476 Vali Acc: 0.228 Test Loss: 3.476 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0801372528076172
Epoch: 50, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.500 Vali Acc: 0.225 Test Loss: 3.500 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.1169531345367432
Epoch: 51, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.424 Vali Acc: 0.232 Test Loss: 3.424 Test Acc: 0.232
Validation loss decreased (-0.228201 --> -0.231730).  Saving model ...
Epoch: 52 cost time: 1.1881964206695557
Epoch: 52, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.490 Vali Acc: 0.245 Test Loss: 3.490 Test Acc: 0.245
Validation loss decreased (-0.231730 --> -0.244671).  Saving model ...
Epoch: 53 cost time: 1.0540480613708496
Epoch: 53, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.504 Vali Acc: 0.245 Test Loss: 3.504 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1013565063476562
Epoch: 54, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.578 Vali Acc: 0.226 Test Loss: 3.578 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2421514987945557
Epoch: 55, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.525 Vali Acc: 0.244 Test Loss: 3.525 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.3116810321807861
Epoch: 56, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.533 Vali Acc: 0.244 Test Loss: 3.533 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.132310152053833
Epoch: 57, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.594 Vali Acc: 0.236 Test Loss: 3.594 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.2194952964782715
Epoch: 58, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.608 Vali Acc: 0.241 Test Loss: 3.608 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.3650989532470703
Epoch: 59, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.616 Vali Acc: 0.228 Test Loss: 3.616 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.2076807022094727
Epoch: 60, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.617 Vali Acc: 0.242 Test Loss: 3.617 Test Acc: 0.242
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.3449337482452393
Epoch: 61, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.615 Vali Acc: 0.247 Test Loss: 3.615 Test Acc: 0.247
Validation loss decreased (-0.244671 --> -0.247023).  Saving model ...
Epoch: 62 cost time: 1.4095768928527832
Epoch: 62, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.672 Vali Acc: 0.240 Test Loss: 3.672 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.2988271713256836
Epoch: 63, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.683 Vali Acc: 0.240 Test Loss: 3.683 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.2681539058685303
Epoch: 64, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.741 Vali Acc: 0.232 Test Loss: 3.741 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.2732384204864502
Epoch: 65, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.674 Vali Acc: 0.247 Test Loss: 3.674 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.5241882801055908
Epoch: 66, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.722 Vali Acc: 0.236 Test Loss: 3.722 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.3215363025665283
Epoch: 67, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.727 Vali Acc: 0.233 Test Loss: 3.727 Test Acc: 0.233
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.2032911777496338
Epoch: 68, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.733 Vali Acc: 0.240 Test Loss: 3.733 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.3103363513946533
Epoch: 69, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.676 Vali Acc: 0.246 Test Loss: 3.676 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.2000057697296143
Epoch: 70, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.788 Vali Acc: 0.233 Test Loss: 3.788 Test Acc: 0.233
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.1581995487213135
Epoch: 71, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.750 Vali Acc: 0.241 Test Loss: 3.750 Test Acc: 0.241
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24705882352941178
model parameter : 601194
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6750903129577637
Epoch: 1, Steps: 10 | Train Loss: 3.428 Vali Loss: 3.357 Vali Acc: 0.029 Test Loss: 3.357 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 0.9770560264587402
Epoch: 2, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.317 Vali Acc: 0.018 Test Loss: 3.317 Test Acc: 0.018
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.002835750579834
Epoch: 3, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.316 Vali Acc: 0.040 Test Loss: 3.316 Test Acc: 0.040
Validation loss decreased (-0.029378 --> -0.039967).  Saving model ...
Epoch: 4 cost time: 1.248809576034546
Epoch: 4, Steps: 10 | Train Loss: 3.222 Vali Loss: 3.338 Vali Acc: 0.039 Test Loss: 3.338 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1831583976745605
Epoch: 5, Steps: 10 | Train Loss: 3.191 Vali Loss: 3.341 Vali Acc: 0.049 Test Loss: 3.341 Test Acc: 0.049
Validation loss decreased (-0.039967 --> -0.049378).  Saving model ...
Epoch: 6 cost time: 1.2092680931091309
Epoch: 6, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.335 Vali Acc: 0.044 Test Loss: 3.335 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2268717288970947
Epoch: 7, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.350 Vali Acc: 0.048 Test Loss: 3.350 Test Acc: 0.048
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.129551887512207
Epoch: 8, Steps: 10 | Train Loss: 3.056 Vali Loss: 3.334 Vali Acc: 0.052 Test Loss: 3.334 Test Acc: 0.052
Validation loss decreased (-0.049378 --> -0.051731).  Saving model ...
Epoch: 9 cost time: 0.9739718437194824
Epoch: 9, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.328 Vali Acc: 0.053 Test Loss: 3.328 Test Acc: 0.053
Validation loss decreased (-0.051731 --> -0.052908).  Saving model ...
Epoch: 10 cost time: 0.9874889850616455
Epoch: 10, Steps: 10 | Train Loss: 3.073 Vali Loss: 3.320 Vali Acc: 0.052 Test Loss: 3.320 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1695199012756348
Epoch: 11, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.312 Vali Acc: 0.066 Test Loss: 3.312 Test Acc: 0.066
Validation loss decreased (-0.052908 --> -0.065849).  Saving model ...
Epoch: 12 cost time: 1.0674831867218018
Epoch: 12, Steps: 10 | Train Loss: 2.977 Vali Loss: 3.295 Vali Acc: 0.068 Test Loss: 3.295 Test Acc: 0.068
Validation loss decreased (-0.065849 --> -0.068202).  Saving model ...
Epoch: 13 cost time: 1.146071195602417
Epoch: 13, Steps: 10 | Train Loss: 2.901 Vali Loss: 3.304 Vali Acc: 0.075 Test Loss: 3.304 Test Acc: 0.075
Validation loss decreased (-0.068202 --> -0.075261).  Saving model ...
Epoch: 14 cost time: 1.0334742069244385
Epoch: 14, Steps: 10 | Train Loss: 2.856 Vali Loss: 3.295 Vali Acc: 0.082 Test Loss: 3.295 Test Acc: 0.082
Validation loss decreased (-0.075261 --> -0.082320).  Saving model ...
Epoch: 15 cost time: 0.9898371696472168
Epoch: 15, Steps: 10 | Train Loss: 2.749 Vali Loss: 3.278 Vali Acc: 0.087 Test Loss: 3.278 Test Acc: 0.087
Validation loss decreased (-0.082320 --> -0.087026).  Saving model ...
Epoch: 16 cost time: 1.146641731262207
Epoch: 16, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.287 Vali Acc: 0.092 Test Loss: 3.287 Test Acc: 0.092
Validation loss decreased (-0.087026 --> -0.091732).  Saving model ...
Epoch: 17 cost time: 0.9898912906646729
Epoch: 17, Steps: 10 | Train Loss: 2.607 Vali Loss: 3.298 Vali Acc: 0.093 Test Loss: 3.298 Test Acc: 0.093
Validation loss decreased (-0.091732 --> -0.092908).  Saving model ...
Epoch: 18 cost time: 1.2537086009979248
Epoch: 18, Steps: 10 | Train Loss: 2.546 Vali Loss: 3.267 Vali Acc: 0.107 Test Loss: 3.267 Test Acc: 0.107
Validation loss decreased (-0.092908 --> -0.107026).  Saving model ...
Epoch: 19 cost time: 1.0403454303741455
Epoch: 19, Steps: 10 | Train Loss: 2.453 Vali Loss: 3.264 Vali Acc: 0.115 Test Loss: 3.264 Test Acc: 0.115
Validation loss decreased (-0.107026 --> -0.115261).  Saving model ...
Epoch: 20 cost time: 0.9946303367614746
Epoch: 20, Steps: 10 | Train Loss: 2.326 Vali Loss: 3.259 Vali Acc: 0.115 Test Loss: 3.259 Test Acc: 0.115
Validation loss decreased (-0.115261 --> -0.115262).  Saving model ...
Epoch: 21 cost time: 1.1736705303192139
Epoch: 21, Steps: 10 | Train Loss: 2.299 Vali Loss: 3.275 Vali Acc: 0.112 Test Loss: 3.275 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.217040777206421
Epoch: 22, Steps: 10 | Train Loss: 2.199 Vali Loss: 3.261 Vali Acc: 0.129 Test Loss: 3.261 Test Acc: 0.129
Validation loss decreased (-0.115262 --> -0.129379).  Saving model ...
Epoch: 23 cost time: 1.2769813537597656
Epoch: 23, Steps: 10 | Train Loss: 2.134 Vali Loss: 3.265 Vali Acc: 0.125 Test Loss: 3.265 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0354528427124023
Epoch: 24, Steps: 10 | Train Loss: 2.075 Vali Loss: 3.250 Vali Acc: 0.133 Test Loss: 3.250 Test Acc: 0.133
Validation loss decreased (-0.129379 --> -0.132909).  Saving model ...
Epoch: 25 cost time: 1.2239396572113037
Epoch: 25, Steps: 10 | Train Loss: 1.997 Vali Loss: 3.255 Vali Acc: 0.138 Test Loss: 3.255 Test Acc: 0.138
Validation loss decreased (-0.132909 --> -0.137615).  Saving model ...
Epoch: 26 cost time: 1.203749656677246
Epoch: 26, Steps: 10 | Train Loss: 1.870 Vali Loss: 3.258 Vali Acc: 0.144 Test Loss: 3.258 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143497).  Saving model ...
Epoch: 27 cost time: 1.097017765045166
Epoch: 27, Steps: 10 | Train Loss: 1.810 Vali Loss: 3.246 Vali Acc: 0.148 Test Loss: 3.246 Test Acc: 0.148
Validation loss decreased (-0.143497 --> -0.148203).  Saving model ...
Epoch: 28 cost time: 1.1106820106506348
Epoch: 28, Steps: 10 | Train Loss: 1.711 Vali Loss: 3.256 Vali Acc: 0.155 Test Loss: 3.256 Test Acc: 0.155
Validation loss decreased (-0.148203 --> -0.155262).  Saving model ...
Epoch: 29 cost time: 1.0581541061401367
Epoch: 29, Steps: 10 | Train Loss: 1.620 Vali Loss: 3.251 Vali Acc: 0.158 Test Loss: 3.251 Test Acc: 0.158
Validation loss decreased (-0.155262 --> -0.157615).  Saving model ...
Epoch: 30 cost time: 1.0807900428771973
Epoch: 30, Steps: 10 | Train Loss: 1.584 Vali Loss: 3.230 Vali Acc: 0.175 Test Loss: 3.230 Test Acc: 0.175
Validation loss decreased (-0.157615 --> -0.175262).  Saving model ...
Epoch: 31 cost time: 1.2780230045318604
Epoch: 31, Steps: 10 | Train Loss: 1.491 Vali Loss: 3.234 Vali Acc: 0.166 Test Loss: 3.234 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2311744689941406
Epoch: 32, Steps: 10 | Train Loss: 1.458 Vali Loss: 3.270 Vali Acc: 0.160 Test Loss: 3.270 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1714015007019043
Epoch: 33, Steps: 10 | Train Loss: 1.364 Vali Loss: 3.229 Vali Acc: 0.172 Test Loss: 3.229 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1934483051300049
Epoch: 34, Steps: 10 | Train Loss: 1.239 Vali Loss: 3.258 Vali Acc: 0.173 Test Loss: 3.258 Test Acc: 0.173
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1840167045593262
Epoch: 35, Steps: 10 | Train Loss: 1.224 Vali Loss: 3.229 Vali Acc: 0.185 Test Loss: 3.229 Test Acc: 0.185
Validation loss decreased (-0.175262 --> -0.184674).  Saving model ...
Epoch: 36 cost time: 1.071645736694336
Epoch: 36, Steps: 10 | Train Loss: 1.134 Vali Loss: 3.274 Vali Acc: 0.186 Test Loss: 3.274 Test Acc: 0.186
Validation loss decreased (-0.184674 --> -0.185850).  Saving model ...
Epoch: 37 cost time: 1.1196181774139404
Epoch: 37, Steps: 10 | Train Loss: 1.065 Vali Loss: 3.235 Vali Acc: 0.198 Test Loss: 3.235 Test Acc: 0.198
Validation loss decreased (-0.185850 --> -0.197615).  Saving model ...
Epoch: 38 cost time: 1.178778886795044
Epoch: 38, Steps: 10 | Train Loss: 0.965 Vali Loss: 3.258 Vali Acc: 0.192 Test Loss: 3.258 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.144313097000122
Epoch: 39, Steps: 10 | Train Loss: 0.900 Vali Loss: 3.247 Vali Acc: 0.206 Test Loss: 3.247 Test Acc: 0.206
Validation loss decreased (-0.197615 --> -0.205850).  Saving model ...
Epoch: 40 cost time: 1.01076078414917
Epoch: 40, Steps: 10 | Train Loss: 0.831 Vali Loss: 3.287 Vali Acc: 0.193 Test Loss: 3.287 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3638992309570312
Epoch: 41, Steps: 10 | Train Loss: 0.765 Vali Loss: 3.268 Vali Acc: 0.212 Test Loss: 3.268 Test Acc: 0.212
Validation loss decreased (-0.205850 --> -0.211732).  Saving model ...
Epoch: 42 cost time: 1.2166669368743896
Epoch: 42, Steps: 10 | Train Loss: 0.697 Vali Loss: 3.312 Vali Acc: 0.199 Test Loss: 3.312 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1071112155914307
Epoch: 43, Steps: 10 | Train Loss: 0.690 Vali Loss: 3.316 Vali Acc: 0.207 Test Loss: 3.316 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1166813373565674
Epoch: 44, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.318 Vali Acc: 0.208 Test Loss: 3.318 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0461349487304688
Epoch: 45, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.273 Vali Acc: 0.215 Test Loss: 3.273 Test Acc: 0.215
Validation loss decreased (-0.211732 --> -0.215261).  Saving model ...
Epoch: 46 cost time: 1.0553503036499023
Epoch: 46, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.342 Vali Acc: 0.208 Test Loss: 3.342 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.850773811340332
Epoch: 47, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.311 Vali Acc: 0.222 Test Loss: 3.311 Test Acc: 0.222
Validation loss decreased (-0.215261 --> -0.222320).  Saving model ...
Epoch: 48 cost time: 1.1415438652038574
Epoch: 48, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.399 Vali Acc: 0.221 Test Loss: 3.399 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2435545921325684
Epoch: 49, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.355 Vali Acc: 0.218 Test Loss: 3.355 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0779428482055664
Epoch: 50, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.371 Vali Acc: 0.228 Test Loss: 3.371 Test Acc: 0.228
Validation loss decreased (-0.222320 --> -0.228202).  Saving model ...
Epoch: 51 cost time: 1.1559219360351562
Epoch: 51, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.425 Vali Acc: 0.226 Test Loss: 3.425 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1989433765411377
Epoch: 52, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.486 Vali Acc: 0.215 Test Loss: 3.486 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1709964275360107
Epoch: 53, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.383 Vali Acc: 0.234 Test Loss: 3.383 Test Acc: 0.234
Validation loss decreased (-0.228202 --> -0.234084).  Saving model ...
Epoch: 54 cost time: 0.9420506954193115
Epoch: 54, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.450 Vali Acc: 0.227 Test Loss: 3.450 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9851112365722656
Epoch: 55, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.403 Vali Acc: 0.236 Test Loss: 3.403 Test Acc: 0.236
Validation loss decreased (-0.234084 --> -0.236437).  Saving model ...
Epoch: 56 cost time: 1.2344698905944824
Epoch: 56, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.484 Vali Acc: 0.234 Test Loss: 3.484 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0979576110839844
Epoch: 57, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.433 Vali Acc: 0.242 Test Loss: 3.433 Test Acc: 0.242
Validation loss decreased (-0.236437 --> -0.242319).  Saving model ...
Epoch: 58 cost time: 0.9007339477539062
Epoch: 58, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.464 Vali Acc: 0.236 Test Loss: 3.464 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0639381408691406
Epoch: 59, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.565 Vali Acc: 0.231 Test Loss: 3.565 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.0476670265197754
Epoch: 60, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.525 Vali Acc: 0.242 Test Loss: 3.525 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.2582271099090576
Epoch: 61, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.600 Vali Acc: 0.247 Test Loss: 3.600 Test Acc: 0.247
Validation loss decreased (-0.242319 --> -0.247023).  Saving model ...
Epoch: 62 cost time: 1.186478614807129
Epoch: 62, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.574 Vali Acc: 0.231 Test Loss: 3.574 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.137538194656372
Epoch: 63, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.572 Vali Acc: 0.239 Test Loss: 3.572 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.1893999576568604
Epoch: 64, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.601 Vali Acc: 0.232 Test Loss: 3.601 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.1873013973236084
Epoch: 65, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.592 Vali Acc: 0.242 Test Loss: 3.592 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.111802577972412
Epoch: 66, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.677 Vali Acc: 0.240 Test Loss: 3.677 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.1554934978485107
Epoch: 67, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.629 Vali Acc: 0.233 Test Loss: 3.629 Test Acc: 0.233
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.0897066593170166
Epoch: 68, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.721 Vali Acc: 0.222 Test Loss: 3.721 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.1128740310668945
Epoch: 69, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.715 Vali Acc: 0.245 Test Loss: 3.715 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.143885612487793
Epoch: 70, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.708 Vali Acc: 0.246 Test Loss: 3.708 Test Acc: 0.246
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.3031668663024902
Epoch: 71, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.717 Vali Acc: 0.240 Test Loss: 3.717 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24705882352941178
model parameter : 370538
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3751003742218018
Epoch: 1, Steps: 10 | Train Loss: 3.429 Vali Loss: 3.390 Vali Acc: 0.046 Test Loss: 3.390 Test Acc: 0.046
Validation loss decreased (inf --> -0.045848).  Saving model ...
Epoch: 2 cost time: 1.024343729019165
Epoch: 2, Steps: 10 | Train Loss: 3.343 Vali Loss: 3.342 Vali Acc: 0.046 Test Loss: 3.342 Test Acc: 0.046
Validation loss decreased (-0.045848 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 1.0132863521575928
Epoch: 3, Steps: 10 | Train Loss: 3.281 Vali Loss: 3.321 Vali Acc: 0.045 Test Loss: 3.321 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9676649570465088
Epoch: 4, Steps: 10 | Train Loss: 3.215 Vali Loss: 3.322 Vali Acc: 0.039 Test Loss: 3.322 Test Acc: 0.039
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0805473327636719
Epoch: 5, Steps: 10 | Train Loss: 3.196 Vali Loss: 3.321 Vali Acc: 0.039 Test Loss: 3.321 Test Acc: 0.039
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.016845464706421
Epoch: 6, Steps: 10 | Train Loss: 3.148 Vali Loss: 3.320 Vali Acc: 0.053 Test Loss: 3.320 Test Acc: 0.053
Validation loss decreased (-0.045849 --> -0.052908).  Saving model ...
Epoch: 7 cost time: 1.0107386112213135
Epoch: 7, Steps: 10 | Train Loss: 3.110 Vali Loss: 3.322 Vali Acc: 0.055 Test Loss: 3.322 Test Acc: 0.055
Validation loss decreased (-0.052908 --> -0.055261).  Saving model ...
Epoch: 8 cost time: 1.0459184646606445
Epoch: 8, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.306 Vali Acc: 0.053 Test Loss: 3.306 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.102191686630249
Epoch: 9, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.293 Vali Acc: 0.060 Test Loss: 3.293 Test Acc: 0.060
Validation loss decreased (-0.055261 --> -0.059967).  Saving model ...
Epoch: 10 cost time: 1.1373405456542969
Epoch: 10, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.298 Vali Acc: 0.066 Test Loss: 3.298 Test Acc: 0.066
Validation loss decreased (-0.059967 --> -0.065849).  Saving model ...
Epoch: 11 cost time: 1.0037171840667725
Epoch: 11, Steps: 10 | Train Loss: 2.976 Vali Loss: 3.285 Vali Acc: 0.078 Test Loss: 3.285 Test Acc: 0.078
Validation loss decreased (-0.065849 --> -0.077614).  Saving model ...
Epoch: 12 cost time: 1.0998380184173584
Epoch: 12, Steps: 10 | Train Loss: 2.869 Vali Loss: 3.262 Vali Acc: 0.082 Test Loss: 3.262 Test Acc: 0.082
Validation loss decreased (-0.077614 --> -0.082320).  Saving model ...
Epoch: 13 cost time: 1.163827896118164
Epoch: 13, Steps: 10 | Train Loss: 2.840 Vali Loss: 3.249 Vali Acc: 0.082 Test Loss: 3.249 Test Acc: 0.082
Validation loss decreased (-0.082320 --> -0.082320).  Saving model ...
Epoch: 14 cost time: 0.9693295955657959
Epoch: 14, Steps: 10 | Train Loss: 2.730 Vali Loss: 3.277 Vali Acc: 0.074 Test Loss: 3.277 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0106785297393799
Epoch: 15, Steps: 10 | Train Loss: 2.689 Vali Loss: 3.265 Vali Acc: 0.074 Test Loss: 3.265 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.040968894958496
Epoch: 16, Steps: 10 | Train Loss: 2.628 Vali Loss: 3.255 Vali Acc: 0.094 Test Loss: 3.255 Test Acc: 0.094
Validation loss decreased (-0.082320 --> -0.094085).  Saving model ...
Epoch: 17 cost time: 1.0056650638580322
Epoch: 17, Steps: 10 | Train Loss: 2.539 Vali Loss: 3.234 Vali Acc: 0.108 Test Loss: 3.234 Test Acc: 0.108
Validation loss decreased (-0.094085 --> -0.108203).  Saving model ...
Epoch: 18 cost time: 0.8211240768432617
Epoch: 18, Steps: 10 | Train Loss: 2.524 Vali Loss: 3.234 Vali Acc: 0.102 Test Loss: 3.234 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0329740047454834
Epoch: 19, Steps: 10 | Train Loss: 2.424 Vali Loss: 3.243 Vali Acc: 0.096 Test Loss: 3.243 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.100660800933838
Epoch: 20, Steps: 10 | Train Loss: 2.280 Vali Loss: 3.227 Vali Acc: 0.116 Test Loss: 3.227 Test Acc: 0.116
Validation loss decreased (-0.108203 --> -0.116438).  Saving model ...
Epoch: 21 cost time: 0.9939751625061035
Epoch: 21, Steps: 10 | Train Loss: 2.214 Vali Loss: 3.213 Vali Acc: 0.133 Test Loss: 3.213 Test Acc: 0.133
Validation loss decreased (-0.116438 --> -0.132909).  Saving model ...
Epoch: 22 cost time: 1.1619083881378174
Epoch: 22, Steps: 10 | Train Loss: 2.133 Vali Loss: 3.237 Vali Acc: 0.133 Test Loss: 3.237 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9700894355773926
Epoch: 23, Steps: 10 | Train Loss: 2.001 Vali Loss: 3.215 Vali Acc: 0.141 Test Loss: 3.215 Test Acc: 0.141
Validation loss decreased (-0.132909 --> -0.141144).  Saving model ...
Epoch: 24 cost time: 1.0584063529968262
Epoch: 24, Steps: 10 | Train Loss: 1.993 Vali Loss: 3.211 Vali Acc: 0.152 Test Loss: 3.211 Test Acc: 0.152
Validation loss decreased (-0.141144 --> -0.151733).  Saving model ...
Epoch: 25 cost time: 1.120551347732544
Epoch: 25, Steps: 10 | Train Loss: 1.869 Vali Loss: 3.230 Vali Acc: 0.153 Test Loss: 3.230 Test Acc: 0.153
Validation loss decreased (-0.151733 --> -0.152909).  Saving model ...
Epoch: 26 cost time: 1.0372755527496338
Epoch: 26, Steps: 10 | Train Loss: 1.826 Vali Loss: 3.204 Vali Acc: 0.149 Test Loss: 3.204 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9374217987060547
Epoch: 27, Steps: 10 | Train Loss: 1.782 Vali Loss: 3.209 Vali Acc: 0.176 Test Loss: 3.209 Test Acc: 0.176
Validation loss decreased (-0.152909 --> -0.176438).  Saving model ...
Epoch: 28 cost time: 0.9161076545715332
Epoch: 28, Steps: 10 | Train Loss: 1.615 Vali Loss: 3.237 Vali Acc: 0.148 Test Loss: 3.237 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.201070785522461
Epoch: 29, Steps: 10 | Train Loss: 1.606 Vali Loss: 3.230 Vali Acc: 0.178 Test Loss: 3.230 Test Acc: 0.178
Validation loss decreased (-0.176438 --> -0.177615).  Saving model ...
Epoch: 30 cost time: 1.0635859966278076
Epoch: 30, Steps: 10 | Train Loss: 1.481 Vali Loss: 3.193 Vali Acc: 0.174 Test Loss: 3.193 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9730479717254639
Epoch: 31, Steps: 10 | Train Loss: 1.423 Vali Loss: 3.216 Vali Acc: 0.189 Test Loss: 3.216 Test Acc: 0.189
Validation loss decreased (-0.177615 --> -0.189380).  Saving model ...
Epoch: 32 cost time: 1.130610466003418
Epoch: 32, Steps: 10 | Train Loss: 1.333 Vali Loss: 3.191 Vali Acc: 0.195 Test Loss: 3.191 Test Acc: 0.195
Validation loss decreased (-0.189380 --> -0.195262).  Saving model ...
Epoch: 33 cost time: 1.1444289684295654
Epoch: 33, Steps: 10 | Train Loss: 1.266 Vali Loss: 3.276 Vali Acc: 0.189 Test Loss: 3.276 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.066798210144043
Epoch: 34, Steps: 10 | Train Loss: 1.194 Vali Loss: 3.247 Vali Acc: 0.195 Test Loss: 3.247 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.988610029220581
Epoch: 35, Steps: 10 | Train Loss: 1.154 Vali Loss: 3.231 Vali Acc: 0.216 Test Loss: 3.231 Test Acc: 0.216
Validation loss decreased (-0.195262 --> -0.216438).  Saving model ...
Epoch: 36 cost time: 1.1141552925109863
Epoch: 36, Steps: 10 | Train Loss: 1.001 Vali Loss: 3.224 Vali Acc: 0.209 Test Loss: 3.224 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.104945182800293
Epoch: 37, Steps: 10 | Train Loss: 1.014 Vali Loss: 3.253 Vali Acc: 0.202 Test Loss: 3.253 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1252467632293701
Epoch: 38, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.247 Vali Acc: 0.212 Test Loss: 3.247 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.149369478225708
Epoch: 39, Steps: 10 | Train Loss: 0.838 Vali Loss: 3.237 Vali Acc: 0.216 Test Loss: 3.237 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3165843486785889
Epoch: 40, Steps: 10 | Train Loss: 0.787 Vali Loss: 3.284 Vali Acc: 0.216 Test Loss: 3.284 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.204348087310791
Epoch: 41, Steps: 10 | Train Loss: 0.764 Vali Loss: 3.277 Vali Acc: 0.228 Test Loss: 3.277 Test Acc: 0.228
Validation loss decreased (-0.216438 --> -0.228203).  Saving model ...
Epoch: 42 cost time: 1.3279941082000732
Epoch: 42, Steps: 10 | Train Loss: 0.665 Vali Loss: 3.350 Vali Acc: 0.212 Test Loss: 3.350 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2184290885925293
Epoch: 43, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.307 Vali Acc: 0.216 Test Loss: 3.307 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.078890323638916
Epoch: 44, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.368 Vali Acc: 0.216 Test Loss: 3.368 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.158881425857544
Epoch: 45, Steps: 10 | Train Loss: 0.545 Vali Loss: 3.343 Vali Acc: 0.228 Test Loss: 3.343 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.3422331809997559
Epoch: 46, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.384 Vali Acc: 0.213 Test Loss: 3.384 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.243757724761963
Epoch: 47, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.412 Vali Acc: 0.225 Test Loss: 3.412 Test Acc: 0.225
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.1419665813446045
Epoch: 48, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.398 Vali Acc: 0.222 Test Loss: 3.398 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.3449211120605469
Epoch: 49, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.477 Vali Acc: 0.231 Test Loss: 3.477 Test Acc: 0.231
Validation loss decreased (-0.228203 --> -0.230553).  Saving model ...
Epoch: 50 cost time: 1.3015244007110596
Epoch: 50, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.430 Vali Acc: 0.233 Test Loss: 3.430 Test Acc: 0.233
Validation loss decreased (-0.230553 --> -0.232907).  Saving model ...
Epoch: 51 cost time: 1.154623031616211
Epoch: 51, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.434 Vali Acc: 0.220 Test Loss: 3.434 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2098314762115479
Epoch: 52, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.507 Vali Acc: 0.212 Test Loss: 3.507 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1872975826263428
Epoch: 53, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.439 Vali Acc: 0.233 Test Loss: 3.439 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0635709762573242
Epoch: 54, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.601 Vali Acc: 0.225 Test Loss: 3.601 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.3362009525299072
Epoch: 55, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.618 Vali Acc: 0.229 Test Loss: 3.618 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.2330622673034668
Epoch: 56, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.526 Vali Acc: 0.239 Test Loss: 3.526 Test Acc: 0.239
Validation loss decreased (-0.232907 --> -0.238788).  Saving model ...
Epoch: 57 cost time: 1.2011632919311523
Epoch: 57, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.619 Vali Acc: 0.213 Test Loss: 3.619 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.3537535667419434
Epoch: 58, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.654 Vali Acc: 0.228 Test Loss: 3.654 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.3557147979736328
Epoch: 59, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.546 Vali Acc: 0.251 Test Loss: 3.546 Test Acc: 0.251
Validation loss decreased (-0.238788 --> -0.250553).  Saving model ...
Epoch: 60 cost time: 1.2377469539642334
Epoch: 60, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.566 Vali Acc: 0.249 Test Loss: 3.566 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.3512496948242188
Epoch: 61, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.648 Vali Acc: 0.222 Test Loss: 3.648 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.2453761100769043
Epoch: 62, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.581 Vali Acc: 0.246 Test Loss: 3.581 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.270700216293335
Epoch: 63, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.743 Vali Acc: 0.236 Test Loss: 3.743 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.0820338726043701
Epoch: 64, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.721 Vali Acc: 0.238 Test Loss: 3.721 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.3332817554473877
Epoch: 65, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.698 Vali Acc: 0.234 Test Loss: 3.698 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.0946965217590332
Epoch: 66, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.740 Vali Acc: 0.239 Test Loss: 3.740 Test Acc: 0.239
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.1295788288116455
Epoch: 67, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.803 Vali Acc: 0.245 Test Loss: 3.803 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.0581016540527344
Epoch: 68, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.680 Vali Acc: 0.240 Test Loss: 3.680 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.1764874458312988
Epoch: 69, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.745 Vali Acc: 0.244 Test Loss: 3.745 Test Acc: 0.244
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25058823529411767
model parameter : 369770
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.709135055541992
Epoch: 1, Steps: 10 | Train Loss: 3.466 Vali Loss: 3.382 Vali Acc: 0.040 Test Loss: 3.382 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.9796531200408936
Epoch: 2, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.327 Vali Acc: 0.034 Test Loss: 3.327 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0193572044372559
Epoch: 3, Steps: 10 | Train Loss: 3.285 Vali Loss: 3.311 Vali Acc: 0.034 Test Loss: 3.311 Test Acc: 0.034
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0602951049804688
Epoch: 4, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.324 Vali Acc: 0.042 Test Loss: 3.324 Test Acc: 0.042
Validation loss decreased (-0.039966 --> -0.042320).  Saving model ...
Epoch: 5 cost time: 1.0082659721374512
Epoch: 5, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.333 Vali Acc: 0.051 Test Loss: 3.333 Test Acc: 0.051
Validation loss decreased (-0.042320 --> -0.050555).  Saving model ...
Epoch: 6 cost time: 1.079237461090088
Epoch: 6, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.334 Vali Acc: 0.066 Test Loss: 3.334 Test Acc: 0.066
Validation loss decreased (-0.050555 --> -0.065849).  Saving model ...
Epoch: 7 cost time: 1.1289761066436768
Epoch: 7, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.329 Vali Acc: 0.072 Test Loss: 3.329 Test Acc: 0.072
Validation loss decreased (-0.065849 --> -0.071731).  Saving model ...
Epoch: 8 cost time: 1.1561100482940674
Epoch: 8, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.320 Vali Acc: 0.072 Test Loss: 3.320 Test Acc: 0.072
Validation loss decreased (-0.071731 --> -0.071732).  Saving model ...
Epoch: 9 cost time: 1.0825364589691162
Epoch: 9, Steps: 10 | Train Loss: 3.038 Vali Loss: 3.316 Vali Acc: 0.066 Test Loss: 3.316 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1351280212402344
Epoch: 10, Steps: 10 | Train Loss: 2.961 Vali Loss: 3.307 Vali Acc: 0.082 Test Loss: 3.307 Test Acc: 0.082
Validation loss decreased (-0.071732 --> -0.082320).  Saving model ...
Epoch: 11 cost time: 1.0515828132629395
Epoch: 11, Steps: 10 | Train Loss: 2.925 Vali Loss: 3.293 Vali Acc: 0.086 Test Loss: 3.293 Test Acc: 0.086
Validation loss decreased (-0.082320 --> -0.085849).  Saving model ...
Epoch: 12 cost time: 1.1906049251556396
Epoch: 12, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.281 Vali Acc: 0.093 Test Loss: 3.281 Test Acc: 0.093
Validation loss decreased (-0.085849 --> -0.092908).  Saving model ...
Epoch: 13 cost time: 1.1223278045654297
Epoch: 13, Steps: 10 | Train Loss: 2.782 Vali Loss: 3.284 Vali Acc: 0.098 Test Loss: 3.284 Test Acc: 0.098
Validation loss decreased (-0.092908 --> -0.097614).  Saving model ...
Epoch: 14 cost time: 1.0091097354888916
Epoch: 14, Steps: 10 | Train Loss: 2.673 Vali Loss: 3.259 Vali Acc: 0.105 Test Loss: 3.259 Test Acc: 0.105
Validation loss decreased (-0.097614 --> -0.104673).  Saving model ...
Epoch: 15 cost time: 1.0616393089294434
Epoch: 15, Steps: 10 | Train Loss: 2.585 Vali Loss: 3.255 Vali Acc: 0.109 Test Loss: 3.255 Test Acc: 0.109
Validation loss decreased (-0.104673 --> -0.109379).  Saving model ...
Epoch: 16 cost time: 0.9943187236785889
Epoch: 16, Steps: 10 | Train Loss: 2.516 Vali Loss: 3.239 Vali Acc: 0.113 Test Loss: 3.239 Test Acc: 0.113
Validation loss decreased (-0.109379 --> -0.112909).  Saving model ...
Epoch: 17 cost time: 1.140444040298462
Epoch: 17, Steps: 10 | Train Loss: 2.475 Vali Loss: 3.240 Vali Acc: 0.106 Test Loss: 3.240 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1776933670043945
Epoch: 18, Steps: 10 | Train Loss: 2.399 Vali Loss: 3.230 Vali Acc: 0.125 Test Loss: 3.230 Test Acc: 0.125
Validation loss decreased (-0.112909 --> -0.124674).  Saving model ...
Epoch: 19 cost time: 1.2150602340698242
Epoch: 19, Steps: 10 | Train Loss: 2.320 Vali Loss: 3.204 Vali Acc: 0.129 Test Loss: 3.204 Test Acc: 0.129
Validation loss decreased (-0.124674 --> -0.129380).  Saving model ...
Epoch: 20 cost time: 1.0900135040283203
Epoch: 20, Steps: 10 | Train Loss: 2.258 Vali Loss: 3.194 Vali Acc: 0.141 Test Loss: 3.194 Test Acc: 0.141
Validation loss decreased (-0.129380 --> -0.141145).  Saving model ...
Epoch: 21 cost time: 1.0934038162231445
Epoch: 21, Steps: 10 | Train Loss: 2.135 Vali Loss: 3.225 Vali Acc: 0.144 Test Loss: 3.225 Test Acc: 0.144
Validation loss decreased (-0.141145 --> -0.143497).  Saving model ...
Epoch: 22 cost time: 1.1621453762054443
Epoch: 22, Steps: 10 | Train Loss: 2.085 Vali Loss: 3.187 Vali Acc: 0.133 Test Loss: 3.187 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.102668046951294
Epoch: 23, Steps: 10 | Train Loss: 1.991 Vali Loss: 3.195 Vali Acc: 0.151 Test Loss: 3.195 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 24 cost time: 1.0331473350524902
Epoch: 24, Steps: 10 | Train Loss: 1.889 Vali Loss: 3.170 Vali Acc: 0.154 Test Loss: 3.170 Test Acc: 0.154
Validation loss decreased (-0.150556 --> -0.154086).  Saving model ...
Epoch: 25 cost time: 1.3229930400848389
Epoch: 25, Steps: 10 | Train Loss: 1.836 Vali Loss: 3.180 Vali Acc: 0.176 Test Loss: 3.180 Test Acc: 0.176
Validation loss decreased (-0.154086 --> -0.176439).  Saving model ...
Epoch: 26 cost time: 1.2847208976745605
Epoch: 26, Steps: 10 | Train Loss: 1.756 Vali Loss: 3.200 Vali Acc: 0.161 Test Loss: 3.200 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1381385326385498
Epoch: 27, Steps: 10 | Train Loss: 1.621 Vali Loss: 3.137 Vali Acc: 0.184 Test Loss: 3.137 Test Acc: 0.184
Validation loss decreased (-0.176439 --> -0.183498).  Saving model ...
Epoch: 28 cost time: 1.2409772872924805
Epoch: 28, Steps: 10 | Train Loss: 1.614 Vali Loss: 3.193 Vali Acc: 0.166 Test Loss: 3.193 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2979247570037842
Epoch: 29, Steps: 10 | Train Loss: 1.512 Vali Loss: 3.175 Vali Acc: 0.182 Test Loss: 3.175 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0397207736968994
Epoch: 30, Steps: 10 | Train Loss: 1.439 Vali Loss: 3.124 Vali Acc: 0.195 Test Loss: 3.124 Test Acc: 0.195
Validation loss decreased (-0.183498 --> -0.195263).  Saving model ...
Epoch: 31 cost time: 0.9902770519256592
Epoch: 31, Steps: 10 | Train Loss: 1.363 Vali Loss: 3.156 Vali Acc: 0.201 Test Loss: 3.156 Test Acc: 0.201
Validation loss decreased (-0.195263 --> -0.201145).  Saving model ...
Epoch: 32 cost time: 1.1503117084503174
Epoch: 32, Steps: 10 | Train Loss: 1.241 Vali Loss: 3.133 Vali Acc: 0.200 Test Loss: 3.133 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2800264358520508
Epoch: 33, Steps: 10 | Train Loss: 1.204 Vali Loss: 3.144 Vali Acc: 0.200 Test Loss: 3.144 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.236593246459961
Epoch: 34, Steps: 10 | Train Loss: 1.135 Vali Loss: 3.129 Vali Acc: 0.211 Test Loss: 3.129 Test Acc: 0.211
Validation loss decreased (-0.201145 --> -0.210557).  Saving model ...
Epoch: 35 cost time: 1.3660805225372314
Epoch: 35, Steps: 10 | Train Loss: 1.046 Vali Loss: 3.143 Vali Acc: 0.214 Test Loss: 3.143 Test Acc: 0.214
Validation loss decreased (-0.210557 --> -0.214086).  Saving model ...
Epoch: 36 cost time: 1.3335013389587402
Epoch: 36, Steps: 10 | Train Loss: 1.037 Vali Loss: 3.135 Vali Acc: 0.216 Test Loss: 3.135 Test Acc: 0.216
Validation loss decreased (-0.214086 --> -0.216439).  Saving model ...
Epoch: 37 cost time: 1.1703917980194092
Epoch: 37, Steps: 10 | Train Loss: 0.901 Vali Loss: 3.157 Vali Acc: 0.221 Test Loss: 3.157 Test Acc: 0.221
Validation loss decreased (-0.216439 --> -0.221145).  Saving model ...
Epoch: 38 cost time: 1.1343986988067627
Epoch: 38, Steps: 10 | Train Loss: 0.920 Vali Loss: 3.198 Vali Acc: 0.193 Test Loss: 3.198 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1815176010131836
Epoch: 39, Steps: 10 | Train Loss: 0.830 Vali Loss: 3.191 Vali Acc: 0.208 Test Loss: 3.191 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1938507556915283
Epoch: 40, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.192 Vali Acc: 0.220 Test Loss: 3.192 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0485804080963135
Epoch: 41, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.162 Vali Acc: 0.221 Test Loss: 3.162 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.123805046081543
Epoch: 42, Steps: 10 | Train Loss: 0.669 Vali Loss: 3.285 Vali Acc: 0.222 Test Loss: 3.285 Test Acc: 0.222
Validation loss decreased (-0.221145 --> -0.222320).  Saving model ...
Epoch: 43 cost time: 1.0780057907104492
Epoch: 43, Steps: 10 | Train Loss: 0.621 Vali Loss: 3.282 Vali Acc: 0.227 Test Loss: 3.282 Test Acc: 0.227
Validation loss decreased (-0.222320 --> -0.227026).  Saving model ...
Epoch: 44 cost time: 1.1417250633239746
Epoch: 44, Steps: 10 | Train Loss: 0.547 Vali Loss: 3.191 Vali Acc: 0.233 Test Loss: 3.191 Test Acc: 0.233
Validation loss decreased (-0.227026 --> -0.232909).  Saving model ...
Epoch: 45 cost time: 1.052746295928955
Epoch: 45, Steps: 10 | Train Loss: 0.472 Vali Loss: 3.242 Vali Acc: 0.236 Test Loss: 3.242 Test Acc: 0.236
Validation loss decreased (-0.232909 --> -0.236438).  Saving model ...
Epoch: 46 cost time: 1.0692389011383057
Epoch: 46, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.306 Vali Acc: 0.228 Test Loss: 3.306 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.035017967224121
Epoch: 47, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.298 Vali Acc: 0.228 Test Loss: 3.298 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.007023811340332
Epoch: 48, Steps: 10 | Train Loss: 0.374 Vali Loss: 3.225 Vali Acc: 0.234 Test Loss: 3.225 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.166929006576538
Epoch: 49, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.295 Vali Acc: 0.240 Test Loss: 3.295 Test Acc: 0.240
Validation loss decreased (-0.236438 --> -0.239967).  Saving model ...
Epoch: 50 cost time: 0.998314619064331
Epoch: 50, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.272 Vali Acc: 0.244 Test Loss: 3.272 Test Acc: 0.244
Validation loss decreased (-0.239967 --> -0.243497).  Saving model ...
Epoch: 51 cost time: 1.1389966011047363
Epoch: 51, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.369 Vali Acc: 0.240 Test Loss: 3.369 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9684352874755859
Epoch: 52, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.381 Vali Acc: 0.240 Test Loss: 3.381 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1099400520324707
Epoch: 53, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.365 Vali Acc: 0.251 Test Loss: 3.365 Test Acc: 0.251
Validation loss decreased (-0.243497 --> -0.250555).  Saving model ...
Epoch: 54 cost time: 0.9986019134521484
Epoch: 54, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.385 Vali Acc: 0.240 Test Loss: 3.385 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0788679122924805
Epoch: 55, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.401 Vali Acc: 0.247 Test Loss: 3.401 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.1774351596832275
Epoch: 56, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.427 Vali Acc: 0.240 Test Loss: 3.427 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.120018720626831
Epoch: 57, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.440 Vali Acc: 0.258 Test Loss: 3.440 Test Acc: 0.258
Validation loss decreased (-0.250555 --> -0.257613).  Saving model ...
Epoch: 58 cost time: 1.1027042865753174
Epoch: 58, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.424 Vali Acc: 0.242 Test Loss: 3.424 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2152831554412842
Epoch: 59, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.550 Vali Acc: 0.268 Test Loss: 3.550 Test Acc: 0.268
Validation loss decreased (-0.257613 --> -0.268200).  Saving model ...
Epoch: 60 cost time: 1.1909494400024414
Epoch: 60, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.443 Vali Acc: 0.251 Test Loss: 3.443 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.220395803451538
Epoch: 61, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.491 Vali Acc: 0.253 Test Loss: 3.491 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.03493332862854
Epoch: 62, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.507 Vali Acc: 0.265 Test Loss: 3.507 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.2294025421142578
Epoch: 63, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.515 Vali Acc: 0.255 Test Loss: 3.515 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.2274808883666992
Epoch: 64, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.511 Vali Acc: 0.261 Test Loss: 3.511 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.1579482555389404
Epoch: 65, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.579 Vali Acc: 0.260 Test Loss: 3.579 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.914337158203125
Epoch: 66, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.506 Vali Acc: 0.272 Test Loss: 3.506 Test Acc: 0.272
Validation loss decreased (-0.268200 --> -0.271730).  Saving model ...
Epoch: 67 cost time: 1.0898513793945312
Epoch: 67, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.556 Vali Acc: 0.262 Test Loss: 3.556 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.038512945175171
Epoch: 68, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.584 Vali Acc: 0.264 Test Loss: 3.584 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.9183940887451172
Epoch: 69, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.575 Vali Acc: 0.259 Test Loss: 3.575 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.1596629619598389
Epoch: 70, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.580 Vali Acc: 0.249 Test Loss: 3.580 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.1775128841400146
Epoch: 71, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.590 Vali Acc: 0.266 Test Loss: 3.590 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.1112267971038818
Epoch: 72, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.572 Vali Acc: 0.268 Test Loss: 3.572 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.1024374961853027
Epoch: 73, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.554 Vali Acc: 0.266 Test Loss: 3.554 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.4155068397521973
Epoch: 74, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.684 Vali Acc: 0.265 Test Loss: 3.684 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.3657739162445068
Epoch: 75, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.639 Vali Acc: 0.264 Test Loss: 3.639 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.380167007446289
Epoch: 76, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.605 Vali Acc: 0.260 Test Loss: 3.605 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 369002
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4166598320007324
Epoch: 1, Steps: 10 | Train Loss: 3.436 Vali Loss: 3.388 Vali Acc: 0.040 Test Loss: 3.388 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 1.0526809692382812
Epoch: 2, Steps: 10 | Train Loss: 3.367 Vali Loss: 3.335 Vali Acc: 0.040 Test Loss: 3.335 Test Acc: 0.040
Validation loss decreased (-0.039966 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 1.1152350902557373
Epoch: 3, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.312 Vali Acc: 0.044 Test Loss: 3.312 Test Acc: 0.044
Validation loss decreased (-0.039967 --> -0.043496).  Saving model ...
Epoch: 4 cost time: 1.1327052116394043
Epoch: 4, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.327 Vali Acc: 0.052 Test Loss: 3.327 Test Acc: 0.052
Validation loss decreased (-0.043496 --> -0.051731).  Saving model ...
Epoch: 5 cost time: 1.0445799827575684
Epoch: 5, Steps: 10 | Train Loss: 3.154 Vali Loss: 3.332 Vali Acc: 0.055 Test Loss: 3.332 Test Acc: 0.055
Validation loss decreased (-0.051731 --> -0.055261).  Saving model ...
Epoch: 6 cost time: 1.1877119541168213
Epoch: 6, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.337 Vali Acc: 0.059 Test Loss: 3.337 Test Acc: 0.059
Validation loss decreased (-0.055261 --> -0.058790).  Saving model ...
Epoch: 7 cost time: 1.1310091018676758
Epoch: 7, Steps: 10 | Train Loss: 3.115 Vali Loss: 3.330 Vali Acc: 0.082 Test Loss: 3.330 Test Acc: 0.082
Validation loss decreased (-0.058790 --> -0.082320).  Saving model ...
Epoch: 8 cost time: 0.9062767028808594
Epoch: 8, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.313 Vali Acc: 0.061 Test Loss: 3.313 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1276154518127441
Epoch: 9, Steps: 10 | Train Loss: 3.044 Vali Loss: 3.308 Vali Acc: 0.066 Test Loss: 3.308 Test Acc: 0.066
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1602530479431152
Epoch: 10, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.292 Vali Acc: 0.084 Test Loss: 3.292 Test Acc: 0.084
Validation loss decreased (-0.082320 --> -0.083496).  Saving model ...
Epoch: 11 cost time: 1.1447150707244873
Epoch: 11, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.280 Vali Acc: 0.088 Test Loss: 3.280 Test Acc: 0.088
Validation loss decreased (-0.083496 --> -0.088202).  Saving model ...
Epoch: 12 cost time: 1.0082342624664307
Epoch: 12, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.276 Vali Acc: 0.089 Test Loss: 3.276 Test Acc: 0.089
Validation loss decreased (-0.088202 --> -0.089379).  Saving model ...
Epoch: 13 cost time: 1.0721416473388672
Epoch: 13, Steps: 10 | Train Loss: 2.776 Vali Loss: 3.274 Vali Acc: 0.104 Test Loss: 3.274 Test Acc: 0.104
Validation loss decreased (-0.089379 --> -0.103497).  Saving model ...
Epoch: 14 cost time: 1.1023390293121338
Epoch: 14, Steps: 10 | Train Loss: 2.728 Vali Loss: 3.279 Vali Acc: 0.102 Test Loss: 3.279 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0520625114440918
Epoch: 15, Steps: 10 | Train Loss: 2.724 Vali Loss: 3.277 Vali Acc: 0.109 Test Loss: 3.277 Test Acc: 0.109
Validation loss decreased (-0.103497 --> -0.109379).  Saving model ...
Epoch: 16 cost time: 1.090900182723999
Epoch: 16, Steps: 10 | Train Loss: 2.577 Vali Loss: 3.252 Vali Acc: 0.118 Test Loss: 3.252 Test Acc: 0.118
Validation loss decreased (-0.109379 --> -0.117615).  Saving model ...
Epoch: 17 cost time: 1.0993678569793701
Epoch: 17, Steps: 10 | Train Loss: 2.538 Vali Loss: 3.252 Vali Acc: 0.127 Test Loss: 3.252 Test Acc: 0.127
Validation loss decreased (-0.117615 --> -0.127026).  Saving model ...
Epoch: 18 cost time: 1.1188013553619385
Epoch: 18, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.241 Vali Acc: 0.132 Test Loss: 3.241 Test Acc: 0.132
Validation loss decreased (-0.127026 --> -0.131732).  Saving model ...
Epoch: 19 cost time: 1.040813684463501
Epoch: 19, Steps: 10 | Train Loss: 2.331 Vali Loss: 3.236 Vali Acc: 0.133 Test Loss: 3.236 Test Acc: 0.133
Validation loss decreased (-0.131732 --> -0.132909).  Saving model ...
Epoch: 20 cost time: 1.019345760345459
Epoch: 20, Steps: 10 | Train Loss: 2.239 Vali Loss: 3.220 Vali Acc: 0.127 Test Loss: 3.220 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2810630798339844
Epoch: 21, Steps: 10 | Train Loss: 2.172 Vali Loss: 3.238 Vali Acc: 0.133 Test Loss: 3.238 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3022866249084473
Epoch: 22, Steps: 10 | Train Loss: 2.127 Vali Loss: 3.249 Vali Acc: 0.149 Test Loss: 3.249 Test Acc: 0.149
Validation loss decreased (-0.132909 --> -0.149379).  Saving model ...
Epoch: 23 cost time: 1.090681791305542
Epoch: 23, Steps: 10 | Train Loss: 2.035 Vali Loss: 3.226 Vali Acc: 0.153 Test Loss: 3.226 Test Acc: 0.153
Validation loss decreased (-0.149379 --> -0.152909).  Saving model ...
Epoch: 24 cost time: 1.0335783958435059
Epoch: 24, Steps: 10 | Train Loss: 1.995 Vali Loss: 3.240 Vali Acc: 0.141 Test Loss: 3.240 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2307798862457275
Epoch: 25, Steps: 10 | Train Loss: 1.907 Vali Loss: 3.239 Vali Acc: 0.159 Test Loss: 3.239 Test Acc: 0.159
Validation loss decreased (-0.152909 --> -0.158791).  Saving model ...
Epoch: 26 cost time: 1.2507026195526123
Epoch: 26, Steps: 10 | Train Loss: 1.793 Vali Loss: 3.219 Vali Acc: 0.158 Test Loss: 3.219 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2240633964538574
Epoch: 27, Steps: 10 | Train Loss: 1.766 Vali Loss: 3.246 Vali Acc: 0.156 Test Loss: 3.246 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1713860034942627
Epoch: 28, Steps: 10 | Train Loss: 1.622 Vali Loss: 3.229 Vali Acc: 0.167 Test Loss: 3.229 Test Acc: 0.167
Validation loss decreased (-0.158791 --> -0.167027).  Saving model ...
Epoch: 29 cost time: 1.1544082164764404
Epoch: 29, Steps: 10 | Train Loss: 1.619 Vali Loss: 3.243 Vali Acc: 0.160 Test Loss: 3.243 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0274760723114014
Epoch: 30, Steps: 10 | Train Loss: 1.499 Vali Loss: 3.226 Vali Acc: 0.165 Test Loss: 3.226 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.223726511001587
Epoch: 31, Steps: 10 | Train Loss: 1.433 Vali Loss: 3.247 Vali Acc: 0.169 Test Loss: 3.247 Test Acc: 0.169
Validation loss decreased (-0.167027 --> -0.169379).  Saving model ...
Epoch: 32 cost time: 1.2260406017303467
Epoch: 32, Steps: 10 | Train Loss: 1.373 Vali Loss: 3.233 Vali Acc: 0.176 Test Loss: 3.233 Test Acc: 0.176
Validation loss decreased (-0.169379 --> -0.176438).  Saving model ...
Epoch: 33 cost time: 1.2449615001678467
Epoch: 33, Steps: 10 | Train Loss: 1.323 Vali Loss: 3.248 Vali Acc: 0.185 Test Loss: 3.248 Test Acc: 0.185
Validation loss decreased (-0.176438 --> -0.184673).  Saving model ...
Epoch: 34 cost time: 1.3381474018096924
Epoch: 34, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.249 Vali Acc: 0.188 Test Loss: 3.249 Test Acc: 0.188
Validation loss decreased (-0.184673 --> -0.188203).  Saving model ...
Epoch: 35 cost time: 1.1138198375701904
Epoch: 35, Steps: 10 | Train Loss: 1.182 Vali Loss: 3.269 Vali Acc: 0.192 Test Loss: 3.269 Test Acc: 0.192
Validation loss decreased (-0.188203 --> -0.191732).  Saving model ...
Epoch: 36 cost time: 1.2513251304626465
Epoch: 36, Steps: 10 | Train Loss: 1.098 Vali Loss: 3.263 Vali Acc: 0.185 Test Loss: 3.263 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1043097972869873
Epoch: 37, Steps: 10 | Train Loss: 1.028 Vali Loss: 3.286 Vali Acc: 0.195 Test Loss: 3.286 Test Acc: 0.195
Validation loss decreased (-0.191732 --> -0.195261).  Saving model ...
Epoch: 38 cost time: 1.0273418426513672
Epoch: 38, Steps: 10 | Train Loss: 0.922 Vali Loss: 3.260 Vali Acc: 0.198 Test Loss: 3.260 Test Acc: 0.198
Validation loss decreased (-0.195261 --> -0.197614).  Saving model ...
Epoch: 39 cost time: 1.1337285041809082
Epoch: 39, Steps: 10 | Train Loss: 0.873 Vali Loss: 3.266 Vali Acc: 0.204 Test Loss: 3.266 Test Acc: 0.204
Validation loss decreased (-0.197614 --> -0.203497).  Saving model ...
Epoch: 40 cost time: 1.2249667644500732
Epoch: 40, Steps: 10 | Train Loss: 0.793 Vali Loss: 3.241 Vali Acc: 0.213 Test Loss: 3.241 Test Acc: 0.213
Validation loss decreased (-0.203497 --> -0.212909).  Saving model ...
Epoch: 41 cost time: 1.1463143825531006
Epoch: 41, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.316 Vali Acc: 0.205 Test Loss: 3.316 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2041337490081787
Epoch: 42, Steps: 10 | Train Loss: 0.746 Vali Loss: 3.295 Vali Acc: 0.215 Test Loss: 3.295 Test Acc: 0.215
Validation loss decreased (-0.212909 --> -0.215261).  Saving model ...
Epoch: 43 cost time: 1.31886625289917
Epoch: 43, Steps: 10 | Train Loss: 0.603 Vali Loss: 3.306 Vali Acc: 0.211 Test Loss: 3.306 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2966525554656982
Epoch: 44, Steps: 10 | Train Loss: 0.577 Vali Loss: 3.260 Vali Acc: 0.216 Test Loss: 3.260 Test Acc: 0.216
Validation loss decreased (-0.215261 --> -0.216438).  Saving model ...
Epoch: 45 cost time: 1.3544566631317139
Epoch: 45, Steps: 10 | Train Loss: 0.550 Vali Loss: 3.348 Vali Acc: 0.213 Test Loss: 3.348 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2824804782867432
Epoch: 46, Steps: 10 | Train Loss: 0.512 Vali Loss: 3.300 Vali Acc: 0.231 Test Loss: 3.300 Test Acc: 0.231
Validation loss decreased (-0.216438 --> -0.230555).  Saving model ...
Epoch: 47 cost time: 1.0492424964904785
Epoch: 47, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.331 Vali Acc: 0.236 Test Loss: 3.331 Test Acc: 0.236
Validation loss decreased (-0.230555 --> -0.236437).  Saving model ...
Epoch: 48 cost time: 1.1623921394348145
Epoch: 48, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.337 Vali Acc: 0.228 Test Loss: 3.337 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2484118938446045
Epoch: 49, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.392 Vali Acc: 0.222 Test Loss: 3.392 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1692957878112793
Epoch: 50, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.336 Vali Acc: 0.226 Test Loss: 3.336 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0386409759521484
Epoch: 51, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.358 Vali Acc: 0.244 Test Loss: 3.358 Test Acc: 0.244
Validation loss decreased (-0.236437 --> -0.243496).  Saving model ...
Epoch: 52 cost time: 1.0584921836853027
Epoch: 52, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.463 Vali Acc: 0.227 Test Loss: 3.463 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.1679165363311768
Epoch: 53, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.414 Vali Acc: 0.247 Test Loss: 3.414 Test Acc: 0.247
Validation loss decreased (-0.243496 --> -0.247025).  Saving model ...
Epoch: 54 cost time: 1.2009308338165283
Epoch: 54, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.384 Vali Acc: 0.238 Test Loss: 3.384 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.234421968460083
Epoch: 55, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.406 Vali Acc: 0.241 Test Loss: 3.406 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.29620361328125
Epoch: 56, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.475 Vali Acc: 0.241 Test Loss: 3.475 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.1205768585205078
Epoch: 57, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.466 Vali Acc: 0.255 Test Loss: 3.466 Test Acc: 0.255
Validation loss decreased (-0.247025 --> -0.255259).  Saving model ...
Epoch: 58 cost time: 1.3009121417999268
Epoch: 58, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.508 Vali Acc: 0.239 Test Loss: 3.508 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.4181907176971436
Epoch: 59, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.542 Vali Acc: 0.234 Test Loss: 3.542 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.1142315864562988
Epoch: 60, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.570 Vali Acc: 0.236 Test Loss: 3.570 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.2396645545959473
Epoch: 61, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.497 Vali Acc: 0.254 Test Loss: 3.497 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.2004544734954834
Epoch: 62, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.582 Vali Acc: 0.240 Test Loss: 3.582 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.0957987308502197
Epoch: 63, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.567 Vali Acc: 0.240 Test Loss: 3.567 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.2337863445281982
Epoch: 64, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.629 Vali Acc: 0.249 Test Loss: 3.629 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.1222503185272217
Epoch: 65, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.577 Vali Acc: 0.255 Test Loss: 3.577 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.1451473236083984
Epoch: 66, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.590 Vali Acc: 0.247 Test Loss: 3.590 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.2586803436279297
Epoch: 67, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.672 Vali Acc: 0.245 Test Loss: 3.672 Test Acc: 0.245
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 368234
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.427435874938965
Epoch: 1, Steps: 10 | Train Loss: 3.436 Vali Loss: 3.335 Vali Acc: 0.029 Test Loss: 3.335 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 0.9481973648071289
Epoch: 2, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.300 Vali Acc: 0.040 Test Loss: 3.300 Test Acc: 0.040
Validation loss decreased (-0.029378 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 1.001032829284668
Epoch: 3, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.290 Vali Acc: 0.052 Test Loss: 3.290 Test Acc: 0.052
Validation loss decreased (-0.039967 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 1.4354524612426758
Epoch: 4, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.307 Vali Acc: 0.052 Test Loss: 3.307 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0789105892181396
Epoch: 5, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.327 Vali Acc: 0.041 Test Loss: 3.327 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1752471923828125
Epoch: 6, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.329 Vali Acc: 0.051 Test Loss: 3.329 Test Acc: 0.051
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1136510372161865
Epoch: 7, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.319 Vali Acc: 0.047 Test Loss: 3.319 Test Acc: 0.047
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.070694923400879
Epoch: 8, Steps: 10 | Train Loss: 3.083 Vali Loss: 3.324 Vali Acc: 0.062 Test Loss: 3.324 Test Acc: 0.062
Validation loss decreased (-0.051732 --> -0.062320).  Saving model ...
Epoch: 9 cost time: 1.0788769721984863
Epoch: 9, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.325 Vali Acc: 0.064 Test Loss: 3.325 Test Acc: 0.064
Validation loss decreased (-0.062320 --> -0.063496).  Saving model ...
Epoch: 10 cost time: 1.2285995483398438
Epoch: 10, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.304 Vali Acc: 0.076 Test Loss: 3.304 Test Acc: 0.076
Validation loss decreased (-0.063496 --> -0.076438).  Saving model ...
Epoch: 11 cost time: 1.2521686553955078
Epoch: 11, Steps: 10 | Train Loss: 3.010 Vali Loss: 3.314 Vali Acc: 0.078 Test Loss: 3.314 Test Acc: 0.078
Validation loss decreased (-0.076438 --> -0.077614).  Saving model ...
Epoch: 12 cost time: 1.074449062347412
Epoch: 12, Steps: 10 | Train Loss: 2.980 Vali Loss: 3.297 Vali Acc: 0.076 Test Loss: 3.297 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.052046775817871
Epoch: 13, Steps: 10 | Train Loss: 2.911 Vali Loss: 3.296 Vali Acc: 0.091 Test Loss: 3.296 Test Acc: 0.091
Validation loss decreased (-0.077614 --> -0.090555).  Saving model ...
Epoch: 14 cost time: 1.146653413772583
Epoch: 14, Steps: 10 | Train Loss: 2.858 Vali Loss: 3.295 Vali Acc: 0.079 Test Loss: 3.295 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.16206693649292
Epoch: 15, Steps: 10 | Train Loss: 2.805 Vali Loss: 3.293 Vali Acc: 0.085 Test Loss: 3.293 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1648716926574707
Epoch: 16, Steps: 10 | Train Loss: 2.727 Vali Loss: 3.267 Vali Acc: 0.099 Test Loss: 3.267 Test Acc: 0.099
Validation loss decreased (-0.090555 --> -0.098791).  Saving model ...
Epoch: 17 cost time: 1.047924280166626
Epoch: 17, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.263 Vali Acc: 0.096 Test Loss: 3.263 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0199215412139893
Epoch: 18, Steps: 10 | Train Loss: 2.631 Vali Loss: 3.244 Vali Acc: 0.124 Test Loss: 3.244 Test Acc: 0.124
Validation loss decreased (-0.098791 --> -0.123497).  Saving model ...
Epoch: 19 cost time: 1.213176965713501
Epoch: 19, Steps: 10 | Train Loss: 2.519 Vali Loss: 3.246 Vali Acc: 0.105 Test Loss: 3.246 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1159577369689941
Epoch: 20, Steps: 10 | Train Loss: 2.456 Vali Loss: 3.249 Vali Acc: 0.108 Test Loss: 3.249 Test Acc: 0.108
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1745362281799316
Epoch: 21, Steps: 10 | Train Loss: 2.364 Vali Loss: 3.227 Vali Acc: 0.121 Test Loss: 3.227 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.163306713104248
Epoch: 22, Steps: 10 | Train Loss: 2.278 Vali Loss: 3.238 Vali Acc: 0.118 Test Loss: 3.238 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4020464420318604
Epoch: 23, Steps: 10 | Train Loss: 2.258 Vali Loss: 3.219 Vali Acc: 0.126 Test Loss: 3.219 Test Acc: 0.126
Validation loss decreased (-0.123497 --> -0.125850).  Saving model ...
Epoch: 24 cost time: 1.164339303970337
Epoch: 24, Steps: 10 | Train Loss: 2.172 Vali Loss: 3.240 Vali Acc: 0.133 Test Loss: 3.240 Test Acc: 0.133
Validation loss decreased (-0.125850 --> -0.132909).  Saving model ...
Epoch: 25 cost time: 1.2511520385742188
Epoch: 25, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.229 Vali Acc: 0.139 Test Loss: 3.229 Test Acc: 0.139
Validation loss decreased (-0.132909 --> -0.138791).  Saving model ...
Epoch: 26 cost time: 1.1977424621582031
Epoch: 26, Steps: 10 | Train Loss: 2.046 Vali Loss: 3.212 Vali Acc: 0.146 Test Loss: 3.212 Test Acc: 0.146
Validation loss decreased (-0.138791 --> -0.145850).  Saving model ...
Epoch: 27 cost time: 1.1906967163085938
Epoch: 27, Steps: 10 | Train Loss: 1.849 Vali Loss: 3.243 Vali Acc: 0.147 Test Loss: 3.243 Test Acc: 0.147
Validation loss decreased (-0.145850 --> -0.147026).  Saving model ...
Epoch: 28 cost time: 1.1218180656433105
Epoch: 28, Steps: 10 | Train Loss: 1.836 Vali Loss: 3.231 Vali Acc: 0.159 Test Loss: 3.231 Test Acc: 0.159
Validation loss decreased (-0.147026 --> -0.158791).  Saving model ...
Epoch: 29 cost time: 1.1953978538513184
Epoch: 29, Steps: 10 | Train Loss: 1.760 Vali Loss: 3.228 Vali Acc: 0.160 Test Loss: 3.228 Test Acc: 0.160
Validation loss decreased (-0.158791 --> -0.159968).  Saving model ...
Epoch: 30 cost time: 1.2526190280914307
Epoch: 30, Steps: 10 | Train Loss: 1.673 Vali Loss: 3.224 Vali Acc: 0.164 Test Loss: 3.224 Test Acc: 0.164
Validation loss decreased (-0.159968 --> -0.163497).  Saving model ...
Epoch: 31 cost time: 1.1801037788391113
Epoch: 31, Steps: 10 | Train Loss: 1.610 Vali Loss: 3.214 Vali Acc: 0.175 Test Loss: 3.214 Test Acc: 0.175
Validation loss decreased (-0.163497 --> -0.175262).  Saving model ...
Epoch: 32 cost time: 1.1738967895507812
Epoch: 32, Steps: 10 | Train Loss: 1.548 Vali Loss: 3.274 Vali Acc: 0.160 Test Loss: 3.274 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1090283393859863
Epoch: 33, Steps: 10 | Train Loss: 1.486 Vali Loss: 3.217 Vali Acc: 0.179 Test Loss: 3.217 Test Acc: 0.179
Validation loss decreased (-0.175262 --> -0.178791).  Saving model ...
Epoch: 34 cost time: 1.1124792098999023
Epoch: 34, Steps: 10 | Train Loss: 1.332 Vali Loss: 3.264 Vali Acc: 0.179 Test Loss: 3.264 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.239903450012207
Epoch: 35, Steps: 10 | Train Loss: 1.262 Vali Loss: 3.285 Vali Acc: 0.176 Test Loss: 3.285 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1770946979522705
Epoch: 36, Steps: 10 | Train Loss: 1.179 Vali Loss: 3.239 Vali Acc: 0.181 Test Loss: 3.239 Test Acc: 0.181
Validation loss decreased (-0.178791 --> -0.181144).  Saving model ...
Epoch: 37 cost time: 1.1156466007232666
Epoch: 37, Steps: 10 | Train Loss: 1.115 Vali Loss: 3.267 Vali Acc: 0.201 Test Loss: 3.267 Test Acc: 0.201
Validation loss decreased (-0.181144 --> -0.201144).  Saving model ...
Epoch: 38 cost time: 1.1506233215332031
Epoch: 38, Steps: 10 | Train Loss: 1.042 Vali Loss: 3.282 Vali Acc: 0.193 Test Loss: 3.282 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1545748710632324
Epoch: 39, Steps: 10 | Train Loss: 1.065 Vali Loss: 3.308 Vali Acc: 0.202 Test Loss: 3.308 Test Acc: 0.202
Validation loss decreased (-0.201144 --> -0.202320).  Saving model ...
Epoch: 40 cost time: 1.1419689655303955
Epoch: 40, Steps: 10 | Train Loss: 0.937 Vali Loss: 3.286 Vali Acc: 0.189 Test Loss: 3.286 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.144782304763794
Epoch: 41, Steps: 10 | Train Loss: 0.844 Vali Loss: 3.337 Vali Acc: 0.209 Test Loss: 3.337 Test Acc: 0.209
Validation loss decreased (-0.202320 --> -0.209378).  Saving model ...
Epoch: 42 cost time: 1.1219747066497803
Epoch: 42, Steps: 10 | Train Loss: 0.835 Vali Loss: 3.334 Vali Acc: 0.201 Test Loss: 3.334 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1874549388885498
Epoch: 43, Steps: 10 | Train Loss: 0.737 Vali Loss: 3.311 Vali Acc: 0.202 Test Loss: 3.311 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1233117580413818
Epoch: 44, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.356 Vali Acc: 0.211 Test Loss: 3.356 Test Acc: 0.211
Validation loss decreased (-0.209378 --> -0.210555).  Saving model ...
Epoch: 45 cost time: 1.0162932872772217
Epoch: 45, Steps: 10 | Train Loss: 0.643 Vali Loss: 3.393 Vali Acc: 0.205 Test Loss: 3.393 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1737444400787354
Epoch: 46, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.364 Vali Acc: 0.220 Test Loss: 3.364 Test Acc: 0.220
Validation loss decreased (-0.210555 --> -0.219966).  Saving model ...
Epoch: 47 cost time: 1.0729193687438965
Epoch: 47, Steps: 10 | Train Loss: 0.581 Vali Loss: 3.404 Vali Acc: 0.212 Test Loss: 3.404 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0171692371368408
Epoch: 48, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.400 Vali Acc: 0.201 Test Loss: 3.400 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0340394973754883
Epoch: 49, Steps: 10 | Train Loss: 0.455 Vali Loss: 3.442 Vali Acc: 0.207 Test Loss: 3.442 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1183266639709473
Epoch: 50, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.437 Vali Acc: 0.216 Test Loss: 3.437 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.129908561706543
Epoch: 51, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.438 Vali Acc: 0.213 Test Loss: 3.438 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.1305208206176758
Epoch: 52, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.468 Vali Acc: 0.211 Test Loss: 3.468 Test Acc: 0.211
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.2077476978302002
Epoch: 53, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.531 Vali Acc: 0.209 Test Loss: 3.531 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.258305549621582
Epoch: 54, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.568 Vali Acc: 0.216 Test Loss: 3.568 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.0848968029022217
Epoch: 55, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.502 Vali Acc: 0.221 Test Loss: 3.502 Test Acc: 0.221
Validation loss decreased (-0.219966 --> -0.221141).  Saving model ...
Epoch: 56 cost time: 1.0660452842712402
Epoch: 56, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.551 Vali Acc: 0.227 Test Loss: 3.551 Test Acc: 0.227
Validation loss decreased (-0.221141 --> -0.227023).  Saving model ...
Epoch: 57 cost time: 1.0305359363555908
Epoch: 57, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.573 Vali Acc: 0.221 Test Loss: 3.573 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.027489423751831
Epoch: 58, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.607 Vali Acc: 0.220 Test Loss: 3.607 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.1416780948638916
Epoch: 59, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.661 Vali Acc: 0.219 Test Loss: 3.661 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.1362676620483398
Epoch: 60, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.614 Vali Acc: 0.228 Test Loss: 3.614 Test Acc: 0.228
Validation loss decreased (-0.227023 --> -0.228199).  Saving model ...
Epoch: 61 cost time: 1.0838074684143066
Epoch: 61, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.658 Vali Acc: 0.224 Test Loss: 3.658 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.0597262382507324
Epoch: 62, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.741 Vali Acc: 0.219 Test Loss: 3.741 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.1446528434753418
Epoch: 63, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.683 Vali Acc: 0.220 Test Loss: 3.683 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.0300860404968262
Epoch: 64, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.824 Vali Acc: 0.214 Test Loss: 3.824 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.9375827312469482
Epoch: 65, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.754 Vali Acc: 0.224 Test Loss: 3.754 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.234168529510498
Epoch: 66, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.695 Vali Acc: 0.219 Test Loss: 3.695 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.2999088764190674
Epoch: 67, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.796 Vali Acc: 0.227 Test Loss: 3.796 Test Acc: 0.227
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.0391173362731934
Epoch: 68, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.791 Vali Acc: 0.234 Test Loss: 3.791 Test Acc: 0.234
Validation loss decreased (-0.228199 --> -0.234080).  Saving model ...
Epoch: 69 cost time: 1.2049763202667236
Epoch: 69, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.781 Vali Acc: 0.224 Test Loss: 3.781 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.3806564807891846
Epoch: 70, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.821 Vali Acc: 0.231 Test Loss: 3.821 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.05515718460083
Epoch: 71, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.858 Vali Acc: 0.224 Test Loss: 3.858 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.3818655014038086
Epoch: 72, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.825 Vali Acc: 0.235 Test Loss: 3.825 Test Acc: 0.235
Validation loss decreased (-0.234080 --> -0.235256).  Saving model ...
Epoch: 73 cost time: 1.2248163223266602
Epoch: 73, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.756 Vali Acc: 0.227 Test Loss: 3.756 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.11411452293396
Epoch: 74, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.910 Vali Acc: 0.231 Test Loss: 3.910 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.1443781852722168
Epoch: 75, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.801 Vali Acc: 0.233 Test Loss: 3.801 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.190636157989502
Epoch: 76, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.862 Vali Acc: 0.235 Test Loss: 3.862 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.0217351913452148
Epoch: 77, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.915 Vali Acc: 0.225 Test Loss: 3.915 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.0808441638946533
Epoch: 78, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.943 Vali Acc: 0.231 Test Loss: 3.943 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.1093308925628662
Epoch: 79, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.910 Vali Acc: 0.232 Test Loss: 3.910 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.0249767303466797
Epoch: 80, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.891 Vali Acc: 0.235 Test Loss: 3.891 Test Acc: 0.235
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 1.106011152267456
Epoch: 81, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.923 Vali Acc: 0.235 Test Loss: 3.923 Test Acc: 0.235
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 1.1380486488342285
Epoch: 82, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.924 Vali Acc: 0.239 Test Loss: 3.924 Test Acc: 0.239
Validation loss decreased (-0.235256 --> -0.238784).  Saving model ...
Epoch: 83 cost time: 1.1137115955352783
Epoch: 83, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.949 Vali Acc: 0.235 Test Loss: 3.949 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.9868834018707275
Epoch: 84, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.967 Vali Acc: 0.236 Test Loss: 3.967 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.1213107109069824
Epoch: 85, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.998 Vali Acc: 0.241 Test Loss: 3.998 Test Acc: 0.241
Validation loss decreased (-0.238784 --> -0.241136).  Saving model ...
Epoch: 86 cost time: 1.225114345550537
Epoch: 86, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.982 Vali Acc: 0.236 Test Loss: 3.982 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.033010721206665
Epoch: 87, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.986 Vali Acc: 0.242 Test Loss: 3.986 Test Acc: 0.242
Validation loss decreased (-0.241136 --> -0.242313).  Saving model ...
Epoch: 88 cost time: 1.3442466259002686
Epoch: 88, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.954 Vali Acc: 0.241 Test Loss: 3.954 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.2230429649353027
Epoch: 89, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.002 Vali Acc: 0.235 Test Loss: 4.002 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.0241148471832275
Epoch: 90, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.034 Vali Acc: 0.240 Test Loss: 4.034 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 1.0604534149169922
Epoch: 91, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.047 Vali Acc: 0.238 Test Loss: 4.047 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 1.2560958862304688
Epoch: 92, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.044 Vali Acc: 0.242 Test Loss: 4.044 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 1.1290440559387207
Epoch: 93, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.031 Vali Acc: 0.239 Test Loss: 4.031 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 1.127375841140747
Epoch: 94, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.045 Vali Acc: 0.240 Test Loss: 4.045 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 1.2611958980560303
Epoch: 95, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.069 Vali Acc: 0.238 Test Loss: 4.069 Test Acc: 0.238
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 1.0025856494903564
Epoch: 96, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.043 Vali Acc: 0.241 Test Loss: 4.043 Test Acc: 0.241
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 1.0296850204467773
Epoch: 97, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.071 Vali Acc: 0.240 Test Loss: 4.071 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24235294117647058
model parameter : 254058
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.547243118286133
Epoch: 1, Steps: 10 | Train Loss: 3.370 Vali Loss: 3.362 Vali Acc: 0.054 Test Loss: 3.362 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 1.1849644184112549
Epoch: 2, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.335 Vali Acc: 0.067 Test Loss: 3.335 Test Acc: 0.067
Validation loss decreased (-0.054084 --> -0.067025).  Saving model ...
Epoch: 3 cost time: 1.0669889450073242
Epoch: 3, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.328 Vali Acc: 0.059 Test Loss: 3.328 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.051879644393921
Epoch: 4, Steps: 10 | Train Loss: 3.168 Vali Loss: 3.336 Vali Acc: 0.053 Test Loss: 3.336 Test Acc: 0.053
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0137853622436523
Epoch: 5, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.347 Vali Acc: 0.052 Test Loss: 3.347 Test Acc: 0.052
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.140472412109375
Epoch: 6, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.342 Vali Acc: 0.051 Test Loss: 3.342 Test Acc: 0.051
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.098872184753418
Epoch: 7, Steps: 10 | Train Loss: 3.133 Vali Loss: 3.319 Vali Acc: 0.051 Test Loss: 3.319 Test Acc: 0.051
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9950218200683594
Epoch: 8, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.319 Vali Acc: 0.055 Test Loss: 3.319 Test Acc: 0.055
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0970540046691895
Epoch: 9, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.321 Vali Acc: 0.061 Test Loss: 3.321 Test Acc: 0.061
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1497678756713867
Epoch: 10, Steps: 10 | Train Loss: 2.991 Vali Loss: 3.312 Vali Acc: 0.066 Test Loss: 3.312 Test Acc: 0.066
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0632669925689697
Epoch: 11, Steps: 10 | Train Loss: 2.989 Vali Loss: 3.315 Vali Acc: 0.067 Test Loss: 3.315 Test Acc: 0.067
Validation loss decreased (-0.067025 --> -0.067026).  Saving model ...
Epoch: 12 cost time: 1.0630691051483154
Epoch: 12, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.304 Vali Acc: 0.062 Test Loss: 3.304 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0555627346038818
Epoch: 13, Steps: 10 | Train Loss: 2.870 Vali Loss: 3.294 Vali Acc: 0.081 Test Loss: 3.294 Test Acc: 0.081
Validation loss decreased (-0.067026 --> -0.081144).  Saving model ...
Epoch: 14 cost time: 1.005467176437378
Epoch: 14, Steps: 10 | Train Loss: 2.795 Vali Loss: 3.288 Vali Acc: 0.076 Test Loss: 3.288 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1627132892608643
Epoch: 15, Steps: 10 | Train Loss: 2.735 Vali Loss: 3.296 Vali Acc: 0.082 Test Loss: 3.296 Test Acc: 0.082
Validation loss decreased (-0.081144 --> -0.082320).  Saving model ...
Epoch: 16 cost time: 1.136214017868042
Epoch: 16, Steps: 10 | Train Loss: 2.639 Vali Loss: 3.292 Vali Acc: 0.094 Test Loss: 3.292 Test Acc: 0.094
Validation loss decreased (-0.082320 --> -0.094085).  Saving model ...
Epoch: 17 cost time: 1.138824701309204
Epoch: 17, Steps: 10 | Train Loss: 2.607 Vali Loss: 3.278 Vali Acc: 0.099 Test Loss: 3.278 Test Acc: 0.099
Validation loss decreased (-0.094085 --> -0.098791).  Saving model ...
Epoch: 18 cost time: 1.1717350482940674
Epoch: 18, Steps: 10 | Train Loss: 2.562 Vali Loss: 3.273 Vali Acc: 0.105 Test Loss: 3.273 Test Acc: 0.105
Validation loss decreased (-0.098791 --> -0.104673).  Saving model ...
Epoch: 19 cost time: 1.451378583908081
Epoch: 19, Steps: 10 | Train Loss: 2.463 Vali Loss: 3.268 Vali Acc: 0.111 Test Loss: 3.268 Test Acc: 0.111
Validation loss decreased (-0.104673 --> -0.110556).  Saving model ...
Epoch: 20 cost time: 1.2555036544799805
Epoch: 20, Steps: 10 | Train Loss: 2.413 Vali Loss: 3.261 Vali Acc: 0.120 Test Loss: 3.261 Test Acc: 0.120
Validation loss decreased (-0.110556 --> -0.119967).  Saving model ...
Epoch: 21 cost time: 1.099247932434082
Epoch: 21, Steps: 10 | Train Loss: 2.351 Vali Loss: 3.264 Vali Acc: 0.115 Test Loss: 3.264 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.144392967224121
Epoch: 22, Steps: 10 | Train Loss: 2.247 Vali Loss: 3.265 Vali Acc: 0.113 Test Loss: 3.265 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1900851726531982
Epoch: 23, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.267 Vali Acc: 0.122 Test Loss: 3.267 Test Acc: 0.122
Validation loss decreased (-0.119967 --> -0.122320).  Saving model ...
Epoch: 24 cost time: 1.226754903793335
Epoch: 24, Steps: 10 | Train Loss: 2.083 Vali Loss: 3.288 Vali Acc: 0.122 Test Loss: 3.288 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.089381217956543
Epoch: 25, Steps: 10 | Train Loss: 2.018 Vali Loss: 3.275 Vali Acc: 0.135 Test Loss: 3.275 Test Acc: 0.135
Validation loss decreased (-0.122320 --> -0.135261).  Saving model ...
Epoch: 26 cost time: 1.303400993347168
Epoch: 26, Steps: 10 | Train Loss: 1.934 Vali Loss: 3.294 Vali Acc: 0.140 Test Loss: 3.294 Test Acc: 0.140
Validation loss decreased (-0.135261 --> -0.139967).  Saving model ...
Epoch: 27 cost time: 1.1090562343597412
Epoch: 27, Steps: 10 | Train Loss: 1.820 Vali Loss: 3.273 Vali Acc: 0.147 Test Loss: 3.273 Test Acc: 0.147
Validation loss decreased (-0.139967 --> -0.147026).  Saving model ...
Epoch: 28 cost time: 1.298360824584961
Epoch: 28, Steps: 10 | Train Loss: 1.765 Vali Loss: 3.289 Vali Acc: 0.146 Test Loss: 3.289 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0985901355743408
Epoch: 29, Steps: 10 | Train Loss: 1.732 Vali Loss: 3.332 Vali Acc: 0.149 Test Loss: 3.332 Test Acc: 0.149
Validation loss decreased (-0.147026 --> -0.149378).  Saving model ...
Epoch: 30 cost time: 1.0866317749023438
Epoch: 30, Steps: 10 | Train Loss: 1.622 Vali Loss: 3.279 Vali Acc: 0.153 Test Loss: 3.279 Test Acc: 0.153
Validation loss decreased (-0.149378 --> -0.152908).  Saving model ...
Epoch: 31 cost time: 0.9854214191436768
Epoch: 31, Steps: 10 | Train Loss: 1.582 Vali Loss: 3.342 Vali Acc: 0.148 Test Loss: 3.342 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1816246509552002
Epoch: 32, Steps: 10 | Train Loss: 1.479 Vali Loss: 3.355 Vali Acc: 0.146 Test Loss: 3.355 Test Acc: 0.146
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.194458246231079
Epoch: 33, Steps: 10 | Train Loss: 1.450 Vali Loss: 3.336 Vali Acc: 0.154 Test Loss: 3.336 Test Acc: 0.154
Validation loss decreased (-0.152908 --> -0.154084).  Saving model ...
Epoch: 34 cost time: 1.093062400817871
Epoch: 34, Steps: 10 | Train Loss: 1.327 Vali Loss: 3.319 Vali Acc: 0.152 Test Loss: 3.319 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1685054302215576
Epoch: 35, Steps: 10 | Train Loss: 1.322 Vali Loss: 3.365 Vali Acc: 0.156 Test Loss: 3.365 Test Acc: 0.156
Validation loss decreased (-0.154084 --> -0.156437).  Saving model ...
Epoch: 36 cost time: 1.044255256652832
Epoch: 36, Steps: 10 | Train Loss: 1.222 Vali Loss: 3.329 Vali Acc: 0.171 Test Loss: 3.329 Test Acc: 0.171
Validation loss decreased (-0.156437 --> -0.170555).  Saving model ...
Epoch: 37 cost time: 1.3189775943756104
Epoch: 37, Steps: 10 | Train Loss: 1.176 Vali Loss: 3.428 Vali Acc: 0.156 Test Loss: 3.428 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1557643413543701
Epoch: 38, Steps: 10 | Train Loss: 1.045 Vali Loss: 3.383 Vali Acc: 0.181 Test Loss: 3.383 Test Acc: 0.181
Validation loss decreased (-0.170555 --> -0.181143).  Saving model ...
Epoch: 39 cost time: 1.2900876998901367
Epoch: 39, Steps: 10 | Train Loss: 0.997 Vali Loss: 3.384 Vali Acc: 0.178 Test Loss: 3.384 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2135207653045654
Epoch: 40, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.444 Vali Acc: 0.178 Test Loss: 3.444 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2386765480041504
Epoch: 41, Steps: 10 | Train Loss: 0.845 Vali Loss: 3.461 Vali Acc: 0.169 Test Loss: 3.461 Test Acc: 0.169
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0759425163269043
Epoch: 42, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.446 Vali Acc: 0.168 Test Loss: 3.446 Test Acc: 0.168
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0259852409362793
Epoch: 43, Steps: 10 | Train Loss: 0.769 Vali Loss: 3.513 Vali Acc: 0.165 Test Loss: 3.513 Test Acc: 0.165
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.126098394393921
Epoch: 44, Steps: 10 | Train Loss: 0.699 Vali Loss: 3.470 Vali Acc: 0.188 Test Loss: 3.470 Test Acc: 0.188
Validation loss decreased (-0.181143 --> -0.188201).  Saving model ...
Epoch: 45 cost time: 1.092935562133789
Epoch: 45, Steps: 10 | Train Loss: 0.640 Vali Loss: 3.510 Vali Acc: 0.199 Test Loss: 3.510 Test Acc: 0.199
Validation loss decreased (-0.188201 --> -0.198788).  Saving model ...
Epoch: 46 cost time: 1.0250496864318848
Epoch: 46, Steps: 10 | Train Loss: 0.593 Vali Loss: 3.556 Vali Acc: 0.176 Test Loss: 3.556 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.109804391860962
Epoch: 47, Steps: 10 | Train Loss: 0.552 Vali Loss: 3.619 Vali Acc: 0.167 Test Loss: 3.619 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.067460298538208
Epoch: 48, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.556 Vali Acc: 0.172 Test Loss: 3.556 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0331425666809082
Epoch: 49, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.610 Vali Acc: 0.204 Test Loss: 3.610 Test Acc: 0.204
Validation loss decreased (-0.198788 --> -0.203493).  Saving model ...
Epoch: 50 cost time: 0.9736373424530029
Epoch: 50, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.627 Vali Acc: 0.192 Test Loss: 3.627 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.2339839935302734
Epoch: 51, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.654 Vali Acc: 0.192 Test Loss: 3.654 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.1648836135864258
Epoch: 52, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.678 Vali Acc: 0.187 Test Loss: 3.678 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.083380937576294
Epoch: 53, Steps: 10 | Train Loss: 0.331 Vali Loss: 3.768 Vali Acc: 0.188 Test Loss: 3.768 Test Acc: 0.188
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.0454564094543457
Epoch: 54, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.783 Vali Acc: 0.180 Test Loss: 3.783 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.2732484340667725
Epoch: 55, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.784 Vali Acc: 0.199 Test Loss: 3.784 Test Acc: 0.199
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.155688762664795
Epoch: 56, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.771 Vali Acc: 0.186 Test Loss: 3.771 Test Acc: 0.186
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.1141281127929688
Epoch: 57, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.827 Vali Acc: 0.187 Test Loss: 3.827 Test Acc: 0.187
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.172349214553833
Epoch: 58, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.827 Vali Acc: 0.189 Test Loss: 3.827 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.1416594982147217
Epoch: 59, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.886 Vali Acc: 0.198 Test Loss: 3.886 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20352941176470588
model parameter : 253290
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7990543842315674
Epoch: 1, Steps: 10 | Train Loss: 3.470 Vali Loss: 3.347 Vali Acc: 0.045 Test Loss: 3.347 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 1.043381690979004
Epoch: 2, Steps: 10 | Train Loss: 3.347 Vali Loss: 3.309 Vali Acc: 0.049 Test Loss: 3.309 Test Acc: 0.049
Validation loss decreased (-0.044672 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 1.0685036182403564
Epoch: 3, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.290 Vali Acc: 0.047 Test Loss: 3.290 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3920512199401855
Epoch: 4, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.297 Vali Acc: 0.044 Test Loss: 3.297 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.172799825668335
Epoch: 5, Steps: 10 | Train Loss: 3.236 Vali Loss: 3.307 Vali Acc: 0.056 Test Loss: 3.307 Test Acc: 0.056
Validation loss decreased (-0.049379 --> -0.056438).  Saving model ...
Epoch: 6 cost time: 1.136831283569336
Epoch: 6, Steps: 10 | Train Loss: 3.186 Vali Loss: 3.305 Vali Acc: 0.061 Test Loss: 3.305 Test Acc: 0.061
Validation loss decreased (-0.056438 --> -0.061143).  Saving model ...
Epoch: 7 cost time: 1.248070478439331
Epoch: 7, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.301 Vali Acc: 0.067 Test Loss: 3.301 Test Acc: 0.067
Validation loss decreased (-0.061143 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 1.1784496307373047
Epoch: 8, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.290 Vali Acc: 0.061 Test Loss: 3.290 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1922614574432373
Epoch: 9, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.300 Vali Acc: 0.059 Test Loss: 3.300 Test Acc: 0.059
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4399657249450684
Epoch: 10, Steps: 10 | Train Loss: 3.055 Vali Loss: 3.290 Vali Acc: 0.071 Test Loss: 3.290 Test Acc: 0.071
Validation loss decreased (-0.067026 --> -0.070555).  Saving model ...
Epoch: 11 cost time: 1.2301881313323975
Epoch: 11, Steps: 10 | Train Loss: 3.011 Vali Loss: 3.279 Vali Acc: 0.081 Test Loss: 3.279 Test Acc: 0.081
Validation loss decreased (-0.070555 --> -0.081144).  Saving model ...
Epoch: 12 cost time: 1.484217643737793
Epoch: 12, Steps: 10 | Train Loss: 2.953 Vali Loss: 3.279 Vali Acc: 0.078 Test Loss: 3.279 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.164768934249878
Epoch: 13, Steps: 10 | Train Loss: 2.898 Vali Loss: 3.270 Vali Acc: 0.074 Test Loss: 3.270 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1258275508880615
Epoch: 14, Steps: 10 | Train Loss: 2.860 Vali Loss: 3.267 Vali Acc: 0.088 Test Loss: 3.267 Test Acc: 0.088
Validation loss decreased (-0.081144 --> -0.088203).  Saving model ...
Epoch: 15 cost time: 1.1883440017700195
Epoch: 15, Steps: 10 | Train Loss: 2.813 Vali Loss: 3.252 Vali Acc: 0.099 Test Loss: 3.252 Test Acc: 0.099
Validation loss decreased (-0.088203 --> -0.098791).  Saving model ...
Epoch: 16 cost time: 1.2072176933288574
Epoch: 16, Steps: 10 | Train Loss: 2.692 Vali Loss: 3.251 Vali Acc: 0.101 Test Loss: 3.251 Test Acc: 0.101
Validation loss decreased (-0.098791 --> -0.101144).  Saving model ...
Epoch: 17 cost time: 1.0479609966278076
Epoch: 17, Steps: 10 | Train Loss: 2.639 Vali Loss: 3.234 Vali Acc: 0.105 Test Loss: 3.234 Test Acc: 0.105
Validation loss decreased (-0.101144 --> -0.104674).  Saving model ...
Epoch: 18 cost time: 1.1227471828460693
Epoch: 18, Steps: 10 | Train Loss: 2.588 Vali Loss: 3.249 Vali Acc: 0.107 Test Loss: 3.249 Test Acc: 0.107
Validation loss decreased (-0.104674 --> -0.107026).  Saving model ...
Epoch: 19 cost time: 1.1230583190917969
Epoch: 19, Steps: 10 | Train Loss: 2.475 Vali Loss: 3.250 Vali Acc: 0.111 Test Loss: 3.250 Test Acc: 0.111
Validation loss decreased (-0.107026 --> -0.110556).  Saving model ...
Epoch: 20 cost time: 1.0746231079101562
Epoch: 20, Steps: 10 | Train Loss: 2.409 Vali Loss: 3.233 Vali Acc: 0.113 Test Loss: 3.233 Test Acc: 0.113
Validation loss decreased (-0.110556 --> -0.112909).  Saving model ...
Epoch: 21 cost time: 0.9529581069946289
Epoch: 21, Steps: 10 | Train Loss: 2.280 Vali Loss: 3.218 Vali Acc: 0.128 Test Loss: 3.218 Test Acc: 0.128
Validation loss decreased (-0.112909 --> -0.128203).  Saving model ...
Epoch: 22 cost time: 1.0322651863098145
Epoch: 22, Steps: 10 | Train Loss: 2.242 Vali Loss: 3.238 Vali Acc: 0.133 Test Loss: 3.238 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 23 cost time: 1.4130282402038574
Epoch: 23, Steps: 10 | Train Loss: 2.160 Vali Loss: 3.230 Vali Acc: 0.125 Test Loss: 3.230 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1935033798217773
Epoch: 24, Steps: 10 | Train Loss: 2.102 Vali Loss: 3.234 Vali Acc: 0.135 Test Loss: 3.234 Test Acc: 0.135
Validation loss decreased (-0.132909 --> -0.135262).  Saving model ...
Epoch: 25 cost time: 1.1681122779846191
Epoch: 25, Steps: 10 | Train Loss: 2.011 Vali Loss: 3.242 Vali Acc: 0.144 Test Loss: 3.242 Test Acc: 0.144
Validation loss decreased (-0.135262 --> -0.143497).  Saving model ...
Epoch: 26 cost time: 1.1672799587249756
Epoch: 26, Steps: 10 | Train Loss: 1.973 Vali Loss: 3.228 Vali Acc: 0.140 Test Loss: 3.228 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1231231689453125
Epoch: 27, Steps: 10 | Train Loss: 1.875 Vali Loss: 3.218 Vali Acc: 0.154 Test Loss: 3.218 Test Acc: 0.154
Validation loss decreased (-0.143497 --> -0.154085).  Saving model ...
Epoch: 28 cost time: 1.2282130718231201
Epoch: 28, Steps: 10 | Train Loss: 1.815 Vali Loss: 3.245 Vali Acc: 0.149 Test Loss: 3.245 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.008484125137329
Epoch: 29, Steps: 10 | Train Loss: 1.661 Vali Loss: 3.237 Vali Acc: 0.156 Test Loss: 3.237 Test Acc: 0.156
Validation loss decreased (-0.154085 --> -0.156438).  Saving model ...
Epoch: 30 cost time: 1.1723363399505615
Epoch: 30, Steps: 10 | Train Loss: 1.567 Vali Loss: 3.210 Vali Acc: 0.164 Test Loss: 3.210 Test Acc: 0.164
Validation loss decreased (-0.156438 --> -0.163497).  Saving model ...
Epoch: 31 cost time: 1.1030948162078857
Epoch: 31, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.239 Vali Acc: 0.169 Test Loss: 3.239 Test Acc: 0.169
Validation loss decreased (-0.163497 --> -0.169379).  Saving model ...
Epoch: 32 cost time: 1.2932310104370117
Epoch: 32, Steps: 10 | Train Loss: 1.422 Vali Loss: 3.245 Vali Acc: 0.165 Test Loss: 3.245 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0925045013427734
Epoch: 33, Steps: 10 | Train Loss: 1.320 Vali Loss: 3.257 Vali Acc: 0.185 Test Loss: 3.257 Test Acc: 0.185
Validation loss decreased (-0.169379 --> -0.184673).  Saving model ...
Epoch: 34 cost time: 1.3482449054718018
Epoch: 34, Steps: 10 | Train Loss: 1.266 Vali Loss: 3.300 Vali Acc: 0.174 Test Loss: 3.300 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0559425354003906
Epoch: 35, Steps: 10 | Train Loss: 1.225 Vali Loss: 3.263 Vali Acc: 0.189 Test Loss: 3.263 Test Acc: 0.189
Validation loss decreased (-0.184673 --> -0.189379).  Saving model ...
Epoch: 36 cost time: 0.9729657173156738
Epoch: 36, Steps: 10 | Train Loss: 1.147 Vali Loss: 3.293 Vali Acc: 0.185 Test Loss: 3.293 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0761981010437012
Epoch: 37, Steps: 10 | Train Loss: 1.038 Vali Loss: 3.292 Vali Acc: 0.195 Test Loss: 3.292 Test Acc: 0.195
Validation loss decreased (-0.189379 --> -0.195261).  Saving model ...
Epoch: 38 cost time: 1.178325891494751
Epoch: 38, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.306 Vali Acc: 0.195 Test Loss: 3.306 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.235121726989746
Epoch: 39, Steps: 10 | Train Loss: 0.954 Vali Loss: 3.299 Vali Acc: 0.202 Test Loss: 3.299 Test Acc: 0.202
Validation loss decreased (-0.195261 --> -0.202320).  Saving model ...
Epoch: 40 cost time: 1.0371685028076172
Epoch: 40, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.319 Vali Acc: 0.207 Test Loss: 3.319 Test Acc: 0.207
Validation loss decreased (-0.202320 --> -0.207026).  Saving model ...
Epoch: 41 cost time: 1.1908087730407715
Epoch: 41, Steps: 10 | Train Loss: 0.825 Vali Loss: 3.330 Vali Acc: 0.208 Test Loss: 3.330 Test Acc: 0.208
Validation loss decreased (-0.207026 --> -0.208202).  Saving model ...
Epoch: 42 cost time: 1.2815439701080322
Epoch: 42, Steps: 10 | Train Loss: 0.777 Vali Loss: 3.388 Vali Acc: 0.209 Test Loss: 3.388 Test Acc: 0.209
Validation loss decreased (-0.208202 --> -0.209378).  Saving model ...
Epoch: 43 cost time: 1.025589942932129
Epoch: 43, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.349 Vali Acc: 0.206 Test Loss: 3.349 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1369545459747314
Epoch: 44, Steps: 10 | Train Loss: 0.654 Vali Loss: 3.411 Vali Acc: 0.211 Test Loss: 3.411 Test Acc: 0.211
Validation loss decreased (-0.209378 --> -0.210554).  Saving model ...
Epoch: 45 cost time: 1.1397614479064941
Epoch: 45, Steps: 10 | Train Loss: 0.616 Vali Loss: 3.408 Vali Acc: 0.204 Test Loss: 3.408 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1235556602478027
Epoch: 46, Steps: 10 | Train Loss: 0.574 Vali Loss: 3.434 Vali Acc: 0.206 Test Loss: 3.434 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.98954176902771
Epoch: 47, Steps: 10 | Train Loss: 0.558 Vali Loss: 3.442 Vali Acc: 0.205 Test Loss: 3.442 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1092560291290283
Epoch: 48, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.540 Vali Acc: 0.213 Test Loss: 3.540 Test Acc: 0.213
Validation loss decreased (-0.210554 --> -0.212906).  Saving model ...
Epoch: 49 cost time: 1.1746807098388672
Epoch: 49, Steps: 10 | Train Loss: 0.466 Vali Loss: 3.633 Vali Acc: 0.204 Test Loss: 3.633 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.034318447113037
Epoch: 50, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.488 Vali Acc: 0.204 Test Loss: 3.488 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0079545974731445
Epoch: 51, Steps: 10 | Train Loss: 0.433 Vali Loss: 3.552 Vali Acc: 0.207 Test Loss: 3.552 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.107318639755249
Epoch: 52, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.526 Vali Acc: 0.213 Test Loss: 3.526 Test Acc: 0.213
Validation loss decreased (-0.212906 --> -0.212906).  Saving model ...
Epoch: 53 cost time: 1.2894906997680664
Epoch: 53, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.612 Vali Acc: 0.202 Test Loss: 3.612 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.2104578018188477
Epoch: 54, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.537 Vali Acc: 0.224 Test Loss: 3.537 Test Acc: 0.224
Validation loss decreased (-0.212906 --> -0.223494).  Saving model ...
Epoch: 55 cost time: 1.2303719520568848
Epoch: 55, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.657 Vali Acc: 0.206 Test Loss: 3.657 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.1165049076080322
Epoch: 56, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.746 Vali Acc: 0.208 Test Loss: 3.746 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1180057525634766
Epoch: 57, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.733 Vali Acc: 0.208 Test Loss: 3.733 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1650326251983643
Epoch: 58, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.690 Vali Acc: 0.211 Test Loss: 3.690 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.1101722717285156
Epoch: 59, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.792 Vali Acc: 0.226 Test Loss: 3.792 Test Acc: 0.226
Validation loss decreased (-0.223494 --> -0.225844).  Saving model ...
Epoch: 60 cost time: 1.132805585861206
Epoch: 60, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.748 Vali Acc: 0.232 Test Loss: 3.748 Test Acc: 0.232
Validation loss decreased (-0.225844 --> -0.231727).  Saving model ...
Epoch: 61 cost time: 1.0519781112670898
Epoch: 61, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.794 Vali Acc: 0.215 Test Loss: 3.794 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.1646013259887695
Epoch: 62, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.782 Vali Acc: 0.207 Test Loss: 3.782 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.105454921722412
Epoch: 63, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.800 Vali Acc: 0.224 Test Loss: 3.800 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.1875226497650146
Epoch: 64, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.913 Vali Acc: 0.225 Test Loss: 3.913 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.2198407649993896
Epoch: 65, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.838 Vali Acc: 0.213 Test Loss: 3.838 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.0625724792480469
Epoch: 66, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.893 Vali Acc: 0.234 Test Loss: 3.893 Test Acc: 0.234
Validation loss decreased (-0.231727 --> -0.234079).  Saving model ...
Epoch: 67 cost time: 1.0751380920410156
Epoch: 67, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.899 Vali Acc: 0.233 Test Loss: 3.899 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.07830810546875
Epoch: 68, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.877 Vali Acc: 0.229 Test Loss: 3.877 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.108790397644043
Epoch: 69, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.931 Vali Acc: 0.236 Test Loss: 3.931 Test Acc: 0.236
Validation loss decreased (-0.234079 --> -0.236431).  Saving model ...
Epoch: 70 cost time: 1.1973028182983398
Epoch: 70, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.926 Vali Acc: 0.222 Test Loss: 3.926 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.1181609630584717
Epoch: 71, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.915 Vali Acc: 0.248 Test Loss: 3.915 Test Acc: 0.248
Validation loss decreased (-0.236431 --> -0.248196).  Saving model ...
Epoch: 72 cost time: 1.2595207691192627
Epoch: 72, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.975 Vali Acc: 0.227 Test Loss: 3.975 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.0703742504119873
Epoch: 73, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.982 Vali Acc: 0.238 Test Loss: 3.982 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.1692490577697754
Epoch: 74, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.964 Vali Acc: 0.229 Test Loss: 3.964 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.058708906173706
Epoch: 75, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.012 Vali Acc: 0.232 Test Loss: 4.012 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.272033452987671
Epoch: 76, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.010 Vali Acc: 0.249 Test Loss: 4.010 Test Acc: 0.249
Validation loss decreased (-0.248196 --> -0.249372).  Saving model ...
Epoch: 77 cost time: 1.065782070159912
Epoch: 77, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.039 Vali Acc: 0.233 Test Loss: 4.039 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.25846266746521
Epoch: 78, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.054 Vali Acc: 0.236 Test Loss: 4.054 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.232717752456665
Epoch: 79, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.068 Vali Acc: 0.236 Test Loss: 4.068 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.170959711074829
Epoch: 80, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.083 Vali Acc: 0.236 Test Loss: 4.083 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.0054948329925537
Epoch: 81, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.114 Vali Acc: 0.245 Test Loss: 4.114 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.1207177639007568
Epoch: 82, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.120 Vali Acc: 0.242 Test Loss: 4.120 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.1359765529632568
Epoch: 83, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.107 Vali Acc: 0.226 Test Loss: 4.107 Test Acc: 0.226
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.047879695892334
Epoch: 84, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.110 Vali Acc: 0.241 Test Loss: 4.110 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 1.043870449066162
Epoch: 85, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.140 Vali Acc: 0.238 Test Loss: 4.140 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 1.1405029296875
Epoch: 86, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.159 Vali Acc: 0.242 Test Loss: 4.159 Test Acc: 0.242
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 252522
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.939887046813965
Epoch: 1, Steps: 10 | Train Loss: 3.442 Vali Loss: 3.379 Vali Acc: 0.032 Test Loss: 3.379 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 0.9322304725646973
Epoch: 2, Steps: 10 | Train Loss: 3.411 Vali Loss: 3.337 Vali Acc: 0.036 Test Loss: 3.337 Test Acc: 0.036
Validation loss decreased (-0.031731 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 0.9641852378845215
Epoch: 3, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.319 Vali Acc: 0.040 Test Loss: 3.319 Test Acc: 0.040
Validation loss decreased (-0.036437 --> -0.039967).  Saving model ...
Epoch: 4 cost time: 1.0462915897369385
Epoch: 4, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.320 Vali Acc: 0.048 Test Loss: 3.320 Test Acc: 0.048
Validation loss decreased (-0.039967 --> -0.048202).  Saving model ...
Epoch: 5 cost time: 1.0870170593261719
Epoch: 5, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.320 Vali Acc: 0.051 Test Loss: 3.320 Test Acc: 0.051
Validation loss decreased (-0.048202 --> -0.050555).  Saving model ...
Epoch: 6 cost time: 1.054166555404663
Epoch: 6, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.330 Vali Acc: 0.048 Test Loss: 3.330 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.090717077255249
Epoch: 7, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.340 Vali Acc: 0.055 Test Loss: 3.340 Test Acc: 0.055
Validation loss decreased (-0.050555 --> -0.055261).  Saving model ...
Epoch: 8 cost time: 1.0655264854431152
Epoch: 8, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.333 Vali Acc: 0.059 Test Loss: 3.333 Test Acc: 0.059
Validation loss decreased (-0.055261 --> -0.058790).  Saving model ...
Epoch: 9 cost time: 1.150184154510498
Epoch: 9, Steps: 10 | Train Loss: 3.028 Vali Loss: 3.330 Vali Acc: 0.062 Test Loss: 3.330 Test Acc: 0.062
Validation loss decreased (-0.058790 --> -0.062320).  Saving model ...
Epoch: 10 cost time: 1.0472426414489746
Epoch: 10, Steps: 10 | Train Loss: 3.037 Vali Loss: 3.306 Vali Acc: 0.065 Test Loss: 3.306 Test Acc: 0.065
Validation loss decreased (-0.062320 --> -0.064673).  Saving model ...
Epoch: 11 cost time: 1.1395299434661865
Epoch: 11, Steps: 10 | Train Loss: 2.959 Vali Loss: 3.299 Vali Acc: 0.071 Test Loss: 3.299 Test Acc: 0.071
Validation loss decreased (-0.064673 --> -0.070555).  Saving model ...
Epoch: 12 cost time: 1.367163896560669
Epoch: 12, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.287 Vali Acc: 0.082 Test Loss: 3.287 Test Acc: 0.082
Validation loss decreased (-0.070555 --> -0.082320).  Saving model ...
Epoch: 13 cost time: 1.0374953746795654
Epoch: 13, Steps: 10 | Train Loss: 2.866 Vali Loss: 3.278 Vali Acc: 0.092 Test Loss: 3.278 Test Acc: 0.092
Validation loss decreased (-0.082320 --> -0.091732).  Saving model ...
Epoch: 14 cost time: 1.123863935470581
Epoch: 14, Steps: 10 | Train Loss: 2.856 Vali Loss: 3.287 Vali Acc: 0.088 Test Loss: 3.287 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9998857975006104
Epoch: 15, Steps: 10 | Train Loss: 2.752 Vali Loss: 3.298 Vali Acc: 0.096 Test Loss: 3.298 Test Acc: 0.096
Validation loss decreased (-0.091732 --> -0.096438).  Saving model ...
Epoch: 16 cost time: 1.068937063217163
Epoch: 16, Steps: 10 | Train Loss: 2.704 Vali Loss: 3.278 Vali Acc: 0.099 Test Loss: 3.278 Test Acc: 0.099
Validation loss decreased (-0.096438 --> -0.098791).  Saving model ...
Epoch: 17 cost time: 1.110175609588623
Epoch: 17, Steps: 10 | Train Loss: 2.632 Vali Loss: 3.270 Vali Acc: 0.099 Test Loss: 3.270 Test Acc: 0.099
Validation loss decreased (-0.098791 --> -0.098791).  Saving model ...
Epoch: 18 cost time: 1.0796382427215576
Epoch: 18, Steps: 10 | Train Loss: 2.544 Vali Loss: 3.258 Vali Acc: 0.105 Test Loss: 3.258 Test Acc: 0.105
Validation loss decreased (-0.098791 --> -0.104673).  Saving model ...
Epoch: 19 cost time: 1.085275650024414
Epoch: 19, Steps: 10 | Train Loss: 2.539 Vali Loss: 3.269 Vali Acc: 0.114 Test Loss: 3.269 Test Acc: 0.114
Validation loss decreased (-0.104673 --> -0.114085).  Saving model ...
Epoch: 20 cost time: 0.9566221237182617
Epoch: 20, Steps: 10 | Train Loss: 2.485 Vali Loss: 3.268 Vali Acc: 0.115 Test Loss: 3.268 Test Acc: 0.115
Validation loss decreased (-0.114085 --> -0.115261).  Saving model ...
Epoch: 21 cost time: 1.0465905666351318
Epoch: 21, Steps: 10 | Train Loss: 2.375 Vali Loss: 3.265 Vali Acc: 0.116 Test Loss: 3.265 Test Acc: 0.116
Validation loss decreased (-0.115261 --> -0.116438).  Saving model ...
Epoch: 22 cost time: 1.0412037372589111
Epoch: 22, Steps: 10 | Train Loss: 2.275 Vali Loss: 3.251 Vali Acc: 0.140 Test Loss: 3.251 Test Acc: 0.140
Validation loss decreased (-0.116438 --> -0.139967).  Saving model ...
Epoch: 23 cost time: 1.1188957691192627
Epoch: 23, Steps: 10 | Train Loss: 2.223 Vali Loss: 3.254 Vali Acc: 0.129 Test Loss: 3.254 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0148000717163086
Epoch: 24, Steps: 10 | Train Loss: 2.128 Vali Loss: 3.236 Vali Acc: 0.138 Test Loss: 3.236 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1443920135498047
Epoch: 25, Steps: 10 | Train Loss: 2.081 Vali Loss: 3.268 Vali Acc: 0.141 Test Loss: 3.268 Test Acc: 0.141
Validation loss decreased (-0.139967 --> -0.141144).  Saving model ...
Epoch: 26 cost time: 1.0951752662658691
Epoch: 26, Steps: 10 | Train Loss: 1.962 Vali Loss: 3.261 Vali Acc: 0.136 Test Loss: 3.261 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9634873867034912
Epoch: 27, Steps: 10 | Train Loss: 1.917 Vali Loss: 3.250 Vali Acc: 0.138 Test Loss: 3.250 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9474267959594727
Epoch: 28, Steps: 10 | Train Loss: 1.865 Vali Loss: 3.294 Vali Acc: 0.147 Test Loss: 3.294 Test Acc: 0.147
Validation loss decreased (-0.141144 --> -0.147026).  Saving model ...
Epoch: 29 cost time: 0.9067199230194092
Epoch: 29, Steps: 10 | Train Loss: 1.739 Vali Loss: 3.291 Vali Acc: 0.156 Test Loss: 3.291 Test Acc: 0.156
Validation loss decreased (-0.147026 --> -0.156438).  Saving model ...
Epoch: 30 cost time: 1.263162612915039
Epoch: 30, Steps: 10 | Train Loss: 1.699 Vali Loss: 3.323 Vali Acc: 0.154 Test Loss: 3.323 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.879295825958252
Epoch: 31, Steps: 10 | Train Loss: 1.579 Vali Loss: 3.281 Vali Acc: 0.154 Test Loss: 3.281 Test Acc: 0.154
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0429105758666992
Epoch: 32, Steps: 10 | Train Loss: 1.585 Vali Loss: 3.323 Vali Acc: 0.159 Test Loss: 3.323 Test Acc: 0.159
Validation loss decreased (-0.156438 --> -0.158790).  Saving model ...
Epoch: 33 cost time: 1.1458814144134521
Epoch: 33, Steps: 10 | Train Loss: 1.468 Vali Loss: 3.347 Vali Acc: 0.156 Test Loss: 3.347 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.933295726776123
Epoch: 34, Steps: 10 | Train Loss: 1.408 Vali Loss: 3.363 Vali Acc: 0.169 Test Loss: 3.363 Test Acc: 0.169
Validation loss decreased (-0.158790 --> -0.169378).  Saving model ...
Epoch: 35 cost time: 0.9157912731170654
Epoch: 35, Steps: 10 | Train Loss: 1.340 Vali Loss: 3.349 Vali Acc: 0.151 Test Loss: 3.349 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0095758438110352
Epoch: 36, Steps: 10 | Train Loss: 1.268 Vali Loss: 3.352 Vali Acc: 0.162 Test Loss: 3.352 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.114731788635254
Epoch: 37, Steps: 10 | Train Loss: 1.154 Vali Loss: 3.367 Vali Acc: 0.173 Test Loss: 3.367 Test Acc: 0.173
Validation loss decreased (-0.169378 --> -0.172908).  Saving model ...
Epoch: 38 cost time: 1.008944034576416
Epoch: 38, Steps: 10 | Train Loss: 1.150 Vali Loss: 3.385 Vali Acc: 0.180 Test Loss: 3.385 Test Acc: 0.180
Validation loss decreased (-0.172908 --> -0.179966).  Saving model ...
Epoch: 39 cost time: 0.9439272880554199
Epoch: 39, Steps: 10 | Train Loss: 1.036 Vali Loss: 3.400 Vali Acc: 0.166 Test Loss: 3.400 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.265345811843872
Epoch: 40, Steps: 10 | Train Loss: 0.946 Vali Loss: 3.405 Vali Acc: 0.172 Test Loss: 3.405 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1373579502105713
Epoch: 41, Steps: 10 | Train Loss: 0.929 Vali Loss: 3.446 Vali Acc: 0.181 Test Loss: 3.446 Test Acc: 0.181
Validation loss decreased (-0.179966 --> -0.181142).  Saving model ...
Epoch: 42 cost time: 1.1426522731781006
Epoch: 42, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.464 Vali Acc: 0.171 Test Loss: 3.464 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8944380283355713
Epoch: 43, Steps: 10 | Train Loss: 0.768 Vali Loss: 3.454 Vali Acc: 0.185 Test Loss: 3.454 Test Acc: 0.185
Validation loss decreased (-0.181142 --> -0.184671).  Saving model ...
Epoch: 44 cost time: 1.2413649559020996
Epoch: 44, Steps: 10 | Train Loss: 0.731 Vali Loss: 3.442 Vali Acc: 0.180 Test Loss: 3.442 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9738116264343262
Epoch: 45, Steps: 10 | Train Loss: 0.676 Vali Loss: 3.540 Vali Acc: 0.179 Test Loss: 3.540 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8878934383392334
Epoch: 46, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.488 Vali Acc: 0.188 Test Loss: 3.488 Test Acc: 0.188
Validation loss decreased (-0.184671 --> -0.188200).  Saving model ...
Epoch: 47 cost time: 1.0932958126068115
Epoch: 47, Steps: 10 | Train Loss: 0.606 Vali Loss: 3.566 Vali Acc: 0.188 Test Loss: 3.566 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0878965854644775
Epoch: 48, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.573 Vali Acc: 0.173 Test Loss: 3.573 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0767676830291748
Epoch: 49, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.531 Vali Acc: 0.185 Test Loss: 3.531 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.010662317276001
Epoch: 50, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.604 Vali Acc: 0.186 Test Loss: 3.604 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.97489333152771
Epoch: 51, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.574 Vali Acc: 0.193 Test Loss: 3.574 Test Acc: 0.193
Validation loss decreased (-0.188200 --> -0.192905).  Saving model ...
Epoch: 52 cost time: 0.9668383598327637
Epoch: 52, Steps: 10 | Train Loss: 0.372 Vali Loss: 3.669 Vali Acc: 0.198 Test Loss: 3.669 Test Acc: 0.198
Validation loss decreased (-0.192905 --> -0.197610).  Saving model ...
Epoch: 53 cost time: 1.057189702987671
Epoch: 53, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.700 Vali Acc: 0.193 Test Loss: 3.700 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.213987112045288
Epoch: 54, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.674 Vali Acc: 0.193 Test Loss: 3.674 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.1809608936309814
Epoch: 55, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.648 Vali Acc: 0.208 Test Loss: 3.648 Test Acc: 0.208
Validation loss decreased (-0.197610 --> -0.208199).  Saving model ...
Epoch: 56 cost time: 1.198385238647461
Epoch: 56, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.729 Vali Acc: 0.195 Test Loss: 3.729 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3416895866394043
Epoch: 57, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.762 Vali Acc: 0.201 Test Loss: 3.762 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.1376237869262695
Epoch: 58, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.735 Vali Acc: 0.207 Test Loss: 3.735 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.1515138149261475
Epoch: 59, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.764 Vali Acc: 0.196 Test Loss: 3.764 Test Acc: 0.196
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.066390037536621
Epoch: 60, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.795 Vali Acc: 0.201 Test Loss: 3.795 Test Acc: 0.201
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.1399543285369873
Epoch: 61, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.852 Vali Acc: 0.199 Test Loss: 3.852 Test Acc: 0.199
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.0750923156738281
Epoch: 62, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.827 Vali Acc: 0.205 Test Loss: 3.827 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.1833479404449463
Epoch: 63, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.855 Vali Acc: 0.198 Test Loss: 3.855 Test Acc: 0.198
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.1482775211334229
Epoch: 64, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.829 Vali Acc: 0.202 Test Loss: 3.829 Test Acc: 0.202
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.1545071601867676
Epoch: 65, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.898 Vali Acc: 0.207 Test Loss: 3.898 Test Acc: 0.207
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20823529411764705
model parameter : 251754
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3084075450897217
Epoch: 1, Steps: 10 | Train Loss: 3.452 Vali Loss: 3.403 Vali Acc: 0.029 Test Loss: 3.403 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 1.0431404113769531
Epoch: 2, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.354 Vali Acc: 0.033 Test Loss: 3.354 Test Acc: 0.033
Validation loss decreased (-0.029378 --> -0.032908).  Saving model ...
Epoch: 3 cost time: 1.0443553924560547
Epoch: 3, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.323 Vali Acc: 0.035 Test Loss: 3.323 Test Acc: 0.035
Validation loss decreased (-0.032908 --> -0.035261).  Saving model ...
Epoch: 4 cost time: 1.0956401824951172
Epoch: 4, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.310 Vali Acc: 0.033 Test Loss: 3.310 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0176169872283936
Epoch: 5, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.308 Vali Acc: 0.061 Test Loss: 3.308 Test Acc: 0.061
Validation loss decreased (-0.035261 --> -0.061143).  Saving model ...
Epoch: 6 cost time: 1.0579664707183838
Epoch: 6, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.311 Vali Acc: 0.068 Test Loss: 3.311 Test Acc: 0.068
Validation loss decreased (-0.061143 --> -0.068202).  Saving model ...
Epoch: 7 cost time: 0.989398717880249
Epoch: 7, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.322 Vali Acc: 0.061 Test Loss: 3.322 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0337486267089844
Epoch: 8, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.310 Vali Acc: 0.069 Test Loss: 3.310 Test Acc: 0.069
Validation loss decreased (-0.068202 --> -0.069379).  Saving model ...
Epoch: 9 cost time: 0.9774391651153564
Epoch: 9, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.300 Vali Acc: 0.072 Test Loss: 3.300 Test Acc: 0.072
Validation loss decreased (-0.069379 --> -0.071732).  Saving model ...
Epoch: 10 cost time: 1.0345187187194824
Epoch: 10, Steps: 10 | Train Loss: 3.073 Vali Loss: 3.292 Vali Acc: 0.064 Test Loss: 3.292 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9621591567993164
Epoch: 11, Steps: 10 | Train Loss: 3.037 Vali Loss: 3.282 Vali Acc: 0.074 Test Loss: 3.282 Test Acc: 0.074
Validation loss decreased (-0.071732 --> -0.074085).  Saving model ...
Epoch: 12 cost time: 0.8910789489746094
Epoch: 12, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.282 Vali Acc: 0.084 Test Loss: 3.282 Test Acc: 0.084
Validation loss decreased (-0.074085 --> -0.083497).  Saving model ...
Epoch: 13 cost time: 0.9486615657806396
Epoch: 13, Steps: 10 | Train Loss: 2.972 Vali Loss: 3.266 Vali Acc: 0.080 Test Loss: 3.266 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9941208362579346
Epoch: 14, Steps: 10 | Train Loss: 2.876 Vali Loss: 3.265 Vali Acc: 0.068 Test Loss: 3.265 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8726046085357666
Epoch: 15, Steps: 10 | Train Loss: 2.857 Vali Loss: 3.266 Vali Acc: 0.091 Test Loss: 3.266 Test Acc: 0.091
Validation loss decreased (-0.083497 --> -0.090556).  Saving model ...
Epoch: 16 cost time: 1.0456507205963135
Epoch: 16, Steps: 10 | Train Loss: 2.796 Vali Loss: 3.254 Vali Acc: 0.088 Test Loss: 3.254 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0442416667938232
Epoch: 17, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.261 Vali Acc: 0.096 Test Loss: 3.261 Test Acc: 0.096
Validation loss decreased (-0.090556 --> -0.096438).  Saving model ...
Epoch: 18 cost time: 1.099273920059204
Epoch: 18, Steps: 10 | Train Loss: 2.629 Vali Loss: 3.255 Vali Acc: 0.089 Test Loss: 3.255 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9540097713470459
Epoch: 19, Steps: 10 | Train Loss: 2.571 Vali Loss: 3.235 Vali Acc: 0.093 Test Loss: 3.235 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.946246862411499
Epoch: 20, Steps: 10 | Train Loss: 2.520 Vali Loss: 3.232 Vali Acc: 0.108 Test Loss: 3.232 Test Acc: 0.108
Validation loss decreased (-0.096438 --> -0.108203).  Saving model ...
Epoch: 21 cost time: 1.096646785736084
Epoch: 21, Steps: 10 | Train Loss: 2.403 Vali Loss: 3.244 Vali Acc: 0.109 Test Loss: 3.244 Test Acc: 0.109
Validation loss decreased (-0.108203 --> -0.109379).  Saving model ...
Epoch: 22 cost time: 0.9398436546325684
Epoch: 22, Steps: 10 | Train Loss: 2.371 Vali Loss: 3.230 Vali Acc: 0.109 Test Loss: 3.230 Test Acc: 0.109
Validation loss decreased (-0.109379 --> -0.109379).  Saving model ...
Epoch: 23 cost time: 1.0379748344421387
Epoch: 23, Steps: 10 | Train Loss: 2.295 Vali Loss: 3.215 Vali Acc: 0.115 Test Loss: 3.215 Test Acc: 0.115
Validation loss decreased (-0.109379 --> -0.115262).  Saving model ...
Epoch: 24 cost time: 1.0747499465942383
Epoch: 24, Steps: 10 | Train Loss: 2.210 Vali Loss: 3.236 Vali Acc: 0.124 Test Loss: 3.236 Test Acc: 0.124
Validation loss decreased (-0.115262 --> -0.123497).  Saving model ...
Epoch: 25 cost time: 1.082082986831665
Epoch: 25, Steps: 10 | Train Loss: 2.151 Vali Loss: 3.225 Vali Acc: 0.131 Test Loss: 3.225 Test Acc: 0.131
Validation loss decreased (-0.123497 --> -0.130556).  Saving model ...
Epoch: 26 cost time: 0.9118757247924805
Epoch: 26, Steps: 10 | Train Loss: 2.061 Vali Loss: 3.220 Vali Acc: 0.131 Test Loss: 3.220 Test Acc: 0.131
Validation loss decreased (-0.130556 --> -0.130556).  Saving model ...
Epoch: 27 cost time: 1.0503261089324951
Epoch: 27, Steps: 10 | Train Loss: 1.990 Vali Loss: 3.240 Vali Acc: 0.131 Test Loss: 3.240 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2319567203521729
Epoch: 28, Steps: 10 | Train Loss: 1.887 Vali Loss: 3.223 Vali Acc: 0.135 Test Loss: 3.223 Test Acc: 0.135
Validation loss decreased (-0.130556 --> -0.135262).  Saving model ...
Epoch: 29 cost time: 1.0757133960723877
Epoch: 29, Steps: 10 | Train Loss: 1.799 Vali Loss: 3.246 Vali Acc: 0.136 Test Loss: 3.246 Test Acc: 0.136
Validation loss decreased (-0.135262 --> -0.136438).  Saving model ...
Epoch: 30 cost time: 0.9904415607452393
Epoch: 30, Steps: 10 | Train Loss: 1.755 Vali Loss: 3.219 Vali Acc: 0.135 Test Loss: 3.219 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.008018970489502
Epoch: 31, Steps: 10 | Train Loss: 1.694 Vali Loss: 3.236 Vali Acc: 0.142 Test Loss: 3.236 Test Acc: 0.142
Validation loss decreased (-0.136438 --> -0.142321).  Saving model ...
Epoch: 32 cost time: 1.003845453262329
Epoch: 32, Steps: 10 | Train Loss: 1.559 Vali Loss: 3.249 Vali Acc: 0.144 Test Loss: 3.249 Test Acc: 0.144
Validation loss decreased (-0.142321 --> -0.143497).  Saving model ...
Epoch: 33 cost time: 1.0065436363220215
Epoch: 33, Steps: 10 | Train Loss: 1.527 Vali Loss: 3.242 Vali Acc: 0.156 Test Loss: 3.242 Test Acc: 0.156
Validation loss decreased (-0.143497 --> -0.156438).  Saving model ...
Epoch: 34 cost time: 0.8968777656555176
Epoch: 34, Steps: 10 | Train Loss: 1.468 Vali Loss: 3.257 Vali Acc: 0.148 Test Loss: 3.257 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8694431781768799
Epoch: 35, Steps: 10 | Train Loss: 1.466 Vali Loss: 3.268 Vali Acc: 0.164 Test Loss: 3.268 Test Acc: 0.164
Validation loss decreased (-0.156438 --> -0.163497).  Saving model ...
Epoch: 36 cost time: 0.9004883766174316
Epoch: 36, Steps: 10 | Train Loss: 1.345 Vali Loss: 3.295 Vali Acc: 0.161 Test Loss: 3.295 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0007638931274414
Epoch: 37, Steps: 10 | Train Loss: 1.248 Vali Loss: 3.289 Vali Acc: 0.152 Test Loss: 3.289 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1401526927947998
Epoch: 38, Steps: 10 | Train Loss: 1.155 Vali Loss: 3.341 Vali Acc: 0.155 Test Loss: 3.341 Test Acc: 0.155
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9884548187255859
Epoch: 39, Steps: 10 | Train Loss: 1.149 Vali Loss: 3.309 Vali Acc: 0.160 Test Loss: 3.309 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0951645374298096
Epoch: 40, Steps: 10 | Train Loss: 1.034 Vali Loss: 3.316 Vali Acc: 0.158 Test Loss: 3.316 Test Acc: 0.158
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0614526271820068
Epoch: 41, Steps: 10 | Train Loss: 1.007 Vali Loss: 3.364 Vali Acc: 0.165 Test Loss: 3.364 Test Acc: 0.165
Validation loss decreased (-0.163497 --> -0.164672).  Saving model ...
Epoch: 42 cost time: 1.021571159362793
Epoch: 42, Steps: 10 | Train Loss: 0.904 Vali Loss: 3.358 Vali Acc: 0.159 Test Loss: 3.358 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1156444549560547
Epoch: 43, Steps: 10 | Train Loss: 0.863 Vali Loss: 3.376 Vali Acc: 0.158 Test Loss: 3.376 Test Acc: 0.158
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.949725866317749
Epoch: 44, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.412 Vali Acc: 0.160 Test Loss: 3.412 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0591962337493896
Epoch: 45, Steps: 10 | Train Loss: 0.757 Vali Loss: 3.419 Vali Acc: 0.166 Test Loss: 3.419 Test Acc: 0.166
Validation loss decreased (-0.164672 --> -0.165848).  Saving model ...
Epoch: 46 cost time: 1.0732848644256592
Epoch: 46, Steps: 10 | Train Loss: 0.713 Vali Loss: 3.393 Vali Acc: 0.167 Test Loss: 3.393 Test Acc: 0.167
Validation loss decreased (-0.165848 --> -0.167025).  Saving model ...
Epoch: 47 cost time: 1.0387835502624512
Epoch: 47, Steps: 10 | Train Loss: 0.681 Vali Loss: 3.506 Vali Acc: 0.169 Test Loss: 3.506 Test Acc: 0.169
Validation loss decreased (-0.167025 --> -0.169377).  Saving model ...
Epoch: 48 cost time: 1.0027477741241455
Epoch: 48, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.547 Vali Acc: 0.156 Test Loss: 3.547 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1449670791625977
Epoch: 49, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.511 Vali Acc: 0.174 Test Loss: 3.511 Test Acc: 0.174
Validation loss decreased (-0.169377 --> -0.174083).  Saving model ...
Epoch: 50 cost time: 1.0526831150054932
Epoch: 50, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.542 Vali Acc: 0.174 Test Loss: 3.542 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9576456546783447
Epoch: 51, Steps: 10 | Train Loss: 0.477 Vali Loss: 3.519 Vali Acc: 0.178 Test Loss: 3.519 Test Acc: 0.178
Validation loss decreased (-0.174083 --> -0.177612).  Saving model ...
Epoch: 52 cost time: 1.1185879707336426
Epoch: 52, Steps: 10 | Train Loss: 0.418 Vali Loss: 3.552 Vali Acc: 0.181 Test Loss: 3.552 Test Acc: 0.181
Validation loss decreased (-0.177612 --> -0.181141).  Saving model ...
Epoch: 53 cost time: 1.1226654052734375
Epoch: 53, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.569 Vali Acc: 0.182 Test Loss: 3.569 Test Acc: 0.182
Validation loss decreased (-0.181141 --> -0.182317).  Saving model ...
Epoch: 54 cost time: 1.0814039707183838
Epoch: 54, Steps: 10 | Train Loss: 0.348 Vali Loss: 3.629 Vali Acc: 0.173 Test Loss: 3.629 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.2849669456481934
Epoch: 55, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.602 Vali Acc: 0.191 Test Loss: 3.602 Test Acc: 0.191
Validation loss decreased (-0.182317 --> -0.190552).  Saving model ...
Epoch: 56 cost time: 1.2215800285339355
Epoch: 56, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.637 Vali Acc: 0.189 Test Loss: 3.637 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.2694084644317627
Epoch: 57, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.668 Vali Acc: 0.178 Test Loss: 3.668 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.2947165966033936
Epoch: 58, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.708 Vali Acc: 0.181 Test Loss: 3.708 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.3262629508972168
Epoch: 59, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.692 Vali Acc: 0.195 Test Loss: 3.692 Test Acc: 0.195
Validation loss decreased (-0.190552 --> -0.195257).  Saving model ...
Epoch: 60 cost time: 1.3743400573730469
Epoch: 60, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.728 Vali Acc: 0.198 Test Loss: 3.728 Test Acc: 0.198
Validation loss decreased (-0.195257 --> -0.197610).  Saving model ...
Epoch: 61 cost time: 1.158155918121338
Epoch: 61, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.772 Vali Acc: 0.191 Test Loss: 3.772 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.109428882598877
Epoch: 62, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.859 Vali Acc: 0.191 Test Loss: 3.859 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.0790927410125732
Epoch: 63, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.778 Vali Acc: 0.194 Test Loss: 3.778 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.049936056137085
Epoch: 64, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.833 Vali Acc: 0.199 Test Loss: 3.833 Test Acc: 0.199
Validation loss decreased (-0.197610 --> -0.198785).  Saving model ...
Epoch: 65 cost time: 1.1225595474243164
Epoch: 65, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.841 Vali Acc: 0.198 Test Loss: 3.841 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.0219123363494873
Epoch: 66, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.858 Vali Acc: 0.200 Test Loss: 3.858 Test Acc: 0.200
Validation loss decreased (-0.198785 --> -0.199961).  Saving model ...
Epoch: 67 cost time: 0.9456937313079834
Epoch: 67, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.865 Vali Acc: 0.201 Test Loss: 3.865 Test Acc: 0.201
Validation loss decreased (-0.199961 --> -0.201138).  Saving model ...
Epoch: 68 cost time: 1.1893949508666992
Epoch: 68, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.904 Vali Acc: 0.200 Test Loss: 3.904 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.1895270347595215
Epoch: 69, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.951 Vali Acc: 0.195 Test Loss: 3.951 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.253600835800171
Epoch: 70, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.931 Vali Acc: 0.204 Test Loss: 3.931 Test Acc: 0.204
Validation loss decreased (-0.201138 --> -0.203490).  Saving model ...
Epoch: 71 cost time: 1.433826208114624
Epoch: 71, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.950 Vali Acc: 0.215 Test Loss: 3.950 Test Acc: 0.215
Validation loss decreased (-0.203490 --> -0.215255).  Saving model ...
Epoch: 72 cost time: 1.038097620010376
Epoch: 72, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.972 Vali Acc: 0.214 Test Loss: 3.972 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.9529087543487549
Epoch: 73, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.012 Vali Acc: 0.212 Test Loss: 4.012 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.2389888763427734
Epoch: 74, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.038 Vali Acc: 0.205 Test Loss: 4.038 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.152055263519287
Epoch: 75, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.047 Vali Acc: 0.214 Test Loss: 4.047 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.1687049865722656
Epoch: 76, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.073 Vali Acc: 0.208 Test Loss: 4.073 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.8947122097015381
Epoch: 77, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.075 Vali Acc: 0.205 Test Loss: 4.075 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.2114388942718506
Epoch: 78, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.045 Vali Acc: 0.212 Test Loss: 4.045 Test Acc: 0.212
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 1.082901954650879
Epoch: 79, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.104 Vali Acc: 0.208 Test Loss: 4.104 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 1.008195400238037
Epoch: 80, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.167 Vali Acc: 0.201 Test Loss: 4.167 Test Acc: 0.201
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 1.110630989074707
Epoch: 81, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.116 Vali Acc: 0.205 Test Loss: 4.116 Test Acc: 0.205
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21529411764705883
model parameter : 195818
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4547479152679443
Epoch: 1, Steps: 10 | Train Loss: 3.444 Vali Loss: 3.454 Vali Acc: 0.038 Test Loss: 3.454 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 0.993464469909668
Epoch: 2, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.396 Vali Acc: 0.039 Test Loss: 3.396 Test Acc: 0.039
Validation loss decreased (-0.037613 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 1.0393424034118652
Epoch: 3, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.357 Vali Acc: 0.046 Test Loss: 3.357 Test Acc: 0.046
Validation loss decreased (-0.038790 --> -0.045849).  Saving model ...
Epoch: 4 cost time: 1.0438942909240723
Epoch: 4, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.348 Vali Acc: 0.041 Test Loss: 3.348 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0866973400115967
Epoch: 5, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.348 Vali Acc: 0.049 Test Loss: 3.348 Test Acc: 0.049
Validation loss decreased (-0.045849 --> -0.049378).  Saving model ...
Epoch: 6 cost time: 1.0603129863739014
Epoch: 6, Steps: 10 | Train Loss: 3.151 Vali Loss: 3.347 Vali Acc: 0.051 Test Loss: 3.347 Test Acc: 0.051
Validation loss decreased (-0.049378 --> -0.050555).  Saving model ...
Epoch: 7 cost time: 1.146702766418457
Epoch: 7, Steps: 10 | Train Loss: 3.160 Vali Loss: 3.352 Vali Acc: 0.055 Test Loss: 3.352 Test Acc: 0.055
Validation loss decreased (-0.050555 --> -0.055261).  Saving model ...
Epoch: 8 cost time: 1.1852946281433105
Epoch: 8, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.343 Vali Acc: 0.054 Test Loss: 3.343 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0949578285217285
Epoch: 9, Steps: 10 | Train Loss: 3.114 Vali Loss: 3.334 Vali Acc: 0.055 Test Loss: 3.334 Test Acc: 0.055
Validation loss decreased (-0.055261 --> -0.055261).  Saving model ...
Epoch: 10 cost time: 1.1903185844421387
Epoch: 10, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.330 Vali Acc: 0.072 Test Loss: 3.330 Test Acc: 0.072
Validation loss decreased (-0.055261 --> -0.071731).  Saving model ...
Epoch: 11 cost time: 1.0411183834075928
Epoch: 11, Steps: 10 | Train Loss: 3.051 Vali Loss: 3.319 Vali Acc: 0.067 Test Loss: 3.319 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.093435287475586
Epoch: 12, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.331 Vali Acc: 0.065 Test Loss: 3.331 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1162395477294922
Epoch: 13, Steps: 10 | Train Loss: 2.933 Vali Loss: 3.315 Vali Acc: 0.085 Test Loss: 3.315 Test Acc: 0.085
Validation loss decreased (-0.071731 --> -0.084673).  Saving model ...
Epoch: 14 cost time: 1.1736023426055908
Epoch: 14, Steps: 10 | Train Loss: 2.895 Vali Loss: 3.310 Vali Acc: 0.091 Test Loss: 3.310 Test Acc: 0.091
Validation loss decreased (-0.084673 --> -0.090555).  Saving model ...
Epoch: 15 cost time: 1.0243611335754395
Epoch: 15, Steps: 10 | Train Loss: 2.866 Vali Loss: 3.299 Vali Acc: 0.098 Test Loss: 3.299 Test Acc: 0.098
Validation loss decreased (-0.090555 --> -0.097614).  Saving model ...
Epoch: 16 cost time: 1.0708494186401367
Epoch: 16, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.303 Vali Acc: 0.093 Test Loss: 3.303 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0859103202819824
Epoch: 17, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.288 Vali Acc: 0.093 Test Loss: 3.288 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0737895965576172
Epoch: 18, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.290 Vali Acc: 0.096 Test Loss: 3.290 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2368624210357666
Epoch: 19, Steps: 10 | Train Loss: 2.636 Vali Loss: 3.287 Vali Acc: 0.109 Test Loss: 3.287 Test Acc: 0.109
Validation loss decreased (-0.097614 --> -0.109379).  Saving model ...
Epoch: 20 cost time: 1.1612153053283691
Epoch: 20, Steps: 10 | Train Loss: 2.483 Vali Loss: 3.267 Vali Acc: 0.113 Test Loss: 3.267 Test Acc: 0.113
Validation loss decreased (-0.109379 --> -0.112909).  Saving model ...
Epoch: 21 cost time: 1.2191624641418457
Epoch: 21, Steps: 10 | Train Loss: 2.442 Vali Loss: 3.290 Vali Acc: 0.111 Test Loss: 3.290 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0864639282226562
Epoch: 22, Steps: 10 | Train Loss: 2.367 Vali Loss: 3.250 Vali Acc: 0.120 Test Loss: 3.250 Test Acc: 0.120
Validation loss decreased (-0.112909 --> -0.119968).  Saving model ...
Epoch: 23 cost time: 1.0736873149871826
Epoch: 23, Steps: 10 | Train Loss: 2.279 Vali Loss: 3.255 Vali Acc: 0.126 Test Loss: 3.255 Test Acc: 0.126
Validation loss decreased (-0.119968 --> -0.125850).  Saving model ...
Epoch: 24 cost time: 1.196720838546753
Epoch: 24, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.238 Vali Acc: 0.125 Test Loss: 3.238 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0035693645477295
Epoch: 25, Steps: 10 | Train Loss: 2.143 Vali Loss: 3.227 Vali Acc: 0.147 Test Loss: 3.227 Test Acc: 0.147
Validation loss decreased (-0.125850 --> -0.147027).  Saving model ...
Epoch: 26 cost time: 1.0398354530334473
Epoch: 26, Steps: 10 | Train Loss: 2.030 Vali Loss: 3.239 Vali Acc: 0.146 Test Loss: 3.239 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2309160232543945
Epoch: 27, Steps: 10 | Train Loss: 1.948 Vali Loss: 3.239 Vali Acc: 0.151 Test Loss: 3.239 Test Acc: 0.151
Validation loss decreased (-0.147027 --> -0.150556).  Saving model ...
Epoch: 28 cost time: 0.9445841312408447
Epoch: 28, Steps: 10 | Train Loss: 1.838 Vali Loss: 3.217 Vali Acc: 0.155 Test Loss: 3.217 Test Acc: 0.155
Validation loss decreased (-0.150556 --> -0.155262).  Saving model ...
Epoch: 29 cost time: 0.9730925559997559
Epoch: 29, Steps: 10 | Train Loss: 1.816 Vali Loss: 3.232 Vali Acc: 0.165 Test Loss: 3.232 Test Acc: 0.165
Validation loss decreased (-0.155262 --> -0.164674).  Saving model ...
Epoch: 30 cost time: 1.014768362045288
Epoch: 30, Steps: 10 | Train Loss: 1.658 Vali Loss: 3.222 Vali Acc: 0.161 Test Loss: 3.222 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.087172269821167
Epoch: 31, Steps: 10 | Train Loss: 1.647 Vali Loss: 3.218 Vali Acc: 0.166 Test Loss: 3.218 Test Acc: 0.166
Validation loss decreased (-0.164674 --> -0.165850).  Saving model ...
Epoch: 32 cost time: 0.9719448089599609
Epoch: 32, Steps: 10 | Train Loss: 1.583 Vali Loss: 3.214 Vali Acc: 0.167 Test Loss: 3.214 Test Acc: 0.167
Validation loss decreased (-0.165850 --> -0.167027).  Saving model ...
Epoch: 33 cost time: 1.2317585945129395
Epoch: 33, Steps: 10 | Train Loss: 1.502 Vali Loss: 3.226 Vali Acc: 0.172 Test Loss: 3.226 Test Acc: 0.172
Validation loss decreased (-0.167027 --> -0.171732).  Saving model ...
Epoch: 34 cost time: 0.9793920516967773
Epoch: 34, Steps: 10 | Train Loss: 1.373 Vali Loss: 3.225 Vali Acc: 0.171 Test Loss: 3.225 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.059739351272583
Epoch: 35, Steps: 10 | Train Loss: 1.382 Vali Loss: 3.241 Vali Acc: 0.178 Test Loss: 3.241 Test Acc: 0.178
Validation loss decreased (-0.171732 --> -0.177615).  Saving model ...
Epoch: 36 cost time: 0.958533763885498
Epoch: 36, Steps: 10 | Train Loss: 1.319 Vali Loss: 3.223 Vali Acc: 0.179 Test Loss: 3.223 Test Acc: 0.179
Validation loss decreased (-0.177615 --> -0.178791).  Saving model ...
Epoch: 37 cost time: 0.9699351787567139
Epoch: 37, Steps: 10 | Train Loss: 1.202 Vali Loss: 3.228 Vali Acc: 0.178 Test Loss: 3.228 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0176959037780762
Epoch: 38, Steps: 10 | Train Loss: 1.146 Vali Loss: 3.257 Vali Acc: 0.184 Test Loss: 3.257 Test Acc: 0.184
Validation loss decreased (-0.178791 --> -0.183497).  Saving model ...
Epoch: 39 cost time: 1.0249242782592773
Epoch: 39, Steps: 10 | Train Loss: 1.098 Vali Loss: 3.262 Vali Acc: 0.189 Test Loss: 3.262 Test Acc: 0.189
Validation loss decreased (-0.183497 --> -0.189379).  Saving model ...
Epoch: 40 cost time: 1.025007963180542
Epoch: 40, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.337 Vali Acc: 0.173 Test Loss: 3.337 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.020209789276123
Epoch: 41, Steps: 10 | Train Loss: 0.931 Vali Loss: 3.322 Vali Acc: 0.189 Test Loss: 3.322 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1270010471343994
Epoch: 42, Steps: 10 | Train Loss: 0.881 Vali Loss: 3.301 Vali Acc: 0.187 Test Loss: 3.301 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.08162522315979
Epoch: 43, Steps: 10 | Train Loss: 0.834 Vali Loss: 3.264 Vali Acc: 0.194 Test Loss: 3.264 Test Acc: 0.194
Validation loss decreased (-0.189379 --> -0.194085).  Saving model ...
Epoch: 44 cost time: 0.9602179527282715
Epoch: 44, Steps: 10 | Train Loss: 0.793 Vali Loss: 3.390 Vali Acc: 0.195 Test Loss: 3.390 Test Acc: 0.195
Validation loss decreased (-0.194085 --> -0.195260).  Saving model ...
Epoch: 45 cost time: 0.9823377132415771
Epoch: 45, Steps: 10 | Train Loss: 0.795 Vali Loss: 3.385 Vali Acc: 0.188 Test Loss: 3.385 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9934780597686768
Epoch: 46, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.312 Vali Acc: 0.214 Test Loss: 3.312 Test Acc: 0.214
Validation loss decreased (-0.195260 --> -0.214085).  Saving model ...
Epoch: 47 cost time: 1.1542103290557861
Epoch: 47, Steps: 10 | Train Loss: 0.661 Vali Loss: 3.369 Vali Acc: 0.202 Test Loss: 3.369 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.002624750137329
Epoch: 48, Steps: 10 | Train Loss: 0.613 Vali Loss: 3.340 Vali Acc: 0.205 Test Loss: 3.340 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9306519031524658
Epoch: 49, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.387 Vali Acc: 0.212 Test Loss: 3.387 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0677030086517334
Epoch: 50, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.473 Vali Acc: 0.209 Test Loss: 3.473 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.9492959976196289
Epoch: 51, Steps: 10 | Train Loss: 0.473 Vali Loss: 3.447 Vali Acc: 0.207 Test Loss: 3.447 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.0783438682556152
Epoch: 52, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.544 Vali Acc: 0.195 Test Loss: 3.544 Test Acc: 0.195
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.1474177837371826
Epoch: 53, Steps: 10 | Train Loss: 0.418 Vali Loss: 3.469 Vali Acc: 0.221 Test Loss: 3.469 Test Acc: 0.221
Validation loss decreased (-0.214085 --> -0.221142).  Saving model ...
Epoch: 54 cost time: 1.0135278701782227
Epoch: 54, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.502 Vali Acc: 0.209 Test Loss: 3.502 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1684865951538086
Epoch: 55, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.499 Vali Acc: 0.220 Test Loss: 3.499 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.9181351661682129
Epoch: 56, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.596 Vali Acc: 0.206 Test Loss: 3.596 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.3564388751983643
Epoch: 57, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.560 Vali Acc: 0.222 Test Loss: 3.560 Test Acc: 0.222
Validation loss decreased (-0.221142 --> -0.222317).  Saving model ...
Epoch: 58 cost time: 1.1157701015472412
Epoch: 58, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.519 Vali Acc: 0.222 Test Loss: 3.519 Test Acc: 0.222
Validation loss decreased (-0.222317 --> -0.222318).  Saving model ...
Epoch: 59 cost time: 0.9296395778656006
Epoch: 59, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.590 Vali Acc: 0.231 Test Loss: 3.590 Test Acc: 0.231
Validation loss decreased (-0.222318 --> -0.230552).  Saving model ...
Epoch: 60 cost time: 1.0854294300079346
Epoch: 60, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.591 Vali Acc: 0.229 Test Loss: 3.591 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.034717082977295
Epoch: 61, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.660 Vali Acc: 0.231 Test Loss: 3.660 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.128587007522583
Epoch: 62, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.571 Vali Acc: 0.231 Test Loss: 3.571 Test Acc: 0.231
Validation loss decreased (-0.230552 --> -0.230553).  Saving model ...
Epoch: 63 cost time: 0.8656005859375
Epoch: 63, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.645 Vali Acc: 0.233 Test Loss: 3.645 Test Acc: 0.233
Validation loss decreased (-0.230553 --> -0.232905).  Saving model ...
Epoch: 64 cost time: 1.266671895980835
Epoch: 64, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.666 Vali Acc: 0.242 Test Loss: 3.666 Test Acc: 0.242
Validation loss decreased (-0.232905 --> -0.242316).  Saving model ...
Epoch: 65 cost time: 0.9946928024291992
Epoch: 65, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.654 Vali Acc: 0.233 Test Loss: 3.654 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.1469345092773438
Epoch: 66, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.697 Vali Acc: 0.231 Test Loss: 3.697 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.311915636062622
Epoch: 67, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.718 Vali Acc: 0.234 Test Loss: 3.718 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.1072180271148682
Epoch: 68, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.734 Vali Acc: 0.240 Test Loss: 3.734 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.0443804264068604
Epoch: 69, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.773 Vali Acc: 0.238 Test Loss: 3.773 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.9409706592559814
Epoch: 70, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.759 Vali Acc: 0.238 Test Loss: 3.759 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.039823055267334
Epoch: 71, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.759 Vali Acc: 0.252 Test Loss: 3.759 Test Acc: 0.252
Validation loss decreased (-0.242316 --> -0.251727).  Saving model ...
Epoch: 72 cost time: 1.2180204391479492
Epoch: 72, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.891 Vali Acc: 0.232 Test Loss: 3.891 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.148881196975708
Epoch: 73, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.806 Vali Acc: 0.235 Test Loss: 3.806 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.1639704704284668
Epoch: 74, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.795 Vali Acc: 0.238 Test Loss: 3.795 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.0958456993103027
Epoch: 75, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.847 Vali Acc: 0.240 Test Loss: 3.847 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.1359639167785645
Epoch: 76, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.929 Vali Acc: 0.233 Test Loss: 3.929 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.035468339920044
Epoch: 77, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.876 Vali Acc: 0.248 Test Loss: 3.876 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.1163232326507568
Epoch: 78, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.900 Vali Acc: 0.244 Test Loss: 3.900 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 1.0089497566223145
Epoch: 79, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.922 Vali Acc: 0.238 Test Loss: 3.922 Test Acc: 0.238
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 1.1359410285949707
Epoch: 80, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.950 Vali Acc: 0.239 Test Loss: 3.950 Test Acc: 0.239
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 1.1784477233886719
Epoch: 81, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.971 Vali Acc: 0.241 Test Loss: 3.971 Test Acc: 0.241
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25176470588235295
model parameter : 195050
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3163182735443115
Epoch: 1, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.340 Vali Acc: 0.042 Test Loss: 3.340 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.1308350563049316
Epoch: 2, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.306 Vali Acc: 0.059 Test Loss: 3.306 Test Acc: 0.059
Validation loss decreased (-0.042320 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 1.1915428638458252
Epoch: 3, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.299 Vali Acc: 0.045 Test Loss: 3.299 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0894455909729004
Epoch: 4, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.313 Vali Acc: 0.055 Test Loss: 3.313 Test Acc: 0.055
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0686278343200684
Epoch: 5, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.340 Vali Acc: 0.062 Test Loss: 3.340 Test Acc: 0.062
Validation loss decreased (-0.058790 --> -0.062320).  Saving model ...
Epoch: 6 cost time: 0.9823586940765381
Epoch: 6, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.331 Vali Acc: 0.049 Test Loss: 3.331 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0253002643585205
Epoch: 7, Steps: 10 | Train Loss: 3.152 Vali Loss: 3.323 Vali Acc: 0.061 Test Loss: 3.323 Test Acc: 0.061
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9210200309753418
Epoch: 8, Steps: 10 | Train Loss: 3.074 Vali Loss: 3.323 Vali Acc: 0.055 Test Loss: 3.323 Test Acc: 0.055
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0455222129821777
Epoch: 9, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.310 Vali Acc: 0.061 Test Loss: 3.310 Test Acc: 0.061
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9509053230285645
Epoch: 10, Steps: 10 | Train Loss: 3.011 Vali Loss: 3.309 Vali Acc: 0.064 Test Loss: 3.309 Test Acc: 0.064
Validation loss decreased (-0.062320 --> -0.063496).  Saving model ...
Epoch: 11 cost time: 1.061223030090332
Epoch: 11, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.309 Vali Acc: 0.061 Test Loss: 3.309 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0430388450622559
Epoch: 12, Steps: 10 | Train Loss: 2.926 Vali Loss: 3.311 Vali Acc: 0.058 Test Loss: 3.311 Test Acc: 0.058
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9011013507843018
Epoch: 13, Steps: 10 | Train Loss: 2.921 Vali Loss: 3.308 Vali Acc: 0.066 Test Loss: 3.308 Test Acc: 0.066
Validation loss decreased (-0.063496 --> -0.065849).  Saving model ...
Epoch: 14 cost time: 1.0983142852783203
Epoch: 14, Steps: 10 | Train Loss: 2.862 Vali Loss: 3.295 Vali Acc: 0.066 Test Loss: 3.295 Test Acc: 0.066
Validation loss decreased (-0.065849 --> -0.065849).  Saving model ...
Epoch: 15 cost time: 1.0706913471221924
Epoch: 15, Steps: 10 | Train Loss: 2.810 Vali Loss: 3.284 Vali Acc: 0.075 Test Loss: 3.284 Test Acc: 0.075
Validation loss decreased (-0.065849 --> -0.075261).  Saving model ...
Epoch: 16 cost time: 1.114666223526001
Epoch: 16, Steps: 10 | Train Loss: 2.734 Vali Loss: 3.290 Vali Acc: 0.079 Test Loss: 3.290 Test Acc: 0.079
Validation loss decreased (-0.075261 --> -0.078791).  Saving model ...
Epoch: 17 cost time: 0.9615044593811035
Epoch: 17, Steps: 10 | Train Loss: 2.716 Vali Loss: 3.292 Vali Acc: 0.074 Test Loss: 3.292 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9892911911010742
Epoch: 18, Steps: 10 | Train Loss: 2.704 Vali Loss: 3.290 Vali Acc: 0.076 Test Loss: 3.290 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2414543628692627
Epoch: 19, Steps: 10 | Train Loss: 2.552 Vali Loss: 3.276 Vali Acc: 0.088 Test Loss: 3.276 Test Acc: 0.088
Validation loss decreased (-0.078791 --> -0.088203).  Saving model ...
Epoch: 20 cost time: 0.925532341003418
Epoch: 20, Steps: 10 | Train Loss: 2.512 Vali Loss: 3.274 Vali Acc: 0.093 Test Loss: 3.274 Test Acc: 0.093
Validation loss decreased (-0.088203 --> -0.092908).  Saving model ...
Epoch: 21 cost time: 1.0061774253845215
Epoch: 21, Steps: 10 | Train Loss: 2.405 Vali Loss: 3.272 Vali Acc: 0.093 Test Loss: 3.272 Test Acc: 0.093
Validation loss decreased (-0.092908 --> -0.092908).  Saving model ...
Epoch: 22 cost time: 1.1695795059204102
Epoch: 22, Steps: 10 | Train Loss: 2.376 Vali Loss: 3.286 Vali Acc: 0.101 Test Loss: 3.286 Test Acc: 0.101
Validation loss decreased (-0.092908 --> -0.101144).  Saving model ...
Epoch: 23 cost time: 0.9884090423583984
Epoch: 23, Steps: 10 | Train Loss: 2.271 Vali Loss: 3.283 Vali Acc: 0.111 Test Loss: 3.283 Test Acc: 0.111
Validation loss decreased (-0.101144 --> -0.110555).  Saving model ...
Epoch: 24 cost time: 0.9747457504272461
Epoch: 24, Steps: 10 | Train Loss: 2.159 Vali Loss: 3.285 Vali Acc: 0.105 Test Loss: 3.285 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9814236164093018
Epoch: 25, Steps: 10 | Train Loss: 2.083 Vali Loss: 3.284 Vali Acc: 0.112 Test Loss: 3.284 Test Acc: 0.112
Validation loss decreased (-0.110555 --> -0.111732).  Saving model ...
Epoch: 26 cost time: 1.1256132125854492
Epoch: 26, Steps: 10 | Train Loss: 2.072 Vali Loss: 3.305 Vali Acc: 0.102 Test Loss: 3.305 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9519221782684326
Epoch: 27, Steps: 10 | Train Loss: 1.979 Vali Loss: 3.313 Vali Acc: 0.116 Test Loss: 3.313 Test Acc: 0.116
Validation loss decreased (-0.111732 --> -0.116437).  Saving model ...
Epoch: 28 cost time: 0.9477088451385498
Epoch: 28, Steps: 10 | Train Loss: 1.874 Vali Loss: 3.301 Vali Acc: 0.116 Test Loss: 3.301 Test Acc: 0.116
Validation loss decreased (-0.116437 --> -0.116438).  Saving model ...
Epoch: 29 cost time: 0.9728643894195557
Epoch: 29, Steps: 10 | Train Loss: 1.839 Vali Loss: 3.310 Vali Acc: 0.122 Test Loss: 3.310 Test Acc: 0.122
Validation loss decreased (-0.116438 --> -0.122320).  Saving model ...
Epoch: 30 cost time: 1.0357880592346191
Epoch: 30, Steps: 10 | Train Loss: 1.769 Vali Loss: 3.319 Vali Acc: 0.134 Test Loss: 3.319 Test Acc: 0.134
Validation loss decreased (-0.122320 --> -0.134084).  Saving model ...
Epoch: 31 cost time: 1.0043840408325195
Epoch: 31, Steps: 10 | Train Loss: 1.711 Vali Loss: 3.317 Vali Acc: 0.142 Test Loss: 3.317 Test Acc: 0.142
Validation loss decreased (-0.134084 --> -0.142320).  Saving model ...
Epoch: 32 cost time: 0.9067883491516113
Epoch: 32, Steps: 10 | Train Loss: 1.588 Vali Loss: 3.325 Vali Acc: 0.139 Test Loss: 3.325 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0211985111236572
Epoch: 33, Steps: 10 | Train Loss: 1.508 Vali Loss: 3.356 Vali Acc: 0.145 Test Loss: 3.356 Test Acc: 0.145
Validation loss decreased (-0.142320 --> -0.144672).  Saving model ...
Epoch: 34 cost time: 0.9477145671844482
Epoch: 34, Steps: 10 | Train Loss: 1.451 Vali Loss: 3.354 Vali Acc: 0.149 Test Loss: 3.354 Test Acc: 0.149
Validation loss decreased (-0.144672 --> -0.149378).  Saving model ...
Epoch: 35 cost time: 1.0686085224151611
Epoch: 35, Steps: 10 | Train Loss: 1.435 Vali Loss: 3.387 Vali Acc: 0.155 Test Loss: 3.387 Test Acc: 0.155
Validation loss decreased (-0.149378 --> -0.155260).  Saving model ...
Epoch: 36 cost time: 1.0894718170166016
Epoch: 36, Steps: 10 | Train Loss: 1.359 Vali Loss: 3.360 Vali Acc: 0.152 Test Loss: 3.360 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0998005867004395
Epoch: 37, Steps: 10 | Train Loss: 1.317 Vali Loss: 3.396 Vali Acc: 0.168 Test Loss: 3.396 Test Acc: 0.168
Validation loss decreased (-0.155260 --> -0.168201).  Saving model ...
Epoch: 38 cost time: 1.0285825729370117
Epoch: 38, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.432 Vali Acc: 0.158 Test Loss: 3.432 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1213908195495605
Epoch: 39, Steps: 10 | Train Loss: 1.164 Vali Loss: 3.421 Vali Acc: 0.161 Test Loss: 3.421 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0032424926757812
Epoch: 40, Steps: 10 | Train Loss: 1.159 Vali Loss: 3.452 Vali Acc: 0.154 Test Loss: 3.452 Test Acc: 0.154
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0637056827545166
Epoch: 41, Steps: 10 | Train Loss: 1.013 Vali Loss: 3.450 Vali Acc: 0.166 Test Loss: 3.450 Test Acc: 0.166
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1121826171875
Epoch: 42, Steps: 10 | Train Loss: 0.993 Vali Loss: 3.466 Vali Acc: 0.171 Test Loss: 3.466 Test Acc: 0.171
Validation loss decreased (-0.168201 --> -0.170554).  Saving model ...
Epoch: 43 cost time: 1.0201704502105713
Epoch: 43, Steps: 10 | Train Loss: 0.886 Vali Loss: 3.480 Vali Acc: 0.161 Test Loss: 3.480 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1441547870635986
Epoch: 44, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.514 Vali Acc: 0.169 Test Loss: 3.514 Test Acc: 0.169
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1823928356170654
Epoch: 45, Steps: 10 | Train Loss: 0.820 Vali Loss: 3.549 Vali Acc: 0.155 Test Loss: 3.549 Test Acc: 0.155
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3406476974487305
Epoch: 46, Steps: 10 | Train Loss: 0.766 Vali Loss: 3.488 Vali Acc: 0.171 Test Loss: 3.488 Test Acc: 0.171
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.222283124923706
Epoch: 47, Steps: 10 | Train Loss: 0.700 Vali Loss: 3.553 Vali Acc: 0.175 Test Loss: 3.553 Test Acc: 0.175
Validation loss decreased (-0.170554 --> -0.175259).  Saving model ...
Epoch: 48 cost time: 1.2661235332489014
Epoch: 48, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.566 Vali Acc: 0.176 Test Loss: 3.566 Test Acc: 0.176
Validation loss decreased (-0.175259 --> -0.176435).  Saving model ...
Epoch: 49 cost time: 1.0912394523620605
Epoch: 49, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.636 Vali Acc: 0.151 Test Loss: 3.636 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.181100845336914
Epoch: 50, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.569 Vali Acc: 0.178 Test Loss: 3.569 Test Acc: 0.178
Validation loss decreased (-0.176435 --> -0.177611).  Saving model ...
Epoch: 51 cost time: 1.2400822639465332
Epoch: 51, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.614 Vali Acc: 0.180 Test Loss: 3.614 Test Acc: 0.180
Validation loss decreased (-0.177611 --> -0.179964).  Saving model ...
Epoch: 52 cost time: 1.1722936630249023
Epoch: 52, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.672 Vali Acc: 0.171 Test Loss: 3.672 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2222788333892822
Epoch: 53, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.670 Vali Acc: 0.187 Test Loss: 3.670 Test Acc: 0.187
Validation loss decreased (-0.179964 --> -0.187022).  Saving model ...
Epoch: 54 cost time: 1.14797043800354
Epoch: 54, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.684 Vali Acc: 0.180 Test Loss: 3.684 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.2488350868225098
Epoch: 55, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.720 Vali Acc: 0.184 Test Loss: 3.720 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.3093106746673584
Epoch: 56, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.726 Vali Acc: 0.191 Test Loss: 3.726 Test Acc: 0.191
Validation loss decreased (-0.187022 --> -0.190551).  Saving model ...
Epoch: 57 cost time: 1.109757423400879
Epoch: 57, Steps: 10 | Train Loss: 0.357 Vali Loss: 3.740 Vali Acc: 0.173 Test Loss: 3.740 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.067615270614624
Epoch: 58, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.808 Vali Acc: 0.179 Test Loss: 3.808 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0571370124816895
Epoch: 59, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.851 Vali Acc: 0.181 Test Loss: 3.851 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.1465415954589844
Epoch: 60, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.813 Vali Acc: 0.181 Test Loss: 3.813 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.1560194492340088
Epoch: 61, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.832 Vali Acc: 0.196 Test Loss: 3.832 Test Acc: 0.196
Validation loss decreased (-0.190551 --> -0.196432).  Saving model ...
Epoch: 62 cost time: 1.2290499210357666
Epoch: 62, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.904 Vali Acc: 0.194 Test Loss: 3.904 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.4362471103668213
Epoch: 63, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.885 Vali Acc: 0.194 Test Loss: 3.885 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.1870245933532715
Epoch: 64, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.898 Vali Acc: 0.199 Test Loss: 3.898 Test Acc: 0.199
Validation loss decreased (-0.196432 --> -0.198785).  Saving model ...
Epoch: 65 cost time: 1.3944284915924072
Epoch: 65, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.899 Vali Acc: 0.202 Test Loss: 3.899 Test Acc: 0.202
Validation loss decreased (-0.198785 --> -0.202314).  Saving model ...
Epoch: 66 cost time: 1.1599493026733398
Epoch: 66, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.960 Vali Acc: 0.192 Test Loss: 3.960 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0785555839538574
Epoch: 67, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.975 Vali Acc: 0.198 Test Loss: 3.975 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1947457790374756
Epoch: 68, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.982 Vali Acc: 0.199 Test Loss: 3.982 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.2450885772705078
Epoch: 69, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.011 Vali Acc: 0.199 Test Loss: 4.011 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.0416576862335205
Epoch: 70, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.033 Vali Acc: 0.194 Test Loss: 4.033 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.2740726470947266
Epoch: 71, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.069 Vali Acc: 0.202 Test Loss: 4.069 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.018017053604126
Epoch: 72, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.036 Vali Acc: 0.205 Test Loss: 4.036 Test Acc: 0.205
Validation loss decreased (-0.202314 --> -0.204666).  Saving model ...
Epoch: 73 cost time: 1.111114740371704
Epoch: 73, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.064 Vali Acc: 0.209 Test Loss: 4.064 Test Acc: 0.209
Validation loss decreased (-0.204666 --> -0.209371).  Saving model ...
Epoch: 74 cost time: 1.0995419025421143
Epoch: 74, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.120 Vali Acc: 0.194 Test Loss: 4.120 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.9598953723907471
Epoch: 75, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.144 Vali Acc: 0.198 Test Loss: 4.144 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.1616127490997314
Epoch: 76, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.130 Vali Acc: 0.201 Test Loss: 4.130 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.151263952255249
Epoch: 77, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.107 Vali Acc: 0.200 Test Loss: 4.107 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.5588839054107666
Epoch: 78, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.144 Vali Acc: 0.201 Test Loss: 4.144 Test Acc: 0.201
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.2622604370117188
Epoch: 79, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.106 Vali Acc: 0.215 Test Loss: 4.106 Test Acc: 0.215
Validation loss decreased (-0.209371 --> -0.215253).  Saving model ...
Epoch: 80 cost time: 1.258516550064087
Epoch: 80, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.137 Vali Acc: 0.204 Test Loss: 4.137 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.053636074066162
Epoch: 81, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.179 Vali Acc: 0.205 Test Loss: 4.179 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.0529260635375977
Epoch: 82, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.196 Vali Acc: 0.209 Test Loss: 4.196 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.0178186893463135
Epoch: 83, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.234 Vali Acc: 0.208 Test Loss: 4.234 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.9257006645202637
Epoch: 84, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.253 Vali Acc: 0.208 Test Loss: 4.253 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.1464207172393799
Epoch: 85, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.316 Vali Acc: 0.205 Test Loss: 4.316 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 1.0498552322387695
Epoch: 86, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.242 Vali Acc: 0.209 Test Loss: 4.242 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 1.0632243156433105
Epoch: 87, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.288 Vali Acc: 0.207 Test Loss: 4.288 Test Acc: 0.207
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 1.0577914714813232
Epoch: 88, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.236 Vali Acc: 0.220 Test Loss: 4.236 Test Acc: 0.220
Validation loss decreased (-0.215253 --> -0.219958).  Saving model ...
Epoch: 89 cost time: 1.0572681427001953
Epoch: 89, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.274 Vali Acc: 0.218 Test Loss: 4.274 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.1213018894195557
Epoch: 90, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.280 Vali Acc: 0.212 Test Loss: 4.280 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.9848134517669678
Epoch: 91, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.291 Vali Acc: 0.216 Test Loss: 4.291 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.9431676864624023
Epoch: 92, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.305 Vali Acc: 0.212 Test Loss: 4.305 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.110046148300171
Epoch: 93, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.345 Vali Acc: 0.211 Test Loss: 4.345 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 1.00288724899292
Epoch: 94, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.345 Vali Acc: 0.212 Test Loss: 4.345 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 1.0975911617279053
Epoch: 95, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.316 Vali Acc: 0.212 Test Loss: 4.316 Test Acc: 0.212
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 1.282714605331421
Epoch: 96, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.339 Vali Acc: 0.214 Test Loss: 4.339 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 1.0206334590911865
Epoch: 97, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.363 Vali Acc: 0.212 Test Loss: 4.363 Test Acc: 0.212
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 1.0913317203521729
Epoch: 98, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.357 Vali Acc: 0.219 Test Loss: 4.357 Test Acc: 0.219
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22
model parameter : 194282
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4336020946502686
Epoch: 1, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.306 Vali Acc: 0.045 Test Loss: 3.306 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.0959041118621826
Epoch: 2, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.297 Vali Acc: 0.051 Test Loss: 3.297 Test Acc: 0.051
Validation loss decreased (-0.044673 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.9010684490203857
Epoch: 3, Steps: 10 | Train Loss: 3.274 Vali Loss: 3.302 Vali Acc: 0.054 Test Loss: 3.302 Test Acc: 0.054
Validation loss decreased (-0.050555 --> -0.054085).  Saving model ...
Epoch: 4 cost time: 1.1213674545288086
Epoch: 4, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.310 Vali Acc: 0.053 Test Loss: 3.310 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0427851676940918
Epoch: 5, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.325 Vali Acc: 0.049 Test Loss: 3.325 Test Acc: 0.049
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9339888095855713
Epoch: 6, Steps: 10 | Train Loss: 3.184 Vali Loss: 3.324 Vali Acc: 0.054 Test Loss: 3.324 Test Acc: 0.054
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0798521041870117
Epoch: 7, Steps: 10 | Train Loss: 3.143 Vali Loss: 3.318 Vali Acc: 0.060 Test Loss: 3.318 Test Acc: 0.060
Validation loss decreased (-0.054085 --> -0.059967).  Saving model ...
Epoch: 8 cost time: 0.9976608753204346
Epoch: 8, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.320 Vali Acc: 0.068 Test Loss: 3.320 Test Acc: 0.068
Validation loss decreased (-0.059967 --> -0.068202).  Saving model ...
Epoch: 9 cost time: 1.017735242843628
Epoch: 9, Steps: 10 | Train Loss: 3.048 Vali Loss: 3.326 Vali Acc: 0.071 Test Loss: 3.326 Test Acc: 0.071
Validation loss decreased (-0.068202 --> -0.070555).  Saving model ...
Epoch: 10 cost time: 0.9985451698303223
Epoch: 10, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.313 Vali Acc: 0.069 Test Loss: 3.313 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0613858699798584
Epoch: 11, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.302 Vali Acc: 0.080 Test Loss: 3.302 Test Acc: 0.080
Validation loss decreased (-0.070555 --> -0.079967).  Saving model ...
Epoch: 12 cost time: 1.066150426864624
Epoch: 12, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.299 Vali Acc: 0.091 Test Loss: 3.299 Test Acc: 0.091
Validation loss decreased (-0.079967 --> -0.090555).  Saving model ...
Epoch: 13 cost time: 0.9399950504302979
Epoch: 13, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.287 Vali Acc: 0.082 Test Loss: 3.287 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2360408306121826
Epoch: 14, Steps: 10 | Train Loss: 2.879 Vali Loss: 3.279 Vali Acc: 0.096 Test Loss: 3.279 Test Acc: 0.096
Validation loss decreased (-0.090555 --> -0.096438).  Saving model ...
Epoch: 15 cost time: 1.1070237159729004
Epoch: 15, Steps: 10 | Train Loss: 2.775 Vali Loss: 3.297 Vali Acc: 0.089 Test Loss: 3.297 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0566191673278809
Epoch: 16, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.295 Vali Acc: 0.098 Test Loss: 3.295 Test Acc: 0.098
Validation loss decreased (-0.096438 --> -0.097614).  Saving model ...
Epoch: 17 cost time: 1.04219388961792
Epoch: 17, Steps: 10 | Train Loss: 2.611 Vali Loss: 3.262 Vali Acc: 0.107 Test Loss: 3.262 Test Acc: 0.107
Validation loss decreased (-0.097614 --> -0.107026).  Saving model ...
Epoch: 18 cost time: 1.0985417366027832
Epoch: 18, Steps: 10 | Train Loss: 2.561 Vali Loss: 3.262 Vali Acc: 0.102 Test Loss: 3.262 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0367305278778076
Epoch: 19, Steps: 10 | Train Loss: 2.487 Vali Loss: 3.246 Vali Acc: 0.115 Test Loss: 3.246 Test Acc: 0.115
Validation loss decreased (-0.107026 --> -0.115262).  Saving model ...
Epoch: 20 cost time: 1.0727927684783936
Epoch: 20, Steps: 10 | Train Loss: 2.436 Vali Loss: 3.262 Vali Acc: 0.116 Test Loss: 3.262 Test Acc: 0.116
Validation loss decreased (-0.115262 --> -0.116438).  Saving model ...
Epoch: 21 cost time: 1.050274133682251
Epoch: 21, Steps: 10 | Train Loss: 2.299 Vali Loss: 3.260 Vali Acc: 0.114 Test Loss: 3.260 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.990872859954834
Epoch: 22, Steps: 10 | Train Loss: 2.252 Vali Loss: 3.265 Vali Acc: 0.131 Test Loss: 3.265 Test Acc: 0.131
Validation loss decreased (-0.116438 --> -0.130556).  Saving model ...
Epoch: 23 cost time: 0.9916062355041504
Epoch: 23, Steps: 10 | Train Loss: 2.153 Vali Loss: 3.233 Vali Acc: 0.141 Test Loss: 3.233 Test Acc: 0.141
Validation loss decreased (-0.130556 --> -0.141144).  Saving model ...
Epoch: 24 cost time: 1.1168992519378662
Epoch: 24, Steps: 10 | Train Loss: 2.098 Vali Loss: 3.247 Vali Acc: 0.145 Test Loss: 3.247 Test Acc: 0.145
Validation loss decreased (-0.141144 --> -0.144673).  Saving model ...
Epoch: 25 cost time: 1.0408036708831787
Epoch: 25, Steps: 10 | Train Loss: 2.035 Vali Loss: 3.244 Vali Acc: 0.148 Test Loss: 3.244 Test Acc: 0.148
Validation loss decreased (-0.144673 --> -0.148203).  Saving model ...
Epoch: 26 cost time: 1.280825138092041
Epoch: 26, Steps: 10 | Train Loss: 1.968 Vali Loss: 3.252 Vali Acc: 0.146 Test Loss: 3.252 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2276499271392822
Epoch: 27, Steps: 10 | Train Loss: 1.937 Vali Loss: 3.242 Vali Acc: 0.166 Test Loss: 3.242 Test Acc: 0.166
Validation loss decreased (-0.148203 --> -0.165850).  Saving model ...
Epoch: 28 cost time: 1.190500020980835
Epoch: 28, Steps: 10 | Train Loss: 1.793 Vali Loss: 3.243 Vali Acc: 0.171 Test Loss: 3.243 Test Acc: 0.171
Validation loss decreased (-0.165850 --> -0.170556).  Saving model ...
Epoch: 29 cost time: 1.002734661102295
Epoch: 29, Steps: 10 | Train Loss: 1.762 Vali Loss: 3.259 Vali Acc: 0.165 Test Loss: 3.259 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.314985752105713
Epoch: 30, Steps: 10 | Train Loss: 1.631 Vali Loss: 3.223 Vali Acc: 0.180 Test Loss: 3.223 Test Acc: 0.180
Validation loss decreased (-0.170556 --> -0.179968).  Saving model ...
Epoch: 31 cost time: 1.0920710563659668
Epoch: 31, Steps: 10 | Train Loss: 1.559 Vali Loss: 3.227 Vali Acc: 0.180 Test Loss: 3.227 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1614198684692383
Epoch: 32, Steps: 10 | Train Loss: 1.508 Vali Loss: 3.268 Vali Acc: 0.175 Test Loss: 3.268 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1606671810150146
Epoch: 33, Steps: 10 | Train Loss: 1.449 Vali Loss: 3.255 Vali Acc: 0.180 Test Loss: 3.255 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0932364463806152
Epoch: 34, Steps: 10 | Train Loss: 1.368 Vali Loss: 3.263 Vali Acc: 0.185 Test Loss: 3.263 Test Acc: 0.185
Validation loss decreased (-0.179968 --> -0.184673).  Saving model ...
Epoch: 35 cost time: 1.1409351825714111
Epoch: 35, Steps: 10 | Train Loss: 1.317 Vali Loss: 3.278 Vali Acc: 0.192 Test Loss: 3.278 Test Acc: 0.192
Validation loss decreased (-0.184673 --> -0.191732).  Saving model ...
Epoch: 36 cost time: 1.0351753234863281
Epoch: 36, Steps: 10 | Train Loss: 1.185 Vali Loss: 3.295 Vali Acc: 0.195 Test Loss: 3.295 Test Acc: 0.195
Validation loss decreased (-0.191732 --> -0.195261).  Saving model ...
Epoch: 37 cost time: 1.0327069759368896
Epoch: 37, Steps: 10 | Train Loss: 1.137 Vali Loss: 3.271 Vali Acc: 0.200 Test Loss: 3.271 Test Acc: 0.200
Validation loss decreased (-0.195261 --> -0.199967).  Saving model ...
Epoch: 38 cost time: 0.8957667350769043
Epoch: 38, Steps: 10 | Train Loss: 1.114 Vali Loss: 3.282 Vali Acc: 0.194 Test Loss: 3.282 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0236620903015137
Epoch: 39, Steps: 10 | Train Loss: 1.036 Vali Loss: 3.313 Vali Acc: 0.191 Test Loss: 3.313 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1831097602844238
Epoch: 40, Steps: 10 | Train Loss: 1.002 Vali Loss: 3.261 Vali Acc: 0.215 Test Loss: 3.261 Test Acc: 0.215
Validation loss decreased (-0.199967 --> -0.215262).  Saving model ...
Epoch: 41 cost time: 1.179563283920288
Epoch: 41, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.297 Vali Acc: 0.218 Test Loss: 3.297 Test Acc: 0.218
Validation loss decreased (-0.215262 --> -0.217614).  Saving model ...
Epoch: 42 cost time: 1.188873291015625
Epoch: 42, Steps: 10 | Train Loss: 0.840 Vali Loss: 3.342 Vali Acc: 0.205 Test Loss: 3.342 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2209537029266357
Epoch: 43, Steps: 10 | Train Loss: 0.764 Vali Loss: 3.302 Vali Acc: 0.209 Test Loss: 3.302 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1770317554473877
Epoch: 44, Steps: 10 | Train Loss: 0.729 Vali Loss: 3.373 Vali Acc: 0.212 Test Loss: 3.373 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2471606731414795
Epoch: 45, Steps: 10 | Train Loss: 0.698 Vali Loss: 3.344 Vali Acc: 0.219 Test Loss: 3.344 Test Acc: 0.219
Validation loss decreased (-0.217614 --> -0.218790).  Saving model ...
Epoch: 46 cost time: 1.2824549674987793
Epoch: 46, Steps: 10 | Train Loss: 0.637 Vali Loss: 3.386 Vali Acc: 0.228 Test Loss: 3.386 Test Acc: 0.228
Validation loss decreased (-0.218790 --> -0.228201).  Saving model ...
Epoch: 47 cost time: 1.074859619140625
Epoch: 47, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.406 Vali Acc: 0.225 Test Loss: 3.406 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1112000942230225
Epoch: 48, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.442 Vali Acc: 0.229 Test Loss: 3.442 Test Acc: 0.229
Validation loss decreased (-0.228201 --> -0.229377).  Saving model ...
Epoch: 49 cost time: 1.2121169567108154
Epoch: 49, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.395 Vali Acc: 0.224 Test Loss: 3.395 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3027312755584717
Epoch: 50, Steps: 10 | Train Loss: 0.480 Vali Loss: 3.452 Vali Acc: 0.233 Test Loss: 3.452 Test Acc: 0.233
Validation loss decreased (-0.229377 --> -0.232907).  Saving model ...
Epoch: 51 cost time: 1.0534965991973877
Epoch: 51, Steps: 10 | Train Loss: 0.418 Vali Loss: 3.430 Vali Acc: 0.220 Test Loss: 3.430 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2207884788513184
Epoch: 52, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.494 Vali Acc: 0.234 Test Loss: 3.494 Test Acc: 0.234
Validation loss decreased (-0.232907 --> -0.234083).  Saving model ...
Epoch: 53 cost time: 1.2256803512573242
Epoch: 53, Steps: 10 | Train Loss: 0.367 Vali Loss: 3.549 Vali Acc: 0.221 Test Loss: 3.549 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1992230415344238
Epoch: 54, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.553 Vali Acc: 0.222 Test Loss: 3.553 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.3024380207061768
Epoch: 55, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.514 Vali Acc: 0.242 Test Loss: 3.514 Test Acc: 0.242
Validation loss decreased (-0.234083 --> -0.242318).  Saving model ...
Epoch: 56 cost time: 1.4189033508300781
Epoch: 56, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.616 Vali Acc: 0.236 Test Loss: 3.616 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1510047912597656
Epoch: 57, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.650 Vali Acc: 0.227 Test Loss: 3.650 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.3687734603881836
Epoch: 58, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.632 Vali Acc: 0.229 Test Loss: 3.632 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.2095270156860352
Epoch: 59, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.661 Vali Acc: 0.226 Test Loss: 3.661 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.0745346546173096
Epoch: 60, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.739 Vali Acc: 0.231 Test Loss: 3.739 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.1063013076782227
Epoch: 61, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.680 Vali Acc: 0.232 Test Loss: 3.680 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.097151517868042
Epoch: 62, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.744 Vali Acc: 0.238 Test Loss: 3.744 Test Acc: 0.238
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.124610185623169
Epoch: 63, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.777 Vali Acc: 0.233 Test Loss: 3.777 Test Acc: 0.233
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.0962650775909424
Epoch: 64, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.783 Vali Acc: 0.233 Test Loss: 3.783 Test Acc: 0.233
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.3099799156188965
Epoch: 65, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.844 Vali Acc: 0.225 Test Loss: 3.844 Test Acc: 0.225
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24235294117647058
model parameter : 193514
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2664196491241455
Epoch: 1, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.353 Vali Acc: 0.059 Test Loss: 3.353 Test Acc: 0.059
Validation loss decreased (inf --> -0.058790).  Saving model ...
Epoch: 2 cost time: 0.7796330451965332
Epoch: 2, Steps: 10 | Train Loss: 3.286 Vali Loss: 3.393 Vali Acc: 0.067 Test Loss: 3.393 Test Acc: 0.067
Validation loss decreased (-0.058790 --> -0.067025).  Saving model ...
Epoch: 3 cost time: 0.8381502628326416
Epoch: 3, Steps: 10 | Train Loss: 3.080 Vali Loss: 3.352 Vali Acc: 0.080 Test Loss: 3.352 Test Acc: 0.080
Validation loss decreased (-0.067025 --> -0.079966).  Saving model ...
Epoch: 4 cost time: 1.0075559616088867
Epoch: 4, Steps: 10 | Train Loss: 2.919 Vali Loss: 3.283 Vali Acc: 0.109 Test Loss: 3.283 Test Acc: 0.109
Validation loss decreased (-0.079966 --> -0.109379).  Saving model ...
Epoch: 5 cost time: 0.9025404453277588
Epoch: 5, Steps: 10 | Train Loss: 2.668 Vali Loss: 3.262 Vali Acc: 0.105 Test Loss: 3.262 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8387045860290527
Epoch: 6, Steps: 10 | Train Loss: 2.355 Vali Loss: 3.324 Vali Acc: 0.133 Test Loss: 3.324 Test Acc: 0.133
Validation loss decreased (-0.109379 --> -0.132908).  Saving model ...
Epoch: 7 cost time: 0.9827921390533447
Epoch: 7, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.324 Vali Acc: 0.173 Test Loss: 3.324 Test Acc: 0.173
Validation loss decreased (-0.132908 --> -0.172908).  Saving model ...
Epoch: 8 cost time: 0.9580385684967041
Epoch: 8, Steps: 10 | Train Loss: 1.746 Vali Loss: 3.333 Vali Acc: 0.161 Test Loss: 3.333 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9954745769500732
Epoch: 9, Steps: 10 | Train Loss: 1.526 Vali Loss: 3.387 Vali Acc: 0.181 Test Loss: 3.387 Test Acc: 0.181
Validation loss decreased (-0.172908 --> -0.181143).  Saving model ...
Epoch: 10 cost time: 0.9295046329498291
Epoch: 10, Steps: 10 | Train Loss: 1.249 Vali Loss: 3.508 Vali Acc: 0.179 Test Loss: 3.508 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8841509819030762
Epoch: 11, Steps: 10 | Train Loss: 0.983 Vali Loss: 3.578 Vali Acc: 0.186 Test Loss: 3.578 Test Acc: 0.186
Validation loss decreased (-0.181143 --> -0.185847).  Saving model ...
Epoch: 12 cost time: 0.9604172706604004
Epoch: 12, Steps: 10 | Train Loss: 0.927 Vali Loss: 3.721 Vali Acc: 0.198 Test Loss: 3.721 Test Acc: 0.198
Validation loss decreased (-0.185847 --> -0.197610).  Saving model ...
Epoch: 13 cost time: 0.8250837326049805
Epoch: 13, Steps: 10 | Train Loss: 0.702 Vali Loss: 3.811 Vali Acc: 0.189 Test Loss: 3.811 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9682824611663818
Epoch: 14, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.683 Vali Acc: 0.245 Test Loss: 3.683 Test Acc: 0.245
Validation loss decreased (-0.197610 --> -0.244669).  Saving model ...
Epoch: 15 cost time: 0.854881763458252
Epoch: 15, Steps: 10 | Train Loss: 0.257 Vali Loss: 4.148 Vali Acc: 0.212 Test Loss: 4.148 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9125826358795166
Epoch: 16, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.913 Vali Acc: 0.235 Test Loss: 3.913 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.838463544845581
Epoch: 17, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.419 Vali Acc: 0.200 Test Loss: 4.419 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9713149070739746
Epoch: 18, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.143 Vali Acc: 0.234 Test Loss: 4.143 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8534436225891113
Epoch: 19, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.309 Vali Acc: 0.248 Test Loss: 4.309 Test Acc: 0.248
Validation loss decreased (-0.244669 --> -0.248192).  Saving model ...
Epoch: 20 cost time: 0.8545675277709961
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.328 Vali Acc: 0.249 Test Loss: 4.328 Test Acc: 0.249
Validation loss decreased (-0.248192 --> -0.249368).  Saving model ...
Epoch: 21 cost time: 1.0401296615600586
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.472 Vali Acc: 0.242 Test Loss: 4.472 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9665255546569824
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.487 Vali Acc: 0.248 Test Loss: 4.487 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7773253917694092
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.473 Vali Acc: 0.260 Test Loss: 4.473 Test Acc: 0.260
Validation loss decreased (-0.249368 --> -0.259955).  Saving model ...
Epoch: 24 cost time: 0.8769776821136475
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.524 Vali Acc: 0.268 Test Loss: 4.524 Test Acc: 0.268
Validation loss decreased (-0.259955 --> -0.268190).  Saving model ...
Epoch: 25 cost time: 0.9581403732299805
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.626 Vali Acc: 0.259 Test Loss: 4.626 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9120993614196777
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.538 Vali Acc: 0.260 Test Loss: 4.538 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0272481441497803
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.535 Vali Acc: 0.268 Test Loss: 4.535 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9310460090637207
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.575 Vali Acc: 0.262 Test Loss: 4.575 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9954118728637695
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.582 Vali Acc: 0.262 Test Loss: 4.582 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.019653081893921
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.575 Vali Acc: 0.269 Test Loss: 4.575 Test Acc: 0.269
Validation loss decreased (-0.268190 --> -0.269366).  Saving model ...
Epoch: 31 cost time: 0.9166712760925293
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.580 Vali Acc: 0.269 Test Loss: 4.580 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.075188159942627
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.601 Vali Acc: 0.267 Test Loss: 4.601 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.919389009475708
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.615 Vali Acc: 0.267 Test Loss: 4.615 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8901121616363525
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.630 Vali Acc: 0.273 Test Loss: 4.630 Test Acc: 0.273
Validation loss decreased (-0.269366 --> -0.272895).  Saving model ...
Epoch: 35 cost time: 0.9594631195068359
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.650 Vali Acc: 0.272 Test Loss: 4.650 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9286510944366455
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.652 Vali Acc: 0.272 Test Loss: 4.652 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8640773296356201
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.659 Vali Acc: 0.276 Test Loss: 4.659 Test Acc: 0.276
Validation loss decreased (-0.272895 --> -0.276424).  Saving model ...
Epoch: 38 cost time: 0.889737606048584
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.675 Vali Acc: 0.276 Test Loss: 4.675 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1194067001342773
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.681 Vali Acc: 0.276 Test Loss: 4.681 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9688665866851807
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.697 Vali Acc: 0.276 Test Loss: 4.697 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8501460552215576
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.692 Vali Acc: 0.279 Test Loss: 4.692 Test Acc: 0.279
Validation loss decreased (-0.276424 --> -0.278777).  Saving model ...
Epoch: 42 cost time: 1.0250871181488037
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.702 Vali Acc: 0.279 Test Loss: 4.702 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0389535427093506
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.735 Vali Acc: 0.278 Test Loss: 4.735 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9188218116760254
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.737 Vali Acc: 0.278 Test Loss: 4.737 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9357216358184814
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.737 Vali Acc: 0.278 Test Loss: 4.737 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0064764022827148
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.759 Vali Acc: 0.279 Test Loss: 4.759 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8506174087524414
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.770 Vali Acc: 0.280 Test Loss: 4.770 Test Acc: 0.280
Validation loss decreased (-0.278777 --> -0.279952).  Saving model ...
Epoch: 48 cost time: 1.0141923427581787
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.772 Vali Acc: 0.281 Test Loss: 4.772 Test Acc: 0.281
Validation loss decreased (-0.279952 --> -0.281129).  Saving model ...
Epoch: 49 cost time: 0.8867478370666504
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.786 Vali Acc: 0.281 Test Loss: 4.786 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9729363918304443
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.787 Vali Acc: 0.280 Test Loss: 4.787 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8692021369934082
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.798 Vali Acc: 0.281 Test Loss: 4.798 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.846320390701294
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.815 Vali Acc: 0.281 Test Loss: 4.815 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.9305434226989746
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.819 Vali Acc: 0.280 Test Loss: 4.819 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.8982038497924805
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.829 Vali Acc: 0.280 Test Loss: 4.829 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.9238207340240479
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.835 Vali Acc: 0.280 Test Loss: 4.835 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.8562169075012207
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.846 Vali Acc: 0.279 Test Loss: 4.846 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.8078057765960693
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.859 Vali Acc: 0.278 Test Loss: 4.859 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.8021371364593506
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.856 Vali Acc: 0.279 Test Loss: 4.856 Test Acc: 0.279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 8089662
model size : 35.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1879196166992188
Epoch: 1, Steps: 10 | Train Loss: 3.450 Vali Loss: 3.316 Vali Acc: 0.045 Test Loss: 3.316 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.9344274997711182
Epoch: 2, Steps: 10 | Train Loss: 3.298 Vali Loss: 3.507 Vali Acc: 0.047 Test Loss: 3.507 Test Acc: 0.047
Validation loss decreased (-0.044673 --> -0.047024).  Saving model ...
Epoch: 3 cost time: 1.0825486183166504
Epoch: 3, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.308 Vali Acc: 0.089 Test Loss: 3.308 Test Acc: 0.089
Validation loss decreased (-0.047024 --> -0.089379).  Saving model ...
Epoch: 4 cost time: 0.8558049201965332
Epoch: 4, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.283 Vali Acc: 0.091 Test Loss: 3.283 Test Acc: 0.091
Validation loss decreased (-0.089379 --> -0.090555).  Saving model ...
Epoch: 5 cost time: 0.9145596027374268
Epoch: 5, Steps: 10 | Train Loss: 2.641 Vali Loss: 3.244 Vali Acc: 0.111 Test Loss: 3.244 Test Acc: 0.111
Validation loss decreased (-0.090555 --> -0.110556).  Saving model ...
Epoch: 6 cost time: 0.9127662181854248
Epoch: 6, Steps: 10 | Train Loss: 2.319 Vali Loss: 3.236 Vali Acc: 0.148 Test Loss: 3.236 Test Acc: 0.148
Validation loss decreased (-0.110556 --> -0.148203).  Saving model ...
Epoch: 7 cost time: 0.9983878135681152
Epoch: 7, Steps: 10 | Train Loss: 2.025 Vali Loss: 3.304 Vali Acc: 0.148 Test Loss: 3.304 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.790581226348877
Epoch: 8, Steps: 10 | Train Loss: 1.697 Vali Loss: 3.323 Vali Acc: 0.161 Test Loss: 3.323 Test Acc: 0.161
Validation loss decreased (-0.148203 --> -0.161143).  Saving model ...
Epoch: 9 cost time: 0.7661588191986084
Epoch: 9, Steps: 10 | Train Loss: 1.540 Vali Loss: 3.381 Vali Acc: 0.186 Test Loss: 3.381 Test Acc: 0.186
Validation loss decreased (-0.161143 --> -0.185849).  Saving model ...
Epoch: 10 cost time: 0.837639570236206
Epoch: 10, Steps: 10 | Train Loss: 1.248 Vali Loss: 3.408 Vali Acc: 0.185 Test Loss: 3.408 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8669748306274414
Epoch: 11, Steps: 10 | Train Loss: 0.913 Vali Loss: 3.488 Vali Acc: 0.196 Test Loss: 3.488 Test Acc: 0.196
Validation loss decreased (-0.185849 --> -0.196436).  Saving model ...
Epoch: 12 cost time: 0.7679533958435059
Epoch: 12, Steps: 10 | Train Loss: 0.746 Vali Loss: 3.650 Vali Acc: 0.185 Test Loss: 3.650 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9375607967376709
Epoch: 13, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.757 Vali Acc: 0.201 Test Loss: 3.757 Test Acc: 0.201
Validation loss decreased (-0.196436 --> -0.201139).  Saving model ...
Epoch: 14 cost time: 0.8038375377655029
Epoch: 14, Steps: 10 | Train Loss: 0.526 Vali Loss: 3.776 Vali Acc: 0.194 Test Loss: 3.776 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8617672920227051
Epoch: 15, Steps: 10 | Train Loss: 0.286 Vali Loss: 4.000 Vali Acc: 0.202 Test Loss: 4.000 Test Acc: 0.202
Validation loss decreased (-0.201139 --> -0.202313).  Saving model ...
Epoch: 16 cost time: 0.8711886405944824
Epoch: 16, Steps: 10 | Train Loss: 0.233 Vali Loss: 4.057 Vali Acc: 0.209 Test Loss: 4.057 Test Acc: 0.209
Validation loss decreased (-0.202313 --> -0.209371).  Saving model ...
Epoch: 17 cost time: 0.9408905506134033
Epoch: 17, Steps: 10 | Train Loss: 0.147 Vali Loss: 4.120 Vali Acc: 0.219 Test Loss: 4.120 Test Acc: 0.219
Validation loss decreased (-0.209371 --> -0.218782).  Saving model ...
Epoch: 18 cost time: 1.0380949974060059
Epoch: 18, Steps: 10 | Train Loss: 0.123 Vali Loss: 4.191 Vali Acc: 0.240 Test Loss: 4.191 Test Acc: 0.240
Validation loss decreased (-0.218782 --> -0.239958).  Saving model ...
Epoch: 19 cost time: 0.8492522239685059
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.352 Vali Acc: 0.236 Test Loss: 4.352 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9685914516448975
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.520 Vali Acc: 0.238 Test Loss: 4.520 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7849047183990479
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.604 Vali Acc: 0.232 Test Loss: 4.604 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9017422199249268
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.578 Vali Acc: 0.222 Test Loss: 4.578 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8293120861053467
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.733 Vali Acc: 0.232 Test Loss: 4.733 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9229021072387695
Epoch: 24, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.840 Vali Acc: 0.211 Test Loss: 4.840 Test Acc: 0.211
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8671853542327881
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.641 Vali Acc: 0.229 Test Loss: 4.641 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9247057437896729
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.624 Vali Acc: 0.256 Test Loss: 4.624 Test Acc: 0.256
Validation loss decreased (-0.239958 --> -0.256424).  Saving model ...
Epoch: 27 cost time: 0.8806638717651367
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.702 Vali Acc: 0.248 Test Loss: 4.702 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8385612964630127
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.719 Vali Acc: 0.240 Test Loss: 4.719 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9081273078918457
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.720 Vali Acc: 0.260 Test Loss: 4.720 Test Acc: 0.260
Validation loss decreased (-0.256424 --> -0.259953).  Saving model ...
Epoch: 30 cost time: 0.8728847503662109
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.742 Vali Acc: 0.266 Test Loss: 4.742 Test Acc: 0.266
Validation loss decreased (-0.259953 --> -0.265835).  Saving model ...
Epoch: 31 cost time: 0.8906497955322266
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.750 Vali Acc: 0.267 Test Loss: 4.750 Test Acc: 0.267
Validation loss decreased (-0.265835 --> -0.267011).  Saving model ...
Epoch: 32 cost time: 0.8986563682556152
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.751 Vali Acc: 0.259 Test Loss: 4.751 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7909190654754639
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.763 Vali Acc: 0.261 Test Loss: 4.763 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8585491180419922
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.772 Vali Acc: 0.262 Test Loss: 4.772 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8628208637237549
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.778 Vali Acc: 0.260 Test Loss: 4.778 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.804426908493042
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.789 Vali Acc: 0.260 Test Loss: 4.789 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9494178295135498
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.801 Vali Acc: 0.264 Test Loss: 4.801 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7855143547058105
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.815 Vali Acc: 0.262 Test Loss: 4.815 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7957074642181396
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.821 Vali Acc: 0.261 Test Loss: 4.821 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8811068534851074
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.829 Vali Acc: 0.262 Test Loss: 4.829 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8619155883789062
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.836 Vali Acc: 0.264 Test Loss: 4.836 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 8084542
model size : 35.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.065021514892578
Epoch: 1, Steps: 10 | Train Loss: 3.359 Vali Loss: 3.326 Vali Acc: 0.040 Test Loss: 3.326 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.8998496532440186
Epoch: 2, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.431 Vali Acc: 0.061 Test Loss: 3.431 Test Acc: 0.061
Validation loss decreased (-0.039967 --> -0.061142).  Saving model ...
Epoch: 3 cost time: 0.9595317840576172
Epoch: 3, Steps: 10 | Train Loss: 3.143 Vali Loss: 3.335 Vali Acc: 0.092 Test Loss: 3.335 Test Acc: 0.092
Validation loss decreased (-0.061142 --> -0.091731).  Saving model ...
Epoch: 4 cost time: 1.092008352279663
Epoch: 4, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.243 Vali Acc: 0.109 Test Loss: 3.243 Test Acc: 0.109
Validation loss decreased (-0.091731 --> -0.109379).  Saving model ...
Epoch: 5 cost time: 0.8720474243164062
Epoch: 5, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.309 Vali Acc: 0.122 Test Loss: 3.309 Test Acc: 0.122
Validation loss decreased (-0.109379 --> -0.122320).  Saving model ...
Epoch: 6 cost time: 0.8751277923583984
Epoch: 6, Steps: 10 | Train Loss: 2.389 Vali Loss: 3.279 Vali Acc: 0.132 Test Loss: 3.279 Test Acc: 0.132
Validation loss decreased (-0.122320 --> -0.131732).  Saving model ...
Epoch: 7 cost time: 0.9047577381134033
Epoch: 7, Steps: 10 | Train Loss: 2.172 Vali Loss: 3.374 Vali Acc: 0.156 Test Loss: 3.374 Test Acc: 0.156
Validation loss decreased (-0.131732 --> -0.156437).  Saving model ...
Epoch: 8 cost time: 0.8542990684509277
Epoch: 8, Steps: 10 | Train Loss: 1.814 Vali Loss: 3.336 Vali Acc: 0.158 Test Loss: 3.336 Test Acc: 0.158
Validation loss decreased (-0.156437 --> -0.157614).  Saving model ...
Epoch: 9 cost time: 0.8530542850494385
Epoch: 9, Steps: 10 | Train Loss: 1.559 Vali Loss: 3.484 Vali Acc: 0.155 Test Loss: 3.484 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8632614612579346
Epoch: 10, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.376 Vali Acc: 0.191 Test Loss: 3.376 Test Acc: 0.191
Validation loss decreased (-0.157614 --> -0.190554).  Saving model ...
Epoch: 11 cost time: 0.8005826473236084
Epoch: 11, Steps: 10 | Train Loss: 1.049 Vali Loss: 3.435 Vali Acc: 0.214 Test Loss: 3.435 Test Acc: 0.214
Validation loss decreased (-0.190554 --> -0.214083).  Saving model ...
Epoch: 12 cost time: 0.9287588596343994
Epoch: 12, Steps: 10 | Train Loss: 0.853 Vali Loss: 3.628 Vali Acc: 0.206 Test Loss: 3.628 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9738874435424805
Epoch: 13, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.656 Vali Acc: 0.222 Test Loss: 3.656 Test Acc: 0.222
Validation loss decreased (-0.214083 --> -0.222316).  Saving model ...
Epoch: 14 cost time: 0.9809083938598633
Epoch: 14, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.755 Vali Acc: 0.205 Test Loss: 3.755 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0712807178497314
Epoch: 15, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.963 Vali Acc: 0.221 Test Loss: 3.963 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9556586742401123
Epoch: 16, Steps: 10 | Train Loss: 0.286 Vali Loss: 4.167 Vali Acc: 0.194 Test Loss: 4.167 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8664400577545166
Epoch: 17, Steps: 10 | Train Loss: 0.207 Vali Loss: 4.100 Vali Acc: 0.249 Test Loss: 4.100 Test Acc: 0.249
Validation loss decreased (-0.222316 --> -0.249371).  Saving model ...
Epoch: 18 cost time: 0.9359145164489746
Epoch: 18, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.179 Vali Acc: 0.213 Test Loss: 4.179 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0865709781646729
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.261 Vali Acc: 0.235 Test Loss: 4.261 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.998607873916626
Epoch: 20, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.469 Vali Acc: 0.225 Test Loss: 4.469 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9437961578369141
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.261 Vali Acc: 0.260 Test Loss: 4.261 Test Acc: 0.260
Validation loss decreased (-0.249371 --> -0.259957).  Saving model ...
Epoch: 22 cost time: 0.9480562210083008
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.395 Vali Acc: 0.247 Test Loss: 4.395 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1211788654327393
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.479 Vali Acc: 0.251 Test Loss: 4.479 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9177877902984619
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.329 Vali Acc: 0.252 Test Loss: 4.329 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0435657501220703
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.377 Vali Acc: 0.273 Test Loss: 4.377 Test Acc: 0.273
Validation loss decreased (-0.259957 --> -0.272897).  Saving model ...
Epoch: 26 cost time: 1.065997838973999
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.467 Vali Acc: 0.271 Test Loss: 4.467 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0435214042663574
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.501 Vali Acc: 0.265 Test Loss: 4.501 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9090375900268555
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.484 Vali Acc: 0.273 Test Loss: 4.484 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9569039344787598
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.497 Vali Acc: 0.273 Test Loss: 4.497 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9722557067871094
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.504 Vali Acc: 0.272 Test Loss: 4.504 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8242697715759277
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.519 Vali Acc: 0.273 Test Loss: 4.519 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0501902103424072
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.527 Vali Acc: 0.274 Test Loss: 4.527 Test Acc: 0.274
Validation loss decreased (-0.272897 --> -0.274072).  Saving model ...
Epoch: 33 cost time: 0.9880757331848145
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.544 Vali Acc: 0.275 Test Loss: 4.544 Test Acc: 0.275
Validation loss decreased (-0.274072 --> -0.275249).  Saving model ...
Epoch: 34 cost time: 0.9797384738922119
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.560 Vali Acc: 0.276 Test Loss: 4.560 Test Acc: 0.276
Validation loss decreased (-0.275249 --> -0.276425).  Saving model ...
Epoch: 35 cost time: 1.030799388885498
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.568 Vali Acc: 0.272 Test Loss: 4.568 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2682030200958252
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.590 Vali Acc: 0.273 Test Loss: 4.590 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9758119583129883
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.616 Vali Acc: 0.280 Test Loss: 4.616 Test Acc: 0.280
Validation loss decreased (-0.276425 --> -0.279954).  Saving model ...
Epoch: 38 cost time: 0.9199275970458984
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.624 Vali Acc: 0.279 Test Loss: 4.624 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9239094257354736
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.631 Vali Acc: 0.280 Test Loss: 4.631 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1046802997589111
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.644 Vali Acc: 0.280 Test Loss: 4.644 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8407669067382812
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.649 Vali Acc: 0.278 Test Loss: 4.649 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9266912937164307
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.658 Vali Acc: 0.279 Test Loss: 4.658 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0022923946380615
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.670 Vali Acc: 0.276 Test Loss: 4.670 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.970806360244751
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.674 Vali Acc: 0.275 Test Loss: 4.674 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8954007625579834
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.676 Vali Acc: 0.276 Test Loss: 4.676 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.0556435585021973
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.691 Vali Acc: 0.273 Test Loss: 4.691 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9085373878479004
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.711 Vali Acc: 0.274 Test Loss: 4.711 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 8079422
model size : 35.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.202786445617676
Epoch: 1, Steps: 10 | Train Loss: 3.468 Vali Loss: 3.337 Vali Acc: 0.045 Test Loss: 3.337 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.0798864364624023
Epoch: 2, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.490 Vali Acc: 0.054 Test Loss: 3.490 Test Acc: 0.054
Validation loss decreased (-0.044673 --> -0.054083).  Saving model ...
Epoch: 3 cost time: 0.9708330631256104
Epoch: 3, Steps: 10 | Train Loss: 3.168 Vali Loss: 3.325 Vali Acc: 0.071 Test Loss: 3.325 Test Acc: 0.071
Validation loss decreased (-0.054083 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 0.901735782623291
Epoch: 4, Steps: 10 | Train Loss: 2.888 Vali Loss: 3.287 Vali Acc: 0.101 Test Loss: 3.287 Test Acc: 0.101
Validation loss decreased (-0.070555 --> -0.101144).  Saving model ...
Epoch: 5 cost time: 0.913189172744751
Epoch: 5, Steps: 10 | Train Loss: 2.640 Vali Loss: 3.332 Vali Acc: 0.112 Test Loss: 3.332 Test Acc: 0.112
Validation loss decreased (-0.101144 --> -0.111731).  Saving model ...
Epoch: 6 cost time: 0.9226727485656738
Epoch: 6, Steps: 10 | Train Loss: 2.374 Vali Loss: 3.278 Vali Acc: 0.153 Test Loss: 3.278 Test Acc: 0.153
Validation loss decreased (-0.111731 --> -0.152908).  Saving model ...
Epoch: 7 cost time: 0.9129118919372559
Epoch: 7, Steps: 10 | Train Loss: 2.147 Vali Loss: 3.341 Vali Acc: 0.155 Test Loss: 3.341 Test Acc: 0.155
Validation loss decreased (-0.152908 --> -0.155261).  Saving model ...
Epoch: 8 cost time: 0.962568998336792
Epoch: 8, Steps: 10 | Train Loss: 1.846 Vali Loss: 3.356 Vali Acc: 0.152 Test Loss: 3.356 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0625782012939453
Epoch: 9, Steps: 10 | Train Loss: 1.521 Vali Loss: 3.348 Vali Acc: 0.175 Test Loss: 3.348 Test Acc: 0.175
Validation loss decreased (-0.155261 --> -0.175261).  Saving model ...
Epoch: 10 cost time: 1.181450605392456
Epoch: 10, Steps: 10 | Train Loss: 1.264 Vali Loss: 3.462 Vali Acc: 0.194 Test Loss: 3.462 Test Acc: 0.194
Validation loss decreased (-0.175261 --> -0.194083).  Saving model ...
Epoch: 11 cost time: 0.8522148132324219
Epoch: 11, Steps: 10 | Train Loss: 0.995 Vali Loss: 3.458 Vali Acc: 0.205 Test Loss: 3.458 Test Acc: 0.205
Validation loss decreased (-0.194083 --> -0.204671).  Saving model ...
Epoch: 12 cost time: 0.9581799507141113
Epoch: 12, Steps: 10 | Train Loss: 0.864 Vali Loss: 3.588 Vali Acc: 0.207 Test Loss: 3.588 Test Acc: 0.207
Validation loss decreased (-0.204671 --> -0.207023).  Saving model ...
Epoch: 13 cost time: 0.8086600303649902
Epoch: 13, Steps: 10 | Train Loss: 0.572 Vali Loss: 3.730 Vali Acc: 0.202 Test Loss: 3.730 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8377621173858643
Epoch: 14, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.811 Vali Acc: 0.201 Test Loss: 3.811 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9098846912384033
Epoch: 15, Steps: 10 | Train Loss: 0.285 Vali Loss: 3.859 Vali Acc: 0.228 Test Loss: 3.859 Test Acc: 0.228
Validation loss decreased (-0.207023 --> -0.228197).  Saving model ...
Epoch: 16 cost time: 0.8081250190734863
Epoch: 16, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.929 Vali Acc: 0.246 Test Loss: 3.929 Test Acc: 0.246
Validation loss decreased (-0.228197 --> -0.245843).  Saving model ...
Epoch: 17 cost time: 0.8136947154998779
Epoch: 17, Steps: 10 | Train Loss: 0.150 Vali Loss: 4.210 Vali Acc: 0.213 Test Loss: 4.210 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8076956272125244
Epoch: 18, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.081 Vali Acc: 0.248 Test Loss: 4.081 Test Acc: 0.248
Validation loss decreased (-0.245843 --> -0.248194).  Saving model ...
Epoch: 19 cost time: 0.8995335102081299
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.676 Vali Acc: 0.226 Test Loss: 4.676 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9914627075195312
Epoch: 20, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.399 Vali Acc: 0.254 Test Loss: 4.399 Test Acc: 0.254
Validation loss decreased (-0.248194 --> -0.254074).  Saving model ...
Epoch: 21 cost time: 0.8893527984619141
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.617 Vali Acc: 0.236 Test Loss: 4.617 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8072483539581299
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.468 Vali Acc: 0.262 Test Loss: 4.468 Test Acc: 0.262
Validation loss decreased (-0.254074 --> -0.262308).  Saving model ...
Epoch: 23 cost time: 0.8939957618713379
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.503 Vali Acc: 0.260 Test Loss: 4.503 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0455069541931152
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.517 Vali Acc: 0.259 Test Loss: 4.517 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8396437168121338
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.509 Vali Acc: 0.267 Test Loss: 4.509 Test Acc: 0.267
Validation loss decreased (-0.262308 --> -0.267014).  Saving model ...
Epoch: 26 cost time: 0.8066141605377197
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.540 Vali Acc: 0.269 Test Loss: 4.540 Test Acc: 0.269
Validation loss decreased (-0.267014 --> -0.269366).  Saving model ...
Epoch: 27 cost time: 0.8904552459716797
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.592 Vali Acc: 0.266 Test Loss: 4.592 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9268803596496582
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.594 Vali Acc: 0.266 Test Loss: 4.594 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9074451923370361
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.596 Vali Acc: 0.268 Test Loss: 4.596 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8281834125518799
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.593 Vali Acc: 0.271 Test Loss: 4.593 Test Acc: 0.271
Validation loss decreased (-0.269366 --> -0.270542).  Saving model ...
Epoch: 31 cost time: 0.8905975818634033
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.613 Vali Acc: 0.274 Test Loss: 4.613 Test Acc: 0.274
Validation loss decreased (-0.270542 --> -0.274072).  Saving model ...
Epoch: 32 cost time: 0.9313161373138428
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.634 Vali Acc: 0.275 Test Loss: 4.634 Test Acc: 0.275
Validation loss decreased (-0.274072 --> -0.275248).  Saving model ...
Epoch: 33 cost time: 0.8594145774841309
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.645 Vali Acc: 0.278 Test Loss: 4.645 Test Acc: 0.278
Validation loss decreased (-0.275248 --> -0.277601).  Saving model ...
Epoch: 34 cost time: 0.9686894416809082
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.664 Vali Acc: 0.271 Test Loss: 4.664 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.820279598236084
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.664 Vali Acc: 0.274 Test Loss: 4.664 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8616790771484375
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.675 Vali Acc: 0.276 Test Loss: 4.675 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9842922687530518
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.681 Vali Acc: 0.278 Test Loss: 4.681 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9753730297088623
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.686 Vali Acc: 0.279 Test Loss: 4.686 Test Acc: 0.279
Validation loss decreased (-0.277601 --> -0.278777).  Saving model ...
Epoch: 39 cost time: 0.8512148857116699
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.697 Vali Acc: 0.280 Test Loss: 4.697 Test Acc: 0.280
Validation loss decreased (-0.278777 --> -0.279953).  Saving model ...
Epoch: 40 cost time: 0.9523561000823975
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.704 Vali Acc: 0.279 Test Loss: 4.704 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9166812896728516
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.713 Vali Acc: 0.276 Test Loss: 4.713 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8473312854766846
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.728 Vali Acc: 0.278 Test Loss: 4.728 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8696503639221191
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.742 Vali Acc: 0.279 Test Loss: 4.742 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1971991062164307
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.751 Vali Acc: 0.278 Test Loss: 4.751 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.987011194229126
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.758 Vali Acc: 0.278 Test Loss: 4.758 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.025827169418335
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.762 Vali Acc: 0.276 Test Loss: 4.762 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9283897876739502
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.775 Vali Acc: 0.278 Test Loss: 4.775 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0092508792877197
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.787 Vali Acc: 0.275 Test Loss: 4.787 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.0296454429626465
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.793 Vali Acc: 0.273 Test Loss: 4.793 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 8074302
model size : 35.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3620717525482178
Epoch: 1, Steps: 10 | Train Loss: 3.418 Vali Loss: 3.316 Vali Acc: 0.032 Test Loss: 3.316 Test Acc: 0.032
Validation loss decreased (inf --> -0.031732).  Saving model ...
Epoch: 2 cost time: 0.8582010269165039
Epoch: 2, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.468 Vali Acc: 0.051 Test Loss: 3.468 Test Acc: 0.051
Validation loss decreased (-0.031732 --> -0.050554).  Saving model ...
Epoch: 3 cost time: 0.9069032669067383
Epoch: 3, Steps: 10 | Train Loss: 3.124 Vali Loss: 3.318 Vali Acc: 0.081 Test Loss: 3.318 Test Acc: 0.081
Validation loss decreased (-0.050554 --> -0.081143).  Saving model ...
Epoch: 4 cost time: 0.8293583393096924
Epoch: 4, Steps: 10 | Train Loss: 2.832 Vali Loss: 3.255 Vali Acc: 0.098 Test Loss: 3.255 Test Acc: 0.098
Validation loss decreased (-0.081143 --> -0.097615).  Saving model ...
Epoch: 5 cost time: 0.9058675765991211
Epoch: 5, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.317 Vali Acc: 0.108 Test Loss: 3.317 Test Acc: 0.108
Validation loss decreased (-0.097615 --> -0.108202).  Saving model ...
Epoch: 6 cost time: 0.9050047397613525
Epoch: 6, Steps: 10 | Train Loss: 2.433 Vali Loss: 3.263 Vali Acc: 0.141 Test Loss: 3.263 Test Acc: 0.141
Validation loss decreased (-0.108202 --> -0.141144).  Saving model ...
Epoch: 7 cost time: 0.9111466407775879
Epoch: 7, Steps: 10 | Train Loss: 2.144 Vali Loss: 3.315 Vali Acc: 0.153 Test Loss: 3.315 Test Acc: 0.153
Validation loss decreased (-0.141144 --> -0.152908).  Saving model ...
Epoch: 8 cost time: 0.8835713863372803
Epoch: 8, Steps: 10 | Train Loss: 1.785 Vali Loss: 3.313 Vali Acc: 0.166 Test Loss: 3.313 Test Acc: 0.166
Validation loss decreased (-0.152908 --> -0.165849).  Saving model ...
Epoch: 9 cost time: 0.9786949157714844
Epoch: 9, Steps: 10 | Train Loss: 1.467 Vali Loss: 3.350 Vali Acc: 0.193 Test Loss: 3.350 Test Acc: 0.193
Validation loss decreased (-0.165849 --> -0.192908).  Saving model ...
Epoch: 10 cost time: 0.8867247104644775
Epoch: 10, Steps: 10 | Train Loss: 1.255 Vali Loss: 3.379 Vali Acc: 0.201 Test Loss: 3.379 Test Acc: 0.201
Validation loss decreased (-0.192908 --> -0.201143).  Saving model ...
Epoch: 11 cost time: 0.9456982612609863
Epoch: 11, Steps: 10 | Train Loss: 1.057 Vali Loss: 3.563 Vali Acc: 0.193 Test Loss: 3.563 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8990147113800049
Epoch: 12, Steps: 10 | Train Loss: 0.848 Vali Loss: 3.561 Vali Acc: 0.209 Test Loss: 3.561 Test Acc: 0.209
Validation loss decreased (-0.201143 --> -0.209376).  Saving model ...
Epoch: 13 cost time: 0.880579948425293
Epoch: 13, Steps: 10 | Train Loss: 0.633 Vali Loss: 3.712 Vali Acc: 0.213 Test Loss: 3.712 Test Acc: 0.213
Validation loss decreased (-0.209376 --> -0.212904).  Saving model ...
Epoch: 14 cost time: 0.8441588878631592
Epoch: 14, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.705 Vali Acc: 0.233 Test Loss: 3.705 Test Acc: 0.233
Validation loss decreased (-0.212904 --> -0.232904).  Saving model ...
Epoch: 15 cost time: 0.8098952770233154
Epoch: 15, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.852 Vali Acc: 0.231 Test Loss: 3.852 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7164425849914551
Epoch: 16, Steps: 10 | Train Loss: 0.189 Vali Loss: 4.076 Vali Acc: 0.224 Test Loss: 4.076 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8918955326080322
Epoch: 17, Steps: 10 | Train Loss: 0.140 Vali Loss: 4.210 Vali Acc: 0.238 Test Loss: 4.210 Test Acc: 0.238
Validation loss decreased (-0.232904 --> -0.237605).  Saving model ...
Epoch: 18 cost time: 0.7775018215179443
Epoch: 18, Steps: 10 | Train Loss: 0.139 Vali Loss: 4.391 Vali Acc: 0.228 Test Loss: 4.391 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8271088600158691
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.414 Vali Acc: 0.218 Test Loss: 4.414 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7294540405273438
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.587 Vali Acc: 0.228 Test Loss: 4.587 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9096500873565674
Epoch: 21, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.585 Vali Acc: 0.240 Test Loss: 4.585 Test Acc: 0.240
Validation loss decreased (-0.237605 --> -0.239954).  Saving model ...
Epoch: 22 cost time: 0.9468104839324951
Epoch: 22, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.756 Vali Acc: 0.227 Test Loss: 4.756 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.055189847946167
Epoch: 23, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.637 Vali Acc: 0.254 Test Loss: 4.637 Test Acc: 0.254
Validation loss decreased (-0.239954 --> -0.254071).  Saving model ...
Epoch: 24 cost time: 0.9303431510925293
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.727 Vali Acc: 0.251 Test Loss: 4.727 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9602055549621582
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.784 Vali Acc: 0.242 Test Loss: 4.784 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9649572372436523
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.887 Vali Acc: 0.255 Test Loss: 4.887 Test Acc: 0.255
Validation loss decreased (-0.254071 --> -0.255245).  Saving model ...
Epoch: 27 cost time: 1.0856778621673584
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.723 Vali Acc: 0.268 Test Loss: 4.723 Test Acc: 0.268
Validation loss decreased (-0.255245 --> -0.268188).  Saving model ...
Epoch: 28 cost time: 0.9459586143493652
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.757 Vali Acc: 0.268 Test Loss: 4.757 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9890687465667725
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.801 Vali Acc: 0.276 Test Loss: 4.801 Test Acc: 0.276
Validation loss decreased (-0.268188 --> -0.276423).  Saving model ...
Epoch: 30 cost time: 1.085517406463623
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.811 Vali Acc: 0.274 Test Loss: 4.811 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9243171215057373
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.824 Vali Acc: 0.276 Test Loss: 4.824 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9250979423522949
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.837 Vali Acc: 0.275 Test Loss: 4.837 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8940691947937012
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.837 Vali Acc: 0.271 Test Loss: 4.837 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0639734268188477
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.838 Vali Acc: 0.271 Test Loss: 4.838 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9138545989990234
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.843 Vali Acc: 0.271 Test Loss: 4.843 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0439372062683105
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.862 Vali Acc: 0.269 Test Loss: 4.862 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9764995574951172
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.880 Vali Acc: 0.269 Test Loss: 4.880 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0851993560791016
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.889 Vali Acc: 0.273 Test Loss: 4.889 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0940988063812256
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.898 Vali Acc: 0.271 Test Loss: 4.898 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 6776382
model size : 30.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5238454341888428
Epoch: 1, Steps: 10 | Train Loss: 3.457 Vali Loss: 3.305 Vali Acc: 0.056 Test Loss: 3.305 Test Acc: 0.056
Validation loss decreased (inf --> -0.056438).  Saving model ...
Epoch: 2 cost time: 0.9051268100738525
Epoch: 2, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.470 Vali Acc: 0.058 Test Loss: 3.470 Test Acc: 0.058
Validation loss decreased (-0.056438 --> -0.057612).  Saving model ...
Epoch: 3 cost time: 0.8202409744262695
Epoch: 3, Steps: 10 | Train Loss: 3.121 Vali Loss: 3.346 Vali Acc: 0.105 Test Loss: 3.346 Test Acc: 0.105
Validation loss decreased (-0.057612 --> -0.104672).  Saving model ...
Epoch: 4 cost time: 0.970818042755127
Epoch: 4, Steps: 10 | Train Loss: 3.031 Vali Loss: 3.283 Vali Acc: 0.115 Test Loss: 3.283 Test Acc: 0.115
Validation loss decreased (-0.104672 --> -0.115261).  Saving model ...
Epoch: 5 cost time: 0.9312701225280762
Epoch: 5, Steps: 10 | Train Loss: 2.704 Vali Loss: 3.257 Vali Acc: 0.102 Test Loss: 3.257 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9769911766052246
Epoch: 6, Steps: 10 | Train Loss: 2.466 Vali Loss: 3.294 Vali Acc: 0.104 Test Loss: 3.294 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0014309883117676
Epoch: 7, Steps: 10 | Train Loss: 2.306 Vali Loss: 3.278 Vali Acc: 0.139 Test Loss: 3.278 Test Acc: 0.139
Validation loss decreased (-0.115261 --> -0.138791).  Saving model ...
Epoch: 8 cost time: 0.9390554428100586
Epoch: 8, Steps: 10 | Train Loss: 1.997 Vali Loss: 3.312 Vali Acc: 0.154 Test Loss: 3.312 Test Acc: 0.154
Validation loss decreased (-0.138791 --> -0.154085).  Saving model ...
Epoch: 9 cost time: 1.0086181163787842
Epoch: 9, Steps: 10 | Train Loss: 1.735 Vali Loss: 3.391 Vali Acc: 0.184 Test Loss: 3.391 Test Acc: 0.184
Validation loss decreased (-0.154085 --> -0.183496).  Saving model ...
Epoch: 10 cost time: 0.9931457042694092
Epoch: 10, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.439 Vali Acc: 0.178 Test Loss: 3.439 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9100961685180664
Epoch: 11, Steps: 10 | Train Loss: 1.110 Vali Loss: 3.446 Vali Acc: 0.214 Test Loss: 3.446 Test Acc: 0.214
Validation loss decreased (-0.183496 --> -0.214083).  Saving model ...
Epoch: 12 cost time: 0.9335935115814209
Epoch: 12, Steps: 10 | Train Loss: 0.928 Vali Loss: 3.513 Vali Acc: 0.214 Test Loss: 3.513 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9210081100463867
Epoch: 13, Steps: 10 | Train Loss: 0.686 Vali Loss: 3.466 Vali Acc: 0.233 Test Loss: 3.466 Test Acc: 0.233
Validation loss decreased (-0.214083 --> -0.232907).  Saving model ...
Epoch: 14 cost time: 0.9501736164093018
Epoch: 14, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.777 Vali Acc: 0.207 Test Loss: 3.777 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9745614528656006
Epoch: 15, Steps: 10 | Train Loss: 0.337 Vali Loss: 4.028 Vali Acc: 0.205 Test Loss: 4.028 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9281506538391113
Epoch: 16, Steps: 10 | Train Loss: 0.306 Vali Loss: 4.037 Vali Acc: 0.201 Test Loss: 4.037 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9482791423797607
Epoch: 17, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.986 Vali Acc: 0.238 Test Loss: 3.986 Test Acc: 0.238
Validation loss decreased (-0.232907 --> -0.237607).  Saving model ...
Epoch: 18 cost time: 0.9348127841949463
Epoch: 18, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.194 Vali Acc: 0.231 Test Loss: 4.194 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9681339263916016
Epoch: 19, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.261 Vali Acc: 0.251 Test Loss: 4.261 Test Acc: 0.251
Validation loss decreased (-0.237607 --> -0.250546).  Saving model ...
Epoch: 20 cost time: 0.9592437744140625
Epoch: 20, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.390 Vali Acc: 0.241 Test Loss: 4.390 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9758796691894531
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.321 Vali Acc: 0.252 Test Loss: 4.321 Test Acc: 0.252
Validation loss decreased (-0.250546 --> -0.251721).  Saving model ...
Epoch: 22 cost time: 0.9042479991912842
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.485 Vali Acc: 0.259 Test Loss: 4.485 Test Acc: 0.259
Validation loss decreased (-0.251721 --> -0.258779).  Saving model ...
Epoch: 23 cost time: 1.098240852355957
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.512 Vali Acc: 0.239 Test Loss: 4.512 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0266931056976318
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.598 Vali Acc: 0.248 Test Loss: 4.598 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9140880107879639
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.558 Vali Acc: 0.266 Test Loss: 4.558 Test Acc: 0.266
Validation loss decreased (-0.258779 --> -0.265837).  Saving model ...
Epoch: 26 cost time: 1.0264158248901367
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.555 Vali Acc: 0.271 Test Loss: 4.555 Test Acc: 0.271
Validation loss decreased (-0.265837 --> -0.270543).  Saving model ...
Epoch: 27 cost time: 0.7898285388946533
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.528 Vali Acc: 0.279 Test Loss: 4.528 Test Acc: 0.279
Validation loss decreased (-0.270543 --> -0.278778).  Saving model ...
Epoch: 28 cost time: 0.8141701221466064
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.523 Vali Acc: 0.282 Test Loss: 4.523 Test Acc: 0.282
Validation loss decreased (-0.278778 --> -0.282308).  Saving model ...
Epoch: 29 cost time: 1.074141025543213
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.546 Vali Acc: 0.281 Test Loss: 4.546 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8501927852630615
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.573 Vali Acc: 0.281 Test Loss: 4.573 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7574844360351562
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.598 Vali Acc: 0.278 Test Loss: 4.598 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9631087779998779
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.624 Vali Acc: 0.281 Test Loss: 4.624 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8750531673431396
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.644 Vali Acc: 0.280 Test Loss: 4.644 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8414568901062012
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.643 Vali Acc: 0.280 Test Loss: 4.643 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9068825244903564
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.662 Vali Acc: 0.280 Test Loss: 4.662 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.2244248390197754
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.681 Vali Acc: 0.284 Test Loss: 4.681 Test Acc: 0.284
Validation loss decreased (-0.282308 --> -0.283483).  Saving model ...
Epoch: 37 cost time: 0.9060320854187012
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.687 Vali Acc: 0.286 Test Loss: 4.687 Test Acc: 0.286
Validation loss decreased (-0.283483 --> -0.285835).  Saving model ...
Epoch: 38 cost time: 0.9624357223510742
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.696 Vali Acc: 0.285 Test Loss: 4.696 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9387743473052979
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.712 Vali Acc: 0.280 Test Loss: 4.712 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9052145481109619
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.728 Vali Acc: 0.281 Test Loss: 4.728 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8667657375335693
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.738 Vali Acc: 0.280 Test Loss: 4.738 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0500991344451904
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.747 Vali Acc: 0.279 Test Loss: 4.747 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9283831119537354
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.760 Vali Acc: 0.285 Test Loss: 4.760 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.956139087677002
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.778 Vali Acc: 0.285 Test Loss: 4.778 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.2154273986816406
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.788 Vali Acc: 0.282 Test Loss: 4.788 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.012122631072998
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.797 Vali Acc: 0.284 Test Loss: 4.797 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8775687217712402
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.806 Vali Acc: 0.282 Test Loss: 4.806 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2858823529411765
model parameter : 6771262
model size : 30.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.36864972114563
Epoch: 1, Steps: 10 | Train Loss: 3.454 Vali Loss: 3.329 Vali Acc: 0.046 Test Loss: 3.329 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 1.017838954925537
Epoch: 2, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.467 Vali Acc: 0.038 Test Loss: 3.467 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9642884731292725
Epoch: 3, Steps: 10 | Train Loss: 3.060 Vali Loss: 3.342 Vali Acc: 0.075 Test Loss: 3.342 Test Acc: 0.075
Validation loss decreased (-0.045849 --> -0.075261).  Saving model ...
Epoch: 4 cost time: 0.8583831787109375
Epoch: 4, Steps: 10 | Train Loss: 2.906 Vali Loss: 3.275 Vali Acc: 0.102 Test Loss: 3.275 Test Acc: 0.102
Validation loss decreased (-0.075261 --> -0.102320).  Saving model ...
Epoch: 5 cost time: 0.8656637668609619
Epoch: 5, Steps: 10 | Train Loss: 2.676 Vali Loss: 3.281 Vali Acc: 0.127 Test Loss: 3.281 Test Acc: 0.127
Validation loss decreased (-0.102320 --> -0.127026).  Saving model ...
Epoch: 6 cost time: 0.8128058910369873
Epoch: 6, Steps: 10 | Train Loss: 2.481 Vali Loss: 3.304 Vali Acc: 0.126 Test Loss: 3.304 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0774996280670166
Epoch: 7, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.269 Vali Acc: 0.140 Test Loss: 3.269 Test Acc: 0.140
Validation loss decreased (-0.127026 --> -0.139967).  Saving model ...
Epoch: 8 cost time: 0.8028945922851562
Epoch: 8, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.340 Vali Acc: 0.167 Test Loss: 3.340 Test Acc: 0.167
Validation loss decreased (-0.139967 --> -0.167025).  Saving model ...
Epoch: 9 cost time: 0.9267096519470215
Epoch: 9, Steps: 10 | Train Loss: 1.598 Vali Loss: 3.346 Vali Acc: 0.193 Test Loss: 3.346 Test Acc: 0.193
Validation loss decreased (-0.167025 --> -0.192908).  Saving model ...
Epoch: 10 cost time: 0.8847169876098633
Epoch: 10, Steps: 10 | Train Loss: 1.343 Vali Loss: 3.503 Vali Acc: 0.191 Test Loss: 3.503 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8833520412445068
Epoch: 11, Steps: 10 | Train Loss: 1.050 Vali Loss: 3.475 Vali Acc: 0.191 Test Loss: 3.475 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9435324668884277
Epoch: 12, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.671 Vali Acc: 0.202 Test Loss: 3.671 Test Acc: 0.202
Validation loss decreased (-0.192908 --> -0.202316).  Saving model ...
Epoch: 13 cost time: 0.8675453662872314
Epoch: 13, Steps: 10 | Train Loss: 0.599 Vali Loss: 3.731 Vali Acc: 0.216 Test Loss: 3.731 Test Acc: 0.216
Validation loss decreased (-0.202316 --> -0.216433).  Saving model ...
Epoch: 14 cost time: 0.8374969959259033
Epoch: 14, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.744 Vali Acc: 0.218 Test Loss: 3.744 Test Acc: 0.218
Validation loss decreased (-0.216433 --> -0.217610).  Saving model ...
Epoch: 15 cost time: 1.0331766605377197
Epoch: 15, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.991 Vali Acc: 0.206 Test Loss: 3.991 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9155397415161133
Epoch: 16, Steps: 10 | Train Loss: 0.250 Vali Loss: 4.064 Vali Acc: 0.208 Test Loss: 4.064 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8667495250701904
Epoch: 17, Steps: 10 | Train Loss: 0.219 Vali Loss: 4.318 Vali Acc: 0.209 Test Loss: 4.318 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.014343500137329
Epoch: 18, Steps: 10 | Train Loss: 0.151 Vali Loss: 4.364 Vali Acc: 0.227 Test Loss: 4.364 Test Acc: 0.227
Validation loss decreased (-0.217610 --> -0.227015).  Saving model ...
Epoch: 19 cost time: 0.9350121021270752
Epoch: 19, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.303 Vali Acc: 0.244 Test Loss: 4.303 Test Acc: 0.244
Validation loss decreased (-0.227015 --> -0.243486).  Saving model ...
Epoch: 20 cost time: 0.9189178943634033
Epoch: 20, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.401 Vali Acc: 0.252 Test Loss: 4.401 Test Acc: 0.252
Validation loss decreased (-0.243486 --> -0.251721).  Saving model ...
Epoch: 21 cost time: 0.9772505760192871
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.459 Vali Acc: 0.247 Test Loss: 4.459 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8599486351013184
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.597 Vali Acc: 0.252 Test Loss: 4.597 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9200026988983154
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.622 Vali Acc: 0.248 Test Loss: 4.622 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1348021030426025
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.573 Vali Acc: 0.259 Test Loss: 4.573 Test Acc: 0.259
Validation loss decreased (-0.251721 --> -0.258778).  Saving model ...
Epoch: 25 cost time: 1.0975391864776611
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.576 Vali Acc: 0.258 Test Loss: 4.576 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8925168514251709
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.576 Vali Acc: 0.265 Test Loss: 4.576 Test Acc: 0.265
Validation loss decreased (-0.258778 --> -0.264660).  Saving model ...
Epoch: 27 cost time: 0.9473073482513428
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.628 Vali Acc: 0.262 Test Loss: 4.628 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1102871894836426
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.659 Vali Acc: 0.267 Test Loss: 4.659 Test Acc: 0.267
Validation loss decreased (-0.264660 --> -0.267012).  Saving model ...
Epoch: 29 cost time: 0.8892579078674316
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.667 Vali Acc: 0.268 Test Loss: 4.667 Test Acc: 0.268
Validation loss decreased (-0.267012 --> -0.268189).  Saving model ...
Epoch: 30 cost time: 0.9429090023040771
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.679 Vali Acc: 0.267 Test Loss: 4.679 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9676949977874756
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.687 Vali Acc: 0.266 Test Loss: 4.687 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8799560070037842
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.692 Vali Acc: 0.264 Test Loss: 4.692 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9448320865631104
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.715 Vali Acc: 0.265 Test Loss: 4.715 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8709266185760498
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.719 Vali Acc: 0.268 Test Loss: 4.719 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9186406135559082
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.742 Vali Acc: 0.266 Test Loss: 4.742 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.915224552154541
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.756 Vali Acc: 0.266 Test Loss: 4.756 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0104191303253174
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.768 Vali Acc: 0.266 Test Loss: 4.768 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9371719360351562
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.779 Vali Acc: 0.271 Test Loss: 4.779 Test Acc: 0.271
Validation loss decreased (-0.268189 --> -0.270540).  Saving model ...
Epoch: 39 cost time: 0.958064079284668
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.786 Vali Acc: 0.271 Test Loss: 4.786 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8742361068725586
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.799 Vali Acc: 0.266 Test Loss: 4.799 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9351029396057129
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.801 Vali Acc: 0.266 Test Loss: 4.801 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9647319316864014
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.808 Vali Acc: 0.268 Test Loss: 4.808 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.008310317993164
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.821 Vali Acc: 0.267 Test Loss: 4.821 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8730058670043945
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.842 Vali Acc: 0.266 Test Loss: 4.842 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8852031230926514
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.859 Vali Acc: 0.265 Test Loss: 4.859 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.9918015003204346
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.864 Vali Acc: 0.269 Test Loss: 4.864 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9350583553314209
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.877 Vali Acc: 0.266 Test Loss: 4.877 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9503977298736572
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.894 Vali Acc: 0.265 Test Loss: 4.894 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 6766142
model size : 30.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.134509325027466
Epoch: 1, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.313 Vali Acc: 0.042 Test Loss: 3.313 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.9615774154663086
Epoch: 2, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.437 Vali Acc: 0.054 Test Loss: 3.437 Test Acc: 0.054
Validation loss decreased (-0.042320 --> -0.054083).  Saving model ...
Epoch: 3 cost time: 0.8639106750488281
Epoch: 3, Steps: 10 | Train Loss: 3.107 Vali Loss: 3.311 Vali Acc: 0.060 Test Loss: 3.311 Test Acc: 0.060
Validation loss decreased (-0.054083 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.9273874759674072
Epoch: 4, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.270 Vali Acc: 0.094 Test Loss: 3.270 Test Acc: 0.094
Validation loss decreased (-0.059967 --> -0.094085).  Saving model ...
Epoch: 5 cost time: 0.9017071723937988
Epoch: 5, Steps: 10 | Train Loss: 2.696 Vali Loss: 3.261 Vali Acc: 0.113 Test Loss: 3.261 Test Acc: 0.113
Validation loss decreased (-0.094085 --> -0.112909).  Saving model ...
Epoch: 6 cost time: 1.0562398433685303
Epoch: 6, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.264 Vali Acc: 0.136 Test Loss: 3.264 Test Acc: 0.136
Validation loss decreased (-0.112909 --> -0.136438).  Saving model ...
Epoch: 7 cost time: 0.9031839370727539
Epoch: 7, Steps: 10 | Train Loss: 2.172 Vali Loss: 3.312 Vali Acc: 0.144 Test Loss: 3.312 Test Acc: 0.144
Validation loss decreased (-0.136438 --> -0.143496).  Saving model ...
Epoch: 8 cost time: 1.1205041408538818
Epoch: 8, Steps: 10 | Train Loss: 1.886 Vali Loss: 3.312 Vali Acc: 0.154 Test Loss: 3.312 Test Acc: 0.154
Validation loss decreased (-0.143496 --> -0.154085).  Saving model ...
Epoch: 9 cost time: 0.8985991477966309
Epoch: 9, Steps: 10 | Train Loss: 1.545 Vali Loss: 3.382 Vali Acc: 0.158 Test Loss: 3.382 Test Acc: 0.158
Validation loss decreased (-0.154085 --> -0.157613).  Saving model ...
Epoch: 10 cost time: 0.9754245281219482
Epoch: 10, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.391 Vali Acc: 0.189 Test Loss: 3.391 Test Acc: 0.189
Validation loss decreased (-0.157613 --> -0.189378).  Saving model ...
Epoch: 11 cost time: 1.0508551597595215
Epoch: 11, Steps: 10 | Train Loss: 1.069 Vali Loss: 3.610 Vali Acc: 0.180 Test Loss: 3.610 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.912686824798584
Epoch: 12, Steps: 10 | Train Loss: 0.872 Vali Loss: 3.559 Vali Acc: 0.185 Test Loss: 3.559 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8667116165161133
Epoch: 13, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.717 Vali Acc: 0.200 Test Loss: 3.717 Test Acc: 0.200
Validation loss decreased (-0.189378 --> -0.199963).  Saving model ...
Epoch: 14 cost time: 1.0049443244934082
Epoch: 14, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.853 Vali Acc: 0.191 Test Loss: 3.853 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8903632164001465
Epoch: 15, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.918 Vali Acc: 0.206 Test Loss: 3.918 Test Acc: 0.206
Validation loss decreased (-0.199963 --> -0.205843).  Saving model ...
Epoch: 16 cost time: 0.876617431640625
Epoch: 16, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.912 Vali Acc: 0.232 Test Loss: 3.912 Test Acc: 0.232
Validation loss decreased (-0.205843 --> -0.231726).  Saving model ...
Epoch: 17 cost time: 0.9817254543304443
Epoch: 17, Steps: 10 | Train Loss: 0.167 Vali Loss: 4.253 Vali Acc: 0.214 Test Loss: 4.253 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9234838485717773
Epoch: 18, Steps: 10 | Train Loss: 0.150 Vali Loss: 4.105 Vali Acc: 0.231 Test Loss: 4.105 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1186387538909912
Epoch: 19, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.490 Vali Acc: 0.236 Test Loss: 4.490 Test Acc: 0.236
Validation loss decreased (-0.231726 --> -0.236426).  Saving model ...
Epoch: 20 cost time: 0.9932465553283691
Epoch: 20, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.364 Vali Acc: 0.253 Test Loss: 4.364 Test Acc: 0.253
Validation loss decreased (-0.236426 --> -0.252898).  Saving model ...
Epoch: 21 cost time: 0.9068617820739746
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.859 Vali Acc: 0.211 Test Loss: 4.859 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8930258750915527
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.585 Vali Acc: 0.245 Test Loss: 4.585 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9240520000457764
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.711 Vali Acc: 0.229 Test Loss: 4.711 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9952030181884766
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.581 Vali Acc: 0.253 Test Loss: 4.581 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9751989841461182
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.687 Vali Acc: 0.241 Test Loss: 4.687 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8709509372711182
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.696 Vali Acc: 0.241 Test Loss: 4.696 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0391995906829834
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.637 Vali Acc: 0.254 Test Loss: 4.637 Test Acc: 0.254
Validation loss decreased (-0.252898 --> -0.254071).  Saving model ...
Epoch: 28 cost time: 1.0398764610290527
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.662 Vali Acc: 0.251 Test Loss: 4.662 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9886317253112793
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.665 Vali Acc: 0.253 Test Loss: 4.665 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9792895317077637
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.677 Vali Acc: 0.253 Test Loss: 4.677 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0398192405700684
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.697 Vali Acc: 0.249 Test Loss: 4.697 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8786914348602295
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.728 Vali Acc: 0.249 Test Loss: 4.728 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9541244506835938
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.752 Vali Acc: 0.253 Test Loss: 4.752 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8492844104766846
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.771 Vali Acc: 0.255 Test Loss: 4.771 Test Acc: 0.255
Validation loss decreased (-0.254071 --> -0.255246).  Saving model ...
Epoch: 35 cost time: 0.895092248916626
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.790 Vali Acc: 0.256 Test Loss: 4.790 Test Acc: 0.256
Validation loss decreased (-0.255246 --> -0.256423).  Saving model ...
Epoch: 36 cost time: 0.8999903202056885
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.797 Vali Acc: 0.249 Test Loss: 4.797 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9290368556976318
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.803 Vali Acc: 0.256 Test Loss: 4.803 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9110476970672607
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.805 Vali Acc: 0.255 Test Loss: 4.805 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9594876766204834
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.818 Vali Acc: 0.254 Test Loss: 4.818 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0214793682098389
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.841 Vali Acc: 0.256 Test Loss: 4.841 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1029131412506104
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.851 Vali Acc: 0.255 Test Loss: 4.851 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.949688196182251
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.857 Vali Acc: 0.254 Test Loss: 4.857 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9474532604217529
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.882 Vali Acc: 0.255 Test Loss: 4.882 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9631772041320801
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.888 Vali Acc: 0.254 Test Loss: 4.888 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9748482704162598
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.891 Vali Acc: 0.256 Test Loss: 4.891 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 6761022
model size : 30.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2254788875579834
Epoch: 1, Steps: 10 | Train Loss: 3.399 Vali Loss: 3.318 Vali Acc: 0.045 Test Loss: 3.318 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.9009201526641846
Epoch: 2, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.431 Vali Acc: 0.058 Test Loss: 3.431 Test Acc: 0.058
Validation loss decreased (-0.044673 --> -0.057613).  Saving model ...
Epoch: 3 cost time: 0.9467694759368896
Epoch: 3, Steps: 10 | Train Loss: 3.152 Vali Loss: 3.306 Vali Acc: 0.074 Test Loss: 3.306 Test Acc: 0.074
Validation loss decreased (-0.057613 --> -0.074085).  Saving model ...
Epoch: 4 cost time: 0.8016524314880371
Epoch: 4, Steps: 10 | Train Loss: 2.992 Vali Loss: 3.308 Vali Acc: 0.094 Test Loss: 3.308 Test Acc: 0.094
Validation loss decreased (-0.074085 --> -0.094085).  Saving model ...
Epoch: 5 cost time: 0.8545899391174316
Epoch: 5, Steps: 10 | Train Loss: 2.754 Vali Loss: 3.253 Vali Acc: 0.113 Test Loss: 3.253 Test Acc: 0.113
Validation loss decreased (-0.094085 --> -0.112909).  Saving model ...
Epoch: 6 cost time: 0.8656611442565918
Epoch: 6, Steps: 10 | Train Loss: 2.491 Vali Loss: 3.241 Vali Acc: 0.120 Test Loss: 3.241 Test Acc: 0.120
Validation loss decreased (-0.112909 --> -0.119968).  Saving model ...
Epoch: 7 cost time: 0.9314203262329102
Epoch: 7, Steps: 10 | Train Loss: 2.240 Vali Loss: 3.302 Vali Acc: 0.108 Test Loss: 3.302 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8854808807373047
Epoch: 8, Steps: 10 | Train Loss: 1.977 Vali Loss: 3.343 Vali Acc: 0.155 Test Loss: 3.343 Test Acc: 0.155
Validation loss decreased (-0.119968 --> -0.155261).  Saving model ...
Epoch: 9 cost time: 0.8479709625244141
Epoch: 9, Steps: 10 | Train Loss: 1.632 Vali Loss: 3.399 Vali Acc: 0.165 Test Loss: 3.399 Test Acc: 0.165
Validation loss decreased (-0.155261 --> -0.164672).  Saving model ...
Epoch: 10 cost time: 1.0349116325378418
Epoch: 10, Steps: 10 | Train Loss: 1.466 Vali Loss: 3.467 Vali Acc: 0.175 Test Loss: 3.467 Test Acc: 0.175
Validation loss decreased (-0.164672 --> -0.175259).  Saving model ...
Epoch: 11 cost time: 1.0139942169189453
Epoch: 11, Steps: 10 | Train Loss: 1.157 Vali Loss: 3.413 Vali Acc: 0.194 Test Loss: 3.413 Test Acc: 0.194
Validation loss decreased (-0.175259 --> -0.194084).  Saving model ...
Epoch: 12 cost time: 0.8311018943786621
Epoch: 12, Steps: 10 | Train Loss: 0.940 Vali Loss: 3.626 Vali Acc: 0.191 Test Loss: 3.626 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9425525665283203
Epoch: 13, Steps: 10 | Train Loss: 0.697 Vali Loss: 3.664 Vali Acc: 0.218 Test Loss: 3.664 Test Acc: 0.218
Validation loss decreased (-0.194084 --> -0.217610).  Saving model ...
Epoch: 14 cost time: 0.9942033290863037
Epoch: 14, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.901 Vali Acc: 0.204 Test Loss: 3.901 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9773526191711426
Epoch: 15, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.889 Vali Acc: 0.218 Test Loss: 3.889 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9821064472198486
Epoch: 16, Steps: 10 | Train Loss: 0.281 Vali Loss: 4.165 Vali Acc: 0.235 Test Loss: 4.165 Test Acc: 0.235
Validation loss decreased (-0.217610 --> -0.235252).  Saving model ...
Epoch: 17 cost time: 0.9079935550689697
Epoch: 17, Steps: 10 | Train Loss: 0.198 Vali Loss: 4.191 Vali Acc: 0.235 Test Loss: 4.191 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1404764652252197
Epoch: 18, Steps: 10 | Train Loss: 0.180 Vali Loss: 4.446 Vali Acc: 0.220 Test Loss: 4.446 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9935688972473145
Epoch: 19, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.289 Vali Acc: 0.265 Test Loss: 4.289 Test Acc: 0.265
Validation loss decreased (-0.235252 --> -0.264663).  Saving model ...
Epoch: 20 cost time: 0.8819572925567627
Epoch: 20, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.607 Vali Acc: 0.235 Test Loss: 4.607 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.856489896774292
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.610 Vali Acc: 0.254 Test Loss: 4.610 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8809406757354736
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.528 Vali Acc: 0.271 Test Loss: 4.528 Test Acc: 0.271
Validation loss decreased (-0.264663 --> -0.270543).  Saving model ...
Epoch: 23 cost time: 0.8398549556732178
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.702 Vali Acc: 0.280 Test Loss: 4.702 Test Acc: 0.280
Validation loss decreased (-0.270543 --> -0.279953).  Saving model ...
Epoch: 24 cost time: 0.8103280067443848
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.716 Vali Acc: 0.268 Test Loss: 4.716 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0814454555511475
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.700 Vali Acc: 0.274 Test Loss: 4.700 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9555325508117676
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.701 Vali Acc: 0.274 Test Loss: 4.701 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9145655632019043
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.708 Vali Acc: 0.276 Test Loss: 4.708 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.966909646987915
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.734 Vali Acc: 0.281 Test Loss: 4.734 Test Acc: 0.281
Validation loss decreased (-0.279953 --> -0.281129).  Saving model ...
Epoch: 29 cost time: 1.0510032176971436
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.747 Vali Acc: 0.267 Test Loss: 4.747 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0338788032531738
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.747 Vali Acc: 0.269 Test Loss: 4.747 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0996360778808594
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.766 Vali Acc: 0.272 Test Loss: 4.766 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.062443733215332
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.788 Vali Acc: 0.269 Test Loss: 4.788 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0063645839691162
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.796 Vali Acc: 0.274 Test Loss: 4.796 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.000570297241211
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.800 Vali Acc: 0.278 Test Loss: 4.800 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1001513004302979
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.814 Vali Acc: 0.279 Test Loss: 4.814 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.152942419052124
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.837 Vali Acc: 0.274 Test Loss: 4.837 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.193683385848999
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.852 Vali Acc: 0.273 Test Loss: 4.852 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9719533920288086
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.874 Vali Acc: 0.272 Test Loss: 4.874 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 6119742
model size : 28.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9419143199920654
Epoch: 1, Steps: 10 | Train Loss: 3.408 Vali Loss: 3.327 Vali Acc: 0.041 Test Loss: 3.327 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.9080250263214111
Epoch: 2, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.432 Vali Acc: 0.048 Test Loss: 3.432 Test Acc: 0.048
Validation loss decreased (-0.041143 --> -0.048201).  Saving model ...
Epoch: 3 cost time: 0.8672852516174316
Epoch: 3, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.332 Vali Acc: 0.066 Test Loss: 3.332 Test Acc: 0.066
Validation loss decreased (-0.048201 --> -0.065849).  Saving model ...
Epoch: 4 cost time: 0.889763593673706
Epoch: 4, Steps: 10 | Train Loss: 2.924 Vali Loss: 3.273 Vali Acc: 0.081 Test Loss: 3.273 Test Acc: 0.081
Validation loss decreased (-0.065849 --> -0.081144).  Saving model ...
Epoch: 5 cost time: 0.8789310455322266
Epoch: 5, Steps: 10 | Train Loss: 2.654 Vali Loss: 3.298 Vali Acc: 0.095 Test Loss: 3.298 Test Acc: 0.095
Validation loss decreased (-0.081144 --> -0.095261).  Saving model ...
Epoch: 6 cost time: 0.9672207832336426
Epoch: 6, Steps: 10 | Train Loss: 2.510 Vali Loss: 3.284 Vali Acc: 0.115 Test Loss: 3.284 Test Acc: 0.115
Validation loss decreased (-0.095261 --> -0.115261).  Saving model ...
Epoch: 7 cost time: 0.7683584690093994
Epoch: 7, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.351 Vali Acc: 0.138 Test Loss: 3.351 Test Acc: 0.138
Validation loss decreased (-0.115261 --> -0.137614).  Saving model ...
Epoch: 8 cost time: 0.9168879985809326
Epoch: 8, Steps: 10 | Train Loss: 1.851 Vali Loss: 3.266 Vali Acc: 0.146 Test Loss: 3.266 Test Acc: 0.146
Validation loss decreased (-0.137614 --> -0.145850).  Saving model ...
Epoch: 9 cost time: 0.8952970504760742
Epoch: 9, Steps: 10 | Train Loss: 1.639 Vali Loss: 3.433 Vali Acc: 0.156 Test Loss: 3.433 Test Acc: 0.156
Validation loss decreased (-0.145850 --> -0.156436).  Saving model ...
Epoch: 10 cost time: 0.9038667678833008
Epoch: 10, Steps: 10 | Train Loss: 1.307 Vali Loss: 3.383 Vali Acc: 0.188 Test Loss: 3.383 Test Acc: 0.188
Validation loss decreased (-0.156436 --> -0.188201).  Saving model ...
Epoch: 11 cost time: 0.9640276432037354
Epoch: 11, Steps: 10 | Train Loss: 1.156 Vali Loss: 3.567 Vali Acc: 0.181 Test Loss: 3.567 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8518283367156982
Epoch: 12, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.503 Vali Acc: 0.215 Test Loss: 3.503 Test Acc: 0.215
Validation loss decreased (-0.188201 --> -0.215259).  Saving model ...
Epoch: 13 cost time: 0.9967260360717773
Epoch: 13, Steps: 10 | Train Loss: 0.676 Vali Loss: 3.604 Vali Acc: 0.218 Test Loss: 3.604 Test Acc: 0.218
Validation loss decreased (-0.215259 --> -0.217611).  Saving model ...
Epoch: 14 cost time: 1.1563193798065186
Epoch: 14, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.722 Vali Acc: 0.231 Test Loss: 3.722 Test Acc: 0.231
Validation loss decreased (-0.217611 --> -0.230551).  Saving model ...
Epoch: 15 cost time: 0.9506993293762207
Epoch: 15, Steps: 10 | Train Loss: 0.411 Vali Loss: 3.913 Vali Acc: 0.209 Test Loss: 3.913 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9597105979919434
Epoch: 16, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.933 Vali Acc: 0.246 Test Loss: 3.933 Test Acc: 0.246
Validation loss decreased (-0.230551 --> -0.245843).  Saving model ...
Epoch: 17 cost time: 0.9277052879333496
Epoch: 17, Steps: 10 | Train Loss: 0.207 Vali Loss: 4.186 Vali Acc: 0.224 Test Loss: 4.186 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9456238746643066
Epoch: 18, Steps: 10 | Train Loss: 0.140 Vali Loss: 4.201 Vali Acc: 0.249 Test Loss: 4.201 Test Acc: 0.249
Validation loss decreased (-0.245843 --> -0.249370).  Saving model ...
Epoch: 19 cost time: 0.9172224998474121
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.263 Vali Acc: 0.260 Test Loss: 4.263 Test Acc: 0.260
Validation loss decreased (-0.249370 --> -0.259957).  Saving model ...
Epoch: 20 cost time: 0.8557004928588867
Epoch: 20, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.359 Vali Acc: 0.252 Test Loss: 4.359 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9252922534942627
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.366 Vali Acc: 0.267 Test Loss: 4.366 Test Acc: 0.267
Validation loss decreased (-0.259957 --> -0.267015).  Saving model ...
Epoch: 22 cost time: 0.9434340000152588
Epoch: 22, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.543 Vali Acc: 0.247 Test Loss: 4.543 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8386287689208984
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.382 Vali Acc: 0.272 Test Loss: 4.382 Test Acc: 0.272
Validation loss decreased (-0.267015 --> -0.271721).  Saving model ...
Epoch: 24 cost time: 0.8934118747711182
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.746 Vali Acc: 0.247 Test Loss: 4.746 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9906694889068604
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.587 Vali Acc: 0.252 Test Loss: 4.587 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8415429592132568
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.584 Vali Acc: 0.268 Test Loss: 4.584 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8514840602874756
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.670 Vali Acc: 0.280 Test Loss: 4.670 Test Acc: 0.280
Validation loss decreased (-0.271721 --> -0.279953).  Saving model ...
Epoch: 28 cost time: 0.8918225765228271
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.644 Vali Acc: 0.278 Test Loss: 4.644 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0086681842803955
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.629 Vali Acc: 0.274 Test Loss: 4.629 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9845585823059082
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.638 Vali Acc: 0.281 Test Loss: 4.638 Test Acc: 0.281
Validation loss decreased (-0.279953 --> -0.281130).  Saving model ...
Epoch: 31 cost time: 0.8495156764984131
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.648 Vali Acc: 0.281 Test Loss: 4.648 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0109426975250244
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.660 Vali Acc: 0.280 Test Loss: 4.660 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9938247203826904
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.665 Vali Acc: 0.293 Test Loss: 4.665 Test Acc: 0.293
Validation loss decreased (-0.281130 --> -0.292895).  Saving model ...
Epoch: 34 cost time: 0.8487279415130615
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.681 Vali Acc: 0.285 Test Loss: 4.681 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.029531717300415
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.689 Vali Acc: 0.286 Test Loss: 4.689 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0681674480438232
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.700 Vali Acc: 0.286 Test Loss: 4.700 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7878060340881348
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.715 Vali Acc: 0.286 Test Loss: 4.715 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9874653816223145
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.719 Vali Acc: 0.288 Test Loss: 4.719 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0229918956756592
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.730 Vali Acc: 0.287 Test Loss: 4.730 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1538043022155762
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.744 Vali Acc: 0.281 Test Loss: 4.744 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9654250144958496
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.746 Vali Acc: 0.286 Test Loss: 4.746 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9587869644165039
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.758 Vali Acc: 0.288 Test Loss: 4.758 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.8515968322753906
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.762 Vali Acc: 0.291 Test Loss: 4.762 Test Acc: 0.291
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29294117647058826
model parameter : 6114622
model size : 28.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3508899211883545
Epoch: 1, Steps: 10 | Train Loss: 3.402 Vali Loss: 3.371 Vali Acc: 0.044 Test Loss: 3.371 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.9946746826171875
Epoch: 2, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.465 Vali Acc: 0.031 Test Loss: 3.465 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8501253128051758
Epoch: 3, Steps: 10 | Train Loss: 3.144 Vali Loss: 3.359 Vali Acc: 0.082 Test Loss: 3.359 Test Acc: 0.082
Validation loss decreased (-0.043496 --> -0.082319).  Saving model ...
Epoch: 4 cost time: 0.9999644756317139
Epoch: 4, Steps: 10 | Train Loss: 2.994 Vali Loss: 3.306 Vali Acc: 0.100 Test Loss: 3.306 Test Acc: 0.100
Validation loss decreased (-0.082319 --> -0.099967).  Saving model ...
Epoch: 5 cost time: 0.8612594604492188
Epoch: 5, Steps: 10 | Train Loss: 2.744 Vali Loss: 3.354 Vali Acc: 0.116 Test Loss: 3.354 Test Acc: 0.116
Validation loss decreased (-0.099967 --> -0.116437).  Saving model ...
Epoch: 6 cost time: 0.9569172859191895
Epoch: 6, Steps: 10 | Train Loss: 2.475 Vali Loss: 3.330 Vali Acc: 0.135 Test Loss: 3.330 Test Acc: 0.135
Validation loss decreased (-0.116437 --> -0.135261).  Saving model ...
Epoch: 7 cost time: 0.9355123043060303
Epoch: 7, Steps: 10 | Train Loss: 2.298 Vali Loss: 3.295 Vali Acc: 0.136 Test Loss: 3.295 Test Acc: 0.136
Validation loss decreased (-0.135261 --> -0.136438).  Saving model ...
Epoch: 8 cost time: 0.9310743808746338
Epoch: 8, Steps: 10 | Train Loss: 2.057 Vali Loss: 3.361 Vali Acc: 0.142 Test Loss: 3.361 Test Acc: 0.142
Validation loss decreased (-0.136438 --> -0.142319).  Saving model ...
Epoch: 9 cost time: 0.9595239162445068
Epoch: 9, Steps: 10 | Train Loss: 1.686 Vali Loss: 3.433 Vali Acc: 0.159 Test Loss: 3.433 Test Acc: 0.159
Validation loss decreased (-0.142319 --> -0.158789).  Saving model ...
Epoch: 10 cost time: 0.8636898994445801
Epoch: 10, Steps: 10 | Train Loss: 1.392 Vali Loss: 3.434 Vali Acc: 0.171 Test Loss: 3.434 Test Acc: 0.171
Validation loss decreased (-0.158789 --> -0.170554).  Saving model ...
Epoch: 11 cost time: 0.893456220626831
Epoch: 11, Steps: 10 | Train Loss: 1.175 Vali Loss: 3.536 Vali Acc: 0.186 Test Loss: 3.536 Test Acc: 0.186
Validation loss decreased (-0.170554 --> -0.185847).  Saving model ...
Epoch: 12 cost time: 0.9237062931060791
Epoch: 12, Steps: 10 | Train Loss: 1.056 Vali Loss: 3.635 Vali Acc: 0.180 Test Loss: 3.635 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9410591125488281
Epoch: 13, Steps: 10 | Train Loss: 0.762 Vali Loss: 3.811 Vali Acc: 0.212 Test Loss: 3.811 Test Acc: 0.212
Validation loss decreased (-0.185847 --> -0.211727).  Saving model ...
Epoch: 14 cost time: 0.8893876075744629
Epoch: 14, Steps: 10 | Train Loss: 0.569 Vali Loss: 3.869 Vali Acc: 0.204 Test Loss: 3.869 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9550533294677734
Epoch: 15, Steps: 10 | Train Loss: 0.432 Vali Loss: 4.041 Vali Acc: 0.209 Test Loss: 4.041 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8744828701019287
Epoch: 16, Steps: 10 | Train Loss: 0.314 Vali Loss: 4.171 Vali Acc: 0.208 Test Loss: 4.171 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9398653507232666
Epoch: 17, Steps: 10 | Train Loss: 0.197 Vali Loss: 4.184 Vali Acc: 0.215 Test Loss: 4.184 Test Acc: 0.215
Validation loss decreased (-0.211727 --> -0.215252).  Saving model ...
Epoch: 18 cost time: 1.0710153579711914
Epoch: 18, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.350 Vali Acc: 0.255 Test Loss: 4.350 Test Acc: 0.255
Validation loss decreased (-0.215252 --> -0.255251).  Saving model ...
Epoch: 19 cost time: 0.9940176010131836
Epoch: 19, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.460 Vali Acc: 0.227 Test Loss: 4.460 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9050679206848145
Epoch: 20, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.395 Vali Acc: 0.247 Test Loss: 4.395 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.930140495300293
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.663 Vali Acc: 0.249 Test Loss: 4.663 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9302978515625
Epoch: 22, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.505 Vali Acc: 0.244 Test Loss: 4.505 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8000326156616211
Epoch: 23, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.588 Vali Acc: 0.255 Test Loss: 4.588 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8328101634979248
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.723 Vali Acc: 0.249 Test Loss: 4.723 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8736741542816162
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.638 Vali Acc: 0.259 Test Loss: 4.638 Test Acc: 0.259
Validation loss decreased (-0.255251 --> -0.258777).  Saving model ...
Epoch: 26 cost time: 0.938927173614502
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.679 Vali Acc: 0.259 Test Loss: 4.679 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8024015426635742
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.739 Vali Acc: 0.267 Test Loss: 4.739 Test Acc: 0.267
Validation loss decreased (-0.258777 --> -0.267011).  Saving model ...
Epoch: 28 cost time: 0.888277530670166
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.735 Vali Acc: 0.268 Test Loss: 4.735 Test Acc: 0.268
Validation loss decreased (-0.267011 --> -0.268188).  Saving model ...
Epoch: 29 cost time: 0.9333252906799316
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.711 Vali Acc: 0.269 Test Loss: 4.711 Test Acc: 0.269
Validation loss decreased (-0.268188 --> -0.269365).  Saving model ...
Epoch: 30 cost time: 1.0017955303192139
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.717 Vali Acc: 0.268 Test Loss: 4.717 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9303641319274902
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.747 Vali Acc: 0.268 Test Loss: 4.747 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9851717948913574
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.774 Vali Acc: 0.272 Test Loss: 4.774 Test Acc: 0.272
Validation loss decreased (-0.269365 --> -0.271717).  Saving model ...
Epoch: 33 cost time: 0.9124164581298828
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.800 Vali Acc: 0.268 Test Loss: 4.800 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8707120418548584
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.804 Vali Acc: 0.267 Test Loss: 4.804 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9323852062225342
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.811 Vali Acc: 0.269 Test Loss: 4.811 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.859487771987915
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.829 Vali Acc: 0.267 Test Loss: 4.829 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.003528118133545
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.850 Vali Acc: 0.266 Test Loss: 4.850 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8138773441314697
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.866 Vali Acc: 0.272 Test Loss: 4.866 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8692111968994141
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.871 Vali Acc: 0.273 Test Loss: 4.871 Test Acc: 0.273
Validation loss decreased (-0.271717 --> -0.272892).  Saving model ...
Epoch: 40 cost time: 0.9520144462585449
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.877 Vali Acc: 0.272 Test Loss: 4.877 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8288822174072266
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.890 Vali Acc: 0.271 Test Loss: 4.890 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8139405250549316
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.904 Vali Acc: 0.268 Test Loss: 4.904 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8914787769317627
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.918 Vali Acc: 0.268 Test Loss: 4.918 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8577158451080322
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.930 Vali Acc: 0.272 Test Loss: 4.930 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8738045692443848
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.939 Vali Acc: 0.272 Test Loss: 4.939 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7694652080535889
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.943 Vali Acc: 0.272 Test Loss: 4.943 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8855879306793213
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.956 Vali Acc: 0.271 Test Loss: 4.956 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0001211166381836
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.971 Vali Acc: 0.272 Test Loss: 4.971 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9441854953765869
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.979 Vali Acc: 0.273 Test Loss: 4.979 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 6109502
model size : 28.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5068860054016113
Epoch: 1, Steps: 10 | Train Loss: 3.470 Vali Loss: 3.330 Vali Acc: 0.048 Test Loss: 3.330 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.8939735889434814
Epoch: 2, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.469 Vali Acc: 0.039 Test Loss: 3.469 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9200212955474854
Epoch: 3, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.395 Vali Acc: 0.071 Test Loss: 3.395 Test Acc: 0.071
Validation loss decreased (-0.048202 --> -0.070554).  Saving model ...
Epoch: 4 cost time: 0.8512110710144043
Epoch: 4, Steps: 10 | Train Loss: 2.924 Vali Loss: 3.298 Vali Acc: 0.087 Test Loss: 3.298 Test Acc: 0.087
Validation loss decreased (-0.070554 --> -0.087026).  Saving model ...
Epoch: 5 cost time: 0.9973230361938477
Epoch: 5, Steps: 10 | Train Loss: 2.768 Vali Loss: 3.291 Vali Acc: 0.111 Test Loss: 3.291 Test Acc: 0.111
Validation loss decreased (-0.087026 --> -0.110555).  Saving model ...
Epoch: 6 cost time: 0.7676379680633545
Epoch: 6, Steps: 10 | Train Loss: 2.505 Vali Loss: 3.260 Vali Acc: 0.128 Test Loss: 3.260 Test Acc: 0.128
Validation loss decreased (-0.110555 --> -0.128203).  Saving model ...
Epoch: 7 cost time: 0.9022984504699707
Epoch: 7, Steps: 10 | Train Loss: 2.213 Vali Loss: 3.368 Vali Acc: 0.132 Test Loss: 3.368 Test Acc: 0.132
Validation loss decreased (-0.128203 --> -0.131731).  Saving model ...
Epoch: 8 cost time: 0.9029500484466553
Epoch: 8, Steps: 10 | Train Loss: 1.952 Vali Loss: 3.393 Vali Acc: 0.152 Test Loss: 3.393 Test Acc: 0.152
Validation loss decreased (-0.131731 --> -0.151731).  Saving model ...
Epoch: 9 cost time: 0.8682246208190918
Epoch: 9, Steps: 10 | Train Loss: 1.683 Vali Loss: 3.389 Vali Acc: 0.149 Test Loss: 3.389 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8107235431671143
Epoch: 10, Steps: 10 | Train Loss: 1.414 Vali Loss: 3.476 Vali Acc: 0.180 Test Loss: 3.476 Test Acc: 0.180
Validation loss decreased (-0.151731 --> -0.179965).  Saving model ...
Epoch: 11 cost time: 0.8597285747528076
Epoch: 11, Steps: 10 | Train Loss: 1.236 Vali Loss: 3.537 Vali Acc: 0.172 Test Loss: 3.537 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9062037467956543
Epoch: 12, Steps: 10 | Train Loss: 0.963 Vali Loss: 3.651 Vali Acc: 0.188 Test Loss: 3.651 Test Acc: 0.188
Validation loss decreased (-0.179965 --> -0.188199).  Saving model ...
Epoch: 13 cost time: 0.8304901123046875
Epoch: 13, Steps: 10 | Train Loss: 0.718 Vali Loss: 3.612 Vali Acc: 0.213 Test Loss: 3.612 Test Acc: 0.213
Validation loss decreased (-0.188199 --> -0.212905).  Saving model ...
Epoch: 14 cost time: 0.8793621063232422
Epoch: 14, Steps: 10 | Train Loss: 0.628 Vali Loss: 3.847 Vali Acc: 0.226 Test Loss: 3.847 Test Acc: 0.226
Validation loss decreased (-0.212905 --> -0.225844).  Saving model ...
Epoch: 15 cost time: 0.8984081745147705
Epoch: 15, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.768 Vali Acc: 0.218 Test Loss: 3.768 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9061262607574463
Epoch: 16, Steps: 10 | Train Loss: 0.339 Vali Loss: 4.184 Vali Acc: 0.216 Test Loss: 4.184 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9965293407440186
Epoch: 17, Steps: 10 | Train Loss: 0.280 Vali Loss: 4.013 Vali Acc: 0.227 Test Loss: 4.013 Test Acc: 0.227
Validation loss decreased (-0.225844 --> -0.227019).  Saving model ...
Epoch: 18 cost time: 1.0248425006866455
Epoch: 18, Steps: 10 | Train Loss: 0.141 Vali Loss: 4.400 Vali Acc: 0.216 Test Loss: 4.400 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9288203716278076
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.354 Vali Acc: 0.244 Test Loss: 4.354 Test Acc: 0.244
Validation loss decreased (-0.227019 --> -0.243486).  Saving model ...
Epoch: 20 cost time: 0.9090433120727539
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.485 Vali Acc: 0.229 Test Loss: 4.485 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9152097702026367
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.445 Vali Acc: 0.258 Test Loss: 4.445 Test Acc: 0.258
Validation loss decreased (-0.243486 --> -0.257603).  Saving model ...
Epoch: 22 cost time: 0.893099308013916
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.462 Vali Acc: 0.255 Test Loss: 4.462 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9242908954620361
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.468 Vali Acc: 0.253 Test Loss: 4.468 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9358358383178711
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.564 Vali Acc: 0.254 Test Loss: 4.564 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8690104484558105
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.577 Vali Acc: 0.260 Test Loss: 4.577 Test Acc: 0.260
Validation loss decreased (-0.257603 --> -0.259954).  Saving model ...
Epoch: 26 cost time: 0.7430188655853271
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.588 Vali Acc: 0.259 Test Loss: 4.588 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9324245452880859
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.619 Vali Acc: 0.260 Test Loss: 4.619 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8569164276123047
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.627 Vali Acc: 0.264 Test Loss: 4.627 Test Acc: 0.264
Validation loss decreased (-0.259954 --> -0.263483).  Saving model ...
Epoch: 29 cost time: 0.8679652214050293
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.632 Vali Acc: 0.267 Test Loss: 4.632 Test Acc: 0.267
Validation loss decreased (-0.263483 --> -0.267013).  Saving model ...
Epoch: 30 cost time: 0.7566478252410889
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.640 Vali Acc: 0.266 Test Loss: 4.640 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8831171989440918
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.669 Vali Acc: 0.271 Test Loss: 4.669 Test Acc: 0.271
Validation loss decreased (-0.267013 --> -0.270542).  Saving model ...
Epoch: 32 cost time: 0.9030649662017822
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.692 Vali Acc: 0.268 Test Loss: 4.692 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7798819541931152
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.706 Vali Acc: 0.269 Test Loss: 4.706 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7998313903808594
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.725 Vali Acc: 0.268 Test Loss: 4.725 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9972944259643555
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.735 Vali Acc: 0.266 Test Loss: 4.735 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9357645511627197
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.749 Vali Acc: 0.268 Test Loss: 4.749 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7868895530700684
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.749 Vali Acc: 0.267 Test Loss: 4.749 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7758960723876953
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.754 Vali Acc: 0.267 Test Loss: 4.754 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9207541942596436
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.771 Vali Acc: 0.267 Test Loss: 4.771 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7636420726776123
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.798 Vali Acc: 0.266 Test Loss: 4.798 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9086184501647949
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.819 Vali Acc: 0.269 Test Loss: 4.819 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 6104382
model size : 28.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.517364025115967
Epoch: 1, Steps: 10 | Train Loss: 3.427 Vali Loss: 3.313 Vali Acc: 0.044 Test Loss: 3.313 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.8729043006896973
Epoch: 2, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.418 Vali Acc: 0.058 Test Loss: 3.418 Test Acc: 0.058
Validation loss decreased (-0.043496 --> -0.057613).  Saving model ...
Epoch: 3 cost time: 0.855243444442749
Epoch: 3, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.359 Vali Acc: 0.056 Test Loss: 3.359 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9244735240936279
Epoch: 4, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.244 Vali Acc: 0.114 Test Loss: 3.244 Test Acc: 0.114
Validation loss decreased (-0.057613 --> -0.114085).  Saving model ...
Epoch: 5 cost time: 0.8694226741790771
Epoch: 5, Steps: 10 | Train Loss: 2.748 Vali Loss: 3.213 Vali Acc: 0.114 Test Loss: 3.213 Test Acc: 0.114
Validation loss decreased (-0.114085 --> -0.114086).  Saving model ...
Epoch: 6 cost time: 0.8091614246368408
Epoch: 6, Steps: 10 | Train Loss: 2.596 Vali Loss: 3.226 Vali Acc: 0.141 Test Loss: 3.226 Test Acc: 0.141
Validation loss decreased (-0.114086 --> -0.141144).  Saving model ...
Epoch: 7 cost time: 0.9305284023284912
Epoch: 7, Steps: 10 | Train Loss: 2.304 Vali Loss: 3.279 Vali Acc: 0.128 Test Loss: 3.279 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9285857677459717
Epoch: 8, Steps: 10 | Train Loss: 1.988 Vali Loss: 3.264 Vali Acc: 0.147 Test Loss: 3.264 Test Acc: 0.147
Validation loss decreased (-0.141144 --> -0.147026).  Saving model ...
Epoch: 9 cost time: 0.834540605545044
Epoch: 9, Steps: 10 | Train Loss: 1.706 Vali Loss: 3.379 Vali Acc: 0.165 Test Loss: 3.379 Test Acc: 0.165
Validation loss decreased (-0.147026 --> -0.164672).  Saving model ...
Epoch: 10 cost time: 0.8427462577819824
Epoch: 10, Steps: 10 | Train Loss: 1.409 Vali Loss: 3.448 Vali Acc: 0.171 Test Loss: 3.448 Test Acc: 0.171
Validation loss decreased (-0.164672 --> -0.170554).  Saving model ...
Epoch: 11 cost time: 0.8277349472045898
Epoch: 11, Steps: 10 | Train Loss: 1.211 Vali Loss: 3.396 Vali Acc: 0.198 Test Loss: 3.396 Test Acc: 0.198
Validation loss decreased (-0.170554 --> -0.197613).  Saving model ...
Epoch: 12 cost time: 0.9230329990386963
Epoch: 12, Steps: 10 | Train Loss: 0.930 Vali Loss: 3.528 Vali Acc: 0.202 Test Loss: 3.528 Test Acc: 0.202
Validation loss decreased (-0.197613 --> -0.202318).  Saving model ...
Epoch: 13 cost time: 0.7936310768127441
Epoch: 13, Steps: 10 | Train Loss: 0.748 Vali Loss: 3.611 Vali Acc: 0.214 Test Loss: 3.611 Test Acc: 0.214
Validation loss decreased (-0.202318 --> -0.214082).  Saving model ...
Epoch: 14 cost time: 0.9508183002471924
Epoch: 14, Steps: 10 | Train Loss: 0.559 Vali Loss: 3.786 Vali Acc: 0.207 Test Loss: 3.786 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.976860761642456
Epoch: 15, Steps: 10 | Train Loss: 0.455 Vali Loss: 4.027 Vali Acc: 0.199 Test Loss: 4.027 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9209277629852295
Epoch: 16, Steps: 10 | Train Loss: 0.335 Vali Loss: 4.026 Vali Acc: 0.221 Test Loss: 4.026 Test Acc: 0.221
Validation loss decreased (-0.214082 --> -0.221136).  Saving model ...
Epoch: 17 cost time: 0.9274587631225586
Epoch: 17, Steps: 10 | Train Loss: 0.230 Vali Loss: 4.036 Vali Acc: 0.238 Test Loss: 4.036 Test Acc: 0.238
Validation loss decreased (-0.221136 --> -0.237607).  Saving model ...
Epoch: 18 cost time: 0.9781312942504883
Epoch: 18, Steps: 10 | Train Loss: 0.137 Vali Loss: 4.228 Vali Acc: 0.235 Test Loss: 4.228 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0230686664581299
Epoch: 19, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.311 Vali Acc: 0.235 Test Loss: 4.311 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8845417499542236
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.319 Vali Acc: 0.275 Test Loss: 4.319 Test Acc: 0.275
Validation loss decreased (-0.237607 --> -0.275251).  Saving model ...
Epoch: 21 cost time: 0.94785475730896
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.462 Vali Acc: 0.268 Test Loss: 4.462 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9309616088867188
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.439 Vali Acc: 0.273 Test Loss: 4.439 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0333812236785889
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.537 Vali Acc: 0.266 Test Loss: 4.537 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8772692680358887
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.563 Vali Acc: 0.265 Test Loss: 4.563 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.91998291015625
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.579 Vali Acc: 0.267 Test Loss: 4.579 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8811423778533936
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.579 Vali Acc: 0.271 Test Loss: 4.579 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9751615524291992
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.564 Vali Acc: 0.268 Test Loss: 4.564 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9836065769195557
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.599 Vali Acc: 0.271 Test Loss: 4.599 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9464645385742188
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.615 Vali Acc: 0.269 Test Loss: 4.615 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1464507579803467
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.637 Vali Acc: 0.271 Test Loss: 4.637 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 5791422
model size : 27.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.255061626434326
Epoch: 1, Steps: 10 | Train Loss: 3.430 Vali Loss: 3.325 Vali Acc: 0.048 Test Loss: 3.325 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 1.0050013065338135
Epoch: 2, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.419 Vali Acc: 0.048 Test Loss: 3.419 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7795367240905762
Epoch: 3, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.303 Vali Acc: 0.066 Test Loss: 3.303 Test Acc: 0.066
Validation loss decreased (-0.048202 --> -0.065849).  Saving model ...
Epoch: 4 cost time: 0.957256555557251
Epoch: 4, Steps: 10 | Train Loss: 2.933 Vali Loss: 3.302 Vali Acc: 0.093 Test Loss: 3.302 Test Acc: 0.093
Validation loss decreased (-0.065849 --> -0.092908).  Saving model ...
Epoch: 5 cost time: 0.827336311340332
Epoch: 5, Steps: 10 | Train Loss: 2.717 Vali Loss: 3.225 Vali Acc: 0.127 Test Loss: 3.225 Test Acc: 0.127
Validation loss decreased (-0.092908 --> -0.127027).  Saving model ...
Epoch: 6 cost time: 0.8693883419036865
Epoch: 6, Steps: 10 | Train Loss: 2.458 Vali Loss: 3.263 Vali Acc: 0.107 Test Loss: 3.263 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9122920036315918
Epoch: 7, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.261 Vali Acc: 0.153 Test Loss: 3.261 Test Acc: 0.153
Validation loss decreased (-0.127027 --> -0.152909).  Saving model ...
Epoch: 8 cost time: 1.1342995166778564
Epoch: 8, Steps: 10 | Train Loss: 1.956 Vali Loss: 3.346 Vali Acc: 0.149 Test Loss: 3.346 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8839724063873291
Epoch: 9, Steps: 10 | Train Loss: 1.711 Vali Loss: 3.328 Vali Acc: 0.186 Test Loss: 3.328 Test Acc: 0.186
Validation loss decreased (-0.152909 --> -0.185849).  Saving model ...
Epoch: 10 cost time: 0.8560130596160889
Epoch: 10, Steps: 10 | Train Loss: 1.473 Vali Loss: 3.399 Vali Acc: 0.204 Test Loss: 3.399 Test Acc: 0.204
Validation loss decreased (-0.185849 --> -0.203495).  Saving model ...
Epoch: 11 cost time: 0.8387501239776611
Epoch: 11, Steps: 10 | Train Loss: 1.273 Vali Loss: 3.421 Vali Acc: 0.218 Test Loss: 3.421 Test Acc: 0.218
Validation loss decreased (-0.203495 --> -0.217613).  Saving model ...
Epoch: 12 cost time: 0.830681562423706
Epoch: 12, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.506 Vali Acc: 0.220 Test Loss: 3.506 Test Acc: 0.220
Validation loss decreased (-0.217613 --> -0.219965).  Saving model ...
Epoch: 13 cost time: 0.8721027374267578
Epoch: 13, Steps: 10 | Train Loss: 0.699 Vali Loss: 3.604 Vali Acc: 0.233 Test Loss: 3.604 Test Acc: 0.233
Validation loss decreased (-0.219965 --> -0.232905).  Saving model ...
Epoch: 14 cost time: 0.8666656017303467
Epoch: 14, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.610 Vali Acc: 0.246 Test Loss: 3.610 Test Acc: 0.246
Validation loss decreased (-0.232905 --> -0.245846).  Saving model ...
Epoch: 15 cost time: 0.9783174991607666
Epoch: 15, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.989 Vali Acc: 0.224 Test Loss: 3.989 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9402420520782471
Epoch: 16, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.851 Vali Acc: 0.235 Test Loss: 3.851 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9045677185058594
Epoch: 17, Steps: 10 | Train Loss: 0.199 Vali Loss: 4.153 Vali Acc: 0.232 Test Loss: 4.153 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9177846908569336
Epoch: 18, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.341 Vali Acc: 0.228 Test Loss: 4.341 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8789591789245605
Epoch: 19, Steps: 10 | Train Loss: 0.112 Vali Loss: 4.494 Vali Acc: 0.211 Test Loss: 4.494 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0838901996612549
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.598 Vali Acc: 0.235 Test Loss: 4.598 Test Acc: 0.235
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9578254222869873
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.593 Vali Acc: 0.246 Test Loss: 4.593 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8191983699798584
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.607 Vali Acc: 0.251 Test Loss: 4.607 Test Acc: 0.251
Validation loss decreased (-0.245846 --> -0.250542).  Saving model ...
Epoch: 23 cost time: 0.8348934650421143
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.622 Vali Acc: 0.248 Test Loss: 4.622 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0260753631591797
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.617 Vali Acc: 0.262 Test Loss: 4.617 Test Acc: 0.262
Validation loss decreased (-0.250542 --> -0.262307).  Saving model ...
Epoch: 25 cost time: 0.9592385292053223
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.738 Vali Acc: 0.254 Test Loss: 4.738 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9089291095733643
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.682 Vali Acc: 0.254 Test Loss: 4.682 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8118090629577637
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.859 Vali Acc: 0.260 Test Loss: 4.859 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9376709461212158
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.793 Vali Acc: 0.262 Test Loss: 4.793 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8763735294342041
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.765 Vali Acc: 0.256 Test Loss: 4.765 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8067312240600586
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.808 Vali Acc: 0.266 Test Loss: 4.808 Test Acc: 0.266
Validation loss decreased (-0.262307 --> -0.265834).  Saving model ...
Epoch: 31 cost time: 0.8760099411010742
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.795 Vali Acc: 0.264 Test Loss: 4.795 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9284200668334961
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.803 Vali Acc: 0.267 Test Loss: 4.803 Test Acc: 0.267
Validation loss decreased (-0.265834 --> -0.267011).  Saving model ...
Epoch: 33 cost time: 0.9136013984680176
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.816 Vali Acc: 0.272 Test Loss: 4.816 Test Acc: 0.272
Validation loss decreased (-0.267011 --> -0.271717).  Saving model ...
Epoch: 34 cost time: 0.8441770076751709
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.846 Vali Acc: 0.268 Test Loss: 4.846 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8675501346588135
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.868 Vali Acc: 0.266 Test Loss: 4.868 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.998039960861206
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.881 Vali Acc: 0.267 Test Loss: 4.881 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9883368015289307
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.889 Vali Acc: 0.266 Test Loss: 4.889 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0693435668945312
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.901 Vali Acc: 0.267 Test Loss: 4.901 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9817585945129395
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.911 Vali Acc: 0.268 Test Loss: 4.911 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1666474342346191
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.934 Vali Acc: 0.262 Test Loss: 4.934 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.095348834991455
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.943 Vali Acc: 0.264 Test Loss: 4.943 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9541606903076172
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.954 Vali Acc: 0.261 Test Loss: 4.954 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0324809551239014
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.969 Vali Acc: 0.265 Test Loss: 4.969 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 5786302
model size : 27.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0805599689483643
Epoch: 1, Steps: 10 | Train Loss: 3.363 Vali Loss: 3.296 Vali Acc: 0.061 Test Loss: 3.296 Test Acc: 0.061
Validation loss decreased (inf --> -0.061144).  Saving model ...
Epoch: 2 cost time: 0.941260576248169
Epoch: 2, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.414 Vali Acc: 0.066 Test Loss: 3.414 Test Acc: 0.066
Validation loss decreased (-0.061144 --> -0.065848).  Saving model ...
Epoch: 3 cost time: 0.8044970035552979
Epoch: 3, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.337 Vali Acc: 0.071 Test Loss: 3.337 Test Acc: 0.071
Validation loss decreased (-0.065848 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 0.9728825092315674
Epoch: 4, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.264 Vali Acc: 0.091 Test Loss: 3.264 Test Acc: 0.091
Validation loss decreased (-0.070555 --> -0.090556).  Saving model ...
Epoch: 5 cost time: 0.9093265533447266
Epoch: 5, Steps: 10 | Train Loss: 2.828 Vali Loss: 3.306 Vali Acc: 0.087 Test Loss: 3.306 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2313973903656006
Epoch: 6, Steps: 10 | Train Loss: 2.527 Vali Loss: 3.267 Vali Acc: 0.121 Test Loss: 3.267 Test Acc: 0.121
Validation loss decreased (-0.090556 --> -0.121144).  Saving model ...
Epoch: 7 cost time: 0.8071308135986328
Epoch: 7, Steps: 10 | Train Loss: 2.227 Vali Loss: 3.306 Vali Acc: 0.129 Test Loss: 3.306 Test Acc: 0.129
Validation loss decreased (-0.121144 --> -0.129379).  Saving model ...
Epoch: 8 cost time: 0.8892784118652344
Epoch: 8, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.234 Vali Acc: 0.142 Test Loss: 3.234 Test Acc: 0.142
Validation loss decreased (-0.129379 --> -0.142321).  Saving model ...
Epoch: 9 cost time: 0.8884034156799316
Epoch: 9, Steps: 10 | Train Loss: 1.843 Vali Loss: 3.428 Vali Acc: 0.151 Test Loss: 3.428 Test Acc: 0.151
Validation loss decreased (-0.142321 --> -0.150554).  Saving model ...
Epoch: 10 cost time: 1.0178990364074707
Epoch: 10, Steps: 10 | Train Loss: 1.448 Vali Loss: 3.443 Vali Acc: 0.188 Test Loss: 3.443 Test Acc: 0.188
Validation loss decreased (-0.150554 --> -0.188201).  Saving model ...
Epoch: 11 cost time: 0.8470547199249268
Epoch: 11, Steps: 10 | Train Loss: 1.210 Vali Loss: 3.465 Vali Acc: 0.194 Test Loss: 3.465 Test Acc: 0.194
Validation loss decreased (-0.188201 --> -0.194083).  Saving model ...
Epoch: 12 cost time: 0.8554913997650146
Epoch: 12, Steps: 10 | Train Loss: 1.005 Vali Loss: 3.603 Vali Acc: 0.204 Test Loss: 3.603 Test Acc: 0.204
Validation loss decreased (-0.194083 --> -0.203493).  Saving model ...
Epoch: 13 cost time: 1.1018602848052979
Epoch: 13, Steps: 10 | Train Loss: 0.769 Vali Loss: 3.700 Vali Acc: 0.196 Test Loss: 3.700 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9238708019256592
Epoch: 14, Steps: 10 | Train Loss: 0.582 Vali Loss: 3.862 Vali Acc: 0.224 Test Loss: 3.862 Test Acc: 0.224
Validation loss decreased (-0.203493 --> -0.223491).  Saving model ...
Epoch: 15 cost time: 0.9790089130401611
Epoch: 15, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.819 Vali Acc: 0.211 Test Loss: 3.819 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8366668224334717
Epoch: 16, Steps: 10 | Train Loss: 0.261 Vali Loss: 4.103 Vali Acc: 0.220 Test Loss: 4.103 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9432320594787598
Epoch: 17, Steps: 10 | Train Loss: 0.161 Vali Loss: 4.254 Vali Acc: 0.227 Test Loss: 4.254 Test Acc: 0.227
Validation loss decreased (-0.223491 --> -0.227016).  Saving model ...
Epoch: 18 cost time: 0.87284255027771
Epoch: 18, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.428 Vali Acc: 0.232 Test Loss: 4.428 Test Acc: 0.232
Validation loss decreased (-0.227016 --> -0.231720).  Saving model ...
Epoch: 19 cost time: 0.8600192070007324
Epoch: 19, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.487 Vali Acc: 0.228 Test Loss: 4.487 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.942636251449585
Epoch: 20, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.566 Vali Acc: 0.233 Test Loss: 4.566 Test Acc: 0.233
Validation loss decreased (-0.231720 --> -0.232896).  Saving model ...
Epoch: 21 cost time: 0.8613440990447998
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.617 Vali Acc: 0.248 Test Loss: 4.617 Test Acc: 0.248
Validation loss decreased (-0.232896 --> -0.248189).  Saving model ...
Epoch: 22 cost time: 0.9141645431518555
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.549 Vali Acc: 0.248 Test Loss: 4.549 Test Acc: 0.248
Validation loss decreased (-0.248189 --> -0.248190).  Saving model ...
Epoch: 23 cost time: 0.8492105007171631
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.767 Vali Acc: 0.236 Test Loss: 4.767 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.865156888961792
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.705 Vali Acc: 0.255 Test Loss: 4.705 Test Acc: 0.255
Validation loss decreased (-0.248190 --> -0.255247).  Saving model ...
Epoch: 25 cost time: 0.9001123905181885
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.729 Vali Acc: 0.258 Test Loss: 4.729 Test Acc: 0.258
Validation loss decreased (-0.255247 --> -0.257600).  Saving model ...
Epoch: 26 cost time: 1.0758192539215088
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.739 Vali Acc: 0.258 Test Loss: 4.739 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9272160530090332
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.749 Vali Acc: 0.254 Test Loss: 4.749 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9478342533111572
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.738 Vali Acc: 0.265 Test Loss: 4.738 Test Acc: 0.265
Validation loss decreased (-0.257600 --> -0.264659).  Saving model ...
Epoch: 29 cost time: 0.9611971378326416
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.757 Vali Acc: 0.269 Test Loss: 4.757 Test Acc: 0.269
Validation loss decreased (-0.264659 --> -0.269364).  Saving model ...
Epoch: 30 cost time: 1.0894815921783447
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.758 Vali Acc: 0.268 Test Loss: 4.758 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8971524238586426
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.785 Vali Acc: 0.267 Test Loss: 4.785 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.033271074295044
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.814 Vali Acc: 0.265 Test Loss: 4.814 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9366309642791748
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.828 Vali Acc: 0.262 Test Loss: 4.828 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.193925142288208
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.843 Vali Acc: 0.265 Test Loss: 4.843 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9327108860015869
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.852 Vali Acc: 0.267 Test Loss: 4.852 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.10024094581604
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.859 Vali Acc: 0.264 Test Loss: 4.859 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1141386032104492
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.870 Vali Acc: 0.261 Test Loss: 4.870 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0182983875274658
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.879 Vali Acc: 0.262 Test Loss: 4.879 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1111726760864258
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.892 Vali Acc: 0.265 Test Loss: 4.892 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 5781182
model size : 27.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4943933486938477
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.312 Vali Acc: 0.036 Test Loss: 3.312 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.0470991134643555
Epoch: 2, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.429 Vali Acc: 0.068 Test Loss: 3.429 Test Acc: 0.068
Validation loss decreased (-0.036437 --> -0.068201).  Saving model ...
Epoch: 3 cost time: 1.065077304840088
Epoch: 3, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.287 Vali Acc: 0.071 Test Loss: 3.287 Test Acc: 0.071
Validation loss decreased (-0.068201 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 0.9178762435913086
Epoch: 4, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.219 Vali Acc: 0.109 Test Loss: 3.219 Test Acc: 0.109
Validation loss decreased (-0.070555 --> -0.109380).  Saving model ...
Epoch: 5 cost time: 0.9139528274536133
Epoch: 5, Steps: 10 | Train Loss: 2.724 Vali Loss: 3.276 Vali Acc: 0.111 Test Loss: 3.276 Test Acc: 0.111
Validation loss decreased (-0.109380 --> -0.110555).  Saving model ...
Epoch: 6 cost time: 0.9923152923583984
Epoch: 6, Steps: 10 | Train Loss: 2.443 Vali Loss: 3.204 Vali Acc: 0.147 Test Loss: 3.204 Test Acc: 0.147
Validation loss decreased (-0.110555 --> -0.147027).  Saving model ...
Epoch: 7 cost time: 1.059525489807129
Epoch: 7, Steps: 10 | Train Loss: 2.124 Vali Loss: 3.259 Vali Acc: 0.152 Test Loss: 3.259 Test Acc: 0.152
Validation loss decreased (-0.147027 --> -0.151732).  Saving model ...
Epoch: 8 cost time: 0.9358217716217041
Epoch: 8, Steps: 10 | Train Loss: 1.918 Vali Loss: 3.276 Vali Acc: 0.169 Test Loss: 3.276 Test Acc: 0.169
Validation loss decreased (-0.151732 --> -0.169379).  Saving model ...
Epoch: 9 cost time: 1.0066165924072266
Epoch: 9, Steps: 10 | Train Loss: 1.545 Vali Loss: 3.322 Vali Acc: 0.181 Test Loss: 3.322 Test Acc: 0.181
Validation loss decreased (-0.169379 --> -0.181143).  Saving model ...
Epoch: 10 cost time: 0.9709317684173584
Epoch: 10, Steps: 10 | Train Loss: 1.408 Vali Loss: 3.358 Vali Acc: 0.178 Test Loss: 3.358 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0379066467285156
Epoch: 11, Steps: 10 | Train Loss: 1.159 Vali Loss: 3.516 Vali Acc: 0.222 Test Loss: 3.516 Test Acc: 0.222
Validation loss decreased (-0.181143 --> -0.222318).  Saving model ...
Epoch: 12 cost time: 0.953366756439209
Epoch: 12, Steps: 10 | Train Loss: 0.928 Vali Loss: 3.520 Vali Acc: 0.213 Test Loss: 3.520 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9529035091400146
Epoch: 13, Steps: 10 | Train Loss: 0.727 Vali Loss: 3.615 Vali Acc: 0.218 Test Loss: 3.615 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9104511737823486
Epoch: 14, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.740 Vali Acc: 0.220 Test Loss: 3.740 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8409314155578613
Epoch: 15, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.830 Vali Acc: 0.228 Test Loss: 3.830 Test Acc: 0.228
Validation loss decreased (-0.222318 --> -0.228197).  Saving model ...
Epoch: 16 cost time: 0.9274060726165771
Epoch: 16, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.984 Vali Acc: 0.226 Test Loss: 3.984 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0117957592010498
Epoch: 17, Steps: 10 | Train Loss: 0.182 Vali Loss: 4.029 Vali Acc: 0.226 Test Loss: 4.029 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1496987342834473
Epoch: 18, Steps: 10 | Train Loss: 0.134 Vali Loss: 4.284 Vali Acc: 0.216 Test Loss: 4.284 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0059614181518555
Epoch: 19, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.101 Vali Acc: 0.246 Test Loss: 4.101 Test Acc: 0.246
Validation loss decreased (-0.228197 --> -0.245841).  Saving model ...
Epoch: 20 cost time: 1.1834309101104736
Epoch: 20, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.380 Vali Acc: 0.242 Test Loss: 4.380 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.053656816482544
Epoch: 21, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.376 Vali Acc: 0.266 Test Loss: 4.376 Test Acc: 0.266
Validation loss decreased (-0.245841 --> -0.265839).  Saving model ...
Epoch: 22 cost time: 0.8251190185546875
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.480 Vali Acc: 0.256 Test Loss: 4.480 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8733615875244141
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.465 Vali Acc: 0.253 Test Loss: 4.465 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.921497106552124
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.583 Vali Acc: 0.265 Test Loss: 4.583 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9366724491119385
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.682 Vali Acc: 0.260 Test Loss: 4.682 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.889291524887085
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.538 Vali Acc: 0.273 Test Loss: 4.538 Test Acc: 0.273
Validation loss decreased (-0.265839 --> -0.272896).  Saving model ...
Epoch: 27 cost time: 1.016969919204712
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.538 Vali Acc: 0.272 Test Loss: 4.538 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9409730434417725
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.531 Vali Acc: 0.272 Test Loss: 4.531 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8117008209228516
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.572 Vali Acc: 0.267 Test Loss: 4.572 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9122285842895508
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.629 Vali Acc: 0.275 Test Loss: 4.629 Test Acc: 0.275
Validation loss decreased (-0.272896 --> -0.275248).  Saving model ...
Epoch: 31 cost time: 0.8610353469848633
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.642 Vali Acc: 0.273 Test Loss: 4.642 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9063246250152588
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.636 Vali Acc: 0.275 Test Loss: 4.636 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9038827419281006
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.671 Vali Acc: 0.275 Test Loss: 4.671 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9836184978485107
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.699 Vali Acc: 0.273 Test Loss: 4.699 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.882868766784668
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.712 Vali Acc: 0.272 Test Loss: 4.712 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9264719486236572
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.725 Vali Acc: 0.273 Test Loss: 4.725 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9334378242492676
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.729 Vali Acc: 0.268 Test Loss: 4.729 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8947117328643799
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.732 Vali Acc: 0.271 Test Loss: 4.732 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9567480087280273
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.741 Vali Acc: 0.269 Test Loss: 4.741 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9538488388061523
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.750 Vali Acc: 0.271 Test Loss: 4.750 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 5776062
model size : 27.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1555142402648926
Epoch: 1, Steps: 10 | Train Loss: 3.450 Vali Loss: 3.338 Vali Acc: 0.031 Test Loss: 3.338 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.8047807216644287
Epoch: 2, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.403 Vali Acc: 0.038 Test Loss: 3.403 Test Acc: 0.038
Validation loss decreased (-0.030555 --> -0.037613).  Saving model ...
Epoch: 3 cost time: 0.7701561450958252
Epoch: 3, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.389 Vali Acc: 0.065 Test Loss: 3.389 Test Acc: 0.065
Validation loss decreased (-0.037613 --> -0.064672).  Saving model ...
Epoch: 4 cost time: 0.8074765205383301
Epoch: 4, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.323 Vali Acc: 0.086 Test Loss: 3.323 Test Acc: 0.086
Validation loss decreased (-0.064672 --> -0.085849).  Saving model ...
Epoch: 5 cost time: 0.840338945388794
Epoch: 5, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.292 Vali Acc: 0.093 Test Loss: 3.292 Test Acc: 0.093
Validation loss decreased (-0.085849 --> -0.092908).  Saving model ...
Epoch: 6 cost time: 0.7459683418273926
Epoch: 6, Steps: 10 | Train Loss: 2.802 Vali Loss: 3.273 Vali Acc: 0.101 Test Loss: 3.273 Test Acc: 0.101
Validation loss decreased (-0.092908 --> -0.101144).  Saving model ...
Epoch: 7 cost time: 0.8378965854644775
Epoch: 7, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.244 Vali Acc: 0.119 Test Loss: 3.244 Test Acc: 0.119
Validation loss decreased (-0.101144 --> -0.118791).  Saving model ...
Epoch: 8 cost time: 0.8331363201141357
Epoch: 8, Steps: 10 | Train Loss: 2.376 Vali Loss: 3.257 Vali Acc: 0.125 Test Loss: 3.257 Test Acc: 0.125
Validation loss decreased (-0.118791 --> -0.124673).  Saving model ...
Epoch: 9 cost time: 0.9471044540405273
Epoch: 9, Steps: 10 | Train Loss: 2.226 Vali Loss: 3.233 Vali Acc: 0.144 Test Loss: 3.233 Test Acc: 0.144
Validation loss decreased (-0.124673 --> -0.143497).  Saving model ...
Epoch: 10 cost time: 0.9394509792327881
Epoch: 10, Steps: 10 | Train Loss: 1.924 Vali Loss: 3.280 Vali Acc: 0.156 Test Loss: 3.280 Test Acc: 0.156
Validation loss decreased (-0.143497 --> -0.156438).  Saving model ...
Epoch: 11 cost time: 0.7952213287353516
Epoch: 11, Steps: 10 | Train Loss: 1.788 Vali Loss: 3.271 Vali Acc: 0.158 Test Loss: 3.271 Test Acc: 0.158
Validation loss decreased (-0.156438 --> -0.157614).  Saving model ...
Epoch: 12 cost time: 0.9342195987701416
Epoch: 12, Steps: 10 | Train Loss: 1.598 Vali Loss: 3.288 Vali Acc: 0.165 Test Loss: 3.288 Test Acc: 0.165
Validation loss decreased (-0.157614 --> -0.164673).  Saving model ...
Epoch: 13 cost time: 0.8822677135467529
Epoch: 13, Steps: 10 | Train Loss: 1.326 Vali Loss: 3.370 Vali Acc: 0.176 Test Loss: 3.370 Test Acc: 0.176
Validation loss decreased (-0.164673 --> -0.176437).  Saving model ...
Epoch: 14 cost time: 0.8975276947021484
Epoch: 14, Steps: 10 | Train Loss: 1.185 Vali Loss: 3.365 Vali Acc: 0.195 Test Loss: 3.365 Test Acc: 0.195
Validation loss decreased (-0.176437 --> -0.195260).  Saving model ...
Epoch: 15 cost time: 0.8812072277069092
Epoch: 15, Steps: 10 | Train Loss: 0.974 Vali Loss: 3.364 Vali Acc: 0.215 Test Loss: 3.364 Test Acc: 0.215
Validation loss decreased (-0.195260 --> -0.215260).  Saving model ...
Epoch: 16 cost time: 0.8964495658874512
Epoch: 16, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.468 Vali Acc: 0.194 Test Loss: 3.468 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8692004680633545
Epoch: 17, Steps: 10 | Train Loss: 0.691 Vali Loss: 3.464 Vali Acc: 0.224 Test Loss: 3.464 Test Acc: 0.224
Validation loss decreased (-0.215260 --> -0.223495).  Saving model ...
Epoch: 18 cost time: 0.9425754547119141
Epoch: 18, Steps: 10 | Train Loss: 0.566 Vali Loss: 3.631 Vali Acc: 0.200 Test Loss: 3.631 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8670196533203125
Epoch: 19, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.596 Vali Acc: 0.228 Test Loss: 3.596 Test Acc: 0.228
Validation loss decreased (-0.223495 --> -0.228199).  Saving model ...
Epoch: 20 cost time: 0.8692936897277832
Epoch: 20, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.706 Vali Acc: 0.216 Test Loss: 3.706 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8886775970458984
Epoch: 21, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.667 Vali Acc: 0.246 Test Loss: 3.667 Test Acc: 0.246
Validation loss decreased (-0.228199 --> -0.245846).  Saving model ...
Epoch: 22 cost time: 0.8777391910552979
Epoch: 22, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.893 Vali Acc: 0.206 Test Loss: 3.893 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8824934959411621
Epoch: 23, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.952 Vali Acc: 0.213 Test Loss: 3.952 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8966517448425293
Epoch: 24, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.783 Vali Acc: 0.244 Test Loss: 3.783 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0406615734100342
Epoch: 25, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.987 Vali Acc: 0.225 Test Loss: 3.987 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.068903923034668
Epoch: 26, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.908 Vali Acc: 0.255 Test Loss: 3.908 Test Acc: 0.255
Validation loss decreased (-0.245846 --> -0.255255).  Saving model ...
Epoch: 27 cost time: 0.9503886699676514
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.996 Vali Acc: 0.240 Test Loss: 3.996 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0849840641021729
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.977 Vali Acc: 0.252 Test Loss: 3.977 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1324362754821777
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.023 Vali Acc: 0.260 Test Loss: 4.023 Test Acc: 0.260
Validation loss decreased (-0.255255 --> -0.259960).  Saving model ...
Epoch: 30 cost time: 0.9904623031616211
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.029 Vali Acc: 0.255 Test Loss: 4.029 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0235435962677002
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.059 Vali Acc: 0.267 Test Loss: 4.059 Test Acc: 0.267
Validation loss decreased (-0.259960 --> -0.267018).  Saving model ...
Epoch: 32 cost time: 1.0939722061157227
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.091 Vali Acc: 0.269 Test Loss: 4.091 Test Acc: 0.269
Validation loss decreased (-0.267018 --> -0.269371).  Saving model ...
Epoch: 33 cost time: 1.0680935382843018
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.093 Vali Acc: 0.269 Test Loss: 4.093 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.146897315979004
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.109 Vali Acc: 0.273 Test Loss: 4.109 Test Acc: 0.273
Validation loss decreased (-0.269371 --> -0.272900).  Saving model ...
Epoch: 35 cost time: 1.1401252746582031
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.133 Vali Acc: 0.266 Test Loss: 4.133 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1041958332061768
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.137 Vali Acc: 0.275 Test Loss: 4.137 Test Acc: 0.275
Validation loss decreased (-0.272900 --> -0.275253).  Saving model ...
Epoch: 37 cost time: 0.9793586730957031
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.154 Vali Acc: 0.275 Test Loss: 4.154 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9741644859313965
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.173 Vali Acc: 0.267 Test Loss: 4.173 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9685537815093994
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.170 Vali Acc: 0.273 Test Loss: 4.170 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9833865165710449
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.179 Vali Acc: 0.275 Test Loss: 4.179 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7870182991027832
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.208 Vali Acc: 0.273 Test Loss: 4.208 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8132538795471191
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.221 Vali Acc: 0.274 Test Loss: 4.221 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8735551834106445
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.232 Vali Acc: 0.274 Test Loss: 4.232 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1493773460388184
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.247 Vali Acc: 0.275 Test Loss: 4.247 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.9832639694213867
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.255 Vali Acc: 0.276 Test Loss: 4.255 Test Acc: 0.276
Validation loss decreased (-0.275253 --> -0.276428).  Saving model ...
Epoch: 46 cost time: 0.9620637893676758
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.273 Vali Acc: 0.274 Test Loss: 4.273 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.884352445602417
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.282 Vali Acc: 0.275 Test Loss: 4.282 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8922750949859619
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.284 Vali Acc: 0.275 Test Loss: 4.284 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7435758113861084
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.284 Vali Acc: 0.276 Test Loss: 4.284 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8424136638641357
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.295 Vali Acc: 0.275 Test Loss: 4.295 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.893653154373169
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.313 Vali Acc: 0.276 Test Loss: 4.313 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9142460823059082
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.334 Vali Acc: 0.275 Test Loss: 4.334 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.021263837814331
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.344 Vali Acc: 0.278 Test Loss: 4.344 Test Acc: 0.278
Validation loss decreased (-0.276428 --> -0.277604).  Saving model ...
Epoch: 54 cost time: 0.9683070182800293
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.352 Vali Acc: 0.274 Test Loss: 4.352 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0618247985839844
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.357 Vali Acc: 0.282 Test Loss: 4.357 Test Acc: 0.282
Validation loss decreased (-0.277604 --> -0.282309).  Saving model ...
Epoch: 56 cost time: 0.9372038841247559
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.380 Vali Acc: 0.281 Test Loss: 4.380 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.9455714225769043
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.367 Vali Acc: 0.280 Test Loss: 4.367 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9030811786651611
Epoch: 58, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.385 Vali Acc: 0.279 Test Loss: 4.385 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.9750287532806396
Epoch: 59, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.402 Vali Acc: 0.275 Test Loss: 4.402 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.9679739475250244
Epoch: 60, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.429 Vali Acc: 0.274 Test Loss: 4.429 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.1224477291107178
Epoch: 61, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.422 Vali Acc: 0.278 Test Loss: 4.422 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.020479440689087
Epoch: 62, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.420 Vali Acc: 0.282 Test Loss: 4.420 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.8290810585021973
Epoch: 63, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.437 Vali Acc: 0.282 Test Loss: 4.437 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.0586483478546143
Epoch: 64, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.439 Vali Acc: 0.279 Test Loss: 4.439 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.8657798767089844
Epoch: 65, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.450 Vali Acc: 0.276 Test Loss: 4.450 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 2736702
model size : 12.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1762888431549072
Epoch: 1, Steps: 10 | Train Loss: 3.360 Vali Loss: 3.321 Vali Acc: 0.053 Test Loss: 3.321 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.780919075012207
Epoch: 2, Steps: 10 | Train Loss: 3.203 Vali Loss: 3.364 Vali Acc: 0.058 Test Loss: 3.364 Test Acc: 0.058
Validation loss decreased (-0.052908 --> -0.057613).  Saving model ...
Epoch: 3 cost time: 0.8749697208404541
Epoch: 3, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.373 Vali Acc: 0.071 Test Loss: 3.373 Test Acc: 0.071
Validation loss decreased (-0.057613 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 1.1627755165100098
Epoch: 4, Steps: 10 | Train Loss: 3.055 Vali Loss: 3.304 Vali Acc: 0.067 Test Loss: 3.304 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8548755645751953
Epoch: 5, Steps: 10 | Train Loss: 2.906 Vali Loss: 3.273 Vali Acc: 0.089 Test Loss: 3.273 Test Acc: 0.089
Validation loss decreased (-0.070555 --> -0.089379).  Saving model ...
Epoch: 6 cost time: 0.8747377395629883
Epoch: 6, Steps: 10 | Train Loss: 2.764 Vali Loss: 3.290 Vali Acc: 0.107 Test Loss: 3.290 Test Acc: 0.107
Validation loss decreased (-0.089379 --> -0.107026).  Saving model ...
Epoch: 7 cost time: 0.8298003673553467
Epoch: 7, Steps: 10 | Train Loss: 2.617 Vali Loss: 3.248 Vali Acc: 0.115 Test Loss: 3.248 Test Acc: 0.115
Validation loss decreased (-0.107026 --> -0.115262).  Saving model ...
Epoch: 8 cost time: 0.9273984432220459
Epoch: 8, Steps: 10 | Train Loss: 2.418 Vali Loss: 3.249 Vali Acc: 0.115 Test Loss: 3.249 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8536913394927979
Epoch: 9, Steps: 10 | Train Loss: 2.197 Vali Loss: 3.232 Vali Acc: 0.151 Test Loss: 3.232 Test Acc: 0.151
Validation loss decreased (-0.115262 --> -0.150556).  Saving model ...
Epoch: 10 cost time: 0.8386659622192383
Epoch: 10, Steps: 10 | Train Loss: 1.950 Vali Loss: 3.241 Vali Acc: 0.167 Test Loss: 3.241 Test Acc: 0.167
Validation loss decreased (-0.150556 --> -0.167026).  Saving model ...
Epoch: 11 cost time: 0.9650025367736816
Epoch: 11, Steps: 10 | Train Loss: 1.783 Vali Loss: 3.240 Vali Acc: 0.172 Test Loss: 3.240 Test Acc: 0.172
Validation loss decreased (-0.167026 --> -0.171732).  Saving model ...
Epoch: 12 cost time: 1.0257670879364014
Epoch: 12, Steps: 10 | Train Loss: 1.530 Vali Loss: 3.320 Vali Acc: 0.173 Test Loss: 3.320 Test Acc: 0.173
Validation loss decreased (-0.171732 --> -0.172908).  Saving model ...
Epoch: 13 cost time: 0.9594988822937012
Epoch: 13, Steps: 10 | Train Loss: 1.334 Vali Loss: 3.304 Vali Acc: 0.189 Test Loss: 3.304 Test Acc: 0.189
Validation loss decreased (-0.172908 --> -0.189379).  Saving model ...
Epoch: 14 cost time: 0.9236037731170654
Epoch: 14, Steps: 10 | Train Loss: 1.102 Vali Loss: 3.362 Vali Acc: 0.191 Test Loss: 3.362 Test Acc: 0.191
Validation loss decreased (-0.189379 --> -0.190555).  Saving model ...
Epoch: 15 cost time: 0.7732138633728027
Epoch: 15, Steps: 10 | Train Loss: 0.956 Vali Loss: 3.364 Vali Acc: 0.213 Test Loss: 3.364 Test Acc: 0.213
Validation loss decreased (-0.190555 --> -0.212908).  Saving model ...
Epoch: 16 cost time: 1.0343050956726074
Epoch: 16, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.420 Vali Acc: 0.220 Test Loss: 3.420 Test Acc: 0.220
Validation loss decreased (-0.212908 --> -0.219966).  Saving model ...
Epoch: 17 cost time: 0.9211869239807129
Epoch: 17, Steps: 10 | Train Loss: 0.621 Vali Loss: 3.539 Vali Acc: 0.212 Test Loss: 3.539 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9180548191070557
Epoch: 18, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.512 Vali Acc: 0.228 Test Loss: 3.512 Test Acc: 0.228
Validation loss decreased (-0.219966 --> -0.228200).  Saving model ...
Epoch: 19 cost time: 0.8628904819488525
Epoch: 19, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.582 Vali Acc: 0.233 Test Loss: 3.582 Test Acc: 0.233
Validation loss decreased (-0.228200 --> -0.232905).  Saving model ...
Epoch: 20 cost time: 0.936145544052124
Epoch: 20, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.766 Vali Acc: 0.216 Test Loss: 3.766 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9370653629302979
Epoch: 21, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.872 Vali Acc: 0.218 Test Loss: 3.872 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8294780254364014
Epoch: 22, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.911 Vali Acc: 0.233 Test Loss: 3.911 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9086878299713135
Epoch: 23, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.047 Vali Acc: 0.199 Test Loss: 4.047 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8389863967895508
Epoch: 24, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.094 Vali Acc: 0.231 Test Loss: 4.094 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9021403789520264
Epoch: 25, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.101 Vali Acc: 0.202 Test Loss: 4.101 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8150255680084229
Epoch: 26, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.095 Vali Acc: 0.224 Test Loss: 4.095 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.727271318435669
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.066 Vali Acc: 0.244 Test Loss: 4.066 Test Acc: 0.244
Validation loss decreased (-0.232905 --> -0.243489).  Saving model ...
Epoch: 28 cost time: 1.0732316970825195
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.071 Vali Acc: 0.246 Test Loss: 4.071 Test Acc: 0.246
Validation loss decreased (-0.243489 --> -0.245842).  Saving model ...
Epoch: 29 cost time: 1.0197546482086182
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.110 Vali Acc: 0.244 Test Loss: 4.110 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0137221813201904
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.163 Vali Acc: 0.244 Test Loss: 4.163 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9568731784820557
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.141 Vali Acc: 0.253 Test Loss: 4.141 Test Acc: 0.253
Validation loss decreased (-0.245842 --> -0.252900).  Saving model ...
Epoch: 32 cost time: 0.8139913082122803
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.144 Vali Acc: 0.242 Test Loss: 4.144 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9178366661071777
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.189 Vali Acc: 0.255 Test Loss: 4.189 Test Acc: 0.255
Validation loss decreased (-0.252900 --> -0.255252).  Saving model ...
Epoch: 34 cost time: 0.8051626682281494
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.198 Vali Acc: 0.245 Test Loss: 4.198 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.043710470199585
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.231 Vali Acc: 0.253 Test Loss: 4.231 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9608192443847656
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.254 Vali Acc: 0.247 Test Loss: 4.254 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9511411190032959
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.235 Vali Acc: 0.251 Test Loss: 4.235 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9300746917724609
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.250 Vali Acc: 0.247 Test Loss: 4.250 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.820950984954834
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.257 Vali Acc: 0.253 Test Loss: 4.257 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.912142276763916
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.308 Vali Acc: 0.248 Test Loss: 4.308 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.930652379989624
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.304 Vali Acc: 0.254 Test Loss: 4.304 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0410358905792236
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.315 Vali Acc: 0.251 Test Loss: 4.315 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.8498330116271973
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.320 Vali Acc: 0.249 Test Loss: 4.320 Test Acc: 0.249
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 2734142
model size : 12.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2664458751678467
Epoch: 1, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.347 Vali Acc: 0.033 Test Loss: 3.347 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.7629599571228027
Epoch: 2, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.399 Vali Acc: 0.046 Test Loss: 3.399 Test Acc: 0.046
Validation loss decreased (-0.032908 --> -0.045848).  Saving model ...
Epoch: 3 cost time: 0.8967053890228271
Epoch: 3, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.332 Vali Acc: 0.065 Test Loss: 3.332 Test Acc: 0.065
Validation loss decreased (-0.045848 --> -0.064673).  Saving model ...
Epoch: 4 cost time: 0.8621020317077637
Epoch: 4, Steps: 10 | Train Loss: 3.065 Vali Loss: 3.304 Vali Acc: 0.064 Test Loss: 3.304 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.899167537689209
Epoch: 5, Steps: 10 | Train Loss: 2.912 Vali Loss: 3.279 Vali Acc: 0.093 Test Loss: 3.279 Test Acc: 0.093
Validation loss decreased (-0.064673 --> -0.092908).  Saving model ...
Epoch: 6 cost time: 0.8806025981903076
Epoch: 6, Steps: 10 | Train Loss: 2.775 Vali Loss: 3.229 Vali Acc: 0.101 Test Loss: 3.229 Test Acc: 0.101
Validation loss decreased (-0.092908 --> -0.101144).  Saving model ...
Epoch: 7 cost time: 0.9080955982208252
Epoch: 7, Steps: 10 | Train Loss: 2.557 Vali Loss: 3.280 Vali Acc: 0.112 Test Loss: 3.280 Test Acc: 0.112
Validation loss decreased (-0.101144 --> -0.111732).  Saving model ...
Epoch: 8 cost time: 0.8849029541015625
Epoch: 8, Steps: 10 | Train Loss: 2.413 Vali Loss: 3.207 Vali Acc: 0.141 Test Loss: 3.207 Test Acc: 0.141
Validation loss decreased (-0.111732 --> -0.141144).  Saving model ...
Epoch: 9 cost time: 0.7485120296478271
Epoch: 9, Steps: 10 | Train Loss: 2.157 Vali Loss: 3.239 Vali Acc: 0.133 Test Loss: 3.239 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8370850086212158
Epoch: 10, Steps: 10 | Train Loss: 2.007 Vali Loss: 3.246 Vali Acc: 0.139 Test Loss: 3.246 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8731100559234619
Epoch: 11, Steps: 10 | Train Loss: 1.789 Vali Loss: 3.298 Vali Acc: 0.162 Test Loss: 3.298 Test Acc: 0.162
Validation loss decreased (-0.141144 --> -0.162320).  Saving model ...
Epoch: 12 cost time: 1.1287152767181396
Epoch: 12, Steps: 10 | Train Loss: 1.542 Vali Loss: 3.286 Vali Acc: 0.171 Test Loss: 3.286 Test Acc: 0.171
Validation loss decreased (-0.162320 --> -0.170555).  Saving model ...
Epoch: 13 cost time: 0.9050030708312988
Epoch: 13, Steps: 10 | Train Loss: 1.430 Vali Loss: 3.298 Vali Acc: 0.188 Test Loss: 3.298 Test Acc: 0.188
Validation loss decreased (-0.170555 --> -0.188202).  Saving model ...
Epoch: 14 cost time: 0.7609636783599854
Epoch: 14, Steps: 10 | Train Loss: 1.123 Vali Loss: 3.290 Vali Acc: 0.208 Test Loss: 3.290 Test Acc: 0.208
Validation loss decreased (-0.188202 --> -0.208202).  Saving model ...
Epoch: 15 cost time: 0.883056640625
Epoch: 15, Steps: 10 | Train Loss: 1.007 Vali Loss: 3.365 Vali Acc: 0.182 Test Loss: 3.365 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.012930154800415
Epoch: 16, Steps: 10 | Train Loss: 0.803 Vali Loss: 3.383 Vali Acc: 0.211 Test Loss: 3.383 Test Acc: 0.211
Validation loss decreased (-0.208202 --> -0.210554).  Saving model ...
Epoch: 17 cost time: 0.9376180171966553
Epoch: 17, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.417 Vali Acc: 0.226 Test Loss: 3.417 Test Acc: 0.226
Validation loss decreased (-0.210554 --> -0.225848).  Saving model ...
Epoch: 18 cost time: 0.8042056560516357
Epoch: 18, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.572 Vali Acc: 0.224 Test Loss: 3.572 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9405796527862549
Epoch: 19, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.510 Vali Acc: 0.234 Test Loss: 3.510 Test Acc: 0.234
Validation loss decreased (-0.225848 --> -0.234083).  Saving model ...
Epoch: 20 cost time: 1.0199346542358398
Epoch: 20, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.606 Vali Acc: 0.234 Test Loss: 3.606 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9035549163818359
Epoch: 21, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.747 Vali Acc: 0.221 Test Loss: 3.747 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8809123039245605
Epoch: 22, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.862 Vali Acc: 0.219 Test Loss: 3.862 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9240994453430176
Epoch: 23, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.778 Vali Acc: 0.241 Test Loss: 3.778 Test Acc: 0.241
Validation loss decreased (-0.234083 --> -0.241139).  Saving model ...
Epoch: 24 cost time: 0.8652913570404053
Epoch: 24, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.780 Vali Acc: 0.262 Test Loss: 3.780 Test Acc: 0.262
Validation loss decreased (-0.241139 --> -0.262315).  Saving model ...
Epoch: 25 cost time: 0.906400203704834
Epoch: 25, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.933 Vali Acc: 0.224 Test Loss: 3.933 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9017579555511475
Epoch: 26, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.939 Vali Acc: 0.259 Test Loss: 3.939 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0753207206726074
Epoch: 27, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.998 Vali Acc: 0.246 Test Loss: 3.998 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9799163341522217
Epoch: 28, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.954 Vali Acc: 0.271 Test Loss: 3.954 Test Acc: 0.271
Validation loss decreased (-0.262315 --> -0.270549).  Saving model ...
Epoch: 29 cost time: 0.8623783588409424
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.030 Vali Acc: 0.251 Test Loss: 4.030 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9106762409210205
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.994 Vali Acc: 0.259 Test Loss: 3.994 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9481198787689209
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.084 Vali Acc: 0.264 Test Loss: 4.084 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8976521492004395
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.031 Vali Acc: 0.282 Test Loss: 4.031 Test Acc: 0.282
Validation loss decreased (-0.270549 --> -0.282313).  Saving model ...
Epoch: 33 cost time: 0.9569063186645508
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.072 Vali Acc: 0.266 Test Loss: 4.072 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.862537145614624
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.086 Vali Acc: 0.266 Test Loss: 4.086 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8559088706970215
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.087 Vali Acc: 0.272 Test Loss: 4.087 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7876663208007812
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.110 Vali Acc: 0.272 Test Loss: 4.110 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8094198703765869
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.122 Vali Acc: 0.272 Test Loss: 4.122 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8731963634490967
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.143 Vali Acc: 0.272 Test Loss: 4.143 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9434821605682373
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.156 Vali Acc: 0.271 Test Loss: 4.156 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9460899829864502
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.168 Vali Acc: 0.275 Test Loss: 4.168 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.986757755279541
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.194 Vali Acc: 0.271 Test Loss: 4.194 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9655365943908691
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.203 Vali Acc: 0.274 Test Loss: 4.203 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 2731582
model size : 12.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.103036880493164
Epoch: 1, Steps: 10 | Train Loss: 3.418 Vali Loss: 3.313 Vali Acc: 0.048 Test Loss: 3.313 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.9079689979553223
Epoch: 2, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.418 Vali Acc: 0.048 Test Loss: 3.418 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9698007106781006
Epoch: 3, Steps: 10 | Train Loss: 3.125 Vali Loss: 3.377 Vali Acc: 0.049 Test Loss: 3.377 Test Acc: 0.049
Validation loss decreased (-0.048202 --> -0.049378).  Saving model ...
Epoch: 4 cost time: 0.9471940994262695
Epoch: 4, Steps: 10 | Train Loss: 2.994 Vali Loss: 3.307 Vali Acc: 0.072 Test Loss: 3.307 Test Acc: 0.072
Validation loss decreased (-0.049378 --> -0.071732).  Saving model ...
Epoch: 5 cost time: 0.7691783905029297
Epoch: 5, Steps: 10 | Train Loss: 2.898 Vali Loss: 3.291 Vali Acc: 0.086 Test Loss: 3.291 Test Acc: 0.086
Validation loss decreased (-0.071732 --> -0.085849).  Saving model ...
Epoch: 6 cost time: 0.9249436855316162
Epoch: 6, Steps: 10 | Train Loss: 2.756 Vali Loss: 3.332 Vali Acc: 0.098 Test Loss: 3.332 Test Acc: 0.098
Validation loss decreased (-0.085849 --> -0.097614).  Saving model ...
Epoch: 7 cost time: 0.9466109275817871
Epoch: 7, Steps: 10 | Train Loss: 2.561 Vali Loss: 3.308 Vali Acc: 0.093 Test Loss: 3.308 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9798505306243896
Epoch: 8, Steps: 10 | Train Loss: 2.332 Vali Loss: 3.225 Vali Acc: 0.121 Test Loss: 3.225 Test Acc: 0.121
Validation loss decreased (-0.097614 --> -0.121144).  Saving model ...
Epoch: 9 cost time: 1.0004029273986816
Epoch: 9, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.268 Vali Acc: 0.138 Test Loss: 3.268 Test Acc: 0.138
Validation loss decreased (-0.121144 --> -0.137614).  Saving model ...
Epoch: 10 cost time: 0.7979867458343506
Epoch: 10, Steps: 10 | Train Loss: 1.935 Vali Loss: 3.238 Vali Acc: 0.159 Test Loss: 3.238 Test Acc: 0.159
Validation loss decreased (-0.137614 --> -0.158791).  Saving model ...
Epoch: 11 cost time: 0.9734764099121094
Epoch: 11, Steps: 10 | Train Loss: 1.711 Vali Loss: 3.276 Vali Acc: 0.169 Test Loss: 3.276 Test Acc: 0.169
Validation loss decreased (-0.158791 --> -0.169379).  Saving model ...
Epoch: 12 cost time: 0.9686746597290039
Epoch: 12, Steps: 10 | Train Loss: 1.479 Vali Loss: 3.343 Vali Acc: 0.161 Test Loss: 3.343 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8711159229278564
Epoch: 13, Steps: 10 | Train Loss: 1.294 Vali Loss: 3.325 Vali Acc: 0.196 Test Loss: 3.325 Test Acc: 0.196
Validation loss decreased (-0.169379 --> -0.196437).  Saving model ...
Epoch: 14 cost time: 0.8830478191375732
Epoch: 14, Steps: 10 | Train Loss: 1.098 Vali Loss: 3.336 Vali Acc: 0.198 Test Loss: 3.336 Test Acc: 0.198
Validation loss decreased (-0.196437 --> -0.197614).  Saving model ...
Epoch: 15 cost time: 1.005768060684204
Epoch: 15, Steps: 10 | Train Loss: 0.922 Vali Loss: 3.411 Vali Acc: 0.204 Test Loss: 3.411 Test Acc: 0.204
Validation loss decreased (-0.197614 --> -0.203495).  Saving model ...
Epoch: 16 cost time: 0.924595832824707
Epoch: 16, Steps: 10 | Train Loss: 0.832 Vali Loss: 3.470 Vali Acc: 0.201 Test Loss: 3.470 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.972853422164917
Epoch: 17, Steps: 10 | Train Loss: 0.639 Vali Loss: 3.479 Vali Acc: 0.234 Test Loss: 3.479 Test Acc: 0.234
Validation loss decreased (-0.203495 --> -0.234083).  Saving model ...
Epoch: 18 cost time: 0.9480772018432617
Epoch: 18, Steps: 10 | Train Loss: 0.528 Vali Loss: 3.516 Vali Acc: 0.221 Test Loss: 3.516 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8992459774017334
Epoch: 19, Steps: 10 | Train Loss: 0.436 Vali Loss: 3.597 Vali Acc: 0.236 Test Loss: 3.597 Test Acc: 0.236
Validation loss decreased (-0.234083 --> -0.236435).  Saving model ...
Epoch: 20 cost time: 0.866804838180542
Epoch: 20, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.732 Vali Acc: 0.239 Test Loss: 3.732 Test Acc: 0.239
Validation loss decreased (-0.236435 --> -0.238786).  Saving model ...
Epoch: 21 cost time: 0.9320154190063477
Epoch: 21, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.692 Vali Acc: 0.235 Test Loss: 3.692 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8229947090148926
Epoch: 22, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.709 Vali Acc: 0.239 Test Loss: 3.709 Test Acc: 0.239
Validation loss decreased (-0.238786 --> -0.238786).  Saving model ...
Epoch: 23 cost time: 0.759404182434082
Epoch: 23, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.887 Vali Acc: 0.254 Test Loss: 3.887 Test Acc: 0.254
Validation loss decreased (-0.238786 --> -0.254079).  Saving model ...
Epoch: 24 cost time: 0.8378427028656006
Epoch: 24, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.870 Vali Acc: 0.245 Test Loss: 3.870 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9275612831115723
Epoch: 25, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.920 Vali Acc: 0.251 Test Loss: 3.920 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8271965980529785
Epoch: 26, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.992 Vali Acc: 0.240 Test Loss: 3.992 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9174611568450928
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.001 Vali Acc: 0.245 Test Loss: 4.001 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9346668720245361
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.052 Vali Acc: 0.254 Test Loss: 4.052 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9414832592010498
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.999 Vali Acc: 0.265 Test Loss: 3.999 Test Acc: 0.265
Validation loss decreased (-0.254079 --> -0.264666).  Saving model ...
Epoch: 30 cost time: 0.9423046112060547
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.080 Vali Acc: 0.266 Test Loss: 4.080 Test Acc: 0.266
Validation loss decreased (-0.264666 --> -0.265842).  Saving model ...
Epoch: 31 cost time: 0.8813786506652832
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.099 Vali Acc: 0.255 Test Loss: 4.099 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9260802268981934
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.074 Vali Acc: 0.269 Test Loss: 4.074 Test Acc: 0.269
Validation loss decreased (-0.265842 --> -0.269371).  Saving model ...
Epoch: 33 cost time: 1.0282375812530518
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.138 Vali Acc: 0.266 Test Loss: 4.138 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.862053632736206
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.150 Vali Acc: 0.273 Test Loss: 4.150 Test Acc: 0.273
Validation loss decreased (-0.269371 --> -0.272900).  Saving model ...
Epoch: 35 cost time: 0.931342363357544
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.171 Vali Acc: 0.271 Test Loss: 4.171 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9446313381195068
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.173 Vali Acc: 0.273 Test Loss: 4.173 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9554316997528076
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.192 Vali Acc: 0.268 Test Loss: 4.192 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8614821434020996
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.212 Vali Acc: 0.268 Test Loss: 4.212 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8681504726409912
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.258 Vali Acc: 0.267 Test Loss: 4.258 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8918607234954834
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.225 Vali Acc: 0.266 Test Loss: 4.225 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8563070297241211
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.249 Vali Acc: 0.266 Test Loss: 4.249 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8959252834320068
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.257 Vali Acc: 0.272 Test Loss: 4.257 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9195220470428467
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.272 Vali Acc: 0.271 Test Loss: 4.272 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8038461208343506
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.309 Vali Acc: 0.269 Test Loss: 4.309 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 2729022
model size : 12.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1451172828674316
Epoch: 1, Steps: 10 | Train Loss: 3.473 Vali Loss: 3.325 Vali Acc: 0.039 Test Loss: 3.325 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.9349255561828613
Epoch: 2, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.385 Vali Acc: 0.060 Test Loss: 3.385 Test Acc: 0.060
Validation loss decreased (-0.038790 --> -0.059966).  Saving model ...
Epoch: 3 cost time: 0.865178108215332
Epoch: 3, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.359 Vali Acc: 0.059 Test Loss: 3.359 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8541083335876465
Epoch: 4, Steps: 10 | Train Loss: 3.032 Vali Loss: 3.290 Vali Acc: 0.091 Test Loss: 3.290 Test Acc: 0.091
Validation loss decreased (-0.059966 --> -0.090555).  Saving model ...
Epoch: 5 cost time: 0.7994379997253418
Epoch: 5, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.304 Vali Acc: 0.101 Test Loss: 3.304 Test Acc: 0.101
Validation loss decreased (-0.090555 --> -0.101143).  Saving model ...
Epoch: 6 cost time: 0.7532875537872314
Epoch: 6, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.316 Vali Acc: 0.093 Test Loss: 3.316 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8402948379516602
Epoch: 7, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.223 Vali Acc: 0.112 Test Loss: 3.223 Test Acc: 0.112
Validation loss decreased (-0.101143 --> -0.111732).  Saving model ...
Epoch: 8 cost time: 0.8750729560852051
Epoch: 8, Steps: 10 | Train Loss: 2.477 Vali Loss: 3.262 Vali Acc: 0.125 Test Loss: 3.262 Test Acc: 0.125
Validation loss decreased (-0.111732 --> -0.124673).  Saving model ...
Epoch: 9 cost time: 0.7595493793487549
Epoch: 9, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.239 Vali Acc: 0.151 Test Loss: 3.239 Test Acc: 0.151
Validation loss decreased (-0.124673 --> -0.150556).  Saving model ...
Epoch: 10 cost time: 0.8949494361877441
Epoch: 10, Steps: 10 | Train Loss: 2.083 Vali Loss: 3.304 Vali Acc: 0.164 Test Loss: 3.304 Test Acc: 0.164
Validation loss decreased (-0.150556 --> -0.163496).  Saving model ...
Epoch: 11 cost time: 0.7610361576080322
Epoch: 11, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.279 Vali Acc: 0.156 Test Loss: 3.279 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8856518268585205
Epoch: 12, Steps: 10 | Train Loss: 1.658 Vali Loss: 3.278 Vali Acc: 0.189 Test Loss: 3.278 Test Acc: 0.189
Validation loss decreased (-0.163496 --> -0.189379).  Saving model ...
Epoch: 13 cost time: 0.7687394618988037
Epoch: 13, Steps: 10 | Train Loss: 1.442 Vali Loss: 3.321 Vali Acc: 0.187 Test Loss: 3.321 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8227815628051758
Epoch: 14, Steps: 10 | Train Loss: 1.278 Vali Loss: 3.373 Vali Acc: 0.188 Test Loss: 3.373 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8767454624176025
Epoch: 15, Steps: 10 | Train Loss: 1.119 Vali Loss: 3.363 Vali Acc: 0.206 Test Loss: 3.363 Test Acc: 0.206
Validation loss decreased (-0.189379 --> -0.205849).  Saving model ...
Epoch: 16 cost time: 0.9123165607452393
Epoch: 16, Steps: 10 | Train Loss: 0.985 Vali Loss: 3.434 Vali Acc: 0.215 Test Loss: 3.434 Test Acc: 0.215
Validation loss decreased (-0.205849 --> -0.215260).  Saving model ...
Epoch: 17 cost time: 0.8095614910125732
Epoch: 17, Steps: 10 | Train Loss: 0.764 Vali Loss: 3.433 Vali Acc: 0.222 Test Loss: 3.433 Test Acc: 0.222
Validation loss decreased (-0.215260 --> -0.222319).  Saving model ...
Epoch: 18 cost time: 0.8743579387664795
Epoch: 18, Steps: 10 | Train Loss: 0.661 Vali Loss: 3.522 Vali Acc: 0.231 Test Loss: 3.522 Test Acc: 0.231
Validation loss decreased (-0.222319 --> -0.230553).  Saving model ...
Epoch: 19 cost time: 0.8669745922088623
Epoch: 19, Steps: 10 | Train Loss: 0.529 Vali Loss: 3.516 Vali Acc: 0.234 Test Loss: 3.516 Test Acc: 0.234
Validation loss decreased (-0.230553 --> -0.234082).  Saving model ...
Epoch: 20 cost time: 0.7517397403717041
Epoch: 20, Steps: 10 | Train Loss: 0.426 Vali Loss: 3.609 Vali Acc: 0.234 Test Loss: 3.609 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8354227542877197
Epoch: 21, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.813 Vali Acc: 0.199 Test Loss: 3.813 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7859830856323242
Epoch: 22, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.750 Vali Acc: 0.241 Test Loss: 3.750 Test Acc: 0.241
Validation loss decreased (-0.234082 --> -0.241139).  Saving model ...
Epoch: 23 cost time: 0.9333884716033936
Epoch: 23, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.819 Vali Acc: 0.227 Test Loss: 3.819 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8571226596832275
Epoch: 24, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.944 Vali Acc: 0.222 Test Loss: 3.944 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7567722797393799
Epoch: 25, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.894 Vali Acc: 0.253 Test Loss: 3.894 Test Acc: 0.253
Validation loss decreased (-0.241139 --> -0.252902).  Saving model ...
Epoch: 26 cost time: 0.8498573303222656
Epoch: 26, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.978 Vali Acc: 0.234 Test Loss: 3.978 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9495344161987305
Epoch: 27, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.074 Vali Acc: 0.251 Test Loss: 4.074 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8934409618377686
Epoch: 28, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.002 Vali Acc: 0.246 Test Loss: 4.002 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9503767490386963
Epoch: 29, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.133 Vali Acc: 0.255 Test Loss: 4.133 Test Acc: 0.255
Validation loss decreased (-0.252902 --> -0.255253).  Saving model ...
Epoch: 30 cost time: 0.9431459903717041
Epoch: 30, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.201 Vali Acc: 0.244 Test Loss: 4.201 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.894782304763794
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.118 Vali Acc: 0.258 Test Loss: 4.118 Test Acc: 0.258
Validation loss decreased (-0.255253 --> -0.257606).  Saving model ...
Epoch: 32 cost time: 0.9193425178527832
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.122 Vali Acc: 0.261 Test Loss: 4.122 Test Acc: 0.261
Validation loss decreased (-0.257606 --> -0.261135).  Saving model ...
Epoch: 33 cost time: 0.8322768211364746
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.167 Vali Acc: 0.267 Test Loss: 4.167 Test Acc: 0.267
Validation loss decreased (-0.261135 --> -0.267017).  Saving model ...
Epoch: 34 cost time: 0.8884024620056152
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.220 Vali Acc: 0.267 Test Loss: 4.220 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8454792499542236
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.227 Vali Acc: 0.262 Test Loss: 4.227 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8905482292175293
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.242 Vali Acc: 0.259 Test Loss: 4.242 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8065643310546875
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.262 Vali Acc: 0.267 Test Loss: 4.262 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7892634868621826
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.285 Vali Acc: 0.267 Test Loss: 4.285 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8057386875152588
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.289 Vali Acc: 0.264 Test Loss: 4.289 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.892878532409668
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.293 Vali Acc: 0.268 Test Loss: 4.293 Test Acc: 0.268
Validation loss decreased (-0.267017 --> -0.268192).  Saving model ...
Epoch: 41 cost time: 0.9458553791046143
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.324 Vali Acc: 0.264 Test Loss: 4.324 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9617574214935303
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.341 Vali Acc: 0.265 Test Loss: 4.341 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9379303455352783
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.340 Vali Acc: 0.268 Test Loss: 4.340 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8762552738189697
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.362 Vali Acc: 0.269 Test Loss: 4.362 Test Acc: 0.269
Validation loss decreased (-0.268192 --> -0.269368).  Saving model ...
Epoch: 45 cost time: 1.1444196701049805
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.386 Vali Acc: 0.268 Test Loss: 4.386 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8742282390594482
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.394 Vali Acc: 0.266 Test Loss: 4.394 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9040589332580566
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.402 Vali Acc: 0.267 Test Loss: 4.402 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.937483549118042
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.407 Vali Acc: 0.265 Test Loss: 4.407 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9904172420501709
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.434 Vali Acc: 0.268 Test Loss: 4.434 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.972405195236206
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.452 Vali Acc: 0.267 Test Loss: 4.452 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.0087106227874756
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.448 Vali Acc: 0.273 Test Loss: 4.448 Test Acc: 0.273
Validation loss decreased (-0.269368 --> -0.272897).  Saving model ...
Epoch: 52 cost time: 1.069115400314331
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.475 Vali Acc: 0.269 Test Loss: 4.475 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0340967178344727
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.476 Vali Acc: 0.272 Test Loss: 4.476 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9135665893554688
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.490 Vali Acc: 0.272 Test Loss: 4.490 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8881888389587402
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.494 Vali Acc: 0.275 Test Loss: 4.494 Test Acc: 0.275
Validation loss decreased (-0.272897 --> -0.275249).  Saving model ...
Epoch: 56 cost time: 1.3447251319885254
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.492 Vali Acc: 0.265 Test Loss: 4.492 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0422570705413818
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.518 Vali Acc: 0.275 Test Loss: 4.518 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.2512452602386475
Epoch: 58, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.528 Vali Acc: 0.273 Test Loss: 4.528 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.1602482795715332
Epoch: 59, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.530 Vali Acc: 0.272 Test Loss: 4.530 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.9817404747009277
Epoch: 60, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.550 Vali Acc: 0.273 Test Loss: 4.550 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.0780713558197021
Epoch: 61, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.553 Vali Acc: 0.273 Test Loss: 4.553 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.9933247566223145
Epoch: 62, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.576 Vali Acc: 0.271 Test Loss: 4.576 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.987293004989624
Epoch: 63, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.583 Vali Acc: 0.267 Test Loss: 4.583 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.9735081195831299
Epoch: 64, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.609 Vali Acc: 0.274 Test Loss: 4.609 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.9344685077667236
Epoch: 65, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.615 Vali Acc: 0.275 Test Loss: 4.615 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 2078782
model size : 10.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8463470935821533
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.329 Vali Acc: 0.031 Test Loss: 3.329 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.7404019832611084
Epoch: 2, Steps: 10 | Train Loss: 3.189 Vali Loss: 3.352 Vali Acc: 0.046 Test Loss: 3.352 Test Acc: 0.046
Validation loss decreased (-0.030555 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.8379592895507812
Epoch: 3, Steps: 10 | Train Loss: 3.107 Vali Loss: 3.360 Vali Acc: 0.062 Test Loss: 3.360 Test Acc: 0.062
Validation loss decreased (-0.045849 --> -0.062319).  Saving model ...
Epoch: 4 cost time: 0.889014720916748
Epoch: 4, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.323 Vali Acc: 0.073 Test Loss: 3.323 Test Acc: 0.073
Validation loss decreased (-0.062319 --> -0.072908).  Saving model ...
Epoch: 5 cost time: 0.7908754348754883
Epoch: 5, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.277 Vali Acc: 0.062 Test Loss: 3.277 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8411498069763184
Epoch: 6, Steps: 10 | Train Loss: 2.816 Vali Loss: 3.308 Vali Acc: 0.089 Test Loss: 3.308 Test Acc: 0.089
Validation loss decreased (-0.072908 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 0.9115984439849854
Epoch: 7, Steps: 10 | Train Loss: 2.635 Vali Loss: 3.262 Vali Acc: 0.101 Test Loss: 3.262 Test Acc: 0.101
Validation loss decreased (-0.089379 --> -0.101144).  Saving model ...
Epoch: 8 cost time: 0.8841605186462402
Epoch: 8, Steps: 10 | Train Loss: 2.398 Vali Loss: 3.225 Vali Acc: 0.129 Test Loss: 3.225 Test Acc: 0.129
Validation loss decreased (-0.101144 --> -0.129380).  Saving model ...
Epoch: 9 cost time: 0.7935678958892822
Epoch: 9, Steps: 10 | Train Loss: 2.218 Vali Loss: 3.241 Vali Acc: 0.132 Test Loss: 3.241 Test Acc: 0.132
Validation loss decreased (-0.129380 --> -0.131732).  Saving model ...
Epoch: 10 cost time: 0.8856596946716309
Epoch: 10, Steps: 10 | Train Loss: 2.026 Vali Loss: 3.279 Vali Acc: 0.145 Test Loss: 3.279 Test Acc: 0.145
Validation loss decreased (-0.131732 --> -0.144673).  Saving model ...
Epoch: 11 cost time: 0.8994426727294922
Epoch: 11, Steps: 10 | Train Loss: 1.760 Vali Loss: 3.273 Vali Acc: 0.141 Test Loss: 3.273 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9211835861206055
Epoch: 12, Steps: 10 | Train Loss: 1.602 Vali Loss: 3.298 Vali Acc: 0.180 Test Loss: 3.298 Test Acc: 0.180
Validation loss decreased (-0.144673 --> -0.179967).  Saving model ...
Epoch: 13 cost time: 0.8491365909576416
Epoch: 13, Steps: 10 | Train Loss: 1.389 Vali Loss: 3.354 Vali Acc: 0.187 Test Loss: 3.354 Test Acc: 0.187
Validation loss decreased (-0.179967 --> -0.187025).  Saving model ...
Epoch: 14 cost time: 0.9722204208374023
Epoch: 14, Steps: 10 | Train Loss: 1.302 Vali Loss: 3.347 Vali Acc: 0.188 Test Loss: 3.347 Test Acc: 0.188
Validation loss decreased (-0.187025 --> -0.188202).  Saving model ...
Epoch: 15 cost time: 0.9032447338104248
Epoch: 15, Steps: 10 | Train Loss: 1.105 Vali Loss: 3.391 Vali Acc: 0.209 Test Loss: 3.391 Test Acc: 0.209
Validation loss decreased (-0.188202 --> -0.209378).  Saving model ...
Epoch: 16 cost time: 0.9636557102203369
Epoch: 16, Steps: 10 | Train Loss: 0.852 Vali Loss: 3.390 Vali Acc: 0.215 Test Loss: 3.390 Test Acc: 0.215
Validation loss decreased (-0.209378 --> -0.215260).  Saving model ...
Epoch: 17 cost time: 0.8850908279418945
Epoch: 17, Steps: 10 | Train Loss: 0.762 Vali Loss: 3.452 Vali Acc: 0.225 Test Loss: 3.452 Test Acc: 0.225
Validation loss decreased (-0.215260 --> -0.224671).  Saving model ...
Epoch: 18 cost time: 1.0332977771759033
Epoch: 18, Steps: 10 | Train Loss: 0.611 Vali Loss: 3.543 Vali Acc: 0.214 Test Loss: 3.543 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9708297252655029
Epoch: 19, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.511 Vali Acc: 0.241 Test Loss: 3.511 Test Acc: 0.241
Validation loss decreased (-0.224671 --> -0.241141).  Saving model ...
Epoch: 20 cost time: 0.9591660499572754
Epoch: 20, Steps: 10 | Train Loss: 0.383 Vali Loss: 3.636 Vali Acc: 0.238 Test Loss: 3.636 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9082355499267578
Epoch: 21, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.652 Vali Acc: 0.258 Test Loss: 3.652 Test Acc: 0.258
Validation loss decreased (-0.241141 --> -0.257611).  Saving model ...
Epoch: 22 cost time: 1.087996482849121
Epoch: 22, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.739 Vali Acc: 0.251 Test Loss: 3.739 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1243083477020264
Epoch: 23, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.770 Vali Acc: 0.241 Test Loss: 3.770 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8488121032714844
Epoch: 24, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.894 Vali Acc: 0.240 Test Loss: 3.894 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.976752519607544
Epoch: 25, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.929 Vali Acc: 0.248 Test Loss: 3.929 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9388604164123535
Epoch: 26, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.034 Vali Acc: 0.246 Test Loss: 4.034 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9339113235473633
Epoch: 27, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.958 Vali Acc: 0.251 Test Loss: 3.958 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7672069072723389
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.010 Vali Acc: 0.264 Test Loss: 4.010 Test Acc: 0.264
Validation loss decreased (-0.257611 --> -0.263489).  Saving model ...
Epoch: 29 cost time: 0.9916632175445557
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.067 Vali Acc: 0.259 Test Loss: 4.067 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9251754283905029
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.083 Vali Acc: 0.268 Test Loss: 4.083 Test Acc: 0.268
Validation loss decreased (-0.263489 --> -0.268194).  Saving model ...
Epoch: 31 cost time: 0.9243988990783691
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.074 Vali Acc: 0.265 Test Loss: 4.074 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9512796401977539
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.110 Vali Acc: 0.262 Test Loss: 4.110 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9239258766174316
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.127 Vali Acc: 0.258 Test Loss: 4.127 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9702088832855225
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.170 Vali Acc: 0.264 Test Loss: 4.170 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8706793785095215
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.173 Vali Acc: 0.264 Test Loss: 4.173 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9618320465087891
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.201 Vali Acc: 0.262 Test Loss: 4.201 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9152517318725586
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.204 Vali Acc: 0.264 Test Loss: 4.204 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9121661186218262
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.210 Vali Acc: 0.266 Test Loss: 4.210 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8729362487792969
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.233 Vali Acc: 0.271 Test Loss: 4.233 Test Acc: 0.271
Validation loss decreased (-0.268194 --> -0.270546).  Saving model ...
Epoch: 40 cost time: 0.9387483596801758
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.259 Vali Acc: 0.269 Test Loss: 4.259 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8565080165863037
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.268 Vali Acc: 0.268 Test Loss: 4.268 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9346494674682617
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.270 Vali Acc: 0.269 Test Loss: 4.270 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8152861595153809
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.286 Vali Acc: 0.273 Test Loss: 4.286 Test Acc: 0.273
Validation loss decreased (-0.270546 --> -0.272898).  Saving model ...
Epoch: 44 cost time: 0.9603068828582764
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.303 Vali Acc: 0.271 Test Loss: 4.303 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8595130443572998
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.309 Vali Acc: 0.269 Test Loss: 4.309 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8458306789398193
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.328 Vali Acc: 0.264 Test Loss: 4.328 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9770157337188721
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.340 Vali Acc: 0.264 Test Loss: 4.340 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8429455757141113
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.349 Vali Acc: 0.262 Test Loss: 4.349 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9353840351104736
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.368 Vali Acc: 0.261 Test Loss: 4.368 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.8599095344543457
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.373 Vali Acc: 0.260 Test Loss: 4.373 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.887845516204834
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.376 Vali Acc: 0.271 Test Loss: 4.376 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.062394380569458
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.398 Vali Acc: 0.266 Test Loss: 4.398 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.0623149871826172
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.418 Vali Acc: 0.268 Test Loss: 4.418 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 2076222
model size : 10.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4255383014678955
Epoch: 1, Steps: 10 | Train Loss: 3.488 Vali Loss: 3.331 Vali Acc: 0.036 Test Loss: 3.331 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.8761303424835205
Epoch: 2, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.355 Vali Acc: 0.039 Test Loss: 3.355 Test Acc: 0.039
Validation loss decreased (-0.036437 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 0.8180561065673828
Epoch: 3, Steps: 10 | Train Loss: 3.154 Vali Loss: 3.382 Vali Acc: 0.054 Test Loss: 3.382 Test Acc: 0.054
Validation loss decreased (-0.038790 --> -0.054084).  Saving model ...
Epoch: 4 cost time: 0.862680196762085
Epoch: 4, Steps: 10 | Train Loss: 3.107 Vali Loss: 3.323 Vali Acc: 0.075 Test Loss: 3.323 Test Acc: 0.075
Validation loss decreased (-0.054084 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 0.8395223617553711
Epoch: 5, Steps: 10 | Train Loss: 2.908 Vali Loss: 3.277 Vali Acc: 0.073 Test Loss: 3.277 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8412132263183594
Epoch: 6, Steps: 10 | Train Loss: 2.845 Vali Loss: 3.274 Vali Acc: 0.107 Test Loss: 3.274 Test Acc: 0.107
Validation loss decreased (-0.075261 --> -0.107026).  Saving model ...
Epoch: 7 cost time: 0.8232982158660889
Epoch: 7, Steps: 10 | Train Loss: 2.661 Vali Loss: 3.317 Vali Acc: 0.106 Test Loss: 3.317 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8769357204437256
Epoch: 8, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.243 Vali Acc: 0.120 Test Loss: 3.243 Test Acc: 0.120
Validation loss decreased (-0.107026 --> -0.119968).  Saving model ...
Epoch: 9 cost time: 0.898507833480835
Epoch: 9, Steps: 10 | Train Loss: 2.300 Vali Loss: 3.270 Vali Acc: 0.138 Test Loss: 3.270 Test Acc: 0.138
Validation loss decreased (-0.119968 --> -0.137614).  Saving model ...
Epoch: 10 cost time: 0.8876698017120361
Epoch: 10, Steps: 10 | Train Loss: 2.081 Vali Loss: 3.291 Vali Acc: 0.146 Test Loss: 3.291 Test Acc: 0.146
Validation loss decreased (-0.137614 --> -0.145849).  Saving model ...
Epoch: 11 cost time: 0.875499963760376
Epoch: 11, Steps: 10 | Train Loss: 1.833 Vali Loss: 3.312 Vali Acc: 0.133 Test Loss: 3.312 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8422994613647461
Epoch: 12, Steps: 10 | Train Loss: 1.641 Vali Loss: 3.339 Vali Acc: 0.147 Test Loss: 3.339 Test Acc: 0.147
Validation loss decreased (-0.145849 --> -0.147025).  Saving model ...
Epoch: 13 cost time: 1.0316154956817627
Epoch: 13, Steps: 10 | Train Loss: 1.481 Vali Loss: 3.345 Vali Acc: 0.175 Test Loss: 3.345 Test Acc: 0.175
Validation loss decreased (-0.147025 --> -0.175261).  Saving model ...
Epoch: 14 cost time: 1.0385584831237793
Epoch: 14, Steps: 10 | Train Loss: 1.272 Vali Loss: 3.371 Vali Acc: 0.194 Test Loss: 3.371 Test Acc: 0.194
Validation loss decreased (-0.175261 --> -0.194084).  Saving model ...
Epoch: 15 cost time: 0.8506417274475098
Epoch: 15, Steps: 10 | Train Loss: 1.122 Vali Loss: 3.416 Vali Acc: 0.206 Test Loss: 3.416 Test Acc: 0.206
Validation loss decreased (-0.194084 --> -0.205848).  Saving model ...
Epoch: 16 cost time: 0.8776862621307373
Epoch: 16, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.449 Vali Acc: 0.202 Test Loss: 3.449 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0242266654968262
Epoch: 17, Steps: 10 | Train Loss: 0.776 Vali Loss: 3.479 Vali Acc: 0.219 Test Loss: 3.479 Test Acc: 0.219
Validation loss decreased (-0.205848 --> -0.218789).  Saving model ...
Epoch: 18 cost time: 1.0612053871154785
Epoch: 18, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.485 Vali Acc: 0.229 Test Loss: 3.485 Test Acc: 0.229
Validation loss decreased (-0.218789 --> -0.229377).  Saving model ...
Epoch: 19 cost time: 0.9482996463775635
Epoch: 19, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.696 Vali Acc: 0.207 Test Loss: 3.696 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0457580089569092
Epoch: 20, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.647 Vali Acc: 0.248 Test Loss: 3.647 Test Acc: 0.248
Validation loss decreased (-0.229377 --> -0.248199).  Saving model ...
Epoch: 21 cost time: 0.8907279968261719
Epoch: 21, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.702 Vali Acc: 0.220 Test Loss: 3.702 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0195486545562744
Epoch: 22, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.738 Vali Acc: 0.242 Test Loss: 3.738 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9383714199066162
Epoch: 23, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.903 Vali Acc: 0.212 Test Loss: 3.903 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8097929954528809
Epoch: 24, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.866 Vali Acc: 0.239 Test Loss: 3.866 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9499955177307129
Epoch: 25, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.932 Vali Acc: 0.241 Test Loss: 3.932 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9189016819000244
Epoch: 26, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.020 Vali Acc: 0.249 Test Loss: 4.020 Test Acc: 0.249
Validation loss decreased (-0.248199 --> -0.249372).  Saving model ...
Epoch: 27 cost time: 0.7811880111694336
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.020 Vali Acc: 0.254 Test Loss: 4.020 Test Acc: 0.254
Validation loss decreased (-0.249372 --> -0.254077).  Saving model ...
Epoch: 28 cost time: 0.8826034069061279
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.086 Vali Acc: 0.259 Test Loss: 4.086 Test Acc: 0.259
Validation loss decreased (-0.254077 --> -0.258783).  Saving model ...
Epoch: 29 cost time: 0.960899829864502
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.110 Vali Acc: 0.259 Test Loss: 4.110 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8737025260925293
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.086 Vali Acc: 0.259 Test Loss: 4.086 Test Acc: 0.259
Validation loss decreased (-0.258783 --> -0.258783).  Saving model ...
Epoch: 31 cost time: 0.9038865566253662
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.088 Vali Acc: 0.261 Test Loss: 4.088 Test Acc: 0.261
Validation loss decreased (-0.258783 --> -0.261136).  Saving model ...
Epoch: 32 cost time: 1.100346326828003
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.215 Vali Acc: 0.260 Test Loss: 4.215 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0390794277191162
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.213 Vali Acc: 0.252 Test Loss: 4.213 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.234374761581421
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.187 Vali Acc: 0.259 Test Loss: 4.187 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.83498215675354
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.237 Vali Acc: 0.253 Test Loss: 4.237 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9454772472381592
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.311 Vali Acc: 0.265 Test Loss: 4.311 Test Acc: 0.265
Validation loss decreased (-0.261136 --> -0.264663).  Saving model ...
Epoch: 37 cost time: 0.91178297996521
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.314 Vali Acc: 0.260 Test Loss: 4.314 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0770010948181152
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.284 Vali Acc: 0.260 Test Loss: 4.284 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.963698148727417
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.301 Vali Acc: 0.261 Test Loss: 4.301 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9571244716644287
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.340 Vali Acc: 0.267 Test Loss: 4.340 Test Acc: 0.267
Validation loss decreased (-0.264663 --> -0.267015).  Saving model ...
Epoch: 41 cost time: 0.9579100608825684
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.378 Vali Acc: 0.269 Test Loss: 4.378 Test Acc: 0.269
Validation loss decreased (-0.267015 --> -0.269368).  Saving model ...
Epoch: 42 cost time: 0.8707544803619385
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.400 Vali Acc: 0.262 Test Loss: 4.400 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8847932815551758
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.379 Vali Acc: 0.268 Test Loss: 4.379 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.845404863357544
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.402 Vali Acc: 0.265 Test Loss: 4.402 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.917719841003418
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.426 Vali Acc: 0.267 Test Loss: 4.426 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7362673282623291
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.443 Vali Acc: 0.268 Test Loss: 4.443 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8970725536346436
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.428 Vali Acc: 0.272 Test Loss: 4.428 Test Acc: 0.272
Validation loss decreased (-0.269368 --> -0.271720).  Saving model ...
Epoch: 48 cost time: 0.8473896980285645
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.444 Vali Acc: 0.268 Test Loss: 4.444 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8916347026824951
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.456 Vali Acc: 0.267 Test Loss: 4.456 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8886890411376953
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.474 Vali Acc: 0.269 Test Loss: 4.474 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9645712375640869
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.499 Vali Acc: 0.272 Test Loss: 4.499 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.9796478748321533
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.533 Vali Acc: 0.267 Test Loss: 4.533 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.8999724388122559
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.556 Vali Acc: 0.265 Test Loss: 4.556 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.8800268173217773
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.539 Vali Acc: 0.271 Test Loss: 4.539 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.9588730335235596
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.551 Vali Acc: 0.269 Test Loss: 4.551 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.8950550556182861
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.568 Vali Acc: 0.266 Test Loss: 4.568 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.897010326385498
Epoch: 57, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.562 Vali Acc: 0.267 Test Loss: 4.562 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 2073662
model size : 10.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.127568006515503
Epoch: 1, Steps: 10 | Train Loss: 3.490 Vali Loss: 3.341 Vali Acc: 0.046 Test Loss: 3.341 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.8471693992614746
Epoch: 2, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.385 Vali Acc: 0.046 Test Loss: 3.385 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8759887218475342
Epoch: 3, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.386 Vali Acc: 0.048 Test Loss: 3.386 Test Acc: 0.048
Validation loss decreased (-0.045849 --> -0.048201).  Saving model ...
Epoch: 4 cost time: 0.7794172763824463
Epoch: 4, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.316 Vali Acc: 0.069 Test Loss: 3.316 Test Acc: 0.069
Validation loss decreased (-0.048201 --> -0.069379).  Saving model ...
Epoch: 5 cost time: 0.8414442539215088
Epoch: 5, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.280 Vali Acc: 0.094 Test Loss: 3.280 Test Acc: 0.094
Validation loss decreased (-0.069379 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 0.7387902736663818
Epoch: 6, Steps: 10 | Train Loss: 2.876 Vali Loss: 3.249 Vali Acc: 0.099 Test Loss: 3.249 Test Acc: 0.099
Validation loss decreased (-0.094085 --> -0.098791).  Saving model ...
Epoch: 7 cost time: 0.8517818450927734
Epoch: 7, Steps: 10 | Train Loss: 2.739 Vali Loss: 3.216 Vali Acc: 0.122 Test Loss: 3.216 Test Acc: 0.122
Validation loss decreased (-0.098791 --> -0.122321).  Saving model ...
Epoch: 8 cost time: 0.8077189922332764
Epoch: 8, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.269 Vali Acc: 0.118 Test Loss: 3.269 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8697702884674072
Epoch: 9, Steps: 10 | Train Loss: 2.360 Vali Loss: 3.204 Vali Acc: 0.141 Test Loss: 3.204 Test Acc: 0.141
Validation loss decreased (-0.122321 --> -0.141144).  Saving model ...
Epoch: 10 cost time: 0.8836302757263184
Epoch: 10, Steps: 10 | Train Loss: 2.127 Vali Loss: 3.266 Vali Acc: 0.144 Test Loss: 3.266 Test Acc: 0.144
Validation loss decreased (-0.141144 --> -0.143497).  Saving model ...
Epoch: 11 cost time: 0.9329628944396973
Epoch: 11, Steps: 10 | Train Loss: 1.920 Vali Loss: 3.218 Vali Acc: 0.172 Test Loss: 3.218 Test Acc: 0.172
Validation loss decreased (-0.143497 --> -0.171733).  Saving model ...
Epoch: 12 cost time: 0.9510452747344971
Epoch: 12, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.274 Vali Acc: 0.172 Test Loss: 3.274 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9226388931274414
Epoch: 13, Steps: 10 | Train Loss: 1.547 Vali Loss: 3.330 Vali Acc: 0.182 Test Loss: 3.330 Test Acc: 0.182
Validation loss decreased (-0.171733 --> -0.182320).  Saving model ...
Epoch: 14 cost time: 0.9288558959960938
Epoch: 14, Steps: 10 | Train Loss: 1.291 Vali Loss: 3.322 Vali Acc: 0.205 Test Loss: 3.322 Test Acc: 0.205
Validation loss decreased (-0.182320 --> -0.204673).  Saving model ...
Epoch: 15 cost time: 0.9147939682006836
Epoch: 15, Steps: 10 | Train Loss: 1.136 Vali Loss: 3.387 Vali Acc: 0.204 Test Loss: 3.387 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9795758724212646
Epoch: 16, Steps: 10 | Train Loss: 0.932 Vali Loss: 3.389 Vali Acc: 0.211 Test Loss: 3.389 Test Acc: 0.211
Validation loss decreased (-0.204673 --> -0.210554).  Saving model ...
Epoch: 17 cost time: 0.890131950378418
Epoch: 17, Steps: 10 | Train Loss: 0.788 Vali Loss: 3.461 Vali Acc: 0.227 Test Loss: 3.461 Test Acc: 0.227
Validation loss decreased (-0.210554 --> -0.227024).  Saving model ...
Epoch: 18 cost time: 0.8890719413757324
Epoch: 18, Steps: 10 | Train Loss: 0.645 Vali Loss: 3.579 Vali Acc: 0.206 Test Loss: 3.579 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9300367832183838
Epoch: 19, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.587 Vali Acc: 0.232 Test Loss: 3.587 Test Acc: 0.232
Validation loss decreased (-0.227024 --> -0.231729).  Saving model ...
Epoch: 20 cost time: 0.8173537254333496
Epoch: 20, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.633 Vali Acc: 0.233 Test Loss: 3.633 Test Acc: 0.233
Validation loss decreased (-0.231729 --> -0.232905).  Saving model ...
Epoch: 21 cost time: 0.8975582122802734
Epoch: 21, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.734 Vali Acc: 0.231 Test Loss: 3.734 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8513433933258057
Epoch: 22, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.772 Vali Acc: 0.241 Test Loss: 3.772 Test Acc: 0.241
Validation loss decreased (-0.232905 --> -0.241139).  Saving model ...
Epoch: 23 cost time: 0.8938486576080322
Epoch: 23, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.852 Vali Acc: 0.246 Test Loss: 3.852 Test Acc: 0.246
Validation loss decreased (-0.241139 --> -0.245844).  Saving model ...
Epoch: 24 cost time: 0.9024193286895752
Epoch: 24, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.963 Vali Acc: 0.220 Test Loss: 3.963 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9114751815795898
Epoch: 25, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.926 Vali Acc: 0.244 Test Loss: 3.926 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9801638126373291
Epoch: 26, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.106 Vali Acc: 0.238 Test Loss: 4.106 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9018828868865967
Epoch: 27, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.061 Vali Acc: 0.242 Test Loss: 4.061 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8665318489074707
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.087 Vali Acc: 0.247 Test Loss: 4.087 Test Acc: 0.247
Validation loss decreased (-0.245844 --> -0.247018).  Saving model ...
Epoch: 29 cost time: 0.8679511547088623
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.129 Vali Acc: 0.253 Test Loss: 4.129 Test Acc: 0.253
Validation loss decreased (-0.247018 --> -0.252900).  Saving model ...
Epoch: 30 cost time: 1.0439963340759277
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.146 Vali Acc: 0.253 Test Loss: 4.146 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.852351188659668
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.157 Vali Acc: 0.249 Test Loss: 4.157 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9322783946990967
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.179 Vali Acc: 0.262 Test Loss: 4.179 Test Acc: 0.262
Validation loss decreased (-0.252900 --> -0.262311).  Saving model ...
Epoch: 33 cost time: 0.8582959175109863
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.177 Vali Acc: 0.262 Test Loss: 4.177 Test Acc: 0.262
Validation loss decreased (-0.262311 --> -0.262311).  Saving model ...
Epoch: 34 cost time: 0.8549904823303223
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.225 Vali Acc: 0.266 Test Loss: 4.225 Test Acc: 0.266
Validation loss decreased (-0.262311 --> -0.265840).  Saving model ...
Epoch: 35 cost time: 0.9169013500213623
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.256 Vali Acc: 0.256 Test Loss: 4.256 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8467164039611816
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.265 Vali Acc: 0.258 Test Loss: 4.265 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9953525066375732
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.286 Vali Acc: 0.256 Test Loss: 4.286 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9853460788726807
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.309 Vali Acc: 0.260 Test Loss: 4.309 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9859714508056641
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.310 Vali Acc: 0.258 Test Loss: 4.310 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1175081729888916
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.315 Vali Acc: 0.265 Test Loss: 4.315 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9027714729309082
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.335 Vali Acc: 0.265 Test Loss: 4.335 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.0653741359710693
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.343 Vali Acc: 0.260 Test Loss: 4.343 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8606646060943604
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.366 Vali Acc: 0.265 Test Loss: 4.366 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9649779796600342
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.380 Vali Acc: 0.266 Test Loss: 4.380 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 2071102
model size : 10.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.615496873855591
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.302 Vali Acc: 0.036 Test Loss: 3.302 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 2.2754299640655518
Epoch: 2, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.346 Vali Acc: 0.046 Test Loss: 3.346 Test Acc: 0.046
Validation loss decreased (-0.036438 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 1.2023303508758545
Epoch: 3, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.348 Vali Acc: 0.061 Test Loss: 3.348 Test Acc: 0.061
Validation loss decreased (-0.045849 --> -0.061143).  Saving model ...
Epoch: 4 cost time: 1.2984130382537842
Epoch: 4, Steps: 10 | Train Loss: 3.104 Vali Loss: 3.308 Vali Acc: 0.076 Test Loss: 3.308 Test Acc: 0.076
Validation loss decreased (-0.061143 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 1.4270381927490234
Epoch: 5, Steps: 10 | Train Loss: 3.034 Vali Loss: 3.277 Vali Acc: 0.062 Test Loss: 3.277 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0736069679260254
Epoch: 6, Steps: 10 | Train Loss: 2.879 Vali Loss: 3.264 Vali Acc: 0.099 Test Loss: 3.264 Test Acc: 0.099
Validation loss decreased (-0.076438 --> -0.098791).  Saving model ...
Epoch: 7 cost time: 1.1905162334442139
Epoch: 7, Steps: 10 | Train Loss: 2.764 Vali Loss: 3.250 Vali Acc: 0.113 Test Loss: 3.250 Test Acc: 0.113
Validation loss decreased (-0.098791 --> -0.112909).  Saving model ...
Epoch: 8 cost time: 1.1194336414337158
Epoch: 8, Steps: 10 | Train Loss: 2.519 Vali Loss: 3.230 Vali Acc: 0.140 Test Loss: 3.230 Test Acc: 0.140
Validation loss decreased (-0.112909 --> -0.139968).  Saving model ...
Epoch: 9 cost time: 1.2234299182891846
Epoch: 9, Steps: 10 | Train Loss: 2.380 Vali Loss: 3.221 Vali Acc: 0.135 Test Loss: 3.221 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1966471672058105
Epoch: 10, Steps: 10 | Train Loss: 2.162 Vali Loss: 3.222 Vali Acc: 0.164 Test Loss: 3.222 Test Acc: 0.164
Validation loss decreased (-0.139968 --> -0.163497).  Saving model ...
Epoch: 11 cost time: 1.3358395099639893
Epoch: 11, Steps: 10 | Train Loss: 1.946 Vali Loss: 3.229 Vali Acc: 0.173 Test Loss: 3.229 Test Acc: 0.173
Validation loss decreased (-0.163497 --> -0.172909).  Saving model ...
Epoch: 12 cost time: 1.1167848110198975
Epoch: 12, Steps: 10 | Train Loss: 1.802 Vali Loss: 3.260 Vali Acc: 0.176 Test Loss: 3.260 Test Acc: 0.176
Validation loss decreased (-0.172909 --> -0.176438).  Saving model ...
Epoch: 13 cost time: 1.1564550399780273
Epoch: 13, Steps: 10 | Train Loss: 1.559 Vali Loss: 3.245 Vali Acc: 0.194 Test Loss: 3.245 Test Acc: 0.194
Validation loss decreased (-0.176438 --> -0.194085).  Saving model ...
Epoch: 14 cost time: 1.3516230583190918
Epoch: 14, Steps: 10 | Train Loss: 1.381 Vali Loss: 3.297 Vali Acc: 0.216 Test Loss: 3.297 Test Acc: 0.216
Validation loss decreased (-0.194085 --> -0.216438).  Saving model ...
Epoch: 15 cost time: 1.0666959285736084
Epoch: 15, Steps: 10 | Train Loss: 1.190 Vali Loss: 3.375 Vali Acc: 0.206 Test Loss: 3.375 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0980453491210938
Epoch: 16, Steps: 10 | Train Loss: 1.055 Vali Loss: 3.353 Vali Acc: 0.226 Test Loss: 3.353 Test Acc: 0.226
Validation loss decreased (-0.216438 --> -0.225849).  Saving model ...
Epoch: 17 cost time: 1.1496367454528809
Epoch: 17, Steps: 10 | Train Loss: 0.874 Vali Loss: 3.416 Vali Acc: 0.211 Test Loss: 3.416 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1052355766296387
Epoch: 18, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.470 Vali Acc: 0.234 Test Loss: 3.470 Test Acc: 0.234
Validation loss decreased (-0.225849 --> -0.234083).  Saving model ...
Epoch: 19 cost time: 1.0268893241882324
Epoch: 19, Steps: 10 | Train Loss: 0.561 Vali Loss: 3.564 Vali Acc: 0.235 Test Loss: 3.564 Test Acc: 0.235
Validation loss decreased (-0.234083 --> -0.235258).  Saving model ...
Epoch: 20 cost time: 1.1294074058532715
Epoch: 20, Steps: 10 | Train Loss: 0.513 Vali Loss: 3.523 Vali Acc: 0.227 Test Loss: 3.523 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0881438255310059
Epoch: 21, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.722 Vali Acc: 0.226 Test Loss: 3.722 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2647438049316406
Epoch: 22, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.695 Vali Acc: 0.225 Test Loss: 3.695 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0229928493499756
Epoch: 23, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.780 Vali Acc: 0.234 Test Loss: 3.780 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5652406215667725
Epoch: 24, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.962 Vali Acc: 0.214 Test Loss: 3.962 Test Acc: 0.214
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1193063259124756
Epoch: 25, Steps: 10 | Train Loss: 0.180 Vali Loss: 4.066 Vali Acc: 0.221 Test Loss: 4.066 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2986037731170654
Epoch: 26, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.960 Vali Acc: 0.238 Test Loss: 3.960 Test Acc: 0.238
Validation loss decreased (-0.235258 --> -0.237607).  Saving model ...
Epoch: 27 cost time: 1.2451205253601074
Epoch: 27, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.120 Vali Acc: 0.244 Test Loss: 4.120 Test Acc: 0.244
Validation loss decreased (-0.237607 --> -0.243488).  Saving model ...
Epoch: 28 cost time: 1.140507698059082
Epoch: 28, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.074 Vali Acc: 0.266 Test Loss: 4.074 Test Acc: 0.266
Validation loss decreased (-0.243488 --> -0.265842).  Saving model ...
Epoch: 29 cost time: 1.3466458320617676
Epoch: 29, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.031 Vali Acc: 0.260 Test Loss: 4.031 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3973829746246338
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.110 Vali Acc: 0.264 Test Loss: 4.110 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4158616065979004
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.138 Vali Acc: 0.256 Test Loss: 4.138 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.9076271057128906
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.141 Vali Acc: 0.260 Test Loss: 4.141 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5378525257110596
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.148 Vali Acc: 0.258 Test Loss: 4.148 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5230019092559814
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.171 Vali Acc: 0.259 Test Loss: 4.171 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.265385627746582
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.189 Vali Acc: 0.267 Test Loss: 4.189 Test Acc: 0.267
Validation loss decreased (-0.265842 --> -0.267017).  Saving model ...
Epoch: 36 cost time: 1.35676908493042
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.218 Vali Acc: 0.260 Test Loss: 4.218 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.186359167098999
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.242 Vali Acc: 0.262 Test Loss: 4.242 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3181397914886475
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.263 Vali Acc: 0.267 Test Loss: 4.263 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5958142280578613
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.274 Vali Acc: 0.264 Test Loss: 4.274 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2659752368927002
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.298 Vali Acc: 0.259 Test Loss: 4.298 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3789947032928467
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.333 Vali Acc: 0.264 Test Loss: 4.333 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3857288360595703
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.316 Vali Acc: 0.268 Test Loss: 4.316 Test Acc: 0.268
Validation loss decreased (-0.267017 --> -0.268192).  Saving model ...
Epoch: 43 cost time: 1.5621817111968994
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.332 Vali Acc: 0.271 Test Loss: 4.332 Test Acc: 0.271
Validation loss decreased (-0.268192 --> -0.270545).  Saving model ...
Epoch: 44 cost time: 2.537438154220581
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.349 Vali Acc: 0.264 Test Loss: 4.349 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.543790578842163
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.347 Vali Acc: 0.269 Test Loss: 4.347 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.445066213607788
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.377 Vali Acc: 0.266 Test Loss: 4.377 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.833932876586914
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.415 Vali Acc: 0.266 Test Loss: 4.415 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.2714893817901611
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.421 Vali Acc: 0.266 Test Loss: 4.421 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.5177431106567383
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.418 Vali Acc: 0.265 Test Loss: 4.418 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.6388237476348877
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.436 Vali Acc: 0.271 Test Loss: 4.436 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.8393909931182861
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.470 Vali Acc: 0.266 Test Loss: 4.470 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.7598381042480469
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.455 Vali Acc: 0.261 Test Loss: 4.455 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.7628397941589355
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.461 Vali Acc: 0.267 Test Loss: 4.461 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 1749822
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.922865867614746
Epoch: 1, Steps: 10 | Train Loss: 3.364 Vali Loss: 3.318 Vali Acc: 0.049 Test Loss: 3.318 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.369584083557129
Epoch: 2, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.394 Vali Acc: 0.038 Test Loss: 3.394 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2883195877075195
Epoch: 3, Steps: 10 | Train Loss: 3.178 Vali Loss: 3.384 Vali Acc: 0.068 Test Loss: 3.384 Test Acc: 0.068
Validation loss decreased (-0.049379 --> -0.068201).  Saving model ...
Epoch: 4 cost time: 1.4746406078338623
Epoch: 4, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.329 Vali Acc: 0.074 Test Loss: 3.329 Test Acc: 0.074
Validation loss decreased (-0.068201 --> -0.074084).  Saving model ...
Epoch: 5 cost time: 1.470764398574829
Epoch: 5, Steps: 10 | Train Loss: 2.967 Vali Loss: 3.314 Vali Acc: 0.078 Test Loss: 3.314 Test Acc: 0.078
Validation loss decreased (-0.074084 --> -0.077614).  Saving model ...
Epoch: 6 cost time: 1.3644797801971436
Epoch: 6, Steps: 10 | Train Loss: 2.813 Vali Loss: 3.272 Vali Acc: 0.086 Test Loss: 3.272 Test Acc: 0.086
Validation loss decreased (-0.077614 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 1.4255597591400146
Epoch: 7, Steps: 10 | Train Loss: 2.662 Vali Loss: 3.249 Vali Acc: 0.106 Test Loss: 3.249 Test Acc: 0.106
Validation loss decreased (-0.085850 --> -0.105850).  Saving model ...
Epoch: 8 cost time: 1.5726337432861328
Epoch: 8, Steps: 10 | Train Loss: 2.495 Vali Loss: 3.260 Vali Acc: 0.099 Test Loss: 3.260 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6134154796600342
Epoch: 9, Steps: 10 | Train Loss: 2.313 Vali Loss: 3.240 Vali Acc: 0.121 Test Loss: 3.240 Test Acc: 0.121
Validation loss decreased (-0.105850 --> -0.121144).  Saving model ...
Epoch: 10 cost time: 1.279942274093628
Epoch: 10, Steps: 10 | Train Loss: 2.077 Vali Loss: 3.231 Vali Acc: 0.138 Test Loss: 3.231 Test Acc: 0.138
Validation loss decreased (-0.121144 --> -0.137615).  Saving model ...
Epoch: 11 cost time: 1.2909462451934814
Epoch: 11, Steps: 10 | Train Loss: 1.967 Vali Loss: 3.269 Vali Acc: 0.147 Test Loss: 3.269 Test Acc: 0.147
Validation loss decreased (-0.137615 --> -0.147026).  Saving model ...
Epoch: 12 cost time: 1.3526296615600586
Epoch: 12, Steps: 10 | Train Loss: 1.726 Vali Loss: 3.253 Vali Acc: 0.160 Test Loss: 3.253 Test Acc: 0.160
Validation loss decreased (-0.147026 --> -0.159967).  Saving model ...
Epoch: 13 cost time: 1.4231774806976318
Epoch: 13, Steps: 10 | Train Loss: 1.580 Vali Loss: 3.342 Vali Acc: 0.169 Test Loss: 3.342 Test Acc: 0.169
Validation loss decreased (-0.159967 --> -0.169378).  Saving model ...
Epoch: 14 cost time: 1.3258187770843506
Epoch: 14, Steps: 10 | Train Loss: 1.365 Vali Loss: 3.362 Vali Acc: 0.162 Test Loss: 3.362 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2716646194458008
Epoch: 15, Steps: 10 | Train Loss: 1.146 Vali Loss: 3.331 Vali Acc: 0.195 Test Loss: 3.331 Test Acc: 0.195
Validation loss decreased (-0.169378 --> -0.195261).  Saving model ...
Epoch: 16 cost time: 1.57542085647583
Epoch: 16, Steps: 10 | Train Loss: 0.998 Vali Loss: 3.405 Vali Acc: 0.204 Test Loss: 3.405 Test Acc: 0.204
Validation loss decreased (-0.195261 --> -0.203495).  Saving model ...
Epoch: 17 cost time: 1.323028564453125
Epoch: 17, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.431 Vali Acc: 0.209 Test Loss: 3.431 Test Acc: 0.209
Validation loss decreased (-0.203495 --> -0.209377).  Saving model ...
Epoch: 18 cost time: 1.6883420944213867
Epoch: 18, Steps: 10 | Train Loss: 0.681 Vali Loss: 3.513 Vali Acc: 0.216 Test Loss: 3.513 Test Acc: 0.216
Validation loss decreased (-0.209377 --> -0.216435).  Saving model ...
Epoch: 19 cost time: 1.5644030570983887
Epoch: 19, Steps: 10 | Train Loss: 0.562 Vali Loss: 3.514 Vali Acc: 0.224 Test Loss: 3.514 Test Acc: 0.224
Validation loss decreased (-0.216435 --> -0.223494).  Saving model ...
Epoch: 20 cost time: 1.456618309020996
Epoch: 20, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.634 Vali Acc: 0.215 Test Loss: 3.634 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5329813957214355
Epoch: 21, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.672 Vali Acc: 0.214 Test Loss: 3.672 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.455115795135498
Epoch: 22, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.695 Vali Acc: 0.227 Test Loss: 3.695 Test Acc: 0.227
Validation loss decreased (-0.223494 --> -0.227022).  Saving model ...
Epoch: 23 cost time: 1.3206613063812256
Epoch: 23, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.818 Vali Acc: 0.215 Test Loss: 3.818 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8219046592712402
Epoch: 24, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.831 Vali Acc: 0.235 Test Loss: 3.831 Test Acc: 0.235
Validation loss decreased (-0.227022 --> -0.235256).  Saving model ...
Epoch: 25 cost time: 1.4671788215637207
Epoch: 25, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.915 Vali Acc: 0.229 Test Loss: 3.915 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6691303253173828
Epoch: 26, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.007 Vali Acc: 0.228 Test Loss: 4.007 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3669142723083496
Epoch: 27, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.944 Vali Acc: 0.234 Test Loss: 3.944 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3716044425964355
Epoch: 28, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.941 Vali Acc: 0.240 Test Loss: 3.941 Test Acc: 0.240
Validation loss decreased (-0.235256 --> -0.239961).  Saving model ...
Epoch: 29 cost time: 1.501512050628662
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.072 Vali Acc: 0.236 Test Loss: 4.072 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4910848140716553
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.056 Vali Acc: 0.248 Test Loss: 4.056 Test Acc: 0.248
Validation loss decreased (-0.239961 --> -0.248195).  Saving model ...
Epoch: 31 cost time: 1.145780086517334
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.123 Vali Acc: 0.242 Test Loss: 4.123 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5801327228546143
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.070 Vali Acc: 0.247 Test Loss: 4.070 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7958641052246094
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.104 Vali Acc: 0.256 Test Loss: 4.104 Test Acc: 0.256
Validation loss decreased (-0.248195 --> -0.256430).  Saving model ...
Epoch: 34 cost time: 1.2233569622039795
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.152 Vali Acc: 0.259 Test Loss: 4.152 Test Acc: 0.259
Validation loss decreased (-0.256430 --> -0.258782).  Saving model ...
Epoch: 35 cost time: 1.6017017364501953
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.157 Vali Acc: 0.268 Test Loss: 4.157 Test Acc: 0.268
Validation loss decreased (-0.258782 --> -0.268194).  Saving model ...
Epoch: 36 cost time: 1.3701786994934082
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.168 Vali Acc: 0.261 Test Loss: 4.168 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.671344518661499
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.190 Vali Acc: 0.264 Test Loss: 4.190 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.426701545715332
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.210 Vali Acc: 0.261 Test Loss: 4.210 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5287902355194092
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.221 Vali Acc: 0.265 Test Loss: 4.221 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.4644503593444824
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.222 Vali Acc: 0.265 Test Loss: 4.222 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.4564354419708252
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.245 Vali Acc: 0.267 Test Loss: 4.245 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3222441673278809
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.266 Vali Acc: 0.269 Test Loss: 4.266 Test Acc: 0.269
Validation loss decreased (-0.268194 --> -0.269369).  Saving model ...
Epoch: 43 cost time: 1.1663827896118164
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.280 Vali Acc: 0.265 Test Loss: 4.280 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.5148470401763916
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.297 Vali Acc: 0.264 Test Loss: 4.297 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.5633468627929688
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.317 Vali Acc: 0.265 Test Loss: 4.317 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.4912450313568115
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.331 Vali Acc: 0.266 Test Loss: 4.331 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.347424030303955
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.343 Vali Acc: 0.268 Test Loss: 4.343 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.4856433868408203
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.347 Vali Acc: 0.271 Test Loss: 4.347 Test Acc: 0.271
Validation loss decreased (-0.269369 --> -0.270545).  Saving model ...
Epoch: 49 cost time: 1.635538101196289
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.359 Vali Acc: 0.271 Test Loss: 4.359 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.4576785564422607
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.363 Vali Acc: 0.272 Test Loss: 4.363 Test Acc: 0.272
Validation loss decreased (-0.270545 --> -0.271721).  Saving model ...
Epoch: 51 cost time: 1.3370931148529053
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.384 Vali Acc: 0.271 Test Loss: 4.384 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.4466853141784668
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.422 Vali Acc: 0.271 Test Loss: 4.422 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.6889514923095703
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.424 Vali Acc: 0.267 Test Loss: 4.424 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.3766448497772217
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.432 Vali Acc: 0.267 Test Loss: 4.432 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.313133716583252
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.434 Vali Acc: 0.271 Test Loss: 4.434 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.3747844696044922
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.436 Vali Acc: 0.268 Test Loss: 4.436 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.4598071575164795
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.464 Vali Acc: 0.268 Test Loss: 4.464 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.7234039306640625
Epoch: 58, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.467 Vali Acc: 0.273 Test Loss: 4.467 Test Acc: 0.273
Validation loss decreased (-0.271721 --> -0.272897).  Saving model ...
Epoch: 59 cost time: 1.5919523239135742
Epoch: 59, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.475 Vali Acc: 0.271 Test Loss: 4.475 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.3686902523040771
Epoch: 60, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.476 Vali Acc: 0.273 Test Loss: 4.476 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.3860650062561035
Epoch: 61, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.488 Vali Acc: 0.271 Test Loss: 4.488 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.32267165184021
Epoch: 62, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.495 Vali Acc: 0.275 Test Loss: 4.495 Test Acc: 0.275
Validation loss decreased (-0.272897 --> -0.275249).  Saving model ...
Epoch: 63 cost time: 1.3497850894927979
Epoch: 63, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.506 Vali Acc: 0.269 Test Loss: 4.506 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.3279132843017578
Epoch: 64, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.524 Vali Acc: 0.269 Test Loss: 4.524 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.424741506576538
Epoch: 65, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.539 Vali Acc: 0.268 Test Loss: 4.539 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.580132246017456
Epoch: 66, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.538 Vali Acc: 0.272 Test Loss: 4.538 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.7152671813964844
Epoch: 67, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.533 Vali Acc: 0.276 Test Loss: 4.533 Test Acc: 0.276
Validation loss decreased (-0.275249 --> -0.276425).  Saving model ...
Epoch: 68 cost time: 1.4468238353729248
Epoch: 68, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.547 Vali Acc: 0.273 Test Loss: 4.547 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.9098546504974365
Epoch: 69, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.558 Vali Acc: 0.273 Test Loss: 4.558 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.5323500633239746
Epoch: 70, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.563 Vali Acc: 0.271 Test Loss: 4.563 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.4450266361236572
Epoch: 71, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.583 Vali Acc: 0.276 Test Loss: 4.583 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.608461618423462
Epoch: 72, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.593 Vali Acc: 0.269 Test Loss: 4.593 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.7615864276885986
Epoch: 73, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.584 Vali Acc: 0.272 Test Loss: 4.584 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.6694397926330566
Epoch: 74, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.592 Vali Acc: 0.273 Test Loss: 4.592 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.4220271110534668
Epoch: 75, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.600 Vali Acc: 0.272 Test Loss: 4.600 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.8186285495758057
Epoch: 76, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.612 Vali Acc: 0.272 Test Loss: 4.612 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.3999221324920654
Epoch: 77, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.622 Vali Acc: 0.273 Test Loss: 4.622 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 1747262
model size : 9.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4418563842773438
Epoch: 1, Steps: 10 | Train Loss: 3.426 Vali Loss: 3.407 Vali Acc: 0.038 Test Loss: 3.407 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 1.2260282039642334
Epoch: 2, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.314 Vali Acc: 0.041 Test Loss: 3.314 Test Acc: 0.041
Validation loss decreased (-0.037613 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 1.2773258686065674
Epoch: 3, Steps: 10 | Train Loss: 3.189 Vali Loss: 3.331 Vali Acc: 0.061 Test Loss: 3.331 Test Acc: 0.061
Validation loss decreased (-0.041143 --> -0.061143).  Saving model ...
Epoch: 4 cost time: 1.4314849376678467
Epoch: 4, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.356 Vali Acc: 0.038 Test Loss: 3.356 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4198837280273438
Epoch: 5, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.297 Vali Acc: 0.085 Test Loss: 3.297 Test Acc: 0.085
Validation loss decreased (-0.061143 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 1.3030729293823242
Epoch: 6, Steps: 10 | Train Loss: 2.891 Vali Loss: 3.295 Vali Acc: 0.100 Test Loss: 3.295 Test Acc: 0.100
Validation loss decreased (-0.084673 --> -0.099967).  Saving model ...
Epoch: 7 cost time: 1.4845187664031982
Epoch: 7, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.254 Vali Acc: 0.107 Test Loss: 3.254 Test Acc: 0.107
Validation loss decreased (-0.099967 --> -0.107026).  Saving model ...
Epoch: 8 cost time: 1.2630174160003662
Epoch: 8, Steps: 10 | Train Loss: 2.553 Vali Loss: 3.244 Vali Acc: 0.112 Test Loss: 3.244 Test Acc: 0.112
Validation loss decreased (-0.107026 --> -0.111732).  Saving model ...
Epoch: 9 cost time: 1.2657418251037598
Epoch: 9, Steps: 10 | Train Loss: 2.363 Vali Loss: 3.270 Vali Acc: 0.109 Test Loss: 3.270 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.245270013809204
Epoch: 10, Steps: 10 | Train Loss: 2.102 Vali Loss: 3.245 Vali Acc: 0.142 Test Loss: 3.245 Test Acc: 0.142
Validation loss decreased (-0.111732 --> -0.142320).  Saving model ...
Epoch: 11 cost time: 1.4883744716644287
Epoch: 11, Steps: 10 | Train Loss: 1.987 Vali Loss: 3.240 Vali Acc: 0.156 Test Loss: 3.240 Test Acc: 0.156
Validation loss decreased (-0.142320 --> -0.156438).  Saving model ...
Epoch: 12 cost time: 1.3890833854675293
Epoch: 12, Steps: 10 | Train Loss: 1.778 Vali Loss: 3.306 Vali Acc: 0.161 Test Loss: 3.306 Test Acc: 0.161
Validation loss decreased (-0.156438 --> -0.161143).  Saving model ...
Epoch: 13 cost time: 1.3855342864990234
Epoch: 13, Steps: 10 | Train Loss: 1.579 Vali Loss: 3.324 Vali Acc: 0.169 Test Loss: 3.324 Test Acc: 0.169
Validation loss decreased (-0.161143 --> -0.169379).  Saving model ...
Epoch: 14 cost time: 1.4158453941345215
Epoch: 14, Steps: 10 | Train Loss: 1.326 Vali Loss: 3.346 Vali Acc: 0.195 Test Loss: 3.346 Test Acc: 0.195
Validation loss decreased (-0.169379 --> -0.195261).  Saving model ...
Epoch: 15 cost time: 1.2704570293426514
Epoch: 15, Steps: 10 | Train Loss: 1.205 Vali Loss: 3.375 Vali Acc: 0.209 Test Loss: 3.375 Test Acc: 0.209
Validation loss decreased (-0.195261 --> -0.209378).  Saving model ...
Epoch: 16 cost time: 1.2352490425109863
Epoch: 16, Steps: 10 | Train Loss: 1.079 Vali Loss: 3.425 Vali Acc: 0.212 Test Loss: 3.425 Test Acc: 0.212
Validation loss decreased (-0.209378 --> -0.211730).  Saving model ...
Epoch: 17 cost time: 1.162954568862915
Epoch: 17, Steps: 10 | Train Loss: 0.884 Vali Loss: 3.456 Vali Acc: 0.218 Test Loss: 3.456 Test Acc: 0.218
Validation loss decreased (-0.211730 --> -0.217613).  Saving model ...
Epoch: 18 cost time: 1.4754760265350342
Epoch: 18, Steps: 10 | Train Loss: 0.717 Vali Loss: 3.547 Vali Acc: 0.205 Test Loss: 3.547 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4245398044586182
Epoch: 19, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.538 Vali Acc: 0.239 Test Loss: 3.538 Test Acc: 0.239
Validation loss decreased (-0.217613 --> -0.238788).  Saving model ...
Epoch: 20 cost time: 1.2465856075286865
Epoch: 20, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.622 Vali Acc: 0.233 Test Loss: 3.622 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2742536067962646
Epoch: 21, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.644 Vali Acc: 0.236 Test Loss: 3.644 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5191829204559326
Epoch: 22, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.743 Vali Acc: 0.238 Test Loss: 3.743 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3861720561981201
Epoch: 23, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.772 Vali Acc: 0.240 Test Loss: 3.772 Test Acc: 0.240
Validation loss decreased (-0.238788 --> -0.239962).  Saving model ...
Epoch: 24 cost time: 1.2471332550048828
Epoch: 24, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.899 Vali Acc: 0.246 Test Loss: 3.899 Test Acc: 0.246
Validation loss decreased (-0.239962 --> -0.245843).  Saving model ...
Epoch: 25 cost time: 1.370631456375122
Epoch: 25, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.004 Vali Acc: 0.227 Test Loss: 4.004 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.349510908126831
Epoch: 26, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.992 Vali Acc: 0.254 Test Loss: 3.992 Test Acc: 0.254
Validation loss decreased (-0.245843 --> -0.254078).  Saving model ...
Epoch: 27 cost time: 1.4670109748840332
Epoch: 27, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.960 Vali Acc: 0.272 Test Loss: 3.960 Test Acc: 0.272
Validation loss decreased (-0.254078 --> -0.271725).  Saving model ...
Epoch: 28 cost time: 1.243821382522583
Epoch: 28, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.023 Vali Acc: 0.259 Test Loss: 4.023 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4795341491699219
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.047 Vali Acc: 0.262 Test Loss: 4.047 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5008091926574707
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.044 Vali Acc: 0.268 Test Loss: 4.044 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2547929286956787
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.070 Vali Acc: 0.275 Test Loss: 4.070 Test Acc: 0.275
Validation loss decreased (-0.271725 --> -0.275253).  Saving model ...
Epoch: 32 cost time: 1.2222187519073486
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.181 Vali Acc: 0.264 Test Loss: 4.181 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2484190464019775
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.152 Vali Acc: 0.266 Test Loss: 4.152 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4165687561035156
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.150 Vali Acc: 0.267 Test Loss: 4.150 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2725059986114502
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.198 Vali Acc: 0.264 Test Loss: 4.198 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.6338162422180176
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.228 Vali Acc: 0.275 Test Loss: 4.228 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.6114089488983154
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.245 Vali Acc: 0.273 Test Loss: 4.245 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.510542869567871
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.244 Vali Acc: 0.276 Test Loss: 4.244 Test Acc: 0.276
Validation loss decreased (-0.275253 --> -0.276428).  Saving model ...
Epoch: 39 cost time: 1.341158390045166
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.280 Vali Acc: 0.265 Test Loss: 4.280 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5453987121582031
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.269 Vali Acc: 0.278 Test Loss: 4.269 Test Acc: 0.278
Validation loss decreased (-0.276428 --> -0.277604).  Saving model ...
Epoch: 41 cost time: 1.4437198638916016
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.306 Vali Acc: 0.273 Test Loss: 4.306 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3254451751708984
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.308 Vali Acc: 0.274 Test Loss: 4.308 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.478489875793457
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.320 Vali Acc: 0.269 Test Loss: 4.320 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5513975620269775
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.324 Vali Acc: 0.273 Test Loss: 4.324 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.355853796005249
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.325 Vali Acc: 0.276 Test Loss: 4.325 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.4418232440948486
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.334 Vali Acc: 0.282 Test Loss: 4.334 Test Acc: 0.282
Validation loss decreased (-0.277604 --> -0.282310).  Saving model ...
Epoch: 47 cost time: 1.7894237041473389
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.362 Vali Acc: 0.286 Test Loss: 4.362 Test Acc: 0.286
Validation loss decreased (-0.282310 --> -0.285839).  Saving model ...
Epoch: 48 cost time: 1.3889822959899902
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.367 Vali Acc: 0.285 Test Loss: 4.367 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.3259913921356201
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.380 Vali Acc: 0.286 Test Loss: 4.380 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.354985237121582
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.405 Vali Acc: 0.286 Test Loss: 4.405 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.3454971313476562
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.420 Vali Acc: 0.287 Test Loss: 4.420 Test Acc: 0.287
Validation loss decreased (-0.285839 --> -0.287015).  Saving model ...
Epoch: 52 cost time: 1.3695671558380127
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.430 Vali Acc: 0.286 Test Loss: 4.430 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.395524024963379
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.432 Vali Acc: 0.280 Test Loss: 4.432 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.4641313552856445
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.428 Vali Acc: 0.284 Test Loss: 4.428 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.3518006801605225
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.446 Vali Acc: 0.280 Test Loss: 4.446 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.513420820236206
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.480 Vali Acc: 0.272 Test Loss: 4.480 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.4467158317565918
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.491 Vali Acc: 0.276 Test Loss: 4.491 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.6512811183929443
Epoch: 58, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.493 Vali Acc: 0.282 Test Loss: 4.493 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.314540147781372
Epoch: 59, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.507 Vali Acc: 0.282 Test Loss: 4.507 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.5152857303619385
Epoch: 60, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.520 Vali Acc: 0.280 Test Loss: 4.520 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.4801387786865234
Epoch: 61, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.516 Vali Acc: 0.279 Test Loss: 4.516 Test Acc: 0.279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 1744702
model size : 9.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6899607181549072
Epoch: 1, Steps: 10 | Train Loss: 3.410 Vali Loss: 3.344 Vali Acc: 0.039 Test Loss: 3.344 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.5056309700012207
Epoch: 2, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.396 Vali Acc: 0.036 Test Loss: 3.396 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4515743255615234
Epoch: 3, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.412 Vali Acc: 0.044 Test Loss: 3.412 Test Acc: 0.044
Validation loss decreased (-0.038790 --> -0.043495).  Saving model ...
Epoch: 4 cost time: 1.5460739135742188
Epoch: 4, Steps: 10 | Train Loss: 3.062 Vali Loss: 3.353 Vali Acc: 0.064 Test Loss: 3.353 Test Acc: 0.064
Validation loss decreased (-0.043495 --> -0.063496).  Saving model ...
Epoch: 5 cost time: 1.2479255199432373
Epoch: 5, Steps: 10 | Train Loss: 2.946 Vali Loss: 3.331 Vali Acc: 0.089 Test Loss: 3.331 Test Acc: 0.089
Validation loss decreased (-0.063496 --> -0.089378).  Saving model ...
Epoch: 6 cost time: 1.2351317405700684
Epoch: 6, Steps: 10 | Train Loss: 2.843 Vali Loss: 3.304 Vali Acc: 0.092 Test Loss: 3.304 Test Acc: 0.092
Validation loss decreased (-0.089378 --> -0.091732).  Saving model ...
Epoch: 7 cost time: 1.2594788074493408
Epoch: 7, Steps: 10 | Train Loss: 2.638 Vali Loss: 3.262 Vali Acc: 0.101 Test Loss: 3.262 Test Acc: 0.101
Validation loss decreased (-0.091732 --> -0.101144).  Saving model ...
Epoch: 8 cost time: 1.2664892673492432
Epoch: 8, Steps: 10 | Train Loss: 2.539 Vali Loss: 3.303 Vali Acc: 0.105 Test Loss: 3.303 Test Acc: 0.105
Validation loss decreased (-0.101144 --> -0.104673).  Saving model ...
Epoch: 9 cost time: 1.3490512371063232
Epoch: 9, Steps: 10 | Train Loss: 2.336 Vali Loss: 3.215 Vali Acc: 0.131 Test Loss: 3.215 Test Acc: 0.131
Validation loss decreased (-0.104673 --> -0.130556).  Saving model ...
Epoch: 10 cost time: 1.2972655296325684
Epoch: 10, Steps: 10 | Train Loss: 2.192 Vali Loss: 3.240 Vali Acc: 0.138 Test Loss: 3.240 Test Acc: 0.138
Validation loss decreased (-0.130556 --> -0.137615).  Saving model ...
Epoch: 11 cost time: 1.2303457260131836
Epoch: 11, Steps: 10 | Train Loss: 1.973 Vali Loss: 3.291 Vali Acc: 0.131 Test Loss: 3.291 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8517448902130127
Epoch: 12, Steps: 10 | Train Loss: 1.761 Vali Loss: 3.238 Vali Acc: 0.156 Test Loss: 3.238 Test Acc: 0.156
Validation loss decreased (-0.137615 --> -0.156438).  Saving model ...
Epoch: 13 cost time: 1.6123228073120117
Epoch: 13, Steps: 10 | Train Loss: 1.618 Vali Loss: 3.264 Vali Acc: 0.180 Test Loss: 3.264 Test Acc: 0.180
Validation loss decreased (-0.156438 --> -0.179967).  Saving model ...
Epoch: 14 cost time: 1.6638197898864746
Epoch: 14, Steps: 10 | Train Loss: 1.424 Vali Loss: 3.296 Vali Acc: 0.188 Test Loss: 3.296 Test Acc: 0.188
Validation loss decreased (-0.179967 --> -0.188202).  Saving model ...
Epoch: 15 cost time: 1.5537753105163574
Epoch: 15, Steps: 10 | Train Loss: 1.230 Vali Loss: 3.361 Vali Acc: 0.194 Test Loss: 3.361 Test Acc: 0.194
Validation loss decreased (-0.188202 --> -0.194084).  Saving model ...
Epoch: 16 cost time: 1.5716383457183838
Epoch: 16, Steps: 10 | Train Loss: 0.987 Vali Loss: 3.322 Vali Acc: 0.220 Test Loss: 3.322 Test Acc: 0.220
Validation loss decreased (-0.194084 --> -0.219967).  Saving model ...
Epoch: 17 cost time: 1.3562417030334473
Epoch: 17, Steps: 10 | Train Loss: 0.862 Vali Loss: 3.402 Vali Acc: 0.215 Test Loss: 3.402 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6173255443572998
Epoch: 18, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.496 Vali Acc: 0.206 Test Loss: 3.496 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4408555030822754
Epoch: 19, Steps: 10 | Train Loss: 0.589 Vali Loss: 3.545 Vali Acc: 0.221 Test Loss: 3.545 Test Acc: 0.221
Validation loss decreased (-0.219967 --> -0.221141).  Saving model ...
Epoch: 20 cost time: 1.4918928146362305
Epoch: 20, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.509 Vali Acc: 0.227 Test Loss: 3.509 Test Acc: 0.227
Validation loss decreased (-0.221141 --> -0.227024).  Saving model ...
Epoch: 21 cost time: 1.3225913047790527
Epoch: 21, Steps: 10 | Train Loss: 0.357 Vali Loss: 3.653 Vali Acc: 0.239 Test Loss: 3.653 Test Acc: 0.239
Validation loss decreased (-0.227024 --> -0.238787).  Saving model ...
Epoch: 22 cost time: 1.6194052696228027
Epoch: 22, Steps: 10 | Train Loss: 0.264 Vali Loss: 3.679 Vali Acc: 0.246 Test Loss: 3.679 Test Acc: 0.246
Validation loss decreased (-0.238787 --> -0.245846).  Saving model ...
Epoch: 23 cost time: 1.3733911514282227
Epoch: 23, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.795 Vali Acc: 0.239 Test Loss: 3.795 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5414984226226807
Epoch: 24, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.884 Vali Acc: 0.247 Test Loss: 3.884 Test Acc: 0.247
Validation loss decreased (-0.245846 --> -0.247020).  Saving model ...
Epoch: 25 cost time: 1.5046067237854004
Epoch: 25, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.925 Vali Acc: 0.246 Test Loss: 3.925 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3361260890960693
Epoch: 26, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.864 Vali Acc: 0.251 Test Loss: 3.864 Test Acc: 0.251
Validation loss decreased (-0.247020 --> -0.250550).  Saving model ...
Epoch: 27 cost time: 1.3449034690856934
Epoch: 27, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.063 Vali Acc: 0.259 Test Loss: 4.063 Test Acc: 0.259
Validation loss decreased (-0.250550 --> -0.258783).  Saving model ...
Epoch: 28 cost time: 1.378098487854004
Epoch: 28, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.008 Vali Acc: 0.255 Test Loss: 4.008 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4547600746154785
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.034 Vali Acc: 0.256 Test Loss: 4.034 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4876048564910889
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.044 Vali Acc: 0.264 Test Loss: 4.044 Test Acc: 0.264
Validation loss decreased (-0.258783 --> -0.263489).  Saving model ...
Epoch: 31 cost time: 1.4947285652160645
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.093 Vali Acc: 0.252 Test Loss: 4.093 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.327761173248291
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.092 Vali Acc: 0.264 Test Loss: 4.092 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4046339988708496
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.107 Vali Acc: 0.264 Test Loss: 4.107 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5471110343933105
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.139 Vali Acc: 0.267 Test Loss: 4.139 Test Acc: 0.267
Validation loss decreased (-0.263489 --> -0.267017).  Saving model ...
Epoch: 35 cost time: 1.2550647258758545
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.173 Vali Acc: 0.262 Test Loss: 4.173 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6899528503417969
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.187 Vali Acc: 0.261 Test Loss: 4.187 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4420299530029297
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.217 Vali Acc: 0.271 Test Loss: 4.217 Test Acc: 0.271
Validation loss decreased (-0.267017 --> -0.270546).  Saving model ...
Epoch: 38 cost time: 1.2993733882904053
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.249 Vali Acc: 0.272 Test Loss: 4.249 Test Acc: 0.272
Validation loss decreased (-0.270546 --> -0.271722).  Saving model ...
Epoch: 39 cost time: 1.484361171722412
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.213 Vali Acc: 0.276 Test Loss: 4.213 Test Acc: 0.276
Validation loss decreased (-0.271722 --> -0.276428).  Saving model ...
Epoch: 40 cost time: 1.4376111030578613
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.256 Vali Acc: 0.273 Test Loss: 4.256 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1851661205291748
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.269 Vali Acc: 0.275 Test Loss: 4.269 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3521831035614014
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.270 Vali Acc: 0.272 Test Loss: 4.270 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2773025035858154
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.290 Vali Acc: 0.268 Test Loss: 4.290 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.4854075908660889
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.309 Vali Acc: 0.271 Test Loss: 4.309 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.402712345123291
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.307 Vali Acc: 0.276 Test Loss: 4.307 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.55657958984375
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.328 Vali Acc: 0.274 Test Loss: 4.328 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.3738889694213867
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.350 Vali Acc: 0.273 Test Loss: 4.350 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.1931183338165283
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.372 Vali Acc: 0.273 Test Loss: 4.372 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.5855607986450195
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.374 Vali Acc: 0.269 Test Loss: 4.374 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 1742142
model size : 9.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7581276893615723
Epoch: 1, Steps: 10 | Train Loss: 3.449 Vali Loss: 3.374 Vali Acc: 0.041 Test Loss: 3.374 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.720571756362915
Epoch: 2, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.371 Vali Acc: 0.051 Test Loss: 3.371 Test Acc: 0.051
Validation loss decreased (-0.041143 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 1.4632391929626465
Epoch: 3, Steps: 10 | Train Loss: 3.203 Vali Loss: 3.413 Vali Acc: 0.042 Test Loss: 3.413 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6772782802581787
Epoch: 4, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.337 Vali Acc: 0.044 Test Loss: 3.337 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4194178581237793
Epoch: 5, Steps: 10 | Train Loss: 3.006 Vali Loss: 3.281 Vali Acc: 0.064 Test Loss: 3.281 Test Acc: 0.064
Validation loss decreased (-0.050555 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 1.5015144348144531
Epoch: 6, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.313 Vali Acc: 0.093 Test Loss: 3.313 Test Acc: 0.093
Validation loss decreased (-0.063497 --> -0.092908).  Saving model ...
Epoch: 7 cost time: 1.437911033630371
Epoch: 7, Steps: 10 | Train Loss: 2.752 Vali Loss: 3.265 Vali Acc: 0.100 Test Loss: 3.265 Test Acc: 0.100
Validation loss decreased (-0.092908 --> -0.099967).  Saving model ...
Epoch: 8 cost time: 1.3039205074310303
Epoch: 8, Steps: 10 | Train Loss: 2.610 Vali Loss: 3.261 Vali Acc: 0.133 Test Loss: 3.261 Test Acc: 0.133
Validation loss decreased (-0.099967 --> -0.132909).  Saving model ...
Epoch: 9 cost time: 1.5847678184509277
Epoch: 9, Steps: 10 | Train Loss: 2.405 Vali Loss: 3.253 Vali Acc: 0.116 Test Loss: 3.253 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.510908603668213
Epoch: 10, Steps: 10 | Train Loss: 2.221 Vali Loss: 3.233 Vali Acc: 0.140 Test Loss: 3.233 Test Acc: 0.140
Validation loss decreased (-0.132909 --> -0.139968).  Saving model ...
Epoch: 11 cost time: 1.4644300937652588
Epoch: 11, Steps: 10 | Train Loss: 2.067 Vali Loss: 3.268 Vali Acc: 0.154 Test Loss: 3.268 Test Acc: 0.154
Validation loss decreased (-0.139968 --> -0.154085).  Saving model ...
Epoch: 12 cost time: 1.2028846740722656
Epoch: 12, Steps: 10 | Train Loss: 1.815 Vali Loss: 3.259 Vali Acc: 0.152 Test Loss: 3.259 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3025591373443604
Epoch: 13, Steps: 10 | Train Loss: 1.666 Vali Loss: 3.287 Vali Acc: 0.176 Test Loss: 3.287 Test Acc: 0.176
Validation loss decreased (-0.154085 --> -0.176438).  Saving model ...
Epoch: 14 cost time: 1.2203853130340576
Epoch: 14, Steps: 10 | Train Loss: 1.471 Vali Loss: 3.329 Vali Acc: 0.171 Test Loss: 3.329 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2715339660644531
Epoch: 15, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.404 Vali Acc: 0.195 Test Loss: 3.404 Test Acc: 0.195
Validation loss decreased (-0.176438 --> -0.195260).  Saving model ...
Epoch: 16 cost time: 1.1630244255065918
Epoch: 16, Steps: 10 | Train Loss: 1.161 Vali Loss: 3.397 Vali Acc: 0.215 Test Loss: 3.397 Test Acc: 0.215
Validation loss decreased (-0.195260 --> -0.215260).  Saving model ...
Epoch: 17 cost time: 1.3717117309570312
Epoch: 17, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.469 Vali Acc: 0.202 Test Loss: 3.469 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.662914514541626
Epoch: 18, Steps: 10 | Train Loss: 0.783 Vali Loss: 3.493 Vali Acc: 0.227 Test Loss: 3.493 Test Acc: 0.227
Validation loss decreased (-0.215260 --> -0.227024).  Saving model ...
Epoch: 19 cost time: 1.2717645168304443
Epoch: 19, Steps: 10 | Train Loss: 0.660 Vali Loss: 3.629 Vali Acc: 0.205 Test Loss: 3.629 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.846888780593872
Epoch: 20, Steps: 10 | Train Loss: 0.561 Vali Loss: 3.623 Vali Acc: 0.226 Test Loss: 3.623 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3477654457092285
Epoch: 21, Steps: 10 | Train Loss: 0.529 Vali Loss: 3.737 Vali Acc: 0.224 Test Loss: 3.737 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.611562967300415
Epoch: 22, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.752 Vali Acc: 0.233 Test Loss: 3.752 Test Acc: 0.233
Validation loss decreased (-0.227024 --> -0.232904).  Saving model ...
Epoch: 23 cost time: 1.2623012065887451
Epoch: 23, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.867 Vali Acc: 0.227 Test Loss: 3.867 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.563157558441162
Epoch: 24, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.925 Vali Acc: 0.228 Test Loss: 3.925 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4380872249603271
Epoch: 25, Steps: 10 | Train Loss: 0.144 Vali Loss: 4.035 Vali Acc: 0.232 Test Loss: 4.035 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.320920467376709
Epoch: 26, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.049 Vali Acc: 0.248 Test Loss: 4.049 Test Acc: 0.248
Validation loss decreased (-0.232904 --> -0.248195).  Saving model ...
Epoch: 27 cost time: 1.705683708190918
Epoch: 27, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.168 Vali Acc: 0.240 Test Loss: 4.168 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4418816566467285
Epoch: 28, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.203 Vali Acc: 0.247 Test Loss: 4.203 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2266027927398682
Epoch: 29, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.184 Vali Acc: 0.244 Test Loss: 4.184 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3050272464752197
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.213 Vali Acc: 0.249 Test Loss: 4.213 Test Acc: 0.249
Validation loss decreased (-0.248195 --> -0.249370).  Saving model ...
Epoch: 31 cost time: 1.3798496723175049
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.313 Vali Acc: 0.242 Test Loss: 4.313 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6472439765930176
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.296 Vali Acc: 0.249 Test Loss: 4.296 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6370830535888672
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.367 Vali Acc: 0.240 Test Loss: 4.367 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.271092176437378
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.370 Vali Acc: 0.248 Test Loss: 4.370 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1365149021148682
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.386 Vali Acc: 0.252 Test Loss: 4.386 Test Acc: 0.252
Validation loss decreased (-0.249370 --> -0.251721).  Saving model ...
Epoch: 36 cost time: 1.3859660625457764
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.422 Vali Acc: 0.241 Test Loss: 4.422 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3447458744049072
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.415 Vali Acc: 0.249 Test Loss: 4.415 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3350541591644287
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.439 Vali Acc: 0.254 Test Loss: 4.439 Test Acc: 0.254
Validation loss decreased (-0.251721 --> -0.254073).  Saving model ...
Epoch: 39 cost time: 1.6822540760040283
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.488 Vali Acc: 0.245 Test Loss: 4.488 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3897085189819336
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.505 Vali Acc: 0.247 Test Loss: 4.505 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7110583782196045
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.514 Vali Acc: 0.247 Test Loss: 4.514 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.3418080806732178
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.524 Vali Acc: 0.245 Test Loss: 4.524 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5358250141143799
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.531 Vali Acc: 0.253 Test Loss: 4.531 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.3554866313934326
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.544 Vali Acc: 0.249 Test Loss: 4.544 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.4982073307037354
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.559 Vali Acc: 0.253 Test Loss: 4.559 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.376246452331543
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.573 Vali Acc: 0.249 Test Loss: 4.573 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.3892059326171875
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.589 Vali Acc: 0.252 Test Loss: 4.589 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.3886873722076416
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.606 Vali Acc: 0.251 Test Loss: 4.606 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 1585342
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.704583168029785
Epoch: 1, Steps: 10 | Train Loss: 3.508 Vali Loss: 3.382 Vali Acc: 0.040 Test Loss: 3.382 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 1.281364917755127
Epoch: 2, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.358 Vali Acc: 0.061 Test Loss: 3.358 Test Acc: 0.061
Validation loss decreased (-0.039966 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 1.1082515716552734
Epoch: 3, Steps: 10 | Train Loss: 3.153 Vali Loss: 3.387 Vali Acc: 0.061 Test Loss: 3.387 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3572216033935547
Epoch: 4, Steps: 10 | Train Loss: 3.062 Vali Loss: 3.348 Vali Acc: 0.061 Test Loss: 3.348 Test Acc: 0.061
Validation loss decreased (-0.061143 --> -0.061143).  Saving model ...
Epoch: 5 cost time: 1.2470808029174805
Epoch: 5, Steps: 10 | Train Loss: 2.967 Vali Loss: 3.326 Vali Acc: 0.080 Test Loss: 3.326 Test Acc: 0.080
Validation loss decreased (-0.061143 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 1.2258238792419434
Epoch: 6, Steps: 10 | Train Loss: 2.886 Vali Loss: 3.307 Vali Acc: 0.091 Test Loss: 3.307 Test Acc: 0.091
Validation loss decreased (-0.079967 --> -0.090555).  Saving model ...
Epoch: 7 cost time: 1.212205410003662
Epoch: 7, Steps: 10 | Train Loss: 2.723 Vali Loss: 3.254 Vali Acc: 0.108 Test Loss: 3.254 Test Acc: 0.108
Validation loss decreased (-0.090555 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 1.2557480335235596
Epoch: 8, Steps: 10 | Train Loss: 2.587 Vali Loss: 3.255 Vali Acc: 0.118 Test Loss: 3.255 Test Acc: 0.118
Validation loss decreased (-0.108203 --> -0.117615).  Saving model ...
Epoch: 9 cost time: 1.4748222827911377
Epoch: 9, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.277 Vali Acc: 0.128 Test Loss: 3.277 Test Acc: 0.128
Validation loss decreased (-0.117615 --> -0.128203).  Saving model ...
Epoch: 10 cost time: 1.4810070991516113
Epoch: 10, Steps: 10 | Train Loss: 2.178 Vali Loss: 3.253 Vali Acc: 0.141 Test Loss: 3.253 Test Acc: 0.141
Validation loss decreased (-0.128203 --> -0.141144).  Saving model ...
Epoch: 11 cost time: 1.4242024421691895
Epoch: 11, Steps: 10 | Train Loss: 2.000 Vali Loss: 3.264 Vali Acc: 0.158 Test Loss: 3.264 Test Acc: 0.158
Validation loss decreased (-0.141144 --> -0.157614).  Saving model ...
Epoch: 12 cost time: 1.2265625
Epoch: 12, Steps: 10 | Train Loss: 1.754 Vali Loss: 3.264 Vali Acc: 0.171 Test Loss: 3.264 Test Acc: 0.171
Validation loss decreased (-0.157614 --> -0.170556).  Saving model ...
Epoch: 13 cost time: 1.542219638824463
Epoch: 13, Steps: 10 | Train Loss: 1.576 Vali Loss: 3.353 Vali Acc: 0.164 Test Loss: 3.353 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3049051761627197
Epoch: 14, Steps: 10 | Train Loss: 1.390 Vali Loss: 3.301 Vali Acc: 0.194 Test Loss: 3.301 Test Acc: 0.194
Validation loss decreased (-0.170556 --> -0.194085).  Saving model ...
Epoch: 15 cost time: 1.3626503944396973
Epoch: 15, Steps: 10 | Train Loss: 1.276 Vali Loss: 3.358 Vali Acc: 0.184 Test Loss: 3.358 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1838786602020264
Epoch: 16, Steps: 10 | Train Loss: 1.103 Vali Loss: 3.452 Vali Acc: 0.200 Test Loss: 3.452 Test Acc: 0.200
Validation loss decreased (-0.194085 --> -0.199965).  Saving model ...
Epoch: 17 cost time: 1.542459487915039
Epoch: 17, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.459 Vali Acc: 0.221 Test Loss: 3.459 Test Acc: 0.221
Validation loss decreased (-0.199965 --> -0.221142).  Saving model ...
Epoch: 18 cost time: 1.3115386962890625
Epoch: 18, Steps: 10 | Train Loss: 0.777 Vali Loss: 3.495 Vali Acc: 0.207 Test Loss: 3.495 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4329392910003662
Epoch: 19, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.533 Vali Acc: 0.212 Test Loss: 3.533 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2125625610351562
Epoch: 20, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.614 Vali Acc: 0.234 Test Loss: 3.614 Test Acc: 0.234
Validation loss decreased (-0.221142 --> -0.234082).  Saving model ...
Epoch: 21 cost time: 1.6106994152069092
Epoch: 21, Steps: 10 | Train Loss: 0.402 Vali Loss: 3.627 Vali Acc: 0.222 Test Loss: 3.627 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4821152687072754
Epoch: 22, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.742 Vali Acc: 0.225 Test Loss: 3.742 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.367779016494751
Epoch: 23, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.854 Vali Acc: 0.228 Test Loss: 3.854 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.271078109741211
Epoch: 24, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.916 Vali Acc: 0.227 Test Loss: 3.916 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4794471263885498
Epoch: 25, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.959 Vali Acc: 0.233 Test Loss: 3.959 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2186717987060547
Epoch: 26, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.003 Vali Acc: 0.229 Test Loss: 4.003 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3999569416046143
Epoch: 27, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.140 Vali Acc: 0.234 Test Loss: 4.140 Test Acc: 0.234
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5157902240753174
Epoch: 28, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.090 Vali Acc: 0.241 Test Loss: 4.090 Test Acc: 0.241
Validation loss decreased (-0.234082 --> -0.241136).  Saving model ...
Epoch: 29 cost time: 1.3251838684082031
Epoch: 29, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.122 Vali Acc: 0.248 Test Loss: 4.122 Test Acc: 0.248
Validation loss decreased (-0.241136 --> -0.248194).  Saving model ...
Epoch: 30 cost time: 1.6859204769134521
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.220 Vali Acc: 0.244 Test Loss: 4.220 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6307291984558105
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.220 Vali Acc: 0.251 Test Loss: 4.220 Test Acc: 0.251
Validation loss decreased (-0.248194 --> -0.250546).  Saving model ...
Epoch: 32 cost time: 1.4014291763305664
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.237 Vali Acc: 0.246 Test Loss: 4.237 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5969676971435547
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.263 Vali Acc: 0.258 Test Loss: 4.263 Test Acc: 0.258
Validation loss decreased (-0.250546 --> -0.257604).  Saving model ...
Epoch: 34 cost time: 1.1258761882781982
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.249 Vali Acc: 0.249 Test Loss: 4.249 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.422163724899292
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.302 Vali Acc: 0.253 Test Loss: 4.302 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3866612911224365
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.346 Vali Acc: 0.255 Test Loss: 4.346 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.469787359237671
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.346 Vali Acc: 0.260 Test Loss: 4.346 Test Acc: 0.260
Validation loss decreased (-0.257604 --> -0.259957).  Saving model ...
Epoch: 38 cost time: 1.2687397003173828
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.379 Vali Acc: 0.258 Test Loss: 4.379 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.114387035369873
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.414 Vali Acc: 0.251 Test Loss: 4.414 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3415107727050781
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.413 Vali Acc: 0.252 Test Loss: 4.413 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3846960067749023
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.424 Vali Acc: 0.260 Test Loss: 4.424 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.387505292892456
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.445 Vali Acc: 0.260 Test Loss: 4.445 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.3844218254089355
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.457 Vali Acc: 0.262 Test Loss: 4.457 Test Acc: 0.262
Validation loss decreased (-0.259957 --> -0.262308).  Saving model ...
Epoch: 44 cost time: 1.4120776653289795
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.487 Vali Acc: 0.256 Test Loss: 4.487 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.4377548694610596
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.522 Vali Acc: 0.255 Test Loss: 4.522 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3704960346221924
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.517 Vali Acc: 0.258 Test Loss: 4.517 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2420802116394043
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.540 Vali Acc: 0.261 Test Loss: 4.540 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.1732499599456787
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.577 Vali Acc: 0.258 Test Loss: 4.577 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2729499340057373
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.564 Vali Acc: 0.258 Test Loss: 4.564 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.2038893699645996
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.592 Vali Acc: 0.260 Test Loss: 4.592 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.2341952323913574
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.593 Vali Acc: 0.253 Test Loss: 4.593 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.2739200592041016
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.606 Vali Acc: 0.258 Test Loss: 4.606 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.143707275390625
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.617 Vali Acc: 0.259 Test Loss: 4.617 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26235294117647057
model parameter : 1582782
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.221322536468506
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.361 Vali Acc: 0.031 Test Loss: 3.361 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 1.4452011585235596
Epoch: 2, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.353 Vali Acc: 0.058 Test Loss: 3.353 Test Acc: 0.058
Validation loss decreased (-0.030555 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 1.218008279800415
Epoch: 3, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.383 Vali Acc: 0.053 Test Loss: 3.383 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2883036136627197
Epoch: 4, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.314 Vali Acc: 0.075 Test Loss: 3.314 Test Acc: 0.075
Validation loss decreased (-0.057614 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 1.7106788158416748
Epoch: 5, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.298 Vali Acc: 0.094 Test Loss: 3.298 Test Acc: 0.094
Validation loss decreased (-0.075261 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 1.1930079460144043
Epoch: 6, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.293 Vali Acc: 0.087 Test Loss: 3.293 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.493887186050415
Epoch: 7, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.304 Vali Acc: 0.100 Test Loss: 3.304 Test Acc: 0.100
Validation loss decreased (-0.094085 --> -0.099967).  Saving model ...
Epoch: 8 cost time: 1.2286696434020996
Epoch: 8, Steps: 10 | Train Loss: 2.562 Vali Loss: 3.253 Vali Acc: 0.120 Test Loss: 3.253 Test Acc: 0.120
Validation loss decreased (-0.099967 --> -0.119967).  Saving model ...
Epoch: 9 cost time: 1.4926655292510986
Epoch: 9, Steps: 10 | Train Loss: 2.380 Vali Loss: 3.211 Vali Acc: 0.135 Test Loss: 3.211 Test Acc: 0.135
Validation loss decreased (-0.119967 --> -0.135262).  Saving model ...
Epoch: 10 cost time: 1.0247488021850586
Epoch: 10, Steps: 10 | Train Loss: 2.207 Vali Loss: 3.282 Vali Acc: 0.133 Test Loss: 3.282 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3479702472686768
Epoch: 11, Steps: 10 | Train Loss: 2.051 Vali Loss: 3.292 Vali Acc: 0.142 Test Loss: 3.292 Test Acc: 0.142
Validation loss decreased (-0.135262 --> -0.142320).  Saving model ...
Epoch: 12 cost time: 1.254204511642456
Epoch: 12, Steps: 10 | Train Loss: 1.844 Vali Loss: 3.266 Vali Acc: 0.165 Test Loss: 3.266 Test Acc: 0.165
Validation loss decreased (-0.142320 --> -0.164673).  Saving model ...
Epoch: 13 cost time: 1.182114601135254
Epoch: 13, Steps: 10 | Train Loss: 1.633 Vali Loss: 3.356 Vali Acc: 0.156 Test Loss: 3.356 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3078742027282715
Epoch: 14, Steps: 10 | Train Loss: 1.423 Vali Loss: 3.341 Vali Acc: 0.176 Test Loss: 3.341 Test Acc: 0.176
Validation loss decreased (-0.164673 --> -0.176437).  Saving model ...
Epoch: 15 cost time: 1.4569339752197266
Epoch: 15, Steps: 10 | Train Loss: 1.270 Vali Loss: 3.408 Vali Acc: 0.195 Test Loss: 3.408 Test Acc: 0.195
Validation loss decreased (-0.176437 --> -0.195260).  Saving model ...
Epoch: 16 cost time: 1.3844666481018066
Epoch: 16, Steps: 10 | Train Loss: 1.109 Vali Loss: 3.408 Vali Acc: 0.204 Test Loss: 3.408 Test Acc: 0.204
Validation loss decreased (-0.195260 --> -0.203495).  Saving model ...
Epoch: 17 cost time: 1.1676619052886963
Epoch: 17, Steps: 10 | Train Loss: 1.020 Vali Loss: 3.478 Vali Acc: 0.218 Test Loss: 3.478 Test Acc: 0.218
Validation loss decreased (-0.203495 --> -0.217612).  Saving model ...
Epoch: 18 cost time: 1.2005383968353271
Epoch: 18, Steps: 10 | Train Loss: 0.888 Vali Loss: 3.513 Vali Acc: 0.215 Test Loss: 3.513 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3302857875823975
Epoch: 19, Steps: 10 | Train Loss: 0.716 Vali Loss: 3.602 Vali Acc: 0.211 Test Loss: 3.602 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3136978149414062
Epoch: 20, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.587 Vali Acc: 0.222 Test Loss: 3.587 Test Acc: 0.222
Validation loss decreased (-0.217612 --> -0.222317).  Saving model ...
Epoch: 21 cost time: 1.4020106792449951
Epoch: 21, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.695 Vali Acc: 0.222 Test Loss: 3.695 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2770180702209473
Epoch: 22, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.853 Vali Acc: 0.212 Test Loss: 3.853 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.175410509109497
Epoch: 23, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.740 Vali Acc: 0.234 Test Loss: 3.740 Test Acc: 0.234
Validation loss decreased (-0.222317 --> -0.234080).  Saving model ...
Epoch: 24 cost time: 1.724869966506958
Epoch: 24, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.948 Vali Acc: 0.240 Test Loss: 3.948 Test Acc: 0.240
Validation loss decreased (-0.234080 --> -0.239961).  Saving model ...
Epoch: 25 cost time: 1.3025364875793457
Epoch: 25, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.895 Vali Acc: 0.248 Test Loss: 3.895 Test Acc: 0.248
Validation loss decreased (-0.239961 --> -0.248196).  Saving model ...
Epoch: 26 cost time: 1.469710350036621
Epoch: 26, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.049 Vali Acc: 0.235 Test Loss: 4.049 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.339440107345581
Epoch: 27, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.129 Vali Acc: 0.241 Test Loss: 4.129 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0176384449005127
Epoch: 28, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.129 Vali Acc: 0.227 Test Loss: 4.129 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.321610927581787
Epoch: 29, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.245 Vali Acc: 0.228 Test Loss: 4.245 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4341082572937012
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.143 Vali Acc: 0.256 Test Loss: 4.143 Test Acc: 0.256
Validation loss decreased (-0.248196 --> -0.256429).  Saving model ...
Epoch: 31 cost time: 1.3628082275390625
Epoch: 31, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.333 Vali Acc: 0.232 Test Loss: 4.333 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3898632526397705
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.250 Vali Acc: 0.249 Test Loss: 4.250 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4066827297210693
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.240 Vali Acc: 0.254 Test Loss: 4.240 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.490757942199707
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.302 Vali Acc: 0.247 Test Loss: 4.302 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4362215995788574
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.291 Vali Acc: 0.248 Test Loss: 4.291 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1685845851898193
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.310 Vali Acc: 0.260 Test Loss: 4.310 Test Acc: 0.260
Validation loss decreased (-0.256429 --> -0.259957).  Saving model ...
Epoch: 37 cost time: 1.4052841663360596
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.349 Vali Acc: 0.252 Test Loss: 4.349 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.207718849182129
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.346 Vali Acc: 0.258 Test Loss: 4.346 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3164756298065186
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.363 Vali Acc: 0.267 Test Loss: 4.363 Test Acc: 0.267
Validation loss decreased (-0.259957 --> -0.267015).  Saving model ...
Epoch: 40 cost time: 1.2049343585968018
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.382 Vali Acc: 0.268 Test Loss: 4.382 Test Acc: 0.268
Validation loss decreased (-0.267015 --> -0.268191).  Saving model ...
Epoch: 41 cost time: 1.1663353443145752
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.431 Vali Acc: 0.262 Test Loss: 4.431 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4385731220245361
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.443 Vali Acc: 0.264 Test Loss: 4.443 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2616875171661377
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.443 Vali Acc: 0.265 Test Loss: 4.443 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5340306758880615
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.453 Vali Acc: 0.272 Test Loss: 4.453 Test Acc: 0.272
Validation loss decreased (-0.268191 --> -0.271720).  Saving model ...
Epoch: 45 cost time: 1.5073421001434326
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.484 Vali Acc: 0.264 Test Loss: 4.484 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.498084306716919
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.501 Vali Acc: 0.262 Test Loss: 4.501 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.257634162902832
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.499 Vali Acc: 0.266 Test Loss: 4.499 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1808664798736572
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.522 Vali Acc: 0.262 Test Loss: 4.522 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2946486473083496
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.516 Vali Acc: 0.264 Test Loss: 4.516 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.2463374137878418
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.525 Vali Acc: 0.266 Test Loss: 4.525 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.289595603942871
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.550 Vali Acc: 0.268 Test Loss: 4.550 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.4626760482788086
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.566 Vali Acc: 0.265 Test Loss: 4.566 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.4975945949554443
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.597 Vali Acc: 0.261 Test Loss: 4.597 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.4225621223449707
Epoch: 54, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.585 Vali Acc: 0.266 Test Loss: 4.585 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 1580222
model size : 8.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.887730598449707
Epoch: 1, Steps: 10 | Train Loss: 3.450 Vali Loss: 3.337 Vali Acc: 0.040 Test Loss: 3.337 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.3922061920166016
Epoch: 2, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.396 Vali Acc: 0.040 Test Loss: 3.396 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4700958728790283
Epoch: 3, Steps: 10 | Train Loss: 3.221 Vali Loss: 3.409 Vali Acc: 0.052 Test Loss: 3.409 Test Acc: 0.052
Validation loss decreased (-0.039967 --> -0.051731).  Saving model ...
Epoch: 4 cost time: 1.2343742847442627
Epoch: 4, Steps: 10 | Train Loss: 3.105 Vali Loss: 3.296 Vali Acc: 0.066 Test Loss: 3.296 Test Acc: 0.066
Validation loss decreased (-0.051731 --> -0.065849).  Saving model ...
Epoch: 5 cost time: 1.2294328212738037
Epoch: 5, Steps: 10 | Train Loss: 3.039 Vali Loss: 3.293 Vali Acc: 0.066 Test Loss: 3.293 Test Acc: 0.066
Validation loss decreased (-0.065849 --> -0.065849).  Saving model ...
Epoch: 6 cost time: 1.2770957946777344
Epoch: 6, Steps: 10 | Train Loss: 2.925 Vali Loss: 3.265 Vali Acc: 0.089 Test Loss: 3.265 Test Acc: 0.089
Validation loss decreased (-0.065849 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 1.7185242176055908
Epoch: 7, Steps: 10 | Train Loss: 2.718 Vali Loss: 3.266 Vali Acc: 0.106 Test Loss: 3.266 Test Acc: 0.106
Validation loss decreased (-0.089379 --> -0.105850).  Saving model ...
Epoch: 8 cost time: 1.3386235237121582
Epoch: 8, Steps: 10 | Train Loss: 2.616 Vali Loss: 3.263 Vali Acc: 0.102 Test Loss: 3.263 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.425351619720459
Epoch: 9, Steps: 10 | Train Loss: 2.445 Vali Loss: 3.238 Vali Acc: 0.124 Test Loss: 3.238 Test Acc: 0.124
Validation loss decreased (-0.105850 --> -0.123497).  Saving model ...
Epoch: 10 cost time: 1.4868497848510742
Epoch: 10, Steps: 10 | Train Loss: 2.240 Vali Loss: 3.246 Vali Acc: 0.131 Test Loss: 3.246 Test Acc: 0.131
Validation loss decreased (-0.123497 --> -0.130556).  Saving model ...
Epoch: 11 cost time: 1.717621088027954
Epoch: 11, Steps: 10 | Train Loss: 2.016 Vali Loss: 3.270 Vali Acc: 0.142 Test Loss: 3.270 Test Acc: 0.142
Validation loss decreased (-0.130556 --> -0.142320).  Saving model ...
Epoch: 12 cost time: 1.469224214553833
Epoch: 12, Steps: 10 | Train Loss: 1.812 Vali Loss: 3.259 Vali Acc: 0.142 Test Loss: 3.259 Test Acc: 0.142
Validation loss decreased (-0.142320 --> -0.142320).  Saving model ...
Epoch: 13 cost time: 1.3521122932434082
Epoch: 13, Steps: 10 | Train Loss: 1.644 Vali Loss: 3.288 Vali Acc: 0.166 Test Loss: 3.288 Test Acc: 0.166
Validation loss decreased (-0.142320 --> -0.165849).  Saving model ...
Epoch: 14 cost time: 1.3133602142333984
Epoch: 14, Steps: 10 | Train Loss: 1.463 Vali Loss: 3.293 Vali Acc: 0.189 Test Loss: 3.293 Test Acc: 0.189
Validation loss decreased (-0.165849 --> -0.189379).  Saving model ...
Epoch: 15 cost time: 1.254047155380249
Epoch: 15, Steps: 10 | Train Loss: 1.202 Vali Loss: 3.358 Vali Acc: 0.186 Test Loss: 3.358 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.248295783996582
Epoch: 16, Steps: 10 | Train Loss: 1.063 Vali Loss: 3.414 Vali Acc: 0.186 Test Loss: 3.414 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.623410701751709
Epoch: 17, Steps: 10 | Train Loss: 0.886 Vali Loss: 3.390 Vali Acc: 0.214 Test Loss: 3.390 Test Acc: 0.214
Validation loss decreased (-0.189379 --> -0.214084).  Saving model ...
Epoch: 18 cost time: 1.6002037525177002
Epoch: 18, Steps: 10 | Train Loss: 0.771 Vali Loss: 3.556 Vali Acc: 0.204 Test Loss: 3.556 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4531280994415283
Epoch: 19, Steps: 10 | Train Loss: 0.619 Vali Loss: 3.535 Vali Acc: 0.216 Test Loss: 3.535 Test Acc: 0.216
Validation loss decreased (-0.214084 --> -0.216435).  Saving model ...
Epoch: 20 cost time: 1.2645394802093506
Epoch: 20, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.579 Vali Acc: 0.211 Test Loss: 3.579 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2807188034057617
Epoch: 21, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.686 Vali Acc: 0.211 Test Loss: 3.686 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.442188024520874
Epoch: 22, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.743 Vali Acc: 0.240 Test Loss: 3.743 Test Acc: 0.240
Validation loss decreased (-0.216435 --> -0.239963).  Saving model ...
Epoch: 23 cost time: 1.124802589416504
Epoch: 23, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.827 Vali Acc: 0.232 Test Loss: 3.827 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4641447067260742
Epoch: 24, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.867 Vali Acc: 0.226 Test Loss: 3.867 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3944425582885742
Epoch: 25, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.925 Vali Acc: 0.238 Test Loss: 3.925 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3404617309570312
Epoch: 26, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.094 Vali Acc: 0.221 Test Loss: 4.094 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4367380142211914
Epoch: 27, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.091 Vali Acc: 0.235 Test Loss: 4.091 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4387872219085693
Epoch: 28, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.043 Vali Acc: 0.255 Test Loss: 4.043 Test Acc: 0.255
Validation loss decreased (-0.239963 --> -0.255254).  Saving model ...
Epoch: 29 cost time: 1.4607751369476318
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.088 Vali Acc: 0.245 Test Loss: 4.088 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3923330307006836
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.146 Vali Acc: 0.251 Test Loss: 4.146 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3633263111114502
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.138 Vali Acc: 0.251 Test Loss: 4.138 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.47110915184021
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.164 Vali Acc: 0.260 Test Loss: 4.164 Test Acc: 0.260
Validation loss decreased (-0.255254 --> -0.259958).  Saving model ...
Epoch: 33 cost time: 1.4838483333587646
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.200 Vali Acc: 0.262 Test Loss: 4.200 Test Acc: 0.262
Validation loss decreased (-0.259958 --> -0.262311).  Saving model ...
Epoch: 34 cost time: 1.2198922634124756
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.238 Vali Acc: 0.255 Test Loss: 4.238 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5040984153747559
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.253 Vali Acc: 0.259 Test Loss: 4.253 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.5606400966644287
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.259 Vali Acc: 0.264 Test Loss: 4.259 Test Acc: 0.264
Validation loss decreased (-0.262311 --> -0.263487).  Saving model ...
Epoch: 37 cost time: 1.454268217086792
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.292 Vali Acc: 0.260 Test Loss: 4.292 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4798274040222168
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.296 Vali Acc: 0.261 Test Loss: 4.296 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5173966884613037
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.328 Vali Acc: 0.256 Test Loss: 4.328 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.543257713317871
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.341 Vali Acc: 0.259 Test Loss: 4.341 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4084277153015137
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.357 Vali Acc: 0.265 Test Loss: 4.357 Test Acc: 0.265
Validation loss decreased (-0.263487 --> -0.264662).  Saving model ...
Epoch: 42 cost time: 1.6884427070617676
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.396 Vali Acc: 0.264 Test Loss: 4.396 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.618300199508667
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.374 Vali Acc: 0.261 Test Loss: 4.374 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5209965705871582
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.379 Vali Acc: 0.259 Test Loss: 4.379 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4571864604949951
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.415 Vali Acc: 0.264 Test Loss: 4.415 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.46687912940979
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.425 Vali Acc: 0.265 Test Loss: 4.425 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.4060609340667725
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.449 Vali Acc: 0.256 Test Loss: 4.449 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3598802089691162
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.468 Vali Acc: 0.264 Test Loss: 4.468 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.386002540588379
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.474 Vali Acc: 0.265 Test Loss: 4.474 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.355114459991455
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.492 Vali Acc: 0.259 Test Loss: 4.492 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.2404942512512207
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.495 Vali Acc: 0.260 Test Loss: 4.495 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 1577662
model size : 8.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5718016624450684
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.315 Vali Acc: 0.038 Test Loss: 3.315 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.411238431930542
Epoch: 2, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.325 Vali Acc: 0.047 Test Loss: 3.325 Test Acc: 0.047
Validation loss decreased (-0.037614 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 1.381993293762207
Epoch: 3, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.356 Vali Acc: 0.056 Test Loss: 3.356 Test Acc: 0.056
Validation loss decreased (-0.047026 --> -0.056437).  Saving model ...
Epoch: 4 cost time: 1.3760325908660889
Epoch: 4, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.344 Vali Acc: 0.058 Test Loss: 3.344 Test Acc: 0.058
Validation loss decreased (-0.056437 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 1.2995166778564453
Epoch: 5, Steps: 10 | Train Loss: 3.039 Vali Loss: 3.289 Vali Acc: 0.092 Test Loss: 3.289 Test Acc: 0.092
Validation loss decreased (-0.057614 --> -0.091732).  Saving model ...
Epoch: 6 cost time: 1.3498187065124512
Epoch: 6, Steps: 10 | Train Loss: 2.940 Vali Loss: 3.269 Vali Acc: 0.080 Test Loss: 3.269 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5497586727142334
Epoch: 7, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.275 Vali Acc: 0.109 Test Loss: 3.275 Test Acc: 0.109
Validation loss decreased (-0.091732 --> -0.109379).  Saving model ...
Epoch: 8 cost time: 1.2823638916015625
Epoch: 8, Steps: 10 | Train Loss: 2.730 Vali Loss: 3.276 Vali Acc: 0.099 Test Loss: 3.276 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5217361450195312
Epoch: 9, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.225 Vali Acc: 0.118 Test Loss: 3.225 Test Acc: 0.118
Validation loss decreased (-0.109379 --> -0.117615).  Saving model ...
Epoch: 10 cost time: 1.2949388027191162
Epoch: 10, Steps: 10 | Train Loss: 2.543 Vali Loss: 3.261 Vali Acc: 0.126 Test Loss: 3.261 Test Acc: 0.126
Validation loss decreased (-0.117615 --> -0.125850).  Saving model ...
Epoch: 11 cost time: 1.3055474758148193
Epoch: 11, Steps: 10 | Train Loss: 2.254 Vali Loss: 3.242 Vali Acc: 0.131 Test Loss: 3.242 Test Acc: 0.131
Validation loss decreased (-0.125850 --> -0.130556).  Saving model ...
Epoch: 12 cost time: 1.259291410446167
Epoch: 12, Steps: 10 | Train Loss: 2.141 Vali Loss: 3.235 Vali Acc: 0.144 Test Loss: 3.235 Test Acc: 0.144
Validation loss decreased (-0.130556 --> -0.143497).  Saving model ...
Epoch: 13 cost time: 1.4694747924804688
Epoch: 13, Steps: 10 | Train Loss: 2.018 Vali Loss: 3.205 Vali Acc: 0.151 Test Loss: 3.205 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 14 cost time: 1.7519361972808838
Epoch: 14, Steps: 10 | Train Loss: 1.841 Vali Loss: 3.264 Vali Acc: 0.151 Test Loss: 3.264 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8188676834106445
Epoch: 15, Steps: 10 | Train Loss: 1.677 Vali Loss: 3.239 Vali Acc: 0.168 Test Loss: 3.239 Test Acc: 0.168
Validation loss decreased (-0.150556 --> -0.168203).  Saving model ...
Epoch: 16 cost time: 1.5431413650512695
Epoch: 16, Steps: 10 | Train Loss: 1.550 Vali Loss: 3.262 Vali Acc: 0.167 Test Loss: 3.262 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2317759990692139
Epoch: 17, Steps: 10 | Train Loss: 1.487 Vali Loss: 3.255 Vali Acc: 0.179 Test Loss: 3.255 Test Acc: 0.179
Validation loss decreased (-0.168203 --> -0.178791).  Saving model ...
Epoch: 18 cost time: 1.1957261562347412
Epoch: 18, Steps: 10 | Train Loss: 1.289 Vali Loss: 3.274 Vali Acc: 0.182 Test Loss: 3.274 Test Acc: 0.182
Validation loss decreased (-0.178791 --> -0.182320).  Saving model ...
Epoch: 19 cost time: 1.1223223209381104
Epoch: 19, Steps: 10 | Train Loss: 1.192 Vali Loss: 3.314 Vali Acc: 0.188 Test Loss: 3.314 Test Acc: 0.188
Validation loss decreased (-0.182320 --> -0.188202).  Saving model ...
Epoch: 20 cost time: 1.1407623291015625
Epoch: 20, Steps: 10 | Train Loss: 1.064 Vali Loss: 3.303 Vali Acc: 0.193 Test Loss: 3.303 Test Acc: 0.193
Validation loss decreased (-0.188202 --> -0.192908).  Saving model ...
Epoch: 21 cost time: 1.1537094116210938
Epoch: 21, Steps: 10 | Train Loss: 0.949 Vali Loss: 3.335 Vali Acc: 0.209 Test Loss: 3.335 Test Acc: 0.209
Validation loss decreased (-0.192908 --> -0.209378).  Saving model ...
Epoch: 22 cost time: 1.7093865871429443
Epoch: 22, Steps: 10 | Train Loss: 0.917 Vali Loss: 3.338 Vali Acc: 0.208 Test Loss: 3.338 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.78908109664917
Epoch: 23, Steps: 10 | Train Loss: 0.759 Vali Loss: 3.385 Vali Acc: 0.213 Test Loss: 3.385 Test Acc: 0.213
Validation loss decreased (-0.209378 --> -0.212907).  Saving model ...
Epoch: 24 cost time: 1.5272409915924072
Epoch: 24, Steps: 10 | Train Loss: 0.658 Vali Loss: 3.381 Vali Acc: 0.213 Test Loss: 3.381 Test Acc: 0.213
Validation loss decreased (-0.212907 --> -0.212907).  Saving model ...
Epoch: 25 cost time: 1.4034686088562012
Epoch: 25, Steps: 10 | Train Loss: 0.599 Vali Loss: 3.425 Vali Acc: 0.211 Test Loss: 3.425 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6147122383117676
Epoch: 26, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.501 Vali Acc: 0.206 Test Loss: 3.501 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4278233051300049
Epoch: 27, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.446 Vali Acc: 0.219 Test Loss: 3.446 Test Acc: 0.219
Validation loss decreased (-0.212907 --> -0.218789).  Saving model ...
Epoch: 28 cost time: 1.539170265197754
Epoch: 28, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.531 Vali Acc: 0.206 Test Loss: 3.531 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5070276260375977
Epoch: 29, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.553 Vali Acc: 0.232 Test Loss: 3.553 Test Acc: 0.232
Validation loss decreased (-0.218789 --> -0.231729).  Saving model ...
Epoch: 30 cost time: 1.4385159015655518
Epoch: 30, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.583 Vali Acc: 0.222 Test Loss: 3.583 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7279632091522217
Epoch: 31, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.616 Vali Acc: 0.232 Test Loss: 3.616 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3555445671081543
Epoch: 32, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.637 Vali Acc: 0.227 Test Loss: 3.637 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4989128112792969
Epoch: 33, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.733 Vali Acc: 0.239 Test Loss: 3.733 Test Acc: 0.239
Validation loss decreased (-0.231729 --> -0.238786).  Saving model ...
Epoch: 34 cost time: 1.5142853260040283
Epoch: 34, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.718 Vali Acc: 0.222 Test Loss: 3.718 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7595036029815674
Epoch: 35, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.715 Vali Acc: 0.239 Test Loss: 3.715 Test Acc: 0.239
Validation loss decreased (-0.238786 --> -0.238786).  Saving model ...
Epoch: 36 cost time: 1.6303510665893555
Epoch: 36, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.772 Vali Acc: 0.247 Test Loss: 3.772 Test Acc: 0.247
Validation loss decreased (-0.238786 --> -0.247021).  Saving model ...
Epoch: 37 cost time: 1.3943448066711426
Epoch: 37, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.815 Vali Acc: 0.240 Test Loss: 3.815 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4889099597930908
Epoch: 38, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.829 Vali Acc: 0.238 Test Loss: 3.829 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.4855737686157227
Epoch: 39, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.803 Vali Acc: 0.231 Test Loss: 3.803 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8511970043182373
Epoch: 40, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.903 Vali Acc: 0.244 Test Loss: 3.903 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.398341417312622
Epoch: 41, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.860 Vali Acc: 0.240 Test Loss: 3.860 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.3942935466766357
Epoch: 42, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.872 Vali Acc: 0.240 Test Loss: 3.872 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.7766191959381104
Epoch: 43, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.895 Vali Acc: 0.248 Test Loss: 3.895 Test Acc: 0.248
Validation loss decreased (-0.247021 --> -0.248196).  Saving model ...
Epoch: 44 cost time: 1.5694634914398193
Epoch: 44, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.894 Vali Acc: 0.247 Test Loss: 3.894 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9359173774719238
Epoch: 45, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.947 Vali Acc: 0.246 Test Loss: 3.947 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.557892084121704
Epoch: 46, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.933 Vali Acc: 0.248 Test Loss: 3.933 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.5463509559631348
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.959 Vali Acc: 0.244 Test Loss: 3.959 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.537327527999878
Epoch: 48, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.950 Vali Acc: 0.249 Test Loss: 3.950 Test Acc: 0.249
Validation loss decreased (-0.248196 --> -0.249372).  Saving model ...
Epoch: 49 cost time: 1.4394426345825195
Epoch: 49, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.975 Vali Acc: 0.251 Test Loss: 3.975 Test Acc: 0.251
Validation loss decreased (-0.249372 --> -0.250548).  Saving model ...
Epoch: 50 cost time: 1.4762396812438965
Epoch: 50, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.997 Vali Acc: 0.248 Test Loss: 3.997 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.8395054340362549
Epoch: 51, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.014 Vali Acc: 0.244 Test Loss: 4.014 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.603039264678955
Epoch: 52, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.007 Vali Acc: 0.249 Test Loss: 4.007 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.3613629341125488
Epoch: 53, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.012 Vali Acc: 0.253 Test Loss: 4.012 Test Acc: 0.253
Validation loss decreased (-0.250548 --> -0.252901).  Saving model ...
Epoch: 54 cost time: 1.8140861988067627
Epoch: 54, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.054 Vali Acc: 0.248 Test Loss: 4.054 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.654350757598877
Epoch: 55, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.040 Vali Acc: 0.248 Test Loss: 4.040 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.3368170261383057
Epoch: 56, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.065 Vali Acc: 0.246 Test Loss: 4.065 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.6677756309509277
Epoch: 57, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.071 Vali Acc: 0.248 Test Loss: 4.071 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.4825119972229004
Epoch: 58, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.087 Vali Acc: 0.252 Test Loss: 4.087 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.5605065822601318
Epoch: 59, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.105 Vali Acc: 0.253 Test Loss: 4.105 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.6243503093719482
Epoch: 60, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.122 Vali Acc: 0.256 Test Loss: 4.122 Test Acc: 0.256
Validation loss decreased (-0.252901 --> -0.256429).  Saving model ...
Epoch: 61 cost time: 1.7530136108398438
Epoch: 61, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.110 Vali Acc: 0.253 Test Loss: 4.110 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.5611300468444824
Epoch: 62, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.114 Vali Acc: 0.253 Test Loss: 4.114 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.7171268463134766
Epoch: 63, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.145 Vali Acc: 0.249 Test Loss: 4.145 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.5189294815063477
Epoch: 64, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.159 Vali Acc: 0.249 Test Loss: 4.159 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.484783411026001
Epoch: 65, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.139 Vali Acc: 0.251 Test Loss: 4.139 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.5942676067352295
Epoch: 66, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.150 Vali Acc: 0.255 Test Loss: 4.150 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.4164721965789795
Epoch: 67, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.172 Vali Acc: 0.254 Test Loss: 4.172 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.3704092502593994
Epoch: 68, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.173 Vali Acc: 0.251 Test Loss: 4.173 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.772071361541748
Epoch: 69, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.180 Vali Acc: 0.256 Test Loss: 4.180 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 1.4956419467926025
Epoch: 70, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.208 Vali Acc: 0.255 Test Loss: 4.208 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 1043262
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6699185371398926
Epoch: 1, Steps: 10 | Train Loss: 3.518 Vali Loss: 3.378 Vali Acc: 0.024 Test Loss: 3.378 Test Acc: 0.024
Validation loss decreased (inf --> -0.023496).  Saving model ...
Epoch: 2 cost time: 1.3093130588531494
Epoch: 2, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.331 Vali Acc: 0.036 Test Loss: 3.331 Test Acc: 0.036
Validation loss decreased (-0.023496 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 1.336613416671753
Epoch: 3, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.387 Vali Acc: 0.053 Test Loss: 3.387 Test Acc: 0.053
Validation loss decreased (-0.036437 --> -0.052907).  Saving model ...
Epoch: 4 cost time: 1.408325433731079
Epoch: 4, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.379 Vali Acc: 0.055 Test Loss: 3.379 Test Acc: 0.055
Validation loss decreased (-0.052907 --> -0.055260).  Saving model ...
Epoch: 5 cost time: 1.9786226749420166
Epoch: 5, Steps: 10 | Train Loss: 3.083 Vali Loss: 3.315 Vali Acc: 0.067 Test Loss: 3.315 Test Acc: 0.067
Validation loss decreased (-0.055260 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 1.2795820236206055
Epoch: 6, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.290 Vali Acc: 0.074 Test Loss: 3.290 Test Acc: 0.074
Validation loss decreased (-0.067026 --> -0.074085).  Saving model ...
Epoch: 7 cost time: 1.167618989944458
Epoch: 7, Steps: 10 | Train Loss: 2.913 Vali Loss: 3.276 Vali Acc: 0.093 Test Loss: 3.276 Test Acc: 0.093
Validation loss decreased (-0.074085 --> -0.092908).  Saving model ...
Epoch: 8 cost time: 1.3003177642822266
Epoch: 8, Steps: 10 | Train Loss: 2.782 Vali Loss: 3.246 Vali Acc: 0.104 Test Loss: 3.246 Test Acc: 0.104
Validation loss decreased (-0.092908 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 1.410182237625122
Epoch: 9, Steps: 10 | Train Loss: 2.626 Vali Loss: 3.273 Vali Acc: 0.102 Test Loss: 3.273 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1277456283569336
Epoch: 10, Steps: 10 | Train Loss: 2.572 Vali Loss: 3.253 Vali Acc: 0.114 Test Loss: 3.253 Test Acc: 0.114
Validation loss decreased (-0.103497 --> -0.114085).  Saving model ...
Epoch: 11 cost time: 1.2784209251403809
Epoch: 11, Steps: 10 | Train Loss: 2.373 Vali Loss: 3.257 Vali Acc: 0.132 Test Loss: 3.257 Test Acc: 0.132
Validation loss decreased (-0.114085 --> -0.131732).  Saving model ...
Epoch: 12 cost time: 1.318831443786621
Epoch: 12, Steps: 10 | Train Loss: 2.233 Vali Loss: 3.257 Vali Acc: 0.138 Test Loss: 3.257 Test Acc: 0.138
Validation loss decreased (-0.131732 --> -0.137614).  Saving model ...
Epoch: 13 cost time: 1.5170860290527344
Epoch: 13, Steps: 10 | Train Loss: 2.095 Vali Loss: 3.228 Vali Acc: 0.151 Test Loss: 3.228 Test Acc: 0.151
Validation loss decreased (-0.137614 --> -0.150556).  Saving model ...
Epoch: 14 cost time: 1.2729876041412354
Epoch: 14, Steps: 10 | Train Loss: 1.875 Vali Loss: 3.252 Vali Acc: 0.152 Test Loss: 3.252 Test Acc: 0.152
Validation loss decreased (-0.150556 --> -0.151732).  Saving model ...
Epoch: 15 cost time: 1.5847303867340088
Epoch: 15, Steps: 10 | Train Loss: 1.747 Vali Loss: 3.257 Vali Acc: 0.165 Test Loss: 3.257 Test Acc: 0.165
Validation loss decreased (-0.151732 --> -0.164673).  Saving model ...
Epoch: 16 cost time: 1.4552812576293945
Epoch: 16, Steps: 10 | Train Loss: 1.657 Vali Loss: 3.257 Vali Acc: 0.172 Test Loss: 3.257 Test Acc: 0.172
Validation loss decreased (-0.164673 --> -0.171732).  Saving model ...
Epoch: 17 cost time: 1.6147892475128174
Epoch: 17, Steps: 10 | Train Loss: 1.500 Vali Loss: 3.264 Vali Acc: 0.200 Test Loss: 3.264 Test Acc: 0.200
Validation loss decreased (-0.171732 --> -0.199967).  Saving model ...
Epoch: 18 cost time: 1.4922027587890625
Epoch: 18, Steps: 10 | Train Loss: 1.321 Vali Loss: 3.292 Vali Acc: 0.180 Test Loss: 3.292 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4932396411895752
Epoch: 19, Steps: 10 | Train Loss: 1.236 Vali Loss: 3.301 Vali Acc: 0.198 Test Loss: 3.301 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6060442924499512
Epoch: 20, Steps: 10 | Train Loss: 1.134 Vali Loss: 3.297 Vali Acc: 0.214 Test Loss: 3.297 Test Acc: 0.214
Validation loss decreased (-0.199967 --> -0.214085).  Saving model ...
Epoch: 21 cost time: 1.5497193336486816
Epoch: 21, Steps: 10 | Train Loss: 0.985 Vali Loss: 3.331 Vali Acc: 0.219 Test Loss: 3.331 Test Acc: 0.219
Validation loss decreased (-0.214085 --> -0.218790).  Saving model ...
Epoch: 22 cost time: 1.417590856552124
Epoch: 22, Steps: 10 | Train Loss: 0.863 Vali Loss: 3.379 Vali Acc: 0.205 Test Loss: 3.379 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.374873399734497
Epoch: 23, Steps: 10 | Train Loss: 0.812 Vali Loss: 3.342 Vali Acc: 0.224 Test Loss: 3.342 Test Acc: 0.224
Validation loss decreased (-0.218790 --> -0.223496).  Saving model ...
Epoch: 24 cost time: 1.209726333618164
Epoch: 24, Steps: 10 | Train Loss: 0.683 Vali Loss: 3.417 Vali Acc: 0.211 Test Loss: 3.417 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5533158779144287
Epoch: 25, Steps: 10 | Train Loss: 0.559 Vali Loss: 3.402 Vali Acc: 0.220 Test Loss: 3.402 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3552310466766357
Epoch: 26, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.445 Vali Acc: 0.212 Test Loss: 3.445 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.336927890777588
Epoch: 27, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.464 Vali Acc: 0.229 Test Loss: 3.464 Test Acc: 0.229
Validation loss decreased (-0.223496 --> -0.229377).  Saving model ...
Epoch: 28 cost time: 1.2338857650756836
Epoch: 28, Steps: 10 | Train Loss: 0.369 Vali Loss: 3.568 Vali Acc: 0.239 Test Loss: 3.568 Test Acc: 0.239
Validation loss decreased (-0.229377 --> -0.238788).  Saving model ...
Epoch: 29 cost time: 1.396493673324585
Epoch: 29, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.519 Vali Acc: 0.225 Test Loss: 3.519 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.300414800643921
Epoch: 30, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.601 Vali Acc: 0.236 Test Loss: 3.601 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6663081645965576
Epoch: 31, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.572 Vali Acc: 0.241 Test Loss: 3.572 Test Acc: 0.241
Validation loss decreased (-0.238788 --> -0.241141).  Saving model ...
Epoch: 32 cost time: 1.3313367366790771
Epoch: 32, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.676 Vali Acc: 0.247 Test Loss: 3.676 Test Acc: 0.247
Validation loss decreased (-0.241141 --> -0.247022).  Saving model ...
Epoch: 33 cost time: 1.4266736507415771
Epoch: 33, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.640 Vali Acc: 0.242 Test Loss: 3.640 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.399902582168579
Epoch: 34, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.725 Vali Acc: 0.247 Test Loss: 3.725 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.571596384048462
Epoch: 35, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.675 Vali Acc: 0.260 Test Loss: 3.675 Test Acc: 0.260
Validation loss decreased (-0.247022 --> -0.259963).  Saving model ...
Epoch: 36 cost time: 1.2040257453918457
Epoch: 36, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.803 Vali Acc: 0.251 Test Loss: 3.803 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5719385147094727
Epoch: 37, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.786 Vali Acc: 0.256 Test Loss: 3.786 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3959953784942627
Epoch: 38, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.784 Vali Acc: 0.260 Test Loss: 3.784 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6009976863861084
Epoch: 39, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.785 Vali Acc: 0.253 Test Loss: 3.785 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.202751874923706
Epoch: 40, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.781 Vali Acc: 0.265 Test Loss: 3.781 Test Acc: 0.265
Validation loss decreased (-0.259963 --> -0.264668).  Saving model ...
Epoch: 41 cost time: 1.556565761566162
Epoch: 41, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.938 Vali Acc: 0.251 Test Loss: 3.938 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4330248832702637
Epoch: 42, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.842 Vali Acc: 0.259 Test Loss: 3.842 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3660142421722412
Epoch: 43, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.909 Vali Acc: 0.262 Test Loss: 3.909 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.4157583713531494
Epoch: 44, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.925 Vali Acc: 0.266 Test Loss: 3.925 Test Acc: 0.266
Validation loss decreased (-0.264668 --> -0.265843).  Saving model ...
Epoch: 45 cost time: 1.560187816619873
Epoch: 45, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.940 Vali Acc: 0.267 Test Loss: 3.940 Test Acc: 0.267
Validation loss decreased (-0.265843 --> -0.267019).  Saving model ...
Epoch: 46 cost time: 1.4029371738433838
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.916 Vali Acc: 0.266 Test Loss: 3.916 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.5757319927215576
Epoch: 47, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.936 Vali Acc: 0.268 Test Loss: 3.936 Test Acc: 0.268
Validation loss decreased (-0.267019 --> -0.268196).  Saving model ...
Epoch: 48 cost time: 1.3837816715240479
Epoch: 48, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.952 Vali Acc: 0.264 Test Loss: 3.952 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.3427269458770752
Epoch: 49, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.958 Vali Acc: 0.272 Test Loss: 3.958 Test Acc: 0.272
Validation loss decreased (-0.268196 --> -0.271725).  Saving model ...
Epoch: 50 cost time: 1.319664478302002
Epoch: 50, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.015 Vali Acc: 0.271 Test Loss: 4.015 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.488067865371704
Epoch: 51, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.990 Vali Acc: 0.266 Test Loss: 3.990 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.3050239086151123
Epoch: 52, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.049 Vali Acc: 0.268 Test Loss: 4.049 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.3643169403076172
Epoch: 53, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.017 Vali Acc: 0.262 Test Loss: 4.017 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.4643313884735107
Epoch: 54, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.028 Vali Acc: 0.268 Test Loss: 4.028 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.4118905067443848
Epoch: 55, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.069 Vali Acc: 0.266 Test Loss: 4.069 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.4691345691680908
Epoch: 56, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.084 Vali Acc: 0.266 Test Loss: 4.084 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.3795814514160156
Epoch: 57, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.076 Vali Acc: 0.266 Test Loss: 4.076 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.6475193500518799
Epoch: 58, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.097 Vali Acc: 0.264 Test Loss: 4.097 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.4735074043273926
Epoch: 59, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.096 Vali Acc: 0.271 Test Loss: 4.096 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 1041982
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.001730442047119
Epoch: 1, Steps: 10 | Train Loss: 3.357 Vali Loss: 3.369 Vali Acc: 0.031 Test Loss: 3.369 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.9776246547698975
Epoch: 2, Steps: 10 | Train Loss: 3.281 Vali Loss: 3.342 Vali Acc: 0.053 Test Loss: 3.342 Test Acc: 0.053
Validation loss decreased (-0.030555 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 1.0570175647735596
Epoch: 3, Steps: 10 | Train Loss: 3.206 Vali Loss: 3.352 Vali Acc: 0.042 Test Loss: 3.352 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2101786136627197
Epoch: 4, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.360 Vali Acc: 0.069 Test Loss: 3.360 Test Acc: 0.069
Validation loss decreased (-0.052908 --> -0.069378).  Saving model ...
Epoch: 5 cost time: 1.06186842918396
Epoch: 5, Steps: 10 | Train Loss: 3.080 Vali Loss: 3.327 Vali Acc: 0.059 Test Loss: 3.327 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2961580753326416
Epoch: 6, Steps: 10 | Train Loss: 2.969 Vali Loss: 3.284 Vali Acc: 0.087 Test Loss: 3.284 Test Acc: 0.087
Validation loss decreased (-0.069378 --> -0.087026).  Saving model ...
Epoch: 7 cost time: 1.2488298416137695
Epoch: 7, Steps: 10 | Train Loss: 2.894 Vali Loss: 3.292 Vali Acc: 0.095 Test Loss: 3.292 Test Acc: 0.095
Validation loss decreased (-0.087026 --> -0.095261).  Saving model ...
Epoch: 8 cost time: 1.012500524520874
Epoch: 8, Steps: 10 | Train Loss: 2.786 Vali Loss: 3.297 Vali Acc: 0.106 Test Loss: 3.297 Test Acc: 0.106
Validation loss decreased (-0.095261 --> -0.105849).  Saving model ...
Epoch: 9 cost time: 1.0940468311309814
Epoch: 9, Steps: 10 | Train Loss: 2.636 Vali Loss: 3.253 Vali Acc: 0.126 Test Loss: 3.253 Test Acc: 0.126
Validation loss decreased (-0.105849 --> -0.125850).  Saving model ...
Epoch: 10 cost time: 1.3876078128814697
Epoch: 10, Steps: 10 | Train Loss: 2.492 Vali Loss: 3.253 Vali Acc: 0.129 Test Loss: 3.253 Test Acc: 0.129
Validation loss decreased (-0.125850 --> -0.129379).  Saving model ...
Epoch: 11 cost time: 1.2691221237182617
Epoch: 11, Steps: 10 | Train Loss: 2.329 Vali Loss: 3.244 Vali Acc: 0.142 Test Loss: 3.244 Test Acc: 0.142
Validation loss decreased (-0.129379 --> -0.142321).  Saving model ...
Epoch: 12 cost time: 1.290510654449463
Epoch: 12, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.252 Vali Acc: 0.148 Test Loss: 3.252 Test Acc: 0.148
Validation loss decreased (-0.142321 --> -0.148203).  Saving model ...
Epoch: 13 cost time: 1.2322912216186523
Epoch: 13, Steps: 10 | Train Loss: 2.024 Vali Loss: 3.222 Vali Acc: 0.165 Test Loss: 3.222 Test Acc: 0.165
Validation loss decreased (-0.148203 --> -0.164674).  Saving model ...
Epoch: 14 cost time: 1.2692816257476807
Epoch: 14, Steps: 10 | Train Loss: 1.913 Vali Loss: 3.244 Vali Acc: 0.166 Test Loss: 3.244 Test Acc: 0.166
Validation loss decreased (-0.164674 --> -0.165850).  Saving model ...
Epoch: 15 cost time: 1.1684002876281738
Epoch: 15, Steps: 10 | Train Loss: 1.719 Vali Loss: 3.231 Vali Acc: 0.172 Test Loss: 3.231 Test Acc: 0.172
Validation loss decreased (-0.165850 --> -0.171732).  Saving model ...
Epoch: 16 cost time: 1.2145144939422607
Epoch: 16, Steps: 10 | Train Loss: 1.560 Vali Loss: 3.255 Vali Acc: 0.186 Test Loss: 3.255 Test Acc: 0.186
Validation loss decreased (-0.171732 --> -0.185850).  Saving model ...
Epoch: 17 cost time: 1.199453353881836
Epoch: 17, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.239 Vali Acc: 0.192 Test Loss: 3.239 Test Acc: 0.192
Validation loss decreased (-0.185850 --> -0.191732).  Saving model ...
Epoch: 18 cost time: 1.1828134059906006
Epoch: 18, Steps: 10 | Train Loss: 1.302 Vali Loss: 3.260 Vali Acc: 0.192 Test Loss: 3.260 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.198385238647461
Epoch: 19, Steps: 10 | Train Loss: 1.178 Vali Loss: 3.313 Vali Acc: 0.206 Test Loss: 3.313 Test Acc: 0.206
Validation loss decreased (-0.191732 --> -0.205849).  Saving model ...
Epoch: 20 cost time: 1.2298266887664795
Epoch: 20, Steps: 10 | Train Loss: 1.018 Vali Loss: 3.288 Vali Acc: 0.193 Test Loss: 3.288 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3520376682281494
Epoch: 21, Steps: 10 | Train Loss: 0.875 Vali Loss: 3.328 Vali Acc: 0.207 Test Loss: 3.328 Test Acc: 0.207
Validation loss decreased (-0.205849 --> -0.207026).  Saving model ...
Epoch: 22 cost time: 1.2473766803741455
Epoch: 22, Steps: 10 | Train Loss: 0.765 Vali Loss: 3.317 Vali Acc: 0.209 Test Loss: 3.317 Test Acc: 0.209
Validation loss decreased (-0.207026 --> -0.209379).  Saving model ...
Epoch: 23 cost time: 1.2288999557495117
Epoch: 23, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.370 Vali Acc: 0.214 Test Loss: 3.370 Test Acc: 0.214
Validation loss decreased (-0.209379 --> -0.214084).  Saving model ...
Epoch: 24 cost time: 1.1234862804412842
Epoch: 24, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.414 Vali Acc: 0.215 Test Loss: 3.414 Test Acc: 0.215
Validation loss decreased (-0.214084 --> -0.215260).  Saving model ...
Epoch: 25 cost time: 1.1845285892486572
Epoch: 25, Steps: 10 | Train Loss: 0.463 Vali Loss: 3.461 Vali Acc: 0.213 Test Loss: 3.461 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3382859230041504
Epoch: 26, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.458 Vali Acc: 0.229 Test Loss: 3.458 Test Acc: 0.229
Validation loss decreased (-0.215260 --> -0.229377).  Saving model ...
Epoch: 27 cost time: 1.222170114517212
Epoch: 27, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.457 Vali Acc: 0.225 Test Loss: 3.457 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2043893337249756
Epoch: 28, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.521 Vali Acc: 0.234 Test Loss: 3.521 Test Acc: 0.234
Validation loss decreased (-0.229377 --> -0.234082).  Saving model ...
Epoch: 29 cost time: 1.408632755279541
Epoch: 29, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.557 Vali Acc: 0.229 Test Loss: 3.557 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2615594863891602
Epoch: 30, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.541 Vali Acc: 0.238 Test Loss: 3.541 Test Acc: 0.238
Validation loss decreased (-0.234082 --> -0.237612).  Saving model ...
Epoch: 31 cost time: 1.284949779510498
Epoch: 31, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.636 Vali Acc: 0.247 Test Loss: 3.636 Test Acc: 0.247
Validation loss decreased (-0.237612 --> -0.247022).  Saving model ...
Epoch: 32 cost time: 1.3046412467956543
Epoch: 32, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.553 Vali Acc: 0.246 Test Loss: 3.553 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.321110486984253
Epoch: 33, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.690 Vali Acc: 0.242 Test Loss: 3.690 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.200927734375
Epoch: 34, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.642 Vali Acc: 0.266 Test Loss: 3.642 Test Acc: 0.266
Validation loss decreased (-0.247022 --> -0.265846).  Saving model ...
Epoch: 35 cost time: 1.1656379699707031
Epoch: 35, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.678 Vali Acc: 0.261 Test Loss: 3.678 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1939458847045898
Epoch: 36, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.715 Vali Acc: 0.259 Test Loss: 3.715 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0784657001495361
Epoch: 37, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.775 Vali Acc: 0.256 Test Loss: 3.775 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1642966270446777
Epoch: 38, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.782 Vali Acc: 0.266 Test Loss: 3.782 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6020877361297607
Epoch: 39, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.819 Vali Acc: 0.262 Test Loss: 3.819 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.3524532318115234
Epoch: 40, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.800 Vali Acc: 0.264 Test Loss: 3.800 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2939682006835938
Epoch: 41, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.794 Vali Acc: 0.265 Test Loss: 3.794 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.3152074813842773
Epoch: 42, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.836 Vali Acc: 0.267 Test Loss: 3.836 Test Acc: 0.267
Validation loss decreased (-0.265846 --> -0.267020).  Saving model ...
Epoch: 43 cost time: 1.0250811576843262
Epoch: 43, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.856 Vali Acc: 0.261 Test Loss: 3.856 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.173034429550171
Epoch: 44, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.909 Vali Acc: 0.262 Test Loss: 3.909 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1938502788543701
Epoch: 45, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.912 Vali Acc: 0.267 Test Loss: 3.912 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2335896492004395
Epoch: 46, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.912 Vali Acc: 0.266 Test Loss: 3.912 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.20894455909729
Epoch: 47, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.901 Vali Acc: 0.274 Test Loss: 3.901 Test Acc: 0.274
Validation loss decreased (-0.267020 --> -0.274079).  Saving model ...
Epoch: 48 cost time: 1.3240606784820557
Epoch: 48, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.910 Vali Acc: 0.273 Test Loss: 3.910 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.4475767612457275
Epoch: 49, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.976 Vali Acc: 0.262 Test Loss: 3.976 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3961148262023926
Epoch: 50, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.974 Vali Acc: 0.259 Test Loss: 3.974 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1783504486083984
Epoch: 51, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.951 Vali Acc: 0.271 Test Loss: 3.951 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.3511457443237305
Epoch: 52, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.995 Vali Acc: 0.275 Test Loss: 3.995 Test Acc: 0.275
Validation loss decreased (-0.274079 --> -0.275254).  Saving model ...
Epoch: 53 cost time: 1.3634464740753174
Epoch: 53, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.986 Vali Acc: 0.262 Test Loss: 3.986 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.051891565322876
Epoch: 54, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.987 Vali Acc: 0.271 Test Loss: 3.987 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2621963024139404
Epoch: 55, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.037 Vali Acc: 0.275 Test Loss: 4.037 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.4306910037994385
Epoch: 56, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.039 Vali Acc: 0.268 Test Loss: 4.039 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.2002856731414795
Epoch: 57, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.068 Vali Acc: 0.264 Test Loss: 4.068 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.346879482269287
Epoch: 58, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.057 Vali Acc: 0.261 Test Loss: 4.057 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.3246612548828125
Epoch: 59, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.069 Vali Acc: 0.269 Test Loss: 4.069 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.2077288627624512
Epoch: 60, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.068 Vali Acc: 0.265 Test Loss: 4.068 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.431776523590088
Epoch: 61, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.091 Vali Acc: 0.267 Test Loss: 4.091 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.5620007514953613
Epoch: 62, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.142 Vali Acc: 0.264 Test Loss: 4.142 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 1040702
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.394263505935669
Epoch: 1, Steps: 10 | Train Loss: 3.337 Vali Loss: 3.369 Vali Acc: 0.045 Test Loss: 3.369 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 1.1866462230682373
Epoch: 2, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.341 Vali Acc: 0.058 Test Loss: 3.341 Test Acc: 0.058
Validation loss decreased (-0.044672 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 1.2771778106689453
Epoch: 3, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.352 Vali Acc: 0.064 Test Loss: 3.352 Test Acc: 0.064
Validation loss decreased (-0.057614 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 1.1564586162567139
Epoch: 4, Steps: 10 | Train Loss: 3.101 Vali Loss: 3.323 Vali Acc: 0.080 Test Loss: 3.323 Test Acc: 0.080
Validation loss decreased (-0.063496 --> -0.079967).  Saving model ...
Epoch: 5 cost time: 1.6536781787872314
Epoch: 5, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.303 Vali Acc: 0.087 Test Loss: 3.303 Test Acc: 0.087
Validation loss decreased (-0.079967 --> -0.087026).  Saving model ...
Epoch: 6 cost time: 1.6171965599060059
Epoch: 6, Steps: 10 | Train Loss: 2.924 Vali Loss: 3.290 Vali Acc: 0.073 Test Loss: 3.290 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4559507369995117
Epoch: 7, Steps: 10 | Train Loss: 2.788 Vali Loss: 3.268 Vali Acc: 0.093 Test Loss: 3.268 Test Acc: 0.093
Validation loss decreased (-0.087026 --> -0.092908).  Saving model ...
Epoch: 8 cost time: 1.7627618312835693
Epoch: 8, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.264 Vali Acc: 0.101 Test Loss: 3.264 Test Acc: 0.101
Validation loss decreased (-0.092908 --> -0.101144).  Saving model ...
Epoch: 9 cost time: 1.5513460636138916
Epoch: 9, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.242 Vali Acc: 0.109 Test Loss: 3.242 Test Acc: 0.109
Validation loss decreased (-0.101144 --> -0.109379).  Saving model ...
Epoch: 10 cost time: 1.1037054061889648
Epoch: 10, Steps: 10 | Train Loss: 2.385 Vali Loss: 3.230 Vali Acc: 0.116 Test Loss: 3.230 Test Acc: 0.116
Validation loss decreased (-0.109379 --> -0.116438).  Saving model ...
Epoch: 11 cost time: 1.3333580493927002
Epoch: 11, Steps: 10 | Train Loss: 2.233 Vali Loss: 3.240 Vali Acc: 0.126 Test Loss: 3.240 Test Acc: 0.126
Validation loss decreased (-0.116438 --> -0.125850).  Saving model ...
Epoch: 12 cost time: 1.2434453964233398
Epoch: 12, Steps: 10 | Train Loss: 2.133 Vali Loss: 3.254 Vali Acc: 0.131 Test Loss: 3.254 Test Acc: 0.131
Validation loss decreased (-0.125850 --> -0.130556).  Saving model ...
Epoch: 13 cost time: 1.0383963584899902
Epoch: 13, Steps: 10 | Train Loss: 1.951 Vali Loss: 3.215 Vali Acc: 0.160 Test Loss: 3.215 Test Acc: 0.160
Validation loss decreased (-0.130556 --> -0.159968).  Saving model ...
Epoch: 14 cost time: 1.4126322269439697
Epoch: 14, Steps: 10 | Train Loss: 1.841 Vali Loss: 3.258 Vali Acc: 0.154 Test Loss: 3.258 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.471787691116333
Epoch: 15, Steps: 10 | Train Loss: 1.662 Vali Loss: 3.258 Vali Acc: 0.164 Test Loss: 3.258 Test Acc: 0.164
Validation loss decreased (-0.159968 --> -0.163497).  Saving model ...
Epoch: 16 cost time: 1.2580630779266357
Epoch: 16, Steps: 10 | Train Loss: 1.536 Vali Loss: 3.249 Vali Acc: 0.179 Test Loss: 3.249 Test Acc: 0.179
Validation loss decreased (-0.163497 --> -0.178791).  Saving model ...
Epoch: 17 cost time: 1.4186413288116455
Epoch: 17, Steps: 10 | Train Loss: 1.415 Vali Loss: 3.268 Vali Acc: 0.187 Test Loss: 3.268 Test Acc: 0.187
Validation loss decreased (-0.178791 --> -0.187026).  Saving model ...
Epoch: 18 cost time: 1.2064235210418701
Epoch: 18, Steps: 10 | Train Loss: 1.264 Vali Loss: 3.256 Vali Acc: 0.201 Test Loss: 3.256 Test Acc: 0.201
Validation loss decreased (-0.187026 --> -0.201144).  Saving model ...
Epoch: 19 cost time: 1.485060214996338
Epoch: 19, Steps: 10 | Train Loss: 1.141 Vali Loss: 3.306 Vali Acc: 0.201 Test Loss: 3.306 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1746323108673096
Epoch: 20, Steps: 10 | Train Loss: 1.013 Vali Loss: 3.288 Vali Acc: 0.202 Test Loss: 3.288 Test Acc: 0.202
Validation loss decreased (-0.201144 --> -0.202320).  Saving model ...
Epoch: 21 cost time: 1.20164155960083
Epoch: 21, Steps: 10 | Train Loss: 0.878 Vali Loss: 3.272 Vali Acc: 0.235 Test Loss: 3.272 Test Acc: 0.235
Validation loss decreased (-0.202320 --> -0.235261).  Saving model ...
Epoch: 22 cost time: 1.3261396884918213
Epoch: 22, Steps: 10 | Train Loss: 0.769 Vali Loss: 3.374 Vali Acc: 0.202 Test Loss: 3.374 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.247326374053955
Epoch: 23, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.293 Vali Acc: 0.226 Test Loss: 3.293 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3182897567749023
Epoch: 24, Steps: 10 | Train Loss: 0.597 Vali Loss: 3.331 Vali Acc: 0.236 Test Loss: 3.331 Test Acc: 0.236
Validation loss decreased (-0.235261 --> -0.236437).  Saving model ...
Epoch: 25 cost time: 1.2705094814300537
Epoch: 25, Steps: 10 | Train Loss: 0.512 Vali Loss: 3.369 Vali Acc: 0.246 Test Loss: 3.369 Test Acc: 0.246
Validation loss decreased (-0.236437 --> -0.245849).  Saving model ...
Epoch: 26 cost time: 1.3023955821990967
Epoch: 26, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.433 Vali Acc: 0.236 Test Loss: 3.433 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2088689804077148
Epoch: 27, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.467 Vali Acc: 0.249 Test Loss: 3.467 Test Acc: 0.249
Validation loss decreased (-0.245849 --> -0.249377).  Saving model ...
Epoch: 28 cost time: 1.3111793994903564
Epoch: 28, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.398 Vali Acc: 0.249 Test Loss: 3.398 Test Acc: 0.249
Validation loss decreased (-0.249377 --> -0.249378).  Saving model ...
Epoch: 29 cost time: 1.277909278869629
Epoch: 29, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.461 Vali Acc: 0.252 Test Loss: 3.461 Test Acc: 0.252
Validation loss decreased (-0.249378 --> -0.251730).  Saving model ...
Epoch: 30 cost time: 1.2376251220703125
Epoch: 30, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.508 Vali Acc: 0.254 Test Loss: 3.508 Test Acc: 0.254
Validation loss decreased (-0.251730 --> -0.254083).  Saving model ...
Epoch: 31 cost time: 1.3817200660705566
Epoch: 31, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.543 Vali Acc: 0.256 Test Loss: 3.543 Test Acc: 0.256
Validation loss decreased (-0.254083 --> -0.256435).  Saving model ...
Epoch: 32 cost time: 1.309438705444336
Epoch: 32, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.518 Vali Acc: 0.267 Test Loss: 3.518 Test Acc: 0.267
Validation loss decreased (-0.256435 --> -0.267024).  Saving model ...
Epoch: 33 cost time: 1.302424430847168
Epoch: 33, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.553 Vali Acc: 0.264 Test Loss: 3.553 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2933213710784912
Epoch: 34, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.642 Vali Acc: 0.254 Test Loss: 3.642 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4977126121520996
Epoch: 35, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.595 Vali Acc: 0.262 Test Loss: 3.595 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5151724815368652
Epoch: 36, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.592 Vali Acc: 0.267 Test Loss: 3.592 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5055592060089111
Epoch: 37, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.707 Vali Acc: 0.258 Test Loss: 3.707 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.32362961769104
Epoch: 38, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.683 Vali Acc: 0.269 Test Loss: 3.683 Test Acc: 0.269
Validation loss decreased (-0.267024 --> -0.269375).  Saving model ...
Epoch: 39 cost time: 1.2822353839874268
Epoch: 39, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.675 Vali Acc: 0.265 Test Loss: 3.675 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5407657623291016
Epoch: 40, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.662 Vali Acc: 0.280 Test Loss: 3.662 Test Acc: 0.280
Validation loss decreased (-0.269375 --> -0.279963).  Saving model ...
Epoch: 41 cost time: 1.4431190490722656
Epoch: 41, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.750 Vali Acc: 0.275 Test Loss: 3.750 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5821523666381836
Epoch: 42, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.770 Vali Acc: 0.269 Test Loss: 3.770 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.6599304676055908
Epoch: 43, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.709 Vali Acc: 0.276 Test Loss: 3.709 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.4914627075195312
Epoch: 44, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.773 Vali Acc: 0.276 Test Loss: 3.773 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3205492496490479
Epoch: 45, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.783 Vali Acc: 0.266 Test Loss: 3.783 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.4851088523864746
Epoch: 46, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.771 Vali Acc: 0.281 Test Loss: 3.771 Test Acc: 0.281
Validation loss decreased (-0.279963 --> -0.281139).  Saving model ...
Epoch: 47 cost time: 1.2859861850738525
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.795 Vali Acc: 0.279 Test Loss: 3.795 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.6549842357635498
Epoch: 48, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.804 Vali Acc: 0.276 Test Loss: 3.804 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2083191871643066
Epoch: 49, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.830 Vali Acc: 0.276 Test Loss: 3.830 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.6343364715576172
Epoch: 50, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.842 Vali Acc: 0.284 Test Loss: 3.842 Test Acc: 0.284
Validation loss decreased (-0.281139 --> -0.283491).  Saving model ...
Epoch: 51 cost time: 1.6156589984893799
Epoch: 51, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.860 Vali Acc: 0.280 Test Loss: 3.860 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.237929344177246
Epoch: 52, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.863 Vali Acc: 0.281 Test Loss: 3.863 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.4951329231262207
Epoch: 53, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.857 Vali Acc: 0.280 Test Loss: 3.857 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.3419086933135986
Epoch: 54, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.867 Vali Acc: 0.281 Test Loss: 3.867 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.5449247360229492
Epoch: 55, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.890 Vali Acc: 0.278 Test Loss: 3.890 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.4134702682495117
Epoch: 56, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.897 Vali Acc: 0.278 Test Loss: 3.897 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.4387128353118896
Epoch: 57, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.892 Vali Acc: 0.285 Test Loss: 3.892 Test Acc: 0.285
Validation loss decreased (-0.283491 --> -0.284667).  Saving model ...
Epoch: 58 cost time: 1.2712054252624512
Epoch: 58, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.899 Vali Acc: 0.284 Test Loss: 3.899 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.5313341617584229
Epoch: 59, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.882 Vali Acc: 0.284 Test Loss: 3.882 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.4150135517120361
Epoch: 60, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.916 Vali Acc: 0.276 Test Loss: 3.916 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.448418140411377
Epoch: 61, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.933 Vali Acc: 0.281 Test Loss: 3.933 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.3854467868804932
Epoch: 62, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.938 Vali Acc: 0.282 Test Loss: 3.938 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.6139671802520752
Epoch: 63, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.941 Vali Acc: 0.284 Test Loss: 3.941 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.9032678604125977
Epoch: 64, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.941 Vali Acc: 0.284 Test Loss: 3.941 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.3169591426849365
Epoch: 65, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.963 Vali Acc: 0.288 Test Loss: 3.963 Test Acc: 0.288
Validation loss decreased (-0.284667 --> -0.288196).  Saving model ...
Epoch: 66 cost time: 1.2435131072998047
Epoch: 66, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.978 Vali Acc: 0.291 Test Loss: 3.978 Test Acc: 0.291
Validation loss decreased (-0.288196 --> -0.290548).  Saving model ...
Epoch: 67 cost time: 1.296337366104126
Epoch: 67, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.988 Vali Acc: 0.285 Test Loss: 3.988 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.2999751567840576
Epoch: 68, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.025 Vali Acc: 0.279 Test Loss: 4.025 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.475719928741455
Epoch: 69, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.001 Vali Acc: 0.286 Test Loss: 4.001 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.237778902053833
Epoch: 70, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.016 Vali Acc: 0.285 Test Loss: 4.016 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.2255637645721436
Epoch: 71, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.012 Vali Acc: 0.281 Test Loss: 4.012 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.3069429397583008
Epoch: 72, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.050 Vali Acc: 0.281 Test Loss: 4.050 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.2845046520233154
Epoch: 73, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.077 Vali Acc: 0.280 Test Loss: 4.077 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.3534290790557861
Epoch: 74, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.056 Vali Acc: 0.285 Test Loss: 4.056 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.1558477878570557
Epoch: 75, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.060 Vali Acc: 0.284 Test Loss: 4.060 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.2675144672393799
Epoch: 76, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.068 Vali Acc: 0.286 Test Loss: 4.068 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 1039422
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.035876512527466
Epoch: 1, Steps: 10 | Train Loss: 3.457 Vali Loss: 3.365 Vali Acc: 0.044 Test Loss: 3.365 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.4541728496551514
Epoch: 2, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.315 Vali Acc: 0.064 Test Loss: 3.315 Test Acc: 0.064
Validation loss decreased (-0.043496 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 1.4139821529388428
Epoch: 3, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.344 Vali Acc: 0.065 Test Loss: 3.344 Test Acc: 0.065
Validation loss decreased (-0.063496 --> -0.064672).  Saving model ...
Epoch: 4 cost time: 1.173689842224121
Epoch: 4, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.336 Vali Acc: 0.066 Test Loss: 3.336 Test Acc: 0.066
Validation loss decreased (-0.064672 --> -0.065849).  Saving model ...
Epoch: 5 cost time: 1.084575891494751
Epoch: 5, Steps: 10 | Train Loss: 3.155 Vali Loss: 3.323 Vali Acc: 0.075 Test Loss: 3.323 Test Acc: 0.075
Validation loss decreased (-0.065849 --> -0.075261).  Saving model ...
Epoch: 6 cost time: 1.2149763107299805
Epoch: 6, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.282 Vali Acc: 0.093 Test Loss: 3.282 Test Acc: 0.093
Validation loss decreased (-0.075261 --> -0.092908).  Saving model ...
Epoch: 7 cost time: 1.0904171466827393
Epoch: 7, Steps: 10 | Train Loss: 2.929 Vali Loss: 3.274 Vali Acc: 0.087 Test Loss: 3.274 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.501802682876587
Epoch: 8, Steps: 10 | Train Loss: 2.828 Vali Loss: 3.285 Vali Acc: 0.102 Test Loss: 3.285 Test Acc: 0.102
Validation loss decreased (-0.092908 --> -0.102320).  Saving model ...
Epoch: 9 cost time: 1.1789209842681885
Epoch: 9, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.255 Vali Acc: 0.131 Test Loss: 3.255 Test Acc: 0.131
Validation loss decreased (-0.102320 --> -0.130556).  Saving model ...
Epoch: 10 cost time: 1.5100173950195312
Epoch: 10, Steps: 10 | Train Loss: 2.571 Vali Loss: 3.228 Vali Acc: 0.124 Test Loss: 3.228 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3134193420410156
Epoch: 11, Steps: 10 | Train Loss: 2.501 Vali Loss: 3.242 Vali Acc: 0.127 Test Loss: 3.242 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3312864303588867
Epoch: 12, Steps: 10 | Train Loss: 2.366 Vali Loss: 3.226 Vali Acc: 0.154 Test Loss: 3.226 Test Acc: 0.154
Validation loss decreased (-0.130556 --> -0.154085).  Saving model ...
Epoch: 13 cost time: 1.3178062438964844
Epoch: 13, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.240 Vali Acc: 0.149 Test Loss: 3.240 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5767238140106201
Epoch: 14, Steps: 10 | Train Loss: 2.029 Vali Loss: 3.222 Vali Acc: 0.154 Test Loss: 3.222 Test Acc: 0.154
Validation loss decreased (-0.154085 --> -0.154085).  Saving model ...
Epoch: 15 cost time: 1.534693717956543
Epoch: 15, Steps: 10 | Train Loss: 1.887 Vali Loss: 3.224 Vali Acc: 0.168 Test Loss: 3.224 Test Acc: 0.168
Validation loss decreased (-0.154085 --> -0.168203).  Saving model ...
Epoch: 16 cost time: 1.3273084163665771
Epoch: 16, Steps: 10 | Train Loss: 1.795 Vali Loss: 3.245 Vali Acc: 0.168 Test Loss: 3.245 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4127874374389648
Epoch: 17, Steps: 10 | Train Loss: 1.687 Vali Loss: 3.218 Vali Acc: 0.194 Test Loss: 3.218 Test Acc: 0.194
Validation loss decreased (-0.168203 --> -0.194085).  Saving model ...
Epoch: 18 cost time: 1.3698668479919434
Epoch: 18, Steps: 10 | Train Loss: 1.524 Vali Loss: 3.251 Vali Acc: 0.193 Test Loss: 3.251 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2922306060791016
Epoch: 19, Steps: 10 | Train Loss: 1.377 Vali Loss: 3.271 Vali Acc: 0.193 Test Loss: 3.271 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.475440502166748
Epoch: 20, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.261 Vali Acc: 0.221 Test Loss: 3.261 Test Acc: 0.221
Validation loss decreased (-0.194085 --> -0.221144).  Saving model ...
Epoch: 21 cost time: 1.2618391513824463
Epoch: 21, Steps: 10 | Train Loss: 1.149 Vali Loss: 3.301 Vali Acc: 0.201 Test Loss: 3.301 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3868052959442139
Epoch: 22, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.288 Vali Acc: 0.233 Test Loss: 3.288 Test Acc: 0.233
Validation loss decreased (-0.221144 --> -0.232908).  Saving model ...
Epoch: 23 cost time: 1.2974660396575928
Epoch: 23, Steps: 10 | Train Loss: 0.844 Vali Loss: 3.305 Vali Acc: 0.232 Test Loss: 3.305 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2948317527770996
Epoch: 24, Steps: 10 | Train Loss: 0.804 Vali Loss: 3.348 Vali Acc: 0.226 Test Loss: 3.348 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.382772445678711
Epoch: 25, Steps: 10 | Train Loss: 0.709 Vali Loss: 3.361 Vali Acc: 0.248 Test Loss: 3.361 Test Acc: 0.248
Validation loss decreased (-0.232908 --> -0.248202).  Saving model ...
Epoch: 26 cost time: 1.461411714553833
Epoch: 26, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.357 Vali Acc: 0.238 Test Loss: 3.357 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3062891960144043
Epoch: 27, Steps: 10 | Train Loss: 0.503 Vali Loss: 3.448 Vali Acc: 0.236 Test Loss: 3.448 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.349240779876709
Epoch: 28, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.446 Vali Acc: 0.249 Test Loss: 3.446 Test Acc: 0.249
Validation loss decreased (-0.248202 --> -0.249377).  Saving model ...
Epoch: 29 cost time: 1.2192151546478271
Epoch: 29, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.466 Vali Acc: 0.253 Test Loss: 3.466 Test Acc: 0.253
Validation loss decreased (-0.249377 --> -0.252907).  Saving model ...
Epoch: 30 cost time: 1.358715295791626
Epoch: 30, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.579 Vali Acc: 0.246 Test Loss: 3.579 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3918302059173584
Epoch: 31, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.603 Vali Acc: 0.245 Test Loss: 3.603 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3162767887115479
Epoch: 32, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.523 Vali Acc: 0.271 Test Loss: 3.523 Test Acc: 0.271
Validation loss decreased (-0.252907 --> -0.270553).  Saving model ...
Epoch: 33 cost time: 1.2258191108703613
Epoch: 33, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.651 Vali Acc: 0.267 Test Loss: 3.651 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4434924125671387
Epoch: 34, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.597 Vali Acc: 0.261 Test Loss: 3.597 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4616711139678955
Epoch: 35, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.719 Vali Acc: 0.248 Test Loss: 3.719 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1500542163848877
Epoch: 36, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.733 Vali Acc: 0.254 Test Loss: 3.733 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.457686424255371
Epoch: 37, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.761 Vali Acc: 0.260 Test Loss: 3.761 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.228795051574707
Epoch: 38, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.783 Vali Acc: 0.260 Test Loss: 3.783 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.386624813079834
Epoch: 39, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.721 Vali Acc: 0.275 Test Loss: 3.721 Test Acc: 0.275
Validation loss decreased (-0.270553 --> -0.275257).  Saving model ...
Epoch: 40 cost time: 1.4404256343841553
Epoch: 40, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.780 Vali Acc: 0.269 Test Loss: 3.780 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7041797637939453
Epoch: 41, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.817 Vali Acc: 0.261 Test Loss: 3.817 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7459890842437744
Epoch: 42, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.816 Vali Acc: 0.268 Test Loss: 3.816 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.7725954055786133
Epoch: 43, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.840 Vali Acc: 0.262 Test Loss: 3.840 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.5911614894866943
Epoch: 44, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.882 Vali Acc: 0.272 Test Loss: 3.882 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.7962853908538818
Epoch: 45, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.886 Vali Acc: 0.274 Test Loss: 3.886 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.662651777267456
Epoch: 46, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.884 Vali Acc: 0.274 Test Loss: 3.884 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.9164702892303467
Epoch: 47, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.877 Vali Acc: 0.274 Test Loss: 3.877 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.6214103698730469
Epoch: 48, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.928 Vali Acc: 0.276 Test Loss: 3.928 Test Acc: 0.276
Validation loss decreased (-0.275257 --> -0.276431).  Saving model ...
Epoch: 49 cost time: 1.6184213161468506
Epoch: 49, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.946 Vali Acc: 0.265 Test Loss: 3.946 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.6471645832061768
Epoch: 50, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.953 Vali Acc: 0.273 Test Loss: 3.953 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.599165916442871
Epoch: 51, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.939 Vali Acc: 0.276 Test Loss: 3.939 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.4968171119689941
Epoch: 52, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.954 Vali Acc: 0.276 Test Loss: 3.954 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.6690912246704102
Epoch: 53, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.967 Vali Acc: 0.276 Test Loss: 3.967 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.527026653289795
Epoch: 54, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.001 Vali Acc: 0.278 Test Loss: 4.001 Test Acc: 0.278
Validation loss decreased (-0.276431 --> -0.277607).  Saving model ...
Epoch: 55 cost time: 1.7470502853393555
Epoch: 55, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.003 Vali Acc: 0.275 Test Loss: 4.003 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.624455213546753
Epoch: 56, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.057 Vali Acc: 0.272 Test Loss: 4.057 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.6332287788391113
Epoch: 57, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.118 Vali Acc: 0.285 Test Loss: 4.118 Test Acc: 0.285
Validation loss decreased (-0.277607 --> -0.284665).  Saving model ...
Epoch: 58 cost time: 1.545947790145874
Epoch: 58, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.061 Vali Acc: 0.266 Test Loss: 4.061 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2845039367675781
Epoch: 59, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.070 Vali Acc: 0.276 Test Loss: 4.070 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.5677175521850586
Epoch: 60, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.074 Vali Acc: 0.273 Test Loss: 4.074 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.6503474712371826
Epoch: 61, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.087 Vali Acc: 0.273 Test Loss: 4.087 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.775947093963623
Epoch: 62, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.089 Vali Acc: 0.284 Test Loss: 4.089 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.3037872314453125
Epoch: 63, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.080 Vali Acc: 0.279 Test Loss: 4.080 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.8455605506896973
Epoch: 64, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.095 Vali Acc: 0.286 Test Loss: 4.095 Test Acc: 0.286
Validation loss decreased (-0.284665 --> -0.285841).  Saving model ...
Epoch: 65 cost time: 1.6850910186767578
Epoch: 65, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.119 Vali Acc: 0.275 Test Loss: 4.119 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.6752440929412842
Epoch: 66, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.142 Vali Acc: 0.276 Test Loss: 4.142 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.6406617164611816
Epoch: 67, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.129 Vali Acc: 0.275 Test Loss: 4.129 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.673311471939087
Epoch: 68, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.136 Vali Acc: 0.278 Test Loss: 4.136 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.863123893737793
Epoch: 69, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.150 Vali Acc: 0.282 Test Loss: 4.150 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.8364274501800537
Epoch: 70, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.170 Vali Acc: 0.275 Test Loss: 4.170 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.384045124053955
Epoch: 71, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.200 Vali Acc: 0.275 Test Loss: 4.200 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.6647813320159912
Epoch: 72, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.199 Vali Acc: 0.279 Test Loss: 4.199 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.4096183776855469
Epoch: 73, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.199 Vali Acc: 0.280 Test Loss: 4.199 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 2.4577348232269287
Epoch: 74, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.229 Vali Acc: 0.279 Test Loss: 4.229 Test Acc: 0.279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2858823529411765
model parameter : 713022
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.916903018951416
Epoch: 1, Steps: 10 | Train Loss: 3.404 Vali Loss: 3.363 Vali Acc: 0.034 Test Loss: 3.363 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 1.320129632949829
Epoch: 2, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.352 Vali Acc: 0.046 Test Loss: 3.352 Test Acc: 0.046
Validation loss decreased (-0.034084 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 1.1715381145477295
Epoch: 3, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.367 Vali Acc: 0.032 Test Loss: 3.367 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2600183486938477
Epoch: 4, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.362 Vali Acc: 0.049 Test Loss: 3.362 Test Acc: 0.049
Validation loss decreased (-0.045849 --> -0.049378).  Saving model ...
Epoch: 5 cost time: 1.1018457412719727
Epoch: 5, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.338 Vali Acc: 0.068 Test Loss: 3.338 Test Acc: 0.068
Validation loss decreased (-0.049378 --> -0.068202).  Saving model ...
Epoch: 6 cost time: 1.2090928554534912
Epoch: 6, Steps: 10 | Train Loss: 3.064 Vali Loss: 3.326 Vali Acc: 0.042 Test Loss: 3.326 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.458404779434204
Epoch: 7, Steps: 10 | Train Loss: 3.002 Vali Loss: 3.316 Vali Acc: 0.074 Test Loss: 3.316 Test Acc: 0.074
Validation loss decreased (-0.068202 --> -0.074084).  Saving model ...
Epoch: 8 cost time: 1.4059884548187256
Epoch: 8, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.273 Vali Acc: 0.086 Test Loss: 3.273 Test Acc: 0.086
Validation loss decreased (-0.074084 --> -0.085850).  Saving model ...
Epoch: 9 cost time: 1.6174137592315674
Epoch: 9, Steps: 10 | Train Loss: 2.756 Vali Loss: 3.256 Vali Acc: 0.091 Test Loss: 3.256 Test Acc: 0.091
Validation loss decreased (-0.085850 --> -0.090556).  Saving model ...
Epoch: 10 cost time: 1.3601324558258057
Epoch: 10, Steps: 10 | Train Loss: 2.669 Vali Loss: 3.270 Vali Acc: 0.101 Test Loss: 3.270 Test Acc: 0.101
Validation loss decreased (-0.090556 --> -0.101144).  Saving model ...
Epoch: 11 cost time: 1.2292475700378418
Epoch: 11, Steps: 10 | Train Loss: 2.507 Vali Loss: 3.235 Vali Acc: 0.121 Test Loss: 3.235 Test Acc: 0.121
Validation loss decreased (-0.101144 --> -0.121144).  Saving model ...
Epoch: 12 cost time: 1.2079064846038818
Epoch: 12, Steps: 10 | Train Loss: 2.358 Vali Loss: 3.233 Vali Acc: 0.124 Test Loss: 3.233 Test Acc: 0.124
Validation loss decreased (-0.121144 --> -0.123497).  Saving model ...
Epoch: 13 cost time: 1.183018684387207
Epoch: 13, Steps: 10 | Train Loss: 2.295 Vali Loss: 3.227 Vali Acc: 0.139 Test Loss: 3.227 Test Acc: 0.139
Validation loss decreased (-0.123497 --> -0.138791).  Saving model ...
Epoch: 14 cost time: 1.3226492404937744
Epoch: 14, Steps: 10 | Train Loss: 2.078 Vali Loss: 3.204 Vali Acc: 0.141 Test Loss: 3.204 Test Acc: 0.141
Validation loss decreased (-0.138791 --> -0.141144).  Saving model ...
Epoch: 15 cost time: 1.1287357807159424
Epoch: 15, Steps: 10 | Train Loss: 1.935 Vali Loss: 3.252 Vali Acc: 0.140 Test Loss: 3.252 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.136183738708496
Epoch: 16, Steps: 10 | Train Loss: 1.841 Vali Loss: 3.223 Vali Acc: 0.169 Test Loss: 3.223 Test Acc: 0.169
Validation loss decreased (-0.141144 --> -0.169380).  Saving model ...
Epoch: 17 cost time: 1.198094367980957
Epoch: 17, Steps: 10 | Train Loss: 1.621 Vali Loss: 3.215 Vali Acc: 0.186 Test Loss: 3.215 Test Acc: 0.186
Validation loss decreased (-0.169380 --> -0.185850).  Saving model ...
Epoch: 18 cost time: 1.212120771408081
Epoch: 18, Steps: 10 | Train Loss: 1.529 Vali Loss: 3.222 Vali Acc: 0.179 Test Loss: 3.222 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2588183879852295
Epoch: 19, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.222 Vali Acc: 0.208 Test Loss: 3.222 Test Acc: 0.208
Validation loss decreased (-0.185850 --> -0.208203).  Saving model ...
Epoch: 20 cost time: 1.3568975925445557
Epoch: 20, Steps: 10 | Train Loss: 1.264 Vali Loss: 3.260 Vali Acc: 0.194 Test Loss: 3.260 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2939379215240479
Epoch: 21, Steps: 10 | Train Loss: 1.115 Vali Loss: 3.269 Vali Acc: 0.211 Test Loss: 3.269 Test Acc: 0.211
Validation loss decreased (-0.208203 --> -0.210556).  Saving model ...
Epoch: 22 cost time: 1.2308549880981445
Epoch: 22, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.249 Vali Acc: 0.229 Test Loss: 3.249 Test Acc: 0.229
Validation loss decreased (-0.210556 --> -0.229379).  Saving model ...
Epoch: 23 cost time: 1.3852503299713135
Epoch: 23, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.292 Vali Acc: 0.225 Test Loss: 3.292 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2524147033691406
Epoch: 24, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.309 Vali Acc: 0.231 Test Loss: 3.309 Test Acc: 0.231
Validation loss decreased (-0.229379 --> -0.230555).  Saving model ...
Epoch: 25 cost time: 1.0986452102661133
Epoch: 25, Steps: 10 | Train Loss: 0.710 Vali Loss: 3.356 Vali Acc: 0.234 Test Loss: 3.356 Test Acc: 0.234
Validation loss decreased (-0.230555 --> -0.234084).  Saving model ...
Epoch: 26 cost time: 1.0670149326324463
Epoch: 26, Steps: 10 | Train Loss: 0.637 Vali Loss: 3.347 Vali Acc: 0.240 Test Loss: 3.347 Test Acc: 0.240
Validation loss decreased (-0.234084 --> -0.239967).  Saving model ...
Epoch: 27 cost time: 1.2631075382232666
Epoch: 27, Steps: 10 | Train Loss: 0.496 Vali Loss: 3.392 Vali Acc: 0.235 Test Loss: 3.392 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3741955757141113
Epoch: 28, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.448 Vali Acc: 0.232 Test Loss: 3.448 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3062608242034912
Epoch: 29, Steps: 10 | Train Loss: 0.347 Vali Loss: 3.489 Vali Acc: 0.232 Test Loss: 3.489 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2027685642242432
Epoch: 30, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.506 Vali Acc: 0.247 Test Loss: 3.506 Test Acc: 0.247
Validation loss decreased (-0.239967 --> -0.247024).  Saving model ...
Epoch: 31 cost time: 1.4006361961364746
Epoch: 31, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.517 Vali Acc: 0.248 Test Loss: 3.517 Test Acc: 0.248
Validation loss decreased (-0.247024 --> -0.248200).  Saving model ...
Epoch: 32 cost time: 1.3686728477478027
Epoch: 32, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.647 Vali Acc: 0.242 Test Loss: 3.647 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.176741361618042
Epoch: 33, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.551 Vali Acc: 0.254 Test Loss: 3.551 Test Acc: 0.254
Validation loss decreased (-0.248200 --> -0.254082).  Saving model ...
Epoch: 34 cost time: 1.2135848999023438
Epoch: 34, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.684 Vali Acc: 0.254 Test Loss: 3.684 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.367210865020752
Epoch: 35, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.754 Vali Acc: 0.234 Test Loss: 3.754 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2343337535858154
Epoch: 36, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.703 Vali Acc: 0.255 Test Loss: 3.703 Test Acc: 0.255
Validation loss decreased (-0.254082 --> -0.255257).  Saving model ...
Epoch: 37 cost time: 1.1777679920196533
Epoch: 37, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.728 Vali Acc: 0.246 Test Loss: 3.728 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2263619899749756
Epoch: 38, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.823 Vali Acc: 0.253 Test Loss: 3.823 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3905718326568604
Epoch: 39, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.714 Vali Acc: 0.266 Test Loss: 3.714 Test Acc: 0.266
Validation loss decreased (-0.255257 --> -0.265845).  Saving model ...
Epoch: 40 cost time: 1.1562049388885498
Epoch: 40, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.799 Vali Acc: 0.260 Test Loss: 3.799 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3451488018035889
Epoch: 41, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.775 Vali Acc: 0.260 Test Loss: 3.775 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2428271770477295
Epoch: 42, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.878 Vali Acc: 0.252 Test Loss: 3.878 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.4043715000152588
Epoch: 43, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.819 Vali Acc: 0.272 Test Loss: 3.819 Test Acc: 0.272
Validation loss decreased (-0.265845 --> -0.271727).  Saving model ...
Epoch: 44 cost time: 1.3411927223205566
Epoch: 44, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.900 Vali Acc: 0.265 Test Loss: 3.900 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.233748197555542
Epoch: 45, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.884 Vali Acc: 0.262 Test Loss: 3.884 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.459519386291504
Epoch: 46, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.922 Vali Acc: 0.264 Test Loss: 3.922 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.4813427925109863
Epoch: 47, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.927 Vali Acc: 0.264 Test Loss: 3.927 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.4275484085083008
Epoch: 48, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.927 Vali Acc: 0.268 Test Loss: 3.927 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3047919273376465
Epoch: 49, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.943 Vali Acc: 0.269 Test Loss: 3.943 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.22688627243042
Epoch: 50, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.947 Vali Acc: 0.269 Test Loss: 3.947 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.3402090072631836
Epoch: 51, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.934 Vali Acc: 0.274 Test Loss: 3.934 Test Acc: 0.274
Validation loss decreased (-0.271727 --> -0.274078).  Saving model ...
Epoch: 52 cost time: 1.211648941040039
Epoch: 52, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.021 Vali Acc: 0.268 Test Loss: 4.021 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2438938617706299
Epoch: 53, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.028 Vali Acc: 0.259 Test Loss: 4.028 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.2785284519195557
Epoch: 54, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.004 Vali Acc: 0.267 Test Loss: 4.004 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.2062411308288574
Epoch: 55, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.027 Vali Acc: 0.268 Test Loss: 4.027 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.2055919170379639
Epoch: 56, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.049 Vali Acc: 0.267 Test Loss: 4.049 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.1721758842468262
Epoch: 57, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.061 Vali Acc: 0.266 Test Loss: 4.061 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.2987985610961914
Epoch: 58, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.070 Vali Acc: 0.272 Test Loss: 4.070 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.3190903663635254
Epoch: 59, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.092 Vali Acc: 0.272 Test Loss: 4.092 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.3637840747833252
Epoch: 60, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.095 Vali Acc: 0.274 Test Loss: 4.095 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.3691301345825195
Epoch: 61, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.083 Vali Acc: 0.274 Test Loss: 4.083 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 711742
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.759226083755493
Epoch: 1, Steps: 10 | Train Loss: 3.360 Vali Loss: 3.348 Vali Acc: 0.039 Test Loss: 3.348 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.34568190574646
Epoch: 2, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.302 Vali Acc: 0.051 Test Loss: 3.302 Test Acc: 0.051
Validation loss decreased (-0.038790 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 1.2459120750427246
Epoch: 3, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.328 Vali Acc: 0.051 Test Loss: 3.328 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.441807746887207
Epoch: 4, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.353 Vali Acc: 0.066 Test Loss: 3.353 Test Acc: 0.066
Validation loss decreased (-0.050555 --> -0.065849).  Saving model ...
Epoch: 5 cost time: 1.2758376598358154
Epoch: 5, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.305 Vali Acc: 0.064 Test Loss: 3.305 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3952407836914062
Epoch: 6, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.260 Vali Acc: 0.080 Test Loss: 3.260 Test Acc: 0.080
Validation loss decreased (-0.065849 --> -0.079967).  Saving model ...
Epoch: 7 cost time: 1.2595922946929932
Epoch: 7, Steps: 10 | Train Loss: 2.923 Vali Loss: 3.255 Vali Acc: 0.082 Test Loss: 3.255 Test Acc: 0.082
Validation loss decreased (-0.079967 --> -0.082320).  Saving model ...
Epoch: 8 cost time: 1.3612899780273438
Epoch: 8, Steps: 10 | Train Loss: 2.815 Vali Loss: 3.270 Vali Acc: 0.087 Test Loss: 3.270 Test Acc: 0.087
Validation loss decreased (-0.082320 --> -0.087026).  Saving model ...
Epoch: 9 cost time: 1.4013593196868896
Epoch: 9, Steps: 10 | Train Loss: 2.746 Vali Loss: 3.238 Vali Acc: 0.109 Test Loss: 3.238 Test Acc: 0.109
Validation loss decreased (-0.087026 --> -0.109379).  Saving model ...
Epoch: 10 cost time: 1.3455524444580078
Epoch: 10, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.222 Vali Acc: 0.128 Test Loss: 3.222 Test Acc: 0.128
Validation loss decreased (-0.109379 --> -0.128203).  Saving model ...
Epoch: 11 cost time: 1.2878127098083496
Epoch: 11, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.199 Vali Acc: 0.116 Test Loss: 3.199 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4923226833343506
Epoch: 12, Steps: 10 | Train Loss: 2.328 Vali Loss: 3.208 Vali Acc: 0.135 Test Loss: 3.208 Test Acc: 0.135
Validation loss decreased (-0.128203 --> -0.135262).  Saving model ...
Epoch: 13 cost time: 1.241379976272583
Epoch: 13, Steps: 10 | Train Loss: 2.211 Vali Loss: 3.204 Vali Acc: 0.135 Test Loss: 3.204 Test Acc: 0.135
Validation loss decreased (-0.135262 --> -0.135262).  Saving model ...
Epoch: 14 cost time: 1.455944299697876
Epoch: 14, Steps: 10 | Train Loss: 2.053 Vali Loss: 3.209 Vali Acc: 0.136 Test Loss: 3.209 Test Acc: 0.136
Validation loss decreased (-0.135262 --> -0.136438).  Saving model ...
Epoch: 15 cost time: 1.129601240158081
Epoch: 15, Steps: 10 | Train Loss: 1.909 Vali Loss: 3.202 Vali Acc: 0.152 Test Loss: 3.202 Test Acc: 0.152
Validation loss decreased (-0.136438 --> -0.151733).  Saving model ...
Epoch: 16 cost time: 1.3364160060882568
Epoch: 16, Steps: 10 | Train Loss: 1.744 Vali Loss: 3.220 Vali Acc: 0.166 Test Loss: 3.220 Test Acc: 0.166
Validation loss decreased (-0.151733 --> -0.165850).  Saving model ...
Epoch: 17 cost time: 1.482093334197998
Epoch: 17, Steps: 10 | Train Loss: 1.688 Vali Loss: 3.219 Vali Acc: 0.175 Test Loss: 3.219 Test Acc: 0.175
Validation loss decreased (-0.165850 --> -0.175262).  Saving model ...
Epoch: 18 cost time: 1.2786989212036133
Epoch: 18, Steps: 10 | Train Loss: 1.461 Vali Loss: 3.239 Vali Acc: 0.161 Test Loss: 3.239 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.445709466934204
Epoch: 19, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.230 Vali Acc: 0.194 Test Loss: 3.230 Test Acc: 0.194
Validation loss decreased (-0.175262 --> -0.194085).  Saving model ...
Epoch: 20 cost time: 1.2316229343414307
Epoch: 20, Steps: 10 | Train Loss: 1.239 Vali Loss: 3.277 Vali Acc: 0.204 Test Loss: 3.277 Test Acc: 0.204
Validation loss decreased (-0.194085 --> -0.203497).  Saving model ...
Epoch: 21 cost time: 1.0700740814208984
Epoch: 21, Steps: 10 | Train Loss: 1.156 Vali Loss: 3.256 Vali Acc: 0.204 Test Loss: 3.256 Test Acc: 0.204
Validation loss decreased (-0.203497 --> -0.203497).  Saving model ...
Epoch: 22 cost time: 1.2406668663024902
Epoch: 22, Steps: 10 | Train Loss: 0.998 Vali Loss: 3.310 Vali Acc: 0.218 Test Loss: 3.310 Test Acc: 0.218
Validation loss decreased (-0.203497 --> -0.217614).  Saving model ...
Epoch: 23 cost time: 1.2787091732025146
Epoch: 23, Steps: 10 | Train Loss: 0.881 Vali Loss: 3.309 Vali Acc: 0.220 Test Loss: 3.309 Test Acc: 0.220
Validation loss decreased (-0.217614 --> -0.219967).  Saving model ...
Epoch: 24 cost time: 1.4078795909881592
Epoch: 24, Steps: 10 | Train Loss: 0.780 Vali Loss: 3.312 Vali Acc: 0.229 Test Loss: 3.312 Test Acc: 0.229
Validation loss decreased (-0.219967 --> -0.229379).  Saving model ...
Epoch: 25 cost time: 1.45172119140625
Epoch: 25, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.371 Vali Acc: 0.229 Test Loss: 3.371 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1712086200714111
Epoch: 26, Steps: 10 | Train Loss: 0.618 Vali Loss: 3.435 Vali Acc: 0.219 Test Loss: 3.435 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3699300289154053
Epoch: 27, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.424 Vali Acc: 0.234 Test Loss: 3.424 Test Acc: 0.234
Validation loss decreased (-0.229379 --> -0.234083).  Saving model ...
Epoch: 28 cost time: 1.3393337726593018
Epoch: 28, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.442 Vali Acc: 0.240 Test Loss: 3.442 Test Acc: 0.240
Validation loss decreased (-0.234083 --> -0.239966).  Saving model ...
Epoch: 29 cost time: 1.2020106315612793
Epoch: 29, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.490 Vali Acc: 0.256 Test Loss: 3.490 Test Acc: 0.256
Validation loss decreased (-0.239966 --> -0.256436).  Saving model ...
Epoch: 30 cost time: 1.277451753616333
Epoch: 30, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.502 Vali Acc: 0.233 Test Loss: 3.502 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3752484321594238
Epoch: 31, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.598 Vali Acc: 0.262 Test Loss: 3.598 Test Acc: 0.262
Validation loss decreased (-0.256436 --> -0.262317).  Saving model ...
Epoch: 32 cost time: 1.3787286281585693
Epoch: 32, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.546 Vali Acc: 0.255 Test Loss: 3.546 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8381390571594238
Epoch: 33, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.635 Vali Acc: 0.242 Test Loss: 3.635 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2449326515197754
Epoch: 34, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.751 Vali Acc: 0.241 Test Loss: 3.751 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4436683654785156
Epoch: 35, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.650 Vali Acc: 0.259 Test Loss: 3.650 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.470294713973999
Epoch: 36, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.709 Vali Acc: 0.259 Test Loss: 3.709 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2067782878875732
Epoch: 37, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.750 Vali Acc: 0.252 Test Loss: 3.750 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1560096740722656
Epoch: 38, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.730 Vali Acc: 0.260 Test Loss: 3.730 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3836545944213867
Epoch: 39, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.751 Vali Acc: 0.271 Test Loss: 3.751 Test Acc: 0.271
Validation loss decreased (-0.262317 --> -0.270551).  Saving model ...
Epoch: 40 cost time: 1.2517061233520508
Epoch: 40, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.764 Vali Acc: 0.268 Test Loss: 3.764 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1291611194610596
Epoch: 41, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.830 Vali Acc: 0.262 Test Loss: 3.830 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3700387477874756
Epoch: 42, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.852 Vali Acc: 0.258 Test Loss: 3.852 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0287222862243652
Epoch: 43, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.858 Vali Acc: 0.273 Test Loss: 3.858 Test Acc: 0.273
Validation loss decreased (-0.270551 --> -0.272903).  Saving model ...
Epoch: 44 cost time: 1.236647367477417
Epoch: 44, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.846 Vali Acc: 0.272 Test Loss: 3.846 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3874874114990234
Epoch: 45, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.890 Vali Acc: 0.268 Test Loss: 3.890 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3934321403503418
Epoch: 46, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.881 Vali Acc: 0.267 Test Loss: 3.881 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2586820125579834
Epoch: 47, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.900 Vali Acc: 0.272 Test Loss: 3.900 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.4778790473937988
Epoch: 48, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.924 Vali Acc: 0.275 Test Loss: 3.924 Test Acc: 0.275
Validation loss decreased (-0.272903 --> -0.275255).  Saving model ...
Epoch: 49 cost time: 1.4914286136627197
Epoch: 49, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.974 Vali Acc: 0.268 Test Loss: 3.974 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.5695703029632568
Epoch: 50, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.969 Vali Acc: 0.273 Test Loss: 3.969 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.2420475482940674
Epoch: 51, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.972 Vali Acc: 0.271 Test Loss: 3.972 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.487156867980957
Epoch: 52, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.982 Vali Acc: 0.268 Test Loss: 3.982 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.398580551147461
Epoch: 53, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.996 Vali Acc: 0.268 Test Loss: 3.996 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.3171870708465576
Epoch: 54, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.985 Vali Acc: 0.268 Test Loss: 3.985 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.1091363430023193
Epoch: 55, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.038 Vali Acc: 0.274 Test Loss: 4.038 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.458319902420044
Epoch: 56, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.089 Vali Acc: 0.265 Test Loss: 4.089 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.4802565574645996
Epoch: 57, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.090 Vali Acc: 0.262 Test Loss: 4.090 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.4189555644989014
Epoch: 58, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.037 Vali Acc: 0.272 Test Loss: 4.037 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 710462
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9948630332946777
Epoch: 1, Steps: 10 | Train Loss: 3.558 Vali Loss: 3.402 Vali Acc: 0.032 Test Loss: 3.402 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 1.7755978107452393
Epoch: 2, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.341 Vali Acc: 0.038 Test Loss: 3.341 Test Acc: 0.038
Validation loss decreased (-0.031731 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 1.6361374855041504
Epoch: 3, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.371 Vali Acc: 0.040 Test Loss: 3.371 Test Acc: 0.040
Validation loss decreased (-0.037614 --> -0.039966).  Saving model ...
Epoch: 4 cost time: 1.387852668762207
Epoch: 4, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.390 Vali Acc: 0.042 Test Loss: 3.390 Test Acc: 0.042
Validation loss decreased (-0.039966 --> -0.042319).  Saving model ...
Epoch: 5 cost time: 1.2887444496154785
Epoch: 5, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.350 Vali Acc: 0.051 Test Loss: 3.350 Test Acc: 0.051
Validation loss decreased (-0.042319 --> -0.050555).  Saving model ...
Epoch: 6 cost time: 1.409531593322754
Epoch: 6, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.339 Vali Acc: 0.054 Test Loss: 3.339 Test Acc: 0.054
Validation loss decreased (-0.050555 --> -0.054084).  Saving model ...
Epoch: 7 cost time: 1.5553665161132812
Epoch: 7, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.290 Vali Acc: 0.051 Test Loss: 3.290 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4813828468322754
Epoch: 8, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.291 Vali Acc: 0.094 Test Loss: 3.291 Test Acc: 0.094
Validation loss decreased (-0.054084 --> -0.094085).  Saving model ...
Epoch: 9 cost time: 1.3191118240356445
Epoch: 9, Steps: 10 | Train Loss: 2.805 Vali Loss: 3.275 Vali Acc: 0.101 Test Loss: 3.275 Test Acc: 0.101
Validation loss decreased (-0.094085 --> -0.101144).  Saving model ...
Epoch: 10 cost time: 1.4289851188659668
Epoch: 10, Steps: 10 | Train Loss: 2.651 Vali Loss: 3.275 Vali Acc: 0.114 Test Loss: 3.275 Test Acc: 0.114
Validation loss decreased (-0.101144 --> -0.114085).  Saving model ...
Epoch: 11 cost time: 1.3806891441345215
Epoch: 11, Steps: 10 | Train Loss: 2.523 Vali Loss: 3.251 Vali Acc: 0.109 Test Loss: 3.251 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.206845998764038
Epoch: 12, Steps: 10 | Train Loss: 2.384 Vali Loss: 3.267 Vali Acc: 0.126 Test Loss: 3.267 Test Acc: 0.126
Validation loss decreased (-0.114085 --> -0.125850).  Saving model ...
Epoch: 13 cost time: 1.6416852474212646
Epoch: 13, Steps: 10 | Train Loss: 2.253 Vali Loss: 3.233 Vali Acc: 0.140 Test Loss: 3.233 Test Acc: 0.140
Validation loss decreased (-0.125850 --> -0.139968).  Saving model ...
Epoch: 14 cost time: 1.480867862701416
Epoch: 14, Steps: 10 | Train Loss: 2.125 Vali Loss: 3.245 Vali Acc: 0.139 Test Loss: 3.245 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.564500331878662
Epoch: 15, Steps: 10 | Train Loss: 1.944 Vali Loss: 3.252 Vali Acc: 0.153 Test Loss: 3.252 Test Acc: 0.153
Validation loss decreased (-0.139968 --> -0.152909).  Saving model ...
Epoch: 16 cost time: 1.40574049949646
Epoch: 16, Steps: 10 | Train Loss: 1.802 Vali Loss: 3.254 Vali Acc: 0.166 Test Loss: 3.254 Test Acc: 0.166
Validation loss decreased (-0.152909 --> -0.165850).  Saving model ...
Epoch: 17 cost time: 1.5600333213806152
Epoch: 17, Steps: 10 | Train Loss: 1.729 Vali Loss: 3.286 Vali Acc: 0.167 Test Loss: 3.286 Test Acc: 0.167
Validation loss decreased (-0.165850 --> -0.167026).  Saving model ...
Epoch: 18 cost time: 1.581939935684204
Epoch: 18, Steps: 10 | Train Loss: 1.500 Vali Loss: 3.266 Vali Acc: 0.179 Test Loss: 3.266 Test Acc: 0.179
Validation loss decreased (-0.167026 --> -0.178791).  Saving model ...
Epoch: 19 cost time: 1.9354290962219238
Epoch: 19, Steps: 10 | Train Loss: 1.443 Vali Loss: 3.290 Vali Acc: 0.178 Test Loss: 3.290 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6743249893188477
Epoch: 20, Steps: 10 | Train Loss: 1.296 Vali Loss: 3.324 Vali Acc: 0.202 Test Loss: 3.324 Test Acc: 0.202
Validation loss decreased (-0.178791 --> -0.202320).  Saving model ...
Epoch: 21 cost time: 1.4949979782104492
Epoch: 21, Steps: 10 | Train Loss: 1.162 Vali Loss: 3.314 Vali Acc: 0.195 Test Loss: 3.314 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8671596050262451
Epoch: 22, Steps: 10 | Train Loss: 1.060 Vali Loss: 3.327 Vali Acc: 0.196 Test Loss: 3.327 Test Acc: 0.196
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3644390106201172
Epoch: 23, Steps: 10 | Train Loss: 0.941 Vali Loss: 3.388 Vali Acc: 0.207 Test Loss: 3.388 Test Acc: 0.207
Validation loss decreased (-0.202320 --> -0.207025).  Saving model ...
Epoch: 24 cost time: 2.027298927307129
Epoch: 24, Steps: 10 | Train Loss: 0.835 Vali Loss: 3.382 Vali Acc: 0.233 Test Loss: 3.382 Test Acc: 0.233
Validation loss decreased (-0.207025 --> -0.232907).  Saving model ...
Epoch: 25 cost time: 1.5574586391448975
Epoch: 25, Steps: 10 | Train Loss: 0.742 Vali Loss: 3.393 Vali Acc: 0.212 Test Loss: 3.393 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6497385501861572
Epoch: 26, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.393 Vali Acc: 0.220 Test Loss: 3.393 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6881275177001953
Epoch: 27, Steps: 10 | Train Loss: 0.552 Vali Loss: 3.500 Vali Acc: 0.236 Test Loss: 3.500 Test Acc: 0.236
Validation loss decreased (-0.232907 --> -0.236436).  Saving model ...
Epoch: 28 cost time: 1.4635965824127197
Epoch: 28, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.484 Vali Acc: 0.240 Test Loss: 3.484 Test Acc: 0.240
Validation loss decreased (-0.236436 --> -0.239965).  Saving model ...
Epoch: 29 cost time: 1.2098476886749268
Epoch: 29, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.503 Vali Acc: 0.219 Test Loss: 3.503 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1383836269378662
Epoch: 30, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.582 Vali Acc: 0.239 Test Loss: 3.582 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7423207759857178
Epoch: 31, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.525 Vali Acc: 0.252 Test Loss: 3.525 Test Acc: 0.252
Validation loss decreased (-0.239965 --> -0.251729).  Saving model ...
Epoch: 32 cost time: 1.7009174823760986
Epoch: 32, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.608 Vali Acc: 0.236 Test Loss: 3.608 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4001553058624268
Epoch: 33, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.661 Vali Acc: 0.247 Test Loss: 3.661 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2657158374786377
Epoch: 34, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.672 Vali Acc: 0.254 Test Loss: 3.672 Test Acc: 0.254
Validation loss decreased (-0.251729 --> -0.254081).  Saving model ...
Epoch: 35 cost time: 1.373645305633545
Epoch: 35, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.722 Vali Acc: 0.247 Test Loss: 3.722 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.430410385131836
Epoch: 36, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.759 Vali Acc: 0.249 Test Loss: 3.759 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3979663848876953
Epoch: 37, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.803 Vali Acc: 0.249 Test Loss: 3.803 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4962637424468994
Epoch: 38, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.770 Vali Acc: 0.247 Test Loss: 3.770 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.648665189743042
Epoch: 39, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.823 Vali Acc: 0.261 Test Loss: 3.823 Test Acc: 0.261
Validation loss decreased (-0.254081 --> -0.261138).  Saving model ...
Epoch: 40 cost time: 1.335143804550171
Epoch: 40, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.837 Vali Acc: 0.259 Test Loss: 3.837 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6841721534729004
Epoch: 41, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.876 Vali Acc: 0.251 Test Loss: 3.876 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.6009562015533447
Epoch: 42, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.857 Vali Acc: 0.271 Test Loss: 3.857 Test Acc: 0.271
Validation loss decreased (-0.261138 --> -0.270550).  Saving model ...
Epoch: 43 cost time: 1.5547943115234375
Epoch: 43, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.895 Vali Acc: 0.264 Test Loss: 3.895 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.7739074230194092
Epoch: 44, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.958 Vali Acc: 0.261 Test Loss: 3.958 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.5867810249328613
Epoch: 45, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.920 Vali Acc: 0.265 Test Loss: 3.920 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.610985517501831
Epoch: 46, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.956 Vali Acc: 0.264 Test Loss: 3.956 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.4913148880004883
Epoch: 47, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.967 Vali Acc: 0.264 Test Loss: 3.967 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.3864140510559082
Epoch: 48, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.980 Vali Acc: 0.267 Test Loss: 3.980 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.391350507736206
Epoch: 49, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.997 Vali Acc: 0.265 Test Loss: 3.997 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.4066474437713623
Epoch: 50, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.991 Vali Acc: 0.269 Test Loss: 3.991 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.907881736755371
Epoch: 51, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.022 Vali Acc: 0.266 Test Loss: 4.022 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.9599659442901611
Epoch: 52, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.026 Vali Acc: 0.269 Test Loss: 4.026 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 709182
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.193532943725586
Epoch: 1, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.380 Vali Acc: 0.038 Test Loss: 3.380 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 1.3223114013671875
Epoch: 2, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.328 Vali Acc: 0.040 Test Loss: 3.328 Test Acc: 0.040
Validation loss decreased (-0.037613 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 1.4050872325897217
Epoch: 3, Steps: 10 | Train Loss: 3.203 Vali Loss: 3.337 Vali Acc: 0.044 Test Loss: 3.337 Test Acc: 0.044
Validation loss decreased (-0.039967 --> -0.043496).  Saving model ...
Epoch: 4 cost time: 1.2914531230926514
Epoch: 4, Steps: 10 | Train Loss: 3.138 Vali Loss: 3.338 Vali Acc: 0.056 Test Loss: 3.338 Test Acc: 0.056
Validation loss decreased (-0.043496 --> -0.056437).  Saving model ...
Epoch: 5 cost time: 1.5548663139343262
Epoch: 5, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.318 Vali Acc: 0.067 Test Loss: 3.318 Test Acc: 0.067
Validation loss decreased (-0.056437 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 1.6287822723388672
Epoch: 6, Steps: 10 | Train Loss: 3.023 Vali Loss: 3.285 Vali Acc: 0.069 Test Loss: 3.285 Test Acc: 0.069
Validation loss decreased (-0.067026 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 1.2659339904785156
Epoch: 7, Steps: 10 | Train Loss: 3.003 Vali Loss: 3.293 Vali Acc: 0.085 Test Loss: 3.293 Test Acc: 0.085
Validation loss decreased (-0.069379 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 1.7555058002471924
Epoch: 8, Steps: 10 | Train Loss: 2.888 Vali Loss: 3.265 Vali Acc: 0.078 Test Loss: 3.265 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6477901935577393
Epoch: 9, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.257 Vali Acc: 0.101 Test Loss: 3.257 Test Acc: 0.101
Validation loss decreased (-0.084673 --> -0.101144).  Saving model ...
Epoch: 10 cost time: 1.4047119617462158
Epoch: 10, Steps: 10 | Train Loss: 2.677 Vali Loss: 3.242 Vali Acc: 0.131 Test Loss: 3.242 Test Acc: 0.131
Validation loss decreased (-0.101144 --> -0.130556).  Saving model ...
Epoch: 11 cost time: 1.362576961517334
Epoch: 11, Steps: 10 | Train Loss: 2.575 Vali Loss: 3.238 Vali Acc: 0.115 Test Loss: 3.238 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8117265701293945
Epoch: 12, Steps: 10 | Train Loss: 2.448 Vali Loss: 3.240 Vali Acc: 0.134 Test Loss: 3.240 Test Acc: 0.134
Validation loss decreased (-0.130556 --> -0.134085).  Saving model ...
Epoch: 13 cost time: 1.8915705680847168
Epoch: 13, Steps: 10 | Train Loss: 2.285 Vali Loss: 3.227 Vali Acc: 0.135 Test Loss: 3.227 Test Acc: 0.135
Validation loss decreased (-0.134085 --> -0.135262).  Saving model ...
Epoch: 14 cost time: 1.5734424591064453
Epoch: 14, Steps: 10 | Train Loss: 2.198 Vali Loss: 3.213 Vali Acc: 0.145 Test Loss: 3.213 Test Acc: 0.145
Validation loss decreased (-0.135262 --> -0.144674).  Saving model ...
Epoch: 15 cost time: 1.3863704204559326
Epoch: 15, Steps: 10 | Train Loss: 2.109 Vali Loss: 3.228 Vali Acc: 0.153 Test Loss: 3.228 Test Acc: 0.153
Validation loss decreased (-0.144674 --> -0.152909).  Saving model ...
Epoch: 16 cost time: 1.8425583839416504
Epoch: 16, Steps: 10 | Train Loss: 1.906 Vali Loss: 3.253 Vali Acc: 0.160 Test Loss: 3.253 Test Acc: 0.160
Validation loss decreased (-0.152909 --> -0.159967).  Saving model ...
Epoch: 17 cost time: 1.557154893875122
Epoch: 17, Steps: 10 | Train Loss: 1.746 Vali Loss: 3.233 Vali Acc: 0.174 Test Loss: 3.233 Test Acc: 0.174
Validation loss decreased (-0.159967 --> -0.174085).  Saving model ...
Epoch: 18 cost time: 1.4787676334381104
Epoch: 18, Steps: 10 | Train Loss: 1.614 Vali Loss: 3.275 Vali Acc: 0.167 Test Loss: 3.275 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.847693920135498
Epoch: 19, Steps: 10 | Train Loss: 1.510 Vali Loss: 3.273 Vali Acc: 0.180 Test Loss: 3.273 Test Acc: 0.180
Validation loss decreased (-0.174085 --> -0.179967).  Saving model ...
Epoch: 20 cost time: 1.4866435527801514
Epoch: 20, Steps: 10 | Train Loss: 1.384 Vali Loss: 3.297 Vali Acc: 0.179 Test Loss: 3.297 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4589784145355225
Epoch: 21, Steps: 10 | Train Loss: 1.247 Vali Loss: 3.314 Vali Acc: 0.198 Test Loss: 3.314 Test Acc: 0.198
Validation loss decreased (-0.179967 --> -0.197614).  Saving model ...
Epoch: 22 cost time: 1.3714547157287598
Epoch: 22, Steps: 10 | Train Loss: 1.110 Vali Loss: 3.350 Vali Acc: 0.209 Test Loss: 3.350 Test Acc: 0.209
Validation loss decreased (-0.197614 --> -0.209378).  Saving model ...
Epoch: 23 cost time: 1.5178539752960205
Epoch: 23, Steps: 10 | Train Loss: 1.008 Vali Loss: 3.383 Vali Acc: 0.201 Test Loss: 3.383 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4995262622833252
Epoch: 24, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.381 Vali Acc: 0.200 Test Loss: 3.381 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7258799076080322
Epoch: 25, Steps: 10 | Train Loss: 0.814 Vali Loss: 3.419 Vali Acc: 0.199 Test Loss: 3.419 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.38472580909729
Epoch: 26, Steps: 10 | Train Loss: 0.700 Vali Loss: 3.470 Vali Acc: 0.225 Test Loss: 3.470 Test Acc: 0.225
Validation loss decreased (-0.209378 --> -0.224671).  Saving model ...
Epoch: 27 cost time: 1.7225370407104492
Epoch: 27, Steps: 10 | Train Loss: 0.578 Vali Loss: 3.491 Vali Acc: 0.214 Test Loss: 3.491 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9169330596923828
Epoch: 28, Steps: 10 | Train Loss: 0.507 Vali Loss: 3.525 Vali Acc: 0.236 Test Loss: 3.525 Test Acc: 0.236
Validation loss decreased (-0.224671 --> -0.236435).  Saving model ...
Epoch: 29 cost time: 1.512810230255127
Epoch: 29, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.611 Vali Acc: 0.235 Test Loss: 3.611 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4749524593353271
Epoch: 30, Steps: 10 | Train Loss: 0.418 Vali Loss: 3.581 Vali Acc: 0.233 Test Loss: 3.581 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.501063346862793
Epoch: 31, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.666 Vali Acc: 0.236 Test Loss: 3.666 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2867426872253418
Epoch: 32, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.677 Vali Acc: 0.232 Test Loss: 3.677 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.379469633102417
Epoch: 33, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.738 Vali Acc: 0.228 Test Loss: 3.738 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5860793590545654
Epoch: 34, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.764 Vali Acc: 0.220 Test Loss: 3.764 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.3548943996429443
Epoch: 35, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.800 Vali Acc: 0.234 Test Loss: 3.800 Test Acc: 0.234
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.5797829627990723
Epoch: 36, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.876 Vali Acc: 0.246 Test Loss: 3.876 Test Acc: 0.246
Validation loss decreased (-0.236435 --> -0.245844).  Saving model ...
Epoch: 37 cost time: 1.7283430099487305
Epoch: 37, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.881 Vali Acc: 0.234 Test Loss: 3.881 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.0023481845855713
Epoch: 38, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.868 Vali Acc: 0.255 Test Loss: 3.868 Test Acc: 0.255
Validation loss decreased (-0.245844 --> -0.255255).  Saving model ...
Epoch: 39 cost time: 1.53019118309021
Epoch: 39, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.995 Vali Acc: 0.234 Test Loss: 3.995 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8696153163909912
Epoch: 40, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.927 Vali Acc: 0.238 Test Loss: 3.927 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5579466819763184
Epoch: 41, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.941 Vali Acc: 0.244 Test Loss: 3.941 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2503128051757812
Epoch: 42, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.006 Vali Acc: 0.239 Test Loss: 4.006 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2778337001800537
Epoch: 43, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.980 Vali Acc: 0.249 Test Loss: 3.980 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.546691656112671
Epoch: 44, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.042 Vali Acc: 0.246 Test Loss: 4.042 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.7917571067810059
Epoch: 45, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.055 Vali Acc: 0.245 Test Loss: 4.055 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.2781529426574707
Epoch: 46, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.035 Vali Acc: 0.255 Test Loss: 4.035 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.4811015129089355
Epoch: 47, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.053 Vali Acc: 0.254 Test Loss: 4.053 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.2553491592407227
Epoch: 48, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.083 Vali Acc: 0.251 Test Loss: 4.083 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 547902
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.070231199264526
Epoch: 1, Steps: 10 | Train Loss: 3.442 Vali Loss: 3.414 Vali Acc: 0.033 Test Loss: 3.414 Test Acc: 0.033
Validation loss decreased (inf --> -0.032907).  Saving model ...
Epoch: 2 cost time: 1.3163962364196777
Epoch: 2, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.341 Vali Acc: 0.052 Test Loss: 3.341 Test Acc: 0.052
Validation loss decreased (-0.032907 --> -0.051731).  Saving model ...
Epoch: 3 cost time: 1.3652913570404053
Epoch: 3, Steps: 10 | Train Loss: 3.201 Vali Loss: 3.356 Vali Acc: 0.047 Test Loss: 3.356 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2250683307647705
Epoch: 4, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.359 Vali Acc: 0.064 Test Loss: 3.359 Test Acc: 0.064
Validation loss decreased (-0.051731 --> -0.063496).  Saving model ...
Epoch: 5 cost time: 1.5305979251861572
Epoch: 5, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.329 Vali Acc: 0.053 Test Loss: 3.329 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.574364423751831
Epoch: 6, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.308 Vali Acc: 0.069 Test Loss: 3.308 Test Acc: 0.069
Validation loss decreased (-0.063496 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 1.494182825088501
Epoch: 7, Steps: 10 | Train Loss: 2.974 Vali Loss: 3.309 Vali Acc: 0.078 Test Loss: 3.309 Test Acc: 0.078
Validation loss decreased (-0.069379 --> -0.077614).  Saving model ...
Epoch: 8 cost time: 1.7187628746032715
Epoch: 8, Steps: 10 | Train Loss: 2.845 Vali Loss: 3.276 Vali Acc: 0.082 Test Loss: 3.276 Test Acc: 0.082
Validation loss decreased (-0.077614 --> -0.082320).  Saving model ...
Epoch: 9 cost time: 1.6275911331176758
Epoch: 9, Steps: 10 | Train Loss: 2.751 Vali Loss: 3.269 Vali Acc: 0.087 Test Loss: 3.269 Test Acc: 0.087
Validation loss decreased (-0.082320 --> -0.087026).  Saving model ...
Epoch: 10 cost time: 1.7285630702972412
Epoch: 10, Steps: 10 | Train Loss: 2.622 Vali Loss: 3.263 Vali Acc: 0.104 Test Loss: 3.263 Test Acc: 0.104
Validation loss decreased (-0.087026 --> -0.103497).  Saving model ...
Epoch: 11 cost time: 1.524479866027832
Epoch: 11, Steps: 10 | Train Loss: 2.519 Vali Loss: 3.232 Vali Acc: 0.100 Test Loss: 3.232 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.594313144683838
Epoch: 12, Steps: 10 | Train Loss: 2.374 Vali Loss: 3.259 Vali Acc: 0.119 Test Loss: 3.259 Test Acc: 0.119
Validation loss decreased (-0.103497 --> -0.118791).  Saving model ...
Epoch: 13 cost time: 1.543217658996582
Epoch: 13, Steps: 10 | Train Loss: 2.275 Vali Loss: 3.275 Vali Acc: 0.125 Test Loss: 3.275 Test Acc: 0.125
Validation loss decreased (-0.118791 --> -0.124673).  Saving model ...
Epoch: 14 cost time: 1.4881699085235596
Epoch: 14, Steps: 10 | Train Loss: 2.121 Vali Loss: 3.240 Vali Acc: 0.155 Test Loss: 3.240 Test Acc: 0.155
Validation loss decreased (-0.124673 --> -0.155262).  Saving model ...
Epoch: 15 cost time: 1.9703433513641357
Epoch: 15, Steps: 10 | Train Loss: 1.956 Vali Loss: 3.267 Vali Acc: 0.141 Test Loss: 3.267 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8832345008850098
Epoch: 16, Steps: 10 | Train Loss: 1.850 Vali Loss: 3.259 Vali Acc: 0.151 Test Loss: 3.259 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.472024917602539
Epoch: 17, Steps: 10 | Train Loss: 1.687 Vali Loss: 3.284 Vali Acc: 0.153 Test Loss: 3.284 Test Acc: 0.153
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.786912441253662
Epoch: 18, Steps: 10 | Train Loss: 1.579 Vali Loss: 3.294 Vali Acc: 0.187 Test Loss: 3.294 Test Acc: 0.187
Validation loss decreased (-0.155262 --> -0.187026).  Saving model ...
Epoch: 19 cost time: 1.229271411895752
Epoch: 19, Steps: 10 | Train Loss: 1.436 Vali Loss: 3.326 Vali Acc: 0.175 Test Loss: 3.326 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6075024604797363
Epoch: 20, Steps: 10 | Train Loss: 1.297 Vali Loss: 3.325 Vali Acc: 0.182 Test Loss: 3.325 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5291550159454346
Epoch: 21, Steps: 10 | Train Loss: 1.220 Vali Loss: 3.333 Vali Acc: 0.199 Test Loss: 3.333 Test Acc: 0.199
Validation loss decreased (-0.187026 --> -0.198790).  Saving model ...
Epoch: 22 cost time: 1.945019006729126
Epoch: 22, Steps: 10 | Train Loss: 1.135 Vali Loss: 3.385 Vali Acc: 0.191 Test Loss: 3.385 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4471533298492432
Epoch: 23, Steps: 10 | Train Loss: 0.944 Vali Loss: 3.386 Vali Acc: 0.207 Test Loss: 3.386 Test Acc: 0.207
Validation loss decreased (-0.198790 --> -0.207025).  Saving model ...
Epoch: 24 cost time: 1.6221790313720703
Epoch: 24, Steps: 10 | Train Loss: 0.891 Vali Loss: 3.416 Vali Acc: 0.212 Test Loss: 3.416 Test Acc: 0.212
Validation loss decreased (-0.207025 --> -0.211731).  Saving model ...
Epoch: 25 cost time: 1.9425969123840332
Epoch: 25, Steps: 10 | Train Loss: 0.757 Vali Loss: 3.431 Vali Acc: 0.218 Test Loss: 3.431 Test Acc: 0.218
Validation loss decreased (-0.211731 --> -0.217613).  Saving model ...
Epoch: 26 cost time: 1.6771864891052246
Epoch: 26, Steps: 10 | Train Loss: 0.660 Vali Loss: 3.469 Vali Acc: 0.225 Test Loss: 3.469 Test Acc: 0.225
Validation loss decreased (-0.217613 --> -0.224671).  Saving model ...
Epoch: 27 cost time: 1.8665721416473389
Epoch: 27, Steps: 10 | Train Loss: 0.584 Vali Loss: 3.526 Vali Acc: 0.214 Test Loss: 3.526 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8102097511291504
Epoch: 28, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.523 Vali Acc: 0.222 Test Loss: 3.523 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5407249927520752
Epoch: 29, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.611 Vali Acc: 0.233 Test Loss: 3.611 Test Acc: 0.233
Validation loss decreased (-0.224671 --> -0.232905).  Saving model ...
Epoch: 30 cost time: 1.659149169921875
Epoch: 30, Steps: 10 | Train Loss: 0.357 Vali Loss: 3.582 Vali Acc: 0.224 Test Loss: 3.582 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6355714797973633
Epoch: 31, Steps: 10 | Train Loss: 0.312 Vali Loss: 3.626 Vali Acc: 0.234 Test Loss: 3.626 Test Acc: 0.234
Validation loss decreased (-0.232905 --> -0.234081).  Saving model ...
Epoch: 32 cost time: 1.3024928569793701
Epoch: 32, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.701 Vali Acc: 0.236 Test Loss: 3.701 Test Acc: 0.236
Validation loss decreased (-0.234081 --> -0.236434).  Saving model ...
Epoch: 33 cost time: 1.3262505531311035
Epoch: 33, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.773 Vali Acc: 0.228 Test Loss: 3.773 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6160337924957275
Epoch: 34, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.763 Vali Acc: 0.218 Test Loss: 3.763 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6490206718444824
Epoch: 35, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.779 Vali Acc: 0.244 Test Loss: 3.779 Test Acc: 0.244
Validation loss decreased (-0.236434 --> -0.243492).  Saving model ...
Epoch: 36 cost time: 1.3827693462371826
Epoch: 36, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.805 Vali Acc: 0.239 Test Loss: 3.805 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6357197761535645
Epoch: 37, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.851 Vali Acc: 0.233 Test Loss: 3.851 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3338956832885742
Epoch: 38, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.896 Vali Acc: 0.247 Test Loss: 3.896 Test Acc: 0.247
Validation loss decreased (-0.243492 --> -0.247020).  Saving model ...
Epoch: 39 cost time: 1.6951103210449219
Epoch: 39, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.872 Vali Acc: 0.247 Test Loss: 3.872 Test Acc: 0.247
Validation loss decreased (-0.247020 --> -0.247020).  Saving model ...
Epoch: 40 cost time: 1.986802339553833
Epoch: 40, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.899 Vali Acc: 0.249 Test Loss: 3.899 Test Acc: 0.249
Validation loss decreased (-0.247020 --> -0.249373).  Saving model ...
Epoch: 41 cost time: 1.7261269092559814
Epoch: 41, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.906 Vali Acc: 0.259 Test Loss: 3.906 Test Acc: 0.259
Validation loss decreased (-0.249373 --> -0.258784).  Saving model ...
Epoch: 42 cost time: 1.959639072418213
Epoch: 42, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.017 Vali Acc: 0.242 Test Loss: 4.017 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4225547313690186
Epoch: 43, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.027 Vali Acc: 0.251 Test Loss: 4.027 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.483412504196167
Epoch: 44, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.981 Vali Acc: 0.253 Test Loss: 3.981 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.86513090133667
Epoch: 45, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.028 Vali Acc: 0.258 Test Loss: 4.028 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.6707444190979004
Epoch: 46, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.032 Vali Acc: 0.249 Test Loss: 4.032 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.330552339553833
Epoch: 47, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.042 Vali Acc: 0.255 Test Loss: 4.042 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.7972567081451416
Epoch: 48, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.054 Vali Acc: 0.253 Test Loss: 4.054 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.4034817218780518
Epoch: 49, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.076 Vali Acc: 0.255 Test Loss: 4.076 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.7247722148895264
Epoch: 50, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.129 Vali Acc: 0.240 Test Loss: 4.129 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.7619378566741943
Epoch: 51, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.108 Vali Acc: 0.255 Test Loss: 4.108 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 546622
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1480648517608643
Epoch: 1, Steps: 10 | Train Loss: 3.444 Vali Loss: 3.376 Vali Acc: 0.038 Test Loss: 3.376 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 1.5785813331604004
Epoch: 2, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.343 Vali Acc: 0.029 Test Loss: 3.343 Test Acc: 0.029
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4847102165222168
Epoch: 3, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.350 Vali Acc: 0.045 Test Loss: 3.350 Test Acc: 0.045
Validation loss decreased (-0.037613 --> -0.044672).  Saving model ...
Epoch: 4 cost time: 1.4281859397888184
Epoch: 4, Steps: 10 | Train Loss: 3.184 Vali Loss: 3.355 Vali Acc: 0.048 Test Loss: 3.355 Test Acc: 0.048
Validation loss decreased (-0.044672 --> -0.048202).  Saving model ...
Epoch: 5 cost time: 1.5550110340118408
Epoch: 5, Steps: 10 | Train Loss: 3.168 Vali Loss: 3.338 Vali Acc: 0.055 Test Loss: 3.338 Test Acc: 0.055
Validation loss decreased (-0.048202 --> -0.055261).  Saving model ...
Epoch: 6 cost time: 1.6826279163360596
Epoch: 6, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.300 Vali Acc: 0.061 Test Loss: 3.300 Test Acc: 0.061
Validation loss decreased (-0.055261 --> -0.061143).  Saving model ...
Epoch: 7 cost time: 1.205306053161621
Epoch: 7, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.299 Vali Acc: 0.073 Test Loss: 3.299 Test Acc: 0.073
Validation loss decreased (-0.061143 --> -0.072908).  Saving model ...
Epoch: 8 cost time: 1.5097997188568115
Epoch: 8, Steps: 10 | Train Loss: 2.878 Vali Loss: 3.294 Vali Acc: 0.081 Test Loss: 3.294 Test Acc: 0.081
Validation loss decreased (-0.072908 --> -0.081144).  Saving model ...
Epoch: 9 cost time: 1.4628708362579346
Epoch: 9, Steps: 10 | Train Loss: 2.806 Vali Loss: 3.277 Vali Acc: 0.092 Test Loss: 3.277 Test Acc: 0.092
Validation loss decreased (-0.081144 --> -0.091732).  Saving model ...
Epoch: 10 cost time: 1.7652013301849365
Epoch: 10, Steps: 10 | Train Loss: 2.712 Vali Loss: 3.273 Vali Acc: 0.096 Test Loss: 3.273 Test Acc: 0.096
Validation loss decreased (-0.091732 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 1.649507761001587
Epoch: 11, Steps: 10 | Train Loss: 2.561 Vali Loss: 3.242 Vali Acc: 0.105 Test Loss: 3.242 Test Acc: 0.105
Validation loss decreased (-0.096438 --> -0.104673).  Saving model ...
Epoch: 12 cost time: 1.4264440536499023
Epoch: 12, Steps: 10 | Train Loss: 2.423 Vali Loss: 3.266 Vali Acc: 0.108 Test Loss: 3.266 Test Acc: 0.108
Validation loss decreased (-0.104673 --> -0.108203).  Saving model ...
Epoch: 13 cost time: 1.6048619747161865
Epoch: 13, Steps: 10 | Train Loss: 2.245 Vali Loss: 3.246 Vali Acc: 0.107 Test Loss: 3.246 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.604644536972046
Epoch: 14, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.246 Vali Acc: 0.132 Test Loss: 3.246 Test Acc: 0.132
Validation loss decreased (-0.108203 --> -0.131732).  Saving model ...
Epoch: 15 cost time: 1.6718847751617432
Epoch: 15, Steps: 10 | Train Loss: 2.055 Vali Loss: 3.254 Vali Acc: 0.132 Test Loss: 3.254 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.476879596710205
Epoch: 16, Steps: 10 | Train Loss: 1.867 Vali Loss: 3.270 Vali Acc: 0.153 Test Loss: 3.270 Test Acc: 0.153
Validation loss decreased (-0.131732 --> -0.152908).  Saving model ...
Epoch: 17 cost time: 1.7258636951446533
Epoch: 17, Steps: 10 | Train Loss: 1.708 Vali Loss: 3.319 Vali Acc: 0.142 Test Loss: 3.319 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.208660840988159
Epoch: 18, Steps: 10 | Train Loss: 1.643 Vali Loss: 3.329 Vali Acc: 0.156 Test Loss: 3.329 Test Acc: 0.156
Validation loss decreased (-0.152908 --> -0.156437).  Saving model ...
Epoch: 19 cost time: 1.6778247356414795
Epoch: 19, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.312 Vali Acc: 0.179 Test Loss: 3.312 Test Acc: 0.179
Validation loss decreased (-0.156437 --> -0.178790).  Saving model ...
Epoch: 20 cost time: 1.6604628562927246
Epoch: 20, Steps: 10 | Train Loss: 1.423 Vali Loss: 3.370 Vali Acc: 0.174 Test Loss: 3.370 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5791609287261963
Epoch: 21, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.334 Vali Acc: 0.193 Test Loss: 3.334 Test Acc: 0.193
Validation loss decreased (-0.178790 --> -0.192908).  Saving model ...
Epoch: 22 cost time: 1.5258045196533203
Epoch: 22, Steps: 10 | Train Loss: 1.161 Vali Loss: 3.383 Vali Acc: 0.199 Test Loss: 3.383 Test Acc: 0.199
Validation loss decreased (-0.192908 --> -0.198790).  Saving model ...
Epoch: 23 cost time: 1.1836681365966797
Epoch: 23, Steps: 10 | Train Loss: 1.047 Vali Loss: 3.435 Vali Acc: 0.187 Test Loss: 3.435 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.391937494277954
Epoch: 24, Steps: 10 | Train Loss: 0.983 Vali Loss: 3.401 Vali Acc: 0.211 Test Loss: 3.401 Test Acc: 0.211
Validation loss decreased (-0.198790 --> -0.210554).  Saving model ...
Epoch: 25 cost time: 1.270477294921875
Epoch: 25, Steps: 10 | Train Loss: 0.820 Vali Loss: 3.468 Vali Acc: 0.213 Test Loss: 3.468 Test Acc: 0.213
Validation loss decreased (-0.210554 --> -0.212906).  Saving model ...
Epoch: 26 cost time: 1.410024642944336
Epoch: 26, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.445 Vali Acc: 0.218 Test Loss: 3.445 Test Acc: 0.218
Validation loss decreased (-0.212906 --> -0.217613).  Saving model ...
Epoch: 27 cost time: 1.5899107456207275
Epoch: 27, Steps: 10 | Train Loss: 0.629 Vali Loss: 3.484 Vali Acc: 0.218 Test Loss: 3.484 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5836255550384521
Epoch: 28, Steps: 10 | Train Loss: 0.576 Vali Loss: 3.540 Vali Acc: 0.219 Test Loss: 3.540 Test Acc: 0.219
Validation loss decreased (-0.217613 --> -0.218788).  Saving model ...
Epoch: 29 cost time: 1.7393717765808105
Epoch: 29, Steps: 10 | Train Loss: 0.459 Vali Loss: 3.536 Vali Acc: 0.245 Test Loss: 3.536 Test Acc: 0.245
Validation loss decreased (-0.218788 --> -0.244671).  Saving model ...
Epoch: 30 cost time: 1.6774332523345947
Epoch: 30, Steps: 10 | Train Loss: 0.365 Vali Loss: 3.598 Vali Acc: 0.222 Test Loss: 3.598 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5659456253051758
Epoch: 31, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.592 Vali Acc: 0.236 Test Loss: 3.592 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4892590045928955
Epoch: 32, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.644 Vali Acc: 0.231 Test Loss: 3.644 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5757126808166504
Epoch: 33, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.681 Vali Acc: 0.240 Test Loss: 3.681 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.5454506874084473
Epoch: 34, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.732 Vali Acc: 0.238 Test Loss: 3.732 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5179121494293213
Epoch: 35, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.722 Vali Acc: 0.252 Test Loss: 3.722 Test Acc: 0.252
Validation loss decreased (-0.244671 --> -0.251727).  Saving model ...
Epoch: 36 cost time: 1.3350284099578857
Epoch: 36, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.819 Vali Acc: 0.244 Test Loss: 3.819 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7901039123535156
Epoch: 37, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.753 Vali Acc: 0.258 Test Loss: 3.753 Test Acc: 0.258
Validation loss decreased (-0.251727 --> -0.257610).  Saving model ...
Epoch: 38 cost time: 1.462594747543335
Epoch: 38, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.850 Vali Acc: 0.261 Test Loss: 3.850 Test Acc: 0.261
Validation loss decreased (-0.257610 --> -0.261138).  Saving model ...
Epoch: 39 cost time: 1.2875099182128906
Epoch: 39, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.887 Vali Acc: 0.256 Test Loss: 3.887 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.640007495880127
Epoch: 40, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.893 Vali Acc: 0.261 Test Loss: 3.893 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7302544116973877
Epoch: 41, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.918 Vali Acc: 0.259 Test Loss: 3.918 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4824438095092773
Epoch: 42, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.949 Vali Acc: 0.248 Test Loss: 3.949 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.4469478130340576
Epoch: 43, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.946 Vali Acc: 0.267 Test Loss: 3.946 Test Acc: 0.267
Validation loss decreased (-0.261138 --> -0.267019).  Saving model ...
Epoch: 44 cost time: 1.526258945465088
Epoch: 44, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.976 Vali Acc: 0.254 Test Loss: 3.976 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2976038455963135
Epoch: 45, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.012 Vali Acc: 0.260 Test Loss: 4.012 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3797636032104492
Epoch: 46, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.033 Vali Acc: 0.262 Test Loss: 4.033 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.5175094604492188
Epoch: 47, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.059 Vali Acc: 0.266 Test Loss: 4.059 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6267192363739014
Epoch: 48, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.068 Vali Acc: 0.265 Test Loss: 4.068 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2672710418701172
Epoch: 49, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.066 Vali Acc: 0.266 Test Loss: 4.066 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.3241174221038818
Epoch: 50, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.099 Vali Acc: 0.269 Test Loss: 4.099 Test Acc: 0.269
Validation loss decreased (-0.267019 --> -0.269371).  Saving model ...
Epoch: 51 cost time: 1.5446181297302246
Epoch: 51, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.108 Vali Acc: 0.261 Test Loss: 4.108 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3949623107910156
Epoch: 52, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.116 Vali Acc: 0.266 Test Loss: 4.116 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.7083461284637451
Epoch: 53, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.138 Vali Acc: 0.261 Test Loss: 4.138 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.5387942790985107
Epoch: 54, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.168 Vali Acc: 0.265 Test Loss: 4.168 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.8647429943084717
Epoch: 55, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.195 Vali Acc: 0.267 Test Loss: 4.195 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.5012118816375732
Epoch: 56, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.192 Vali Acc: 0.265 Test Loss: 4.192 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.4277126789093018
Epoch: 57, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.223 Vali Acc: 0.261 Test Loss: 4.223 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.2168834209442139
Epoch: 58, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.238 Vali Acc: 0.265 Test Loss: 4.238 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.614565134048462
Epoch: 59, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.244 Vali Acc: 0.264 Test Loss: 4.244 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.6237618923187256
Epoch: 60, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.253 Vali Acc: 0.266 Test Loss: 4.253 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 545342
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.8158998489379883
Epoch: 1, Steps: 10 | Train Loss: 3.426 Vali Loss: 3.364 Vali Acc: 0.028 Test Loss: 3.364 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 1.426924467086792
Epoch: 2, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.321 Vali Acc: 0.033 Test Loss: 3.321 Test Acc: 0.033
Validation loss decreased (-0.028202 --> -0.032908).  Saving model ...
Epoch: 3 cost time: 1.1427724361419678
Epoch: 3, Steps: 10 | Train Loss: 3.226 Vali Loss: 3.339 Vali Acc: 0.044 Test Loss: 3.339 Test Acc: 0.044
Validation loss decreased (-0.032908 --> -0.043496).  Saving model ...
Epoch: 4 cost time: 1.2213189601898193
Epoch: 4, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.360 Vali Acc: 0.072 Test Loss: 3.360 Test Acc: 0.072
Validation loss decreased (-0.043496 --> -0.071731).  Saving model ...
Epoch: 5 cost time: 1.4825749397277832
Epoch: 5, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.362 Vali Acc: 0.059 Test Loss: 3.362 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6494166851043701
Epoch: 6, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.324 Vali Acc: 0.078 Test Loss: 3.324 Test Acc: 0.078
Validation loss decreased (-0.071731 --> -0.077614).  Saving model ...
Epoch: 7 cost time: 1.6110830307006836
Epoch: 7, Steps: 10 | Train Loss: 2.946 Vali Loss: 3.320 Vali Acc: 0.071 Test Loss: 3.320 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8703601360321045
Epoch: 8, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.281 Vali Acc: 0.099 Test Loss: 3.281 Test Acc: 0.099
Validation loss decreased (-0.077614 --> -0.098791).  Saving model ...
Epoch: 9 cost time: 1.692251443862915
Epoch: 9, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.273 Vali Acc: 0.107 Test Loss: 3.273 Test Acc: 0.107
Validation loss decreased (-0.098791 --> -0.107026).  Saving model ...
Epoch: 10 cost time: 1.3621017932891846
Epoch: 10, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.282 Vali Acc: 0.100 Test Loss: 3.282 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6358115673065186
Epoch: 11, Steps: 10 | Train Loss: 2.561 Vali Loss: 3.267 Vali Acc: 0.105 Test Loss: 3.267 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4218947887420654
Epoch: 12, Steps: 10 | Train Loss: 2.450 Vali Loss: 3.265 Vali Acc: 0.107 Test Loss: 3.265 Test Acc: 0.107
Validation loss decreased (-0.107026 --> -0.107026).  Saving model ...
Epoch: 13 cost time: 1.4466841220855713
Epoch: 13, Steps: 10 | Train Loss: 2.233 Vali Loss: 3.254 Vali Acc: 0.125 Test Loss: 3.254 Test Acc: 0.125
Validation loss decreased (-0.107026 --> -0.124673).  Saving model ...
Epoch: 14 cost time: 1.3999357223510742
Epoch: 14, Steps: 10 | Train Loss: 2.082 Vali Loss: 3.274 Vali Acc: 0.131 Test Loss: 3.274 Test Acc: 0.131
Validation loss decreased (-0.124673 --> -0.130555).  Saving model ...
Epoch: 15 cost time: 1.463975191116333
Epoch: 15, Steps: 10 | Train Loss: 1.948 Vali Loss: 3.276 Vali Acc: 0.135 Test Loss: 3.276 Test Acc: 0.135
Validation loss decreased (-0.130555 --> -0.135261).  Saving model ...
Epoch: 16 cost time: 1.5551667213439941
Epoch: 16, Steps: 10 | Train Loss: 1.847 Vali Loss: 3.275 Vali Acc: 0.155 Test Loss: 3.275 Test Acc: 0.155
Validation loss decreased (-0.135261 --> -0.155261).  Saving model ...
Epoch: 17 cost time: 1.4011385440826416
Epoch: 17, Steps: 10 | Train Loss: 1.726 Vali Loss: 3.293 Vali Acc: 0.158 Test Loss: 3.293 Test Acc: 0.158
Validation loss decreased (-0.155261 --> -0.157614).  Saving model ...
Epoch: 18 cost time: 1.6513164043426514
Epoch: 18, Steps: 10 | Train Loss: 1.618 Vali Loss: 3.312 Vali Acc: 0.159 Test Loss: 3.312 Test Acc: 0.159
Validation loss decreased (-0.157614 --> -0.158790).  Saving model ...
Epoch: 19 cost time: 1.3221616744995117
Epoch: 19, Steps: 10 | Train Loss: 1.462 Vali Loss: 3.306 Vali Acc: 0.167 Test Loss: 3.306 Test Acc: 0.167
Validation loss decreased (-0.158790 --> -0.167026).  Saving model ...
Epoch: 20 cost time: 1.222548007965088
Epoch: 20, Steps: 10 | Train Loss: 1.310 Vali Loss: 3.346 Vali Acc: 0.175 Test Loss: 3.346 Test Acc: 0.175
Validation loss decreased (-0.167026 --> -0.175261).  Saving model ...
Epoch: 21 cost time: 1.1802988052368164
Epoch: 21, Steps: 10 | Train Loss: 1.183 Vali Loss: 3.352 Vali Acc: 0.188 Test Loss: 3.352 Test Acc: 0.188
Validation loss decreased (-0.175261 --> -0.188202).  Saving model ...
Epoch: 22 cost time: 1.456979513168335
Epoch: 22, Steps: 10 | Train Loss: 1.086 Vali Loss: 3.418 Vali Acc: 0.176 Test Loss: 3.418 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5107204914093018
Epoch: 23, Steps: 10 | Train Loss: 0.981 Vali Loss: 3.406 Vali Acc: 0.198 Test Loss: 3.406 Test Acc: 0.198
Validation loss decreased (-0.188202 --> -0.197613).  Saving model ...
Epoch: 24 cost time: 1.4719631671905518
Epoch: 24, Steps: 10 | Train Loss: 0.872 Vali Loss: 3.408 Vali Acc: 0.201 Test Loss: 3.408 Test Acc: 0.201
Validation loss decreased (-0.197613 --> -0.201142).  Saving model ...
Epoch: 25 cost time: 1.4981398582458496
Epoch: 25, Steps: 10 | Train Loss: 0.753 Vali Loss: 3.465 Vali Acc: 0.199 Test Loss: 3.465 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5694680213928223
Epoch: 26, Steps: 10 | Train Loss: 0.687 Vali Loss: 3.531 Vali Acc: 0.206 Test Loss: 3.531 Test Acc: 0.206
Validation loss decreased (-0.201142 --> -0.205847).  Saving model ...
Epoch: 27 cost time: 1.637805461883545
Epoch: 27, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.501 Vali Acc: 0.212 Test Loss: 3.501 Test Acc: 0.212
Validation loss decreased (-0.205847 --> -0.211730).  Saving model ...
Epoch: 28 cost time: 1.5505263805389404
Epoch: 28, Steps: 10 | Train Loss: 0.496 Vali Loss: 3.555 Vali Acc: 0.214 Test Loss: 3.555 Test Acc: 0.214
Validation loss decreased (-0.211730 --> -0.214082).  Saving model ...
Epoch: 29 cost time: 1.442497730255127
Epoch: 29, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.628 Vali Acc: 0.215 Test Loss: 3.628 Test Acc: 0.215
Validation loss decreased (-0.214082 --> -0.215258).  Saving model ...
Epoch: 30 cost time: 1.6082980632781982
Epoch: 30, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.593 Vali Acc: 0.224 Test Loss: 3.593 Test Acc: 0.224
Validation loss decreased (-0.215258 --> -0.223493).  Saving model ...
Epoch: 31 cost time: 1.5584614276885986
Epoch: 31, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.672 Vali Acc: 0.215 Test Loss: 3.672 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1619932651519775
Epoch: 32, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.769 Vali Acc: 0.215 Test Loss: 3.769 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5001189708709717
Epoch: 33, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.703 Vali Acc: 0.229 Test Loss: 3.703 Test Acc: 0.229
Validation loss decreased (-0.223493 --> -0.229375).  Saving model ...
Epoch: 34 cost time: 1.7490015029907227
Epoch: 34, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.735 Vali Acc: 0.233 Test Loss: 3.735 Test Acc: 0.233
Validation loss decreased (-0.229375 --> -0.232904).  Saving model ...
Epoch: 35 cost time: 1.4637658596038818
Epoch: 35, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.838 Vali Acc: 0.224 Test Loss: 3.838 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.96677565574646
Epoch: 36, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.753 Vali Acc: 0.236 Test Loss: 3.753 Test Acc: 0.236
Validation loss decreased (-0.232904 --> -0.236433).  Saving model ...
Epoch: 37 cost time: 1.6256396770477295
Epoch: 37, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.883 Vali Acc: 0.235 Test Loss: 3.883 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8594143390655518
Epoch: 38, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.926 Vali Acc: 0.226 Test Loss: 3.926 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.4236042499542236
Epoch: 39, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.863 Vali Acc: 0.247 Test Loss: 3.863 Test Acc: 0.247
Validation loss decreased (-0.236433 --> -0.247020).  Saving model ...
Epoch: 40 cost time: 1.4879610538482666
Epoch: 40, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.946 Vali Acc: 0.233 Test Loss: 3.946 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2929179668426514
Epoch: 41, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.911 Vali Acc: 0.240 Test Loss: 3.911 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.6145000457763672
Epoch: 42, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.977 Vali Acc: 0.244 Test Loss: 3.977 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.5223770141601562
Epoch: 43, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.989 Vali Acc: 0.241 Test Loss: 3.989 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.529294729232788
Epoch: 44, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.971 Vali Acc: 0.254 Test Loss: 3.971 Test Acc: 0.254
Validation loss decreased (-0.247020 --> -0.254078).  Saving model ...
Epoch: 45 cost time: 1.3458435535430908
Epoch: 45, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.996 Vali Acc: 0.251 Test Loss: 3.996 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.556426763534546
Epoch: 46, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.054 Vali Acc: 0.247 Test Loss: 4.054 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.6748223304748535
Epoch: 47, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.009 Vali Acc: 0.252 Test Loss: 4.009 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.7635266780853271
Epoch: 48, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.065 Vali Acc: 0.247 Test Loss: 4.065 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.5197019577026367
Epoch: 49, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.084 Vali Acc: 0.253 Test Loss: 4.084 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.3965792655944824
Epoch: 50, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.089 Vali Acc: 0.258 Test Loss: 4.089 Test Acc: 0.258
Validation loss decreased (-0.254078 --> -0.257606).  Saving model ...
Epoch: 51 cost time: 1.3657300472259521
Epoch: 51, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.119 Vali Acc: 0.251 Test Loss: 4.119 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.538543462753296
Epoch: 52, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.112 Vali Acc: 0.248 Test Loss: 4.112 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.5616722106933594
Epoch: 53, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.179 Vali Acc: 0.246 Test Loss: 4.179 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.5179142951965332
Epoch: 54, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.141 Vali Acc: 0.249 Test Loss: 4.141 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.5899178981781006
Epoch: 55, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.137 Vali Acc: 0.256 Test Loss: 4.137 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.5157806873321533
Epoch: 56, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.233 Vali Acc: 0.246 Test Loss: 4.233 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.4272403717041016
Epoch: 57, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.192 Vali Acc: 0.247 Test Loss: 4.192 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.483882188796997
Epoch: 58, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.237 Vali Acc: 0.251 Test Loss: 4.237 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.4622604846954346
Epoch: 59, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.202 Vali Acc: 0.249 Test Loss: 4.202 Test Acc: 0.249
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.4888312816619873
Epoch: 60, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.257 Vali Acc: 0.249 Test Loss: 4.257 Test Acc: 0.249
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 544062
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.608334541320801
Epoch: 1, Steps: 10 | Train Loss: 3.360 Vali Loss: 3.367 Vali Acc: 0.049 Test Loss: 3.367 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 1.8890717029571533
Epoch: 2, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.337 Vali Acc: 0.055 Test Loss: 3.337 Test Acc: 0.055
Validation loss decreased (-0.049378 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 1.5348773002624512
Epoch: 3, Steps: 10 | Train Loss: 3.201 Vali Loss: 3.351 Vali Acc: 0.059 Test Loss: 3.351 Test Acc: 0.059
Validation loss decreased (-0.055261 --> -0.058790).  Saving model ...
Epoch: 4 cost time: 1.3056416511535645
Epoch: 4, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.327 Vali Acc: 0.065 Test Loss: 3.327 Test Acc: 0.065
Validation loss decreased (-0.058790 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 1.5739405155181885
Epoch: 5, Steps: 10 | Train Loss: 3.071 Vali Loss: 3.306 Vali Acc: 0.081 Test Loss: 3.306 Test Acc: 0.081
Validation loss decreased (-0.064673 --> -0.081143).  Saving model ...
Epoch: 6 cost time: 2.054081678390503
Epoch: 6, Steps: 10 | Train Loss: 3.014 Vali Loss: 3.298 Vali Acc: 0.084 Test Loss: 3.298 Test Acc: 0.084
Validation loss decreased (-0.081143 --> -0.083496).  Saving model ...
Epoch: 7 cost time: 1.7351551055908203
Epoch: 7, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.271 Vali Acc: 0.084 Test Loss: 3.271 Test Acc: 0.084
Validation loss decreased (-0.083496 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 1.4843418598175049
Epoch: 8, Steps: 10 | Train Loss: 2.870 Vali Loss: 3.262 Vali Acc: 0.096 Test Loss: 3.262 Test Acc: 0.096
Validation loss decreased (-0.083497 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 1.5596630573272705
Epoch: 9, Steps: 10 | Train Loss: 2.749 Vali Loss: 3.279 Vali Acc: 0.098 Test Loss: 3.279 Test Acc: 0.098
Validation loss decreased (-0.096438 --> -0.097614).  Saving model ...
Epoch: 10 cost time: 1.5161747932434082
Epoch: 10, Steps: 10 | Train Loss: 2.678 Vali Loss: 3.255 Vali Acc: 0.109 Test Loss: 3.255 Test Acc: 0.109
Validation loss decreased (-0.097614 --> -0.109379).  Saving model ...
Epoch: 11 cost time: 1.6318862438201904
Epoch: 11, Steps: 10 | Train Loss: 2.554 Vali Loss: 3.219 Vali Acc: 0.106 Test Loss: 3.219 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5042870044708252
Epoch: 12, Steps: 10 | Train Loss: 2.452 Vali Loss: 3.226 Vali Acc: 0.126 Test Loss: 3.226 Test Acc: 0.126
Validation loss decreased (-0.109379 --> -0.125850).  Saving model ...
Epoch: 13 cost time: 1.6689355373382568
Epoch: 13, Steps: 10 | Train Loss: 2.288 Vali Loss: 3.222 Vali Acc: 0.156 Test Loss: 3.222 Test Acc: 0.156
Validation loss decreased (-0.125850 --> -0.156438).  Saving model ...
Epoch: 14 cost time: 1.6090421676635742
Epoch: 14, Steps: 10 | Train Loss: 2.197 Vali Loss: 3.215 Vali Acc: 0.148 Test Loss: 3.215 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.467503309249878
Epoch: 15, Steps: 10 | Train Loss: 2.027 Vali Loss: 3.258 Vali Acc: 0.145 Test Loss: 3.258 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5056233406066895
Epoch: 16, Steps: 10 | Train Loss: 1.867 Vali Loss: 3.240 Vali Acc: 0.154 Test Loss: 3.240 Test Acc: 0.154
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3100552558898926
Epoch: 17, Steps: 10 | Train Loss: 1.748 Vali Loss: 3.228 Vali Acc: 0.186 Test Loss: 3.228 Test Acc: 0.186
Validation loss decreased (-0.156438 --> -0.185850).  Saving model ...
Epoch: 18 cost time: 1.395702600479126
Epoch: 18, Steps: 10 | Train Loss: 1.639 Vali Loss: 3.247 Vali Acc: 0.186 Test Loss: 3.247 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7281115055084229
Epoch: 19, Steps: 10 | Train Loss: 1.501 Vali Loss: 3.294 Vali Acc: 0.185 Test Loss: 3.294 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3386304378509521
Epoch: 20, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.299 Vali Acc: 0.189 Test Loss: 3.299 Test Acc: 0.189
Validation loss decreased (-0.185850 --> -0.189379).  Saving model ...
Epoch: 21 cost time: 1.7984862327575684
Epoch: 21, Steps: 10 | Train Loss: 1.289 Vali Loss: 3.354 Vali Acc: 0.186 Test Loss: 3.354 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7347054481506348
Epoch: 22, Steps: 10 | Train Loss: 1.113 Vali Loss: 3.339 Vali Acc: 0.199 Test Loss: 3.339 Test Acc: 0.199
Validation loss decreased (-0.189379 --> -0.198790).  Saving model ...
Epoch: 23 cost time: 1.9184234142303467
Epoch: 23, Steps: 10 | Train Loss: 1.106 Vali Loss: 3.323 Vali Acc: 0.222 Test Loss: 3.323 Test Acc: 0.222
Validation loss decreased (-0.198790 --> -0.222320).  Saving model ...
Epoch: 24 cost time: 1.682999849319458
Epoch: 24, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.408 Vali Acc: 0.202 Test Loss: 3.408 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9500024318695068
Epoch: 25, Steps: 10 | Train Loss: 0.796 Vali Loss: 3.404 Vali Acc: 0.228 Test Loss: 3.404 Test Acc: 0.228
Validation loss decreased (-0.222320 --> -0.228201).  Saving model ...
Epoch: 26 cost time: 1.61069917678833
Epoch: 26, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.402 Vali Acc: 0.224 Test Loss: 3.402 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.708383321762085
Epoch: 27, Steps: 10 | Train Loss: 0.645 Vali Loss: 3.492 Vali Acc: 0.206 Test Loss: 3.492 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5742688179016113
Epoch: 28, Steps: 10 | Train Loss: 0.574 Vali Loss: 3.471 Vali Acc: 0.220 Test Loss: 3.471 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4481675624847412
Epoch: 29, Steps: 10 | Train Loss: 0.478 Vali Loss: 3.523 Vali Acc: 0.239 Test Loss: 3.523 Test Acc: 0.239
Validation loss decreased (-0.228201 --> -0.238788).  Saving model ...
Epoch: 30 cost time: 1.5397469997406006
Epoch: 30, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.574 Vali Acc: 0.247 Test Loss: 3.574 Test Acc: 0.247
Validation loss decreased (-0.238788 --> -0.247023).  Saving model ...
Epoch: 31 cost time: 1.6915829181671143
Epoch: 31, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.558 Vali Acc: 0.244 Test Loss: 3.558 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4926509857177734
Epoch: 32, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.617 Vali Acc: 0.248 Test Loss: 3.617 Test Acc: 0.248
Validation loss decreased (-0.247023 --> -0.248199).  Saving model ...
Epoch: 33 cost time: 1.614628553390503
Epoch: 33, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.709 Vali Acc: 0.241 Test Loss: 3.709 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3982465267181396
Epoch: 34, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.681 Vali Acc: 0.235 Test Loss: 3.681 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8138628005981445
Epoch: 35, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.738 Vali Acc: 0.251 Test Loss: 3.738 Test Acc: 0.251
Validation loss decreased (-0.248199 --> -0.250551).  Saving model ...
Epoch: 36 cost time: 1.6214964389801025
Epoch: 36, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.749 Vali Acc: 0.254 Test Loss: 3.749 Test Acc: 0.254
Validation loss decreased (-0.250551 --> -0.254080).  Saving model ...
Epoch: 37 cost time: 1.3560280799865723
Epoch: 37, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.808 Vali Acc: 0.242 Test Loss: 3.808 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5700182914733887
Epoch: 38, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.814 Vali Acc: 0.258 Test Loss: 3.814 Test Acc: 0.258
Validation loss decreased (-0.254080 --> -0.257609).  Saving model ...
Epoch: 39 cost time: 1.6892898082733154
Epoch: 39, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.861 Vali Acc: 0.258 Test Loss: 3.861 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.253657817840576
Epoch: 40, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.896 Vali Acc: 0.259 Test Loss: 3.896 Test Acc: 0.259
Validation loss decreased (-0.257609 --> -0.258785).  Saving model ...
Epoch: 41 cost time: 1.5516397953033447
Epoch: 41, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.868 Vali Acc: 0.259 Test Loss: 3.868 Test Acc: 0.259
Validation loss decreased (-0.258785 --> -0.258785).  Saving model ...
Epoch: 42 cost time: 1.4329509735107422
Epoch: 42, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.929 Vali Acc: 0.265 Test Loss: 3.929 Test Acc: 0.265
Validation loss decreased (-0.258785 --> -0.264667).  Saving model ...
Epoch: 43 cost time: 1.9584569931030273
Epoch: 43, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.936 Vali Acc: 0.262 Test Loss: 3.936 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.4868853092193604
Epoch: 44, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.982 Vali Acc: 0.260 Test Loss: 3.982 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.9383890628814697
Epoch: 45, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.958 Vali Acc: 0.262 Test Loss: 3.958 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.5930569171905518
Epoch: 46, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.972 Vali Acc: 0.265 Test Loss: 3.972 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.0786709785461426
Epoch: 47, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.005 Vali Acc: 0.260 Test Loss: 4.005 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.343027114868164
Epoch: 48, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.039 Vali Acc: 0.264 Test Loss: 4.039 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.134631633758545
Epoch: 49, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.068 Vali Acc: 0.271 Test Loss: 4.068 Test Acc: 0.271
Validation loss decreased (-0.264667 --> -0.270548).  Saving model ...
Epoch: 50 cost time: 1.3275654315948486
Epoch: 50, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.053 Vali Acc: 0.259 Test Loss: 4.053 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.567136287689209
Epoch: 51, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.085 Vali Acc: 0.258 Test Loss: 4.085 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.4442148208618164
Epoch: 52, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.088 Vali Acc: 0.268 Test Loss: 4.088 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.6051018238067627
Epoch: 53, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.095 Vali Acc: 0.265 Test Loss: 4.095 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.4474353790283203
Epoch: 54, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.112 Vali Acc: 0.268 Test Loss: 4.112 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.404566764831543
Epoch: 55, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.129 Vali Acc: 0.271 Test Loss: 4.129 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.6700232028961182
Epoch: 56, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.152 Vali Acc: 0.272 Test Loss: 4.152 Test Acc: 0.272
Validation loss decreased (-0.270548 --> -0.271723).  Saving model ...
Epoch: 57 cost time: 1.8152141571044922
Epoch: 57, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.181 Vali Acc: 0.265 Test Loss: 4.181 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.7031655311584473
Epoch: 58, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.211 Vali Acc: 0.261 Test Loss: 4.211 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.5719037055969238
Epoch: 59, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.195 Vali Acc: 0.269 Test Loss: 4.195 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 2.305069923400879
Epoch: 60, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.225 Vali Acc: 0.264 Test Loss: 4.225 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.9254467487335205
Epoch: 61, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.220 Vali Acc: 0.268 Test Loss: 4.220 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.878265380859375
Epoch: 62, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.252 Vali Acc: 0.267 Test Loss: 4.252 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.693969488143921
Epoch: 63, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.259 Vali Acc: 0.268 Test Loss: 4.259 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.5964195728302002
Epoch: 64, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.281 Vali Acc: 0.267 Test Loss: 4.281 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.4706237316131592
Epoch: 65, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.260 Vali Acc: 0.273 Test Loss: 4.260 Test Acc: 0.273
Validation loss decreased (-0.271723 --> -0.272899).  Saving model ...
Epoch: 66 cost time: 1.2763094902038574
Epoch: 66, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.283 Vali Acc: 0.272 Test Loss: 4.283 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.7138524055480957
Epoch: 67, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.328 Vali Acc: 0.269 Test Loss: 4.328 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.5829739570617676
Epoch: 68, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.291 Vali Acc: 0.271 Test Loss: 4.291 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.4959158897399902
Epoch: 69, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.297 Vali Acc: 0.269 Test Loss: 4.297 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.6142842769622803
Epoch: 70, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.298 Vali Acc: 0.272 Test Loss: 4.298 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.5106205940246582
Epoch: 71, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.322 Vali Acc: 0.274 Test Loss: 4.322 Test Acc: 0.274
Validation loss decreased (-0.272899 --> -0.274074).  Saving model ...
Epoch: 72 cost time: 1.3656551837921143
Epoch: 72, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.339 Vali Acc: 0.273 Test Loss: 4.339 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.598872184753418
Epoch: 73, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.349 Vali Acc: 0.275 Test Loss: 4.349 Test Acc: 0.275
Validation loss decreased (-0.274074 --> -0.275251).  Saving model ...
Epoch: 74 cost time: 1.3091933727264404
Epoch: 74, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.340 Vali Acc: 0.274 Test Loss: 4.340 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.6339082717895508
Epoch: 75, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.354 Vali Acc: 0.267 Test Loss: 4.354 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.5187466144561768
Epoch: 76, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.373 Vali Acc: 0.267 Test Loss: 4.373 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 2.3473291397094727
Epoch: 77, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.386 Vali Acc: 0.266 Test Loss: 4.386 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.8525779247283936
Epoch: 78, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.393 Vali Acc: 0.274 Test Loss: 4.393 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.9327764511108398
Epoch: 79, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.398 Vali Acc: 0.269 Test Loss: 4.398 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.57704758644104
Epoch: 80, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.423 Vali Acc: 0.271 Test Loss: 4.423 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.6626214981079102
Epoch: 81, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.451 Vali Acc: 0.276 Test Loss: 4.451 Test Acc: 0.276
Validation loss decreased (-0.275251 --> -0.276426).  Saving model ...
Epoch: 82 cost time: 1.7104301452636719
Epoch: 82, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.433 Vali Acc: 0.271 Test Loss: 4.433 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.4283580780029297
Epoch: 83, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.437 Vali Acc: 0.275 Test Loss: 4.437 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.520059585571289
Epoch: 84, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.464 Vali Acc: 0.274 Test Loss: 4.464 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.7684931755065918
Epoch: 85, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.464 Vali Acc: 0.272 Test Loss: 4.464 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.5413143634796143
Epoch: 86, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.451 Vali Acc: 0.278 Test Loss: 4.451 Test Acc: 0.278
Validation loss decreased (-0.276426 --> -0.277603).  Saving model ...
Epoch: 87 cost time: 1.4098427295684814
Epoch: 87, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.460 Vali Acc: 0.273 Test Loss: 4.460 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.3527092933654785
Epoch: 88, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.472 Vali Acc: 0.272 Test Loss: 4.472 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.464752197265625
Epoch: 89, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.477 Vali Acc: 0.272 Test Loss: 4.477 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.6680104732513428
Epoch: 90, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.498 Vali Acc: 0.271 Test Loss: 4.498 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 1.4830901622772217
Epoch: 91, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.491 Vali Acc: 0.268 Test Loss: 4.491 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 1.2893223762512207
Epoch: 92, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.500 Vali Acc: 0.269 Test Loss: 4.500 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 1.7413227558135986
Epoch: 93, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.526 Vali Acc: 0.271 Test Loss: 4.526 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 1.7116310596466064
Epoch: 94, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.548 Vali Acc: 0.272 Test Loss: 4.548 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 1.7118277549743652
Epoch: 95, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.520 Vali Acc: 0.272 Test Loss: 4.520 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 1.38161301612854
Epoch: 96, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.551 Vali Acc: 0.271 Test Loss: 4.551 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 465342
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6634879112243652
Epoch: 1, Steps: 10 | Train Loss: 3.390 Vali Loss: 3.344 Vali Acc: 0.051 Test Loss: 3.344 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.5533778667449951
Epoch: 2, Steps: 10 | Train Loss: 3.310 Vali Loss: 3.331 Vali Acc: 0.044 Test Loss: 3.331 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3924202919006348
Epoch: 3, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.349 Vali Acc: 0.058 Test Loss: 3.349 Test Acc: 0.058
Validation loss decreased (-0.050555 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 1.3132753372192383
Epoch: 4, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.358 Vali Acc: 0.062 Test Loss: 3.358 Test Acc: 0.062
Validation loss decreased (-0.057614 --> -0.062319).  Saving model ...
Epoch: 5 cost time: 1.1321427822113037
Epoch: 5, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.340 Vali Acc: 0.056 Test Loss: 3.340 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.312958002090454
Epoch: 6, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.322 Vali Acc: 0.080 Test Loss: 3.322 Test Acc: 0.080
Validation loss decreased (-0.062319 --> -0.079967).  Saving model ...
Epoch: 7 cost time: 1.237058162689209
Epoch: 7, Steps: 10 | Train Loss: 3.011 Vali Loss: 3.293 Vali Acc: 0.086 Test Loss: 3.293 Test Acc: 0.086
Validation loss decreased (-0.079967 --> -0.085849).  Saving model ...
Epoch: 8 cost time: 1.2288904190063477
Epoch: 8, Steps: 10 | Train Loss: 2.891 Vali Loss: 3.294 Vali Acc: 0.087 Test Loss: 3.294 Test Acc: 0.087
Validation loss decreased (-0.085849 --> -0.087026).  Saving model ...
Epoch: 9 cost time: 1.5798113346099854
Epoch: 9, Steps: 10 | Train Loss: 2.806 Vali Loss: 3.296 Vali Acc: 0.099 Test Loss: 3.296 Test Acc: 0.099
Validation loss decreased (-0.087026 --> -0.098791).  Saving model ...
Epoch: 10 cost time: 1.38480544090271
Epoch: 10, Steps: 10 | Train Loss: 2.677 Vali Loss: 3.280 Vali Acc: 0.092 Test Loss: 3.280 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4107766151428223
Epoch: 11, Steps: 10 | Train Loss: 2.633 Vali Loss: 3.287 Vali Acc: 0.104 Test Loss: 3.287 Test Acc: 0.104
Validation loss decreased (-0.098791 --> -0.103497).  Saving model ...
Epoch: 12 cost time: 1.342930793762207
Epoch: 12, Steps: 10 | Train Loss: 2.466 Vali Loss: 3.243 Vali Acc: 0.141 Test Loss: 3.243 Test Acc: 0.141
Validation loss decreased (-0.103497 --> -0.141144).  Saving model ...
Epoch: 13 cost time: 1.7372782230377197
Epoch: 13, Steps: 10 | Train Loss: 2.313 Vali Loss: 3.257 Vali Acc: 0.113 Test Loss: 3.257 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4972538948059082
Epoch: 14, Steps: 10 | Train Loss: 2.226 Vali Loss: 3.279 Vali Acc: 0.131 Test Loss: 3.279 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5818424224853516
Epoch: 15, Steps: 10 | Train Loss: 2.067 Vali Loss: 3.283 Vali Acc: 0.141 Test Loss: 3.283 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4812004566192627
Epoch: 16, Steps: 10 | Train Loss: 1.948 Vali Loss: 3.281 Vali Acc: 0.162 Test Loss: 3.281 Test Acc: 0.162
Validation loss decreased (-0.141144 --> -0.162320).  Saving model ...
Epoch: 17 cost time: 1.452779769897461
Epoch: 17, Steps: 10 | Train Loss: 1.811 Vali Loss: 3.276 Vali Acc: 0.165 Test Loss: 3.276 Test Acc: 0.165
Validation loss decreased (-0.162320 --> -0.164673).  Saving model ...
Epoch: 18 cost time: 1.7525217533111572
Epoch: 18, Steps: 10 | Train Loss: 1.674 Vali Loss: 3.331 Vali Acc: 0.167 Test Loss: 3.331 Test Acc: 0.167
Validation loss decreased (-0.164673 --> -0.167026).  Saving model ...
Epoch: 19 cost time: 1.6425096988677979
Epoch: 19, Steps: 10 | Train Loss: 1.572 Vali Loss: 3.344 Vali Acc: 0.174 Test Loss: 3.344 Test Acc: 0.174
Validation loss decreased (-0.167026 --> -0.174084).  Saving model ...
Epoch: 20 cost time: 1.5607750415802002
Epoch: 20, Steps: 10 | Train Loss: 1.430 Vali Loss: 3.362 Vali Acc: 0.200 Test Loss: 3.362 Test Acc: 0.200
Validation loss decreased (-0.174084 --> -0.199966).  Saving model ...
Epoch: 21 cost time: 1.1378886699676514
Epoch: 21, Steps: 10 | Train Loss: 1.359 Vali Loss: 3.339 Vali Acc: 0.198 Test Loss: 3.339 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7885446548461914
Epoch: 22, Steps: 10 | Train Loss: 1.173 Vali Loss: 3.389 Vali Acc: 0.211 Test Loss: 3.389 Test Acc: 0.211
Validation loss decreased (-0.199966 --> -0.210554).  Saving model ...
Epoch: 23 cost time: 1.5959279537200928
Epoch: 23, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.421 Vali Acc: 0.220 Test Loss: 3.421 Test Acc: 0.220
Validation loss decreased (-0.210554 --> -0.219966).  Saving model ...
Epoch: 24 cost time: 1.4089360237121582
Epoch: 24, Steps: 10 | Train Loss: 0.973 Vali Loss: 3.418 Vali Acc: 0.218 Test Loss: 3.418 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3390896320343018
Epoch: 25, Steps: 10 | Train Loss: 0.840 Vali Loss: 3.440 Vali Acc: 0.231 Test Loss: 3.440 Test Acc: 0.231
Validation loss decreased (-0.219966 --> -0.230554).  Saving model ...
Epoch: 26 cost time: 1.5571649074554443
Epoch: 26, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.470 Vali Acc: 0.219 Test Loss: 3.470 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.66054368019104
Epoch: 27, Steps: 10 | Train Loss: 0.629 Vali Loss: 3.486 Vali Acc: 0.248 Test Loss: 3.486 Test Acc: 0.248
Validation loss decreased (-0.230554 --> -0.248200).  Saving model ...
Epoch: 28 cost time: 1.3403780460357666
Epoch: 28, Steps: 10 | Train Loss: 0.534 Vali Loss: 3.512 Vali Acc: 0.241 Test Loss: 3.512 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7230446338653564
Epoch: 29, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.565 Vali Acc: 0.249 Test Loss: 3.565 Test Acc: 0.249
Validation loss decreased (-0.248200 --> -0.249376).  Saving model ...
Epoch: 30 cost time: 1.6611487865447998
Epoch: 30, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.686 Vali Acc: 0.242 Test Loss: 3.686 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4977171421051025
Epoch: 31, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.609 Vali Acc: 0.255 Test Loss: 3.609 Test Acc: 0.255
Validation loss decreased (-0.249376 --> -0.255258).  Saving model ...
Epoch: 32 cost time: 1.7751853466033936
Epoch: 32, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.635 Vali Acc: 0.252 Test Loss: 3.635 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2230243682861328
Epoch: 33, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.790 Vali Acc: 0.240 Test Loss: 3.790 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4444305896759033
Epoch: 34, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.751 Vali Acc: 0.254 Test Loss: 3.751 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7801072597503662
Epoch: 35, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.835 Vali Acc: 0.252 Test Loss: 3.835 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.676253318786621
Epoch: 36, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.827 Vali Acc: 0.262 Test Loss: 3.827 Test Acc: 0.262
Validation loss decreased (-0.255258 --> -0.262315).  Saving model ...
Epoch: 37 cost time: 1.5747113227844238
Epoch: 37, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.864 Vali Acc: 0.255 Test Loss: 3.864 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.6245999336242676
Epoch: 38, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.842 Vali Acc: 0.259 Test Loss: 3.842 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7852730751037598
Epoch: 39, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.926 Vali Acc: 0.253 Test Loss: 3.926 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6019339561462402
Epoch: 40, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.953 Vali Acc: 0.265 Test Loss: 3.953 Test Acc: 0.265
Validation loss decreased (-0.262315 --> -0.264666).  Saving model ...
Epoch: 41 cost time: 1.392334222793579
Epoch: 41, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.953 Vali Acc: 0.261 Test Loss: 3.953 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.729161024093628
Epoch: 42, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.977 Vali Acc: 0.261 Test Loss: 3.977 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3345565795898438
Epoch: 43, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.024 Vali Acc: 0.265 Test Loss: 4.024 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.61248779296875
Epoch: 44, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.031 Vali Acc: 0.264 Test Loss: 4.031 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.9566190242767334
Epoch: 45, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.021 Vali Acc: 0.264 Test Loss: 4.021 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.4672000408172607
Epoch: 46, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.036 Vali Acc: 0.265 Test Loss: 4.036 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.4964520931243896
Epoch: 47, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.066 Vali Acc: 0.260 Test Loss: 4.066 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.712597131729126
Epoch: 48, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.103 Vali Acc: 0.258 Test Loss: 4.103 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.4524571895599365
Epoch: 49, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.112 Vali Acc: 0.262 Test Loss: 4.112 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.5622458457946777
Epoch: 50, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.123 Vali Acc: 0.265 Test Loss: 4.123 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 464062
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.549945592880249
Epoch: 1, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.326 Vali Acc: 0.038 Test Loss: 3.326 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.6829800605773926
Epoch: 2, Steps: 10 | Train Loss: 3.262 Vali Loss: 3.314 Vali Acc: 0.038 Test Loss: 3.314 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 1.4081387519836426
Epoch: 3, Steps: 10 | Train Loss: 3.181 Vali Loss: 3.334 Vali Acc: 0.042 Test Loss: 3.334 Test Acc: 0.042
Validation loss decreased (-0.037614 --> -0.042320).  Saving model ...
Epoch: 4 cost time: 1.4333124160766602
Epoch: 4, Steps: 10 | Train Loss: 3.142 Vali Loss: 3.336 Vali Acc: 0.048 Test Loss: 3.336 Test Acc: 0.048
Validation loss decreased (-0.042320 --> -0.048202).  Saving model ...
Epoch: 5 cost time: 1.4906127452850342
Epoch: 5, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.308 Vali Acc: 0.066 Test Loss: 3.308 Test Acc: 0.066
Validation loss decreased (-0.048202 --> -0.065849).  Saving model ...
Epoch: 6 cost time: 1.5922143459320068
Epoch: 6, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.287 Vali Acc: 0.074 Test Loss: 3.287 Test Acc: 0.074
Validation loss decreased (-0.065849 --> -0.074085).  Saving model ...
Epoch: 7 cost time: 1.7194559574127197
Epoch: 7, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.275 Vali Acc: 0.066 Test Loss: 3.275 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9860279560089111
Epoch: 8, Steps: 10 | Train Loss: 2.822 Vali Loss: 3.247 Vali Acc: 0.084 Test Loss: 3.247 Test Acc: 0.084
Validation loss decreased (-0.074085 --> -0.083497).  Saving model ...
Epoch: 9 cost time: 2.1490042209625244
Epoch: 9, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.259 Vali Acc: 0.080 Test Loss: 3.259 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4300551414489746
Epoch: 10, Steps: 10 | Train Loss: 2.698 Vali Loss: 3.250 Vali Acc: 0.104 Test Loss: 3.250 Test Acc: 0.104
Validation loss decreased (-0.083497 --> -0.103497).  Saving model ...
Epoch: 11 cost time: 1.4404866695404053
Epoch: 11, Steps: 10 | Train Loss: 2.523 Vali Loss: 3.212 Vali Acc: 0.131 Test Loss: 3.212 Test Acc: 0.131
Validation loss decreased (-0.103497 --> -0.130556).  Saving model ...
Epoch: 12 cost time: 1.529578685760498
Epoch: 12, Steps: 10 | Train Loss: 2.434 Vali Loss: 3.242 Vali Acc: 0.118 Test Loss: 3.242 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7800753116607666
Epoch: 13, Steps: 10 | Train Loss: 2.308 Vali Loss: 3.242 Vali Acc: 0.132 Test Loss: 3.242 Test Acc: 0.132
Validation loss decreased (-0.130556 --> -0.131732).  Saving model ...
Epoch: 14 cost time: 1.8562171459197998
Epoch: 14, Steps: 10 | Train Loss: 2.167 Vali Loss: 3.225 Vali Acc: 0.154 Test Loss: 3.225 Test Acc: 0.154
Validation loss decreased (-0.131732 --> -0.154085).  Saving model ...
Epoch: 15 cost time: 1.5178275108337402
Epoch: 15, Steps: 10 | Train Loss: 2.011 Vali Loss: 3.221 Vali Acc: 0.160 Test Loss: 3.221 Test Acc: 0.160
Validation loss decreased (-0.154085 --> -0.159968).  Saving model ...
Epoch: 16 cost time: 1.9785571098327637
Epoch: 16, Steps: 10 | Train Loss: 1.888 Vali Loss: 3.223 Vali Acc: 0.160 Test Loss: 3.223 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.268051862716675
Epoch: 17, Steps: 10 | Train Loss: 1.715 Vali Loss: 3.248 Vali Acc: 0.165 Test Loss: 3.248 Test Acc: 0.165
Validation loss decreased (-0.159968 --> -0.164673).  Saving model ...
Epoch: 18 cost time: 1.5799345970153809
Epoch: 18, Steps: 10 | Train Loss: 1.625 Vali Loss: 3.272 Vali Acc: 0.171 Test Loss: 3.272 Test Acc: 0.171
Validation loss decreased (-0.164673 --> -0.170556).  Saving model ...
Epoch: 19 cost time: 1.590362548828125
Epoch: 19, Steps: 10 | Train Loss: 1.471 Vali Loss: 3.248 Vali Acc: 0.180 Test Loss: 3.248 Test Acc: 0.180
Validation loss decreased (-0.170556 --> -0.179968).  Saving model ...
Epoch: 20 cost time: 2.091865301132202
Epoch: 20, Steps: 10 | Train Loss: 1.343 Vali Loss: 3.291 Vali Acc: 0.191 Test Loss: 3.291 Test Acc: 0.191
Validation loss decreased (-0.179968 --> -0.190555).  Saving model ...
Epoch: 21 cost time: 1.6593422889709473
Epoch: 21, Steps: 10 | Train Loss: 1.263 Vali Loss: 3.324 Vali Acc: 0.195 Test Loss: 3.324 Test Acc: 0.195
Validation loss decreased (-0.190555 --> -0.195261).  Saving model ...
Epoch: 22 cost time: 2.236464500427246
Epoch: 22, Steps: 10 | Train Loss: 1.128 Vali Loss: 3.301 Vali Acc: 0.200 Test Loss: 3.301 Test Acc: 0.200
Validation loss decreased (-0.195261 --> -0.199967).  Saving model ...
Epoch: 23 cost time: 2.248507499694824
Epoch: 23, Steps: 10 | Train Loss: 1.011 Vali Loss: 3.335 Vali Acc: 0.215 Test Loss: 3.335 Test Acc: 0.215
Validation loss decreased (-0.199967 --> -0.215261).  Saving model ...
Epoch: 24 cost time: 1.8424997329711914
Epoch: 24, Steps: 10 | Train Loss: 0.900 Vali Loss: 3.335 Vali Acc: 0.215 Test Loss: 3.335 Test Acc: 0.215
Validation loss decreased (-0.215261 --> -0.215261).  Saving model ...
Epoch: 25 cost time: 1.5600574016571045
Epoch: 25, Steps: 10 | Train Loss: 0.795 Vali Loss: 3.360 Vali Acc: 0.232 Test Loss: 3.360 Test Acc: 0.232
Validation loss decreased (-0.215261 --> -0.231731).  Saving model ...
Epoch: 26 cost time: 1.9164063930511475
Epoch: 26, Steps: 10 | Train Loss: 0.681 Vali Loss: 3.399 Vali Acc: 0.229 Test Loss: 3.399 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7475686073303223
Epoch: 27, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.432 Vali Acc: 0.244 Test Loss: 3.432 Test Acc: 0.244
Validation loss decreased (-0.231731 --> -0.243495).  Saving model ...
Epoch: 28 cost time: 1.7930703163146973
Epoch: 28, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.424 Vali Acc: 0.245 Test Loss: 3.424 Test Acc: 0.245
Validation loss decreased (-0.243495 --> -0.244672).  Saving model ...
Epoch: 29 cost time: 1.5264289379119873
Epoch: 29, Steps: 10 | Train Loss: 0.435 Vali Loss: 3.514 Vali Acc: 0.255 Test Loss: 3.514 Test Acc: 0.255
Validation loss decreased (-0.244672 --> -0.255259).  Saving model ...
Epoch: 30 cost time: 1.675189733505249
Epoch: 30, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.535 Vali Acc: 0.242 Test Loss: 3.535 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6089372634887695
Epoch: 31, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.592 Vali Acc: 0.252 Test Loss: 3.592 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.591324806213379
Epoch: 32, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.600 Vali Acc: 0.254 Test Loss: 3.600 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.70701003074646
Epoch: 33, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.712 Vali Acc: 0.256 Test Loss: 3.712 Test Acc: 0.256
Validation loss decreased (-0.255259 --> -0.256433).  Saving model ...
Epoch: 34 cost time: 1.937049388885498
Epoch: 34, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.697 Vali Acc: 0.264 Test Loss: 3.697 Test Acc: 0.264
Validation loss decreased (-0.256433 --> -0.263492).  Saving model ...
Epoch: 35 cost time: 1.6587891578674316
Epoch: 35, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.729 Vali Acc: 0.252 Test Loss: 3.729 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3886542320251465
Epoch: 36, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.779 Vali Acc: 0.255 Test Loss: 3.779 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7960224151611328
Epoch: 37, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.815 Vali Acc: 0.262 Test Loss: 3.815 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.9318559169769287
Epoch: 38, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.814 Vali Acc: 0.266 Test Loss: 3.814 Test Acc: 0.266
Validation loss decreased (-0.263492 --> -0.265844).  Saving model ...
Epoch: 39 cost time: 1.6001160144805908
Epoch: 39, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.863 Vali Acc: 0.256 Test Loss: 3.863 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6127192974090576
Epoch: 40, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.864 Vali Acc: 0.265 Test Loss: 3.864 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7611815929412842
Epoch: 41, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.918 Vali Acc: 0.262 Test Loss: 3.918 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.8767573833465576
Epoch: 42, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.950 Vali Acc: 0.264 Test Loss: 3.950 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.6866395473480225
Epoch: 43, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.951 Vali Acc: 0.273 Test Loss: 3.951 Test Acc: 0.273
Validation loss decreased (-0.265844 --> -0.272902).  Saving model ...
Epoch: 44 cost time: 1.2366490364074707
Epoch: 44, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.995 Vali Acc: 0.255 Test Loss: 3.995 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6277291774749756
Epoch: 45, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.030 Vali Acc: 0.265 Test Loss: 4.030 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.0978524684906006
Epoch: 46, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.014 Vali Acc: 0.264 Test Loss: 4.014 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.5081043243408203
Epoch: 47, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.061 Vali Acc: 0.266 Test Loss: 4.061 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.7962958812713623
Epoch: 48, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.062 Vali Acc: 0.272 Test Loss: 4.062 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3904900550842285
Epoch: 49, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.071 Vali Acc: 0.273 Test Loss: 4.071 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.3357765674591064
Epoch: 50, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.085 Vali Acc: 0.265 Test Loss: 4.085 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.5845837593078613
Epoch: 51, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.116 Vali Acc: 0.266 Test Loss: 4.116 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.9147703647613525
Epoch: 52, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.096 Vali Acc: 0.264 Test Loss: 4.096 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.6218440532684326
Epoch: 53, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.157 Vali Acc: 0.264 Test Loss: 4.157 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 462782
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5557634830474854
Epoch: 1, Steps: 10 | Train Loss: 3.396 Vali Loss: 3.454 Vali Acc: 0.044 Test Loss: 3.454 Test Acc: 0.044
Validation loss decreased (inf --> -0.043495).  Saving model ...
Epoch: 2 cost time: 1.2759766578674316
Epoch: 2, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.359 Vali Acc: 0.064 Test Loss: 3.359 Test Acc: 0.064
Validation loss decreased (-0.043495 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 1.1732332706451416
Epoch: 3, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.333 Vali Acc: 0.064 Test Loss: 3.333 Test Acc: 0.064
Validation loss decreased (-0.063496 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 1.46248197555542
Epoch: 4, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.310 Vali Acc: 0.064 Test Loss: 3.310 Test Acc: 0.064
Validation loss decreased (-0.063496 --> -0.063496).  Saving model ...
Epoch: 5 cost time: 1.4049596786499023
Epoch: 5, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.293 Vali Acc: 0.060 Test Loss: 3.293 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4950673580169678
Epoch: 6, Steps: 10 | Train Loss: 3.012 Vali Loss: 3.281 Vali Acc: 0.074 Test Loss: 3.281 Test Acc: 0.074
Validation loss decreased (-0.063496 --> -0.074085).  Saving model ...
Epoch: 7 cost time: 1.1506335735321045
Epoch: 7, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.285 Vali Acc: 0.088 Test Loss: 3.285 Test Acc: 0.088
Validation loss decreased (-0.074085 --> -0.088202).  Saving model ...
Epoch: 8 cost time: 1.5029523372650146
Epoch: 8, Steps: 10 | Train Loss: 2.833 Vali Loss: 3.275 Vali Acc: 0.069 Test Loss: 3.275 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4636151790618896
Epoch: 9, Steps: 10 | Train Loss: 2.809 Vali Loss: 3.259 Vali Acc: 0.107 Test Loss: 3.259 Test Acc: 0.107
Validation loss decreased (-0.088202 --> -0.107026).  Saving model ...
Epoch: 10 cost time: 1.2422547340393066
Epoch: 10, Steps: 10 | Train Loss: 2.673 Vali Loss: 3.221 Vali Acc: 0.106 Test Loss: 3.221 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4958674907684326
Epoch: 11, Steps: 10 | Train Loss: 2.590 Vali Loss: 3.237 Vali Acc: 0.125 Test Loss: 3.237 Test Acc: 0.125
Validation loss decreased (-0.107026 --> -0.124674).  Saving model ...
Epoch: 12 cost time: 1.2829644680023193
Epoch: 12, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.253 Vali Acc: 0.114 Test Loss: 3.253 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.72235107421875
Epoch: 13, Steps: 10 | Train Loss: 2.312 Vali Loss: 3.232 Vali Acc: 0.122 Test Loss: 3.232 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5296719074249268
Epoch: 14, Steps: 10 | Train Loss: 2.192 Vali Loss: 3.261 Vali Acc: 0.136 Test Loss: 3.261 Test Acc: 0.136
Validation loss decreased (-0.124674 --> -0.136438).  Saving model ...
Epoch: 15 cost time: 1.4219861030578613
Epoch: 15, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.235 Vali Acc: 0.158 Test Loss: 3.235 Test Acc: 0.158
Validation loss decreased (-0.136438 --> -0.157615).  Saving model ...
Epoch: 16 cost time: 1.5248377323150635
Epoch: 16, Steps: 10 | Train Loss: 1.923 Vali Loss: 3.260 Vali Acc: 0.140 Test Loss: 3.260 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5829970836639404
Epoch: 17, Steps: 10 | Train Loss: 1.790 Vali Loss: 3.222 Vali Acc: 0.159 Test Loss: 3.222 Test Acc: 0.159
Validation loss decreased (-0.157615 --> -0.158791).  Saving model ...
Epoch: 18 cost time: 1.4410078525543213
Epoch: 18, Steps: 10 | Train Loss: 1.665 Vali Loss: 3.278 Vali Acc: 0.173 Test Loss: 3.278 Test Acc: 0.173
Validation loss decreased (-0.158791 --> -0.172908).  Saving model ...
Epoch: 19 cost time: 1.6835136413574219
Epoch: 19, Steps: 10 | Train Loss: 1.530 Vali Loss: 3.303 Vali Acc: 0.185 Test Loss: 3.303 Test Acc: 0.185
Validation loss decreased (-0.172908 --> -0.184673).  Saving model ...
Epoch: 20 cost time: 1.8081576824188232
Epoch: 20, Steps: 10 | Train Loss: 1.435 Vali Loss: 3.319 Vali Acc: 0.189 Test Loss: 3.319 Test Acc: 0.189
Validation loss decreased (-0.184673 --> -0.189379).  Saving model ...
Epoch: 21 cost time: 1.342289686203003
Epoch: 21, Steps: 10 | Train Loss: 1.264 Vali Loss: 3.298 Vali Acc: 0.206 Test Loss: 3.298 Test Acc: 0.206
Validation loss decreased (-0.189379 --> -0.205849).  Saving model ...
Epoch: 22 cost time: 1.4265449047088623
Epoch: 22, Steps: 10 | Train Loss: 1.198 Vali Loss: 3.335 Vali Acc: 0.209 Test Loss: 3.335 Test Acc: 0.209
Validation loss decreased (-0.205849 --> -0.209378).  Saving model ...
Epoch: 23 cost time: 1.500422477722168
Epoch: 23, Steps: 10 | Train Loss: 1.087 Vali Loss: 3.393 Vali Acc: 0.196 Test Loss: 3.393 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5644199848175049
Epoch: 24, Steps: 10 | Train Loss: 0.946 Vali Loss: 3.341 Vali Acc: 0.222 Test Loss: 3.341 Test Acc: 0.222
Validation loss decreased (-0.209378 --> -0.222320).  Saving model ...
Epoch: 25 cost time: 1.8119347095489502
Epoch: 25, Steps: 10 | Train Loss: 0.854 Vali Loss: 3.400 Vali Acc: 0.228 Test Loss: 3.400 Test Acc: 0.228
Validation loss decreased (-0.222320 --> -0.228201).  Saving model ...
Epoch: 26 cost time: 1.3218145370483398
Epoch: 26, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.448 Vali Acc: 0.212 Test Loss: 3.448 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1492912769317627
Epoch: 27, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.421 Vali Acc: 0.228 Test Loss: 3.421 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4812488555908203
Epoch: 28, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.523 Vali Acc: 0.226 Test Loss: 3.523 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.439033031463623
Epoch: 29, Steps: 10 | Train Loss: 0.472 Vali Loss: 3.496 Vali Acc: 0.226 Test Loss: 3.496 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.385544776916504
Epoch: 30, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.541 Vali Acc: 0.233 Test Loss: 3.541 Test Acc: 0.233
Validation loss decreased (-0.228201 --> -0.232906).  Saving model ...
Epoch: 31 cost time: 1.4841997623443604
Epoch: 31, Steps: 10 | Train Loss: 0.367 Vali Loss: 3.643 Vali Acc: 0.228 Test Loss: 3.643 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4205124378204346
Epoch: 32, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.656 Vali Acc: 0.228 Test Loss: 3.656 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3209195137023926
Epoch: 33, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.709 Vali Acc: 0.245 Test Loss: 3.709 Test Acc: 0.245
Validation loss decreased (-0.232906 --> -0.244669).  Saving model ...
Epoch: 34 cost time: 1.1429059505462646
Epoch: 34, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.692 Vali Acc: 0.236 Test Loss: 3.692 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5505084991455078
Epoch: 35, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.717 Vali Acc: 0.238 Test Loss: 3.717 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3767971992492676
Epoch: 36, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.762 Vali Acc: 0.235 Test Loss: 3.762 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1811015605926514
Epoch: 37, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.783 Vali Acc: 0.258 Test Loss: 3.783 Test Acc: 0.258
Validation loss decreased (-0.244669 --> -0.257609).  Saving model ...
Epoch: 38 cost time: 1.276449203491211
Epoch: 38, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.849 Vali Acc: 0.245 Test Loss: 3.849 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2532765865325928
Epoch: 39, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.843 Vali Acc: 0.255 Test Loss: 3.843 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1699154376983643
Epoch: 40, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.868 Vali Acc: 0.259 Test Loss: 3.868 Test Acc: 0.259
Validation loss decreased (-0.257609 --> -0.258785).  Saving model ...
Epoch: 41 cost time: 1.3154826164245605
Epoch: 41, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.961 Vali Acc: 0.246 Test Loss: 3.961 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2281970977783203
Epoch: 42, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.881 Vali Acc: 0.258 Test Loss: 3.881 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.012542724609375
Epoch: 43, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.908 Vali Acc: 0.258 Test Loss: 3.908 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3090872764587402
Epoch: 44, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.950 Vali Acc: 0.264 Test Loss: 3.950 Test Acc: 0.264
Validation loss decreased (-0.258785 --> -0.263490).  Saving model ...
Epoch: 45 cost time: 1.2846243381500244
Epoch: 45, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.988 Vali Acc: 0.260 Test Loss: 3.988 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.226515531539917
Epoch: 46, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.017 Vali Acc: 0.259 Test Loss: 4.017 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.279660940170288
Epoch: 47, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.014 Vali Acc: 0.265 Test Loss: 4.014 Test Acc: 0.265
Validation loss decreased (-0.263490 --> -0.264666).  Saving model ...
Epoch: 48 cost time: 1.250943899154663
Epoch: 48, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.059 Vali Acc: 0.265 Test Loss: 4.059 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.5279216766357422
Epoch: 49, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.063 Vali Acc: 0.266 Test Loss: 4.063 Test Acc: 0.266
Validation loss decreased (-0.264666 --> -0.265842).  Saving model ...
Epoch: 50 cost time: 1.22041916847229
Epoch: 50, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.069 Vali Acc: 0.264 Test Loss: 4.069 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.3645448684692383
Epoch: 51, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.077 Vali Acc: 0.264 Test Loss: 4.077 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.402954339981079
Epoch: 52, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.109 Vali Acc: 0.265 Test Loss: 4.109 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.3248555660247803
Epoch: 53, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.116 Vali Acc: 0.265 Test Loss: 4.116 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.2166919708251953
Epoch: 54, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.133 Vali Acc: 0.264 Test Loss: 4.133 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.7393131256103516
Epoch: 55, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.146 Vali Acc: 0.268 Test Loss: 4.146 Test Acc: 0.268
Validation loss decreased (-0.265842 --> -0.268194).  Saving model ...
Epoch: 56 cost time: 1.4251396656036377
Epoch: 56, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.150 Vali Acc: 0.271 Test Loss: 4.150 Test Acc: 0.271
Validation loss decreased (-0.268194 --> -0.270547).  Saving model ...
Epoch: 57 cost time: 1.7911732196807861
Epoch: 57, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.192 Vali Acc: 0.266 Test Loss: 4.192 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.3524105548858643
Epoch: 58, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.194 Vali Acc: 0.267 Test Loss: 4.194 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.1828877925872803
Epoch: 59, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.179 Vali Acc: 0.269 Test Loss: 4.179 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.3393990993499756
Epoch: 60, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.215 Vali Acc: 0.271 Test Loss: 4.215 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.540414571762085
Epoch: 61, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.208 Vali Acc: 0.271 Test Loss: 4.208 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.440143346786499
Epoch: 62, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.227 Vali Acc: 0.273 Test Loss: 4.227 Test Acc: 0.273
Validation loss decreased (-0.270547 --> -0.272899).  Saving model ...
Epoch: 63 cost time: 1.6861419677734375
Epoch: 63, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.260 Vali Acc: 0.266 Test Loss: 4.260 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.6948566436767578
Epoch: 64, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.266 Vali Acc: 0.266 Test Loss: 4.266 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.5369598865509033
Epoch: 65, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.287 Vali Acc: 0.267 Test Loss: 4.287 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.3937044143676758
Epoch: 66, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.299 Vali Acc: 0.268 Test Loss: 4.299 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.558312177658081
Epoch: 67, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.309 Vali Acc: 0.266 Test Loss: 4.309 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.3976898193359375
Epoch: 68, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.315 Vali Acc: 0.266 Test Loss: 4.315 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.483534574508667
Epoch: 69, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.316 Vali Acc: 0.265 Test Loss: 4.316 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.455352544784546
Epoch: 70, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.342 Vali Acc: 0.271 Test Loss: 4.342 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.185229778289795
Epoch: 71, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.351 Vali Acc: 0.269 Test Loss: 4.351 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.4954380989074707
Epoch: 72, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.339 Vali Acc: 0.265 Test Loss: 4.339 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 461502
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.493644952774048
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.350 Vali Acc: 0.040 Test Loss: 3.350 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 1.583008050918579
Epoch: 2, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.320 Vali Acc: 0.047 Test Loss: 3.320 Test Acc: 0.047
Validation loss decreased (-0.039966 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 1.1478440761566162
Epoch: 3, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.325 Vali Acc: 0.032 Test Loss: 3.325 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2271203994750977
Epoch: 4, Steps: 10 | Train Loss: 3.168 Vali Loss: 3.328 Vali Acc: 0.035 Test Loss: 3.328 Test Acc: 0.035
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.620924949645996
Epoch: 5, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.339 Vali Acc: 0.047 Test Loss: 3.339 Test Acc: 0.047
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3505873680114746
Epoch: 6, Steps: 10 | Train Loss: 3.098 Vali Loss: 3.330 Vali Acc: 0.051 Test Loss: 3.330 Test Acc: 0.051
Validation loss decreased (-0.047026 --> -0.050555).  Saving model ...
Epoch: 7 cost time: 1.4305124282836914
Epoch: 7, Steps: 10 | Train Loss: 3.124 Vali Loss: 3.307 Vali Acc: 0.060 Test Loss: 3.307 Test Acc: 0.060
Validation loss decreased (-0.050555 --> -0.059967).  Saving model ...
Epoch: 8 cost time: 1.3128046989440918
Epoch: 8, Steps: 10 | Train Loss: 3.014 Vali Loss: 3.289 Vali Acc: 0.065 Test Loss: 3.289 Test Acc: 0.065
Validation loss decreased (-0.059967 --> -0.064673).  Saving model ...
Epoch: 9 cost time: 1.432356357574463
Epoch: 9, Steps: 10 | Train Loss: 2.951 Vali Loss: 3.295 Vali Acc: 0.069 Test Loss: 3.295 Test Acc: 0.069
Validation loss decreased (-0.064673 --> -0.069379).  Saving model ...
Epoch: 10 cost time: 1.3470594882965088
Epoch: 10, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.299 Vali Acc: 0.071 Test Loss: 3.299 Test Acc: 0.071
Validation loss decreased (-0.069379 --> -0.070555).  Saving model ...
Epoch: 11 cost time: 1.6642999649047852
Epoch: 11, Steps: 10 | Train Loss: 2.859 Vali Loss: 3.257 Vali Acc: 0.093 Test Loss: 3.257 Test Acc: 0.093
Validation loss decreased (-0.070555 --> -0.092909).  Saving model ...
Epoch: 12 cost time: 1.1547796726226807
Epoch: 12, Steps: 10 | Train Loss: 2.682 Vali Loss: 3.246 Vali Acc: 0.096 Test Loss: 3.246 Test Acc: 0.096
Validation loss decreased (-0.092909 --> -0.096438).  Saving model ...
Epoch: 13 cost time: 1.2104711532592773
Epoch: 13, Steps: 10 | Train Loss: 2.683 Vali Loss: 3.275 Vali Acc: 0.099 Test Loss: 3.275 Test Acc: 0.099
Validation loss decreased (-0.096438 --> -0.098791).  Saving model ...
Epoch: 14 cost time: 1.2850494384765625
Epoch: 14, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.249 Vali Acc: 0.114 Test Loss: 3.249 Test Acc: 0.114
Validation loss decreased (-0.098791 --> -0.114085).  Saving model ...
Epoch: 15 cost time: 1.2057874202728271
Epoch: 15, Steps: 10 | Train Loss: 2.372 Vali Loss: 3.248 Vali Acc: 0.127 Test Loss: 3.248 Test Acc: 0.127
Validation loss decreased (-0.114085 --> -0.127026).  Saving model ...
Epoch: 16 cost time: 1.3849537372589111
Epoch: 16, Steps: 10 | Train Loss: 2.392 Vali Loss: 3.266 Vali Acc: 0.126 Test Loss: 3.266 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.421712875366211
Epoch: 17, Steps: 10 | Train Loss: 2.246 Vali Loss: 3.218 Vali Acc: 0.128 Test Loss: 3.218 Test Acc: 0.128
Validation loss decreased (-0.127026 --> -0.128203).  Saving model ...
Epoch: 18 cost time: 1.2157206535339355
Epoch: 18, Steps: 10 | Train Loss: 2.132 Vali Loss: 3.213 Vali Acc: 0.133 Test Loss: 3.213 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 19 cost time: 1.429366111755371
Epoch: 19, Steps: 10 | Train Loss: 2.032 Vali Loss: 3.250 Vali Acc: 0.139 Test Loss: 3.250 Test Acc: 0.139
Validation loss decreased (-0.132909 --> -0.138791).  Saving model ...
Epoch: 20 cost time: 1.284454345703125
Epoch: 20, Steps: 10 | Train Loss: 1.890 Vali Loss: 3.234 Vali Acc: 0.147 Test Loss: 3.234 Test Acc: 0.147
Validation loss decreased (-0.138791 --> -0.147026).  Saving model ...
Epoch: 21 cost time: 1.225407600402832
Epoch: 21, Steps: 10 | Train Loss: 1.824 Vali Loss: 3.231 Vali Acc: 0.164 Test Loss: 3.231 Test Acc: 0.164
Validation loss decreased (-0.147026 --> -0.163497).  Saving model ...
Epoch: 22 cost time: 1.5914552211761475
Epoch: 22, Steps: 10 | Train Loss: 1.771 Vali Loss: 3.228 Vali Acc: 0.165 Test Loss: 3.228 Test Acc: 0.165
Validation loss decreased (-0.163497 --> -0.164674).  Saving model ...
Epoch: 23 cost time: 1.3006749153137207
Epoch: 23, Steps: 10 | Train Loss: 1.582 Vali Loss: 3.208 Vali Acc: 0.175 Test Loss: 3.208 Test Acc: 0.175
Validation loss decreased (-0.164674 --> -0.175262).  Saving model ...
Epoch: 24 cost time: 1.5041251182556152
Epoch: 24, Steps: 10 | Train Loss: 1.555 Vali Loss: 3.240 Vali Acc: 0.172 Test Loss: 3.240 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.308016300201416
Epoch: 25, Steps: 10 | Train Loss: 1.447 Vali Loss: 3.237 Vali Acc: 0.187 Test Loss: 3.237 Test Acc: 0.187
Validation loss decreased (-0.175262 --> -0.187026).  Saving model ...
Epoch: 26 cost time: 1.4932341575622559
Epoch: 26, Steps: 10 | Train Loss: 1.333 Vali Loss: 3.217 Vali Acc: 0.189 Test Loss: 3.217 Test Acc: 0.189
Validation loss decreased (-0.187026 --> -0.189380).  Saving model ...
Epoch: 27 cost time: 1.2073657512664795
Epoch: 27, Steps: 10 | Train Loss: 1.203 Vali Loss: 3.252 Vali Acc: 0.194 Test Loss: 3.252 Test Acc: 0.194
Validation loss decreased (-0.189380 --> -0.194085).  Saving model ...
Epoch: 28 cost time: 1.427053689956665
Epoch: 28, Steps: 10 | Train Loss: 1.136 Vali Loss: 3.239 Vali Acc: 0.206 Test Loss: 3.239 Test Acc: 0.206
Validation loss decreased (-0.194085 --> -0.205850).  Saving model ...
Epoch: 29 cost time: 1.3494594097137451
Epoch: 29, Steps: 10 | Train Loss: 0.997 Vali Loss: 3.275 Vali Acc: 0.200 Test Loss: 3.275 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4313757419586182
Epoch: 30, Steps: 10 | Train Loss: 0.955 Vali Loss: 3.259 Vali Acc: 0.211 Test Loss: 3.259 Test Acc: 0.211
Validation loss decreased (-0.205850 --> -0.210556).  Saving model ...
Epoch: 31 cost time: 1.563814401626587
Epoch: 31, Steps: 10 | Train Loss: 0.882 Vali Loss: 3.275 Vali Acc: 0.209 Test Loss: 3.275 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6473259925842285
Epoch: 32, Steps: 10 | Train Loss: 0.840 Vali Loss: 3.319 Vali Acc: 0.205 Test Loss: 3.319 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.132434606552124
Epoch: 33, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.323 Vali Acc: 0.215 Test Loss: 3.323 Test Acc: 0.215
Validation loss decreased (-0.210556 --> -0.215261).  Saving model ...
Epoch: 34 cost time: 1.4693293571472168
Epoch: 34, Steps: 10 | Train Loss: 0.686 Vali Loss: 3.329 Vali Acc: 0.221 Test Loss: 3.329 Test Acc: 0.221
Validation loss decreased (-0.215261 --> -0.221143).  Saving model ...
Epoch: 35 cost time: 1.4678878784179688
Epoch: 35, Steps: 10 | Train Loss: 0.649 Vali Loss: 3.352 Vali Acc: 0.220 Test Loss: 3.352 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4554297924041748
Epoch: 36, Steps: 10 | Train Loss: 0.552 Vali Loss: 3.367 Vali Acc: 0.211 Test Loss: 3.367 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5701844692230225
Epoch: 37, Steps: 10 | Train Loss: 0.503 Vali Loss: 3.369 Vali Acc: 0.220 Test Loss: 3.369 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4548916816711426
Epoch: 38, Steps: 10 | Train Loss: 0.473 Vali Loss: 3.456 Vali Acc: 0.216 Test Loss: 3.456 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6598341464996338
Epoch: 39, Steps: 10 | Train Loss: 0.463 Vali Loss: 3.467 Vali Acc: 0.218 Test Loss: 3.467 Test Acc: 0.218
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.322371006011963
Epoch: 40, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.488 Vali Acc: 0.228 Test Loss: 3.488 Test Acc: 0.228
Validation loss decreased (-0.221143 --> -0.228200).  Saving model ...
Epoch: 41 cost time: 1.668872356414795
Epoch: 41, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.398 Vali Acc: 0.247 Test Loss: 3.398 Test Acc: 0.247
Validation loss decreased (-0.228200 --> -0.247025).  Saving model ...
Epoch: 42 cost time: 1.5442206859588623
Epoch: 42, Steps: 10 | Train Loss: 0.285 Vali Loss: 3.526 Vali Acc: 0.233 Test Loss: 3.526 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4609935283660889
Epoch: 43, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.569 Vali Acc: 0.229 Test Loss: 3.569 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.4230332374572754
Epoch: 44, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.501 Vali Acc: 0.222 Test Loss: 3.501 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.536860704421997
Epoch: 45, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.725 Vali Acc: 0.220 Test Loss: 3.725 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.349379301071167
Epoch: 46, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.641 Vali Acc: 0.232 Test Loss: 3.641 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.3885736465454102
Epoch: 47, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.600 Vali Acc: 0.241 Test Loss: 3.600 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.44211745262146
Epoch: 48, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.595 Vali Acc: 0.235 Test Loss: 3.595 Test Acc: 0.235
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.6057953834533691
Epoch: 49, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.755 Vali Acc: 0.226 Test Loss: 3.755 Test Acc: 0.226
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.4724807739257812
Epoch: 50, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.654 Vali Acc: 0.247 Test Loss: 3.654 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.4329760074615479
Epoch: 51, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.695 Vali Acc: 0.241 Test Loss: 3.695 Test Acc: 0.241
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24705882352941178
model parameter : 442302
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5446243286132812
Epoch: 1, Steps: 10 | Train Loss: 3.306 Vali Loss: 3.348 Vali Acc: 0.036 Test Loss: 3.348 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.3291723728179932
Epoch: 2, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.324 Vali Acc: 0.049 Test Loss: 3.324 Test Acc: 0.049
Validation loss decreased (-0.036437 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 1.2518107891082764
Epoch: 3, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.329 Vali Acc: 0.034 Test Loss: 3.329 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5239920616149902
Epoch: 4, Steps: 10 | Train Loss: 3.175 Vali Loss: 3.334 Vali Acc: 0.044 Test Loss: 3.334 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3143742084503174
Epoch: 5, Steps: 10 | Train Loss: 3.157 Vali Loss: 3.322 Vali Acc: 0.047 Test Loss: 3.322 Test Acc: 0.047
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.297628402709961
Epoch: 6, Steps: 10 | Train Loss: 3.126 Vali Loss: 3.304 Vali Acc: 0.053 Test Loss: 3.304 Test Acc: 0.053
Validation loss decreased (-0.049379 --> -0.052908).  Saving model ...
Epoch: 7 cost time: 1.147294521331787
Epoch: 7, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.306 Vali Acc: 0.052 Test Loss: 3.306 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3003778457641602
Epoch: 8, Steps: 10 | Train Loss: 3.044 Vali Loss: 3.311 Vali Acc: 0.071 Test Loss: 3.311 Test Acc: 0.071
Validation loss decreased (-0.052908 --> -0.070555).  Saving model ...
Epoch: 9 cost time: 1.0910708904266357
Epoch: 9, Steps: 10 | Train Loss: 2.992 Vali Loss: 3.282 Vali Acc: 0.073 Test Loss: 3.282 Test Acc: 0.073
Validation loss decreased (-0.070555 --> -0.072908).  Saving model ...
Epoch: 10 cost time: 1.5279483795166016
Epoch: 10, Steps: 10 | Train Loss: 2.910 Vali Loss: 3.259 Vali Acc: 0.093 Test Loss: 3.259 Test Acc: 0.093
Validation loss decreased (-0.072908 --> -0.092909).  Saving model ...
Epoch: 11 cost time: 1.4177427291870117
Epoch: 11, Steps: 10 | Train Loss: 2.818 Vali Loss: 3.237 Vali Acc: 0.100 Test Loss: 3.237 Test Acc: 0.100
Validation loss decreased (-0.092909 --> -0.099968).  Saving model ...
Epoch: 12 cost time: 1.721846580505371
Epoch: 12, Steps: 10 | Train Loss: 2.709 Vali Loss: 3.237 Vali Acc: 0.099 Test Loss: 3.237 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2062838077545166
Epoch: 13, Steps: 10 | Train Loss: 2.601 Vali Loss: 3.222 Vali Acc: 0.128 Test Loss: 3.222 Test Acc: 0.128
Validation loss decreased (-0.099968 --> -0.128203).  Saving model ...
Epoch: 14 cost time: 1.1725273132324219
Epoch: 14, Steps: 10 | Train Loss: 2.588 Vali Loss: 3.228 Vali Acc: 0.109 Test Loss: 3.228 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4335999488830566
Epoch: 15, Steps: 10 | Train Loss: 2.446 Vali Loss: 3.217 Vali Acc: 0.120 Test Loss: 3.217 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3372714519500732
Epoch: 16, Steps: 10 | Train Loss: 2.328 Vali Loss: 3.203 Vali Acc: 0.134 Test Loss: 3.203 Test Acc: 0.134
Validation loss decreased (-0.128203 --> -0.134086).  Saving model ...
Epoch: 17 cost time: 1.1779112815856934
Epoch: 17, Steps: 10 | Train Loss: 2.239 Vali Loss: 3.178 Vali Acc: 0.139 Test Loss: 3.178 Test Acc: 0.139
Validation loss decreased (-0.134086 --> -0.138792).  Saving model ...
Epoch: 18 cost time: 1.3132383823394775
Epoch: 18, Steps: 10 | Train Loss: 2.127 Vali Loss: 3.183 Vali Acc: 0.140 Test Loss: 3.183 Test Acc: 0.140
Validation loss decreased (-0.138792 --> -0.139968).  Saving model ...
Epoch: 19 cost time: 1.1743979454040527
Epoch: 19, Steps: 10 | Train Loss: 2.020 Vali Loss: 3.182 Vali Acc: 0.145 Test Loss: 3.182 Test Acc: 0.145
Validation loss decreased (-0.139968 --> -0.144674).  Saving model ...
Epoch: 20 cost time: 1.4749867916107178
Epoch: 20, Steps: 10 | Train Loss: 1.977 Vali Loss: 3.195 Vali Acc: 0.147 Test Loss: 3.195 Test Acc: 0.147
Validation loss decreased (-0.144674 --> -0.147027).  Saving model ...
Epoch: 21 cost time: 1.3354604244232178
Epoch: 21, Steps: 10 | Train Loss: 1.863 Vali Loss: 3.178 Vali Acc: 0.151 Test Loss: 3.178 Test Acc: 0.151
Validation loss decreased (-0.147027 --> -0.150556).  Saving model ...
Epoch: 22 cost time: 1.322812795639038
Epoch: 22, Steps: 10 | Train Loss: 1.731 Vali Loss: 3.175 Vali Acc: 0.164 Test Loss: 3.175 Test Acc: 0.164
Validation loss decreased (-0.150556 --> -0.163498).  Saving model ...
Epoch: 23 cost time: 1.2196447849273682
Epoch: 23, Steps: 10 | Train Loss: 1.662 Vali Loss: 3.181 Vali Acc: 0.160 Test Loss: 3.181 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8378345966339111
Epoch: 24, Steps: 10 | Train Loss: 1.512 Vali Loss: 3.171 Vali Acc: 0.175 Test Loss: 3.171 Test Acc: 0.175
Validation loss decreased (-0.163498 --> -0.175262).  Saving model ...
Epoch: 25 cost time: 1.680720329284668
Epoch: 25, Steps: 10 | Train Loss: 1.406 Vali Loss: 3.185 Vali Acc: 0.192 Test Loss: 3.185 Test Acc: 0.192
Validation loss decreased (-0.175262 --> -0.191733).  Saving model ...
Epoch: 26 cost time: 1.4730088710784912
Epoch: 26, Steps: 10 | Train Loss: 1.333 Vali Loss: 3.198 Vali Acc: 0.182 Test Loss: 3.198 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.644078254699707
Epoch: 27, Steps: 10 | Train Loss: 1.212 Vali Loss: 3.178 Vali Acc: 0.204 Test Loss: 3.178 Test Acc: 0.204
Validation loss decreased (-0.191733 --> -0.203498).  Saving model ...
Epoch: 28 cost time: 1.403170108795166
Epoch: 28, Steps: 10 | Train Loss: 1.113 Vali Loss: 3.219 Vali Acc: 0.206 Test Loss: 3.219 Test Acc: 0.206
Validation loss decreased (-0.203498 --> -0.205850).  Saving model ...
Epoch: 29 cost time: 1.2493557929992676
Epoch: 29, Steps: 10 | Train Loss: 1.066 Vali Loss: 3.206 Vali Acc: 0.200 Test Loss: 3.206 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.390383005142212
Epoch: 30, Steps: 10 | Train Loss: 0.946 Vali Loss: 3.208 Vali Acc: 0.219 Test Loss: 3.208 Test Acc: 0.219
Validation loss decreased (-0.205850 --> -0.218791).  Saving model ...
Epoch: 31 cost time: 1.5237832069396973
Epoch: 31, Steps: 10 | Train Loss: 0.965 Vali Loss: 3.244 Vali Acc: 0.214 Test Loss: 3.244 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4805023670196533
Epoch: 32, Steps: 10 | Train Loss: 0.822 Vali Loss: 3.212 Vali Acc: 0.229 Test Loss: 3.212 Test Acc: 0.229
Validation loss decreased (-0.218791 --> -0.229380).  Saving model ...
Epoch: 33 cost time: 1.2537426948547363
Epoch: 33, Steps: 10 | Train Loss: 0.735 Vali Loss: 3.345 Vali Acc: 0.208 Test Loss: 3.345 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1259431838989258
Epoch: 34, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.250 Vali Acc: 0.232 Test Loss: 3.250 Test Acc: 0.232
Validation loss decreased (-0.229380 --> -0.231732).  Saving model ...
Epoch: 35 cost time: 1.4738202095031738
Epoch: 35, Steps: 10 | Train Loss: 0.605 Vali Loss: 3.343 Vali Acc: 0.228 Test Loss: 3.343 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4510183334350586
Epoch: 36, Steps: 10 | Train Loss: 0.537 Vali Loss: 3.303 Vali Acc: 0.236 Test Loss: 3.303 Test Acc: 0.236
Validation loss decreased (-0.231732 --> -0.236438).  Saving model ...
Epoch: 37 cost time: 1.487874984741211
Epoch: 37, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.311 Vali Acc: 0.245 Test Loss: 3.311 Test Acc: 0.245
Validation loss decreased (-0.236438 --> -0.244673).  Saving model ...
Epoch: 38 cost time: 1.4760792255401611
Epoch: 38, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.361 Vali Acc: 0.227 Test Loss: 3.361 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7895948886871338
Epoch: 39, Steps: 10 | Train Loss: 0.416 Vali Loss: 3.449 Vali Acc: 0.234 Test Loss: 3.449 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3541038036346436
Epoch: 40, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.410 Vali Acc: 0.233 Test Loss: 3.410 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.262836217880249
Epoch: 41, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.391 Vali Acc: 0.245 Test Loss: 3.391 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.599527359008789
Epoch: 42, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.444 Vali Acc: 0.242 Test Loss: 3.444 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.6983642578125
Epoch: 43, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.494 Vali Acc: 0.233 Test Loss: 3.494 Test Acc: 0.233
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.5781383514404297
Epoch: 44, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.513 Vali Acc: 0.242 Test Loss: 3.513 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.4897396564483643
Epoch: 45, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.491 Vali Acc: 0.252 Test Loss: 3.491 Test Acc: 0.252
Validation loss decreased (-0.244673 --> -0.251730).  Saving model ...
Epoch: 46 cost time: 1.3356680870056152
Epoch: 46, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.582 Vali Acc: 0.235 Test Loss: 3.582 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.395378589630127
Epoch: 47, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.581 Vali Acc: 0.246 Test Loss: 3.581 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2799911499023438
Epoch: 48, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.561 Vali Acc: 0.251 Test Loss: 3.561 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.3022737503051758
Epoch: 49, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.589 Vali Acc: 0.248 Test Loss: 3.589 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.3872590065002441
Epoch: 50, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.641 Vali Acc: 0.248 Test Loss: 3.641 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.2367639541625977
Epoch: 51, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.678 Vali Acc: 0.255 Test Loss: 3.678 Test Acc: 0.255
Validation loss decreased (-0.251730 --> -0.255257).  Saving model ...
Epoch: 52 cost time: 1.3245799541473389
Epoch: 52, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.709 Vali Acc: 0.252 Test Loss: 3.709 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.204638957977295
Epoch: 53, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.625 Vali Acc: 0.261 Test Loss: 3.625 Test Acc: 0.261
Validation loss decreased (-0.255257 --> -0.261140).  Saving model ...
Epoch: 54 cost time: 1.4618825912475586
Epoch: 54, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.679 Vali Acc: 0.258 Test Loss: 3.679 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.355254888534546
Epoch: 55, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.771 Vali Acc: 0.246 Test Loss: 3.771 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.5425150394439697
Epoch: 56, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.703 Vali Acc: 0.264 Test Loss: 3.703 Test Acc: 0.264
Validation loss decreased (-0.261140 --> -0.263492).  Saving model ...
Epoch: 57 cost time: 1.255265712738037
Epoch: 57, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.771 Vali Acc: 0.260 Test Loss: 3.771 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1974313259124756
Epoch: 58, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.715 Vali Acc: 0.255 Test Loss: 3.715 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.2292394638061523
Epoch: 59, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.800 Vali Acc: 0.260 Test Loss: 3.800 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.5615296363830566
Epoch: 60, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.800 Vali Acc: 0.262 Test Loss: 3.800 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.4422576427459717
Epoch: 61, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.896 Vali Acc: 0.248 Test Loss: 3.896 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.2465400695800781
Epoch: 62, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.829 Vali Acc: 0.265 Test Loss: 3.829 Test Acc: 0.265
Validation loss decreased (-0.263492 --> -0.264668).  Saving model ...
Epoch: 63 cost time: 1.4422645568847656
Epoch: 63, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.843 Vali Acc: 0.253 Test Loss: 3.843 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.369379997253418
Epoch: 64, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.888 Vali Acc: 0.252 Test Loss: 3.888 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.3695547580718994
Epoch: 65, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.858 Vali Acc: 0.260 Test Loss: 3.858 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.4999117851257324
Epoch: 66, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.911 Vali Acc: 0.261 Test Loss: 3.911 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.7222464084625244
Epoch: 67, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.877 Vali Acc: 0.258 Test Loss: 3.877 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.5175583362579346
Epoch: 68, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.897 Vali Acc: 0.255 Test Loss: 3.897 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.2527236938476562
Epoch: 69, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.946 Vali Acc: 0.267 Test Loss: 3.946 Test Acc: 0.267
Validation loss decreased (-0.264668 --> -0.267019).  Saving model ...
Epoch: 70 cost time: 1.2344999313354492
Epoch: 70, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.905 Vali Acc: 0.260 Test Loss: 3.905 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.428743600845337
Epoch: 71, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.961 Vali Acc: 0.269 Test Loss: 3.961 Test Acc: 0.269
Validation loss decreased (-0.267019 --> -0.269372).  Saving model ...
Epoch: 72 cost time: 1.4323973655700684
Epoch: 72, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.908 Vali Acc: 0.273 Test Loss: 3.908 Test Acc: 0.273
Validation loss decreased (-0.269372 --> -0.272902).  Saving model ...
Epoch: 73 cost time: 1.3466534614562988
Epoch: 73, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.939 Vali Acc: 0.276 Test Loss: 3.939 Test Acc: 0.276
Validation loss decreased (-0.272902 --> -0.276431).  Saving model ...
Epoch: 74 cost time: 1.4365947246551514
Epoch: 74, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.967 Vali Acc: 0.268 Test Loss: 3.967 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.5324280261993408
Epoch: 75, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.998 Vali Acc: 0.260 Test Loss: 3.998 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.5856120586395264
Epoch: 76, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.006 Vali Acc: 0.259 Test Loss: 4.006 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.3284592628479004
Epoch: 77, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.003 Vali Acc: 0.264 Test Loss: 4.003 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.1556658744812012
Epoch: 78, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.987 Vali Acc: 0.266 Test Loss: 3.987 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.4387738704681396
Epoch: 79, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.018 Vali Acc: 0.266 Test Loss: 4.018 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.467524766921997
Epoch: 80, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.047 Vali Acc: 0.265 Test Loss: 4.047 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.338285207748413
Epoch: 81, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.038 Vali Acc: 0.258 Test Loss: 4.038 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.3547255992889404
Epoch: 82, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.102 Vali Acc: 0.265 Test Loss: 4.102 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.5542869567871094
Epoch: 83, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.043 Vali Acc: 0.269 Test Loss: 4.043 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 441662
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.558542013168335
Epoch: 1, Steps: 10 | Train Loss: 3.485 Vali Loss: 3.473 Vali Acc: 0.027 Test Loss: 3.473 Test Acc: 0.027
Validation loss decreased (inf --> -0.027024).  Saving model ...
Epoch: 2 cost time: 1.4658775329589844
Epoch: 2, Steps: 10 | Train Loss: 3.428 Vali Loss: 3.381 Vali Acc: 0.033 Test Loss: 3.381 Test Acc: 0.033
Validation loss decreased (-0.027024 --> -0.032907).  Saving model ...
Epoch: 3 cost time: 1.3681459426879883
Epoch: 3, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.336 Vali Acc: 0.041 Test Loss: 3.336 Test Acc: 0.041
Validation loss decreased (-0.032907 --> -0.041143).  Saving model ...
Epoch: 4 cost time: 1.3881747722625732
Epoch: 4, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.346 Vali Acc: 0.049 Test Loss: 3.346 Test Acc: 0.049
Validation loss decreased (-0.041143 --> -0.049378).  Saving model ...
Epoch: 5 cost time: 1.1904375553131104
Epoch: 5, Steps: 10 | Train Loss: 3.142 Vali Loss: 3.350 Vali Acc: 0.049 Test Loss: 3.350 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.83024263381958
Epoch: 6, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.329 Vali Acc: 0.067 Test Loss: 3.329 Test Acc: 0.067
Validation loss decreased (-0.049378 --> -0.067026).  Saving model ...
Epoch: 7 cost time: 1.5967891216278076
Epoch: 7, Steps: 10 | Train Loss: 2.978 Vali Loss: 3.324 Vali Acc: 0.062 Test Loss: 3.324 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4093074798583984
Epoch: 8, Steps: 10 | Train Loss: 2.965 Vali Loss: 3.311 Vali Acc: 0.079 Test Loss: 3.311 Test Acc: 0.079
Validation loss decreased (-0.067026 --> -0.078790).  Saving model ...
Epoch: 9 cost time: 1.5229055881500244
Epoch: 9, Steps: 10 | Train Loss: 2.871 Vali Loss: 3.304 Vali Acc: 0.084 Test Loss: 3.304 Test Acc: 0.084
Validation loss decreased (-0.078790 --> -0.083496).  Saving model ...
Epoch: 10 cost time: 1.2610893249511719
Epoch: 10, Steps: 10 | Train Loss: 2.834 Vali Loss: 3.303 Vali Acc: 0.082 Test Loss: 3.303 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4406273365020752
Epoch: 11, Steps: 10 | Train Loss: 2.739 Vali Loss: 3.266 Vali Acc: 0.095 Test Loss: 3.266 Test Acc: 0.095
Validation loss decreased (-0.083496 --> -0.095261).  Saving model ...
Epoch: 12 cost time: 1.2657148838043213
Epoch: 12, Steps: 10 | Train Loss: 2.662 Vali Loss: 3.277 Vali Acc: 0.094 Test Loss: 3.277 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2989106178283691
Epoch: 13, Steps: 10 | Train Loss: 2.523 Vali Loss: 3.265 Vali Acc: 0.124 Test Loss: 3.265 Test Acc: 0.124
Validation loss decreased (-0.095261 --> -0.123497).  Saving model ...
Epoch: 14 cost time: 1.5549495220184326
Epoch: 14, Steps: 10 | Train Loss: 2.449 Vali Loss: 3.260 Vali Acc: 0.122 Test Loss: 3.260 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3657124042510986
Epoch: 15, Steps: 10 | Train Loss: 2.346 Vali Loss: 3.251 Vali Acc: 0.124 Test Loss: 3.251 Test Acc: 0.124
Validation loss decreased (-0.123497 --> -0.123497).  Saving model ...
Epoch: 16 cost time: 1.3804054260253906
Epoch: 16, Steps: 10 | Train Loss: 2.249 Vali Loss: 3.244 Vali Acc: 0.124 Test Loss: 3.244 Test Acc: 0.124
Validation loss decreased (-0.123497 --> -0.123497).  Saving model ...
Epoch: 17 cost time: 1.2792768478393555
Epoch: 17, Steps: 10 | Train Loss: 2.140 Vali Loss: 3.236 Vali Acc: 0.126 Test Loss: 3.236 Test Acc: 0.126
Validation loss decreased (-0.123497 --> -0.125850).  Saving model ...
Epoch: 18 cost time: 1.4448707103729248
Epoch: 18, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.254 Vali Acc: 0.136 Test Loss: 3.254 Test Acc: 0.136
Validation loss decreased (-0.125850 --> -0.136438).  Saving model ...
Epoch: 19 cost time: 1.4134905338287354
Epoch: 19, Steps: 10 | Train Loss: 1.981 Vali Loss: 3.249 Vali Acc: 0.147 Test Loss: 3.249 Test Acc: 0.147
Validation loss decreased (-0.136438 --> -0.147026).  Saving model ...
Epoch: 20 cost time: 1.7342290878295898
Epoch: 20, Steps: 10 | Train Loss: 1.794 Vali Loss: 3.235 Vali Acc: 0.152 Test Loss: 3.235 Test Acc: 0.152
Validation loss decreased (-0.147026 --> -0.151732).  Saving model ...
Epoch: 21 cost time: 1.370821475982666
Epoch: 21, Steps: 10 | Train Loss: 1.743 Vali Loss: 3.255 Vali Acc: 0.161 Test Loss: 3.255 Test Acc: 0.161
Validation loss decreased (-0.151732 --> -0.161144).  Saving model ...
Epoch: 22 cost time: 1.3986804485321045
Epoch: 22, Steps: 10 | Train Loss: 1.638 Vali Loss: 3.226 Vali Acc: 0.172 Test Loss: 3.226 Test Acc: 0.172
Validation loss decreased (-0.161144 --> -0.171732).  Saving model ...
Epoch: 23 cost time: 1.707947015762329
Epoch: 23, Steps: 10 | Train Loss: 1.597 Vali Loss: 3.255 Vali Acc: 0.178 Test Loss: 3.255 Test Acc: 0.178
Validation loss decreased (-0.171732 --> -0.177615).  Saving model ...
Epoch: 24 cost time: 1.3758876323699951
Epoch: 24, Steps: 10 | Train Loss: 1.487 Vali Loss: 3.249 Vali Acc: 0.182 Test Loss: 3.249 Test Acc: 0.182
Validation loss decreased (-0.177615 --> -0.182320).  Saving model ...
Epoch: 25 cost time: 1.2020032405853271
Epoch: 25, Steps: 10 | Train Loss: 1.317 Vali Loss: 3.249 Vali Acc: 0.185 Test Loss: 3.249 Test Acc: 0.185
Validation loss decreased (-0.182320 --> -0.184673).  Saving model ...
Epoch: 26 cost time: 1.3217263221740723
Epoch: 26, Steps: 10 | Train Loss: 1.219 Vali Loss: 3.285 Vali Acc: 0.192 Test Loss: 3.285 Test Acc: 0.192
Validation loss decreased (-0.184673 --> -0.191732).  Saving model ...
Epoch: 27 cost time: 1.4096040725708008
Epoch: 27, Steps: 10 | Train Loss: 1.225 Vali Loss: 3.324 Vali Acc: 0.176 Test Loss: 3.324 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3449218273162842
Epoch: 28, Steps: 10 | Train Loss: 1.105 Vali Loss: 3.276 Vali Acc: 0.205 Test Loss: 3.276 Test Acc: 0.205
Validation loss decreased (-0.191732 --> -0.204673).  Saving model ...
Epoch: 29 cost time: 1.3317537307739258
Epoch: 29, Steps: 10 | Train Loss: 0.991 Vali Loss: 3.301 Vali Acc: 0.200 Test Loss: 3.301 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3087990283966064
Epoch: 30, Steps: 10 | Train Loss: 0.920 Vali Loss: 3.306 Vali Acc: 0.208 Test Loss: 3.306 Test Acc: 0.208
Validation loss decreased (-0.204673 --> -0.208202).  Saving model ...
Epoch: 31 cost time: 1.660459280014038
Epoch: 31, Steps: 10 | Train Loss: 0.843 Vali Loss: 3.286 Vali Acc: 0.222 Test Loss: 3.286 Test Acc: 0.222
Validation loss decreased (-0.208202 --> -0.222320).  Saving model ...
Epoch: 32 cost time: 1.3527541160583496
Epoch: 32, Steps: 10 | Train Loss: 0.791 Vali Loss: 3.301 Vali Acc: 0.219 Test Loss: 3.301 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.545217514038086
Epoch: 33, Steps: 10 | Train Loss: 0.720 Vali Loss: 3.333 Vali Acc: 0.232 Test Loss: 3.333 Test Acc: 0.232
Validation loss decreased (-0.222320 --> -0.231731).  Saving model ...
Epoch: 34 cost time: 1.5729410648345947
Epoch: 34, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.307 Vali Acc: 0.222 Test Loss: 3.307 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.909749984741211
Epoch: 35, Steps: 10 | Train Loss: 0.553 Vali Loss: 3.462 Vali Acc: 0.209 Test Loss: 3.462 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3964860439300537
Epoch: 36, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.349 Vali Acc: 0.232 Test Loss: 3.349 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6407575607299805
Epoch: 37, Steps: 10 | Train Loss: 0.483 Vali Loss: 3.469 Vali Acc: 0.229 Test Loss: 3.469 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.4499931335449219
Epoch: 38, Steps: 10 | Train Loss: 0.447 Vali Loss: 3.441 Vali Acc: 0.228 Test Loss: 3.441 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2892482280731201
Epoch: 39, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.503 Vali Acc: 0.240 Test Loss: 3.503 Test Acc: 0.240
Validation loss decreased (-0.231731 --> -0.239965).  Saving model ...
Epoch: 40 cost time: 1.3559975624084473
Epoch: 40, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.457 Vali Acc: 0.246 Test Loss: 3.457 Test Acc: 0.246
Validation loss decreased (-0.239965 --> -0.245848).  Saving model ...
Epoch: 41 cost time: 1.4789514541625977
Epoch: 41, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.440 Vali Acc: 0.242 Test Loss: 3.440 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2137353420257568
Epoch: 42, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.504 Vali Acc: 0.241 Test Loss: 3.504 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3456752300262451
Epoch: 43, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.577 Vali Acc: 0.234 Test Loss: 3.577 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1783766746520996
Epoch: 44, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.560 Vali Acc: 0.245 Test Loss: 3.560 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3124899864196777
Epoch: 45, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.556 Vali Acc: 0.239 Test Loss: 3.556 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.41548752784729
Epoch: 46, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.598 Vali Acc: 0.247 Test Loss: 3.598 Test Acc: 0.247
Validation loss decreased (-0.245848 --> -0.247023).  Saving model ...
Epoch: 47 cost time: 1.4608161449432373
Epoch: 47, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.592 Vali Acc: 0.242 Test Loss: 3.592 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4341247081756592
Epoch: 48, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.644 Vali Acc: 0.242 Test Loss: 3.644 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.680312156677246
Epoch: 49, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.678 Vali Acc: 0.241 Test Loss: 3.678 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.4955270290374756
Epoch: 50, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.677 Vali Acc: 0.251 Test Loss: 3.677 Test Acc: 0.251
Validation loss decreased (-0.247023 --> -0.250551).  Saving model ...
Epoch: 51 cost time: 1.3237171173095703
Epoch: 51, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.721 Vali Acc: 0.240 Test Loss: 3.721 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2380378246307373
Epoch: 52, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.692 Vali Acc: 0.254 Test Loss: 3.692 Test Acc: 0.254
Validation loss decreased (-0.250551 --> -0.254081).  Saving model ...
Epoch: 53 cost time: 1.3195674419403076
Epoch: 53, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.713 Vali Acc: 0.244 Test Loss: 3.713 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.4226486682891846
Epoch: 54, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.727 Vali Acc: 0.245 Test Loss: 3.727 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.4859180450439453
Epoch: 55, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.745 Vali Acc: 0.244 Test Loss: 3.745 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.8298437595367432
Epoch: 56, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.797 Vali Acc: 0.240 Test Loss: 3.797 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.4868133068084717
Epoch: 57, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.801 Vali Acc: 0.254 Test Loss: 3.801 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.5549097061157227
Epoch: 58, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.861 Vali Acc: 0.256 Test Loss: 3.861 Test Acc: 0.256
Validation loss decreased (-0.254081 --> -0.256432).  Saving model ...
Epoch: 59 cost time: 1.594390630722046
Epoch: 59, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.828 Vali Acc: 0.254 Test Loss: 3.828 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.402465581893921
Epoch: 60, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.914 Vali Acc: 0.248 Test Loss: 3.914 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.426079511642456
Epoch: 61, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.832 Vali Acc: 0.247 Test Loss: 3.832 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.6207499504089355
Epoch: 62, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.914 Vali Acc: 0.253 Test Loss: 3.914 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.5828375816345215
Epoch: 63, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.886 Vali Acc: 0.260 Test Loss: 3.886 Test Acc: 0.260
Validation loss decreased (-0.256432 --> -0.259961).  Saving model ...
Epoch: 64 cost time: 1.371377944946289
Epoch: 64, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.901 Vali Acc: 0.256 Test Loss: 3.901 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.7565584182739258
Epoch: 65, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.940 Vali Acc: 0.258 Test Loss: 3.940 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.2900230884552002
Epoch: 66, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.967 Vali Acc: 0.256 Test Loss: 3.967 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.3028028011322021
Epoch: 67, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.944 Vali Acc: 0.258 Test Loss: 3.944 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.3297357559204102
Epoch: 68, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.938 Vali Acc: 0.256 Test Loss: 3.938 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.4294648170471191
Epoch: 69, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.951 Vali Acc: 0.258 Test Loss: 3.951 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.1973118782043457
Epoch: 70, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.040 Vali Acc: 0.247 Test Loss: 4.040 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.5330853462219238
Epoch: 71, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.012 Vali Acc: 0.259 Test Loss: 4.012 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.4730403423309326
Epoch: 72, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.007 Vali Acc: 0.253 Test Loss: 4.007 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.4727380275726318
Epoch: 73, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.060 Vali Acc: 0.253 Test Loss: 4.060 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 441022
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.4074866771698
Epoch: 1, Steps: 10 | Train Loss: 3.408 Vali Loss: 3.370 Vali Acc: 0.048 Test Loss: 3.370 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 2.0222649574279785
Epoch: 2, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.317 Vali Acc: 0.042 Test Loss: 3.317 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7894394397735596
Epoch: 3, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.316 Vali Acc: 0.052 Test Loss: 3.316 Test Acc: 0.052
Validation loss decreased (-0.048202 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 1.5983190536499023
Epoch: 4, Steps: 10 | Train Loss: 3.154 Vali Loss: 3.339 Vali Acc: 0.052 Test Loss: 3.339 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5512633323669434
Epoch: 5, Steps: 10 | Train Loss: 3.092 Vali Loss: 3.333 Vali Acc: 0.054 Test Loss: 3.333 Test Acc: 0.054
Validation loss decreased (-0.051732 --> -0.054084).  Saving model ...
Epoch: 6 cost time: 1.556300401687622
Epoch: 6, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.313 Vali Acc: 0.065 Test Loss: 3.313 Test Acc: 0.065
Validation loss decreased (-0.054084 --> -0.064673).  Saving model ...
Epoch: 7 cost time: 1.3343417644500732
Epoch: 7, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.299 Vali Acc: 0.073 Test Loss: 3.299 Test Acc: 0.073
Validation loss decreased (-0.064673 --> -0.072908).  Saving model ...
Epoch: 8 cost time: 1.7330875396728516
Epoch: 8, Steps: 10 | Train Loss: 2.950 Vali Loss: 3.283 Vali Acc: 0.087 Test Loss: 3.283 Test Acc: 0.087
Validation loss decreased (-0.072908 --> -0.087026).  Saving model ...
Epoch: 9 cost time: 1.3869142532348633
Epoch: 9, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.284 Vali Acc: 0.078 Test Loss: 3.284 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6663002967834473
Epoch: 10, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.248 Vali Acc: 0.088 Test Loss: 3.248 Test Acc: 0.088
Validation loss decreased (-0.087026 --> -0.088203).  Saving model ...
Epoch: 11 cost time: 1.736149549484253
Epoch: 11, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.251 Vali Acc: 0.088 Test Loss: 3.251 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9401576519012451
Epoch: 12, Steps: 10 | Train Loss: 2.650 Vali Loss: 3.249 Vali Acc: 0.093 Test Loss: 3.249 Test Acc: 0.093
Validation loss decreased (-0.088203 --> -0.092909).  Saving model ...
Epoch: 13 cost time: 1.6135995388031006
Epoch: 13, Steps: 10 | Train Loss: 2.508 Vali Loss: 3.230 Vali Acc: 0.104 Test Loss: 3.230 Test Acc: 0.104
Validation loss decreased (-0.092909 --> -0.103497).  Saving model ...
Epoch: 14 cost time: 2.018878221511841
Epoch: 14, Steps: 10 | Train Loss: 2.380 Vali Loss: 3.220 Vali Acc: 0.102 Test Loss: 3.220 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.702052116394043
Epoch: 15, Steps: 10 | Train Loss: 2.355 Vali Loss: 3.234 Vali Acc: 0.105 Test Loss: 3.234 Test Acc: 0.105
Validation loss decreased (-0.103497 --> -0.104674).  Saving model ...
Epoch: 16 cost time: 1.2436459064483643
Epoch: 16, Steps: 10 | Train Loss: 2.231 Vali Loss: 3.227 Vali Acc: 0.128 Test Loss: 3.227 Test Acc: 0.128
Validation loss decreased (-0.104674 --> -0.128203).  Saving model ...
Epoch: 17 cost time: 2.2795259952545166
Epoch: 17, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.220 Vali Acc: 0.132 Test Loss: 3.220 Test Acc: 0.132
Validation loss decreased (-0.128203 --> -0.131733).  Saving model ...
Epoch: 18 cost time: 2.014862298965454
Epoch: 18, Steps: 10 | Train Loss: 2.021 Vali Loss: 3.217 Vali Acc: 0.138 Test Loss: 3.217 Test Acc: 0.138
Validation loss decreased (-0.131733 --> -0.137615).  Saving model ...
Epoch: 19 cost time: 1.6240057945251465
Epoch: 19, Steps: 10 | Train Loss: 1.931 Vali Loss: 3.220 Vali Acc: 0.136 Test Loss: 3.220 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.728020429611206
Epoch: 20, Steps: 10 | Train Loss: 1.836 Vali Loss: 3.218 Vali Acc: 0.148 Test Loss: 3.218 Test Acc: 0.148
Validation loss decreased (-0.137615 --> -0.148203).  Saving model ...
Epoch: 21 cost time: 1.683288335800171
Epoch: 21, Steps: 10 | Train Loss: 1.757 Vali Loss: 3.215 Vali Acc: 0.145 Test Loss: 3.215 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6209428310394287
Epoch: 22, Steps: 10 | Train Loss: 1.635 Vali Loss: 3.205 Vali Acc: 0.155 Test Loss: 3.205 Test Acc: 0.155
Validation loss decreased (-0.148203 --> -0.155262).  Saving model ...
Epoch: 23 cost time: 1.7463881969451904
Epoch: 23, Steps: 10 | Train Loss: 1.548 Vali Loss: 3.236 Vali Acc: 0.156 Test Loss: 3.236 Test Acc: 0.156
Validation loss decreased (-0.155262 --> -0.156438).  Saving model ...
Epoch: 24 cost time: 1.4744093418121338
Epoch: 24, Steps: 10 | Train Loss: 1.406 Vali Loss: 3.235 Vali Acc: 0.161 Test Loss: 3.235 Test Acc: 0.161
Validation loss decreased (-0.156438 --> -0.161144).  Saving model ...
Epoch: 25 cost time: 1.331014633178711
Epoch: 25, Steps: 10 | Train Loss: 1.295 Vali Loss: 3.239 Vali Acc: 0.159 Test Loss: 3.239 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0637567043304443
Epoch: 26, Steps: 10 | Train Loss: 1.239 Vali Loss: 3.314 Vali Acc: 0.173 Test Loss: 3.314 Test Acc: 0.173
Validation loss decreased (-0.161144 --> -0.172908).  Saving model ...
Epoch: 27 cost time: 1.697723627090454
Epoch: 27, Steps: 10 | Train Loss: 1.143 Vali Loss: 3.268 Vali Acc: 0.176 Test Loss: 3.268 Test Acc: 0.176
Validation loss decreased (-0.172908 --> -0.176438).  Saving model ...
Epoch: 28 cost time: 1.6606378555297852
Epoch: 28, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.273 Vali Acc: 0.180 Test Loss: 3.273 Test Acc: 0.180
Validation loss decreased (-0.176438 --> -0.179967).  Saving model ...
Epoch: 29 cost time: 1.6605777740478516
Epoch: 29, Steps: 10 | Train Loss: 1.012 Vali Loss: 3.322 Vali Acc: 0.187 Test Loss: 3.322 Test Acc: 0.187
Validation loss decreased (-0.179967 --> -0.187026).  Saving model ...
Epoch: 30 cost time: 1.6379852294921875
Epoch: 30, Steps: 10 | Train Loss: 0.875 Vali Loss: 3.335 Vali Acc: 0.192 Test Loss: 3.335 Test Acc: 0.192
Validation loss decreased (-0.187026 --> -0.191731).  Saving model ...
Epoch: 31 cost time: 1.5462918281555176
Epoch: 31, Steps: 10 | Train Loss: 0.800 Vali Loss: 3.349 Vali Acc: 0.189 Test Loss: 3.349 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7292916774749756
Epoch: 32, Steps: 10 | Train Loss: 0.741 Vali Loss: 3.347 Vali Acc: 0.204 Test Loss: 3.347 Test Acc: 0.204
Validation loss decreased (-0.191731 --> -0.203496).  Saving model ...
Epoch: 33 cost time: 1.8114371299743652
Epoch: 33, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.376 Vali Acc: 0.209 Test Loss: 3.376 Test Acc: 0.209
Validation loss decreased (-0.203496 --> -0.209378).  Saving model ...
Epoch: 34 cost time: 1.9071605205535889
Epoch: 34, Steps: 10 | Train Loss: 0.629 Vali Loss: 3.495 Vali Acc: 0.191 Test Loss: 3.495 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8274388313293457
Epoch: 35, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.455 Vali Acc: 0.199 Test Loss: 3.455 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.9736104011535645
Epoch: 36, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.449 Vali Acc: 0.206 Test Loss: 3.449 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7067351341247559
Epoch: 37, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.477 Vali Acc: 0.212 Test Loss: 3.477 Test Acc: 0.212
Validation loss decreased (-0.209378 --> -0.211730).  Saving model ...
Epoch: 38 cost time: 1.6959457397460938
Epoch: 38, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.489 Vali Acc: 0.207 Test Loss: 3.489 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3662443161010742
Epoch: 39, Steps: 10 | Train Loss: 0.379 Vali Loss: 3.468 Vali Acc: 0.225 Test Loss: 3.468 Test Acc: 0.225
Validation loss decreased (-0.211730 --> -0.224671).  Saving model ...
Epoch: 40 cost time: 1.2078940868377686
Epoch: 40, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.621 Vali Acc: 0.211 Test Loss: 3.621 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9244742393493652
Epoch: 41, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.562 Vali Acc: 0.231 Test Loss: 3.562 Test Acc: 0.231
Validation loss decreased (-0.224671 --> -0.230553).  Saving model ...
Epoch: 42 cost time: 1.721024990081787
Epoch: 42, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.602 Vali Acc: 0.227 Test Loss: 3.602 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.7813458442687988
Epoch: 43, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.605 Vali Acc: 0.236 Test Loss: 3.605 Test Acc: 0.236
Validation loss decreased (-0.230553 --> -0.236435).  Saving model ...
Epoch: 44 cost time: 1.4972095489501953
Epoch: 44, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.695 Vali Acc: 0.215 Test Loss: 3.695 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6276757717132568
Epoch: 45, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.730 Vali Acc: 0.226 Test Loss: 3.730 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.5815773010253906
Epoch: 46, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.666 Vali Acc: 0.239 Test Loss: 3.666 Test Acc: 0.239
Validation loss decreased (-0.236435 --> -0.238787).  Saving model ...
Epoch: 47 cost time: 1.3350365161895752
Epoch: 47, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.715 Vali Acc: 0.226 Test Loss: 3.715 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.7359626293182373
Epoch: 48, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.698 Vali Acc: 0.242 Test Loss: 3.698 Test Acc: 0.242
Validation loss decreased (-0.238787 --> -0.242316).  Saving model ...
Epoch: 49 cost time: 1.8637144565582275
Epoch: 49, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.739 Vali Acc: 0.235 Test Loss: 3.739 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.8099260330200195
Epoch: 50, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.733 Vali Acc: 0.242 Test Loss: 3.733 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.7433032989501953
Epoch: 51, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.804 Vali Acc: 0.235 Test Loss: 3.804 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.954148292541504
Epoch: 52, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.746 Vali Acc: 0.254 Test Loss: 3.746 Test Acc: 0.254
Validation loss decreased (-0.242316 --> -0.254080).  Saving model ...
Epoch: 53 cost time: 1.4382286071777344
Epoch: 53, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.837 Vali Acc: 0.254 Test Loss: 3.837 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.8118689060211182
Epoch: 54, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.947 Vali Acc: 0.241 Test Loss: 3.947 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.8684561252593994
Epoch: 55, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.818 Vali Acc: 0.239 Test Loss: 3.818 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.9525225162506104
Epoch: 56, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.890 Vali Acc: 0.245 Test Loss: 3.890 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.6007745265960693
Epoch: 57, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.870 Vali Acc: 0.252 Test Loss: 3.870 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.4967749118804932
Epoch: 58, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.875 Vali Acc: 0.244 Test Loss: 3.875 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.8057379722595215
Epoch: 59, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.948 Vali Acc: 0.246 Test Loss: 3.948 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.6559875011444092
Epoch: 60, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.928 Vali Acc: 0.249 Test Loss: 3.928 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.7162318229675293
Epoch: 61, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.980 Vali Acc: 0.236 Test Loss: 3.980 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.639223337173462
Epoch: 62, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.926 Vali Acc: 0.256 Test Loss: 3.926 Test Acc: 0.256
Validation loss decreased (-0.254080 --> -0.256431).  Saving model ...
Epoch: 63 cost time: 1.5890223979949951
Epoch: 63, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.013 Vali Acc: 0.252 Test Loss: 4.013 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.8418707847595215
Epoch: 64, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.915 Vali Acc: 0.245 Test Loss: 3.915 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.5851943492889404
Epoch: 65, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.012 Vali Acc: 0.251 Test Loss: 4.012 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.7926268577575684
Epoch: 66, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.980 Vali Acc: 0.252 Test Loss: 3.980 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.5500948429107666
Epoch: 67, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.986 Vali Acc: 0.253 Test Loss: 3.986 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.8036820888519287
Epoch: 68, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.025 Vali Acc: 0.251 Test Loss: 4.025 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.974801778793335
Epoch: 69, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.033 Vali Acc: 0.252 Test Loss: 4.033 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.9428844451904297
Epoch: 70, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.015 Vali Acc: 0.247 Test Loss: 4.015 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.673091173171997
Epoch: 71, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.024 Vali Acc: 0.266 Test Loss: 4.024 Test Acc: 0.266
Validation loss decreased (-0.256431 --> -0.265842).  Saving model ...
Epoch: 72 cost time: 1.766416072845459
Epoch: 72, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.056 Vali Acc: 0.258 Test Loss: 4.056 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.5798778533935547
Epoch: 73, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.051 Vali Acc: 0.252 Test Loss: 4.051 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.5781702995300293
Epoch: 74, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.084 Vali Acc: 0.259 Test Loss: 4.084 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.6848127841949463
Epoch: 75, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.133 Vali Acc: 0.254 Test Loss: 4.133 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.7391958236694336
Epoch: 76, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.100 Vali Acc: 0.249 Test Loss: 4.100 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.9192421436309814
Epoch: 77, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.078 Vali Acc: 0.255 Test Loss: 4.078 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.7711889743804932
Epoch: 78, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.114 Vali Acc: 0.254 Test Loss: 4.114 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 1.4492266178131104
Epoch: 79, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.104 Vali Acc: 0.258 Test Loss: 4.104 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 2.047546625137329
Epoch: 80, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.113 Vali Acc: 0.261 Test Loss: 4.113 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 1.7710599899291992
Epoch: 81, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.150 Vali Acc: 0.264 Test Loss: 4.150 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 440382
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.315915107727051
Epoch: 1, Steps: 10 | Train Loss: 3.382 Vali Loss: 3.365 Vali Acc: 0.047 Test Loss: 3.365 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 1.441817045211792
Epoch: 2, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.333 Vali Acc: 0.041 Test Loss: 3.333 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8148181438446045
Epoch: 3, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.326 Vali Acc: 0.033 Test Loss: 3.326 Test Acc: 0.033
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9772381782531738
Epoch: 4, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.335 Vali Acc: 0.046 Test Loss: 3.335 Test Acc: 0.046
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7974863052368164
Epoch: 5, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.346 Vali Acc: 0.041 Test Loss: 3.346 Test Acc: 0.041
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.291049003601074
Epoch: 6, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.333 Vali Acc: 0.064 Test Loss: 3.333 Test Acc: 0.064
Validation loss decreased (-0.047025 --> -0.063496).  Saving model ...
Epoch: 7 cost time: 2.1126320362091064
Epoch: 7, Steps: 10 | Train Loss: 3.026 Vali Loss: 3.327 Vali Acc: 0.067 Test Loss: 3.327 Test Acc: 0.067
Validation loss decreased (-0.063496 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 2.1491470336914062
Epoch: 8, Steps: 10 | Train Loss: 3.008 Vali Loss: 3.307 Vali Acc: 0.065 Test Loss: 3.307 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8506731986999512
Epoch: 9, Steps: 10 | Train Loss: 2.972 Vali Loss: 3.305 Vali Acc: 0.078 Test Loss: 3.305 Test Acc: 0.078
Validation loss decreased (-0.067026 --> -0.077614).  Saving model ...
Epoch: 10 cost time: 1.9071896076202393
Epoch: 10, Steps: 10 | Train Loss: 2.942 Vali Loss: 3.296 Vali Acc: 0.080 Test Loss: 3.296 Test Acc: 0.080
Validation loss decreased (-0.077614 --> -0.079967).  Saving model ...
Epoch: 11 cost time: 1.3150444030761719
Epoch: 11, Steps: 10 | Train Loss: 2.820 Vali Loss: 3.280 Vali Acc: 0.086 Test Loss: 3.280 Test Acc: 0.086
Validation loss decreased (-0.079967 --> -0.085850).  Saving model ...
Epoch: 12 cost time: 1.6797573566436768
Epoch: 12, Steps: 10 | Train Loss: 2.738 Vali Loss: 3.275 Vali Acc: 0.091 Test Loss: 3.275 Test Acc: 0.091
Validation loss decreased (-0.085850 --> -0.090555).  Saving model ...
Epoch: 13 cost time: 1.581284523010254
Epoch: 13, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.280 Vali Acc: 0.093 Test Loss: 3.280 Test Acc: 0.093
Validation loss decreased (-0.090555 --> -0.092908).  Saving model ...
Epoch: 14 cost time: 1.931910753250122
Epoch: 14, Steps: 10 | Train Loss: 2.571 Vali Loss: 3.257 Vali Acc: 0.108 Test Loss: 3.257 Test Acc: 0.108
Validation loss decreased (-0.092908 --> -0.108203).  Saving model ...
Epoch: 15 cost time: 2.2595949172973633
Epoch: 15, Steps: 10 | Train Loss: 2.500 Vali Loss: 3.266 Vali Acc: 0.113 Test Loss: 3.266 Test Acc: 0.113
Validation loss decreased (-0.108203 --> -0.112909).  Saving model ...
Epoch: 16 cost time: 1.3086574077606201
Epoch: 16, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.278 Vali Acc: 0.122 Test Loss: 3.278 Test Acc: 0.122
Validation loss decreased (-0.112909 --> -0.122320).  Saving model ...
Epoch: 17 cost time: 1.6702752113342285
Epoch: 17, Steps: 10 | Train Loss: 2.298 Vali Loss: 3.276 Vali Acc: 0.127 Test Loss: 3.276 Test Acc: 0.127
Validation loss decreased (-0.122320 --> -0.127026).  Saving model ...
Epoch: 18 cost time: 1.472968578338623
Epoch: 18, Steps: 10 | Train Loss: 2.216 Vali Loss: 3.297 Vali Acc: 0.129 Test Loss: 3.297 Test Acc: 0.129
Validation loss decreased (-0.127026 --> -0.129379).  Saving model ...
Epoch: 19 cost time: 1.4481127262115479
Epoch: 19, Steps: 10 | Train Loss: 2.113 Vali Loss: 3.270 Vali Acc: 0.138 Test Loss: 3.270 Test Acc: 0.138
Validation loss decreased (-0.129379 --> -0.137614).  Saving model ...
Epoch: 20 cost time: 1.5691721439361572
Epoch: 20, Steps: 10 | Train Loss: 1.995 Vali Loss: 3.279 Vali Acc: 0.145 Test Loss: 3.279 Test Acc: 0.145
Validation loss decreased (-0.137614 --> -0.144673).  Saving model ...
Epoch: 21 cost time: 1.630622386932373
Epoch: 21, Steps: 10 | Train Loss: 1.878 Vali Loss: 3.291 Vali Acc: 0.146 Test Loss: 3.291 Test Acc: 0.146
Validation loss decreased (-0.144673 --> -0.145849).  Saving model ...
Epoch: 22 cost time: 1.6597256660461426
Epoch: 22, Steps: 10 | Train Loss: 1.828 Vali Loss: 3.301 Vali Acc: 0.152 Test Loss: 3.301 Test Acc: 0.152
Validation loss decreased (-0.145849 --> -0.151732).  Saving model ...
Epoch: 23 cost time: 1.3341658115386963
Epoch: 23, Steps: 10 | Train Loss: 1.718 Vali Loss: 3.300 Vali Acc: 0.164 Test Loss: 3.300 Test Acc: 0.164
Validation loss decreased (-0.151732 --> -0.163496).  Saving model ...
Epoch: 24 cost time: 1.671536922454834
Epoch: 24, Steps: 10 | Train Loss: 1.638 Vali Loss: 3.297 Vali Acc: 0.174 Test Loss: 3.297 Test Acc: 0.174
Validation loss decreased (-0.163496 --> -0.174085).  Saving model ...
Epoch: 25 cost time: 1.7534112930297852
Epoch: 25, Steps: 10 | Train Loss: 1.578 Vali Loss: 3.315 Vali Acc: 0.188 Test Loss: 3.315 Test Acc: 0.188
Validation loss decreased (-0.174085 --> -0.188202).  Saving model ...
Epoch: 26 cost time: 1.3795497417449951
Epoch: 26, Steps: 10 | Train Loss: 1.501 Vali Loss: 3.310 Vali Acc: 0.166 Test Loss: 3.310 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3865835666656494
Epoch: 27, Steps: 10 | Train Loss: 1.357 Vali Loss: 3.335 Vali Acc: 0.181 Test Loss: 3.335 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8247032165527344
Epoch: 28, Steps: 10 | Train Loss: 1.269 Vali Loss: 3.329 Vali Acc: 0.184 Test Loss: 3.329 Test Acc: 0.184
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8708500862121582
Epoch: 29, Steps: 10 | Train Loss: 1.171 Vali Loss: 3.353 Vali Acc: 0.186 Test Loss: 3.353 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2535762786865234
Epoch: 30, Steps: 10 | Train Loss: 1.078 Vali Loss: 3.331 Vali Acc: 0.186 Test Loss: 3.331 Test Acc: 0.186
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.519836664199829
Epoch: 31, Steps: 10 | Train Loss: 1.004 Vali Loss: 3.334 Vali Acc: 0.196 Test Loss: 3.334 Test Acc: 0.196
Validation loss decreased (-0.188202 --> -0.196437).  Saving model ...
Epoch: 32 cost time: 1.9401731491088867
Epoch: 32, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.372 Vali Acc: 0.200 Test Loss: 3.372 Test Acc: 0.200
Validation loss decreased (-0.196437 --> -0.199966).  Saving model ...
Epoch: 33 cost time: 1.7790682315826416
Epoch: 33, Steps: 10 | Train Loss: 0.901 Vali Loss: 3.373 Vali Acc: 0.208 Test Loss: 3.373 Test Acc: 0.208
Validation loss decreased (-0.199966 --> -0.208202).  Saving model ...
Epoch: 34 cost time: 1.6012804508209229
Epoch: 34, Steps: 10 | Train Loss: 0.822 Vali Loss: 3.350 Vali Acc: 0.212 Test Loss: 3.350 Test Acc: 0.212
Validation loss decreased (-0.208202 --> -0.211731).  Saving model ...
Epoch: 35 cost time: 1.5518457889556885
Epoch: 35, Steps: 10 | Train Loss: 0.741 Vali Loss: 3.390 Vali Acc: 0.209 Test Loss: 3.390 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.57566499710083
Epoch: 36, Steps: 10 | Train Loss: 0.688 Vali Loss: 3.418 Vali Acc: 0.208 Test Loss: 3.418 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5424847602844238
Epoch: 37, Steps: 10 | Train Loss: 0.654 Vali Loss: 3.425 Vali Acc: 0.222 Test Loss: 3.425 Test Acc: 0.222
Validation loss decreased (-0.211731 --> -0.222319).  Saving model ...
Epoch: 38 cost time: 1.5786418914794922
Epoch: 38, Steps: 10 | Train Loss: 0.599 Vali Loss: 3.442 Vali Acc: 0.214 Test Loss: 3.442 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.628347396850586
Epoch: 39, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.481 Vali Acc: 0.205 Test Loss: 3.481 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6867685317993164
Epoch: 40, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.463 Vali Acc: 0.224 Test Loss: 3.463 Test Acc: 0.224
Validation loss decreased (-0.222319 --> -0.223495).  Saving model ...
Epoch: 41 cost time: 1.3964152336120605
Epoch: 41, Steps: 10 | Train Loss: 0.409 Vali Loss: 3.473 Vali Acc: 0.233 Test Loss: 3.473 Test Acc: 0.233
Validation loss decreased (-0.223495 --> -0.232906).  Saving model ...
Epoch: 42 cost time: 1.6915745735168457
Epoch: 42, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.521 Vali Acc: 0.213 Test Loss: 3.521 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5807185173034668
Epoch: 43, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.645 Vali Acc: 0.221 Test Loss: 3.645 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.4888405799865723
Epoch: 44, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.547 Vali Acc: 0.222 Test Loss: 3.547 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.0566306114196777
Epoch: 45, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.606 Vali Acc: 0.226 Test Loss: 3.606 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.5604918003082275
Epoch: 46, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.598 Vali Acc: 0.225 Test Loss: 3.598 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.6832542419433594
Epoch: 47, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.608 Vali Acc: 0.232 Test Loss: 3.608 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.646296501159668
Epoch: 48, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.634 Vali Acc: 0.240 Test Loss: 3.634 Test Acc: 0.240
Validation loss decreased (-0.232906 --> -0.239964).  Saving model ...
Epoch: 49 cost time: 1.4841094017028809
Epoch: 49, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.611 Vali Acc: 0.236 Test Loss: 3.611 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.9697086811065674
Epoch: 50, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.667 Vali Acc: 0.238 Test Loss: 3.667 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.8516135215759277
Epoch: 51, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.682 Vali Acc: 0.239 Test Loss: 3.682 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.5183689594268799
Epoch: 52, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.747 Vali Acc: 0.232 Test Loss: 3.747 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.7364635467529297
Epoch: 53, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.815 Vali Acc: 0.225 Test Loss: 3.815 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.9185047149658203
Epoch: 54, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.741 Vali Acc: 0.228 Test Loss: 3.741 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.4945321083068848
Epoch: 55, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.765 Vali Acc: 0.241 Test Loss: 3.765 Test Acc: 0.241
Validation loss decreased (-0.239964 --> -0.241139).  Saving model ...
Epoch: 56 cost time: 1.6152927875518799
Epoch: 56, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.737 Vali Acc: 0.239 Test Loss: 3.737 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.5505430698394775
Epoch: 57, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.788 Vali Acc: 0.249 Test Loss: 3.788 Test Acc: 0.249
Validation loss decreased (-0.241139 --> -0.249374).  Saving model ...
Epoch: 58 cost time: 1.461254358291626
Epoch: 58, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.819 Vali Acc: 0.241 Test Loss: 3.819 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.4283459186553955
Epoch: 59, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.836 Vali Acc: 0.241 Test Loss: 3.836 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.487849473953247
Epoch: 60, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.794 Vali Acc: 0.240 Test Loss: 3.794 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.3986613750457764
Epoch: 61, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.860 Vali Acc: 0.241 Test Loss: 3.860 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.5093402862548828
Epoch: 62, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.835 Vali Acc: 0.240 Test Loss: 3.835 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 2.111929416656494
Epoch: 63, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.868 Vali Acc: 0.242 Test Loss: 3.868 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.5664012432098389
Epoch: 64, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.896 Vali Acc: 0.248 Test Loss: 3.896 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.7386753559112549
Epoch: 65, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.878 Vali Acc: 0.236 Test Loss: 3.878 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.6325385570526123
Epoch: 66, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.885 Vali Acc: 0.247 Test Loss: 3.885 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.6108181476593018
Epoch: 67, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.894 Vali Acc: 0.248 Test Loss: 3.894 Test Acc: 0.248
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 275902
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.048381567001343
Epoch: 1, Steps: 10 | Train Loss: 3.448 Vali Loss: 3.405 Vali Acc: 0.027 Test Loss: 3.405 Test Acc: 0.027
Validation loss decreased (inf --> -0.027025).  Saving model ...
Epoch: 2 cost time: 2.0919878482818604
Epoch: 2, Steps: 10 | Train Loss: 3.378 Vali Loss: 3.348 Vali Acc: 0.039 Test Loss: 3.348 Test Acc: 0.039
Validation loss decreased (-0.027025 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 1.6404423713684082
Epoch: 3, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.332 Vali Acc: 0.044 Test Loss: 3.332 Test Acc: 0.044
Validation loss decreased (-0.038790 --> -0.043496).  Saving model ...
Epoch: 4 cost time: 1.9576573371887207
Epoch: 4, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.340 Vali Acc: 0.044 Test Loss: 3.340 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5925662517547607
Epoch: 5, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.358 Vali Acc: 0.051 Test Loss: 3.358 Test Acc: 0.051
Validation loss decreased (-0.043496 --> -0.050555).  Saving model ...
Epoch: 6 cost time: 1.6199228763580322
Epoch: 6, Steps: 10 | Train Loss: 3.096 Vali Loss: 3.347 Vali Acc: 0.061 Test Loss: 3.347 Test Acc: 0.061
Validation loss decreased (-0.050555 --> -0.061143).  Saving model ...
Epoch: 7 cost time: 1.581268072128296
Epoch: 7, Steps: 10 | Train Loss: 3.115 Vali Loss: 3.342 Vali Acc: 0.051 Test Loss: 3.342 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4600255489349365
Epoch: 8, Steps: 10 | Train Loss: 3.051 Vali Loss: 3.325 Vali Acc: 0.065 Test Loss: 3.325 Test Acc: 0.065
Validation loss decreased (-0.061143 --> -0.064673).  Saving model ...
Epoch: 9 cost time: 1.7789864540100098
Epoch: 9, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.317 Vali Acc: 0.056 Test Loss: 3.317 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.268693685531616
Epoch: 10, Steps: 10 | Train Loss: 2.952 Vali Loss: 3.317 Vali Acc: 0.059 Test Loss: 3.317 Test Acc: 0.059
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.040088415145874
Epoch: 11, Steps: 10 | Train Loss: 2.921 Vali Loss: 3.297 Vali Acc: 0.076 Test Loss: 3.297 Test Acc: 0.076
Validation loss decreased (-0.064673 --> -0.076438).  Saving model ...
Epoch: 12 cost time: 1.8237228393554688
Epoch: 12, Steps: 10 | Train Loss: 2.830 Vali Loss: 3.288 Vali Acc: 0.099 Test Loss: 3.288 Test Acc: 0.099
Validation loss decreased (-0.076438 --> -0.098791).  Saving model ...
Epoch: 13 cost time: 2.0153863430023193
Epoch: 13, Steps: 10 | Train Loss: 2.813 Vali Loss: 3.276 Vali Acc: 0.076 Test Loss: 3.276 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9589602947235107
Epoch: 14, Steps: 10 | Train Loss: 2.661 Vali Loss: 3.278 Vali Acc: 0.105 Test Loss: 3.278 Test Acc: 0.105
Validation loss decreased (-0.098791 --> -0.104673).  Saving model ...
Epoch: 15 cost time: 1.7012794017791748
Epoch: 15, Steps: 10 | Train Loss: 2.589 Vali Loss: 3.295 Vali Acc: 0.108 Test Loss: 3.295 Test Acc: 0.108
Validation loss decreased (-0.104673 --> -0.108202).  Saving model ...
Epoch: 16 cost time: 1.8539910316467285
Epoch: 16, Steps: 10 | Train Loss: 2.575 Vali Loss: 3.263 Vali Acc: 0.105 Test Loss: 3.263 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9070026874542236
Epoch: 17, Steps: 10 | Train Loss: 2.404 Vali Loss: 3.268 Vali Acc: 0.129 Test Loss: 3.268 Test Acc: 0.129
Validation loss decreased (-0.108202 --> -0.129379).  Saving model ...
Epoch: 18 cost time: 1.631253719329834
Epoch: 18, Steps: 10 | Train Loss: 2.342 Vali Loss: 3.268 Vali Acc: 0.129 Test Loss: 3.268 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0983119010925293
Epoch: 19, Steps: 10 | Train Loss: 2.262 Vali Loss: 3.266 Vali Acc: 0.131 Test Loss: 3.266 Test Acc: 0.131
Validation loss decreased (-0.129379 --> -0.130556).  Saving model ...
Epoch: 20 cost time: 1.6000235080718994
Epoch: 20, Steps: 10 | Train Loss: 2.156 Vali Loss: 3.254 Vali Acc: 0.131 Test Loss: 3.254 Test Acc: 0.131
Validation loss decreased (-0.130556 --> -0.130556).  Saving model ...
Epoch: 21 cost time: 1.453643560409546
Epoch: 21, Steps: 10 | Train Loss: 2.052 Vali Loss: 3.272 Vali Acc: 0.144 Test Loss: 3.272 Test Acc: 0.144
Validation loss decreased (-0.130556 --> -0.143497).  Saving model ...
Epoch: 22 cost time: 2.0092451572418213
Epoch: 22, Steps: 10 | Train Loss: 1.962 Vali Loss: 3.280 Vali Acc: 0.138 Test Loss: 3.280 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6386222839355469
Epoch: 23, Steps: 10 | Train Loss: 1.903 Vali Loss: 3.249 Vali Acc: 0.152 Test Loss: 3.249 Test Acc: 0.152
Validation loss decreased (-0.143497 --> -0.151732).  Saving model ...
Epoch: 24 cost time: 1.6866631507873535
Epoch: 24, Steps: 10 | Train Loss: 1.772 Vali Loss: 3.273 Vali Acc: 0.154 Test Loss: 3.273 Test Acc: 0.154
Validation loss decreased (-0.151732 --> -0.154085).  Saving model ...
Epoch: 25 cost time: 1.9719090461730957
Epoch: 25, Steps: 10 | Train Loss: 1.691 Vali Loss: 3.296 Vali Acc: 0.164 Test Loss: 3.296 Test Acc: 0.164
Validation loss decreased (-0.154085 --> -0.163496).  Saving model ...
Epoch: 26 cost time: 1.7002274990081787
Epoch: 26, Steps: 10 | Train Loss: 1.534 Vali Loss: 3.266 Vali Acc: 0.172 Test Loss: 3.266 Test Acc: 0.172
Validation loss decreased (-0.163496 --> -0.171732).  Saving model ...
Epoch: 27 cost time: 1.8007056713104248
Epoch: 27, Steps: 10 | Train Loss: 1.452 Vali Loss: 3.283 Vali Acc: 0.179 Test Loss: 3.283 Test Acc: 0.179
Validation loss decreased (-0.171732 --> -0.178791).  Saving model ...
Epoch: 28 cost time: 1.5479271411895752
Epoch: 28, Steps: 10 | Train Loss: 1.375 Vali Loss: 3.283 Vali Acc: 0.166 Test Loss: 3.283 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8981342315673828
Epoch: 29, Steps: 10 | Train Loss: 1.306 Vali Loss: 3.309 Vali Acc: 0.179 Test Loss: 3.309 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.0697267055511475
Epoch: 30, Steps: 10 | Train Loss: 1.272 Vali Loss: 3.300 Vali Acc: 0.191 Test Loss: 3.300 Test Acc: 0.191
Validation loss decreased (-0.178791 --> -0.190555).  Saving model ...
Epoch: 31 cost time: 1.5049574375152588
Epoch: 31, Steps: 10 | Train Loss: 1.100 Vali Loss: 3.308 Vali Acc: 0.180 Test Loss: 3.308 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.69344162940979
Epoch: 32, Steps: 10 | Train Loss: 1.037 Vali Loss: 3.326 Vali Acc: 0.199 Test Loss: 3.326 Test Acc: 0.199
Validation loss decreased (-0.190555 --> -0.198790).  Saving model ...
Epoch: 33 cost time: 1.7938661575317383
Epoch: 33, Steps: 10 | Train Loss: 0.972 Vali Loss: 3.320 Vali Acc: 0.202 Test Loss: 3.320 Test Acc: 0.202
Validation loss decreased (-0.198790 --> -0.202320).  Saving model ...
Epoch: 34 cost time: 1.4099705219268799
Epoch: 34, Steps: 10 | Train Loss: 0.911 Vali Loss: 3.377 Vali Acc: 0.188 Test Loss: 3.377 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.632472276687622
Epoch: 35, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.379 Vali Acc: 0.201 Test Loss: 3.379 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.2408854961395264
Epoch: 36, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.336 Vali Acc: 0.215 Test Loss: 3.336 Test Acc: 0.215
Validation loss decreased (-0.202320 --> -0.215261).  Saving model ...
Epoch: 37 cost time: 1.640228271484375
Epoch: 37, Steps: 10 | Train Loss: 0.651 Vali Loss: 3.392 Vali Acc: 0.221 Test Loss: 3.392 Test Acc: 0.221
Validation loss decreased (-0.215261 --> -0.221143).  Saving model ...
Epoch: 38 cost time: 1.6364903450012207
Epoch: 38, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.398 Vali Acc: 0.228 Test Loss: 3.398 Test Acc: 0.228
Validation loss decreased (-0.221143 --> -0.228201).  Saving model ...
Epoch: 39 cost time: 1.9197320938110352
Epoch: 39, Steps: 10 | Train Loss: 0.537 Vali Loss: 3.480 Vali Acc: 0.219 Test Loss: 3.480 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5732083320617676
Epoch: 40, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.437 Vali Acc: 0.231 Test Loss: 3.437 Test Acc: 0.231
Validation loss decreased (-0.228201 --> -0.230554).  Saving model ...
Epoch: 41 cost time: 1.7424895763397217
Epoch: 41, Steps: 10 | Train Loss: 0.381 Vali Loss: 3.463 Vali Acc: 0.225 Test Loss: 3.463 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.0687947273254395
Epoch: 42, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.505 Vali Acc: 0.234 Test Loss: 3.505 Test Acc: 0.234
Validation loss decreased (-0.230554 --> -0.234083).  Saving model ...
Epoch: 43 cost time: 1.6999871730804443
Epoch: 43, Steps: 10 | Train Loss: 0.322 Vali Loss: 3.520 Vali Acc: 0.236 Test Loss: 3.520 Test Acc: 0.236
Validation loss decreased (-0.234083 --> -0.236435).  Saving model ...
Epoch: 44 cost time: 2.131835699081421
Epoch: 44, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.498 Vali Acc: 0.233 Test Loss: 3.498 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.740431547164917
Epoch: 45, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.588 Vali Acc: 0.222 Test Loss: 3.588 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.7492523193359375
Epoch: 46, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.635 Vali Acc: 0.236 Test Loss: 3.635 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.6159636974334717
Epoch: 47, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.697 Vali Acc: 0.232 Test Loss: 3.697 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6974127292633057
Epoch: 48, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.618 Vali Acc: 0.244 Test Loss: 3.618 Test Acc: 0.244
Validation loss decreased (-0.236435 --> -0.243493).  Saving model ...
Epoch: 49 cost time: 1.4197001457214355
Epoch: 49, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.677 Vali Acc: 0.248 Test Loss: 3.677 Test Acc: 0.248
Validation loss decreased (-0.243493 --> -0.248199).  Saving model ...
Epoch: 50 cost time: 1.6996307373046875
Epoch: 50, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.782 Vali Acc: 0.247 Test Loss: 3.782 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.8075759410858154
Epoch: 51, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.698 Vali Acc: 0.239 Test Loss: 3.698 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.5748791694641113
Epoch: 52, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.771 Vali Acc: 0.255 Test Loss: 3.771 Test Acc: 0.255
Validation loss decreased (-0.248199 --> -0.255256).  Saving model ...
Epoch: 53 cost time: 2.109133720397949
Epoch: 53, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.769 Vali Acc: 0.251 Test Loss: 3.769 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.848076343536377
Epoch: 54, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.774 Vali Acc: 0.249 Test Loss: 3.774 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.6324877738952637
Epoch: 55, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.805 Vali Acc: 0.253 Test Loss: 3.805 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.783449411392212
Epoch: 56, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.800 Vali Acc: 0.252 Test Loss: 3.800 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.66322922706604
Epoch: 57, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.854 Vali Acc: 0.248 Test Loss: 3.854 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.8681144714355469
Epoch: 58, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.892 Vali Acc: 0.264 Test Loss: 3.892 Test Acc: 0.264
Validation loss decreased (-0.255256 --> -0.263490).  Saving model ...
Epoch: 59 cost time: 1.822519302368164
Epoch: 59, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.897 Vali Acc: 0.255 Test Loss: 3.897 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.826624870300293
Epoch: 60, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.873 Vali Acc: 0.254 Test Loss: 3.873 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.582183599472046
Epoch: 61, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.906 Vali Acc: 0.262 Test Loss: 3.906 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 2.1708269119262695
Epoch: 62, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.995 Vali Acc: 0.242 Test Loss: 3.995 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 2.188385486602783
Epoch: 63, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.911 Vali Acc: 0.256 Test Loss: 3.911 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.657548189163208
Epoch: 64, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.004 Vali Acc: 0.252 Test Loss: 4.004 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.869727373123169
Epoch: 65, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.951 Vali Acc: 0.267 Test Loss: 3.951 Test Acc: 0.267
Validation loss decreased (-0.263490 --> -0.267019).  Saving model ...
Epoch: 66 cost time: 1.993537187576294
Epoch: 66, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.021 Vali Acc: 0.253 Test Loss: 4.021 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.638967752456665
Epoch: 67, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.970 Vali Acc: 0.253 Test Loss: 3.970 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.3891079425811768
Epoch: 68, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.009 Vali Acc: 0.255 Test Loss: 4.009 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.5314147472381592
Epoch: 69, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.040 Vali Acc: 0.261 Test Loss: 4.040 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.6961090564727783
Epoch: 70, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.088 Vali Acc: 0.259 Test Loss: 4.088 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.5418221950531006
Epoch: 71, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.052 Vali Acc: 0.265 Test Loss: 4.052 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.9885756969451904
Epoch: 72, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.046 Vali Acc: 0.262 Test Loss: 4.046 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.89101243019104
Epoch: 73, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.054 Vali Acc: 0.268 Test Loss: 4.054 Test Acc: 0.268
Validation loss decreased (-0.267019 --> -0.268195).  Saving model ...
Epoch: 74 cost time: 1.745595932006836
Epoch: 74, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.080 Vali Acc: 0.256 Test Loss: 4.080 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.4984471797943115
Epoch: 75, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.144 Vali Acc: 0.254 Test Loss: 4.144 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 2.054048776626587
Epoch: 76, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.128 Vali Acc: 0.261 Test Loss: 4.128 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.7498693466186523
Epoch: 77, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.162 Vali Acc: 0.259 Test Loss: 4.162 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.6593329906463623
Epoch: 78, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.110 Vali Acc: 0.262 Test Loss: 4.110 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.9902267456054688
Epoch: 79, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.160 Vali Acc: 0.265 Test Loss: 4.160 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.5813632011413574
Epoch: 80, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.172 Vali Acc: 0.266 Test Loss: 4.172 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.5375235080718994
Epoch: 81, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.160 Vali Acc: 0.256 Test Loss: 4.160 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.1460373401641846
Epoch: 82, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.198 Vali Acc: 0.264 Test Loss: 4.198 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 2.1036739349365234
Epoch: 83, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.192 Vali Acc: 0.260 Test Loss: 4.192 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 275262
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.890244483947754
Epoch: 1, Steps: 10 | Train Loss: 3.478 Vali Loss: 3.365 Vali Acc: 0.053 Test Loss: 3.365 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 1.3939993381500244
Epoch: 2, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.316 Vali Acc: 0.045 Test Loss: 3.316 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3322410583496094
Epoch: 3, Steps: 10 | Train Loss: 3.260 Vali Loss: 3.320 Vali Acc: 0.045 Test Loss: 3.320 Test Acc: 0.045
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.63517165184021
Epoch: 4, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.336 Vali Acc: 0.049 Test Loss: 3.336 Test Acc: 0.049
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3385961055755615
Epoch: 5, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.345 Vali Acc: 0.051 Test Loss: 3.345 Test Acc: 0.051
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.067826271057129
Epoch: 6, Steps: 10 | Train Loss: 3.152 Vali Loss: 3.319 Vali Acc: 0.054 Test Loss: 3.319 Test Acc: 0.054
Validation loss decreased (-0.052908 --> -0.054084).  Saving model ...
Epoch: 7 cost time: 1.74338698387146
Epoch: 7, Steps: 10 | Train Loss: 3.066 Vali Loss: 3.319 Vali Acc: 0.053 Test Loss: 3.319 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5102434158325195
Epoch: 8, Steps: 10 | Train Loss: 3.055 Vali Loss: 3.316 Vali Acc: 0.053 Test Loss: 3.316 Test Acc: 0.053
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0225179195404053
Epoch: 9, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.321 Vali Acc: 0.066 Test Loss: 3.321 Test Acc: 0.066
Validation loss decreased (-0.054084 --> -0.065849).  Saving model ...
Epoch: 10 cost time: 1.6892900466918945
Epoch: 10, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.302 Vali Acc: 0.069 Test Loss: 3.302 Test Acc: 0.069
Validation loss decreased (-0.065849 --> -0.069379).  Saving model ...
Epoch: 11 cost time: 1.762660264968872
Epoch: 11, Steps: 10 | Train Loss: 2.952 Vali Loss: 3.299 Vali Acc: 0.066 Test Loss: 3.299 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6458005905151367
Epoch: 12, Steps: 10 | Train Loss: 2.788 Vali Loss: 3.282 Vali Acc: 0.089 Test Loss: 3.282 Test Acc: 0.089
Validation loss decreased (-0.069379 --> -0.089379).  Saving model ...
Epoch: 13 cost time: 2.2832555770874023
Epoch: 13, Steps: 10 | Train Loss: 2.776 Vali Loss: 3.270 Vali Acc: 0.072 Test Loss: 3.270 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.591616153717041
Epoch: 14, Steps: 10 | Train Loss: 2.667 Vali Loss: 3.283 Vali Acc: 0.085 Test Loss: 3.283 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.615494966506958
Epoch: 15, Steps: 10 | Train Loss: 2.478 Vali Loss: 3.269 Vali Acc: 0.095 Test Loss: 3.269 Test Acc: 0.095
Validation loss decreased (-0.089379 --> -0.095261).  Saving model ...
Epoch: 16 cost time: 1.7892260551452637
Epoch: 16, Steps: 10 | Train Loss: 2.520 Vali Loss: 3.283 Vali Acc: 0.084 Test Loss: 3.283 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1883749961853027
Epoch: 17, Steps: 10 | Train Loss: 2.411 Vali Loss: 3.275 Vali Acc: 0.099 Test Loss: 3.275 Test Acc: 0.099
Validation loss decreased (-0.095261 --> -0.098791).  Saving model ...
Epoch: 18 cost time: 1.72005033493042
Epoch: 18, Steps: 10 | Train Loss: 2.288 Vali Loss: 3.250 Vali Acc: 0.121 Test Loss: 3.250 Test Acc: 0.121
Validation loss decreased (-0.098791 --> -0.121144).  Saving model ...
Epoch: 19 cost time: 1.8992335796356201
Epoch: 19, Steps: 10 | Train Loss: 2.175 Vali Loss: 3.257 Vali Acc: 0.127 Test Loss: 3.257 Test Acc: 0.127
Validation loss decreased (-0.121144 --> -0.127026).  Saving model ...
Epoch: 20 cost time: 1.509467601776123
Epoch: 20, Steps: 10 | Train Loss: 2.115 Vali Loss: 3.292 Vali Acc: 0.114 Test Loss: 3.292 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6607379913330078
Epoch: 21, Steps: 10 | Train Loss: 2.019 Vali Loss: 3.263 Vali Acc: 0.124 Test Loss: 3.263 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7413809299468994
Epoch: 22, Steps: 10 | Train Loss: 1.937 Vali Loss: 3.270 Vali Acc: 0.128 Test Loss: 3.270 Test Acc: 0.128
Validation loss decreased (-0.127026 --> -0.128203).  Saving model ...
Epoch: 23 cost time: 1.769763469696045
Epoch: 23, Steps: 10 | Train Loss: 1.848 Vali Loss: 3.276 Vali Acc: 0.136 Test Loss: 3.276 Test Acc: 0.136
Validation loss decreased (-0.128203 --> -0.136438).  Saving model ...
Epoch: 24 cost time: 1.9061150550842285
Epoch: 24, Steps: 10 | Train Loss: 1.760 Vali Loss: 3.302 Vali Acc: 0.148 Test Loss: 3.302 Test Acc: 0.148
Validation loss decreased (-0.136438 --> -0.148202).  Saving model ...
Epoch: 25 cost time: 2.2876081466674805
Epoch: 25, Steps: 10 | Train Loss: 1.676 Vali Loss: 3.286 Vali Acc: 0.141 Test Loss: 3.286 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7446980476379395
Epoch: 26, Steps: 10 | Train Loss: 1.564 Vali Loss: 3.286 Vali Acc: 0.146 Test Loss: 3.286 Test Acc: 0.146
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8212831020355225
Epoch: 27, Steps: 10 | Train Loss: 1.482 Vali Loss: 3.291 Vali Acc: 0.166 Test Loss: 3.291 Test Acc: 0.166
Validation loss decreased (-0.148202 --> -0.165849).  Saving model ...
Epoch: 28 cost time: 1.259385347366333
Epoch: 28, Steps: 10 | Train Loss: 1.415 Vali Loss: 3.352 Vali Acc: 0.155 Test Loss: 3.352 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2045116424560547
Epoch: 29, Steps: 10 | Train Loss: 1.336 Vali Loss: 3.322 Vali Acc: 0.164 Test Loss: 3.322 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4833557605743408
Epoch: 30, Steps: 10 | Train Loss: 1.210 Vali Loss: 3.282 Vali Acc: 0.185 Test Loss: 3.282 Test Acc: 0.185
Validation loss decreased (-0.165849 --> -0.184673).  Saving model ...
Epoch: 31 cost time: 2.4870221614837646
Epoch: 31, Steps: 10 | Train Loss: 1.193 Vali Loss: 3.345 Vali Acc: 0.184 Test Loss: 3.345 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7337794303894043
Epoch: 32, Steps: 10 | Train Loss: 1.048 Vali Loss: 3.350 Vali Acc: 0.188 Test Loss: 3.350 Test Acc: 0.188
Validation loss decreased (-0.184673 --> -0.188202).  Saving model ...
Epoch: 33 cost time: 1.5679936408996582
Epoch: 33, Steps: 10 | Train Loss: 1.032 Vali Loss: 3.356 Vali Acc: 0.181 Test Loss: 3.356 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.441964864730835
Epoch: 34, Steps: 10 | Train Loss: 0.939 Vali Loss: 3.334 Vali Acc: 0.204 Test Loss: 3.334 Test Acc: 0.204
Validation loss decreased (-0.188202 --> -0.203496).  Saving model ...
Epoch: 35 cost time: 1.4836370944976807
Epoch: 35, Steps: 10 | Train Loss: 0.831 Vali Loss: 3.365 Vali Acc: 0.194 Test Loss: 3.365 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.1895508766174316
Epoch: 36, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.425 Vali Acc: 0.189 Test Loss: 3.425 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7226641178131104
Epoch: 37, Steps: 10 | Train Loss: 0.700 Vali Loss: 3.368 Vali Acc: 0.208 Test Loss: 3.368 Test Acc: 0.208
Validation loss decreased (-0.203496 --> -0.208202).  Saving model ...
Epoch: 38 cost time: 1.785182237625122
Epoch: 38, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.418 Vali Acc: 0.208 Test Loss: 3.418 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6212031841278076
Epoch: 39, Steps: 10 | Train Loss: 0.597 Vali Loss: 3.448 Vali Acc: 0.201 Test Loss: 3.448 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.835566520690918
Epoch: 40, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.484 Vali Acc: 0.202 Test Loss: 3.484 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.0375683307647705
Epoch: 41, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.514 Vali Acc: 0.204 Test Loss: 3.514 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.9338643550872803
Epoch: 42, Steps: 10 | Train Loss: 0.469 Vali Loss: 3.473 Vali Acc: 0.215 Test Loss: 3.473 Test Acc: 0.215
Validation loss decreased (-0.208202 --> -0.215259).  Saving model ...
Epoch: 43 cost time: 1.8321638107299805
Epoch: 43, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.482 Vali Acc: 0.213 Test Loss: 3.482 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.5694200992584229
Epoch: 44, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.576 Vali Acc: 0.213 Test Loss: 3.576 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.748953104019165
Epoch: 45, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.611 Vali Acc: 0.207 Test Loss: 3.611 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.6019773483276367
Epoch: 46, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.617 Vali Acc: 0.212 Test Loss: 3.617 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.7345597743988037
Epoch: 47, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.623 Vali Acc: 0.235 Test Loss: 3.623 Test Acc: 0.235
Validation loss decreased (-0.215259 --> -0.235258).  Saving model ...
Epoch: 48 cost time: 1.5114448070526123
Epoch: 48, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.619 Vali Acc: 0.221 Test Loss: 3.619 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.7752552032470703
Epoch: 49, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.700 Vali Acc: 0.209 Test Loss: 3.700 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.6041314601898193
Epoch: 50, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.648 Vali Acc: 0.229 Test Loss: 3.648 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.148116111755371
Epoch: 51, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.688 Vali Acc: 0.228 Test Loss: 3.688 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.6172823905944824
Epoch: 52, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.758 Vali Acc: 0.219 Test Loss: 3.758 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.7696847915649414
Epoch: 53, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.703 Vali Acc: 0.225 Test Loss: 3.703 Test Acc: 0.225
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.4266183376312256
Epoch: 54, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.758 Vali Acc: 0.224 Test Loss: 3.758 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.8285343647003174
Epoch: 55, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.756 Vali Acc: 0.228 Test Loss: 3.756 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.5462603569030762
Epoch: 56, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.777 Vali Acc: 0.224 Test Loss: 3.777 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.6588563919067383
Epoch: 57, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.802 Vali Acc: 0.225 Test Loss: 3.802 Test Acc: 0.225
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23529411764705882
model parameter : 274622
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.313293933868408
Epoch: 1, Steps: 10 | Train Loss: 3.405 Vali Loss: 3.358 Vali Acc: 0.034 Test Loss: 3.358 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 1.3438079357147217
Epoch: 2, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.298 Vali Acc: 0.040 Test Loss: 3.298 Test Acc: 0.040
Validation loss decreased (-0.034084 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 1.271209478378296
Epoch: 3, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.290 Vali Acc: 0.054 Test Loss: 3.290 Test Acc: 0.054
Validation loss decreased (-0.039967 --> -0.054085).  Saving model ...
Epoch: 4 cost time: 1.3920247554779053
Epoch: 4, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.314 Vali Acc: 0.055 Test Loss: 3.314 Test Acc: 0.055
Validation loss decreased (-0.054085 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 1.5798447132110596
Epoch: 5, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.322 Vali Acc: 0.055 Test Loss: 3.322 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5475718975067139
Epoch: 6, Steps: 10 | Train Loss: 3.121 Vali Loss: 3.311 Vali Acc: 0.041 Test Loss: 3.311 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5138401985168457
Epoch: 7, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.303 Vali Acc: 0.058 Test Loss: 3.303 Test Acc: 0.058
Validation loss decreased (-0.055261 --> -0.057614).  Saving model ...
Epoch: 8 cost time: 1.3692994117736816
Epoch: 8, Steps: 10 | Train Loss: 3.034 Vali Loss: 3.290 Vali Acc: 0.066 Test Loss: 3.290 Test Acc: 0.066
Validation loss decreased (-0.057614 --> -0.065849).  Saving model ...
Epoch: 9 cost time: 1.4176266193389893
Epoch: 9, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.268 Vali Acc: 0.088 Test Loss: 3.268 Test Acc: 0.088
Validation loss decreased (-0.065849 --> -0.088203).  Saving model ...
Epoch: 10 cost time: 1.8073704242706299
Epoch: 10, Steps: 10 | Train Loss: 2.877 Vali Loss: 3.264 Vali Acc: 0.089 Test Loss: 3.264 Test Acc: 0.089
Validation loss decreased (-0.088203 --> -0.089379).  Saving model ...
Epoch: 11 cost time: 1.4098217487335205
Epoch: 11, Steps: 10 | Train Loss: 2.847 Vali Loss: 3.263 Vali Acc: 0.088 Test Loss: 3.263 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5624687671661377
Epoch: 12, Steps: 10 | Train Loss: 2.719 Vali Loss: 3.246 Vali Acc: 0.092 Test Loss: 3.246 Test Acc: 0.092
Validation loss decreased (-0.089379 --> -0.091732).  Saving model ...
Epoch: 13 cost time: 1.4377162456512451
Epoch: 13, Steps: 10 | Train Loss: 2.702 Vali Loss: 3.228 Vali Acc: 0.101 Test Loss: 3.228 Test Acc: 0.101
Validation loss decreased (-0.091732 --> -0.101144).  Saving model ...
Epoch: 14 cost time: 1.4969727993011475
Epoch: 14, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.219 Vali Acc: 0.098 Test Loss: 3.219 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4802348613739014
Epoch: 15, Steps: 10 | Train Loss: 2.478 Vali Loss: 3.197 Vali Acc: 0.124 Test Loss: 3.197 Test Acc: 0.124
Validation loss decreased (-0.101144 --> -0.123497).  Saving model ...
Epoch: 16 cost time: 1.3622944355010986
Epoch: 16, Steps: 10 | Train Loss: 2.382 Vali Loss: 3.190 Vali Acc: 0.122 Test Loss: 3.190 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7211523056030273
Epoch: 17, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.220 Vali Acc: 0.114 Test Loss: 3.220 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4529283046722412
Epoch: 18, Steps: 10 | Train Loss: 2.170 Vali Loss: 3.201 Vali Acc: 0.128 Test Loss: 3.201 Test Acc: 0.128
Validation loss decreased (-0.123497 --> -0.128203).  Saving model ...
Epoch: 19 cost time: 1.5335073471069336
Epoch: 19, Steps: 10 | Train Loss: 2.052 Vali Loss: 3.188 Vali Acc: 0.138 Test Loss: 3.188 Test Acc: 0.138
Validation loss decreased (-0.128203 --> -0.137615).  Saving model ...
Epoch: 20 cost time: 1.7846651077270508
Epoch: 20, Steps: 10 | Train Loss: 1.957 Vali Loss: 3.178 Vali Acc: 0.154 Test Loss: 3.178 Test Acc: 0.154
Validation loss decreased (-0.137615 --> -0.154086).  Saving model ...
Epoch: 21 cost time: 1.8180594444274902
Epoch: 21, Steps: 10 | Train Loss: 1.901 Vali Loss: 3.191 Vali Acc: 0.152 Test Loss: 3.191 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.474027395248413
Epoch: 22, Steps: 10 | Train Loss: 1.848 Vali Loss: 3.215 Vali Acc: 0.161 Test Loss: 3.215 Test Acc: 0.161
Validation loss decreased (-0.154086 --> -0.161144).  Saving model ...
Epoch: 23 cost time: 1.4804203510284424
Epoch: 23, Steps: 10 | Train Loss: 1.705 Vali Loss: 3.184 Vali Acc: 0.159 Test Loss: 3.184 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7569022178649902
Epoch: 24, Steps: 10 | Train Loss: 1.596 Vali Loss: 3.192 Vali Acc: 0.176 Test Loss: 3.192 Test Acc: 0.176
Validation loss decreased (-0.161144 --> -0.176439).  Saving model ...
Epoch: 25 cost time: 1.5696830749511719
Epoch: 25, Steps: 10 | Train Loss: 1.486 Vali Loss: 3.199 Vali Acc: 0.173 Test Loss: 3.199 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7954788208007812
Epoch: 26, Steps: 10 | Train Loss: 1.386 Vali Loss: 3.200 Vali Acc: 0.180 Test Loss: 3.200 Test Acc: 0.180
Validation loss decreased (-0.176439 --> -0.179968).  Saving model ...
Epoch: 27 cost time: 1.4474821090698242
Epoch: 27, Steps: 10 | Train Loss: 1.357 Vali Loss: 3.224 Vali Acc: 0.185 Test Loss: 3.224 Test Acc: 0.185
Validation loss decreased (-0.179968 --> -0.184674).  Saving model ...
Epoch: 28 cost time: 1.5695838928222656
Epoch: 28, Steps: 10 | Train Loss: 1.255 Vali Loss: 3.211 Vali Acc: 0.201 Test Loss: 3.211 Test Acc: 0.201
Validation loss decreased (-0.184674 --> -0.201144).  Saving model ...
Epoch: 29 cost time: 2.1933584213256836
Epoch: 29, Steps: 10 | Train Loss: 1.204 Vali Loss: 3.207 Vali Acc: 0.204 Test Loss: 3.207 Test Acc: 0.204
Validation loss decreased (-0.201144 --> -0.203497).  Saving model ...
Epoch: 30 cost time: 1.515883445739746
Epoch: 30, Steps: 10 | Train Loss: 1.125 Vali Loss: 3.239 Vali Acc: 0.207 Test Loss: 3.239 Test Acc: 0.207
Validation loss decreased (-0.203497 --> -0.207026).  Saving model ...
Epoch: 31 cost time: 1.6424012184143066
Epoch: 31, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.239 Vali Acc: 0.218 Test Loss: 3.239 Test Acc: 0.218
Validation loss decreased (-0.207026 --> -0.217615).  Saving model ...
Epoch: 32 cost time: 1.5874552726745605
Epoch: 32, Steps: 10 | Train Loss: 0.938 Vali Loss: 3.255 Vali Acc: 0.205 Test Loss: 3.255 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6764581203460693
Epoch: 33, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.247 Vali Acc: 0.226 Test Loss: 3.247 Test Acc: 0.226
Validation loss decreased (-0.217615 --> -0.225850).  Saving model ...
Epoch: 34 cost time: 1.4927966594696045
Epoch: 34, Steps: 10 | Train Loss: 0.757 Vali Loss: 3.292 Vali Acc: 0.215 Test Loss: 3.292 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5694491863250732
Epoch: 35, Steps: 10 | Train Loss: 0.729 Vali Loss: 3.263 Vali Acc: 0.229 Test Loss: 3.263 Test Acc: 0.229
Validation loss decreased (-0.225850 --> -0.229379).  Saving model ...
Epoch: 36 cost time: 1.5147991180419922
Epoch: 36, Steps: 10 | Train Loss: 0.622 Vali Loss: 3.309 Vali Acc: 0.225 Test Loss: 3.309 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.783493995666504
Epoch: 37, Steps: 10 | Train Loss: 0.575 Vali Loss: 3.312 Vali Acc: 0.234 Test Loss: 3.312 Test Acc: 0.234
Validation loss decreased (-0.229379 --> -0.234085).  Saving model ...
Epoch: 38 cost time: 1.7647356986999512
Epoch: 38, Steps: 10 | Train Loss: 0.513 Vali Loss: 3.331 Vali Acc: 0.245 Test Loss: 3.331 Test Acc: 0.245
Validation loss decreased (-0.234085 --> -0.244673).  Saving model ...
Epoch: 39 cost time: 1.478154182434082
Epoch: 39, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.307 Vali Acc: 0.240 Test Loss: 3.307 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9019887447357178
Epoch: 40, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.409 Vali Acc: 0.249 Test Loss: 3.409 Test Acc: 0.249
Validation loss decreased (-0.244673 --> -0.249378).  Saving model ...
Epoch: 41 cost time: 1.6795544624328613
Epoch: 41, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.431 Vali Acc: 0.231 Test Loss: 3.431 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.571129322052002
Epoch: 42, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.384 Vali Acc: 0.242 Test Loss: 3.384 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.8171782493591309
Epoch: 43, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.409 Vali Acc: 0.246 Test Loss: 3.409 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.005261182785034
Epoch: 44, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.459 Vali Acc: 0.246 Test Loss: 3.459 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.71799898147583
Epoch: 45, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.424 Vali Acc: 0.255 Test Loss: 3.424 Test Acc: 0.255
Validation loss decreased (-0.249378 --> -0.255260).  Saving model ...
Epoch: 46 cost time: 1.5567235946655273
Epoch: 46, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.526 Vali Acc: 0.235 Test Loss: 3.526 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4410808086395264
Epoch: 47, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.488 Vali Acc: 0.247 Test Loss: 3.488 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.0548250675201416
Epoch: 48, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.507 Vali Acc: 0.238 Test Loss: 3.507 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.932736873626709
Epoch: 49, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.585 Vali Acc: 0.252 Test Loss: 3.585 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.6169772148132324
Epoch: 50, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.628 Vali Acc: 0.261 Test Loss: 3.628 Test Acc: 0.261
Validation loss decreased (-0.255260 --> -0.261140).  Saving model ...
Epoch: 51 cost time: 1.583055019378662
Epoch: 51, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.644 Vali Acc: 0.258 Test Loss: 3.644 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.9481189250946045
Epoch: 52, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.611 Vali Acc: 0.246 Test Loss: 3.611 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.5090522766113281
Epoch: 53, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.607 Vali Acc: 0.262 Test Loss: 3.607 Test Acc: 0.262
Validation loss decreased (-0.261140 --> -0.262317).  Saving model ...
Epoch: 54 cost time: 1.5069384574890137
Epoch: 54, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.694 Vali Acc: 0.266 Test Loss: 3.694 Test Acc: 0.266
Validation loss decreased (-0.262317 --> -0.265845).  Saving model ...
Epoch: 55 cost time: 1.9309518337249756
Epoch: 55, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.626 Vali Acc: 0.266 Test Loss: 3.626 Test Acc: 0.266
Validation loss decreased (-0.265845 --> -0.265846).  Saving model ...
Epoch: 56 cost time: 1.6705830097198486
Epoch: 56, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.627 Vali Acc: 0.267 Test Loss: 3.627 Test Acc: 0.267
Validation loss decreased (-0.265846 --> -0.267023).  Saving model ...
Epoch: 57 cost time: 1.6171765327453613
Epoch: 57, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.643 Vali Acc: 0.261 Test Loss: 3.643 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.578171968460083
Epoch: 58, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.723 Vali Acc: 0.266 Test Loss: 3.723 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.4860212802886963
Epoch: 59, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.732 Vali Acc: 0.258 Test Loss: 3.732 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.700174331665039
Epoch: 60, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.686 Vali Acc: 0.255 Test Loss: 3.686 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.6658504009246826
Epoch: 61, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.778 Vali Acc: 0.256 Test Loss: 3.778 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.84578275680542
Epoch: 62, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.842 Vali Acc: 0.244 Test Loss: 3.842 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.8077116012573242
Epoch: 63, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.733 Vali Acc: 0.260 Test Loss: 3.733 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.3275372982025146
Epoch: 64, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.781 Vali Acc: 0.262 Test Loss: 3.781 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.4831318855285645
Epoch: 65, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.815 Vali Acc: 0.262 Test Loss: 3.815 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.5793144702911377
Epoch: 66, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.836 Vali Acc: 0.258 Test Loss: 3.836 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 273982
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.149639368057251
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.344 Vali Acc: 0.049 Test Loss: 3.344 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 1.4227356910705566
Epoch: 2, Steps: 10 | Train Loss: 3.311 Vali Loss: 3.309 Vali Acc: 0.044 Test Loss: 3.309 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5832641124725342
Epoch: 3, Steps: 10 | Train Loss: 3.235 Vali Loss: 3.310 Vali Acc: 0.029 Test Loss: 3.310 Test Acc: 0.029
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.304060935974121
Epoch: 4, Steps: 10 | Train Loss: 3.142 Vali Loss: 3.318 Vali Acc: 0.032 Test Loss: 3.318 Test Acc: 0.032
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8039982318878174
Epoch: 5, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.334 Vali Acc: 0.038 Test Loss: 3.334 Test Acc: 0.038
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.551762580871582
Epoch: 6, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.335 Vali Acc: 0.041 Test Loss: 3.335 Test Acc: 0.041
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.110844612121582
Epoch: 7, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.319 Vali Acc: 0.039 Test Loss: 3.319 Test Acc: 0.039
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6305937767028809
Epoch: 8, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.314 Vali Acc: 0.053 Test Loss: 3.314 Test Acc: 0.053
Validation loss decreased (-0.049378 --> -0.052908).  Saving model ...
Epoch: 9 cost time: 1.53322172164917
Epoch: 9, Steps: 10 | Train Loss: 3.078 Vali Loss: 3.310 Vali Acc: 0.048 Test Loss: 3.310 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4936916828155518
Epoch: 10, Steps: 10 | Train Loss: 2.979 Vali Loss: 3.288 Vali Acc: 0.064 Test Loss: 3.288 Test Acc: 0.064
Validation loss decreased (-0.052908 --> -0.063497).  Saving model ...
Epoch: 11 cost time: 1.3919708728790283
Epoch: 11, Steps: 10 | Train Loss: 2.879 Vali Loss: 3.276 Vali Acc: 0.066 Test Loss: 3.276 Test Acc: 0.066
Validation loss decreased (-0.063497 --> -0.065850).  Saving model ...
Epoch: 12 cost time: 1.523242473602295
Epoch: 12, Steps: 10 | Train Loss: 2.907 Vali Loss: 3.268 Vali Acc: 0.069 Test Loss: 3.268 Test Acc: 0.069
Validation loss decreased (-0.065850 --> -0.069379).  Saving model ...
Epoch: 13 cost time: 1.4290015697479248
Epoch: 13, Steps: 10 | Train Loss: 2.823 Vali Loss: 3.276 Vali Acc: 0.080 Test Loss: 3.276 Test Acc: 0.080
Validation loss decreased (-0.069379 --> -0.079967).  Saving model ...
Epoch: 14 cost time: 1.2518515586853027
Epoch: 14, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.259 Vali Acc: 0.088 Test Loss: 3.259 Test Acc: 0.088
Validation loss decreased (-0.079967 --> -0.088203).  Saving model ...
Epoch: 15 cost time: 1.6325089931488037
Epoch: 15, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.253 Vali Acc: 0.098 Test Loss: 3.253 Test Acc: 0.098
Validation loss decreased (-0.088203 --> -0.097615).  Saving model ...
Epoch: 16 cost time: 1.627953290939331
Epoch: 16, Steps: 10 | Train Loss: 2.570 Vali Loss: 3.243 Vali Acc: 0.109 Test Loss: 3.243 Test Acc: 0.109
Validation loss decreased (-0.097615 --> -0.109379).  Saving model ...
Epoch: 17 cost time: 1.5571999549865723
Epoch: 17, Steps: 10 | Train Loss: 2.517 Vali Loss: 3.229 Vali Acc: 0.114 Test Loss: 3.229 Test Acc: 0.114
Validation loss decreased (-0.109379 --> -0.114085).  Saving model ...
Epoch: 18 cost time: 1.3026025295257568
Epoch: 18, Steps: 10 | Train Loss: 2.386 Vali Loss: 3.235 Vali Acc: 0.116 Test Loss: 3.235 Test Acc: 0.116
Validation loss decreased (-0.114085 --> -0.116438).  Saving model ...
Epoch: 19 cost time: 1.5433006286621094
Epoch: 19, Steps: 10 | Train Loss: 2.270 Vali Loss: 3.229 Vali Acc: 0.119 Test Loss: 3.229 Test Acc: 0.119
Validation loss decreased (-0.116438 --> -0.118791).  Saving model ...
Epoch: 20 cost time: 1.4651002883911133
Epoch: 20, Steps: 10 | Train Loss: 2.179 Vali Loss: 3.235 Vali Acc: 0.133 Test Loss: 3.235 Test Acc: 0.133
Validation loss decreased (-0.118791 --> -0.132909).  Saving model ...
Epoch: 21 cost time: 1.324265956878662
Epoch: 21, Steps: 10 | Train Loss: 2.061 Vali Loss: 3.237 Vali Acc: 0.138 Test Loss: 3.237 Test Acc: 0.138
Validation loss decreased (-0.132909 --> -0.137615).  Saving model ...
Epoch: 22 cost time: 1.491241216659546
Epoch: 22, Steps: 10 | Train Loss: 2.014 Vali Loss: 3.238 Vali Acc: 0.133 Test Loss: 3.238 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7750611305236816
Epoch: 23, Steps: 10 | Train Loss: 1.872 Vali Loss: 3.236 Vali Acc: 0.151 Test Loss: 3.236 Test Acc: 0.151
Validation loss decreased (-0.137615 --> -0.150556).  Saving model ...
Epoch: 24 cost time: 1.8308141231536865
Epoch: 24, Steps: 10 | Train Loss: 1.748 Vali Loss: 3.260 Vali Acc: 0.159 Test Loss: 3.260 Test Acc: 0.159
Validation loss decreased (-0.150556 --> -0.158791).  Saving model ...
Epoch: 25 cost time: 1.3199958801269531
Epoch: 25, Steps: 10 | Train Loss: 1.725 Vali Loss: 3.249 Vali Acc: 0.166 Test Loss: 3.249 Test Acc: 0.166
Validation loss decreased (-0.158791 --> -0.165850).  Saving model ...
Epoch: 26 cost time: 1.347055196762085
Epoch: 26, Steps: 10 | Train Loss: 1.550 Vali Loss: 3.252 Vali Acc: 0.169 Test Loss: 3.252 Test Acc: 0.169
Validation loss decreased (-0.165850 --> -0.169379).  Saving model ...
Epoch: 27 cost time: 1.6054761409759521
Epoch: 27, Steps: 10 | Train Loss: 1.454 Vali Loss: 3.279 Vali Acc: 0.176 Test Loss: 3.279 Test Acc: 0.176
Validation loss decreased (-0.169379 --> -0.176438).  Saving model ...
Epoch: 28 cost time: 1.4575071334838867
Epoch: 28, Steps: 10 | Train Loss: 1.352 Vali Loss: 3.287 Vali Acc: 0.179 Test Loss: 3.287 Test Acc: 0.179
Validation loss decreased (-0.176438 --> -0.178791).  Saving model ...
Epoch: 29 cost time: 1.5527973175048828
Epoch: 29, Steps: 10 | Train Loss: 1.307 Vali Loss: 3.272 Vali Acc: 0.179 Test Loss: 3.272 Test Acc: 0.179
Validation loss decreased (-0.178791 --> -0.178791).  Saving model ...
Epoch: 30 cost time: 1.3097481727600098
Epoch: 30, Steps: 10 | Train Loss: 1.156 Vali Loss: 3.304 Vali Acc: 0.189 Test Loss: 3.304 Test Acc: 0.189
Validation loss decreased (-0.178791 --> -0.189379).  Saving model ...
Epoch: 31 cost time: 1.4774844646453857
Epoch: 31, Steps: 10 | Train Loss: 1.109 Vali Loss: 3.312 Vali Acc: 0.195 Test Loss: 3.312 Test Acc: 0.195
Validation loss decreased (-0.189379 --> -0.195261).  Saving model ...
Epoch: 32 cost time: 1.6035633087158203
Epoch: 32, Steps: 10 | Train Loss: 1.095 Vali Loss: 3.312 Vali Acc: 0.201 Test Loss: 3.312 Test Acc: 0.201
Validation loss decreased (-0.195261 --> -0.201143).  Saving model ...
Epoch: 33 cost time: 1.2524161338806152
Epoch: 33, Steps: 10 | Train Loss: 0.994 Vali Loss: 3.342 Vali Acc: 0.201 Test Loss: 3.342 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4513204097747803
Epoch: 34, Steps: 10 | Train Loss: 0.877 Vali Loss: 3.371 Vali Acc: 0.202 Test Loss: 3.371 Test Acc: 0.202
Validation loss decreased (-0.201143 --> -0.202319).  Saving model ...
Epoch: 35 cost time: 1.5462934970855713
Epoch: 35, Steps: 10 | Train Loss: 0.764 Vali Loss: 3.391 Vali Acc: 0.201 Test Loss: 3.391 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3330445289611816
Epoch: 36, Steps: 10 | Train Loss: 0.785 Vali Loss: 3.389 Vali Acc: 0.212 Test Loss: 3.389 Test Acc: 0.212
Validation loss decreased (-0.202319 --> -0.211731).  Saving model ...
Epoch: 37 cost time: 1.1745727062225342
Epoch: 37, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.446 Vali Acc: 0.216 Test Loss: 3.446 Test Acc: 0.216
Validation loss decreased (-0.211731 --> -0.216436).  Saving model ...
Epoch: 38 cost time: 1.4884164333343506
Epoch: 38, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.465 Vali Acc: 0.201 Test Loss: 3.465 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.675220012664795
Epoch: 39, Steps: 10 | Train Loss: 0.566 Vali Loss: 3.464 Vali Acc: 0.215 Test Loss: 3.464 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.459085464477539
Epoch: 40, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.517 Vali Acc: 0.216 Test Loss: 3.517 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3145751953125
Epoch: 41, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.504 Vali Acc: 0.212 Test Loss: 3.504 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.3039779663085938
Epoch: 42, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.608 Vali Acc: 0.211 Test Loss: 3.608 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.6191480159759521
Epoch: 43, Steps: 10 | Train Loss: 0.367 Vali Loss: 3.550 Vali Acc: 0.232 Test Loss: 3.550 Test Acc: 0.232
Validation loss decreased (-0.216436 --> -0.231729).  Saving model ...
Epoch: 44 cost time: 1.7845795154571533
Epoch: 44, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.628 Vali Acc: 0.214 Test Loss: 3.628 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7205126285552979
Epoch: 45, Steps: 10 | Train Loss: 0.328 Vali Loss: 3.626 Vali Acc: 0.220 Test Loss: 3.626 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.7430479526519775
Epoch: 46, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.710 Vali Acc: 0.218 Test Loss: 3.710 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2203278541564941
Epoch: 47, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.757 Vali Acc: 0.216 Test Loss: 3.757 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.727614164352417
Epoch: 48, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.721 Vali Acc: 0.224 Test Loss: 3.721 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3537070751190186
Epoch: 49, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.765 Vali Acc: 0.220 Test Loss: 3.765 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.6624319553375244
Epoch: 50, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.959 Vali Acc: 0.212 Test Loss: 3.959 Test Acc: 0.212
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.576256513595581
Epoch: 51, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.785 Vali Acc: 0.220 Test Loss: 3.785 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.5882313251495361
Epoch: 52, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.902 Vali Acc: 0.213 Test Loss: 3.902 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.6453588008880615
Epoch: 53, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.906 Vali Acc: 0.220 Test Loss: 3.906 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23176470588235293
model parameter : 192702
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.511417865753174
Epoch: 1, Steps: 10 | Train Loss: 3.510 Vali Loss: 3.416 Vali Acc: 0.032 Test Loss: 3.416 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 1.8242757320404053
Epoch: 2, Steps: 10 | Train Loss: 3.420 Vali Loss: 3.345 Vali Acc: 0.026 Test Loss: 3.345 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3069186210632324
Epoch: 3, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.314 Vali Acc: 0.038 Test Loss: 3.314 Test Acc: 0.038
Validation loss decreased (-0.031731 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 1.4307575225830078
Epoch: 4, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.318 Vali Acc: 0.052 Test Loss: 3.318 Test Acc: 0.052
Validation loss decreased (-0.037614 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 1.6420440673828125
Epoch: 5, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.321 Vali Acc: 0.051 Test Loss: 3.321 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4418699741363525
Epoch: 6, Steps: 10 | Train Loss: 3.189 Vali Loss: 3.325 Vali Acc: 0.060 Test Loss: 3.325 Test Acc: 0.060
Validation loss decreased (-0.051732 --> -0.059967).  Saving model ...
Epoch: 7 cost time: 1.2436726093292236
Epoch: 7, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.327 Vali Acc: 0.058 Test Loss: 3.327 Test Acc: 0.058
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.613976240158081
Epoch: 8, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.310 Vali Acc: 0.069 Test Loss: 3.310 Test Acc: 0.069
Validation loss decreased (-0.059967 --> -0.069379).  Saving model ...
Epoch: 9 cost time: 1.4791207313537598
Epoch: 9, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.289 Vali Acc: 0.061 Test Loss: 3.289 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3368666172027588
Epoch: 10, Steps: 10 | Train Loss: 2.961 Vali Loss: 3.291 Vali Acc: 0.072 Test Loss: 3.291 Test Acc: 0.072
Validation loss decreased (-0.069379 --> -0.071732).  Saving model ...
Epoch: 11 cost time: 1.6022398471832275
Epoch: 11, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.281 Vali Acc: 0.088 Test Loss: 3.281 Test Acc: 0.088
Validation loss decreased (-0.071732 --> -0.088202).  Saving model ...
Epoch: 12 cost time: 1.2249348163604736
Epoch: 12, Steps: 10 | Train Loss: 2.887 Vali Loss: 3.278 Vali Acc: 0.086 Test Loss: 3.278 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6189906597137451
Epoch: 13, Steps: 10 | Train Loss: 2.831 Vali Loss: 3.263 Vali Acc: 0.104 Test Loss: 3.263 Test Acc: 0.104
Validation loss decreased (-0.088202 --> -0.103497).  Saving model ...
Epoch: 14 cost time: 1.3393909931182861
Epoch: 14, Steps: 10 | Train Loss: 2.750 Vali Loss: 3.276 Vali Acc: 0.107 Test Loss: 3.276 Test Acc: 0.107
Validation loss decreased (-0.103497 --> -0.107026).  Saving model ...
Epoch: 15 cost time: 1.1241836547851562
Epoch: 15, Steps: 10 | Train Loss: 2.688 Vali Loss: 3.274 Vali Acc: 0.108 Test Loss: 3.274 Test Acc: 0.108
Validation loss decreased (-0.107026 --> -0.108203).  Saving model ...
Epoch: 16 cost time: 1.5169024467468262
Epoch: 16, Steps: 10 | Train Loss: 2.574 Vali Loss: 3.255 Vali Acc: 0.102 Test Loss: 3.255 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4378695487976074
Epoch: 17, Steps: 10 | Train Loss: 2.523 Vali Loss: 3.234 Vali Acc: 0.112 Test Loss: 3.234 Test Acc: 0.112
Validation loss decreased (-0.108203 --> -0.111732).  Saving model ...
Epoch: 18 cost time: 1.7047498226165771
Epoch: 18, Steps: 10 | Train Loss: 2.439 Vali Loss: 3.249 Vali Acc: 0.124 Test Loss: 3.249 Test Acc: 0.124
Validation loss decreased (-0.111732 --> -0.123497).  Saving model ...
Epoch: 19 cost time: 1.3308017253875732
Epoch: 19, Steps: 10 | Train Loss: 2.335 Vali Loss: 3.262 Vali Acc: 0.132 Test Loss: 3.262 Test Acc: 0.132
Validation loss decreased (-0.123497 --> -0.131732).  Saving model ...
Epoch: 20 cost time: 1.5435914993286133
Epoch: 20, Steps: 10 | Train Loss: 2.220 Vali Loss: 3.239 Vali Acc: 0.141 Test Loss: 3.239 Test Acc: 0.141
Validation loss decreased (-0.131732 --> -0.141144).  Saving model ...
Epoch: 21 cost time: 1.8643443584442139
Epoch: 21, Steps: 10 | Train Loss: 2.182 Vali Loss: 3.232 Vali Acc: 0.140 Test Loss: 3.232 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5266809463500977
Epoch: 22, Steps: 10 | Train Loss: 2.097 Vali Loss: 3.257 Vali Acc: 0.152 Test Loss: 3.257 Test Acc: 0.152
Validation loss decreased (-0.141144 --> -0.151732).  Saving model ...
Epoch: 23 cost time: 1.5166196823120117
Epoch: 23, Steps: 10 | Train Loss: 2.012 Vali Loss: 3.260 Vali Acc: 0.161 Test Loss: 3.260 Test Acc: 0.161
Validation loss decreased (-0.151732 --> -0.161144).  Saving model ...
Epoch: 24 cost time: 1.6039223670959473
Epoch: 24, Steps: 10 | Train Loss: 1.912 Vali Loss: 3.268 Vali Acc: 0.149 Test Loss: 3.268 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5404052734375
Epoch: 25, Steps: 10 | Train Loss: 1.817 Vali Loss: 3.277 Vali Acc: 0.162 Test Loss: 3.277 Test Acc: 0.162
Validation loss decreased (-0.161144 --> -0.162320).  Saving model ...
Epoch: 26 cost time: 1.420717477798462
Epoch: 26, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.265 Vali Acc: 0.174 Test Loss: 3.265 Test Acc: 0.174
Validation loss decreased (-0.162320 --> -0.174085).  Saving model ...
Epoch: 27 cost time: 1.3762190341949463
Epoch: 27, Steps: 10 | Train Loss: 1.679 Vali Loss: 3.288 Vali Acc: 0.167 Test Loss: 3.288 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8012518882751465
Epoch: 28, Steps: 10 | Train Loss: 1.471 Vali Loss: 3.285 Vali Acc: 0.179 Test Loss: 3.285 Test Acc: 0.179
Validation loss decreased (-0.174085 --> -0.178791).  Saving model ...
Epoch: 29 cost time: 1.7660205364227295
Epoch: 29, Steps: 10 | Train Loss: 1.479 Vali Loss: 3.313 Vali Acc: 0.176 Test Loss: 3.313 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.501086711883545
Epoch: 30, Steps: 10 | Train Loss: 1.415 Vali Loss: 3.290 Vali Acc: 0.181 Test Loss: 3.290 Test Acc: 0.181
Validation loss decreased (-0.178791 --> -0.181144).  Saving model ...
Epoch: 31 cost time: 1.3957548141479492
Epoch: 31, Steps: 10 | Train Loss: 1.278 Vali Loss: 3.329 Vali Acc: 0.181 Test Loss: 3.329 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3905954360961914
Epoch: 32, Steps: 10 | Train Loss: 1.194 Vali Loss: 3.311 Vali Acc: 0.191 Test Loss: 3.311 Test Acc: 0.191
Validation loss decreased (-0.181144 --> -0.190555).  Saving model ...
Epoch: 33 cost time: 1.8477270603179932
Epoch: 33, Steps: 10 | Train Loss: 1.101 Vali Loss: 3.369 Vali Acc: 0.188 Test Loss: 3.369 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5610523223876953
Epoch: 34, Steps: 10 | Train Loss: 1.004 Vali Loss: 3.339 Vali Acc: 0.199 Test Loss: 3.339 Test Acc: 0.199
Validation loss decreased (-0.190555 --> -0.198790).  Saving model ...
Epoch: 35 cost time: 1.5778257846832275
Epoch: 35, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.386 Vali Acc: 0.202 Test Loss: 3.386 Test Acc: 0.202
Validation loss decreased (-0.198790 --> -0.202319).  Saving model ...
Epoch: 36 cost time: 1.5685503482818604
Epoch: 36, Steps: 10 | Train Loss: 0.906 Vali Loss: 3.370 Vali Acc: 0.201 Test Loss: 3.370 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.939422369003296
Epoch: 37, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.377 Vali Acc: 0.208 Test Loss: 3.377 Test Acc: 0.208
Validation loss decreased (-0.202319 --> -0.208202).  Saving model ...
Epoch: 38 cost time: 1.6308157444000244
Epoch: 38, Steps: 10 | Train Loss: 0.721 Vali Loss: 3.416 Vali Acc: 0.219 Test Loss: 3.416 Test Acc: 0.219
Validation loss decreased (-0.208202 --> -0.218789).  Saving model ...
Epoch: 39 cost time: 1.633375883102417
Epoch: 39, Steps: 10 | Train Loss: 0.697 Vali Loss: 3.411 Vali Acc: 0.221 Test Loss: 3.411 Test Acc: 0.221
Validation loss decreased (-0.218789 --> -0.221142).  Saving model ...
Epoch: 40 cost time: 1.688063383102417
Epoch: 40, Steps: 10 | Train Loss: 0.605 Vali Loss: 3.420 Vali Acc: 0.216 Test Loss: 3.420 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.704052448272705
Epoch: 41, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.475 Vali Acc: 0.229 Test Loss: 3.475 Test Acc: 0.229
Validation loss decreased (-0.221142 --> -0.229377).  Saving model ...
Epoch: 42 cost time: 1.5580220222473145
Epoch: 42, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.535 Vali Acc: 0.213 Test Loss: 3.535 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4753632545471191
Epoch: 43, Steps: 10 | Train Loss: 0.437 Vali Loss: 3.490 Vali Acc: 0.228 Test Loss: 3.490 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5401082038879395
Epoch: 44, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.540 Vali Acc: 0.226 Test Loss: 3.540 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.409616231918335
Epoch: 45, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.623 Vali Acc: 0.218 Test Loss: 3.623 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.5486347675323486
Epoch: 46, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.518 Vali Acc: 0.227 Test Loss: 3.518 Test Acc: 0.227
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.752741813659668
Epoch: 47, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.641 Vali Acc: 0.231 Test Loss: 3.641 Test Acc: 0.231
Validation loss decreased (-0.229377 --> -0.230552).  Saving model ...
Epoch: 48 cost time: 1.377096176147461
Epoch: 48, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.655 Vali Acc: 0.228 Test Loss: 3.655 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.2241873741149902
Epoch: 49, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.627 Vali Acc: 0.236 Test Loss: 3.627 Test Acc: 0.236
Validation loss decreased (-0.230552 --> -0.236434).  Saving model ...
Epoch: 50 cost time: 1.63566255569458
Epoch: 50, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.691 Vali Acc: 0.240 Test Loss: 3.691 Test Acc: 0.240
Validation loss decreased (-0.236434 --> -0.239963).  Saving model ...
Epoch: 51 cost time: 1.2084565162658691
Epoch: 51, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.704 Vali Acc: 0.240 Test Loss: 3.704 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.5170509815216064
Epoch: 52, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.737 Vali Acc: 0.242 Test Loss: 3.737 Test Acc: 0.242
Validation loss decreased (-0.239963 --> -0.242316).  Saving model ...
Epoch: 53 cost time: 1.5192432403564453
Epoch: 53, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.770 Vali Acc: 0.239 Test Loss: 3.770 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.5482544898986816
Epoch: 54, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.807 Vali Acc: 0.241 Test Loss: 3.807 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.4206435680389404
Epoch: 55, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.785 Vali Acc: 0.242 Test Loss: 3.785 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.781270980834961
Epoch: 56, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.824 Vali Acc: 0.247 Test Loss: 3.824 Test Acc: 0.247
Validation loss decreased (-0.242316 --> -0.247021).  Saving model ...
Epoch: 57 cost time: 1.7984309196472168
Epoch: 57, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.780 Vali Acc: 0.241 Test Loss: 3.780 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.4366106986999512
Epoch: 58, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.866 Vali Acc: 0.254 Test Loss: 3.866 Test Acc: 0.254
Validation loss decreased (-0.247021 --> -0.254079).  Saving model ...
Epoch: 59 cost time: 1.297041416168213
Epoch: 59, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.843 Vali Acc: 0.248 Test Loss: 3.843 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.556518793106079
Epoch: 60, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.865 Vali Acc: 0.254 Test Loss: 3.865 Test Acc: 0.254
Validation loss decreased (-0.254079 --> -0.254079).  Saving model ...
Epoch: 61 cost time: 1.6201457977294922
Epoch: 61, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.878 Vali Acc: 0.256 Test Loss: 3.878 Test Acc: 0.256
Validation loss decreased (-0.254079 --> -0.256432).  Saving model ...
Epoch: 62 cost time: 1.3041338920593262
Epoch: 62, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.866 Vali Acc: 0.249 Test Loss: 3.866 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.7658238410949707
Epoch: 63, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.905 Vali Acc: 0.261 Test Loss: 3.905 Test Acc: 0.261
Validation loss decreased (-0.256432 --> -0.261137).  Saving model ...
Epoch: 64 cost time: 1.7163708209991455
Epoch: 64, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.933 Vali Acc: 0.260 Test Loss: 3.933 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.3556182384490967
Epoch: 65, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.929 Vali Acc: 0.255 Test Loss: 3.929 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.5068576335906982
Epoch: 66, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.979 Vali Acc: 0.259 Test Loss: 3.979 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.9368619918823242
Epoch: 67, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.983 Vali Acc: 0.258 Test Loss: 3.983 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.4330554008483887
Epoch: 68, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.999 Vali Acc: 0.259 Test Loss: 3.999 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.4540131092071533
Epoch: 69, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.046 Vali Acc: 0.254 Test Loss: 4.046 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.4002907276153564
Epoch: 70, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.067 Vali Acc: 0.252 Test Loss: 4.067 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.6323742866516113
Epoch: 71, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.118 Vali Acc: 0.240 Test Loss: 4.118 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.47786283493042
Epoch: 72, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.053 Vali Acc: 0.254 Test Loss: 4.053 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.34629225730896
Epoch: 73, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.065 Vali Acc: 0.259 Test Loss: 4.065 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 192062
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4117512702941895
Epoch: 1, Steps: 10 | Train Loss: 3.455 Vali Loss: 3.397 Vali Acc: 0.042 Test Loss: 3.397 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 1.194580316543579
Epoch: 2, Steps: 10 | Train Loss: 3.403 Vali Loss: 3.341 Vali Acc: 0.049 Test Loss: 3.341 Test Acc: 0.049
Validation loss decreased (-0.042319 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 1.3202555179595947
Epoch: 3, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.317 Vali Acc: 0.042 Test Loss: 3.317 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6938302516937256
Epoch: 4, Steps: 10 | Train Loss: 3.186 Vali Loss: 3.314 Vali Acc: 0.039 Test Loss: 3.314 Test Acc: 0.039
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.354116678237915
Epoch: 5, Steps: 10 | Train Loss: 3.160 Vali Loss: 3.327 Vali Acc: 0.042 Test Loss: 3.327 Test Acc: 0.042
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3261091709136963
Epoch: 6, Steps: 10 | Train Loss: 3.168 Vali Loss: 3.332 Vali Acc: 0.040 Test Loss: 3.332 Test Acc: 0.040
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3162856101989746
Epoch: 7, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.317 Vali Acc: 0.049 Test Loss: 3.317 Test Acc: 0.049
Validation loss decreased (-0.049378 --> -0.049379).  Saving model ...
Epoch: 8 cost time: 1.3640289306640625
Epoch: 8, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.316 Vali Acc: 0.066 Test Loss: 3.316 Test Acc: 0.066
Validation loss decreased (-0.049379 --> -0.065849).  Saving model ...
Epoch: 9 cost time: 1.1465680599212646
Epoch: 9, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.307 Vali Acc: 0.062 Test Loss: 3.307 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3184881210327148
Epoch: 10, Steps: 10 | Train Loss: 2.979 Vali Loss: 3.293 Vali Acc: 0.056 Test Loss: 3.293 Test Acc: 0.056
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6161930561065674
Epoch: 11, Steps: 10 | Train Loss: 2.929 Vali Loss: 3.283 Vali Acc: 0.068 Test Loss: 3.283 Test Acc: 0.068
Validation loss decreased (-0.065849 --> -0.068202).  Saving model ...
Epoch: 12 cost time: 1.327497959136963
Epoch: 12, Steps: 10 | Train Loss: 2.848 Vali Loss: 3.276 Vali Acc: 0.072 Test Loss: 3.276 Test Acc: 0.072
Validation loss decreased (-0.068202 --> -0.071732).  Saving model ...
Epoch: 13 cost time: 1.5901505947113037
Epoch: 13, Steps: 10 | Train Loss: 2.777 Vali Loss: 3.284 Vali Acc: 0.080 Test Loss: 3.284 Test Acc: 0.080
Validation loss decreased (-0.071732 --> -0.079967).  Saving model ...
Epoch: 14 cost time: 1.3990159034729004
Epoch: 14, Steps: 10 | Train Loss: 2.773 Vali Loss: 3.280 Vali Acc: 0.091 Test Loss: 3.280 Test Acc: 0.091
Validation loss decreased (-0.079967 --> -0.090555).  Saving model ...
Epoch: 15 cost time: 1.6137194633483887
Epoch: 15, Steps: 10 | Train Loss: 2.650 Vali Loss: 3.270 Vali Acc: 0.100 Test Loss: 3.270 Test Acc: 0.100
Validation loss decreased (-0.090555 --> -0.099967).  Saving model ...
Epoch: 16 cost time: 1.335597276687622
Epoch: 16, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.256 Vali Acc: 0.089 Test Loss: 3.256 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4375672340393066
Epoch: 17, Steps: 10 | Train Loss: 2.480 Vali Loss: 3.239 Vali Acc: 0.111 Test Loss: 3.239 Test Acc: 0.111
Validation loss decreased (-0.099967 --> -0.110556).  Saving model ...
Epoch: 18 cost time: 1.6589818000793457
Epoch: 18, Steps: 10 | Train Loss: 2.381 Vali Loss: 3.250 Vali Acc: 0.111 Test Loss: 3.250 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.686601161956787
Epoch: 19, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.259 Vali Acc: 0.128 Test Loss: 3.259 Test Acc: 0.128
Validation loss decreased (-0.110556 --> -0.128203).  Saving model ...
Epoch: 20 cost time: 1.142963171005249
Epoch: 20, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.272 Vali Acc: 0.131 Test Loss: 3.272 Test Acc: 0.131
Validation loss decreased (-0.128203 --> -0.130556).  Saving model ...
Epoch: 21 cost time: 1.3717107772827148
Epoch: 21, Steps: 10 | Train Loss: 2.124 Vali Loss: 3.274 Vali Acc: 0.126 Test Loss: 3.274 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2965073585510254
Epoch: 22, Steps: 10 | Train Loss: 1.977 Vali Loss: 3.279 Vali Acc: 0.132 Test Loss: 3.279 Test Acc: 0.132
Validation loss decreased (-0.130556 --> -0.131732).  Saving model ...
Epoch: 23 cost time: 1.2919039726257324
Epoch: 23, Steps: 10 | Train Loss: 1.882 Vali Loss: 3.277 Vali Acc: 0.146 Test Loss: 3.277 Test Acc: 0.146
Validation loss decreased (-0.131732 --> -0.145850).  Saving model ...
Epoch: 24 cost time: 1.3597800731658936
Epoch: 24, Steps: 10 | Train Loss: 1.790 Vali Loss: 3.281 Vali Acc: 0.154 Test Loss: 3.281 Test Acc: 0.154
Validation loss decreased (-0.145850 --> -0.154085).  Saving model ...
Epoch: 25 cost time: 1.5720329284667969
Epoch: 25, Steps: 10 | Train Loss: 1.677 Vali Loss: 3.283 Vali Acc: 0.160 Test Loss: 3.283 Test Acc: 0.160
Validation loss decreased (-0.154085 --> -0.159967).  Saving model ...
Epoch: 26 cost time: 1.7109909057617188
Epoch: 26, Steps: 10 | Train Loss: 1.587 Vali Loss: 3.318 Vali Acc: 0.164 Test Loss: 3.318 Test Acc: 0.164
Validation loss decreased (-0.159967 --> -0.163496).  Saving model ...
Epoch: 27 cost time: 1.3719863891601562
Epoch: 27, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.332 Vali Acc: 0.172 Test Loss: 3.332 Test Acc: 0.172
Validation loss decreased (-0.163496 --> -0.171731).  Saving model ...
Epoch: 28 cost time: 1.6003787517547607
Epoch: 28, Steps: 10 | Train Loss: 1.389 Vali Loss: 3.327 Vali Acc: 0.168 Test Loss: 3.327 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.506941556930542
Epoch: 29, Steps: 10 | Train Loss: 1.277 Vali Loss: 3.317 Vali Acc: 0.181 Test Loss: 3.317 Test Acc: 0.181
Validation loss decreased (-0.171731 --> -0.181143).  Saving model ...
Epoch: 30 cost time: 1.2174468040466309
Epoch: 30, Steps: 10 | Train Loss: 1.175 Vali Loss: 3.318 Vali Acc: 0.180 Test Loss: 3.318 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0840516090393066
Epoch: 31, Steps: 10 | Train Loss: 1.135 Vali Loss: 3.374 Vali Acc: 0.179 Test Loss: 3.374 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7167387008666992
Epoch: 32, Steps: 10 | Train Loss: 1.049 Vali Loss: 3.389 Vali Acc: 0.201 Test Loss: 3.389 Test Acc: 0.201
Validation loss decreased (-0.181143 --> -0.201143).  Saving model ...
Epoch: 33 cost time: 1.6714818477630615
Epoch: 33, Steps: 10 | Train Loss: 0.942 Vali Loss: 3.408 Vali Acc: 0.188 Test Loss: 3.408 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6132521629333496
Epoch: 34, Steps: 10 | Train Loss: 0.882 Vali Loss: 3.422 Vali Acc: 0.199 Test Loss: 3.422 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6471054553985596
Epoch: 35, Steps: 10 | Train Loss: 0.829 Vali Loss: 3.411 Vali Acc: 0.202 Test Loss: 3.411 Test Acc: 0.202
Validation loss decreased (-0.201143 --> -0.202319).  Saving model ...
Epoch: 36 cost time: 1.468623399734497
Epoch: 36, Steps: 10 | Train Loss: 0.727 Vali Loss: 3.468 Vali Acc: 0.204 Test Loss: 3.468 Test Acc: 0.204
Validation loss decreased (-0.202319 --> -0.203495).  Saving model ...
Epoch: 37 cost time: 1.2926325798034668
Epoch: 37, Steps: 10 | Train Loss: 0.631 Vali Loss: 3.491 Vali Acc: 0.213 Test Loss: 3.491 Test Acc: 0.213
Validation loss decreased (-0.203495 --> -0.212906).  Saving model ...
Epoch: 38 cost time: 1.3458056449890137
Epoch: 38, Steps: 10 | Train Loss: 0.597 Vali Loss: 3.483 Vali Acc: 0.214 Test Loss: 3.483 Test Acc: 0.214
Validation loss decreased (-0.212906 --> -0.214083).  Saving model ...
Epoch: 39 cost time: 1.3685152530670166
Epoch: 39, Steps: 10 | Train Loss: 0.518 Vali Loss: 3.542 Vali Acc: 0.206 Test Loss: 3.542 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1846284866333008
Epoch: 40, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.586 Vali Acc: 0.227 Test Loss: 3.586 Test Acc: 0.227
Validation loss decreased (-0.214083 --> -0.227023).  Saving model ...
Epoch: 41 cost time: 1.2393324375152588
Epoch: 41, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.600 Vali Acc: 0.207 Test Loss: 3.600 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3393104076385498
Epoch: 42, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.628 Vali Acc: 0.233 Test Loss: 3.628 Test Acc: 0.233
Validation loss decreased (-0.227023 --> -0.232905).  Saving model ...
Epoch: 43 cost time: 1.3664813041687012
Epoch: 43, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.702 Vali Acc: 0.231 Test Loss: 3.702 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.644974946975708
Epoch: 44, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.658 Vali Acc: 0.226 Test Loss: 3.658 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.24924898147583
Epoch: 45, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.737 Vali Acc: 0.220 Test Loss: 3.737 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.5534908771514893
Epoch: 46, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.794 Vali Acc: 0.235 Test Loss: 3.794 Test Acc: 0.235
Validation loss decreased (-0.232905 --> -0.235256).  Saving model ...
Epoch: 47 cost time: 1.1647908687591553
Epoch: 47, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.783 Vali Acc: 0.224 Test Loss: 3.783 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4703564643859863
Epoch: 48, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.796 Vali Acc: 0.220 Test Loss: 3.796 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.4661719799041748
Epoch: 49, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.837 Vali Acc: 0.233 Test Loss: 3.837 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.698904037475586
Epoch: 50, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.843 Vali Acc: 0.229 Test Loss: 3.843 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.2852671146392822
Epoch: 51, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.823 Vali Acc: 0.235 Test Loss: 3.823 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.489915370941162
Epoch: 52, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.942 Vali Acc: 0.234 Test Loss: 3.942 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.796452283859253
Epoch: 53, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.904 Vali Acc: 0.224 Test Loss: 3.904 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.2897140979766846
Epoch: 54, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.915 Vali Acc: 0.234 Test Loss: 3.915 Test Acc: 0.234
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.4023373126983643
Epoch: 55, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.955 Vali Acc: 0.234 Test Loss: 3.955 Test Acc: 0.234
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.3626821041107178
Epoch: 56, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.960 Vali Acc: 0.234 Test Loss: 3.960 Test Acc: 0.234
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23529411764705882
model parameter : 191422
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.9948201179504395
Epoch: 1, Steps: 10 | Train Loss: 3.571 Vali Loss: 3.425 Vali Acc: 0.032 Test Loss: 3.425 Test Acc: 0.032
Validation loss decreased (inf --> -0.031730).  Saving model ...
Epoch: 2 cost time: 1.3251760005950928
Epoch: 2, Steps: 10 | Train Loss: 3.403 Vali Loss: 3.352 Vali Acc: 0.031 Test Loss: 3.352 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5761420726776123
Epoch: 3, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.321 Vali Acc: 0.036 Test Loss: 3.321 Test Acc: 0.036
Validation loss decreased (-0.031730 --> -0.036437).  Saving model ...
Epoch: 4 cost time: 1.5273997783660889
Epoch: 4, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.331 Vali Acc: 0.041 Test Loss: 3.331 Test Acc: 0.041
Validation loss decreased (-0.036437 --> -0.041143).  Saving model ...
Epoch: 5 cost time: 1.3253145217895508
Epoch: 5, Steps: 10 | Train Loss: 3.186 Vali Loss: 3.352 Vali Acc: 0.046 Test Loss: 3.352 Test Acc: 0.046
Validation loss decreased (-0.041143 --> -0.045849).  Saving model ...
Epoch: 6 cost time: 1.3678369522094727
Epoch: 6, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.342 Vali Acc: 0.058 Test Loss: 3.342 Test Acc: 0.058
Validation loss decreased (-0.045849 --> -0.057614).  Saving model ...
Epoch: 7 cost time: 1.38411545753479
Epoch: 7, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.341 Vali Acc: 0.061 Test Loss: 3.341 Test Acc: 0.061
Validation loss decreased (-0.057614 --> -0.061143).  Saving model ...
Epoch: 8 cost time: 1.5121288299560547
Epoch: 8, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.336 Vali Acc: 0.055 Test Loss: 3.336 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0815784931182861
Epoch: 9, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.334 Vali Acc: 0.069 Test Loss: 3.334 Test Acc: 0.069
Validation loss decreased (-0.061143 --> -0.069378).  Saving model ...
Epoch: 10 cost time: 1.114689826965332
Epoch: 10, Steps: 10 | Train Loss: 2.924 Vali Loss: 3.313 Vali Acc: 0.073 Test Loss: 3.313 Test Acc: 0.073
Validation loss decreased (-0.069378 --> -0.072908).  Saving model ...
Epoch: 11 cost time: 1.2891871929168701
Epoch: 11, Steps: 10 | Train Loss: 2.913 Vali Loss: 3.308 Vali Acc: 0.065 Test Loss: 3.308 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2949252128601074
Epoch: 12, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.307 Vali Acc: 0.082 Test Loss: 3.307 Test Acc: 0.082
Validation loss decreased (-0.072908 --> -0.082320).  Saving model ...
Epoch: 13 cost time: 1.669062852859497
Epoch: 13, Steps: 10 | Train Loss: 2.791 Vali Loss: 3.300 Vali Acc: 0.101 Test Loss: 3.300 Test Acc: 0.101
Validation loss decreased (-0.082320 --> -0.101143).  Saving model ...
Epoch: 14 cost time: 1.4176535606384277
Epoch: 14, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.295 Vali Acc: 0.088 Test Loss: 3.295 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6054139137268066
Epoch: 15, Steps: 10 | Train Loss: 2.629 Vali Loss: 3.273 Vali Acc: 0.105 Test Loss: 3.273 Test Acc: 0.105
Validation loss decreased (-0.101143 --> -0.104673).  Saving model ...
Epoch: 16 cost time: 1.5505993366241455
Epoch: 16, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.265 Vali Acc: 0.124 Test Loss: 3.265 Test Acc: 0.124
Validation loss decreased (-0.104673 --> -0.123497).  Saving model ...
Epoch: 17 cost time: 1.6973280906677246
Epoch: 17, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.254 Vali Acc: 0.128 Test Loss: 3.254 Test Acc: 0.128
Validation loss decreased (-0.123497 --> -0.128203).  Saving model ...
Epoch: 18 cost time: 1.4997014999389648
Epoch: 18, Steps: 10 | Train Loss: 2.408 Vali Loss: 3.258 Vali Acc: 0.138 Test Loss: 3.258 Test Acc: 0.138
Validation loss decreased (-0.128203 --> -0.137614).  Saving model ...
Epoch: 19 cost time: 1.7167973518371582
Epoch: 19, Steps: 10 | Train Loss: 2.299 Vali Loss: 3.283 Vali Acc: 0.127 Test Loss: 3.283 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6271047592163086
Epoch: 20, Steps: 10 | Train Loss: 2.185 Vali Loss: 3.263 Vali Acc: 0.141 Test Loss: 3.263 Test Acc: 0.141
Validation loss decreased (-0.137614 --> -0.141144).  Saving model ...
Epoch: 21 cost time: 1.671461820602417
Epoch: 21, Steps: 10 | Train Loss: 2.080 Vali Loss: 3.244 Vali Acc: 0.144 Test Loss: 3.244 Test Acc: 0.144
Validation loss decreased (-0.141144 --> -0.143497).  Saving model ...
Epoch: 22 cost time: 1.9789721965789795
Epoch: 22, Steps: 10 | Train Loss: 1.979 Vali Loss: 3.259 Vali Acc: 0.153 Test Loss: 3.259 Test Acc: 0.153
Validation loss decreased (-0.143497 --> -0.152909).  Saving model ...
Epoch: 23 cost time: 1.1663897037506104
Epoch: 23, Steps: 10 | Train Loss: 1.949 Vali Loss: 3.261 Vali Acc: 0.149 Test Loss: 3.261 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6241393089294434
Epoch: 24, Steps: 10 | Train Loss: 1.812 Vali Loss: 3.255 Vali Acc: 0.158 Test Loss: 3.255 Test Acc: 0.158
Validation loss decreased (-0.152909 --> -0.157615).  Saving model ...
Epoch: 25 cost time: 1.822845220565796
Epoch: 25, Steps: 10 | Train Loss: 1.740 Vali Loss: 3.268 Vali Acc: 0.159 Test Loss: 3.268 Test Acc: 0.159
Validation loss decreased (-0.157615 --> -0.158791).  Saving model ...
Epoch: 26 cost time: 1.1323020458221436
Epoch: 26, Steps: 10 | Train Loss: 1.617 Vali Loss: 3.282 Vali Acc: 0.160 Test Loss: 3.282 Test Acc: 0.160
Validation loss decreased (-0.158791 --> -0.159967).  Saving model ...
Epoch: 27 cost time: 1.750124216079712
Epoch: 27, Steps: 10 | Train Loss: 1.557 Vali Loss: 3.300 Vali Acc: 0.172 Test Loss: 3.300 Test Acc: 0.172
Validation loss decreased (-0.159967 --> -0.171732).  Saving model ...
Epoch: 28 cost time: 1.693809986114502
Epoch: 28, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.280 Vali Acc: 0.178 Test Loss: 3.280 Test Acc: 0.178
Validation loss decreased (-0.171732 --> -0.177614).  Saving model ...
Epoch: 29 cost time: 1.4509479999542236
Epoch: 29, Steps: 10 | Train Loss: 1.358 Vali Loss: 3.310 Vali Acc: 0.184 Test Loss: 3.310 Test Acc: 0.184
Validation loss decreased (-0.177614 --> -0.183496).  Saving model ...
Epoch: 30 cost time: 1.7513995170593262
Epoch: 30, Steps: 10 | Train Loss: 1.307 Vali Loss: 3.314 Vali Acc: 0.180 Test Loss: 3.314 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8938145637512207
Epoch: 31, Steps: 10 | Train Loss: 1.243 Vali Loss: 3.314 Vali Acc: 0.179 Test Loss: 3.314 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7584285736083984
Epoch: 32, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.316 Vali Acc: 0.193 Test Loss: 3.316 Test Acc: 0.193
Validation loss decreased (-0.183496 --> -0.192908).  Saving model ...
Epoch: 33 cost time: 1.4083068370819092
Epoch: 33, Steps: 10 | Train Loss: 1.111 Vali Loss: 3.339 Vali Acc: 0.192 Test Loss: 3.339 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9204328060150146
Epoch: 34, Steps: 10 | Train Loss: 1.086 Vali Loss: 3.374 Vali Acc: 0.191 Test Loss: 3.374 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7020847797393799
Epoch: 35, Steps: 10 | Train Loss: 0.934 Vali Loss: 3.339 Vali Acc: 0.211 Test Loss: 3.339 Test Acc: 0.211
Validation loss decreased (-0.192908 --> -0.210555).  Saving model ...
Epoch: 36 cost time: 1.3318588733673096
Epoch: 36, Steps: 10 | Train Loss: 0.856 Vali Loss: 3.358 Vali Acc: 0.202 Test Loss: 3.358 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3880157470703125
Epoch: 37, Steps: 10 | Train Loss: 0.769 Vali Loss: 3.357 Vali Acc: 0.211 Test Loss: 3.357 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6201908588409424
Epoch: 38, Steps: 10 | Train Loss: 0.732 Vali Loss: 3.399 Vali Acc: 0.204 Test Loss: 3.399 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.497063159942627
Epoch: 39, Steps: 10 | Train Loss: 0.688 Vali Loss: 3.412 Vali Acc: 0.220 Test Loss: 3.412 Test Acc: 0.220
Validation loss decreased (-0.210555 --> -0.219966).  Saving model ...
Epoch: 40 cost time: 1.247913122177124
Epoch: 40, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.414 Vali Acc: 0.211 Test Loss: 3.414 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6516423225402832
Epoch: 41, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.431 Vali Acc: 0.220 Test Loss: 3.431 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.637418508529663
Epoch: 42, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.459 Vali Acc: 0.215 Test Loss: 3.459 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.6338748931884766
Epoch: 43, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.477 Vali Acc: 0.229 Test Loss: 3.477 Test Acc: 0.229
Validation loss decreased (-0.219966 --> -0.229377).  Saving model ...
Epoch: 44 cost time: 1.4357502460479736
Epoch: 44, Steps: 10 | Train Loss: 0.421 Vali Loss: 3.502 Vali Acc: 0.235 Test Loss: 3.502 Test Acc: 0.235
Validation loss decreased (-0.229377 --> -0.235259).  Saving model ...
Epoch: 45 cost time: 1.8137614727020264
Epoch: 45, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.552 Vali Acc: 0.215 Test Loss: 3.552 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.589247703552246
Epoch: 46, Steps: 10 | Train Loss: 0.333 Vali Loss: 3.622 Vali Acc: 0.228 Test Loss: 3.622 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.7865848541259766
Epoch: 47, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.565 Vali Acc: 0.232 Test Loss: 3.565 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.8510792255401611
Epoch: 48, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.588 Vali Acc: 0.235 Test Loss: 3.588 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.6140527725219727
Epoch: 49, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.685 Vali Acc: 0.239 Test Loss: 3.685 Test Acc: 0.239
Validation loss decreased (-0.235259 --> -0.238787).  Saving model ...
Epoch: 50 cost time: 1.3703632354736328
Epoch: 50, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.678 Vali Acc: 0.220 Test Loss: 3.678 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.341217041015625
Epoch: 51, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.704 Vali Acc: 0.245 Test Loss: 3.704 Test Acc: 0.245
Validation loss decreased (-0.238787 --> -0.244669).  Saving model ...
Epoch: 52 cost time: 1.6583526134490967
Epoch: 52, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.665 Vali Acc: 0.241 Test Loss: 3.665 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.629565954208374
Epoch: 53, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.724 Vali Acc: 0.245 Test Loss: 3.724 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.7707180976867676
Epoch: 54, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.724 Vali Acc: 0.244 Test Loss: 3.724 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.0663607120513916
Epoch: 55, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.742 Vali Acc: 0.246 Test Loss: 3.742 Test Acc: 0.246
Validation loss decreased (-0.244669 --> -0.245845).  Saving model ...
Epoch: 56 cost time: 1.4956858158111572
Epoch: 56, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.769 Vali Acc: 0.253 Test Loss: 3.769 Test Acc: 0.253
Validation loss decreased (-0.245845 --> -0.252903).  Saving model ...
Epoch: 57 cost time: 1.2000017166137695
Epoch: 57, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.818 Vali Acc: 0.258 Test Loss: 3.818 Test Acc: 0.258
Validation loss decreased (-0.252903 --> -0.257609).  Saving model ...
Epoch: 58 cost time: 1.411219835281372
Epoch: 58, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.838 Vali Acc: 0.251 Test Loss: 3.838 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.150963544845581
Epoch: 59, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.862 Vali Acc: 0.258 Test Loss: 3.862 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.663266897201538
Epoch: 60, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.819 Vali Acc: 0.246 Test Loss: 3.819 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.516127586364746
Epoch: 61, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.869 Vali Acc: 0.249 Test Loss: 3.869 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.4908771514892578
Epoch: 62, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.915 Vali Acc: 0.247 Test Loss: 3.915 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.8857264518737793
Epoch: 63, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.905 Vali Acc: 0.249 Test Loss: 3.905 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.8635706901550293
Epoch: 64, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.916 Vali Acc: 0.254 Test Loss: 3.916 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.5979321002960205
Epoch: 65, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.987 Vali Acc: 0.249 Test Loss: 3.987 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 2.064192533493042
Epoch: 66, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.965 Vali Acc: 0.251 Test Loss: 3.965 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.7109651565551758
Epoch: 67, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.965 Vali Acc: 0.255 Test Loss: 3.965 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 190782
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6984782218933105
Epoch: 1, Steps: 10 | Train Loss: 3.461 Vali Loss: 3.420 Vali Acc: 0.036 Test Loss: 3.420 Test Acc: 0.036
Validation loss decreased (inf --> -0.036436).  Saving model ...
Epoch: 2 cost time: 2.0909082889556885
Epoch: 2, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.362 Vali Acc: 0.053 Test Loss: 3.362 Test Acc: 0.053
Validation loss decreased (-0.036436 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 1.3491408824920654
Epoch: 3, Steps: 10 | Train Loss: 3.231 Vali Loss: 3.322 Vali Acc: 0.047 Test Loss: 3.322 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.396838903427124
Epoch: 4, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.316 Vali Acc: 0.044 Test Loss: 3.316 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7109365463256836
Epoch: 5, Steps: 10 | Train Loss: 3.155 Vali Loss: 3.318 Vali Acc: 0.046 Test Loss: 3.318 Test Acc: 0.046
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3988611698150635
Epoch: 6, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.319 Vali Acc: 0.062 Test Loss: 3.319 Test Acc: 0.062
Validation loss decreased (-0.052908 --> -0.062320).  Saving model ...
Epoch: 7 cost time: 1.4325459003448486
Epoch: 7, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.325 Vali Acc: 0.067 Test Loss: 3.325 Test Acc: 0.067
Validation loss decreased (-0.062320 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 1.59483003616333
Epoch: 8, Steps: 10 | Train Loss: 3.020 Vali Loss: 3.311 Vali Acc: 0.067 Test Loss: 3.311 Test Acc: 0.067
Validation loss decreased (-0.067026 --> -0.067026).  Saving model ...
Epoch: 9 cost time: 1.4851832389831543
Epoch: 9, Steps: 10 | Train Loss: 3.038 Vali Loss: 3.308 Vali Acc: 0.074 Test Loss: 3.308 Test Acc: 0.074
Validation loss decreased (-0.067026 --> -0.074085).  Saving model ...
Epoch: 10 cost time: 1.4467053413391113
Epoch: 10, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.292 Vali Acc: 0.078 Test Loss: 3.292 Test Acc: 0.078
Validation loss decreased (-0.074085 --> -0.077614).  Saving model ...
Epoch: 11 cost time: 1.5238676071166992
Epoch: 11, Steps: 10 | Train Loss: 2.886 Vali Loss: 3.269 Vali Acc: 0.089 Test Loss: 3.269 Test Acc: 0.089
Validation loss decreased (-0.077614 --> -0.089379).  Saving model ...
Epoch: 12 cost time: 1.4774386882781982
Epoch: 12, Steps: 10 | Train Loss: 2.847 Vali Loss: 3.270 Vali Acc: 0.089 Test Loss: 3.270 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4866466522216797
Epoch: 13, Steps: 10 | Train Loss: 2.771 Vali Loss: 3.262 Vali Acc: 0.085 Test Loss: 3.262 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8381333351135254
Epoch: 14, Steps: 10 | Train Loss: 2.700 Vali Loss: 3.267 Vali Acc: 0.096 Test Loss: 3.267 Test Acc: 0.096
Validation loss decreased (-0.089379 --> -0.096438).  Saving model ...
Epoch: 15 cost time: 1.8092191219329834
Epoch: 15, Steps: 10 | Train Loss: 2.663 Vali Loss: 3.280 Vali Acc: 0.091 Test Loss: 3.280 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4050278663635254
Epoch: 16, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.255 Vali Acc: 0.101 Test Loss: 3.255 Test Acc: 0.101
Validation loss decreased (-0.096438 --> -0.101144).  Saving model ...
Epoch: 17 cost time: 2.189608335494995
Epoch: 17, Steps: 10 | Train Loss: 2.455 Vali Loss: 3.242 Vali Acc: 0.109 Test Loss: 3.242 Test Acc: 0.109
Validation loss decreased (-0.101144 --> -0.109379).  Saving model ...
Epoch: 18 cost time: 1.3727405071258545
Epoch: 18, Steps: 10 | Train Loss: 2.375 Vali Loss: 3.255 Vali Acc: 0.109 Test Loss: 3.255 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1208014488220215
Epoch: 19, Steps: 10 | Train Loss: 2.299 Vali Loss: 3.255 Vali Acc: 0.115 Test Loss: 3.255 Test Acc: 0.115
Validation loss decreased (-0.109379 --> -0.115262).  Saving model ...
Epoch: 20 cost time: 1.9656970500946045
Epoch: 20, Steps: 10 | Train Loss: 2.177 Vali Loss: 3.235 Vali Acc: 0.119 Test Loss: 3.235 Test Acc: 0.119
Validation loss decreased (-0.115262 --> -0.118791).  Saving model ...
Epoch: 21 cost time: 2.489438533782959
Epoch: 21, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.249 Vali Acc: 0.124 Test Loss: 3.249 Test Acc: 0.124
Validation loss decreased (-0.118791 --> -0.123497).  Saving model ...
Epoch: 22 cost time: 1.6495168209075928
Epoch: 22, Steps: 10 | Train Loss: 1.986 Vali Loss: 3.260 Vali Acc: 0.136 Test Loss: 3.260 Test Acc: 0.136
Validation loss decreased (-0.123497 --> -0.136438).  Saving model ...
Epoch: 23 cost time: 1.5421271324157715
Epoch: 23, Steps: 10 | Train Loss: 1.980 Vali Loss: 3.281 Vali Acc: 0.128 Test Loss: 3.281 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.602099895477295
Epoch: 24, Steps: 10 | Train Loss: 1.874 Vali Loss: 3.273 Vali Acc: 0.142 Test Loss: 3.273 Test Acc: 0.142
Validation loss decreased (-0.136438 --> -0.142320).  Saving model ...
Epoch: 25 cost time: 1.5416207313537598
Epoch: 25, Steps: 10 | Train Loss: 1.787 Vali Loss: 3.277 Vali Acc: 0.149 Test Loss: 3.277 Test Acc: 0.149
Validation loss decreased (-0.142320 --> -0.149379).  Saving model ...
Epoch: 26 cost time: 1.8235185146331787
Epoch: 26, Steps: 10 | Train Loss: 1.679 Vali Loss: 3.284 Vali Acc: 0.165 Test Loss: 3.284 Test Acc: 0.165
Validation loss decreased (-0.149379 --> -0.164673).  Saving model ...
Epoch: 27 cost time: 1.3964447975158691
Epoch: 27, Steps: 10 | Train Loss: 1.661 Vali Loss: 3.276 Vali Acc: 0.162 Test Loss: 3.276 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.545083999633789
Epoch: 28, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.312 Vali Acc: 0.162 Test Loss: 3.312 Test Acc: 0.162
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3270795345306396
Epoch: 29, Steps: 10 | Train Loss: 1.411 Vali Loss: 3.288 Vali Acc: 0.169 Test Loss: 3.288 Test Acc: 0.169
Validation loss decreased (-0.164673 --> -0.169379).  Saving model ...
Epoch: 30 cost time: 1.4649038314819336
Epoch: 30, Steps: 10 | Train Loss: 1.332 Vali Loss: 3.329 Vali Acc: 0.174 Test Loss: 3.329 Test Acc: 0.174
Validation loss decreased (-0.169379 --> -0.174084).  Saving model ...
Epoch: 31 cost time: 1.534409523010254
Epoch: 31, Steps: 10 | Train Loss: 1.297 Vali Loss: 3.318 Vali Acc: 0.178 Test Loss: 3.318 Test Acc: 0.178
Validation loss decreased (-0.174084 --> -0.177614).  Saving model ...
Epoch: 32 cost time: 2.081549644470215
Epoch: 32, Steps: 10 | Train Loss: 1.236 Vali Loss: 3.319 Vali Acc: 0.186 Test Loss: 3.319 Test Acc: 0.186
Validation loss decreased (-0.177614 --> -0.185849).  Saving model ...
Epoch: 33 cost time: 1.961111068725586
Epoch: 33, Steps: 10 | Train Loss: 1.127 Vali Loss: 3.354 Vali Acc: 0.186 Test Loss: 3.354 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.918877363204956
Epoch: 34, Steps: 10 | Train Loss: 1.065 Vali Loss: 3.346 Vali Acc: 0.191 Test Loss: 3.346 Test Acc: 0.191
Validation loss decreased (-0.185849 --> -0.190555).  Saving model ...
Epoch: 35 cost time: 1.9285852909088135
Epoch: 35, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.367 Vali Acc: 0.192 Test Loss: 3.367 Test Acc: 0.192
Validation loss decreased (-0.190555 --> -0.191731).  Saving model ...
Epoch: 36 cost time: 2.2455577850341797
Epoch: 36, Steps: 10 | Train Loss: 0.902 Vali Loss: 3.386 Vali Acc: 0.194 Test Loss: 3.386 Test Acc: 0.194
Validation loss decreased (-0.191731 --> -0.194084).  Saving model ...
Epoch: 37 cost time: 2.365389347076416
Epoch: 37, Steps: 10 | Train Loss: 0.848 Vali Loss: 3.397 Vali Acc: 0.204 Test Loss: 3.397 Test Acc: 0.204
Validation loss decreased (-0.194084 --> -0.203495).  Saving model ...
Epoch: 38 cost time: 1.8655924797058105
Epoch: 38, Steps: 10 | Train Loss: 0.812 Vali Loss: 3.444 Vali Acc: 0.206 Test Loss: 3.444 Test Acc: 0.206
Validation loss decreased (-0.203495 --> -0.205848).  Saving model ...
Epoch: 39 cost time: 1.995636224746704
Epoch: 39, Steps: 10 | Train Loss: 0.768 Vali Loss: 3.443 Vali Acc: 0.206 Test Loss: 3.443 Test Acc: 0.206
Validation loss decreased (-0.205848 --> -0.205848).  Saving model ...
Epoch: 40 cost time: 1.7400250434875488
Epoch: 40, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.432 Vali Acc: 0.213 Test Loss: 3.432 Test Acc: 0.213
Validation loss decreased (-0.205848 --> -0.212907).  Saving model ...
Epoch: 41 cost time: 2.172142505645752
Epoch: 41, Steps: 10 | Train Loss: 0.622 Vali Loss: 3.473 Vali Acc: 0.207 Test Loss: 3.473 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.8189113140106201
Epoch: 42, Steps: 10 | Train Loss: 0.564 Vali Loss: 3.505 Vali Acc: 0.213 Test Loss: 3.505 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.2854363918304443
Epoch: 43, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.540 Vali Acc: 0.213 Test Loss: 3.540 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.39031982421875
Epoch: 44, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.567 Vali Acc: 0.224 Test Loss: 3.567 Test Acc: 0.224
Validation loss decreased (-0.212907 --> -0.223494).  Saving model ...
Epoch: 45 cost time: 1.487053394317627
Epoch: 45, Steps: 10 | Train Loss: 0.417 Vali Loss: 3.586 Vali Acc: 0.208 Test Loss: 3.586 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.4413480758666992
Epoch: 46, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.588 Vali Acc: 0.218 Test Loss: 3.588 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.5775985717773438
Epoch: 47, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.637 Vali Acc: 0.212 Test Loss: 3.637 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3426434993743896
Epoch: 48, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.704 Vali Acc: 0.220 Test Loss: 3.704 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.5741829872131348
Epoch: 49, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.693 Vali Acc: 0.220 Test Loss: 3.693 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.7856829166412354
Epoch: 50, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.721 Vali Acc: 0.209 Test Loss: 3.721 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.6151466369628906
Epoch: 51, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.726 Vali Acc: 0.227 Test Loss: 3.726 Test Acc: 0.227
Validation loss decreased (-0.223494 --> -0.227022).  Saving model ...
Epoch: 52 cost time: 2.1463708877563477
Epoch: 52, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.775 Vali Acc: 0.218 Test Loss: 3.775 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.602337121963501
Epoch: 53, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.777 Vali Acc: 0.234 Test Loss: 3.777 Test Acc: 0.234
Validation loss decreased (-0.227022 --> -0.234080).  Saving model ...
Epoch: 54 cost time: 1.495328426361084
Epoch: 54, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.801 Vali Acc: 0.222 Test Loss: 3.801 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.4219717979431152
Epoch: 55, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.835 Vali Acc: 0.219 Test Loss: 3.835 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.6843481063842773
Epoch: 56, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.881 Vali Acc: 0.227 Test Loss: 3.881 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.5797581672668457
Epoch: 57, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.865 Vali Acc: 0.221 Test Loss: 3.865 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.4269931316375732
Epoch: 58, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.906 Vali Acc: 0.226 Test Loss: 3.906 Test Acc: 0.226
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.3893556594848633
Epoch: 59, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.952 Vali Acc: 0.220 Test Loss: 3.952 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.5769116878509521
Epoch: 60, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.935 Vali Acc: 0.225 Test Loss: 3.935 Test Acc: 0.225
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.6482725143432617
Epoch: 61, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.977 Vali Acc: 0.222 Test Loss: 3.977 Test Acc: 0.222
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.9285168647766113
Epoch: 62, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.988 Vali Acc: 0.224 Test Loss: 3.988 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.4529213905334473
Epoch: 63, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.071 Vali Acc: 0.214 Test Loss: 4.071 Test Acc: 0.214
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23411764705882354
model parameter : 151102
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6763391494750977
Epoch: 1, Steps: 10 | Train Loss: 3.306 Vali Loss: 3.392 Vali Acc: 0.038 Test Loss: 3.392 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 1.215165138244629
Epoch: 2, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.354 Vali Acc: 0.040 Test Loss: 3.354 Test Acc: 0.040
Validation loss decreased (-0.037613 --> -0.039966).  Saving model ...
Epoch: 3 cost time: 1.2834408283233643
Epoch: 3, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.331 Vali Acc: 0.041 Test Loss: 3.331 Test Acc: 0.041
Validation loss decreased (-0.039966 --> -0.041143).  Saving model ...
Epoch: 4 cost time: 1.202427864074707
Epoch: 4, Steps: 10 | Train Loss: 3.215 Vali Loss: 3.330 Vali Acc: 0.040 Test Loss: 3.330 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.170220136642456
Epoch: 5, Steps: 10 | Train Loss: 3.168 Vali Loss: 3.322 Vali Acc: 0.055 Test Loss: 3.322 Test Acc: 0.055
Validation loss decreased (-0.041143 --> -0.055261).  Saving model ...
Epoch: 6 cost time: 1.3581418991088867
Epoch: 6, Steps: 10 | Train Loss: 3.122 Vali Loss: 3.323 Vali Acc: 0.055 Test Loss: 3.323 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3565926551818848
Epoch: 7, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.319 Vali Acc: 0.058 Test Loss: 3.319 Test Acc: 0.058
Validation loss decreased (-0.055261 --> -0.057614).  Saving model ...
Epoch: 8 cost time: 1.2751431465148926
Epoch: 8, Steps: 10 | Train Loss: 3.059 Vali Loss: 3.319 Vali Acc: 0.051 Test Loss: 3.319 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5847485065460205
Epoch: 9, Steps: 10 | Train Loss: 3.037 Vali Loss: 3.313 Vali Acc: 0.062 Test Loss: 3.313 Test Acc: 0.062
Validation loss decreased (-0.057614 --> -0.062320).  Saving model ...
Epoch: 10 cost time: 1.647566556930542
Epoch: 10, Steps: 10 | Train Loss: 2.944 Vali Loss: 3.308 Vali Acc: 0.066 Test Loss: 3.308 Test Acc: 0.066
Validation loss decreased (-0.062320 --> -0.065849).  Saving model ...
Epoch: 11 cost time: 1.5509192943572998
Epoch: 11, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.318 Vali Acc: 0.071 Test Loss: 3.318 Test Acc: 0.071
Validation loss decreased (-0.065849 --> -0.070555).  Saving model ...
Epoch: 12 cost time: 1.487269639968872
Epoch: 12, Steps: 10 | Train Loss: 2.910 Vali Loss: 3.296 Vali Acc: 0.074 Test Loss: 3.296 Test Acc: 0.074
Validation loss decreased (-0.070555 --> -0.074085).  Saving model ...
Epoch: 13 cost time: 1.4418728351593018
Epoch: 13, Steps: 10 | Train Loss: 2.869 Vali Loss: 3.281 Vali Acc: 0.073 Test Loss: 3.281 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.319638729095459
Epoch: 14, Steps: 10 | Train Loss: 2.764 Vali Loss: 3.268 Vali Acc: 0.091 Test Loss: 3.268 Test Acc: 0.091
Validation loss decreased (-0.074085 --> -0.090556).  Saving model ...
Epoch: 15 cost time: 1.5210158824920654
Epoch: 15, Steps: 10 | Train Loss: 2.693 Vali Loss: 3.263 Vali Acc: 0.086 Test Loss: 3.263 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4551095962524414
Epoch: 16, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.270 Vali Acc: 0.094 Test Loss: 3.270 Test Acc: 0.094
Validation loss decreased (-0.090556 --> -0.094085).  Saving model ...
Epoch: 17 cost time: 1.1605632305145264
Epoch: 17, Steps: 10 | Train Loss: 2.542 Vali Loss: 3.273 Vali Acc: 0.093 Test Loss: 3.273 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.411391019821167
Epoch: 18, Steps: 10 | Train Loss: 2.458 Vali Loss: 3.261 Vali Acc: 0.108 Test Loss: 3.261 Test Acc: 0.108
Validation loss decreased (-0.094085 --> -0.108203).  Saving model ...
Epoch: 19 cost time: 1.5095882415771484
Epoch: 19, Steps: 10 | Train Loss: 2.353 Vali Loss: 3.251 Vali Acc: 0.119 Test Loss: 3.251 Test Acc: 0.119
Validation loss decreased (-0.108203 --> -0.118791).  Saving model ...
Epoch: 20 cost time: 1.436554193496704
Epoch: 20, Steps: 10 | Train Loss: 2.221 Vali Loss: 3.242 Vali Acc: 0.127 Test Loss: 3.242 Test Acc: 0.127
Validation loss decreased (-0.118791 --> -0.127026).  Saving model ...
Epoch: 21 cost time: 1.6134490966796875
Epoch: 21, Steps: 10 | Train Loss: 2.173 Vali Loss: 3.269 Vali Acc: 0.116 Test Loss: 3.269 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.517000436782837
Epoch: 22, Steps: 10 | Train Loss: 2.077 Vali Loss: 3.277 Vali Acc: 0.127 Test Loss: 3.277 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6000657081604004
Epoch: 23, Steps: 10 | Train Loss: 1.950 Vali Loss: 3.264 Vali Acc: 0.133 Test Loss: 3.264 Test Acc: 0.133
Validation loss decreased (-0.127026 --> -0.132909).  Saving model ...
Epoch: 24 cost time: 1.3752787113189697
Epoch: 24, Steps: 10 | Train Loss: 1.894 Vali Loss: 3.269 Vali Acc: 0.136 Test Loss: 3.269 Test Acc: 0.136
Validation loss decreased (-0.132909 --> -0.136438).  Saving model ...
Epoch: 25 cost time: 1.3769011497497559
Epoch: 25, Steps: 10 | Train Loss: 1.771 Vali Loss: 3.274 Vali Acc: 0.154 Test Loss: 3.274 Test Acc: 0.154
Validation loss decreased (-0.136438 --> -0.154085).  Saving model ...
Epoch: 26 cost time: 1.3899357318878174
Epoch: 26, Steps: 10 | Train Loss: 1.698 Vali Loss: 3.292 Vali Acc: 0.153 Test Loss: 3.292 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7756812572479248
Epoch: 27, Steps: 10 | Train Loss: 1.601 Vali Loss: 3.306 Vali Acc: 0.142 Test Loss: 3.306 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2320287227630615
Epoch: 28, Steps: 10 | Train Loss: 1.473 Vali Loss: 3.308 Vali Acc: 0.166 Test Loss: 3.308 Test Acc: 0.166
Validation loss decreased (-0.154085 --> -0.165849).  Saving model ...
Epoch: 29 cost time: 1.2782068252563477
Epoch: 29, Steps: 10 | Train Loss: 1.411 Vali Loss: 3.312 Vali Acc: 0.168 Test Loss: 3.312 Test Acc: 0.168
Validation loss decreased (-0.165849 --> -0.168202).  Saving model ...
Epoch: 30 cost time: 1.2594223022460938
Epoch: 30, Steps: 10 | Train Loss: 1.362 Vali Loss: 3.315 Vali Acc: 0.168 Test Loss: 3.315 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3305277824401855
Epoch: 31, Steps: 10 | Train Loss: 1.213 Vali Loss: 3.321 Vali Acc: 0.175 Test Loss: 3.321 Test Acc: 0.175
Validation loss decreased (-0.168202 --> -0.175261).  Saving model ...
Epoch: 32 cost time: 1.3259541988372803
Epoch: 32, Steps: 10 | Train Loss: 1.158 Vali Loss: 3.334 Vali Acc: 0.186 Test Loss: 3.334 Test Acc: 0.186
Validation loss decreased (-0.175261 --> -0.185849).  Saving model ...
Epoch: 33 cost time: 1.466221570968628
Epoch: 33, Steps: 10 | Train Loss: 1.051 Vali Loss: 3.346 Vali Acc: 0.193 Test Loss: 3.346 Test Acc: 0.193
Validation loss decreased (-0.185849 --> -0.192908).  Saving model ...
Epoch: 34 cost time: 1.8486099243164062
Epoch: 34, Steps: 10 | Train Loss: 1.015 Vali Loss: 3.368 Vali Acc: 0.193 Test Loss: 3.368 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7849650382995605
Epoch: 35, Steps: 10 | Train Loss: 0.920 Vali Loss: 3.387 Vali Acc: 0.206 Test Loss: 3.387 Test Acc: 0.206
Validation loss decreased (-0.192908 --> -0.205848).  Saving model ...
Epoch: 36 cost time: 1.5923871994018555
Epoch: 36, Steps: 10 | Train Loss: 0.831 Vali Loss: 3.382 Vali Acc: 0.209 Test Loss: 3.382 Test Acc: 0.209
Validation loss decreased (-0.205848 --> -0.209378).  Saving model ...
Epoch: 37 cost time: 1.309300184249878
Epoch: 37, Steps: 10 | Train Loss: 0.796 Vali Loss: 3.391 Vali Acc: 0.207 Test Loss: 3.391 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3161053657531738
Epoch: 38, Steps: 10 | Train Loss: 0.702 Vali Loss: 3.409 Vali Acc: 0.211 Test Loss: 3.409 Test Acc: 0.211
Validation loss decreased (-0.209378 --> -0.210554).  Saving model ...
Epoch: 39 cost time: 1.299128770828247
Epoch: 39, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.465 Vali Acc: 0.207 Test Loss: 3.465 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6169064044952393
Epoch: 40, Steps: 10 | Train Loss: 0.594 Vali Loss: 3.461 Vali Acc: 0.226 Test Loss: 3.461 Test Acc: 0.226
Validation loss decreased (-0.210554 --> -0.225848).  Saving model ...
Epoch: 41 cost time: 1.6373505592346191
Epoch: 41, Steps: 10 | Train Loss: 0.565 Vali Loss: 3.498 Vali Acc: 0.219 Test Loss: 3.498 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5409700870513916
Epoch: 42, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.536 Vali Acc: 0.220 Test Loss: 3.536 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.686539649963379
Epoch: 43, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.542 Vali Acc: 0.232 Test Loss: 3.542 Test Acc: 0.232
Validation loss decreased (-0.225848 --> -0.231729).  Saving model ...
Epoch: 44 cost time: 1.298736333847046
Epoch: 44, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.544 Vali Acc: 0.224 Test Loss: 3.544 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.4664983749389648
Epoch: 45, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.549 Vali Acc: 0.241 Test Loss: 3.549 Test Acc: 0.241
Validation loss decreased (-0.231729 --> -0.241141).  Saving model ...
Epoch: 46 cost time: 1.5786850452423096
Epoch: 46, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.617 Vali Acc: 0.232 Test Loss: 3.617 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4576900005340576
Epoch: 47, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.656 Vali Acc: 0.219 Test Loss: 3.656 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1802868843078613
Epoch: 48, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.650 Vali Acc: 0.232 Test Loss: 3.650 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2866408824920654
Epoch: 49, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.798 Vali Acc: 0.226 Test Loss: 3.798 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.254258394241333
Epoch: 50, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.758 Vali Acc: 0.235 Test Loss: 3.758 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.4294462203979492
Epoch: 51, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.730 Vali Acc: 0.234 Test Loss: 3.730 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.5808701515197754
Epoch: 52, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.738 Vali Acc: 0.238 Test Loss: 3.738 Test Acc: 0.238
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.5316941738128662
Epoch: 53, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.835 Vali Acc: 0.228 Test Loss: 3.835 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.5606157779693604
Epoch: 54, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.813 Vali Acc: 0.227 Test Loss: 3.813 Test Acc: 0.227
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.4492645263671875
Epoch: 55, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.854 Vali Acc: 0.231 Test Loss: 3.854 Test Acc: 0.231
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2411764705882353
model parameter : 150462
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.497478723526001
Epoch: 1, Steps: 10 | Train Loss: 3.510 Vali Loss: 3.348 Vali Acc: 0.040 Test Loss: 3.348 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.4080138206481934
Epoch: 2, Steps: 10 | Train Loss: 3.378 Vali Loss: 3.295 Vali Acc: 0.039 Test Loss: 3.295 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3013050556182861
Epoch: 3, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.280 Vali Acc: 0.045 Test Loss: 3.280 Test Acc: 0.045
Validation loss decreased (-0.039967 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 2.0901992321014404
Epoch: 4, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.305 Vali Acc: 0.047 Test Loss: 3.305 Test Acc: 0.047
Validation loss decreased (-0.044673 --> -0.047026).  Saving model ...
Epoch: 5 cost time: 1.3376829624176025
Epoch: 5, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.322 Vali Acc: 0.048 Test Loss: 3.322 Test Acc: 0.048
Validation loss decreased (-0.047026 --> -0.048202).  Saving model ...
Epoch: 6 cost time: 1.7242774963378906
Epoch: 6, Steps: 10 | Train Loss: 3.152 Vali Loss: 3.313 Vali Acc: 0.055 Test Loss: 3.313 Test Acc: 0.055
Validation loss decreased (-0.048202 --> -0.055261).  Saving model ...
Epoch: 7 cost time: 1.5286507606506348
Epoch: 7, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.302 Vali Acc: 0.058 Test Loss: 3.302 Test Acc: 0.058
Validation loss decreased (-0.055261 --> -0.057614).  Saving model ...
Epoch: 8 cost time: 1.7099363803863525
Epoch: 8, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.299 Vali Acc: 0.060 Test Loss: 3.299 Test Acc: 0.060
Validation loss decreased (-0.057614 --> -0.059967).  Saving model ...
Epoch: 9 cost time: 1.6700787544250488
Epoch: 9, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.300 Vali Acc: 0.064 Test Loss: 3.300 Test Acc: 0.064
Validation loss decreased (-0.059967 --> -0.063496).  Saving model ...
Epoch: 10 cost time: 1.888516902923584
Epoch: 10, Steps: 10 | Train Loss: 3.003 Vali Loss: 3.291 Vali Acc: 0.065 Test Loss: 3.291 Test Acc: 0.065
Validation loss decreased (-0.063496 --> -0.064673).  Saving model ...
Epoch: 11 cost time: 1.388340711593628
Epoch: 11, Steps: 10 | Train Loss: 2.959 Vali Loss: 3.259 Vali Acc: 0.066 Test Loss: 3.259 Test Acc: 0.066
Validation loss decreased (-0.064673 --> -0.065850).  Saving model ...
Epoch: 12 cost time: 1.397871494293213
Epoch: 12, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.265 Vali Acc: 0.071 Test Loss: 3.265 Test Acc: 0.071
Validation loss decreased (-0.065850 --> -0.070556).  Saving model ...
Epoch: 13 cost time: 1.4023675918579102
Epoch: 13, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.268 Vali Acc: 0.071 Test Loss: 3.268 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4451408386230469
Epoch: 14, Steps: 10 | Train Loss: 2.777 Vali Loss: 3.251 Vali Acc: 0.104 Test Loss: 3.251 Test Acc: 0.104
Validation loss decreased (-0.070556 --> -0.103497).  Saving model ...
Epoch: 15 cost time: 1.3720555305480957
Epoch: 15, Steps: 10 | Train Loss: 2.700 Vali Loss: 3.239 Vali Acc: 0.105 Test Loss: 3.239 Test Acc: 0.105
Validation loss decreased (-0.103497 --> -0.104673).  Saving model ...
Epoch: 16 cost time: 1.2167034149169922
Epoch: 16, Steps: 10 | Train Loss: 2.588 Vali Loss: 3.242 Vali Acc: 0.108 Test Loss: 3.242 Test Acc: 0.108
Validation loss decreased (-0.104673 --> -0.108203).  Saving model ...
Epoch: 17 cost time: 1.58066987991333
Epoch: 17, Steps: 10 | Train Loss: 2.551 Vali Loss: 3.230 Vali Acc: 0.115 Test Loss: 3.230 Test Acc: 0.115
Validation loss decreased (-0.108203 --> -0.115262).  Saving model ...
Epoch: 18 cost time: 1.5490915775299072
Epoch: 18, Steps: 10 | Train Loss: 2.481 Vali Loss: 3.233 Vali Acc: 0.101 Test Loss: 3.233 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3425133228302002
Epoch: 19, Steps: 10 | Train Loss: 2.365 Vali Loss: 3.229 Vali Acc: 0.118 Test Loss: 3.229 Test Acc: 0.118
Validation loss decreased (-0.115262 --> -0.117615).  Saving model ...
Epoch: 20 cost time: 1.6791157722473145
Epoch: 20, Steps: 10 | Train Loss: 2.298 Vali Loss: 3.230 Vali Acc: 0.129 Test Loss: 3.230 Test Acc: 0.129
Validation loss decreased (-0.117615 --> -0.129379).  Saving model ...
Epoch: 21 cost time: 1.4873299598693848
Epoch: 21, Steps: 10 | Train Loss: 2.210 Vali Loss: 3.229 Vali Acc: 0.122 Test Loss: 3.229 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3383855819702148
Epoch: 22, Steps: 10 | Train Loss: 2.105 Vali Loss: 3.246 Vali Acc: 0.141 Test Loss: 3.246 Test Acc: 0.141
Validation loss decreased (-0.129379 --> -0.141144).  Saving model ...
Epoch: 23 cost time: 1.1021642684936523
Epoch: 23, Steps: 10 | Train Loss: 2.009 Vali Loss: 3.264 Vali Acc: 0.136 Test Loss: 3.264 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1996872425079346
Epoch: 24, Steps: 10 | Train Loss: 1.868 Vali Loss: 3.267 Vali Acc: 0.138 Test Loss: 3.267 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.263319730758667
Epoch: 25, Steps: 10 | Train Loss: 1.801 Vali Loss: 3.250 Vali Acc: 0.155 Test Loss: 3.250 Test Acc: 0.155
Validation loss decreased (-0.141144 --> -0.155262).  Saving model ...
Epoch: 26 cost time: 1.2815794944763184
Epoch: 26, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.284 Vali Acc: 0.145 Test Loss: 3.284 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2311327457427979
Epoch: 27, Steps: 10 | Train Loss: 1.639 Vali Loss: 3.287 Vali Acc: 0.149 Test Loss: 3.287 Test Acc: 0.149
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4537456035614014
Epoch: 28, Steps: 10 | Train Loss: 1.559 Vali Loss: 3.298 Vali Acc: 0.174 Test Loss: 3.298 Test Acc: 0.174
Validation loss decreased (-0.155262 --> -0.174085).  Saving model ...
Epoch: 29 cost time: 1.7086522579193115
Epoch: 29, Steps: 10 | Train Loss: 1.460 Vali Loss: 3.315 Vali Acc: 0.169 Test Loss: 3.315 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5004081726074219
Epoch: 30, Steps: 10 | Train Loss: 1.414 Vali Loss: 3.348 Vali Acc: 0.159 Test Loss: 3.348 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6292684078216553
Epoch: 31, Steps: 10 | Train Loss: 1.271 Vali Loss: 3.349 Vali Acc: 0.178 Test Loss: 3.349 Test Acc: 0.178
Validation loss decreased (-0.174085 --> -0.177614).  Saving model ...
Epoch: 32 cost time: 1.4297268390655518
Epoch: 32, Steps: 10 | Train Loss: 1.223 Vali Loss: 3.359 Vali Acc: 0.182 Test Loss: 3.359 Test Acc: 0.182
Validation loss decreased (-0.177614 --> -0.182319).  Saving model ...
Epoch: 33 cost time: 1.2545640468597412
Epoch: 33, Steps: 10 | Train Loss: 1.139 Vali Loss: 3.383 Vali Acc: 0.172 Test Loss: 3.383 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2229187488555908
Epoch: 34, Steps: 10 | Train Loss: 1.056 Vali Loss: 3.419 Vali Acc: 0.172 Test Loss: 3.419 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.300520658493042
Epoch: 35, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.415 Vali Acc: 0.179 Test Loss: 3.415 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2868971824645996
Epoch: 36, Steps: 10 | Train Loss: 0.930 Vali Loss: 3.454 Vali Acc: 0.180 Test Loss: 3.454 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.33927321434021
Epoch: 37, Steps: 10 | Train Loss: 0.916 Vali Loss: 3.470 Vali Acc: 0.185 Test Loss: 3.470 Test Acc: 0.185
Validation loss decreased (-0.182319 --> -0.184671).  Saving model ...
Epoch: 38 cost time: 1.2644927501678467
Epoch: 38, Steps: 10 | Train Loss: 0.801 Vali Loss: 3.472 Vali Acc: 0.188 Test Loss: 3.472 Test Acc: 0.188
Validation loss decreased (-0.184671 --> -0.188201).  Saving model ...
Epoch: 39 cost time: 1.1455397605895996
Epoch: 39, Steps: 10 | Train Loss: 0.777 Vali Loss: 3.477 Vali Acc: 0.201 Test Loss: 3.477 Test Acc: 0.201
Validation loss decreased (-0.188201 --> -0.201142).  Saving model ...
Epoch: 40 cost time: 1.5177671909332275
Epoch: 40, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.525 Vali Acc: 0.192 Test Loss: 3.525 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.8439946174621582
Epoch: 41, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.562 Vali Acc: 0.178 Test Loss: 3.562 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3567829132080078
Epoch: 42, Steps: 10 | Train Loss: 0.574 Vali Loss: 3.578 Vali Acc: 0.192 Test Loss: 3.578 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.601966381072998
Epoch: 43, Steps: 10 | Train Loss: 0.547 Vali Loss: 3.577 Vali Acc: 0.192 Test Loss: 3.577 Test Acc: 0.192
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.3594536781311035
Epoch: 44, Steps: 10 | Train Loss: 0.455 Vali Loss: 3.627 Vali Acc: 0.198 Test Loss: 3.627 Test Acc: 0.198
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.9019854068756104
Epoch: 45, Steps: 10 | Train Loss: 0.465 Vali Loss: 3.659 Vali Acc: 0.188 Test Loss: 3.659 Test Acc: 0.188
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.534372091293335
Epoch: 46, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.659 Vali Acc: 0.195 Test Loss: 3.659 Test Acc: 0.195
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.3788731098175049
Epoch: 47, Steps: 10 | Train Loss: 0.314 Vali Loss: 3.685 Vali Acc: 0.201 Test Loss: 3.685 Test Acc: 0.201
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.3746592998504639
Epoch: 48, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.723 Vali Acc: 0.206 Test Loss: 3.723 Test Acc: 0.206
Validation loss decreased (-0.201142 --> -0.205845).  Saving model ...
Epoch: 49 cost time: 1.3825609683990479
Epoch: 49, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.765 Vali Acc: 0.193 Test Loss: 3.765 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.7242963314056396
Epoch: 50, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.734 Vali Acc: 0.208 Test Loss: 3.734 Test Acc: 0.208
Validation loss decreased (-0.205845 --> -0.208198).  Saving model ...
Epoch: 51 cost time: 1.8011720180511475
Epoch: 51, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.757 Vali Acc: 0.212 Test Loss: 3.757 Test Acc: 0.212
Validation loss decreased (-0.208198 --> -0.211727).  Saving model ...
Epoch: 52 cost time: 1.8709743022918701
Epoch: 52, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.809 Vali Acc: 0.202 Test Loss: 3.809 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.4820506572723389
Epoch: 53, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.829 Vali Acc: 0.201 Test Loss: 3.829 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.6544430255889893
Epoch: 54, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.842 Vali Acc: 0.195 Test Loss: 3.842 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.4519453048706055
Epoch: 55, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.881 Vali Acc: 0.194 Test Loss: 3.881 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.3047544956207275
Epoch: 56, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.874 Vali Acc: 0.207 Test Loss: 3.874 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.330049753189087
Epoch: 57, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.908 Vali Acc: 0.209 Test Loss: 3.908 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.5329806804656982
Epoch: 58, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.926 Vali Acc: 0.214 Test Loss: 3.926 Test Acc: 0.214
Validation loss decreased (-0.211727 --> -0.214078).  Saving model ...
Epoch: 59 cost time: 1.4090466499328613
Epoch: 59, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.940 Vali Acc: 0.199 Test Loss: 3.940 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.2762928009033203
Epoch: 60, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.937 Vali Acc: 0.202 Test Loss: 3.937 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.4540073871612549
Epoch: 61, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.987 Vali Acc: 0.200 Test Loss: 3.987 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.637258768081665
Epoch: 62, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.977 Vali Acc: 0.206 Test Loss: 3.977 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.3459062576293945
Epoch: 63, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.028 Vali Acc: 0.209 Test Loss: 4.028 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.3063633441925049
Epoch: 64, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.020 Vali Acc: 0.202 Test Loss: 4.020 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.7498564720153809
Epoch: 65, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.022 Vali Acc: 0.214 Test Loss: 4.022 Test Acc: 0.214
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.525115728378296
Epoch: 66, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.053 Vali Acc: 0.207 Test Loss: 4.053 Test Acc: 0.207
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.3513925075531006
Epoch: 67, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.067 Vali Acc: 0.209 Test Loss: 4.067 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.515550136566162
Epoch: 68, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.068 Vali Acc: 0.214 Test Loss: 4.068 Test Acc: 0.214
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21411764705882352
model parameter : 149822
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.9059877395629883
Epoch: 1, Steps: 10 | Train Loss: 3.466 Vali Loss: 3.417 Vali Acc: 0.036 Test Loss: 3.417 Test Acc: 0.036
Validation loss decreased (inf --> -0.036436).  Saving model ...
Epoch: 2 cost time: 1.786219835281372
Epoch: 2, Steps: 10 | Train Loss: 3.437 Vali Loss: 3.359 Vali Acc: 0.036 Test Loss: 3.359 Test Acc: 0.036
Validation loss decreased (-0.036436 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 1.9246151447296143
Epoch: 3, Steps: 10 | Train Loss: 3.310 Vali Loss: 3.328 Vali Acc: 0.033 Test Loss: 3.328 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8731977939605713
Epoch: 4, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.328 Vali Acc: 0.051 Test Loss: 3.328 Test Acc: 0.051
Validation loss decreased (-0.036437 --> -0.050555).  Saving model ...
Epoch: 5 cost time: 1.6339747905731201
Epoch: 5, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.342 Vali Acc: 0.049 Test Loss: 3.342 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.049116849899292
Epoch: 6, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.334 Vali Acc: 0.051 Test Loss: 3.334 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.456754207611084
Epoch: 7, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.334 Vali Acc: 0.056 Test Loss: 3.334 Test Acc: 0.056
Validation loss decreased (-0.050555 --> -0.056437).  Saving model ...
Epoch: 8 cost time: 1.8068444728851318
Epoch: 8, Steps: 10 | Train Loss: 3.085 Vali Loss: 3.332 Vali Acc: 0.056 Test Loss: 3.332 Test Acc: 0.056
Validation loss decreased (-0.056437 --> -0.056437).  Saving model ...
Epoch: 9 cost time: 1.5117454528808594
Epoch: 9, Steps: 10 | Train Loss: 3.053 Vali Loss: 3.323 Vali Acc: 0.064 Test Loss: 3.323 Test Acc: 0.064
Validation loss decreased (-0.056437 --> -0.063496).  Saving model ...
Epoch: 10 cost time: 2.0109691619873047
Epoch: 10, Steps: 10 | Train Loss: 3.002 Vali Loss: 3.313 Vali Acc: 0.067 Test Loss: 3.313 Test Acc: 0.067
Validation loss decreased (-0.063496 --> -0.067026).  Saving model ...
Epoch: 11 cost time: 1.6083362102508545
Epoch: 11, Steps: 10 | Train Loss: 2.974 Vali Loss: 3.293 Vali Acc: 0.075 Test Loss: 3.293 Test Acc: 0.075
Validation loss decreased (-0.067026 --> -0.075261).  Saving model ...
Epoch: 12 cost time: 1.5330724716186523
Epoch: 12, Steps: 10 | Train Loss: 2.883 Vali Loss: 3.296 Vali Acc: 0.091 Test Loss: 3.296 Test Acc: 0.091
Validation loss decreased (-0.075261 --> -0.090555).  Saving model ...
Epoch: 13 cost time: 1.686039686203003
Epoch: 13, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.291 Vali Acc: 0.095 Test Loss: 3.291 Test Acc: 0.095
Validation loss decreased (-0.090555 --> -0.095261).  Saving model ...
Epoch: 14 cost time: 1.922720193862915
Epoch: 14, Steps: 10 | Train Loss: 2.787 Vali Loss: 3.256 Vali Acc: 0.080 Test Loss: 3.256 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9455273151397705
Epoch: 15, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.246 Vali Acc: 0.101 Test Loss: 3.246 Test Acc: 0.101
Validation loss decreased (-0.095261 --> -0.101144).  Saving model ...
Epoch: 16 cost time: 1.4546189308166504
Epoch: 16, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.250 Vali Acc: 0.102 Test Loss: 3.250 Test Acc: 0.102
Validation loss decreased (-0.101144 --> -0.102320).  Saving model ...
Epoch: 17 cost time: 1.667679786682129
Epoch: 17, Steps: 10 | Train Loss: 2.515 Vali Loss: 3.264 Vali Acc: 0.106 Test Loss: 3.264 Test Acc: 0.106
Validation loss decreased (-0.102320 --> -0.105850).  Saving model ...
Epoch: 18 cost time: 1.4286746978759766
Epoch: 18, Steps: 10 | Train Loss: 2.476 Vali Loss: 3.248 Vali Acc: 0.124 Test Loss: 3.248 Test Acc: 0.124
Validation loss decreased (-0.105850 --> -0.123497).  Saving model ...
Epoch: 19 cost time: 1.5720515251159668
Epoch: 19, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.238 Vali Acc: 0.128 Test Loss: 3.238 Test Acc: 0.128
Validation loss decreased (-0.123497 --> -0.128203).  Saving model ...
Epoch: 20 cost time: 1.817058801651001
Epoch: 20, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.243 Vali Acc: 0.109 Test Loss: 3.243 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7644152641296387
Epoch: 21, Steps: 10 | Train Loss: 2.156 Vali Loss: 3.232 Vali Acc: 0.129 Test Loss: 3.232 Test Acc: 0.129
Validation loss decreased (-0.128203 --> -0.129379).  Saving model ...
Epoch: 22 cost time: 1.770604133605957
Epoch: 22, Steps: 10 | Train Loss: 2.104 Vali Loss: 3.235 Vali Acc: 0.145 Test Loss: 3.235 Test Acc: 0.145
Validation loss decreased (-0.129379 --> -0.144674).  Saving model ...
Epoch: 23 cost time: 1.9248247146606445
Epoch: 23, Steps: 10 | Train Loss: 1.989 Vali Loss: 3.244 Vali Acc: 0.155 Test Loss: 3.244 Test Acc: 0.155
Validation loss decreased (-0.144674 --> -0.155262).  Saving model ...
Epoch: 24 cost time: 1.4768455028533936
Epoch: 24, Steps: 10 | Train Loss: 1.862 Vali Loss: 3.236 Vali Acc: 0.148 Test Loss: 3.236 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1400129795074463
Epoch: 25, Steps: 10 | Train Loss: 1.800 Vali Loss: 3.248 Vali Acc: 0.158 Test Loss: 3.248 Test Acc: 0.158
Validation loss decreased (-0.155262 --> -0.157615).  Saving model ...
Epoch: 26 cost time: 2.241809606552124
Epoch: 26, Steps: 10 | Train Loss: 1.707 Vali Loss: 3.245 Vali Acc: 0.162 Test Loss: 3.245 Test Acc: 0.162
Validation loss decreased (-0.157615 --> -0.162320).  Saving model ...
Epoch: 27 cost time: 1.229707956314087
Epoch: 27, Steps: 10 | Train Loss: 1.642 Vali Loss: 3.245 Vali Acc: 0.173 Test Loss: 3.245 Test Acc: 0.173
Validation loss decreased (-0.162320 --> -0.172909).  Saving model ...
Epoch: 28 cost time: 1.8127923011779785
Epoch: 28, Steps: 10 | Train Loss: 1.578 Vali Loss: 3.262 Vali Acc: 0.182 Test Loss: 3.262 Test Acc: 0.182
Validation loss decreased (-0.172909 --> -0.182320).  Saving model ...
Epoch: 29 cost time: 2.2775988578796387
Epoch: 29, Steps: 10 | Train Loss: 1.423 Vali Loss: 3.268 Vali Acc: 0.182 Test Loss: 3.268 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.374136209487915
Epoch: 30, Steps: 10 | Train Loss: 1.346 Vali Loss: 3.276 Vali Acc: 0.184 Test Loss: 3.276 Test Acc: 0.184
Validation loss decreased (-0.182320 --> -0.183497).  Saving model ...
Epoch: 31 cost time: 1.382629632949829
Epoch: 31, Steps: 10 | Train Loss: 1.237 Vali Loss: 3.282 Vali Acc: 0.194 Test Loss: 3.282 Test Acc: 0.194
Validation loss decreased (-0.183497 --> -0.194085).  Saving model ...
Epoch: 32 cost time: 1.8053321838378906
Epoch: 32, Steps: 10 | Train Loss: 1.104 Vali Loss: 3.306 Vali Acc: 0.191 Test Loss: 3.306 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.1002016067504883
Epoch: 33, Steps: 10 | Train Loss: 1.095 Vali Loss: 3.305 Vali Acc: 0.205 Test Loss: 3.305 Test Acc: 0.205
Validation loss decreased (-0.194085 --> -0.204673).  Saving model ...
Epoch: 34 cost time: 1.5442559719085693
Epoch: 34, Steps: 10 | Train Loss: 1.002 Vali Loss: 3.304 Vali Acc: 0.199 Test Loss: 3.304 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6576223373413086
Epoch: 35, Steps: 10 | Train Loss: 0.885 Vali Loss: 3.360 Vali Acc: 0.202 Test Loss: 3.360 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6823053359985352
Epoch: 36, Steps: 10 | Train Loss: 0.824 Vali Loss: 3.351 Vali Acc: 0.204 Test Loss: 3.351 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.5974018573760986
Epoch: 37, Steps: 10 | Train Loss: 0.790 Vali Loss: 3.337 Vali Acc: 0.219 Test Loss: 3.337 Test Acc: 0.219
Validation loss decreased (-0.204673 --> -0.218790).  Saving model ...
Epoch: 38 cost time: 1.371227502822876
Epoch: 38, Steps: 10 | Train Loss: 0.731 Vali Loss: 3.394 Vali Acc: 0.222 Test Loss: 3.394 Test Acc: 0.222
Validation loss decreased (-0.218790 --> -0.222319).  Saving model ...
Epoch: 39 cost time: 1.4862682819366455
Epoch: 39, Steps: 10 | Train Loss: 0.624 Vali Loss: 3.410 Vali Acc: 0.221 Test Loss: 3.410 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9466207027435303
Epoch: 40, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.392 Vali Acc: 0.226 Test Loss: 3.392 Test Acc: 0.226
Validation loss decreased (-0.222319 --> -0.225848).  Saving model ...
Epoch: 41 cost time: 1.685016393661499
Epoch: 41, Steps: 10 | Train Loss: 0.517 Vali Loss: 3.422 Vali Acc: 0.224 Test Loss: 3.422 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6716153621673584
Epoch: 42, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.511 Vali Acc: 0.209 Test Loss: 3.511 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.5526041984558105
Epoch: 43, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.492 Vali Acc: 0.239 Test Loss: 3.492 Test Acc: 0.239
Validation loss decreased (-0.225848 --> -0.238789).  Saving model ...
Epoch: 44 cost time: 1.4913816452026367
Epoch: 44, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.575 Vali Acc: 0.213 Test Loss: 3.575 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.4383995532989502
Epoch: 45, Steps: 10 | Train Loss: 0.374 Vali Loss: 3.566 Vali Acc: 0.219 Test Loss: 3.566 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.5800793170928955
Epoch: 46, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.582 Vali Acc: 0.229 Test Loss: 3.582 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.8516297340393066
Epoch: 47, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.565 Vali Acc: 0.240 Test Loss: 3.565 Test Acc: 0.240
Validation loss decreased (-0.238789 --> -0.239964).  Saving model ...
Epoch: 48 cost time: 1.7057018280029297
Epoch: 48, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.631 Vali Acc: 0.218 Test Loss: 3.631 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.9164133071899414
Epoch: 49, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.638 Vali Acc: 0.236 Test Loss: 3.638 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.046130895614624
Epoch: 50, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.659 Vali Acc: 0.242 Test Loss: 3.659 Test Acc: 0.242
Validation loss decreased (-0.239964 --> -0.242316).  Saving model ...
Epoch: 51 cost time: 1.81156325340271
Epoch: 51, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.699 Vali Acc: 0.235 Test Loss: 3.699 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.3535943031311035
Epoch: 52, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.720 Vali Acc: 0.245 Test Loss: 3.720 Test Acc: 0.245
Validation loss decreased (-0.242316 --> -0.244669).  Saving model ...
Epoch: 53 cost time: 1.6544556617736816
Epoch: 53, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.776 Vali Acc: 0.238 Test Loss: 3.776 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.5315015316009521
Epoch: 54, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.711 Vali Acc: 0.241 Test Loss: 3.711 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.131922960281372
Epoch: 55, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.797 Vali Acc: 0.247 Test Loss: 3.797 Test Acc: 0.247
Validation loss decreased (-0.244669 --> -0.247021).  Saving model ...
Epoch: 56 cost time: 1.822420597076416
Epoch: 56, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.769 Vali Acc: 0.253 Test Loss: 3.769 Test Acc: 0.253
Validation loss decreased (-0.247021 --> -0.252903).  Saving model ...
Epoch: 57 cost time: 1.49186372756958
Epoch: 57, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.823 Vali Acc: 0.253 Test Loss: 3.823 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.5329573154449463
Epoch: 58, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.861 Vali Acc: 0.252 Test Loss: 3.861 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.9346532821655273
Epoch: 59, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.869 Vali Acc: 0.242 Test Loss: 3.869 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.8483729362487793
Epoch: 60, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.858 Vali Acc: 0.258 Test Loss: 3.858 Test Acc: 0.258
Validation loss decreased (-0.252903 --> -0.257608).  Saving model ...
Epoch: 61 cost time: 2.096104383468628
Epoch: 61, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.857 Vali Acc: 0.254 Test Loss: 3.857 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.9523406028747559
Epoch: 62, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.879 Vali Acc: 0.247 Test Loss: 3.879 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.7017226219177246
Epoch: 63, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.932 Vali Acc: 0.254 Test Loss: 3.932 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.6403260231018066
Epoch: 64, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.992 Vali Acc: 0.256 Test Loss: 3.992 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.5601661205291748
Epoch: 65, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.984 Vali Acc: 0.259 Test Loss: 3.984 Test Acc: 0.259
Validation loss decreased (-0.257608 --> -0.258784).  Saving model ...
Epoch: 66 cost time: 1.6926875114440918
Epoch: 66, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.998 Vali Acc: 0.248 Test Loss: 3.998 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.6412353515625
Epoch: 67, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.994 Vali Acc: 0.258 Test Loss: 3.994 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.8435642719268799
Epoch: 68, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.020 Vali Acc: 0.262 Test Loss: 4.020 Test Acc: 0.262
Validation loss decreased (-0.258784 --> -0.262313).  Saving model ...
Epoch: 69 cost time: 1.6339881420135498
Epoch: 69, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.008 Vali Acc: 0.255 Test Loss: 4.008 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.3002431392669678
Epoch: 70, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.051 Vali Acc: 0.245 Test Loss: 4.051 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.7286159992218018
Epoch: 71, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.103 Vali Acc: 0.247 Test Loss: 4.103 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.7084887027740479
Epoch: 72, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.078 Vali Acc: 0.252 Test Loss: 4.078 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.7765283584594727
Epoch: 73, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.098 Vali Acc: 0.266 Test Loss: 4.098 Test Acc: 0.266
Validation loss decreased (-0.262313 --> -0.265841).  Saving model ...
Epoch: 74 cost time: 1.2855145931243896
Epoch: 74, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.122 Vali Acc: 0.246 Test Loss: 4.122 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.521064043045044
Epoch: 75, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.156 Vali Acc: 0.260 Test Loss: 4.156 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.6248722076416016
Epoch: 76, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.138 Vali Acc: 0.259 Test Loss: 4.138 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.9250328540802002
Epoch: 77, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.133 Vali Acc: 0.266 Test Loss: 4.133 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 2.5328149795532227
Epoch: 78, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.168 Vali Acc: 0.256 Test Loss: 4.168 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.5940191745758057
Epoch: 79, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.176 Vali Acc: 0.258 Test Loss: 4.176 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.3575031757354736
Epoch: 80, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.157 Vali Acc: 0.261 Test Loss: 4.157 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.559973955154419
Epoch: 81, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.187 Vali Acc: 0.254 Test Loss: 4.187 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.7572731971740723
Epoch: 82, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.209 Vali Acc: 0.256 Test Loss: 4.209 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.5129961967468262
Epoch: 83, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.231 Vali Acc: 0.252 Test Loss: 4.231 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 149182
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4750890731811523
Epoch: 1, Steps: 10 | Train Loss: 3.382 Vali Loss: 3.336 Vali Acc: 0.036 Test Loss: 3.336 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.2158825397491455
Epoch: 2, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.491 Vali Acc: 0.053 Test Loss: 3.491 Test Acc: 0.053
Validation loss decreased (-0.036437 --> -0.052906).  Saving model ...
Epoch: 3 cost time: 1.180286169052124
Epoch: 3, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.323 Vali Acc: 0.074 Test Loss: 3.323 Test Acc: 0.074
Validation loss decreased (-0.052906 --> -0.074084).  Saving model ...
Epoch: 4 cost time: 1.7094652652740479
Epoch: 4, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.337 Vali Acc: 0.095 Test Loss: 3.337 Test Acc: 0.095
Validation loss decreased (-0.074084 --> -0.095261).  Saving model ...
Epoch: 5 cost time: 1.0877187252044678
Epoch: 5, Steps: 10 | Train Loss: 2.535 Vali Loss: 3.286 Vali Acc: 0.121 Test Loss: 3.286 Test Acc: 0.121
Validation loss decreased (-0.095261 --> -0.121144).  Saving model ...
Epoch: 6 cost time: 1.1107902526855469
Epoch: 6, Steps: 10 | Train Loss: 2.288 Vali Loss: 3.303 Vali Acc: 0.132 Test Loss: 3.303 Test Acc: 0.132
Validation loss decreased (-0.121144 --> -0.131732).  Saving model ...
Epoch: 7 cost time: 1.1805601119995117
Epoch: 7, Steps: 10 | Train Loss: 1.937 Vali Loss: 3.290 Vali Acc: 0.174 Test Loss: 3.290 Test Acc: 0.174
Validation loss decreased (-0.131732 --> -0.174085).  Saving model ...
Epoch: 8 cost time: 1.2387990951538086
Epoch: 8, Steps: 10 | Train Loss: 1.683 Vali Loss: 3.488 Vali Acc: 0.155 Test Loss: 3.488 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1690952777862549
Epoch: 9, Steps: 10 | Train Loss: 1.414 Vali Loss: 3.433 Vali Acc: 0.192 Test Loss: 3.433 Test Acc: 0.192
Validation loss decreased (-0.174085 --> -0.191730).  Saving model ...
Epoch: 10 cost time: 1.1649250984191895
Epoch: 10, Steps: 10 | Train Loss: 1.097 Vali Loss: 3.761 Vali Acc: 0.182 Test Loss: 3.761 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6626214981079102
Epoch: 11, Steps: 10 | Train Loss: 0.977 Vali Loss: 3.760 Vali Acc: 0.206 Test Loss: 3.760 Test Acc: 0.206
Validation loss decreased (-0.191730 --> -0.205845).  Saving model ...
Epoch: 12 cost time: 1.1889417171478271
Epoch: 12, Steps: 10 | Train Loss: 0.720 Vali Loss: 4.017 Vali Acc: 0.199 Test Loss: 4.017 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.294546365737915
Epoch: 13, Steps: 10 | Train Loss: 0.602 Vali Loss: 4.128 Vali Acc: 0.208 Test Loss: 4.128 Test Acc: 0.208
Validation loss decreased (-0.205845 --> -0.208194).  Saving model ...
Epoch: 14 cost time: 1.3428800106048584
Epoch: 14, Steps: 10 | Train Loss: 0.396 Vali Loss: 4.363 Vali Acc: 0.205 Test Loss: 4.363 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0199573040008545
Epoch: 15, Steps: 10 | Train Loss: 0.432 Vali Loss: 4.466 Vali Acc: 0.233 Test Loss: 4.466 Test Acc: 0.233
Validation loss decreased (-0.208194 --> -0.232897).  Saving model ...
Epoch: 16 cost time: 1.224668025970459
Epoch: 16, Steps: 10 | Train Loss: 0.202 Vali Loss: 4.507 Vali Acc: 0.215 Test Loss: 4.507 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.405334234237671
Epoch: 17, Steps: 10 | Train Loss: 0.121 Vali Loss: 4.633 Vali Acc: 0.225 Test Loss: 4.633 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4709010124206543
Epoch: 18, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.966 Vali Acc: 0.219 Test Loss: 4.966 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3322274684906006
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.925 Vali Acc: 0.245 Test Loss: 4.925 Test Acc: 0.245
Validation loss decreased (-0.232897 --> -0.244657).  Saving model ...
Epoch: 20 cost time: 1.042236089706421
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.994 Vali Acc: 0.232 Test Loss: 4.994 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1360490322113037
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.349 Vali Acc: 0.206 Test Loss: 5.349 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1425490379333496
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 5.427 Vali Acc: 0.225 Test Loss: 5.427 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.229313611984253
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.447 Vali Acc: 0.224 Test Loss: 5.447 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.614300012588501
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.448 Vali Acc: 0.241 Test Loss: 5.448 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.551934003829956
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.469 Vali Acc: 0.246 Test Loss: 5.469 Test Acc: 0.246
Validation loss decreased (-0.244657 --> -0.245828).  Saving model ...
Epoch: 26 cost time: 1.5613083839416504
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.494 Vali Acc: 0.253 Test Loss: 5.494 Test Acc: 0.253
Validation loss decreased (-0.245828 --> -0.252886).  Saving model ...
Epoch: 27 cost time: 1.2238941192626953
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.460 Vali Acc: 0.255 Test Loss: 5.460 Test Acc: 0.255
Validation loss decreased (-0.252886 --> -0.255240).  Saving model ...
Epoch: 28 cost time: 1.4355189800262451
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.428 Vali Acc: 0.254 Test Loss: 5.428 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.376889705657959
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.411 Vali Acc: 0.256 Test Loss: 5.411 Test Acc: 0.256
Validation loss decreased (-0.255240 --> -0.256416).  Saving model ...
Epoch: 30 cost time: 1.335383415222168
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.413 Vali Acc: 0.253 Test Loss: 5.413 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.147993564605713
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.429 Vali Acc: 0.254 Test Loss: 5.429 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5290522575378418
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.447 Vali Acc: 0.249 Test Loss: 5.447 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.309950590133667
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.455 Vali Acc: 0.251 Test Loss: 5.455 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1924688816070557
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.458 Vali Acc: 0.253 Test Loss: 5.458 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2769718170166016
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.459 Vali Acc: 0.253 Test Loss: 5.459 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.038952350616455
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.470 Vali Acc: 0.252 Test Loss: 5.470 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.226811408996582
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.480 Vali Acc: 0.254 Test Loss: 5.480 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.5060839653015137
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.495 Vali Acc: 0.254 Test Loss: 5.495 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1959891319274902
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.505 Vali Acc: 0.253 Test Loss: 5.505 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 5036338
model size : 24.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.824406623840332
Epoch: 1, Steps: 10 | Train Loss: 3.422 Vali Loss: 3.340 Vali Acc: 0.036 Test Loss: 3.340 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.3290643692016602
Epoch: 2, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.524 Vali Acc: 0.047 Test Loss: 3.524 Test Acc: 0.047
Validation loss decreased (-0.036437 --> -0.047024).  Saving model ...
Epoch: 3 cost time: 1.2608742713928223
Epoch: 3, Steps: 10 | Train Loss: 3.018 Vali Loss: 3.323 Vali Acc: 0.073 Test Loss: 3.323 Test Acc: 0.073
Validation loss decreased (-0.047024 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 1.211435317993164
Epoch: 4, Steps: 10 | Train Loss: 2.776 Vali Loss: 3.278 Vali Acc: 0.113 Test Loss: 3.278 Test Acc: 0.113
Validation loss decreased (-0.072908 --> -0.112908).  Saving model ...
Epoch: 5 cost time: 1.3029735088348389
Epoch: 5, Steps: 10 | Train Loss: 2.500 Vali Loss: 3.250 Vali Acc: 0.106 Test Loss: 3.250 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3571386337280273
Epoch: 6, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.232 Vali Acc: 0.135 Test Loss: 3.232 Test Acc: 0.135
Validation loss decreased (-0.112908 --> -0.135262).  Saving model ...
Epoch: 7 cost time: 1.187932014465332
Epoch: 7, Steps: 10 | Train Loss: 1.868 Vali Loss: 3.305 Vali Acc: 0.153 Test Loss: 3.305 Test Acc: 0.153
Validation loss decreased (-0.135262 --> -0.152908).  Saving model ...
Epoch: 8 cost time: 1.3398196697235107
Epoch: 8, Steps: 10 | Train Loss: 1.619 Vali Loss: 3.336 Vali Acc: 0.164 Test Loss: 3.336 Test Acc: 0.164
Validation loss decreased (-0.152908 --> -0.163496).  Saving model ...
Epoch: 9 cost time: 1.0480499267578125
Epoch: 9, Steps: 10 | Train Loss: 1.346 Vali Loss: 3.436 Vali Acc: 0.191 Test Loss: 3.436 Test Acc: 0.191
Validation loss decreased (-0.163496 --> -0.190554).  Saving model ...
Epoch: 10 cost time: 0.946113109588623
Epoch: 10, Steps: 10 | Train Loss: 1.096 Vali Loss: 3.605 Vali Acc: 0.192 Test Loss: 3.605 Test Acc: 0.192
Validation loss decreased (-0.190554 --> -0.191729).  Saving model ...
Epoch: 11 cost time: 1.185927152633667
Epoch: 11, Steps: 10 | Train Loss: 0.852 Vali Loss: 3.665 Vali Acc: 0.215 Test Loss: 3.665 Test Acc: 0.215
Validation loss decreased (-0.191729 --> -0.215257).  Saving model ...
Epoch: 12 cost time: 1.0871403217315674
Epoch: 12, Steps: 10 | Train Loss: 0.616 Vali Loss: 3.852 Vali Acc: 0.218 Test Loss: 3.852 Test Acc: 0.218
Validation loss decreased (-0.215257 --> -0.217609).  Saving model ...
Epoch: 13 cost time: 1.6610603332519531
Epoch: 13, Steps: 10 | Train Loss: 0.449 Vali Loss: 4.061 Vali Acc: 0.221 Test Loss: 4.061 Test Acc: 0.221
Validation loss decreased (-0.217609 --> -0.221136).  Saving model ...
Epoch: 14 cost time: 1.099879264831543
Epoch: 14, Steps: 10 | Train Loss: 0.406 Vali Loss: 4.317 Vali Acc: 0.205 Test Loss: 4.317 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.36421537399292
Epoch: 15, Steps: 10 | Train Loss: 0.259 Vali Loss: 4.253 Vali Acc: 0.247 Test Loss: 4.253 Test Acc: 0.247
Validation loss decreased (-0.221136 --> -0.247016).  Saving model ...
Epoch: 16 cost time: 1.2644870281219482
Epoch: 16, Steps: 10 | Train Loss: 0.165 Vali Loss: 4.529 Vali Acc: 0.231 Test Loss: 4.529 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.466439962387085
Epoch: 17, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.606 Vali Acc: 0.249 Test Loss: 4.606 Test Acc: 0.249
Validation loss decreased (-0.247016 --> -0.249366).  Saving model ...
Epoch: 18 cost time: 1.1108384132385254
Epoch: 18, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.703 Vali Acc: 0.239 Test Loss: 4.703 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3806664943695068
Epoch: 19, Steps: 10 | Train Loss: 0.099 Vali Loss: 5.255 Vali Acc: 0.207 Test Loss: 5.255 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1897807121276855
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 5.150 Vali Acc: 0.219 Test Loss: 5.150 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2456815242767334
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 5.166 Vali Acc: 0.247 Test Loss: 5.166 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1395940780639648
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.235 Vali Acc: 0.249 Test Loss: 5.235 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.101149559020996
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 5.312 Vali Acc: 0.244 Test Loss: 5.312 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3197927474975586
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.332 Vali Acc: 0.239 Test Loss: 5.332 Test Acc: 0.239
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4471549987792969
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.191 Vali Acc: 0.247 Test Loss: 5.191 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3886659145355225
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.167 Vali Acc: 0.267 Test Loss: 5.167 Test Acc: 0.267
Validation loss decreased (-0.249366 --> -0.267007).  Saving model ...
Epoch: 27 cost time: 1.4480721950531006
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.206 Vali Acc: 0.255 Test Loss: 5.206 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.08455491065979
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.314 Vali Acc: 0.262 Test Loss: 5.314 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3181586265563965
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.276 Vali Acc: 0.267 Test Loss: 5.276 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2152717113494873
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.279 Vali Acc: 0.266 Test Loss: 5.279 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2365686893463135
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.276 Vali Acc: 0.262 Test Loss: 5.276 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3683977127075195
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.294 Vali Acc: 0.259 Test Loss: 5.294 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0963797569274902
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.316 Vali Acc: 0.259 Test Loss: 5.316 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5996384620666504
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.337 Vali Acc: 0.265 Test Loss: 5.337 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.815537929534912
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.354 Vali Acc: 0.261 Test Loss: 5.354 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.7007951736450195
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.369 Vali Acc: 0.256 Test Loss: 5.369 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 5033010
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.139919996261597
Epoch: 1, Steps: 10 | Train Loss: 3.373 Vali Loss: 3.354 Vali Acc: 0.053 Test Loss: 3.354 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 1.5161943435668945
Epoch: 2, Steps: 10 | Train Loss: 3.196 Vali Loss: 3.409 Vali Acc: 0.060 Test Loss: 3.409 Test Acc: 0.060
Validation loss decreased (-0.052908 --> -0.059966).  Saving model ...
Epoch: 3 cost time: 1.4191603660583496
Epoch: 3, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.308 Vali Acc: 0.065 Test Loss: 3.308 Test Acc: 0.065
Validation loss decreased (-0.059966 --> -0.064673).  Saving model ...
Epoch: 4 cost time: 0.8569059371948242
Epoch: 4, Steps: 10 | Train Loss: 2.832 Vali Loss: 3.247 Vali Acc: 0.108 Test Loss: 3.247 Test Acc: 0.108
Validation loss decreased (-0.064673 --> -0.108203).  Saving model ...
Epoch: 5 cost time: 1.3133118152618408
Epoch: 5, Steps: 10 | Train Loss: 2.551 Vali Loss: 3.303 Vali Acc: 0.136 Test Loss: 3.303 Test Acc: 0.136
Validation loss decreased (-0.108203 --> -0.136438).  Saving model ...
Epoch: 6 cost time: 1.3147375583648682
Epoch: 6, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.273 Vali Acc: 0.136 Test Loss: 3.273 Test Acc: 0.136
Validation loss decreased (-0.136438 --> -0.136438).  Saving model ...
Epoch: 7 cost time: 1.640136957168579
Epoch: 7, Steps: 10 | Train Loss: 2.030 Vali Loss: 3.343 Vali Acc: 0.159 Test Loss: 3.343 Test Acc: 0.159
Validation loss decreased (-0.136438 --> -0.158790).  Saving model ...
Epoch: 8 cost time: 1.4503462314605713
Epoch: 8, Steps: 10 | Train Loss: 1.748 Vali Loss: 3.394 Vali Acc: 0.168 Test Loss: 3.394 Test Acc: 0.168
Validation loss decreased (-0.158790 --> -0.168201).  Saving model ...
Epoch: 9 cost time: 1.465346336364746
Epoch: 9, Steps: 10 | Train Loss: 1.370 Vali Loss: 3.578 Vali Acc: 0.168 Test Loss: 3.578 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3527507781982422
Epoch: 10, Steps: 10 | Train Loss: 1.181 Vali Loss: 3.560 Vali Acc: 0.184 Test Loss: 3.560 Test Acc: 0.184
Validation loss decreased (-0.168201 --> -0.183494).  Saving model ...
Epoch: 11 cost time: 1.8979344367980957
Epoch: 11, Steps: 10 | Train Loss: 0.931 Vali Loss: 3.839 Vali Acc: 0.200 Test Loss: 3.839 Test Acc: 0.200
Validation loss decreased (-0.183494 --> -0.199962).  Saving model ...
Epoch: 12 cost time: 1.6857390403747559
Epoch: 12, Steps: 10 | Train Loss: 0.688 Vali Loss: 3.885 Vali Acc: 0.182 Test Loss: 3.885 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2793047428131104
Epoch: 13, Steps: 10 | Train Loss: 0.537 Vali Loss: 4.133 Vali Acc: 0.201 Test Loss: 4.133 Test Acc: 0.201
Validation loss decreased (-0.199962 --> -0.201135).  Saving model ...
Epoch: 14 cost time: 1.7381870746612549
Epoch: 14, Steps: 10 | Train Loss: 0.432 Vali Loss: 4.322 Vali Acc: 0.184 Test Loss: 4.322 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.288095235824585
Epoch: 15, Steps: 10 | Train Loss: 0.329 Vali Loss: 4.568 Vali Acc: 0.199 Test Loss: 4.568 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8370747566223145
Epoch: 16, Steps: 10 | Train Loss: 0.231 Vali Loss: 4.358 Vali Acc: 0.231 Test Loss: 4.358 Test Acc: 0.231
Validation loss decreased (-0.201135 --> -0.230545).  Saving model ...
Epoch: 17 cost time: 1.602914810180664
Epoch: 17, Steps: 10 | Train Loss: 0.178 Vali Loss: 4.651 Vali Acc: 0.229 Test Loss: 4.651 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8191311359405518
Epoch: 18, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.659 Vali Acc: 0.222 Test Loss: 4.659 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4446442127227783
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 5.119 Vali Acc: 0.208 Test Loss: 5.119 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6127395629882812
Epoch: 20, Steps: 10 | Train Loss: 0.080 Vali Loss: 5.014 Vali Acc: 0.232 Test Loss: 5.014 Test Acc: 0.232
Validation loss decreased (-0.230545 --> -0.231715).  Saving model ...
Epoch: 21 cost time: 1.2718181610107422
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.248 Vali Acc: 0.233 Test Loss: 5.248 Test Acc: 0.233
Validation loss decreased (-0.231715 --> -0.232889).  Saving model ...
Epoch: 22 cost time: 1.2381188869476318
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 5.584 Vali Acc: 0.206 Test Loss: 5.584 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2037022113800049
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.169 Vali Acc: 0.246 Test Loss: 5.169 Test Acc: 0.246
Validation loss decreased (-0.232889 --> -0.245831).  Saving model ...
Epoch: 24 cost time: 1.2858376502990723
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.298 Vali Acc: 0.244 Test Loss: 5.298 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.721181869506836
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.493 Vali Acc: 0.256 Test Loss: 5.493 Test Acc: 0.256
Validation loss decreased (-0.245831 --> -0.256416).  Saving model ...
Epoch: 26 cost time: 1.475733995437622
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.525 Vali Acc: 0.251 Test Loss: 5.525 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.110579013824463
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.443 Vali Acc: 0.248 Test Loss: 5.443 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1528456211090088
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.364 Vali Acc: 0.249 Test Loss: 5.364 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0742950439453125
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.341 Vali Acc: 0.249 Test Loss: 5.341 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0830657482147217
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.327 Vali Acc: 0.252 Test Loss: 5.327 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2550487518310547
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.331 Vali Acc: 0.255 Test Loss: 5.331 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2724699974060059
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.351 Vali Acc: 0.253 Test Loss: 5.351 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.3071002960205078
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.371 Vali Acc: 0.254 Test Loss: 5.371 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.5751757621765137
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.397 Vali Acc: 0.253 Test Loss: 5.397 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.5568997859954834
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.417 Vali Acc: 0.252 Test Loss: 5.417 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 5029682
model size : 24.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.513906955718994
Epoch: 1, Steps: 10 | Train Loss: 3.357 Vali Loss: 3.377 Vali Acc: 0.036 Test Loss: 3.377 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.1094555854797363
Epoch: 2, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.405 Vali Acc: 0.046 Test Loss: 3.405 Test Acc: 0.046
Validation loss decreased (-0.036437 --> -0.045848).  Saving model ...
Epoch: 3 cost time: 0.9017577171325684
Epoch: 3, Steps: 10 | Train Loss: 3.034 Vali Loss: 3.297 Vali Acc: 0.093 Test Loss: 3.297 Test Acc: 0.093
Validation loss decreased (-0.045848 --> -0.092908).  Saving model ...
Epoch: 4 cost time: 1.2396860122680664
Epoch: 4, Steps: 10 | Train Loss: 2.820 Vali Loss: 3.321 Vali Acc: 0.087 Test Loss: 3.321 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5409958362579346
Epoch: 5, Steps: 10 | Train Loss: 2.683 Vali Loss: 3.308 Vali Acc: 0.126 Test Loss: 3.308 Test Acc: 0.126
Validation loss decreased (-0.092908 --> -0.125849).  Saving model ...
Epoch: 6 cost time: 1.015890121459961
Epoch: 6, Steps: 10 | Train Loss: 2.262 Vali Loss: 3.538 Vali Acc: 0.102 Test Loss: 3.538 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3374369144439697
Epoch: 7, Steps: 10 | Train Loss: 2.118 Vali Loss: 3.401 Vali Acc: 0.152 Test Loss: 3.401 Test Acc: 0.152
Validation loss decreased (-0.125849 --> -0.151731).  Saving model ...
Epoch: 8 cost time: 1.0471792221069336
Epoch: 8, Steps: 10 | Train Loss: 1.698 Vali Loss: 3.555 Vali Acc: 0.162 Test Loss: 3.555 Test Acc: 0.162
Validation loss decreased (-0.151731 --> -0.162317).  Saving model ...
Epoch: 9 cost time: 1.2036728858947754
Epoch: 9, Steps: 10 | Train Loss: 1.409 Vali Loss: 3.545 Vali Acc: 0.176 Test Loss: 3.545 Test Acc: 0.176
Validation loss decreased (-0.162317 --> -0.176435).  Saving model ...
Epoch: 10 cost time: 1.2002217769622803
Epoch: 10, Steps: 10 | Train Loss: 1.198 Vali Loss: 3.636 Vali Acc: 0.205 Test Loss: 3.636 Test Acc: 0.205
Validation loss decreased (-0.176435 --> -0.204670).  Saving model ...
Epoch: 11 cost time: 1.3364121913909912
Epoch: 11, Steps: 10 | Train Loss: 0.940 Vali Loss: 3.710 Vali Acc: 0.200 Test Loss: 3.710 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.168579339981079
Epoch: 12, Steps: 10 | Train Loss: 0.739 Vali Loss: 3.977 Vali Acc: 0.214 Test Loss: 3.977 Test Acc: 0.214
Validation loss decreased (-0.204670 --> -0.214078).  Saving model ...
Epoch: 13 cost time: 1.0586137771606445
Epoch: 13, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.930 Vali Acc: 0.231 Test Loss: 3.930 Test Acc: 0.231
Validation loss decreased (-0.214078 --> -0.230549).  Saving model ...
Epoch: 14 cost time: 1.0252947807312012
Epoch: 14, Steps: 10 | Train Loss: 0.404 Vali Loss: 4.075 Vali Acc: 0.228 Test Loss: 4.075 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0226871967315674
Epoch: 15, Steps: 10 | Train Loss: 0.291 Vali Loss: 4.605 Vali Acc: 0.198 Test Loss: 4.605 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0519094467163086
Epoch: 16, Steps: 10 | Train Loss: 0.330 Vali Loss: 4.496 Vali Acc: 0.208 Test Loss: 4.496 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2877016067504883
Epoch: 17, Steps: 10 | Train Loss: 0.121 Vali Loss: 4.521 Vali Acc: 0.242 Test Loss: 4.521 Test Acc: 0.242
Validation loss decreased (-0.230549 --> -0.242308).  Saving model ...
Epoch: 18 cost time: 1.1175537109375
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.750 Vali Acc: 0.244 Test Loss: 4.750 Test Acc: 0.244
Validation loss decreased (-0.242308 --> -0.243482).  Saving model ...
Epoch: 19 cost time: 1.038243055343628
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.831 Vali Acc: 0.242 Test Loss: 4.831 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0633208751678467
Epoch: 20, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.947 Vali Acc: 0.234 Test Loss: 4.947 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.11397385597229
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.104 Vali Acc: 0.239 Test Loss: 5.104 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1660146713256836
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.270 Vali Acc: 0.242 Test Loss: 5.270 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.160783290863037
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.299 Vali Acc: 0.239 Test Loss: 5.299 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3832941055297852
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.399 Vali Acc: 0.241 Test Loss: 5.399 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1920197010040283
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.306 Vali Acc: 0.241 Test Loss: 5.306 Test Acc: 0.241
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2217803001403809
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.294 Vali Acc: 0.242 Test Loss: 5.294 Test Acc: 0.242
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3747057914733887
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.318 Vali Acc: 0.249 Test Loss: 5.318 Test Acc: 0.249
Validation loss decreased (-0.243482 --> -0.249359).  Saving model ...
Epoch: 28 cost time: 1.0593857765197754
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.359 Vali Acc: 0.247 Test Loss: 5.359 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.239386796951294
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.416 Vali Acc: 0.251 Test Loss: 5.416 Test Acc: 0.251
Validation loss decreased (-0.249359 --> -0.250534).  Saving model ...
Epoch: 30 cost time: 1.1263093948364258
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.415 Vali Acc: 0.251 Test Loss: 5.415 Test Acc: 0.251
Validation loss decreased (-0.250534 --> -0.250534).  Saving model ...
Epoch: 31 cost time: 1.2793638706207275
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.412 Vali Acc: 0.255 Test Loss: 5.412 Test Acc: 0.255
Validation loss decreased (-0.250534 --> -0.255240).  Saving model ...
Epoch: 32 cost time: 1.1437232494354248
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.428 Vali Acc: 0.254 Test Loss: 5.428 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.393235206604004
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.444 Vali Acc: 0.251 Test Loss: 5.444 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0587842464447021
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.458 Vali Acc: 0.253 Test Loss: 5.458 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2560014724731445
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.461 Vali Acc: 0.253 Test Loss: 5.461 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.227599859237671
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.472 Vali Acc: 0.256 Test Loss: 5.472 Test Acc: 0.256
Validation loss decreased (-0.255240 --> -0.256416).  Saving model ...
Epoch: 37 cost time: 1.4022445678710938
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.475 Vali Acc: 0.256 Test Loss: 5.475 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5362629890441895
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.487 Vali Acc: 0.256 Test Loss: 5.487 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5035784244537354
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.499 Vali Acc: 0.255 Test Loss: 5.499 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.292393684387207
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.513 Vali Acc: 0.260 Test Loss: 5.513 Test Acc: 0.260
Validation loss decreased (-0.256416 --> -0.259945).  Saving model ...
Epoch: 41 cost time: 1.3748466968536377
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.527 Vali Acc: 0.258 Test Loss: 5.527 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.495126485824585
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.539 Vali Acc: 0.259 Test Loss: 5.539 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3317346572875977
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.547 Vali Acc: 0.258 Test Loss: 5.547 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.4528682231903076
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.552 Vali Acc: 0.258 Test Loss: 5.552 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.377209186553955
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.554 Vali Acc: 0.260 Test Loss: 5.554 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.481511116027832
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.563 Vali Acc: 0.259 Test Loss: 5.563 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.700188398361206
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.578 Vali Acc: 0.260 Test Loss: 5.578 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.500520944595337
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.595 Vali Acc: 0.259 Test Loss: 5.595 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.5827622413635254
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.601 Vali Acc: 0.259 Test Loss: 5.601 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.8180134296417236
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.611 Vali Acc: 0.260 Test Loss: 5.611 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 5026354
model size : 24.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.560802698135376
Epoch: 1, Steps: 10 | Train Loss: 3.376 Vali Loss: 3.330 Vali Acc: 0.038 Test Loss: 3.330 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.1549251079559326
Epoch: 2, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.380 Vali Acc: 0.049 Test Loss: 3.380 Test Acc: 0.049
Validation loss decreased (-0.037614 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 1.1441354751586914
Epoch: 3, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.302 Vali Acc: 0.087 Test Loss: 3.302 Test Acc: 0.087
Validation loss decreased (-0.049378 --> -0.087026).  Saving model ...
Epoch: 4 cost time: 1.2693829536437988
Epoch: 4, Steps: 10 | Train Loss: 2.822 Vali Loss: 3.275 Vali Acc: 0.104 Test Loss: 3.275 Test Acc: 0.104
Validation loss decreased (-0.087026 --> -0.103497).  Saving model ...
Epoch: 5 cost time: 1.2900094985961914
Epoch: 5, Steps: 10 | Train Loss: 2.466 Vali Loss: 3.205 Vali Acc: 0.153 Test Loss: 3.205 Test Acc: 0.153
Validation loss decreased (-0.103497 --> -0.152909).  Saving model ...
Epoch: 6 cost time: 1.2311277389526367
Epoch: 6, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.319 Vali Acc: 0.132 Test Loss: 3.319 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1344752311706543
Epoch: 7, Steps: 10 | Train Loss: 1.954 Vali Loss: 3.305 Vali Acc: 0.156 Test Loss: 3.305 Test Acc: 0.156
Validation loss decreased (-0.152909 --> -0.156438).  Saving model ...
Epoch: 8 cost time: 1.069913387298584
Epoch: 8, Steps: 10 | Train Loss: 1.700 Vali Loss: 3.301 Vali Acc: 0.185 Test Loss: 3.301 Test Acc: 0.185
Validation loss decreased (-0.156438 --> -0.184673).  Saving model ...
Epoch: 9 cost time: 1.3806357383728027
Epoch: 9, Steps: 10 | Train Loss: 1.473 Vali Loss: 3.521 Vali Acc: 0.181 Test Loss: 3.521 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2414405345916748
Epoch: 10, Steps: 10 | Train Loss: 1.191 Vali Loss: 3.568 Vali Acc: 0.185 Test Loss: 3.568 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.079451084136963
Epoch: 11, Steps: 10 | Train Loss: 0.918 Vali Loss: 3.618 Vali Acc: 0.216 Test Loss: 3.618 Test Acc: 0.216
Validation loss decreased (-0.184673 --> -0.216434).  Saving model ...
Epoch: 12 cost time: 1.2745630741119385
Epoch: 12, Steps: 10 | Train Loss: 0.729 Vali Loss: 3.818 Vali Acc: 0.202 Test Loss: 3.818 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4319136142730713
Epoch: 13, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.953 Vali Acc: 0.220 Test Loss: 3.953 Test Acc: 0.220
Validation loss decreased (-0.216434 --> -0.219960).  Saving model ...
Epoch: 14 cost time: 1.0230331420898438
Epoch: 14, Steps: 10 | Train Loss: 0.378 Vali Loss: 4.234 Vali Acc: 0.204 Test Loss: 4.234 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9830172061920166
Epoch: 15, Steps: 10 | Train Loss: 0.318 Vali Loss: 4.181 Vali Acc: 0.235 Test Loss: 4.181 Test Acc: 0.235
Validation loss decreased (-0.219960 --> -0.235252).  Saving model ...
Epoch: 16 cost time: 0.9649643898010254
Epoch: 16, Steps: 10 | Train Loss: 0.211 Vali Loss: 4.549 Vali Acc: 0.233 Test Loss: 4.549 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2347147464752197
Epoch: 17, Steps: 10 | Train Loss: 0.180 Vali Loss: 4.549 Vali Acc: 0.216 Test Loss: 4.549 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1755874156951904
Epoch: 18, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.667 Vali Acc: 0.248 Test Loss: 4.667 Test Acc: 0.248
Validation loss decreased (-0.235252 --> -0.248189).  Saving model ...
Epoch: 19 cost time: 1.0108458995819092
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.653 Vali Acc: 0.254 Test Loss: 4.653 Test Acc: 0.254
Validation loss decreased (-0.248189 --> -0.254071).  Saving model ...
Epoch: 20 cost time: 1.2702383995056152
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 5.152 Vali Acc: 0.220 Test Loss: 5.152 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4090681076049805
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 5.089 Vali Acc: 0.233 Test Loss: 5.089 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2517468929290771
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.339 Vali Acc: 0.213 Test Loss: 5.339 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2328853607177734
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.162 Vali Acc: 0.249 Test Loss: 5.162 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.583448886871338
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.134 Vali Acc: 0.247 Test Loss: 5.134 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4056289196014404
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.226 Vali Acc: 0.255 Test Loss: 5.226 Test Acc: 0.255
Validation loss decreased (-0.254071 --> -0.255242).  Saving model ...
Epoch: 26 cost time: 1.2302041053771973
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.224 Vali Acc: 0.255 Test Loss: 5.224 Test Acc: 0.255
Validation loss decreased (-0.255242 --> -0.255242).  Saving model ...
Epoch: 27 cost time: 1.1083359718322754
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.160 Vali Acc: 0.265 Test Loss: 5.160 Test Acc: 0.265
Validation loss decreased (-0.255242 --> -0.264654).  Saving model ...
Epoch: 28 cost time: 1.2715463638305664
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.163 Vali Acc: 0.269 Test Loss: 5.163 Test Acc: 0.269
Validation loss decreased (-0.264654 --> -0.269360).  Saving model ...
Epoch: 29 cost time: 1.134282112121582
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.189 Vali Acc: 0.265 Test Loss: 5.189 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2530102729797363
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.223 Vali Acc: 0.262 Test Loss: 5.223 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2122206687927246
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.239 Vali Acc: 0.267 Test Loss: 5.239 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3565354347229004
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.252 Vali Acc: 0.272 Test Loss: 5.252 Test Acc: 0.272
Validation loss decreased (-0.269360 --> -0.271712).  Saving model ...
Epoch: 33 cost time: 1.4676268100738525
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.272 Vali Acc: 0.272 Test Loss: 5.272 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6365516185760498
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.295 Vali Acc: 0.269 Test Loss: 5.295 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.999321699142456
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.312 Vali Acc: 0.268 Test Loss: 5.312 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.098778247833252
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.313 Vali Acc: 0.266 Test Loss: 5.313 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0140984058380127
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.312 Vali Acc: 0.271 Test Loss: 5.312 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1350905895233154
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.323 Vali Acc: 0.272 Test Loss: 5.323 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.286252498626709
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.335 Vali Acc: 0.268 Test Loss: 5.335 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0591425895690918
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.353 Vali Acc: 0.267 Test Loss: 5.353 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.364607810974121
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.362 Vali Acc: 0.268 Test Loss: 5.362 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0954961776733398
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.376 Vali Acc: 0.269 Test Loss: 5.376 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 4248370
model size : 21.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.943286418914795
Epoch: 1, Steps: 10 | Train Loss: 3.367 Vali Loss: 3.347 Vali Acc: 0.041 Test Loss: 3.347 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.2117359638214111
Epoch: 2, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.506 Vali Acc: 0.062 Test Loss: 3.506 Test Acc: 0.062
Validation loss decreased (-0.041143 --> -0.062318).  Saving model ...
Epoch: 3 cost time: 1.092442274093628
Epoch: 3, Steps: 10 | Train Loss: 3.051 Vali Loss: 3.287 Vali Acc: 0.086 Test Loss: 3.287 Test Acc: 0.086
Validation loss decreased (-0.062318 --> -0.085849).  Saving model ...
Epoch: 4 cost time: 0.9864909648895264
Epoch: 4, Steps: 10 | Train Loss: 2.823 Vali Loss: 3.287 Vali Acc: 0.091 Test Loss: 3.287 Test Acc: 0.091
Validation loss decreased (-0.085849 --> -0.090555).  Saving model ...
Epoch: 5 cost time: 1.0781331062316895
Epoch: 5, Steps: 10 | Train Loss: 2.596 Vali Loss: 3.256 Vali Acc: 0.136 Test Loss: 3.256 Test Acc: 0.136
Validation loss decreased (-0.090555 --> -0.136438).  Saving model ...
Epoch: 6 cost time: 1.327486515045166
Epoch: 6, Steps: 10 | Train Loss: 2.374 Vali Loss: 3.293 Vali Acc: 0.122 Test Loss: 3.293 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3433890342712402
Epoch: 7, Steps: 10 | Train Loss: 2.035 Vali Loss: 3.345 Vali Acc: 0.169 Test Loss: 3.345 Test Acc: 0.169
Validation loss decreased (-0.136438 --> -0.169378).  Saving model ...
Epoch: 8 cost time: 1.4032914638519287
Epoch: 8, Steps: 10 | Train Loss: 1.651 Vali Loss: 3.406 Vali Acc: 0.152 Test Loss: 3.406 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1451663970947266
Epoch: 9, Steps: 10 | Train Loss: 1.368 Vali Loss: 3.498 Vali Acc: 0.158 Test Loss: 3.498 Test Acc: 0.158
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2040009498596191
Epoch: 10, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.534 Vali Acc: 0.192 Test Loss: 3.534 Test Acc: 0.192
Validation loss decreased (-0.169378 --> -0.191729).  Saving model ...
Epoch: 11 cost time: 1.322932243347168
Epoch: 11, Steps: 10 | Train Loss: 0.963 Vali Loss: 3.761 Vali Acc: 0.173 Test Loss: 3.761 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1405301094055176
Epoch: 12, Steps: 10 | Train Loss: 0.733 Vali Loss: 3.748 Vali Acc: 0.215 Test Loss: 3.748 Test Acc: 0.215
Validation loss decreased (-0.191729 --> -0.215257).  Saving model ...
Epoch: 13 cost time: 1.1398952007293701
Epoch: 13, Steps: 10 | Train Loss: 0.554 Vali Loss: 4.042 Vali Acc: 0.205 Test Loss: 4.042 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0674219131469727
Epoch: 14, Steps: 10 | Train Loss: 0.431 Vali Loss: 4.173 Vali Acc: 0.204 Test Loss: 4.173 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0665442943572998
Epoch: 15, Steps: 10 | Train Loss: 0.273 Vali Loss: 4.496 Vali Acc: 0.211 Test Loss: 4.496 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.222848892211914
Epoch: 16, Steps: 10 | Train Loss: 0.267 Vali Loss: 4.660 Vali Acc: 0.199 Test Loss: 4.660 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0097618103027344
Epoch: 17, Steps: 10 | Train Loss: 0.231 Vali Loss: 4.625 Vali Acc: 0.216 Test Loss: 4.625 Test Acc: 0.216
Validation loss decreased (-0.215257 --> -0.216424).  Saving model ...
Epoch: 18 cost time: 0.9681651592254639
Epoch: 18, Steps: 10 | Train Loss: 0.109 Vali Loss: 5.065 Vali Acc: 0.209 Test Loss: 5.065 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2045152187347412
Epoch: 19, Steps: 10 | Train Loss: 0.096 Vali Loss: 5.128 Vali Acc: 0.205 Test Loss: 5.128 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.137166976928711
Epoch: 20, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.964 Vali Acc: 0.247 Test Loss: 4.964 Test Acc: 0.247
Validation loss decreased (-0.216424 --> -0.247009).  Saving model ...
Epoch: 21 cost time: 1.2050340175628662
Epoch: 21, Steps: 10 | Train Loss: 0.092 Vali Loss: 5.317 Vali Acc: 0.231 Test Loss: 5.317 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1688988208770752
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 5.150 Vali Acc: 0.234 Test Loss: 5.150 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.257643461227417
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.524 Vali Acc: 0.236 Test Loss: 5.524 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3360474109649658
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 5.514 Vali Acc: 0.225 Test Loss: 5.514 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0977602005004883
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.465 Vali Acc: 0.219 Test Loss: 5.465 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.215843915939331
Epoch: 26, Steps: 10 | Train Loss: 0.034 Vali Loss: 5.467 Vali Acc: 0.238 Test Loss: 5.467 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.143545389175415
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.649 Vali Acc: 0.233 Test Loss: 5.649 Test Acc: 0.233
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4483873844146729
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.487 Vali Acc: 0.241 Test Loss: 5.487 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1923367977142334
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.448 Vali Acc: 0.247 Test Loss: 5.448 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3201680183410645
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.458 Vali Acc: 0.246 Test Loss: 5.458 Test Acc: 0.246
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24705882352941178
model parameter : 4245042
model size : 21.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.8268308639526367
Epoch: 1, Steps: 10 | Train Loss: 3.418 Vali Loss: 3.355 Vali Acc: 0.051 Test Loss: 3.355 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.0301129817962646
Epoch: 2, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.413 Vali Acc: 0.045 Test Loss: 3.413 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1498847007751465
Epoch: 3, Steps: 10 | Train Loss: 3.059 Vali Loss: 3.270 Vali Acc: 0.092 Test Loss: 3.270 Test Acc: 0.092
Validation loss decreased (-0.050555 --> -0.091732).  Saving model ...
Epoch: 4 cost time: 1.0381355285644531
Epoch: 4, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.307 Vali Acc: 0.092 Test Loss: 3.307 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1509737968444824
Epoch: 5, Steps: 10 | Train Loss: 2.539 Vali Loss: 3.273 Vali Acc: 0.126 Test Loss: 3.273 Test Acc: 0.126
Validation loss decreased (-0.091732 --> -0.125850).  Saving model ...
Epoch: 6 cost time: 1.0752661228179932
Epoch: 6, Steps: 10 | Train Loss: 2.195 Vali Loss: 3.354 Vali Acc: 0.119 Test Loss: 3.354 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1574525833129883
Epoch: 7, Steps: 10 | Train Loss: 2.000 Vali Loss: 3.292 Vali Acc: 0.155 Test Loss: 3.292 Test Acc: 0.155
Validation loss decreased (-0.125850 --> -0.155261).  Saving model ...
Epoch: 8 cost time: 1.2176671028137207
Epoch: 8, Steps: 10 | Train Loss: 1.754 Vali Loss: 3.426 Vali Acc: 0.158 Test Loss: 3.426 Test Acc: 0.158
Validation loss decreased (-0.155261 --> -0.157613).  Saving model ...
Epoch: 9 cost time: 1.4173622131347656
Epoch: 9, Steps: 10 | Train Loss: 1.416 Vali Loss: 3.482 Vali Acc: 0.180 Test Loss: 3.482 Test Acc: 0.180
Validation loss decreased (-0.157613 --> -0.179965).  Saving model ...
Epoch: 10 cost time: 0.904759407043457
Epoch: 10, Steps: 10 | Train Loss: 1.180 Vali Loss: 3.526 Vali Acc: 0.201 Test Loss: 3.526 Test Acc: 0.201
Validation loss decreased (-0.179965 --> -0.201141).  Saving model ...
Epoch: 11 cost time: 1.1427562236785889
Epoch: 11, Steps: 10 | Train Loss: 0.881 Vali Loss: 3.641 Vali Acc: 0.202 Test Loss: 3.641 Test Acc: 0.202
Validation loss decreased (-0.201141 --> -0.202317).  Saving model ...
Epoch: 12 cost time: 1.0691330432891846
Epoch: 12, Steps: 10 | Train Loss: 0.781 Vali Loss: 3.753 Vali Acc: 0.209 Test Loss: 3.753 Test Acc: 0.209
Validation loss decreased (-0.202317 --> -0.209374).  Saving model ...
Epoch: 13 cost time: 1.4154646396636963
Epoch: 13, Steps: 10 | Train Loss: 0.559 Vali Loss: 3.971 Vali Acc: 0.232 Test Loss: 3.971 Test Acc: 0.232
Validation loss decreased (-0.209374 --> -0.231725).  Saving model ...
Epoch: 14 cost time: 1.511519193649292
Epoch: 14, Steps: 10 | Train Loss: 0.441 Vali Loss: 3.988 Vali Acc: 0.221 Test Loss: 3.988 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4313254356384277
Epoch: 15, Steps: 10 | Train Loss: 0.299 Vali Loss: 4.457 Vali Acc: 0.225 Test Loss: 4.457 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3446710109710693
Epoch: 16, Steps: 10 | Train Loss: 0.240 Vali Loss: 4.351 Vali Acc: 0.246 Test Loss: 4.351 Test Acc: 0.246
Validation loss decreased (-0.231725 --> -0.245839).  Saving model ...
Epoch: 17 cost time: 1.6654527187347412
Epoch: 17, Steps: 10 | Train Loss: 0.238 Vali Loss: 4.656 Vali Acc: 0.235 Test Loss: 4.656 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2561094760894775
Epoch: 18, Steps: 10 | Train Loss: 0.138 Vali Loss: 4.652 Vali Acc: 0.222 Test Loss: 4.652 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.571502685546875
Epoch: 19, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.788 Vali Acc: 0.240 Test Loss: 4.788 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5606558322906494
Epoch: 20, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.907 Vali Acc: 0.256 Test Loss: 4.907 Test Acc: 0.256
Validation loss decreased (-0.245839 --> -0.256422).  Saving model ...
Epoch: 21 cost time: 1.3889665603637695
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.989 Vali Acc: 0.245 Test Loss: 4.989 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.751601219177246
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 5.256 Vali Acc: 0.240 Test Loss: 5.256 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6143722534179688
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 5.249 Vali Acc: 0.241 Test Loss: 5.249 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7608709335327148
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.162 Vali Acc: 0.264 Test Loss: 5.162 Test Acc: 0.264
Validation loss decreased (-0.256422 --> -0.263478).  Saving model ...
Epoch: 25 cost time: 1.7046363353729248
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.213 Vali Acc: 0.248 Test Loss: 5.213 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3977766036987305
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.170 Vali Acc: 0.255 Test Loss: 5.170 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6186161041259766
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.203 Vali Acc: 0.256 Test Loss: 5.203 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3035821914672852
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.221 Vali Acc: 0.265 Test Loss: 5.221 Test Acc: 0.265
Validation loss decreased (-0.263478 --> -0.264654).  Saving model ...
Epoch: 29 cost time: 1.6467225551605225
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.236 Vali Acc: 0.262 Test Loss: 5.236 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4067540168762207
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.266 Vali Acc: 0.266 Test Loss: 5.266 Test Acc: 0.266
Validation loss decreased (-0.264654 --> -0.265830).  Saving model ...
Epoch: 31 cost time: 1.615985631942749
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.281 Vali Acc: 0.269 Test Loss: 5.281 Test Acc: 0.269
Validation loss decreased (-0.265830 --> -0.269359).  Saving model ...
Epoch: 32 cost time: 1.8607888221740723
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.301 Vali Acc: 0.267 Test Loss: 5.301 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3884572982788086
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.296 Vali Acc: 0.265 Test Loss: 5.296 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2944848537445068
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.302 Vali Acc: 0.268 Test Loss: 5.302 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2079107761383057
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.309 Vali Acc: 0.267 Test Loss: 5.309 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.424776554107666
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.325 Vali Acc: 0.266 Test Loss: 5.325 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4641308784484863
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.358 Vali Acc: 0.268 Test Loss: 5.358 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.566871166229248
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.370 Vali Acc: 0.264 Test Loss: 5.370 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.6431844234466553
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.373 Vali Acc: 0.266 Test Loss: 5.373 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.861952304840088
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.379 Vali Acc: 0.268 Test Loss: 5.379 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4380340576171875
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.396 Vali Acc: 0.265 Test Loss: 5.396 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 4241714
model size : 21.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.170077085494995
Epoch: 1, Steps: 10 | Train Loss: 3.385 Vali Loss: 3.345 Vali Acc: 0.048 Test Loss: 3.345 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 1.2082891464233398
Epoch: 2, Steps: 10 | Train Loss: 3.178 Vali Loss: 3.385 Vali Acc: 0.048 Test Loss: 3.385 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3551177978515625
Epoch: 3, Steps: 10 | Train Loss: 3.009 Vali Loss: 3.272 Vali Acc: 0.076 Test Loss: 3.272 Test Acc: 0.076
Validation loss decreased (-0.048202 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 1.2330689430236816
Epoch: 4, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.314 Vali Acc: 0.111 Test Loss: 3.314 Test Acc: 0.111
Validation loss decreased (-0.076438 --> -0.110555).  Saving model ...
Epoch: 5 cost time: 1.230079174041748
Epoch: 5, Steps: 10 | Train Loss: 2.478 Vali Loss: 3.267 Vali Acc: 0.125 Test Loss: 3.267 Test Acc: 0.125
Validation loss decreased (-0.110555 --> -0.124673).  Saving model ...
Epoch: 6 cost time: 1.0644676685333252
Epoch: 6, Steps: 10 | Train Loss: 2.206 Vali Loss: 3.273 Vali Acc: 0.128 Test Loss: 3.273 Test Acc: 0.128
Validation loss decreased (-0.124673 --> -0.128203).  Saving model ...
Epoch: 7 cost time: 1.416696310043335
Epoch: 7, Steps: 10 | Train Loss: 2.049 Vali Loss: 3.286 Vali Acc: 0.174 Test Loss: 3.286 Test Acc: 0.174
Validation loss decreased (-0.128203 --> -0.174085).  Saving model ...
Epoch: 8 cost time: 1.025008201599121
Epoch: 8, Steps: 10 | Train Loss: 1.819 Vali Loss: 3.386 Vali Acc: 0.169 Test Loss: 3.386 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.437622308731079
Epoch: 9, Steps: 10 | Train Loss: 1.462 Vali Loss: 3.471 Vali Acc: 0.181 Test Loss: 3.471 Test Acc: 0.181
Validation loss decreased (-0.174085 --> -0.181142).  Saving model ...
Epoch: 10 cost time: 1.345228672027588
Epoch: 10, Steps: 10 | Train Loss: 1.110 Vali Loss: 3.592 Vali Acc: 0.196 Test Loss: 3.592 Test Acc: 0.196
Validation loss decreased (-0.181142 --> -0.196435).  Saving model ...
Epoch: 11 cost time: 1.0959587097167969
Epoch: 11, Steps: 10 | Train Loss: 1.029 Vali Loss: 3.683 Vali Acc: 0.192 Test Loss: 3.683 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.294398307800293
Epoch: 12, Steps: 10 | Train Loss: 0.719 Vali Loss: 3.714 Vali Acc: 0.201 Test Loss: 3.714 Test Acc: 0.201
Validation loss decreased (-0.196435 --> -0.201139).  Saving model ...
Epoch: 13 cost time: 1.4230091571807861
Epoch: 13, Steps: 10 | Train Loss: 0.548 Vali Loss: 4.001 Vali Acc: 0.204 Test Loss: 4.001 Test Acc: 0.204
Validation loss decreased (-0.201139 --> -0.203489).  Saving model ...
Epoch: 14 cost time: 1.1851072311401367
Epoch: 14, Steps: 10 | Train Loss: 0.443 Vali Loss: 4.129 Vali Acc: 0.222 Test Loss: 4.129 Test Acc: 0.222
Validation loss decreased (-0.203489 --> -0.222312).  Saving model ...
Epoch: 15 cost time: 1.2082901000976562
Epoch: 15, Steps: 10 | Train Loss: 0.317 Vali Loss: 4.264 Vali Acc: 0.228 Test Loss: 4.264 Test Acc: 0.228
Validation loss decreased (-0.222312 --> -0.228193).  Saving model ...
Epoch: 16 cost time: 1.5624165534973145
Epoch: 16, Steps: 10 | Train Loss: 0.276 Vali Loss: 4.381 Vali Acc: 0.231 Test Loss: 4.381 Test Acc: 0.231
Validation loss decreased (-0.228193 --> -0.230544).  Saving model ...
Epoch: 17 cost time: 1.2028555870056152
Epoch: 17, Steps: 10 | Train Loss: 0.167 Vali Loss: 4.536 Vali Acc: 0.255 Test Loss: 4.536 Test Acc: 0.255
Validation loss decreased (-0.230544 --> -0.255249).  Saving model ...
Epoch: 18 cost time: 1.2516167163848877
Epoch: 18, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.800 Vali Acc: 0.226 Test Loss: 4.800 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.482269048690796
Epoch: 19, Steps: 10 | Train Loss: 0.102 Vali Loss: 4.855 Vali Acc: 0.253 Test Loss: 4.855 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7855236530303955
Epoch: 20, Steps: 10 | Train Loss: 0.083 Vali Loss: 5.221 Vali Acc: 0.218 Test Loss: 5.221 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1879947185516357
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.966 Vali Acc: 0.245 Test Loss: 4.966 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2853999137878418
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.219 Vali Acc: 0.231 Test Loss: 5.219 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1110405921936035
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.228 Vali Acc: 0.234 Test Loss: 5.228 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4048500061035156
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 5.400 Vali Acc: 0.252 Test Loss: 5.400 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1237468719482422
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.394 Vali Acc: 0.258 Test Loss: 5.394 Test Acc: 0.258
Validation loss decreased (-0.255249 --> -0.257593).  Saving model ...
Epoch: 26 cost time: 1.181178331375122
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.306 Vali Acc: 0.272 Test Loss: 5.306 Test Acc: 0.272
Validation loss decreased (-0.257593 --> -0.271712).  Saving model ...
Epoch: 27 cost time: 1.1043343544006348
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.266 Vali Acc: 0.276 Test Loss: 5.266 Test Acc: 0.276
Validation loss decreased (-0.271712 --> -0.276418).  Saving model ...
Epoch: 28 cost time: 1.2938988208770752
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.270 Vali Acc: 0.275 Test Loss: 5.270 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3451638221740723
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.299 Vali Acc: 0.276 Test Loss: 5.299 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4165065288543701
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.335 Vali Acc: 0.274 Test Loss: 5.335 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.224348783493042
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.348 Vali Acc: 0.279 Test Loss: 5.348 Test Acc: 0.279
Validation loss decreased (-0.276418 --> -0.278770).  Saving model ...
Epoch: 32 cost time: 1.8132760524749756
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.355 Vali Acc: 0.276 Test Loss: 5.355 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.423771619796753
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.364 Vali Acc: 0.278 Test Loss: 5.364 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.564631700515747
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.373 Vali Acc: 0.276 Test Loss: 5.373 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7717437744140625
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.377 Vali Acc: 0.279 Test Loss: 5.377 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4029426574707031
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.391 Vali Acc: 0.279 Test Loss: 5.391 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3740870952606201
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.408 Vali Acc: 0.285 Test Loss: 5.408 Test Acc: 0.285
Validation loss decreased (-0.278770 --> -0.284652).  Saving model ...
Epoch: 38 cost time: 1.6422929763793945
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.418 Vali Acc: 0.281 Test Loss: 5.418 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4757983684539795
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.430 Vali Acc: 0.284 Test Loss: 5.430 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3900957107543945
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.440 Vali Acc: 0.282 Test Loss: 5.440 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.4048874378204346
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.441 Vali Acc: 0.285 Test Loss: 5.441 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.614187479019165
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.447 Vali Acc: 0.287 Test Loss: 5.447 Test Acc: 0.287
Validation loss decreased (-0.284652 --> -0.287004).  Saving model ...
Epoch: 43 cost time: 1.2597765922546387
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.455 Vali Acc: 0.286 Test Loss: 5.455 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.4944589138031006
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.467 Vali Acc: 0.288 Test Loss: 5.467 Test Acc: 0.288
Validation loss decreased (-0.287004 --> -0.288181).  Saving model ...
Epoch: 45 cost time: 1.3628590106964111
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.488 Vali Acc: 0.286 Test Loss: 5.488 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.4333646297454834
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.490 Vali Acc: 0.287 Test Loss: 5.490 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.3559141159057617
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.498 Vali Acc: 0.287 Test Loss: 5.498 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3817222118377686
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.512 Vali Acc: 0.288 Test Loss: 5.512 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2754712104797363
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.528 Vali Acc: 0.284 Test Loss: 5.528 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.3334572315216064
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.535 Vali Acc: 0.285 Test Loss: 5.535 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.7001063823699951
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.546 Vali Acc: 0.286 Test Loss: 5.546 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.513484001159668
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.557 Vali Acc: 0.288 Test Loss: 5.557 Test Acc: 0.288
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.391021490097046
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.561 Vali Acc: 0.288 Test Loss: 5.561 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.7554059028625488
Epoch: 54, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.568 Vali Acc: 0.288 Test Loss: 5.568 Test Acc: 0.288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28823529411764703
model parameter : 4238386
model size : 21.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4984378814697266
Epoch: 1, Steps: 10 | Train Loss: 3.414 Vali Loss: 3.363 Vali Acc: 0.041 Test Loss: 3.363 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.9646191596984863
Epoch: 2, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.447 Vali Acc: 0.052 Test Loss: 3.447 Test Acc: 0.052
Validation loss decreased (-0.041143 --> -0.051730).  Saving model ...
Epoch: 3 cost time: 1.2380080223083496
Epoch: 3, Steps: 10 | Train Loss: 3.050 Vali Loss: 3.321 Vali Acc: 0.096 Test Loss: 3.321 Test Acc: 0.096
Validation loss decreased (-0.051730 --> -0.096437).  Saving model ...
Epoch: 4 cost time: 1.3001410961151123
Epoch: 4, Steps: 10 | Train Loss: 2.781 Vali Loss: 3.241 Vali Acc: 0.109 Test Loss: 3.241 Test Acc: 0.109
Validation loss decreased (-0.096437 --> -0.109379).  Saving model ...
Epoch: 5 cost time: 1.3187813758850098
Epoch: 5, Steps: 10 | Train Loss: 2.615 Vali Loss: 3.242 Vali Acc: 0.142 Test Loss: 3.242 Test Acc: 0.142
Validation loss decreased (-0.109379 --> -0.142321).  Saving model ...
Epoch: 6 cost time: 1.2907350063323975
Epoch: 6, Steps: 10 | Train Loss: 2.318 Vali Loss: 3.270 Vali Acc: 0.147 Test Loss: 3.270 Test Acc: 0.147
Validation loss decreased (-0.142321 --> -0.147026).  Saving model ...
Epoch: 7 cost time: 1.0732040405273438
Epoch: 7, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.347 Vali Acc: 0.146 Test Loss: 3.347 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6320381164550781
Epoch: 8, Steps: 10 | Train Loss: 1.774 Vali Loss: 3.392 Vali Acc: 0.168 Test Loss: 3.392 Test Acc: 0.168
Validation loss decreased (-0.147026 --> -0.168201).  Saving model ...
Epoch: 9 cost time: 1.113912582397461
Epoch: 9, Steps: 10 | Train Loss: 1.518 Vali Loss: 3.426 Vali Acc: 0.162 Test Loss: 3.426 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6849935054779053
Epoch: 10, Steps: 10 | Train Loss: 1.275 Vali Loss: 3.526 Vali Acc: 0.201 Test Loss: 3.526 Test Acc: 0.201
Validation loss decreased (-0.168201 --> -0.201141).  Saving model ...
Epoch: 11 cost time: 1.0923924446105957
Epoch: 11, Steps: 10 | Train Loss: 1.145 Vali Loss: 3.625 Vali Acc: 0.200 Test Loss: 3.625 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0901069641113281
Epoch: 12, Steps: 10 | Train Loss: 0.839 Vali Loss: 3.767 Vali Acc: 0.219 Test Loss: 3.767 Test Acc: 0.219
Validation loss decreased (-0.201141 --> -0.218786).  Saving model ...
Epoch: 13 cost time: 1.1880345344543457
Epoch: 13, Steps: 10 | Train Loss: 0.792 Vali Loss: 3.944 Vali Acc: 0.208 Test Loss: 3.944 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5843520164489746
Epoch: 14, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.933 Vali Acc: 0.224 Test Loss: 3.933 Test Acc: 0.224
Validation loss decreased (-0.218786 --> -0.223490).  Saving model ...
Epoch: 15 cost time: 1.6425294876098633
Epoch: 15, Steps: 10 | Train Loss: 0.379 Vali Loss: 4.345 Vali Acc: 0.225 Test Loss: 4.345 Test Acc: 0.225
Validation loss decreased (-0.223490 --> -0.224662).  Saving model ...
Epoch: 16 cost time: 1.1984007358551025
Epoch: 16, Steps: 10 | Train Loss: 0.269 Vali Loss: 4.344 Vali Acc: 0.221 Test Loss: 4.344 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.302729606628418
Epoch: 17, Steps: 10 | Train Loss: 0.174 Vali Loss: 4.669 Vali Acc: 0.215 Test Loss: 4.669 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3896050453186035
Epoch: 18, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.663 Vali Acc: 0.248 Test Loss: 4.663 Test Acc: 0.248
Validation loss decreased (-0.224662 --> -0.248189).  Saving model ...
Epoch: 19 cost time: 1.4892804622650146
Epoch: 19, Steps: 10 | Train Loss: 0.119 Vali Loss: 5.553 Vali Acc: 0.202 Test Loss: 5.553 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2192966938018799
Epoch: 20, Steps: 10 | Train Loss: 0.087 Vali Loss: 5.105 Vali Acc: 0.228 Test Loss: 5.105 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2245967388153076
Epoch: 21, Steps: 10 | Train Loss: 0.070 Vali Loss: 5.035 Vali Acc: 0.252 Test Loss: 5.035 Test Acc: 0.252
Validation loss decreased (-0.248189 --> -0.251714).  Saving model ...
Epoch: 22 cost time: 1.518522024154663
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.148 Vali Acc: 0.254 Test Loss: 5.148 Test Acc: 0.254
Validation loss decreased (-0.251714 --> -0.254066).  Saving model ...
Epoch: 23 cost time: 1.7068257331848145
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.389 Vali Acc: 0.240 Test Loss: 5.389 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5915124416351318
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.394 Vali Acc: 0.252 Test Loss: 5.394 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3303918838500977
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.365 Vali Acc: 0.246 Test Loss: 5.365 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3890669345855713
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.359 Vali Acc: 0.238 Test Loss: 5.359 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7449796199798584
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.300 Vali Acc: 0.247 Test Loss: 5.300 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2580242156982422
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.331 Vali Acc: 0.240 Test Loss: 5.331 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5620923042297363
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.327 Vali Acc: 0.246 Test Loss: 5.327 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2494478225708008
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.339 Vali Acc: 0.247 Test Loss: 5.339 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6793348789215088
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.357 Vali Acc: 0.248 Test Loss: 5.357 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.100245475769043
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.362 Vali Acc: 0.251 Test Loss: 5.362 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 3854386
model size : 19.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5349268913269043
Epoch: 1, Steps: 10 | Train Loss: 3.345 Vali Loss: 3.335 Vali Acc: 0.045 Test Loss: 3.335 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.1554417610168457
Epoch: 2, Steps: 10 | Train Loss: 3.228 Vali Loss: 3.433 Vali Acc: 0.054 Test Loss: 3.433 Test Acc: 0.054
Validation loss decreased (-0.044673 --> -0.054083).  Saving model ...
Epoch: 3 cost time: 1.1050567626953125
Epoch: 3, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.349 Vali Acc: 0.082 Test Loss: 3.349 Test Acc: 0.082
Validation loss decreased (-0.054083 --> -0.082319).  Saving model ...
Epoch: 4 cost time: 0.9989755153656006
Epoch: 4, Steps: 10 | Train Loss: 2.838 Vali Loss: 3.288 Vali Acc: 0.112 Test Loss: 3.288 Test Acc: 0.112
Validation loss decreased (-0.082319 --> -0.111732).  Saving model ...
Epoch: 5 cost time: 1.1195101737976074
Epoch: 5, Steps: 10 | Train Loss: 2.530 Vali Loss: 3.324 Vali Acc: 0.108 Test Loss: 3.324 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.051663875579834
Epoch: 6, Steps: 10 | Train Loss: 2.217 Vali Loss: 3.350 Vali Acc: 0.115 Test Loss: 3.350 Test Acc: 0.115
Validation loss decreased (-0.111732 --> -0.115261).  Saving model ...
Epoch: 7 cost time: 1.143758773803711
Epoch: 7, Steps: 10 | Train Loss: 2.015 Vali Loss: 3.303 Vali Acc: 0.142 Test Loss: 3.303 Test Acc: 0.142
Validation loss decreased (-0.115261 --> -0.142320).  Saving model ...
Epoch: 8 cost time: 1.0582270622253418
Epoch: 8, Steps: 10 | Train Loss: 1.763 Vali Loss: 3.395 Vali Acc: 0.162 Test Loss: 3.395 Test Acc: 0.162
Validation loss decreased (-0.142320 --> -0.162319).  Saving model ...
Epoch: 9 cost time: 1.1992218494415283
Epoch: 9, Steps: 10 | Train Loss: 1.392 Vali Loss: 3.513 Vali Acc: 0.154 Test Loss: 3.513 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.20457124710083
Epoch: 10, Steps: 10 | Train Loss: 1.206 Vali Loss: 3.607 Vali Acc: 0.173 Test Loss: 3.607 Test Acc: 0.173
Validation loss decreased (-0.162319 --> -0.172905).  Saving model ...
Epoch: 11 cost time: 1.2929291725158691
Epoch: 11, Steps: 10 | Train Loss: 0.977 Vali Loss: 3.679 Vali Acc: 0.192 Test Loss: 3.679 Test Acc: 0.192
Validation loss decreased (-0.172905 --> -0.191728).  Saving model ...
Epoch: 12 cost time: 1.0156445503234863
Epoch: 12, Steps: 10 | Train Loss: 0.771 Vali Loss: 3.940 Vali Acc: 0.175 Test Loss: 3.940 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3302874565124512
Epoch: 13, Steps: 10 | Train Loss: 0.656 Vali Loss: 3.912 Vali Acc: 0.224 Test Loss: 3.912 Test Acc: 0.224
Validation loss decreased (-0.191728 --> -0.223490).  Saving model ...
Epoch: 14 cost time: 1.272230625152588
Epoch: 14, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.981 Vali Acc: 0.231 Test Loss: 3.981 Test Acc: 0.231
Validation loss decreased (-0.223490 --> -0.230548).  Saving model ...
Epoch: 15 cost time: 1.0479533672332764
Epoch: 15, Steps: 10 | Train Loss: 0.385 Vali Loss: 4.330 Vali Acc: 0.201 Test Loss: 4.330 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2293922901153564
Epoch: 16, Steps: 10 | Train Loss: 0.298 Vali Loss: 4.377 Vali Acc: 0.226 Test Loss: 4.377 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0156705379486084
Epoch: 17, Steps: 10 | Train Loss: 0.171 Vali Loss: 4.621 Vali Acc: 0.216 Test Loss: 4.621 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1782503128051758
Epoch: 18, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.648 Vali Acc: 0.239 Test Loss: 4.648 Test Acc: 0.239
Validation loss decreased (-0.230548 --> -0.238777).  Saving model ...
Epoch: 19 cost time: 1.4817798137664795
Epoch: 19, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.981 Vali Acc: 0.220 Test Loss: 4.981 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3049802780151367
Epoch: 20, Steps: 10 | Train Loss: 0.075 Vali Loss: 5.407 Vali Acc: 0.182 Test Loss: 5.407 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.247502088546753
Epoch: 21, Steps: 10 | Train Loss: 0.052 Vali Loss: 5.307 Vali Acc: 0.234 Test Loss: 5.307 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4128665924072266
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.057 Vali Acc: 0.244 Test Loss: 5.057 Test Acc: 0.244
Validation loss decreased (-0.238777 --> -0.243479).  Saving model ...
Epoch: 23 cost time: 1.3802216053009033
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.347 Vali Acc: 0.248 Test Loss: 5.347 Test Acc: 0.248
Validation loss decreased (-0.243479 --> -0.248182).  Saving model ...
Epoch: 24 cost time: 1.2449722290039062
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.314 Vali Acc: 0.260 Test Loss: 5.314 Test Acc: 0.260
Validation loss decreased (-0.248182 --> -0.259947).  Saving model ...
Epoch: 25 cost time: 1.064835786819458
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.347 Vali Acc: 0.253 Test Loss: 5.347 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5002970695495605
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.327 Vali Acc: 0.266 Test Loss: 5.327 Test Acc: 0.266
Validation loss decreased (-0.259947 --> -0.265829).  Saving model ...
Epoch: 27 cost time: 1.2424590587615967
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.336 Vali Acc: 0.266 Test Loss: 5.336 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3933284282684326
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.353 Vali Acc: 0.264 Test Loss: 5.353 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2748076915740967
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.353 Vali Acc: 0.268 Test Loss: 5.353 Test Acc: 0.268
Validation loss decreased (-0.265829 --> -0.268182).  Saving model ...
Epoch: 30 cost time: 1.1498210430145264
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.357 Vali Acc: 0.272 Test Loss: 5.357 Test Acc: 0.272
Validation loss decreased (-0.268182 --> -0.271711).  Saving model ...
Epoch: 31 cost time: 1.0944921970367432
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.381 Vali Acc: 0.276 Test Loss: 5.381 Test Acc: 0.276
Validation loss decreased (-0.271711 --> -0.276417).  Saving model ...
Epoch: 32 cost time: 1.0570969581604004
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.397 Vali Acc: 0.266 Test Loss: 5.397 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1940109729766846
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.409 Vali Acc: 0.268 Test Loss: 5.409 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.155791997909546
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.412 Vali Acc: 0.271 Test Loss: 5.412 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2184512615203857
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.412 Vali Acc: 0.274 Test Loss: 5.412 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9832596778869629
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.432 Vali Acc: 0.274 Test Loss: 5.432 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0057551860809326
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.449 Vali Acc: 0.274 Test Loss: 5.449 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0885334014892578
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.462 Vali Acc: 0.274 Test Loss: 5.462 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1046943664550781
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.477 Vali Acc: 0.273 Test Loss: 5.477 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1831443309783936
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.489 Vali Acc: 0.272 Test Loss: 5.489 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1188960075378418
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.499 Vali Acc: 0.273 Test Loss: 5.499 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 3851058
model size : 19.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.3236517906188965
Epoch: 1, Steps: 10 | Train Loss: 3.366 Vali Loss: 3.309 Vali Acc: 0.049 Test Loss: 3.309 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.2475874423980713
Epoch: 2, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.416 Vali Acc: 0.066 Test Loss: 3.416 Test Acc: 0.066
Validation loss decreased (-0.049379 --> -0.065848).  Saving model ...
Epoch: 3 cost time: 1.0948197841644287
Epoch: 3, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.291 Vali Acc: 0.099 Test Loss: 3.291 Test Acc: 0.099
Validation loss decreased (-0.065848 --> -0.098791).  Saving model ...
Epoch: 4 cost time: 1.0492806434631348
Epoch: 4, Steps: 10 | Train Loss: 2.852 Vali Loss: 3.251 Vali Acc: 0.126 Test Loss: 3.251 Test Acc: 0.126
Validation loss decreased (-0.098791 --> -0.125850).  Saving model ...
Epoch: 5 cost time: 1.1312179565429688
Epoch: 5, Steps: 10 | Train Loss: 2.552 Vali Loss: 3.273 Vali Acc: 0.120 Test Loss: 3.273 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1543681621551514
Epoch: 6, Steps: 10 | Train Loss: 2.260 Vali Loss: 3.345 Vali Acc: 0.139 Test Loss: 3.345 Test Acc: 0.139
Validation loss decreased (-0.125850 --> -0.138790).  Saving model ...
Epoch: 7 cost time: 0.9633560180664062
Epoch: 7, Steps: 10 | Train Loss: 2.031 Vali Loss: 3.306 Vali Acc: 0.166 Test Loss: 3.306 Test Acc: 0.166
Validation loss decreased (-0.138790 --> -0.165849).  Saving model ...
Epoch: 8 cost time: 0.9889082908630371
Epoch: 8, Steps: 10 | Train Loss: 1.630 Vali Loss: 3.351 Vali Acc: 0.156 Test Loss: 3.351 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3769128322601318
Epoch: 9, Steps: 10 | Train Loss: 1.465 Vali Loss: 3.431 Vali Acc: 0.187 Test Loss: 3.431 Test Acc: 0.187
Validation loss decreased (-0.165849 --> -0.187025).  Saving model ...
Epoch: 10 cost time: 1.3256089687347412
Epoch: 10, Steps: 10 | Train Loss: 1.217 Vali Loss: 3.590 Vali Acc: 0.161 Test Loss: 3.590 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2426114082336426
Epoch: 11, Steps: 10 | Train Loss: 1.051 Vali Loss: 3.635 Vali Acc: 0.200 Test Loss: 3.635 Test Acc: 0.200
Validation loss decreased (-0.187025 --> -0.199964).  Saving model ...
Epoch: 12 cost time: 1.0524234771728516
Epoch: 12, Steps: 10 | Train Loss: 0.863 Vali Loss: 3.731 Vali Acc: 0.214 Test Loss: 3.731 Test Acc: 0.214
Validation loss decreased (-0.199964 --> -0.214080).  Saving model ...
Epoch: 13 cost time: 0.9473898410797119
Epoch: 13, Steps: 10 | Train Loss: 0.634 Vali Loss: 3.808 Vali Acc: 0.218 Test Loss: 3.808 Test Acc: 0.218
Validation loss decreased (-0.214080 --> -0.217609).  Saving model ...
Epoch: 14 cost time: 1.2685000896453857
Epoch: 14, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.989 Vali Acc: 0.233 Test Loss: 3.989 Test Acc: 0.233
Validation loss decreased (-0.217609 --> -0.232901).  Saving model ...
Epoch: 15 cost time: 1.1752324104309082
Epoch: 15, Steps: 10 | Train Loss: 0.334 Vali Loss: 4.273 Vali Acc: 0.201 Test Loss: 4.273 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0724945068359375
Epoch: 16, Steps: 10 | Train Loss: 0.297 Vali Loss: 4.283 Vali Acc: 0.228 Test Loss: 4.283 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0813617706298828
Epoch: 17, Steps: 10 | Train Loss: 0.195 Vali Loss: 4.632 Vali Acc: 0.207 Test Loss: 4.632 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1366946697235107
Epoch: 18, Steps: 10 | Train Loss: 0.179 Vali Loss: 4.774 Vali Acc: 0.229 Test Loss: 4.774 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0925228595733643
Epoch: 19, Steps: 10 | Train Loss: 0.107 Vali Loss: 5.000 Vali Acc: 0.221 Test Loss: 5.000 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3145489692687988
Epoch: 20, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.992 Vali Acc: 0.252 Test Loss: 4.992 Test Acc: 0.252
Validation loss decreased (-0.232901 --> -0.251715).  Saving model ...
Epoch: 21 cost time: 1.0730915069580078
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.962 Vali Acc: 0.235 Test Loss: 4.962 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4048881530761719
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 5.107 Vali Acc: 0.235 Test Loss: 5.107 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.399122714996338
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.125 Vali Acc: 0.258 Test Loss: 5.125 Test Acc: 0.258
Validation loss decreased (-0.251715 --> -0.257596).  Saving model ...
Epoch: 24 cost time: 1.066028118133545
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.245 Vali Acc: 0.264 Test Loss: 5.245 Test Acc: 0.264
Validation loss decreased (-0.257596 --> -0.263477).  Saving model ...
Epoch: 25 cost time: 1.1171433925628662
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.366 Vali Acc: 0.262 Test Loss: 5.366 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0807757377624512
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.262 Vali Acc: 0.269 Test Loss: 5.262 Test Acc: 0.269
Validation loss decreased (-0.263477 --> -0.269359).  Saving model ...
Epoch: 27 cost time: 0.9583454132080078
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.276 Vali Acc: 0.259 Test Loss: 5.276 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3206408023834229
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.279 Vali Acc: 0.264 Test Loss: 5.279 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0405778884887695
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.291 Vali Acc: 0.269 Test Loss: 5.291 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.268580675125122
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.302 Vali Acc: 0.273 Test Loss: 5.302 Test Acc: 0.273
Validation loss decreased (-0.269359 --> -0.272888).  Saving model ...
Epoch: 31 cost time: 1.1399552822113037
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.303 Vali Acc: 0.271 Test Loss: 5.303 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2715773582458496
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.310 Vali Acc: 0.272 Test Loss: 5.310 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.127549409866333
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.317 Vali Acc: 0.272 Test Loss: 5.317 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2734746932983398
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.316 Vali Acc: 0.269 Test Loss: 5.316 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2154805660247803
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.325 Vali Acc: 0.269 Test Loss: 5.325 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.140153169631958
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.345 Vali Acc: 0.268 Test Loss: 5.345 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0763535499572754
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.361 Vali Acc: 0.271 Test Loss: 5.361 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2926807403564453
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.366 Vali Acc: 0.271 Test Loss: 5.366 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.32472562789917
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.373 Vali Acc: 0.268 Test Loss: 5.373 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3518030643463135
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.381 Vali Acc: 0.269 Test Loss: 5.381 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 3847730
model size : 19.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7210633754730225
Epoch: 1, Steps: 10 | Train Loss: 3.472 Vali Loss: 3.353 Vali Acc: 0.041 Test Loss: 3.353 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.3933539390563965
Epoch: 2, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.504 Vali Acc: 0.068 Test Loss: 3.504 Test Acc: 0.068
Validation loss decreased (-0.041143 --> -0.068200).  Saving model ...
Epoch: 3 cost time: 1.3251781463623047
Epoch: 3, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.308 Vali Acc: 0.089 Test Loss: 3.308 Test Acc: 0.089
Validation loss decreased (-0.068200 --> -0.089379).  Saving model ...
Epoch: 4 cost time: 1.1916720867156982
Epoch: 4, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.290 Vali Acc: 0.089 Test Loss: 3.290 Test Acc: 0.089
Validation loss decreased (-0.089379 --> -0.089379).  Saving model ...
Epoch: 5 cost time: 1.1513874530792236
Epoch: 5, Steps: 10 | Train Loss: 2.560 Vali Loss: 3.322 Vali Acc: 0.108 Test Loss: 3.322 Test Acc: 0.108
Validation loss decreased (-0.089379 --> -0.108202).  Saving model ...
Epoch: 6 cost time: 1.141303539276123
Epoch: 6, Steps: 10 | Train Loss: 2.224 Vali Loss: 3.234 Vali Acc: 0.172 Test Loss: 3.234 Test Acc: 0.172
Validation loss decreased (-0.108202 --> -0.171732).  Saving model ...
Epoch: 7 cost time: 1.0777051448822021
Epoch: 7, Steps: 10 | Train Loss: 2.072 Vali Loss: 3.335 Vali Acc: 0.141 Test Loss: 3.335 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4225587844848633
Epoch: 8, Steps: 10 | Train Loss: 1.832 Vali Loss: 3.334 Vali Acc: 0.164 Test Loss: 3.334 Test Acc: 0.164
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.194962978363037
Epoch: 9, Steps: 10 | Train Loss: 1.570 Vali Loss: 3.391 Vali Acc: 0.180 Test Loss: 3.391 Test Acc: 0.180
Validation loss decreased (-0.171732 --> -0.179966).  Saving model ...
Epoch: 10 cost time: 1.065704107284546
Epoch: 10, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.455 Vali Acc: 0.194 Test Loss: 3.455 Test Acc: 0.194
Validation loss decreased (-0.179966 --> -0.194083).  Saving model ...
Epoch: 11 cost time: 1.3262221813201904
Epoch: 11, Steps: 10 | Train Loss: 1.088 Vali Loss: 3.603 Vali Acc: 0.191 Test Loss: 3.603 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0511555671691895
Epoch: 12, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.917 Vali Acc: 0.182 Test Loss: 3.917 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0818142890930176
Epoch: 13, Steps: 10 | Train Loss: 0.666 Vali Loss: 3.819 Vali Acc: 0.212 Test Loss: 3.819 Test Acc: 0.212
Validation loss decreased (-0.194083 --> -0.211727).  Saving model ...
Epoch: 14 cost time: 1.5368802547454834
Epoch: 14, Steps: 10 | Train Loss: 0.447 Vali Loss: 4.203 Vali Acc: 0.199 Test Loss: 4.203 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2701530456542969
Epoch: 15, Steps: 10 | Train Loss: 0.370 Vali Loss: 4.138 Vali Acc: 0.214 Test Loss: 4.138 Test Acc: 0.214
Validation loss decreased (-0.211727 --> -0.214076).  Saving model ...
Epoch: 16 cost time: 1.097377061843872
Epoch: 16, Steps: 10 | Train Loss: 0.310 Vali Loss: 4.328 Vali Acc: 0.236 Test Loss: 4.328 Test Acc: 0.236
Validation loss decreased (-0.214076 --> -0.236427).  Saving model ...
Epoch: 17 cost time: 1.3449201583862305
Epoch: 17, Steps: 10 | Train Loss: 0.215 Vali Loss: 4.584 Vali Acc: 0.216 Test Loss: 4.584 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.282015085220337
Epoch: 18, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.696 Vali Acc: 0.236 Test Loss: 4.696 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3115029335021973
Epoch: 19, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.683 Vali Acc: 0.245 Test Loss: 4.683 Test Acc: 0.245
Validation loss decreased (-0.236427 --> -0.244659).  Saving model ...
Epoch: 20 cost time: 1.0949201583862305
Epoch: 20, Steps: 10 | Train Loss: 0.044 Vali Loss: 5.064 Vali Acc: 0.220 Test Loss: 5.064 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3197197914123535
Epoch: 21, Steps: 10 | Train Loss: 0.071 Vali Loss: 5.070 Vali Acc: 0.251 Test Loss: 5.070 Test Acc: 0.251
Validation loss decreased (-0.244659 --> -0.250538).  Saving model ...
Epoch: 22 cost time: 1.26194429397583
Epoch: 22, Steps: 10 | Train Loss: 0.070 Vali Loss: 5.375 Vali Acc: 0.242 Test Loss: 5.375 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2715821266174316
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 5.577 Vali Acc: 0.232 Test Loss: 5.577 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.051541805267334
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 5.269 Vali Acc: 0.260 Test Loss: 5.269 Test Acc: 0.260
Validation loss decreased (-0.250538 --> -0.259947).  Saving model ...
Epoch: 25 cost time: 0.9819505214691162
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.417 Vali Acc: 0.253 Test Loss: 5.417 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1653218269348145
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.536 Vali Acc: 0.255 Test Loss: 5.536 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.09678053855896
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.447 Vali Acc: 0.258 Test Loss: 5.447 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.445502519607544
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.382 Vali Acc: 0.260 Test Loss: 5.382 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9800186157226562
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.545 Vali Acc: 0.261 Test Loss: 5.545 Test Acc: 0.261
Validation loss decreased (-0.259947 --> -0.261121).  Saving model ...
Epoch: 30 cost time: 1.4181852340698242
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.406 Vali Acc: 0.268 Test Loss: 5.406 Test Acc: 0.268
Validation loss decreased (-0.261121 --> -0.268181).  Saving model ...
Epoch: 31 cost time: 1.4345238208770752
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.371 Vali Acc: 0.268 Test Loss: 5.371 Test Acc: 0.268
Validation loss decreased (-0.268181 --> -0.268182).  Saving model ...
Epoch: 32 cost time: 1.0718772411346436
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.366 Vali Acc: 0.274 Test Loss: 5.366 Test Acc: 0.274
Validation loss decreased (-0.268182 --> -0.274064).  Saving model ...
Epoch: 33 cost time: 1.019101619720459
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.387 Vali Acc: 0.266 Test Loss: 5.387 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3456554412841797
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.413 Vali Acc: 0.264 Test Loss: 5.413 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.16788649559021
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.420 Vali Acc: 0.261 Test Loss: 5.420 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3176109790802002
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.420 Vali Acc: 0.266 Test Loss: 5.420 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.043820858001709
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.423 Vali Acc: 0.267 Test Loss: 5.423 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.129411220550537
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.428 Vali Acc: 0.269 Test Loss: 5.428 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0537502765655518
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.440 Vali Acc: 0.268 Test Loss: 5.440 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0543348789215088
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.458 Vali Acc: 0.269 Test Loss: 5.458 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2341153621673584
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.469 Vali Acc: 0.271 Test Loss: 5.469 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0172252655029297
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.479 Vali Acc: 0.267 Test Loss: 5.479 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 3844402
model size : 19.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.8719944953918457
Epoch: 1, Steps: 10 | Train Loss: 3.418 Vali Loss: 3.330 Vali Acc: 0.042 Test Loss: 3.330 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.719404697418213
Epoch: 2, Steps: 10 | Train Loss: 3.235 Vali Loss: 3.480 Vali Acc: 0.038 Test Loss: 3.480 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5438365936279297
Epoch: 3, Steps: 10 | Train Loss: 3.078 Vali Loss: 3.324 Vali Acc: 0.089 Test Loss: 3.324 Test Acc: 0.089
Validation loss decreased (-0.042320 --> -0.089379).  Saving model ...
Epoch: 4 cost time: 1.417668342590332
Epoch: 4, Steps: 10 | Train Loss: 2.841 Vali Loss: 3.278 Vali Acc: 0.118 Test Loss: 3.278 Test Acc: 0.118
Validation loss decreased (-0.089379 --> -0.117614).  Saving model ...
Epoch: 5 cost time: 1.4823787212371826
Epoch: 5, Steps: 10 | Train Loss: 2.552 Vali Loss: 3.305 Vali Acc: 0.121 Test Loss: 3.305 Test Acc: 0.121
Validation loss decreased (-0.117614 --> -0.121143).  Saving model ...
Epoch: 6 cost time: 1.5662238597869873
Epoch: 6, Steps: 10 | Train Loss: 2.366 Vali Loss: 3.266 Vali Acc: 0.139 Test Loss: 3.266 Test Acc: 0.139
Validation loss decreased (-0.121143 --> -0.138791).  Saving model ...
Epoch: 7 cost time: 1.8317599296569824
Epoch: 7, Steps: 10 | Train Loss: 2.063 Vali Loss: 3.303 Vali Acc: 0.148 Test Loss: 3.303 Test Acc: 0.148
Validation loss decreased (-0.138791 --> -0.148202).  Saving model ...
Epoch: 8 cost time: 1.4395511150360107
Epoch: 8, Steps: 10 | Train Loss: 1.820 Vali Loss: 3.350 Vali Acc: 0.167 Test Loss: 3.350 Test Acc: 0.167
Validation loss decreased (-0.148202 --> -0.167025).  Saving model ...
Epoch: 9 cost time: 1.3113861083984375
Epoch: 9, Steps: 10 | Train Loss: 1.530 Vali Loss: 3.429 Vali Acc: 0.175 Test Loss: 3.429 Test Acc: 0.175
Validation loss decreased (-0.167025 --> -0.175260).  Saving model ...
Epoch: 10 cost time: 1.3060412406921387
Epoch: 10, Steps: 10 | Train Loss: 1.246 Vali Loss: 3.504 Vali Acc: 0.199 Test Loss: 3.504 Test Acc: 0.199
Validation loss decreased (-0.175260 --> -0.198788).  Saving model ...
Epoch: 11 cost time: 1.3614842891693115
Epoch: 11, Steps: 10 | Train Loss: 1.032 Vali Loss: 3.653 Vali Acc: 0.168 Test Loss: 3.653 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.226212501525879
Epoch: 12, Steps: 10 | Train Loss: 0.787 Vali Loss: 3.783 Vali Acc: 0.212 Test Loss: 3.783 Test Acc: 0.212
Validation loss decreased (-0.198788 --> -0.211727).  Saving model ...
Epoch: 13 cost time: 1.3380787372589111
Epoch: 13, Steps: 10 | Train Loss: 0.677 Vali Loss: 3.857 Vali Acc: 0.211 Test Loss: 3.857 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3608286380767822
Epoch: 14, Steps: 10 | Train Loss: 0.481 Vali Loss: 4.083 Vali Acc: 0.228 Test Loss: 4.083 Test Acc: 0.228
Validation loss decreased (-0.211727 --> -0.228194).  Saving model ...
Epoch: 15 cost time: 1.196930170059204
Epoch: 15, Steps: 10 | Train Loss: 0.397 Vali Loss: 4.201 Vali Acc: 0.211 Test Loss: 4.201 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2358503341674805
Epoch: 16, Steps: 10 | Train Loss: 0.374 Vali Loss: 4.381 Vali Acc: 0.218 Test Loss: 4.381 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5448393821716309
Epoch: 17, Steps: 10 | Train Loss: 0.230 Vali Loss: 4.769 Vali Acc: 0.191 Test Loss: 4.769 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5638031959533691
Epoch: 18, Steps: 10 | Train Loss: 0.166 Vali Loss: 4.630 Vali Acc: 0.226 Test Loss: 4.630 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1224896907806396
Epoch: 19, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.724 Vali Acc: 0.253 Test Loss: 4.724 Test Acc: 0.253
Validation loss decreased (-0.228194 --> -0.252894).  Saving model ...
Epoch: 20 cost time: 1.6523311138153076
Epoch: 20, Steps: 10 | Train Loss: 0.067 Vali Loss: 5.025 Vali Acc: 0.216 Test Loss: 5.025 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.301602840423584
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 5.172 Vali Acc: 0.229 Test Loss: 5.172 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.408567190170288
Epoch: 22, Steps: 10 | Train Loss: 0.042 Vali Loss: 5.325 Vali Acc: 0.244 Test Loss: 5.325 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2294440269470215
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 5.152 Vali Acc: 0.241 Test Loss: 5.152 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.664452314376831
Epoch: 24, Steps: 10 | Train Loss: 0.086 Vali Loss: 5.612 Vali Acc: 0.215 Test Loss: 5.612 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5260779857635498
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.899 Vali Acc: 0.216 Test Loss: 5.899 Test Acc: 0.216
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3116838932037354
Epoch: 26, Steps: 10 | Train Loss: 0.059 Vali Loss: 5.645 Vali Acc: 0.227 Test Loss: 5.645 Test Acc: 0.227
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3507273197174072
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.658 Vali Acc: 0.234 Test Loss: 5.658 Test Acc: 0.234
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5804448127746582
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.666 Vali Acc: 0.238 Test Loss: 5.666 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7118542194366455
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.602 Vali Acc: 0.235 Test Loss: 5.602 Test Acc: 0.235
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 3657394
model size : 18.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.485910177230835
Epoch: 1, Steps: 10 | Train Loss: 3.390 Vali Loss: 3.342 Vali Acc: 0.058 Test Loss: 3.342 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 1.210103988647461
Epoch: 2, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.460 Vali Acc: 0.048 Test Loss: 3.460 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2764978408813477
Epoch: 3, Steps: 10 | Train Loss: 3.136 Vali Loss: 3.302 Vali Acc: 0.068 Test Loss: 3.302 Test Acc: 0.068
Validation loss decreased (-0.057614 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 1.1015336513519287
Epoch: 4, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.358 Vali Acc: 0.074 Test Loss: 3.358 Test Acc: 0.074
Validation loss decreased (-0.068202 --> -0.074084).  Saving model ...
Epoch: 5 cost time: 1.0929205417633057
Epoch: 5, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.332 Vali Acc: 0.124 Test Loss: 3.332 Test Acc: 0.124
Validation loss decreased (-0.074084 --> -0.123496).  Saving model ...
Epoch: 6 cost time: 1.4415464401245117
Epoch: 6, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.329 Vali Acc: 0.129 Test Loss: 3.329 Test Acc: 0.129
Validation loss decreased (-0.123496 --> -0.129378).  Saving model ...
Epoch: 7 cost time: 1.2586822509765625
Epoch: 7, Steps: 10 | Train Loss: 2.069 Vali Loss: 3.298 Vali Acc: 0.131 Test Loss: 3.298 Test Acc: 0.131
Validation loss decreased (-0.129378 --> -0.130555).  Saving model ...
Epoch: 8 cost time: 1.7061829566955566
Epoch: 8, Steps: 10 | Train Loss: 1.823 Vali Loss: 3.294 Vali Acc: 0.171 Test Loss: 3.294 Test Acc: 0.171
Validation loss decreased (-0.130555 --> -0.170555).  Saving model ...
Epoch: 9 cost time: 1.3465805053710938
Epoch: 9, Steps: 10 | Train Loss: 1.484 Vali Loss: 3.432 Vali Acc: 0.167 Test Loss: 3.432 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4617347717285156
Epoch: 10, Steps: 10 | Train Loss: 1.347 Vali Loss: 3.450 Vali Acc: 0.171 Test Loss: 3.450 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4473402500152588
Epoch: 11, Steps: 10 | Train Loss: 1.086 Vali Loss: 3.671 Vali Acc: 0.186 Test Loss: 3.671 Test Acc: 0.186
Validation loss decreased (-0.170555 --> -0.185846).  Saving model ...
Epoch: 12 cost time: 1.3946964740753174
Epoch: 12, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.726 Vali Acc: 0.189 Test Loss: 3.726 Test Acc: 0.189
Validation loss decreased (-0.185846 --> -0.189375).  Saving model ...
Epoch: 13 cost time: 1.332571268081665
Epoch: 13, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.901 Vali Acc: 0.207 Test Loss: 3.901 Test Acc: 0.207
Validation loss decreased (-0.189375 --> -0.207020).  Saving model ...
Epoch: 14 cost time: 1.1686804294586182
Epoch: 14, Steps: 10 | Train Loss: 0.575 Vali Loss: 4.070 Vali Acc: 0.180 Test Loss: 4.070 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3197388648986816
Epoch: 15, Steps: 10 | Train Loss: 0.402 Vali Loss: 4.179 Vali Acc: 0.221 Test Loss: 4.179 Test Acc: 0.221
Validation loss decreased (-0.207020 --> -0.221135).  Saving model ...
Epoch: 16 cost time: 1.1590242385864258
Epoch: 16, Steps: 10 | Train Loss: 0.290 Vali Loss: 4.322 Vali Acc: 0.219 Test Loss: 4.322 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2775912284851074
Epoch: 17, Steps: 10 | Train Loss: 0.243 Vali Loss: 4.675 Vali Acc: 0.204 Test Loss: 4.675 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2310314178466797
Epoch: 18, Steps: 10 | Train Loss: 0.199 Vali Loss: 4.695 Vali Acc: 0.212 Test Loss: 4.695 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2825825214385986
Epoch: 19, Steps: 10 | Train Loss: 0.158 Vali Loss: 4.835 Vali Acc: 0.220 Test Loss: 4.835 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.070378065109253
Epoch: 20, Steps: 10 | Train Loss: 0.093 Vali Loss: 5.047 Vali Acc: 0.222 Test Loss: 5.047 Test Acc: 0.222
Validation loss decreased (-0.221135 --> -0.222302).  Saving model ...
Epoch: 21 cost time: 1.2629320621490479
Epoch: 21, Steps: 10 | Train Loss: 0.046 Vali Loss: 5.160 Vali Acc: 0.240 Test Loss: 5.160 Test Acc: 0.240
Validation loss decreased (-0.222302 --> -0.239948).  Saving model ...
Epoch: 22 cost time: 1.198779821395874
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 5.176 Vali Acc: 0.248 Test Loss: 5.176 Test Acc: 0.248
Validation loss decreased (-0.239948 --> -0.248184).  Saving model ...
Epoch: 23 cost time: 1.3283309936523438
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.194 Vali Acc: 0.254 Test Loss: 5.194 Test Acc: 0.254
Validation loss decreased (-0.248184 --> -0.254066).  Saving model ...
Epoch: 24 cost time: 1.178734540939331
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.242 Vali Acc: 0.255 Test Loss: 5.242 Test Acc: 0.255
Validation loss decreased (-0.254066 --> -0.255242).  Saving model ...
Epoch: 25 cost time: 1.2005794048309326
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.288 Vali Acc: 0.239 Test Loss: 5.288 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1247944831848145
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.382 Vali Acc: 0.253 Test Loss: 5.382 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2649550437927246
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.420 Vali Acc: 0.255 Test Loss: 5.420 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0080375671386719
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.435 Vali Acc: 0.255 Test Loss: 5.435 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2743942737579346
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.544 Vali Acc: 0.240 Test Loss: 5.544 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0459833145141602
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.431 Vali Acc: 0.255 Test Loss: 5.431 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0961570739746094
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.458 Vali Acc: 0.251 Test Loss: 5.458 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.4249601364135742
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.625 Vali Acc: 0.241 Test Loss: 5.625 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4420998096466064
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.513 Vali Acc: 0.252 Test Loss: 5.513 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.3063371181488037
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.582 Vali Acc: 0.251 Test Loss: 5.582 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 3654066
model size : 18.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.054579257965088
Epoch: 1, Steps: 10 | Train Loss: 3.426 Vali Loss: 3.356 Vali Acc: 0.035 Test Loss: 3.356 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 1.069199800491333
Epoch: 2, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.549 Vali Acc: 0.040 Test Loss: 3.549 Test Acc: 0.040
Validation loss decreased (-0.035261 --> -0.039965).  Saving model ...
Epoch: 3 cost time: 1.2436225414276123
Epoch: 3, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.323 Vali Acc: 0.052 Test Loss: 3.323 Test Acc: 0.052
Validation loss decreased (-0.039965 --> -0.051731).  Saving model ...
Epoch: 4 cost time: 1.1314654350280762
Epoch: 4, Steps: 10 | Train Loss: 2.817 Vali Loss: 3.328 Vali Acc: 0.085 Test Loss: 3.328 Test Acc: 0.085
Validation loss decreased (-0.051731 --> -0.084673).  Saving model ...
Epoch: 5 cost time: 1.1287059783935547
Epoch: 5, Steps: 10 | Train Loss: 2.571 Vali Loss: 3.204 Vali Acc: 0.131 Test Loss: 3.204 Test Acc: 0.131
Validation loss decreased (-0.084673 --> -0.130556).  Saving model ...
Epoch: 6 cost time: 1.1429896354675293
Epoch: 6, Steps: 10 | Train Loss: 2.293 Vali Loss: 3.377 Vali Acc: 0.104 Test Loss: 3.377 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0773265361785889
Epoch: 7, Steps: 10 | Train Loss: 2.083 Vali Loss: 3.199 Vali Acc: 0.181 Test Loss: 3.199 Test Acc: 0.181
Validation loss decreased (-0.130556 --> -0.181144).  Saving model ...
Epoch: 8 cost time: 1.2279508113861084
Epoch: 8, Steps: 10 | Train Loss: 1.935 Vali Loss: 3.412 Vali Acc: 0.140 Test Loss: 3.412 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9474828243255615
Epoch: 9, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.477 Vali Acc: 0.174 Test Loss: 3.477 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.006490707397461
Epoch: 10, Steps: 10 | Train Loss: 1.426 Vali Loss: 3.472 Vali Acc: 0.176 Test Loss: 3.472 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0909969806671143
Epoch: 11, Steps: 10 | Train Loss: 1.278 Vali Loss: 3.732 Vali Acc: 0.187 Test Loss: 3.732 Test Acc: 0.187
Validation loss decreased (-0.181144 --> -0.187021).  Saving model ...
Epoch: 12 cost time: 1.2131938934326172
Epoch: 12, Steps: 10 | Train Loss: 0.911 Vali Loss: 3.669 Vali Acc: 0.202 Test Loss: 3.669 Test Acc: 0.202
Validation loss decreased (-0.187021 --> -0.202316).  Saving model ...
Epoch: 13 cost time: 1.2181332111358643
Epoch: 13, Steps: 10 | Train Loss: 0.668 Vali Loss: 3.925 Vali Acc: 0.207 Test Loss: 3.925 Test Acc: 0.207
Validation loss decreased (-0.202316 --> -0.207020).  Saving model ...
Epoch: 14 cost time: 1.0711114406585693
Epoch: 14, Steps: 10 | Train Loss: 0.564 Vali Loss: 4.021 Vali Acc: 0.201 Test Loss: 4.021 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1530940532684326
Epoch: 15, Steps: 10 | Train Loss: 0.419 Vali Loss: 4.119 Vali Acc: 0.218 Test Loss: 4.119 Test Acc: 0.218
Validation loss decreased (-0.207020 --> -0.217606).  Saving model ...
Epoch: 16 cost time: 0.9915640354156494
Epoch: 16, Steps: 10 | Train Loss: 0.248 Vali Loss: 4.318 Vali Acc: 0.227 Test Loss: 4.318 Test Acc: 0.227
Validation loss decreased (-0.217606 --> -0.227016).  Saving model ...
Epoch: 17 cost time: 1.2655398845672607
Epoch: 17, Steps: 10 | Train Loss: 0.208 Vali Loss: 4.687 Vali Acc: 0.209 Test Loss: 4.687 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1777758598327637
Epoch: 18, Steps: 10 | Train Loss: 0.167 Vali Loss: 4.558 Vali Acc: 0.231 Test Loss: 4.558 Test Acc: 0.231
Validation loss decreased (-0.227016 --> -0.230543).  Saving model ...
Epoch: 19 cost time: 1.3627862930297852
Epoch: 19, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.939 Vali Acc: 0.233 Test Loss: 4.939 Test Acc: 0.233
Validation loss decreased (-0.230543 --> -0.232892).  Saving model ...
Epoch: 20 cost time: 1.2204062938690186
Epoch: 20, Steps: 10 | Train Loss: 0.104 Vali Loss: 5.010 Vali Acc: 0.226 Test Loss: 5.010 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2053132057189941
Epoch: 21, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.987 Vali Acc: 0.235 Test Loss: 4.987 Test Acc: 0.235
Validation loss decreased (-0.232892 --> -0.235244).  Saving model ...
Epoch: 22 cost time: 1.5378203392028809
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.972 Vali Acc: 0.234 Test Loss: 4.972 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.475036859512329
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.128 Vali Acc: 0.251 Test Loss: 5.128 Test Acc: 0.251
Validation loss decreased (-0.235244 --> -0.250537).  Saving model ...
Epoch: 24 cost time: 1.309180736541748
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.118 Vali Acc: 0.252 Test Loss: 5.118 Test Acc: 0.252
Validation loss decreased (-0.250537 --> -0.251714).  Saving model ...
Epoch: 25 cost time: 1.2580766677856445
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.078 Vali Acc: 0.272 Test Loss: 5.078 Test Acc: 0.272
Validation loss decreased (-0.251714 --> -0.271714).  Saving model ...
Epoch: 26 cost time: 1.4099640846252441
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.127 Vali Acc: 0.264 Test Loss: 5.127 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4269912242889404
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.123 Vali Acc: 0.260 Test Loss: 5.123 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2794389724731445
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.124 Vali Acc: 0.265 Test Loss: 5.124 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2545573711395264
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.144 Vali Acc: 0.269 Test Loss: 5.144 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0713186264038086
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.165 Vali Acc: 0.269 Test Loss: 5.165 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3107106685638428
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.184 Vali Acc: 0.268 Test Loss: 5.184 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2059786319732666
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.204 Vali Acc: 0.271 Test Loss: 5.204 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1364567279815674
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.216 Vali Acc: 0.272 Test Loss: 5.216 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.332695722579956
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.231 Vali Acc: 0.273 Test Loss: 5.231 Test Acc: 0.273
Validation loss decreased (-0.271714 --> -0.272889).  Saving model ...
Epoch: 35 cost time: 1.3231089115142822
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.236 Vali Acc: 0.276 Test Loss: 5.236 Test Acc: 0.276
Validation loss decreased (-0.272889 --> -0.276418).  Saving model ...
Epoch: 36 cost time: 1.1155855655670166
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.254 Vali Acc: 0.272 Test Loss: 5.254 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.725172996520996
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.266 Vali Acc: 0.275 Test Loss: 5.266 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.60089111328125
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.286 Vali Acc: 0.273 Test Loss: 5.286 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2617945671081543
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.295 Vali Acc: 0.274 Test Loss: 5.295 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.024113655090332
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.306 Vali Acc: 0.275 Test Loss: 5.306 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1373248100280762
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.321 Vali Acc: 0.273 Test Loss: 5.321 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2862677574157715
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.338 Vali Acc: 0.274 Test Loss: 5.338 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.5938708782196045
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.352 Vali Acc: 0.273 Test Loss: 5.352 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1273090839385986
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.370 Vali Acc: 0.274 Test Loss: 5.370 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.256868600845337
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.391 Vali Acc: 0.273 Test Loss: 5.391 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 3650738
model size : 18.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6401844024658203
Epoch: 1, Steps: 10 | Train Loss: 3.416 Vali Loss: 3.374 Vali Acc: 0.041 Test Loss: 3.374 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.4501986503601074
Epoch: 2, Steps: 10 | Train Loss: 3.221 Vali Loss: 3.456 Vali Acc: 0.075 Test Loss: 3.456 Test Acc: 0.075
Validation loss decreased (-0.041143 --> -0.075260).  Saving model ...
Epoch: 3 cost time: 1.3674578666687012
Epoch: 3, Steps: 10 | Train Loss: 3.015 Vali Loss: 3.268 Vali Acc: 0.101 Test Loss: 3.268 Test Acc: 0.101
Validation loss decreased (-0.075260 --> -0.101144).  Saving model ...
Epoch: 4 cost time: 1.3986632823944092
Epoch: 4, Steps: 10 | Train Loss: 2.828 Vali Loss: 3.264 Vali Acc: 0.129 Test Loss: 3.264 Test Acc: 0.129
Validation loss decreased (-0.101144 --> -0.129379).  Saving model ...
Epoch: 5 cost time: 1.846024990081787
Epoch: 5, Steps: 10 | Train Loss: 2.564 Vali Loss: 3.289 Vali Acc: 0.138 Test Loss: 3.289 Test Acc: 0.138
Validation loss decreased (-0.129379 --> -0.137614).  Saving model ...
Epoch: 6 cost time: 1.3679049015045166
Epoch: 6, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.269 Vali Acc: 0.151 Test Loss: 3.269 Test Acc: 0.151
Validation loss decreased (-0.137614 --> -0.150556).  Saving model ...
Epoch: 7 cost time: 1.7798590660095215
Epoch: 7, Steps: 10 | Train Loss: 2.117 Vali Loss: 3.264 Vali Acc: 0.142 Test Loss: 3.264 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.253364086151123
Epoch: 8, Steps: 10 | Train Loss: 1.792 Vali Loss: 3.430 Vali Acc: 0.136 Test Loss: 3.430 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6100316047668457
Epoch: 9, Steps: 10 | Train Loss: 1.624 Vali Loss: 3.377 Vali Acc: 0.166 Test Loss: 3.377 Test Acc: 0.166
Validation loss decreased (-0.150556 --> -0.165849).  Saving model ...
Epoch: 10 cost time: 1.5828516483306885
Epoch: 10, Steps: 10 | Train Loss: 1.501 Vali Loss: 3.469 Vali Acc: 0.199 Test Loss: 3.469 Test Acc: 0.199
Validation loss decreased (-0.165849 --> -0.198789).  Saving model ...
Epoch: 11 cost time: 1.3973157405853271
Epoch: 11, Steps: 10 | Train Loss: 1.240 Vali Loss: 3.622 Vali Acc: 0.196 Test Loss: 3.622 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0729868412017822
Epoch: 12, Steps: 10 | Train Loss: 0.840 Vali Loss: 3.739 Vali Acc: 0.202 Test Loss: 3.739 Test Acc: 0.202
Validation loss decreased (-0.198789 --> -0.202316).  Saving model ...
Epoch: 13 cost time: 1.12925386428833
Epoch: 13, Steps: 10 | Train Loss: 0.625 Vali Loss: 3.766 Vali Acc: 0.206 Test Loss: 3.766 Test Acc: 0.206
Validation loss decreased (-0.202316 --> -0.205845).  Saving model ...
Epoch: 14 cost time: 1.4390227794647217
Epoch: 14, Steps: 10 | Train Loss: 0.521 Vali Loss: 4.073 Vali Acc: 0.226 Test Loss: 4.073 Test Acc: 0.226
Validation loss decreased (-0.205845 --> -0.225842).  Saving model ...
Epoch: 15 cost time: 1.348318338394165
Epoch: 15, Steps: 10 | Train Loss: 0.417 Vali Loss: 4.050 Vali Acc: 0.244 Test Loss: 4.050 Test Acc: 0.244
Validation loss decreased (-0.225842 --> -0.243489).  Saving model ...
Epoch: 16 cost time: 1.288466453552246
Epoch: 16, Steps: 10 | Train Loss: 0.356 Vali Loss: 4.362 Vali Acc: 0.222 Test Loss: 4.362 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5489449501037598
Epoch: 17, Steps: 10 | Train Loss: 0.222 Vali Loss: 4.456 Vali Acc: 0.222 Test Loss: 4.456 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1459014415740967
Epoch: 18, Steps: 10 | Train Loss: 0.181 Vali Loss: 4.713 Vali Acc: 0.225 Test Loss: 4.713 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2661018371582031
Epoch: 19, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.841 Vali Acc: 0.235 Test Loss: 4.841 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6110765933990479
Epoch: 20, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.823 Vali Acc: 0.233 Test Loss: 4.823 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3473501205444336
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 5.023 Vali Acc: 0.251 Test Loss: 5.023 Test Acc: 0.251
Validation loss decreased (-0.243489 --> -0.250538).  Saving model ...
Epoch: 22 cost time: 1.092017650604248
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 5.237 Vali Acc: 0.234 Test Loss: 5.237 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.478365182876587
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.032 Vali Acc: 0.265 Test Loss: 5.032 Test Acc: 0.265
Validation loss decreased (-0.250538 --> -0.264656).  Saving model ...
Epoch: 24 cost time: 1.5185141563415527
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.229 Vali Acc: 0.254 Test Loss: 5.229 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4685351848602295
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.182 Vali Acc: 0.259 Test Loss: 5.182 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2362616062164307
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.344 Vali Acc: 0.253 Test Loss: 5.344 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4887769222259521
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.421 Vali Acc: 0.248 Test Loss: 5.421 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3899047374725342
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.499 Vali Acc: 0.256 Test Loss: 5.499 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.4848873615264893
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.455 Vali Acc: 0.265 Test Loss: 5.455 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5297305583953857
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.457 Vali Acc: 0.268 Test Loss: 5.457 Test Acc: 0.268
Validation loss decreased (-0.264656 --> -0.268181).  Saving model ...
Epoch: 31 cost time: 1.2827961444854736
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.484 Vali Acc: 0.251 Test Loss: 5.484 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2943229675292969
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.485 Vali Acc: 0.249 Test Loss: 5.485 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2782609462738037
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.490 Vali Acc: 0.252 Test Loss: 5.490 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.474846601486206
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.493 Vali Acc: 0.256 Test Loss: 5.493 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.212852954864502
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.503 Vali Acc: 0.259 Test Loss: 5.503 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.760831594467163
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.515 Vali Acc: 0.262 Test Loss: 5.515 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3987562656402588
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.531 Vali Acc: 0.261 Test Loss: 5.531 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3101751804351807
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.538 Vali Acc: 0.265 Test Loss: 5.538 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.378080129623413
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.552 Vali Acc: 0.261 Test Loss: 5.552 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3317279815673828
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.560 Vali Acc: 0.261 Test Loss: 5.560 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 3647410
model size : 18.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0478310585021973
Epoch: 1, Steps: 10 | Train Loss: 3.379 Vali Loss: 3.320 Vali Acc: 0.046 Test Loss: 3.320 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 1.3565645217895508
Epoch: 2, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.429 Vali Acc: 0.047 Test Loss: 3.429 Test Acc: 0.047
Validation loss decreased (-0.045849 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 1.4667186737060547
Epoch: 3, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.367 Vali Acc: 0.067 Test Loss: 3.367 Test Acc: 0.067
Validation loss decreased (-0.047025 --> -0.067025).  Saving model ...
Epoch: 4 cost time: 1.1037678718566895
Epoch: 4, Steps: 10 | Train Loss: 2.969 Vali Loss: 3.271 Vali Acc: 0.076 Test Loss: 3.271 Test Acc: 0.076
Validation loss decreased (-0.067025 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 0.9811136722564697
Epoch: 5, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.319 Vali Acc: 0.102 Test Loss: 3.319 Test Acc: 0.102
Validation loss decreased (-0.076438 --> -0.102320).  Saving model ...
Epoch: 6 cost time: 1.227853536605835
Epoch: 6, Steps: 10 | Train Loss: 2.611 Vali Loss: 3.229 Vali Acc: 0.122 Test Loss: 3.229 Test Acc: 0.122
Validation loss decreased (-0.102320 --> -0.122321).  Saving model ...
Epoch: 7 cost time: 0.96809983253479
Epoch: 7, Steps: 10 | Train Loss: 2.410 Vali Loss: 3.300 Vali Acc: 0.119 Test Loss: 3.300 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0591332912445068
Epoch: 8, Steps: 10 | Train Loss: 2.237 Vali Loss: 3.277 Vali Acc: 0.152 Test Loss: 3.277 Test Acc: 0.152
Validation loss decreased (-0.122321 --> -0.151732).  Saving model ...
Epoch: 9 cost time: 1.466933250427246
Epoch: 9, Steps: 10 | Train Loss: 1.957 Vali Loss: 3.292 Vali Acc: 0.161 Test Loss: 3.292 Test Acc: 0.161
Validation loss decreased (-0.151732 --> -0.161144).  Saving model ...
Epoch: 10 cost time: 1.1464719772338867
Epoch: 10, Steps: 10 | Train Loss: 1.724 Vali Loss: 3.335 Vali Acc: 0.159 Test Loss: 3.335 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.051743507385254
Epoch: 11, Steps: 10 | Train Loss: 1.468 Vali Loss: 3.353 Vali Acc: 0.174 Test Loss: 3.353 Test Acc: 0.174
Validation loss decreased (-0.161144 --> -0.174084).  Saving model ...
Epoch: 12 cost time: 1.193821907043457
Epoch: 12, Steps: 10 | Train Loss: 1.319 Vali Loss: 3.464 Vali Acc: 0.191 Test Loss: 3.464 Test Acc: 0.191
Validation loss decreased (-0.174084 --> -0.190554).  Saving model ...
Epoch: 13 cost time: 1.1338317394256592
Epoch: 13, Steps: 10 | Train Loss: 1.071 Vali Loss: 3.436 Vali Acc: 0.209 Test Loss: 3.436 Test Acc: 0.209
Validation loss decreased (-0.190554 --> -0.209377).  Saving model ...
Epoch: 14 cost time: 1.1287617683410645
Epoch: 14, Steps: 10 | Train Loss: 0.876 Vali Loss: 3.575 Vali Acc: 0.206 Test Loss: 3.575 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2091665267944336
Epoch: 15, Steps: 10 | Train Loss: 0.700 Vali Loss: 3.605 Vali Acc: 0.231 Test Loss: 3.605 Test Acc: 0.231
Validation loss decreased (-0.209377 --> -0.230552).  Saving model ...
Epoch: 16 cost time: 1.1343603134155273
Epoch: 16, Steps: 10 | Train Loss: 0.619 Vali Loss: 3.743 Vali Acc: 0.233 Test Loss: 3.743 Test Acc: 0.233
Validation loss decreased (-0.230552 --> -0.232904).  Saving model ...
Epoch: 17 cost time: 1.321091890335083
Epoch: 17, Steps: 10 | Train Loss: 0.509 Vali Loss: 3.841 Vali Acc: 0.225 Test Loss: 3.841 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.090012550354004
Epoch: 18, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.974 Vali Acc: 0.225 Test Loss: 3.974 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0580952167510986
Epoch: 19, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.978 Vali Acc: 0.218 Test Loss: 3.978 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1040797233581543
Epoch: 20, Steps: 10 | Train Loss: 0.224 Vali Loss: 4.122 Vali Acc: 0.226 Test Loss: 4.122 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3108961582183838
Epoch: 21, Steps: 10 | Train Loss: 0.182 Vali Loss: 4.231 Vali Acc: 0.216 Test Loss: 4.231 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8623287677764893
Epoch: 22, Steps: 10 | Train Loss: 0.145 Vali Loss: 4.284 Vali Acc: 0.232 Test Loss: 4.284 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9965827465057373
Epoch: 23, Steps: 10 | Train Loss: 0.118 Vali Loss: 4.386 Vali Acc: 0.245 Test Loss: 4.386 Test Acc: 0.245
Validation loss decreased (-0.232904 --> -0.244662).  Saving model ...
Epoch: 24 cost time: 0.9880425930023193
Epoch: 24, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.383 Vali Acc: 0.246 Test Loss: 4.383 Test Acc: 0.246
Validation loss decreased (-0.244662 --> -0.245839).  Saving model ...
Epoch: 25 cost time: 1.7693443298339844
Epoch: 25, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.483 Vali Acc: 0.238 Test Loss: 4.483 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1843748092651367
Epoch: 26, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.504 Vali Acc: 0.248 Test Loss: 4.504 Test Acc: 0.248
Validation loss decreased (-0.245839 --> -0.248190).  Saving model ...
Epoch: 27 cost time: 1.0549662113189697
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.568 Vali Acc: 0.244 Test Loss: 4.568 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0264225006103516
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.558 Vali Acc: 0.248 Test Loss: 4.558 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2531731128692627
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.645 Vali Acc: 0.251 Test Loss: 4.645 Test Acc: 0.251
Validation loss decreased (-0.248190 --> -0.250542).  Saving model ...
Epoch: 30 cost time: 1.184537649154663
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.643 Vali Acc: 0.255 Test Loss: 4.643 Test Acc: 0.255
Validation loss decreased (-0.250542 --> -0.255248).  Saving model ...
Epoch: 31 cost time: 0.8867125511169434
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.688 Vali Acc: 0.254 Test Loss: 4.688 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3965981006622314
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.659 Vali Acc: 0.265 Test Loss: 4.659 Test Acc: 0.265
Validation loss decreased (-0.255248 --> -0.264659).  Saving model ...
Epoch: 33 cost time: 1.1650142669677734
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.672 Vali Acc: 0.258 Test Loss: 4.672 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3435275554656982
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.711 Vali Acc: 0.260 Test Loss: 4.711 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1362149715423584
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.749 Vali Acc: 0.261 Test Loss: 4.749 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2529218196868896
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.783 Vali Acc: 0.258 Test Loss: 4.783 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4841022491455078
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.781 Vali Acc: 0.256 Test Loss: 4.781 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2885918617248535
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.794 Vali Acc: 0.262 Test Loss: 4.794 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.012932538986206
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.825 Vali Acc: 0.260 Test Loss: 4.825 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0835566520690918
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.847 Vali Acc: 0.260 Test Loss: 4.847 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.0599591732025146
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.869 Vali Acc: 0.265 Test Loss: 4.869 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.14438796043396
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.883 Vali Acc: 0.262 Test Loss: 4.883 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 1733298
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6031782627105713
Epoch: 1, Steps: 10 | Train Loss: 3.427 Vali Loss: 3.342 Vali Acc: 0.042 Test Loss: 3.342 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.4336018562316895
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.426 Vali Acc: 0.046 Test Loss: 3.426 Test Acc: 0.046
Validation loss decreased (-0.042320 --> -0.045848).  Saving model ...
Epoch: 3 cost time: 1.6154277324676514
Epoch: 3, Steps: 10 | Train Loss: 3.180 Vali Loss: 3.380 Vali Acc: 0.046 Test Loss: 3.380 Test Acc: 0.046
Validation loss decreased (-0.045848 --> -0.045849).  Saving model ...
Epoch: 4 cost time: 1.586930274963379
Epoch: 4, Steps: 10 | Train Loss: 2.991 Vali Loss: 3.307 Vali Acc: 0.087 Test Loss: 3.307 Test Acc: 0.087
Validation loss decreased (-0.045849 --> -0.087026).  Saving model ...
Epoch: 5 cost time: 1.3529167175292969
Epoch: 5, Steps: 10 | Train Loss: 2.819 Vali Loss: 3.255 Vali Acc: 0.102 Test Loss: 3.255 Test Acc: 0.102
Validation loss decreased (-0.087026 --> -0.102320).  Saving model ...
Epoch: 6 cost time: 1.6513986587524414
Epoch: 6, Steps: 10 | Train Loss: 2.644 Vali Loss: 3.281 Vali Acc: 0.107 Test Loss: 3.281 Test Acc: 0.107
Validation loss decreased (-0.102320 --> -0.107026).  Saving model ...
Epoch: 7 cost time: 1.3897747993469238
Epoch: 7, Steps: 10 | Train Loss: 2.454 Vali Loss: 3.263 Vali Acc: 0.129 Test Loss: 3.263 Test Acc: 0.129
Validation loss decreased (-0.107026 --> -0.129379).  Saving model ...
Epoch: 8 cost time: 1.2307219505310059
Epoch: 8, Steps: 10 | Train Loss: 2.266 Vali Loss: 3.231 Vali Acc: 0.131 Test Loss: 3.231 Test Acc: 0.131
Validation loss decreased (-0.129379 --> -0.130556).  Saving model ...
Epoch: 9 cost time: 1.3804748058319092
Epoch: 9, Steps: 10 | Train Loss: 1.985 Vali Loss: 3.267 Vali Acc: 0.158 Test Loss: 3.267 Test Acc: 0.158
Validation loss decreased (-0.130556 --> -0.157614).  Saving model ...
Epoch: 10 cost time: 1.4722983837127686
Epoch: 10, Steps: 10 | Train Loss: 1.812 Vali Loss: 3.254 Vali Acc: 0.162 Test Loss: 3.254 Test Acc: 0.162
Validation loss decreased (-0.157614 --> -0.162320).  Saving model ...
Epoch: 11 cost time: 1.2209789752960205
Epoch: 11, Steps: 10 | Train Loss: 1.556 Vali Loss: 3.362 Vali Acc: 0.176 Test Loss: 3.362 Test Acc: 0.176
Validation loss decreased (-0.162320 --> -0.176437).  Saving model ...
Epoch: 12 cost time: 1.4155824184417725
Epoch: 12, Steps: 10 | Train Loss: 1.295 Vali Loss: 3.384 Vali Acc: 0.184 Test Loss: 3.384 Test Acc: 0.184
Validation loss decreased (-0.176437 --> -0.183496).  Saving model ...
Epoch: 13 cost time: 1.2742838859558105
Epoch: 13, Steps: 10 | Train Loss: 1.127 Vali Loss: 3.459 Vali Acc: 0.200 Test Loss: 3.459 Test Acc: 0.200
Validation loss decreased (-0.183496 --> -0.199965).  Saving model ...
Epoch: 14 cost time: 1.1099343299865723
Epoch: 14, Steps: 10 | Train Loss: 0.935 Vali Loss: 3.484 Vali Acc: 0.202 Test Loss: 3.484 Test Acc: 0.202
Validation loss decreased (-0.199965 --> -0.202318).  Saving model ...
Epoch: 15 cost time: 1.117708444595337
Epoch: 15, Steps: 10 | Train Loss: 0.782 Vali Loss: 3.534 Vali Acc: 0.216 Test Loss: 3.534 Test Acc: 0.216
Validation loss decreased (-0.202318 --> -0.216435).  Saving model ...
Epoch: 16 cost time: 1.2096259593963623
Epoch: 16, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.598 Vali Acc: 0.231 Test Loss: 3.598 Test Acc: 0.231
Validation loss decreased (-0.216435 --> -0.230552).  Saving model ...
Epoch: 17 cost time: 1.4121010303497314
Epoch: 17, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.784 Vali Acc: 0.211 Test Loss: 3.784 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.702641248703003
Epoch: 18, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.866 Vali Acc: 0.216 Test Loss: 3.866 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1643333435058594
Epoch: 19, Steps: 10 | Train Loss: 0.314 Vali Loss: 3.913 Vali Acc: 0.226 Test Loss: 3.913 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2494802474975586
Epoch: 20, Steps: 10 | Train Loss: 0.237 Vali Loss: 4.036 Vali Acc: 0.236 Test Loss: 4.036 Test Acc: 0.236
Validation loss decreased (-0.230552 --> -0.236430).  Saving model ...
Epoch: 21 cost time: 1.1974260807037354
Epoch: 21, Steps: 10 | Train Loss: 0.181 Vali Loss: 4.168 Vali Acc: 0.224 Test Loss: 4.168 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3666293621063232
Epoch: 22, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.187 Vali Acc: 0.235 Test Loss: 4.187 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3463239669799805
Epoch: 23, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.266 Vali Acc: 0.231 Test Loss: 4.266 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3969206809997559
Epoch: 24, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.351 Vali Acc: 0.233 Test Loss: 4.351 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.57493257522583
Epoch: 25, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.454 Vali Acc: 0.231 Test Loss: 4.454 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2591090202331543
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.490 Vali Acc: 0.229 Test Loss: 4.490 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4469218254089355
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.499 Vali Acc: 0.231 Test Loss: 4.499 Test Acc: 0.231
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.701216220855713
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.604 Vali Acc: 0.235 Test Loss: 4.604 Test Acc: 0.235
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8236901760101318
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.625 Vali Acc: 0.232 Test Loss: 4.625 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1453518867492676
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.632 Vali Acc: 0.236 Test Loss: 4.632 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23647058823529413
model parameter : 1731634
model size : 9.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.605616331100464
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.319 Vali Acc: 0.065 Test Loss: 3.319 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 1.0764753818511963
Epoch: 2, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.459 Vali Acc: 0.048 Test Loss: 3.459 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.053452730178833
Epoch: 3, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.352 Vali Acc: 0.087 Test Loss: 3.352 Test Acc: 0.087
Validation loss decreased (-0.064673 --> -0.087025).  Saving model ...
Epoch: 4 cost time: 1.1451706886291504
Epoch: 4, Steps: 10 | Train Loss: 2.936 Vali Loss: 3.289 Vali Acc: 0.084 Test Loss: 3.289 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0756959915161133
Epoch: 5, Steps: 10 | Train Loss: 2.796 Vali Loss: 3.272 Vali Acc: 0.112 Test Loss: 3.272 Test Acc: 0.112
Validation loss decreased (-0.087025 --> -0.111732).  Saving model ...
Epoch: 6 cost time: 1.1368658542633057
Epoch: 6, Steps: 10 | Train Loss: 2.566 Vali Loss: 3.293 Vali Acc: 0.126 Test Loss: 3.293 Test Acc: 0.126
Validation loss decreased (-0.111732 --> -0.125849).  Saving model ...
Epoch: 7 cost time: 1.1360642910003662
Epoch: 7, Steps: 10 | Train Loss: 2.429 Vali Loss: 3.251 Vali Acc: 0.120 Test Loss: 3.251 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0876686573028564
Epoch: 8, Steps: 10 | Train Loss: 2.217 Vali Loss: 3.309 Vali Acc: 0.126 Test Loss: 3.309 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.134718418121338
Epoch: 9, Steps: 10 | Train Loss: 1.906 Vali Loss: 3.319 Vali Acc: 0.140 Test Loss: 3.319 Test Acc: 0.140
Validation loss decreased (-0.125849 --> -0.139967).  Saving model ...
Epoch: 10 cost time: 0.9221594333648682
Epoch: 10, Steps: 10 | Train Loss: 1.752 Vali Loss: 3.338 Vali Acc: 0.156 Test Loss: 3.338 Test Acc: 0.156
Validation loss decreased (-0.139967 --> -0.156437).  Saving model ...
Epoch: 11 cost time: 1.0884315967559814
Epoch: 11, Steps: 10 | Train Loss: 1.505 Vali Loss: 3.369 Vali Acc: 0.172 Test Loss: 3.369 Test Acc: 0.172
Validation loss decreased (-0.156437 --> -0.171731).  Saving model ...
Epoch: 12 cost time: 1.1029808521270752
Epoch: 12, Steps: 10 | Train Loss: 1.321 Vali Loss: 3.442 Vali Acc: 0.171 Test Loss: 3.442 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.211704969406128
Epoch: 13, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.513 Vali Acc: 0.191 Test Loss: 3.513 Test Acc: 0.191
Validation loss decreased (-0.171731 --> -0.190553).  Saving model ...
Epoch: 14 cost time: 1.0096983909606934
Epoch: 14, Steps: 10 | Train Loss: 0.948 Vali Loss: 3.614 Vali Acc: 0.195 Test Loss: 3.614 Test Acc: 0.195
Validation loss decreased (-0.190553 --> -0.195258).  Saving model ...
Epoch: 15 cost time: 1.194058895111084
Epoch: 15, Steps: 10 | Train Loss: 0.719 Vali Loss: 3.607 Vali Acc: 0.219 Test Loss: 3.607 Test Acc: 0.219
Validation loss decreased (-0.195258 --> -0.218787).  Saving model ...
Epoch: 16 cost time: 1.2529287338256836
Epoch: 16, Steps: 10 | Train Loss: 0.599 Vali Loss: 3.742 Vali Acc: 0.214 Test Loss: 3.742 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0368638038635254
Epoch: 17, Steps: 10 | Train Loss: 0.465 Vali Loss: 3.860 Vali Acc: 0.208 Test Loss: 3.860 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1398587226867676
Epoch: 18, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.899 Vali Acc: 0.222 Test Loss: 3.899 Test Acc: 0.222
Validation loss decreased (-0.218787 --> -0.222314).  Saving model ...
Epoch: 19 cost time: 1.14430832862854
Epoch: 19, Steps: 10 | Train Loss: 0.272 Vali Loss: 4.096 Vali Acc: 0.220 Test Loss: 4.096 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1042826175689697
Epoch: 20, Steps: 10 | Train Loss: 0.210 Vali Loss: 4.093 Vali Acc: 0.225 Test Loss: 4.093 Test Acc: 0.225
Validation loss decreased (-0.222314 --> -0.224665).  Saving model ...
Epoch: 21 cost time: 0.938697099685669
Epoch: 21, Steps: 10 | Train Loss: 0.141 Vali Loss: 4.240 Vali Acc: 0.228 Test Loss: 4.240 Test Acc: 0.228
Validation loss decreased (-0.224665 --> -0.228193).  Saving model ...
Epoch: 22 cost time: 1.1567609310150146
Epoch: 22, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.282 Vali Acc: 0.229 Test Loss: 4.282 Test Acc: 0.229
Validation loss decreased (-0.228193 --> -0.229369).  Saving model ...
Epoch: 23 cost time: 1.1394522190093994
Epoch: 23, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.435 Vali Acc: 0.231 Test Loss: 4.435 Test Acc: 0.231
Validation loss decreased (-0.229369 --> -0.230544).  Saving model ...
Epoch: 24 cost time: 1.1041738986968994
Epoch: 24, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.512 Vali Acc: 0.221 Test Loss: 4.512 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3552863597869873
Epoch: 25, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.526 Vali Acc: 0.225 Test Loss: 4.526 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0935876369476318
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.606 Vali Acc: 0.232 Test Loss: 4.606 Test Acc: 0.232
Validation loss decreased (-0.230544 --> -0.231719).  Saving model ...
Epoch: 27 cost time: 1.1106164455413818
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.671 Vali Acc: 0.232 Test Loss: 4.671 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1105844974517822
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.639 Vali Acc: 0.236 Test Loss: 4.639 Test Acc: 0.236
Validation loss decreased (-0.231719 --> -0.236424).  Saving model ...
Epoch: 29 cost time: 1.1237390041351318
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.617 Vali Acc: 0.244 Test Loss: 4.617 Test Acc: 0.244
Validation loss decreased (-0.236424 --> -0.243483).  Saving model ...
Epoch: 30 cost time: 1.320427417755127
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.637 Vali Acc: 0.248 Test Loss: 4.637 Test Acc: 0.248
Validation loss decreased (-0.243483 --> -0.248189).  Saving model ...
Epoch: 31 cost time: 1.0267910957336426
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.654 Vali Acc: 0.256 Test Loss: 4.654 Test Acc: 0.256
Validation loss decreased (-0.248189 --> -0.256424).  Saving model ...
Epoch: 32 cost time: 1.3087835311889648
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.684 Vali Acc: 0.249 Test Loss: 4.684 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2576475143432617
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.697 Vali Acc: 0.256 Test Loss: 4.697 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.205545425415039
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.712 Vali Acc: 0.260 Test Loss: 4.712 Test Acc: 0.260
Validation loss decreased (-0.256424 --> -0.259953).  Saving model ...
Epoch: 35 cost time: 1.1507666110992432
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.751 Vali Acc: 0.254 Test Loss: 4.751 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4624700546264648
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.782 Vali Acc: 0.255 Test Loss: 4.782 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1118831634521484
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.796 Vali Acc: 0.260 Test Loss: 4.796 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3456156253814697
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.824 Vali Acc: 0.252 Test Loss: 4.824 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.5219612121582031
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.830 Vali Acc: 0.259 Test Loss: 4.830 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.2839407920837402
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.844 Vali Acc: 0.261 Test Loss: 4.844 Test Acc: 0.261
Validation loss decreased (-0.259953 --> -0.261128).  Saving model ...
Epoch: 41 cost time: 1.4940123558044434
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.864 Vali Acc: 0.256 Test Loss: 4.864 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1416947841644287
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.865 Vali Acc: 0.262 Test Loss: 4.865 Test Acc: 0.262
Validation loss decreased (-0.261128 --> -0.262304).  Saving model ...
Epoch: 43 cost time: 1.383430004119873
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.893 Vali Acc: 0.255 Test Loss: 4.893 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2953135967254639
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.913 Vali Acc: 0.255 Test Loss: 4.913 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9116196632385254
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.939 Vali Acc: 0.256 Test Loss: 4.939 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0460724830627441
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.951 Vali Acc: 0.254 Test Loss: 4.951 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1905021667480469
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.950 Vali Acc: 0.260 Test Loss: 4.950 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1261322498321533
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.964 Vali Acc: 0.258 Test Loss: 4.964 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.202239990234375
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.004 Vali Acc: 0.253 Test Loss: 5.004 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.3146424293518066
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.998 Vali Acc: 0.255 Test Loss: 4.998 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.115727424621582
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.997 Vali Acc: 0.255 Test Loss: 4.997 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.174281358718872
Epoch: 52, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.016 Vali Acc: 0.253 Test Loss: 5.016 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26235294117647057
model parameter : 1729970
model size : 9.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6050281524658203
Epoch: 1, Steps: 10 | Train Loss: 3.402 Vali Loss: 3.333 Vali Acc: 0.040 Test Loss: 3.333 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.1991679668426514
Epoch: 2, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.428 Vali Acc: 0.056 Test Loss: 3.428 Test Acc: 0.056
Validation loss decreased (-0.039967 --> -0.056436).  Saving model ...
Epoch: 3 cost time: 1.258105993270874
Epoch: 3, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.390 Vali Acc: 0.062 Test Loss: 3.390 Test Acc: 0.062
Validation loss decreased (-0.056436 --> -0.062319).  Saving model ...
Epoch: 4 cost time: 1.2665982246398926
Epoch: 4, Steps: 10 | Train Loss: 2.947 Vali Loss: 3.304 Vali Acc: 0.079 Test Loss: 3.304 Test Acc: 0.079
Validation loss decreased (-0.062319 --> -0.078790).  Saving model ...
Epoch: 5 cost time: 1.439589500427246
Epoch: 5, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.311 Vali Acc: 0.095 Test Loss: 3.311 Test Acc: 0.095
Validation loss decreased (-0.078790 --> -0.095261).  Saving model ...
Epoch: 6 cost time: 1.3006813526153564
Epoch: 6, Steps: 10 | Train Loss: 2.607 Vali Loss: 3.233 Vali Acc: 0.099 Test Loss: 3.233 Test Acc: 0.099
Validation loss decreased (-0.095261 --> -0.098791).  Saving model ...
Epoch: 7 cost time: 1.1998310089111328
Epoch: 7, Steps: 10 | Train Loss: 2.415 Vali Loss: 3.303 Vali Acc: 0.106 Test Loss: 3.303 Test Acc: 0.106
Validation loss decreased (-0.098791 --> -0.105849).  Saving model ...
Epoch: 8 cost time: 1.2305502891540527
Epoch: 8, Steps: 10 | Train Loss: 2.187 Vali Loss: 3.300 Vali Acc: 0.134 Test Loss: 3.300 Test Acc: 0.134
Validation loss decreased (-0.105849 --> -0.134085).  Saving model ...
Epoch: 9 cost time: 1.3914899826049805
Epoch: 9, Steps: 10 | Train Loss: 2.017 Vali Loss: 3.255 Vali Acc: 0.142 Test Loss: 3.255 Test Acc: 0.142
Validation loss decreased (-0.134085 --> -0.142320).  Saving model ...
Epoch: 10 cost time: 1.126844882965088
Epoch: 10, Steps: 10 | Train Loss: 1.753 Vali Loss: 3.337 Vali Acc: 0.148 Test Loss: 3.337 Test Acc: 0.148
Validation loss decreased (-0.142320 --> -0.148202).  Saving model ...
Epoch: 11 cost time: 1.299727201461792
Epoch: 11, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.332 Vali Acc: 0.167 Test Loss: 3.332 Test Acc: 0.167
Validation loss decreased (-0.148202 --> -0.167026).  Saving model ...
Epoch: 12 cost time: 1.4905247688293457
Epoch: 12, Steps: 10 | Train Loss: 1.347 Vali Loss: 3.392 Vali Acc: 0.193 Test Loss: 3.392 Test Acc: 0.193
Validation loss decreased (-0.167026 --> -0.192907).  Saving model ...
Epoch: 13 cost time: 1.3258962631225586
Epoch: 13, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.529 Vali Acc: 0.188 Test Loss: 3.529 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3754026889801025
Epoch: 14, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.488 Vali Acc: 0.209 Test Loss: 3.488 Test Acc: 0.209
Validation loss decreased (-0.192907 --> -0.209377).  Saving model ...
Epoch: 15 cost time: 1.094660758972168
Epoch: 15, Steps: 10 | Train Loss: 0.849 Vali Loss: 3.618 Vali Acc: 0.204 Test Loss: 3.618 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3282394409179688
Epoch: 16, Steps: 10 | Train Loss: 0.656 Vali Loss: 3.714 Vali Acc: 0.209 Test Loss: 3.714 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4497127532958984
Epoch: 17, Steps: 10 | Train Loss: 0.498 Vali Loss: 3.761 Vali Acc: 0.221 Test Loss: 3.761 Test Acc: 0.221
Validation loss decreased (-0.209377 --> -0.221139).  Saving model ...
Epoch: 18 cost time: 1.3145453929901123
Epoch: 18, Steps: 10 | Train Loss: 0.435 Vali Loss: 3.801 Vali Acc: 0.240 Test Loss: 3.801 Test Acc: 0.240
Validation loss decreased (-0.221139 --> -0.239962).  Saving model ...
Epoch: 19 cost time: 1.115790843963623
Epoch: 19, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.919 Vali Acc: 0.232 Test Loss: 3.919 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4073755741119385
Epoch: 20, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.949 Vali Acc: 0.234 Test Loss: 3.949 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3960421085357666
Epoch: 21, Steps: 10 | Train Loss: 0.152 Vali Loss: 4.207 Vali Acc: 0.233 Test Loss: 4.207 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3748290538787842
Epoch: 22, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.102 Vali Acc: 0.251 Test Loss: 4.102 Test Acc: 0.251
Validation loss decreased (-0.239962 --> -0.250547).  Saving model ...
Epoch: 23 cost time: 1.2343125343322754
Epoch: 23, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.335 Vali Acc: 0.242 Test Loss: 4.335 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.032320499420166
Epoch: 24, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.391 Vali Acc: 0.253 Test Loss: 4.391 Test Acc: 0.253
Validation loss decreased (-0.250547 --> -0.252897).  Saving model ...
Epoch: 25 cost time: 1.1842365264892578
Epoch: 25, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.357 Vali Acc: 0.244 Test Loss: 4.357 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4807839393615723
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.514 Vali Acc: 0.246 Test Loss: 4.514 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1143138408660889
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.452 Vali Acc: 0.247 Test Loss: 4.452 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5743553638458252
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.492 Vali Acc: 0.259 Test Loss: 4.492 Test Acc: 0.259
Validation loss decreased (-0.252897 --> -0.258779).  Saving model ...
Epoch: 29 cost time: 1.1199548244476318
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.549 Vali Acc: 0.251 Test Loss: 4.549 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.262760877609253
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.629 Vali Acc: 0.246 Test Loss: 4.629 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.618565320968628
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.628 Vali Acc: 0.252 Test Loss: 4.628 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6059954166412354
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.635 Vali Acc: 0.259 Test Loss: 4.635 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4714314937591553
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.684 Vali Acc: 0.256 Test Loss: 4.684 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2696049213409424
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.679 Vali Acc: 0.261 Test Loss: 4.679 Test Acc: 0.261
Validation loss decreased (-0.258779 --> -0.261130).  Saving model ...
Epoch: 35 cost time: 1.3096435070037842
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.697 Vali Acc: 0.259 Test Loss: 4.697 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1656301021575928
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.784 Vali Acc: 0.256 Test Loss: 4.784 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2082252502441406
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.762 Vali Acc: 0.255 Test Loss: 4.762 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2921841144561768
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.745 Vali Acc: 0.258 Test Loss: 4.745 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.646066427230835
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.760 Vali Acc: 0.256 Test Loss: 4.760 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.2243385314941406
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.787 Vali Acc: 0.259 Test Loss: 4.787 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2215452194213867
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.815 Vali Acc: 0.260 Test Loss: 4.815 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.293067455291748
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.847 Vali Acc: 0.261 Test Loss: 4.847 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.8588957786560059
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.874 Vali Acc: 0.259 Test Loss: 4.874 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.4606459140777588
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.896 Vali Acc: 0.254 Test Loss: 4.896 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 1728306
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3594515323638916
Epoch: 1, Steps: 10 | Train Loss: 3.428 Vali Loss: 3.293 Vali Acc: 0.047 Test Loss: 3.293 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.4287152290344238
Epoch: 2, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.403 Vali Acc: 0.053 Test Loss: 3.403 Test Acc: 0.053
Validation loss decreased (-0.047026 --> -0.052907).  Saving model ...
Epoch: 3 cost time: 1.182607650756836
Epoch: 3, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.397 Vali Acc: 0.049 Test Loss: 3.397 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1917178630828857
Epoch: 4, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.276 Vali Acc: 0.079 Test Loss: 3.276 Test Acc: 0.079
Validation loss decreased (-0.052907 --> -0.078791).  Saving model ...
Epoch: 5 cost time: 1.2130441665649414
Epoch: 5, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.261 Vali Acc: 0.086 Test Loss: 3.261 Test Acc: 0.086
Validation loss decreased (-0.078791 --> -0.085850).  Saving model ...
Epoch: 6 cost time: 1.3305563926696777
Epoch: 6, Steps: 10 | Train Loss: 2.630 Vali Loss: 3.255 Vali Acc: 0.114 Test Loss: 3.255 Test Acc: 0.114
Validation loss decreased (-0.085850 --> -0.114085).  Saving model ...
Epoch: 7 cost time: 1.4279563426971436
Epoch: 7, Steps: 10 | Train Loss: 2.465 Vali Loss: 3.277 Vali Acc: 0.125 Test Loss: 3.277 Test Acc: 0.125
Validation loss decreased (-0.114085 --> -0.124673).  Saving model ...
Epoch: 8 cost time: 1.2920973300933838
Epoch: 8, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.233 Vali Acc: 0.131 Test Loss: 3.233 Test Acc: 0.131
Validation loss decreased (-0.124673 --> -0.130556).  Saving model ...
Epoch: 9 cost time: 1.058955430984497
Epoch: 9, Steps: 10 | Train Loss: 2.041 Vali Loss: 3.247 Vali Acc: 0.152 Test Loss: 3.247 Test Acc: 0.152
Validation loss decreased (-0.130556 --> -0.151732).  Saving model ...
Epoch: 10 cost time: 1.145890712738037
Epoch: 10, Steps: 10 | Train Loss: 1.846 Vali Loss: 3.328 Vali Acc: 0.158 Test Loss: 3.328 Test Acc: 0.158
Validation loss decreased (-0.151732 --> -0.157614).  Saving model ...
Epoch: 11 cost time: 1.203444480895996
Epoch: 11, Steps: 10 | Train Loss: 1.657 Vali Loss: 3.339 Vali Acc: 0.159 Test Loss: 3.339 Test Acc: 0.159
Validation loss decreased (-0.157614 --> -0.158790).  Saving model ...
Epoch: 12 cost time: 1.3291230201721191
Epoch: 12, Steps: 10 | Train Loss: 1.481 Vali Loss: 3.340 Vali Acc: 0.187 Test Loss: 3.340 Test Acc: 0.187
Validation loss decreased (-0.158790 --> -0.187025).  Saving model ...
Epoch: 13 cost time: 1.030890941619873
Epoch: 13, Steps: 10 | Train Loss: 1.284 Vali Loss: 3.527 Vali Acc: 0.185 Test Loss: 3.527 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5086705684661865
Epoch: 14, Steps: 10 | Train Loss: 1.017 Vali Loss: 3.486 Vali Acc: 0.200 Test Loss: 3.486 Test Acc: 0.200
Validation loss decreased (-0.187025 --> -0.199965).  Saving model ...
Epoch: 15 cost time: 1.0985548496246338
Epoch: 15, Steps: 10 | Train Loss: 0.868 Vali Loss: 3.589 Vali Acc: 0.204 Test Loss: 3.589 Test Acc: 0.204
Validation loss decreased (-0.199965 --> -0.203494).  Saving model ...
Epoch: 16 cost time: 0.9308836460113525
Epoch: 16, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.620 Vali Acc: 0.226 Test Loss: 3.620 Test Acc: 0.226
Validation loss decreased (-0.203494 --> -0.225846).  Saving model ...
Epoch: 17 cost time: 1.03959059715271
Epoch: 17, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.731 Vali Acc: 0.224 Test Loss: 3.731 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2938385009765625
Epoch: 18, Steps: 10 | Train Loss: 0.479 Vali Loss: 3.862 Vali Acc: 0.239 Test Loss: 3.862 Test Acc: 0.239
Validation loss decreased (-0.225846 --> -0.238785).  Saving model ...
Epoch: 19 cost time: 1.244847059249878
Epoch: 19, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.885 Vali Acc: 0.222 Test Loss: 3.885 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0738322734832764
Epoch: 20, Steps: 10 | Train Loss: 0.308 Vali Loss: 4.014 Vali Acc: 0.235 Test Loss: 4.014 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.382922887802124
Epoch: 21, Steps: 10 | Train Loss: 0.211 Vali Loss: 4.171 Vali Acc: 0.227 Test Loss: 4.171 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5765626430511475
Epoch: 22, Steps: 10 | Train Loss: 0.153 Vali Loss: 4.255 Vali Acc: 0.239 Test Loss: 4.255 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2064259052276611
Epoch: 23, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.472 Vali Acc: 0.215 Test Loss: 4.472 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.393831491470337
Epoch: 24, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.300 Vali Acc: 0.238 Test Loss: 4.300 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4779324531555176
Epoch: 25, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.436 Vali Acc: 0.254 Test Loss: 4.436 Test Acc: 0.254
Validation loss decreased (-0.238785 --> -0.254073).  Saving model ...
Epoch: 26 cost time: 1.2148547172546387
Epoch: 26, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.517 Vali Acc: 0.241 Test Loss: 4.517 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.166414499282837
Epoch: 27, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.530 Vali Acc: 0.244 Test Loss: 4.530 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.404679775238037
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.584 Vali Acc: 0.245 Test Loss: 4.584 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3383889198303223
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.571 Vali Acc: 0.251 Test Loss: 4.571 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5654747486114502
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.658 Vali Acc: 0.253 Test Loss: 4.658 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2270519733428955
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.658 Vali Acc: 0.254 Test Loss: 4.658 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1893136501312256
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.673 Vali Acc: 0.253 Test Loss: 4.673 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.145963430404663
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.699 Vali Acc: 0.256 Test Loss: 4.699 Test Acc: 0.256
Validation loss decreased (-0.254073 --> -0.256424).  Saving model ...
Epoch: 34 cost time: 1.0787262916564941
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.705 Vali Acc: 0.255 Test Loss: 4.705 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0710411071777344
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.787 Vali Acc: 0.253 Test Loss: 4.787 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.506636381149292
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.799 Vali Acc: 0.254 Test Loss: 4.799 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6393706798553467
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.792 Vali Acc: 0.251 Test Loss: 4.792 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.347754955291748
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.795 Vali Acc: 0.254 Test Loss: 4.795 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2152090072631836
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.828 Vali Acc: 0.255 Test Loss: 4.828 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2202198505401611
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.853 Vali Acc: 0.255 Test Loss: 4.853 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1674821376800537
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.875 Vali Acc: 0.258 Test Loss: 4.875 Test Acc: 0.258
Validation loss decreased (-0.256424 --> -0.257598).  Saving model ...
Epoch: 42 cost time: 1.184051513671875
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.919 Vali Acc: 0.253 Test Loss: 4.919 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.466113567352295
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.941 Vali Acc: 0.249 Test Loss: 4.941 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3279879093170166
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.947 Vali Acc: 0.254 Test Loss: 4.947 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.5099692344665527
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.957 Vali Acc: 0.258 Test Loss: 4.957 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.3439922332763672
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.978 Vali Acc: 0.254 Test Loss: 4.978 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.4132895469665527
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.984 Vali Acc: 0.256 Test Loss: 4.984 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0657951831817627
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.003 Vali Acc: 0.260 Test Loss: 5.003 Test Acc: 0.260
Validation loss decreased (-0.257598 --> -0.259950).  Saving model ...
Epoch: 49 cost time: 0.9625387191772461
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.024 Vali Acc: 0.258 Test Loss: 5.024 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.214294672012329
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.042 Vali Acc: 0.260 Test Loss: 5.042 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.2394142150878906
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.055 Vali Acc: 0.261 Test Loss: 5.055 Test Acc: 0.261
Validation loss decreased (-0.259950 --> -0.261126).  Saving model ...
Epoch: 52 cost time: 1.0059490203857422
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.065 Vali Acc: 0.265 Test Loss: 5.065 Test Acc: 0.265
Validation loss decreased (-0.261126 --> -0.264655).  Saving model ...
Epoch: 53 cost time: 1.560523509979248
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.071 Vali Acc: 0.264 Test Loss: 5.071 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.4504153728485107
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.106 Vali Acc: 0.260 Test Loss: 5.106 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.3173842430114746
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.108 Vali Acc: 0.265 Test Loss: 5.108 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.2838494777679443
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.122 Vali Acc: 0.266 Test Loss: 5.122 Test Acc: 0.266
Validation loss decreased (-0.264655 --> -0.265831).  Saving model ...
Epoch: 57 cost time: 1.13942551612854
Epoch: 57, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.133 Vali Acc: 0.265 Test Loss: 5.133 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.6935791969299316
Epoch: 58, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.143 Vali Acc: 0.262 Test Loss: 5.143 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.4423785209655762
Epoch: 59, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.166 Vali Acc: 0.265 Test Loss: 5.166 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.0867700576782227
Epoch: 60, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.177 Vali Acc: 0.261 Test Loss: 5.177 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.4233386516571045
Epoch: 61, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.187 Vali Acc: 0.259 Test Loss: 5.187 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.6225576400756836
Epoch: 62, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.203 Vali Acc: 0.266 Test Loss: 5.203 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.3325855731964111
Epoch: 63, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.212 Vali Acc: 0.264 Test Loss: 5.212 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.1350741386413574
Epoch: 64, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.220 Vali Acc: 0.264 Test Loss: 5.220 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.3924014568328857
Epoch: 65, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.232 Vali Acc: 0.260 Test Loss: 5.232 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.4497692584991455
Epoch: 66, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.237 Vali Acc: 0.260 Test Loss: 5.237 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 1338546
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7089099884033203
Epoch: 1, Steps: 10 | Train Loss: 3.506 Vali Loss: 3.304 Vali Acc: 0.059 Test Loss: 3.304 Test Acc: 0.059
Validation loss decreased (inf --> -0.058790).  Saving model ...
Epoch: 2 cost time: 0.9290966987609863
Epoch: 2, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.424 Vali Acc: 0.062 Test Loss: 3.424 Test Acc: 0.062
Validation loss decreased (-0.058790 --> -0.062319).  Saving model ...
Epoch: 3 cost time: 1.1270909309387207
Epoch: 3, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.343 Vali Acc: 0.066 Test Loss: 3.343 Test Acc: 0.066
Validation loss decreased (-0.062319 --> -0.065849).  Saving model ...
Epoch: 4 cost time: 1.156034231185913
Epoch: 4, Steps: 10 | Train Loss: 2.995 Vali Loss: 3.270 Vali Acc: 0.087 Test Loss: 3.270 Test Acc: 0.087
Validation loss decreased (-0.065849 --> -0.087026).  Saving model ...
Epoch: 5 cost time: 1.1736547946929932
Epoch: 5, Steps: 10 | Train Loss: 2.801 Vali Loss: 3.246 Vali Acc: 0.095 Test Loss: 3.246 Test Acc: 0.095
Validation loss decreased (-0.087026 --> -0.095262).  Saving model ...
Epoch: 6 cost time: 1.321681022644043
Epoch: 6, Steps: 10 | Train Loss: 2.654 Vali Loss: 3.289 Vali Acc: 0.115 Test Loss: 3.289 Test Acc: 0.115
Validation loss decreased (-0.095262 --> -0.115261).  Saving model ...
Epoch: 7 cost time: 1.0380706787109375
Epoch: 7, Steps: 10 | Train Loss: 2.444 Vali Loss: 3.237 Vali Acc: 0.125 Test Loss: 3.237 Test Acc: 0.125
Validation loss decreased (-0.115261 --> -0.124674).  Saving model ...
Epoch: 8 cost time: 1.0827713012695312
Epoch: 8, Steps: 10 | Train Loss: 2.277 Vali Loss: 3.231 Vali Acc: 0.147 Test Loss: 3.231 Test Acc: 0.147
Validation loss decreased (-0.124674 --> -0.147027).  Saving model ...
Epoch: 9 cost time: 1.1987526416778564
Epoch: 9, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.300 Vali Acc: 0.151 Test Loss: 3.300 Test Acc: 0.151
Validation loss decreased (-0.147027 --> -0.150555).  Saving model ...
Epoch: 10 cost time: 1.118750810623169
Epoch: 10, Steps: 10 | Train Loss: 1.849 Vali Loss: 3.244 Vali Acc: 0.158 Test Loss: 3.244 Test Acc: 0.158
Validation loss decreased (-0.150555 --> -0.157615).  Saving model ...
Epoch: 11 cost time: 1.3428270816802979
Epoch: 11, Steps: 10 | Train Loss: 1.621 Vali Loss: 3.360 Vali Acc: 0.178 Test Loss: 3.360 Test Acc: 0.178
Validation loss decreased (-0.157615 --> -0.177613).  Saving model ...
Epoch: 12 cost time: 1.279144525527954
Epoch: 12, Steps: 10 | Train Loss: 1.440 Vali Loss: 3.353 Vali Acc: 0.174 Test Loss: 3.353 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.006645917892456
Epoch: 13, Steps: 10 | Train Loss: 1.163 Vali Loss: 3.455 Vali Acc: 0.189 Test Loss: 3.455 Test Acc: 0.189
Validation loss decreased (-0.177613 --> -0.189377).  Saving model ...
Epoch: 14 cost time: 1.1197528839111328
Epoch: 14, Steps: 10 | Train Loss: 1.089 Vali Loss: 3.485 Vali Acc: 0.201 Test Loss: 3.485 Test Acc: 0.201
Validation loss decreased (-0.189377 --> -0.201142).  Saving model ...
Epoch: 15 cost time: 0.956902027130127
Epoch: 15, Steps: 10 | Train Loss: 0.857 Vali Loss: 3.561 Vali Acc: 0.224 Test Loss: 3.561 Test Acc: 0.224
Validation loss decreased (-0.201142 --> -0.223494).  Saving model ...
Epoch: 16 cost time: 1.054908275604248
Epoch: 16, Steps: 10 | Train Loss: 0.735 Vali Loss: 3.656 Vali Acc: 0.234 Test Loss: 3.656 Test Acc: 0.234
Validation loss decreased (-0.223494 --> -0.234081).  Saving model ...
Epoch: 17 cost time: 1.00718092918396
Epoch: 17, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.732 Vali Acc: 0.221 Test Loss: 3.732 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0501604080200195
Epoch: 18, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.794 Vali Acc: 0.238 Test Loss: 3.794 Test Acc: 0.238
Validation loss decreased (-0.234081 --> -0.237609).  Saving model ...
Epoch: 19 cost time: 1.1135904788970947
Epoch: 19, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.975 Vali Acc: 0.231 Test Loss: 3.975 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.128828763961792
Epoch: 20, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.950 Vali Acc: 0.219 Test Loss: 3.950 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0192046165466309
Epoch: 21, Steps: 10 | Train Loss: 0.231 Vali Loss: 4.173 Vali Acc: 0.246 Test Loss: 4.173 Test Acc: 0.246
Validation loss decreased (-0.237609 --> -0.245841).  Saving model ...
Epoch: 22 cost time: 1.0740630626678467
Epoch: 22, Steps: 10 | Train Loss: 0.191 Vali Loss: 4.253 Vali Acc: 0.213 Test Loss: 4.253 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2048535346984863
Epoch: 23, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.304 Vali Acc: 0.241 Test Loss: 4.304 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0789086818695068
Epoch: 24, Steps: 10 | Train Loss: 0.112 Vali Loss: 4.449 Vali Acc: 0.225 Test Loss: 4.449 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0394842624664307
Epoch: 25, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.544 Vali Acc: 0.239 Test Loss: 4.544 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9471757411956787
Epoch: 26, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.453 Vali Acc: 0.244 Test Loss: 4.453 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9972648620605469
Epoch: 27, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.598 Vali Acc: 0.244 Test Loss: 4.598 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1764395236968994
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.693 Vali Acc: 0.251 Test Loss: 4.693 Test Acc: 0.251
Validation loss decreased (-0.245841 --> -0.250541).  Saving model ...
Epoch: 29 cost time: 1.161102294921875
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.683 Vali Acc: 0.252 Test Loss: 4.683 Test Acc: 0.252
Validation loss decreased (-0.250541 --> -0.251718).  Saving model ...
Epoch: 30 cost time: 1.2324140071868896
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.653 Vali Acc: 0.259 Test Loss: 4.653 Test Acc: 0.259
Validation loss decreased (-0.251718 --> -0.258777).  Saving model ...
Epoch: 31 cost time: 1.0675745010375977
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.641 Vali Acc: 0.259 Test Loss: 4.641 Test Acc: 0.259
Validation loss decreased (-0.258777 --> -0.258777).  Saving model ...
Epoch: 32 cost time: 1.3265650272369385
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.671 Vali Acc: 0.266 Test Loss: 4.671 Test Acc: 0.266
Validation loss decreased (-0.258777 --> -0.265836).  Saving model ...
Epoch: 33 cost time: 0.9631049633026123
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.709 Vali Acc: 0.266 Test Loss: 4.709 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1783757209777832
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.752 Vali Acc: 0.261 Test Loss: 4.752 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.354055404663086
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.761 Vali Acc: 0.262 Test Loss: 4.761 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0421149730682373
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.757 Vali Acc: 0.259 Test Loss: 4.757 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2508525848388672
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.777 Vali Acc: 0.258 Test Loss: 4.777 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9141416549682617
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.803 Vali Acc: 0.261 Test Loss: 4.803 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.245276689529419
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.875 Vali Acc: 0.249 Test Loss: 4.875 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1156089305877686
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.846 Vali Acc: 0.259 Test Loss: 4.846 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.028456687927246
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.850 Vali Acc: 0.248 Test Loss: 4.850 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1086061000823975
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.923 Vali Acc: 0.251 Test Loss: 4.923 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 1336882
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1628377437591553
Epoch: 1, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.300 Vali Acc: 0.047 Test Loss: 3.300 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.0352983474731445
Epoch: 2, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.396 Vali Acc: 0.048 Test Loss: 3.396 Test Acc: 0.048
Validation loss decreased (-0.047026 --> -0.048201).  Saving model ...
Epoch: 3 cost time: 1.2621500492095947
Epoch: 3, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.340 Vali Acc: 0.076 Test Loss: 3.340 Test Acc: 0.076
Validation loss decreased (-0.048201 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 1.1081414222717285
Epoch: 4, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.283 Vali Acc: 0.102 Test Loss: 3.283 Test Acc: 0.102
Validation loss decreased (-0.076437 --> -0.102320).  Saving model ...
Epoch: 5 cost time: 1.2674875259399414
Epoch: 5, Steps: 10 | Train Loss: 2.863 Vali Loss: 3.283 Vali Acc: 0.108 Test Loss: 3.283 Test Acc: 0.108
Validation loss decreased (-0.102320 --> -0.108202).  Saving model ...
Epoch: 6 cost time: 1.2348148822784424
Epoch: 6, Steps: 10 | Train Loss: 2.611 Vali Loss: 3.249 Vali Acc: 0.116 Test Loss: 3.249 Test Acc: 0.116
Validation loss decreased (-0.108202 --> -0.116438).  Saving model ...
Epoch: 7 cost time: 1.2597343921661377
Epoch: 7, Steps: 10 | Train Loss: 2.460 Vali Loss: 3.217 Vali Acc: 0.126 Test Loss: 3.217 Test Acc: 0.126
Validation loss decreased (-0.116438 --> -0.125850).  Saving model ...
Epoch: 8 cost time: 1.0060603618621826
Epoch: 8, Steps: 10 | Train Loss: 2.314 Vali Loss: 3.279 Vali Acc: 0.138 Test Loss: 3.279 Test Acc: 0.138
Validation loss decreased (-0.125850 --> -0.137614).  Saving model ...
Epoch: 9 cost time: 1.4591991901397705
Epoch: 9, Steps: 10 | Train Loss: 2.073 Vali Loss: 3.284 Vali Acc: 0.155 Test Loss: 3.284 Test Acc: 0.155
Validation loss decreased (-0.137614 --> -0.155261).  Saving model ...
Epoch: 10 cost time: 1.0414481163024902
Epoch: 10, Steps: 10 | Train Loss: 1.808 Vali Loss: 3.317 Vali Acc: 0.144 Test Loss: 3.317 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.380108118057251
Epoch: 11, Steps: 10 | Train Loss: 1.604 Vali Loss: 3.281 Vali Acc: 0.161 Test Loss: 3.281 Test Acc: 0.161
Validation loss decreased (-0.155261 --> -0.161144).  Saving model ...
Epoch: 12 cost time: 1.305504560470581
Epoch: 12, Steps: 10 | Train Loss: 1.397 Vali Loss: 3.392 Vali Acc: 0.178 Test Loss: 3.392 Test Acc: 0.178
Validation loss decreased (-0.161144 --> -0.177613).  Saving model ...
Epoch: 13 cost time: 1.1387994289398193
Epoch: 13, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.446 Vali Acc: 0.189 Test Loss: 3.446 Test Acc: 0.189
Validation loss decreased (-0.177613 --> -0.189377).  Saving model ...
Epoch: 14 cost time: 1.381434440612793
Epoch: 14, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.465 Vali Acc: 0.194 Test Loss: 3.465 Test Acc: 0.194
Validation loss decreased (-0.189377 --> -0.194083).  Saving model ...
Epoch: 15 cost time: 1.5384113788604736
Epoch: 15, Steps: 10 | Train Loss: 0.860 Vali Loss: 3.631 Vali Acc: 0.189 Test Loss: 3.631 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5341193675994873
Epoch: 16, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.607 Vali Acc: 0.220 Test Loss: 3.607 Test Acc: 0.220
Validation loss decreased (-0.194083 --> -0.219964).  Saving model ...
Epoch: 17 cost time: 1.5393409729003906
Epoch: 17, Steps: 10 | Train Loss: 0.615 Vali Loss: 3.760 Vali Acc: 0.209 Test Loss: 3.760 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6122839450836182
Epoch: 18, Steps: 10 | Train Loss: 0.466 Vali Loss: 3.840 Vali Acc: 0.225 Test Loss: 3.840 Test Acc: 0.225
Validation loss decreased (-0.219964 --> -0.224667).  Saving model ...
Epoch: 19 cost time: 1.721266746520996
Epoch: 19, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.895 Vali Acc: 0.224 Test Loss: 3.895 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7295873165130615
Epoch: 20, Steps: 10 | Train Loss: 0.273 Vali Loss: 4.120 Vali Acc: 0.212 Test Loss: 4.120 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.465463399887085
Epoch: 21, Steps: 10 | Train Loss: 0.232 Vali Loss: 4.141 Vali Acc: 0.222 Test Loss: 4.141 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2727012634277344
Epoch: 22, Steps: 10 | Train Loss: 0.152 Vali Loss: 4.270 Vali Acc: 0.227 Test Loss: 4.270 Test Acc: 0.227
Validation loss decreased (-0.224667 --> -0.227016).  Saving model ...
Epoch: 23 cost time: 1.1883413791656494
Epoch: 23, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.379 Vali Acc: 0.224 Test Loss: 4.379 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5018279552459717
Epoch: 24, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.462 Vali Acc: 0.226 Test Loss: 4.462 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4220833778381348
Epoch: 25, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.496 Vali Acc: 0.219 Test Loss: 4.496 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2799608707427979
Epoch: 26, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.502 Vali Acc: 0.232 Test Loss: 4.502 Test Acc: 0.232
Validation loss decreased (-0.227016 --> -0.231720).  Saving model ...
Epoch: 27 cost time: 1.2437379360198975
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.656 Vali Acc: 0.222 Test Loss: 4.656 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4948012828826904
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.664 Vali Acc: 0.231 Test Loss: 4.664 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3152525424957275
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.655 Vali Acc: 0.232 Test Loss: 4.655 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2420339584350586
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.722 Vali Acc: 0.240 Test Loss: 4.722 Test Acc: 0.240
Validation loss decreased (-0.231720 --> -0.239953).  Saving model ...
Epoch: 31 cost time: 1.200047492980957
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.729 Vali Acc: 0.240 Test Loss: 4.729 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4003071784973145
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.752 Vali Acc: 0.238 Test Loss: 4.752 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4067018032073975
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.804 Vali Acc: 0.232 Test Loss: 4.804 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2904870510101318
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.809 Vali Acc: 0.240 Test Loss: 4.809 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2010283470153809
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.856 Vali Acc: 0.242 Test Loss: 4.856 Test Acc: 0.242
Validation loss decreased (-0.239953 --> -0.242304).  Saving model ...
Epoch: 36 cost time: 1.199310064315796
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.870 Vali Acc: 0.242 Test Loss: 4.870 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4207329750061035
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.890 Vali Acc: 0.246 Test Loss: 4.890 Test Acc: 0.246
Validation loss decreased (-0.242304 --> -0.245833).  Saving model ...
Epoch: 38 cost time: 1.6518070697784424
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.900 Vali Acc: 0.241 Test Loss: 4.900 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8612890243530273
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.914 Vali Acc: 0.245 Test Loss: 4.914 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.32735013961792
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.943 Vali Acc: 0.240 Test Loss: 4.943 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.5272927284240723
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.997 Vali Acc: 0.238 Test Loss: 4.997 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1720726490020752
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.007 Vali Acc: 0.245 Test Loss: 5.007 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1828243732452393
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.006 Vali Acc: 0.247 Test Loss: 5.006 Test Acc: 0.247
Validation loss decreased (-0.245833 --> -0.247009).  Saving model ...
Epoch: 44 cost time: 1.5468847751617432
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.008 Vali Acc: 0.245 Test Loss: 5.008 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2491962909698486
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.029 Vali Acc: 0.247 Test Loss: 5.029 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4234821796417236
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.053 Vali Acc: 0.251 Test Loss: 5.053 Test Acc: 0.251
Validation loss decreased (-0.247009 --> -0.250538).  Saving model ...
Epoch: 47 cost time: 1.284019947052002
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.066 Vali Acc: 0.246 Test Loss: 5.066 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3254265785217285
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.079 Vali Acc: 0.249 Test Loss: 5.079 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3179996013641357
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.105 Vali Acc: 0.246 Test Loss: 5.105 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.4688398838043213
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.127 Vali Acc: 0.247 Test Loss: 5.127 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.138521671295166
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.141 Vali Acc: 0.249 Test Loss: 5.141 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.1633696556091309
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.159 Vali Acc: 0.247 Test Loss: 5.159 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.1913104057312012
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.182 Vali Acc: 0.246 Test Loss: 5.182 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.4673552513122559
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.197 Vali Acc: 0.251 Test Loss: 5.197 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.2968494892120361
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.200 Vali Acc: 0.248 Test Loss: 5.200 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.289565086364746
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.210 Vali Acc: 0.246 Test Loss: 5.210 Test Acc: 0.246
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25058823529411767
model parameter : 1335218
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9266409873962402
Epoch: 1, Steps: 10 | Train Loss: 3.547 Vali Loss: 3.318 Vali Acc: 0.041 Test Loss: 3.318 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.2289643287658691
Epoch: 2, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.383 Vali Acc: 0.049 Test Loss: 3.383 Test Acc: 0.049
Validation loss decreased (-0.041143 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 1.0594654083251953
Epoch: 3, Steps: 10 | Train Loss: 3.148 Vali Loss: 3.414 Vali Acc: 0.042 Test Loss: 3.414 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9755949974060059
Epoch: 4, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.253 Vali Acc: 0.084 Test Loss: 3.253 Test Acc: 0.084
Validation loss decreased (-0.049378 --> -0.083497).  Saving model ...
Epoch: 5 cost time: 1.038090705871582
Epoch: 5, Steps: 10 | Train Loss: 2.827 Vali Loss: 3.282 Vali Acc: 0.085 Test Loss: 3.282 Test Acc: 0.085
Validation loss decreased (-0.083497 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.9674150943756104
Epoch: 6, Steps: 10 | Train Loss: 2.657 Vali Loss: 3.278 Vali Acc: 0.089 Test Loss: 3.278 Test Acc: 0.089
Validation loss decreased (-0.084673 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 0.8765592575073242
Epoch: 7, Steps: 10 | Train Loss: 2.451 Vali Loss: 3.264 Vali Acc: 0.122 Test Loss: 3.264 Test Acc: 0.122
Validation loss decreased (-0.089379 --> -0.122320).  Saving model ...
Epoch: 8 cost time: 0.9891757965087891
Epoch: 8, Steps: 10 | Train Loss: 2.197 Vali Loss: 3.293 Vali Acc: 0.115 Test Loss: 3.293 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.185859203338623
Epoch: 9, Steps: 10 | Train Loss: 2.041 Vali Loss: 3.266 Vali Acc: 0.149 Test Loss: 3.266 Test Acc: 0.149
Validation loss decreased (-0.122320 --> -0.149379).  Saving model ...
Epoch: 10 cost time: 1.1452443599700928
Epoch: 10, Steps: 10 | Train Loss: 1.788 Vali Loss: 3.296 Vali Acc: 0.154 Test Loss: 3.296 Test Acc: 0.154
Validation loss decreased (-0.149379 --> -0.154085).  Saving model ...
Epoch: 11 cost time: 1.114424705505371
Epoch: 11, Steps: 10 | Train Loss: 1.565 Vali Loss: 3.345 Vali Acc: 0.175 Test Loss: 3.345 Test Acc: 0.175
Validation loss decreased (-0.154085 --> -0.175261).  Saving model ...
Epoch: 12 cost time: 1.0285120010375977
Epoch: 12, Steps: 10 | Train Loss: 1.340 Vali Loss: 3.380 Vali Acc: 0.199 Test Loss: 3.380 Test Acc: 0.199
Validation loss decreased (-0.175261 --> -0.198790).  Saving model ...
Epoch: 13 cost time: 1.2239251136779785
Epoch: 13, Steps: 10 | Train Loss: 1.212 Vali Loss: 3.462 Vali Acc: 0.207 Test Loss: 3.462 Test Acc: 0.207
Validation loss decreased (-0.198790 --> -0.207024).  Saving model ...
Epoch: 14 cost time: 1.1729099750518799
Epoch: 14, Steps: 10 | Train Loss: 1.005 Vali Loss: 3.517 Vali Acc: 0.206 Test Loss: 3.517 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2441093921661377
Epoch: 15, Steps: 10 | Train Loss: 0.818 Vali Loss: 3.584 Vali Acc: 0.208 Test Loss: 3.584 Test Acc: 0.208
Validation loss decreased (-0.207024 --> -0.208199).  Saving model ...
Epoch: 16 cost time: 1.206667423248291
Epoch: 16, Steps: 10 | Train Loss: 0.725 Vali Loss: 3.698 Vali Acc: 0.207 Test Loss: 3.698 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1956548690795898
Epoch: 17, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.749 Vali Acc: 0.212 Test Loss: 3.749 Test Acc: 0.212
Validation loss decreased (-0.208199 --> -0.211727).  Saving model ...
Epoch: 18 cost time: 1.1570484638214111
Epoch: 18, Steps: 10 | Train Loss: 0.463 Vali Loss: 3.847 Vali Acc: 0.221 Test Loss: 3.847 Test Acc: 0.221
Validation loss decreased (-0.211727 --> -0.221138).  Saving model ...
Epoch: 19 cost time: 1.3524796962738037
Epoch: 19, Steps: 10 | Train Loss: 0.352 Vali Loss: 4.000 Vali Acc: 0.231 Test Loss: 4.000 Test Acc: 0.231
Validation loss decreased (-0.221138 --> -0.230548).  Saving model ...
Epoch: 20 cost time: 1.1510052680969238
Epoch: 20, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.999 Vali Acc: 0.235 Test Loss: 3.999 Test Acc: 0.235
Validation loss decreased (-0.230548 --> -0.235254).  Saving model ...
Epoch: 21 cost time: 1.3234641551971436
Epoch: 21, Steps: 10 | Train Loss: 0.214 Vali Loss: 4.305 Vali Acc: 0.214 Test Loss: 4.305 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1824209690093994
Epoch: 22, Steps: 10 | Train Loss: 0.152 Vali Loss: 4.215 Vali Acc: 0.227 Test Loss: 4.215 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1685454845428467
Epoch: 23, Steps: 10 | Train Loss: 0.118 Vali Loss: 4.363 Vali Acc: 0.228 Test Loss: 4.363 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1770219802856445
Epoch: 24, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.391 Vali Acc: 0.226 Test Loss: 4.391 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.494441032409668
Epoch: 25, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.534 Vali Acc: 0.231 Test Loss: 4.534 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2622308731079102
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.536 Vali Acc: 0.234 Test Loss: 4.536 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1086997985839844
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.521 Vali Acc: 0.233 Test Loss: 4.521 Test Acc: 0.233
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.281639575958252
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.628 Vali Acc: 0.226 Test Loss: 4.628 Test Acc: 0.226
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2668087482452393
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.693 Vali Acc: 0.232 Test Loss: 4.693 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1844282150268555
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.679 Vali Acc: 0.242 Test Loss: 4.679 Test Acc: 0.242
Validation loss decreased (-0.235254 --> -0.242306).  Saving model ...
Epoch: 31 cost time: 0.9525096416473389
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.713 Vali Acc: 0.241 Test Loss: 4.713 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.240990161895752
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.713 Vali Acc: 0.242 Test Loss: 4.713 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0952610969543457
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.748 Vali Acc: 0.245 Test Loss: 4.748 Test Acc: 0.245
Validation loss decreased (-0.242306 --> -0.244658).  Saving model ...
Epoch: 34 cost time: 1.1043932437896729
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.777 Vali Acc: 0.245 Test Loss: 4.777 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0391669273376465
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.810 Vali Acc: 0.246 Test Loss: 4.810 Test Acc: 0.246
Validation loss decreased (-0.244658 --> -0.245834).  Saving model ...
Epoch: 36 cost time: 1.0034875869750977
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.850 Vali Acc: 0.244 Test Loss: 4.850 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2687668800354004
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.850 Vali Acc: 0.242 Test Loss: 4.850 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4701406955718994
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.871 Vali Acc: 0.246 Test Loss: 4.871 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2923572063446045
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.898 Vali Acc: 0.247 Test Loss: 4.898 Test Acc: 0.247
Validation loss decreased (-0.245834 --> -0.247010).  Saving model ...
Epoch: 40 cost time: 1.0628693103790283
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.920 Vali Acc: 0.252 Test Loss: 4.920 Test Acc: 0.252
Validation loss decreased (-0.247010 --> -0.251716).  Saving model ...
Epoch: 41 cost time: 1.1073215007781982
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.945 Vali Acc: 0.248 Test Loss: 4.945 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2285640239715576
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.965 Vali Acc: 0.249 Test Loss: 4.965 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.357255220413208
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.998 Vali Acc: 0.249 Test Loss: 4.998 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1083953380584717
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.023 Vali Acc: 0.251 Test Loss: 5.023 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.344250202178955
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.992 Vali Acc: 0.252 Test Loss: 4.992 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0821750164031982
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.016 Vali Acc: 0.252 Test Loss: 5.016 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.0713701248168945
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.052 Vali Acc: 0.253 Test Loss: 5.052 Test Acc: 0.253
Validation loss decreased (-0.251716 --> -0.252891).  Saving model ...
Epoch: 48 cost time: 1.3688933849334717
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.065 Vali Acc: 0.251 Test Loss: 5.065 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2243447303771973
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.081 Vali Acc: 0.251 Test Loss: 5.081 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0353469848632812
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.085 Vali Acc: 0.251 Test Loss: 5.085 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.106168270111084
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.096 Vali Acc: 0.256 Test Loss: 5.096 Test Acc: 0.256
Validation loss decreased (-0.252891 --> -0.256420).  Saving model ...
Epoch: 52 cost time: 0.8650460243225098
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.125 Vali Acc: 0.254 Test Loss: 5.125 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9700400829315186
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.146 Vali Acc: 0.252 Test Loss: 5.146 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.1074256896972656
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.150 Vali Acc: 0.249 Test Loss: 5.150 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9395856857299805
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.170 Vali Acc: 0.248 Test Loss: 5.170 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9703354835510254
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.191 Vali Acc: 0.254 Test Loss: 5.191 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.8950574398040771
Epoch: 57, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.202 Vali Acc: 0.252 Test Loss: 5.202 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.1132826805114746
Epoch: 58, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.227 Vali Acc: 0.247 Test Loss: 5.227 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.1318659782409668
Epoch: 59, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.239 Vali Acc: 0.255 Test Loss: 5.239 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.9798703193664551
Epoch: 60, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.253 Vali Acc: 0.254 Test Loss: 5.253 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.1745591163635254
Epoch: 61, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.256 Vali Acc: 0.254 Test Loss: 5.256 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 1333554
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.736480951309204
Epoch: 1, Steps: 10 | Train Loss: 3.414 Vali Loss: 3.299 Vali Acc: 0.036 Test Loss: 3.299 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.9633815288543701
Epoch: 2, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.352 Vali Acc: 0.049 Test Loss: 3.352 Test Acc: 0.049
Validation loss decreased (-0.036438 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 1.1993305683135986
Epoch: 3, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.364 Vali Acc: 0.064 Test Loss: 3.364 Test Acc: 0.064
Validation loss decreased (-0.049378 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 1.1218538284301758
Epoch: 4, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.249 Vali Acc: 0.091 Test Loss: 3.249 Test Acc: 0.091
Validation loss decreased (-0.063496 --> -0.090556).  Saving model ...
Epoch: 5 cost time: 0.883913516998291
Epoch: 5, Steps: 10 | Train Loss: 2.870 Vali Loss: 3.279 Vali Acc: 0.086 Test Loss: 3.279 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9205176830291748
Epoch: 6, Steps: 10 | Train Loss: 2.730 Vali Loss: 3.269 Vali Acc: 0.114 Test Loss: 3.269 Test Acc: 0.114
Validation loss decreased (-0.090556 --> -0.114085).  Saving model ...
Epoch: 7 cost time: 1.1995882987976074
Epoch: 7, Steps: 10 | Train Loss: 2.522 Vali Loss: 3.232 Vali Acc: 0.120 Test Loss: 3.232 Test Acc: 0.120
Validation loss decreased (-0.114085 --> -0.119968).  Saving model ...
Epoch: 8 cost time: 0.9509532451629639
Epoch: 8, Steps: 10 | Train Loss: 2.278 Vali Loss: 3.270 Vali Acc: 0.124 Test Loss: 3.270 Test Acc: 0.124
Validation loss decreased (-0.119968 --> -0.123497).  Saving model ...
Epoch: 9 cost time: 1.023944616317749
Epoch: 9, Steps: 10 | Train Loss: 2.060 Vali Loss: 3.273 Vali Acc: 0.138 Test Loss: 3.273 Test Acc: 0.138
Validation loss decreased (-0.123497 --> -0.137614).  Saving model ...
Epoch: 10 cost time: 0.9110782146453857
Epoch: 10, Steps: 10 | Train Loss: 1.884 Vali Loss: 3.234 Vali Acc: 0.162 Test Loss: 3.234 Test Acc: 0.162
Validation loss decreased (-0.137614 --> -0.162321).  Saving model ...
Epoch: 11 cost time: 1.2596673965454102
Epoch: 11, Steps: 10 | Train Loss: 1.697 Vali Loss: 3.329 Vali Acc: 0.169 Test Loss: 3.329 Test Acc: 0.169
Validation loss decreased (-0.162321 --> -0.169378).  Saving model ...
Epoch: 12 cost time: 0.9546844959259033
Epoch: 12, Steps: 10 | Train Loss: 1.482 Vali Loss: 3.402 Vali Acc: 0.179 Test Loss: 3.402 Test Acc: 0.179
Validation loss decreased (-0.169378 --> -0.178790).  Saving model ...
Epoch: 13 cost time: 0.9956915378570557
Epoch: 13, Steps: 10 | Train Loss: 1.341 Vali Loss: 3.414 Vali Acc: 0.180 Test Loss: 3.414 Test Acc: 0.180
Validation loss decreased (-0.178790 --> -0.179966).  Saving model ...
Epoch: 14 cost time: 0.9213979244232178
Epoch: 14, Steps: 10 | Train Loss: 1.055 Vali Loss: 3.507 Vali Acc: 0.191 Test Loss: 3.507 Test Acc: 0.191
Validation loss decreased (-0.179966 --> -0.190553).  Saving model ...
Epoch: 15 cost time: 1.0709104537963867
Epoch: 15, Steps: 10 | Train Loss: 0.973 Vali Loss: 3.530 Vali Acc: 0.212 Test Loss: 3.530 Test Acc: 0.212
Validation loss decreased (-0.190553 --> -0.211729).  Saving model ...
Epoch: 16 cost time: 0.9419369697570801
Epoch: 16, Steps: 10 | Train Loss: 0.781 Vali Loss: 3.630 Vali Acc: 0.218 Test Loss: 3.630 Test Acc: 0.218
Validation loss decreased (-0.211729 --> -0.217611).  Saving model ...
Epoch: 17 cost time: 0.920337438583374
Epoch: 17, Steps: 10 | Train Loss: 0.637 Vali Loss: 3.659 Vali Acc: 0.218 Test Loss: 3.659 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1991331577301025
Epoch: 18, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.841 Vali Acc: 0.218 Test Loss: 3.841 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1008799076080322
Epoch: 19, Steps: 10 | Train Loss: 0.455 Vali Loss: 3.901 Vali Acc: 0.222 Test Loss: 3.901 Test Acc: 0.222
Validation loss decreased (-0.217611 --> -0.222314).  Saving model ...
Epoch: 20 cost time: 1.0413212776184082
Epoch: 20, Steps: 10 | Train Loss: 0.369 Vali Loss: 3.947 Vali Acc: 0.236 Test Loss: 3.947 Test Acc: 0.236
Validation loss decreased (-0.222314 --> -0.236431).  Saving model ...
Epoch: 21 cost time: 1.3367397785186768
Epoch: 21, Steps: 10 | Train Loss: 0.264 Vali Loss: 4.133 Vali Acc: 0.219 Test Loss: 4.133 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1556482315063477
Epoch: 22, Steps: 10 | Train Loss: 0.204 Vali Loss: 4.181 Vali Acc: 0.241 Test Loss: 4.181 Test Acc: 0.241
Validation loss decreased (-0.236431 --> -0.241135).  Saving model ...
Epoch: 23 cost time: 0.9264180660247803
Epoch: 23, Steps: 10 | Train Loss: 0.149 Vali Loss: 4.260 Vali Acc: 0.249 Test Loss: 4.260 Test Acc: 0.249
Validation loss decreased (-0.241135 --> -0.249369).  Saving model ...
Epoch: 24 cost time: 0.9752326011657715
Epoch: 24, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.307 Vali Acc: 0.233 Test Loss: 4.307 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.17215895652771
Epoch: 25, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.447 Vali Acc: 0.254 Test Loss: 4.447 Test Acc: 0.254
Validation loss decreased (-0.249369 --> -0.254073).  Saving model ...
Epoch: 26 cost time: 0.9463579654693604
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.455 Vali Acc: 0.242 Test Loss: 4.455 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.984849214553833
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.482 Vali Acc: 0.261 Test Loss: 4.482 Test Acc: 0.261
Validation loss decreased (-0.254073 --> -0.261132).  Saving model ...
Epoch: 28 cost time: 1.2427153587341309
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.557 Vali Acc: 0.262 Test Loss: 4.557 Test Acc: 0.262
Validation loss decreased (-0.261132 --> -0.262307).  Saving model ...
Epoch: 29 cost time: 1.1061511039733887
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.660 Vali Acc: 0.258 Test Loss: 4.660 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0119373798370361
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.655 Vali Acc: 0.264 Test Loss: 4.655 Test Acc: 0.264
Validation loss decreased (-0.262307 --> -0.263483).  Saving model ...
Epoch: 31 cost time: 1.2847442626953125
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.681 Vali Acc: 0.260 Test Loss: 4.681 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0904645919799805
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.748 Vali Acc: 0.262 Test Loss: 4.748 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0238945484161377
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.760 Vali Acc: 0.260 Test Loss: 4.760 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0271260738372803
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.779 Vali Acc: 0.256 Test Loss: 4.779 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9512438774108887
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.814 Vali Acc: 0.264 Test Loss: 4.814 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1608150005340576
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.835 Vali Acc: 0.261 Test Loss: 4.835 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1699793338775635
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.848 Vali Acc: 0.260 Test Loss: 4.848 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1409938335418701
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.885 Vali Acc: 0.262 Test Loss: 4.885 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.040259838104248
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.897 Vali Acc: 0.269 Test Loss: 4.897 Test Acc: 0.269
Validation loss decreased (-0.263483 --> -0.269363).  Saving model ...
Epoch: 40 cost time: 1.2754807472229004
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.923 Vali Acc: 0.267 Test Loss: 4.923 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9967834949493408
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.957 Vali Acc: 0.268 Test Loss: 4.957 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0584845542907715
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.971 Vali Acc: 0.265 Test Loss: 4.971 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.6379332542419434
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.993 Vali Acc: 0.260 Test Loss: 4.993 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.4138538837432861
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.013 Vali Acc: 0.262 Test Loss: 5.013 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.229602575302124
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.045 Vali Acc: 0.261 Test Loss: 5.045 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.1227102279663086
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.073 Vali Acc: 0.261 Test Loss: 5.073 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.310596227645874
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.074 Vali Acc: 0.264 Test Loss: 5.074 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.262747049331665
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.080 Vali Acc: 0.261 Test Loss: 5.080 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.2344517707824707
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.113 Vali Acc: 0.261 Test Loss: 5.113 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 1141170
model size : 6.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7361834049224854
Epoch: 1, Steps: 10 | Train Loss: 3.390 Vali Loss: 3.365 Vali Acc: 0.025 Test Loss: 3.365 Test Acc: 0.025
Validation loss decreased (inf --> -0.024672).  Saving model ...
Epoch: 2 cost time: 1.267864465713501
Epoch: 2, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.386 Vali Acc: 0.045 Test Loss: 3.386 Test Acc: 0.045
Validation loss decreased (-0.024672 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 1.1839661598205566
Epoch: 3, Steps: 10 | Train Loss: 3.157 Vali Loss: 3.342 Vali Acc: 0.049 Test Loss: 3.342 Test Acc: 0.049
Validation loss decreased (-0.044672 --> -0.049378).  Saving model ...
Epoch: 4 cost time: 1.182919979095459
Epoch: 4, Steps: 10 | Train Loss: 3.026 Vali Loss: 3.297 Vali Acc: 0.074 Test Loss: 3.297 Test Acc: 0.074
Validation loss decreased (-0.049378 --> -0.074085).  Saving model ...
Epoch: 5 cost time: 1.1515882015228271
Epoch: 5, Steps: 10 | Train Loss: 2.844 Vali Loss: 3.295 Vali Acc: 0.085 Test Loss: 3.295 Test Acc: 0.085
Validation loss decreased (-0.074085 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 1.0645439624786377
Epoch: 6, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.291 Vali Acc: 0.098 Test Loss: 3.291 Test Acc: 0.098
Validation loss decreased (-0.084673 --> -0.097614).  Saving model ...
Epoch: 7 cost time: 0.9435839653015137
Epoch: 7, Steps: 10 | Train Loss: 2.482 Vali Loss: 3.319 Vali Acc: 0.096 Test Loss: 3.319 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9449429512023926
Epoch: 8, Steps: 10 | Train Loss: 2.321 Vali Loss: 3.217 Vali Acc: 0.133 Test Loss: 3.217 Test Acc: 0.133
Validation loss decreased (-0.097614 --> -0.132909).  Saving model ...
Epoch: 9 cost time: 1.0384912490844727
Epoch: 9, Steps: 10 | Train Loss: 2.125 Vali Loss: 3.278 Vali Acc: 0.147 Test Loss: 3.278 Test Acc: 0.147
Validation loss decreased (-0.132909 --> -0.147026).  Saving model ...
Epoch: 10 cost time: 0.855553150177002
Epoch: 10, Steps: 10 | Train Loss: 1.873 Vali Loss: 3.247 Vali Acc: 0.139 Test Loss: 3.247 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0652940273284912
Epoch: 11, Steps: 10 | Train Loss: 1.688 Vali Loss: 3.329 Vali Acc: 0.149 Test Loss: 3.329 Test Acc: 0.149
Validation loss decreased (-0.147026 --> -0.149378).  Saving model ...
Epoch: 12 cost time: 0.9860439300537109
Epoch: 12, Steps: 10 | Train Loss: 1.499 Vali Loss: 3.331 Vali Acc: 0.179 Test Loss: 3.331 Test Acc: 0.179
Validation loss decreased (-0.149378 --> -0.178790).  Saving model ...
Epoch: 13 cost time: 1.0249955654144287
Epoch: 13, Steps: 10 | Train Loss: 1.399 Vali Loss: 3.335 Vali Acc: 0.193 Test Loss: 3.335 Test Acc: 0.193
Validation loss decreased (-0.178790 --> -0.192908).  Saving model ...
Epoch: 14 cost time: 1.2342984676361084
Epoch: 14, Steps: 10 | Train Loss: 1.101 Vali Loss: 3.505 Vali Acc: 0.192 Test Loss: 3.505 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2896757125854492
Epoch: 15, Steps: 10 | Train Loss: 0.899 Vali Loss: 3.456 Vali Acc: 0.226 Test Loss: 3.456 Test Acc: 0.226
Validation loss decreased (-0.192908 --> -0.225848).  Saving model ...
Epoch: 16 cost time: 1.0476820468902588
Epoch: 16, Steps: 10 | Train Loss: 0.840 Vali Loss: 3.570 Vali Acc: 0.215 Test Loss: 3.570 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2223193645477295
Epoch: 17, Steps: 10 | Train Loss: 0.668 Vali Loss: 3.692 Vali Acc: 0.216 Test Loss: 3.692 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.074882984161377
Epoch: 18, Steps: 10 | Train Loss: 0.534 Vali Loss: 3.817 Vali Acc: 0.225 Test Loss: 3.817 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2883002758026123
Epoch: 19, Steps: 10 | Train Loss: 0.449 Vali Loss: 3.807 Vali Acc: 0.227 Test Loss: 3.807 Test Acc: 0.227
Validation loss decreased (-0.225848 --> -0.227021).  Saving model ...
Epoch: 20 cost time: 1.1732735633850098
Epoch: 20, Steps: 10 | Train Loss: 0.437 Vali Loss: 4.082 Vali Acc: 0.222 Test Loss: 4.082 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1042084693908691
Epoch: 21, Steps: 10 | Train Loss: 0.311 Vali Loss: 4.062 Vali Acc: 0.222 Test Loss: 4.062 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1196722984313965
Epoch: 22, Steps: 10 | Train Loss: 0.243 Vali Loss: 4.173 Vali Acc: 0.209 Test Loss: 4.173 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1714799404144287
Epoch: 23, Steps: 10 | Train Loss: 0.152 Vali Loss: 4.225 Vali Acc: 0.226 Test Loss: 4.225 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.056699275970459
Epoch: 24, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.368 Vali Acc: 0.238 Test Loss: 4.368 Test Acc: 0.238
Validation loss decreased (-0.227021 --> -0.237603).  Saving model ...
Epoch: 25 cost time: 1.0841352939605713
Epoch: 25, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.406 Vali Acc: 0.242 Test Loss: 4.406 Test Acc: 0.242
Validation loss decreased (-0.237603 --> -0.242309).  Saving model ...
Epoch: 26 cost time: 1.2256863117218018
Epoch: 26, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.481 Vali Acc: 0.228 Test Loss: 4.481 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0663907527923584
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.529 Vali Acc: 0.248 Test Loss: 4.529 Test Acc: 0.248
Validation loss decreased (-0.242309 --> -0.248190).  Saving model ...
Epoch: 28 cost time: 1.1492607593536377
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.553 Vali Acc: 0.246 Test Loss: 4.553 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9722819328308105
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.632 Vali Acc: 0.245 Test Loss: 4.632 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1568830013275146
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.647 Vali Acc: 0.246 Test Loss: 4.647 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9388093948364258
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.696 Vali Acc: 0.245 Test Loss: 4.696 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0761547088623047
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.711 Vali Acc: 0.245 Test Loss: 4.711 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9510636329650879
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.748 Vali Acc: 0.244 Test Loss: 4.748 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0326430797576904
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.787 Vali Acc: 0.248 Test Loss: 4.787 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0688982009887695
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.805 Vali Acc: 0.247 Test Loss: 4.805 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1149325370788574
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.824 Vali Acc: 0.246 Test Loss: 4.824 Test Acc: 0.246
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.3595201969146729
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.865 Vali Acc: 0.252 Test Loss: 4.865 Test Acc: 0.252
Validation loss decreased (-0.248190 --> -0.251716).  Saving model ...
Epoch: 38 cost time: 1.2561113834381104
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.863 Vali Acc: 0.254 Test Loss: 4.863 Test Acc: 0.254
Validation loss decreased (-0.251716 --> -0.254069).  Saving model ...
Epoch: 39 cost time: 0.9444289207458496
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.882 Vali Acc: 0.253 Test Loss: 4.882 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9885601997375488
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.904 Vali Acc: 0.252 Test Loss: 4.904 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1339235305786133
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.927 Vali Acc: 0.248 Test Loss: 4.927 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0277676582336426
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.934 Vali Acc: 0.252 Test Loss: 4.934 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1231424808502197
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.980 Vali Acc: 0.252 Test Loss: 4.980 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2595322132110596
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.994 Vali Acc: 0.248 Test Loss: 4.994 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.0700209140777588
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.007 Vali Acc: 0.249 Test Loss: 5.007 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.268484115600586
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.021 Vali Acc: 0.254 Test Loss: 5.021 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.1756064891815186
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.045 Vali Acc: 0.259 Test Loss: 5.045 Test Acc: 0.259
Validation loss decreased (-0.254069 --> -0.258773).  Saving model ...
Epoch: 48 cost time: 1.0502734184265137
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.071 Vali Acc: 0.253 Test Loss: 5.071 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.149306297302246
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.102 Vali Acc: 0.253 Test Loss: 5.102 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3359992504119873
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.112 Vali Acc: 0.252 Test Loss: 5.112 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.042468786239624
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.119 Vali Acc: 0.248 Test Loss: 5.119 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.1439802646636963
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.141 Vali Acc: 0.249 Test Loss: 5.141 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1219587326049805
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.155 Vali Acc: 0.253 Test Loss: 5.155 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0980336666107178
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.166 Vali Acc: 0.248 Test Loss: 5.166 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.9158804416656494
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.178 Vali Acc: 0.256 Test Loss: 5.178 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.9754443168640137
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.191 Vali Acc: 0.260 Test Loss: 5.191 Test Acc: 0.260
Validation loss decreased (-0.258773 --> -0.259948).  Saving model ...
Epoch: 57 cost time: 1.16371750831604
Epoch: 57, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.192 Vali Acc: 0.258 Test Loss: 5.192 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.2909505367279053
Epoch: 58, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.212 Vali Acc: 0.261 Test Loss: 5.212 Test Acc: 0.261
Validation loss decreased (-0.259948 --> -0.261124).  Saving model ...
Epoch: 59 cost time: 1.03725004196167
Epoch: 59, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.235 Vali Acc: 0.254 Test Loss: 5.235 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.3213164806365967
Epoch: 60, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.244 Vali Acc: 0.254 Test Loss: 5.244 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.375060796737671
Epoch: 61, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.254 Vali Acc: 0.253 Test Loss: 5.254 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.245448350906372
Epoch: 62, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.272 Vali Acc: 0.254 Test Loss: 5.272 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.1710107326507568
Epoch: 63, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.290 Vali Acc: 0.254 Test Loss: 5.290 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.3112561702728271
Epoch: 64, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.308 Vali Acc: 0.254 Test Loss: 5.308 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.2548816204071045
Epoch: 65, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.326 Vali Acc: 0.255 Test Loss: 5.326 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.1378142833709717
Epoch: 66, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.328 Vali Acc: 0.260 Test Loss: 5.328 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.1862330436706543
Epoch: 67, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.339 Vali Acc: 0.255 Test Loss: 5.339 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.1443774700164795
Epoch: 68, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.342 Vali Acc: 0.255 Test Loss: 5.342 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 1139506
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5526671409606934
Epoch: 1, Steps: 10 | Train Loss: 3.373 Vali Loss: 3.339 Vali Acc: 0.058 Test Loss: 3.339 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 1.1597402095794678
Epoch: 2, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.396 Vali Acc: 0.045 Test Loss: 3.396 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2235107421875
Epoch: 3, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.329 Vali Acc: 0.076 Test Loss: 3.329 Test Acc: 0.076
Validation loss decreased (-0.057614 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 0.8107948303222656
Epoch: 4, Steps: 10 | Train Loss: 2.977 Vali Loss: 3.318 Vali Acc: 0.080 Test Loss: 3.318 Test Acc: 0.080
Validation loss decreased (-0.076437 --> -0.079967).  Saving model ...
Epoch: 5 cost time: 1.1593523025512695
Epoch: 5, Steps: 10 | Train Loss: 2.835 Vali Loss: 3.293 Vali Acc: 0.100 Test Loss: 3.293 Test Acc: 0.100
Validation loss decreased (-0.079967 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 1.1971960067749023
Epoch: 6, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.238 Vali Acc: 0.102 Test Loss: 3.238 Test Acc: 0.102
Validation loss decreased (-0.099967 --> -0.102321).  Saving model ...
Epoch: 7 cost time: 1.025658130645752
Epoch: 7, Steps: 10 | Train Loss: 2.479 Vali Loss: 3.275 Vali Acc: 0.121 Test Loss: 3.275 Test Acc: 0.121
Validation loss decreased (-0.102321 --> -0.121144).  Saving model ...
Epoch: 8 cost time: 0.9503030776977539
Epoch: 8, Steps: 10 | Train Loss: 2.291 Vali Loss: 3.272 Vali Acc: 0.126 Test Loss: 3.272 Test Acc: 0.126
Validation loss decreased (-0.121144 --> -0.125850).  Saving model ...
Epoch: 9 cost time: 1.0922338962554932
Epoch: 9, Steps: 10 | Train Loss: 2.058 Vali Loss: 3.276 Vali Acc: 0.133 Test Loss: 3.276 Test Acc: 0.133
Validation loss decreased (-0.125850 --> -0.132908).  Saving model ...
Epoch: 10 cost time: 1.0271217823028564
Epoch: 10, Steps: 10 | Train Loss: 1.888 Vali Loss: 3.304 Vali Acc: 0.151 Test Loss: 3.304 Test Acc: 0.151
Validation loss decreased (-0.132908 --> -0.150555).  Saving model ...
Epoch: 11 cost time: 1.0321776866912842
Epoch: 11, Steps: 10 | Train Loss: 1.701 Vali Loss: 3.307 Vali Acc: 0.168 Test Loss: 3.307 Test Acc: 0.168
Validation loss decreased (-0.150555 --> -0.168202).  Saving model ...
Epoch: 12 cost time: 1.3009557723999023
Epoch: 12, Steps: 10 | Train Loss: 1.503 Vali Loss: 3.335 Vali Acc: 0.169 Test Loss: 3.335 Test Acc: 0.169
Validation loss decreased (-0.168202 --> -0.169378).  Saving model ...
Epoch: 13 cost time: 1.2006146907806396
Epoch: 13, Steps: 10 | Train Loss: 1.279 Vali Loss: 3.443 Vali Acc: 0.185 Test Loss: 3.443 Test Acc: 0.185
Validation loss decreased (-0.169378 --> -0.184671).  Saving model ...
Epoch: 14 cost time: 1.203850507736206
Epoch: 14, Steps: 10 | Train Loss: 1.150 Vali Loss: 3.424 Vali Acc: 0.201 Test Loss: 3.424 Test Acc: 0.201
Validation loss decreased (-0.184671 --> -0.201142).  Saving model ...
Epoch: 15 cost time: 1.0552592277526855
Epoch: 15, Steps: 10 | Train Loss: 0.994 Vali Loss: 3.535 Vali Acc: 0.218 Test Loss: 3.535 Test Acc: 0.218
Validation loss decreased (-0.201142 --> -0.217612).  Saving model ...
Epoch: 16 cost time: 1.0623009204864502
Epoch: 16, Steps: 10 | Train Loss: 0.794 Vali Loss: 3.637 Vali Acc: 0.215 Test Loss: 3.637 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1278653144836426
Epoch: 17, Steps: 10 | Train Loss: 0.638 Vali Loss: 3.642 Vali Acc: 0.215 Test Loss: 3.642 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.138904333114624
Epoch: 18, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.762 Vali Acc: 0.239 Test Loss: 3.762 Test Acc: 0.239
Validation loss decreased (-0.217612 --> -0.238786).  Saving model ...
Epoch: 19 cost time: 0.9605803489685059
Epoch: 19, Steps: 10 | Train Loss: 0.441 Vali Loss: 3.896 Vali Acc: 0.229 Test Loss: 3.896 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1553514003753662
Epoch: 20, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.999 Vali Acc: 0.235 Test Loss: 3.999 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0352506637573242
Epoch: 21, Steps: 10 | Train Loss: 0.300 Vali Loss: 4.037 Vali Acc: 0.231 Test Loss: 4.037 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9499399662017822
Epoch: 22, Steps: 10 | Train Loss: 0.211 Vali Loss: 4.132 Vali Acc: 0.238 Test Loss: 4.132 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0259077548980713
Epoch: 23, Steps: 10 | Train Loss: 0.156 Vali Loss: 4.227 Vali Acc: 0.247 Test Loss: 4.227 Test Acc: 0.247
Validation loss decreased (-0.238786 --> -0.247017).  Saving model ...
Epoch: 24 cost time: 1.19022798538208
Epoch: 24, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.397 Vali Acc: 0.241 Test Loss: 4.397 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.373884916305542
Epoch: 25, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.390 Vali Acc: 0.248 Test Loss: 4.390 Test Acc: 0.248
Validation loss decreased (-0.247017 --> -0.248191).  Saving model ...
Epoch: 26 cost time: 1.1021568775177002
Epoch: 26, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.528 Vali Acc: 0.238 Test Loss: 4.528 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2999427318572998
Epoch: 27, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.605 Vali Acc: 0.240 Test Loss: 4.605 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0773849487304688
Epoch: 28, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.682 Vali Acc: 0.236 Test Loss: 4.682 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.073061227798462
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.655 Vali Acc: 0.245 Test Loss: 4.655 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1483232975006104
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.738 Vali Acc: 0.241 Test Loss: 4.738 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8620719909667969
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.735 Vali Acc: 0.244 Test Loss: 4.735 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0530247688293457
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.739 Vali Acc: 0.254 Test Loss: 4.739 Test Acc: 0.254
Validation loss decreased (-0.248191 --> -0.254070).  Saving model ...
Epoch: 33 cost time: 0.8866207599639893
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.805 Vali Acc: 0.241 Test Loss: 4.805 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0390377044677734
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.829 Vali Acc: 0.251 Test Loss: 4.829 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9663724899291992
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.848 Vali Acc: 0.249 Test Loss: 4.848 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0698506832122803
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.858 Vali Acc: 0.249 Test Loss: 4.858 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0258445739746094
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.883 Vali Acc: 0.255 Test Loss: 4.883 Test Acc: 0.255
Validation loss decreased (-0.254070 --> -0.255245).  Saving model ...
Epoch: 38 cost time: 1.0362327098846436
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.914 Vali Acc: 0.253 Test Loss: 4.914 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1445813179016113
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.942 Vali Acc: 0.252 Test Loss: 4.942 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2499022483825684
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.951 Vali Acc: 0.252 Test Loss: 4.951 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0608770847320557
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.979 Vali Acc: 0.251 Test Loss: 4.979 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.06925630569458
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.020 Vali Acc: 0.246 Test Loss: 5.020 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1504108905792236
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.043 Vali Acc: 0.249 Test Loss: 5.043 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9012446403503418
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.048 Vali Acc: 0.247 Test Loss: 5.048 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9244658946990967
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.061 Vali Acc: 0.249 Test Loss: 5.061 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.1737425327301025
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.084 Vali Acc: 0.246 Test Loss: 5.084 Test Acc: 0.246
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.2238898277282715
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.106 Vali Acc: 0.248 Test Loss: 5.106 Test Acc: 0.248
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 1137842
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.595907211303711
Epoch: 1, Steps: 10 | Train Loss: 3.415 Vali Loss: 3.340 Vali Acc: 0.039 Test Loss: 3.340 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.2693939208984375
Epoch: 2, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.425 Vali Acc: 0.044 Test Loss: 3.425 Test Acc: 0.044
Validation loss decreased (-0.038790 --> -0.043495).  Saving model ...
Epoch: 3 cost time: 1.0396344661712646
Epoch: 3, Steps: 10 | Train Loss: 3.156 Vali Loss: 3.345 Vali Acc: 0.076 Test Loss: 3.345 Test Acc: 0.076
Validation loss decreased (-0.043495 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 1.1093285083770752
Epoch: 4, Steps: 10 | Train Loss: 3.010 Vali Loss: 3.270 Vali Acc: 0.075 Test Loss: 3.270 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2788803577423096
Epoch: 5, Steps: 10 | Train Loss: 2.828 Vali Loss: 3.283 Vali Acc: 0.119 Test Loss: 3.283 Test Acc: 0.119
Validation loss decreased (-0.076437 --> -0.118791).  Saving model ...
Epoch: 6 cost time: 1.1419570446014404
Epoch: 6, Steps: 10 | Train Loss: 2.638 Vali Loss: 3.294 Vali Acc: 0.152 Test Loss: 3.294 Test Acc: 0.152
Validation loss decreased (-0.118791 --> -0.151732).  Saving model ...
Epoch: 7 cost time: 0.9425280094146729
Epoch: 7, Steps: 10 | Train Loss: 2.436 Vali Loss: 3.243 Vali Acc: 0.125 Test Loss: 3.243 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8889830112457275
Epoch: 8, Steps: 10 | Train Loss: 2.300 Vali Loss: 3.226 Vali Acc: 0.176 Test Loss: 3.226 Test Acc: 0.176
Validation loss decreased (-0.151732 --> -0.176438).  Saving model ...
Epoch: 9 cost time: 1.0696969032287598
Epoch: 9, Steps: 10 | Train Loss: 2.049 Vali Loss: 3.319 Vali Acc: 0.141 Test Loss: 3.319 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1220698356628418
Epoch: 10, Steps: 10 | Train Loss: 1.853 Vali Loss: 3.319 Vali Acc: 0.187 Test Loss: 3.319 Test Acc: 0.187
Validation loss decreased (-0.176438 --> -0.187026).  Saving model ...
Epoch: 11 cost time: 0.8865127563476562
Epoch: 11, Steps: 10 | Train Loss: 1.663 Vali Loss: 3.315 Vali Acc: 0.168 Test Loss: 3.315 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3540887832641602
Epoch: 12, Steps: 10 | Train Loss: 1.547 Vali Loss: 3.365 Vali Acc: 0.202 Test Loss: 3.365 Test Acc: 0.202
Validation loss decreased (-0.187026 --> -0.202319).  Saving model ...
Epoch: 13 cost time: 1.0479304790496826
Epoch: 13, Steps: 10 | Train Loss: 1.339 Vali Loss: 3.419 Vali Acc: 0.187 Test Loss: 3.419 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1162972450256348
Epoch: 14, Steps: 10 | Train Loss: 1.117 Vali Loss: 3.464 Vali Acc: 0.192 Test Loss: 3.464 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9781303405761719
Epoch: 15, Steps: 10 | Train Loss: 0.947 Vali Loss: 3.503 Vali Acc: 0.214 Test Loss: 3.503 Test Acc: 0.214
Validation loss decreased (-0.202319 --> -0.214083).  Saving model ...
Epoch: 16 cost time: 1.1162400245666504
Epoch: 16, Steps: 10 | Train Loss: 0.852 Vali Loss: 3.613 Vali Acc: 0.219 Test Loss: 3.613 Test Acc: 0.219
Validation loss decreased (-0.214083 --> -0.218787).  Saving model ...
Epoch: 17 cost time: 1.0068950653076172
Epoch: 17, Steps: 10 | Train Loss: 0.712 Vali Loss: 3.661 Vali Acc: 0.226 Test Loss: 3.661 Test Acc: 0.226
Validation loss decreased (-0.218787 --> -0.225846).  Saving model ...
Epoch: 18 cost time: 0.8794267177581787
Epoch: 18, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.823 Vali Acc: 0.235 Test Loss: 3.823 Test Acc: 0.235
Validation loss decreased (-0.225846 --> -0.235256).  Saving model ...
Epoch: 19 cost time: 0.9693799018859863
Epoch: 19, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.780 Vali Acc: 0.232 Test Loss: 3.780 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3660812377929688
Epoch: 20, Steps: 10 | Train Loss: 0.366 Vali Loss: 4.064 Vali Acc: 0.228 Test Loss: 4.064 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1880114078521729
Epoch: 21, Steps: 10 | Train Loss: 0.258 Vali Loss: 4.006 Vali Acc: 0.238 Test Loss: 4.006 Test Acc: 0.238
Validation loss decreased (-0.235256 --> -0.237607).  Saving model ...
Epoch: 22 cost time: 1.2024133205413818
Epoch: 22, Steps: 10 | Train Loss: 0.218 Vali Loss: 4.237 Vali Acc: 0.234 Test Loss: 4.237 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1801836490631104
Epoch: 23, Steps: 10 | Train Loss: 0.161 Vali Loss: 4.231 Vali Acc: 0.240 Test Loss: 4.231 Test Acc: 0.240
Validation loss decreased (-0.237607 --> -0.239958).  Saving model ...
Epoch: 24 cost time: 1.0174741744995117
Epoch: 24, Steps: 10 | Train Loss: 0.123 Vali Loss: 4.331 Vali Acc: 0.233 Test Loss: 4.331 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0791394710540771
Epoch: 25, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.533 Vali Acc: 0.224 Test Loss: 4.533 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2251007556915283
Epoch: 26, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.540 Vali Acc: 0.228 Test Loss: 4.540 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1714262962341309
Epoch: 27, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.610 Vali Acc: 0.232 Test Loss: 4.610 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2167010307312012
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.636 Vali Acc: 0.238 Test Loss: 4.636 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.219285011291504
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.621 Vali Acc: 0.242 Test Loss: 4.621 Test Acc: 0.242
Validation loss decreased (-0.239958 --> -0.242307).  Saving model ...
Epoch: 30 cost time: 0.9320423603057861
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.738 Vali Acc: 0.246 Test Loss: 4.738 Test Acc: 0.246
Validation loss decreased (-0.242307 --> -0.245835).  Saving model ...
Epoch: 31 cost time: 1.1922423839569092
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.755 Vali Acc: 0.255 Test Loss: 4.755 Test Acc: 0.255
Validation loss decreased (-0.245835 --> -0.255247).  Saving model ...
Epoch: 32 cost time: 1.2533583641052246
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.773 Vali Acc: 0.253 Test Loss: 4.773 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0081584453582764
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.792 Vali Acc: 0.256 Test Loss: 4.792 Test Acc: 0.256
Validation loss decreased (-0.255247 --> -0.256423).  Saving model ...
Epoch: 34 cost time: 0.912043571472168
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.797 Vali Acc: 0.248 Test Loss: 4.797 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2721226215362549
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.803 Vali Acc: 0.246 Test Loss: 4.803 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1604773998260498
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.822 Vali Acc: 0.245 Test Loss: 4.822 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3026235103607178
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.861 Vali Acc: 0.248 Test Loss: 4.861 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2630712985992432
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.880 Vali Acc: 0.249 Test Loss: 4.880 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2895491123199463
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.878 Vali Acc: 0.253 Test Loss: 4.878 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.193990707397461
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.896 Vali Acc: 0.253 Test Loss: 4.896 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.306931972503662
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.938 Vali Acc: 0.255 Test Loss: 4.938 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.210456371307373
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.958 Vali Acc: 0.253 Test Loss: 4.958 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.201488971710205
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.977 Vali Acc: 0.256 Test Loss: 4.977 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 1136178
model size : 6.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2181668281555176
Epoch: 1, Steps: 10 | Train Loss: 3.411 Vali Loss: 3.307 Vali Acc: 0.022 Test Loss: 3.307 Test Acc: 0.022
Validation loss decreased (inf --> -0.022320).  Saving model ...
Epoch: 2 cost time: 1.5599710941314697
Epoch: 2, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.406 Vali Acc: 0.061 Test Loss: 3.406 Test Acc: 0.061
Validation loss decreased (-0.022320 --> -0.061142).  Saving model ...
Epoch: 3 cost time: 1.7943997383117676
Epoch: 3, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.359 Vali Acc: 0.064 Test Loss: 3.359 Test Acc: 0.064
Validation loss decreased (-0.061142 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 1.4659459590911865
Epoch: 4, Steps: 10 | Train Loss: 2.952 Vali Loss: 3.270 Vali Acc: 0.091 Test Loss: 3.270 Test Acc: 0.091
Validation loss decreased (-0.063496 --> -0.090556).  Saving model ...
Epoch: 5 cost time: 1.289604902267456
Epoch: 5, Steps: 10 | Train Loss: 2.805 Vali Loss: 3.281 Vali Acc: 0.101 Test Loss: 3.281 Test Acc: 0.101
Validation loss decreased (-0.090556 --> -0.101144).  Saving model ...
Epoch: 6 cost time: 1.2876780033111572
Epoch: 6, Steps: 10 | Train Loss: 2.664 Vali Loss: 3.230 Vali Acc: 0.102 Test Loss: 3.230 Test Acc: 0.102
Validation loss decreased (-0.101144 --> -0.102321).  Saving model ...
Epoch: 7 cost time: 1.119483470916748
Epoch: 7, Steps: 10 | Train Loss: 2.511 Vali Loss: 3.261 Vali Acc: 0.116 Test Loss: 3.261 Test Acc: 0.116
Validation loss decreased (-0.102321 --> -0.116438).  Saving model ...
Epoch: 8 cost time: 1.3379812240600586
Epoch: 8, Steps: 10 | Train Loss: 2.285 Vali Loss: 3.251 Vali Acc: 0.132 Test Loss: 3.251 Test Acc: 0.132
Validation loss decreased (-0.116438 --> -0.131732).  Saving model ...
Epoch: 9 cost time: 0.9942619800567627
Epoch: 9, Steps: 10 | Train Loss: 2.079 Vali Loss: 3.248 Vali Acc: 0.141 Test Loss: 3.248 Test Acc: 0.141
Validation loss decreased (-0.131732 --> -0.141144).  Saving model ...
Epoch: 10 cost time: 1.3362183570861816
Epoch: 10, Steps: 10 | Train Loss: 1.878 Vali Loss: 3.280 Vali Acc: 0.147 Test Loss: 3.280 Test Acc: 0.147
Validation loss decreased (-0.141144 --> -0.147026).  Saving model ...
Epoch: 11 cost time: 1.08819580078125
Epoch: 11, Steps: 10 | Train Loss: 1.722 Vali Loss: 3.278 Vali Acc: 0.180 Test Loss: 3.278 Test Acc: 0.180
Validation loss decreased (-0.147026 --> -0.179967).  Saving model ...
Epoch: 12 cost time: 1.075636863708496
Epoch: 12, Steps: 10 | Train Loss: 1.544 Vali Loss: 3.368 Vali Acc: 0.165 Test Loss: 3.368 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.342832326889038
Epoch: 13, Steps: 10 | Train Loss: 1.309 Vali Loss: 3.420 Vali Acc: 0.182 Test Loss: 3.420 Test Acc: 0.182
Validation loss decreased (-0.179967 --> -0.182319).  Saving model ...
Epoch: 14 cost time: 1.3733689785003662
Epoch: 14, Steps: 10 | Train Loss: 1.121 Vali Loss: 3.444 Vali Acc: 0.188 Test Loss: 3.444 Test Acc: 0.188
Validation loss decreased (-0.182319 --> -0.188201).  Saving model ...
Epoch: 15 cost time: 1.3188748359680176
Epoch: 15, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.550 Vali Acc: 0.204 Test Loss: 3.550 Test Acc: 0.204
Validation loss decreased (-0.188201 --> -0.203494).  Saving model ...
Epoch: 16 cost time: 1.1070666313171387
Epoch: 16, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.555 Vali Acc: 0.191 Test Loss: 3.555 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3696990013122559
Epoch: 17, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.678 Vali Acc: 0.207 Test Loss: 3.678 Test Acc: 0.207
Validation loss decreased (-0.203494 --> -0.207022).  Saving model ...
Epoch: 18 cost time: 1.0907785892486572
Epoch: 18, Steps: 10 | Train Loss: 0.624 Vali Loss: 3.683 Vali Acc: 0.216 Test Loss: 3.683 Test Acc: 0.216
Validation loss decreased (-0.207022 --> -0.216434).  Saving model ...
Epoch: 19 cost time: 1.2027947902679443
Epoch: 19, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.885 Vali Acc: 0.212 Test Loss: 3.885 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0996568202972412
Epoch: 20, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.895 Vali Acc: 0.239 Test Loss: 3.895 Test Acc: 0.239
Validation loss decreased (-0.216434 --> -0.238785).  Saving model ...
Epoch: 21 cost time: 1.4388427734375
Epoch: 21, Steps: 10 | Train Loss: 0.291 Vali Loss: 4.074 Vali Acc: 0.225 Test Loss: 4.074 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.101315975189209
Epoch: 22, Steps: 10 | Train Loss: 0.235 Vali Loss: 4.189 Vali Acc: 0.231 Test Loss: 4.189 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.235564947128296
Epoch: 23, Steps: 10 | Train Loss: 0.196 Vali Loss: 4.229 Vali Acc: 0.238 Test Loss: 4.229 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2146365642547607
Epoch: 24, Steps: 10 | Train Loss: 0.138 Vali Loss: 4.333 Vali Acc: 0.240 Test Loss: 4.333 Test Acc: 0.240
Validation loss decreased (-0.238785 --> -0.239957).  Saving model ...
Epoch: 25 cost time: 1.3625462055206299
Epoch: 25, Steps: 10 | Train Loss: 0.112 Vali Loss: 4.348 Vali Acc: 0.224 Test Loss: 4.348 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2315807342529297
Epoch: 26, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.473 Vali Acc: 0.238 Test Loss: 4.473 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7064299583435059
Epoch: 27, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.565 Vali Acc: 0.235 Test Loss: 4.565 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7528162002563477
Epoch: 28, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.582 Vali Acc: 0.245 Test Loss: 4.582 Test Acc: 0.245
Validation loss decreased (-0.239957 --> -0.244660).  Saving model ...
Epoch: 29 cost time: 1.0021262168884277
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.735 Vali Acc: 0.238 Test Loss: 4.735 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2060341835021973
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.686 Vali Acc: 0.241 Test Loss: 4.686 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.237257480621338
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.700 Vali Acc: 0.249 Test Loss: 4.700 Test Acc: 0.249
Validation loss decreased (-0.244660 --> -0.249365).  Saving model ...
Epoch: 32 cost time: 1.241912841796875
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.746 Vali Acc: 0.256 Test Loss: 4.746 Test Acc: 0.256
Validation loss decreased (-0.249365 --> -0.256423).  Saving model ...
Epoch: 33 cost time: 0.8520603179931641
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.760 Vali Acc: 0.258 Test Loss: 4.760 Test Acc: 0.258
Validation loss decreased (-0.256423 --> -0.257599).  Saving model ...
Epoch: 34 cost time: 1.0360002517700195
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.790 Vali Acc: 0.254 Test Loss: 4.790 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.358832597732544
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.827 Vali Acc: 0.254 Test Loss: 4.827 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.191244125366211
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.863 Vali Acc: 0.256 Test Loss: 4.863 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1821815967559814
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.882 Vali Acc: 0.259 Test Loss: 4.882 Test Acc: 0.259
Validation loss decreased (-0.257599 --> -0.258775).  Saving model ...
Epoch: 38 cost time: 1.3330748081207275
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.907 Vali Acc: 0.256 Test Loss: 4.907 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5228495597839355
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.921 Vali Acc: 0.255 Test Loss: 4.921 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.405306339263916
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.937 Vali Acc: 0.259 Test Loss: 4.937 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3796539306640625
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.963 Vali Acc: 0.255 Test Loss: 4.963 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1991026401519775
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.980 Vali Acc: 0.255 Test Loss: 4.980 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.946413516998291
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.013 Vali Acc: 0.259 Test Loss: 5.013 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.2142751216888428
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.031 Vali Acc: 0.254 Test Loss: 5.031 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.2086083889007568
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.037 Vali Acc: 0.253 Test Loss: 5.037 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.296034812927246
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.046 Vali Acc: 0.259 Test Loss: 5.046 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.261397123336792
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.076 Vali Acc: 0.259 Test Loss: 5.076 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 1042482
model size : 6.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1261913776397705
Epoch: 1, Steps: 10 | Train Loss: 3.403 Vali Loss: 3.321 Vali Acc: 0.034 Test Loss: 3.321 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.9920356273651123
Epoch: 2, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.396 Vali Acc: 0.036 Test Loss: 3.396 Test Acc: 0.036
Validation loss decreased (-0.034084 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 1.264117956161499
Epoch: 3, Steps: 10 | Train Loss: 3.148 Vali Loss: 3.350 Vali Acc: 0.072 Test Loss: 3.350 Test Acc: 0.072
Validation loss decreased (-0.036437 --> -0.071731).  Saving model ...
Epoch: 4 cost time: 1.079338788986206
Epoch: 4, Steps: 10 | Train Loss: 3.050 Vali Loss: 3.282 Vali Acc: 0.082 Test Loss: 3.282 Test Acc: 0.082
Validation loss decreased (-0.071731 --> -0.082320).  Saving model ...
Epoch: 5 cost time: 1.2887952327728271
Epoch: 5, Steps: 10 | Train Loss: 2.839 Vali Loss: 3.269 Vali Acc: 0.078 Test Loss: 3.269 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1527881622314453
Epoch: 6, Steps: 10 | Train Loss: 2.734 Vali Loss: 3.290 Vali Acc: 0.107 Test Loss: 3.290 Test Acc: 0.107
Validation loss decreased (-0.082320 --> -0.107026).  Saving model ...
Epoch: 7 cost time: 0.9312613010406494
Epoch: 7, Steps: 10 | Train Loss: 2.516 Vali Loss: 3.259 Vali Acc: 0.116 Test Loss: 3.259 Test Acc: 0.116
Validation loss decreased (-0.107026 --> -0.116438).  Saving model ...
Epoch: 8 cost time: 1.195225477218628
Epoch: 8, Steps: 10 | Train Loss: 2.377 Vali Loss: 3.208 Vali Acc: 0.139 Test Loss: 3.208 Test Acc: 0.139
Validation loss decreased (-0.116438 --> -0.138791).  Saving model ...
Epoch: 9 cost time: 1.2373592853546143
Epoch: 9, Steps: 10 | Train Loss: 2.263 Vali Loss: 3.284 Vali Acc: 0.118 Test Loss: 3.284 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.166372299194336
Epoch: 10, Steps: 10 | Train Loss: 1.941 Vali Loss: 3.283 Vali Acc: 0.144 Test Loss: 3.283 Test Acc: 0.144
Validation loss decreased (-0.138791 --> -0.143497).  Saving model ...
Epoch: 11 cost time: 1.0790784358978271
Epoch: 11, Steps: 10 | Train Loss: 1.778 Vali Loss: 3.335 Vali Acc: 0.151 Test Loss: 3.335 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150555).  Saving model ...
Epoch: 12 cost time: 1.395500659942627
Epoch: 12, Steps: 10 | Train Loss: 1.539 Vali Loss: 3.281 Vali Acc: 0.180 Test Loss: 3.281 Test Acc: 0.180
Validation loss decreased (-0.150555 --> -0.179967).  Saving model ...
Epoch: 13 cost time: 1.0528395175933838
Epoch: 13, Steps: 10 | Train Loss: 1.343 Vali Loss: 3.382 Vali Acc: 0.179 Test Loss: 3.382 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0695617198944092
Epoch: 14, Steps: 10 | Train Loss: 1.137 Vali Loss: 3.385 Vali Acc: 0.194 Test Loss: 3.385 Test Acc: 0.194
Validation loss decreased (-0.179967 --> -0.194084).  Saving model ...
Epoch: 15 cost time: 1.219316005706787
Epoch: 15, Steps: 10 | Train Loss: 0.985 Vali Loss: 3.467 Vali Acc: 0.209 Test Loss: 3.467 Test Acc: 0.209
Validation loss decreased (-0.194084 --> -0.209377).  Saving model ...
Epoch: 16 cost time: 1.2501163482666016
Epoch: 16, Steps: 10 | Train Loss: 0.843 Vali Loss: 3.554 Vali Acc: 0.204 Test Loss: 3.554 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.175565481185913
Epoch: 17, Steps: 10 | Train Loss: 0.692 Vali Loss: 3.701 Vali Acc: 0.205 Test Loss: 3.701 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3432886600494385
Epoch: 18, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.738 Vali Acc: 0.231 Test Loss: 3.738 Test Acc: 0.231
Validation loss decreased (-0.209377 --> -0.230551).  Saving model ...
Epoch: 19 cost time: 1.1595287322998047
Epoch: 19, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.896 Vali Acc: 0.211 Test Loss: 3.896 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5457327365875244
Epoch: 20, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.893 Vali Acc: 0.231 Test Loss: 3.893 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3712284564971924
Epoch: 21, Steps: 10 | Train Loss: 0.326 Vali Loss: 4.025 Vali Acc: 0.233 Test Loss: 4.025 Test Acc: 0.233
Validation loss decreased (-0.230551 --> -0.232901).  Saving model ...
Epoch: 22 cost time: 1.2188220024108887
Epoch: 22, Steps: 10 | Train Loss: 0.198 Vali Loss: 4.174 Vali Acc: 0.241 Test Loss: 4.174 Test Acc: 0.241
Validation loss decreased (-0.232901 --> -0.241135).  Saving model ...
Epoch: 23 cost time: 1.1986093521118164
Epoch: 23, Steps: 10 | Train Loss: 0.159 Vali Loss: 4.166 Vali Acc: 0.247 Test Loss: 4.166 Test Acc: 0.247
Validation loss decreased (-0.241135 --> -0.247017).  Saving model ...
Epoch: 24 cost time: 1.3766698837280273
Epoch: 24, Steps: 10 | Train Loss: 0.116 Vali Loss: 4.357 Vali Acc: 0.231 Test Loss: 4.357 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1829731464385986
Epoch: 25, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.498 Vali Acc: 0.225 Test Loss: 4.498 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6069588661193848
Epoch: 26, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.512 Vali Acc: 0.235 Test Loss: 4.512 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3271632194519043
Epoch: 27, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.634 Vali Acc: 0.229 Test Loss: 4.634 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.277679443359375
Epoch: 28, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.687 Vali Acc: 0.235 Test Loss: 4.687 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2529296875
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.803 Vali Acc: 0.244 Test Loss: 4.803 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6786820888519287
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.752 Vali Acc: 0.236 Test Loss: 4.752 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5159337520599365
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.757 Vali Acc: 0.240 Test Loss: 4.757 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.5047998428344727
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.893 Vali Acc: 0.248 Test Loss: 4.893 Test Acc: 0.248
Validation loss decreased (-0.247017 --> -0.248186).  Saving model ...
Epoch: 33 cost time: 1.2382440567016602
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.855 Vali Acc: 0.252 Test Loss: 4.855 Test Acc: 0.252
Validation loss decreased (-0.248186 --> -0.251716).  Saving model ...
Epoch: 34 cost time: 1.3631207942962646
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.851 Vali Acc: 0.247 Test Loss: 4.851 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5729405879974365
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.859 Vali Acc: 0.254 Test Loss: 4.859 Test Acc: 0.254
Validation loss decreased (-0.251716 --> -0.254069).  Saving model ...
Epoch: 36 cost time: 1.2671172618865967
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.884 Vali Acc: 0.259 Test Loss: 4.884 Test Acc: 0.259
Validation loss decreased (-0.254069 --> -0.258775).  Saving model ...
Epoch: 37 cost time: 1.2056028842926025
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.925 Vali Acc: 0.258 Test Loss: 4.925 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.41115140914917
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.949 Vali Acc: 0.259 Test Loss: 4.949 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2448558807373047
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.958 Vali Acc: 0.255 Test Loss: 4.958 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.614607572555542
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.979 Vali Acc: 0.255 Test Loss: 4.979 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.366783618927002
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.014 Vali Acc: 0.256 Test Loss: 5.014 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.42997407913208
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.030 Vali Acc: 0.254 Test Loss: 5.030 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.2594959735870361
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.049 Vali Acc: 0.256 Test Loss: 5.049 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.5838892459869385
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.062 Vali Acc: 0.256 Test Loss: 5.062 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.2505910396575928
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.064 Vali Acc: 0.255 Test Loss: 5.064 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.2346501350402832
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.079 Vali Acc: 0.254 Test Loss: 5.079 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 1040818
model size : 6.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1983137130737305
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.336 Vali Acc: 0.051 Test Loss: 3.336 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.35361909866333
Epoch: 2, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.408 Vali Acc: 0.056 Test Loss: 3.408 Test Acc: 0.056
Validation loss decreased (-0.050555 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 1.0726544857025146
Epoch: 3, Steps: 10 | Train Loss: 3.130 Vali Loss: 3.365 Vali Acc: 0.078 Test Loss: 3.365 Test Acc: 0.078
Validation loss decreased (-0.056437 --> -0.077613).  Saving model ...
Epoch: 4 cost time: 0.9510629177093506
Epoch: 4, Steps: 10 | Train Loss: 2.958 Vali Loss: 3.302 Vali Acc: 0.082 Test Loss: 3.302 Test Acc: 0.082
Validation loss decreased (-0.077613 --> -0.082320).  Saving model ...
Epoch: 5 cost time: 1.064225673675537
Epoch: 5, Steps: 10 | Train Loss: 2.851 Vali Loss: 3.328 Vali Acc: 0.085 Test Loss: 3.328 Test Acc: 0.085
Validation loss decreased (-0.082320 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 1.1214523315429688
Epoch: 6, Steps: 10 | Train Loss: 2.615 Vali Loss: 3.254 Vali Acc: 0.128 Test Loss: 3.254 Test Acc: 0.128
Validation loss decreased (-0.084673 --> -0.128203).  Saving model ...
Epoch: 7 cost time: 1.0879662036895752
Epoch: 7, Steps: 10 | Train Loss: 2.503 Vali Loss: 3.271 Vali Acc: 0.109 Test Loss: 3.271 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.983715295791626
Epoch: 8, Steps: 10 | Train Loss: 2.275 Vali Loss: 3.280 Vali Acc: 0.111 Test Loss: 3.280 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.212019443511963
Epoch: 9, Steps: 10 | Train Loss: 2.101 Vali Loss: 3.272 Vali Acc: 0.144 Test Loss: 3.272 Test Acc: 0.144
Validation loss decreased (-0.128203 --> -0.143497).  Saving model ...
Epoch: 10 cost time: 1.059748888015747
Epoch: 10, Steps: 10 | Train Loss: 1.953 Vali Loss: 3.306 Vali Acc: 0.154 Test Loss: 3.306 Test Acc: 0.154
Validation loss decreased (-0.143497 --> -0.154085).  Saving model ...
Epoch: 11 cost time: 0.9635095596313477
Epoch: 11, Steps: 10 | Train Loss: 1.745 Vali Loss: 3.366 Vali Acc: 0.144 Test Loss: 3.366 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1341230869293213
Epoch: 12, Steps: 10 | Train Loss: 1.544 Vali Loss: 3.367 Vali Acc: 0.185 Test Loss: 3.367 Test Acc: 0.185
Validation loss decreased (-0.154085 --> -0.184672).  Saving model ...
Epoch: 13 cost time: 1.2105872631072998
Epoch: 13, Steps: 10 | Train Loss: 1.329 Vali Loss: 3.401 Vali Acc: 0.164 Test Loss: 3.401 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2022576332092285
Epoch: 14, Steps: 10 | Train Loss: 1.202 Vali Loss: 3.474 Vali Acc: 0.211 Test Loss: 3.474 Test Acc: 0.211
Validation loss decreased (-0.184672 --> -0.210553).  Saving model ...
Epoch: 15 cost time: 1.2240662574768066
Epoch: 15, Steps: 10 | Train Loss: 0.969 Vali Loss: 3.572 Vali Acc: 0.176 Test Loss: 3.572 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.000636339187622
Epoch: 16, Steps: 10 | Train Loss: 0.863 Vali Loss: 3.544 Vali Acc: 0.209 Test Loss: 3.544 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3886830806732178
Epoch: 17, Steps: 10 | Train Loss: 0.760 Vali Loss: 3.668 Vali Acc: 0.212 Test Loss: 3.668 Test Acc: 0.212
Validation loss decreased (-0.210553 --> -0.211728).  Saving model ...
Epoch: 18 cost time: 1.3429787158966064
Epoch: 18, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.748 Vali Acc: 0.218 Test Loss: 3.748 Test Acc: 0.218
Validation loss decreased (-0.211728 --> -0.217610).  Saving model ...
Epoch: 19 cost time: 0.8696813583374023
Epoch: 19, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.897 Vali Acc: 0.227 Test Loss: 3.897 Test Acc: 0.227
Validation loss decreased (-0.217610 --> -0.227020).  Saving model ...
Epoch: 20 cost time: 1.0819787979125977
Epoch: 20, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.900 Vali Acc: 0.236 Test Loss: 3.900 Test Acc: 0.236
Validation loss decreased (-0.227020 --> -0.236432).  Saving model ...
Epoch: 21 cost time: 1.1749989986419678
Epoch: 21, Steps: 10 | Train Loss: 0.307 Vali Loss: 4.090 Vali Acc: 0.224 Test Loss: 4.090 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.058812141418457
Epoch: 22, Steps: 10 | Train Loss: 0.260 Vali Loss: 4.214 Vali Acc: 0.231 Test Loss: 4.214 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9905924797058105
Epoch: 23, Steps: 10 | Train Loss: 0.192 Vali Loss: 4.268 Vali Acc: 0.228 Test Loss: 4.268 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.158651351928711
Epoch: 24, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.344 Vali Acc: 0.241 Test Loss: 4.344 Test Acc: 0.241
Validation loss decreased (-0.236432 --> -0.241133).  Saving model ...
Epoch: 25 cost time: 1.2967650890350342
Epoch: 25, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.467 Vali Acc: 0.228 Test Loss: 4.467 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0781099796295166
Epoch: 26, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.511 Vali Acc: 0.221 Test Loss: 4.511 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0519616603851318
Epoch: 27, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.632 Vali Acc: 0.247 Test Loss: 4.632 Test Acc: 0.247
Validation loss decreased (-0.241133 --> -0.247013).  Saving model ...
Epoch: 28 cost time: 1.1788535118103027
Epoch: 28, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.679 Vali Acc: 0.233 Test Loss: 4.679 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.329561710357666
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.686 Vali Acc: 0.232 Test Loss: 4.686 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.279038429260254
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.656 Vali Acc: 0.248 Test Loss: 4.656 Test Acc: 0.248
Validation loss decreased (-0.247013 --> -0.248189).  Saving model ...
Epoch: 31 cost time: 1.2792670726776123
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.774 Vali Acc: 0.241 Test Loss: 4.774 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2129392623901367
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.790 Vali Acc: 0.248 Test Loss: 4.790 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1086575984954834
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.771 Vali Acc: 0.252 Test Loss: 4.771 Test Acc: 0.252
Validation loss decreased (-0.248189 --> -0.251717).  Saving model ...
Epoch: 34 cost time: 0.8993446826934814
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.771 Vali Acc: 0.245 Test Loss: 4.771 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5257322788238525
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.799 Vali Acc: 0.248 Test Loss: 4.799 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2406785488128662
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.883 Vali Acc: 0.247 Test Loss: 4.883 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1554062366485596
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.892 Vali Acc: 0.246 Test Loss: 4.892 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.4824776649475098
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.910 Vali Acc: 0.254 Test Loss: 4.910 Test Acc: 0.254
Validation loss decreased (-0.251717 --> -0.254069).  Saving model ...
Epoch: 39 cost time: 1.0597572326660156
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.901 Vali Acc: 0.254 Test Loss: 4.901 Test Acc: 0.254
Validation loss decreased (-0.254069 --> -0.254069).  Saving model ...
Epoch: 40 cost time: 1.1544239521026611
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.919 Vali Acc: 0.253 Test Loss: 4.919 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.279794692993164
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.958 Vali Acc: 0.249 Test Loss: 4.958 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2577040195465088
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.003 Vali Acc: 0.251 Test Loss: 5.003 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3065533638000488
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.036 Vali Acc: 0.251 Test Loss: 5.036 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1808843612670898
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.032 Vali Acc: 0.247 Test Loss: 5.032 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.1563799381256104
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.034 Vali Acc: 0.254 Test Loss: 5.034 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0088458061218262
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.061 Vali Acc: 0.258 Test Loss: 5.061 Test Acc: 0.258
Validation loss decreased (-0.254069 --> -0.257596).  Saving model ...
Epoch: 47 cost time: 1.12685227394104
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.088 Vali Acc: 0.252 Test Loss: 5.088 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3144688606262207
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.102 Vali Acc: 0.248 Test Loss: 5.102 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.4622840881347656
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.114 Vali Acc: 0.258 Test Loss: 5.114 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1167256832122803
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.106 Vali Acc: 0.254 Test Loss: 5.106 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.2433888912200928
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.131 Vali Acc: 0.255 Test Loss: 5.131 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.2065908908843994
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.145 Vali Acc: 0.252 Test Loss: 5.145 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.3602910041809082
Epoch: 53, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.165 Vali Acc: 0.253 Test Loss: 5.165 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.105271339416504
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.184 Vali Acc: 0.252 Test Loss: 5.184 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.323401689529419
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.202 Vali Acc: 0.255 Test Loss: 5.202 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.4843511581420898
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.224 Vali Acc: 0.253 Test Loss: 5.224 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 1039154
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.306140184402466
Epoch: 1, Steps: 10 | Train Loss: 3.404 Vali Loss: 3.325 Vali Acc: 0.033 Test Loss: 3.325 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 1.293729305267334
Epoch: 2, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.384 Vali Acc: 0.040 Test Loss: 3.384 Test Acc: 0.040
Validation loss decreased (-0.032908 --> -0.039966).  Saving model ...
Epoch: 3 cost time: 1.2123382091522217
Epoch: 3, Steps: 10 | Train Loss: 3.119 Vali Loss: 3.381 Vali Acc: 0.064 Test Loss: 3.381 Test Acc: 0.064
Validation loss decreased (-0.039966 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 1.139686107635498
Epoch: 4, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.273 Vali Acc: 0.075 Test Loss: 3.273 Test Acc: 0.075
Validation loss decreased (-0.063496 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 1.3535218238830566
Epoch: 5, Steps: 10 | Train Loss: 2.833 Vali Loss: 3.275 Vali Acc: 0.074 Test Loss: 3.275 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1417450904846191
Epoch: 6, Steps: 10 | Train Loss: 2.659 Vali Loss: 3.277 Vali Acc: 0.113 Test Loss: 3.277 Test Acc: 0.113
Validation loss decreased (-0.075261 --> -0.112908).  Saving model ...
Epoch: 7 cost time: 1.158271074295044
Epoch: 7, Steps: 10 | Train Loss: 2.460 Vali Loss: 3.271 Vali Acc: 0.111 Test Loss: 3.271 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.081394910812378
Epoch: 8, Steps: 10 | Train Loss: 2.284 Vali Loss: 3.221 Vali Acc: 0.129 Test Loss: 3.221 Test Acc: 0.129
Validation loss decreased (-0.112908 --> -0.129380).  Saving model ...
Epoch: 9 cost time: 1.2662014961242676
Epoch: 9, Steps: 10 | Train Loss: 2.108 Vali Loss: 3.283 Vali Acc: 0.126 Test Loss: 3.283 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5421783924102783
Epoch: 10, Steps: 10 | Train Loss: 1.885 Vali Loss: 3.300 Vali Acc: 0.140 Test Loss: 3.300 Test Acc: 0.140
Validation loss decreased (-0.129380 --> -0.139967).  Saving model ...
Epoch: 11 cost time: 1.3813965320587158
Epoch: 11, Steps: 10 | Train Loss: 1.724 Vali Loss: 3.233 Vali Acc: 0.159 Test Loss: 3.233 Test Acc: 0.159
Validation loss decreased (-0.139967 --> -0.158791).  Saving model ...
Epoch: 12 cost time: 1.1822805404663086
Epoch: 12, Steps: 10 | Train Loss: 1.507 Vali Loss: 3.383 Vali Acc: 0.159 Test Loss: 3.383 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3790802955627441
Epoch: 13, Steps: 10 | Train Loss: 1.394 Vali Loss: 3.354 Vali Acc: 0.171 Test Loss: 3.354 Test Acc: 0.171
Validation loss decreased (-0.158791 --> -0.170555).  Saving model ...
Epoch: 14 cost time: 1.4049310684204102
Epoch: 14, Steps: 10 | Train Loss: 1.172 Vali Loss: 3.434 Vali Acc: 0.185 Test Loss: 3.434 Test Acc: 0.185
Validation loss decreased (-0.170555 --> -0.184672).  Saving model ...
Epoch: 15 cost time: 1.0496137142181396
Epoch: 15, Steps: 10 | Train Loss: 1.017 Vali Loss: 3.496 Vali Acc: 0.189 Test Loss: 3.496 Test Acc: 0.189
Validation loss decreased (-0.184672 --> -0.189377).  Saving model ...
Epoch: 16 cost time: 1.3323400020599365
Epoch: 16, Steps: 10 | Train Loss: 0.838 Vali Loss: 3.552 Vali Acc: 0.201 Test Loss: 3.552 Test Acc: 0.201
Validation loss decreased (-0.189377 --> -0.201141).  Saving model ...
Epoch: 17 cost time: 1.1680538654327393
Epoch: 17, Steps: 10 | Train Loss: 0.753 Vali Loss: 3.592 Vali Acc: 0.211 Test Loss: 3.592 Test Acc: 0.211
Validation loss decreased (-0.201141 --> -0.210552).  Saving model ...
Epoch: 18 cost time: 1.3182458877563477
Epoch: 18, Steps: 10 | Train Loss: 0.570 Vali Loss: 3.686 Vali Acc: 0.231 Test Loss: 3.686 Test Acc: 0.231
Validation loss decreased (-0.210552 --> -0.230551).  Saving model ...
Epoch: 19 cost time: 1.3336522579193115
Epoch: 19, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.717 Vali Acc: 0.229 Test Loss: 3.717 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2196598052978516
Epoch: 20, Steps: 10 | Train Loss: 0.379 Vali Loss: 3.821 Vali Acc: 0.219 Test Loss: 3.821 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2578928470611572
Epoch: 21, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.959 Vali Acc: 0.235 Test Loss: 3.959 Test Acc: 0.235
Validation loss decreased (-0.230551 --> -0.235255).  Saving model ...
Epoch: 22 cost time: 1.0326764583587646
Epoch: 22, Steps: 10 | Train Loss: 0.241 Vali Loss: 4.162 Vali Acc: 0.207 Test Loss: 4.162 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2169222831726074
Epoch: 23, Steps: 10 | Train Loss: 0.188 Vali Loss: 4.143 Vali Acc: 0.229 Test Loss: 4.143 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3408010005950928
Epoch: 24, Steps: 10 | Train Loss: 0.130 Vali Loss: 4.201 Vali Acc: 0.239 Test Loss: 4.201 Test Acc: 0.239
Validation loss decreased (-0.235255 --> -0.238782).  Saving model ...
Epoch: 25 cost time: 1.2228374481201172
Epoch: 25, Steps: 10 | Train Loss: 0.165 Vali Loss: 4.312 Vali Acc: 0.245 Test Loss: 4.312 Test Acc: 0.245
Validation loss decreased (-0.238782 --> -0.244663).  Saving model ...
Epoch: 26 cost time: 1.3865044116973877
Epoch: 26, Steps: 10 | Train Loss: 0.144 Vali Loss: 4.477 Vali Acc: 0.239 Test Loss: 4.477 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2156953811645508
Epoch: 27, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.597 Vali Acc: 0.221 Test Loss: 4.597 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2924091815948486
Epoch: 28, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.453 Vali Acc: 0.242 Test Loss: 4.453 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3129322528839111
Epoch: 29, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.732 Vali Acc: 0.236 Test Loss: 4.732 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.170454502105713
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.690 Vali Acc: 0.245 Test Loss: 4.690 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.4213037490844727
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.624 Vali Acc: 0.259 Test Loss: 4.624 Test Acc: 0.259
Validation loss decreased (-0.244663 --> -0.258777).  Saving model ...
Epoch: 32 cost time: 1.3748366832733154
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.633 Vali Acc: 0.259 Test Loss: 4.633 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2836875915527344
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.698 Vali Acc: 0.252 Test Loss: 4.698 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5095703601837158
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.741 Vali Acc: 0.248 Test Loss: 4.741 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5540437698364258
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.718 Vali Acc: 0.247 Test Loss: 4.718 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.518352746963501
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.709 Vali Acc: 0.258 Test Loss: 4.709 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.766556978225708
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.760 Vali Acc: 0.255 Test Loss: 4.760 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5599822998046875
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.777 Vali Acc: 0.259 Test Loss: 4.777 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3687996864318848
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.816 Vali Acc: 0.253 Test Loss: 4.816 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.4407007694244385
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.861 Vali Acc: 0.249 Test Loss: 4.861 Test Acc: 0.249
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.5636029243469238
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.858 Vali Acc: 0.251 Test Loss: 4.858 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 1037490
model size : 6.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.225116729736328
Epoch: 1, Steps: 10 | Train Loss: 3.479 Vali Loss: 3.383 Vali Acc: 0.041 Test Loss: 3.383 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.0981054306030273
Epoch: 2, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.328 Vali Acc: 0.061 Test Loss: 3.328 Test Acc: 0.061
Validation loss decreased (-0.041143 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 0.9039349555969238
Epoch: 3, Steps: 10 | Train Loss: 3.233 Vali Loss: 3.382 Vali Acc: 0.059 Test Loss: 3.382 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.206000804901123
Epoch: 4, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.342 Vali Acc: 0.055 Test Loss: 3.342 Test Acc: 0.055
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.288123607635498
Epoch: 5, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.327 Vali Acc: 0.087 Test Loss: 3.327 Test Acc: 0.087
Validation loss decreased (-0.061143 --> -0.087026).  Saving model ...
Epoch: 6 cost time: 1.0130150318145752
Epoch: 6, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.283 Vali Acc: 0.085 Test Loss: 3.283 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1156578063964844
Epoch: 7, Steps: 10 | Train Loss: 2.792 Vali Loss: 3.267 Vali Acc: 0.109 Test Loss: 3.267 Test Acc: 0.109
Validation loss decreased (-0.087026 --> -0.109379).  Saving model ...
Epoch: 8 cost time: 1.019796371459961
Epoch: 8, Steps: 10 | Train Loss: 2.604 Vali Loss: 3.255 Vali Acc: 0.100 Test Loss: 3.255 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0610744953155518
Epoch: 9, Steps: 10 | Train Loss: 2.499 Vali Loss: 3.267 Vali Acc: 0.129 Test Loss: 3.267 Test Acc: 0.129
Validation loss decreased (-0.109379 --> -0.129379).  Saving model ...
Epoch: 10 cost time: 1.1169569492340088
Epoch: 10, Steps: 10 | Train Loss: 2.331 Vali Loss: 3.265 Vali Acc: 0.132 Test Loss: 3.265 Test Acc: 0.132
Validation loss decreased (-0.129379 --> -0.131732).  Saving model ...
Epoch: 11 cost time: 1.000819444656372
Epoch: 11, Steps: 10 | Train Loss: 2.158 Vali Loss: 3.249 Vali Acc: 0.133 Test Loss: 3.249 Test Acc: 0.133
Validation loss decreased (-0.131732 --> -0.132909).  Saving model ...
Epoch: 12 cost time: 1.1621136665344238
Epoch: 12, Steps: 10 | Train Loss: 1.990 Vali Loss: 3.264 Vali Acc: 0.140 Test Loss: 3.264 Test Acc: 0.140
Validation loss decreased (-0.132909 --> -0.139967).  Saving model ...
Epoch: 13 cost time: 1.0102896690368652
Epoch: 13, Steps: 10 | Train Loss: 1.822 Vali Loss: 3.265 Vali Acc: 0.169 Test Loss: 3.265 Test Acc: 0.169
Validation loss decreased (-0.139967 --> -0.169379).  Saving model ...
Epoch: 14 cost time: 0.9426403045654297
Epoch: 14, Steps: 10 | Train Loss: 1.634 Vali Loss: 3.300 Vali Acc: 0.175 Test Loss: 3.300 Test Acc: 0.175
Validation loss decreased (-0.169379 --> -0.175261).  Saving model ...
Epoch: 15 cost time: 1.097203254699707
Epoch: 15, Steps: 10 | Train Loss: 1.460 Vali Loss: 3.328 Vali Acc: 0.185 Test Loss: 3.328 Test Acc: 0.185
Validation loss decreased (-0.175261 --> -0.184673).  Saving model ...
Epoch: 16 cost time: 0.985903263092041
Epoch: 16, Steps: 10 | Train Loss: 1.362 Vali Loss: 3.374 Vali Acc: 0.187 Test Loss: 3.374 Test Acc: 0.187
Validation loss decreased (-0.184673 --> -0.187025).  Saving model ...
Epoch: 17 cost time: 0.9133684635162354
Epoch: 17, Steps: 10 | Train Loss: 1.161 Vali Loss: 3.393 Vali Acc: 0.209 Test Loss: 3.393 Test Acc: 0.209
Validation loss decreased (-0.187025 --> -0.209378).  Saving model ...
Epoch: 18 cost time: 1.4982328414916992
Epoch: 18, Steps: 10 | Train Loss: 1.011 Vali Loss: 3.444 Vali Acc: 0.202 Test Loss: 3.444 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0912089347839355
Epoch: 19, Steps: 10 | Train Loss: 0.885 Vali Loss: 3.461 Vali Acc: 0.213 Test Loss: 3.461 Test Acc: 0.213
Validation loss decreased (-0.209378 --> -0.212907).  Saving model ...
Epoch: 20 cost time: 0.9943027496337891
Epoch: 20, Steps: 10 | Train Loss: 0.794 Vali Loss: 3.531 Vali Acc: 0.218 Test Loss: 3.531 Test Acc: 0.218
Validation loss decreased (-0.212907 --> -0.217612).  Saving model ...
Epoch: 21 cost time: 0.8669242858886719
Epoch: 21, Steps: 10 | Train Loss: 0.651 Vali Loss: 3.552 Vali Acc: 0.226 Test Loss: 3.552 Test Acc: 0.226
Validation loss decreased (-0.217612 --> -0.225847).  Saving model ...
Epoch: 22 cost time: 0.9694259166717529
Epoch: 22, Steps: 10 | Train Loss: 0.599 Vali Loss: 3.595 Vali Acc: 0.225 Test Loss: 3.595 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9073565006256104
Epoch: 23, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.654 Vali Acc: 0.231 Test Loss: 3.654 Test Acc: 0.231
Validation loss decreased (-0.225847 --> -0.230552).  Saving model ...
Epoch: 24 cost time: 1.1039085388183594
Epoch: 24, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.761 Vali Acc: 0.229 Test Loss: 3.761 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9498775005340576
Epoch: 25, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.797 Vali Acc: 0.231 Test Loss: 3.797 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0267016887664795
Epoch: 26, Steps: 10 | Train Loss: 0.275 Vali Loss: 3.798 Vali Acc: 0.249 Test Loss: 3.798 Test Acc: 0.249
Validation loss decreased (-0.230552 --> -0.249374).  Saving model ...
Epoch: 27 cost time: 0.940687894821167
Epoch: 27, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.911 Vali Acc: 0.253 Test Loss: 3.911 Test Acc: 0.253
Validation loss decreased (-0.249374 --> -0.252902).  Saving model ...
Epoch: 28 cost time: 1.0793368816375732
Epoch: 28, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.915 Vali Acc: 0.241 Test Loss: 3.915 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0237360000610352
Epoch: 29, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.959 Vali Acc: 0.235 Test Loss: 3.959 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.858043909072876
Epoch: 30, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.019 Vali Acc: 0.236 Test Loss: 4.019 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8253803253173828
Epoch: 31, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.056 Vali Acc: 0.245 Test Loss: 4.056 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9037210941314697
Epoch: 32, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.160 Vali Acc: 0.231 Test Loss: 4.160 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9654631614685059
Epoch: 33, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.126 Vali Acc: 0.247 Test Loss: 4.126 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0730228424072266
Epoch: 34, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.188 Vali Acc: 0.236 Test Loss: 4.188 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0924408435821533
Epoch: 35, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.186 Vali Acc: 0.241 Test Loss: 4.186 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1108887195587158
Epoch: 36, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.231 Vali Acc: 0.245 Test Loss: 4.231 Test Acc: 0.245
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0583465099334717
Epoch: 37, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.215 Vali Acc: 0.240 Test Loss: 4.215 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 671602
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0576274394989014
Epoch: 1, Steps: 10 | Train Loss: 3.530 Vali Loss: 3.380 Vali Acc: 0.032 Test Loss: 3.380 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 1.210026741027832
Epoch: 2, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.345 Vali Acc: 0.039 Test Loss: 3.345 Test Acc: 0.039
Validation loss decreased (-0.031731 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 1.1736869812011719
Epoch: 3, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.412 Vali Acc: 0.055 Test Loss: 3.412 Test Acc: 0.055
Validation loss decreased (-0.038790 --> -0.055260).  Saving model ...
Epoch: 4 cost time: 0.8458919525146484
Epoch: 4, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.373 Vali Acc: 0.034 Test Loss: 3.373 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9176769256591797
Epoch: 5, Steps: 10 | Train Loss: 3.011 Vali Loss: 3.311 Vali Acc: 0.085 Test Loss: 3.311 Test Acc: 0.085
Validation loss decreased (-0.055260 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.8997347354888916
Epoch: 6, Steps: 10 | Train Loss: 2.907 Vali Loss: 3.286 Vali Acc: 0.091 Test Loss: 3.286 Test Acc: 0.091
Validation loss decreased (-0.084673 --> -0.090555).  Saving model ...
Epoch: 7 cost time: 0.9453895092010498
Epoch: 7, Steps: 10 | Train Loss: 2.793 Vali Loss: 3.269 Vali Acc: 0.105 Test Loss: 3.269 Test Acc: 0.105
Validation loss decreased (-0.090555 --> -0.104673).  Saving model ...
Epoch: 8 cost time: 0.8591253757476807
Epoch: 8, Steps: 10 | Train Loss: 2.661 Vali Loss: 3.267 Vali Acc: 0.111 Test Loss: 3.267 Test Acc: 0.111
Validation loss decreased (-0.104673 --> -0.110556).  Saving model ...
Epoch: 9 cost time: 1.1148371696472168
Epoch: 9, Steps: 10 | Train Loss: 2.518 Vali Loss: 3.249 Vali Acc: 0.114 Test Loss: 3.249 Test Acc: 0.114
Validation loss decreased (-0.110556 --> -0.114085).  Saving model ...
Epoch: 10 cost time: 1.1432275772094727
Epoch: 10, Steps: 10 | Train Loss: 2.345 Vali Loss: 3.234 Vali Acc: 0.142 Test Loss: 3.234 Test Acc: 0.142
Validation loss decreased (-0.114085 --> -0.142321).  Saving model ...
Epoch: 11 cost time: 0.8735370635986328
Epoch: 11, Steps: 10 | Train Loss: 2.165 Vali Loss: 3.267 Vali Acc: 0.138 Test Loss: 3.267 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0553550720214844
Epoch: 12, Steps: 10 | Train Loss: 1.950 Vali Loss: 3.232 Vali Acc: 0.160 Test Loss: 3.232 Test Acc: 0.160
Validation loss decreased (-0.142321 --> -0.159968).  Saving model ...
Epoch: 13 cost time: 1.0042173862457275
Epoch: 13, Steps: 10 | Train Loss: 1.848 Vali Loss: 3.264 Vali Acc: 0.153 Test Loss: 3.264 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2330880165100098
Epoch: 14, Steps: 10 | Train Loss: 1.610 Vali Loss: 3.282 Vali Acc: 0.185 Test Loss: 3.282 Test Acc: 0.185
Validation loss decreased (-0.159968 --> -0.184673).  Saving model ...
Epoch: 15 cost time: 1.0447924137115479
Epoch: 15, Steps: 10 | Train Loss: 1.480 Vali Loss: 3.272 Vali Acc: 0.195 Test Loss: 3.272 Test Acc: 0.195
Validation loss decreased (-0.184673 --> -0.195261).  Saving model ...
Epoch: 16 cost time: 1.016143560409546
Epoch: 16, Steps: 10 | Train Loss: 1.296 Vali Loss: 3.359 Vali Acc: 0.182 Test Loss: 3.359 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.165306806564331
Epoch: 17, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.333 Vali Acc: 0.208 Test Loss: 3.333 Test Acc: 0.208
Validation loss decreased (-0.195261 --> -0.208202).  Saving model ...
Epoch: 18 cost time: 0.9872753620147705
Epoch: 18, Steps: 10 | Train Loss: 1.033 Vali Loss: 3.388 Vali Acc: 0.219 Test Loss: 3.388 Test Acc: 0.219
Validation loss decreased (-0.208202 --> -0.218790).  Saving model ...
Epoch: 19 cost time: 1.0822508335113525
Epoch: 19, Steps: 10 | Train Loss: 0.918 Vali Loss: 3.462 Vali Acc: 0.212 Test Loss: 3.462 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.925832986831665
Epoch: 20, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.432 Vali Acc: 0.231 Test Loss: 3.432 Test Acc: 0.231
Validation loss decreased (-0.218790 --> -0.230554).  Saving model ...
Epoch: 21 cost time: 0.9744861125946045
Epoch: 21, Steps: 10 | Train Loss: 0.682 Vali Loss: 3.571 Vali Acc: 0.220 Test Loss: 3.571 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2242097854614258
Epoch: 22, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.549 Vali Acc: 0.229 Test Loss: 3.549 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8787600994110107
Epoch: 23, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.563 Vali Acc: 0.249 Test Loss: 3.563 Test Acc: 0.249
Validation loss decreased (-0.230554 --> -0.249376).  Saving model ...
Epoch: 24 cost time: 1.0507194995880127
Epoch: 24, Steps: 10 | Train Loss: 0.434 Vali Loss: 3.710 Vali Acc: 0.245 Test Loss: 3.710 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.144164800643921
Epoch: 25, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.676 Vali Acc: 0.244 Test Loss: 3.676 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1599557399749756
Epoch: 26, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.819 Vali Acc: 0.251 Test Loss: 3.819 Test Acc: 0.251
Validation loss decreased (-0.249376 --> -0.250550).  Saving model ...
Epoch: 27 cost time: 1.0396218299865723
Epoch: 27, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.878 Vali Acc: 0.247 Test Loss: 3.878 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.14654541015625
Epoch: 28, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.873 Vali Acc: 0.262 Test Loss: 3.873 Test Acc: 0.262
Validation loss decreased (-0.250550 --> -0.262314).  Saving model ...
Epoch: 29 cost time: 1.1917593479156494
Epoch: 29, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.975 Vali Acc: 0.245 Test Loss: 3.975 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0505785942077637
Epoch: 30, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.937 Vali Acc: 0.247 Test Loss: 3.937 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.127793788909912
Epoch: 31, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.097 Vali Acc: 0.253 Test Loss: 4.097 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0862092971801758
Epoch: 32, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.078 Vali Acc: 0.245 Test Loss: 4.078 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0674664974212646
Epoch: 33, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.122 Vali Acc: 0.246 Test Loss: 4.122 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2542648315429688
Epoch: 34, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.146 Vali Acc: 0.258 Test Loss: 4.146 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2925934791564941
Epoch: 35, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.146 Vali Acc: 0.245 Test Loss: 4.146 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.273815631866455
Epoch: 36, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.177 Vali Acc: 0.256 Test Loss: 4.177 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2060320377349854
Epoch: 37, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.242 Vali Acc: 0.255 Test Loss: 4.242 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1482281684875488
Epoch: 38, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.266 Vali Acc: 0.251 Test Loss: 4.266 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26235294117647057
model parameter : 670770
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4015166759490967
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.336 Vali Acc: 0.048 Test Loss: 3.336 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 1.247201681137085
Epoch: 2, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.325 Vali Acc: 0.044 Test Loss: 3.325 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2585582733154297
Epoch: 3, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.334 Vali Acc: 0.049 Test Loss: 3.334 Test Acc: 0.049
Validation loss decreased (-0.048202 --> -0.049378).  Saving model ...
Epoch: 4 cost time: 1.0113561153411865
Epoch: 4, Steps: 10 | Train Loss: 3.071 Vali Loss: 3.316 Vali Acc: 0.067 Test Loss: 3.316 Test Acc: 0.067
Validation loss decreased (-0.049378 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 1.145204782485962
Epoch: 5, Steps: 10 | Train Loss: 2.991 Vali Loss: 3.276 Vali Acc: 0.084 Test Loss: 3.276 Test Acc: 0.084
Validation loss decreased (-0.067026 --> -0.083497).  Saving model ...
Epoch: 6 cost time: 1.280712604522705
Epoch: 6, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.266 Vali Acc: 0.084 Test Loss: 3.266 Test Acc: 0.084
Validation loss decreased (-0.083497 --> -0.083497).  Saving model ...
Epoch: 7 cost time: 1.0425825119018555
Epoch: 7, Steps: 10 | Train Loss: 2.670 Vali Loss: 3.244 Vali Acc: 0.099 Test Loss: 3.244 Test Acc: 0.099
Validation loss decreased (-0.083497 --> -0.098791).  Saving model ...
Epoch: 8 cost time: 1.0878570079803467
Epoch: 8, Steps: 10 | Train Loss: 2.604 Vali Loss: 3.240 Vali Acc: 0.114 Test Loss: 3.240 Test Acc: 0.114
Validation loss decreased (-0.098791 --> -0.114085).  Saving model ...
Epoch: 9 cost time: 1.2567145824432373
Epoch: 9, Steps: 10 | Train Loss: 2.447 Vali Loss: 3.228 Vali Acc: 0.129 Test Loss: 3.228 Test Acc: 0.129
Validation loss decreased (-0.114085 --> -0.129379).  Saving model ...
Epoch: 10 cost time: 1.2079010009765625
Epoch: 10, Steps: 10 | Train Loss: 2.219 Vali Loss: 3.222 Vali Acc: 0.141 Test Loss: 3.222 Test Acc: 0.141
Validation loss decreased (-0.129379 --> -0.141144).  Saving model ...
Epoch: 11 cost time: 1.0550265312194824
Epoch: 11, Steps: 10 | Train Loss: 2.131 Vali Loss: 3.243 Vali Acc: 0.158 Test Loss: 3.243 Test Acc: 0.158
Validation loss decreased (-0.141144 --> -0.157615).  Saving model ...
Epoch: 12 cost time: 0.984886646270752
Epoch: 12, Steps: 10 | Train Loss: 1.913 Vali Loss: 3.248 Vali Acc: 0.149 Test Loss: 3.248 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1963260173797607
Epoch: 13, Steps: 10 | Train Loss: 1.743 Vali Loss: 3.236 Vali Acc: 0.180 Test Loss: 3.236 Test Acc: 0.180
Validation loss decreased (-0.157615 --> -0.179968).  Saving model ...
Epoch: 14 cost time: 1.050678014755249
Epoch: 14, Steps: 10 | Train Loss: 1.640 Vali Loss: 3.321 Vali Acc: 0.178 Test Loss: 3.321 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0878071784973145
Epoch: 15, Steps: 10 | Train Loss: 1.463 Vali Loss: 3.310 Vali Acc: 0.178 Test Loss: 3.310 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4920387268066406
Epoch: 16, Steps: 10 | Train Loss: 1.231 Vali Loss: 3.319 Vali Acc: 0.205 Test Loss: 3.319 Test Acc: 0.205
Validation loss decreased (-0.179968 --> -0.204673).  Saving model ...
Epoch: 17 cost time: 1.3269147872924805
Epoch: 17, Steps: 10 | Train Loss: 1.100 Vali Loss: 3.362 Vali Acc: 0.228 Test Loss: 3.362 Test Acc: 0.228
Validation loss decreased (-0.204673 --> -0.228202).  Saving model ...
Epoch: 18 cost time: 1.1277210712432861
Epoch: 18, Steps: 10 | Train Loss: 0.954 Vali Loss: 3.408 Vali Acc: 0.214 Test Loss: 3.408 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.293914556503296
Epoch: 19, Steps: 10 | Train Loss: 0.907 Vali Loss: 3.461 Vali Acc: 0.222 Test Loss: 3.461 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0404627323150635
Epoch: 20, Steps: 10 | Train Loss: 0.797 Vali Loss: 3.473 Vali Acc: 0.229 Test Loss: 3.473 Test Acc: 0.229
Validation loss decreased (-0.228202 --> -0.229377).  Saving model ...
Epoch: 21 cost time: 1.054358720779419
Epoch: 21, Steps: 10 | Train Loss: 0.715 Vali Loss: 3.497 Vali Acc: 0.248 Test Loss: 3.497 Test Acc: 0.248
Validation loss decreased (-0.229377 --> -0.248200).  Saving model ...
Epoch: 22 cost time: 1.4650285243988037
Epoch: 22, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.635 Vali Acc: 0.231 Test Loss: 3.635 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.242351770401001
Epoch: 23, Steps: 10 | Train Loss: 0.446 Vali Loss: 3.567 Vali Acc: 0.247 Test Loss: 3.567 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5429527759552002
Epoch: 24, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.641 Vali Acc: 0.251 Test Loss: 3.641 Test Acc: 0.251
Validation loss decreased (-0.248200 --> -0.250552).  Saving model ...
Epoch: 25 cost time: 1.1758415699005127
Epoch: 25, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.674 Vali Acc: 0.251 Test Loss: 3.674 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4411358833312988
Epoch: 26, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.759 Vali Acc: 0.264 Test Loss: 3.759 Test Acc: 0.264
Validation loss decreased (-0.250552 --> -0.263492).  Saving model ...
Epoch: 27 cost time: 1.1361274719238281
Epoch: 27, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.812 Vali Acc: 0.260 Test Loss: 3.812 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7253375053405762
Epoch: 28, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.807 Vali Acc: 0.260 Test Loss: 3.807 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3785417079925537
Epoch: 29, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.901 Vali Acc: 0.260 Test Loss: 3.901 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3021743297576904
Epoch: 30, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.960 Vali Acc: 0.264 Test Loss: 3.960 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2722094058990479
Epoch: 31, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.961 Vali Acc: 0.260 Test Loss: 3.961 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1225254535675049
Epoch: 32, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.998 Vali Acc: 0.262 Test Loss: 3.998 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.130650520324707
Epoch: 33, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.025 Vali Acc: 0.267 Test Loss: 4.025 Test Acc: 0.267
Validation loss decreased (-0.263492 --> -0.267019).  Saving model ...
Epoch: 34 cost time: 1.1547014713287354
Epoch: 34, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.044 Vali Acc: 0.266 Test Loss: 4.044 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0002365112304688
Epoch: 35, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.039 Vali Acc: 0.261 Test Loss: 4.039 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3821864128112793
Epoch: 36, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.075 Vali Acc: 0.259 Test Loss: 4.075 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.120405912399292
Epoch: 37, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.077 Vali Acc: 0.265 Test Loss: 4.077 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.212726354598999
Epoch: 38, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.129 Vali Acc: 0.264 Test Loss: 4.129 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2066302299499512
Epoch: 39, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.124 Vali Acc: 0.268 Test Loss: 4.124 Test Acc: 0.268
Validation loss decreased (-0.267019 --> -0.268194).  Saving model ...
Epoch: 40 cost time: 1.1703548431396484
Epoch: 40, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.158 Vali Acc: 0.266 Test Loss: 4.158 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1573374271392822
Epoch: 41, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.187 Vali Acc: 0.262 Test Loss: 4.187 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2686729431152344
Epoch: 42, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.227 Vali Acc: 0.262 Test Loss: 4.227 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.306555986404419
Epoch: 43, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.221 Vali Acc: 0.268 Test Loss: 4.221 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1841888427734375
Epoch: 44, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.224 Vali Acc: 0.273 Test Loss: 4.224 Test Acc: 0.273
Validation loss decreased (-0.268194 --> -0.272899).  Saving model ...
Epoch: 45 cost time: 1.2833795547485352
Epoch: 45, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.253 Vali Acc: 0.268 Test Loss: 4.253 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1799745559692383
Epoch: 46, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.269 Vali Acc: 0.268 Test Loss: 4.269 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1081657409667969
Epoch: 47, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.288 Vali Acc: 0.274 Test Loss: 4.288 Test Acc: 0.274
Validation loss decreased (-0.272899 --> -0.274075).  Saving model ...
Epoch: 48 cost time: 1.0149285793304443
Epoch: 48, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.299 Vali Acc: 0.268 Test Loss: 4.299 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1576449871063232
Epoch: 49, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.304 Vali Acc: 0.269 Test Loss: 4.304 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.411353349685669
Epoch: 50, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.308 Vali Acc: 0.267 Test Loss: 4.308 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.3687093257904053
Epoch: 51, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.354 Vali Acc: 0.262 Test Loss: 4.354 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.338820219039917
Epoch: 52, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.360 Vali Acc: 0.272 Test Loss: 4.360 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1755144596099854
Epoch: 53, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.374 Vali Acc: 0.279 Test Loss: 4.374 Test Acc: 0.279
Validation loss decreased (-0.274075 --> -0.278780).  Saving model ...
Epoch: 54 cost time: 1.1546382904052734
Epoch: 54, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.396 Vali Acc: 0.268 Test Loss: 4.396 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1331045627593994
Epoch: 55, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.380 Vali Acc: 0.274 Test Loss: 4.380 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.1448960304260254
Epoch: 56, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.418 Vali Acc: 0.273 Test Loss: 4.418 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.0657284259796143
Epoch: 57, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.423 Vali Acc: 0.273 Test Loss: 4.423 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.2352793216705322
Epoch: 58, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.450 Vali Acc: 0.274 Test Loss: 4.450 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.1900339126586914
Epoch: 59, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.435 Vali Acc: 0.271 Test Loss: 4.435 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.189560890197754
Epoch: 60, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.461 Vali Acc: 0.273 Test Loss: 4.461 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.278480052947998
Epoch: 61, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.462 Vali Acc: 0.271 Test Loss: 4.462 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.3050651550292969
Epoch: 62, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.463 Vali Acc: 0.271 Test Loss: 4.463 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.2342100143432617
Epoch: 63, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.488 Vali Acc: 0.273 Test Loss: 4.488 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 669938
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5255370140075684
Epoch: 1, Steps: 10 | Train Loss: 3.484 Vali Loss: 3.352 Vali Acc: 0.035 Test Loss: 3.352 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 1.3797047138214111
Epoch: 2, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.321 Vali Acc: 0.058 Test Loss: 3.321 Test Acc: 0.058
Validation loss decreased (-0.035261 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 1.0963258743286133
Epoch: 3, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.391 Vali Acc: 0.042 Test Loss: 3.391 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0647804737091064
Epoch: 4, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.367 Vali Acc: 0.052 Test Loss: 3.367 Test Acc: 0.052
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9518070220947266
Epoch: 5, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.305 Vali Acc: 0.075 Test Loss: 3.305 Test Acc: 0.075
Validation loss decreased (-0.057614 --> -0.075261).  Saving model ...
Epoch: 6 cost time: 1.1451473236083984
Epoch: 6, Steps: 10 | Train Loss: 2.886 Vali Loss: 3.277 Vali Acc: 0.086 Test Loss: 3.277 Test Acc: 0.086
Validation loss decreased (-0.075261 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 0.8717541694641113
Epoch: 7, Steps: 10 | Train Loss: 2.758 Vali Loss: 3.264 Vali Acc: 0.092 Test Loss: 3.264 Test Acc: 0.092
Validation loss decreased (-0.085850 --> -0.091732).  Saving model ...
Epoch: 8 cost time: 0.8874516487121582
Epoch: 8, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.257 Vali Acc: 0.094 Test Loss: 3.257 Test Acc: 0.094
Validation loss decreased (-0.091732 --> -0.094085).  Saving model ...
Epoch: 9 cost time: 0.9739270210266113
Epoch: 9, Steps: 10 | Train Loss: 2.496 Vali Loss: 3.227 Vali Acc: 0.114 Test Loss: 3.227 Test Acc: 0.114
Validation loss decreased (-0.094085 --> -0.114085).  Saving model ...
Epoch: 10 cost time: 0.885857343673706
Epoch: 10, Steps: 10 | Train Loss: 2.370 Vali Loss: 3.257 Vali Acc: 0.134 Test Loss: 3.257 Test Acc: 0.134
Validation loss decreased (-0.114085 --> -0.134085).  Saving model ...
Epoch: 11 cost time: 1.1203811168670654
Epoch: 11, Steps: 10 | Train Loss: 2.142 Vali Loss: 3.195 Vali Acc: 0.149 Test Loss: 3.195 Test Acc: 0.149
Validation loss decreased (-0.134085 --> -0.149380).  Saving model ...
Epoch: 12 cost time: 0.9499521255493164
Epoch: 12, Steps: 10 | Train Loss: 1.970 Vali Loss: 3.227 Vali Acc: 0.148 Test Loss: 3.227 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.292924404144287
Epoch: 13, Steps: 10 | Train Loss: 1.802 Vali Loss: 3.248 Vali Acc: 0.176 Test Loss: 3.248 Test Acc: 0.176
Validation loss decreased (-0.149380 --> -0.176438).  Saving model ...
Epoch: 14 cost time: 1.1212983131408691
Epoch: 14, Steps: 10 | Train Loss: 1.619 Vali Loss: 3.255 Vali Acc: 0.171 Test Loss: 3.255 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0262579917907715
Epoch: 15, Steps: 10 | Train Loss: 1.466 Vali Loss: 3.260 Vali Acc: 0.192 Test Loss: 3.260 Test Acc: 0.192
Validation loss decreased (-0.176438 --> -0.191732).  Saving model ...
Epoch: 16 cost time: 1.0931954383850098
Epoch: 16, Steps: 10 | Train Loss: 1.307 Vali Loss: 3.278 Vali Acc: 0.187 Test Loss: 3.278 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8924965858459473
Epoch: 17, Steps: 10 | Train Loss: 1.161 Vali Loss: 3.341 Vali Acc: 0.205 Test Loss: 3.341 Test Acc: 0.205
Validation loss decreased (-0.191732 --> -0.204672).  Saving model ...
Epoch: 18 cost time: 0.879096508026123
Epoch: 18, Steps: 10 | Train Loss: 1.019 Vali Loss: 3.338 Vali Acc: 0.216 Test Loss: 3.338 Test Acc: 0.216
Validation loss decreased (-0.204672 --> -0.216437).  Saving model ...
Epoch: 19 cost time: 1.1393084526062012
Epoch: 19, Steps: 10 | Train Loss: 0.859 Vali Loss: 3.405 Vali Acc: 0.212 Test Loss: 3.405 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8871176242828369
Epoch: 20, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.429 Vali Acc: 0.225 Test Loss: 3.429 Test Acc: 0.225
Validation loss decreased (-0.216437 --> -0.224672).  Saving model ...
Epoch: 21 cost time: 0.9210453033447266
Epoch: 21, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.469 Vali Acc: 0.234 Test Loss: 3.469 Test Acc: 0.234
Validation loss decreased (-0.224672 --> -0.234083).  Saving model ...
Epoch: 22 cost time: 0.9048638343811035
Epoch: 22, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.532 Vali Acc: 0.238 Test Loss: 3.532 Test Acc: 0.238
Validation loss decreased (-0.234083 --> -0.237612).  Saving model ...
Epoch: 23 cost time: 1.1409313678741455
Epoch: 23, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.560 Vali Acc: 0.244 Test Loss: 3.560 Test Acc: 0.244
Validation loss decreased (-0.237612 --> -0.243494).  Saving model ...
Epoch: 24 cost time: 0.8872237205505371
Epoch: 24, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.642 Vali Acc: 0.235 Test Loss: 3.642 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8296289443969727
Epoch: 25, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.736 Vali Acc: 0.254 Test Loss: 3.736 Test Acc: 0.254
Validation loss decreased (-0.243494 --> -0.254080).  Saving model ...
Epoch: 26 cost time: 0.8539495468139648
Epoch: 26, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.780 Vali Acc: 0.252 Test Loss: 3.780 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.417973279953003
Epoch: 27, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.788 Vali Acc: 0.251 Test Loss: 3.788 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.970792293548584
Epoch: 28, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.854 Vali Acc: 0.259 Test Loss: 3.854 Test Acc: 0.259
Validation loss decreased (-0.254080 --> -0.258785).  Saving model ...
Epoch: 29 cost time: 1.0877649784088135
Epoch: 29, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.937 Vali Acc: 0.255 Test Loss: 3.937 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0551133155822754
Epoch: 30, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.940 Vali Acc: 0.260 Test Loss: 3.940 Test Acc: 0.260
Validation loss decreased (-0.258785 --> -0.259961).  Saving model ...
Epoch: 31 cost time: 1.0726861953735352
Epoch: 31, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.995 Vali Acc: 0.265 Test Loss: 3.995 Test Acc: 0.265
Validation loss decreased (-0.259961 --> -0.264666).  Saving model ...
Epoch: 32 cost time: 0.9761407375335693
Epoch: 32, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.001 Vali Acc: 0.271 Test Loss: 4.001 Test Acc: 0.271
Validation loss decreased (-0.264666 --> -0.270548).  Saving model ...
Epoch: 33 cost time: 0.9838700294494629
Epoch: 33, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.069 Vali Acc: 0.267 Test Loss: 4.069 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.170954942703247
Epoch: 34, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.087 Vali Acc: 0.267 Test Loss: 4.087 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3592243194580078
Epoch: 35, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.072 Vali Acc: 0.261 Test Loss: 4.072 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.10573410987854
Epoch: 36, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.131 Vali Acc: 0.258 Test Loss: 4.131 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1368308067321777
Epoch: 37, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.144 Vali Acc: 0.269 Test Loss: 4.144 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1891233921051025
Epoch: 38, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.174 Vali Acc: 0.273 Test Loss: 4.174 Test Acc: 0.273
Validation loss decreased (-0.270548 --> -0.272899).  Saving model ...
Epoch: 39 cost time: 0.9619934558868408
Epoch: 39, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.209 Vali Acc: 0.275 Test Loss: 4.209 Test Acc: 0.275
Validation loss decreased (-0.272899 --> -0.275252).  Saving model ...
Epoch: 40 cost time: 1.087888479232788
Epoch: 40, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.249 Vali Acc: 0.268 Test Loss: 4.249 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0433990955352783
Epoch: 41, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.277 Vali Acc: 0.272 Test Loss: 4.277 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.146338701248169
Epoch: 42, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.265 Vali Acc: 0.273 Test Loss: 4.265 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1636319160461426
Epoch: 43, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.303 Vali Acc: 0.275 Test Loss: 4.303 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2144017219543457
Epoch: 44, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.290 Vali Acc: 0.274 Test Loss: 4.290 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.1645476818084717
Epoch: 45, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.317 Vali Acc: 0.272 Test Loss: 4.317 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.1328744888305664
Epoch: 46, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.363 Vali Acc: 0.271 Test Loss: 4.363 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2813162803649902
Epoch: 47, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.369 Vali Acc: 0.269 Test Loss: 4.369 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9749114513397217
Epoch: 48, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.371 Vali Acc: 0.278 Test Loss: 4.371 Test Acc: 0.278
Validation loss decreased (-0.275252 --> -0.277603).  Saving model ...
Epoch: 49 cost time: 1.24104642868042
Epoch: 49, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.392 Vali Acc: 0.274 Test Loss: 4.392 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.237680435180664
Epoch: 50, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.404 Vali Acc: 0.278 Test Loss: 4.404 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.1649954319000244
Epoch: 51, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.392 Vali Acc: 0.280 Test Loss: 4.392 Test Acc: 0.280
Validation loss decreased (-0.277603 --> -0.279956).  Saving model ...
Epoch: 52 cost time: 1.357436180114746
Epoch: 52, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.417 Vali Acc: 0.279 Test Loss: 4.417 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0838868618011475
Epoch: 53, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.457 Vali Acc: 0.278 Test Loss: 4.457 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.3263659477233887
Epoch: 54, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.435 Vali Acc: 0.274 Test Loss: 4.435 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.0707857608795166
Epoch: 55, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.451 Vali Acc: 0.281 Test Loss: 4.451 Test Acc: 0.281
Validation loss decreased (-0.279956 --> -0.281132).  Saving model ...
Epoch: 56 cost time: 1.3015162944793701
Epoch: 56, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.515 Vali Acc: 0.264 Test Loss: 4.515 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.116208553314209
Epoch: 57, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.474 Vali Acc: 0.278 Test Loss: 4.474 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9996564388275146
Epoch: 58, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.496 Vali Acc: 0.274 Test Loss: 4.496 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.1923575401306152
Epoch: 59, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.498 Vali Acc: 0.278 Test Loss: 4.498 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.0248262882232666
Epoch: 60, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.507 Vali Acc: 0.281 Test Loss: 4.507 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.2167911529541016
Epoch: 61, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.532 Vali Acc: 0.282 Test Loss: 4.532 Test Acc: 0.282
Validation loss decreased (-0.281132 --> -0.282308).  Saving model ...
Epoch: 62 cost time: 0.8785326480865479
Epoch: 62, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.570 Vali Acc: 0.279 Test Loss: 4.570 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.3605282306671143
Epoch: 63, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.572 Vali Acc: 0.273 Test Loss: 4.572 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.0170292854309082
Epoch: 64, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.565 Vali Acc: 0.275 Test Loss: 4.565 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.1111433506011963
Epoch: 65, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.588 Vali Acc: 0.275 Test Loss: 4.588 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.1219432353973389
Epoch: 66, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.581 Vali Acc: 0.278 Test Loss: 4.581 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.1960253715515137
Epoch: 67, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.582 Vali Acc: 0.278 Test Loss: 4.582 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.1071701049804688
Epoch: 68, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.626 Vali Acc: 0.282 Test Loss: 4.626 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.9176974296569824
Epoch: 69, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.646 Vali Acc: 0.282 Test Loss: 4.646 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.9991095066070557
Epoch: 70, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.657 Vali Acc: 0.282 Test Loss: 4.657 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.1361579895019531
Epoch: 71, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.655 Vali Acc: 0.278 Test Loss: 4.655 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 669106
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4603774547576904
Epoch: 1, Steps: 10 | Train Loss: 3.458 Vali Loss: 3.349 Vali Acc: 0.041 Test Loss: 3.349 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.278930425643921
Epoch: 2, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.332 Vali Acc: 0.052 Test Loss: 3.332 Test Acc: 0.052
Validation loss decreased (-0.041143 --> -0.051731).  Saving model ...
Epoch: 3 cost time: 0.8808939456939697
Epoch: 3, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.381 Vali Acc: 0.055 Test Loss: 3.381 Test Acc: 0.055
Validation loss decreased (-0.051731 --> -0.055260).  Saving model ...
Epoch: 4 cost time: 1.794264554977417
Epoch: 4, Steps: 10 | Train Loss: 3.133 Vali Loss: 3.315 Vali Acc: 0.068 Test Loss: 3.315 Test Acc: 0.068
Validation loss decreased (-0.055260 --> -0.068202).  Saving model ...
Epoch: 5 cost time: 1.2110397815704346
Epoch: 5, Steps: 10 | Train Loss: 3.053 Vali Loss: 3.305 Vali Acc: 0.076 Test Loss: 3.305 Test Acc: 0.076
Validation loss decreased (-0.068202 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 1.0365290641784668
Epoch: 6, Steps: 10 | Train Loss: 2.975 Vali Loss: 3.285 Vali Acc: 0.084 Test Loss: 3.285 Test Acc: 0.084
Validation loss decreased (-0.076438 --> -0.083497).  Saving model ...
Epoch: 7 cost time: 1.0772628784179688
Epoch: 7, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.266 Vali Acc: 0.093 Test Loss: 3.266 Test Acc: 0.093
Validation loss decreased (-0.083497 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 1.2412385940551758
Epoch: 8, Steps: 10 | Train Loss: 2.688 Vali Loss: 3.262 Vali Acc: 0.119 Test Loss: 3.262 Test Acc: 0.119
Validation loss decreased (-0.092909 --> -0.118791).  Saving model ...
Epoch: 9 cost time: 1.2221829891204834
Epoch: 9, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.246 Vali Acc: 0.112 Test Loss: 3.246 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2605350017547607
Epoch: 10, Steps: 10 | Train Loss: 2.394 Vali Loss: 3.241 Vali Acc: 0.113 Test Loss: 3.241 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0766546726226807
Epoch: 11, Steps: 10 | Train Loss: 2.284 Vali Loss: 3.219 Vali Acc: 0.142 Test Loss: 3.219 Test Acc: 0.142
Validation loss decreased (-0.118791 --> -0.142321).  Saving model ...
Epoch: 12 cost time: 1.2599585056304932
Epoch: 12, Steps: 10 | Train Loss: 2.147 Vali Loss: 3.228 Vali Acc: 0.139 Test Loss: 3.228 Test Acc: 0.139
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3263070583343506
Epoch: 13, Steps: 10 | Train Loss: 1.928 Vali Loss: 3.235 Vali Acc: 0.155 Test Loss: 3.235 Test Acc: 0.155
Validation loss decreased (-0.142321 --> -0.155262).  Saving model ...
Epoch: 14 cost time: 0.8177192211151123
Epoch: 14, Steps: 10 | Train Loss: 1.801 Vali Loss: 3.252 Vali Acc: 0.164 Test Loss: 3.252 Test Acc: 0.164
Validation loss decreased (-0.155262 --> -0.163497).  Saving model ...
Epoch: 15 cost time: 1.009660005569458
Epoch: 15, Steps: 10 | Train Loss: 1.599 Vali Loss: 3.252 Vali Acc: 0.158 Test Loss: 3.252 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1221959590911865
Epoch: 16, Steps: 10 | Train Loss: 1.446 Vali Loss: 3.297 Vali Acc: 0.191 Test Loss: 3.297 Test Acc: 0.191
Validation loss decreased (-0.163497 --> -0.190555).  Saving model ...
Epoch: 17 cost time: 1.1100995540618896
Epoch: 17, Steps: 10 | Train Loss: 1.338 Vali Loss: 3.357 Vali Acc: 0.189 Test Loss: 3.357 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9366710186004639
Epoch: 18, Steps: 10 | Train Loss: 1.133 Vali Loss: 3.313 Vali Acc: 0.207 Test Loss: 3.313 Test Acc: 0.207
Validation loss decreased (-0.190555 --> -0.207026).  Saving model ...
Epoch: 19 cost time: 0.9069809913635254
Epoch: 19, Steps: 10 | Train Loss: 1.042 Vali Loss: 3.368 Vali Acc: 0.224 Test Loss: 3.368 Test Acc: 0.224
Validation loss decreased (-0.207026 --> -0.223496).  Saving model ...
Epoch: 20 cost time: 1.2535243034362793
Epoch: 20, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.431 Vali Acc: 0.232 Test Loss: 3.431 Test Acc: 0.232
Validation loss decreased (-0.223496 --> -0.231730).  Saving model ...
Epoch: 21 cost time: 0.9563734531402588
Epoch: 21, Steps: 10 | Train Loss: 0.848 Vali Loss: 3.417 Vali Acc: 0.221 Test Loss: 3.417 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8792662620544434
Epoch: 22, Steps: 10 | Train Loss: 0.664 Vali Loss: 3.524 Vali Acc: 0.242 Test Loss: 3.524 Test Acc: 0.242
Validation loss decreased (-0.231730 --> -0.242318).  Saving model ...
Epoch: 23 cost time: 0.9537944793701172
Epoch: 23, Steps: 10 | Train Loss: 0.593 Vali Loss: 3.497 Vali Acc: 0.248 Test Loss: 3.497 Test Acc: 0.248
Validation loss decreased (-0.242318 --> -0.248200).  Saving model ...
Epoch: 24 cost time: 1.1873316764831543
Epoch: 24, Steps: 10 | Train Loss: 0.473 Vali Loss: 3.589 Vali Acc: 0.246 Test Loss: 3.589 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2759315967559814
Epoch: 25, Steps: 10 | Train Loss: 0.369 Vali Loss: 3.647 Vali Acc: 0.253 Test Loss: 3.647 Test Acc: 0.253
Validation loss decreased (-0.248200 --> -0.252905).  Saving model ...
Epoch: 26 cost time: 1.0507402420043945
Epoch: 26, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.674 Vali Acc: 0.256 Test Loss: 3.674 Test Acc: 0.256
Validation loss decreased (-0.252905 --> -0.256434).  Saving model ...
Epoch: 27 cost time: 1.0824215412139893
Epoch: 27, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.730 Vali Acc: 0.238 Test Loss: 3.730 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0774872303009033
Epoch: 28, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.773 Vali Acc: 0.260 Test Loss: 3.773 Test Acc: 0.260
Validation loss decreased (-0.256434 --> -0.259962).  Saving model ...
Epoch: 29 cost time: 1.1156303882598877
Epoch: 29, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.927 Vali Acc: 0.241 Test Loss: 3.927 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0829942226409912
Epoch: 30, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.885 Vali Acc: 0.248 Test Loss: 3.885 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9537055492401123
Epoch: 31, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.896 Vali Acc: 0.266 Test Loss: 3.896 Test Acc: 0.266
Validation loss decreased (-0.259962 --> -0.265843).  Saving model ...
Epoch: 32 cost time: 1.2382986545562744
Epoch: 32, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.040 Vali Acc: 0.258 Test Loss: 4.040 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0184745788574219
Epoch: 33, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.998 Vali Acc: 0.266 Test Loss: 3.998 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8009903430938721
Epoch: 34, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.001 Vali Acc: 0.255 Test Loss: 4.001 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0398433208465576
Epoch: 35, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.068 Vali Acc: 0.259 Test Loss: 4.068 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1976943016052246
Epoch: 36, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.083 Vali Acc: 0.268 Test Loss: 4.083 Test Acc: 0.268
Validation loss decreased (-0.265843 --> -0.268194).  Saving model ...
Epoch: 37 cost time: 1.2849688529968262
Epoch: 37, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.210 Vali Acc: 0.262 Test Loss: 4.210 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9539458751678467
Epoch: 38, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.146 Vali Acc: 0.271 Test Loss: 4.146 Test Acc: 0.271
Validation loss decreased (-0.268194 --> -0.270547).  Saving model ...
Epoch: 39 cost time: 0.9506411552429199
Epoch: 39, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.128 Vali Acc: 0.273 Test Loss: 4.128 Test Acc: 0.273
Validation loss decreased (-0.270547 --> -0.272900).  Saving model ...
Epoch: 40 cost time: 0.9523177146911621
Epoch: 40, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.179 Vali Acc: 0.267 Test Loss: 4.179 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3446159362792969
Epoch: 41, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.188 Vali Acc: 0.266 Test Loss: 4.188 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.030346155166626
Epoch: 42, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.214 Vali Acc: 0.269 Test Loss: 4.214 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.989447832107544
Epoch: 43, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.251 Vali Acc: 0.268 Test Loss: 4.251 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2108800411224365
Epoch: 44, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.255 Vali Acc: 0.264 Test Loss: 4.255 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.1455659866333008
Epoch: 45, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.274 Vali Acc: 0.268 Test Loss: 4.274 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9275193214416504
Epoch: 46, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.268 Vali Acc: 0.271 Test Loss: 4.268 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.048933982849121
Epoch: 47, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.293 Vali Acc: 0.264 Test Loss: 4.293 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9381473064422607
Epoch: 48, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.327 Vali Acc: 0.264 Test Loss: 4.327 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9940652847290039
Epoch: 49, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.344 Vali Acc: 0.261 Test Loss: 4.344 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 473458
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3965682983398438
Epoch: 1, Steps: 10 | Train Loss: 3.410 Vali Loss: 3.320 Vali Acc: 0.028 Test Loss: 3.320 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 0.9606571197509766
Epoch: 2, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.323 Vali Acc: 0.058 Test Loss: 3.323 Test Acc: 0.058
Validation loss decreased (-0.028202 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 1.1163926124572754
Epoch: 3, Steps: 10 | Train Loss: 3.184 Vali Loss: 3.375 Vali Acc: 0.065 Test Loss: 3.375 Test Acc: 0.065
Validation loss decreased (-0.057614 --> -0.064672).  Saving model ...
Epoch: 4 cost time: 1.0268566608428955
Epoch: 4, Steps: 10 | Train Loss: 3.053 Vali Loss: 3.339 Vali Acc: 0.069 Test Loss: 3.339 Test Acc: 0.069
Validation loss decreased (-0.064672 --> -0.069378).  Saving model ...
Epoch: 5 cost time: 1.0443027019500732
Epoch: 5, Steps: 10 | Train Loss: 3.028 Vali Loss: 3.294 Vali Acc: 0.054 Test Loss: 3.294 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0280089378356934
Epoch: 6, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.260 Vali Acc: 0.111 Test Loss: 3.260 Test Acc: 0.111
Validation loss decreased (-0.069378 --> -0.110556).  Saving model ...
Epoch: 7 cost time: 1.1106185913085938
Epoch: 7, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.241 Vali Acc: 0.105 Test Loss: 3.241 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1276805400848389
Epoch: 8, Steps: 10 | Train Loss: 2.686 Vali Loss: 3.241 Vali Acc: 0.132 Test Loss: 3.241 Test Acc: 0.132
Validation loss decreased (-0.110556 --> -0.131732).  Saving model ...
Epoch: 9 cost time: 1.071354866027832
Epoch: 9, Steps: 10 | Train Loss: 2.595 Vali Loss: 3.233 Vali Acc: 0.125 Test Loss: 3.233 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0336260795593262
Epoch: 10, Steps: 10 | Train Loss: 2.396 Vali Loss: 3.228 Vali Acc: 0.115 Test Loss: 3.228 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9390158653259277
Epoch: 11, Steps: 10 | Train Loss: 2.255 Vali Loss: 3.206 Vali Acc: 0.147 Test Loss: 3.206 Test Acc: 0.147
Validation loss decreased (-0.131732 --> -0.147027).  Saving model ...
Epoch: 12 cost time: 0.8835170269012451
Epoch: 12, Steps: 10 | Train Loss: 2.059 Vali Loss: 3.208 Vali Acc: 0.166 Test Loss: 3.208 Test Acc: 0.166
Validation loss decreased (-0.147027 --> -0.165850).  Saving model ...
Epoch: 13 cost time: 0.894399881362915
Epoch: 13, Steps: 10 | Train Loss: 1.937 Vali Loss: 3.229 Vali Acc: 0.167 Test Loss: 3.229 Test Acc: 0.167
Validation loss decreased (-0.165850 --> -0.167027).  Saving model ...
Epoch: 14 cost time: 0.9759724140167236
Epoch: 14, Steps: 10 | Train Loss: 1.709 Vali Loss: 3.280 Vali Acc: 0.169 Test Loss: 3.280 Test Acc: 0.169
Validation loss decreased (-0.167027 --> -0.169379).  Saving model ...
Epoch: 15 cost time: 0.9670383930206299
Epoch: 15, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.260 Vali Acc: 0.186 Test Loss: 3.260 Test Acc: 0.186
Validation loss decreased (-0.169379 --> -0.185850).  Saving model ...
Epoch: 16 cost time: 1.0046861171722412
Epoch: 16, Steps: 10 | Train Loss: 1.412 Vali Loss: 3.297 Vali Acc: 0.185 Test Loss: 3.297 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8779101371765137
Epoch: 17, Steps: 10 | Train Loss: 1.256 Vali Loss: 3.319 Vali Acc: 0.216 Test Loss: 3.319 Test Acc: 0.216
Validation loss decreased (-0.185850 --> -0.216437).  Saving model ...
Epoch: 18 cost time: 1.095268964767456
Epoch: 18, Steps: 10 | Train Loss: 1.142 Vali Loss: 3.363 Vali Acc: 0.193 Test Loss: 3.363 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1241106986999512
Epoch: 19, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.412 Vali Acc: 0.199 Test Loss: 3.412 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9158189296722412
Epoch: 20, Steps: 10 | Train Loss: 0.871 Vali Loss: 3.481 Vali Acc: 0.214 Test Loss: 3.481 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8516662120819092
Epoch: 21, Steps: 10 | Train Loss: 0.741 Vali Loss: 3.432 Vali Acc: 0.233 Test Loss: 3.432 Test Acc: 0.233
Validation loss decreased (-0.216437 --> -0.232907).  Saving model ...
Epoch: 22 cost time: 0.9165182113647461
Epoch: 22, Steps: 10 | Train Loss: 0.682 Vali Loss: 3.541 Vali Acc: 0.226 Test Loss: 3.541 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9386868476867676
Epoch: 23, Steps: 10 | Train Loss: 0.561 Vali Loss: 3.583 Vali Acc: 0.233 Test Loss: 3.583 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9985537528991699
Epoch: 24, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.656 Vali Acc: 0.234 Test Loss: 3.656 Test Acc: 0.234
Validation loss decreased (-0.232907 --> -0.234081).  Saving model ...
Epoch: 25 cost time: 1.1504032611846924
Epoch: 25, Steps: 10 | Train Loss: 0.409 Vali Loss: 3.702 Vali Acc: 0.244 Test Loss: 3.702 Test Acc: 0.244
Validation loss decreased (-0.234081 --> -0.243492).  Saving model ...
Epoch: 26 cost time: 0.8906536102294922
Epoch: 26, Steps: 10 | Train Loss: 0.331 Vali Loss: 3.754 Vali Acc: 0.241 Test Loss: 3.754 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0689198970794678
Epoch: 27, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.793 Vali Acc: 0.246 Test Loss: 3.793 Test Acc: 0.246
Validation loss decreased (-0.243492 --> -0.245844).  Saving model ...
Epoch: 28 cost time: 0.9308831691741943
Epoch: 28, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.879 Vali Acc: 0.238 Test Loss: 3.879 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9130961894989014
Epoch: 29, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.900 Vali Acc: 0.239 Test Loss: 3.900 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9621288776397705
Epoch: 30, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.984 Vali Acc: 0.244 Test Loss: 3.984 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1248700618743896
Epoch: 31, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.077 Vali Acc: 0.246 Test Loss: 4.077 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1399316787719727
Epoch: 32, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.046 Vali Acc: 0.244 Test Loss: 4.046 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4173848628997803
Epoch: 33, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.119 Vali Acc: 0.244 Test Loss: 4.119 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9873044490814209
Epoch: 34, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.130 Vali Acc: 0.248 Test Loss: 4.130 Test Acc: 0.248
Validation loss decreased (-0.245844 --> -0.248194).  Saving model ...
Epoch: 35 cost time: 1.1874215602874756
Epoch: 35, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.175 Vali Acc: 0.245 Test Loss: 4.175 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1201307773590088
Epoch: 36, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.195 Vali Acc: 0.249 Test Loss: 4.195 Test Acc: 0.249
Validation loss decreased (-0.248194 --> -0.249370).  Saving model ...
Epoch: 37 cost time: 0.9429492950439453
Epoch: 37, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.172 Vali Acc: 0.255 Test Loss: 4.172 Test Acc: 0.255
Validation loss decreased (-0.249370 --> -0.255252).  Saving model ...
Epoch: 38 cost time: 0.9469914436340332
Epoch: 38, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.247 Vali Acc: 0.247 Test Loss: 4.247 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0412721633911133
Epoch: 39, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.291 Vali Acc: 0.245 Test Loss: 4.291 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1347894668579102
Epoch: 40, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.314 Vali Acc: 0.249 Test Loss: 4.314 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1385295391082764
Epoch: 41, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.363 Vali Acc: 0.248 Test Loss: 4.363 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.090416431427002
Epoch: 42, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.366 Vali Acc: 0.247 Test Loss: 4.366 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1227939128875732
Epoch: 43, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.368 Vali Acc: 0.249 Test Loss: 4.368 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3091232776641846
Epoch: 44, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.397 Vali Acc: 0.248 Test Loss: 4.397 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1015760898590088
Epoch: 45, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.395 Vali Acc: 0.253 Test Loss: 4.395 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.245680570602417
Epoch: 46, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.413 Vali Acc: 0.249 Test Loss: 4.413 Test Acc: 0.249
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9132635593414307
Epoch: 47, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.444 Vali Acc: 0.248 Test Loss: 4.444 Test Acc: 0.248
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 472626
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1094963550567627
Epoch: 1, Steps: 10 | Train Loss: 3.477 Vali Loss: 3.369 Vali Acc: 0.024 Test Loss: 3.369 Test Acc: 0.024
Validation loss decreased (inf --> -0.023496).  Saving model ...
Epoch: 2 cost time: 1.4186034202575684
Epoch: 2, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.334 Vali Acc: 0.039 Test Loss: 3.334 Test Acc: 0.039
Validation loss decreased (-0.023496 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 1.3991150856018066
Epoch: 3, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.366 Vali Acc: 0.058 Test Loss: 3.366 Test Acc: 0.058
Validation loss decreased (-0.038790 --> -0.057613).  Saving model ...
Epoch: 4 cost time: 1.1595282554626465
Epoch: 4, Steps: 10 | Train Loss: 3.115 Vali Loss: 3.355 Vali Acc: 0.047 Test Loss: 3.355 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3321163654327393
Epoch: 5, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.310 Vali Acc: 0.062 Test Loss: 3.310 Test Acc: 0.062
Validation loss decreased (-0.057613 --> -0.062320).  Saving model ...
Epoch: 6 cost time: 1.0772783756256104
Epoch: 6, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.295 Vali Acc: 0.093 Test Loss: 3.295 Test Acc: 0.093
Validation loss decreased (-0.062320 --> -0.092908).  Saving model ...
Epoch: 7 cost time: 1.18068265914917
Epoch: 7, Steps: 10 | Train Loss: 2.807 Vali Loss: 3.295 Vali Acc: 0.106 Test Loss: 3.295 Test Acc: 0.106
Validation loss decreased (-0.092908 --> -0.105849).  Saving model ...
Epoch: 8 cost time: 1.1801838874816895
Epoch: 8, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.260 Vali Acc: 0.120 Test Loss: 3.260 Test Acc: 0.120
Validation loss decreased (-0.105849 --> -0.119967).  Saving model ...
Epoch: 9 cost time: 1.3279478549957275
Epoch: 9, Steps: 10 | Train Loss: 2.478 Vali Loss: 3.236 Vali Acc: 0.118 Test Loss: 3.236 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0861029624938965
Epoch: 10, Steps: 10 | Train Loss: 2.366 Vali Loss: 3.259 Vali Acc: 0.129 Test Loss: 3.259 Test Acc: 0.129
Validation loss decreased (-0.119967 --> -0.129379).  Saving model ...
Epoch: 11 cost time: 1.1778604984283447
Epoch: 11, Steps: 10 | Train Loss: 2.234 Vali Loss: 3.255 Vali Acc: 0.145 Test Loss: 3.255 Test Acc: 0.145
Validation loss decreased (-0.129379 --> -0.144673).  Saving model ...
Epoch: 12 cost time: 1.4754478931427002
Epoch: 12, Steps: 10 | Train Loss: 2.045 Vali Loss: 3.201 Vali Acc: 0.146 Test Loss: 3.201 Test Acc: 0.146
Validation loss decreased (-0.144673 --> -0.145850).  Saving model ...
Epoch: 13 cost time: 1.4552841186523438
Epoch: 13, Steps: 10 | Train Loss: 1.925 Vali Loss: 3.251 Vali Acc: 0.145 Test Loss: 3.251 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.970120906829834
Epoch: 14, Steps: 10 | Train Loss: 1.702 Vali Loss: 3.275 Vali Acc: 0.171 Test Loss: 3.275 Test Acc: 0.171
Validation loss decreased (-0.145850 --> -0.170555).  Saving model ...
Epoch: 15 cost time: 1.1403453350067139
Epoch: 15, Steps: 10 | Train Loss: 1.578 Vali Loss: 3.283 Vali Acc: 0.174 Test Loss: 3.283 Test Acc: 0.174
Validation loss decreased (-0.170555 --> -0.174085).  Saving model ...
Epoch: 16 cost time: 1.2036938667297363
Epoch: 16, Steps: 10 | Train Loss: 1.387 Vali Loss: 3.312 Vali Acc: 0.189 Test Loss: 3.312 Test Acc: 0.189
Validation loss decreased (-0.174085 --> -0.189379).  Saving model ...
Epoch: 17 cost time: 1.3027026653289795
Epoch: 17, Steps: 10 | Train Loss: 1.282 Vali Loss: 3.356 Vali Acc: 0.189 Test Loss: 3.356 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0649492740631104
Epoch: 18, Steps: 10 | Train Loss: 1.143 Vali Loss: 3.390 Vali Acc: 0.201 Test Loss: 3.390 Test Acc: 0.201
Validation loss decreased (-0.189379 --> -0.201143).  Saving model ...
Epoch: 19 cost time: 1.1669256687164307
Epoch: 19, Steps: 10 | Train Loss: 1.059 Vali Loss: 3.388 Vali Acc: 0.219 Test Loss: 3.388 Test Acc: 0.219
Validation loss decreased (-0.201143 --> -0.218790).  Saving model ...
Epoch: 20 cost time: 0.9418618679046631
Epoch: 20, Steps: 10 | Train Loss: 0.874 Vali Loss: 3.466 Vali Acc: 0.216 Test Loss: 3.466 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5853970050811768
Epoch: 21, Steps: 10 | Train Loss: 0.799 Vali Loss: 3.430 Vali Acc: 0.228 Test Loss: 3.430 Test Acc: 0.228
Validation loss decreased (-0.218790 --> -0.228201).  Saving model ...
Epoch: 22 cost time: 1.3298299312591553
Epoch: 22, Steps: 10 | Train Loss: 0.651 Vali Loss: 3.539 Vali Acc: 0.240 Test Loss: 3.539 Test Acc: 0.240
Validation loss decreased (-0.228201 --> -0.239965).  Saving model ...
Epoch: 23 cost time: 0.9387714862823486
Epoch: 23, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.533 Vali Acc: 0.241 Test Loss: 3.533 Test Acc: 0.241
Validation loss decreased (-0.239965 --> -0.241141).  Saving model ...
Epoch: 24 cost time: 1.1882877349853516
Epoch: 24, Steps: 10 | Train Loss: 0.446 Vali Loss: 3.620 Vali Acc: 0.248 Test Loss: 3.620 Test Acc: 0.248
Validation loss decreased (-0.241141 --> -0.248199).  Saving model ...
Epoch: 25 cost time: 1.1104857921600342
Epoch: 25, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.661 Vali Acc: 0.242 Test Loss: 3.661 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1237692832946777
Epoch: 26, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.729 Vali Acc: 0.253 Test Loss: 3.729 Test Acc: 0.253
Validation loss decreased (-0.248199 --> -0.252904).  Saving model ...
Epoch: 27 cost time: 1.2169826030731201
Epoch: 27, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.797 Vali Acc: 0.246 Test Loss: 3.797 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0803735256195068
Epoch: 28, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.879 Vali Acc: 0.233 Test Loss: 3.879 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1074273586273193
Epoch: 29, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.925 Vali Acc: 0.247 Test Loss: 3.925 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1125118732452393
Epoch: 30, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.950 Vali Acc: 0.266 Test Loss: 3.950 Test Acc: 0.266
Validation loss decreased (-0.252904 --> -0.265843).  Saving model ...
Epoch: 31 cost time: 0.9228448867797852
Epoch: 31, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.015 Vali Acc: 0.254 Test Loss: 4.015 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0517661571502686
Epoch: 32, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.033 Vali Acc: 0.251 Test Loss: 4.033 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0416569709777832
Epoch: 33, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.106 Vali Acc: 0.260 Test Loss: 4.106 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9792826175689697
Epoch: 34, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.104 Vali Acc: 0.248 Test Loss: 4.104 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.07537841796875
Epoch: 35, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.115 Vali Acc: 0.256 Test Loss: 4.115 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.194528341293335
Epoch: 36, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.190 Vali Acc: 0.249 Test Loss: 4.190 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.192162036895752
Epoch: 37, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.222 Vali Acc: 0.260 Test Loss: 4.222 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.196298360824585
Epoch: 38, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.232 Vali Acc: 0.258 Test Loss: 4.232 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.3221328258514404
Epoch: 39, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.258 Vali Acc: 0.253 Test Loss: 4.258 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.2198889255523682
Epoch: 40, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.277 Vali Acc: 0.256 Test Loss: 4.277 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 471794
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.045590400695801
Epoch: 1, Steps: 10 | Train Loss: 3.482 Vali Loss: 3.378 Vali Acc: 0.035 Test Loss: 3.378 Test Acc: 0.035
Validation loss decreased (inf --> -0.035260).  Saving model ...
Epoch: 2 cost time: 1.0589277744293213
Epoch: 2, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.331 Vali Acc: 0.060 Test Loss: 3.331 Test Acc: 0.060
Validation loss decreased (-0.035260 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 1.0222828388214111
Epoch: 3, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.385 Vali Acc: 0.051 Test Loss: 3.385 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0630464553833008
Epoch: 4, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.367 Vali Acc: 0.047 Test Loss: 3.367 Test Acc: 0.047
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2974011898040771
Epoch: 5, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.317 Vali Acc: 0.067 Test Loss: 3.317 Test Acc: 0.067
Validation loss decreased (-0.059967 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 1.1485600471496582
Epoch: 6, Steps: 10 | Train Loss: 2.915 Vali Loss: 3.298 Vali Acc: 0.075 Test Loss: 3.298 Test Acc: 0.075
Validation loss decreased (-0.067026 --> -0.075261).  Saving model ...
Epoch: 7 cost time: 0.921410083770752
Epoch: 7, Steps: 10 | Train Loss: 2.823 Vali Loss: 3.292 Vali Acc: 0.086 Test Loss: 3.292 Test Acc: 0.086
Validation loss decreased (-0.075261 --> -0.085849).  Saving model ...
Epoch: 8 cost time: 1.0658199787139893
Epoch: 8, Steps: 10 | Train Loss: 2.700 Vali Loss: 3.274 Vali Acc: 0.108 Test Loss: 3.274 Test Acc: 0.108
Validation loss decreased (-0.085849 --> -0.108203).  Saving model ...
Epoch: 9 cost time: 0.9821577072143555
Epoch: 9, Steps: 10 | Train Loss: 2.579 Vali Loss: 3.277 Vali Acc: 0.105 Test Loss: 3.277 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1482672691345215
Epoch: 10, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.256 Vali Acc: 0.120 Test Loss: 3.256 Test Acc: 0.120
Validation loss decreased (-0.108203 --> -0.119967).  Saving model ...
Epoch: 11 cost time: 1.1456034183502197
Epoch: 11, Steps: 10 | Train Loss: 2.249 Vali Loss: 3.262 Vali Acc: 0.138 Test Loss: 3.262 Test Acc: 0.138
Validation loss decreased (-0.119967 --> -0.137614).  Saving model ...
Epoch: 12 cost time: 0.9970324039459229
Epoch: 12, Steps: 10 | Train Loss: 2.089 Vali Loss: 3.249 Vali Acc: 0.151 Test Loss: 3.249 Test Acc: 0.151
Validation loss decreased (-0.137614 --> -0.150556).  Saving model ...
Epoch: 13 cost time: 1.019970178604126
Epoch: 13, Steps: 10 | Train Loss: 1.939 Vali Loss: 3.259 Vali Acc: 0.149 Test Loss: 3.259 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.251023292541504
Epoch: 14, Steps: 10 | Train Loss: 1.753 Vali Loss: 3.300 Vali Acc: 0.155 Test Loss: 3.300 Test Acc: 0.155
Validation loss decreased (-0.150556 --> -0.155261).  Saving model ...
Epoch: 15 cost time: 0.9587349891662598
Epoch: 15, Steps: 10 | Train Loss: 1.598 Vali Loss: 3.347 Vali Acc: 0.162 Test Loss: 3.347 Test Acc: 0.162
Validation loss decreased (-0.155261 --> -0.162319).  Saving model ...
Epoch: 16 cost time: 1.1505837440490723
Epoch: 16, Steps: 10 | Train Loss: 1.391 Vali Loss: 3.310 Vali Acc: 0.191 Test Loss: 3.310 Test Acc: 0.191
Validation loss decreased (-0.162319 --> -0.190555).  Saving model ...
Epoch: 17 cost time: 1.087636947631836
Epoch: 17, Steps: 10 | Train Loss: 1.265 Vali Loss: 3.373 Vali Acc: 0.187 Test Loss: 3.373 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0761964321136475
Epoch: 18, Steps: 10 | Train Loss: 1.130 Vali Loss: 3.405 Vali Acc: 0.201 Test Loss: 3.405 Test Acc: 0.201
Validation loss decreased (-0.190555 --> -0.201142).  Saving model ...
Epoch: 19 cost time: 1.1056652069091797
Epoch: 19, Steps: 10 | Train Loss: 1.036 Vali Loss: 3.460 Vali Acc: 0.204 Test Loss: 3.460 Test Acc: 0.204
Validation loss decreased (-0.201142 --> -0.203495).  Saving model ...
Epoch: 20 cost time: 1.0429778099060059
Epoch: 20, Steps: 10 | Train Loss: 0.883 Vali Loss: 3.501 Vali Acc: 0.212 Test Loss: 3.501 Test Acc: 0.212
Validation loss decreased (-0.203495 --> -0.211730).  Saving model ...
Epoch: 21 cost time: 1.0527207851409912
Epoch: 21, Steps: 10 | Train Loss: 0.799 Vali Loss: 3.559 Vali Acc: 0.199 Test Loss: 3.559 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.06693434715271
Epoch: 22, Steps: 10 | Train Loss: 0.750 Vali Loss: 3.600 Vali Acc: 0.224 Test Loss: 3.600 Test Acc: 0.224
Validation loss decreased (-0.211730 --> -0.223493).  Saving model ...
Epoch: 23 cost time: 1.0729577541351318
Epoch: 23, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.613 Vali Acc: 0.225 Test Loss: 3.613 Test Acc: 0.225
Validation loss decreased (-0.223493 --> -0.224670).  Saving model ...
Epoch: 24 cost time: 0.9078197479248047
Epoch: 24, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.701 Vali Acc: 0.225 Test Loss: 3.701 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1525676250457764
Epoch: 25, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.674 Vali Acc: 0.236 Test Loss: 3.674 Test Acc: 0.236
Validation loss decreased (-0.224670 --> -0.236434).  Saving model ...
Epoch: 26 cost time: 0.8952696323394775
Epoch: 26, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.802 Vali Acc: 0.233 Test Loss: 3.802 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.02964448928833
Epoch: 27, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.845 Vali Acc: 0.233 Test Loss: 3.845 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3777143955230713
Epoch: 28, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.903 Vali Acc: 0.227 Test Loss: 3.903 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2001049518585205
Epoch: 29, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.970 Vali Acc: 0.246 Test Loss: 3.970 Test Acc: 0.246
Validation loss decreased (-0.236434 --> -0.245843).  Saving model ...
Epoch: 30 cost time: 1.0317301750183105
Epoch: 30, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.938 Vali Acc: 0.248 Test Loss: 3.938 Test Acc: 0.248
Validation loss decreased (-0.245843 --> -0.248196).  Saving model ...
Epoch: 31 cost time: 0.9939491748809814
Epoch: 31, Steps: 10 | Train Loss: 0.120 Vali Loss: 4.061 Vali Acc: 0.248 Test Loss: 4.061 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9211630821228027
Epoch: 32, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.042 Vali Acc: 0.258 Test Loss: 4.042 Test Acc: 0.258
Validation loss decreased (-0.248196 --> -0.257607).  Saving model ...
Epoch: 33 cost time: 0.8811111450195312
Epoch: 33, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.126 Vali Acc: 0.246 Test Loss: 4.126 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0495822429656982
Epoch: 34, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.206 Vali Acc: 0.246 Test Loss: 4.206 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1649401187896729
Epoch: 35, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.166 Vali Acc: 0.261 Test Loss: 4.166 Test Acc: 0.261
Validation loss decreased (-0.257607 --> -0.261135).  Saving model ...
Epoch: 36 cost time: 1.1947946548461914
Epoch: 36, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.232 Vali Acc: 0.255 Test Loss: 4.232 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.992506742477417
Epoch: 37, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.248 Vali Acc: 0.246 Test Loss: 4.248 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9720678329467773
Epoch: 38, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.257 Vali Acc: 0.260 Test Loss: 4.257 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2617883682250977
Epoch: 39, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.316 Vali Acc: 0.258 Test Loss: 4.316 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0467629432678223
Epoch: 40, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.329 Vali Acc: 0.264 Test Loss: 4.329 Test Acc: 0.264
Validation loss decreased (-0.261135 --> -0.263486).  Saving model ...
Epoch: 41 cost time: 1.2634375095367432
Epoch: 41, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.331 Vali Acc: 0.259 Test Loss: 4.331 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2184312343597412
Epoch: 42, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.371 Vali Acc: 0.256 Test Loss: 4.371 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.4413793087005615
Epoch: 43, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.417 Vali Acc: 0.258 Test Loss: 4.417 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0101094245910645
Epoch: 44, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.437 Vali Acc: 0.256 Test Loss: 4.437 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0472033023834229
Epoch: 45, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.445 Vali Acc: 0.255 Test Loss: 4.445 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8056333065032959
Epoch: 46, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.491 Vali Acc: 0.262 Test Loss: 4.491 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.952751874923706
Epoch: 47, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.452 Vali Acc: 0.264 Test Loss: 4.452 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.3932294845581055
Epoch: 48, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.461 Vali Acc: 0.265 Test Loss: 4.461 Test Acc: 0.265
Validation loss decreased (-0.263486 --> -0.264661).  Saving model ...
Epoch: 49 cost time: 1.0555996894836426
Epoch: 49, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.488 Vali Acc: 0.259 Test Loss: 4.488 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0489091873168945
Epoch: 50, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.480 Vali Acc: 0.264 Test Loss: 4.480 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.365898609161377
Epoch: 51, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.507 Vali Acc: 0.268 Test Loss: 4.507 Test Acc: 0.268
Validation loss decreased (-0.264661 --> -0.268190).  Saving model ...
Epoch: 52 cost time: 0.8988234996795654
Epoch: 52, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.517 Vali Acc: 0.267 Test Loss: 4.517 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0637552738189697
Epoch: 53, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.548 Vali Acc: 0.266 Test Loss: 4.548 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.0539946556091309
Epoch: 54, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.581 Vali Acc: 0.269 Test Loss: 4.581 Test Acc: 0.269
Validation loss decreased (-0.268190 --> -0.269366).  Saving model ...
Epoch: 55 cost time: 1.0055575370788574
Epoch: 55, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.564 Vali Acc: 0.268 Test Loss: 4.564 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0027086734771729
Epoch: 56, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.588 Vali Acc: 0.272 Test Loss: 4.588 Test Acc: 0.272
Validation loss decreased (-0.269366 --> -0.271719).  Saving model ...
Epoch: 57 cost time: 1.0012569427490234
Epoch: 57, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.598 Vali Acc: 0.271 Test Loss: 4.598 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.886455774307251
Epoch: 58, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.610 Vali Acc: 0.264 Test Loss: 4.610 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0209364891052246
Epoch: 59, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.637 Vali Acc: 0.268 Test Loss: 4.637 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.0479698181152344
Epoch: 60, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.656 Vali Acc: 0.265 Test Loss: 4.656 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.9119422435760498
Epoch: 61, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.652 Vali Acc: 0.268 Test Loss: 4.652 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9963767528533936
Epoch: 62, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.663 Vali Acc: 0.266 Test Loss: 4.663 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.0544145107269287
Epoch: 63, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.685 Vali Acc: 0.268 Test Loss: 4.685 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.1375174522399902
Epoch: 64, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.687 Vali Acc: 0.268 Test Loss: 4.687 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.1170461177825928
Epoch: 65, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.708 Vali Acc: 0.267 Test Loss: 4.708 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.087419033050537
Epoch: 66, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.708 Vali Acc: 0.267 Test Loss: 4.708 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 470962
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7428746223449707
Epoch: 1, Steps: 10 | Train Loss: 3.407 Vali Loss: 3.366 Vali Acc: 0.046 Test Loss: 3.366 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 1.0361416339874268
Epoch: 2, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.314 Vali Acc: 0.035 Test Loss: 3.314 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9634020328521729
Epoch: 3, Steps: 10 | Train Loss: 3.154 Vali Loss: 3.334 Vali Acc: 0.042 Test Loss: 3.334 Test Acc: 0.042
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8782930374145508
Epoch: 4, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.325 Vali Acc: 0.065 Test Loss: 3.325 Test Acc: 0.065
Validation loss decreased (-0.045849 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 1.128458023071289
Epoch: 5, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.293 Vali Acc: 0.085 Test Loss: 3.293 Test Acc: 0.085
Validation loss decreased (-0.064673 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 1.1330807209014893
Epoch: 6, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.276 Vali Acc: 0.085 Test Loss: 3.276 Test Acc: 0.085
Validation loss decreased (-0.084673 --> -0.084673).  Saving model ...
Epoch: 7 cost time: 0.9153356552124023
Epoch: 7, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.270 Vali Acc: 0.094 Test Loss: 3.270 Test Acc: 0.094
Validation loss decreased (-0.084673 --> -0.094085).  Saving model ...
Epoch: 8 cost time: 1.0072240829467773
Epoch: 8, Steps: 10 | Train Loss: 2.647 Vali Loss: 3.243 Vali Acc: 0.114 Test Loss: 3.243 Test Acc: 0.114
Validation loss decreased (-0.094085 --> -0.114085).  Saving model ...
Epoch: 9 cost time: 0.8428840637207031
Epoch: 9, Steps: 10 | Train Loss: 2.493 Vali Loss: 3.218 Vali Acc: 0.128 Test Loss: 3.218 Test Acc: 0.128
Validation loss decreased (-0.114085 --> -0.128203).  Saving model ...
Epoch: 10 cost time: 1.0052177906036377
Epoch: 10, Steps: 10 | Train Loss: 2.397 Vali Loss: 3.217 Vali Acc: 0.136 Test Loss: 3.217 Test Acc: 0.136
Validation loss decreased (-0.128203 --> -0.136438).  Saving model ...
Epoch: 11 cost time: 0.8929829597473145
Epoch: 11, Steps: 10 | Train Loss: 2.284 Vali Loss: 3.229 Vali Acc: 0.134 Test Loss: 3.229 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9241046905517578
Epoch: 12, Steps: 10 | Train Loss: 2.104 Vali Loss: 3.267 Vali Acc: 0.145 Test Loss: 3.267 Test Acc: 0.145
Validation loss decreased (-0.136438 --> -0.144673).  Saving model ...
Epoch: 13 cost time: 0.8304386138916016
Epoch: 13, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.223 Vali Acc: 0.179 Test Loss: 3.223 Test Acc: 0.179
Validation loss decreased (-0.144673 --> -0.178791).  Saving model ...
Epoch: 14 cost time: 1.0236518383026123
Epoch: 14, Steps: 10 | Train Loss: 1.780 Vali Loss: 3.275 Vali Acc: 0.151 Test Loss: 3.275 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9223263263702393
Epoch: 15, Steps: 10 | Train Loss: 1.645 Vali Loss: 3.277 Vali Acc: 0.172 Test Loss: 3.277 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8927347660064697
Epoch: 16, Steps: 10 | Train Loss: 1.482 Vali Loss: 3.341 Vali Acc: 0.176 Test Loss: 3.341 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.980980396270752
Epoch: 17, Steps: 10 | Train Loss: 1.367 Vali Loss: 3.317 Vali Acc: 0.186 Test Loss: 3.317 Test Acc: 0.186
Validation loss decreased (-0.178791 --> -0.185849).  Saving model ...
Epoch: 18 cost time: 0.9337153434753418
Epoch: 18, Steps: 10 | Train Loss: 1.220 Vali Loss: 3.368 Vali Acc: 0.200 Test Loss: 3.368 Test Acc: 0.200
Validation loss decreased (-0.185849 --> -0.199966).  Saving model ...
Epoch: 19 cost time: 0.9996509552001953
Epoch: 19, Steps: 10 | Train Loss: 1.099 Vali Loss: 3.419 Vali Acc: 0.206 Test Loss: 3.419 Test Acc: 0.206
Validation loss decreased (-0.199966 --> -0.205848).  Saving model ...
Epoch: 20 cost time: 1.1775836944580078
Epoch: 20, Steps: 10 | Train Loss: 0.955 Vali Loss: 3.442 Vali Acc: 0.199 Test Loss: 3.442 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2027478218078613
Epoch: 21, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.479 Vali Acc: 0.233 Test Loss: 3.479 Test Acc: 0.233
Validation loss decreased (-0.205848 --> -0.232906).  Saving model ...
Epoch: 22 cost time: 0.9736158847808838
Epoch: 22, Steps: 10 | Train Loss: 0.703 Vali Loss: 3.519 Vali Acc: 0.225 Test Loss: 3.519 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0165846347808838
Epoch: 23, Steps: 10 | Train Loss: 0.665 Vali Loss: 3.581 Vali Acc: 0.246 Test Loss: 3.581 Test Acc: 0.246
Validation loss decreased (-0.232906 --> -0.245847).  Saving model ...
Epoch: 24 cost time: 0.9105713367462158
Epoch: 24, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.620 Vali Acc: 0.238 Test Loss: 3.620 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0833008289337158
Epoch: 25, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.674 Vali Acc: 0.253 Test Loss: 3.674 Test Acc: 0.253
Validation loss decreased (-0.245847 --> -0.252904).  Saving model ...
Epoch: 26 cost time: 1.4712090492248535
Epoch: 26, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.688 Vali Acc: 0.244 Test Loss: 3.688 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3164820671081543
Epoch: 27, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.818 Vali Acc: 0.239 Test Loss: 3.818 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1138050556182861
Epoch: 28, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.858 Vali Acc: 0.239 Test Loss: 3.858 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.156095266342163
Epoch: 29, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.893 Vali Acc: 0.248 Test Loss: 3.893 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0058743953704834
Epoch: 30, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.943 Vali Acc: 0.253 Test Loss: 3.943 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.305861473083496
Epoch: 31, Steps: 10 | Train Loss: 0.145 Vali Loss: 4.003 Vali Acc: 0.264 Test Loss: 4.003 Test Acc: 0.264
Validation loss decreased (-0.252904 --> -0.263489).  Saving model ...
Epoch: 32 cost time: 0.7751784324645996
Epoch: 32, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.093 Vali Acc: 0.249 Test Loss: 4.093 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0411200523376465
Epoch: 33, Steps: 10 | Train Loss: 0.102 Vali Loss: 4.075 Vali Acc: 0.266 Test Loss: 4.075 Test Acc: 0.266
Validation loss decreased (-0.263489 --> -0.265842).  Saving model ...
Epoch: 34 cost time: 0.9809577465057373
Epoch: 34, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.157 Vali Acc: 0.256 Test Loss: 4.157 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0652525424957275
Epoch: 35, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.197 Vali Acc: 0.254 Test Loss: 4.197 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.894655704498291
Epoch: 36, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.209 Vali Acc: 0.262 Test Loss: 4.209 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9176967144012451
Epoch: 37, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.270 Vali Acc: 0.261 Test Loss: 4.270 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9360010623931885
Epoch: 38, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.275 Vali Acc: 0.254 Test Loss: 4.275 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0862421989440918
Epoch: 39, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.272 Vali Acc: 0.261 Test Loss: 4.272 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.075986385345459
Epoch: 40, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.319 Vali Acc: 0.260 Test Loss: 4.319 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0114924907684326
Epoch: 41, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.310 Vali Acc: 0.259 Test Loss: 4.310 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2191047668457031
Epoch: 42, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.336 Vali Acc: 0.268 Test Loss: 4.336 Test Acc: 0.268
Validation loss decreased (-0.265842 --> -0.268192).  Saving model ...
Epoch: 43 cost time: 1.1084699630737305
Epoch: 43, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.369 Vali Acc: 0.266 Test Loss: 4.369 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0706982612609863
Epoch: 44, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.408 Vali Acc: 0.268 Test Loss: 4.408 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2287864685058594
Epoch: 45, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.428 Vali Acc: 0.268 Test Loss: 4.428 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1551976203918457
Epoch: 46, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.424 Vali Acc: 0.268 Test Loss: 4.424 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.22151517868042
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.437 Vali Acc: 0.268 Test Loss: 4.437 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1357014179229736
Epoch: 48, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.448 Vali Acc: 0.265 Test Loss: 4.448 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0866363048553467
Epoch: 49, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.482 Vali Acc: 0.269 Test Loss: 4.482 Test Acc: 0.269
Validation loss decreased (-0.268192 --> -0.269367).  Saving model ...
Epoch: 50 cost time: 0.9921119213104248
Epoch: 50, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.497 Vali Acc: 0.264 Test Loss: 4.497 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.276353359222412
Epoch: 51, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.529 Vali Acc: 0.267 Test Loss: 4.529 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.158637285232544
Epoch: 52, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.549 Vali Acc: 0.269 Test Loss: 4.549 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.3317358493804932
Epoch: 53, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.529 Vali Acc: 0.267 Test Loss: 4.529 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.0334086418151855
Epoch: 54, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.555 Vali Acc: 0.274 Test Loss: 4.555 Test Acc: 0.274
Validation loss decreased (-0.269367 --> -0.274072).  Saving model ...
Epoch: 55 cost time: 0.9502370357513428
Epoch: 55, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.579 Vali Acc: 0.272 Test Loss: 4.579 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0375919342041016
Epoch: 56, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.631 Vali Acc: 0.271 Test Loss: 4.631 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.176558494567871
Epoch: 57, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.630 Vali Acc: 0.268 Test Loss: 4.630 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.0444512367248535
Epoch: 58, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.639 Vali Acc: 0.276 Test Loss: 4.639 Test Acc: 0.276
Validation loss decreased (-0.274072 --> -0.276424).  Saving model ...
Epoch: 59 cost time: 0.9886364936828613
Epoch: 59, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.633 Vali Acc: 0.274 Test Loss: 4.633 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9904491901397705
Epoch: 60, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.648 Vali Acc: 0.276 Test Loss: 4.648 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1795704364776611
Epoch: 61, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.653 Vali Acc: 0.274 Test Loss: 4.653 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.1842103004455566
Epoch: 62, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.663 Vali Acc: 0.272 Test Loss: 4.663 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.2549984455108643
Epoch: 63, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.673 Vali Acc: 0.269 Test Loss: 4.673 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.2809257507324219
Epoch: 64, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.688 Vali Acc: 0.272 Test Loss: 4.688 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.3546524047851562
Epoch: 65, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.728 Vali Acc: 0.274 Test Loss: 4.728 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.362600564956665
Epoch: 66, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.730 Vali Acc: 0.271 Test Loss: 4.730 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.1787993907928467
Epoch: 67, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.729 Vali Acc: 0.271 Test Loss: 4.729 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.4984428882598877
Epoch: 68, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.748 Vali Acc: 0.271 Test Loss: 4.748 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 374386
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.692136764526367
Epoch: 1, Steps: 10 | Train Loss: 3.454 Vali Loss: 3.359 Vali Acc: 0.029 Test Loss: 3.359 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 1.0048902034759521
Epoch: 2, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.330 Vali Acc: 0.038 Test Loss: 3.330 Test Acc: 0.038
Validation loss decreased (-0.029378 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 1.3149986267089844
Epoch: 3, Steps: 10 | Train Loss: 3.175 Vali Loss: 3.380 Vali Acc: 0.056 Test Loss: 3.380 Test Acc: 0.056
Validation loss decreased (-0.037614 --> -0.056437).  Saving model ...
Epoch: 4 cost time: 0.9696884155273438
Epoch: 4, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.363 Vali Acc: 0.049 Test Loss: 3.363 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9852499961853027
Epoch: 5, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.314 Vali Acc: 0.056 Test Loss: 3.314 Test Acc: 0.056
Validation loss decreased (-0.056437 --> -0.056437).  Saving model ...
Epoch: 6 cost time: 1.1215510368347168
Epoch: 6, Steps: 10 | Train Loss: 2.918 Vali Loss: 3.296 Vali Acc: 0.078 Test Loss: 3.296 Test Acc: 0.078
Validation loss decreased (-0.056437 --> -0.077614).  Saving model ...
Epoch: 7 cost time: 0.9347143173217773
Epoch: 7, Steps: 10 | Train Loss: 2.813 Vali Loss: 3.256 Vali Acc: 0.074 Test Loss: 3.256 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.16874361038208
Epoch: 8, Steps: 10 | Train Loss: 2.689 Vali Loss: 3.271 Vali Acc: 0.101 Test Loss: 3.271 Test Acc: 0.101
Validation loss decreased (-0.077614 --> -0.101144).  Saving model ...
Epoch: 9 cost time: 1.0965204238891602
Epoch: 9, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.254 Vali Acc: 0.114 Test Loss: 3.254 Test Acc: 0.114
Validation loss decreased (-0.101144 --> -0.114085).  Saving model ...
Epoch: 10 cost time: 1.018768072128296
Epoch: 10, Steps: 10 | Train Loss: 2.394 Vali Loss: 3.252 Vali Acc: 0.104 Test Loss: 3.252 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.206695795059204
Epoch: 11, Steps: 10 | Train Loss: 2.255 Vali Loss: 3.262 Vali Acc: 0.128 Test Loss: 3.262 Test Acc: 0.128
Validation loss decreased (-0.114085 --> -0.128203).  Saving model ...
Epoch: 12 cost time: 1.3033227920532227
Epoch: 12, Steps: 10 | Train Loss: 2.194 Vali Loss: 3.248 Vali Acc: 0.134 Test Loss: 3.248 Test Acc: 0.134
Validation loss decreased (-0.128203 --> -0.134085).  Saving model ...
Epoch: 13 cost time: 1.3621292114257812
Epoch: 13, Steps: 10 | Train Loss: 1.941 Vali Loss: 3.239 Vali Acc: 0.149 Test Loss: 3.239 Test Acc: 0.149
Validation loss decreased (-0.134085 --> -0.149379).  Saving model ...
Epoch: 14 cost time: 1.0227854251861572
Epoch: 14, Steps: 10 | Train Loss: 1.792 Vali Loss: 3.252 Vali Acc: 0.155 Test Loss: 3.252 Test Acc: 0.155
Validation loss decreased (-0.149379 --> -0.155262).  Saving model ...
Epoch: 15 cost time: 1.0480749607086182
Epoch: 15, Steps: 10 | Train Loss: 1.628 Vali Loss: 3.281 Vali Acc: 0.166 Test Loss: 3.281 Test Acc: 0.166
Validation loss decreased (-0.155262 --> -0.165850).  Saving model ...
Epoch: 16 cost time: 0.8314394950866699
Epoch: 16, Steps: 10 | Train Loss: 1.500 Vali Loss: 3.334 Vali Acc: 0.172 Test Loss: 3.334 Test Acc: 0.172
Validation loss decreased (-0.165850 --> -0.171731).  Saving model ...
Epoch: 17 cost time: 1.1281464099884033
Epoch: 17, Steps: 10 | Train Loss: 1.339 Vali Loss: 3.331 Vali Acc: 0.175 Test Loss: 3.331 Test Acc: 0.175
Validation loss decreased (-0.171731 --> -0.175261).  Saving model ...
Epoch: 18 cost time: 1.0569453239440918
Epoch: 18, Steps: 10 | Train Loss: 1.198 Vali Loss: 3.334 Vali Acc: 0.187 Test Loss: 3.334 Test Acc: 0.187
Validation loss decreased (-0.175261 --> -0.187025).  Saving model ...
Epoch: 19 cost time: 0.9551448822021484
Epoch: 19, Steps: 10 | Train Loss: 1.061 Vali Loss: 3.440 Vali Acc: 0.199 Test Loss: 3.440 Test Acc: 0.199
Validation loss decreased (-0.187025 --> -0.198789).  Saving model ...
Epoch: 20 cost time: 1.1389577388763428
Epoch: 20, Steps: 10 | Train Loss: 0.950 Vali Loss: 3.438 Vali Acc: 0.220 Test Loss: 3.438 Test Acc: 0.220
Validation loss decreased (-0.198789 --> -0.219966).  Saving model ...
Epoch: 21 cost time: 0.9935507774353027
Epoch: 21, Steps: 10 | Train Loss: 0.834 Vali Loss: 3.472 Vali Acc: 0.213 Test Loss: 3.472 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0581402778625488
Epoch: 22, Steps: 10 | Train Loss: 0.739 Vali Loss: 3.536 Vali Acc: 0.228 Test Loss: 3.536 Test Acc: 0.228
Validation loss decreased (-0.219966 --> -0.228200).  Saving model ...
Epoch: 23 cost time: 1.1770071983337402
Epoch: 23, Steps: 10 | Train Loss: 0.621 Vali Loss: 3.583 Vali Acc: 0.232 Test Loss: 3.583 Test Acc: 0.232
Validation loss decreased (-0.228200 --> -0.231729).  Saving model ...
Epoch: 24 cost time: 0.9978539943695068
Epoch: 24, Steps: 10 | Train Loss: 0.599 Vali Loss: 3.601 Vali Acc: 0.252 Test Loss: 3.601 Test Acc: 0.252
Validation loss decreased (-0.231729 --> -0.251729).  Saving model ...
Epoch: 25 cost time: 1.1397452354431152
Epoch: 25, Steps: 10 | Train Loss: 0.479 Vali Loss: 3.715 Vali Acc: 0.225 Test Loss: 3.715 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1935052871704102
Epoch: 26, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.717 Vali Acc: 0.246 Test Loss: 3.717 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8990497589111328
Epoch: 27, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.833 Vali Acc: 0.240 Test Loss: 3.833 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1458325386047363
Epoch: 28, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.826 Vali Acc: 0.245 Test Loss: 3.826 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1852624416351318
Epoch: 29, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.875 Vali Acc: 0.256 Test Loss: 3.875 Test Acc: 0.256
Validation loss decreased (-0.251729 --> -0.256432).  Saving model ...
Epoch: 30 cost time: 1.1556415557861328
Epoch: 30, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.995 Vali Acc: 0.254 Test Loss: 3.995 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2449781894683838
Epoch: 31, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.987 Vali Acc: 0.247 Test Loss: 3.987 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0915942192077637
Epoch: 32, Steps: 10 | Train Loss: 0.121 Vali Loss: 4.004 Vali Acc: 0.261 Test Loss: 4.004 Test Acc: 0.261
Validation loss decreased (-0.256432 --> -0.261136).  Saving model ...
Epoch: 33 cost time: 1.1664979457855225
Epoch: 33, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.080 Vali Acc: 0.265 Test Loss: 4.080 Test Acc: 0.265
Validation loss decreased (-0.261136 --> -0.264665).  Saving model ...
Epoch: 34 cost time: 1.1263186931610107
Epoch: 34, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.119 Vali Acc: 0.253 Test Loss: 4.119 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2442116737365723
Epoch: 35, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.184 Vali Acc: 0.254 Test Loss: 4.184 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0566203594207764
Epoch: 36, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.251 Vali Acc: 0.254 Test Loss: 4.251 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9143619537353516
Epoch: 37, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.268 Vali Acc: 0.268 Test Loss: 4.268 Test Acc: 0.268
Validation loss decreased (-0.264665 --> -0.268193).  Saving model ...
Epoch: 38 cost time: 1.078183889389038
Epoch: 38, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.283 Vali Acc: 0.261 Test Loss: 4.283 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3790314197540283
Epoch: 39, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.281 Vali Acc: 0.262 Test Loss: 4.281 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1462409496307373
Epoch: 40, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.343 Vali Acc: 0.269 Test Loss: 4.343 Test Acc: 0.269
Validation loss decreased (-0.268193 --> -0.269368).  Saving model ...
Epoch: 41 cost time: 0.9846975803375244
Epoch: 41, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.350 Vali Acc: 0.272 Test Loss: 4.350 Test Acc: 0.272
Validation loss decreased (-0.269368 --> -0.271721).  Saving model ...
Epoch: 42 cost time: 1.2355387210845947
Epoch: 42, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.363 Vali Acc: 0.261 Test Loss: 4.363 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1825592517852783
Epoch: 43, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.397 Vali Acc: 0.258 Test Loss: 4.397 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1949784755706787
Epoch: 44, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.394 Vali Acc: 0.268 Test Loss: 4.394 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.240877628326416
Epoch: 45, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.415 Vali Acc: 0.266 Test Loss: 4.415 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.2174508571624756
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.425 Vali Acc: 0.266 Test Loss: 4.425 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9896793365478516
Epoch: 47, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.451 Vali Acc: 0.267 Test Loss: 4.451 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.369497299194336
Epoch: 48, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.472 Vali Acc: 0.269 Test Loss: 4.472 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.7524988651275635
Epoch: 49, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.495 Vali Acc: 0.267 Test Loss: 4.495 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.0830636024475098
Epoch: 50, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.547 Vali Acc: 0.264 Test Loss: 4.547 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.2966396808624268
Epoch: 51, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.558 Vali Acc: 0.266 Test Loss: 4.558 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 373554
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.2181127071380615
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.346 Vali Acc: 0.036 Test Loss: 3.346 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 1.150569200515747
Epoch: 2, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.340 Vali Acc: 0.033 Test Loss: 3.340 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0847854614257812
Epoch: 3, Steps: 10 | Train Loss: 3.136 Vali Loss: 3.363 Vali Acc: 0.048 Test Loss: 3.363 Test Acc: 0.048
Validation loss decreased (-0.036437 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 1.1935439109802246
Epoch: 4, Steps: 10 | Train Loss: 3.074 Vali Loss: 3.335 Vali Acc: 0.064 Test Loss: 3.335 Test Acc: 0.064
Validation loss decreased (-0.048202 --> -0.063496).  Saving model ...
Epoch: 5 cost time: 0.9932944774627686
Epoch: 5, Steps: 10 | Train Loss: 2.992 Vali Loss: 3.311 Vali Acc: 0.072 Test Loss: 3.311 Test Acc: 0.072
Validation loss decreased (-0.063496 --> -0.071732).  Saving model ...
Epoch: 6 cost time: 1.139371395111084
Epoch: 6, Steps: 10 | Train Loss: 2.912 Vali Loss: 3.305 Vali Acc: 0.076 Test Loss: 3.305 Test Acc: 0.076
Validation loss decreased (-0.071732 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 1.045133113861084
Epoch: 7, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.263 Vali Acc: 0.102 Test Loss: 3.263 Test Acc: 0.102
Validation loss decreased (-0.076438 --> -0.102320).  Saving model ...
Epoch: 8 cost time: 1.1122853755950928
Epoch: 8, Steps: 10 | Train Loss: 2.634 Vali Loss: 3.264 Vali Acc: 0.100 Test Loss: 3.264 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.036769151687622
Epoch: 9, Steps: 10 | Train Loss: 2.512 Vali Loss: 3.249 Vali Acc: 0.109 Test Loss: 3.249 Test Acc: 0.109
Validation loss decreased (-0.102320 --> -0.109379).  Saving model ...
Epoch: 10 cost time: 1.3274412155151367
Epoch: 10, Steps: 10 | Train Loss: 2.428 Vali Loss: 3.258 Vali Acc: 0.122 Test Loss: 3.258 Test Acc: 0.122
Validation loss decreased (-0.109379 --> -0.122320).  Saving model ...
Epoch: 11 cost time: 1.0878918170928955
Epoch: 11, Steps: 10 | Train Loss: 2.260 Vali Loss: 3.241 Vali Acc: 0.125 Test Loss: 3.241 Test Acc: 0.125
Validation loss decreased (-0.122320 --> -0.124673).  Saving model ...
Epoch: 12 cost time: 1.2568738460540771
Epoch: 12, Steps: 10 | Train Loss: 2.098 Vali Loss: 3.221 Vali Acc: 0.145 Test Loss: 3.221 Test Acc: 0.145
Validation loss decreased (-0.124673 --> -0.144674).  Saving model ...
Epoch: 13 cost time: 1.022721529006958
Epoch: 13, Steps: 10 | Train Loss: 1.925 Vali Loss: 3.257 Vali Acc: 0.141 Test Loss: 3.257 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0755550861358643
Epoch: 14, Steps: 10 | Train Loss: 1.795 Vali Loss: 3.239 Vali Acc: 0.146 Test Loss: 3.239 Test Acc: 0.146
Validation loss decreased (-0.144674 --> -0.145850).  Saving model ...
Epoch: 15 cost time: 1.267547845840454
Epoch: 15, Steps: 10 | Train Loss: 1.645 Vali Loss: 3.282 Vali Acc: 0.165 Test Loss: 3.282 Test Acc: 0.165
Validation loss decreased (-0.145850 --> -0.164673).  Saving model ...
Epoch: 16 cost time: 1.200028896331787
Epoch: 16, Steps: 10 | Train Loss: 1.469 Vali Loss: 3.319 Vali Acc: 0.159 Test Loss: 3.319 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3627333641052246
Epoch: 17, Steps: 10 | Train Loss: 1.361 Vali Loss: 3.351 Vali Acc: 0.176 Test Loss: 3.351 Test Acc: 0.176
Validation loss decreased (-0.164673 --> -0.176437).  Saving model ...
Epoch: 18 cost time: 1.1072540283203125
Epoch: 18, Steps: 10 | Train Loss: 1.187 Vali Loss: 3.374 Vali Acc: 0.194 Test Loss: 3.374 Test Acc: 0.194
Validation loss decreased (-0.176437 --> -0.194084).  Saving model ...
Epoch: 19 cost time: 1.0599322319030762
Epoch: 19, Steps: 10 | Train Loss: 1.065 Vali Loss: 3.430 Vali Acc: 0.206 Test Loss: 3.430 Test Acc: 0.206
Validation loss decreased (-0.194084 --> -0.205848).  Saving model ...
Epoch: 20 cost time: 1.0800719261169434
Epoch: 20, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.470 Vali Acc: 0.199 Test Loss: 3.470 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1439979076385498
Epoch: 21, Steps: 10 | Train Loss: 0.837 Vali Loss: 3.498 Vali Acc: 0.221 Test Loss: 3.498 Test Acc: 0.221
Validation loss decreased (-0.205848 --> -0.221141).  Saving model ...
Epoch: 22 cost time: 1.0245749950408936
Epoch: 22, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.596 Vali Acc: 0.208 Test Loss: 3.596 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1826748847961426
Epoch: 23, Steps: 10 | Train Loss: 0.645 Vali Loss: 3.633 Vali Acc: 0.228 Test Loss: 3.633 Test Acc: 0.228
Validation loss decreased (-0.221141 --> -0.228199).  Saving model ...
Epoch: 24 cost time: 1.2129604816436768
Epoch: 24, Steps: 10 | Train Loss: 0.575 Vali Loss: 3.681 Vali Acc: 0.218 Test Loss: 3.681 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4049408435821533
Epoch: 25, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.724 Vali Acc: 0.225 Test Loss: 3.724 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4186749458312988
Epoch: 26, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.785 Vali Acc: 0.226 Test Loss: 3.785 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7067241668701172
Epoch: 27, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.874 Vali Acc: 0.235 Test Loss: 3.874 Test Acc: 0.235
Validation loss decreased (-0.228199 --> -0.235255).  Saving model ...
Epoch: 28 cost time: 1.076714277267456
Epoch: 28, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.874 Vali Acc: 0.232 Test Loss: 3.874 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0237531661987305
Epoch: 29, Steps: 10 | Train Loss: 0.193 Vali Loss: 4.015 Vali Acc: 0.234 Test Loss: 4.015 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4073538780212402
Epoch: 30, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.980 Vali Acc: 0.242 Test Loss: 3.980 Test Acc: 0.242
Validation loss decreased (-0.235255 --> -0.242313).  Saving model ...
Epoch: 31 cost time: 1.3305983543395996
Epoch: 31, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.054 Vali Acc: 0.246 Test Loss: 4.054 Test Acc: 0.246
Validation loss decreased (-0.242313 --> -0.245842).  Saving model ...
Epoch: 32 cost time: 1.2850868701934814
Epoch: 32, Steps: 10 | Train Loss: 0.118 Vali Loss: 4.112 Vali Acc: 0.247 Test Loss: 4.112 Test Acc: 0.247
Validation loss decreased (-0.245842 --> -0.247018).  Saving model ...
Epoch: 33 cost time: 1.3213958740234375
Epoch: 33, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.136 Vali Acc: 0.241 Test Loss: 4.136 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1286628246307373
Epoch: 34, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.145 Vali Acc: 0.242 Test Loss: 4.145 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2027385234832764
Epoch: 35, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.267 Vali Acc: 0.249 Test Loss: 4.267 Test Acc: 0.249
Validation loss decreased (-0.247018 --> -0.249369).  Saving model ...
Epoch: 36 cost time: 1.2449936866760254
Epoch: 36, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.262 Vali Acc: 0.249 Test Loss: 4.262 Test Acc: 0.249
Validation loss decreased (-0.249369 --> -0.249369).  Saving model ...
Epoch: 37 cost time: 1.0083107948303223
Epoch: 37, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.268 Vali Acc: 0.247 Test Loss: 4.268 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1598443984985352
Epoch: 38, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.303 Vali Acc: 0.247 Test Loss: 4.303 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0936214923858643
Epoch: 39, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.332 Vali Acc: 0.245 Test Loss: 4.332 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2243049144744873
Epoch: 40, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.406 Vali Acc: 0.253 Test Loss: 4.406 Test Acc: 0.253
Validation loss decreased (-0.249369 --> -0.252897).  Saving model ...
Epoch: 41 cost time: 1.125061273574829
Epoch: 41, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.404 Vali Acc: 0.253 Test Loss: 4.404 Test Acc: 0.253
Validation loss decreased (-0.252897 --> -0.252897).  Saving model ...
Epoch: 42 cost time: 1.1808278560638428
Epoch: 42, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.433 Vali Acc: 0.247 Test Loss: 4.433 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3645076751708984
Epoch: 43, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.487 Vali Acc: 0.244 Test Loss: 4.487 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2056388854980469
Epoch: 44, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.480 Vali Acc: 0.247 Test Loss: 4.480 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.010371208190918
Epoch: 45, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.491 Vali Acc: 0.253 Test Loss: 4.491 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.130002498626709
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.548 Vali Acc: 0.249 Test Loss: 4.548 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1177256107330322
Epoch: 47, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.557 Vali Acc: 0.251 Test Loss: 4.557 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2840402126312256
Epoch: 48, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.590 Vali Acc: 0.256 Test Loss: 4.590 Test Acc: 0.256
Validation loss decreased (-0.252897 --> -0.256425).  Saving model ...
Epoch: 49 cost time: 1.2400989532470703
Epoch: 49, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.599 Vali Acc: 0.255 Test Loss: 4.599 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9130148887634277
Epoch: 50, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.598 Vali Acc: 0.253 Test Loss: 4.598 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.1359024047851562
Epoch: 51, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.611 Vali Acc: 0.254 Test Loss: 4.611 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0201692581176758
Epoch: 52, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.629 Vali Acc: 0.255 Test Loss: 4.629 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8971447944641113
Epoch: 53, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.639 Vali Acc: 0.258 Test Loss: 4.639 Test Acc: 0.258
Validation loss decreased (-0.256425 --> -0.257601).  Saving model ...
Epoch: 54 cost time: 1.306257724761963
Epoch: 54, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.656 Vali Acc: 0.259 Test Loss: 4.656 Test Acc: 0.259
Validation loss decreased (-0.257601 --> -0.258777).  Saving model ...
Epoch: 55 cost time: 1.1483511924743652
Epoch: 55, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.676 Vali Acc: 0.256 Test Loss: 4.676 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2279682159423828
Epoch: 56, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.695 Vali Acc: 0.260 Test Loss: 4.695 Test Acc: 0.260
Validation loss decreased (-0.258777 --> -0.259953).  Saving model ...
Epoch: 57 cost time: 1.0986757278442383
Epoch: 57, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.694 Vali Acc: 0.256 Test Loss: 4.694 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1358697414398193
Epoch: 58, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.724 Vali Acc: 0.258 Test Loss: 4.724 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0719923973083496
Epoch: 59, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.739 Vali Acc: 0.252 Test Loss: 4.739 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.3557109832763672
Epoch: 60, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.756 Vali Acc: 0.253 Test Loss: 4.756 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.0374631881713867
Epoch: 61, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.767 Vali Acc: 0.260 Test Loss: 4.767 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.0875864028930664
Epoch: 62, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.778 Vali Acc: 0.258 Test Loss: 4.778 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.3378102779388428
Epoch: 63, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.789 Vali Acc: 0.258 Test Loss: 4.789 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.119044542312622
Epoch: 64, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.792 Vali Acc: 0.253 Test Loss: 4.792 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.19273042678833
Epoch: 65, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.810 Vali Acc: 0.259 Test Loss: 4.810 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.9984636306762695
Epoch: 66, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.821 Vali Acc: 0.260 Test Loss: 4.821 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 372722
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.776155948638916
Epoch: 1, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.327 Vali Acc: 0.036 Test Loss: 3.327 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.8521072864532471
Epoch: 2, Steps: 10 | Train Loss: 3.235 Vali Loss: 3.313 Vali Acc: 0.044 Test Loss: 3.313 Test Acc: 0.044
Validation loss decreased (-0.036437 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 1.1397302150726318
Epoch: 3, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.346 Vali Acc: 0.066 Test Loss: 3.346 Test Acc: 0.066
Validation loss decreased (-0.043496 --> -0.065849).  Saving model ...
Epoch: 4 cost time: 0.8757994174957275
Epoch: 4, Steps: 10 | Train Loss: 3.056 Vali Loss: 3.339 Vali Acc: 0.076 Test Loss: 3.339 Test Acc: 0.076
Validation loss decreased (-0.065849 --> -0.076437).  Saving model ...
Epoch: 5 cost time: 0.8459455966949463
Epoch: 5, Steps: 10 | Train Loss: 2.960 Vali Loss: 3.286 Vali Acc: 0.069 Test Loss: 3.286 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.015939474105835
Epoch: 6, Steps: 10 | Train Loss: 2.883 Vali Loss: 3.268 Vali Acc: 0.102 Test Loss: 3.268 Test Acc: 0.102
Validation loss decreased (-0.076437 --> -0.102320).  Saving model ...
Epoch: 7 cost time: 0.9793965816497803
Epoch: 7, Steps: 10 | Train Loss: 2.749 Vali Loss: 3.265 Vali Acc: 0.100 Test Loss: 3.265 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.786888837814331
Epoch: 8, Steps: 10 | Train Loss: 2.656 Vali Loss: 3.250 Vali Acc: 0.115 Test Loss: 3.250 Test Acc: 0.115
Validation loss decreased (-0.102320 --> -0.115262).  Saving model ...
Epoch: 9 cost time: 1.0444328784942627
Epoch: 9, Steps: 10 | Train Loss: 2.481 Vali Loss: 3.247 Vali Acc: 0.120 Test Loss: 3.247 Test Acc: 0.120
Validation loss decreased (-0.115262 --> -0.119968).  Saving model ...
Epoch: 10 cost time: 0.9106380939483643
Epoch: 10, Steps: 10 | Train Loss: 2.422 Vali Loss: 3.221 Vali Acc: 0.128 Test Loss: 3.221 Test Acc: 0.128
Validation loss decreased (-0.119968 --> -0.128203).  Saving model ...
Epoch: 11 cost time: 0.9896650314331055
Epoch: 11, Steps: 10 | Train Loss: 2.256 Vali Loss: 3.229 Vali Acc: 0.133 Test Loss: 3.229 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 12 cost time: 0.9005603790283203
Epoch: 12, Steps: 10 | Train Loss: 2.129 Vali Loss: 3.198 Vali Acc: 0.144 Test Loss: 3.198 Test Acc: 0.144
Validation loss decreased (-0.132909 --> -0.143497).  Saving model ...
Epoch: 13 cost time: 0.9027070999145508
Epoch: 13, Steps: 10 | Train Loss: 1.902 Vali Loss: 3.237 Vali Acc: 0.158 Test Loss: 3.237 Test Acc: 0.158
Validation loss decreased (-0.143497 --> -0.157615).  Saving model ...
Epoch: 14 cost time: 0.8945393562316895
Epoch: 14, Steps: 10 | Train Loss: 1.749 Vali Loss: 3.250 Vali Acc: 0.167 Test Loss: 3.250 Test Acc: 0.167
Validation loss decreased (-0.157615 --> -0.167026).  Saving model ...
Epoch: 15 cost time: 1.1044750213623047
Epoch: 15, Steps: 10 | Train Loss: 1.623 Vali Loss: 3.296 Vali Acc: 0.167 Test Loss: 3.296 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0295774936676025
Epoch: 16, Steps: 10 | Train Loss: 1.475 Vali Loss: 3.276 Vali Acc: 0.193 Test Loss: 3.276 Test Acc: 0.193
Validation loss decreased (-0.167026 --> -0.192908).  Saving model ...
Epoch: 17 cost time: 1.0804033279418945
Epoch: 17, Steps: 10 | Train Loss: 1.346 Vali Loss: 3.367 Vali Acc: 0.174 Test Loss: 3.367 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0022189617156982
Epoch: 18, Steps: 10 | Train Loss: 1.198 Vali Loss: 3.342 Vali Acc: 0.189 Test Loss: 3.342 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2167372703552246
Epoch: 19, Steps: 10 | Train Loss: 1.066 Vali Loss: 3.410 Vali Acc: 0.205 Test Loss: 3.410 Test Acc: 0.205
Validation loss decreased (-0.192908 --> -0.204672).  Saving model ...
Epoch: 20 cost time: 1.0756516456604004
Epoch: 20, Steps: 10 | Train Loss: 0.928 Vali Loss: 3.451 Vali Acc: 0.205 Test Loss: 3.451 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1753802299499512
Epoch: 21, Steps: 10 | Train Loss: 0.851 Vali Loss: 3.452 Vali Acc: 0.219 Test Loss: 3.452 Test Acc: 0.219
Validation loss decreased (-0.204672 --> -0.218789).  Saving model ...
Epoch: 22 cost time: 1.0347623825073242
Epoch: 22, Steps: 10 | Train Loss: 0.768 Vali Loss: 3.587 Vali Acc: 0.213 Test Loss: 3.587 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8005988597869873
Epoch: 23, Steps: 10 | Train Loss: 0.645 Vali Loss: 3.561 Vali Acc: 0.231 Test Loss: 3.561 Test Acc: 0.231
Validation loss decreased (-0.218789 --> -0.230553).  Saving model ...
Epoch: 24 cost time: 0.8621101379394531
Epoch: 24, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.656 Vali Acc: 0.222 Test Loss: 3.656 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0488348007202148
Epoch: 25, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.665 Vali Acc: 0.239 Test Loss: 3.665 Test Acc: 0.239
Validation loss decreased (-0.230553 --> -0.238787).  Saving model ...
Epoch: 26 cost time: 1.069948673248291
Epoch: 26, Steps: 10 | Train Loss: 0.374 Vali Loss: 3.715 Vali Acc: 0.240 Test Loss: 3.715 Test Acc: 0.240
Validation loss decreased (-0.238787 --> -0.239963).  Saving model ...
Epoch: 27 cost time: 0.8794331550598145
Epoch: 27, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.791 Vali Acc: 0.245 Test Loss: 3.791 Test Acc: 0.245
Validation loss decreased (-0.239963 --> -0.244668).  Saving model ...
Epoch: 28 cost time: 0.9031708240509033
Epoch: 28, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.857 Vali Acc: 0.251 Test Loss: 3.857 Test Acc: 0.251
Validation loss decreased (-0.244668 --> -0.250550).  Saving model ...
Epoch: 29 cost time: 0.9507620334625244
Epoch: 29, Steps: 10 | Train Loss: 0.217 Vali Loss: 3.891 Vali Acc: 0.240 Test Loss: 3.891 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9910781383514404
Epoch: 30, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.957 Vali Acc: 0.247 Test Loss: 3.957 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0996837615966797
Epoch: 31, Steps: 10 | Train Loss: 0.145 Vali Loss: 4.016 Vali Acc: 0.261 Test Loss: 4.016 Test Acc: 0.261
Validation loss decreased (-0.250550 --> -0.261136).  Saving model ...
Epoch: 32 cost time: 0.8952608108520508
Epoch: 32, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.087 Vali Acc: 0.251 Test Loss: 4.087 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8976650238037109
Epoch: 33, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.063 Vali Acc: 0.254 Test Loss: 4.063 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.105342149734497
Epoch: 34, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.113 Vali Acc: 0.253 Test Loss: 4.113 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9486711025238037
Epoch: 35, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.219 Vali Acc: 0.249 Test Loss: 4.219 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.11557936668396
Epoch: 36, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.142 Vali Acc: 0.260 Test Loss: 4.142 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1129956245422363
Epoch: 37, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.226 Vali Acc: 0.259 Test Loss: 4.226 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9057371616363525
Epoch: 38, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.245 Vali Acc: 0.264 Test Loss: 4.245 Test Acc: 0.264
Validation loss decreased (-0.261136 --> -0.263487).  Saving model ...
Epoch: 39 cost time: 0.9776911735534668
Epoch: 39, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.286 Vali Acc: 0.264 Test Loss: 4.286 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0911016464233398
Epoch: 40, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.293 Vali Acc: 0.254 Test Loss: 4.293 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1667249202728271
Epoch: 41, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.346 Vali Acc: 0.258 Test Loss: 4.346 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1372528076171875
Epoch: 42, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.352 Vali Acc: 0.262 Test Loss: 4.352 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8713159561157227
Epoch: 43, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.355 Vali Acc: 0.262 Test Loss: 4.355 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0072293281555176
Epoch: 44, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.381 Vali Acc: 0.265 Test Loss: 4.381 Test Acc: 0.265
Validation loss decreased (-0.263487 --> -0.264662).  Saving model ...
Epoch: 45 cost time: 1.0815660953521729
Epoch: 45, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.421 Vali Acc: 0.258 Test Loss: 4.421 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.102536916732788
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.446 Vali Acc: 0.264 Test Loss: 4.446 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9297573566436768
Epoch: 47, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.458 Vali Acc: 0.261 Test Loss: 4.458 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0080583095550537
Epoch: 48, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.460 Vali Acc: 0.255 Test Loss: 4.460 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3101725578308105
Epoch: 49, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.467 Vali Acc: 0.262 Test Loss: 4.467 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0800185203552246
Epoch: 50, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.495 Vali Acc: 0.265 Test Loss: 4.495 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.9962317943572998
Epoch: 51, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.537 Vali Acc: 0.266 Test Loss: 4.537 Test Acc: 0.266
Validation loss decreased (-0.264662 --> -0.265837).  Saving model ...
Epoch: 52 cost time: 1.0011522769927979
Epoch: 52, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.551 Vali Acc: 0.265 Test Loss: 4.551 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.176900863647461
Epoch: 53, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.560 Vali Acc: 0.264 Test Loss: 4.560 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.051260232925415
Epoch: 54, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.612 Vali Acc: 0.258 Test Loss: 4.612 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9880759716033936
Epoch: 55, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.596 Vali Acc: 0.258 Test Loss: 4.596 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.1542823314666748
Epoch: 56, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.611 Vali Acc: 0.264 Test Loss: 4.611 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.2219460010528564
Epoch: 57, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.606 Vali Acc: 0.266 Test Loss: 4.606 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.061821699142456
Epoch: 58, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.623 Vali Acc: 0.265 Test Loss: 4.623 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.9212813377380371
Epoch: 59, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.665 Vali Acc: 0.262 Test Loss: 4.665 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.0326552391052246
Epoch: 60, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.660 Vali Acc: 0.267 Test Loss: 4.660 Test Acc: 0.267
Validation loss decreased (-0.265837 --> -0.267012).  Saving model ...
Epoch: 61 cost time: 1.1001877784729004
Epoch: 61, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.681 Vali Acc: 0.262 Test Loss: 4.681 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.005492925643921
Epoch: 62, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.685 Vali Acc: 0.262 Test Loss: 4.685 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.0212314128875732
Epoch: 63, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.700 Vali Acc: 0.266 Test Loss: 4.700 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.9492752552032471
Epoch: 64, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.710 Vali Acc: 0.268 Test Loss: 4.710 Test Acc: 0.268
Validation loss decreased (-0.267012 --> -0.268188).  Saving model ...
Epoch: 65 cost time: 0.8259608745574951
Epoch: 65, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.727 Vali Acc: 0.264 Test Loss: 4.727 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9001655578613281
Epoch: 66, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.742 Vali Acc: 0.264 Test Loss: 4.742 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.2219123840332031
Epoch: 67, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.751 Vali Acc: 0.269 Test Loss: 4.751 Test Acc: 0.269
Validation loss decreased (-0.268188 --> -0.269364).  Saving model ...
Epoch: 68 cost time: 1.1846306324005127
Epoch: 68, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.756 Vali Acc: 0.271 Test Loss: 4.756 Test Acc: 0.271
Validation loss decreased (-0.269364 --> -0.270541).  Saving model ...
Epoch: 69 cost time: 1.1136455535888672
Epoch: 69, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.756 Vali Acc: 0.269 Test Loss: 4.756 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.9224448204040527
Epoch: 70, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.772 Vali Acc: 0.267 Test Loss: 4.772 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.187377691268921
Epoch: 71, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.784 Vali Acc: 0.268 Test Loss: 4.784 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.0233118534088135
Epoch: 72, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.793 Vali Acc: 0.269 Test Loss: 4.793 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.1544735431671143
Epoch: 73, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.802 Vali Acc: 0.268 Test Loss: 4.802 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.1695680618286133
Epoch: 74, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.827 Vali Acc: 0.268 Test Loss: 4.827 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.9402790069580078
Epoch: 75, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.828 Vali Acc: 0.265 Test Loss: 4.828 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 1.0011403560638428
Epoch: 76, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.825 Vali Acc: 0.266 Test Loss: 4.825 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 1.196824312210083
Epoch: 77, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.836 Vali Acc: 0.267 Test Loss: 4.836 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 1.1929945945739746
Epoch: 78, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.858 Vali Acc: 0.265 Test Loss: 4.858 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 371890
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.703765630722046
Epoch: 1, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.322 Vali Acc: 0.039 Test Loss: 3.322 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.1605639457702637
Epoch: 2, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.337 Vali Acc: 0.038 Test Loss: 3.337 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9912374019622803
Epoch: 3, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.362 Vali Acc: 0.042 Test Loss: 3.362 Test Acc: 0.042
Validation loss decreased (-0.038790 --> -0.042319).  Saving model ...
Epoch: 4 cost time: 1.001502513885498
Epoch: 4, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.331 Vali Acc: 0.066 Test Loss: 3.331 Test Acc: 0.066
Validation loss decreased (-0.042319 --> -0.065849).  Saving model ...
Epoch: 5 cost time: 0.9007453918457031
Epoch: 5, Steps: 10 | Train Loss: 3.032 Vali Loss: 3.297 Vali Acc: 0.089 Test Loss: 3.297 Test Acc: 0.089
Validation loss decreased (-0.065849 --> -0.089379).  Saving model ...
Epoch: 6 cost time: 0.9239585399627686
Epoch: 6, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.285 Vali Acc: 0.072 Test Loss: 3.285 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1053571701049805
Epoch: 7, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.284 Vali Acc: 0.073 Test Loss: 3.284 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8754477500915527
Epoch: 8, Steps: 10 | Train Loss: 2.743 Vali Loss: 3.249 Vali Acc: 0.080 Test Loss: 3.249 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8661346435546875
Epoch: 9, Steps: 10 | Train Loss: 2.560 Vali Loss: 3.265 Vali Acc: 0.108 Test Loss: 3.265 Test Acc: 0.108
Validation loss decreased (-0.089379 --> -0.108203).  Saving model ...
Epoch: 10 cost time: 0.7815155982971191
Epoch: 10, Steps: 10 | Train Loss: 2.455 Vali Loss: 3.268 Vali Acc: 0.128 Test Loss: 3.268 Test Acc: 0.128
Validation loss decreased (-0.108203 --> -0.128203).  Saving model ...
Epoch: 11 cost time: 0.7728073596954346
Epoch: 11, Steps: 10 | Train Loss: 2.344 Vali Loss: 3.239 Vali Acc: 0.132 Test Loss: 3.239 Test Acc: 0.132
Validation loss decreased (-0.128203 --> -0.131732).  Saving model ...
Epoch: 12 cost time: 1.0890531539916992
Epoch: 12, Steps: 10 | Train Loss: 2.192 Vali Loss: 3.255 Vali Acc: 0.140 Test Loss: 3.255 Test Acc: 0.140
Validation loss decreased (-0.131732 --> -0.139967).  Saving model ...
Epoch: 13 cost time: 1.0586960315704346
Epoch: 13, Steps: 10 | Train Loss: 2.069 Vali Loss: 3.247 Vali Acc: 0.144 Test Loss: 3.247 Test Acc: 0.144
Validation loss decreased (-0.139967 --> -0.143497).  Saving model ...
Epoch: 14 cost time: 0.963167667388916
Epoch: 14, Steps: 10 | Train Loss: 1.896 Vali Loss: 3.242 Vali Acc: 0.155 Test Loss: 3.242 Test Acc: 0.155
Validation loss decreased (-0.143497 --> -0.155262).  Saving model ...
Epoch: 15 cost time: 0.9922342300415039
Epoch: 15, Steps: 10 | Train Loss: 1.733 Vali Loss: 3.268 Vali Acc: 0.165 Test Loss: 3.268 Test Acc: 0.165
Validation loss decreased (-0.155262 --> -0.164673).  Saving model ...
Epoch: 16 cost time: 1.0627014636993408
Epoch: 16, Steps: 10 | Train Loss: 1.592 Vali Loss: 3.294 Vali Acc: 0.180 Test Loss: 3.294 Test Acc: 0.180
Validation loss decreased (-0.164673 --> -0.179967).  Saving model ...
Epoch: 17 cost time: 1.0670690536499023
Epoch: 17, Steps: 10 | Train Loss: 1.466 Vali Loss: 3.327 Vali Acc: 0.184 Test Loss: 3.327 Test Acc: 0.184
Validation loss decreased (-0.179967 --> -0.183496).  Saving model ...
Epoch: 18 cost time: 1.2727866172790527
Epoch: 18, Steps: 10 | Train Loss: 1.336 Vali Loss: 3.334 Vali Acc: 0.181 Test Loss: 3.334 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9082803726196289
Epoch: 19, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.391 Vali Acc: 0.186 Test Loss: 3.391 Test Acc: 0.186
Validation loss decreased (-0.183496 --> -0.185848).  Saving model ...
Epoch: 20 cost time: 0.9696533679962158
Epoch: 20, Steps: 10 | Train Loss: 1.099 Vali Loss: 3.424 Vali Acc: 0.216 Test Loss: 3.424 Test Acc: 0.216
Validation loss decreased (-0.185848 --> -0.216436).  Saving model ...
Epoch: 21 cost time: 0.9134104251861572
Epoch: 21, Steps: 10 | Train Loss: 0.957 Vali Loss: 3.416 Vali Acc: 0.226 Test Loss: 3.416 Test Acc: 0.226
Validation loss decreased (-0.216436 --> -0.225848).  Saving model ...
Epoch: 22 cost time: 1.0783648490905762
Epoch: 22, Steps: 10 | Train Loss: 0.867 Vali Loss: 3.479 Vali Acc: 0.225 Test Loss: 3.479 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0236237049102783
Epoch: 23, Steps: 10 | Train Loss: 0.763 Vali Loss: 3.542 Vali Acc: 0.219 Test Loss: 3.542 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9747631549835205
Epoch: 24, Steps: 10 | Train Loss: 0.679 Vali Loss: 3.525 Vali Acc: 0.246 Test Loss: 3.525 Test Acc: 0.246
Validation loss decreased (-0.225848 --> -0.245847).  Saving model ...
Epoch: 25 cost time: 0.8235950469970703
Epoch: 25, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.631 Vali Acc: 0.229 Test Loss: 3.631 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.974170446395874
Epoch: 26, Steps: 10 | Train Loss: 0.526 Vali Loss: 3.660 Vali Acc: 0.245 Test Loss: 3.660 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.142716407775879
Epoch: 27, Steps: 10 | Train Loss: 0.418 Vali Loss: 3.683 Vali Acc: 0.251 Test Loss: 3.683 Test Acc: 0.251
Validation loss decreased (-0.245847 --> -0.250551).  Saving model ...
Epoch: 28 cost time: 0.9791107177734375
Epoch: 28, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.798 Vali Acc: 0.240 Test Loss: 3.798 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1379711627960205
Epoch: 29, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.778 Vali Acc: 0.259 Test Loss: 3.778 Test Acc: 0.259
Validation loss decreased (-0.250551 --> -0.258786).  Saving model ...
Epoch: 30 cost time: 0.920262336730957
Epoch: 30, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.960 Vali Acc: 0.235 Test Loss: 3.960 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9176104068756104
Epoch: 31, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.914 Vali Acc: 0.254 Test Loss: 3.914 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2457432746887207
Epoch: 32, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.040 Vali Acc: 0.247 Test Loss: 4.040 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0349383354187012
Epoch: 33, Steps: 10 | Train Loss: 0.137 Vali Loss: 4.011 Vali Acc: 0.258 Test Loss: 4.011 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9583511352539062
Epoch: 34, Steps: 10 | Train Loss: 0.108 Vali Loss: 4.084 Vali Acc: 0.259 Test Loss: 4.084 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9106621742248535
Epoch: 35, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.139 Vali Acc: 0.256 Test Loss: 4.139 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9917812347412109
Epoch: 36, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.157 Vali Acc: 0.259 Test Loss: 4.157 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1556358337402344
Epoch: 37, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.181 Vali Acc: 0.262 Test Loss: 4.181 Test Acc: 0.262
Validation loss decreased (-0.258786 --> -0.262311).  Saving model ...
Epoch: 38 cost time: 0.9120771884918213
Epoch: 38, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.245 Vali Acc: 0.256 Test Loss: 4.245 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.158540964126587
Epoch: 39, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.279 Vali Acc: 0.251 Test Loss: 4.279 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1652936935424805
Epoch: 40, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.273 Vali Acc: 0.256 Test Loss: 4.273 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9100558757781982
Epoch: 41, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.288 Vali Acc: 0.260 Test Loss: 4.288 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0054306983947754
Epoch: 42, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.343 Vali Acc: 0.260 Test Loss: 4.343 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0580065250396729
Epoch: 43, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.366 Vali Acc: 0.261 Test Loss: 4.366 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9181864261627197
Epoch: 44, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.379 Vali Acc: 0.266 Test Loss: 4.379 Test Acc: 0.266
Validation loss decreased (-0.262311 --> -0.265839).  Saving model ...
Epoch: 45 cost time: 0.9289259910583496
Epoch: 45, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.417 Vali Acc: 0.261 Test Loss: 4.417 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0674939155578613
Epoch: 46, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.448 Vali Acc: 0.262 Test Loss: 4.448 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.202627420425415
Epoch: 47, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.454 Vali Acc: 0.260 Test Loss: 4.454 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.4660377502441406
Epoch: 48, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.477 Vali Acc: 0.264 Test Loss: 4.477 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8567168712615967
Epoch: 49, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.494 Vali Acc: 0.272 Test Loss: 4.494 Test Acc: 0.272
Validation loss decreased (-0.265839 --> -0.271720).  Saving model ...
Epoch: 50 cost time: 0.939049482345581
Epoch: 50, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.495 Vali Acc: 0.268 Test Loss: 4.495 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.061603307723999
Epoch: 51, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.500 Vali Acc: 0.269 Test Loss: 4.500 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.1441681385040283
Epoch: 52, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.530 Vali Acc: 0.266 Test Loss: 4.530 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.0311155319213867
Epoch: 53, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.565 Vali Acc: 0.266 Test Loss: 4.565 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.9394876956939697
Epoch: 54, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.590 Vali Acc: 0.269 Test Loss: 4.590 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.1029324531555176
Epoch: 55, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.592 Vali Acc: 0.269 Test Loss: 4.592 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.039759635925293
Epoch: 56, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.583 Vali Acc: 0.271 Test Loss: 4.583 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.8544714450836182
Epoch: 57, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.586 Vali Acc: 0.278 Test Loss: 4.586 Test Acc: 0.278
Validation loss decreased (-0.271720 --> -0.277601).  Saving model ...
Epoch: 58 cost time: 1.0790443420410156
Epoch: 58, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.607 Vali Acc: 0.275 Test Loss: 4.607 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.1250965595245361
Epoch: 59, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.637 Vali Acc: 0.274 Test Loss: 4.637 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9075992107391357
Epoch: 60, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.677 Vali Acc: 0.269 Test Loss: 4.677 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9488120079040527
Epoch: 61, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.666 Vali Acc: 0.271 Test Loss: 4.666 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.168118953704834
Epoch: 62, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.669 Vali Acc: 0.272 Test Loss: 4.669 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.0393929481506348
Epoch: 63, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.690 Vali Acc: 0.269 Test Loss: 4.690 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.9359676837921143
Epoch: 64, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.712 Vali Acc: 0.265 Test Loss: 4.712 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.9419822692871094
Epoch: 65, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.723 Vali Acc: 0.266 Test Loss: 4.723 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.9736645221710205
Epoch: 66, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.743 Vali Acc: 0.271 Test Loss: 4.743 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.9723248481750488
Epoch: 67, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.759 Vali Acc: 0.272 Test Loss: 4.759 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 324850
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7468342781066895
Epoch: 1, Steps: 10 | Train Loss: 3.396 Vali Loss: 3.353 Vali Acc: 0.031 Test Loss: 3.353 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.9825634956359863
Epoch: 2, Steps: 10 | Train Loss: 3.332 Vali Loss: 3.316 Vali Acc: 0.051 Test Loss: 3.316 Test Acc: 0.051
Validation loss decreased (-0.030555 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 1.0485990047454834
Epoch: 3, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.348 Vali Acc: 0.053 Test Loss: 3.348 Test Acc: 0.053
Validation loss decreased (-0.050555 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 1.111318588256836
Epoch: 4, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.334 Vali Acc: 0.072 Test Loss: 3.334 Test Acc: 0.072
Validation loss decreased (-0.052908 --> -0.071731).  Saving model ...
Epoch: 5 cost time: 1.3516228199005127
Epoch: 5, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.309 Vali Acc: 0.078 Test Loss: 3.309 Test Acc: 0.078
Validation loss decreased (-0.071731 --> -0.077614).  Saving model ...
Epoch: 6 cost time: 1.1069107055664062
Epoch: 6, Steps: 10 | Train Loss: 2.958 Vali Loss: 3.273 Vali Acc: 0.095 Test Loss: 3.273 Test Acc: 0.095
Validation loss decreased (-0.077614 --> -0.095261).  Saving model ...
Epoch: 7 cost time: 1.3180615901947021
Epoch: 7, Steps: 10 | Train Loss: 2.792 Vali Loss: 3.272 Vali Acc: 0.089 Test Loss: 3.272 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8837981224060059
Epoch: 8, Steps: 10 | Train Loss: 2.746 Vali Loss: 3.304 Vali Acc: 0.096 Test Loss: 3.304 Test Acc: 0.096
Validation loss decreased (-0.095261 --> -0.096438).  Saving model ...
Epoch: 9 cost time: 1.1585662364959717
Epoch: 9, Steps: 10 | Train Loss: 2.609 Vali Loss: 3.216 Vali Acc: 0.114 Test Loss: 3.216 Test Acc: 0.114
Validation loss decreased (-0.096438 --> -0.114085).  Saving model ...
Epoch: 10 cost time: 1.0654077529907227
Epoch: 10, Steps: 10 | Train Loss: 2.471 Vali Loss: 3.243 Vali Acc: 0.113 Test Loss: 3.243 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9943227767944336
Epoch: 11, Steps: 10 | Train Loss: 2.358 Vali Loss: 3.216 Vali Acc: 0.134 Test Loss: 3.216 Test Acc: 0.134
Validation loss decreased (-0.114085 --> -0.134085).  Saving model ...
Epoch: 12 cost time: 0.9951443672180176
Epoch: 12, Steps: 10 | Train Loss: 2.212 Vali Loss: 3.259 Vali Acc: 0.142 Test Loss: 3.259 Test Acc: 0.142
Validation loss decreased (-0.134085 --> -0.142320).  Saving model ...
Epoch: 13 cost time: 0.9497377872467041
Epoch: 13, Steps: 10 | Train Loss: 2.064 Vali Loss: 3.224 Vali Acc: 0.148 Test Loss: 3.224 Test Acc: 0.148
Validation loss decreased (-0.142320 --> -0.148203).  Saving model ...
Epoch: 14 cost time: 1.0521900653839111
Epoch: 14, Steps: 10 | Train Loss: 1.934 Vali Loss: 3.253 Vali Acc: 0.145 Test Loss: 3.253 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9579989910125732
Epoch: 15, Steps: 10 | Train Loss: 1.811 Vali Loss: 3.243 Vali Acc: 0.173 Test Loss: 3.243 Test Acc: 0.173
Validation loss decreased (-0.148203 --> -0.172909).  Saving model ...
Epoch: 16 cost time: 1.2128472328186035
Epoch: 16, Steps: 10 | Train Loss: 1.595 Vali Loss: 3.255 Vali Acc: 0.169 Test Loss: 3.255 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0608277320861816
Epoch: 17, Steps: 10 | Train Loss: 1.497 Vali Loss: 3.283 Vali Acc: 0.195 Test Loss: 3.283 Test Acc: 0.195
Validation loss decreased (-0.172909 --> -0.195261).  Saving model ...
Epoch: 18 cost time: 1.0300374031066895
Epoch: 18, Steps: 10 | Train Loss: 1.339 Vali Loss: 3.330 Vali Acc: 0.184 Test Loss: 3.330 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.958235502243042
Epoch: 19, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.341 Vali Acc: 0.206 Test Loss: 3.341 Test Acc: 0.206
Validation loss decreased (-0.195261 --> -0.205849).  Saving model ...
Epoch: 20 cost time: 1.099534034729004
Epoch: 20, Steps: 10 | Train Loss: 1.075 Vali Loss: 3.386 Vali Acc: 0.211 Test Loss: 3.386 Test Acc: 0.211
Validation loss decreased (-0.205849 --> -0.210554).  Saving model ...
Epoch: 21 cost time: 1.0110208988189697
Epoch: 21, Steps: 10 | Train Loss: 0.974 Vali Loss: 3.426 Vali Acc: 0.214 Test Loss: 3.426 Test Acc: 0.214
Validation loss decreased (-0.210554 --> -0.214083).  Saving model ...
Epoch: 22 cost time: 1.018813133239746
Epoch: 22, Steps: 10 | Train Loss: 0.895 Vali Loss: 3.475 Vali Acc: 0.207 Test Loss: 3.475 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3453843593597412
Epoch: 23, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.516 Vali Acc: 0.220 Test Loss: 3.516 Test Acc: 0.220
Validation loss decreased (-0.214083 --> -0.219965).  Saving model ...
Epoch: 24 cost time: 1.0703940391540527
Epoch: 24, Steps: 10 | Train Loss: 0.663 Vali Loss: 3.574 Vali Acc: 0.225 Test Loss: 3.574 Test Acc: 0.225
Validation loss decreased (-0.219965 --> -0.224670).  Saving model ...
Epoch: 25 cost time: 1.0708632469177246
Epoch: 25, Steps: 10 | Train Loss: 0.574 Vali Loss: 3.649 Vali Acc: 0.225 Test Loss: 3.649 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3662619590759277
Epoch: 26, Steps: 10 | Train Loss: 0.473 Vali Loss: 3.632 Vali Acc: 0.247 Test Loss: 3.632 Test Acc: 0.247
Validation loss decreased (-0.224670 --> -0.247023).  Saving model ...
Epoch: 27 cost time: 1.3653299808502197
Epoch: 27, Steps: 10 | Train Loss: 0.407 Vali Loss: 3.736 Vali Acc: 0.247 Test Loss: 3.736 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.253138542175293
Epoch: 28, Steps: 10 | Train Loss: 0.333 Vali Loss: 3.777 Vali Acc: 0.242 Test Loss: 3.777 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3795628547668457
Epoch: 29, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.836 Vali Acc: 0.245 Test Loss: 3.836 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2801382541656494
Epoch: 30, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.896 Vali Acc: 0.248 Test Loss: 3.896 Test Acc: 0.248
Validation loss decreased (-0.247023 --> -0.248196).  Saving model ...
Epoch: 31 cost time: 0.9899911880493164
Epoch: 31, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.851 Vali Acc: 0.251 Test Loss: 3.851 Test Acc: 0.251
Validation loss decreased (-0.248196 --> -0.250550).  Saving model ...
Epoch: 32 cost time: 1.2730636596679688
Epoch: 32, Steps: 10 | Train Loss: 0.175 Vali Loss: 4.015 Vali Acc: 0.247 Test Loss: 4.015 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0831797122955322
Epoch: 33, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.009 Vali Acc: 0.256 Test Loss: 4.009 Test Acc: 0.256
Validation loss decreased (-0.250550 --> -0.256431).  Saving model ...
Epoch: 34 cost time: 1.1182847023010254
Epoch: 34, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.003 Vali Acc: 0.255 Test Loss: 4.003 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1208434104919434
Epoch: 35, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.101 Vali Acc: 0.258 Test Loss: 4.101 Test Acc: 0.258
Validation loss decreased (-0.256431 --> -0.257606).  Saving model ...
Epoch: 36 cost time: 1.169565200805664
Epoch: 36, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.116 Vali Acc: 0.258 Test Loss: 4.116 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2597460746765137
Epoch: 37, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.143 Vali Acc: 0.267 Test Loss: 4.143 Test Acc: 0.267
Validation loss decreased (-0.257606 --> -0.267017).  Saving model ...
Epoch: 38 cost time: 1.1125781536102295
Epoch: 38, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.162 Vali Acc: 0.253 Test Loss: 4.162 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.168961763381958
Epoch: 39, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.233 Vali Acc: 0.266 Test Loss: 4.233 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1272079944610596
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.312 Vali Acc: 0.253 Test Loss: 4.312 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3500969409942627
Epoch: 41, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.273 Vali Acc: 0.258 Test Loss: 4.273 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0567951202392578
Epoch: 42, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.284 Vali Acc: 0.253 Test Loss: 4.284 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0527150630950928
Epoch: 43, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.333 Vali Acc: 0.251 Test Loss: 4.333 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.2701895236968994
Epoch: 44, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.361 Vali Acc: 0.254 Test Loss: 4.361 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0812132358551025
Epoch: 45, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.391 Vali Acc: 0.260 Test Loss: 4.391 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.215761423110962
Epoch: 46, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.419 Vali Acc: 0.256 Test Loss: 4.419 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.2529354095458984
Epoch: 47, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.424 Vali Acc: 0.255 Test Loss: 4.424 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 324018
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.76267409324646
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.321 Vali Acc: 0.041 Test Loss: 3.321 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 1.0684340000152588
Epoch: 2, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.317 Vali Acc: 0.045 Test Loss: 3.317 Test Acc: 0.045
Validation loss decreased (-0.041143 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 1.1833617687225342
Epoch: 3, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.330 Vali Acc: 0.056 Test Loss: 3.330 Test Acc: 0.056
Validation loss decreased (-0.044673 --> -0.056437).  Saving model ...
Epoch: 4 cost time: 1.0062551498413086
Epoch: 4, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.334 Vali Acc: 0.064 Test Loss: 3.334 Test Acc: 0.064
Validation loss decreased (-0.056437 --> -0.063496).  Saving model ...
Epoch: 5 cost time: 1.174046516418457
Epoch: 5, Steps: 10 | Train Loss: 2.941 Vali Loss: 3.310 Vali Acc: 0.075 Test Loss: 3.310 Test Acc: 0.075
Validation loss decreased (-0.063496 --> -0.075261).  Saving model ...
Epoch: 6 cost time: 0.9136552810668945
Epoch: 6, Steps: 10 | Train Loss: 2.898 Vali Loss: 3.268 Vali Acc: 0.104 Test Loss: 3.268 Test Acc: 0.104
Validation loss decreased (-0.075261 --> -0.103497).  Saving model ...
Epoch: 7 cost time: 1.104123592376709
Epoch: 7, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.257 Vali Acc: 0.108 Test Loss: 3.257 Test Acc: 0.108
Validation loss decreased (-0.103497 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 0.9172101020812988
Epoch: 8, Steps: 10 | Train Loss: 2.637 Vali Loss: 3.260 Vali Acc: 0.107 Test Loss: 3.260 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0337085723876953
Epoch: 9, Steps: 10 | Train Loss: 2.600 Vali Loss: 3.246 Vali Acc: 0.124 Test Loss: 3.246 Test Acc: 0.124
Validation loss decreased (-0.108203 --> -0.123497).  Saving model ...
Epoch: 10 cost time: 1.1568520069122314
Epoch: 10, Steps: 10 | Train Loss: 2.437 Vali Loss: 3.230 Vali Acc: 0.127 Test Loss: 3.230 Test Acc: 0.127
Validation loss decreased (-0.123497 --> -0.127027).  Saving model ...
Epoch: 11 cost time: 1.1964054107666016
Epoch: 11, Steps: 10 | Train Loss: 2.308 Vali Loss: 3.218 Vali Acc: 0.122 Test Loss: 3.218 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1373462677001953
Epoch: 12, Steps: 10 | Train Loss: 2.158 Vali Loss: 3.229 Vali Acc: 0.144 Test Loss: 3.229 Test Acc: 0.144
Validation loss decreased (-0.127027 --> -0.143497).  Saving model ...
Epoch: 13 cost time: 1.0716094970703125
Epoch: 13, Steps: 10 | Train Loss: 2.050 Vali Loss: 3.225 Vali Acc: 0.148 Test Loss: 3.225 Test Acc: 0.148
Validation loss decreased (-0.143497 --> -0.148203).  Saving model ...
Epoch: 14 cost time: 1.2941651344299316
Epoch: 14, Steps: 10 | Train Loss: 1.875 Vali Loss: 3.223 Vali Acc: 0.154 Test Loss: 3.223 Test Acc: 0.154
Validation loss decreased (-0.148203 --> -0.154085).  Saving model ...
Epoch: 15 cost time: 0.9950275421142578
Epoch: 15, Steps: 10 | Train Loss: 1.740 Vali Loss: 3.296 Vali Acc: 0.161 Test Loss: 3.296 Test Acc: 0.161
Validation loss decreased (-0.154085 --> -0.161144).  Saving model ...
Epoch: 16 cost time: 1.2585484981536865
Epoch: 16, Steps: 10 | Train Loss: 1.604 Vali Loss: 3.272 Vali Acc: 0.167 Test Loss: 3.272 Test Acc: 0.167
Validation loss decreased (-0.161144 --> -0.167026).  Saving model ...
Epoch: 17 cost time: 1.1271395683288574
Epoch: 17, Steps: 10 | Train Loss: 1.442 Vali Loss: 3.295 Vali Acc: 0.180 Test Loss: 3.295 Test Acc: 0.180
Validation loss decreased (-0.167026 --> -0.179967).  Saving model ...
Epoch: 18 cost time: 1.234156608581543
Epoch: 18, Steps: 10 | Train Loss: 1.314 Vali Loss: 3.345 Vali Acc: 0.173 Test Loss: 3.345 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3189659118652344
Epoch: 19, Steps: 10 | Train Loss: 1.207 Vali Loss: 3.359 Vali Acc: 0.198 Test Loss: 3.359 Test Acc: 0.198
Validation loss decreased (-0.179967 --> -0.197613).  Saving model ...
Epoch: 20 cost time: 1.132554292678833
Epoch: 20, Steps: 10 | Train Loss: 1.049 Vali Loss: 3.397 Vali Acc: 0.198 Test Loss: 3.397 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0921049118041992
Epoch: 21, Steps: 10 | Train Loss: 0.942 Vali Loss: 3.462 Vali Acc: 0.204 Test Loss: 3.462 Test Acc: 0.204
Validation loss decreased (-0.197613 --> -0.203495).  Saving model ...
Epoch: 22 cost time: 1.2184293270111084
Epoch: 22, Steps: 10 | Train Loss: 0.828 Vali Loss: 3.494 Vali Acc: 0.209 Test Loss: 3.494 Test Acc: 0.209
Validation loss decreased (-0.203495 --> -0.209377).  Saving model ...
Epoch: 23 cost time: 0.9926967620849609
Epoch: 23, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.569 Vali Acc: 0.226 Test Loss: 3.569 Test Acc: 0.226
Validation loss decreased (-0.209377 --> -0.225847).  Saving model ...
Epoch: 24 cost time: 1.003814935684204
Epoch: 24, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.613 Vali Acc: 0.215 Test Loss: 3.613 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0389494895935059
Epoch: 25, Steps: 10 | Train Loss: 0.521 Vali Loss: 3.647 Vali Acc: 0.225 Test Loss: 3.647 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2477166652679443
Epoch: 26, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.731 Vali Acc: 0.233 Test Loss: 3.731 Test Acc: 0.233
Validation loss decreased (-0.225847 --> -0.232904).  Saving model ...
Epoch: 27 cost time: 1.1675007343292236
Epoch: 27, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.787 Vali Acc: 0.222 Test Loss: 3.787 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1927454471588135
Epoch: 28, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.817 Vali Acc: 0.235 Test Loss: 3.817 Test Acc: 0.235
Validation loss decreased (-0.232904 --> -0.235256).  Saving model ...
Epoch: 29 cost time: 0.9713282585144043
Epoch: 29, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.860 Vali Acc: 0.246 Test Loss: 3.860 Test Acc: 0.246
Validation loss decreased (-0.235256 --> -0.245844).  Saving model ...
Epoch: 30 cost time: 1.2001643180847168
Epoch: 30, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.977 Vali Acc: 0.231 Test Loss: 3.977 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0572080612182617
Epoch: 31, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.974 Vali Acc: 0.241 Test Loss: 3.974 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1831483840942383
Epoch: 32, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.061 Vali Acc: 0.251 Test Loss: 4.061 Test Acc: 0.251
Validation loss decreased (-0.245844 --> -0.250548).  Saving model ...
Epoch: 33 cost time: 1.218519926071167
Epoch: 33, Steps: 10 | Train Loss: 0.115 Vali Loss: 4.127 Vali Acc: 0.251 Test Loss: 4.127 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2348899841308594
Epoch: 34, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.079 Vali Acc: 0.242 Test Loss: 4.079 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1412224769592285
Epoch: 35, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.128 Vali Acc: 0.245 Test Loss: 4.128 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2160205841064453
Epoch: 36, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.217 Vali Acc: 0.244 Test Loss: 4.217 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2914047241210938
Epoch: 37, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.229 Vali Acc: 0.249 Test Loss: 4.229 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0377044677734375
Epoch: 38, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.239 Vali Acc: 0.241 Test Loss: 4.239 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.244248390197754
Epoch: 39, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.251 Vali Acc: 0.245 Test Loss: 4.251 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.02225923538208
Epoch: 40, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.292 Vali Acc: 0.249 Test Loss: 4.292 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.3762195110321045
Epoch: 41, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.366 Vali Acc: 0.248 Test Loss: 4.366 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0425677299499512
Epoch: 42, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.361 Vali Acc: 0.248 Test Loss: 4.361 Test Acc: 0.248
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25058823529411767
model parameter : 323186
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7258987426757812
Epoch: 1, Steps: 10 | Train Loss: 3.409 Vali Loss: 3.313 Vali Acc: 0.044 Test Loss: 3.313 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.940157413482666
Epoch: 2, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.327 Vali Acc: 0.060 Test Loss: 3.327 Test Acc: 0.060
Validation loss decreased (-0.043496 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 1.2251124382019043
Epoch: 3, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.377 Vali Acc: 0.064 Test Loss: 3.377 Test Acc: 0.064
Validation loss decreased (-0.059967 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 1.0942857265472412
Epoch: 4, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.368 Vali Acc: 0.076 Test Loss: 3.368 Test Acc: 0.076
Validation loss decreased (-0.063496 --> -0.076437).  Saving model ...
Epoch: 5 cost time: 1.205183506011963
Epoch: 5, Steps: 10 | Train Loss: 3.009 Vali Loss: 3.303 Vali Acc: 0.076 Test Loss: 3.303 Test Acc: 0.076
Validation loss decreased (-0.076437 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 1.0274298191070557
Epoch: 6, Steps: 10 | Train Loss: 2.958 Vali Loss: 3.283 Vali Acc: 0.087 Test Loss: 3.283 Test Acc: 0.087
Validation loss decreased (-0.076438 --> -0.087026).  Saving model ...
Epoch: 7 cost time: 0.9621713161468506
Epoch: 7, Steps: 10 | Train Loss: 2.855 Vali Loss: 3.284 Vali Acc: 0.106 Test Loss: 3.284 Test Acc: 0.106
Validation loss decreased (-0.087026 --> -0.105850).  Saving model ...
Epoch: 8 cost time: 0.8269731998443604
Epoch: 8, Steps: 10 | Train Loss: 2.744 Vali Loss: 3.254 Vali Acc: 0.101 Test Loss: 3.254 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8416323661804199
Epoch: 9, Steps: 10 | Train Loss: 2.564 Vali Loss: 3.234 Vali Acc: 0.128 Test Loss: 3.234 Test Acc: 0.128
Validation loss decreased (-0.105850 --> -0.128203).  Saving model ...
Epoch: 10 cost time: 0.9004526138305664
Epoch: 10, Steps: 10 | Train Loss: 2.532 Vali Loss: 3.268 Vali Acc: 0.120 Test Loss: 3.268 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9488527774810791
Epoch: 11, Steps: 10 | Train Loss: 2.352 Vali Loss: 3.222 Vali Acc: 0.131 Test Loss: 3.222 Test Acc: 0.131
Validation loss decreased (-0.128203 --> -0.130556).  Saving model ...
Epoch: 12 cost time: 0.9819014072418213
Epoch: 12, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.251 Vali Acc: 0.124 Test Loss: 3.251 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1513733863830566
Epoch: 13, Steps: 10 | Train Loss: 2.011 Vali Loss: 3.226 Vali Acc: 0.162 Test Loss: 3.226 Test Acc: 0.162
Validation loss decreased (-0.130556 --> -0.162321).  Saving model ...
Epoch: 14 cost time: 1.1100077629089355
Epoch: 14, Steps: 10 | Train Loss: 1.993 Vali Loss: 3.249 Vali Acc: 0.156 Test Loss: 3.249 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0298595428466797
Epoch: 15, Steps: 10 | Train Loss: 1.743 Vali Loss: 3.260 Vali Acc: 0.142 Test Loss: 3.260 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9247837066650391
Epoch: 16, Steps: 10 | Train Loss: 1.645 Vali Loss: 3.267 Vali Acc: 0.185 Test Loss: 3.267 Test Acc: 0.185
Validation loss decreased (-0.162321 --> -0.184673).  Saving model ...
Epoch: 17 cost time: 1.1813926696777344
Epoch: 17, Steps: 10 | Train Loss: 1.480 Vali Loss: 3.346 Vali Acc: 0.184 Test Loss: 3.346 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.25748872756958
Epoch: 18, Steps: 10 | Train Loss: 1.310 Vali Loss: 3.339 Vali Acc: 0.185 Test Loss: 3.339 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0529565811157227
Epoch: 19, Steps: 10 | Train Loss: 1.227 Vali Loss: 3.356 Vali Acc: 0.202 Test Loss: 3.356 Test Acc: 0.202
Validation loss decreased (-0.184673 --> -0.202319).  Saving model ...
Epoch: 20 cost time: 1.0094478130340576
Epoch: 20, Steps: 10 | Train Loss: 1.104 Vali Loss: 3.407 Vali Acc: 0.213 Test Loss: 3.407 Test Acc: 0.213
Validation loss decreased (-0.202319 --> -0.212907).  Saving model ...
Epoch: 21 cost time: 1.0095791816711426
Epoch: 21, Steps: 10 | Train Loss: 0.933 Vali Loss: 3.430 Vali Acc: 0.222 Test Loss: 3.430 Test Acc: 0.222
Validation loss decreased (-0.212907 --> -0.222319).  Saving model ...
Epoch: 22 cost time: 0.9032518863677979
Epoch: 22, Steps: 10 | Train Loss: 0.837 Vali Loss: 3.479 Vali Acc: 0.220 Test Loss: 3.479 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.927440881729126
Epoch: 23, Steps: 10 | Train Loss: 0.747 Vali Loss: 3.520 Vali Acc: 0.219 Test Loss: 3.520 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8842072486877441
Epoch: 24, Steps: 10 | Train Loss: 0.671 Vali Loss: 3.563 Vali Acc: 0.238 Test Loss: 3.563 Test Acc: 0.238
Validation loss decreased (-0.222319 --> -0.237611).  Saving model ...
Epoch: 25 cost time: 0.8409597873687744
Epoch: 25, Steps: 10 | Train Loss: 0.553 Vali Loss: 3.666 Vali Acc: 0.233 Test Loss: 3.666 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7827005386352539
Epoch: 26, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.654 Vali Acc: 0.228 Test Loss: 3.654 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9806227684020996
Epoch: 27, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.721 Vali Acc: 0.245 Test Loss: 3.721 Test Acc: 0.245
Validation loss decreased (-0.237611 --> -0.244669).  Saving model ...
Epoch: 28 cost time: 1.230696678161621
Epoch: 28, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.766 Vali Acc: 0.245 Test Loss: 3.766 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1353611946105957
Epoch: 29, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.900 Vali Acc: 0.240 Test Loss: 3.900 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0008571147918701
Epoch: 30, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.937 Vali Acc: 0.254 Test Loss: 3.937 Test Acc: 0.254
Validation loss decreased (-0.244669 --> -0.254078).  Saving model ...
Epoch: 31 cost time: 1.033555507659912
Epoch: 31, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.974 Vali Acc: 0.260 Test Loss: 3.974 Test Acc: 0.260
Validation loss decreased (-0.254078 --> -0.259960).  Saving model ...
Epoch: 32 cost time: 1.0988430976867676
Epoch: 32, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.046 Vali Acc: 0.241 Test Loss: 4.046 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1466481685638428
Epoch: 33, Steps: 10 | Train Loss: 0.131 Vali Loss: 4.028 Vali Acc: 0.255 Test Loss: 4.028 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.181107521057129
Epoch: 34, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.089 Vali Acc: 0.240 Test Loss: 4.089 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9494421482086182
Epoch: 35, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.142 Vali Acc: 0.254 Test Loss: 4.142 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.173187017440796
Epoch: 36, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.232 Vali Acc: 0.255 Test Loss: 4.232 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0577607154846191
Epoch: 37, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.237 Vali Acc: 0.256 Test Loss: 4.237 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.231010913848877
Epoch: 38, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.285 Vali Acc: 0.251 Test Loss: 4.285 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9198768138885498
Epoch: 39, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.310 Vali Acc: 0.260 Test Loss: 4.310 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8800504207611084
Epoch: 40, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.344 Vali Acc: 0.259 Test Loss: 4.344 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9656765460968018
Epoch: 41, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.374 Vali Acc: 0.255 Test Loss: 4.374 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 322354
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8290717601776123
Epoch: 1, Steps: 10 | Train Loss: 3.461 Vali Loss: 3.346 Vali Acc: 0.058 Test Loss: 3.346 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.9337754249572754
Epoch: 2, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.308 Vali Acc: 0.060 Test Loss: 3.308 Test Acc: 0.060
Validation loss decreased (-0.057614 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 1.297874927520752
Epoch: 3, Steps: 10 | Train Loss: 3.231 Vali Loss: 3.313 Vali Acc: 0.045 Test Loss: 3.313 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.180469036102295
Epoch: 4, Steps: 10 | Train Loss: 3.189 Vali Loss: 3.349 Vali Acc: 0.060 Test Loss: 3.349 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2373161315917969
Epoch: 5, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.344 Vali Acc: 0.062 Test Loss: 3.344 Test Acc: 0.062
Validation loss decreased (-0.059967 --> -0.062319).  Saving model ...
Epoch: 6 cost time: 1.1208593845367432
Epoch: 6, Steps: 10 | Train Loss: 3.110 Vali Loss: 3.321 Vali Acc: 0.061 Test Loss: 3.321 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1263244152069092
Epoch: 7, Steps: 10 | Train Loss: 3.034 Vali Loss: 3.297 Vali Acc: 0.067 Test Loss: 3.297 Test Acc: 0.067
Validation loss decreased (-0.062319 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 1.1117324829101562
Epoch: 8, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.290 Vali Acc: 0.078 Test Loss: 3.290 Test Acc: 0.078
Validation loss decreased (-0.067026 --> -0.077614).  Saving model ...
Epoch: 9 cost time: 0.9326004981994629
Epoch: 9, Steps: 10 | Train Loss: 2.879 Vali Loss: 3.253 Vali Acc: 0.080 Test Loss: 3.253 Test Acc: 0.080
Validation loss decreased (-0.077614 --> -0.079967).  Saving model ...
Epoch: 10 cost time: 1.0689072608947754
Epoch: 10, Steps: 10 | Train Loss: 2.806 Vali Loss: 3.268 Vali Acc: 0.082 Test Loss: 3.268 Test Acc: 0.082
Validation loss decreased (-0.079967 --> -0.082320).  Saving model ...
Epoch: 11 cost time: 0.9645414352416992
Epoch: 11, Steps: 10 | Train Loss: 2.677 Vali Loss: 3.249 Vali Acc: 0.098 Test Loss: 3.249 Test Acc: 0.098
Validation loss decreased (-0.082320 --> -0.097615).  Saving model ...
Epoch: 12 cost time: 0.9868030548095703
Epoch: 12, Steps: 10 | Train Loss: 2.621 Vali Loss: 3.250 Vali Acc: 0.100 Test Loss: 3.250 Test Acc: 0.100
Validation loss decreased (-0.097615 --> -0.099968).  Saving model ...
Epoch: 13 cost time: 0.934988260269165
Epoch: 13, Steps: 10 | Train Loss: 2.522 Vali Loss: 3.252 Vali Acc: 0.113 Test Loss: 3.252 Test Acc: 0.113
Validation loss decreased (-0.099968 --> -0.112909).  Saving model ...
Epoch: 14 cost time: 1.0211410522460938
Epoch: 14, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.238 Vali Acc: 0.111 Test Loss: 3.238 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9253132343292236
Epoch: 15, Steps: 10 | Train Loss: 2.281 Vali Loss: 3.235 Vali Acc: 0.132 Test Loss: 3.235 Test Acc: 0.132
Validation loss decreased (-0.112909 --> -0.131732).  Saving model ...
Epoch: 16 cost time: 1.2750060558319092
Epoch: 16, Steps: 10 | Train Loss: 2.141 Vali Loss: 3.214 Vali Acc: 0.140 Test Loss: 3.214 Test Acc: 0.140
Validation loss decreased (-0.131732 --> -0.139968).  Saving model ...
Epoch: 17 cost time: 0.9198215007781982
Epoch: 17, Steps: 10 | Train Loss: 2.001 Vali Loss: 3.232 Vali Acc: 0.146 Test Loss: 3.232 Test Acc: 0.146
Validation loss decreased (-0.139968 --> -0.145850).  Saving model ...
Epoch: 18 cost time: 0.8180944919586182
Epoch: 18, Steps: 10 | Train Loss: 1.925 Vali Loss: 3.241 Vali Acc: 0.165 Test Loss: 3.241 Test Acc: 0.165
Validation loss decreased (-0.145850 --> -0.164673).  Saving model ...
Epoch: 19 cost time: 1.0140306949615479
Epoch: 19, Steps: 10 | Train Loss: 1.730 Vali Loss: 3.257 Vali Acc: 0.159 Test Loss: 3.257 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0858840942382812
Epoch: 20, Steps: 10 | Train Loss: 1.636 Vali Loss: 3.255 Vali Acc: 0.176 Test Loss: 3.255 Test Acc: 0.176
Validation loss decreased (-0.164673 --> -0.176438).  Saving model ...
Epoch: 21 cost time: 1.1154348850250244
Epoch: 21, Steps: 10 | Train Loss: 1.581 Vali Loss: 3.255 Vali Acc: 0.185 Test Loss: 3.255 Test Acc: 0.185
Validation loss decreased (-0.176438 --> -0.184673).  Saving model ...
Epoch: 22 cost time: 1.0069992542266846
Epoch: 22, Steps: 10 | Train Loss: 1.409 Vali Loss: 3.292 Vali Acc: 0.192 Test Loss: 3.292 Test Acc: 0.192
Validation loss decreased (-0.184673 --> -0.191732).  Saving model ...
Epoch: 23 cost time: 0.9834179878234863
Epoch: 23, Steps: 10 | Train Loss: 1.266 Vali Loss: 3.306 Vali Acc: 0.189 Test Loss: 3.306 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8874521255493164
Epoch: 24, Steps: 10 | Train Loss: 1.216 Vali Loss: 3.347 Vali Acc: 0.191 Test Loss: 3.347 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9885687828063965
Epoch: 25, Steps: 10 | Train Loss: 1.071 Vali Loss: 3.314 Vali Acc: 0.193 Test Loss: 3.314 Test Acc: 0.193
Validation loss decreased (-0.191732 --> -0.192908).  Saving model ...
Epoch: 26 cost time: 1.036271572113037
Epoch: 26, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.336 Vali Acc: 0.211 Test Loss: 3.336 Test Acc: 0.211
Validation loss decreased (-0.192908 --> -0.210555).  Saving model ...
Epoch: 27 cost time: 1.110543966293335
Epoch: 27, Steps: 10 | Train Loss: 0.888 Vali Loss: 3.377 Vali Acc: 0.207 Test Loss: 3.377 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9253101348876953
Epoch: 28, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.405 Vali Acc: 0.207 Test Loss: 3.405 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9964654445648193
Epoch: 29, Steps: 10 | Train Loss: 0.755 Vali Loss: 3.425 Vali Acc: 0.216 Test Loss: 3.425 Test Acc: 0.216
Validation loss decreased (-0.210555 --> -0.216436).  Saving model ...
Epoch: 30 cost time: 0.9897336959838867
Epoch: 30, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.445 Vali Acc: 0.209 Test Loss: 3.445 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8819520473480225
Epoch: 31, Steps: 10 | Train Loss: 0.575 Vali Loss: 3.487 Vali Acc: 0.221 Test Loss: 3.487 Test Acc: 0.221
Validation loss decreased (-0.216436 --> -0.221142).  Saving model ...
Epoch: 32 cost time: 0.911566972732544
Epoch: 32, Steps: 10 | Train Loss: 0.503 Vali Loss: 3.513 Vali Acc: 0.216 Test Loss: 3.513 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2060704231262207
Epoch: 33, Steps: 10 | Train Loss: 0.442 Vali Loss: 3.522 Vali Acc: 0.225 Test Loss: 3.522 Test Acc: 0.225
Validation loss decreased (-0.221142 --> -0.224671).  Saving model ...
Epoch: 34 cost time: 1.0945510864257812
Epoch: 34, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.583 Vali Acc: 0.227 Test Loss: 3.583 Test Acc: 0.227
Validation loss decreased (-0.224671 --> -0.227023).  Saving model ...
Epoch: 35 cost time: 0.9219954013824463
Epoch: 35, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.615 Vali Acc: 0.231 Test Loss: 3.615 Test Acc: 0.231
Validation loss decreased (-0.227023 --> -0.230552).  Saving model ...
Epoch: 36 cost time: 0.8246681690216064
Epoch: 36, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.641 Vali Acc: 0.236 Test Loss: 3.641 Test Acc: 0.236
Validation loss decreased (-0.230552 --> -0.236434).  Saving model ...
Epoch: 37 cost time: 0.9139463901519775
Epoch: 37, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.676 Vali Acc: 0.233 Test Loss: 3.676 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3484110832214355
Epoch: 38, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.706 Vali Acc: 0.236 Test Loss: 3.706 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9080612659454346
Epoch: 39, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.752 Vali Acc: 0.238 Test Loss: 3.752 Test Acc: 0.238
Validation loss decreased (-0.236434 --> -0.237610).  Saving model ...
Epoch: 40 cost time: 0.9610190391540527
Epoch: 40, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.727 Vali Acc: 0.240 Test Loss: 3.727 Test Acc: 0.240
Validation loss decreased (-0.237610 --> -0.239963).  Saving model ...
Epoch: 41 cost time: 0.9234862327575684
Epoch: 41, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.779 Vali Acc: 0.226 Test Loss: 3.779 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9816896915435791
Epoch: 42, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.845 Vali Acc: 0.233 Test Loss: 3.845 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.186321496963501
Epoch: 43, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.868 Vali Acc: 0.244 Test Loss: 3.868 Test Acc: 0.244
Validation loss decreased (-0.239963 --> -0.243491).  Saving model ...
Epoch: 44 cost time: 1.2699193954467773
Epoch: 44, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.887 Vali Acc: 0.241 Test Loss: 3.887 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0655872821807861
Epoch: 45, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.924 Vali Acc: 0.239 Test Loss: 3.924 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1156892776489258
Epoch: 46, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.938 Vali Acc: 0.231 Test Loss: 3.938 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.09285569190979
Epoch: 47, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.954 Vali Acc: 0.239 Test Loss: 3.954 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0670208930969238
Epoch: 48, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.975 Vali Acc: 0.238 Test Loss: 3.975 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2646636962890625
Epoch: 49, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.994 Vali Acc: 0.241 Test Loss: 3.994 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.4842455387115479
Epoch: 50, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.001 Vali Acc: 0.244 Test Loss: 4.001 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.019604206085205
Epoch: 51, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.051 Vali Acc: 0.235 Test Loss: 4.051 Test Acc: 0.235
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.9384245872497559
Epoch: 52, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.073 Vali Acc: 0.246 Test Loss: 4.073 Test Acc: 0.246
Validation loss decreased (-0.243491 --> -0.245842).  Saving model ...
Epoch: 53 cost time: 0.9546113014221191
Epoch: 53, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.074 Vali Acc: 0.248 Test Loss: 4.074 Test Acc: 0.248
Validation loss decreased (-0.245842 --> -0.248195).  Saving model ...
Epoch: 54 cost time: 1.0070157051086426
Epoch: 54, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.082 Vali Acc: 0.251 Test Loss: 4.082 Test Acc: 0.251
Validation loss decreased (-0.248195 --> -0.250547).  Saving model ...
Epoch: 55 cost time: 0.8832738399505615
Epoch: 55, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.155 Vali Acc: 0.240 Test Loss: 4.155 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9335620403289795
Epoch: 56, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.160 Vali Acc: 0.238 Test Loss: 4.160 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9946298599243164
Epoch: 57, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.191 Vali Acc: 0.245 Test Loss: 4.191 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1543781757354736
Epoch: 58, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.152 Vali Acc: 0.247 Test Loss: 4.152 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8398776054382324
Epoch: 59, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.161 Vali Acc: 0.251 Test Loss: 4.161 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.0049583911895752
Epoch: 60, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.196 Vali Acc: 0.251 Test Loss: 4.196 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.8226726055145264
Epoch: 61, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.236 Vali Acc: 0.247 Test Loss: 4.236 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.1856327056884766
Epoch: 62, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.250 Vali Acc: 0.246 Test Loss: 4.250 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.0319054126739502
Epoch: 63, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.251 Vali Acc: 0.249 Test Loss: 4.251 Test Acc: 0.249
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.9676284790039062
Epoch: 64, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.293 Vali Acc: 0.247 Test Loss: 4.293 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25058823529411767
model parameter : 288210
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0488438606262207
Epoch: 1, Steps: 10 | Train Loss: 3.411 Vali Loss: 3.344 Vali Acc: 0.052 Test Loss: 3.344 Test Acc: 0.052
Validation loss decreased (inf --> -0.051731).  Saving model ...
Epoch: 2 cost time: 1.1423335075378418
Epoch: 2, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.313 Vali Acc: 0.039 Test Loss: 3.313 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.050795078277588
Epoch: 3, Steps: 10 | Train Loss: 3.154 Vali Loss: 3.346 Vali Acc: 0.039 Test Loss: 3.346 Test Acc: 0.039
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9950363636016846
Epoch: 4, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.367 Vali Acc: 0.044 Test Loss: 3.367 Test Acc: 0.044
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.076993703842163
Epoch: 5, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.357 Vali Acc: 0.044 Test Loss: 3.357 Test Acc: 0.044
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0297431945800781
Epoch: 6, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.322 Vali Acc: 0.052 Test Loss: 3.322 Test Acc: 0.052
Validation loss decreased (-0.051731 --> -0.051731).  Saving model ...
Epoch: 7 cost time: 0.9786694049835205
Epoch: 7, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.312 Vali Acc: 0.059 Test Loss: 3.312 Test Acc: 0.059
Validation loss decreased (-0.051731 --> -0.058790).  Saving model ...
Epoch: 8 cost time: 0.8012373447418213
Epoch: 8, Steps: 10 | Train Loss: 2.959 Vali Loss: 3.302 Vali Acc: 0.065 Test Loss: 3.302 Test Acc: 0.065
Validation loss decreased (-0.058790 --> -0.064673).  Saving model ...
Epoch: 9 cost time: 0.9544682502746582
Epoch: 9, Steps: 10 | Train Loss: 2.839 Vali Loss: 3.282 Vali Acc: 0.081 Test Loss: 3.282 Test Acc: 0.081
Validation loss decreased (-0.064673 --> -0.081144).  Saving model ...
Epoch: 10 cost time: 0.9807798862457275
Epoch: 10, Steps: 10 | Train Loss: 2.765 Vali Loss: 3.275 Vali Acc: 0.082 Test Loss: 3.275 Test Acc: 0.082
Validation loss decreased (-0.081144 --> -0.082320).  Saving model ...
Epoch: 11 cost time: 0.9814867973327637
Epoch: 11, Steps: 10 | Train Loss: 2.695 Vali Loss: 3.266 Vali Acc: 0.081 Test Loss: 3.266 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1483500003814697
Epoch: 12, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.277 Vali Acc: 0.076 Test Loss: 3.277 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0297222137451172
Epoch: 13, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.280 Vali Acc: 0.085 Test Loss: 3.280 Test Acc: 0.085
Validation loss decreased (-0.082320 --> -0.084673).  Saving model ...
Epoch: 14 cost time: 0.982680082321167
Epoch: 14, Steps: 10 | Train Loss: 2.363 Vali Loss: 3.260 Vali Acc: 0.104 Test Loss: 3.260 Test Acc: 0.104
Validation loss decreased (-0.084673 --> -0.103497).  Saving model ...
Epoch: 15 cost time: 0.9647252559661865
Epoch: 15, Steps: 10 | Train Loss: 2.244 Vali Loss: 3.260 Vali Acc: 0.124 Test Loss: 3.260 Test Acc: 0.124
Validation loss decreased (-0.103497 --> -0.123497).  Saving model ...
Epoch: 16 cost time: 1.0415115356445312
Epoch: 16, Steps: 10 | Train Loss: 2.086 Vali Loss: 3.264 Vali Acc: 0.124 Test Loss: 3.264 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9847500324249268
Epoch: 17, Steps: 10 | Train Loss: 2.000 Vali Loss: 3.268 Vali Acc: 0.136 Test Loss: 3.268 Test Acc: 0.136
Validation loss decreased (-0.123497 --> -0.136438).  Saving model ...
Epoch: 18 cost time: 1.0453248023986816
Epoch: 18, Steps: 10 | Train Loss: 1.864 Vali Loss: 3.270 Vali Acc: 0.153 Test Loss: 3.270 Test Acc: 0.153
Validation loss decreased (-0.136438 --> -0.152908).  Saving model ...
Epoch: 19 cost time: 1.0061609745025635
Epoch: 19, Steps: 10 | Train Loss: 1.732 Vali Loss: 3.276 Vali Acc: 0.162 Test Loss: 3.276 Test Acc: 0.162
Validation loss decreased (-0.152908 --> -0.162320).  Saving model ...
Epoch: 20 cost time: 1.020362377166748
Epoch: 20, Steps: 10 | Train Loss: 1.588 Vali Loss: 3.292 Vali Acc: 0.160 Test Loss: 3.292 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8901405334472656
Epoch: 21, Steps: 10 | Train Loss: 1.452 Vali Loss: 3.305 Vali Acc: 0.159 Test Loss: 3.305 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1164617538452148
Epoch: 22, Steps: 10 | Train Loss: 1.368 Vali Loss: 3.312 Vali Acc: 0.178 Test Loss: 3.312 Test Acc: 0.178
Validation loss decreased (-0.162320 --> -0.177614).  Saving model ...
Epoch: 23 cost time: 0.8675827980041504
Epoch: 23, Steps: 10 | Train Loss: 1.249 Vali Loss: 3.316 Vali Acc: 0.193 Test Loss: 3.316 Test Acc: 0.193
Validation loss decreased (-0.177614 --> -0.192908).  Saving model ...
Epoch: 24 cost time: 1.2300522327423096
Epoch: 24, Steps: 10 | Train Loss: 1.212 Vali Loss: 3.343 Vali Acc: 0.182 Test Loss: 3.343 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.221195936203003
Epoch: 25, Steps: 10 | Train Loss: 1.059 Vali Loss: 3.387 Vali Acc: 0.193 Test Loss: 3.387 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.255791425704956
Epoch: 26, Steps: 10 | Train Loss: 0.956 Vali Loss: 3.364 Vali Acc: 0.195 Test Loss: 3.364 Test Acc: 0.195
Validation loss decreased (-0.192908 --> -0.195260).  Saving model ...
Epoch: 27 cost time: 0.9526176452636719
Epoch: 27, Steps: 10 | Train Loss: 0.868 Vali Loss: 3.442 Vali Acc: 0.207 Test Loss: 3.442 Test Acc: 0.207
Validation loss decreased (-0.195260 --> -0.207024).  Saving model ...
Epoch: 28 cost time: 1.2674012184143066
Epoch: 28, Steps: 10 | Train Loss: 0.788 Vali Loss: 3.424 Vali Acc: 0.211 Test Loss: 3.424 Test Acc: 0.211
Validation loss decreased (-0.207024 --> -0.210554).  Saving model ...
Epoch: 29 cost time: 0.8120057582855225
Epoch: 29, Steps: 10 | Train Loss: 0.711 Vali Loss: 3.453 Vali Acc: 0.218 Test Loss: 3.453 Test Acc: 0.218
Validation loss decreased (-0.210554 --> -0.217613).  Saving model ...
Epoch: 30 cost time: 0.9415068626403809
Epoch: 30, Steps: 10 | Train Loss: 0.641 Vali Loss: 3.505 Vali Acc: 0.214 Test Loss: 3.505 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0354366302490234
Epoch: 31, Steps: 10 | Train Loss: 0.545 Vali Loss: 3.566 Vali Acc: 0.206 Test Loss: 3.566 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.195554494857788
Epoch: 32, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.535 Vali Acc: 0.218 Test Loss: 3.535 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9031219482421875
Epoch: 33, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.587 Vali Acc: 0.224 Test Loss: 3.587 Test Acc: 0.224
Validation loss decreased (-0.217613 --> -0.223494).  Saving model ...
Epoch: 34 cost time: 1.179069995880127
Epoch: 34, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.672 Vali Acc: 0.215 Test Loss: 3.672 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9966142177581787
Epoch: 35, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.656 Vali Acc: 0.224 Test Loss: 3.656 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0892696380615234
Epoch: 36, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.715 Vali Acc: 0.212 Test Loss: 3.715 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0111496448516846
Epoch: 37, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.752 Vali Acc: 0.222 Test Loss: 3.752 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0826938152313232
Epoch: 38, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.802 Vali Acc: 0.220 Test Loss: 3.802 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0396273136138916
Epoch: 39, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.821 Vali Acc: 0.219 Test Loss: 3.821 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.159261703491211
Epoch: 40, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.832 Vali Acc: 0.228 Test Loss: 3.832 Test Acc: 0.228
Validation loss decreased (-0.223494 --> -0.228197).  Saving model ...
Epoch: 41 cost time: 1.1586675643920898
Epoch: 41, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.931 Vali Acc: 0.225 Test Loss: 3.931 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0125205516815186
Epoch: 42, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.859 Vali Acc: 0.238 Test Loss: 3.859 Test Acc: 0.238
Validation loss decreased (-0.228197 --> -0.237608).  Saving model ...
Epoch: 43 cost time: 0.9904592037200928
Epoch: 43, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.925 Vali Acc: 0.236 Test Loss: 3.925 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0855519771575928
Epoch: 44, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.987 Vali Acc: 0.234 Test Loss: 3.987 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0885400772094727
Epoch: 45, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.963 Vali Acc: 0.236 Test Loss: 3.963 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0789868831634521
Epoch: 46, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.986 Vali Acc: 0.239 Test Loss: 3.986 Test Acc: 0.239
Validation loss decreased (-0.237608 --> -0.238784).  Saving model ...
Epoch: 47 cost time: 1.1254746913909912
Epoch: 47, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.012 Vali Acc: 0.232 Test Loss: 4.012 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1505992412567139
Epoch: 48, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.097 Vali Acc: 0.233 Test Loss: 4.097 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1567373275756836
Epoch: 49, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.050 Vali Acc: 0.241 Test Loss: 4.050 Test Acc: 0.241
Validation loss decreased (-0.238784 --> -0.241136).  Saving model ...
Epoch: 50 cost time: 1.0910334587097168
Epoch: 50, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.099 Vali Acc: 0.232 Test Loss: 4.099 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0121283531188965
Epoch: 51, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.096 Vali Acc: 0.245 Test Loss: 4.096 Test Acc: 0.245
Validation loss decreased (-0.241136 --> -0.244665).  Saving model ...
Epoch: 52 cost time: 1.1055195331573486
Epoch: 52, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.117 Vali Acc: 0.236 Test Loss: 4.117 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.138474941253662
Epoch: 53, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.144 Vali Acc: 0.239 Test Loss: 4.144 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9867730140686035
Epoch: 54, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.155 Vali Acc: 0.236 Test Loss: 4.155 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.0080180168151855
Epoch: 55, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.140 Vali Acc: 0.240 Test Loss: 4.140 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.1092348098754883
Epoch: 56, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.192 Vali Acc: 0.241 Test Loss: 4.192 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.9482965469360352
Epoch: 57, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.214 Vali Acc: 0.234 Test Loss: 4.214 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.0113146305084229
Epoch: 58, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.237 Vali Acc: 0.246 Test Loss: 4.237 Test Acc: 0.246
Validation loss decreased (-0.244665 --> -0.245840).  Saving model ...
Epoch: 59 cost time: 1.2479798793792725
Epoch: 59, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.248 Vali Acc: 0.244 Test Loss: 4.248 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.088447093963623
Epoch: 60, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.257 Vali Acc: 0.242 Test Loss: 4.257 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1099905967712402
Epoch: 61, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.262 Vali Acc: 0.240 Test Loss: 4.262 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.8954291343688965
Epoch: 62, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.278 Vali Acc: 0.248 Test Loss: 4.278 Test Acc: 0.248
Validation loss decreased (-0.245840 --> -0.248193).  Saving model ...
Epoch: 63 cost time: 0.8759486675262451
Epoch: 63, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.304 Vali Acc: 0.246 Test Loss: 4.304 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.0386161804199219
Epoch: 64, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.320 Vali Acc: 0.244 Test Loss: 4.320 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.9845423698425293
Epoch: 65, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.353 Vali Acc: 0.244 Test Loss: 4.353 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.9681508541107178
Epoch: 66, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.383 Vali Acc: 0.242 Test Loss: 4.383 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.9757084846496582
Epoch: 67, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.390 Vali Acc: 0.242 Test Loss: 4.390 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.2988483905792236
Epoch: 68, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.369 Vali Acc: 0.241 Test Loss: 4.369 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.9814655780792236
Epoch: 69, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.381 Vali Acc: 0.249 Test Loss: 4.381 Test Acc: 0.249
Validation loss decreased (-0.248193 --> -0.249368).  Saving model ...
Epoch: 70 cost time: 1.0318458080291748
Epoch: 70, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.369 Vali Acc: 0.248 Test Loss: 4.369 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.1222164630889893
Epoch: 71, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.420 Vali Acc: 0.246 Test Loss: 4.420 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.288654088973999
Epoch: 72, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.444 Vali Acc: 0.249 Test Loss: 4.444 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.2091033458709717
Epoch: 73, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.444 Vali Acc: 0.245 Test Loss: 4.444 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.2316699028015137
Epoch: 74, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.486 Vali Acc: 0.240 Test Loss: 4.486 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.9939861297607422
Epoch: 75, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.477 Vali Acc: 0.252 Test Loss: 4.477 Test Acc: 0.252
Validation loss decreased (-0.249368 --> -0.251720).  Saving model ...
Epoch: 76 cost time: 1.0168278217315674
Epoch: 76, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.481 Vali Acc: 0.252 Test Loss: 4.481 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.9982843399047852
Epoch: 77, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.489 Vali Acc: 0.249 Test Loss: 4.489 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.8928496837615967
Epoch: 78, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.483 Vali Acc: 0.252 Test Loss: 4.483 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.9090414047241211
Epoch: 79, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.517 Vali Acc: 0.251 Test Loss: 4.517 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.1413538455963135
Epoch: 80, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.536 Vali Acc: 0.247 Test Loss: 4.536 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.0028493404388428
Epoch: 81, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.527 Vali Acc: 0.246 Test Loss: 4.527 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 1.0380008220672607
Epoch: 82, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.525 Vali Acc: 0.247 Test Loss: 4.525 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.9754269123077393
Epoch: 83, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.564 Vali Acc: 0.247 Test Loss: 4.564 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 1.0235114097595215
Epoch: 84, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.605 Vali Acc: 0.248 Test Loss: 4.605 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 1.0617012977600098
Epoch: 85, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.582 Vali Acc: 0.251 Test Loss: 4.582 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25176470588235295
model parameter : 287794
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7229630947113037
Epoch: 1, Steps: 10 | Train Loss: 3.484 Vali Loss: 3.417 Vali Acc: 0.024 Test Loss: 3.417 Test Acc: 0.024
Validation loss decreased (inf --> -0.023495).  Saving model ...
Epoch: 2 cost time: 1.0376384258270264
Epoch: 2, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.336 Vali Acc: 0.035 Test Loss: 3.336 Test Acc: 0.035
Validation loss decreased (-0.023495 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.8622894287109375
Epoch: 3, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.334 Vali Acc: 0.051 Test Loss: 3.334 Test Acc: 0.051
Validation loss decreased (-0.035261 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 1.089263916015625
Epoch: 4, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.358 Vali Acc: 0.035 Test Loss: 3.358 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9588234424591064
Epoch: 5, Steps: 10 | Train Loss: 3.143 Vali Loss: 3.351 Vali Acc: 0.058 Test Loss: 3.351 Test Acc: 0.058
Validation loss decreased (-0.050555 --> -0.057614).  Saving model ...
Epoch: 6 cost time: 0.8924829959869385
Epoch: 6, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.327 Vali Acc: 0.060 Test Loss: 3.327 Test Acc: 0.060
Validation loss decreased (-0.057614 --> -0.059967).  Saving model ...
Epoch: 7 cost time: 0.8722407817840576
Epoch: 7, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.311 Vali Acc: 0.075 Test Loss: 3.311 Test Acc: 0.075
Validation loss decreased (-0.059967 --> -0.075261).  Saving model ...
Epoch: 8 cost time: 1.100689172744751
Epoch: 8, Steps: 10 | Train Loss: 2.960 Vali Loss: 3.297 Vali Acc: 0.075 Test Loss: 3.297 Test Acc: 0.075
Validation loss decreased (-0.075261 --> -0.075261).  Saving model ...
Epoch: 9 cost time: 1.151505947113037
Epoch: 9, Steps: 10 | Train Loss: 2.894 Vali Loss: 3.280 Vali Acc: 0.067 Test Loss: 3.280 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1447131633758545
Epoch: 10, Steps: 10 | Train Loss: 2.815 Vali Loss: 3.278 Vali Acc: 0.086 Test Loss: 3.278 Test Acc: 0.086
Validation loss decreased (-0.075261 --> -0.085850).  Saving model ...
Epoch: 11 cost time: 0.7467596530914307
Epoch: 11, Steps: 10 | Train Loss: 2.720 Vali Loss: 3.282 Vali Acc: 0.093 Test Loss: 3.282 Test Acc: 0.093
Validation loss decreased (-0.085850 --> -0.092908).  Saving model ...
Epoch: 12 cost time: 0.8674750328063965
Epoch: 12, Steps: 10 | Train Loss: 2.566 Vali Loss: 3.268 Vali Acc: 0.086 Test Loss: 3.268 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0954084396362305
Epoch: 13, Steps: 10 | Train Loss: 2.489 Vali Loss: 3.237 Vali Acc: 0.113 Test Loss: 3.237 Test Acc: 0.113
Validation loss decreased (-0.092908 --> -0.112909).  Saving model ...
Epoch: 14 cost time: 1.0975501537322998
Epoch: 14, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.246 Vali Acc: 0.119 Test Loss: 3.246 Test Acc: 0.119
Validation loss decreased (-0.112909 --> -0.118791).  Saving model ...
Epoch: 15 cost time: 1.0304784774780273
Epoch: 15, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.266 Vali Acc: 0.114 Test Loss: 3.266 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8950693607330322
Epoch: 16, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.241 Vali Acc: 0.132 Test Loss: 3.241 Test Acc: 0.132
Validation loss decreased (-0.118791 --> -0.131732).  Saving model ...
Epoch: 17 cost time: 1.0275468826293945
Epoch: 17, Steps: 10 | Train Loss: 1.993 Vali Loss: 3.239 Vali Acc: 0.141 Test Loss: 3.239 Test Acc: 0.141
Validation loss decreased (-0.131732 --> -0.141144).  Saving model ...
Epoch: 18 cost time: 1.1149988174438477
Epoch: 18, Steps: 10 | Train Loss: 1.825 Vali Loss: 3.261 Vali Acc: 0.136 Test Loss: 3.261 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.079820156097412
Epoch: 19, Steps: 10 | Train Loss: 1.723 Vali Loss: 3.261 Vali Acc: 0.174 Test Loss: 3.261 Test Acc: 0.174
Validation loss decreased (-0.141144 --> -0.174085).  Saving model ...
Epoch: 20 cost time: 0.9653825759887695
Epoch: 20, Steps: 10 | Train Loss: 1.626 Vali Loss: 3.273 Vali Acc: 0.173 Test Loss: 3.273 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9817111492156982
Epoch: 21, Steps: 10 | Train Loss: 1.472 Vali Loss: 3.276 Vali Acc: 0.180 Test Loss: 3.276 Test Acc: 0.180
Validation loss decreased (-0.174085 --> -0.179967).  Saving model ...
Epoch: 22 cost time: 0.8619005680084229
Epoch: 22, Steps: 10 | Train Loss: 1.352 Vali Loss: 3.273 Vali Acc: 0.187 Test Loss: 3.273 Test Acc: 0.187
Validation loss decreased (-0.179967 --> -0.187026).  Saving model ...
Epoch: 23 cost time: 1.0146136283874512
Epoch: 23, Steps: 10 | Train Loss: 1.212 Vali Loss: 3.305 Vali Acc: 0.194 Test Loss: 3.305 Test Acc: 0.194
Validation loss decreased (-0.187026 --> -0.194085).  Saving model ...
Epoch: 24 cost time: 1.0364878177642822
Epoch: 24, Steps: 10 | Train Loss: 1.172 Vali Loss: 3.347 Vali Acc: 0.189 Test Loss: 3.347 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8710184097290039
Epoch: 25, Steps: 10 | Train Loss: 1.008 Vali Loss: 3.334 Vali Acc: 0.208 Test Loss: 3.334 Test Acc: 0.208
Validation loss decreased (-0.194085 --> -0.208202).  Saving model ...
Epoch: 26 cost time: 0.9005351066589355
Epoch: 26, Steps: 10 | Train Loss: 0.938 Vali Loss: 3.354 Vali Acc: 0.195 Test Loss: 3.354 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9989190101623535
Epoch: 27, Steps: 10 | Train Loss: 0.837 Vali Loss: 3.380 Vali Acc: 0.214 Test Loss: 3.380 Test Acc: 0.214
Validation loss decreased (-0.208202 --> -0.214084).  Saving model ...
Epoch: 28 cost time: 0.9817836284637451
Epoch: 28, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.379 Vali Acc: 0.205 Test Loss: 3.379 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8724846839904785
Epoch: 29, Steps: 10 | Train Loss: 0.714 Vali Loss: 3.434 Vali Acc: 0.206 Test Loss: 3.434 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8277268409729004
Epoch: 30, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.485 Vali Acc: 0.216 Test Loss: 3.485 Test Acc: 0.216
Validation loss decreased (-0.214084 --> -0.216436).  Saving model ...
Epoch: 31 cost time: 0.9246337413787842
Epoch: 31, Steps: 10 | Train Loss: 0.524 Vali Loss: 3.511 Vali Acc: 0.209 Test Loss: 3.511 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.86623215675354
Epoch: 32, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.544 Vali Acc: 0.215 Test Loss: 3.544 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9040765762329102
Epoch: 33, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.550 Vali Acc: 0.232 Test Loss: 3.550 Test Acc: 0.232
Validation loss decreased (-0.216436 --> -0.231729).  Saving model ...
Epoch: 34 cost time: 0.9913251399993896
Epoch: 34, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.616 Vali Acc: 0.218 Test Loss: 3.616 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9252452850341797
Epoch: 35, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.628 Vali Acc: 0.222 Test Loss: 3.628 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.003399133682251
Epoch: 36, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.694 Vali Acc: 0.228 Test Loss: 3.694 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8558905124664307
Epoch: 37, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.719 Vali Acc: 0.231 Test Loss: 3.719 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9893128871917725
Epoch: 38, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.734 Vali Acc: 0.235 Test Loss: 3.734 Test Acc: 0.235
Validation loss decreased (-0.231729 --> -0.235257).  Saving model ...
Epoch: 39 cost time: 0.8580904006958008
Epoch: 39, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.764 Vali Acc: 0.229 Test Loss: 3.764 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9600768089294434
Epoch: 40, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.812 Vali Acc: 0.235 Test Loss: 3.812 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7311909198760986
Epoch: 41, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.861 Vali Acc: 0.235 Test Loss: 3.861 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8052971363067627
Epoch: 42, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.835 Vali Acc: 0.236 Test Loss: 3.835 Test Acc: 0.236
Validation loss decreased (-0.235257 --> -0.236432).  Saving model ...
Epoch: 43 cost time: 1.0066516399383545
Epoch: 43, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.916 Vali Acc: 0.225 Test Loss: 3.916 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9987432956695557
Epoch: 44, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.902 Vali Acc: 0.236 Test Loss: 3.902 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8361115455627441
Epoch: 45, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.968 Vali Acc: 0.238 Test Loss: 3.968 Test Acc: 0.238
Validation loss decreased (-0.236432 --> -0.237607).  Saving model ...
Epoch: 46 cost time: 0.8685321807861328
Epoch: 46, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.959 Vali Acc: 0.244 Test Loss: 3.959 Test Acc: 0.244
Validation loss decreased (-0.237607 --> -0.243490).  Saving model ...
Epoch: 47 cost time: 0.9744243621826172
Epoch: 47, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.988 Vali Acc: 0.244 Test Loss: 3.988 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9296035766601562
Epoch: 48, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.001 Vali Acc: 0.234 Test Loss: 4.001 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7712984085083008
Epoch: 49, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.045 Vali Acc: 0.241 Test Loss: 4.045 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9310576915740967
Epoch: 50, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.052 Vali Acc: 0.246 Test Loss: 4.052 Test Acc: 0.246
Validation loss decreased (-0.243490 --> -0.245842).  Saving model ...
Epoch: 51 cost time: 1.0113003253936768
Epoch: 51, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.074 Vali Acc: 0.240 Test Loss: 4.074 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8849689960479736
Epoch: 52, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.101 Vali Acc: 0.241 Test Loss: 4.101 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0610442161560059
Epoch: 53, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.083 Vali Acc: 0.232 Test Loss: 4.083 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8682608604431152
Epoch: 54, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.103 Vali Acc: 0.246 Test Loss: 4.103 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.3542420864105225
Epoch: 55, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.139 Vali Acc: 0.245 Test Loss: 4.139 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.3163881301879883
Epoch: 56, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.168 Vali Acc: 0.245 Test Loss: 4.168 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.218712568283081
Epoch: 57, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.221 Vali Acc: 0.245 Test Loss: 4.221 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.9367649555206299
Epoch: 58, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.197 Vali Acc: 0.245 Test Loss: 4.197 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.9650306701660156
Epoch: 59, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.211 Vali Acc: 0.248 Test Loss: 4.211 Test Acc: 0.248
Validation loss decreased (-0.245842 --> -0.248193).  Saving model ...
Epoch: 60 cost time: 0.8946201801300049
Epoch: 60, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.224 Vali Acc: 0.242 Test Loss: 4.224 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9619638919830322
Epoch: 61, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.254 Vali Acc: 0.248 Test Loss: 4.254 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9084677696228027
Epoch: 62, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.264 Vali Acc: 0.249 Test Loss: 4.264 Test Acc: 0.249
Validation loss decreased (-0.248193 --> -0.249369).  Saving model ...
Epoch: 63 cost time: 0.9897208213806152
Epoch: 63, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.286 Vali Acc: 0.251 Test Loss: 4.286 Test Acc: 0.251
Validation loss decreased (-0.249369 --> -0.250545).  Saving model ...
Epoch: 64 cost time: 1.2542304992675781
Epoch: 64, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.339 Vali Acc: 0.246 Test Loss: 4.339 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.069765329360962
Epoch: 65, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.326 Vali Acc: 0.253 Test Loss: 4.326 Test Acc: 0.253
Validation loss decreased (-0.250545 --> -0.252898).  Saving model ...
Epoch: 66 cost time: 0.9911031723022461
Epoch: 66, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.315 Vali Acc: 0.249 Test Loss: 4.315 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0510456562042236
Epoch: 67, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.334 Vali Acc: 0.253 Test Loss: 4.334 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.205533504486084
Epoch: 68, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.354 Vali Acc: 0.252 Test Loss: 4.354 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9833364486694336
Epoch: 69, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.358 Vali Acc: 0.246 Test Loss: 4.358 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.9257049560546875
Epoch: 70, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.423 Vali Acc: 0.247 Test Loss: 4.423 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.8454251289367676
Epoch: 71, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.423 Vali Acc: 0.247 Test Loss: 4.423 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.0548937320709229
Epoch: 72, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.404 Vali Acc: 0.246 Test Loss: 4.404 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.3056745529174805
Epoch: 73, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.412 Vali Acc: 0.244 Test Loss: 4.412 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.2195088863372803
Epoch: 74, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.447 Vali Acc: 0.247 Test Loss: 4.447 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.304194450378418
Epoch: 75, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.445 Vali Acc: 0.253 Test Loss: 4.445 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 287378
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.792454242706299
Epoch: 1, Steps: 10 | Train Loss: 3.547 Vali Loss: 3.354 Vali Acc: 0.051 Test Loss: 3.354 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.0680718421936035
Epoch: 2, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.309 Vali Acc: 0.035 Test Loss: 3.309 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2548491954803467
Epoch: 3, Steps: 10 | Train Loss: 3.267 Vali Loss: 3.338 Vali Acc: 0.042 Test Loss: 3.338 Test Acc: 0.042
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0968353748321533
Epoch: 4, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.360 Vali Acc: 0.041 Test Loss: 3.360 Test Acc: 0.041
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0066180229187012
Epoch: 5, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.356 Vali Acc: 0.046 Test Loss: 3.356 Test Acc: 0.046
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1225640773773193
Epoch: 6, Steps: 10 | Train Loss: 3.105 Vali Loss: 3.315 Vali Acc: 0.053 Test Loss: 3.315 Test Acc: 0.053
Validation loss decreased (-0.050555 --> -0.052908).  Saving model ...
Epoch: 7 cost time: 1.1472320556640625
Epoch: 7, Steps: 10 | Train Loss: 3.008 Vali Loss: 3.305 Vali Acc: 0.068 Test Loss: 3.305 Test Acc: 0.068
Validation loss decreased (-0.052908 --> -0.068202).  Saving model ...
Epoch: 8 cost time: 0.995448112487793
Epoch: 8, Steps: 10 | Train Loss: 2.971 Vali Loss: 3.302 Vali Acc: 0.065 Test Loss: 3.302 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1221680641174316
Epoch: 9, Steps: 10 | Train Loss: 2.906 Vali Loss: 3.274 Vali Acc: 0.091 Test Loss: 3.274 Test Acc: 0.091
Validation loss decreased (-0.068202 --> -0.090555).  Saving model ...
Epoch: 10 cost time: 1.1581408977508545
Epoch: 10, Steps: 10 | Train Loss: 2.754 Vali Loss: 3.277 Vali Acc: 0.094 Test Loss: 3.277 Test Acc: 0.094
Validation loss decreased (-0.090555 --> -0.094085).  Saving model ...
Epoch: 11 cost time: 0.9529900550842285
Epoch: 11, Steps: 10 | Train Loss: 2.635 Vali Loss: 3.282 Vali Acc: 0.098 Test Loss: 3.282 Test Acc: 0.098
Validation loss decreased (-0.094085 --> -0.097614).  Saving model ...
Epoch: 12 cost time: 0.851538896560669
Epoch: 12, Steps: 10 | Train Loss: 2.571 Vali Loss: 3.249 Vali Acc: 0.099 Test Loss: 3.249 Test Acc: 0.099
Validation loss decreased (-0.097614 --> -0.098791).  Saving model ...
Epoch: 13 cost time: 1.0383470058441162
Epoch: 13, Steps: 10 | Train Loss: 2.504 Vali Loss: 3.227 Vali Acc: 0.107 Test Loss: 3.227 Test Acc: 0.107
Validation loss decreased (-0.098791 --> -0.107027).  Saving model ...
Epoch: 14 cost time: 1.2237591743469238
Epoch: 14, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.250 Vali Acc: 0.114 Test Loss: 3.250 Test Acc: 0.114
Validation loss decreased (-0.107027 --> -0.114085).  Saving model ...
Epoch: 15 cost time: 1.0072801113128662
Epoch: 15, Steps: 10 | Train Loss: 2.199 Vali Loss: 3.253 Vali Acc: 0.138 Test Loss: 3.253 Test Acc: 0.138
Validation loss decreased (-0.114085 --> -0.137615).  Saving model ...
Epoch: 16 cost time: 1.0741517543792725
Epoch: 16, Steps: 10 | Train Loss: 2.045 Vali Loss: 3.248 Vali Acc: 0.138 Test Loss: 3.248 Test Acc: 0.138
Validation loss decreased (-0.137615 --> -0.137615).  Saving model ...
Epoch: 17 cost time: 1.0922737121582031
Epoch: 17, Steps: 10 | Train Loss: 1.977 Vali Loss: 3.253 Vali Acc: 0.138 Test Loss: 3.253 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2017796039581299
Epoch: 18, Steps: 10 | Train Loss: 1.840 Vali Loss: 3.272 Vali Acc: 0.154 Test Loss: 3.272 Test Acc: 0.154
Validation loss decreased (-0.137615 --> -0.154085).  Saving model ...
Epoch: 19 cost time: 0.9338839054107666
Epoch: 19, Steps: 10 | Train Loss: 1.748 Vali Loss: 3.277 Vali Acc: 0.156 Test Loss: 3.277 Test Acc: 0.156
Validation loss decreased (-0.154085 --> -0.156438).  Saving model ...
Epoch: 20 cost time: 1.0952966213226318
Epoch: 20, Steps: 10 | Train Loss: 1.542 Vali Loss: 3.270 Vali Acc: 0.178 Test Loss: 3.270 Test Acc: 0.178
Validation loss decreased (-0.156438 --> -0.177614).  Saving model ...
Epoch: 21 cost time: 1.0312914848327637
Epoch: 21, Steps: 10 | Train Loss: 1.484 Vali Loss: 3.305 Vali Acc: 0.176 Test Loss: 3.305 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0258476734161377
Epoch: 22, Steps: 10 | Train Loss: 1.327 Vali Loss: 3.317 Vali Acc: 0.188 Test Loss: 3.317 Test Acc: 0.188
Validation loss decreased (-0.177614 --> -0.188202).  Saving model ...
Epoch: 23 cost time: 1.1760289669036865
Epoch: 23, Steps: 10 | Train Loss: 1.268 Vali Loss: 3.334 Vali Acc: 0.180 Test Loss: 3.334 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1124143600463867
Epoch: 24, Steps: 10 | Train Loss: 1.115 Vali Loss: 3.346 Vali Acc: 0.193 Test Loss: 3.346 Test Acc: 0.193
Validation loss decreased (-0.188202 --> -0.192908).  Saving model ...
Epoch: 25 cost time: 1.0075833797454834
Epoch: 25, Steps: 10 | Train Loss: 1.016 Vali Loss: 3.360 Vali Acc: 0.200 Test Loss: 3.360 Test Acc: 0.200
Validation loss decreased (-0.192908 --> -0.199966).  Saving model ...
Epoch: 26 cost time: 1.1285340785980225
Epoch: 26, Steps: 10 | Train Loss: 0.943 Vali Loss: 3.373 Vali Acc: 0.202 Test Loss: 3.373 Test Acc: 0.202
Validation loss decreased (-0.199966 --> -0.202319).  Saving model ...
Epoch: 27 cost time: 1.0108904838562012
Epoch: 27, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.400 Vali Acc: 0.220 Test Loss: 3.400 Test Acc: 0.220
Validation loss decreased (-0.202319 --> -0.219966).  Saving model ...
Epoch: 28 cost time: 0.9924514293670654
Epoch: 28, Steps: 10 | Train Loss: 0.766 Vali Loss: 3.430 Vali Acc: 0.218 Test Loss: 3.430 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.140946865081787
Epoch: 29, Steps: 10 | Train Loss: 0.707 Vali Loss: 3.463 Vali Acc: 0.208 Test Loss: 3.463 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9000239372253418
Epoch: 30, Steps: 10 | Train Loss: 0.589 Vali Loss: 3.505 Vali Acc: 0.219 Test Loss: 3.505 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.116551160812378
Epoch: 31, Steps: 10 | Train Loss: 0.556 Vali Loss: 3.523 Vali Acc: 0.211 Test Loss: 3.523 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0955467224121094
Epoch: 32, Steps: 10 | Train Loss: 0.459 Vali Loss: 3.521 Vali Acc: 0.229 Test Loss: 3.521 Test Acc: 0.229
Validation loss decreased (-0.219966 --> -0.229377).  Saving model ...
Epoch: 33 cost time: 0.8685064315795898
Epoch: 33, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.603 Vali Acc: 0.226 Test Loss: 3.603 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.149421215057373
Epoch: 34, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.658 Vali Acc: 0.218 Test Loss: 3.658 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3043344020843506
Epoch: 35, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.656 Vali Acc: 0.234 Test Loss: 3.656 Test Acc: 0.234
Validation loss decreased (-0.229377 --> -0.234081).  Saving model ...
Epoch: 36 cost time: 0.8331270217895508
Epoch: 36, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.752 Vali Acc: 0.222 Test Loss: 3.752 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8383321762084961
Epoch: 37, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.722 Vali Acc: 0.229 Test Loss: 3.722 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9278249740600586
Epoch: 38, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.786 Vali Acc: 0.229 Test Loss: 3.786 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9696211814880371
Epoch: 39, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.787 Vali Acc: 0.222 Test Loss: 3.787 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9514815807342529
Epoch: 40, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.878 Vali Acc: 0.233 Test Loss: 3.878 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8715057373046875
Epoch: 41, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.877 Vali Acc: 0.222 Test Loss: 3.877 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0722861289978027
Epoch: 42, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.901 Vali Acc: 0.232 Test Loss: 3.901 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1260497570037842
Epoch: 43, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.921 Vali Acc: 0.229 Test Loss: 3.921 Test Acc: 0.229
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0882532596588135
Epoch: 44, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.952 Vali Acc: 0.242 Test Loss: 3.952 Test Acc: 0.242
Validation loss decreased (-0.234081 --> -0.242313).  Saving model ...
Epoch: 45 cost time: 1.1317262649536133
Epoch: 45, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.946 Vali Acc: 0.233 Test Loss: 3.946 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.236276388168335
Epoch: 46, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.966 Vali Acc: 0.239 Test Loss: 3.966 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9877080917358398
Epoch: 47, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.032 Vali Acc: 0.241 Test Loss: 4.032 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7935633659362793
Epoch: 48, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.001 Vali Acc: 0.239 Test Loss: 4.001 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9978475570678711
Epoch: 49, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.036 Vali Acc: 0.241 Test Loss: 4.036 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0306344032287598
Epoch: 50, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.096 Vali Acc: 0.241 Test Loss: 4.096 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.9805171489715576
Epoch: 51, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.115 Vali Acc: 0.239 Test Loss: 4.115 Test Acc: 0.239
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.9186742305755615
Epoch: 52, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.150 Vali Acc: 0.232 Test Loss: 4.150 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.9012720584869385
Epoch: 53, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.169 Vali Acc: 0.222 Test Loss: 4.169 Test Acc: 0.222
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.9644575119018555
Epoch: 54, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.218 Vali Acc: 0.233 Test Loss: 4.218 Test Acc: 0.233
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24235294117647058
model parameter : 286962
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.3425986766815186
Epoch: 1, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.342 Vali Acc: 0.041 Test Loss: 3.342 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.9290180206298828
Epoch: 2, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.312 Vali Acc: 0.036 Test Loss: 3.312 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9693403244018555
Epoch: 3, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.319 Vali Acc: 0.047 Test Loss: 3.319 Test Acc: 0.047
Validation loss decreased (-0.041143 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 1.0855343341827393
Epoch: 4, Steps: 10 | Train Loss: 3.098 Vali Loss: 3.345 Vali Acc: 0.055 Test Loss: 3.345 Test Acc: 0.055
Validation loss decreased (-0.047026 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 0.858055830001831
Epoch: 5, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.343 Vali Acc: 0.060 Test Loss: 3.343 Test Acc: 0.060
Validation loss decreased (-0.055261 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 1.1150667667388916
Epoch: 6, Steps: 10 | Train Loss: 3.032 Vali Loss: 3.312 Vali Acc: 0.047 Test Loss: 3.312 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.09718918800354
Epoch: 7, Steps: 10 | Train Loss: 2.967 Vali Loss: 3.295 Vali Acc: 0.066 Test Loss: 3.295 Test Acc: 0.066
Validation loss decreased (-0.059967 --> -0.065849).  Saving model ...
Epoch: 8 cost time: 1.0497205257415771
Epoch: 8, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.284 Vali Acc: 0.093 Test Loss: 3.284 Test Acc: 0.093
Validation loss decreased (-0.065849 --> -0.092908).  Saving model ...
Epoch: 9 cost time: 0.8880877494812012
Epoch: 9, Steps: 10 | Train Loss: 2.832 Vali Loss: 3.289 Vali Acc: 0.089 Test Loss: 3.289 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1575300693511963
Epoch: 10, Steps: 10 | Train Loss: 2.735 Vali Loss: 3.267 Vali Acc: 0.099 Test Loss: 3.267 Test Acc: 0.099
Validation loss decreased (-0.092908 --> -0.098791).  Saving model ...
Epoch: 11 cost time: 1.0840601921081543
Epoch: 11, Steps: 10 | Train Loss: 2.655 Vali Loss: 3.251 Vali Acc: 0.112 Test Loss: 3.251 Test Acc: 0.112
Validation loss decreased (-0.098791 --> -0.111732).  Saving model ...
Epoch: 12 cost time: 0.9814088344573975
Epoch: 12, Steps: 10 | Train Loss: 2.569 Vali Loss: 3.246 Vali Acc: 0.108 Test Loss: 3.246 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0693793296813965
Epoch: 13, Steps: 10 | Train Loss: 2.482 Vali Loss: 3.242 Vali Acc: 0.115 Test Loss: 3.242 Test Acc: 0.115
Validation loss decreased (-0.111732 --> -0.115262).  Saving model ...
Epoch: 14 cost time: 1.1363747119903564
Epoch: 14, Steps: 10 | Train Loss: 2.360 Vali Loss: 3.258 Vali Acc: 0.111 Test Loss: 3.258 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0246944427490234
Epoch: 15, Steps: 10 | Train Loss: 2.248 Vali Loss: 3.232 Vali Acc: 0.141 Test Loss: 3.232 Test Acc: 0.141
Validation loss decreased (-0.115262 --> -0.141144).  Saving model ...
Epoch: 16 cost time: 1.0786302089691162
Epoch: 16, Steps: 10 | Train Loss: 2.108 Vali Loss: 3.245 Vali Acc: 0.141 Test Loss: 3.245 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0258939266204834
Epoch: 17, Steps: 10 | Train Loss: 2.037 Vali Loss: 3.238 Vali Acc: 0.151 Test Loss: 3.238 Test Acc: 0.151
Validation loss decreased (-0.141144 --> -0.150556).  Saving model ...
Epoch: 18 cost time: 0.9437985420227051
Epoch: 18, Steps: 10 | Train Loss: 1.889 Vali Loss: 3.265 Vali Acc: 0.142 Test Loss: 3.265 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.052316665649414
Epoch: 19, Steps: 10 | Train Loss: 1.795 Vali Loss: 3.251 Vali Acc: 0.174 Test Loss: 3.251 Test Acc: 0.174
Validation loss decreased (-0.150556 --> -0.174085).  Saving model ...
Epoch: 20 cost time: 0.987720251083374
Epoch: 20, Steps: 10 | Train Loss: 1.707 Vali Loss: 3.273 Vali Acc: 0.158 Test Loss: 3.273 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.130208969116211
Epoch: 21, Steps: 10 | Train Loss: 1.536 Vali Loss: 3.254 Vali Acc: 0.172 Test Loss: 3.254 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2397279739379883
Epoch: 22, Steps: 10 | Train Loss: 1.401 Vali Loss: 3.305 Vali Acc: 0.185 Test Loss: 3.305 Test Acc: 0.185
Validation loss decreased (-0.174085 --> -0.184673).  Saving model ...
Epoch: 23 cost time: 0.9760901927947998
Epoch: 23, Steps: 10 | Train Loss: 1.283 Vali Loss: 3.300 Vali Acc: 0.191 Test Loss: 3.300 Test Acc: 0.191
Validation loss decreased (-0.184673 --> -0.190555).  Saving model ...
Epoch: 24 cost time: 1.3048622608184814
Epoch: 24, Steps: 10 | Train Loss: 1.225 Vali Loss: 3.308 Vali Acc: 0.199 Test Loss: 3.308 Test Acc: 0.199
Validation loss decreased (-0.190555 --> -0.198790).  Saving model ...
Epoch: 25 cost time: 1.2309069633483887
Epoch: 25, Steps: 10 | Train Loss: 1.116 Vali Loss: 3.335 Vali Acc: 0.204 Test Loss: 3.335 Test Acc: 0.204
Validation loss decreased (-0.198790 --> -0.203496).  Saving model ...
Epoch: 26 cost time: 1.0846092700958252
Epoch: 26, Steps: 10 | Train Loss: 1.058 Vali Loss: 3.361 Vali Acc: 0.219 Test Loss: 3.361 Test Acc: 0.219
Validation loss decreased (-0.203496 --> -0.218790).  Saving model ...
Epoch: 27 cost time: 1.1353352069854736
Epoch: 27, Steps: 10 | Train Loss: 0.908 Vali Loss: 3.400 Vali Acc: 0.200 Test Loss: 3.400 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9724769592285156
Epoch: 28, Steps: 10 | Train Loss: 0.792 Vali Loss: 3.388 Vali Acc: 0.218 Test Loss: 3.388 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0081665515899658
Epoch: 29, Steps: 10 | Train Loss: 0.741 Vali Loss: 3.401 Vali Acc: 0.214 Test Loss: 3.401 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.200674295425415
Epoch: 30, Steps: 10 | Train Loss: 0.689 Vali Loss: 3.468 Vali Acc: 0.213 Test Loss: 3.468 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8361446857452393
Epoch: 31, Steps: 10 | Train Loss: 0.570 Vali Loss: 3.519 Vali Acc: 0.232 Test Loss: 3.519 Test Acc: 0.232
Validation loss decreased (-0.218790 --> -0.231730).  Saving model ...
Epoch: 32 cost time: 0.8399906158447266
Epoch: 32, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.542 Vali Acc: 0.225 Test Loss: 3.542 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.973034143447876
Epoch: 33, Steps: 10 | Train Loss: 0.472 Vali Loss: 3.548 Vali Acc: 0.219 Test Loss: 3.548 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.949195384979248
Epoch: 34, Steps: 10 | Train Loss: 0.419 Vali Loss: 3.623 Vali Acc: 0.225 Test Loss: 3.623 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9607827663421631
Epoch: 35, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.646 Vali Acc: 0.234 Test Loss: 3.646 Test Acc: 0.234
Validation loss decreased (-0.231730 --> -0.234081).  Saving model ...
Epoch: 36 cost time: 1.1147868633270264
Epoch: 36, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.663 Vali Acc: 0.238 Test Loss: 3.663 Test Acc: 0.238
Validation loss decreased (-0.234081 --> -0.237610).  Saving model ...
Epoch: 37 cost time: 1.079350233078003
Epoch: 37, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.714 Vali Acc: 0.238 Test Loss: 3.714 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0494420528411865
Epoch: 38, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.784 Vali Acc: 0.234 Test Loss: 3.784 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0821120738983154
Epoch: 39, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.753 Vali Acc: 0.247 Test Loss: 3.753 Test Acc: 0.247
Validation loss decreased (-0.237610 --> -0.247021).  Saving model ...
Epoch: 40 cost time: 0.9359734058380127
Epoch: 40, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.835 Vali Acc: 0.234 Test Loss: 3.835 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9564263820648193
Epoch: 41, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.843 Vali Acc: 0.241 Test Loss: 3.843 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9512968063354492
Epoch: 42, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.895 Vali Acc: 0.238 Test Loss: 3.895 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.860849142074585
Epoch: 43, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.909 Vali Acc: 0.249 Test Loss: 3.909 Test Acc: 0.249
Validation loss decreased (-0.247021 --> -0.249373).  Saving model ...
Epoch: 44 cost time: 0.8256995677947998
Epoch: 44, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.911 Vali Acc: 0.248 Test Loss: 3.911 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0748553276062012
Epoch: 45, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.970 Vali Acc: 0.242 Test Loss: 3.970 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0808093547821045
Epoch: 46, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.984 Vali Acc: 0.236 Test Loss: 3.984 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9116501808166504
Epoch: 47, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.001 Vali Acc: 0.238 Test Loss: 4.001 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0587191581726074
Epoch: 48, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.012 Vali Acc: 0.247 Test Loss: 4.012 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9657394886016846
Epoch: 49, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.053 Vali Acc: 0.236 Test Loss: 4.053 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.9853570461273193
Epoch: 50, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.092 Vali Acc: 0.248 Test Loss: 4.092 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.0126209259033203
Epoch: 51, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.150 Vali Acc: 0.233 Test Loss: 4.150 Test Acc: 0.233
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.054840326309204
Epoch: 52, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.101 Vali Acc: 0.247 Test Loss: 4.101 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.958094596862793
Epoch: 53, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.125 Vali Acc: 0.245 Test Loss: 4.125 Test Acc: 0.245
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 188370
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7644383907318115
Epoch: 1, Steps: 10 | Train Loss: 3.522 Vali Loss: 3.431 Vali Acc: 0.045 Test Loss: 3.431 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 0.9808907508850098
Epoch: 2, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.366 Vali Acc: 0.046 Test Loss: 3.366 Test Acc: 0.046
Validation loss decreased (-0.044672 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 1.0373437404632568
Epoch: 3, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.347 Vali Acc: 0.049 Test Loss: 3.347 Test Acc: 0.049
Validation loss decreased (-0.045849 --> -0.049378).  Saving model ...
Epoch: 4 cost time: 0.9448564052581787
Epoch: 4, Steps: 10 | Train Loss: 3.124 Vali Loss: 3.370 Vali Acc: 0.058 Test Loss: 3.370 Test Acc: 0.058
Validation loss decreased (-0.049378 --> -0.057613).  Saving model ...
Epoch: 5 cost time: 1.234281301498413
Epoch: 5, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.378 Vali Acc: 0.054 Test Loss: 3.378 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0382850170135498
Epoch: 6, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.348 Vali Acc: 0.064 Test Loss: 3.348 Test Acc: 0.064
Validation loss decreased (-0.057613 --> -0.063496).  Saving model ...
Epoch: 7 cost time: 1.117173671722412
Epoch: 7, Steps: 10 | Train Loss: 3.015 Vali Loss: 3.328 Vali Acc: 0.073 Test Loss: 3.328 Test Acc: 0.073
Validation loss decreased (-0.063496 --> -0.072908).  Saving model ...
Epoch: 8 cost time: 1.0244362354278564
Epoch: 8, Steps: 10 | Train Loss: 2.924 Vali Loss: 3.326 Vali Acc: 0.076 Test Loss: 3.326 Test Acc: 0.076
Validation loss decreased (-0.072908 --> -0.076437).  Saving model ...
Epoch: 9 cost time: 1.408088207244873
Epoch: 9, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.306 Vali Acc: 0.085 Test Loss: 3.306 Test Acc: 0.085
Validation loss decreased (-0.076437 --> -0.084673).  Saving model ...
Epoch: 10 cost time: 1.0249912738800049
Epoch: 10, Steps: 10 | Train Loss: 2.751 Vali Loss: 3.298 Vali Acc: 0.080 Test Loss: 3.298 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0463180541992188
Epoch: 11, Steps: 10 | Train Loss: 2.682 Vali Loss: 3.309 Vali Acc: 0.104 Test Loss: 3.309 Test Acc: 0.104
Validation loss decreased (-0.084673 --> -0.103496).  Saving model ...
Epoch: 12 cost time: 1.0154430866241455
Epoch: 12, Steps: 10 | Train Loss: 2.562 Vali Loss: 3.304 Vali Acc: 0.100 Test Loss: 3.304 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1103808879852295
Epoch: 13, Steps: 10 | Train Loss: 2.522 Vali Loss: 3.288 Vali Acc: 0.113 Test Loss: 3.288 Test Acc: 0.113
Validation loss decreased (-0.103496 --> -0.112908).  Saving model ...
Epoch: 14 cost time: 0.8243319988250732
Epoch: 14, Steps: 10 | Train Loss: 2.410 Vali Loss: 3.269 Vali Acc: 0.112 Test Loss: 3.269 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.177262544631958
Epoch: 15, Steps: 10 | Train Loss: 2.287 Vali Loss: 3.275 Vali Acc: 0.125 Test Loss: 3.275 Test Acc: 0.125
Validation loss decreased (-0.112908 --> -0.124673).  Saving model ...
Epoch: 16 cost time: 1.00632643699646
Epoch: 16, Steps: 10 | Train Loss: 2.175 Vali Loss: 3.280 Vali Acc: 0.140 Test Loss: 3.280 Test Acc: 0.140
Validation loss decreased (-0.124673 --> -0.139967).  Saving model ...
Epoch: 17 cost time: 1.2038216590881348
Epoch: 17, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.304 Vali Acc: 0.134 Test Loss: 3.304 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.092599630355835
Epoch: 18, Steps: 10 | Train Loss: 1.932 Vali Loss: 3.279 Vali Acc: 0.148 Test Loss: 3.279 Test Acc: 0.148
Validation loss decreased (-0.139967 --> -0.148203).  Saving model ...
Epoch: 19 cost time: 1.0149495601654053
Epoch: 19, Steps: 10 | Train Loss: 1.841 Vali Loss: 3.298 Vali Acc: 0.151 Test Loss: 3.298 Test Acc: 0.151
Validation loss decreased (-0.148203 --> -0.150555).  Saving model ...
Epoch: 20 cost time: 0.8844790458679199
Epoch: 20, Steps: 10 | Train Loss: 1.694 Vali Loss: 3.320 Vali Acc: 0.160 Test Loss: 3.320 Test Acc: 0.160
Validation loss decreased (-0.150555 --> -0.159967).  Saving model ...
Epoch: 21 cost time: 0.9853019714355469
Epoch: 21, Steps: 10 | Train Loss: 1.554 Vali Loss: 3.333 Vali Acc: 0.169 Test Loss: 3.333 Test Acc: 0.169
Validation loss decreased (-0.159967 --> -0.169378).  Saving model ...
Epoch: 22 cost time: 1.0014739036560059
Epoch: 22, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.323 Vali Acc: 0.175 Test Loss: 3.323 Test Acc: 0.175
Validation loss decreased (-0.169378 --> -0.175261).  Saving model ...
Epoch: 23 cost time: 1.048377275466919
Epoch: 23, Steps: 10 | Train Loss: 1.360 Vali Loss: 3.377 Vali Acc: 0.173 Test Loss: 3.377 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2202613353729248
Epoch: 24, Steps: 10 | Train Loss: 1.283 Vali Loss: 3.380 Vali Acc: 0.182 Test Loss: 3.380 Test Acc: 0.182
Validation loss decreased (-0.175261 --> -0.182319).  Saving model ...
Epoch: 25 cost time: 1.0058538913726807
Epoch: 25, Steps: 10 | Train Loss: 1.154 Vali Loss: 3.388 Vali Acc: 0.199 Test Loss: 3.388 Test Acc: 0.199
Validation loss decreased (-0.182319 --> -0.198790).  Saving model ...
Epoch: 26 cost time: 1.2008473873138428
Epoch: 26, Steps: 10 | Train Loss: 1.073 Vali Loss: 3.408 Vali Acc: 0.200 Test Loss: 3.408 Test Acc: 0.200
Validation loss decreased (-0.198790 --> -0.199966).  Saving model ...
Epoch: 27 cost time: 1.099393367767334
Epoch: 27, Steps: 10 | Train Loss: 1.001 Vali Loss: 3.429 Vali Acc: 0.196 Test Loss: 3.429 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2651455402374268
Epoch: 28, Steps: 10 | Train Loss: 0.875 Vali Loss: 3.451 Vali Acc: 0.209 Test Loss: 3.451 Test Acc: 0.209
Validation loss decreased (-0.199966 --> -0.209377).  Saving model ...
Epoch: 29 cost time: 1.0782577991485596
Epoch: 29, Steps: 10 | Train Loss: 0.825 Vali Loss: 3.494 Vali Acc: 0.208 Test Loss: 3.494 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3591382503509521
Epoch: 30, Steps: 10 | Train Loss: 0.685 Vali Loss: 3.527 Vali Acc: 0.194 Test Loss: 3.527 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.033672571182251
Epoch: 31, Steps: 10 | Train Loss: 0.611 Vali Loss: 3.548 Vali Acc: 0.222 Test Loss: 3.548 Test Acc: 0.222
Validation loss decreased (-0.209377 --> -0.222317).  Saving model ...
Epoch: 32 cost time: 0.9353852272033691
Epoch: 32, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.601 Vali Acc: 0.204 Test Loss: 3.601 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9973511695861816
Epoch: 33, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.587 Vali Acc: 0.215 Test Loss: 3.587 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.231820821762085
Epoch: 34, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.653 Vali Acc: 0.216 Test Loss: 3.653 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0781629085540771
Epoch: 35, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.719 Vali Acc: 0.219 Test Loss: 3.719 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9969191551208496
Epoch: 36, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.752 Vali Acc: 0.222 Test Loss: 3.752 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.033543586730957
Epoch: 37, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.761 Vali Acc: 0.219 Test Loss: 3.761 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.042182445526123
Epoch: 38, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.794 Vali Acc: 0.234 Test Loss: 3.794 Test Acc: 0.234
Validation loss decreased (-0.222317 --> -0.234080).  Saving model ...
Epoch: 39 cost time: 1.029930591583252
Epoch: 39, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.847 Vali Acc: 0.234 Test Loss: 3.847 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.985724925994873
Epoch: 40, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.868 Vali Acc: 0.227 Test Loss: 3.868 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0361158847808838
Epoch: 41, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.835 Vali Acc: 0.239 Test Loss: 3.835 Test Acc: 0.239
Validation loss decreased (-0.234080 --> -0.238785).  Saving model ...
Epoch: 42 cost time: 0.841498851776123
Epoch: 42, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.916 Vali Acc: 0.240 Test Loss: 3.916 Test Acc: 0.240
Validation loss decreased (-0.238785 --> -0.239961).  Saving model ...
Epoch: 43 cost time: 0.9863314628601074
Epoch: 43, Steps: 10 | Train Loss: 0.152 Vali Loss: 4.000 Vali Acc: 0.232 Test Loss: 4.000 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2241389751434326
Epoch: 44, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.004 Vali Acc: 0.236 Test Loss: 4.004 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0317533016204834
Epoch: 45, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.020 Vali Acc: 0.236 Test Loss: 4.020 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0464344024658203
Epoch: 46, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.057 Vali Acc: 0.242 Test Loss: 4.057 Test Acc: 0.242
Validation loss decreased (-0.239961 --> -0.242312).  Saving model ...
Epoch: 47 cost time: 0.8575439453125
Epoch: 47, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.098 Vali Acc: 0.240 Test Loss: 4.098 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1313462257385254
Epoch: 48, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.102 Vali Acc: 0.240 Test Loss: 4.102 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.108780860900879
Epoch: 49, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.126 Vali Acc: 0.242 Test Loss: 4.126 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.220668077468872
Epoch: 50, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.180 Vali Acc: 0.239 Test Loss: 4.180 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.2736163139343262
Epoch: 51, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.207 Vali Acc: 0.240 Test Loss: 4.207 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.2851369380950928
Epoch: 52, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.182 Vali Acc: 0.244 Test Loss: 4.182 Test Acc: 0.244
Validation loss decreased (-0.242312 --> -0.243488).  Saving model ...
Epoch: 53 cost time: 1.0083696842193604
Epoch: 53, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.209 Vali Acc: 0.239 Test Loss: 4.209 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1651203632354736
Epoch: 54, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.231 Vali Acc: 0.240 Test Loss: 4.231 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.1728882789611816
Epoch: 55, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.258 Vali Acc: 0.240 Test Loss: 4.258 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.0053865909576416
Epoch: 56, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.274 Vali Acc: 0.240 Test Loss: 4.274 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.1875231266021729
Epoch: 57, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.270 Vali Acc: 0.246 Test Loss: 4.270 Test Acc: 0.246
Validation loss decreased (-0.243488 --> -0.245840).  Saving model ...
Epoch: 58 cost time: 1.1539380550384521
Epoch: 58, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.333 Vali Acc: 0.240 Test Loss: 4.333 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.163435935974121
Epoch: 59, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.375 Vali Acc: 0.245 Test Loss: 4.375 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.071272611618042
Epoch: 60, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.347 Vali Acc: 0.242 Test Loss: 4.347 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.3779563903808594
Epoch: 61, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.378 Vali Acc: 0.241 Test Loss: 4.378 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.108520269393921
Epoch: 62, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.419 Vali Acc: 0.240 Test Loss: 4.419 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.190037727355957
Epoch: 63, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.409 Vali Acc: 0.241 Test Loss: 4.409 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.0681264400482178
Epoch: 64, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.398 Vali Acc: 0.236 Test Loss: 4.398 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.6136698722839355
Epoch: 65, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.502 Vali Acc: 0.231 Test Loss: 4.502 Test Acc: 0.231
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.2596004009246826
Epoch: 66, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.467 Vali Acc: 0.249 Test Loss: 4.467 Test Acc: 0.249
Validation loss decreased (-0.245840 --> -0.249367).  Saving model ...
Epoch: 67 cost time: 1.533853530883789
Epoch: 67, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.442 Vali Acc: 0.249 Test Loss: 4.442 Test Acc: 0.249
Validation loss decreased (-0.249367 --> -0.249367).  Saving model ...
Epoch: 68 cost time: 1.1615328788757324
Epoch: 68, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.479 Vali Acc: 0.246 Test Loss: 4.479 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.3169469833374023
Epoch: 69, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.506 Vali Acc: 0.249 Test Loss: 4.506 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.066053867340088
Epoch: 70, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.497 Vali Acc: 0.247 Test Loss: 4.497 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.9600424766540527
Epoch: 71, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.536 Vali Acc: 0.241 Test Loss: 4.536 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.166438102722168
Epoch: 72, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.585 Vali Acc: 0.246 Test Loss: 4.585 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.2776849269866943
Epoch: 73, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.587 Vali Acc: 0.244 Test Loss: 4.587 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.387519359588623
Epoch: 74, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.590 Vali Acc: 0.248 Test Loss: 4.590 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.910620927810669
Epoch: 75, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.585 Vali Acc: 0.241 Test Loss: 4.585 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.2662572860717773
Epoch: 76, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.600 Vali Acc: 0.241 Test Loss: 4.600 Test Acc: 0.241
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.1613919734954834
Epoch: 77, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.618 Vali Acc: 0.245 Test Loss: 4.618 Test Acc: 0.245
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 187954
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8573453426361084
Epoch: 1, Steps: 10 | Train Loss: 3.486 Vali Loss: 3.352 Vali Acc: 0.048 Test Loss: 3.352 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 1.0658988952636719
Epoch: 2, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.302 Vali Acc: 0.049 Test Loss: 3.302 Test Acc: 0.049
Validation loss decreased (-0.048202 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 0.8527789115905762
Epoch: 3, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.321 Vali Acc: 0.046 Test Loss: 3.321 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1054792404174805
Epoch: 4, Steps: 10 | Train Loss: 3.109 Vali Loss: 3.354 Vali Acc: 0.048 Test Loss: 3.354 Test Acc: 0.048
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.063324213027954
Epoch: 5, Steps: 10 | Train Loss: 3.050 Vali Loss: 3.367 Vali Acc: 0.052 Test Loss: 3.367 Test Acc: 0.052
Validation loss decreased (-0.049379 --> -0.051731).  Saving model ...
Epoch: 6 cost time: 0.8665246963500977
Epoch: 6, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.336 Vali Acc: 0.071 Test Loss: 3.336 Test Acc: 0.071
Validation loss decreased (-0.051731 --> -0.070555).  Saving model ...
Epoch: 7 cost time: 0.8748304843902588
Epoch: 7, Steps: 10 | Train Loss: 2.969 Vali Loss: 3.307 Vali Acc: 0.088 Test Loss: 3.307 Test Acc: 0.088
Validation loss decreased (-0.070555 --> -0.088202).  Saving model ...
Epoch: 8 cost time: 0.9052762985229492
Epoch: 8, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.293 Vali Acc: 0.091 Test Loss: 3.293 Test Acc: 0.091
Validation loss decreased (-0.088202 --> -0.090555).  Saving model ...
Epoch: 9 cost time: 1.025484323501587
Epoch: 9, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.291 Vali Acc: 0.086 Test Loss: 3.291 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8371930122375488
Epoch: 10, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.279 Vali Acc: 0.101 Test Loss: 3.279 Test Acc: 0.101
Validation loss decreased (-0.090555 --> -0.101144).  Saving model ...
Epoch: 11 cost time: 0.9170897006988525
Epoch: 11, Steps: 10 | Train Loss: 2.653 Vali Loss: 3.278 Vali Acc: 0.104 Test Loss: 3.278 Test Acc: 0.104
Validation loss decreased (-0.101144 --> -0.103497).  Saving model ...
Epoch: 12 cost time: 0.8993480205535889
Epoch: 12, Steps: 10 | Train Loss: 2.637 Vali Loss: 3.276 Vali Acc: 0.104 Test Loss: 3.276 Test Acc: 0.104
Validation loss decreased (-0.103497 --> -0.103497).  Saving model ...
Epoch: 13 cost time: 1.0361754894256592
Epoch: 13, Steps: 10 | Train Loss: 2.473 Vali Loss: 3.238 Vali Acc: 0.112 Test Loss: 3.238 Test Acc: 0.112
Validation loss decreased (-0.103497 --> -0.111732).  Saving model ...
Epoch: 14 cost time: 1.0297627449035645
Epoch: 14, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.250 Vali Acc: 0.129 Test Loss: 3.250 Test Acc: 0.129
Validation loss decreased (-0.111732 --> -0.129379).  Saving model ...
Epoch: 15 cost time: 1.0018985271453857
Epoch: 15, Steps: 10 | Train Loss: 2.294 Vali Loss: 3.242 Vali Acc: 0.122 Test Loss: 3.242 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0171411037445068
Epoch: 16, Steps: 10 | Train Loss: 2.183 Vali Loss: 3.257 Vali Acc: 0.129 Test Loss: 3.257 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9519362449645996
Epoch: 17, Steps: 10 | Train Loss: 2.048 Vali Loss: 3.246 Vali Acc: 0.152 Test Loss: 3.246 Test Acc: 0.152
Validation loss decreased (-0.129379 --> -0.151732).  Saving model ...
Epoch: 18 cost time: 0.7817895412445068
Epoch: 18, Steps: 10 | Train Loss: 1.941 Vali Loss: 3.263 Vali Acc: 0.138 Test Loss: 3.263 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8912200927734375
Epoch: 19, Steps: 10 | Train Loss: 1.771 Vali Loss: 3.257 Vali Acc: 0.159 Test Loss: 3.257 Test Acc: 0.159
Validation loss decreased (-0.151732 --> -0.158791).  Saving model ...
Epoch: 20 cost time: 1.0332274436950684
Epoch: 20, Steps: 10 | Train Loss: 1.657 Vali Loss: 3.279 Vali Acc: 0.153 Test Loss: 3.279 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.132657766342163
Epoch: 21, Steps: 10 | Train Loss: 1.608 Vali Loss: 3.269 Vali Acc: 0.171 Test Loss: 3.269 Test Acc: 0.171
Validation loss decreased (-0.158791 --> -0.170556).  Saving model ...
Epoch: 22 cost time: 0.902510404586792
Epoch: 22, Steps: 10 | Train Loss: 1.496 Vali Loss: 3.336 Vali Acc: 0.164 Test Loss: 3.336 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2043077945709229
Epoch: 23, Steps: 10 | Train Loss: 1.356 Vali Loss: 3.321 Vali Acc: 0.172 Test Loss: 3.321 Test Acc: 0.172
Validation loss decreased (-0.170556 --> -0.171731).  Saving model ...
Epoch: 24 cost time: 0.9767723083496094
Epoch: 24, Steps: 10 | Train Loss: 1.233 Vali Loss: 3.357 Vali Acc: 0.176 Test Loss: 3.357 Test Acc: 0.176
Validation loss decreased (-0.171731 --> -0.176437).  Saving model ...
Epoch: 25 cost time: 1.0610685348510742
Epoch: 25, Steps: 10 | Train Loss: 1.142 Vali Loss: 3.355 Vali Acc: 0.186 Test Loss: 3.355 Test Acc: 0.186
Validation loss decreased (-0.176437 --> -0.185849).  Saving model ...
Epoch: 26 cost time: 1.0125648975372314
Epoch: 26, Steps: 10 | Train Loss: 1.055 Vali Loss: 3.364 Vali Acc: 0.193 Test Loss: 3.364 Test Acc: 0.193
Validation loss decreased (-0.185849 --> -0.192908).  Saving model ...
Epoch: 27 cost time: 0.9740903377532959
Epoch: 27, Steps: 10 | Train Loss: 0.969 Vali Loss: 3.413 Vali Acc: 0.188 Test Loss: 3.413 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.093036413192749
Epoch: 28, Steps: 10 | Train Loss: 0.897 Vali Loss: 3.415 Vali Acc: 0.196 Test Loss: 3.415 Test Acc: 0.196
Validation loss decreased (-0.192908 --> -0.196436).  Saving model ...
Epoch: 29 cost time: 0.8894572257995605
Epoch: 29, Steps: 10 | Train Loss: 0.843 Vali Loss: 3.454 Vali Acc: 0.196 Test Loss: 3.454 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9217095375061035
Epoch: 30, Steps: 10 | Train Loss: 0.712 Vali Loss: 3.471 Vali Acc: 0.204 Test Loss: 3.471 Test Acc: 0.204
Validation loss decreased (-0.196436 --> -0.203495).  Saving model ...
Epoch: 31 cost time: 0.956043004989624
Epoch: 31, Steps: 10 | Train Loss: 0.637 Vali Loss: 3.485 Vali Acc: 0.206 Test Loss: 3.485 Test Acc: 0.206
Validation loss decreased (-0.203495 --> -0.205848).  Saving model ...
Epoch: 32 cost time: 1.3280291557312012
Epoch: 32, Steps: 10 | Train Loss: 0.568 Vali Loss: 3.548 Vali Acc: 0.211 Test Loss: 3.548 Test Acc: 0.211
Validation loss decreased (-0.205848 --> -0.210553).  Saving model ...
Epoch: 33 cost time: 1.061199426651001
Epoch: 33, Steps: 10 | Train Loss: 0.517 Vali Loss: 3.582 Vali Acc: 0.213 Test Loss: 3.582 Test Acc: 0.213
Validation loss decreased (-0.210553 --> -0.212905).  Saving model ...
Epoch: 34 cost time: 1.0551300048828125
Epoch: 34, Steps: 10 | Train Loss: 0.470 Vali Loss: 3.640 Vali Acc: 0.202 Test Loss: 3.640 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.209035873413086
Epoch: 35, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.675 Vali Acc: 0.212 Test Loss: 3.675 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0542092323303223
Epoch: 36, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.673 Vali Acc: 0.218 Test Loss: 3.673 Test Acc: 0.218
Validation loss decreased (-0.212905 --> -0.217610).  Saving model ...
Epoch: 37 cost time: 0.9550619125366211
Epoch: 37, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.692 Vali Acc: 0.219 Test Loss: 3.692 Test Acc: 0.219
Validation loss decreased (-0.217610 --> -0.218787).  Saving model ...
Epoch: 38 cost time: 1.0037732124328613
Epoch: 38, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.750 Vali Acc: 0.224 Test Loss: 3.750 Test Acc: 0.224
Validation loss decreased (-0.218787 --> -0.223492).  Saving model ...
Epoch: 39 cost time: 0.864675760269165
Epoch: 39, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.792 Vali Acc: 0.218 Test Loss: 3.792 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.931236982345581
Epoch: 40, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.770 Vali Acc: 0.225 Test Loss: 3.770 Test Acc: 0.225
Validation loss decreased (-0.223492 --> -0.224668).  Saving model ...
Epoch: 41 cost time: 0.9739353656768799
Epoch: 41, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.858 Vali Acc: 0.225 Test Loss: 3.858 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0477049350738525
Epoch: 42, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.926 Vali Acc: 0.219 Test Loss: 3.926 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0708723068237305
Epoch: 43, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.910 Vali Acc: 0.222 Test Loss: 3.910 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0019187927246094
Epoch: 44, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.941 Vali Acc: 0.226 Test Loss: 3.941 Test Acc: 0.226
Validation loss decreased (-0.224668 --> -0.225843).  Saving model ...
Epoch: 45 cost time: 0.805103063583374
Epoch: 45, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.993 Vali Acc: 0.225 Test Loss: 3.993 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1150729656219482
Epoch: 46, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.988 Vali Acc: 0.229 Test Loss: 3.988 Test Acc: 0.229
Validation loss decreased (-0.225843 --> -0.229372).  Saving model ...
Epoch: 47 cost time: 1.0977931022644043
Epoch: 47, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.069 Vali Acc: 0.220 Test Loss: 4.069 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0503382682800293
Epoch: 48, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.074 Vali Acc: 0.225 Test Loss: 4.074 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.860018253326416
Epoch: 49, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.084 Vali Acc: 0.233 Test Loss: 4.084 Test Acc: 0.233
Validation loss decreased (-0.229372 --> -0.232900).  Saving model ...
Epoch: 50 cost time: 0.9585492610931396
Epoch: 50, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.137 Vali Acc: 0.225 Test Loss: 4.137 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0843322277069092
Epoch: 51, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.148 Vali Acc: 0.227 Test Loss: 4.148 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0128889083862305
Epoch: 52, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.151 Vali Acc: 0.229 Test Loss: 4.151 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.3461620807647705
Epoch: 53, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.167 Vali Acc: 0.239 Test Loss: 4.167 Test Acc: 0.239
Validation loss decreased (-0.232900 --> -0.238782).  Saving model ...
Epoch: 54 cost time: 0.9647204875946045
Epoch: 54, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.211 Vali Acc: 0.234 Test Loss: 4.211 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0465114116668701
Epoch: 55, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.220 Vali Acc: 0.235 Test Loss: 4.220 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.0303847789764404
Epoch: 56, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.212 Vali Acc: 0.232 Test Loss: 4.212 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.171945571899414
Epoch: 57, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.251 Vali Acc: 0.233 Test Loss: 4.251 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.1097872257232666
Epoch: 58, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.262 Vali Acc: 0.229 Test Loss: 4.262 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.312537431716919
Epoch: 59, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.299 Vali Acc: 0.234 Test Loss: 4.299 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.2391557693481445
Epoch: 60, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.297 Vali Acc: 0.236 Test Loss: 4.297 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.1617515087127686
Epoch: 61, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.298 Vali Acc: 0.238 Test Loss: 4.298 Test Acc: 0.238
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.0440385341644287
Epoch: 62, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.331 Vali Acc: 0.239 Test Loss: 4.331 Test Acc: 0.239
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.018298625946045
Epoch: 63, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.371 Vali Acc: 0.234 Test Loss: 4.371 Test Acc: 0.234
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2388235294117647
model parameter : 187538
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.256742000579834
Epoch: 1, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.362 Vali Acc: 0.038 Test Loss: 3.362 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 1.0886166095733643
Epoch: 2, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.327 Vali Acc: 0.032 Test Loss: 3.327 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0856502056121826
Epoch: 3, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.337 Vali Acc: 0.039 Test Loss: 3.337 Test Acc: 0.039
Validation loss decreased (-0.037613 --> -0.038790).  Saving model ...
Epoch: 4 cost time: 1.3258683681488037
Epoch: 4, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.344 Vali Acc: 0.035 Test Loss: 3.344 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1887378692626953
Epoch: 5, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.358 Vali Acc: 0.045 Test Loss: 3.358 Test Acc: 0.045
Validation loss decreased (-0.038790 --> -0.044672).  Saving model ...
Epoch: 6 cost time: 1.2199985980987549
Epoch: 6, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.346 Vali Acc: 0.048 Test Loss: 3.346 Test Acc: 0.048
Validation loss decreased (-0.044672 --> -0.048202).  Saving model ...
Epoch: 7 cost time: 0.9562520980834961
Epoch: 7, Steps: 10 | Train Loss: 3.065 Vali Loss: 3.318 Vali Acc: 0.064 Test Loss: 3.318 Test Acc: 0.064
Validation loss decreased (-0.048202 --> -0.063496).  Saving model ...
Epoch: 8 cost time: 0.894608736038208
Epoch: 8, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.311 Vali Acc: 0.067 Test Loss: 3.311 Test Acc: 0.067
Validation loss decreased (-0.063496 --> -0.067026).  Saving model ...
Epoch: 9 cost time: 0.8095331192016602
Epoch: 9, Steps: 10 | Train Loss: 2.876 Vali Loss: 3.301 Vali Acc: 0.075 Test Loss: 3.301 Test Acc: 0.075
Validation loss decreased (-0.067026 --> -0.075261).  Saving model ...
Epoch: 10 cost time: 1.1151914596557617
Epoch: 10, Steps: 10 | Train Loss: 2.806 Vali Loss: 3.290 Vali Acc: 0.071 Test Loss: 3.290 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1829547882080078
Epoch: 11, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.299 Vali Acc: 0.076 Test Loss: 3.299 Test Acc: 0.076
Validation loss decreased (-0.075261 --> -0.076438).  Saving model ...
Epoch: 12 cost time: 1.0528297424316406
Epoch: 12, Steps: 10 | Train Loss: 2.654 Vali Loss: 3.290 Vali Acc: 0.094 Test Loss: 3.290 Test Acc: 0.094
Validation loss decreased (-0.076438 --> -0.094085).  Saving model ...
Epoch: 13 cost time: 1.0761048793792725
Epoch: 13, Steps: 10 | Train Loss: 2.544 Vali Loss: 3.276 Vali Acc: 0.107 Test Loss: 3.276 Test Acc: 0.107
Validation loss decreased (-0.094085 --> -0.107026).  Saving model ...
Epoch: 14 cost time: 1.1394052505493164
Epoch: 14, Steps: 10 | Train Loss: 2.449 Vali Loss: 3.271 Vali Acc: 0.107 Test Loss: 3.271 Test Acc: 0.107
Validation loss decreased (-0.107026 --> -0.107026).  Saving model ...
Epoch: 15 cost time: 1.0744283199310303
Epoch: 15, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.271 Vali Acc: 0.121 Test Loss: 3.271 Test Acc: 0.121
Validation loss decreased (-0.107026 --> -0.121144).  Saving model ...
Epoch: 16 cost time: 1.1763343811035156
Epoch: 16, Steps: 10 | Train Loss: 2.253 Vali Loss: 3.285 Vali Acc: 0.115 Test Loss: 3.285 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9932491779327393
Epoch: 17, Steps: 10 | Train Loss: 2.123 Vali Loss: 3.273 Vali Acc: 0.127 Test Loss: 3.273 Test Acc: 0.127
Validation loss decreased (-0.121144 --> -0.127026).  Saving model ...
Epoch: 18 cost time: 1.0501327514648438
Epoch: 18, Steps: 10 | Train Loss: 1.981 Vali Loss: 3.254 Vali Acc: 0.136 Test Loss: 3.254 Test Acc: 0.136
Validation loss decreased (-0.127026 --> -0.136438).  Saving model ...
Epoch: 19 cost time: 0.8629374504089355
Epoch: 19, Steps: 10 | Train Loss: 1.846 Vali Loss: 3.279 Vali Acc: 0.135 Test Loss: 3.279 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9096274375915527
Epoch: 20, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.292 Vali Acc: 0.153 Test Loss: 3.292 Test Acc: 0.153
Validation loss decreased (-0.136438 --> -0.152908).  Saving model ...
Epoch: 21 cost time: 1.0492630004882812
Epoch: 21, Steps: 10 | Train Loss: 1.594 Vali Loss: 3.308 Vali Acc: 0.154 Test Loss: 3.308 Test Acc: 0.154
Validation loss decreased (-0.152908 --> -0.154085).  Saving model ...
Epoch: 22 cost time: 0.9917826652526855
Epoch: 22, Steps: 10 | Train Loss: 1.487 Vali Loss: 3.318 Vali Acc: 0.158 Test Loss: 3.318 Test Acc: 0.158
Validation loss decreased (-0.154085 --> -0.157614).  Saving model ...
Epoch: 23 cost time: 1.0013902187347412
Epoch: 23, Steps: 10 | Train Loss: 1.390 Vali Loss: 3.335 Vali Acc: 0.169 Test Loss: 3.335 Test Acc: 0.169
Validation loss decreased (-0.157614 --> -0.169378).  Saving model ...
Epoch: 24 cost time: 1.0582265853881836
Epoch: 24, Steps: 10 | Train Loss: 1.293 Vali Loss: 3.344 Vali Acc: 0.167 Test Loss: 3.344 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1428351402282715
Epoch: 25, Steps: 10 | Train Loss: 1.137 Vali Loss: 3.361 Vali Acc: 0.175 Test Loss: 3.361 Test Acc: 0.175
Validation loss decreased (-0.169378 --> -0.175261).  Saving model ...
Epoch: 26 cost time: 0.9839873313903809
Epoch: 26, Steps: 10 | Train Loss: 1.102 Vali Loss: 3.393 Vali Acc: 0.187 Test Loss: 3.393 Test Acc: 0.187
Validation loss decreased (-0.175261 --> -0.187025).  Saving model ...
Epoch: 27 cost time: 1.005138874053955
Epoch: 27, Steps: 10 | Train Loss: 0.997 Vali Loss: 3.400 Vali Acc: 0.200 Test Loss: 3.400 Test Acc: 0.200
Validation loss decreased (-0.187025 --> -0.199966).  Saving model ...
Epoch: 28 cost time: 1.0740315914154053
Epoch: 28, Steps: 10 | Train Loss: 0.899 Vali Loss: 3.431 Vali Acc: 0.211 Test Loss: 3.431 Test Acc: 0.211
Validation loss decreased (-0.199966 --> -0.210554).  Saving model ...
Epoch: 29 cost time: 1.2433362007141113
Epoch: 29, Steps: 10 | Train Loss: 0.802 Vali Loss: 3.435 Vali Acc: 0.205 Test Loss: 3.435 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0911684036254883
Epoch: 30, Steps: 10 | Train Loss: 0.709 Vali Loss: 3.471 Vali Acc: 0.216 Test Loss: 3.471 Test Acc: 0.216
Validation loss decreased (-0.210554 --> -0.216436).  Saving model ...
Epoch: 31 cost time: 0.9988577365875244
Epoch: 31, Steps: 10 | Train Loss: 0.662 Vali Loss: 3.507 Vali Acc: 0.213 Test Loss: 3.507 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1505169868469238
Epoch: 32, Steps: 10 | Train Loss: 0.633 Vali Loss: 3.545 Vali Acc: 0.218 Test Loss: 3.545 Test Acc: 0.218
Validation loss decreased (-0.216436 --> -0.217612).  Saving model ...
Epoch: 33 cost time: 1.114870548248291
Epoch: 33, Steps: 10 | Train Loss: 0.555 Vali Loss: 3.552 Vali Acc: 0.220 Test Loss: 3.552 Test Acc: 0.220
Validation loss decreased (-0.217612 --> -0.219964).  Saving model ...
Epoch: 34 cost time: 0.9216582775115967
Epoch: 34, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.672 Vali Acc: 0.222 Test Loss: 3.672 Test Acc: 0.222
Validation loss decreased (-0.219964 --> -0.222316).  Saving model ...
Epoch: 35 cost time: 1.359966516494751
Epoch: 35, Steps: 10 | Train Loss: 0.419 Vali Loss: 3.638 Vali Acc: 0.224 Test Loss: 3.638 Test Acc: 0.224
Validation loss decreased (-0.222316 --> -0.223493).  Saving model ...
Epoch: 36 cost time: 1.064650535583496
Epoch: 36, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.688 Vali Acc: 0.218 Test Loss: 3.688 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0729889869689941
Epoch: 37, Steps: 10 | Train Loss: 0.314 Vali Loss: 3.735 Vali Acc: 0.226 Test Loss: 3.735 Test Acc: 0.226
Validation loss decreased (-0.223493 --> -0.225845).  Saving model ...
Epoch: 38 cost time: 1.0176193714141846
Epoch: 38, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.774 Vali Acc: 0.218 Test Loss: 3.774 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.942598819732666
Epoch: 39, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.794 Vali Acc: 0.234 Test Loss: 3.794 Test Acc: 0.234
Validation loss decreased (-0.225845 --> -0.234080).  Saving model ...
Epoch: 40 cost time: 1.169755220413208
Epoch: 40, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.847 Vali Acc: 0.226 Test Loss: 3.847 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.971489429473877
Epoch: 41, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.867 Vali Acc: 0.229 Test Loss: 3.867 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9497122764587402
Epoch: 42, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.894 Vali Acc: 0.234 Test Loss: 3.894 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1181361675262451
Epoch: 43, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.952 Vali Acc: 0.234 Test Loss: 3.952 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1286675930023193
Epoch: 44, Steps: 10 | Train Loss: 0.138 Vali Loss: 4.002 Vali Acc: 0.232 Test Loss: 4.002 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.3955564498901367
Epoch: 45, Steps: 10 | Train Loss: 0.131 Vali Loss: 4.023 Vali Acc: 0.227 Test Loss: 4.023 Test Acc: 0.227
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8881194591522217
Epoch: 46, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.049 Vali Acc: 0.227 Test Loss: 4.049 Test Acc: 0.227
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.059584379196167
Epoch: 47, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.086 Vali Acc: 0.227 Test Loss: 4.086 Test Acc: 0.227
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.869581937789917
Epoch: 48, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.063 Vali Acc: 0.232 Test Loss: 4.063 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.948845624923706
Epoch: 49, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.086 Vali Acc: 0.233 Test Loss: 4.086 Test Acc: 0.233
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23411764705882354
model parameter : 187122
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.181133270263672
Epoch: 1, Steps: 10 | Train Loss: 3.366 Vali Loss: 3.343 Vali Acc: 0.039 Test Loss: 3.343 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 1.499558925628662
Epoch: 2, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.314 Vali Acc: 0.051 Test Loss: 3.314 Test Acc: 0.051
Validation loss decreased (-0.038790 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 1.0851566791534424
Epoch: 3, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.318 Vali Acc: 0.051 Test Loss: 3.318 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0043883323669434
Epoch: 4, Steps: 10 | Train Loss: 3.133 Vali Loss: 3.331 Vali Acc: 0.055 Test Loss: 3.331 Test Acc: 0.055
Validation loss decreased (-0.050555 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 1.184413194656372
Epoch: 5, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.337 Vali Acc: 0.049 Test Loss: 3.337 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3588738441467285
Epoch: 6, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.319 Vali Acc: 0.064 Test Loss: 3.319 Test Acc: 0.064
Validation loss decreased (-0.055261 --> -0.063496).  Saving model ...
Epoch: 7 cost time: 1.0187666416168213
Epoch: 7, Steps: 10 | Train Loss: 3.020 Vali Loss: 3.294 Vali Acc: 0.066 Test Loss: 3.294 Test Acc: 0.066
Validation loss decreased (-0.063496 --> -0.065849).  Saving model ...
Epoch: 8 cost time: 1.103635311126709
Epoch: 8, Steps: 10 | Train Loss: 2.921 Vali Loss: 3.278 Vali Acc: 0.076 Test Loss: 3.278 Test Acc: 0.076
Validation loss decreased (-0.065849 --> -0.076438).  Saving model ...
Epoch: 9 cost time: 1.0112805366516113
Epoch: 9, Steps: 10 | Train Loss: 2.912 Vali Loss: 3.281 Vali Acc: 0.076 Test Loss: 3.281 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.106386661529541
Epoch: 10, Steps: 10 | Train Loss: 2.822 Vali Loss: 3.282 Vali Acc: 0.069 Test Loss: 3.282 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8685019016265869
Epoch: 11, Steps: 10 | Train Loss: 2.738 Vali Loss: 3.267 Vali Acc: 0.087 Test Loss: 3.267 Test Acc: 0.087
Validation loss decreased (-0.076438 --> -0.087026).  Saving model ...
Epoch: 12 cost time: 0.9372730255126953
Epoch: 12, Steps: 10 | Train Loss: 2.638 Vali Loss: 3.245 Vali Acc: 0.112 Test Loss: 3.245 Test Acc: 0.112
Validation loss decreased (-0.087026 --> -0.111732).  Saving model ...
Epoch: 13 cost time: 1.1593775749206543
Epoch: 13, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.250 Vali Acc: 0.098 Test Loss: 3.250 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9550392627716064
Epoch: 14, Steps: 10 | Train Loss: 2.466 Vali Loss: 3.226 Vali Acc: 0.121 Test Loss: 3.226 Test Acc: 0.121
Validation loss decreased (-0.111732 --> -0.121144).  Saving model ...
Epoch: 15 cost time: 1.1855969429016113
Epoch: 15, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.251 Vali Acc: 0.109 Test Loss: 3.251 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.815413236618042
Epoch: 16, Steps: 10 | Train Loss: 2.221 Vali Loss: 3.242 Vali Acc: 0.121 Test Loss: 3.242 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9280059337615967
Epoch: 17, Steps: 10 | Train Loss: 2.123 Vali Loss: 3.256 Vali Acc: 0.132 Test Loss: 3.256 Test Acc: 0.132
Validation loss decreased (-0.121144 --> -0.131732).  Saving model ...
Epoch: 18 cost time: 0.9549891948699951
Epoch: 18, Steps: 10 | Train Loss: 2.047 Vali Loss: 3.234 Vali Acc: 0.140 Test Loss: 3.234 Test Acc: 0.140
Validation loss decreased (-0.131732 --> -0.139968).  Saving model ...
Epoch: 19 cost time: 1.0158112049102783
Epoch: 19, Steps: 10 | Train Loss: 1.915 Vali Loss: 3.249 Vali Acc: 0.131 Test Loss: 3.249 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9706113338470459
Epoch: 20, Steps: 10 | Train Loss: 1.778 Vali Loss: 3.250 Vali Acc: 0.165 Test Loss: 3.250 Test Acc: 0.165
Validation loss decreased (-0.139968 --> -0.164673).  Saving model ...
Epoch: 21 cost time: 1.0455734729766846
Epoch: 21, Steps: 10 | Train Loss: 1.644 Vali Loss: 3.280 Vali Acc: 0.158 Test Loss: 3.280 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.018158197402954
Epoch: 22, Steps: 10 | Train Loss: 1.552 Vali Loss: 3.277 Vali Acc: 0.178 Test Loss: 3.277 Test Acc: 0.178
Validation loss decreased (-0.164673 --> -0.177614).  Saving model ...
Epoch: 23 cost time: 1.1055047512054443
Epoch: 23, Steps: 10 | Train Loss: 1.436 Vali Loss: 3.316 Vali Acc: 0.176 Test Loss: 3.316 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0244863033294678
Epoch: 24, Steps: 10 | Train Loss: 1.300 Vali Loss: 3.321 Vali Acc: 0.179 Test Loss: 3.321 Test Acc: 0.179
Validation loss decreased (-0.177614 --> -0.178790).  Saving model ...
Epoch: 25 cost time: 0.814678430557251
Epoch: 25, Steps: 10 | Train Loss: 1.245 Vali Loss: 3.347 Vali Acc: 0.192 Test Loss: 3.347 Test Acc: 0.192
Validation loss decreased (-0.178790 --> -0.191731).  Saving model ...
Epoch: 26 cost time: 0.9803280830383301
Epoch: 26, Steps: 10 | Train Loss: 1.140 Vali Loss: 3.351 Vali Acc: 0.200 Test Loss: 3.351 Test Acc: 0.200
Validation loss decreased (-0.191731 --> -0.199966).  Saving model ...
Epoch: 27 cost time: 0.833594560623169
Epoch: 27, Steps: 10 | Train Loss: 1.022 Vali Loss: 3.380 Vali Acc: 0.199 Test Loss: 3.380 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9646201133728027
Epoch: 28, Steps: 10 | Train Loss: 0.948 Vali Loss: 3.403 Vali Acc: 0.212 Test Loss: 3.403 Test Acc: 0.212
Validation loss decreased (-0.199966 --> -0.211731).  Saving model ...
Epoch: 29 cost time: 1.018977165222168
Epoch: 29, Steps: 10 | Train Loss: 0.885 Vali Loss: 3.420 Vali Acc: 0.208 Test Loss: 3.420 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7784543037414551
Epoch: 30, Steps: 10 | Train Loss: 0.726 Vali Loss: 3.471 Vali Acc: 0.209 Test Loss: 3.471 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8995039463043213
Epoch: 31, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.513 Vali Acc: 0.212 Test Loss: 3.513 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0510342121124268
Epoch: 32, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.476 Vali Acc: 0.216 Test Loss: 3.476 Test Acc: 0.216
Validation loss decreased (-0.211731 --> -0.216436).  Saving model ...
Epoch: 33 cost time: 1.0640668869018555
Epoch: 33, Steps: 10 | Train Loss: 0.572 Vali Loss: 3.550 Vali Acc: 0.222 Test Loss: 3.550 Test Acc: 0.222
Validation loss decreased (-0.216436 --> -0.222317).  Saving model ...
Epoch: 34 cost time: 0.8892996311187744
Epoch: 34, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.598 Vali Acc: 0.219 Test Loss: 3.598 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.047020673751831
Epoch: 35, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.620 Vali Acc: 0.211 Test Loss: 3.620 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9020123481750488
Epoch: 36, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.655 Vali Acc: 0.221 Test Loss: 3.655 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0358426570892334
Epoch: 37, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.678 Vali Acc: 0.229 Test Loss: 3.678 Test Acc: 0.229
Validation loss decreased (-0.222317 --> -0.229375).  Saving model ...
Epoch: 38 cost time: 1.2181148529052734
Epoch: 38, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.724 Vali Acc: 0.236 Test Loss: 3.724 Test Acc: 0.236
Validation loss decreased (-0.229375 --> -0.236433).  Saving model ...
Epoch: 39 cost time: 1.0791301727294922
Epoch: 39, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.774 Vali Acc: 0.233 Test Loss: 3.774 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0583155155181885
Epoch: 40, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.814 Vali Acc: 0.232 Test Loss: 3.814 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.928246259689331
Epoch: 41, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.845 Vali Acc: 0.238 Test Loss: 3.845 Test Acc: 0.238
Validation loss decreased (-0.236433 --> -0.237609).  Saving model ...
Epoch: 42 cost time: 0.913128137588501
Epoch: 42, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.871 Vali Acc: 0.229 Test Loss: 3.871 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8880596160888672
Epoch: 43, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.928 Vali Acc: 0.240 Test Loss: 3.928 Test Acc: 0.240
Validation loss decreased (-0.237609 --> -0.239961).  Saving model ...
Epoch: 44 cost time: 0.9624321460723877
Epoch: 44, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.932 Vali Acc: 0.236 Test Loss: 3.932 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8724465370178223
Epoch: 45, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.931 Vali Acc: 0.234 Test Loss: 3.931 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0592951774597168
Epoch: 46, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.007 Vali Acc: 0.233 Test Loss: 4.007 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0989186763763428
Epoch: 47, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.020 Vali Acc: 0.238 Test Loss: 4.020 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9733383655548096
Epoch: 48, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.023 Vali Acc: 0.231 Test Loss: 4.023 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9629051685333252
Epoch: 49, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.071 Vali Acc: 0.226 Test Loss: 4.071 Test Acc: 0.226
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.2472100257873535
Epoch: 50, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.070 Vali Acc: 0.238 Test Loss: 4.070 Test Acc: 0.238
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.1204915046691895
Epoch: 51, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.091 Vali Acc: 0.242 Test Loss: 4.091 Test Acc: 0.242
Validation loss decreased (-0.239961 --> -0.242312).  Saving model ...
Epoch: 52 cost time: 0.9400413036346436
Epoch: 52, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.131 Vali Acc: 0.242 Test Loss: 4.131 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0773499011993408
Epoch: 53, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.162 Vali Acc: 0.242 Test Loss: 4.162 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.1289403438568115
Epoch: 54, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.155 Vali Acc: 0.238 Test Loss: 4.155 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.142416000366211
Epoch: 55, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.179 Vali Acc: 0.238 Test Loss: 4.179 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9040491580963135
Epoch: 56, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.214 Vali Acc: 0.234 Test Loss: 4.214 Test Acc: 0.234
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.019496202468872
Epoch: 57, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.213 Vali Acc: 0.236 Test Loss: 4.213 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.1647999286651611
Epoch: 58, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.253 Vali Acc: 0.240 Test Loss: 4.253 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.0529823303222656
Epoch: 59, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.271 Vali Acc: 0.242 Test Loss: 4.271 Test Acc: 0.242
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.952172040939331
Epoch: 60, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.265 Vali Acc: 0.242 Test Loss: 4.265 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.0831234455108643
Epoch: 61, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.278 Vali Acc: 0.246 Test Loss: 4.278 Test Acc: 0.246
Validation loss decreased (-0.242312 --> -0.245840).  Saving model ...
Epoch: 62 cost time: 1.038301944732666
Epoch: 62, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.296 Vali Acc: 0.251 Test Loss: 4.296 Test Acc: 0.251
Validation loss decreased (-0.245840 --> -0.250545).  Saving model ...
Epoch: 63 cost time: 1.3895201683044434
Epoch: 63, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.306 Vali Acc: 0.247 Test Loss: 4.306 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8773550987243652
Epoch: 64, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.328 Vali Acc: 0.245 Test Loss: 4.328 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.2294402122497559
Epoch: 65, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.332 Vali Acc: 0.258 Test Loss: 4.332 Test Acc: 0.258
Validation loss decreased (-0.250545 --> -0.257604).  Saving model ...
Epoch: 66 cost time: 1.5337824821472168
Epoch: 66, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.343 Vali Acc: 0.253 Test Loss: 4.343 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0845091342926025
Epoch: 67, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.384 Vali Acc: 0.241 Test Loss: 4.384 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0790245532989502
Epoch: 68, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.418 Vali Acc: 0.251 Test Loss: 4.418 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9387607574462891
Epoch: 69, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.419 Vali Acc: 0.249 Test Loss: 4.419 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.1893322467803955
Epoch: 70, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.437 Vali Acc: 0.244 Test Loss: 4.437 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.9820895195007324
Epoch: 71, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.439 Vali Acc: 0.247 Test Loss: 4.439 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.9361686706542969
Epoch: 72, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.462 Vali Acc: 0.251 Test Loss: 4.462 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.8413970470428467
Epoch: 73, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.468 Vali Acc: 0.239 Test Loss: 4.468 Test Acc: 0.239
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.029484748840332
Epoch: 74, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.487 Vali Acc: 0.241 Test Loss: 4.487 Test Acc: 0.241
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.1111414432525635
Epoch: 75, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.483 Vali Acc: 0.247 Test Loss: 4.483 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 138450
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.835808515548706
Epoch: 1, Steps: 10 | Train Loss: 3.418 Vali Loss: 3.349 Vali Acc: 0.046 Test Loss: 3.349 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.8880629539489746
Epoch: 2, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.315 Vali Acc: 0.059 Test Loss: 3.315 Test Acc: 0.059
Validation loss decreased (-0.045849 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 1.1716039180755615
Epoch: 3, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.320 Vali Acc: 0.055 Test Loss: 3.320 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.182976484298706
Epoch: 4, Steps: 10 | Train Loss: 3.130 Vali Loss: 3.340 Vali Acc: 0.051 Test Loss: 3.340 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1194522380828857
Epoch: 5, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.334 Vali Acc: 0.054 Test Loss: 3.334 Test Acc: 0.054
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0874824523925781
Epoch: 6, Steps: 10 | Train Loss: 3.085 Vali Loss: 3.319 Vali Acc: 0.066 Test Loss: 3.319 Test Acc: 0.066
Validation loss decreased (-0.058790 --> -0.065849).  Saving model ...
Epoch: 7 cost time: 0.9733638763427734
Epoch: 7, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.300 Vali Acc: 0.069 Test Loss: 3.300 Test Acc: 0.069
Validation loss decreased (-0.065849 --> -0.069379).  Saving model ...
Epoch: 8 cost time: 0.8274774551391602
Epoch: 8, Steps: 10 | Train Loss: 2.944 Vali Loss: 3.288 Vali Acc: 0.073 Test Loss: 3.288 Test Acc: 0.073
Validation loss decreased (-0.069379 --> -0.072908).  Saving model ...
Epoch: 9 cost time: 0.9393825531005859
Epoch: 9, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.278 Vali Acc: 0.078 Test Loss: 3.278 Test Acc: 0.078
Validation loss decreased (-0.072908 --> -0.077614).  Saving model ...
Epoch: 10 cost time: 0.9528927803039551
Epoch: 10, Steps: 10 | Train Loss: 2.798 Vali Loss: 3.265 Vali Acc: 0.087 Test Loss: 3.265 Test Acc: 0.087
Validation loss decreased (-0.077614 --> -0.087026).  Saving model ...
Epoch: 11 cost time: 0.9833521842956543
Epoch: 11, Steps: 10 | Train Loss: 2.745 Vali Loss: 3.250 Vali Acc: 0.094 Test Loss: 3.250 Test Acc: 0.094
Validation loss decreased (-0.087026 --> -0.094085).  Saving model ...
Epoch: 12 cost time: 1.0463025569915771
Epoch: 12, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.253 Vali Acc: 0.092 Test Loss: 3.253 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.989206075668335
Epoch: 13, Steps: 10 | Train Loss: 2.617 Vali Loss: 3.242 Vali Acc: 0.116 Test Loss: 3.242 Test Acc: 0.116
Validation loss decreased (-0.094085 --> -0.116438).  Saving model ...
Epoch: 14 cost time: 0.9526963233947754
Epoch: 14, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.233 Vali Acc: 0.098 Test Loss: 3.233 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1811621189117432
Epoch: 15, Steps: 10 | Train Loss: 2.386 Vali Loss: 3.224 Vali Acc: 0.121 Test Loss: 3.224 Test Acc: 0.121
Validation loss decreased (-0.116438 --> -0.121144).  Saving model ...
Epoch: 16 cost time: 0.885575532913208
Epoch: 16, Steps: 10 | Train Loss: 2.307 Vali Loss: 3.206 Vali Acc: 0.133 Test Loss: 3.206 Test Acc: 0.133
Validation loss decreased (-0.121144 --> -0.132909).  Saving model ...
Epoch: 17 cost time: 1.0995738506317139
Epoch: 17, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.203 Vali Acc: 0.127 Test Loss: 3.203 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9081387519836426
Epoch: 18, Steps: 10 | Train Loss: 2.070 Vali Loss: 3.207 Vali Acc: 0.145 Test Loss: 3.207 Test Acc: 0.145
Validation loss decreased (-0.132909 --> -0.144674).  Saving model ...
Epoch: 19 cost time: 0.978161096572876
Epoch: 19, Steps: 10 | Train Loss: 1.921 Vali Loss: 3.216 Vali Acc: 0.151 Test Loss: 3.216 Test Acc: 0.151
Validation loss decreased (-0.144674 --> -0.150556).  Saving model ...
Epoch: 20 cost time: 1.1340672969818115
Epoch: 20, Steps: 10 | Train Loss: 1.856 Vali Loss: 3.216 Vali Acc: 0.155 Test Loss: 3.216 Test Acc: 0.155
Validation loss decreased (-0.150556 --> -0.155262).  Saving model ...
Epoch: 21 cost time: 0.9515945911407471
Epoch: 21, Steps: 10 | Train Loss: 1.731 Vali Loss: 3.210 Vali Acc: 0.164 Test Loss: 3.210 Test Acc: 0.164
Validation loss decreased (-0.155262 --> -0.163497).  Saving model ...
Epoch: 22 cost time: 0.9687511920928955
Epoch: 22, Steps: 10 | Train Loss: 1.564 Vali Loss: 3.237 Vali Acc: 0.178 Test Loss: 3.237 Test Acc: 0.178
Validation loss decreased (-0.163497 --> -0.177615).  Saving model ...
Epoch: 23 cost time: 0.8997635841369629
Epoch: 23, Steps: 10 | Train Loss: 1.501 Vali Loss: 3.245 Vali Acc: 0.173 Test Loss: 3.245 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1467998027801514
Epoch: 24, Steps: 10 | Train Loss: 1.422 Vali Loss: 3.242 Vali Acc: 0.192 Test Loss: 3.242 Test Acc: 0.192
Validation loss decreased (-0.177615 --> -0.191732).  Saving model ...
Epoch: 25 cost time: 1.0669710636138916
Epoch: 25, Steps: 10 | Train Loss: 1.362 Vali Loss: 3.268 Vali Acc: 0.193 Test Loss: 3.268 Test Acc: 0.193
Validation loss decreased (-0.191732 --> -0.192908).  Saving model ...
Epoch: 26 cost time: 0.990241527557373
Epoch: 26, Steps: 10 | Train Loss: 1.202 Vali Loss: 3.280 Vali Acc: 0.202 Test Loss: 3.280 Test Acc: 0.202
Validation loss decreased (-0.192908 --> -0.202320).  Saving model ...
Epoch: 27 cost time: 1.100660800933838
Epoch: 27, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.313 Vali Acc: 0.212 Test Loss: 3.313 Test Acc: 0.212
Validation loss decreased (-0.202320 --> -0.211732).  Saving model ...
Epoch: 28 cost time: 1.1156949996948242
Epoch: 28, Steps: 10 | Train Loss: 1.022 Vali Loss: 3.352 Vali Acc: 0.208 Test Loss: 3.352 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0694074630737305
Epoch: 29, Steps: 10 | Train Loss: 0.923 Vali Loss: 3.354 Vali Acc: 0.219 Test Loss: 3.354 Test Acc: 0.219
Validation loss decreased (-0.211732 --> -0.218790).  Saving model ...
Epoch: 30 cost time: 0.8971068859100342
Epoch: 30, Steps: 10 | Train Loss: 0.795 Vali Loss: 3.370 Vali Acc: 0.222 Test Loss: 3.370 Test Acc: 0.222
Validation loss decreased (-0.218790 --> -0.222319).  Saving model ...
Epoch: 31 cost time: 0.8902938365936279
Epoch: 31, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.414 Vali Acc: 0.228 Test Loss: 3.414 Test Acc: 0.228
Validation loss decreased (-0.222319 --> -0.228201).  Saving model ...
Epoch: 32 cost time: 0.9872610569000244
Epoch: 32, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.409 Vali Acc: 0.232 Test Loss: 3.409 Test Acc: 0.232
Validation loss decreased (-0.228201 --> -0.231731).  Saving model ...
Epoch: 33 cost time: 0.899155855178833
Epoch: 33, Steps: 10 | Train Loss: 0.613 Vali Loss: 3.464 Vali Acc: 0.229 Test Loss: 3.464 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8792784214019775
Epoch: 34, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.526 Vali Acc: 0.232 Test Loss: 3.526 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8929083347320557
Epoch: 35, Steps: 10 | Train Loss: 0.483 Vali Loss: 3.554 Vali Acc: 0.235 Test Loss: 3.554 Test Acc: 0.235
Validation loss decreased (-0.231731 --> -0.235259).  Saving model ...
Epoch: 36 cost time: 1.145575761795044
Epoch: 36, Steps: 10 | Train Loss: 0.435 Vali Loss: 3.585 Vali Acc: 0.233 Test Loss: 3.585 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2128264904022217
Epoch: 37, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.587 Vali Acc: 0.239 Test Loss: 3.587 Test Acc: 0.239
Validation loss decreased (-0.235259 --> -0.238788).  Saving model ...
Epoch: 38 cost time: 0.992605447769165
Epoch: 38, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.639 Vali Acc: 0.233 Test Loss: 3.639 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.207139253616333
Epoch: 39, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.741 Vali Acc: 0.231 Test Loss: 3.741 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.4590067863464355
Epoch: 40, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.736 Vali Acc: 0.239 Test Loss: 3.736 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0498461723327637
Epoch: 41, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.750 Vali Acc: 0.249 Test Loss: 3.750 Test Acc: 0.249
Validation loss decreased (-0.238788 --> -0.249374).  Saving model ...
Epoch: 42 cost time: 0.9755594730377197
Epoch: 42, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.841 Vali Acc: 0.239 Test Loss: 3.841 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.326939582824707
Epoch: 43, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.831 Vali Acc: 0.242 Test Loss: 3.831 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3511791229248047
Epoch: 44, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.862 Vali Acc: 0.242 Test Loss: 3.862 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2103519439697266
Epoch: 45, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.941 Vali Acc: 0.233 Test Loss: 3.941 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1586296558380127
Epoch: 46, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.943 Vali Acc: 0.238 Test Loss: 3.943 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.222357988357544
Epoch: 47, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.932 Vali Acc: 0.249 Test Loss: 3.932 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3679983615875244
Epoch: 48, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.973 Vali Acc: 0.249 Test Loss: 3.973 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.284297227859497
Epoch: 49, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.019 Vali Acc: 0.244 Test Loss: 4.019 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.0836751461029053
Epoch: 50, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.053 Vali Acc: 0.241 Test Loss: 4.053 Test Acc: 0.241
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.0561904907226562
Epoch: 51, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.100 Vali Acc: 0.246 Test Loss: 4.100 Test Acc: 0.246
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 138034
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.058211326599121
Epoch: 1, Steps: 10 | Train Loss: 3.379 Vali Loss: 3.344 Vali Acc: 0.047 Test Loss: 3.344 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 0.9496018886566162
Epoch: 2, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.323 Vali Acc: 0.045 Test Loss: 3.323 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.966630220413208
Epoch: 3, Steps: 10 | Train Loss: 3.205 Vali Loss: 3.346 Vali Acc: 0.039 Test Loss: 3.346 Test Acc: 0.039
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9831957817077637
Epoch: 4, Steps: 10 | Train Loss: 3.168 Vali Loss: 3.355 Vali Acc: 0.044 Test Loss: 3.355 Test Acc: 0.044
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3523926734924316
Epoch: 5, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.340 Vali Acc: 0.055 Test Loss: 3.340 Test Acc: 0.055
Validation loss decreased (-0.047025 --> -0.055261).  Saving model ...
Epoch: 6 cost time: 0.9675254821777344
Epoch: 6, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.336 Vali Acc: 0.055 Test Loss: 3.336 Test Acc: 0.055
Validation loss decreased (-0.055261 --> -0.055261).  Saving model ...
Epoch: 7 cost time: 0.9075479507446289
Epoch: 7, Steps: 10 | Train Loss: 2.997 Vali Loss: 3.318 Vali Acc: 0.058 Test Loss: 3.318 Test Acc: 0.058
Validation loss decreased (-0.055261 --> -0.057614).  Saving model ...
Epoch: 8 cost time: 0.9639472961425781
Epoch: 8, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.313 Vali Acc: 0.074 Test Loss: 3.313 Test Acc: 0.074
Validation loss decreased (-0.057614 --> -0.074085).  Saving model ...
Epoch: 9 cost time: 0.8970232009887695
Epoch: 9, Steps: 10 | Train Loss: 2.877 Vali Loss: 3.300 Vali Acc: 0.078 Test Loss: 3.300 Test Acc: 0.078
Validation loss decreased (-0.074085 --> -0.077614).  Saving model ...
Epoch: 10 cost time: 1.031507968902588
Epoch: 10, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.287 Vali Acc: 0.076 Test Loss: 3.287 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9591269493103027
Epoch: 11, Steps: 10 | Train Loss: 2.748 Vali Loss: 3.299 Vali Acc: 0.085 Test Loss: 3.299 Test Acc: 0.085
Validation loss decreased (-0.077614 --> -0.084673).  Saving model ...
Epoch: 12 cost time: 1.0252089500427246
Epoch: 12, Steps: 10 | Train Loss: 2.708 Vali Loss: 3.266 Vali Acc: 0.088 Test Loss: 3.266 Test Acc: 0.088
Validation loss decreased (-0.084673 --> -0.088203).  Saving model ...
Epoch: 13 cost time: 0.9300258159637451
Epoch: 13, Steps: 10 | Train Loss: 2.565 Vali Loss: 3.236 Vali Acc: 0.120 Test Loss: 3.236 Test Acc: 0.120
Validation loss decreased (-0.088203 --> -0.119968).  Saving model ...
Epoch: 14 cost time: 1.1514153480529785
Epoch: 14, Steps: 10 | Train Loss: 2.489 Vali Loss: 3.248 Vali Acc: 0.099 Test Loss: 3.248 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9332070350646973
Epoch: 15, Steps: 10 | Train Loss: 2.375 Vali Loss: 3.256 Vali Acc: 0.114 Test Loss: 3.256 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1141371726989746
Epoch: 16, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.270 Vali Acc: 0.113 Test Loss: 3.270 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9058310985565186
Epoch: 17, Steps: 10 | Train Loss: 2.205 Vali Loss: 3.255 Vali Acc: 0.126 Test Loss: 3.255 Test Acc: 0.126
Validation loss decreased (-0.119968 --> -0.125850).  Saving model ...
Epoch: 18 cost time: 0.7767693996429443
Epoch: 18, Steps: 10 | Train Loss: 2.055 Vali Loss: 3.249 Vali Acc: 0.140 Test Loss: 3.249 Test Acc: 0.140
Validation loss decreased (-0.125850 --> -0.139968).  Saving model ...
Epoch: 19 cost time: 0.8691062927246094
Epoch: 19, Steps: 10 | Train Loss: 1.968 Vali Loss: 3.259 Vali Acc: 0.145 Test Loss: 3.259 Test Acc: 0.145
Validation loss decreased (-0.139968 --> -0.144673).  Saving model ...
Epoch: 20 cost time: 0.8756914138793945
Epoch: 20, Steps: 10 | Train Loss: 1.820 Vali Loss: 3.249 Vali Acc: 0.155 Test Loss: 3.249 Test Acc: 0.155
Validation loss decreased (-0.144673 --> -0.155262).  Saving model ...
Epoch: 21 cost time: 0.9844005107879639
Epoch: 21, Steps: 10 | Train Loss: 1.724 Vali Loss: 3.276 Vali Acc: 0.145 Test Loss: 3.276 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7933576107025146
Epoch: 22, Steps: 10 | Train Loss: 1.623 Vali Loss: 3.285 Vali Acc: 0.154 Test Loss: 3.285 Test Acc: 0.154
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9090065956115723
Epoch: 23, Steps: 10 | Train Loss: 1.478 Vali Loss: 3.302 Vali Acc: 0.167 Test Loss: 3.302 Test Acc: 0.167
Validation loss decreased (-0.155262 --> -0.167026).  Saving model ...
Epoch: 24 cost time: 1.2919020652770996
Epoch: 24, Steps: 10 | Train Loss: 1.438 Vali Loss: 3.303 Vali Acc: 0.173 Test Loss: 3.303 Test Acc: 0.173
Validation loss decreased (-0.167026 --> -0.172908).  Saving model ...
Epoch: 25 cost time: 0.9849076271057129
Epoch: 25, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.335 Vali Acc: 0.179 Test Loss: 3.335 Test Acc: 0.179
Validation loss decreased (-0.172908 --> -0.178790).  Saving model ...
Epoch: 26 cost time: 0.9852521419525146
Epoch: 26, Steps: 10 | Train Loss: 1.201 Vali Loss: 3.352 Vali Acc: 0.198 Test Loss: 3.352 Test Acc: 0.198
Validation loss decreased (-0.178790 --> -0.197614).  Saving model ...
Epoch: 27 cost time: 0.9618771076202393
Epoch: 27, Steps: 10 | Train Loss: 1.091 Vali Loss: 3.363 Vali Acc: 0.189 Test Loss: 3.363 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8924989700317383
Epoch: 28, Steps: 10 | Train Loss: 1.038 Vali Loss: 3.381 Vali Acc: 0.195 Test Loss: 3.381 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1400203704833984
Epoch: 29, Steps: 10 | Train Loss: 0.953 Vali Loss: 3.401 Vali Acc: 0.205 Test Loss: 3.401 Test Acc: 0.205
Validation loss decreased (-0.197614 --> -0.204672).  Saving model ...
Epoch: 30 cost time: 1.0179228782653809
Epoch: 30, Steps: 10 | Train Loss: 0.865 Vali Loss: 3.433 Vali Acc: 0.208 Test Loss: 3.433 Test Acc: 0.208
Validation loss decreased (-0.204672 --> -0.208201).  Saving model ...
Epoch: 31 cost time: 1.0220112800598145
Epoch: 31, Steps: 10 | Train Loss: 0.772 Vali Loss: 3.490 Vali Acc: 0.213 Test Loss: 3.490 Test Acc: 0.213
Validation loss decreased (-0.208201 --> -0.212906).  Saving model ...
Epoch: 32 cost time: 0.8531792163848877
Epoch: 32, Steps: 10 | Train Loss: 0.651 Vali Loss: 3.484 Vali Acc: 0.218 Test Loss: 3.484 Test Acc: 0.218
Validation loss decreased (-0.212906 --> -0.217612).  Saving model ...
Epoch: 33 cost time: 0.9757797718048096
Epoch: 33, Steps: 10 | Train Loss: 0.628 Vali Loss: 3.545 Vali Acc: 0.216 Test Loss: 3.545 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9231605529785156
Epoch: 34, Steps: 10 | Train Loss: 0.538 Vali Loss: 3.578 Vali Acc: 0.222 Test Loss: 3.578 Test Acc: 0.222
Validation loss decreased (-0.217612 --> -0.222317).  Saving model ...
Epoch: 35 cost time: 0.9209771156311035
Epoch: 35, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.580 Vali Acc: 0.224 Test Loss: 3.580 Test Acc: 0.224
Validation loss decreased (-0.222317 --> -0.223494).  Saving model ...
Epoch: 36 cost time: 1.0337462425231934
Epoch: 36, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.625 Vali Acc: 0.227 Test Loss: 3.625 Test Acc: 0.227
Validation loss decreased (-0.223494 --> -0.227023).  Saving model ...
Epoch: 37 cost time: 0.8958921432495117
Epoch: 37, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.695 Vali Acc: 0.222 Test Loss: 3.695 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9325680732727051
Epoch: 38, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.694 Vali Acc: 0.229 Test Loss: 3.694 Test Acc: 0.229
Validation loss decreased (-0.227023 --> -0.229375).  Saving model ...
Epoch: 39 cost time: 0.9054603576660156
Epoch: 39, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.746 Vali Acc: 0.226 Test Loss: 3.746 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1034553050994873
Epoch: 40, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.797 Vali Acc: 0.226 Test Loss: 3.797 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9459309577941895
Epoch: 41, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.831 Vali Acc: 0.229 Test Loss: 3.831 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8151228427886963
Epoch: 42, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.823 Vali Acc: 0.236 Test Loss: 3.823 Test Acc: 0.236
Validation loss decreased (-0.229375 --> -0.236432).  Saving model ...
Epoch: 43 cost time: 0.9666950702667236
Epoch: 43, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.876 Vali Acc: 0.233 Test Loss: 3.876 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9124395847320557
Epoch: 44, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.942 Vali Acc: 0.226 Test Loss: 3.942 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9895775318145752
Epoch: 45, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.981 Vali Acc: 0.231 Test Loss: 3.981 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8379862308502197
Epoch: 46, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.964 Vali Acc: 0.231 Test Loss: 3.964 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0587363243103027
Epoch: 47, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.995 Vali Acc: 0.219 Test Loss: 3.995 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8811764717102051
Epoch: 48, Steps: 10 | Train Loss: 0.112 Vali Loss: 4.040 Vali Acc: 0.221 Test Loss: 4.040 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.964454174041748
Epoch: 49, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.040 Vali Acc: 0.241 Test Loss: 4.040 Test Acc: 0.241
Validation loss decreased (-0.236432 --> -0.241136).  Saving model ...
Epoch: 50 cost time: 0.818528413772583
Epoch: 50, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.057 Vali Acc: 0.236 Test Loss: 4.057 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9617927074432373
Epoch: 51, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.088 Vali Acc: 0.239 Test Loss: 4.088 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9950892925262451
Epoch: 52, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.120 Vali Acc: 0.232 Test Loss: 4.120 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8741836547851562
Epoch: 53, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.125 Vali Acc: 0.236 Test Loss: 4.125 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.9546551704406738
Epoch: 54, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.155 Vali Acc: 0.231 Test Loss: 4.155 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.8948113918304443
Epoch: 55, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.151 Vali Acc: 0.231 Test Loss: 4.151 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.003455400466919
Epoch: 56, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.175 Vali Acc: 0.231 Test Loss: 4.175 Test Acc: 0.231
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.9523839950561523
Epoch: 57, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.218 Vali Acc: 0.235 Test Loss: 4.218 Test Acc: 0.235
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.052229404449463
Epoch: 58, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.239 Vali Acc: 0.234 Test Loss: 4.239 Test Acc: 0.234
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.0394129753112793
Epoch: 59, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.257 Vali Acc: 0.236 Test Loss: 4.257 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2411764705882353
model parameter : 137618
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4767959117889404
Epoch: 1, Steps: 10 | Train Loss: 3.377 Vali Loss: 3.370 Vali Acc: 0.051 Test Loss: 3.370 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.9015853404998779
Epoch: 2, Steps: 10 | Train Loss: 3.274 Vali Loss: 3.331 Vali Acc: 0.049 Test Loss: 3.331 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8065030574798584
Epoch: 3, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.338 Vali Acc: 0.044 Test Loss: 3.338 Test Acc: 0.044
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1496787071228027
Epoch: 4, Steps: 10 | Train Loss: 3.151 Vali Loss: 3.344 Vali Acc: 0.048 Test Loss: 3.344 Test Acc: 0.048
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0403766632080078
Epoch: 5, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.338 Vali Acc: 0.060 Test Loss: 3.338 Test Acc: 0.060
Validation loss decreased (-0.050555 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 0.9671564102172852
Epoch: 6, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.332 Vali Acc: 0.071 Test Loss: 3.332 Test Acc: 0.071
Validation loss decreased (-0.059967 --> -0.070555).  Saving model ...
Epoch: 7 cost time: 0.7872083187103271
Epoch: 7, Steps: 10 | Train Loss: 2.993 Vali Loss: 3.303 Vali Acc: 0.069 Test Loss: 3.303 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.046457052230835
Epoch: 8, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.298 Vali Acc: 0.069 Test Loss: 3.298 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1288626194000244
Epoch: 9, Steps: 10 | Train Loss: 2.874 Vali Loss: 3.299 Vali Acc: 0.085 Test Loss: 3.299 Test Acc: 0.085
Validation loss decreased (-0.070555 --> -0.084673).  Saving model ...
Epoch: 10 cost time: 0.885012149810791
Epoch: 10, Steps: 10 | Train Loss: 2.787 Vali Loss: 3.283 Vali Acc: 0.088 Test Loss: 3.283 Test Acc: 0.088
Validation loss decreased (-0.084673 --> -0.088202).  Saving model ...
Epoch: 11 cost time: 0.8931441307067871
Epoch: 11, Steps: 10 | Train Loss: 2.718 Vali Loss: 3.276 Vali Acc: 0.091 Test Loss: 3.276 Test Acc: 0.091
Validation loss decreased (-0.088202 --> -0.090555).  Saving model ...
Epoch: 12 cost time: 1.1293392181396484
Epoch: 12, Steps: 10 | Train Loss: 2.612 Vali Loss: 3.263 Vali Acc: 0.092 Test Loss: 3.263 Test Acc: 0.092
Validation loss decreased (-0.090555 --> -0.091732).  Saving model ...
Epoch: 13 cost time: 1.1602516174316406
Epoch: 13, Steps: 10 | Train Loss: 2.544 Vali Loss: 3.251 Vali Acc: 0.109 Test Loss: 3.251 Test Acc: 0.109
Validation loss decreased (-0.091732 --> -0.109379).  Saving model ...
Epoch: 14 cost time: 0.9208829402923584
Epoch: 14, Steps: 10 | Train Loss: 2.447 Vali Loss: 3.244 Vali Acc: 0.105 Test Loss: 3.244 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.023547649383545
Epoch: 15, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.253 Vali Acc: 0.119 Test Loss: 3.253 Test Acc: 0.119
Validation loss decreased (-0.109379 --> -0.118791).  Saving model ...
Epoch: 16 cost time: 0.9159891605377197
Epoch: 16, Steps: 10 | Train Loss: 2.247 Vali Loss: 3.230 Vali Acc: 0.115 Test Loss: 3.230 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9437363147735596
Epoch: 17, Steps: 10 | Train Loss: 2.143 Vali Loss: 3.227 Vali Acc: 0.129 Test Loss: 3.227 Test Acc: 0.129
Validation loss decreased (-0.118791 --> -0.129379).  Saving model ...
Epoch: 18 cost time: 1.0426313877105713
Epoch: 18, Steps: 10 | Train Loss: 2.037 Vali Loss: 3.245 Vali Acc: 0.133 Test Loss: 3.245 Test Acc: 0.133
Validation loss decreased (-0.129379 --> -0.132909).  Saving model ...
Epoch: 19 cost time: 1.061647653579712
Epoch: 19, Steps: 10 | Train Loss: 1.950 Vali Loss: 3.256 Vali Acc: 0.135 Test Loss: 3.256 Test Acc: 0.135
Validation loss decreased (-0.132909 --> -0.135262).  Saving model ...
Epoch: 20 cost time: 0.9007077217102051
Epoch: 20, Steps: 10 | Train Loss: 1.797 Vali Loss: 3.259 Vali Acc: 0.135 Test Loss: 3.259 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8495979309082031
Epoch: 21, Steps: 10 | Train Loss: 1.690 Vali Loss: 3.272 Vali Acc: 0.149 Test Loss: 3.272 Test Acc: 0.149
Validation loss decreased (-0.135262 --> -0.149379).  Saving model ...
Epoch: 22 cost time: 0.8716094493865967
Epoch: 22, Steps: 10 | Train Loss: 1.561 Vali Loss: 3.275 Vali Acc: 0.152 Test Loss: 3.275 Test Acc: 0.152
Validation loss decreased (-0.149379 --> -0.151732).  Saving model ...
Epoch: 23 cost time: 1.1365759372711182
Epoch: 23, Steps: 10 | Train Loss: 1.436 Vali Loss: 3.307 Vali Acc: 0.168 Test Loss: 3.307 Test Acc: 0.168
Validation loss decreased (-0.151732 --> -0.168202).  Saving model ...
Epoch: 24 cost time: 0.9903666973114014
Epoch: 24, Steps: 10 | Train Loss: 1.365 Vali Loss: 3.317 Vali Acc: 0.165 Test Loss: 3.317 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8941786289215088
Epoch: 25, Steps: 10 | Train Loss: 1.239 Vali Loss: 3.327 Vali Acc: 0.178 Test Loss: 3.327 Test Acc: 0.178
Validation loss decreased (-0.168202 --> -0.177614).  Saving model ...
Epoch: 26 cost time: 0.8894064426422119
Epoch: 26, Steps: 10 | Train Loss: 1.161 Vali Loss: 3.334 Vali Acc: 0.188 Test Loss: 3.334 Test Acc: 0.188
Validation loss decreased (-0.177614 --> -0.188202).  Saving model ...
Epoch: 27 cost time: 0.9865665435791016
Epoch: 27, Steps: 10 | Train Loss: 1.070 Vali Loss: 3.385 Vali Acc: 0.200 Test Loss: 3.385 Test Acc: 0.200
Validation loss decreased (-0.188202 --> -0.199966).  Saving model ...
Epoch: 28 cost time: 1.1158790588378906
Epoch: 28, Steps: 10 | Train Loss: 0.976 Vali Loss: 3.396 Vali Acc: 0.195 Test Loss: 3.396 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.006138563156128
Epoch: 29, Steps: 10 | Train Loss: 0.859 Vali Loss: 3.426 Vali Acc: 0.202 Test Loss: 3.426 Test Acc: 0.202
Validation loss decreased (-0.199966 --> -0.202319).  Saving model ...
Epoch: 30 cost time: 0.9371557235717773
Epoch: 30, Steps: 10 | Train Loss: 0.770 Vali Loss: 3.436 Vali Acc: 0.225 Test Loss: 3.436 Test Acc: 0.225
Validation loss decreased (-0.202319 --> -0.224672).  Saving model ...
Epoch: 31 cost time: 1.2941370010375977
Epoch: 31, Steps: 10 | Train Loss: 0.702 Vali Loss: 3.497 Vali Acc: 0.206 Test Loss: 3.497 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.17203950881958
Epoch: 32, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.510 Vali Acc: 0.221 Test Loss: 3.510 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.267317533493042
Epoch: 33, Steps: 10 | Train Loss: 0.577 Vali Loss: 3.531 Vali Acc: 0.224 Test Loss: 3.531 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9400362968444824
Epoch: 34, Steps: 10 | Train Loss: 0.494 Vali Loss: 3.585 Vali Acc: 0.225 Test Loss: 3.585 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9500629901885986
Epoch: 35, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.631 Vali Acc: 0.235 Test Loss: 3.631 Test Acc: 0.235
Validation loss decreased (-0.224672 --> -0.235258).  Saving model ...
Epoch: 36 cost time: 0.8716475963592529
Epoch: 36, Steps: 10 | Train Loss: 0.374 Vali Loss: 3.682 Vali Acc: 0.233 Test Loss: 3.682 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9907763004302979
Epoch: 37, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.699 Vali Acc: 0.247 Test Loss: 3.699 Test Acc: 0.247
Validation loss decreased (-0.235258 --> -0.247022).  Saving model ...
Epoch: 38 cost time: 0.9384846687316895
Epoch: 38, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.736 Vali Acc: 0.234 Test Loss: 3.736 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9866220951080322
Epoch: 39, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.778 Vali Acc: 0.232 Test Loss: 3.778 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1371304988861084
Epoch: 40, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.788 Vali Acc: 0.244 Test Loss: 3.788 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0255980491638184
Epoch: 41, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.851 Vali Acc: 0.244 Test Loss: 3.851 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9210290908813477
Epoch: 42, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.854 Vali Acc: 0.241 Test Loss: 3.854 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9666697978973389
Epoch: 43, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.884 Vali Acc: 0.247 Test Loss: 3.884 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9107592105865479
Epoch: 44, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.976 Vali Acc: 0.242 Test Loss: 3.976 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.879086971282959
Epoch: 45, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.987 Vali Acc: 0.248 Test Loss: 3.987 Test Acc: 0.248
Validation loss decreased (-0.247022 --> -0.248195).  Saving model ...
Epoch: 46 cost time: 0.884918212890625
Epoch: 46, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.980 Vali Acc: 0.252 Test Loss: 3.980 Test Acc: 0.252
Validation loss decreased (-0.248195 --> -0.251725).  Saving model ...
Epoch: 47 cost time: 0.8665947914123535
Epoch: 47, Steps: 10 | Train Loss: 0.123 Vali Loss: 4.009 Vali Acc: 0.252 Test Loss: 4.009 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9920125007629395
Epoch: 48, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.067 Vali Acc: 0.245 Test Loss: 4.067 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9855434894561768
Epoch: 49, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.064 Vali Acc: 0.245 Test Loss: 4.064 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0193750858306885
Epoch: 50, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.110 Vali Acc: 0.238 Test Loss: 4.110 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.8811516761779785
Epoch: 51, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.121 Vali Acc: 0.245 Test Loss: 4.121 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.0024054050445557
Epoch: 52, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.129 Vali Acc: 0.245 Test Loss: 4.129 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9918005466461182
Epoch: 53, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.159 Vali Acc: 0.251 Test Loss: 4.159 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.8776779174804688
Epoch: 54, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.177 Vali Acc: 0.248 Test Loss: 4.177 Test Acc: 0.248
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.9866232872009277
Epoch: 55, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.199 Vali Acc: 0.240 Test Loss: 4.199 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.2540912628173828
Epoch: 56, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.245 Vali Acc: 0.245 Test Loss: 4.245 Test Acc: 0.245
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25176470588235295
model parameter : 137202
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0382168292999268
Epoch: 1, Steps: 10 | Train Loss: 3.382 Vali Loss: 3.367 Vali Acc: 0.042 Test Loss: 3.367 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 1.0665833950042725
Epoch: 2, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.327 Vali Acc: 0.054 Test Loss: 3.327 Test Acc: 0.054
Validation loss decreased (-0.042319 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.7713053226470947
Epoch: 3, Steps: 10 | Train Loss: 3.186 Vali Loss: 3.324 Vali Acc: 0.040 Test Loss: 3.324 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8111574649810791
Epoch: 4, Steps: 10 | Train Loss: 3.138 Vali Loss: 3.330 Vali Acc: 0.051 Test Loss: 3.330 Test Acc: 0.051
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0078961849212646
Epoch: 5, Steps: 10 | Train Loss: 3.104 Vali Loss: 3.329 Vali Acc: 0.053 Test Loss: 3.329 Test Acc: 0.053
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8695871829986572
Epoch: 6, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.328 Vali Acc: 0.039 Test Loss: 3.328 Test Acc: 0.039
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8917183876037598
Epoch: 7, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.301 Vali Acc: 0.064 Test Loss: 3.301 Test Acc: 0.064
Validation loss decreased (-0.054084 --> -0.063496).  Saving model ...
Epoch: 8 cost time: 0.8006136417388916
Epoch: 8, Steps: 10 | Train Loss: 2.936 Vali Loss: 3.291 Vali Acc: 0.074 Test Loss: 3.291 Test Acc: 0.074
Validation loss decreased (-0.063496 --> -0.074085).  Saving model ...
Epoch: 9 cost time: 0.787705659866333
Epoch: 9, Steps: 10 | Train Loss: 2.927 Vali Loss: 3.284 Vali Acc: 0.085 Test Loss: 3.284 Test Acc: 0.085
Validation loss decreased (-0.074085 --> -0.084673).  Saving model ...
Epoch: 10 cost time: 0.9536452293395996
Epoch: 10, Steps: 10 | Train Loss: 2.833 Vali Loss: 3.266 Vali Acc: 0.084 Test Loss: 3.266 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8754401206970215
Epoch: 11, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.262 Vali Acc: 0.099 Test Loss: 3.262 Test Acc: 0.099
Validation loss decreased (-0.084673 --> -0.098791).  Saving model ...
Epoch: 12 cost time: 1.0304570198059082
Epoch: 12, Steps: 10 | Train Loss: 2.626 Vali Loss: 3.254 Vali Acc: 0.091 Test Loss: 3.254 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8901519775390625
Epoch: 13, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.242 Vali Acc: 0.111 Test Loss: 3.242 Test Acc: 0.111
Validation loss decreased (-0.098791 --> -0.110556).  Saving model ...
Epoch: 14 cost time: 0.8321917057037354
Epoch: 14, Steps: 10 | Train Loss: 2.496 Vali Loss: 3.219 Vali Acc: 0.099 Test Loss: 3.219 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9905984401702881
Epoch: 15, Steps: 10 | Train Loss: 2.438 Vali Loss: 3.243 Vali Acc: 0.101 Test Loss: 3.243 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9133288860321045
Epoch: 16, Steps: 10 | Train Loss: 2.296 Vali Loss: 3.222 Vali Acc: 0.118 Test Loss: 3.222 Test Acc: 0.118
Validation loss decreased (-0.110556 --> -0.117615).  Saving model ...
Epoch: 17 cost time: 0.9388720989227295
Epoch: 17, Steps: 10 | Train Loss: 2.207 Vali Loss: 3.231 Vali Acc: 0.128 Test Loss: 3.231 Test Acc: 0.128
Validation loss decreased (-0.117615 --> -0.128203).  Saving model ...
Epoch: 18 cost time: 0.9132397174835205
Epoch: 18, Steps: 10 | Train Loss: 2.105 Vali Loss: 3.218 Vali Acc: 0.142 Test Loss: 3.218 Test Acc: 0.142
Validation loss decreased (-0.128203 --> -0.142321).  Saving model ...
Epoch: 19 cost time: 0.8960859775543213
Epoch: 19, Steps: 10 | Train Loss: 1.988 Vali Loss: 3.223 Vali Acc: 0.142 Test Loss: 3.223 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1981923580169678
Epoch: 20, Steps: 10 | Train Loss: 1.867 Vali Loss: 3.247 Vali Acc: 0.142 Test Loss: 3.247 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9368834495544434
Epoch: 21, Steps: 10 | Train Loss: 1.765 Vali Loss: 3.226 Vali Acc: 0.174 Test Loss: 3.226 Test Acc: 0.174
Validation loss decreased (-0.142321 --> -0.174085).  Saving model ...
Epoch: 22 cost time: 0.8862569332122803
Epoch: 22, Steps: 10 | Train Loss: 1.688 Vali Loss: 3.257 Vali Acc: 0.154 Test Loss: 3.257 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8476467132568359
Epoch: 23, Steps: 10 | Train Loss: 1.570 Vali Loss: 3.280 Vali Acc: 0.182 Test Loss: 3.280 Test Acc: 0.182
Validation loss decreased (-0.174085 --> -0.182320).  Saving model ...
Epoch: 24 cost time: 0.9441447257995605
Epoch: 24, Steps: 10 | Train Loss: 1.501 Vali Loss: 3.269 Vali Acc: 0.173 Test Loss: 3.269 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.162128210067749
Epoch: 25, Steps: 10 | Train Loss: 1.400 Vali Loss: 3.301 Vali Acc: 0.173 Test Loss: 3.301 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9126572608947754
Epoch: 26, Steps: 10 | Train Loss: 1.233 Vali Loss: 3.318 Vali Acc: 0.188 Test Loss: 3.318 Test Acc: 0.188
Validation loss decreased (-0.182320 --> -0.188202).  Saving model ...
Epoch: 27 cost time: 0.8423807621002197
Epoch: 27, Steps: 10 | Train Loss: 1.167 Vali Loss: 3.345 Vali Acc: 0.195 Test Loss: 3.345 Test Acc: 0.195
Validation loss decreased (-0.188202 --> -0.195261).  Saving model ...
Epoch: 28 cost time: 0.842736005783081
Epoch: 28, Steps: 10 | Train Loss: 1.101 Vali Loss: 3.385 Vali Acc: 0.193 Test Loss: 3.385 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8313717842102051
Epoch: 29, Steps: 10 | Train Loss: 1.050 Vali Loss: 3.401 Vali Acc: 0.214 Test Loss: 3.401 Test Acc: 0.214
Validation loss decreased (-0.195261 --> -0.214084).  Saving model ...
Epoch: 30 cost time: 0.8175854682922363
Epoch: 30, Steps: 10 | Train Loss: 0.889 Vali Loss: 3.414 Vali Acc: 0.195 Test Loss: 3.414 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7892241477966309
Epoch: 31, Steps: 10 | Train Loss: 0.870 Vali Loss: 3.433 Vali Acc: 0.214 Test Loss: 3.433 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8481061458587646
Epoch: 32, Steps: 10 | Train Loss: 0.753 Vali Loss: 3.497 Vali Acc: 0.211 Test Loss: 3.497 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8895320892333984
Epoch: 33, Steps: 10 | Train Loss: 0.640 Vali Loss: 3.541 Vali Acc: 0.216 Test Loss: 3.541 Test Acc: 0.216
Validation loss decreased (-0.214084 --> -0.216435).  Saving model ...
Epoch: 34 cost time: 1.135840892791748
Epoch: 34, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.537 Vali Acc: 0.213 Test Loss: 3.537 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.856130838394165
Epoch: 35, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.582 Vali Acc: 0.224 Test Loss: 3.582 Test Acc: 0.224
Validation loss decreased (-0.216435 --> -0.223494).  Saving model ...
Epoch: 36 cost time: 0.854421854019165
Epoch: 36, Steps: 10 | Train Loss: 0.486 Vali Loss: 3.625 Vali Acc: 0.229 Test Loss: 3.625 Test Acc: 0.229
Validation loss decreased (-0.223494 --> -0.229376).  Saving model ...
Epoch: 37 cost time: 0.7872085571289062
Epoch: 37, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.665 Vali Acc: 0.236 Test Loss: 3.665 Test Acc: 0.236
Validation loss decreased (-0.229376 --> -0.236434).  Saving model ...
Epoch: 38 cost time: 0.8754928112030029
Epoch: 38, Steps: 10 | Train Loss: 0.372 Vali Loss: 3.685 Vali Acc: 0.240 Test Loss: 3.685 Test Acc: 0.240
Validation loss decreased (-0.236434 --> -0.239963).  Saving model ...
Epoch: 39 cost time: 1.0677907466888428
Epoch: 39, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.722 Vali Acc: 0.234 Test Loss: 3.722 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.882622480392456
Epoch: 40, Steps: 10 | Train Loss: 0.303 Vali Loss: 3.793 Vali Acc: 0.231 Test Loss: 3.793 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9107229709625244
Epoch: 41, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.796 Vali Acc: 0.244 Test Loss: 3.796 Test Acc: 0.244
Validation loss decreased (-0.239963 --> -0.243491).  Saving model ...
Epoch: 42 cost time: 0.9361979961395264
Epoch: 42, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.840 Vali Acc: 0.235 Test Loss: 3.840 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8699007034301758
Epoch: 43, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.887 Vali Acc: 0.239 Test Loss: 3.887 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8272550106048584
Epoch: 44, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.936 Vali Acc: 0.236 Test Loss: 3.936 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9057199954986572
Epoch: 45, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.972 Vali Acc: 0.240 Test Loss: 3.972 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9368526935577393
Epoch: 46, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.988 Vali Acc: 0.246 Test Loss: 3.988 Test Acc: 0.246
Validation loss decreased (-0.243491 --> -0.245842).  Saving model ...
Epoch: 47 cost time: 0.7758500576019287
Epoch: 47, Steps: 10 | Train Loss: 0.144 Vali Loss: 4.016 Vali Acc: 0.236 Test Loss: 4.016 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.971081018447876
Epoch: 48, Steps: 10 | Train Loss: 0.128 Vali Loss: 4.021 Vali Acc: 0.240 Test Loss: 4.021 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9779565334320068
Epoch: 49, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.058 Vali Acc: 0.236 Test Loss: 4.058 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8320984840393066
Epoch: 50, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.126 Vali Acc: 0.238 Test Loss: 4.126 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.7889096736907959
Epoch: 51, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.144 Vali Acc: 0.241 Test Loss: 4.144 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.1114332675933838
Epoch: 52, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.152 Vali Acc: 0.239 Test Loss: 4.152 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.926325798034668
Epoch: 53, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.172 Vali Acc: 0.239 Test Loss: 4.172 Test Acc: 0.239
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.8846592903137207
Epoch: 54, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.212 Vali Acc: 0.242 Test Loss: 4.212 Test Acc: 0.242
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.9587099552154541
Epoch: 55, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.235 Vali Acc: 0.241 Test Loss: 4.235 Test Acc: 0.241
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.8411846160888672
Epoch: 56, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.246 Vali Acc: 0.245 Test Loss: 4.246 Test Acc: 0.245
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24588235294117647
model parameter : 113490
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.949557065963745
Epoch: 1, Steps: 10 | Train Loss: 3.396 Vali Loss: 3.343 Vali Acc: 0.045 Test Loss: 3.343 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 0.865659236907959
Epoch: 2, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.308 Vali Acc: 0.069 Test Loss: 3.308 Test Acc: 0.069
Validation loss decreased (-0.044672 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 0.8592679500579834
Epoch: 3, Steps: 10 | Train Loss: 3.172 Vali Loss: 3.318 Vali Acc: 0.069 Test Loss: 3.318 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8711488246917725
Epoch: 4, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.347 Vali Acc: 0.060 Test Loss: 3.347 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9242513179779053
Epoch: 5, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.350 Vali Acc: 0.065 Test Loss: 3.350 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9780864715576172
Epoch: 6, Steps: 10 | Train Loss: 3.018 Vali Loss: 3.329 Vali Acc: 0.076 Test Loss: 3.329 Test Acc: 0.076
Validation loss decreased (-0.069379 --> -0.076437).  Saving model ...
Epoch: 7 cost time: 0.8523588180541992
Epoch: 7, Steps: 10 | Train Loss: 2.968 Vali Loss: 3.321 Vali Acc: 0.082 Test Loss: 3.321 Test Acc: 0.082
Validation loss decreased (-0.076437 --> -0.082320).  Saving model ...
Epoch: 8 cost time: 0.942185640335083
Epoch: 8, Steps: 10 | Train Loss: 2.911 Vali Loss: 3.308 Vali Acc: 0.078 Test Loss: 3.308 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1109814643859863
Epoch: 9, Steps: 10 | Train Loss: 2.845 Vali Loss: 3.294 Vali Acc: 0.095 Test Loss: 3.294 Test Acc: 0.095
Validation loss decreased (-0.082320 --> -0.095261).  Saving model ...
Epoch: 10 cost time: 0.7936451435089111
Epoch: 10, Steps: 10 | Train Loss: 2.817 Vali Loss: 3.283 Vali Acc: 0.096 Test Loss: 3.283 Test Acc: 0.096
Validation loss decreased (-0.095261 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 0.8457586765289307
Epoch: 11, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.295 Vali Acc: 0.091 Test Loss: 3.295 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9744424819946289
Epoch: 12, Steps: 10 | Train Loss: 2.678 Vali Loss: 3.269 Vali Acc: 0.105 Test Loss: 3.269 Test Acc: 0.105
Validation loss decreased (-0.096438 --> -0.104673).  Saving model ...
Epoch: 13 cost time: 0.8803179264068604
Epoch: 13, Steps: 10 | Train Loss: 2.550 Vali Loss: 3.271 Vali Acc: 0.118 Test Loss: 3.271 Test Acc: 0.118
Validation loss decreased (-0.104673 --> -0.117614).  Saving model ...
Epoch: 14 cost time: 0.891993522644043
Epoch: 14, Steps: 10 | Train Loss: 2.470 Vali Loss: 3.270 Vali Acc: 0.125 Test Loss: 3.270 Test Acc: 0.125
Validation loss decreased (-0.117614 --> -0.124673).  Saving model ...
Epoch: 15 cost time: 0.9806175231933594
Epoch: 15, Steps: 10 | Train Loss: 2.371 Vali Loss: 3.254 Vali Acc: 0.121 Test Loss: 3.254 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9855237007141113
Epoch: 16, Steps: 10 | Train Loss: 2.290 Vali Loss: 3.242 Vali Acc: 0.128 Test Loss: 3.242 Test Acc: 0.128
Validation loss decreased (-0.124673 --> -0.128203).  Saving model ...
Epoch: 17 cost time: 0.9783899784088135
Epoch: 17, Steps: 10 | Train Loss: 2.193 Vali Loss: 3.278 Vali Acc: 0.125 Test Loss: 3.278 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8866362571716309
Epoch: 18, Steps: 10 | Train Loss: 2.041 Vali Loss: 3.283 Vali Acc: 0.148 Test Loss: 3.283 Test Acc: 0.148
Validation loss decreased (-0.128203 --> -0.148202).  Saving model ...
Epoch: 19 cost time: 0.9708819389343262
Epoch: 19, Steps: 10 | Train Loss: 1.930 Vali Loss: 3.278 Vali Acc: 0.151 Test Loss: 3.278 Test Acc: 0.151
Validation loss decreased (-0.148202 --> -0.150555).  Saving model ...
Epoch: 20 cost time: 0.9118585586547852
Epoch: 20, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.277 Vali Acc: 0.160 Test Loss: 3.277 Test Acc: 0.160
Validation loss decreased (-0.150555 --> -0.159967).  Saving model ...
Epoch: 21 cost time: 0.9389133453369141
Epoch: 21, Steps: 10 | Train Loss: 1.747 Vali Loss: 3.301 Vali Acc: 0.159 Test Loss: 3.301 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8236472606658936
Epoch: 22, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.310 Vali Acc: 0.164 Test Loss: 3.310 Test Acc: 0.164
Validation loss decreased (-0.159967 --> -0.163496).  Saving model ...
Epoch: 23 cost time: 0.972740650177002
Epoch: 23, Steps: 10 | Train Loss: 1.519 Vali Loss: 3.307 Vali Acc: 0.166 Test Loss: 3.307 Test Acc: 0.166
Validation loss decreased (-0.163496 --> -0.165849).  Saving model ...
Epoch: 24 cost time: 0.9144651889801025
Epoch: 24, Steps: 10 | Train Loss: 1.449 Vali Loss: 3.329 Vali Acc: 0.175 Test Loss: 3.329 Test Acc: 0.175
Validation loss decreased (-0.165849 --> -0.175261).  Saving model ...
Epoch: 25 cost time: 0.8979287147521973
Epoch: 25, Steps: 10 | Train Loss: 1.362 Vali Loss: 3.364 Vali Acc: 0.181 Test Loss: 3.364 Test Acc: 0.181
Validation loss decreased (-0.175261 --> -0.181143).  Saving model ...
Epoch: 26 cost time: 0.7746913433074951
Epoch: 26, Steps: 10 | Train Loss: 1.246 Vali Loss: 3.384 Vali Acc: 0.184 Test Loss: 3.384 Test Acc: 0.184
Validation loss decreased (-0.181143 --> -0.183496).  Saving model ...
Epoch: 27 cost time: 0.9864442348480225
Epoch: 27, Steps: 10 | Train Loss: 1.141 Vali Loss: 3.397 Vali Acc: 0.191 Test Loss: 3.397 Test Acc: 0.191
Validation loss decreased (-0.183496 --> -0.190554).  Saving model ...
Epoch: 28 cost time: 1.0599887371063232
Epoch: 28, Steps: 10 | Train Loss: 1.080 Vali Loss: 3.427 Vali Acc: 0.195 Test Loss: 3.427 Test Acc: 0.195
Validation loss decreased (-0.190554 --> -0.195260).  Saving model ...
Epoch: 29 cost time: 0.8924560546875
Epoch: 29, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.443 Vali Acc: 0.207 Test Loss: 3.443 Test Acc: 0.207
Validation loss decreased (-0.195260 --> -0.207024).  Saving model ...
Epoch: 30 cost time: 0.9681448936462402
Epoch: 30, Steps: 10 | Train Loss: 0.861 Vali Loss: 3.449 Vali Acc: 0.202 Test Loss: 3.449 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8410029411315918
Epoch: 31, Steps: 10 | Train Loss: 0.833 Vali Loss: 3.485 Vali Acc: 0.198 Test Loss: 3.485 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9617698192596436
Epoch: 32, Steps: 10 | Train Loss: 0.766 Vali Loss: 3.509 Vali Acc: 0.226 Test Loss: 3.509 Test Acc: 0.226
Validation loss decreased (-0.207024 --> -0.225847).  Saving model ...
Epoch: 33 cost time: 0.8812973499298096
Epoch: 33, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.577 Vali Acc: 0.204 Test Loss: 3.577 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9237637519836426
Epoch: 34, Steps: 10 | Train Loss: 0.613 Vali Loss: 3.588 Vali Acc: 0.228 Test Loss: 3.588 Test Acc: 0.228
Validation loss decreased (-0.225847 --> -0.228199).  Saving model ...
Epoch: 35 cost time: 1.0104272365570068
Epoch: 35, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.579 Vali Acc: 0.234 Test Loss: 3.579 Test Acc: 0.234
Validation loss decreased (-0.228199 --> -0.234082).  Saving model ...
Epoch: 36 cost time: 1.0508368015289307
Epoch: 36, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.635 Vali Acc: 0.214 Test Loss: 3.635 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9236676692962646
Epoch: 37, Steps: 10 | Train Loss: 0.419 Vali Loss: 3.646 Vali Acc: 0.231 Test Loss: 3.646 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7893991470336914
Epoch: 38, Steps: 10 | Train Loss: 0.407 Vali Loss: 3.706 Vali Acc: 0.229 Test Loss: 3.706 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.085810899734497
Epoch: 39, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.769 Vali Acc: 0.228 Test Loss: 3.769 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9138312339782715
Epoch: 40, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.737 Vali Acc: 0.247 Test Loss: 3.737 Test Acc: 0.247
Validation loss decreased (-0.234082 --> -0.247021).  Saving model ...
Epoch: 41 cost time: 0.7748315334320068
Epoch: 41, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.811 Vali Acc: 0.233 Test Loss: 3.811 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9435746669769287
Epoch: 42, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.843 Vali Acc: 0.238 Test Loss: 3.843 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9069962501525879
Epoch: 43, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.859 Vali Acc: 0.231 Test Loss: 3.859 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.098966360092163
Epoch: 44, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.907 Vali Acc: 0.236 Test Loss: 3.907 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0778119564056396
Epoch: 45, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.897 Vali Acc: 0.240 Test Loss: 3.897 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7658958435058594
Epoch: 46, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.962 Vali Acc: 0.235 Test Loss: 3.962 Test Acc: 0.235
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9274218082427979
Epoch: 47, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.957 Vali Acc: 0.245 Test Loss: 3.957 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0737082958221436
Epoch: 48, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.994 Vali Acc: 0.233 Test Loss: 3.994 Test Acc: 0.233
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.9121778011322021
Epoch: 49, Steps: 10 | Train Loss: 0.119 Vali Loss: 4.007 Vali Acc: 0.249 Test Loss: 4.007 Test Acc: 0.249
Validation loss decreased (-0.247021 --> -0.249372).  Saving model ...
Epoch: 50 cost time: 0.876784086227417
Epoch: 50, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.025 Vali Acc: 0.249 Test Loss: 4.025 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8895406723022461
Epoch: 51, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.072 Vali Acc: 0.238 Test Loss: 4.072 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0001533031463623
Epoch: 52, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.072 Vali Acc: 0.240 Test Loss: 4.072 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.9978020191192627
Epoch: 53, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.083 Vali Acc: 0.251 Test Loss: 4.083 Test Acc: 0.251
Validation loss decreased (-0.249372 --> -0.250547).  Saving model ...
Epoch: 54 cost time: 1.068084478378296
Epoch: 54, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.088 Vali Acc: 0.251 Test Loss: 4.088 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8693037033081055
Epoch: 55, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.134 Vali Acc: 0.245 Test Loss: 4.134 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.0039405822753906
Epoch: 56, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.160 Vali Acc: 0.247 Test Loss: 4.160 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.8623673915863037
Epoch: 57, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.191 Vali Acc: 0.244 Test Loss: 4.191 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.0393524169921875
Epoch: 58, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.212 Vali Acc: 0.242 Test Loss: 4.212 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.9860584735870361
Epoch: 59, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.231 Vali Acc: 0.246 Test Loss: 4.231 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.0243804454803467
Epoch: 60, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.249 Vali Acc: 0.241 Test Loss: 4.249 Test Acc: 0.241
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.8197038173675537
Epoch: 61, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.260 Vali Acc: 0.240 Test Loss: 4.260 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.8588986396789551
Epoch: 62, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.267 Vali Acc: 0.248 Test Loss: 4.267 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.9182229042053223
Epoch: 63, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.301 Vali Acc: 0.240 Test Loss: 4.301 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25058823529411767
model parameter : 113074
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1532726287841797
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.355 Vali Acc: 0.032 Test Loss: 3.355 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 0.9626235961914062
Epoch: 2, Steps: 10 | Train Loss: 3.274 Vali Loss: 3.319 Vali Acc: 0.036 Test Loss: 3.319 Test Acc: 0.036
Validation loss decreased (-0.031731 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 0.9027249813079834
Epoch: 3, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.321 Vali Acc: 0.047 Test Loss: 3.321 Test Acc: 0.047
Validation loss decreased (-0.036437 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 0.8711934089660645
Epoch: 4, Steps: 10 | Train Loss: 3.205 Vali Loss: 3.328 Vali Acc: 0.056 Test Loss: 3.328 Test Acc: 0.056
Validation loss decreased (-0.047026 --> -0.056437).  Saving model ...
Epoch: 5 cost time: 1.0439467430114746
Epoch: 5, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.331 Vali Acc: 0.052 Test Loss: 3.331 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0654163360595703
Epoch: 6, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.327 Vali Acc: 0.056 Test Loss: 3.327 Test Acc: 0.056
Validation loss decreased (-0.056437 --> -0.056437).  Saving model ...
Epoch: 7 cost time: 0.8380732536315918
Epoch: 7, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.319 Vali Acc: 0.052 Test Loss: 3.319 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0433197021484375
Epoch: 8, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.300 Vali Acc: 0.073 Test Loss: 3.300 Test Acc: 0.073
Validation loss decreased (-0.056437 --> -0.072908).  Saving model ...
Epoch: 9 cost time: 0.9132106304168701
Epoch: 9, Steps: 10 | Train Loss: 2.894 Vali Loss: 3.293 Vali Acc: 0.074 Test Loss: 3.293 Test Acc: 0.074
Validation loss decreased (-0.072908 --> -0.074085).  Saving model ...
Epoch: 10 cost time: 0.8804452419281006
Epoch: 10, Steps: 10 | Train Loss: 2.841 Vali Loss: 3.291 Vali Acc: 0.072 Test Loss: 3.291 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8874428272247314
Epoch: 11, Steps: 10 | Train Loss: 2.782 Vali Loss: 3.259 Vali Acc: 0.089 Test Loss: 3.259 Test Acc: 0.089
Validation loss decreased (-0.074085 --> -0.089379).  Saving model ...
Epoch: 12 cost time: 0.939612627029419
Epoch: 12, Steps: 10 | Train Loss: 2.700 Vali Loss: 3.253 Vali Acc: 0.094 Test Loss: 3.253 Test Acc: 0.094
Validation loss decreased (-0.089379 --> -0.094085).  Saving model ...
Epoch: 13 cost time: 0.8129744529724121
Epoch: 13, Steps: 10 | Train Loss: 2.639 Vali Loss: 3.304 Vali Acc: 0.092 Test Loss: 3.304 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9282383918762207
Epoch: 14, Steps: 10 | Train Loss: 2.534 Vali Loss: 3.259 Vali Acc: 0.113 Test Loss: 3.259 Test Acc: 0.113
Validation loss decreased (-0.094085 --> -0.112909).  Saving model ...
Epoch: 15 cost time: 0.8431301116943359
Epoch: 15, Steps: 10 | Train Loss: 2.498 Vali Loss: 3.261 Vali Acc: 0.119 Test Loss: 3.261 Test Acc: 0.119
Validation loss decreased (-0.112909 --> -0.118791).  Saving model ...
Epoch: 16 cost time: 0.9053754806518555
Epoch: 16, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.245 Vali Acc: 0.115 Test Loss: 3.245 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7678263187408447
Epoch: 17, Steps: 10 | Train Loss: 2.300 Vali Loss: 3.240 Vali Acc: 0.128 Test Loss: 3.240 Test Acc: 0.128
Validation loss decreased (-0.118791 --> -0.128203).  Saving model ...
Epoch: 18 cost time: 0.8705968856811523
Epoch: 18, Steps: 10 | Train Loss: 2.200 Vali Loss: 3.238 Vali Acc: 0.125 Test Loss: 3.238 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8070554733276367
Epoch: 19, Steps: 10 | Train Loss: 2.067 Vali Loss: 3.242 Vali Acc: 0.125 Test Loss: 3.242 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8887629508972168
Epoch: 20, Steps: 10 | Train Loss: 1.958 Vali Loss: 3.255 Vali Acc: 0.154 Test Loss: 3.255 Test Acc: 0.154
Validation loss decreased (-0.128203 --> -0.154085).  Saving model ...
Epoch: 21 cost time: 0.8615257740020752
Epoch: 21, Steps: 10 | Train Loss: 1.803 Vali Loss: 3.245 Vali Acc: 0.155 Test Loss: 3.245 Test Acc: 0.155
Validation loss decreased (-0.154085 --> -0.155262).  Saving model ...
Epoch: 22 cost time: 0.8657042980194092
Epoch: 22, Steps: 10 | Train Loss: 1.731 Vali Loss: 3.276 Vali Acc: 0.155 Test Loss: 3.276 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.816129207611084
Epoch: 23, Steps: 10 | Train Loss: 1.598 Vali Loss: 3.287 Vali Acc: 0.156 Test Loss: 3.287 Test Acc: 0.156
Validation loss decreased (-0.155262 --> -0.156438).  Saving model ...
Epoch: 24 cost time: 0.9690501689910889
Epoch: 24, Steps: 10 | Train Loss: 1.495 Vali Loss: 3.300 Vali Acc: 0.173 Test Loss: 3.300 Test Acc: 0.173
Validation loss decreased (-0.156438 --> -0.172908).  Saving model ...
Epoch: 25 cost time: 0.8139190673828125
Epoch: 25, Steps: 10 | Train Loss: 1.407 Vali Loss: 3.318 Vali Acc: 0.186 Test Loss: 3.318 Test Acc: 0.186
Validation loss decreased (-0.172908 --> -0.185849).  Saving model ...
Epoch: 26 cost time: 1.0218262672424316
Epoch: 26, Steps: 10 | Train Loss: 1.327 Vali Loss: 3.332 Vali Acc: 0.174 Test Loss: 3.332 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9078333377838135
Epoch: 27, Steps: 10 | Train Loss: 1.223 Vali Loss: 3.364 Vali Acc: 0.174 Test Loss: 3.364 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.958061695098877
Epoch: 28, Steps: 10 | Train Loss: 1.169 Vali Loss: 3.369 Vali Acc: 0.200 Test Loss: 3.369 Test Acc: 0.200
Validation loss decreased (-0.185849 --> -0.199966).  Saving model ...
Epoch: 29 cost time: 0.9186677932739258
Epoch: 29, Steps: 10 | Train Loss: 1.007 Vali Loss: 3.418 Vali Acc: 0.201 Test Loss: 3.418 Test Acc: 0.201
Validation loss decreased (-0.199966 --> -0.201142).  Saving model ...
Epoch: 30 cost time: 0.9798190593719482
Epoch: 30, Steps: 10 | Train Loss: 0.959 Vali Loss: 3.453 Vali Acc: 0.194 Test Loss: 3.453 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1215026378631592
Epoch: 31, Steps: 10 | Train Loss: 0.884 Vali Loss: 3.475 Vali Acc: 0.208 Test Loss: 3.475 Test Acc: 0.208
Validation loss decreased (-0.201142 --> -0.208201).  Saving model ...
Epoch: 32 cost time: 1.0017626285552979
Epoch: 32, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.450 Vali Acc: 0.212 Test Loss: 3.450 Test Acc: 0.212
Validation loss decreased (-0.208201 --> -0.211730).  Saving model ...
Epoch: 33 cost time: 0.9597508907318115
Epoch: 33, Steps: 10 | Train Loss: 0.718 Vali Loss: 3.505 Vali Acc: 0.224 Test Loss: 3.505 Test Acc: 0.224
Validation loss decreased (-0.211730 --> -0.223494).  Saving model ...
Epoch: 34 cost time: 0.8665890693664551
Epoch: 34, Steps: 10 | Train Loss: 0.653 Vali Loss: 3.536 Vali Acc: 0.222 Test Loss: 3.536 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9172730445861816
Epoch: 35, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.558 Vali Acc: 0.219 Test Loss: 3.558 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.877753496170044
Epoch: 36, Steps: 10 | Train Loss: 0.517 Vali Loss: 3.568 Vali Acc: 0.224 Test Loss: 3.568 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.896775484085083
Epoch: 37, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.643 Vali Acc: 0.234 Test Loss: 3.643 Test Acc: 0.234
Validation loss decreased (-0.223494 --> -0.234081).  Saving model ...
Epoch: 38 cost time: 0.8941776752471924
Epoch: 38, Steps: 10 | Train Loss: 0.409 Vali Loss: 3.673 Vali Acc: 0.229 Test Loss: 3.673 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9229152202606201
Epoch: 39, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.682 Vali Acc: 0.221 Test Loss: 3.682 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8762161731719971
Epoch: 40, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.721 Vali Acc: 0.234 Test Loss: 3.721 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8349409103393555
Epoch: 41, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.752 Vali Acc: 0.233 Test Loss: 3.752 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.936063289642334
Epoch: 42, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.806 Vali Acc: 0.242 Test Loss: 3.806 Test Acc: 0.242
Validation loss decreased (-0.234081 --> -0.242315).  Saving model ...
Epoch: 43 cost time: 0.854701042175293
Epoch: 43, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.867 Vali Acc: 0.244 Test Loss: 3.867 Test Acc: 0.244
Validation loss decreased (-0.242315 --> -0.243491).  Saving model ...
Epoch: 44 cost time: 0.9619219303131104
Epoch: 44, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.901 Vali Acc: 0.248 Test Loss: 3.901 Test Acc: 0.248
Validation loss decreased (-0.243491 --> -0.248196).  Saving model ...
Epoch: 45 cost time: 0.8745663166046143
Epoch: 45, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.878 Vali Acc: 0.252 Test Loss: 3.878 Test Acc: 0.252
Validation loss decreased (-0.248196 --> -0.251726).  Saving model ...
Epoch: 46 cost time: 1.017418384552002
Epoch: 46, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.921 Vali Acc: 0.249 Test Loss: 3.921 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9779508113861084
Epoch: 47, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.989 Vali Acc: 0.251 Test Loss: 3.989 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9337241649627686
Epoch: 48, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.972 Vali Acc: 0.249 Test Loss: 3.972 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8325581550598145
Epoch: 49, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.974 Vali Acc: 0.248 Test Loss: 3.974 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.026665210723877
Epoch: 50, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.008 Vali Acc: 0.238 Test Loss: 4.008 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.238173007965088
Epoch: 51, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.042 Vali Acc: 0.248 Test Loss: 4.042 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9720427989959717
Epoch: 52, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.082 Vali Acc: 0.251 Test Loss: 4.082 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.833552360534668
Epoch: 53, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.075 Vali Acc: 0.252 Test Loss: 4.075 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.1680223941802979
Epoch: 54, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.118 Vali Acc: 0.261 Test Loss: 4.118 Test Acc: 0.261
Validation loss decreased (-0.251726 --> -0.261135).  Saving model ...
Epoch: 55 cost time: 0.977841854095459
Epoch: 55, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.124 Vali Acc: 0.255 Test Loss: 4.124 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.1215386390686035
Epoch: 56, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.145 Vali Acc: 0.252 Test Loss: 4.145 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.867375373840332
Epoch: 57, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.175 Vali Acc: 0.252 Test Loss: 4.175 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.9309906959533691
Epoch: 58, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.204 Vali Acc: 0.254 Test Loss: 4.204 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8808398246765137
Epoch: 59, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.236 Vali Acc: 0.251 Test Loss: 4.236 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.9377787113189697
Epoch: 60, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.219 Vali Acc: 0.249 Test Loss: 4.219 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.9037384986877441
Epoch: 61, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.217 Vali Acc: 0.254 Test Loss: 4.217 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.8267641067504883
Epoch: 62, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.257 Vali Acc: 0.254 Test Loss: 4.257 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.770850658416748
Epoch: 63, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.311 Vali Acc: 0.248 Test Loss: 4.311 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.9477431774139404
Epoch: 64, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.282 Vali Acc: 0.249 Test Loss: 4.282 Test Acc: 0.249
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 112658
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5185070037841797
Epoch: 1, Steps: 10 | Train Loss: 3.330 Vali Loss: 3.391 Vali Acc: 0.042 Test Loss: 3.391 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 0.9030230045318604
Epoch: 2, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.339 Vali Acc: 0.045 Test Loss: 3.339 Test Acc: 0.045
Validation loss decreased (-0.042319 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 0.8566544055938721
Epoch: 3, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.323 Vali Acc: 0.062 Test Loss: 3.323 Test Acc: 0.062
Validation loss decreased (-0.044672 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.9635357856750488
Epoch: 4, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.332 Vali Acc: 0.059 Test Loss: 3.332 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7909736633300781
Epoch: 5, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.329 Vali Acc: 0.074 Test Loss: 3.329 Test Acc: 0.074
Validation loss decreased (-0.062320 --> -0.074084).  Saving model ...
Epoch: 6 cost time: 0.9313626289367676
Epoch: 6, Steps: 10 | Train Loss: 3.048 Vali Loss: 3.314 Vali Acc: 0.071 Test Loss: 3.314 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8124725818634033
Epoch: 7, Steps: 10 | Train Loss: 2.975 Vali Loss: 3.300 Vali Acc: 0.075 Test Loss: 3.300 Test Acc: 0.075
Validation loss decreased (-0.074084 --> -0.075261).  Saving model ...
Epoch: 8 cost time: 0.8901534080505371
Epoch: 8, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.286 Vali Acc: 0.080 Test Loss: 3.286 Test Acc: 0.080
Validation loss decreased (-0.075261 --> -0.079967).  Saving model ...
Epoch: 9 cost time: 0.7856266498565674
Epoch: 9, Steps: 10 | Train Loss: 2.864 Vali Loss: 3.270 Vali Acc: 0.084 Test Loss: 3.270 Test Acc: 0.084
Validation loss decreased (-0.079967 --> -0.083497).  Saving model ...
Epoch: 10 cost time: 0.8344745635986328
Epoch: 10, Steps: 10 | Train Loss: 2.770 Vali Loss: 3.265 Vali Acc: 0.098 Test Loss: 3.265 Test Acc: 0.098
Validation loss decreased (-0.083497 --> -0.097614).  Saving model ...
Epoch: 11 cost time: 1.187206506729126
Epoch: 11, Steps: 10 | Train Loss: 2.698 Vali Loss: 3.263 Vali Acc: 0.105 Test Loss: 3.263 Test Acc: 0.105
Validation loss decreased (-0.097614 --> -0.104673).  Saving model ...
Epoch: 12 cost time: 0.9464304447174072
Epoch: 12, Steps: 10 | Train Loss: 2.625 Vali Loss: 3.253 Vali Acc: 0.122 Test Loss: 3.253 Test Acc: 0.122
Validation loss decreased (-0.104673 --> -0.122320).  Saving model ...
Epoch: 13 cost time: 0.7640478610992432
Epoch: 13, Steps: 10 | Train Loss: 2.518 Vali Loss: 3.252 Vali Acc: 0.106 Test Loss: 3.252 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9676463603973389
Epoch: 14, Steps: 10 | Train Loss: 2.446 Vali Loss: 3.241 Vali Acc: 0.113 Test Loss: 3.241 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8357670307159424
Epoch: 15, Steps: 10 | Train Loss: 2.346 Vali Loss: 3.231 Vali Acc: 0.129 Test Loss: 3.231 Test Acc: 0.129
Validation loss decreased (-0.122320 --> -0.129379).  Saving model ...
Epoch: 16 cost time: 0.8794083595275879
Epoch: 16, Steps: 10 | Train Loss: 2.258 Vali Loss: 3.234 Vali Acc: 0.145 Test Loss: 3.234 Test Acc: 0.145
Validation loss decreased (-0.129379 --> -0.144674).  Saving model ...
Epoch: 17 cost time: 0.8092489242553711
Epoch: 17, Steps: 10 | Train Loss: 2.183 Vali Loss: 3.238 Vali Acc: 0.151 Test Loss: 3.238 Test Acc: 0.151
Validation loss decreased (-0.144674 --> -0.150556).  Saving model ...
Epoch: 18 cost time: 0.7797548770904541
Epoch: 18, Steps: 10 | Train Loss: 2.059 Vali Loss: 3.221 Vali Acc: 0.152 Test Loss: 3.221 Test Acc: 0.152
Validation loss decreased (-0.150556 --> -0.151732).  Saving model ...
Epoch: 19 cost time: 0.7745578289031982
Epoch: 19, Steps: 10 | Train Loss: 1.947 Vali Loss: 3.251 Vali Acc: 0.147 Test Loss: 3.251 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0371863842010498
Epoch: 20, Steps: 10 | Train Loss: 1.820 Vali Loss: 3.238 Vali Acc: 0.161 Test Loss: 3.238 Test Acc: 0.161
Validation loss decreased (-0.151732 --> -0.161144).  Saving model ...
Epoch: 21 cost time: 0.9880790710449219
Epoch: 21, Steps: 10 | Train Loss: 1.782 Vali Loss: 3.239 Vali Acc: 0.166 Test Loss: 3.239 Test Acc: 0.166
Validation loss decreased (-0.161144 --> -0.165850).  Saving model ...
Epoch: 22 cost time: 0.8276386260986328
Epoch: 22, Steps: 10 | Train Loss: 1.637 Vali Loss: 3.280 Vali Acc: 0.171 Test Loss: 3.280 Test Acc: 0.171
Validation loss decreased (-0.165850 --> -0.170555).  Saving model ...
Epoch: 23 cost time: 0.8507289886474609
Epoch: 23, Steps: 10 | Train Loss: 1.555 Vali Loss: 3.263 Vali Acc: 0.181 Test Loss: 3.263 Test Acc: 0.181
Validation loss decreased (-0.170555 --> -0.181144).  Saving model ...
Epoch: 24 cost time: 1.0503756999969482
Epoch: 24, Steps: 10 | Train Loss: 1.402 Vali Loss: 3.288 Vali Acc: 0.175 Test Loss: 3.288 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1020972728729248
Epoch: 25, Steps: 10 | Train Loss: 1.339 Vali Loss: 3.305 Vali Acc: 0.193 Test Loss: 3.305 Test Acc: 0.193
Validation loss decreased (-0.181144 --> -0.192908).  Saving model ...
Epoch: 26 cost time: 1.1423840522766113
Epoch: 26, Steps: 10 | Train Loss: 1.221 Vali Loss: 3.335 Vali Acc: 0.200 Test Loss: 3.335 Test Acc: 0.200
Validation loss decreased (-0.192908 --> -0.199967).  Saving model ...
Epoch: 27 cost time: 0.817302942276001
Epoch: 27, Steps: 10 | Train Loss: 1.139 Vali Loss: 3.346 Vali Acc: 0.215 Test Loss: 3.346 Test Acc: 0.215
Validation loss decreased (-0.199967 --> -0.215261).  Saving model ...
Epoch: 28 cost time: 0.8474254608154297
Epoch: 28, Steps: 10 | Train Loss: 1.051 Vali Loss: 3.370 Vali Acc: 0.206 Test Loss: 3.370 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9407796859741211
Epoch: 29, Steps: 10 | Train Loss: 0.996 Vali Loss: 3.382 Vali Acc: 0.213 Test Loss: 3.382 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8412103652954102
Epoch: 30, Steps: 10 | Train Loss: 0.916 Vali Loss: 3.437 Vali Acc: 0.204 Test Loss: 3.437 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8919186592102051
Epoch: 31, Steps: 10 | Train Loss: 0.802 Vali Loss: 3.426 Vali Acc: 0.225 Test Loss: 3.426 Test Acc: 0.225
Validation loss decreased (-0.215261 --> -0.224672).  Saving model ...
Epoch: 32 cost time: 0.8599708080291748
Epoch: 32, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.488 Vali Acc: 0.222 Test Loss: 3.488 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.848285436630249
Epoch: 33, Steps: 10 | Train Loss: 0.676 Vali Loss: 3.491 Vali Acc: 0.231 Test Loss: 3.491 Test Acc: 0.231
Validation loss decreased (-0.224672 --> -0.230553).  Saving model ...
Epoch: 34 cost time: 0.8591005802154541
Epoch: 34, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.548 Vali Acc: 0.221 Test Loss: 3.548 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8969230651855469
Epoch: 35, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.587 Vali Acc: 0.222 Test Loss: 3.587 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8467135429382324
Epoch: 36, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.584 Vali Acc: 0.238 Test Loss: 3.584 Test Acc: 0.238
Validation loss decreased (-0.230553 --> -0.237611).  Saving model ...
Epoch: 37 cost time: 1.1093425750732422
Epoch: 37, Steps: 10 | Train Loss: 0.436 Vali Loss: 3.682 Vali Acc: 0.231 Test Loss: 3.682 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8437173366546631
Epoch: 38, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.652 Vali Acc: 0.231 Test Loss: 3.652 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9673311710357666
Epoch: 39, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.675 Vali Acc: 0.242 Test Loss: 3.675 Test Acc: 0.242
Validation loss decreased (-0.237611 --> -0.242316).  Saving model ...
Epoch: 40 cost time: 0.7565112113952637
Epoch: 40, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.761 Vali Acc: 0.241 Test Loss: 3.761 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8953864574432373
Epoch: 41, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.750 Vali Acc: 0.247 Test Loss: 3.750 Test Acc: 0.247
Validation loss decreased (-0.242316 --> -0.247021).  Saving model ...
Epoch: 42 cost time: 0.9368436336517334
Epoch: 42, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.795 Vali Acc: 0.238 Test Loss: 3.795 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9487287998199463
Epoch: 43, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.873 Vali Acc: 0.232 Test Loss: 3.873 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9183523654937744
Epoch: 44, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.838 Vali Acc: 0.240 Test Loss: 3.838 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9373476505279541
Epoch: 45, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.871 Vali Acc: 0.239 Test Loss: 3.871 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8526046276092529
Epoch: 46, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.954 Vali Acc: 0.245 Test Loss: 3.954 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9896044731140137
Epoch: 47, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.967 Vali Acc: 0.240 Test Loss: 3.967 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9511103630065918
Epoch: 48, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.964 Vali Acc: 0.239 Test Loss: 3.964 Test Acc: 0.239
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.087195873260498
Epoch: 49, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.028 Vali Acc: 0.241 Test Loss: 4.028 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9115896224975586
Epoch: 50, Steps: 10 | Train Loss: 0.115 Vali Loss: 4.033 Vali Acc: 0.241 Test Loss: 4.033 Test Acc: 0.241
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.755842924118042
Epoch: 51, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.067 Vali Acc: 0.239 Test Loss: 4.067 Test Acc: 0.239
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_Crossformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24705882352941178
model parameter : 112242
model size : 1.10MB
