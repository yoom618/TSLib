Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4470579624176025
Epoch: 1, Steps: 8 | Train Loss: 2.175 Vali Loss: 1.987 Vali Acc: 0.281 Test Loss: 1.987 Test Acc: 0.281
Validation loss decreased (inf --> -0.281230).  Saving model ...
Epoch: 2 cost time: 1.9693071842193604
Epoch: 2, Steps: 8 | Train Loss: 1.957 Vali Loss: 1.512 Vali Acc: 0.609 Test Loss: 1.512 Test Acc: 0.609
Validation loss decreased (-0.281230 --> -0.609360).  Saving model ...
Epoch: 3 cost time: 1.9921824932098389
Epoch: 3, Steps: 8 | Train Loss: 1.176 Vali Loss: 0.935 Vali Acc: 0.731 Test Loss: 0.935 Test Acc: 0.731
Validation loss decreased (-0.609360 --> -0.731241).  Saving model ...
Epoch: 4 cost time: 1.9175362586975098
Epoch: 4, Steps: 8 | Train Loss: 0.727 Vali Loss: 0.625 Vali Acc: 0.794 Test Loss: 0.625 Test Acc: 0.794
Validation loss decreased (-0.731241 --> -0.793744).  Saving model ...
Epoch: 5 cost time: 2.215548038482666
Epoch: 5, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.562 Vali Acc: 0.834 Test Loss: 0.562 Test Acc: 0.834
Validation loss decreased (-0.793744 --> -0.834369).  Saving model ...
Epoch: 6 cost time: 2.317739963531494
Epoch: 6, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.551 Vali Acc: 0.812 Test Loss: 0.551 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9468975067138672
Epoch: 7, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1610782146453857
Epoch: 8, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.023918628692627
Epoch: 9, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.541 Vali Acc: 0.828 Test Loss: 0.541 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.27462100982666
Epoch: 10, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.045171022415161
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.592 Vali Acc: 0.816 Test Loss: 0.592 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9573988914489746
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840620).  Saving model ...
Epoch: 13 cost time: 1.7911691665649414
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7779178619384766
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.595 Vali Acc: 0.841 Test Loss: 0.595 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9471158981323242
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.606 Vali Acc: 0.819 Test Loss: 0.606 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8338298797607422
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.998628854751587
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.598 Vali Acc: 0.838 Test Loss: 0.598 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.519714593887329
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843744).  Saving model ...
Epoch: 19 cost time: 2.2674365043640137
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.595 Vali Acc: 0.853 Test Loss: 0.595 Test Acc: 0.853
Validation loss decreased (-0.843744 --> -0.853119).  Saving model ...
Epoch: 20 cost time: 1.9058911800384521
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.590 Vali Acc: 0.847 Test Loss: 0.590 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.399479866027832
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.592 Vali Acc: 0.841 Test Loss: 0.592 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7132668495178223
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1208198070526123
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9510211944580078
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.04876446723938
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.273318290710449
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.188973903656006
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.853 Test Loss: 0.598 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.825697422027588
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.847 Test Loss: 0.610 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7742621898651123
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.623 Vali Acc: 0.841 Test Loss: 0.623 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 14349892
model size : 59.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7698073387145996
Epoch: 1, Steps: 8 | Train Loss: 2.131 Vali Loss: 1.871 Vali Acc: 0.403 Test Loss: 1.871 Test Acc: 0.403
Validation loss decreased (inf --> -0.403106).  Saving model ...
Epoch: 2 cost time: 2.0505170822143555
Epoch: 2, Steps: 8 | Train Loss: 1.724 Vali Loss: 1.271 Vali Acc: 0.747 Test Loss: 1.271 Test Acc: 0.747
Validation loss decreased (-0.403106 --> -0.746862).  Saving model ...
Epoch: 3 cost time: 2.0267114639282227
Epoch: 3, Steps: 8 | Train Loss: 1.101 Vali Loss: 0.786 Vali Acc: 0.841 Test Loss: 0.786 Test Acc: 0.841
Validation loss decreased (-0.746862 --> -0.840617).  Saving model ...
Epoch: 4 cost time: 2.1457386016845703
Epoch: 4, Steps: 8 | Train Loss: 0.695 Vali Loss: 0.577 Vali Acc: 0.847 Test Loss: 0.577 Test Acc: 0.847
Validation loss decreased (-0.840617 --> -0.846869).  Saving model ...
Epoch: 5 cost time: 2.3571202754974365
Epoch: 5, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4282426834106445
Epoch: 6, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7387874126434326
Epoch: 7, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8182604312896729
Epoch: 8, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6512641906738281
Epoch: 9, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.829643726348877
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 1.9917881488800049
Epoch: 11, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5075621604919434
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9701533317565918
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6693406105041504
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.584 Vali Acc: 0.825 Test Loss: 0.584 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.186337471008301
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.535 Vali Acc: 0.853 Test Loss: 0.535 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 1.838963508605957
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859370).  Saving model ...
Epoch: 17 cost time: 1.6969921588897705
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.550 Vali Acc: 0.831 Test Loss: 0.550 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9740638732910156
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.539 Vali Acc: 0.859 Test Loss: 0.539 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5479090213775635
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.533 Vali Acc: 0.863 Test Loss: 0.533 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 20 cost time: 1.7157082557678223
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.538 Vali Acc: 0.859 Test Loss: 0.538 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7513728141784668
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.567 Vali Acc: 0.859 Test Loss: 0.567 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7741856575012207
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.863 Test Loss: 0.564 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7059285640716553
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.866 Test Loss: 0.558 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 24 cost time: 1.8357512950897217
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.552 Vali Acc: 0.863 Test Loss: 0.552 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0379555225372314
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.549 Vali Acc: 0.866 Test Loss: 0.549 Test Acc: 0.866
Validation loss decreased (-0.865619 --> -0.865620).  Saving model ...
Epoch: 26 cost time: 1.7312722206115723
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.863 Test Loss: 0.557 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.969773292541504
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.863 Test Loss: 0.565 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.969137191772461
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.863 Test Loss: 0.571 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8979408740997314
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.863 Test Loss: 0.581 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8113012313842773
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.863 Test Loss: 0.576 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5993309020996094
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.863 Test Loss: 0.563 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6858811378479004
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.863 Test Loss: 0.570 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.1811327934265137
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.859 Test Loss: 0.575 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.804349660873413
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8058483600616455
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.863 Test Loss: 0.596 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 14336580
model size : 59.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.119061231613159
Epoch: 1, Steps: 8 | Train Loss: 2.174 Vali Loss: 1.961 Vali Acc: 0.247 Test Loss: 1.961 Test Acc: 0.247
Validation loss decreased (inf --> -0.246855).  Saving model ...
Epoch: 2 cost time: 1.9303972721099854
Epoch: 2, Steps: 8 | Train Loss: 1.798 Vali Loss: 1.406 Vali Acc: 0.675 Test Loss: 1.406 Test Acc: 0.675
Validation loss decreased (-0.246855 --> -0.674986).  Saving model ...
Epoch: 3 cost time: 2.019636869430542
Epoch: 3, Steps: 8 | Train Loss: 1.168 Vali Loss: 0.932 Vali Acc: 0.738 Test Loss: 0.932 Test Acc: 0.738
Validation loss decreased (-0.674986 --> -0.737491).  Saving model ...
Epoch: 4 cost time: 1.8773260116577148
Epoch: 4, Steps: 8 | Train Loss: 0.798 Vali Loss: 0.630 Vali Acc: 0.831 Test Loss: 0.630 Test Acc: 0.831
Validation loss decreased (-0.737491 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 2.036412000656128
Epoch: 5, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.602 Vali Acc: 0.806 Test Loss: 0.602 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.19804048538208
Epoch: 6, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.339304208755493
Epoch: 7, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.592 Vali Acc: 0.812 Test Loss: 0.592 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1564230918884277
Epoch: 8, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1430814266204834
Epoch: 9, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
Validation loss decreased (-0.831244 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 1.943495750427246
Epoch: 10, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2996389865875244
Epoch: 11, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.595 Vali Acc: 0.806 Test Loss: 0.595 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9928224086761475
Epoch: 12, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.604 Vali Acc: 0.828 Test Loss: 0.604 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.330127477645874
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7813420295715332
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 15 cost time: 1.7434351444244385
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.536 Vali Acc: 0.866 Test Loss: 0.536 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865620).  Saving model ...
Epoch: 16 cost time: 2.3235185146331787
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.229916572570801
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.558 Vali Acc: 0.853 Test Loss: 0.558 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.250105619430542
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9238250255584717
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.553 Vali Acc: 0.859 Test Loss: 0.553 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1898036003112793
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.0085878372192383
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.0170209407806396
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.853 Test Loss: 0.568 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.0823371410369873
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.859 Test Loss: 0.573 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.3683741092681885
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.853 Test Loss: 0.585 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1347436904907227
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.582 Vali Acc: 0.859 Test Loss: 0.582 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 14323268
model size : 59.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9046201705932617
Epoch: 1, Steps: 8 | Train Loss: 2.221 Vali Loss: 1.969 Vali Acc: 0.194 Test Loss: 1.969 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 1.7882895469665527
Epoch: 2, Steps: 8 | Train Loss: 1.896 Vali Loss: 1.393 Vali Acc: 0.678 Test Loss: 1.393 Test Acc: 0.678
Validation loss decreased (-0.193730 --> -0.678111).  Saving model ...
Epoch: 3 cost time: 1.7091867923736572
Epoch: 3, Steps: 8 | Train Loss: 1.231 Vali Loss: 0.948 Vali Acc: 0.753 Test Loss: 0.948 Test Acc: 0.753
Validation loss decreased (-0.678111 --> -0.753116).  Saving model ...
Epoch: 4 cost time: 1.9472401142120361
Epoch: 4, Steps: 8 | Train Loss: 0.765 Vali Loss: 0.648 Vali Acc: 0.787 Test Loss: 0.648 Test Acc: 0.787
Validation loss decreased (-0.753116 --> -0.787494).  Saving model ...
Epoch: 5 cost time: 1.9567186832427979
Epoch: 5, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.562 Vali Acc: 0.838 Test Loss: 0.562 Test Acc: 0.838
Validation loss decreased (-0.787494 --> -0.837494).  Saving model ...
Epoch: 6 cost time: 1.9159090518951416
Epoch: 6, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.538 Vali Acc: 0.847 Test Loss: 0.538 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 1.7077515125274658
Epoch: 7, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.826824426651001
Epoch: 8, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8750555515289307
Epoch: 9, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8081302642822266
Epoch: 10, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.59185528755188
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 2.244229555130005
Epoch: 12, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9634160995483398
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.510 Vali Acc: 0.863 Test Loss: 0.510 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 14 cost time: 1.9479219913482666
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.555 Vali Acc: 0.847 Test Loss: 0.555 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9840664863586426
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.591 Vali Acc: 0.847 Test Loss: 0.591 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9334800243377686
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.542 Vali Acc: 0.869 Test Loss: 0.542 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 17 cost time: 2.019263505935669
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.548 Vali Acc: 0.853 Test Loss: 0.548 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2049312591552734
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.556 Vali Acc: 0.859 Test Loss: 0.556 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7258620262145996
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.558 Vali Acc: 0.859 Test Loss: 0.558 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9108316898345947
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.567 Vali Acc: 0.859 Test Loss: 0.567 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7278721332550049
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.859 Test Loss: 0.568 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.67203950881958
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.560 Vali Acc: 0.866 Test Loss: 0.560 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7372159957885742
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.866 Test Loss: 0.559 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8213958740234375
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.866 Test Loss: 0.561 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6609821319580078
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.866 Test Loss: 0.565 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5970432758331299
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.869 Test Loss: 0.569 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 14309956
model size : 59.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.799238920211792
Epoch: 1, Steps: 8 | Train Loss: 2.273 Vali Loss: 2.031 Vali Acc: 0.216 Test Loss: 2.031 Test Acc: 0.216
Validation loss decreased (inf --> -0.215605).  Saving model ...
Epoch: 2 cost time: 1.971658706665039
Epoch: 2, Steps: 8 | Train Loss: 1.933 Vali Loss: 1.489 Vali Acc: 0.659 Test Loss: 1.489 Test Acc: 0.659
Validation loss decreased (-0.215605 --> -0.659360).  Saving model ...
Epoch: 3 cost time: 2.2171833515167236
Epoch: 3, Steps: 8 | Train Loss: 1.369 Vali Loss: 1.013 Vali Acc: 0.731 Test Loss: 1.013 Test Acc: 0.731
Validation loss decreased (-0.659360 --> -0.731240).  Saving model ...
Epoch: 4 cost time: 1.9114394187927246
Epoch: 4, Steps: 8 | Train Loss: 0.854 Vali Loss: 0.704 Vali Acc: 0.803 Test Loss: 0.704 Test Acc: 0.803
Validation loss decreased (-0.731240 --> -0.803118).  Saving model ...
Epoch: 5 cost time: 1.9512684345245361
Epoch: 5, Steps: 8 | Train Loss: 0.527 Vali Loss: 0.576 Vali Acc: 0.812 Test Loss: 0.576 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 1.6424615383148193
Epoch: 6, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
Validation loss decreased (-0.812494 --> -0.837494).  Saving model ...
Epoch: 7 cost time: 1.991917610168457
Epoch: 7, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.501 Vali Acc: 0.825 Test Loss: 0.501 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0385355949401855
Epoch: 8, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2639236450195312
Epoch: 9, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 2.2587389945983887
Epoch: 10, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.491 Vali Acc: 0.853 Test Loss: 0.491 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 1.906869888305664
Epoch: 11, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.526 Vali Acc: 0.831 Test Loss: 0.526 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2847607135772705
Epoch: 12, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.533 Vali Acc: 0.847 Test Loss: 0.533 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0940325260162354
Epoch: 13, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0149052143096924
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.538 Vali Acc: 0.847 Test Loss: 0.538 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.036734104156494
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1857993602752686
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.117154359817505
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.514 Vali Acc: 0.866 Test Loss: 0.514 Test Acc: 0.866
Validation loss decreased (-0.853120 --> -0.865620).  Saving model ...
Epoch: 18 cost time: 2.070601224899292
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.533 Vali Acc: 0.859 Test Loss: 0.533 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0403029918670654
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.533 Vali Acc: 0.859 Test Loss: 0.533 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.181837558746338
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.535 Vali Acc: 0.853 Test Loss: 0.535 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9160115718841553
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1411221027374268
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.544 Vali Acc: 0.853 Test Loss: 0.544 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.135789155960083
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.544 Vali Acc: 0.863 Test Loss: 0.544 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1340739727020264
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.543 Vali Acc: 0.859 Test Loss: 0.543 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.115255117416382
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.866 Test Loss: 0.544 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.0516605377197266
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.546 Vali Acc: 0.859 Test Loss: 0.546 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8670365810394287
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.551 Vali Acc: 0.869 Test Loss: 0.551 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868744).  Saving model ...
Epoch: 28 cost time: 1.9693291187286377
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.863 Test Loss: 0.549 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9812517166137695
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871870).  Saving model ...
Epoch: 30 cost time: 1.9995617866516113
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.551 Vali Acc: 0.863 Test Loss: 0.551 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9235496520996094
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.866 Test Loss: 0.557 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.137734889984131
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.869 Test Loss: 0.556 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9355573654174805
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.863 Test Loss: 0.556 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.185272455215454
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.869 Test Loss: 0.560 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.005030632019043
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.859 Test Loss: 0.561 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8160638809204102
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.866 Test Loss: 0.565 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.1443910598754883
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.872 Test Loss: 0.567 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.78358793258667
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.872 Test Loss: 0.567 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.097538948059082
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.869 Test Loss: 0.571 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 11985988
model size : 50.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.167902946472168
Epoch: 1, Steps: 8 | Train Loss: 2.105 Vali Loss: 1.995 Vali Acc: 0.222 Test Loss: 1.995 Test Acc: 0.222
Validation loss decreased (inf --> -0.221855).  Saving model ...
Epoch: 2 cost time: 1.9620139598846436
Epoch: 2, Steps: 8 | Train Loss: 1.920 Vali Loss: 1.483 Vali Acc: 0.625 Test Loss: 1.483 Test Acc: 0.625
Validation loss decreased (-0.221855 --> -0.624985).  Saving model ...
Epoch: 3 cost time: 1.9827604293823242
Epoch: 3, Steps: 8 | Train Loss: 1.391 Vali Loss: 0.965 Vali Acc: 0.803 Test Loss: 0.965 Test Acc: 0.803
Validation loss decreased (-0.624985 --> -0.803115).  Saving model ...
Epoch: 4 cost time: 2.1568691730499268
Epoch: 4, Steps: 8 | Train Loss: 0.901 Vali Loss: 0.694 Vali Acc: 0.828 Test Loss: 0.694 Test Acc: 0.828
Validation loss decreased (-0.803115 --> -0.828118).  Saving model ...
Epoch: 5 cost time: 2.241133689880371
Epoch: 5, Steps: 8 | Train Loss: 0.531 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1494698524475098
Epoch: 6, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
Validation loss decreased (-0.828118 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 2.045083999633789
Epoch: 7, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 1.9668843746185303
Epoch: 8, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.496 Vali Acc: 0.866 Test Loss: 0.496 Test Acc: 0.866
Validation loss decreased (-0.840620 --> -0.865620).  Saving model ...
Epoch: 9 cost time: 1.6508572101593018
Epoch: 9, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.530 Vali Acc: 0.828 Test Loss: 0.530 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.874577522277832
Epoch: 10, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.492 Vali Acc: 0.859 Test Loss: 0.492 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.73813796043396
Epoch: 11, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6579973697662354
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.519 Vali Acc: 0.853 Test Loss: 0.519 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.708677053451538
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.514 Vali Acc: 0.853 Test Loss: 0.514 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.626795768737793
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.515 Vali Acc: 0.872 Test Loss: 0.515 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871870).  Saving model ...
Epoch: 15 cost time: 1.8970038890838623
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8852179050445557
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.526 Vali Acc: 0.863 Test Loss: 0.526 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8353149890899658
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.533 Vali Acc: 0.866 Test Loss: 0.533 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0288174152374268
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.564 Vali Acc: 0.859 Test Loss: 0.564 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1320440769195557
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.564 Vali Acc: 0.866 Test Loss: 0.564 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.888770580291748
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.548 Vali Acc: 0.869 Test Loss: 0.548 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.748816728591919
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.549 Vali Acc: 0.863 Test Loss: 0.549 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.19486141204834
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.555 Vali Acc: 0.869 Test Loss: 0.555 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7381556034088135
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.555 Vali Acc: 0.872 Test Loss: 0.555 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.751638412475586
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.863 Test Loss: 0.567 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 11972676
model size : 50.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.28912353515625
Epoch: 1, Steps: 8 | Train Loss: 2.104 Vali Loss: 1.916 Vali Acc: 0.306 Test Loss: 1.916 Test Acc: 0.306
Validation loss decreased (inf --> -0.306231).  Saving model ...
Epoch: 2 cost time: 1.6522221565246582
Epoch: 2, Steps: 8 | Train Loss: 1.818 Vali Loss: 1.447 Vali Acc: 0.616 Test Loss: 1.447 Test Acc: 0.616
Validation loss decreased (-0.306231 --> -0.615611).  Saving model ...
Epoch: 3 cost time: 1.9696834087371826
Epoch: 3, Steps: 8 | Train Loss: 1.269 Vali Loss: 0.957 Vali Acc: 0.806 Test Loss: 0.957 Test Acc: 0.806
Validation loss decreased (-0.615611 --> -0.806240).  Saving model ...
Epoch: 4 cost time: 2.1730103492736816
Epoch: 4, Steps: 8 | Train Loss: 0.787 Vali Loss: 0.703 Vali Acc: 0.806 Test Loss: 0.703 Test Acc: 0.806
Validation loss decreased (-0.806240 --> -0.806243).  Saving model ...
Epoch: 5 cost time: 1.8988583087921143
Epoch: 5, Steps: 8 | Train Loss: 0.561 Vali Loss: 0.628 Vali Acc: 0.806 Test Loss: 0.628 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806244).  Saving model ...
Epoch: 6 cost time: 1.9631543159484863
Epoch: 6, Steps: 8 | Train Loss: 0.449 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
Validation loss decreased (-0.806244 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 1.841097116470337
Epoch: 7, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 1.825005054473877
Epoch: 8, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.593 Vali Acc: 0.806 Test Loss: 0.593 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2400927543640137
Epoch: 9, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.474 Vali Acc: 0.831 Test Loss: 0.474 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.407853126525879
Epoch: 10, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 1.9610364437103271
Epoch: 11, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.947054386138916
Epoch: 12, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.497 Vali Acc: 0.844 Test Loss: 0.497 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8241875171661377
Epoch: 13, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.571 Vali Acc: 0.825 Test Loss: 0.571 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0819239616394043
Epoch: 14, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.604 Vali Acc: 0.828 Test Loss: 0.604 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9470739364624023
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1873021125793457
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.974071979522705
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.610 Vali Acc: 0.838 Test Loss: 0.610 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.935032606124878
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.553 Vali Acc: 0.853 Test Loss: 0.553 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853119).  Saving model ...
Epoch: 19 cost time: 1.60402250289917
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.538 Vali Acc: 0.853 Test Loss: 0.538 Test Acc: 0.853
Validation loss decreased (-0.853119 --> -0.853120).  Saving model ...
Epoch: 20 cost time: 2.005289077758789
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 21 cost time: 2.069896936416626
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.538 Vali Acc: 0.863 Test Loss: 0.538 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 22 cost time: 2.2713072299957275
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.535 Vali Acc: 0.863 Test Loss: 0.535 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 23 cost time: 1.8016421794891357
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.544 Vali Acc: 0.863 Test Loss: 0.544 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7504849433898926
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.550 Vali Acc: 0.866 Test Loss: 0.550 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 25 cost time: 1.8297834396362305
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.554 Vali Acc: 0.863 Test Loss: 0.554 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0119590759277344
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.554 Vali Acc: 0.863 Test Loss: 0.554 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0804624557495117
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.859 Test Loss: 0.556 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8067069053649902
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.863 Test Loss: 0.559 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.882552146911621
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.863 Test Loss: 0.558 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.868940830230713
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.863 Test Loss: 0.561 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.904116153717041
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.863 Test Loss: 0.562 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.8654086589813232
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.859 Test Loss: 0.564 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9945006370544434
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.859 Test Loss: 0.571 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.7922642230987549
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 11959364
model size : 50.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.306835889816284
Epoch: 1, Steps: 8 | Train Loss: 2.164 Vali Loss: 1.966 Vali Acc: 0.281 Test Loss: 1.966 Test Acc: 0.281
Validation loss decreased (inf --> -0.281230).  Saving model ...
Epoch: 2 cost time: 2.103665590286255
Epoch: 2, Steps: 8 | Train Loss: 1.929 Vali Loss: 1.476 Vali Acc: 0.594 Test Loss: 1.476 Test Acc: 0.594
Validation loss decreased (-0.281230 --> -0.593735).  Saving model ...
Epoch: 3 cost time: 1.9538486003875732
Epoch: 3, Steps: 8 | Train Loss: 1.331 Vali Loss: 1.014 Vali Acc: 0.750 Test Loss: 1.014 Test Acc: 0.750
Validation loss decreased (-0.593735 --> -0.749990).  Saving model ...
Epoch: 4 cost time: 1.7650504112243652
Epoch: 4, Steps: 8 | Train Loss: 0.874 Vali Loss: 0.716 Vali Acc: 0.787 Test Loss: 0.716 Test Acc: 0.787
Validation loss decreased (-0.749990 --> -0.787493).  Saving model ...
Epoch: 5 cost time: 1.889371395111084
Epoch: 5, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.617 Vali Acc: 0.816 Test Loss: 0.617 Test Acc: 0.816
Validation loss decreased (-0.787493 --> -0.815619).  Saving model ...
Epoch: 6 cost time: 1.9730751514434814
Epoch: 6, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821870).  Saving model ...
Epoch: 7 cost time: 1.9875195026397705
Epoch: 7, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.558 Vali Acc: 0.800 Test Loss: 0.558 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7342383861541748
Epoch: 8, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828120).  Saving model ...
Epoch: 9 cost time: 2.06880784034729
Epoch: 9, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.481 Vali Acc: 0.853 Test Loss: 0.481 Test Acc: 0.853
Validation loss decreased (-0.828120 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 2.027647018432617
Epoch: 10, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.308436155319214
Epoch: 11, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.510 Vali Acc: 0.831 Test Loss: 0.510 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6764795780181885
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.699723720550537
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.057098150253296
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1907379627227783
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0631983280181885
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.568 Vali Acc: 0.834 Test Loss: 0.568 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8999314308166504
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9036133289337158
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9971177577972412
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 11946052
model size : 50.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.1842334270477295
Epoch: 1, Steps: 8 | Train Loss: 2.006 Vali Loss: 1.846 Vali Acc: 0.397 Test Loss: 1.846 Test Acc: 0.397
Validation loss decreased (inf --> -0.396857).  Saving model ...
Epoch: 2 cost time: 2.0573434829711914
Epoch: 2, Steps: 8 | Train Loss: 1.744 Vali Loss: 1.385 Vali Acc: 0.575 Test Loss: 1.385 Test Acc: 0.575
Validation loss decreased (-0.396857 --> -0.574986).  Saving model ...
Epoch: 3 cost time: 1.6633987426757812
Epoch: 3, Steps: 8 | Train Loss: 1.264 Vali Loss: 0.890 Vali Acc: 0.844 Test Loss: 0.890 Test Acc: 0.844
Validation loss decreased (-0.574986 --> -0.843741).  Saving model ...
Epoch: 4 cost time: 1.9495985507965088
Epoch: 4, Steps: 8 | Train Loss: 0.760 Vali Loss: 0.678 Vali Acc: 0.800 Test Loss: 0.678 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9803225994110107
Epoch: 5, Steps: 8 | Train Loss: 0.553 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.341648817062378
Epoch: 6, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.146958589553833
Epoch: 7, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7086503505706787
Epoch: 8, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.512 Vali Acc: 0.847 Test Loss: 0.512 Test Acc: 0.847
Validation loss decreased (-0.843741 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 1.7662346363067627
Epoch: 9, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.511 Vali Acc: 0.828 Test Loss: 0.511 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1768717765808105
Epoch: 10, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9986114501953125
Epoch: 11, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.119919776916504
Epoch: 12, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9213051795959473
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 1.987344741821289
Epoch: 14, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2495508193969727
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.556 Vali Acc: 0.853 Test Loss: 0.556 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7555127143859863
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0556957721710205
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7654831409454346
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.542 Vali Acc: 0.863 Test Loss: 0.542 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 19 cost time: 2.185734987258911
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.557 Vali Acc: 0.863 Test Loss: 0.557 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0532338619232178
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7430994510650635
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.567 Vali Acc: 0.866 Test Loss: 0.567 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 22 cost time: 1.6411421298980713
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.561 Vali Acc: 0.863 Test Loss: 0.561 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.90779447555542
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.573 Vali Acc: 0.863 Test Loss: 0.573 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0088372230529785
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.578 Vali Acc: 0.863 Test Loss: 0.578 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.138474941253662
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.576 Vali Acc: 0.859 Test Loss: 0.576 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.1097614765167236
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.582 Vali Acc: 0.863 Test Loss: 0.582 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.1539037227630615
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.856 Test Loss: 0.585 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7757019996643066
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.863 Test Loss: 0.588 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9374003410339355
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.859 Test Loss: 0.590 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.1583595275878906
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.866 Test Loss: 0.590 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.2186622619628906
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.859 Test Loss: 0.588 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 10804036
model size : 46.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9002685546875
Epoch: 1, Steps: 8 | Train Loss: 2.165 Vali Loss: 2.001 Vali Acc: 0.191 Test Loss: 2.001 Test Acc: 0.191
Validation loss decreased (inf --> -0.190605).  Saving model ...
Epoch: 2 cost time: 1.8117218017578125
Epoch: 2, Steps: 8 | Train Loss: 1.903 Vali Loss: 1.543 Vali Acc: 0.703 Test Loss: 1.543 Test Acc: 0.703
Validation loss decreased (-0.190605 --> -0.703110).  Saving model ...
Epoch: 3 cost time: 1.8894283771514893
Epoch: 3, Steps: 8 | Train Loss: 1.415 Vali Loss: 1.069 Vali Acc: 0.728 Test Loss: 1.069 Test Acc: 0.728
Validation loss decreased (-0.703110 --> -0.728114).  Saving model ...
Epoch: 4 cost time: 1.6380043029785156
Epoch: 4, Steps: 8 | Train Loss: 0.924 Vali Loss: 0.730 Vali Acc: 0.812 Test Loss: 0.730 Test Acc: 0.812
Validation loss decreased (-0.728114 --> -0.812493).  Saving model ...
Epoch: 5 cost time: 1.9647061824798584
Epoch: 5, Steps: 8 | Train Loss: 0.581 Vali Loss: 0.597 Vali Acc: 0.822 Test Loss: 0.597 Test Acc: 0.822
Validation loss decreased (-0.812493 --> -0.821869).  Saving model ...
Epoch: 6 cost time: 1.4575836658477783
Epoch: 6, Steps: 8 | Train Loss: 0.436 Vali Loss: 0.522 Vali Acc: 0.831 Test Loss: 0.522 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 1.7747163772583008
Epoch: 7, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1097216606140137
Epoch: 8, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.521 Vali Acc: 0.834 Test Loss: 0.521 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 2.070563793182373
Epoch: 9, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.037093162536621
Epoch: 10, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.544 Vali Acc: 0.831 Test Loss: 0.544 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7637593746185303
Epoch: 11, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7278921604156494
Epoch: 12, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.548 Vali Acc: 0.838 Test Loss: 0.548 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 1.9433221817016602
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 1.946810007095337
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 15 cost time: 2.0098354816436768
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 2.084367275238037
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.553 Vali Acc: 0.838 Test Loss: 0.553 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9370877742767334
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8744137287139893
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8336670398712158
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1950788497924805
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9038059711456299
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.569 Vali Acc: 0.863 Test Loss: 0.569 Test Acc: 0.863
Validation loss decreased (-0.849994 --> -0.862494).  Saving model ...
Epoch: 22 cost time: 1.8418679237365723
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.853 Test Loss: 0.568 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1038625240325928
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.738478422164917
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1136081218719482
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.604 Vali Acc: 0.856 Test Loss: 0.604 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.167447566986084
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0072789192199707
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.863 Test Loss: 0.589 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.123425006866455
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.863 Test Loss: 0.598 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.0759174823760986
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.594 Vali Acc: 0.863 Test Loss: 0.594 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.825714349746704
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.859 Test Loss: 0.599 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.1365299224853516
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.604 Vali Acc: 0.866 Test Loss: 0.604 Test Acc: 0.866
Validation loss decreased (-0.862494 --> -0.865619).  Saving model ...
Epoch: 32 cost time: 2.121994733810425
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7653167247772217
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.859 Test Loss: 0.613 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.2732691764831543
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.863 Test Loss: 0.616 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7599375247955322
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.863 Test Loss: 0.605 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.976496696472168
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.863 Test Loss: 0.605 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.9810478687286377
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.866 Test Loss: 0.617 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.162325143814087
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.863 Test Loss: 0.625 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.991506576538086
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.859 Test Loss: 0.633 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.78043794631958
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.863 Test Loss: 0.618 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.7098309993743896
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.866 Test Loss: 0.617 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 10790724
model size : 46.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9651410579681396
Epoch: 1, Steps: 8 | Train Loss: 2.142 Vali Loss: 1.937 Vali Acc: 0.338 Test Loss: 1.937 Test Acc: 0.338
Validation loss decreased (inf --> -0.337481).  Saving model ...
Epoch: 2 cost time: 1.8666226863861084
Epoch: 2, Steps: 8 | Train Loss: 1.895 Vali Loss: 1.467 Vali Acc: 0.734 Test Loss: 1.467 Test Acc: 0.734
Validation loss decreased (-0.337481 --> -0.734360).  Saving model ...
Epoch: 3 cost time: 1.8365797996520996
Epoch: 3, Steps: 8 | Train Loss: 1.375 Vali Loss: 0.981 Vali Acc: 0.828 Test Loss: 0.981 Test Acc: 0.828
Validation loss decreased (-0.734360 --> -0.828115).  Saving model ...
Epoch: 4 cost time: 1.945732831954956
Epoch: 4, Steps: 8 | Train Loss: 0.826 Vali Loss: 0.738 Vali Acc: 0.753 Test Loss: 0.738 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7580304145812988
Epoch: 5, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.551 Vali Acc: 0.838 Test Loss: 0.551 Test Acc: 0.838
Validation loss decreased (-0.828115 --> -0.837494).  Saving model ...
Epoch: 6 cost time: 1.9557945728302002
Epoch: 6, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7481398582458496
Epoch: 7, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.579 Vali Acc: 0.787 Test Loss: 0.579 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7303054332733154
Epoch: 8, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.999631643295288
Epoch: 9, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 2.1561119556427
Epoch: 10, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.579 Vali Acc: 0.800 Test Loss: 0.579 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9782655239105225
Epoch: 11, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9314172267913818
Epoch: 12, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1073310375213623
Epoch: 13, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2221498489379883
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.573 Vali Acc: 0.838 Test Loss: 0.573 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8237333297729492
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.533 Vali Acc: 0.863 Test Loss: 0.533 Test Acc: 0.863
Validation loss decreased (-0.843745 --> -0.862495).  Saving model ...
Epoch: 16 cost time: 1.7604148387908936
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.525 Vali Acc: 0.859 Test Loss: 0.525 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6991450786590576
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.770573616027832
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.562 Vali Acc: 0.863 Test Loss: 0.562 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.907959222793579
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.551 Vali Acc: 0.866 Test Loss: 0.551 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 20 cost time: 2.0587339401245117
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.545 Vali Acc: 0.866 Test Loss: 0.545 Test Acc: 0.866
Validation loss decreased (-0.865619 --> -0.865620).  Saving model ...
Epoch: 21 cost time: 1.833509922027588
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0258493423461914
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.569 Vali Acc: 0.869 Test Loss: 0.569 Test Acc: 0.869
Validation loss decreased (-0.865620 --> -0.868744).  Saving model ...
Epoch: 23 cost time: 2.0488224029541016
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.565 Vali Acc: 0.872 Test Loss: 0.565 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871869).  Saving model ...
Epoch: 24 cost time: 2.049055337905884
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.866 Test Loss: 0.565 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7680597305297852
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.574 Vali Acc: 0.859 Test Loss: 0.574 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8664910793304443
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.576 Vali Acc: 0.863 Test Loss: 0.576 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8658151626586914
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.579 Vali Acc: 0.866 Test Loss: 0.579 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5669245719909668
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.869 Test Loss: 0.581 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8168611526489258
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.583 Vali Acc: 0.869 Test Loss: 0.583 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9373972415924072
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.872 Test Loss: 0.587 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.83420729637146
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.872 Test Loss: 0.590 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.776604413986206
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.872 Test Loss: 0.588 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.022843360900879
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.863 Test Loss: 0.590 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 10777412
model size : 46.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7254269123077393
Epoch: 1, Steps: 8 | Train Loss: 2.149 Vali Loss: 1.987 Vali Acc: 0.181 Test Loss: 1.987 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 1.8905360698699951
Epoch: 2, Steps: 8 | Train Loss: 1.866 Vali Loss: 1.526 Vali Acc: 0.603 Test Loss: 1.526 Test Acc: 0.603
Validation loss decreased (-0.181230 --> -0.603110).  Saving model ...
Epoch: 3 cost time: 1.716064453125
Epoch: 3, Steps: 8 | Train Loss: 1.439 Vali Loss: 1.040 Vali Acc: 0.762 Test Loss: 1.040 Test Acc: 0.762
Validation loss decreased (-0.603110 --> -0.762490).  Saving model ...
Epoch: 4 cost time: 1.7741062641143799
Epoch: 4, Steps: 8 | Train Loss: 0.917 Vali Loss: 0.792 Vali Acc: 0.741 Test Loss: 0.792 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5318853855133057
Epoch: 5, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
Validation loss decreased (-0.762490 --> -0.803119).  Saving model ...
Epoch: 6 cost time: 1.6778488159179688
Epoch: 6, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.559 Vali Acc: 0.816 Test Loss: 0.559 Test Acc: 0.816
Validation loss decreased (-0.803119 --> -0.815619).  Saving model ...
Epoch: 7 cost time: 1.8491597175598145
Epoch: 7, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 1.7687852382659912
Epoch: 8, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
Validation loss decreased (-0.824994 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 1.7136807441711426
Epoch: 9, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.563 Vali Acc: 0.806 Test Loss: 0.563 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6982574462890625
Epoch: 10, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7202792167663574
Epoch: 11, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.507 Vali Acc: 0.853 Test Loss: 0.507 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 1.5342597961425781
Epoch: 12, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.766359806060791
Epoch: 13, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.531 Vali Acc: 0.853 Test Loss: 0.531 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5921995639801025
Epoch: 14, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.498 Vali Acc: 0.869 Test Loss: 0.498 Test Acc: 0.869
Validation loss decreased (-0.853120 --> -0.868745).  Saving model ...
Epoch: 15 cost time: 1.6692848205566406
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.524 Vali Acc: 0.859 Test Loss: 0.524 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7355623245239258
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6595406532287598
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.530 Vali Acc: 0.863 Test Loss: 0.530 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6109833717346191
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.510 Vali Acc: 0.872 Test Loss: 0.510 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 19 cost time: 1.647001028060913
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
Validation loss decreased (-0.871870 --> -0.878120).  Saving model ...
Epoch: 20 cost time: 1.6318058967590332
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6052560806274414
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.532 Vali Acc: 0.872 Test Loss: 0.532 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7254865169525146
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.544 Vali Acc: 0.872 Test Loss: 0.544 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9534261226654053
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.545 Vali Acc: 0.869 Test Loss: 0.545 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.68611478805542
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.720731496810913
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.546 Vali Acc: 0.872 Test Loss: 0.546 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8808565139770508
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9337189197540283
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.551 Vali Acc: 0.872 Test Loss: 0.551 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.580700397491455
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.548 Vali Acc: 0.872 Test Loss: 0.548 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.803349494934082
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 10764100
model size : 46.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.067670822143555
Epoch: 1, Steps: 8 | Train Loss: 2.193 Vali Loss: 2.060 Vali Acc: 0.194 Test Loss: 2.060 Test Acc: 0.194
Validation loss decreased (inf --> -0.193729).  Saving model ...
Epoch: 2 cost time: 1.8016719818115234
Epoch: 2, Steps: 8 | Train Loss: 2.009 Vali Loss: 1.624 Vali Acc: 0.584 Test Loss: 1.624 Test Acc: 0.584
Validation loss decreased (-0.193729 --> -0.584359).  Saving model ...
Epoch: 3 cost time: 1.7444355487823486
Epoch: 3, Steps: 8 | Train Loss: 1.546 Vali Loss: 1.148 Vali Acc: 0.750 Test Loss: 1.148 Test Acc: 0.750
Validation loss decreased (-0.584359 --> -0.749989).  Saving model ...
Epoch: 4 cost time: 1.9915049076080322
Epoch: 4, Steps: 8 | Train Loss: 0.982 Vali Loss: 0.764 Vali Acc: 0.825 Test Loss: 0.764 Test Acc: 0.825
Validation loss decreased (-0.749989 --> -0.824992).  Saving model ...
Epoch: 5 cost time: 1.9265305995941162
Epoch: 5, Steps: 8 | Train Loss: 0.654 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8981683254241943
Epoch: 6, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.544 Vali Acc: 0.834 Test Loss: 0.544 Test Acc: 0.834
Validation loss decreased (-0.824992 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 1.5785198211669922
Epoch: 7, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 1.7021815776824951
Epoch: 8, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 1.9171137809753418
Epoch: 9, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.501 Vali Acc: 0.847 Test Loss: 0.501 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 1.75876784324646
Epoch: 10, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.483 Vali Acc: 0.841 Test Loss: 0.483 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.179283380508423
Epoch: 11, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.552 Vali Acc: 0.831 Test Loss: 0.552 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8983643054962158
Epoch: 12, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2197747230529785
Epoch: 13, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.014427423477173
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.977231502532959
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9555981159210205
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.68365478515625
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9618840217590332
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8598167896270752
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.552 Vali Acc: 0.853 Test Loss: 0.552 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853119).  Saving model ...
Epoch: 20 cost time: 1.962068796157837
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.565 Vali Acc: 0.847 Test Loss: 0.565 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0993497371673584
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.578 Vali Acc: 0.841 Test Loss: 0.578 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.906083106994629
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.564 Vali Acc: 0.847 Test Loss: 0.564 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8680996894836426
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856244).  Saving model ...
Epoch: 24 cost time: 1.6973998546600342
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.16923189163208
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.574 Vali Acc: 0.853 Test Loss: 0.574 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.119589328765869
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.563 Vali Acc: 0.853 Test Loss: 0.563 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7476799488067627
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856244).  Saving model ...
Epoch: 28 cost time: 1.8578169345855713
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.566 Vali Acc: 0.863 Test Loss: 0.566 Test Acc: 0.863
Validation loss decreased (-0.856244 --> -0.862494).  Saving model ...
Epoch: 29 cost time: 2.0262956619262695
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.859 Test Loss: 0.573 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0501251220703125
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9258594512939453
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.9462125301361084
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.4828133583068848
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.0025687217712402
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.859 Test Loss: 0.585 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.1819286346435547
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.859 Test Loss: 0.587 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.3239104747772217
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.853 Test Loss: 0.597 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.24826979637146
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.859 Test Loss: 0.593 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.2349448204040527
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.856 Test Loss: 0.592 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 10213060
model size : 44.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.151135444641113
Epoch: 1, Steps: 8 | Train Loss: 2.147 Vali Loss: 1.948 Vali Acc: 0.266 Test Loss: 1.948 Test Acc: 0.266
Validation loss decreased (inf --> -0.265606).  Saving model ...
Epoch: 2 cost time: 2.0746710300445557
Epoch: 2, Steps: 8 | Train Loss: 1.899 Vali Loss: 1.476 Vali Acc: 0.706 Test Loss: 1.476 Test Acc: 0.706
Validation loss decreased (-0.265606 --> -0.706235).  Saving model ...
Epoch: 3 cost time: 1.8954410552978516
Epoch: 3, Steps: 8 | Train Loss: 1.308 Vali Loss: 1.015 Vali Acc: 0.722 Test Loss: 1.015 Test Acc: 0.722
Validation loss decreased (-0.706235 --> -0.721865).  Saving model ...
Epoch: 4 cost time: 2.0440449714660645
Epoch: 4, Steps: 8 | Train Loss: 0.876 Vali Loss: 0.683 Vali Acc: 0.822 Test Loss: 0.683 Test Acc: 0.822
Validation loss decreased (-0.721865 --> -0.821868).  Saving model ...
Epoch: 5 cost time: 2.0411112308502197
Epoch: 5, Steps: 8 | Train Loss: 0.586 Vali Loss: 0.585 Vali Acc: 0.816 Test Loss: 0.585 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9587273597717285
Epoch: 6, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.542 Vali Acc: 0.812 Test Loss: 0.542 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.856837272644043
Epoch: 7, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.548 Vali Acc: 0.812 Test Loss: 0.548 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8586640357971191
Epoch: 8, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.504 Vali Acc: 0.831 Test Loss: 0.504 Test Acc: 0.831
Validation loss decreased (-0.821868 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 1.9162719249725342
Epoch: 9, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.549 Vali Acc: 0.831 Test Loss: 0.549 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9027843475341797
Epoch: 10, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 1.7264423370361328
Epoch: 11, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.814086675643921
Epoch: 12, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.578 Vali Acc: 0.834 Test Loss: 0.578 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8712985515594482
Epoch: 13, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.098385810852051
Epoch: 14, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9022853374481201
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.546 Vali Acc: 0.853 Test Loss: 0.546 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 1.9063620567321777
Epoch: 16, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.566 Vali Acc: 0.853 Test Loss: 0.566 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8859343528747559
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.568 Vali Acc: 0.847 Test Loss: 0.568 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7930092811584473
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6258471012115479
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.84848952293396
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.785517692565918
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.575 Vali Acc: 0.863 Test Loss: 0.575 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862494).  Saving model ...
Epoch: 22 cost time: 2.0317578315734863
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.568 Vali Acc: 0.866 Test Loss: 0.568 Test Acc: 0.866
Validation loss decreased (-0.862494 --> -0.865619).  Saving model ...
Epoch: 23 cost time: 1.7581486701965332
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.578 Vali Acc: 0.869 Test Loss: 0.578 Test Acc: 0.869
Validation loss decreased (-0.865619 --> -0.868744).  Saving model ...
Epoch: 24 cost time: 1.6020042896270752
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.866 Test Loss: 0.585 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8784022331237793
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.589 Vali Acc: 0.866 Test Loss: 0.589 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0111825466156006
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.581 Vali Acc: 0.863 Test Loss: 0.581 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8622469902038574
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.580 Vali Acc: 0.866 Test Loss: 0.580 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.816664457321167
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.869 Test Loss: 0.590 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8049952983856201
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.866 Test Loss: 0.605 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.93284010887146
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.869 Test Loss: 0.607 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8951191902160645
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.866 Test Loss: 0.602 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.7869644165039062
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.869 Test Loss: 0.601 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.0637948513031006
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.869 Test Loss: 0.600 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 10199748
model size : 43.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.2160584926605225
Epoch: 1, Steps: 8 | Train Loss: 2.189 Vali Loss: 1.993 Vali Acc: 0.269 Test Loss: 1.993 Test Acc: 0.269
Validation loss decreased (inf --> -0.268730).  Saving model ...
Epoch: 2 cost time: 1.6543617248535156
Epoch: 2, Steps: 8 | Train Loss: 1.983 Vali Loss: 1.619 Vali Acc: 0.584 Test Loss: 1.619 Test Acc: 0.584
Validation loss decreased (-0.268730 --> -0.584359).  Saving model ...
Epoch: 3 cost time: 2.183295249938965
Epoch: 3, Steps: 8 | Train Loss: 1.430 Vali Loss: 1.170 Vali Acc: 0.741 Test Loss: 1.170 Test Acc: 0.741
Validation loss decreased (-0.584359 --> -0.740613).  Saving model ...
Epoch: 4 cost time: 1.9479756355285645
Epoch: 4, Steps: 8 | Train Loss: 0.969 Vali Loss: 0.821 Vali Acc: 0.781 Test Loss: 0.821 Test Acc: 0.781
Validation loss decreased (-0.740613 --> -0.781242).  Saving model ...
Epoch: 5 cost time: 1.8836708068847656
Epoch: 5, Steps: 8 | Train Loss: 0.667 Vali Loss: 0.628 Vali Acc: 0.803 Test Loss: 0.628 Test Acc: 0.803
Validation loss decreased (-0.781242 --> -0.803119).  Saving model ...
Epoch: 6 cost time: 1.9932548999786377
Epoch: 6, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.554 Vali Acc: 0.819 Test Loss: 0.554 Test Acc: 0.819
Validation loss decreased (-0.803119 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 2.070666790008545
Epoch: 7, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.589 Vali Acc: 0.794 Test Loss: 0.589 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.788149118423462
Epoch: 8, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.533 Vali Acc: 0.800 Test Loss: 0.533 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7359509468078613
Epoch: 9, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824995).  Saving model ...
Epoch: 10 cost time: 1.788539171218872
Epoch: 10, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8856844902038574
Epoch: 11, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.520 Vali Acc: 0.831 Test Loss: 0.520 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 1.7068915367126465
Epoch: 12, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0793228149414062
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6485068798065186
Epoch: 14, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.547 Vali Acc: 0.831 Test Loss: 0.547 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8028500080108643
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 2.070608139038086
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.570 Vali Acc: 0.844 Test Loss: 0.570 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843744).  Saving model ...
Epoch: 17 cost time: 1.9457104206085205
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0829343795776367
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2307627201080322
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.580 Vali Acc: 0.847 Test Loss: 0.580 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846869).  Saving model ...
Epoch: 20 cost time: 1.8742501735687256
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.569 Vali Acc: 0.847 Test Loss: 0.569 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846869).  Saving model ...
Epoch: 21 cost time: 2.009493827819824
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.848738431930542
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.561 Vali Acc: 0.853 Test Loss: 0.561 Test Acc: 0.853
Validation loss decreased (-0.846869 --> -0.853119).  Saving model ...
Epoch: 23 cost time: 1.9810075759887695
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.956489086151123
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.578 Vali Acc: 0.853 Test Loss: 0.578 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8163948059082031
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8051612377166748
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6596789360046387
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.584 Vali Acc: 0.847 Test Loss: 0.584 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.2420949935913086
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.586 Vali Acc: 0.853 Test Loss: 0.586 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.345628499984741
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.853 Test Loss: 0.591 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.569281578063965
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.853 Test Loss: 0.587 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9878270626068115
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.9179863929748535
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.853 Test Loss: 0.592 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 10186436
model size : 43.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6630654335021973
Epoch: 1, Steps: 8 | Train Loss: 2.197 Vali Loss: 2.015 Vali Acc: 0.206 Test Loss: 2.015 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 1.9305520057678223
Epoch: 2, Steps: 8 | Train Loss: 1.892 Vali Loss: 1.579 Vali Acc: 0.584 Test Loss: 1.579 Test Acc: 0.584
Validation loss decreased (-0.206230 --> -0.584359).  Saving model ...
Epoch: 3 cost time: 1.3857488632202148
Epoch: 3, Steps: 8 | Train Loss: 1.425 Vali Loss: 1.086 Vali Acc: 0.778 Test Loss: 1.086 Test Acc: 0.778
Validation loss decreased (-0.584359 --> -0.778114).  Saving model ...
Epoch: 4 cost time: 1.6424386501312256
Epoch: 4, Steps: 8 | Train Loss: 0.909 Vali Loss: 0.735 Vali Acc: 0.797 Test Loss: 0.735 Test Acc: 0.797
Validation loss decreased (-0.778114 --> -0.796868).  Saving model ...
Epoch: 5 cost time: 1.6717209815979004
Epoch: 5, Steps: 8 | Train Loss: 0.572 Vali Loss: 0.625 Vali Acc: 0.806 Test Loss: 0.625 Test Acc: 0.806
Validation loss decreased (-0.796868 --> -0.806244).  Saving model ...
Epoch: 6 cost time: 1.6286892890930176
Epoch: 6, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3787741661071777
Epoch: 7, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.525 Vali Acc: 0.847 Test Loss: 0.525 Test Acc: 0.847
Validation loss decreased (-0.806244 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 1.5422389507293701
Epoch: 8, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6842658519744873
Epoch: 9, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.811586856842041
Epoch: 10, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8760223388671875
Epoch: 11, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7926571369171143
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9482312202453613
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8054189682006836
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.2091786861419678
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 2.0707883834838867
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.527 Vali Acc: 0.863 Test Loss: 0.527 Test Acc: 0.863
Validation loss decreased (-0.849994 --> -0.862495).  Saving model ...
Epoch: 17 cost time: 1.6272947788238525
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.523 Vali Acc: 0.866 Test Loss: 0.523 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 18 cost time: 1.689439296722412
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.537 Vali Acc: 0.859 Test Loss: 0.537 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8837215900421143
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.549 Vali Acc: 0.853 Test Loss: 0.549 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.729238510131836
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.553 Vali Acc: 0.853 Test Loss: 0.553 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7409777641296387
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.543 Vali Acc: 0.863 Test Loss: 0.543 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0636332035064697
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.547 Vali Acc: 0.866 Test Loss: 0.547 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7865221500396729
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.866 Test Loss: 0.536 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7554585933685303
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.553 Vali Acc: 0.859 Test Loss: 0.553 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7383756637573242
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.863 Test Loss: 0.558 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9229426383972168
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.863 Test Loss: 0.561 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6044607162475586
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.863 Test Loss: 0.562 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 10173124
model size : 43.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.232167959213257
Epoch: 1, Steps: 8 | Train Loss: 2.148 Vali Loss: 1.988 Vali Acc: 0.287 Test Loss: 1.988 Test Acc: 0.287
Validation loss decreased (inf --> -0.287480).  Saving model ...
Epoch: 2 cost time: 1.8199641704559326
Epoch: 2, Steps: 8 | Train Loss: 1.883 Vali Loss: 1.719 Vali Acc: 0.394 Test Loss: 1.719 Test Acc: 0.394
Validation loss decreased (-0.287480 --> -0.393733).  Saving model ...
Epoch: 3 cost time: 1.58530855178833
Epoch: 3, Steps: 8 | Train Loss: 1.563 Vali Loss: 1.290 Vali Acc: 0.722 Test Loss: 1.290 Test Acc: 0.722
Validation loss decreased (-0.393733 --> -0.721862).  Saving model ...
Epoch: 4 cost time: 1.8071255683898926
Epoch: 4, Steps: 8 | Train Loss: 1.103 Vali Loss: 0.917 Vali Acc: 0.784 Test Loss: 0.917 Test Acc: 0.784
Validation loss decreased (-0.721862 --> -0.784366).  Saving model ...
Epoch: 5 cost time: 1.700890064239502
Epoch: 5, Steps: 8 | Train Loss: 0.759 Vali Loss: 0.731 Vali Acc: 0.794 Test Loss: 0.731 Test Acc: 0.794
Validation loss decreased (-0.784366 --> -0.793743).  Saving model ...
Epoch: 6 cost time: 1.8194572925567627
Epoch: 6, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.618 Vali Acc: 0.822 Test Loss: 0.618 Test Acc: 0.822
Validation loss decreased (-0.793743 --> -0.821869).  Saving model ...
Epoch: 7 cost time: 1.9319100379943848
Epoch: 7, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.540 Vali Acc: 0.847 Test Loss: 0.540 Test Acc: 0.847
Validation loss decreased (-0.821869 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 1.8744518756866455
Epoch: 8, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6560382843017578
Epoch: 9, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.147047519683838
Epoch: 10, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 1.7394249439239502
Epoch: 11, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0043647289276123
Epoch: 12, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 1.9534633159637451
Epoch: 13, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.520 Vali Acc: 0.819 Test Loss: 0.520 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8751652240753174
Epoch: 14, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.503 Vali Acc: 0.831 Test Loss: 0.503 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7094504833221436
Epoch: 15, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.474 Vali Acc: 0.863 Test Loss: 0.474 Test Acc: 0.863
Validation loss decreased (-0.846870 --> -0.862495).  Saving model ...
Epoch: 16 cost time: 1.7605855464935303
Epoch: 16, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.491 Vali Acc: 0.859 Test Loss: 0.491 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6414551734924316
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.492 Vali Acc: 0.853 Test Loss: 0.492 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.632051706314087
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7616240978240967
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.696152925491333
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.775733470916748
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9728283882141113
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.490 Vali Acc: 0.853 Test Loss: 0.490 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7744698524475098
Epoch: 23, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7458176612854004
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8393990993499756
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.487 Vali Acc: 0.859 Test Loss: 0.487 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 4820292
model size : 21.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.009409189224243
Epoch: 1, Steps: 8 | Train Loss: 2.170 Vali Loss: 2.023 Vali Acc: 0.219 Test Loss: 2.023 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 2.397702217102051
Epoch: 2, Steps: 8 | Train Loss: 2.069 Vali Loss: 1.863 Vali Acc: 0.322 Test Loss: 1.863 Test Acc: 0.322
Validation loss decreased (-0.218730 --> -0.321856).  Saving model ...
Epoch: 3 cost time: 1.8239431381225586
Epoch: 3, Steps: 8 | Train Loss: 1.664 Vali Loss: 1.507 Vali Acc: 0.575 Test Loss: 1.507 Test Acc: 0.575
Validation loss decreased (-0.321856 --> -0.574985).  Saving model ...
Epoch: 4 cost time: 1.6461329460144043
Epoch: 4, Steps: 8 | Train Loss: 1.340 Vali Loss: 1.088 Vali Acc: 0.756 Test Loss: 1.088 Test Acc: 0.756
Validation loss decreased (-0.574985 --> -0.756239).  Saving model ...
Epoch: 5 cost time: 1.9621753692626953
Epoch: 5, Steps: 8 | Train Loss: 0.978 Vali Loss: 0.812 Vali Acc: 0.825 Test Loss: 0.812 Test Acc: 0.825
Validation loss decreased (-0.756239 --> -0.824992).  Saving model ...
Epoch: 6 cost time: 1.6944422721862793
Epoch: 6, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.662 Vali Acc: 0.819 Test Loss: 0.662 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8600795269012451
Epoch: 7, Steps: 8 | Train Loss: 0.504 Vali Loss: 0.590 Vali Acc: 0.834 Test Loss: 0.590 Test Acc: 0.834
Validation loss decreased (-0.824992 --> -0.834369).  Saving model ...
Epoch: 8 cost time: 2.0754950046539307
Epoch: 8, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.551 Vali Acc: 0.847 Test Loss: 0.551 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846869).  Saving model ...
Epoch: 9 cost time: 1.9985129833221436
Epoch: 9, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9690771102905273
Epoch: 10, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.540 Vali Acc: 0.847 Test Loss: 0.540 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 1.817159652709961
Epoch: 11, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.533 Vali Acc: 0.803 Test Loss: 0.533 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9781911373138428
Epoch: 12, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.529 Vali Acc: 0.819 Test Loss: 0.529 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.819127082824707
Epoch: 13, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8031282424926758
Epoch: 14, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.828521728515625
Epoch: 15, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9758663177490234
Epoch: 16, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 1.9981915950775146
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9173243045806885
Epoch: 18, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.484 Vali Acc: 0.853 Test Loss: 0.484 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 19 cost time: 2.2557790279388428
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9745087623596191
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6810393333435059
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9706251621246338
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.520 Vali Acc: 0.834 Test Loss: 0.520 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9149422645568848
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.673579216003418
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8261308670043945
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.2220516204833984
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8987655639648438
Epoch: 27, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.157019853591919
Epoch: 28, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 4813636
model size : 20.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.1399571895599365
Epoch: 1, Steps: 8 | Train Loss: 2.228 Vali Loss: 2.074 Vali Acc: 0.131 Test Loss: 2.074 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 1.8648390769958496
Epoch: 2, Steps: 8 | Train Loss: 2.077 Vali Loss: 1.862 Vali Acc: 0.328 Test Loss: 1.862 Test Acc: 0.328
Validation loss decreased (-0.131229 --> -0.328106).  Saving model ...
Epoch: 3 cost time: 1.725447177886963
Epoch: 3, Steps: 8 | Train Loss: 1.735 Vali Loss: 1.491 Vali Acc: 0.553 Test Loss: 1.491 Test Acc: 0.553
Validation loss decreased (-0.328106 --> -0.553110).  Saving model ...
Epoch: 4 cost time: 1.8393495082855225
Epoch: 4, Steps: 8 | Train Loss: 1.337 Vali Loss: 1.070 Vali Acc: 0.753 Test Loss: 1.070 Test Acc: 0.753
Validation loss decreased (-0.553110 --> -0.753114).  Saving model ...
Epoch: 5 cost time: 1.9499585628509521
Epoch: 5, Steps: 8 | Train Loss: 0.960 Vali Loss: 0.807 Vali Acc: 0.816 Test Loss: 0.807 Test Acc: 0.816
Validation loss decreased (-0.753114 --> -0.815617).  Saving model ...
Epoch: 6 cost time: 1.8200147151947021
Epoch: 6, Steps: 8 | Train Loss: 0.688 Vali Loss: 0.663 Vali Acc: 0.812 Test Loss: 0.663 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6209592819213867
Epoch: 7, Steps: 8 | Train Loss: 0.514 Vali Loss: 0.600 Vali Acc: 0.831 Test Loss: 0.600 Test Acc: 0.831
Validation loss decreased (-0.815617 --> -0.831244).  Saving model ...
Epoch: 8 cost time: 1.7179434299468994
Epoch: 8, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6069331169128418
Epoch: 9, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.529 Vali Acc: 0.834 Test Loss: 0.529 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 1.9174895286560059
Epoch: 10, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 1.5578620433807373
Epoch: 11, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
Validation loss decreased (-0.837495 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 1.774247169494629
Epoch: 12, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.521 Vali Acc: 0.831 Test Loss: 0.521 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7081882953643799
Epoch: 13, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6476080417633057
Epoch: 14, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7064235210418701
Epoch: 15, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.479 Vali Acc: 0.847 Test Loss: 0.479 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.664825439453125
Epoch: 16, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.514 Vali Acc: 0.834 Test Loss: 0.514 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6229074001312256
Epoch: 17, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.20635986328125
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8633134365081787
Epoch: 19, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9318828582763672
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1754610538482666
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.461 Vali Acc: 0.847 Test Loss: 0.461 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 4806980
model size : 20.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.521897077560425
Epoch: 1, Steps: 8 | Train Loss: 2.131 Vali Loss: 1.996 Vali Acc: 0.191 Test Loss: 1.996 Test Acc: 0.191
Validation loss decreased (inf --> -0.190605).  Saving model ...
Epoch: 2 cost time: 2.0266075134277344
Epoch: 2, Steps: 8 | Train Loss: 2.027 Vali Loss: 1.760 Vali Acc: 0.503 Test Loss: 1.760 Test Acc: 0.503
Validation loss decreased (-0.190605 --> -0.503107).  Saving model ...
Epoch: 3 cost time: 2.120100736618042
Epoch: 3, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.423 Vali Acc: 0.644 Test Loss: 1.423 Test Acc: 0.644
Validation loss decreased (-0.503107 --> -0.643736).  Saving model ...
Epoch: 4 cost time: 2.1740198135375977
Epoch: 4, Steps: 8 | Train Loss: 1.208 Vali Loss: 1.062 Vali Acc: 0.694 Test Loss: 1.062 Test Acc: 0.694
Validation loss decreased (-0.643736 --> -0.693739).  Saving model ...
Epoch: 5 cost time: 1.9722867012023926
Epoch: 5, Steps: 8 | Train Loss: 0.917 Vali Loss: 0.793 Vali Acc: 0.819 Test Loss: 0.793 Test Acc: 0.819
Validation loss decreased (-0.693739 --> -0.818742).  Saving model ...
Epoch: 6 cost time: 2.010951042175293
Epoch: 6, Steps: 8 | Train Loss: 0.602 Vali Loss: 0.654 Vali Acc: 0.825 Test Loss: 0.654 Test Acc: 0.825
Validation loss decreased (-0.818742 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 1.7571942806243896
Epoch: 7, Steps: 8 | Train Loss: 0.468 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 1.4154908657073975
Epoch: 8, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.856062412261963
Epoch: 9, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8130240440368652
Epoch: 10, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
Validation loss decreased (-0.828119 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 1.949218511581421
Epoch: 11, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.495 Vali Acc: 0.828 Test Loss: 0.495 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.774832010269165
Epoch: 12, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9211809635162354
Epoch: 13, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.027581214904785
Epoch: 14, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0765633583068848
Epoch: 15, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8736820220947266
Epoch: 16, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 17 cost time: 1.62459397315979
Epoch: 17, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.554297685623169
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0970191955566406
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6043801307678223
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.927525281906128
Epoch: 21, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7406649589538574
Epoch: 22, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.515 Vali Acc: 0.834 Test Loss: 0.515 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7574312686920166
Epoch: 23, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.680182933807373
Epoch: 24, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6533544063568115
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9721593856811523
Epoch: 26, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 4800324
model size : 20.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.509768962860107
Epoch: 1, Steps: 8 | Train Loss: 2.131 Vali Loss: 2.001 Vali Acc: 0.256 Test Loss: 2.001 Test Acc: 0.256
Validation loss decreased (inf --> -0.256230).  Saving model ...
Epoch: 2 cost time: 1.9168989658355713
Epoch: 2, Steps: 8 | Train Loss: 2.017 Vali Loss: 1.841 Vali Acc: 0.384 Test Loss: 1.841 Test Acc: 0.384
Validation loss decreased (-0.256230 --> -0.384357).  Saving model ...
Epoch: 3 cost time: 1.865035057067871
Epoch: 3, Steps: 8 | Train Loss: 1.768 Vali Loss: 1.578 Vali Acc: 0.672 Test Loss: 1.578 Test Acc: 0.672
Validation loss decreased (-0.384357 --> -0.671859).  Saving model ...
Epoch: 4 cost time: 1.6510443687438965
Epoch: 4, Steps: 8 | Train Loss: 1.503 Vali Loss: 1.237 Vali Acc: 0.713 Test Loss: 1.237 Test Acc: 0.713
Validation loss decreased (-0.671859 --> -0.712488).  Saving model ...
Epoch: 5 cost time: 1.7102551460266113
Epoch: 5, Steps: 8 | Train Loss: 1.099 Vali Loss: 0.941 Vali Acc: 0.781 Test Loss: 0.941 Test Acc: 0.781
Validation loss decreased (-0.712488 --> -0.781241).  Saving model ...
Epoch: 6 cost time: 2.1158554553985596
Epoch: 6, Steps: 8 | Train Loss: 0.814 Vali Loss: 0.779 Vali Acc: 0.794 Test Loss: 0.779 Test Acc: 0.794
Validation loss decreased (-0.781241 --> -0.793742).  Saving model ...
Epoch: 7 cost time: 1.6073434352874756
Epoch: 7, Steps: 8 | Train Loss: 0.606 Vali Loss: 0.665 Vali Acc: 0.809 Test Loss: 0.665 Test Acc: 0.809
Validation loss decreased (-0.793742 --> -0.809368).  Saving model ...
Epoch: 8 cost time: 1.5498278141021729
Epoch: 8, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.606 Vali Acc: 0.831 Test Loss: 0.606 Test Acc: 0.831
Validation loss decreased (-0.809368 --> -0.831244).  Saving model ...
Epoch: 9 cost time: 1.8034708499908447
Epoch: 9, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.571 Vali Acc: 0.841 Test Loss: 0.571 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840619).  Saving model ...
Epoch: 10 cost time: 1.873084545135498
Epoch: 10, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.568 Vali Acc: 0.838 Test Loss: 0.568 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7548880577087402
Epoch: 11, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.565 Vali Acc: 0.806 Test Loss: 0.565 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.83536696434021
Epoch: 12, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 13 cost time: 1.7023429870605469
Epoch: 13, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0290138721466064
Epoch: 14, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6247994899749756
Epoch: 15, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.520 Vali Acc: 0.831 Test Loss: 0.520 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.69390869140625
Epoch: 16, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.067753314971924
Epoch: 17, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.540 Vali Acc: 0.847 Test Loss: 0.540 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 18 cost time: 1.8130366802215576
Epoch: 18, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8931677341461182
Epoch: 19, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8826937675476074
Epoch: 20, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 21 cost time: 1.864344596862793
Epoch: 21, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7757656574249268
Epoch: 22, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8429393768310547
Epoch: 23, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9733142852783203
Epoch: 24, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.560 Vali Acc: 0.831 Test Loss: 0.560 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.764237642288208
Epoch: 25, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7499146461486816
Epoch: 26, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7167224884033203
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.548 Vali Acc: 0.838 Test Loss: 0.548 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.838247299194336
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.567 Vali Acc: 0.853 Test Loss: 0.567 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.988997459411621
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9149327278137207
Epoch: 30, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 3636036
model size : 16.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8147764205932617
Epoch: 1, Steps: 8 | Train Loss: 2.069 Vali Loss: 1.973 Vali Acc: 0.194 Test Loss: 1.973 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 1.894195556640625
Epoch: 2, Steps: 8 | Train Loss: 1.916 Vali Loss: 1.781 Vali Acc: 0.453 Test Loss: 1.781 Test Acc: 0.453
Validation loss decreased (-0.193730 --> -0.453107).  Saving model ...
Epoch: 3 cost time: 1.7232990264892578
Epoch: 3, Steps: 8 | Train Loss: 1.677 Vali Loss: 1.470 Vali Acc: 0.716 Test Loss: 1.470 Test Acc: 0.716
Validation loss decreased (-0.453107 --> -0.715610).  Saving model ...
Epoch: 4 cost time: 1.7935376167297363
Epoch: 4, Steps: 8 | Train Loss: 1.314 Vali Loss: 1.111 Vali Acc: 0.734 Test Loss: 1.111 Test Acc: 0.734
Validation loss decreased (-0.715610 --> -0.734364).  Saving model ...
Epoch: 5 cost time: 1.602790117263794
Epoch: 5, Steps: 8 | Train Loss: 0.963 Vali Loss: 0.817 Vali Acc: 0.838 Test Loss: 0.817 Test Acc: 0.838
Validation loss decreased (-0.734364 --> -0.837492).  Saving model ...
Epoch: 6 cost time: 2.1477465629577637
Epoch: 6, Steps: 8 | Train Loss: 0.721 Vali Loss: 0.682 Vali Acc: 0.800 Test Loss: 0.682 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6765847206115723
Epoch: 7, Steps: 8 | Train Loss: 0.541 Vali Loss: 0.585 Vali Acc: 0.834 Test Loss: 0.585 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6145908832550049
Epoch: 8, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
Validation loss decreased (-0.837492 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 2.1024091243743896
Epoch: 9, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.582 Vali Acc: 0.797 Test Loss: 0.582 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7089738845825195
Epoch: 10, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.525 Vali Acc: 0.847 Test Loss: 0.525 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 1.8797662258148193
Epoch: 11, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9804120063781738
Epoch: 12, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.025697946548462
Epoch: 13, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.484 Vali Acc: 0.856 Test Loss: 0.484 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 1.681565761566162
Epoch: 14, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5880918502807617
Epoch: 15, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.538 Vali Acc: 0.831 Test Loss: 0.538 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7605302333831787
Epoch: 16, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.508 Vali Acc: 0.828 Test Loss: 0.508 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7218043804168701
Epoch: 17, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8833234310150146
Epoch: 18, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.520 Vali Acc: 0.828 Test Loss: 0.520 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.059929609298706
Epoch: 19, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7967047691345215
Epoch: 20, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.503 Vali Acc: 0.863 Test Loss: 0.503 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 21 cost time: 1.993708848953247
Epoch: 21, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.511 Vali Acc: 0.853 Test Loss: 0.511 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4578301906585693
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.932997465133667
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7835731506347656
Epoch: 24, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.508 Vali Acc: 0.863 Test Loss: 0.508 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7675902843475342
Epoch: 25, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7777643203735352
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6411147117614746
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6873927116394043
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.519 Vali Acc: 0.853 Test Loss: 0.519 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8422207832336426
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.516 Vali Acc: 0.866 Test Loss: 0.516 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 30 cost time: 1.7796990871429443
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.967045783996582
Epoch: 31, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.532 Vali Acc: 0.853 Test Loss: 0.532 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7878639698028564
Epoch: 32, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.532 Vali Acc: 0.859 Test Loss: 0.532 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.8531932830810547
Epoch: 33, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.7032840251922607
Epoch: 34, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.070211172103882
Epoch: 35, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.533 Vali Acc: 0.866 Test Loss: 0.533 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8134479522705078
Epoch: 36, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.9502365589141846
Epoch: 37, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.541 Vali Acc: 0.863 Test Loss: 0.541 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.6538116931915283
Epoch: 38, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.534 Vali Acc: 0.866 Test Loss: 0.534 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.6795928478240967
Epoch: 39, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.539 Vali Acc: 0.866 Test Loss: 0.539 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 3629380
model size : 16.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1609654426574707
Epoch: 1, Steps: 8 | Train Loss: 2.192 Vali Loss: 2.002 Vali Acc: 0.206 Test Loss: 2.002 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 1.6787078380584717
Epoch: 2, Steps: 8 | Train Loss: 1.951 Vali Loss: 1.819 Vali Acc: 0.391 Test Loss: 1.819 Test Acc: 0.391
Validation loss decreased (-0.206230 --> -0.390607).  Saving model ...
Epoch: 3 cost time: 1.722346544265747
Epoch: 3, Steps: 8 | Train Loss: 1.685 Vali Loss: 1.480 Vali Acc: 0.619 Test Loss: 1.480 Test Acc: 0.619
Validation loss decreased (-0.390607 --> -0.618735).  Saving model ...
Epoch: 4 cost time: 1.5355875492095947
Epoch: 4, Steps: 8 | Train Loss: 1.326 Vali Loss: 1.164 Vali Acc: 0.719 Test Loss: 1.164 Test Acc: 0.719
Validation loss decreased (-0.618735 --> -0.718738).  Saving model ...
Epoch: 5 cost time: 1.669776439666748
Epoch: 5, Steps: 8 | Train Loss: 0.969 Vali Loss: 0.879 Vali Acc: 0.769 Test Loss: 0.879 Test Acc: 0.769
Validation loss decreased (-0.718738 --> -0.768741).  Saving model ...
Epoch: 6 cost time: 1.665013313293457
Epoch: 6, Steps: 8 | Train Loss: 0.708 Vali Loss: 0.704 Vali Acc: 0.803 Test Loss: 0.704 Test Acc: 0.803
Validation loss decreased (-0.768741 --> -0.803118).  Saving model ...
Epoch: 7 cost time: 1.3322863578796387
Epoch: 7, Steps: 8 | Train Loss: 0.514 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
Validation loss decreased (-0.803118 --> -0.809369).  Saving model ...
Epoch: 8 cost time: 1.5342786312103271
Epoch: 8, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.564 Vali Acc: 0.828 Test Loss: 0.564 Test Acc: 0.828
Validation loss decreased (-0.809369 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 1.9567675590515137
Epoch: 9, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 1.6846981048583984
Epoch: 10, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.559 Vali Acc: 0.806 Test Loss: 0.559 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.750962495803833
Epoch: 11, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.576383113861084
Epoch: 12, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6583406925201416
Epoch: 13, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.523 Vali Acc: 0.825 Test Loss: 0.523 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.622300624847412
Epoch: 14, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 15 cost time: 2.4129605293273926
Epoch: 15, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9550504684448242
Epoch: 16, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.552 Vali Acc: 0.834 Test Loss: 0.552 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6182477474212646
Epoch: 17, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.65455961227417
Epoch: 18, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.561523675918579
Epoch: 19, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.615706205368042
Epoch: 20, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.541 Vali Acc: 0.828 Test Loss: 0.541 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6245450973510742
Epoch: 21, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.526 Vali Acc: 0.847 Test Loss: 0.526 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 22 cost time: 1.5272772312164307
Epoch: 22, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6418280601501465
Epoch: 23, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5529098510742188
Epoch: 24, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6621878147125244
Epoch: 25, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.537 Vali Acc: 0.816 Test Loss: 0.537 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.590322494506836
Epoch: 26, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.559 Vali Acc: 0.831 Test Loss: 0.559 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.562342643737793
Epoch: 27, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.684061050415039
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.493082046508789
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.555 Vali Acc: 0.828 Test Loss: 0.555 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6004815101623535
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6047444343566895
Epoch: 31, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 3622724
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5750417709350586
Epoch: 1, Steps: 8 | Train Loss: 2.072 Vali Loss: 1.994 Vali Acc: 0.269 Test Loss: 1.994 Test Acc: 0.269
Validation loss decreased (inf --> -0.268730).  Saving model ...
Epoch: 2 cost time: 1.7592508792877197
Epoch: 2, Steps: 8 | Train Loss: 2.049 Vali Loss: 1.917 Vali Acc: 0.384 Test Loss: 1.917 Test Acc: 0.384
Validation loss decreased (-0.268730 --> -0.384356).  Saving model ...
Epoch: 3 cost time: 1.7408502101898193
Epoch: 3, Steps: 8 | Train Loss: 1.844 Vali Loss: 1.548 Vali Acc: 0.609 Test Loss: 1.548 Test Acc: 0.609
Validation loss decreased (-0.384356 --> -0.609360).  Saving model ...
Epoch: 4 cost time: 1.576969861984253
Epoch: 4, Steps: 8 | Train Loss: 1.408 Vali Loss: 1.205 Vali Acc: 0.628 Test Loss: 1.205 Test Acc: 0.628
Validation loss decreased (-0.609360 --> -0.628113).  Saving model ...
Epoch: 5 cost time: 1.8490140438079834
Epoch: 5, Steps: 8 | Train Loss: 1.013 Vali Loss: 0.891 Vali Acc: 0.791 Test Loss: 0.891 Test Acc: 0.791
Validation loss decreased (-0.628113 --> -0.790616).  Saving model ...
Epoch: 6 cost time: 1.9103813171386719
Epoch: 6, Steps: 8 | Train Loss: 0.742 Vali Loss: 0.712 Vali Acc: 0.797 Test Loss: 0.712 Test Acc: 0.797
Validation loss decreased (-0.790616 --> -0.796868).  Saving model ...
Epoch: 7 cost time: 1.7795329093933105
Epoch: 7, Steps: 8 | Train Loss: 0.582 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
Validation loss decreased (-0.796868 --> -0.809369).  Saving model ...
Epoch: 8 cost time: 1.493619680404663
Epoch: 8, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 1.626737356185913
Epoch: 9, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.583 Vali Acc: 0.800 Test Loss: 0.583 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9759840965270996
Epoch: 10, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 2.076005697250366
Epoch: 11, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.552 Vali Acc: 0.834 Test Loss: 0.552 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834369).  Saving model ...
Epoch: 12 cost time: 1.8242864608764648
Epoch: 12, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.522 Vali Acc: 0.825 Test Loss: 0.522 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7076137065887451
Epoch: 13, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.518 Vali Acc: 0.847 Test Loss: 0.518 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 1.5441761016845703
Epoch: 14, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4840679168701172
Epoch: 15, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.496 Vali Acc: 0.847 Test Loss: 0.496 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 16 cost time: 1.8912322521209717
Epoch: 16, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.540 Vali Acc: 0.834 Test Loss: 0.540 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.486133337020874
Epoch: 17, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7698209285736084
Epoch: 18, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.517 Vali Acc: 0.859 Test Loss: 0.517 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859370).  Saving model ...
Epoch: 19 cost time: 1.5542240142822266
Epoch: 19, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6347947120666504
Epoch: 20, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.567 Vali Acc: 0.844 Test Loss: 0.567 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.675774097442627
Epoch: 21, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9171149730682373
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8122217655181885
Epoch: 23, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7269043922424316
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7572638988494873
Epoch: 25, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7012650966644287
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.539 Vali Acc: 0.853 Test Loss: 0.539 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7813537120819092
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.541 Vali Acc: 0.859 Test Loss: 0.541 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4314916133880615
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.539 Vali Acc: 0.856 Test Loss: 0.539 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 3616068
model size : 16.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.558272838592529
Epoch: 1, Steps: 8 | Train Loss: 2.198 Vali Loss: 2.081 Vali Acc: 0.250 Test Loss: 2.081 Test Acc: 0.250
Validation loss decreased (inf --> -0.249979).  Saving model ...
Epoch: 2 cost time: 1.9346034526824951
Epoch: 2, Steps: 8 | Train Loss: 2.033 Vali Loss: 1.917 Vali Acc: 0.244 Test Loss: 1.917 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9648199081420898
Epoch: 3, Steps: 8 | Train Loss: 1.872 Vali Loss: 1.630 Vali Acc: 0.650 Test Loss: 1.630 Test Acc: 0.650
Validation loss decreased (-0.249979 --> -0.649984).  Saving model ...
Epoch: 4 cost time: 1.8734362125396729
Epoch: 4, Steps: 8 | Train Loss: 1.525 Vali Loss: 1.310 Vali Acc: 0.709 Test Loss: 1.310 Test Acc: 0.709
Validation loss decreased (-0.649984 --> -0.709362).  Saving model ...
Epoch: 5 cost time: 2.0762875080108643
Epoch: 5, Steps: 8 | Train Loss: 1.144 Vali Loss: 1.004 Vali Acc: 0.772 Test Loss: 1.004 Test Acc: 0.772
Validation loss decreased (-0.709362 --> -0.771865).  Saving model ...
Epoch: 6 cost time: 1.6275360584259033
Epoch: 6, Steps: 8 | Train Loss: 0.794 Vali Loss: 0.762 Vali Acc: 0.806 Test Loss: 0.762 Test Acc: 0.806
Validation loss decreased (-0.771865 --> -0.806242).  Saving model ...
Epoch: 7 cost time: 1.7855982780456543
Epoch: 7, Steps: 8 | Train Loss: 0.619 Vali Loss: 0.659 Vali Acc: 0.797 Test Loss: 0.659 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.980708360671997
Epoch: 8, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.581 Vali Acc: 0.809 Test Loss: 0.581 Test Acc: 0.809
Validation loss decreased (-0.806242 --> -0.809369).  Saving model ...
Epoch: 9 cost time: 1.8486571311950684
Epoch: 9, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.575 Vali Acc: 0.812 Test Loss: 0.575 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 10 cost time: 1.821854591369629
Epoch: 10, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.563 Vali Acc: 0.812 Test Loss: 0.563 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 11 cost time: 1.644643783569336
Epoch: 11, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.562 Vali Acc: 0.828 Test Loss: 0.562 Test Acc: 0.828
Validation loss decreased (-0.812494 --> -0.828119).  Saving model ...
Epoch: 12 cost time: 1.7863702774047852
Epoch: 12, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.559 Vali Acc: 0.800 Test Loss: 0.559 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8630695343017578
Epoch: 13, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.568 Vali Acc: 0.828 Test Loss: 0.568 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9691088199615479
Epoch: 14, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9849812984466553
Epoch: 15, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.100262403488159
Epoch: 16, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.533 Vali Acc: 0.806 Test Loss: 0.533 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9946422576904297
Epoch: 17, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 18 cost time: 1.9654476642608643
Epoch: 18, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7506511211395264
Epoch: 19, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9568002223968506
Epoch: 20, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 21 cost time: 1.714477777481079
Epoch: 21, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.808356285095215
Epoch: 22, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.552 Vali Acc: 0.812 Test Loss: 0.552 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7718966007232666
Epoch: 23, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8910870552062988
Epoch: 24, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9194657802581787
Epoch: 25, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7692999839782715
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.721045732498169
Epoch: 27, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 28 cost time: 1.7217140197753906
Epoch: 28, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 29 cost time: 1.9297349452972412
Epoch: 29, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9552507400512695
Epoch: 30, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.708702802658081
Epoch: 31, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856244).  Saving model ...
Epoch: 32 cost time: 1.8718674182891846
Epoch: 32, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.080007553100586
Epoch: 33, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.974541425704956
Epoch: 34, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.024200439453125
Epoch: 35, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.557 Vali Acc: 0.847 Test Loss: 0.557 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.0313613414764404
Epoch: 36, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.567 Vali Acc: 0.853 Test Loss: 0.567 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.8754305839538574
Epoch: 37, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.818047046661377
Epoch: 38, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.1040947437286377
Epoch: 39, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.556 Vali Acc: 0.853 Test Loss: 0.556 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.882519006729126
Epoch: 40, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.552 Vali Acc: 0.847 Test Loss: 0.552 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.6593961715698242
Epoch: 41, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.563 Vali Acc: 0.853 Test Loss: 0.563 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 3043908
model size : 14.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.974597930908203
Epoch: 1, Steps: 8 | Train Loss: 2.305 Vali Loss: 2.130 Vali Acc: 0.062 Test Loss: 2.130 Test Acc: 0.062
Validation loss decreased (inf --> -0.062479).  Saving model ...
Epoch: 2 cost time: 1.8472886085510254
Epoch: 2, Steps: 8 | Train Loss: 2.092 Vali Loss: 1.992 Vali Acc: 0.222 Test Loss: 1.992 Test Acc: 0.222
Validation loss decreased (-0.062479 --> -0.221855).  Saving model ...
Epoch: 3 cost time: 2.009357213973999
Epoch: 3, Steps: 8 | Train Loss: 1.917 Vali Loss: 1.738 Vali Acc: 0.481 Test Loss: 1.738 Test Acc: 0.481
Validation loss decreased (-0.221855 --> -0.481233).  Saving model ...
Epoch: 4 cost time: 1.8326365947723389
Epoch: 4, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.433 Vali Acc: 0.603 Test Loss: 1.433 Test Acc: 0.603
Validation loss decreased (-0.481233 --> -0.603111).  Saving model ...
Epoch: 5 cost time: 1.6670482158660889
Epoch: 5, Steps: 8 | Train Loss: 1.242 Vali Loss: 1.078 Vali Acc: 0.762 Test Loss: 1.078 Test Acc: 0.762
Validation loss decreased (-0.603111 --> -0.762489).  Saving model ...
Epoch: 6 cost time: 1.5333280563354492
Epoch: 6, Steps: 8 | Train Loss: 0.888 Vali Loss: 0.817 Vali Acc: 0.791 Test Loss: 0.817 Test Acc: 0.791
Validation loss decreased (-0.762489 --> -0.790617).  Saving model ...
Epoch: 7 cost time: 1.7125840187072754
Epoch: 7, Steps: 8 | Train Loss: 0.616 Vali Loss: 0.670 Vali Acc: 0.809 Test Loss: 0.670 Test Acc: 0.809
Validation loss decreased (-0.790617 --> -0.809368).  Saving model ...
Epoch: 8 cost time: 1.6158733367919922
Epoch: 8, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.585 Vali Acc: 0.831 Test Loss: 0.585 Test Acc: 0.831
Validation loss decreased (-0.809368 --> -0.831244).  Saving model ...
Epoch: 9 cost time: 1.8815572261810303
Epoch: 9, Steps: 8 | Train Loss: 0.419 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7679905891418457
Epoch: 10, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.546 Vali Acc: 0.831 Test Loss: 0.546 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 11 cost time: 2.2986834049224854
Epoch: 11, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 1.720796823501587
Epoch: 12, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7102372646331787
Epoch: 13, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.521 Vali Acc: 0.819 Test Loss: 0.521 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7510349750518799
Epoch: 14, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.546 Vali Acc: 0.812 Test Loss: 0.546 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9638760089874268
Epoch: 15, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.618764877319336
Epoch: 16, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.542 Vali Acc: 0.812 Test Loss: 0.542 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.839101791381836
Epoch: 17, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9487388134002686
Epoch: 18, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9539408683776855
Epoch: 19, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6638383865356445
Epoch: 20, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.538 Vali Acc: 0.816 Test Loss: 0.538 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7241270542144775
Epoch: 21, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 3037252
model size : 14.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7499849796295166
Epoch: 1, Steps: 8 | Train Loss: 2.119 Vali Loss: 1.997 Vali Acc: 0.269 Test Loss: 1.997 Test Acc: 0.269
Validation loss decreased (inf --> -0.268730).  Saving model ...
Epoch: 2 cost time: 1.756561040878296
Epoch: 2, Steps: 8 | Train Loss: 1.952 Vali Loss: 1.797 Vali Acc: 0.422 Test Loss: 1.797 Test Acc: 0.422
Validation loss decreased (-0.268730 --> -0.421857).  Saving model ...
Epoch: 3 cost time: 1.7428622245788574
Epoch: 3, Steps: 8 | Train Loss: 1.765 Vali Loss: 1.477 Vali Acc: 0.656 Test Loss: 1.477 Test Acc: 0.656
Validation loss decreased (-0.421857 --> -0.656235).  Saving model ...
Epoch: 4 cost time: 1.6104602813720703
Epoch: 4, Steps: 8 | Train Loss: 1.326 Vali Loss: 1.144 Vali Acc: 0.756 Test Loss: 1.144 Test Acc: 0.756
Validation loss decreased (-0.656235 --> -0.756239).  Saving model ...
Epoch: 5 cost time: 1.8362767696380615
Epoch: 5, Steps: 8 | Train Loss: 0.990 Vali Loss: 0.889 Vali Acc: 0.772 Test Loss: 0.889 Test Acc: 0.772
Validation loss decreased (-0.756239 --> -0.771866).  Saving model ...
Epoch: 6 cost time: 1.8910362720489502
Epoch: 6, Steps: 8 | Train Loss: 0.700 Vali Loss: 0.728 Vali Acc: 0.791 Test Loss: 0.728 Test Acc: 0.791
Validation loss decreased (-0.771866 --> -0.790618).  Saving model ...
Epoch: 7 cost time: 1.8478035926818848
Epoch: 7, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.646 Vali Acc: 0.791 Test Loss: 0.646 Test Acc: 0.791
Validation loss decreased (-0.790618 --> -0.790619).  Saving model ...
Epoch: 8 cost time: 2.1468780040740967
Epoch: 8, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
Validation loss decreased (-0.790619 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 1.9463393688201904
Epoch: 9, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8108618259429932
Epoch: 10, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840619).  Saving model ...
Epoch: 11 cost time: 1.7878329753875732
Epoch: 11, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.517 Vali Acc: 0.847 Test Loss: 0.517 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 1.8168997764587402
Epoch: 12, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 1.9202003479003906
Epoch: 13, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.533 Vali Acc: 0.847 Test Loss: 0.533 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7358062267303467
Epoch: 14, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7915432453155518
Epoch: 15, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6328065395355225
Epoch: 16, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7914366722106934
Epoch: 17, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.502 Vali Acc: 0.853 Test Loss: 0.502 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 18 cost time: 1.970980167388916
Epoch: 18, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9580061435699463
Epoch: 19, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6213281154632568
Epoch: 20, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.491 Vali Acc: 0.869 Test Loss: 0.491 Test Acc: 0.869
Validation loss decreased (-0.853120 --> -0.868745).  Saving model ...
Epoch: 21 cost time: 1.741786003112793
Epoch: 21, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.510 Vali Acc: 0.853 Test Loss: 0.510 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0443172454833984
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.910491704940796
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.527 Vali Acc: 0.866 Test Loss: 0.527 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7681286334991455
Epoch: 24, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.519 Vali Acc: 0.859 Test Loss: 0.519 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.693270206451416
Epoch: 25, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.521 Vali Acc: 0.863 Test Loss: 0.521 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0202653408050537
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6472527980804443
Epoch: 27, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.9933021068572998
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8223659992218018
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.533 Vali Acc: 0.853 Test Loss: 0.533 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9283404350280762
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.529 Vali Acc: 0.863 Test Loss: 0.529 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 3030596
model size : 14.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8597679138183594
Epoch: 1, Steps: 8 | Train Loss: 2.193 Vali Loss: 1.998 Vali Acc: 0.312 Test Loss: 1.998 Test Acc: 0.312
Validation loss decreased (inf --> -0.312480).  Saving model ...
Epoch: 2 cost time: 2.0691754817962646
Epoch: 2, Steps: 8 | Train Loss: 2.005 Vali Loss: 1.864 Vali Acc: 0.300 Test Loss: 1.864 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0834593772888184
Epoch: 3, Steps: 8 | Train Loss: 1.749 Vali Loss: 1.572 Vali Acc: 0.653 Test Loss: 1.572 Test Acc: 0.653
Validation loss decreased (-0.312480 --> -0.653109).  Saving model ...
Epoch: 4 cost time: 1.9446542263031006
Epoch: 4, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.248 Vali Acc: 0.753 Test Loss: 1.248 Test Acc: 0.753
Validation loss decreased (-0.653109 --> -0.753113).  Saving model ...
Epoch: 5 cost time: 1.8838257789611816
Epoch: 5, Steps: 8 | Train Loss: 1.093 Vali Loss: 0.945 Vali Acc: 0.747 Test Loss: 0.945 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7764873504638672
Epoch: 6, Steps: 8 | Train Loss: 0.819 Vali Loss: 0.743 Vali Acc: 0.825 Test Loss: 0.743 Test Acc: 0.825
Validation loss decreased (-0.753113 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 1.850825309753418
Epoch: 7, Steps: 8 | Train Loss: 0.586 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.807769536972046
Epoch: 8, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 1.8040900230407715
Epoch: 9, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.572 Vali Acc: 0.834 Test Loss: 0.572 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 10 cost time: 1.87843656539917
Epoch: 10, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 1.8589601516723633
Epoch: 11, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6923341751098633
Epoch: 12, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5908894538879395
Epoch: 13, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6810872554779053
Epoch: 14, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8673572540283203
Epoch: 15, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8778424263000488
Epoch: 16, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7530481815338135
Epoch: 17, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0533249378204346
Epoch: 18, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 19 cost time: 1.9383599758148193
Epoch: 19, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.907520055770874
Epoch: 20, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.520 Vali Acc: 0.847 Test Loss: 0.520 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 21 cost time: 1.9495387077331543
Epoch: 21, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.517 Vali Acc: 0.847 Test Loss: 0.517 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 22 cost time: 1.5795924663543701
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.593027114868164
Epoch: 23, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 1.7116992473602295
Epoch: 24, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 25 cost time: 1.8268342018127441
Epoch: 25, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 26 cost time: 1.9438939094543457
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.390118360519409
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.856391429901123
Epoch: 28, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 29 cost time: 1.8089900016784668
Epoch: 29, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.529 Vali Acc: 0.859 Test Loss: 0.529 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 30 cost time: 1.5678534507751465
Epoch: 30, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8598434925079346
Epoch: 31, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.550 Vali Acc: 0.847 Test Loss: 0.550 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.0008678436279297
Epoch: 32, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.558 Vali Acc: 0.847 Test Loss: 0.558 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7644269466400146
Epoch: 33, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.7683203220367432
Epoch: 34, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7662465572357178
Epoch: 35, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.542 Vali Acc: 0.853 Test Loss: 0.542 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8982133865356445
Epoch: 36, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.549 Vali Acc: 0.847 Test Loss: 0.549 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.7591302394866943
Epoch: 37, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.9189057350158691
Epoch: 38, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.559 Vali Acc: 0.853 Test Loss: 0.559 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.033953905105591
Epoch: 39, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 3023940
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9109737873077393
Epoch: 1, Steps: 8 | Train Loss: 2.178 Vali Loss: 2.044 Vali Acc: 0.169 Test Loss: 2.044 Test Acc: 0.169
Validation loss decreased (inf --> -0.168730).  Saving model ...
Epoch: 2 cost time: 1.9166791439056396
Epoch: 2, Steps: 8 | Train Loss: 2.055 Vali Loss: 1.916 Vali Acc: 0.381 Test Loss: 1.916 Test Acc: 0.381
Validation loss decreased (-0.168730 --> -0.381231).  Saving model ...
Epoch: 3 cost time: 1.6684253215789795
Epoch: 3, Steps: 8 | Train Loss: 1.858 Vali Loss: 1.657 Vali Acc: 0.600 Test Loss: 1.657 Test Acc: 0.600
Validation loss decreased (-0.381231 --> -0.599983).  Saving model ...
Epoch: 4 cost time: 2.319340229034424
Epoch: 4, Steps: 8 | Train Loss: 1.587 Vali Loss: 1.350 Vali Acc: 0.700 Test Loss: 1.350 Test Acc: 0.700
Validation loss decreased (-0.599983 --> -0.699987).  Saving model ...
Epoch: 5 cost time: 2.1116278171539307
Epoch: 5, Steps: 8 | Train Loss: 1.211 Vali Loss: 1.030 Vali Acc: 0.747 Test Loss: 1.030 Test Acc: 0.747
Validation loss decreased (-0.699987 --> -0.746865).  Saving model ...
Epoch: 6 cost time: 2.0008387565612793
Epoch: 6, Steps: 8 | Train Loss: 0.893 Vali Loss: 0.792 Vali Acc: 0.819 Test Loss: 0.792 Test Acc: 0.819
Validation loss decreased (-0.746865 --> -0.818742).  Saving model ...
Epoch: 7 cost time: 2.832235097885132
Epoch: 7, Steps: 8 | Train Loss: 0.642 Vali Loss: 0.675 Vali Acc: 0.809 Test Loss: 0.675 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5326039791107178
Epoch: 8, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.600 Vali Acc: 0.797 Test Loss: 0.600 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6328413486480713
Epoch: 9, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.578 Vali Acc: 0.831 Test Loss: 0.578 Test Acc: 0.831
Validation loss decreased (-0.818742 --> -0.831244).  Saving model ...
Epoch: 10 cost time: 2.238285541534424
Epoch: 10, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2639801502227783
Epoch: 11, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.31915283203125
Epoch: 12, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9417059421539307
Epoch: 13, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0228424072265625
Epoch: 14, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 15 cost time: 2.147963523864746
Epoch: 15, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8679697513580322
Epoch: 16, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.577 Vali Acc: 0.803 Test Loss: 0.577 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.047731637954712
Epoch: 17, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.01802921295166
Epoch: 18, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2120964527130127
Epoch: 19, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.550 Vali Acc: 0.828 Test Loss: 0.550 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.431805372238159
Epoch: 20, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.559 Vali Acc: 0.812 Test Loss: 0.559 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1031646728515625
Epoch: 21, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.577 Vali Acc: 0.816 Test Loss: 0.577 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.754267930984497
Epoch: 22, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.570 Vali Acc: 0.812 Test Loss: 0.570 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.09793758392334
Epoch: 23, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.162745952606201
Epoch: 24, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 2747844
model size : 13.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9793992042541504
Epoch: 1, Steps: 8 | Train Loss: 2.193 Vali Loss: 2.034 Vali Acc: 0.234 Test Loss: 2.034 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 2.2280256748199463
Epoch: 2, Steps: 8 | Train Loss: 2.040 Vali Loss: 1.918 Vali Acc: 0.272 Test Loss: 1.918 Test Acc: 0.272
Validation loss decreased (-0.234355 --> -0.271856).  Saving model ...
Epoch: 3 cost time: 1.9475791454315186
Epoch: 3, Steps: 8 | Train Loss: 1.858 Vali Loss: 1.671 Vali Acc: 0.516 Test Loss: 1.671 Test Acc: 0.516
Validation loss decreased (-0.271856 --> -0.515608).  Saving model ...
Epoch: 4 cost time: 1.9734554290771484
Epoch: 4, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.379 Vali Acc: 0.719 Test Loss: 1.379 Test Acc: 0.719
Validation loss decreased (-0.515608 --> -0.718736).  Saving model ...
Epoch: 5 cost time: 2.3615386486053467
Epoch: 5, Steps: 8 | Train Loss: 1.219 Vali Loss: 1.048 Vali Acc: 0.784 Test Loss: 1.048 Test Acc: 0.784
Validation loss decreased (-0.718736 --> -0.784365).  Saving model ...
Epoch: 6 cost time: 1.817854881286621
Epoch: 6, Steps: 8 | Train Loss: 0.924 Vali Loss: 0.806 Vali Acc: 0.812 Test Loss: 0.806 Test Acc: 0.812
Validation loss decreased (-0.784365 --> -0.812492).  Saving model ...
Epoch: 7 cost time: 2.231962203979492
Epoch: 7, Steps: 8 | Train Loss: 0.632 Vali Loss: 0.674 Vali Acc: 0.819 Test Loss: 0.674 Test Acc: 0.819
Validation loss decreased (-0.812492 --> -0.818743).  Saving model ...
Epoch: 8 cost time: 1.751089334487915
Epoch: 8, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
Validation loss decreased (-0.818743 --> -0.840619).  Saving model ...
Epoch: 9 cost time: 2.163684368133545
Epoch: 9, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6088786125183105
Epoch: 10, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.543 Vali Acc: 0.847 Test Loss: 0.543 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 1.8426012992858887
Epoch: 11, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.494 Vali Acc: 0.856 Test Loss: 0.494 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 1.6383056640625
Epoch: 12, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7915236949920654
Epoch: 13, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8141791820526123
Epoch: 14, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.010319709777832
Epoch: 15, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8039870262145996
Epoch: 16, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.493 Vali Acc: 0.853 Test Loss: 0.493 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8683552742004395
Epoch: 17, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.475 Vali Acc: 0.856 Test Loss: 0.475 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 18 cost time: 1.8397157192230225
Epoch: 18, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9444687366485596
Epoch: 19, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.500 Vali Acc: 0.859 Test Loss: 0.500 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 20 cost time: 1.8381478786468506
Epoch: 20, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.487 Vali Acc: 0.863 Test Loss: 0.487 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 21 cost time: 1.6710028648376465
Epoch: 21, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1510820388793945
Epoch: 22, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9661343097686768
Epoch: 23, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.502 Vali Acc: 0.859 Test Loss: 0.502 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.908515453338623
Epoch: 24, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.491 Vali Acc: 0.863 Test Loss: 0.491 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.2370903491973877
Epoch: 25, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.487 Vali Acc: 0.859 Test Loss: 0.487 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8219897747039795
Epoch: 26, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.500 Vali Acc: 0.863 Test Loss: 0.500 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6854348182678223
Epoch: 27, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8455355167388916
Epoch: 28, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.3392586708068848
Epoch: 29, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.508 Vali Acc: 0.863 Test Loss: 0.508 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.8046104907989502
Epoch: 30, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.505 Vali Acc: 0.869 Test Loss: 0.505 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 31 cost time: 1.9098081588745117
Epoch: 31, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.512 Vali Acc: 0.853 Test Loss: 0.512 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6433680057525635
Epoch: 32, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.518 Vali Acc: 0.856 Test Loss: 0.518 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.826291799545288
Epoch: 33, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.520 Vali Acc: 0.866 Test Loss: 0.520 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.48500394821167
Epoch: 34, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.515 Vali Acc: 0.866 Test Loss: 0.515 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.9043521881103516
Epoch: 35, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.509 Vali Acc: 0.872 Test Loss: 0.509 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871870).  Saving model ...
Epoch: 36 cost time: 2.021394729614258
Epoch: 36, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.502 Vali Acc: 0.869 Test Loss: 0.502 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.9560184478759766
Epoch: 37, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.506 Vali Acc: 0.866 Test Loss: 0.506 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.0148444175720215
Epoch: 38, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.866 Test Loss: 0.524 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.435180902481079
Epoch: 39, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.527 Vali Acc: 0.863 Test Loss: 0.527 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.0040078163146973
Epoch: 40, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.520 Vali Acc: 0.859 Test Loss: 0.520 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.742520809173584
Epoch: 41, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.512 Vali Acc: 0.869 Test Loss: 0.512 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.0583934783935547
Epoch: 42, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.517 Vali Acc: 0.866 Test Loss: 0.517 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.0689244270324707
Epoch: 43, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.8084242343902588
Epoch: 44, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.520 Vali Acc: 0.866 Test Loss: 0.520 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.619095802307129
Epoch: 45, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.521 Vali Acc: 0.866 Test Loss: 0.521 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 2741188
model size : 13.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.789983034133911
Epoch: 1, Steps: 8 | Train Loss: 2.204 Vali Loss: 2.052 Vali Acc: 0.125 Test Loss: 2.052 Test Acc: 0.125
Validation loss decreased (inf --> -0.124979).  Saving model ...
Epoch: 2 cost time: 1.8919384479522705
Epoch: 2, Steps: 8 | Train Loss: 2.051 Vali Loss: 1.851 Vali Acc: 0.319 Test Loss: 1.851 Test Acc: 0.319
Validation loss decreased (-0.124979 --> -0.318731).  Saving model ...
Epoch: 3 cost time: 1.593210220336914
Epoch: 3, Steps: 8 | Train Loss: 1.825 Vali Loss: 1.564 Vali Acc: 0.669 Test Loss: 1.564 Test Acc: 0.669
Validation loss decreased (-0.318731 --> -0.668734).  Saving model ...
Epoch: 4 cost time: 1.868128776550293
Epoch: 4, Steps: 8 | Train Loss: 1.511 Vali Loss: 1.264 Vali Acc: 0.709 Test Loss: 1.264 Test Acc: 0.709
Validation loss decreased (-0.668734 --> -0.709362).  Saving model ...
Epoch: 5 cost time: 1.7777349948883057
Epoch: 5, Steps: 8 | Train Loss: 1.149 Vali Loss: 0.949 Vali Acc: 0.775 Test Loss: 0.949 Test Acc: 0.775
Validation loss decreased (-0.709362 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 1.9777870178222656
Epoch: 6, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.720 Vali Acc: 0.831 Test Loss: 0.720 Test Acc: 0.831
Validation loss decreased (-0.774991 --> -0.831243).  Saving model ...
Epoch: 7 cost time: 1.4899091720581055
Epoch: 7, Steps: 8 | Train Loss: 0.622 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
Validation loss decreased (-0.831243 --> -0.849994).  Saving model ...
Epoch: 8 cost time: 1.6880130767822266
Epoch: 8, Steps: 8 | Train Loss: 0.514 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.462097406387329
Epoch: 9, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2534539699554443
Epoch: 10, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6587026119232178
Epoch: 11, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.511 Vali Acc: 0.831 Test Loss: 0.511 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.746011734008789
Epoch: 12, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.505 Vali Acc: 0.838 Test Loss: 0.505 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.84434175491333
Epoch: 13, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 1.7116482257843018
Epoch: 14, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5297942161560059
Epoch: 15, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.512 Vali Acc: 0.831 Test Loss: 0.512 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7787694931030273
Epoch: 16, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.525 Vali Acc: 0.831 Test Loss: 0.525 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.236145257949829
Epoch: 17, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.504 Vali Acc: 0.834 Test Loss: 0.504 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7930757999420166
Epoch: 18, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7547245025634766
Epoch: 19, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0191972255706787
Epoch: 20, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.522 Vali Acc: 0.822 Test Loss: 0.522 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9580109119415283
Epoch: 21, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.529 Vali Acc: 0.828 Test Loss: 0.529 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0421345233917236
Epoch: 22, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7675883769989014
Epoch: 23, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 2734532
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.448725700378418
Epoch: 1, Steps: 8 | Train Loss: 2.274 Vali Loss: 2.134 Vali Acc: 0.113 Test Loss: 2.134 Test Acc: 0.113
Validation loss decreased (inf --> -0.112479).  Saving model ...
Epoch: 2 cost time: 1.7798025608062744
Epoch: 2, Steps: 8 | Train Loss: 2.092 Vali Loss: 1.986 Vali Acc: 0.147 Test Loss: 1.986 Test Acc: 0.147
Validation loss decreased (-0.112479 --> -0.146855).  Saving model ...
Epoch: 3 cost time: 1.5467054843902588
Epoch: 3, Steps: 8 | Train Loss: 1.943 Vali Loss: 1.736 Vali Acc: 0.522 Test Loss: 1.736 Test Acc: 0.522
Validation loss decreased (-0.146855 --> -0.521858).  Saving model ...
Epoch: 4 cost time: 1.424851894378662
Epoch: 4, Steps: 8 | Train Loss: 1.705 Vali Loss: 1.492 Vali Acc: 0.619 Test Loss: 1.492 Test Acc: 0.619
Validation loss decreased (-0.521858 --> -0.618735).  Saving model ...
Epoch: 5 cost time: 1.4138612747192383
Epoch: 5, Steps: 8 | Train Loss: 1.303 Vali Loss: 1.115 Vali Acc: 0.756 Test Loss: 1.115 Test Acc: 0.756
Validation loss decreased (-0.618735 --> -0.756239).  Saving model ...
Epoch: 6 cost time: 1.8050317764282227
Epoch: 6, Steps: 8 | Train Loss: 0.993 Vali Loss: 0.825 Vali Acc: 0.819 Test Loss: 0.825 Test Acc: 0.819
Validation loss decreased (-0.756239 --> -0.818742).  Saving model ...
Epoch: 7 cost time: 1.6931140422821045
Epoch: 7, Steps: 8 | Train Loss: 0.710 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
Validation loss decreased (-0.818742 --> -0.818743).  Saving model ...
Epoch: 8 cost time: 1.4465603828430176
Epoch: 8, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.600 Vali Acc: 0.853 Test Loss: 0.600 Test Acc: 0.853
Validation loss decreased (-0.818743 --> -0.853119).  Saving model ...
Epoch: 9 cost time: 1.8663811683654785
Epoch: 9, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6428720951080322
Epoch: 10, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5194854736328125
Epoch: 11, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 1.4995300769805908
Epoch: 12, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7483484745025635
Epoch: 13, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.808469295501709
Epoch: 14, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6269476413726807
Epoch: 15, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4434382915496826
Epoch: 16, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5776731967926025
Epoch: 17, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4633605480194092
Epoch: 18, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.525 Vali Acc: 0.838 Test Loss: 0.525 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4278695583343506
Epoch: 19, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4325041770935059
Epoch: 20, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.537 Vali Acc: 0.847 Test Loss: 0.537 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.442202091217041
Epoch: 21, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 2727876
model size : 13.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9756128787994385
Epoch: 1, Steps: 8 | Train Loss: 2.145 Vali Loss: 2.048 Vali Acc: 0.209 Test Loss: 2.048 Test Acc: 0.209
Validation loss decreased (inf --> -0.209355).  Saving model ...
Epoch: 2 cost time: 1.6999320983886719
Epoch: 2, Steps: 8 | Train Loss: 2.020 Vali Loss: 1.916 Vali Acc: 0.341 Test Loss: 1.916 Test Acc: 0.341
Validation loss decreased (-0.209355 --> -0.340606).  Saving model ...
Epoch: 3 cost time: 1.4539422988891602
Epoch: 3, Steps: 8 | Train Loss: 1.889 Vali Loss: 1.687 Vali Acc: 0.603 Test Loss: 1.687 Test Acc: 0.603
Validation loss decreased (-0.340606 --> -0.603108).  Saving model ...
Epoch: 4 cost time: 1.4405531883239746
Epoch: 4, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.429 Vali Acc: 0.662 Test Loss: 1.429 Test Acc: 0.662
Validation loss decreased (-0.603108 --> -0.662486).  Saving model ...
Epoch: 5 cost time: 1.3789851665496826
Epoch: 5, Steps: 8 | Train Loss: 1.339 Vali Loss: 1.164 Vali Acc: 0.753 Test Loss: 1.164 Test Acc: 0.753
Validation loss decreased (-0.662486 --> -0.753113).  Saving model ...
Epoch: 6 cost time: 1.4153141975402832
Epoch: 6, Steps: 8 | Train Loss: 1.068 Vali Loss: 0.975 Vali Acc: 0.744 Test Loss: 0.975 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4345977306365967
Epoch: 7, Steps: 8 | Train Loss: 0.866 Vali Loss: 0.827 Vali Acc: 0.794 Test Loss: 0.827 Test Acc: 0.794
Validation loss decreased (-0.753113 --> -0.793742).  Saving model ...
Epoch: 8 cost time: 1.3330199718475342
Epoch: 8, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.714 Vali Acc: 0.841 Test Loss: 0.714 Test Acc: 0.841
Validation loss decreased (-0.793742 --> -0.840618).  Saving model ...
Epoch: 9 cost time: 1.3513691425323486
Epoch: 9, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.662 Vali Acc: 0.803 Test Loss: 0.662 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4729771614074707
Epoch: 10, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.602 Vali Acc: 0.841 Test Loss: 0.602 Test Acc: 0.841
Validation loss decreased (-0.840618 --> -0.840619).  Saving model ...
Epoch: 11 cost time: 1.4322702884674072
Epoch: 11, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 12 cost time: 1.2474780082702637
Epoch: 12, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3719415664672852
Epoch: 13, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.515 Vali Acc: 0.847 Test Loss: 0.515 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 1.4278323650360107
Epoch: 14, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.500 Vali Acc: 0.866 Test Loss: 0.500 Test Acc: 0.866
Validation loss decreased (-0.846870 --> -0.865620).  Saving model ...
Epoch: 15 cost time: 1.5245771408081055
Epoch: 15, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.503 Vali Acc: 0.863 Test Loss: 0.503 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4338209629058838
Epoch: 16, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.493 Vali Acc: 0.859 Test Loss: 0.493 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5934839248657227
Epoch: 17, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.498 Vali Acc: 0.828 Test Loss: 0.498 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5391180515289307
Epoch: 18, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4300382137298584
Epoch: 19, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
Validation loss decreased (-0.865620 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 1.6282312870025635
Epoch: 20, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.488 Vali Acc: 0.822 Test Loss: 0.488 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5066373348236084
Epoch: 21, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.483 Vali Acc: 0.831 Test Loss: 0.483 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5079848766326904
Epoch: 22, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.466 Vali Acc: 0.863 Test Loss: 0.466 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3225650787353516
Epoch: 23, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.484 Vali Acc: 0.859 Test Loss: 0.484 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5609359741210938
Epoch: 24, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.468 Vali Acc: 0.866 Test Loss: 0.468 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4368367195129395
Epoch: 25, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.476 Vali Acc: 0.866 Test Loss: 0.476 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4482660293579102
Epoch: 26, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.472 Vali Acc: 0.863 Test Loss: 0.472 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.475822925567627
Epoch: 27, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.473 Vali Acc: 0.853 Test Loss: 0.473 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.721125602722168
Epoch: 28, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.460 Vali Acc: 0.866 Test Loss: 0.460 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4278059005737305
Epoch: 29, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.472 Vali Acc: 0.866 Test Loss: 0.472 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 1824964
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.156419277191162
Epoch: 1, Steps: 8 | Train Loss: 2.180 Vali Loss: 2.082 Vali Acc: 0.100 Test Loss: 2.082 Test Acc: 0.100
Validation loss decreased (inf --> -0.099979).  Saving model ...
Epoch: 2 cost time: 1.4576787948608398
Epoch: 2, Steps: 8 | Train Loss: 2.095 Vali Loss: 1.953 Vali Acc: 0.338 Test Loss: 1.953 Test Acc: 0.338
Validation loss decreased (-0.099979 --> -0.337480).  Saving model ...
Epoch: 3 cost time: 1.6176042556762695
Epoch: 3, Steps: 8 | Train Loss: 1.893 Vali Loss: 1.754 Vali Acc: 0.503 Test Loss: 1.754 Test Acc: 0.503
Validation loss decreased (-0.337480 --> -0.503107).  Saving model ...
Epoch: 4 cost time: 1.3094186782836914
Epoch: 4, Steps: 8 | Train Loss: 1.679 Vali Loss: 1.521 Vali Acc: 0.650 Test Loss: 1.521 Test Acc: 0.650
Validation loss decreased (-0.503107 --> -0.649985).  Saving model ...
Epoch: 5 cost time: 1.2533628940582275
Epoch: 5, Steps: 8 | Train Loss: 1.441 Vali Loss: 1.244 Vali Acc: 0.756 Test Loss: 1.244 Test Acc: 0.756
Validation loss decreased (-0.649985 --> -0.756238).  Saving model ...
Epoch: 6 cost time: 1.3198728561401367
Epoch: 6, Steps: 8 | Train Loss: 1.115 Vali Loss: 1.019 Vali Acc: 0.744 Test Loss: 1.019 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5739490985870361
Epoch: 7, Steps: 8 | Train Loss: 0.933 Vali Loss: 0.844 Vali Acc: 0.803 Test Loss: 0.844 Test Acc: 0.803
Validation loss decreased (-0.756238 --> -0.803117).  Saving model ...
Epoch: 8 cost time: 1.467883586883545
Epoch: 8, Steps: 8 | Train Loss: 0.705 Vali Loss: 0.738 Vali Acc: 0.797 Test Loss: 0.738 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5231480598449707
Epoch: 9, Steps: 8 | Train Loss: 0.633 Vali Loss: 0.695 Vali Acc: 0.806 Test Loss: 0.695 Test Acc: 0.806
Validation loss decreased (-0.803117 --> -0.806243).  Saving model ...
Epoch: 10 cost time: 1.4361462593078613
Epoch: 10, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.628 Vali Acc: 0.822 Test Loss: 0.628 Test Acc: 0.822
Validation loss decreased (-0.806243 --> -0.821869).  Saving model ...
Epoch: 11 cost time: 1.5645763874053955
Epoch: 11, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.602 Vali Acc: 0.825 Test Loss: 0.602 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 1.4482753276824951
Epoch: 12, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.458667516708374
Epoch: 13, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.541 Vali Acc: 0.834 Test Loss: 0.541 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 1.4935593605041504
Epoch: 14, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3438706398010254
Epoch: 15, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.516 Vali Acc: 0.825 Test Loss: 0.516 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5312507152557373
Epoch: 16, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 17 cost time: 1.5500092506408691
Epoch: 17, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.491 Vali Acc: 0.834 Test Loss: 0.491 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6798648834228516
Epoch: 18, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.503 Vali Acc: 0.828 Test Loss: 0.503 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3541526794433594
Epoch: 19, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3781096935272217
Epoch: 20, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5781702995300293
Epoch: 21, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.472 Vali Acc: 0.828 Test Loss: 0.472 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6828486919403076
Epoch: 22, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.485 Vali Acc: 0.834 Test Loss: 0.485 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6911592483520508
Epoch: 23, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.481 Vali Acc: 0.838 Test Loss: 0.481 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.369875192642212
Epoch: 24, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 25 cost time: 1.8292348384857178
Epoch: 25, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.491 Vali Acc: 0.831 Test Loss: 0.491 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4482145309448242
Epoch: 26, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.456857442855835
Epoch: 27, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.483 Vali Acc: 0.838 Test Loss: 0.483 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5453600883483887
Epoch: 28, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.488 Vali Acc: 0.819 Test Loss: 0.488 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7518060207366943
Epoch: 29, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.480 Vali Acc: 0.838 Test Loss: 0.480 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5624721050262451
Epoch: 30, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.7317335605621338
Epoch: 31, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.7083072662353516
Epoch: 32, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.482 Vali Acc: 0.828 Test Loss: 0.482 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6612656116485596
Epoch: 33, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6063730716705322
Epoch: 34, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.480 Vali Acc: 0.853 Test Loss: 0.480 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 35 cost time: 1.728044033050537
Epoch: 35, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.873018503189087
Epoch: 36, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.0575942993164062
Epoch: 37, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7201573848724365
Epoch: 38, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.7121126651763916
Epoch: 39, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.496 Vali Acc: 0.838 Test Loss: 0.496 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.7999422550201416
Epoch: 40, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.7125523090362549
Epoch: 41, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.768164873123169
Epoch: 42, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.557563066482544
Epoch: 43, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.5689384937286377
Epoch: 44, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 1821636
model size : 8.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0448672771453857
Epoch: 1, Steps: 8 | Train Loss: 2.333 Vali Loss: 2.128 Vali Acc: 0.131 Test Loss: 2.128 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 1.4572269916534424
Epoch: 2, Steps: 8 | Train Loss: 2.109 Vali Loss: 1.989 Vali Acc: 0.275 Test Loss: 1.989 Test Acc: 0.275
Validation loss decreased (-0.131229 --> -0.274980).  Saving model ...
Epoch: 3 cost time: 1.6074607372283936
Epoch: 3, Steps: 8 | Train Loss: 1.991 Vali Loss: 1.792 Vali Acc: 0.416 Test Loss: 1.792 Test Acc: 0.416
Validation loss decreased (-0.274980 --> -0.415607).  Saving model ...
Epoch: 4 cost time: 1.5240790843963623
Epoch: 4, Steps: 8 | Train Loss: 1.747 Vali Loss: 1.543 Vali Acc: 0.603 Test Loss: 1.543 Test Acc: 0.603
Validation loss decreased (-0.415607 --> -0.603110).  Saving model ...
Epoch: 5 cost time: 1.6579442024230957
Epoch: 5, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.307 Vali Acc: 0.662 Test Loss: 1.307 Test Acc: 0.662
Validation loss decreased (-0.603110 --> -0.662487).  Saving model ...
Epoch: 6 cost time: 1.2544989585876465
Epoch: 6, Steps: 8 | Train Loss: 1.235 Vali Loss: 1.059 Vali Acc: 0.803 Test Loss: 1.059 Test Acc: 0.803
Validation loss decreased (-0.662487 --> -0.803114).  Saving model ...
Epoch: 7 cost time: 1.3511505126953125
Epoch: 7, Steps: 8 | Train Loss: 1.000 Vali Loss: 0.887 Vali Acc: 0.809 Test Loss: 0.887 Test Acc: 0.809
Validation loss decreased (-0.803114 --> -0.809366).  Saving model ...
Epoch: 8 cost time: 1.3785405158996582
Epoch: 8, Steps: 8 | Train Loss: 0.761 Vali Loss: 0.748 Vali Acc: 0.831 Test Loss: 0.748 Test Acc: 0.831
Validation loss decreased (-0.809366 --> -0.831243).  Saving model ...
Epoch: 9 cost time: 1.6412417888641357
Epoch: 9, Steps: 8 | Train Loss: 0.610 Vali Loss: 0.663 Vali Acc: 0.844 Test Loss: 0.663 Test Acc: 0.844
Validation loss decreased (-0.831243 --> -0.843743).  Saving model ...
Epoch: 10 cost time: 1.700725793838501
Epoch: 10, Steps: 8 | Train Loss: 0.487 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.843743 --> -0.849994).  Saving model ...
Epoch: 11 cost time: 1.3797547817230225
Epoch: 11, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.856244).  Saving model ...
Epoch: 12 cost time: 1.4556140899658203
Epoch: 12, Steps: 8 | Train Loss: 0.324 Vali Loss: 0.537 Vali Acc: 0.853 Test Loss: 0.537 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4384686946868896
Epoch: 13, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.518 Vali Acc: 0.856 Test Loss: 0.518 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856245).  Saving model ...
Epoch: 14 cost time: 1.3966801166534424
Epoch: 14, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.516 Vali Acc: 0.859 Test Loss: 0.516 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 15 cost time: 1.5063042640686035
Epoch: 15, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.689497709274292
Epoch: 16, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4899587631225586
Epoch: 17, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.480 Vali Acc: 0.866 Test Loss: 0.480 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 18 cost time: 1.4932966232299805
Epoch: 18, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.375309705734253
Epoch: 19, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.479 Vali Acc: 0.878 Test Loss: 0.479 Test Acc: 0.878
Validation loss decreased (-0.865620 --> -0.878120).  Saving model ...
Epoch: 20 cost time: 1.4561855792999268
Epoch: 20, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.449946641921997
Epoch: 21, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7534351348876953
Epoch: 22, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.492 Vali Acc: 0.853 Test Loss: 0.492 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.715806484222412
Epoch: 23, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4447705745697021
Epoch: 24, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.502 Vali Acc: 0.863 Test Loss: 0.502 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4518184661865234
Epoch: 25, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5455727577209473
Epoch: 26, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3946294784545898
Epoch: 27, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.411482810974121
Epoch: 28, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5892419815063477
Epoch: 29, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.491 Vali Acc: 0.853 Test Loss: 0.491 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 1818308
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8687479496002197
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 2.031 Vali Acc: 0.237 Test Loss: 2.031 Test Acc: 0.237
Validation loss decreased (inf --> -0.237480).  Saving model ...
Epoch: 2 cost time: 1.4380683898925781
Epoch: 2, Steps: 8 | Train Loss: 2.009 Vali Loss: 1.882 Vali Acc: 0.409 Test Loss: 1.882 Test Acc: 0.409
Validation loss decreased (-0.237480 --> -0.409356).  Saving model ...
Epoch: 3 cost time: 1.543506383895874
Epoch: 3, Steps: 8 | Train Loss: 1.873 Vali Loss: 1.659 Vali Acc: 0.503 Test Loss: 1.659 Test Acc: 0.503
Validation loss decreased (-0.409356 --> -0.503108).  Saving model ...
Epoch: 4 cost time: 1.4149374961853027
Epoch: 4, Steps: 8 | Train Loss: 1.553 Vali Loss: 1.362 Vali Acc: 0.719 Test Loss: 1.362 Test Acc: 0.719
Validation loss decreased (-0.503108 --> -0.718736).  Saving model ...
Epoch: 5 cost time: 1.6982629299163818
Epoch: 5, Steps: 8 | Train Loss: 1.257 Vali Loss: 1.071 Vali Acc: 0.800 Test Loss: 1.071 Test Acc: 0.800
Validation loss decreased (-0.718736 --> -0.799989).  Saving model ...
Epoch: 6 cost time: 1.3468084335327148
Epoch: 6, Steps: 8 | Train Loss: 1.007 Vali Loss: 0.878 Vali Acc: 0.800 Test Loss: 0.878 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 1.3582253456115723
Epoch: 7, Steps: 8 | Train Loss: 0.807 Vali Loss: 0.746 Vali Acc: 0.822 Test Loss: 0.746 Test Acc: 0.822
Validation loss decreased (-0.799991 --> -0.821868).  Saving model ...
Epoch: 8 cost time: 1.4005138874053955
Epoch: 8, Steps: 8 | Train Loss: 0.638 Vali Loss: 0.665 Vali Acc: 0.828 Test Loss: 0.665 Test Acc: 0.828
Validation loss decreased (-0.821868 --> -0.828118).  Saving model ...
Epoch: 9 cost time: 1.3994882106781006
Epoch: 9, Steps: 8 | Train Loss: 0.518 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
Validation loss decreased (-0.828118 --> -0.843744).  Saving model ...
Epoch: 10 cost time: 2.231794834136963
Epoch: 10, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.564 Vali Acc: 0.834 Test Loss: 0.564 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6857249736785889
Epoch: 11, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4623284339904785
Epoch: 12, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.56514310836792
Epoch: 13, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 1.3917293548583984
Epoch: 14, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.519 Vali Acc: 0.819 Test Loss: 0.519 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.475834608078003
Epoch: 15, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.289172649383545
Epoch: 16, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.504 Vali Acc: 0.831 Test Loss: 0.504 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4086179733276367
Epoch: 17, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5050854682922363
Epoch: 18, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5602459907531738
Epoch: 19, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.515 Vali Acc: 0.834 Test Loss: 0.515 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7414891719818115
Epoch: 20, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 1.5159027576446533
Epoch: 21, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6258537769317627
Epoch: 22, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5201303958892822
Epoch: 23, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4826304912567139
Epoch: 24, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.496 Vali Acc: 0.838 Test Loss: 0.496 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7101473808288574
Epoch: 25, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.515 Vali Acc: 0.838 Test Loss: 0.515 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3831079006195068
Epoch: 26, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.525 Vali Acc: 0.834 Test Loss: 0.525 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2883219718933105
Epoch: 27, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.514 Vali Acc: 0.828 Test Loss: 0.514 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4658710956573486
Epoch: 28, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8536462783813477
Epoch: 29, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5769128799438477
Epoch: 30, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 1814980
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3118832111358643
Epoch: 1, Steps: 8 | Train Loss: 2.250 Vali Loss: 2.150 Vali Acc: 0.097 Test Loss: 2.150 Test Acc: 0.097
Validation loss decreased (inf --> -0.096854).  Saving model ...
Epoch: 2 cost time: 1.332662582397461
Epoch: 2, Steps: 8 | Train Loss: 2.101 Vali Loss: 2.024 Vali Acc: 0.147 Test Loss: 2.024 Test Acc: 0.147
Validation loss decreased (-0.096854 --> -0.146855).  Saving model ...
Epoch: 3 cost time: 1.4390101432800293
Epoch: 3, Steps: 8 | Train Loss: 2.044 Vali Loss: 1.921 Vali Acc: 0.316 Test Loss: 1.921 Test Acc: 0.316
Validation loss decreased (-0.146855 --> -0.315606).  Saving model ...
Epoch: 4 cost time: 1.4582819938659668
Epoch: 4, Steps: 8 | Train Loss: 1.891 Vali Loss: 1.742 Vali Acc: 0.613 Test Loss: 1.742 Test Acc: 0.613
Validation loss decreased (-0.315606 --> -0.612483).  Saving model ...
Epoch: 5 cost time: 1.8647263050079346
Epoch: 5, Steps: 8 | Train Loss: 1.650 Vali Loss: 1.497 Vali Acc: 0.684 Test Loss: 1.497 Test Acc: 0.684
Validation loss decreased (-0.612483 --> -0.684360).  Saving model ...
Epoch: 6 cost time: 1.6211869716644287
Epoch: 6, Steps: 8 | Train Loss: 1.404 Vali Loss: 1.224 Vali Acc: 0.728 Test Loss: 1.224 Test Acc: 0.728
Validation loss decreased (-0.684360 --> -0.728113).  Saving model ...
Epoch: 7 cost time: 1.667881727218628
Epoch: 7, Steps: 8 | Train Loss: 1.051 Vali Loss: 1.010 Vali Acc: 0.756 Test Loss: 1.010 Test Acc: 0.756
Validation loss decreased (-0.728113 --> -0.756240).  Saving model ...
Epoch: 8 cost time: 1.5285232067108154
Epoch: 8, Steps: 8 | Train Loss: 0.820 Vali Loss: 0.843 Vali Acc: 0.797 Test Loss: 0.843 Test Acc: 0.797
Validation loss decreased (-0.756240 --> -0.796867).  Saving model ...
Epoch: 9 cost time: 1.6114938259124756
Epoch: 9, Steps: 8 | Train Loss: 0.682 Vali Loss: 0.730 Vali Acc: 0.816 Test Loss: 0.730 Test Acc: 0.816
Validation loss decreased (-0.796867 --> -0.815618).  Saving model ...
Epoch: 10 cost time: 1.600600242614746
Epoch: 10, Steps: 8 | Train Loss: 0.573 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
Validation loss decreased (-0.815618 --> -0.843743).  Saving model ...
Epoch: 11 cost time: 1.6175150871276855
Epoch: 11, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.612 Vali Acc: 0.828 Test Loss: 0.612 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7241976261138916
Epoch: 12, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7781803607940674
Epoch: 13, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
Validation loss decreased (-0.843743 --> -0.843744).  Saving model ...
Epoch: 14 cost time: 1.7356398105621338
Epoch: 14, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 1.7627894878387451
Epoch: 15, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 1.7859091758728027
Epoch: 16, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 17 cost time: 1.9409947395324707
Epoch: 17, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 18 cost time: 1.7514879703521729
Epoch: 18, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8836002349853516
Epoch: 19, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3287436962127686
Epoch: 20, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.511 Vali Acc: 0.859 Test Loss: 0.511 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 21 cost time: 1.8930795192718506
Epoch: 21, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
Validation loss decreased (-0.859370 --> -0.871870).  Saving model ...
Epoch: 22 cost time: 1.7226529121398926
Epoch: 22, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.504 Vali Acc: 0.875 Test Loss: 0.504 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 1.8379485607147217
Epoch: 23, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9680190086364746
Epoch: 24, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.491 Vali Acc: 0.866 Test Loss: 0.491 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9294812679290771
Epoch: 25, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 26 cost time: 1.8754985332489014
Epoch: 26, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.480 Vali Acc: 0.869 Test Loss: 0.480 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.635742425918579
Epoch: 27, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 1.6327006816864014
Epoch: 28, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.498 Vali Acc: 0.859 Test Loss: 0.498 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7040839195251465
Epoch: 29, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.499 Vali Acc: 0.863 Test Loss: 0.499 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.832322120666504
Epoch: 30, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.495 Vali Acc: 0.872 Test Loss: 0.495 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.2928647994995117
Epoch: 31, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.490 Vali Acc: 0.866 Test Loss: 0.490 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6682415008544922
Epoch: 32, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.489 Vali Acc: 0.875 Test Loss: 0.489 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6439223289489746
Epoch: 33, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.932553768157959
Epoch: 34, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.503 Vali Acc: 0.863 Test Loss: 0.503 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4891605377197266
Epoch: 35, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.503 Vali Acc: 0.866 Test Loss: 0.503 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.4298079013824463
Epoch: 36, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.500 Vali Acc: 0.866 Test Loss: 0.500 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.7710487842559814
Epoch: 37, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.504 Vali Acc: 0.859 Test Loss: 0.504 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 1230532
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9854421615600586
Epoch: 1, Steps: 8 | Train Loss: 2.364 Vali Loss: 2.230 Vali Acc: 0.053 Test Loss: 2.230 Test Acc: 0.053
Validation loss decreased (inf --> -0.053103).  Saving model ...
Epoch: 2 cost time: 1.5219535827636719
Epoch: 2, Steps: 8 | Train Loss: 2.170 Vali Loss: 2.058 Vali Acc: 0.097 Test Loss: 2.058 Test Acc: 0.097
Validation loss decreased (-0.053103 --> -0.096854).  Saving model ...
Epoch: 3 cost time: 1.6026792526245117
Epoch: 3, Steps: 8 | Train Loss: 2.024 Vali Loss: 1.917 Vali Acc: 0.284 Test Loss: 1.917 Test Acc: 0.284
Validation loss decreased (-0.096854 --> -0.284356).  Saving model ...
Epoch: 4 cost time: 1.4924516677856445
Epoch: 4, Steps: 8 | Train Loss: 1.856 Vali Loss: 1.720 Vali Acc: 0.584 Test Loss: 1.720 Test Acc: 0.584
Validation loss decreased (-0.284356 --> -0.584358).  Saving model ...
Epoch: 5 cost time: 1.4868009090423584
Epoch: 5, Steps: 8 | Train Loss: 1.631 Vali Loss: 1.471 Vali Acc: 0.697 Test Loss: 1.471 Test Acc: 0.697
Validation loss decreased (-0.584358 --> -0.696860).  Saving model ...
Epoch: 6 cost time: 1.3147804737091064
Epoch: 6, Steps: 8 | Train Loss: 1.367 Vali Loss: 1.217 Vali Acc: 0.759 Test Loss: 1.217 Test Acc: 0.759
Validation loss decreased (-0.696860 --> -0.759363).  Saving model ...
Epoch: 7 cost time: 1.3194382190704346
Epoch: 7, Steps: 8 | Train Loss: 1.042 Vali Loss: 1.002 Vali Acc: 0.775 Test Loss: 1.002 Test Acc: 0.775
Validation loss decreased (-0.759363 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 1.7332093715667725
Epoch: 8, Steps: 8 | Train Loss: 0.853 Vali Loss: 0.824 Vali Acc: 0.806 Test Loss: 0.824 Test Acc: 0.806
Validation loss decreased (-0.774990 --> -0.806242).  Saving model ...
Epoch: 9 cost time: 1.8329830169677734
Epoch: 9, Steps: 8 | Train Loss: 0.683 Vali Loss: 0.724 Vali Acc: 0.816 Test Loss: 0.724 Test Acc: 0.816
Validation loss decreased (-0.806242 --> -0.815618).  Saving model ...
Epoch: 10 cost time: 1.3900723457336426
Epoch: 10, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.664 Vali Acc: 0.812 Test Loss: 0.664 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7941484451293945
Epoch: 11, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.613 Vali Acc: 0.831 Test Loss: 0.613 Test Acc: 0.831
Validation loss decreased (-0.815618 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 1.740060806274414
Epoch: 12, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.586 Vali Acc: 0.838 Test Loss: 0.586 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 13 cost time: 1.565605640411377
Epoch: 13, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8872277736663818
Epoch: 14, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.565 Vali Acc: 0.831 Test Loss: 0.565 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.80839204788208
Epoch: 15, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9138765335083008
Epoch: 16, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9562537670135498
Epoch: 17, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.82850980758667
Epoch: 18, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
Validation loss decreased (-0.837494 --> -0.856245).  Saving model ...
Epoch: 19 cost time: 1.3405191898345947
Epoch: 19, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5864765644073486
Epoch: 20, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4839468002319336
Epoch: 21, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4107553958892822
Epoch: 22, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5022718906402588
Epoch: 23, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.010852098464966
Epoch: 24, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.518 Vali Acc: 0.859 Test Loss: 0.518 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 25 cost time: 1.3947715759277344
Epoch: 25, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.512 Vali Acc: 0.869 Test Loss: 0.512 Test Acc: 0.869
Validation loss decreased (-0.859370 --> -0.868745).  Saving model ...
Epoch: 26 cost time: 1.6644442081451416
Epoch: 26, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.499 Vali Acc: 0.853 Test Loss: 0.499 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6613166332244873
Epoch: 27, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.513 Vali Acc: 0.859 Test Loss: 0.513 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5772709846496582
Epoch: 28, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.516 Vali Acc: 0.866 Test Loss: 0.516 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9499990940093994
Epoch: 29, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.582308053970337
Epoch: 30, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.512 Vali Acc: 0.859 Test Loss: 0.512 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8650732040405273
Epoch: 31, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.516 Vali Acc: 0.859 Test Loss: 0.516 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.575392723083496
Epoch: 32, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.500 Vali Acc: 0.863 Test Loss: 0.500 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.5129804611206055
Epoch: 33, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.491 Vali Acc: 0.863 Test Loss: 0.491 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3689732551574707
Epoch: 34, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.500 Vali Acc: 0.859 Test Loss: 0.500 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.7836387157440186
Epoch: 35, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.511 Vali Acc: 0.859 Test Loss: 0.511 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 1227204
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.218028545379639
Epoch: 1, Steps: 8 | Train Loss: 2.217 Vali Loss: 2.140 Vali Acc: 0.106 Test Loss: 2.140 Test Acc: 0.106
Validation loss decreased (inf --> -0.106229).  Saving model ...
Epoch: 2 cost time: 1.9400982856750488
Epoch: 2, Steps: 8 | Train Loss: 2.147 Vali Loss: 2.001 Vali Acc: 0.241 Test Loss: 2.001 Test Acc: 0.241
Validation loss decreased (-0.106229 --> -0.240605).  Saving model ...
Epoch: 3 cost time: 1.8392376899719238
Epoch: 3, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.822 Vali Acc: 0.475 Test Loss: 1.822 Test Acc: 0.475
Validation loss decreased (-0.240605 --> -0.474982).  Saving model ...
Epoch: 4 cost time: 1.9809865951538086
Epoch: 4, Steps: 8 | Train Loss: 1.768 Vali Loss: 1.613 Vali Acc: 0.553 Test Loss: 1.613 Test Acc: 0.553
Validation loss decreased (-0.474982 --> -0.553109).  Saving model ...
Epoch: 5 cost time: 2.125135660171509
Epoch: 5, Steps: 8 | Train Loss: 1.547 Vali Loss: 1.370 Vali Acc: 0.709 Test Loss: 1.370 Test Acc: 0.709
Validation loss decreased (-0.553109 --> -0.709361).  Saving model ...
Epoch: 6 cost time: 1.7312309741973877
Epoch: 6, Steps: 8 | Train Loss: 1.216 Vali Loss: 1.109 Vali Acc: 0.784 Test Loss: 1.109 Test Acc: 0.784
Validation loss decreased (-0.709361 --> -0.784364).  Saving model ...
Epoch: 7 cost time: 2.2636656761169434
Epoch: 7, Steps: 8 | Train Loss: 0.938 Vali Loss: 0.924 Vali Acc: 0.791 Test Loss: 0.924 Test Acc: 0.791
Validation loss decreased (-0.784364 --> -0.790616).  Saving model ...
Epoch: 8 cost time: 1.8388512134552002
Epoch: 8, Steps: 8 | Train Loss: 0.771 Vali Loss: 0.813 Vali Acc: 0.778 Test Loss: 0.813 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9121825695037842
Epoch: 9, Steps: 8 | Train Loss: 0.609 Vali Loss: 0.699 Vali Acc: 0.841 Test Loss: 0.699 Test Acc: 0.841
Validation loss decreased (-0.790616 --> -0.840618).  Saving model ...
Epoch: 10 cost time: 1.7130186557769775
Epoch: 10, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.645 Vali Acc: 0.838 Test Loss: 0.645 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8892037868499756
Epoch: 11, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.283146381378174
Epoch: 12, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.572 Vali Acc: 0.831 Test Loss: 0.572 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8130254745483398
Epoch: 13, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
Validation loss decreased (-0.840618 --> -0.840619).  Saving model ...
Epoch: 14 cost time: 1.7320549488067627
Epoch: 14, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.56309175491333
Epoch: 15, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.050690174102783
Epoch: 16, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.520 Vali Acc: 0.831 Test Loss: 0.520 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.773883581161499
Epoch: 17, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843745).  Saving model ...
Epoch: 18 cost time: 1.7038519382476807
Epoch: 18, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0272445678710938
Epoch: 19, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.501 Vali Acc: 0.831 Test Loss: 0.501 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5689666271209717
Epoch: 20, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.487 Vali Acc: 0.831 Test Loss: 0.487 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7475249767303467
Epoch: 21, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8333895206451416
Epoch: 22, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.487 Vali Acc: 0.838 Test Loss: 0.487 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7201333045959473
Epoch: 23, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.493 Vali Acc: 0.828 Test Loss: 0.493 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.619699478149414
Epoch: 24, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.480 Vali Acc: 0.853 Test Loss: 0.480 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 25 cost time: 1.9304783344268799
Epoch: 25, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.482 Vali Acc: 0.847 Test Loss: 0.482 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8314435482025146
Epoch: 26, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 27 cost time: 1.6345512866973877
Epoch: 27, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7974233627319336
Epoch: 28, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5280582904815674
Epoch: 29, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 30 cost time: 1.7864964008331299
Epoch: 30, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8765790462493896
Epoch: 31, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.487 Vali Acc: 0.853 Test Loss: 0.487 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4498553276062012
Epoch: 32, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.043571949005127
Epoch: 33, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.481 Vali Acc: 0.859 Test Loss: 0.481 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 34 cost time: 1.7533094882965088
Epoch: 34, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.479 Vali Acc: 0.859 Test Loss: 0.479 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 35 cost time: 2.081517457962036
Epoch: 35, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.477 Vali Acc: 0.859 Test Loss: 0.477 Test Acc: 0.859
Validation loss decreased (-0.859370 --> -0.859370).  Saving model ...
Epoch: 36 cost time: 1.4848461151123047
Epoch: 36, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.489 Vali Acc: 0.847 Test Loss: 0.489 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.124425172805786
Epoch: 37, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.480 Vali Acc: 0.853 Test Loss: 0.480 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.167069673538208
Epoch: 38, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.479 Vali Acc: 0.853 Test Loss: 0.479 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.8963391780853271
Epoch: 39, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.491 Vali Acc: 0.853 Test Loss: 0.491 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.1983890533447266
Epoch: 40, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.134990930557251
Epoch: 41, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.485 Vali Acc: 0.859 Test Loss: 0.485 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.8642692565917969
Epoch: 42, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.166943073272705
Epoch: 43, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.3014180660247803
Epoch: 44, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.8770394325256348
Epoch: 45, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.491 Vali Acc: 0.859 Test Loss: 0.491 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1223876
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.356710433959961
Epoch: 1, Steps: 8 | Train Loss: 2.232 Vali Loss: 2.116 Vali Acc: 0.175 Test Loss: 2.116 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 2.1175289154052734
Epoch: 2, Steps: 8 | Train Loss: 2.072 Vali Loss: 1.980 Vali Acc: 0.228 Test Loss: 1.980 Test Acc: 0.228
Validation loss decreased (-0.174979 --> -0.228105).  Saving model ...
Epoch: 3 cost time: 1.7797579765319824
Epoch: 3, Steps: 8 | Train Loss: 1.920 Vali Loss: 1.796 Vali Acc: 0.484 Test Loss: 1.796 Test Acc: 0.484
Validation loss decreased (-0.228105 --> -0.484357).  Saving model ...
Epoch: 4 cost time: 1.6170246601104736
Epoch: 4, Steps: 8 | Train Loss: 1.742 Vali Loss: 1.559 Vali Acc: 0.609 Test Loss: 1.559 Test Acc: 0.609
Validation loss decreased (-0.484357 --> -0.609359).  Saving model ...
Epoch: 5 cost time: 2.258162498474121
Epoch: 5, Steps: 8 | Train Loss: 1.483 Vali Loss: 1.305 Vali Acc: 0.753 Test Loss: 1.305 Test Acc: 0.753
Validation loss decreased (-0.609359 --> -0.753112).  Saving model ...
Epoch: 6 cost time: 2.2319834232330322
Epoch: 6, Steps: 8 | Train Loss: 1.174 Vali Loss: 1.079 Vali Acc: 0.778 Test Loss: 1.079 Test Acc: 0.778
Validation loss decreased (-0.753112 --> -0.778114).  Saving model ...
Epoch: 7 cost time: 1.8455796241760254
Epoch: 7, Steps: 8 | Train Loss: 0.973 Vali Loss: 0.901 Vali Acc: 0.787 Test Loss: 0.901 Test Acc: 0.787
Validation loss decreased (-0.778114 --> -0.787491).  Saving model ...
Epoch: 8 cost time: 1.7122583389282227
Epoch: 8, Steps: 8 | Train Loss: 0.728 Vali Loss: 0.764 Vali Acc: 0.831 Test Loss: 0.764 Test Acc: 0.831
Validation loss decreased (-0.787491 --> -0.831242).  Saving model ...
Epoch: 9 cost time: 1.5888655185699463
Epoch: 9, Steps: 8 | Train Loss: 0.610 Vali Loss: 0.677 Vali Acc: 0.831 Test Loss: 0.677 Test Acc: 0.831
Validation loss decreased (-0.831242 --> -0.831243).  Saving model ...
Epoch: 10 cost time: 1.5067286491394043
Epoch: 10, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.620 Vali Acc: 0.838 Test Loss: 0.620 Test Acc: 0.838
Validation loss decreased (-0.831243 --> -0.837494).  Saving model ...
Epoch: 11 cost time: 1.7197089195251465
Epoch: 11, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.576 Vali Acc: 0.847 Test Loss: 0.576 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846869).  Saving model ...
Epoch: 12 cost time: 1.9245781898498535
Epoch: 12, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 1.448848009109497
Epoch: 13, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.544 Vali Acc: 0.853 Test Loss: 0.544 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 14 cost time: 1.3824315071105957
Epoch: 14, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8893892765045166
Epoch: 15, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.520 Vali Acc: 0.831 Test Loss: 0.520 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0021536350250244
Epoch: 16, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.999312162399292
Epoch: 17, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.980048656463623
Epoch: 18, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7922570705413818
Epoch: 19, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.491 Vali Acc: 0.838 Test Loss: 0.491 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.280242443084717
Epoch: 20, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.504 Vali Acc: 0.831 Test Loss: 0.504 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0040953159332275
Epoch: 21, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8874406814575195
Epoch: 22, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.744211435317993
Epoch: 23, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 1220548
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.066423654556274
Epoch: 1, Steps: 8 | Train Loss: 2.236 Vali Loss: 2.121 Vali Acc: 0.103 Test Loss: 2.121 Test Acc: 0.103
Validation loss decreased (inf --> -0.103104).  Saving model ...
Epoch: 2 cost time: 1.707167625427246
Epoch: 2, Steps: 8 | Train Loss: 2.092 Vali Loss: 1.996 Vali Acc: 0.294 Test Loss: 1.996 Test Acc: 0.294
Validation loss decreased (-0.103104 --> -0.293730).  Saving model ...
Epoch: 3 cost time: 2.2789628505706787
Epoch: 3, Steps: 8 | Train Loss: 2.003 Vali Loss: 1.903 Vali Acc: 0.319 Test Loss: 1.903 Test Acc: 0.319
Validation loss decreased (-0.293730 --> -0.318731).  Saving model ...
Epoch: 4 cost time: 1.6396706104278564
Epoch: 4, Steps: 8 | Train Loss: 1.908 Vali Loss: 1.737 Vali Acc: 0.569 Test Loss: 1.737 Test Acc: 0.569
Validation loss decreased (-0.318731 --> -0.568733).  Saving model ...
Epoch: 5 cost time: 1.7179985046386719
Epoch: 5, Steps: 8 | Train Loss: 1.723 Vali Loss: 1.556 Vali Acc: 0.613 Test Loss: 1.556 Test Acc: 0.613
Validation loss decreased (-0.568733 --> -0.612484).  Saving model ...
Epoch: 6 cost time: 1.9766597747802734
Epoch: 6, Steps: 8 | Train Loss: 1.523 Vali Loss: 1.312 Vali Acc: 0.700 Test Loss: 1.312 Test Acc: 0.700
Validation loss decreased (-0.612484 --> -0.699987).  Saving model ...
Epoch: 7 cost time: 2.249311923980713
Epoch: 7, Steps: 8 | Train Loss: 1.249 Vali Loss: 1.109 Vali Acc: 0.744 Test Loss: 1.109 Test Acc: 0.744
Validation loss decreased (-0.699987 --> -0.743739).  Saving model ...
Epoch: 8 cost time: 1.9621002674102783
Epoch: 8, Steps: 8 | Train Loss: 1.000 Vali Loss: 0.941 Vali Acc: 0.781 Test Loss: 0.941 Test Acc: 0.781
Validation loss decreased (-0.743739 --> -0.781241).  Saving model ...
Epoch: 9 cost time: 2.13252592086792
Epoch: 9, Steps: 8 | Train Loss: 0.837 Vali Loss: 0.811 Vali Acc: 0.822 Test Loss: 0.811 Test Acc: 0.822
Validation loss decreased (-0.781241 --> -0.821867).  Saving model ...
Epoch: 10 cost time: 2.0226056575775146
Epoch: 10, Steps: 8 | Train Loss: 0.666 Vali Loss: 0.716 Vali Acc: 0.803 Test Loss: 0.716 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.925964117050171
Epoch: 11, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.658 Vali Acc: 0.809 Test Loss: 0.658 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.496971607208252
Epoch: 12, Steps: 8 | Train Loss: 0.449 Vali Loss: 0.621 Vali Acc: 0.831 Test Loss: 0.621 Test Acc: 0.831
Validation loss decreased (-0.821867 --> -0.831244).  Saving model ...
Epoch: 13 cost time: 2.040674924850464
Epoch: 13, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.590 Vali Acc: 0.834 Test Loss: 0.590 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 14 cost time: 2.1398868560791016
Epoch: 14, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.566 Vali Acc: 0.834 Test Loss: 0.566 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834369).  Saving model ...
Epoch: 15 cost time: 1.5508155822753906
Epoch: 15, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.551 Vali Acc: 0.834 Test Loss: 0.551 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834369).  Saving model ...
Epoch: 16 cost time: 1.5466327667236328
Epoch: 16, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.548 Vali Acc: 0.834 Test Loss: 0.548 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 17 cost time: 1.6790995597839355
Epoch: 17, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 18 cost time: 1.4597270488739014
Epoch: 18, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6627771854400635
Epoch: 19, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.533 Vali Acc: 0.831 Test Loss: 0.533 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9841070175170898
Epoch: 20, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.519 Vali Acc: 0.828 Test Loss: 0.519 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.417836904525757
Epoch: 21, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.736313819885254
Epoch: 22, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9615123271942139
Epoch: 23, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1016945838928223
Epoch: 24, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.518 Vali Acc: 0.834 Test Loss: 0.518 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.2230119705200195
Epoch: 25, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 26 cost time: 1.9758541584014893
Epoch: 26, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.196722984313965
Epoch: 27, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.536 Vali Acc: 0.831 Test Loss: 0.536 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7320051193237305
Epoch: 28, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.541 Vali Acc: 0.834 Test Loss: 0.541 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9178354740142822
Epoch: 29, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9492342472076416
Epoch: 30, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9268057346343994
Epoch: 31, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.1903207302093506
Epoch: 32, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9946246147155762
Epoch: 33, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.0375072956085205
Epoch: 34, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.548 Vali Acc: 0.834 Test Loss: 0.548 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.5374550819396973
Epoch: 35, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 36 cost time: 2.2554564476013184
Epoch: 36, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.544877529144287
Epoch: 37, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.1303422451019287
Epoch: 38, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.090696334838867
Epoch: 39, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.566 Vali Acc: 0.841 Test Loss: 0.566 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.0309104919433594
Epoch: 40, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846869).  Saving model ...
Epoch: 41 cost time: 1.9750375747680664
Epoch: 41, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849995).  Saving model ...
Epoch: 42 cost time: 1.6229393482208252
Epoch: 42, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.7384965419769287
Epoch: 43, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.566 Vali Acc: 0.838 Test Loss: 0.566 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.19553542137146
Epoch: 44, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.7054831981658936
Epoch: 45, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.754065990447998
Epoch: 46, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.196826457977295
Epoch: 47, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.574 Vali Acc: 0.834 Test Loss: 0.574 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.8707287311553955
Epoch: 48, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.570 Vali Acc: 0.831 Test Loss: 0.570 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.8991050720214844
Epoch: 49, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.7491626739501953
Epoch: 50, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.570 Vali Acc: 0.847 Test Loss: 0.570 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.5605533123016357
Epoch: 51, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.555 Vali Acc: 0.853 Test Loss: 0.555 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853119).  Saving model ...
Epoch: 52 cost time: 1.6899604797363281
Epoch: 52, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.558 Vali Acc: 0.853 Test Loss: 0.558 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.015510320663452
Epoch: 53, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.064387321472168
Epoch: 54, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.8119993209838867
Epoch: 55, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.591 Vali Acc: 0.847 Test Loss: 0.591 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.9267010688781738
Epoch: 56, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.872201681137085
Epoch: 57, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.588 Vali Acc: 0.847 Test Loss: 0.588 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.6875426769256592
Epoch: 58, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.583 Vali Acc: 0.847 Test Loss: 0.583 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 2.03474497795105
Epoch: 59, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.585 Vali Acc: 0.853 Test Loss: 0.585 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.6793460845947266
Epoch: 60, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856244).  Saving model ...
Epoch: 61 cost time: 1.726957082748413
Epoch: 61, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.1811208724975586
Epoch: 62, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.884700059890747
Epoch: 63, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.587 Vali Acc: 0.856 Test Loss: 0.587 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.785282850265503
Epoch: 64, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.585 Vali Acc: 0.863 Test Loss: 0.585 Test Acc: 0.863
Validation loss decreased (-0.856244 --> -0.862494).  Saving model ...
Epoch: 65 cost time: 2.0083181858062744
Epoch: 65, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.3837411403656006
Epoch: 66, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 2.121415615081787
Epoch: 67, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.589 Vali Acc: 0.853 Test Loss: 0.589 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 2.3083338737487793
Epoch: 68, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.593 Vali Acc: 0.853 Test Loss: 0.593 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.2336621284484863
Epoch: 69, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 2.085477590560913
Epoch: 70, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.856 Test Loss: 0.597 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.8369300365447998
Epoch: 71, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.5433018207550049
Epoch: 72, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 2.0658867359161377
Epoch: 73, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.609 Vali Acc: 0.859 Test Loss: 0.609 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.785015344619751
Epoch: 74, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.619 Vali Acc: 0.853 Test Loss: 0.619 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 933316
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.115117073059082
Epoch: 1, Steps: 8 | Train Loss: 2.182 Vali Loss: 2.104 Vali Acc: 0.153 Test Loss: 2.104 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 1.5710420608520508
Epoch: 2, Steps: 8 | Train Loss: 2.072 Vali Loss: 1.994 Vali Acc: 0.256 Test Loss: 1.994 Test Acc: 0.256
Validation loss decreased (-0.153104 --> -0.256230).  Saving model ...
Epoch: 3 cost time: 1.8198654651641846
Epoch: 3, Steps: 8 | Train Loss: 2.011 Vali Loss: 1.860 Vali Acc: 0.388 Test Loss: 1.860 Test Acc: 0.388
Validation loss decreased (-0.256230 --> -0.387481).  Saving model ...
Epoch: 4 cost time: 1.9818682670593262
Epoch: 4, Steps: 8 | Train Loss: 1.805 Vali Loss: 1.704 Vali Acc: 0.519 Test Loss: 1.704 Test Acc: 0.519
Validation loss decreased (-0.387481 --> -0.518733).  Saving model ...
Epoch: 5 cost time: 1.7911810874938965
Epoch: 5, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.507 Vali Acc: 0.619 Test Loss: 1.507 Test Acc: 0.619
Validation loss decreased (-0.518733 --> -0.618735).  Saving model ...
Epoch: 6 cost time: 1.4666645526885986
Epoch: 6, Steps: 8 | Train Loss: 1.436 Vali Loss: 1.283 Vali Acc: 0.688 Test Loss: 1.283 Test Acc: 0.688
Validation loss decreased (-0.618735 --> -0.687487).  Saving model ...
Epoch: 7 cost time: 1.6148386001586914
Epoch: 7, Steps: 8 | Train Loss: 1.133 Vali Loss: 1.097 Vali Acc: 0.741 Test Loss: 1.097 Test Acc: 0.741
Validation loss decreased (-0.687487 --> -0.740614).  Saving model ...
Epoch: 8 cost time: 1.6189908981323242
Epoch: 8, Steps: 8 | Train Loss: 0.913 Vali Loss: 0.945 Vali Acc: 0.734 Test Loss: 0.945 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8021409511566162
Epoch: 9, Steps: 8 | Train Loss: 0.765 Vali Loss: 0.816 Vali Acc: 0.787 Test Loss: 0.816 Test Acc: 0.787
Validation loss decreased (-0.740614 --> -0.787492).  Saving model ...
Epoch: 10 cost time: 1.8265416622161865
Epoch: 10, Steps: 8 | Train Loss: 0.645 Vali Loss: 0.718 Vali Acc: 0.809 Test Loss: 0.718 Test Acc: 0.809
Validation loss decreased (-0.787492 --> -0.809368).  Saving model ...
Epoch: 11 cost time: 1.4204449653625488
Epoch: 11, Steps: 8 | Train Loss: 0.554 Vali Loss: 0.659 Vali Acc: 0.825 Test Loss: 0.659 Test Acc: 0.825
Validation loss decreased (-0.809368 --> -0.824993).  Saving model ...
Epoch: 12 cost time: 1.7728774547576904
Epoch: 12, Steps: 8 | Train Loss: 0.456 Vali Loss: 0.644 Vali Acc: 0.803 Test Loss: 0.644 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.580847978591919
Epoch: 13, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.576 Vali Acc: 0.844 Test Loss: 0.576 Test Acc: 0.844
Validation loss decreased (-0.824993 --> -0.843744).  Saving model ...
Epoch: 14 cost time: 1.4088537693023682
Epoch: 14, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4623641967773438
Epoch: 15, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.537 Vali Acc: 0.819 Test Loss: 0.537 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.509889841079712
Epoch: 16, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4826061725616455
Epoch: 17, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.724579095840454
Epoch: 18, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7893249988555908
Epoch: 19, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8752145767211914
Epoch: 20, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.829195261001587
Epoch: 21, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9232330322265625
Epoch: 22, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 23 cost time: 1.7071051597595215
Epoch: 23, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.487 Vali Acc: 0.834 Test Loss: 0.487 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9319219589233398
Epoch: 24, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.494 Vali Acc: 0.847 Test Loss: 0.494 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 25 cost time: 2.232943058013916
Epoch: 25, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.500 Vali Acc: 0.825 Test Loss: 0.500 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5654962062835693
Epoch: 26, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 27 cost time: 1.8122968673706055
Epoch: 27, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.032651424407959
Epoch: 28, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.493 Vali Acc: 0.838 Test Loss: 0.493 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7852065563201904
Epoch: 29, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9778189659118652
Epoch: 30, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 1.86311674118042
Epoch: 31, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6305224895477295
Epoch: 32, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7588269710540771
Epoch: 33, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5556421279907227
Epoch: 34, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.484 Vali Acc: 0.853 Test Loss: 0.484 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 35 cost time: 1.712873935699463
Epoch: 35, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 36 cost time: 1.6013073921203613
Epoch: 36, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.497 Vali Acc: 0.853 Test Loss: 0.497 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8420472145080566
Epoch: 37, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.489 Vali Acc: 0.853 Test Loss: 0.489 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7108302116394043
Epoch: 38, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.494 Vali Acc: 0.863 Test Loss: 0.494 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 39 cost time: 1.7194194793701172
Epoch: 39, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.007765293121338
Epoch: 40, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.487 Vali Acc: 0.853 Test Loss: 0.487 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.907487392425537
Epoch: 41, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.8935766220092773
Epoch: 42, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.500 Vali Acc: 0.859 Test Loss: 0.500 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5377354621887207
Epoch: 43, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.60353422164917
Epoch: 44, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.8448665142059326
Epoch: 45, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.487 Vali Acc: 0.859 Test Loss: 0.487 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.777789831161499
Epoch: 46, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.489 Vali Acc: 0.863 Test Loss: 0.489 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 47 cost time: 1.8452701568603516
Epoch: 47, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.491 Vali Acc: 0.859 Test Loss: 0.491 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.6689519882202148
Epoch: 48, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.5385091304779053
Epoch: 49, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.508 Vali Acc: 0.859 Test Loss: 0.508 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.4577782154083252
Epoch: 50, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.492 Vali Acc: 0.872 Test Loss: 0.492 Test Acc: 0.872
Validation loss decreased (-0.862495 --> -0.871870).  Saving model ...
Epoch: 51 cost time: 1.5308115482330322
Epoch: 51, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.941061019897461
Epoch: 52, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.709075927734375
Epoch: 53, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.493 Vali Acc: 0.872 Test Loss: 0.493 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.7259457111358643
Epoch: 54, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.495 Vali Acc: 0.872 Test Loss: 0.495 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.015706777572632
Epoch: 55, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.505 Vali Acc: 0.863 Test Loss: 0.505 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.4294791221618652
Epoch: 56, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.508 Vali Acc: 0.859 Test Loss: 0.508 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.450887680053711
Epoch: 57, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.500 Vali Acc: 0.869 Test Loss: 0.500 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.333082914352417
Epoch: 58, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.498 Vali Acc: 0.866 Test Loss: 0.498 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.6605033874511719
Epoch: 59, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.499 Vali Acc: 0.866 Test Loss: 0.499 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 2.0115134716033936
Epoch: 60, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.507 Vali Acc: 0.863 Test Loss: 0.507 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 929988
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7143986225128174
Epoch: 1, Steps: 8 | Train Loss: 2.198 Vali Loss: 2.103 Vali Acc: 0.163 Test Loss: 2.103 Test Acc: 0.163
Validation loss decreased (inf --> -0.162479).  Saving model ...
Epoch: 2 cost time: 1.8960914611816406
Epoch: 2, Steps: 8 | Train Loss: 2.130 Vali Loss: 2.015 Vali Acc: 0.287 Test Loss: 2.015 Test Acc: 0.287
Validation loss decreased (-0.162479 --> -0.287480).  Saving model ...
Epoch: 3 cost time: 1.9767816066741943
Epoch: 3, Steps: 8 | Train Loss: 2.049 Vali Loss: 1.921 Vali Acc: 0.338 Test Loss: 1.921 Test Acc: 0.338
Validation loss decreased (-0.287480 --> -0.337481).  Saving model ...
Epoch: 4 cost time: 2.1241402626037598
Epoch: 4, Steps: 8 | Train Loss: 1.950 Vali Loss: 1.767 Vali Acc: 0.547 Test Loss: 1.767 Test Acc: 0.547
Validation loss decreased (-0.337481 --> -0.546857).  Saving model ...
Epoch: 5 cost time: 1.8011014461517334
Epoch: 5, Steps: 8 | Train Loss: 1.759 Vali Loss: 1.586 Vali Acc: 0.531 Test Loss: 1.586 Test Acc: 0.531
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.068665027618408
Epoch: 6, Steps: 8 | Train Loss: 1.569 Vali Loss: 1.342 Vali Acc: 0.672 Test Loss: 1.342 Test Acc: 0.672
Validation loss decreased (-0.546857 --> -0.671862).  Saving model ...
Epoch: 7 cost time: 1.8373007774353027
Epoch: 7, Steps: 8 | Train Loss: 1.209 Vali Loss: 1.105 Vali Acc: 0.772 Test Loss: 1.105 Test Acc: 0.772
Validation loss decreased (-0.671862 --> -0.771864).  Saving model ...
Epoch: 8 cost time: 1.9941999912261963
Epoch: 8, Steps: 8 | Train Loss: 1.010 Vali Loss: 0.938 Vali Acc: 0.778 Test Loss: 0.938 Test Acc: 0.778
Validation loss decreased (-0.771864 --> -0.778116).  Saving model ...
Epoch: 9 cost time: 1.745509147644043
Epoch: 9, Steps: 8 | Train Loss: 0.781 Vali Loss: 0.811 Vali Acc: 0.797 Test Loss: 0.811 Test Acc: 0.797
Validation loss decreased (-0.778116 --> -0.796867).  Saving model ...
Epoch: 10 cost time: 2.2523114681243896
Epoch: 10, Steps: 8 | Train Loss: 0.661 Vali Loss: 0.741 Vali Acc: 0.809 Test Loss: 0.741 Test Acc: 0.809
Validation loss decreased (-0.796867 --> -0.809368).  Saving model ...
Epoch: 11 cost time: 2.479628801345825
Epoch: 11, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.675 Vali Acc: 0.819 Test Loss: 0.675 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818743).  Saving model ...
Epoch: 12 cost time: 1.6749799251556396
Epoch: 12, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.634 Vali Acc: 0.831 Test Loss: 0.634 Test Acc: 0.831
Validation loss decreased (-0.818743 --> -0.831244).  Saving model ...
Epoch: 13 cost time: 1.5356378555297852
Epoch: 13, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.606 Vali Acc: 0.847 Test Loss: 0.606 Test Acc: 0.847
Validation loss decreased (-0.831244 --> -0.846869).  Saving model ...
Epoch: 14 cost time: 2.202796220779419
Epoch: 14, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.597 Vali Acc: 0.838 Test Loss: 0.597 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1063501834869385
Epoch: 15, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.584 Vali Acc: 0.831 Test Loss: 0.584 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1069812774658203
Epoch: 16, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.570 Vali Acc: 0.847 Test Loss: 0.570 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846869).  Saving model ...
Epoch: 17 cost time: 1.768878698348999
Epoch: 17, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8864922523498535
Epoch: 18, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
Validation loss decreased (-0.846869 --> -0.856244).  Saving model ...
Epoch: 19 cost time: 1.4747796058654785
Epoch: 19, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6674737930297852
Epoch: 20, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1766064167022705
Epoch: 21, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.10203218460083
Epoch: 22, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.101231813430786
Epoch: 23, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856245).  Saving model ...
Epoch: 24 cost time: 1.8486897945404053
Epoch: 24, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8013057708740234
Epoch: 25, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.537 Vali Acc: 0.847 Test Loss: 0.537 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.867271900177002
Epoch: 26, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8635687828063965
Epoch: 27, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.531 Vali Acc: 0.828 Test Loss: 0.531 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.6200909614562988
Epoch: 28, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.705531120300293
Epoch: 29, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9798247814178467
Epoch: 30, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8298909664154053
Epoch: 31, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.526 Vali Acc: 0.847 Test Loss: 0.526 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8630335330963135
Epoch: 32, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6790316104888916
Epoch: 33, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.527 Vali Acc: 0.853 Test Loss: 0.527 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 926660
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.216774225234985
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 2.065 Vali Acc: 0.219 Test Loss: 2.065 Test Acc: 0.219
Validation loss decreased (inf --> -0.218729).  Saving model ...
Epoch: 2 cost time: 1.8049366474151611
Epoch: 2, Steps: 8 | Train Loss: 2.104 Vali Loss: 1.979 Vali Acc: 0.341 Test Loss: 1.979 Test Acc: 0.341
Validation loss decreased (-0.218729 --> -0.340605).  Saving model ...
Epoch: 3 cost time: 1.8172714710235596
Epoch: 3, Steps: 8 | Train Loss: 1.994 Vali Loss: 1.874 Vali Acc: 0.459 Test Loss: 1.874 Test Acc: 0.459
Validation loss decreased (-0.340605 --> -0.459356).  Saving model ...
Epoch: 4 cost time: 1.4952893257141113
Epoch: 4, Steps: 8 | Train Loss: 1.876 Vali Loss: 1.718 Vali Acc: 0.572 Test Loss: 1.718 Test Acc: 0.572
Validation loss decreased (-0.459356 --> -0.571858).  Saving model ...
Epoch: 5 cost time: 1.8862855434417725
Epoch: 5, Steps: 8 | Train Loss: 1.711 Vali Loss: 1.497 Vali Acc: 0.669 Test Loss: 1.497 Test Acc: 0.669
Validation loss decreased (-0.571858 --> -0.668735).  Saving model ...
Epoch: 6 cost time: 2.2231478691101074
Epoch: 6, Steps: 8 | Train Loss: 1.486 Vali Loss: 1.259 Vali Acc: 0.797 Test Loss: 1.259 Test Acc: 0.797
Validation loss decreased (-0.668735 --> -0.796862).  Saving model ...
Epoch: 7 cost time: 2.046675443649292
Epoch: 7, Steps: 8 | Train Loss: 1.197 Vali Loss: 1.027 Vali Acc: 0.822 Test Loss: 1.027 Test Acc: 0.822
Validation loss decreased (-0.796862 --> -0.821865).  Saving model ...
Epoch: 8 cost time: 1.8647794723510742
Epoch: 8, Steps: 8 | Train Loss: 1.013 Vali Loss: 0.864 Vali Acc: 0.806 Test Loss: 0.864 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7231719493865967
Epoch: 9, Steps: 8 | Train Loss: 0.765 Vali Loss: 0.745 Vali Acc: 0.828 Test Loss: 0.745 Test Acc: 0.828
Validation loss decreased (-0.821865 --> -0.828118).  Saving model ...
Epoch: 10 cost time: 1.6816143989562988
Epoch: 10, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.672 Vali Acc: 0.847 Test Loss: 0.672 Test Acc: 0.847
Validation loss decreased (-0.828118 --> -0.846868).  Saving model ...
Epoch: 11 cost time: 1.71878981590271
Epoch: 11, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
Validation loss decreased (-0.846868 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 2.161745548248291
Epoch: 12, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.590 Vali Acc: 0.847 Test Loss: 0.590 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8604223728179932
Epoch: 13, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 1.8968546390533447
Epoch: 14, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.560 Vali Acc: 0.838 Test Loss: 0.560 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.137944221496582
Epoch: 15, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 1.6377687454223633
Epoch: 16, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 1.667600154876709
Epoch: 17, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4957504272460938
Epoch: 18, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0816285610198975
Epoch: 19, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.330571174621582
Epoch: 20, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.687410831451416
Epoch: 21, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.213134527206421
Epoch: 22, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.525 Vali Acc: 0.834 Test Loss: 0.525 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0472257137298584
Epoch: 23, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0363194942474365
Epoch: 24, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7109642028808594
Epoch: 25, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6975255012512207
Epoch: 26, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.504 Vali Acc: 0.831 Test Loss: 0.504 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 923332
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.01111364364624
Epoch: 1, Steps: 8 | Train Loss: 2.218 Vali Loss: 2.094 Vali Acc: 0.138 Test Loss: 2.094 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 1.6736655235290527
Epoch: 2, Steps: 8 | Train Loss: 2.082 Vali Loss: 2.010 Vali Acc: 0.275 Test Loss: 2.010 Test Acc: 0.275
Validation loss decreased (-0.137479 --> -0.274980).  Saving model ...
Epoch: 3 cost time: 1.425441026687622
Epoch: 3, Steps: 8 | Train Loss: 2.026 Vali Loss: 1.912 Vali Acc: 0.366 Test Loss: 1.912 Test Acc: 0.366
Validation loss decreased (-0.274980 --> -0.365606).  Saving model ...
Epoch: 4 cost time: 1.5369911193847656
Epoch: 4, Steps: 8 | Train Loss: 1.902 Vali Loss: 1.768 Vali Acc: 0.547 Test Loss: 1.768 Test Acc: 0.547
Validation loss decreased (-0.365606 --> -0.546857).  Saving model ...
Epoch: 5 cost time: 2.0603058338165283
Epoch: 5, Steps: 8 | Train Loss: 1.739 Vali Loss: 1.598 Vali Acc: 0.609 Test Loss: 1.598 Test Acc: 0.609
Validation loss decreased (-0.546857 --> -0.609359).  Saving model ...
Epoch: 6 cost time: 1.761824369430542
Epoch: 6, Steps: 8 | Train Loss: 1.611 Vali Loss: 1.410 Vali Acc: 0.641 Test Loss: 1.410 Test Acc: 0.641
Validation loss decreased (-0.609359 --> -0.640611).  Saving model ...
Epoch: 7 cost time: 1.868783712387085
Epoch: 7, Steps: 8 | Train Loss: 1.346 Vali Loss: 1.195 Vali Acc: 0.728 Test Loss: 1.195 Test Acc: 0.728
Validation loss decreased (-0.640611 --> -0.728113).  Saving model ...
Epoch: 8 cost time: 1.7756857872009277
Epoch: 8, Steps: 8 | Train Loss: 1.104 Vali Loss: 1.007 Vali Acc: 0.759 Test Loss: 1.007 Test Acc: 0.759
Validation loss decreased (-0.728113 --> -0.759365).  Saving model ...
Epoch: 9 cost time: 1.484572410583496
Epoch: 9, Steps: 8 | Train Loss: 0.901 Vali Loss: 0.846 Vali Acc: 0.766 Test Loss: 0.846 Test Acc: 0.766
Validation loss decreased (-0.759365 --> -0.765617).  Saving model ...
Epoch: 10 cost time: 1.7200298309326172
Epoch: 10, Steps: 8 | Train Loss: 0.737 Vali Loss: 0.730 Vali Acc: 0.812 Test Loss: 0.730 Test Acc: 0.812
Validation loss decreased (-0.765617 --> -0.812493).  Saving model ...
Epoch: 11 cost time: 1.661891222000122
Epoch: 11, Steps: 8 | Train Loss: 0.594 Vali Loss: 0.657 Vali Acc: 0.809 Test Loss: 0.657 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.735705852508545
Epoch: 12, Steps: 8 | Train Loss: 0.522 Vali Loss: 0.608 Vali Acc: 0.816 Test Loss: 0.608 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815619).  Saving model ...
Epoch: 13 cost time: 1.5145847797393799
Epoch: 13, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 14 cost time: 1.5939090251922607
Epoch: 14, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 15 cost time: 1.5164992809295654
Epoch: 15, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831245).  Saving model ...
Epoch: 16 cost time: 1.7402129173278809
Epoch: 16, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7840890884399414
Epoch: 17, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 18 cost time: 1.5348923206329346
Epoch: 18, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5357046127319336
Epoch: 19, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.513 Vali Acc: 0.831 Test Loss: 0.513 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4552278518676758
Epoch: 20, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2018179893493652
Epoch: 21, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.505 Vali Acc: 0.828 Test Loss: 0.505 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1032967567443848
Epoch: 22, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.506 Vali Acc: 0.825 Test Loss: 0.506 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5127742290496826
Epoch: 23, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8633320331573486
Epoch: 24, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.090869665145874
Epoch: 25, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7964675426483154
Epoch: 26, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.523 Vali Acc: 0.834 Test Loss: 0.523 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 27 cost time: 1.65336012840271
Epoch: 27, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0993905067443848
Epoch: 28, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8115358352661133
Epoch: 29, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.513 Vali Acc: 0.822 Test Loss: 0.513 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.730217456817627
Epoch: 30, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.8975133895874023
Epoch: 31, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6082375049591064
Epoch: 32, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.7314772605895996
Epoch: 33, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5461809635162354
Epoch: 34, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.512 Vali Acc: 0.831 Test Loss: 0.512 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.708024263381958
Epoch: 35, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.859973430633545
Epoch: 36, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.515 Vali Acc: 0.825 Test Loss: 0.515 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 784708
model size : 4.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.422603607177734
Epoch: 1, Steps: 8 | Train Loss: 2.116 Vali Loss: 2.047 Vali Acc: 0.106 Test Loss: 2.047 Test Acc: 0.106
Validation loss decreased (inf --> -0.106230).  Saving model ...
Epoch: 2 cost time: 1.6336853504180908
Epoch: 2, Steps: 8 | Train Loss: 2.065 Vali Loss: 1.938 Vali Acc: 0.312 Test Loss: 1.938 Test Acc: 0.312
Validation loss decreased (-0.106230 --> -0.312481).  Saving model ...
Epoch: 3 cost time: 1.5762333869934082
Epoch: 3, Steps: 8 | Train Loss: 1.988 Vali Loss: 1.832 Vali Acc: 0.453 Test Loss: 1.832 Test Acc: 0.453
Validation loss decreased (-0.312481 --> -0.453107).  Saving model ...
Epoch: 4 cost time: 1.6533772945404053
Epoch: 4, Steps: 8 | Train Loss: 1.857 Vali Loss: 1.674 Vali Acc: 0.588 Test Loss: 1.674 Test Acc: 0.588
Validation loss decreased (-0.453107 --> -0.587483).  Saving model ...
Epoch: 5 cost time: 1.8995881080627441
Epoch: 5, Steps: 8 | Train Loss: 1.680 Vali Loss: 1.478 Vali Acc: 0.681 Test Loss: 1.478 Test Acc: 0.681
Validation loss decreased (-0.587483 --> -0.681235).  Saving model ...
Epoch: 6 cost time: 1.846207857131958
Epoch: 6, Steps: 8 | Train Loss: 1.453 Vali Loss: 1.253 Vali Acc: 0.725 Test Loss: 1.253 Test Acc: 0.725
Validation loss decreased (-0.681235 --> -0.724987).  Saving model ...
Epoch: 7 cost time: 1.851893424987793
Epoch: 7, Steps: 8 | Train Loss: 1.182 Vali Loss: 1.056 Vali Acc: 0.766 Test Loss: 1.056 Test Acc: 0.766
Validation loss decreased (-0.724987 --> -0.765614).  Saving model ...
Epoch: 8 cost time: 1.6667766571044922
Epoch: 8, Steps: 8 | Train Loss: 0.978 Vali Loss: 0.887 Vali Acc: 0.803 Test Loss: 0.887 Test Acc: 0.803
Validation loss decreased (-0.765614 --> -0.803116).  Saving model ...
Epoch: 9 cost time: 2.040158748626709
Epoch: 9, Steps: 8 | Train Loss: 0.780 Vali Loss: 0.764 Vali Acc: 0.822 Test Loss: 0.764 Test Acc: 0.822
Validation loss decreased (-0.803116 --> -0.821867).  Saving model ...
Epoch: 10 cost time: 2.093125820159912
Epoch: 10, Steps: 8 | Train Loss: 0.635 Vali Loss: 0.682 Vali Acc: 0.847 Test Loss: 0.682 Test Acc: 0.847
Validation loss decreased (-0.821867 --> -0.846868).  Saving model ...
Epoch: 11 cost time: 2.0750744342803955
Epoch: 11, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0737528800964355
Epoch: 12, Steps: 8 | Train Loss: 0.438 Vali Loss: 0.596 Vali Acc: 0.847 Test Loss: 0.596 Test Acc: 0.847
Validation loss decreased (-0.846868 --> -0.846869).  Saving model ...
Epoch: 13 cost time: 1.8017399311065674
Epoch: 13, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.064303398132324
Epoch: 14, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.562 Vali Acc: 0.838 Test Loss: 0.562 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9480013847351074
Epoch: 15, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0978033542633057
Epoch: 16, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3656582832336426
Epoch: 17, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9723708629608154
Epoch: 18, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.538 Vali Acc: 0.838 Test Loss: 0.538 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7798082828521729
Epoch: 19, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846870).  Saving model ...
Epoch: 20 cost time: 1.5477921962738037
Epoch: 20, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7738041877746582
Epoch: 21, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.644085168838501
Epoch: 22, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.140672445297241
Epoch: 23, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2667179107666016
Epoch: 24, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.1438229084014893
Epoch: 25, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.544 Vali Acc: 0.834 Test Loss: 0.544 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7998392581939697
Epoch: 26, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9029591083526611
Epoch: 27, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.456658124923706
Epoch: 28, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1140494346618652
Epoch: 29, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 781380
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.762777328491211
Epoch: 1, Steps: 8 | Train Loss: 2.247 Vali Loss: 2.110 Vali Acc: 0.134 Test Loss: 2.110 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 1.5258164405822754
Epoch: 2, Steps: 8 | Train Loss: 2.066 Vali Loss: 1.972 Vali Acc: 0.284 Test Loss: 1.972 Test Acc: 0.284
Validation loss decreased (-0.134354 --> -0.284355).  Saving model ...
Epoch: 3 cost time: 1.5823135375976562
Epoch: 3, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.884 Vali Acc: 0.453 Test Loss: 1.884 Test Acc: 0.453
Validation loss decreased (-0.284355 --> -0.453106).  Saving model ...
Epoch: 4 cost time: 1.6490225791931152
Epoch: 4, Steps: 8 | Train Loss: 1.830 Vali Loss: 1.698 Vali Acc: 0.606 Test Loss: 1.698 Test Acc: 0.606
Validation loss decreased (-0.453106 --> -0.606233).  Saving model ...
Epoch: 5 cost time: 1.8983650207519531
Epoch: 5, Steps: 8 | Train Loss: 1.699 Vali Loss: 1.500 Vali Acc: 0.647 Test Loss: 1.500 Test Acc: 0.647
Validation loss decreased (-0.606233 --> -0.646860).  Saving model ...
Epoch: 6 cost time: 1.8109982013702393
Epoch: 6, Steps: 8 | Train Loss: 1.421 Vali Loss: 1.283 Vali Acc: 0.725 Test Loss: 1.283 Test Acc: 0.725
Validation loss decreased (-0.646860 --> -0.724987).  Saving model ...
Epoch: 7 cost time: 1.5977225303649902
Epoch: 7, Steps: 8 | Train Loss: 1.210 Vali Loss: 1.089 Vali Acc: 0.738 Test Loss: 1.089 Test Acc: 0.738
Validation loss decreased (-0.724987 --> -0.737489).  Saving model ...
Epoch: 8 cost time: 1.478241205215454
Epoch: 8, Steps: 8 | Train Loss: 0.965 Vali Loss: 0.934 Vali Acc: 0.791 Test Loss: 0.934 Test Acc: 0.791
Validation loss decreased (-0.737489 --> -0.790616).  Saving model ...
Epoch: 9 cost time: 1.4240450859069824
Epoch: 9, Steps: 8 | Train Loss: 0.818 Vali Loss: 0.808 Vali Acc: 0.803 Test Loss: 0.808 Test Acc: 0.803
Validation loss decreased (-0.790616 --> -0.803117).  Saving model ...
Epoch: 10 cost time: 1.4675986766815186
Epoch: 10, Steps: 8 | Train Loss: 0.701 Vali Loss: 0.745 Vali Acc: 0.803 Test Loss: 0.745 Test Acc: 0.803
Validation loss decreased (-0.803117 --> -0.803118).  Saving model ...
Epoch: 11 cost time: 1.4495441913604736
Epoch: 11, Steps: 8 | Train Loss: 0.561 Vali Loss: 0.675 Vali Acc: 0.831 Test Loss: 0.675 Test Acc: 0.831
Validation loss decreased (-0.803118 --> -0.831243).  Saving model ...
Epoch: 12 cost time: 1.4848053455352783
Epoch: 12, Steps: 8 | Train Loss: 0.496 Vali Loss: 0.641 Vali Acc: 0.834 Test Loss: 0.641 Test Acc: 0.834
Validation loss decreased (-0.831243 --> -0.834369).  Saving model ...
Epoch: 13 cost time: 1.7524492740631104
Epoch: 13, Steps: 8 | Train Loss: 0.399 Vali Loss: 0.607 Vali Acc: 0.838 Test Loss: 0.607 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 14 cost time: 1.4966809749603271
Epoch: 14, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.582406759262085
Epoch: 15, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6184394359588623
Epoch: 16, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.363910436630249
Epoch: 17, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5232124328613281
Epoch: 18, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8854024410247803
Epoch: 19, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.681955337524414
Epoch: 20, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6720805168151855
Epoch: 21, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6024060249328613
Epoch: 22, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.542 Vali Acc: 0.819 Test Loss: 0.542 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.718247890472412
Epoch: 23, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 778052
model size : 4.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.547900676727295
Epoch: 1, Steps: 8 | Train Loss: 2.117 Vali Loss: 2.073 Vali Acc: 0.175 Test Loss: 2.073 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 1.861652135848999
Epoch: 2, Steps: 8 | Train Loss: 2.089 Vali Loss: 1.983 Vali Acc: 0.284 Test Loss: 1.983 Test Acc: 0.284
Validation loss decreased (-0.174979 --> -0.284355).  Saving model ...
Epoch: 3 cost time: 1.9379193782806396
Epoch: 3, Steps: 8 | Train Loss: 1.975 Vali Loss: 1.880 Vali Acc: 0.372 Test Loss: 1.880 Test Acc: 0.372
Validation loss decreased (-0.284355 --> -0.371856).  Saving model ...
Epoch: 4 cost time: 2.049729824066162
Epoch: 4, Steps: 8 | Train Loss: 1.819 Vali Loss: 1.725 Vali Acc: 0.559 Test Loss: 1.725 Test Acc: 0.559
Validation loss decreased (-0.371856 --> -0.559358).  Saving model ...
Epoch: 5 cost time: 1.9187815189361572
Epoch: 5, Steps: 8 | Train Loss: 1.662 Vali Loss: 1.531 Vali Acc: 0.697 Test Loss: 1.531 Test Acc: 0.697
Validation loss decreased (-0.559358 --> -0.696860).  Saving model ...
Epoch: 6 cost time: 2.732152223587036
Epoch: 6, Steps: 8 | Train Loss: 1.479 Vali Loss: 1.311 Vali Acc: 0.731 Test Loss: 1.311 Test Acc: 0.731
Validation loss decreased (-0.696860 --> -0.731237).  Saving model ...
Epoch: 7 cost time: 1.9326863288879395
Epoch: 7, Steps: 8 | Train Loss: 1.193 Vali Loss: 1.115 Vali Acc: 0.753 Test Loss: 1.115 Test Acc: 0.753
Validation loss decreased (-0.731237 --> -0.753114).  Saving model ...
Epoch: 8 cost time: 2.000352621078491
Epoch: 8, Steps: 8 | Train Loss: 1.013 Vali Loss: 0.955 Vali Acc: 0.769 Test Loss: 0.955 Test Acc: 0.769
Validation loss decreased (-0.753114 --> -0.768740).  Saving model ...
Epoch: 9 cost time: 1.8441834449768066
Epoch: 9, Steps: 8 | Train Loss: 0.810 Vali Loss: 0.836 Vali Acc: 0.791 Test Loss: 0.836 Test Acc: 0.791
Validation loss decreased (-0.768740 --> -0.790617).  Saving model ...
Epoch: 10 cost time: 1.744819164276123
Epoch: 10, Steps: 8 | Train Loss: 0.677 Vali Loss: 0.743 Vali Acc: 0.803 Test Loss: 0.743 Test Acc: 0.803
Validation loss decreased (-0.790617 --> -0.803118).  Saving model ...
Epoch: 11 cost time: 1.632218360900879
Epoch: 11, Steps: 8 | Train Loss: 0.563 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
Validation loss decreased (-0.803118 --> -0.828118).  Saving model ...
Epoch: 12 cost time: 1.7768101692199707
Epoch: 12, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.654 Vali Acc: 0.806 Test Loss: 0.654 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.099036693572998
Epoch: 13, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.635 Vali Acc: 0.812 Test Loss: 0.635 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5447046756744385
Epoch: 14, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.589 Vali Acc: 0.838 Test Loss: 0.589 Test Acc: 0.838
Validation loss decreased (-0.828118 --> -0.837494).  Saving model ...
Epoch: 15 cost time: 2.04292631149292
Epoch: 15, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.572 Vali Acc: 0.834 Test Loss: 0.572 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6849365234375
Epoch: 16, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843744).  Saving model ...
Epoch: 17 cost time: 1.5177085399627686
Epoch: 17, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843744).  Saving model ...
Epoch: 18 cost time: 1.4958100318908691
Epoch: 18, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8223388195037842
Epoch: 19, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7536752223968506
Epoch: 20, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0980193614959717
Epoch: 21, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 22 cost time: 2.7444913387298584
Epoch: 22, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.521 Vali Acc: 0.859 Test Loss: 0.521 Test Acc: 0.859
Validation loss decreased (-0.843745 --> -0.859370).  Saving model ...
Epoch: 23 cost time: 1.7690317630767822
Epoch: 23, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.555 Vali Acc: 0.831 Test Loss: 0.555 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7960753440856934
Epoch: 24, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0338239669799805
Epoch: 25, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.3380074501037598
Epoch: 26, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.1047825813293457
Epoch: 27, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.525 Vali Acc: 0.853 Test Loss: 0.525 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6095538139343262
Epoch: 28, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6993415355682373
Epoch: 29, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.1343085765838623
Epoch: 30, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5914890766143799
Epoch: 31, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.871286392211914
Epoch: 32, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.518 Vali Acc: 0.856 Test Loss: 0.518 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 774724
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8426308631896973
Epoch: 1, Steps: 8 | Train Loss: 2.292 Vali Loss: 2.164 Vali Acc: 0.056 Test Loss: 2.164 Test Acc: 0.056
Validation loss decreased (inf --> -0.056228).  Saving model ...
Epoch: 2 cost time: 2.2571792602539062
Epoch: 2, Steps: 8 | Train Loss: 2.126 Vali Loss: 2.038 Vali Acc: 0.241 Test Loss: 2.038 Test Acc: 0.241
Validation loss decreased (-0.056228 --> -0.240605).  Saving model ...
Epoch: 3 cost time: 2.108217239379883
Epoch: 3, Steps: 8 | Train Loss: 2.050 Vali Loss: 1.936 Vali Acc: 0.384 Test Loss: 1.936 Test Acc: 0.384
Validation loss decreased (-0.240605 --> -0.384356).  Saving model ...
Epoch: 4 cost time: 2.1693904399871826
Epoch: 4, Steps: 8 | Train Loss: 1.887 Vali Loss: 1.803 Vali Acc: 0.438 Test Loss: 1.803 Test Acc: 0.438
Validation loss decreased (-0.384356 --> -0.437482).  Saving model ...
Epoch: 5 cost time: 1.564816951751709
Epoch: 5, Steps: 8 | Train Loss: 1.806 Vali Loss: 1.646 Vali Acc: 0.487 Test Loss: 1.646 Test Acc: 0.487
Validation loss decreased (-0.437482 --> -0.487484).  Saving model ...
Epoch: 6 cost time: 1.8952653408050537
Epoch: 6, Steps: 8 | Train Loss: 1.574 Vali Loss: 1.450 Vali Acc: 0.650 Test Loss: 1.450 Test Acc: 0.650
Validation loss decreased (-0.487484 --> -0.649986).  Saving model ...
Epoch: 7 cost time: 2.1948742866516113
Epoch: 7, Steps: 8 | Train Loss: 1.364 Vali Loss: 1.268 Vali Acc: 0.722 Test Loss: 1.268 Test Acc: 0.722
Validation loss decreased (-0.649986 --> -0.721862).  Saving model ...
Epoch: 8 cost time: 2.2882368564605713
Epoch: 8, Steps: 8 | Train Loss: 1.143 Vali Loss: 1.131 Vali Acc: 0.731 Test Loss: 1.131 Test Acc: 0.731
Validation loss decreased (-0.721862 --> -0.731239).  Saving model ...
Epoch: 9 cost time: 2.1305582523345947
Epoch: 9, Steps: 8 | Train Loss: 0.982 Vali Loss: 1.008 Vali Acc: 0.756 Test Loss: 1.008 Test Acc: 0.756
Validation loss decreased (-0.731239 --> -0.756240).  Saving model ...
Epoch: 10 cost time: 1.9033269882202148
Epoch: 10, Steps: 8 | Train Loss: 0.875 Vali Loss: 0.894 Vali Acc: 0.800 Test Loss: 0.894 Test Acc: 0.800
Validation loss decreased (-0.756240 --> -0.799991).  Saving model ...
Epoch: 11 cost time: 2.3951830863952637
Epoch: 11, Steps: 8 | Train Loss: 0.736 Vali Loss: 0.818 Vali Acc: 0.812 Test Loss: 0.818 Test Acc: 0.812
Validation loss decreased (-0.799991 --> -0.812492).  Saving model ...
Epoch: 12 cost time: 2.1701669692993164
Epoch: 12, Steps: 8 | Train Loss: 0.671 Vali Loss: 0.747 Vali Acc: 0.828 Test Loss: 0.747 Test Acc: 0.828
Validation loss decreased (-0.812492 --> -0.828118).  Saving model ...
Epoch: 13 cost time: 1.9918885231018066
Epoch: 13, Steps: 8 | Train Loss: 0.554 Vali Loss: 0.701 Vali Acc: 0.822 Test Loss: 0.701 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2265915870666504
Epoch: 14, Steps: 8 | Train Loss: 0.548 Vali Loss: 0.668 Vali Acc: 0.828 Test Loss: 0.668 Test Acc: 0.828
Validation loss decreased (-0.828118 --> -0.828118).  Saving model ...
Epoch: 15 cost time: 1.3676562309265137
Epoch: 15, Steps: 8 | Train Loss: 0.466 Vali Loss: 0.638 Vali Acc: 0.831 Test Loss: 0.638 Test Acc: 0.831
Validation loss decreased (-0.828118 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 1.6239948272705078
Epoch: 16, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.619 Vali Acc: 0.834 Test Loss: 0.619 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 17 cost time: 1.8834335803985596
Epoch: 17, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.607 Vali Acc: 0.828 Test Loss: 0.607 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3757669925689697
Epoch: 18, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840619).  Saving model ...
Epoch: 19 cost time: 2.013530731201172
Epoch: 19, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.584 Vali Acc: 0.831 Test Loss: 0.584 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0430655479431152
Epoch: 20, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.571 Vali Acc: 0.834 Test Loss: 0.571 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8189818859100342
Epoch: 21, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.560 Vali Acc: 0.825 Test Loss: 0.560 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0066561698913574
Epoch: 22, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.552 Vali Acc: 0.831 Test Loss: 0.552 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4268054962158203
Epoch: 23, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.546 Vali Acc: 0.831 Test Loss: 0.546 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.2412328720092773
Epoch: 24, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.0589420795440674
Epoch: 25, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8001976013183594
Epoch: 26, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840620).  Saving model ...
Epoch: 27 cost time: 1.7778434753417969
Epoch: 27, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.519 Vali Acc: 0.825 Test Loss: 0.519 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.880113124847412
Epoch: 28, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.524 Vali Acc: 0.819 Test Loss: 0.524 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7947108745574951
Epoch: 29, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.387073040008545
Epoch: 30, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.8536930084228516
Epoch: 31, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.8104071617126465
Epoch: 32, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 33 cost time: 1.7285113334655762
Epoch: 33, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.507 Vali Acc: 0.828 Test Loss: 0.507 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9812016487121582
Epoch: 34, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.5109355449676514
Epoch: 35, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 36 cost time: 1.859832763671875
Epoch: 36, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7362895011901855
Epoch: 37, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.518 Vali Acc: 0.844 Test Loss: 0.518 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 38 cost time: 2.271479845046997
Epoch: 38, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.0910730361938477
Epoch: 39, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.9336926937103271
Epoch: 40, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.353372812271118
Epoch: 41, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.0249500274658203
Epoch: 42, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.520 Vali Acc: 0.834 Test Loss: 0.520 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.7138075828552246
Epoch: 43, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.521 Vali Acc: 0.834 Test Loss: 0.521 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.134364128112793
Epoch: 44, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.518 Vali Acc: 0.834 Test Loss: 0.518 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.168107271194458
Epoch: 45, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.263368606567383
Epoch: 46, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.499 Vali Acc: 0.828 Test Loss: 0.499 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.8320562839508057
Epoch: 47, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 769668
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6331825256347656
Epoch: 1, Steps: 8 | Train Loss: 2.300 Vali Loss: 2.271 Vali Acc: 0.172 Test Loss: 2.271 Test Acc: 0.172
Validation loss decreased (inf --> -0.171852).  Saving model ...
Epoch: 2 cost time: 1.591461181640625
Epoch: 2, Steps: 8 | Train Loss: 2.129 Vali Loss: 2.077 Vali Acc: 0.197 Test Loss: 2.077 Test Acc: 0.197
Validation loss decreased (-0.171852 --> -0.196854).  Saving model ...
Epoch: 3 cost time: 1.3788223266601562
Epoch: 3, Steps: 8 | Train Loss: 2.029 Vali Loss: 1.961 Vali Acc: 0.291 Test Loss: 1.961 Test Acc: 0.291
Validation loss decreased (-0.196854 --> -0.290605).  Saving model ...
Epoch: 4 cost time: 1.6396129131317139
Epoch: 4, Steps: 8 | Train Loss: 1.901 Vali Loss: 1.831 Vali Acc: 0.372 Test Loss: 1.831 Test Acc: 0.372
Validation loss decreased (-0.290605 --> -0.371857).  Saving model ...
Epoch: 5 cost time: 1.6227376461029053
Epoch: 5, Steps: 8 | Train Loss: 1.742 Vali Loss: 1.629 Vali Acc: 0.525 Test Loss: 1.629 Test Acc: 0.525
Validation loss decreased (-0.371857 --> -0.524984).  Saving model ...
Epoch: 6 cost time: 1.9623456001281738
Epoch: 6, Steps: 8 | Train Loss: 1.517 Vali Loss: 1.448 Vali Acc: 0.628 Test Loss: 1.448 Test Acc: 0.628
Validation loss decreased (-0.524984 --> -0.628111).  Saving model ...
Epoch: 7 cost time: 1.829775094985962
Epoch: 7, Steps: 8 | Train Loss: 1.377 Vali Loss: 1.261 Vali Acc: 0.703 Test Loss: 1.261 Test Acc: 0.703
Validation loss decreased (-0.628111 --> -0.703112).  Saving model ...
Epoch: 8 cost time: 1.9466054439544678
Epoch: 8, Steps: 8 | Train Loss: 1.176 Vali Loss: 1.118 Vali Acc: 0.756 Test Loss: 1.118 Test Acc: 0.756
Validation loss decreased (-0.703112 --> -0.756239).  Saving model ...
Epoch: 9 cost time: 1.7486283779144287
Epoch: 9, Steps: 8 | Train Loss: 0.981 Vali Loss: 0.996 Vali Acc: 0.772 Test Loss: 0.996 Test Acc: 0.772
Validation loss decreased (-0.756239 --> -0.771865).  Saving model ...
Epoch: 10 cost time: 1.6479694843292236
Epoch: 10, Steps: 8 | Train Loss: 0.838 Vali Loss: 0.904 Vali Acc: 0.794 Test Loss: 0.904 Test Acc: 0.794
Validation loss decreased (-0.771865 --> -0.793741).  Saving model ...
Epoch: 11 cost time: 1.5429675579071045
Epoch: 11, Steps: 8 | Train Loss: 0.768 Vali Loss: 0.815 Vali Acc: 0.797 Test Loss: 0.815 Test Acc: 0.797
Validation loss decreased (-0.793741 --> -0.796867).  Saving model ...
Epoch: 12 cost time: 1.4579927921295166
Epoch: 12, Steps: 8 | Train Loss: 0.686 Vali Loss: 0.744 Vali Acc: 0.816 Test Loss: 0.744 Test Acc: 0.816
Validation loss decreased (-0.796867 --> -0.815618).  Saving model ...
Epoch: 13 cost time: 1.3776156902313232
Epoch: 13, Steps: 8 | Train Loss: 0.595 Vali Loss: 0.728 Vali Acc: 0.803 Test Loss: 0.728 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6809661388397217
Epoch: 14, Steps: 8 | Train Loss: 0.514 Vali Loss: 0.685 Vali Acc: 0.806 Test Loss: 0.685 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6177895069122314
Epoch: 15, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.648 Vali Acc: 0.825 Test Loss: 0.648 Test Acc: 0.825
Validation loss decreased (-0.815618 --> -0.824994).  Saving model ...
Epoch: 16 cost time: 1.6441574096679688
Epoch: 16, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.630 Vali Acc: 0.816 Test Loss: 0.630 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.556969404220581
Epoch: 17, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6268410682678223
Epoch: 18, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 19 cost time: 1.6127276420593262
Epoch: 19, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.565 Vali Acc: 0.828 Test Loss: 0.565 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 20 cost time: 1.7354445457458496
Epoch: 20, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.542 Vali Acc: 0.834 Test Loss: 0.542 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 21 cost time: 1.7828783988952637
Epoch: 21, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8280181884765625
Epoch: 22, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6641583442687988
Epoch: 23, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.525 Vali Acc: 0.838 Test Loss: 0.525 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 24 cost time: 1.7656431198120117
Epoch: 24, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6800711154937744
Epoch: 25, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.525 Vali Acc: 0.853 Test Loss: 0.525 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853120).  Saving model ...
Epoch: 26 cost time: 1.3723115921020508
Epoch: 26, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.540 Vali Acc: 0.816 Test Loss: 0.540 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6496272087097168
Epoch: 27, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5697166919708252
Epoch: 28, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5386536121368408
Epoch: 29, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4884002208709717
Epoch: 30, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.520 Vali Acc: 0.831 Test Loss: 0.520 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.523909091949463
Epoch: 31, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4362428188323975
Epoch: 32, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.5038325786590576
Epoch: 33, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 34 cost time: 1.6133499145507812
Epoch: 34, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.107992172241211
Epoch: 35, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.464428186416626
Epoch: 36, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.493 Vali Acc: 0.859 Test Loss: 0.493 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 37 cost time: 1.5726230144500732
Epoch: 37, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.509 Vali Acc: 0.853 Test Loss: 0.509 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.6785929203033447
Epoch: 38, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5841107368469238
Epoch: 39, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8044416904449463
Epoch: 40, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.8105831146240234
Epoch: 41, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.7962191104888916
Epoch: 42, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.9515018463134766
Epoch: 43, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.498 Vali Acc: 0.863 Test Loss: 0.498 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 44 cost time: 2.001525640487671
Epoch: 44, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.512 Vali Acc: 0.847 Test Loss: 0.512 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6177706718444824
Epoch: 45, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6940512657165527
Epoch: 46, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.7246882915496826
Epoch: 47, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.516 Vali Acc: 0.856 Test Loss: 0.516 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.1806721687316895
Epoch: 48, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.9237911701202393
Epoch: 49, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.518 Vali Acc: 0.853 Test Loss: 0.518 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.6715257167816162
Epoch: 50, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.7162644863128662
Epoch: 51, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.718092918395996
Epoch: 52, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.504 Vali Acc: 0.859 Test Loss: 0.504 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.843052625656128
Epoch: 53, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 768004
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.408788442611694
Epoch: 1, Steps: 8 | Train Loss: 2.086 Vali Loss: 2.056 Vali Acc: 0.128 Test Loss: 2.056 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 1.8823587894439697
Epoch: 2, Steps: 8 | Train Loss: 2.064 Vali Loss: 1.982 Vali Acc: 0.263 Test Loss: 1.982 Test Acc: 0.263
Validation loss decreased (-0.128104 --> -0.262480).  Saving model ...
Epoch: 3 cost time: 1.6479957103729248
Epoch: 3, Steps: 8 | Train Loss: 1.981 Vali Loss: 1.884 Vali Acc: 0.453 Test Loss: 1.884 Test Acc: 0.453
Validation loss decreased (-0.262480 --> -0.453106).  Saving model ...
Epoch: 4 cost time: 1.6624722480773926
Epoch: 4, Steps: 8 | Train Loss: 1.848 Vali Loss: 1.731 Vali Acc: 0.503 Test Loss: 1.731 Test Acc: 0.503
Validation loss decreased (-0.453106 --> -0.503108).  Saving model ...
Epoch: 5 cost time: 1.4388401508331299
Epoch: 5, Steps: 8 | Train Loss: 1.640 Vali Loss: 1.535 Vali Acc: 0.566 Test Loss: 1.535 Test Acc: 0.566
Validation loss decreased (-0.503108 --> -0.565610).  Saving model ...
Epoch: 6 cost time: 1.6568405628204346
Epoch: 6, Steps: 8 | Train Loss: 1.430 Vali Loss: 1.356 Vali Acc: 0.672 Test Loss: 1.356 Test Acc: 0.672
Validation loss decreased (-0.565610 --> -0.671861).  Saving model ...
Epoch: 7 cost time: 1.7728893756866455
Epoch: 7, Steps: 8 | Train Loss: 1.301 Vali Loss: 1.205 Vali Acc: 0.703 Test Loss: 1.205 Test Acc: 0.703
Validation loss decreased (-0.671861 --> -0.703113).  Saving model ...
Epoch: 8 cost time: 1.427095890045166
Epoch: 8, Steps: 8 | Train Loss: 1.102 Vali Loss: 1.084 Vali Acc: 0.731 Test Loss: 1.084 Test Acc: 0.731
Validation loss decreased (-0.703113 --> -0.731239).  Saving model ...
Epoch: 9 cost time: 1.9296324253082275
Epoch: 9, Steps: 8 | Train Loss: 0.939 Vali Loss: 0.984 Vali Acc: 0.747 Test Loss: 0.984 Test Acc: 0.747
Validation loss decreased (-0.731239 --> -0.746865).  Saving model ...
Epoch: 10 cost time: 2.2528135776519775
Epoch: 10, Steps: 8 | Train Loss: 0.842 Vali Loss: 0.907 Vali Acc: 0.759 Test Loss: 0.907 Test Acc: 0.759
Validation loss decreased (-0.746865 --> -0.759366).  Saving model ...
Epoch: 11 cost time: 1.906787395477295
Epoch: 11, Steps: 8 | Train Loss: 0.706 Vali Loss: 0.838 Vali Acc: 0.766 Test Loss: 0.838 Test Acc: 0.766
Validation loss decreased (-0.759366 --> -0.765617).  Saving model ...
Epoch: 12 cost time: 1.607243299484253
Epoch: 12, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.782 Vali Acc: 0.769 Test Loss: 0.782 Test Acc: 0.769
Validation loss decreased (-0.765617 --> -0.768742).  Saving model ...
Epoch: 13 cost time: 1.7148888111114502
Epoch: 13, Steps: 8 | Train Loss: 0.602 Vali Loss: 0.738 Vali Acc: 0.794 Test Loss: 0.738 Test Acc: 0.794
Validation loss decreased (-0.768742 --> -0.793743).  Saving model ...
Epoch: 14 cost time: 1.6927485466003418
Epoch: 14, Steps: 8 | Train Loss: 0.526 Vali Loss: 0.702 Vali Acc: 0.806 Test Loss: 0.702 Test Acc: 0.806
Validation loss decreased (-0.793743 --> -0.806243).  Saving model ...
Epoch: 15 cost time: 1.7334649562835693
Epoch: 15, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.666 Vali Acc: 0.806 Test Loss: 0.666 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806243).  Saving model ...
Epoch: 16 cost time: 1.4546990394592285
Epoch: 16, Steps: 8 | Train Loss: 0.407 Vali Loss: 0.640 Vali Acc: 0.816 Test Loss: 0.640 Test Acc: 0.816
Validation loss decreased (-0.806243 --> -0.815619).  Saving model ...
Epoch: 17 cost time: 1.624229907989502
Epoch: 17, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5800185203552246
Epoch: 18, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.594 Vali Acc: 0.819 Test Loss: 0.594 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 19 cost time: 2.554015636444092
Epoch: 19, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.577 Vali Acc: 0.825 Test Loss: 0.577 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 20 cost time: 1.4883549213409424
Epoch: 20, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.440103530883789
Epoch: 21, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.558 Vali Acc: 0.816 Test Loss: 0.558 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.744570255279541
Epoch: 22, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.550 Vali Acc: 0.828 Test Loss: 0.550 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 23 cost time: 1.618558406829834
Epoch: 23, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6607918739318848
Epoch: 24, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8373124599456787
Epoch: 25, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6074082851409912
Epoch: 26, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 27 cost time: 1.6396198272705078
Epoch: 27, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.529 Vali Acc: 0.825 Test Loss: 0.529 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7254602909088135
Epoch: 28, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.520 Vali Acc: 0.831 Test Loss: 0.520 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 29 cost time: 1.501539945602417
Epoch: 29, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.528 Vali Acc: 0.828 Test Loss: 0.528 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5196247100830078
Epoch: 30, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4705941677093506
Epoch: 31, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 32 cost time: 1.6490223407745361
Epoch: 32, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 33 cost time: 1.6000230312347412
Epoch: 33, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.541 Vali Acc: 0.812 Test Loss: 0.541 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.781186819076538
Epoch: 34, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 35 cost time: 1.5023820400238037
Epoch: 35, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5612847805023193
Epoch: 36, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 37 cost time: 1.868112564086914
Epoch: 37, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.74367094039917
Epoch: 38, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.960435390472412
Epoch: 39, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.507 Vali Acc: 0.828 Test Loss: 0.507 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.248595714569092
Epoch: 40, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.505 Vali Acc: 0.828 Test Loss: 0.505 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.6181795597076416
Epoch: 41, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4883337020874023
Epoch: 42, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.831782341003418
Epoch: 43, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 44 cost time: 1.81241774559021
Epoch: 44, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6593379974365234
Epoch: 45, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.488 Vali Acc: 0.831 Test Loss: 0.488 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.0688819885253906
Epoch: 46, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.7334582805633545
Epoch: 47, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.504 Vali Acc: 0.834 Test Loss: 0.504 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.756086826324463
Epoch: 48, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.506 Vali Acc: 0.828 Test Loss: 0.506 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.7073333263397217
Epoch: 49, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.9289140701293945
Epoch: 50, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.3388895988464355
Epoch: 51, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.990159034729004
Epoch: 52, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.476 Vali Acc: 0.853 Test Loss: 0.476 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 53 cost time: 1.8482975959777832
Epoch: 53, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.504 Vali Acc: 0.828 Test Loss: 0.504 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.9993867874145508
Epoch: 54, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.529 Vali Acc: 0.828 Test Loss: 0.529 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.176321506500244
Epoch: 55, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.495 Vali Acc: 0.838 Test Loss: 0.495 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 2.0070016384124756
Epoch: 56, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 2.0688931941986084
Epoch: 57, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.7226147651672363
Epoch: 58, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.5417068004608154
Epoch: 59, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.514 Vali Acc: 0.831 Test Loss: 0.514 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.7850041389465332
Epoch: 60, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.510 Vali Acc: 0.831 Test Loss: 0.510 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.7301175594329834
Epoch: 61, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.660851001739502
Epoch: 62, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.504 Vali Acc: 0.828 Test Loss: 0.504 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 766340
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.5225560665130615
Epoch: 1, Steps: 8 | Train Loss: 2.119 Vali Loss: 2.077 Vali Acc: 0.147 Test Loss: 2.077 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 1.8047442436218262
Epoch: 2, Steps: 8 | Train Loss: 2.145 Vali Loss: 1.983 Vali Acc: 0.191 Test Loss: 1.983 Test Acc: 0.191
Validation loss decreased (-0.146854 --> -0.190605).  Saving model ...
Epoch: 3 cost time: 1.7631983757019043
Epoch: 3, Steps: 8 | Train Loss: 1.994 Vali Loss: 1.852 Vali Acc: 0.428 Test Loss: 1.852 Test Acc: 0.428
Validation loss decreased (-0.190605 --> -0.428106).  Saving model ...
Epoch: 4 cost time: 1.786088228225708
Epoch: 4, Steps: 8 | Train Loss: 1.810 Vali Loss: 1.717 Vali Acc: 0.569 Test Loss: 1.717 Test Acc: 0.569
Validation loss decreased (-0.428106 --> -0.568733).  Saving model ...
Epoch: 5 cost time: 1.7835726737976074
Epoch: 5, Steps: 8 | Train Loss: 1.690 Vali Loss: 1.544 Vali Acc: 0.662 Test Loss: 1.544 Test Acc: 0.662
Validation loss decreased (-0.568733 --> -0.662485).  Saving model ...
Epoch: 6 cost time: 1.8497650623321533
Epoch: 6, Steps: 8 | Train Loss: 1.488 Vali Loss: 1.374 Vali Acc: 0.722 Test Loss: 1.374 Test Acc: 0.722
Validation loss decreased (-0.662485 --> -0.721861).  Saving model ...
Epoch: 7 cost time: 1.670313835144043
Epoch: 7, Steps: 8 | Train Loss: 1.278 Vali Loss: 1.208 Vali Acc: 0.772 Test Loss: 1.208 Test Acc: 0.772
Validation loss decreased (-0.721861 --> -0.771863).  Saving model ...
Epoch: 8 cost time: 1.7220702171325684
Epoch: 8, Steps: 8 | Train Loss: 1.099 Vali Loss: 1.061 Vali Acc: 0.809 Test Loss: 1.061 Test Acc: 0.809
Validation loss decreased (-0.771863 --> -0.809364).  Saving model ...
Epoch: 9 cost time: 2.0645320415496826
Epoch: 9, Steps: 8 | Train Loss: 0.931 Vali Loss: 0.942 Vali Acc: 0.809 Test Loss: 0.942 Test Acc: 0.809
Validation loss decreased (-0.809364 --> -0.809366).  Saving model ...
Epoch: 10 cost time: 1.8430211544036865
Epoch: 10, Steps: 8 | Train Loss: 0.801 Vali Loss: 0.851 Vali Acc: 0.800 Test Loss: 0.851 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.980156421661377
Epoch: 11, Steps: 8 | Train Loss: 0.733 Vali Loss: 0.775 Vali Acc: 0.816 Test Loss: 0.775 Test Acc: 0.816
Validation loss decreased (-0.809366 --> -0.815617).  Saving model ...
Epoch: 12 cost time: 1.7040214538574219
Epoch: 12, Steps: 8 | Train Loss: 0.687 Vali Loss: 0.734 Vali Acc: 0.816 Test Loss: 0.734 Test Acc: 0.816
Validation loss decreased (-0.815617 --> -0.815618).  Saving model ...
Epoch: 13 cost time: 1.670426607131958
Epoch: 13, Steps: 8 | Train Loss: 0.557 Vali Loss: 0.681 Vali Acc: 0.822 Test Loss: 0.681 Test Acc: 0.822
Validation loss decreased (-0.815618 --> -0.821868).  Saving model ...
Epoch: 14 cost time: 1.6456549167633057
Epoch: 14, Steps: 8 | Train Loss: 0.470 Vali Loss: 0.658 Vali Acc: 0.825 Test Loss: 0.658 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824993).  Saving model ...
Epoch: 15 cost time: 1.6253087520599365
Epoch: 15, Steps: 8 | Train Loss: 0.471 Vali Loss: 0.630 Vali Acc: 0.834 Test Loss: 0.630 Test Acc: 0.834
Validation loss decreased (-0.824993 --> -0.834369).  Saving model ...
Epoch: 16 cost time: 1.699899673461914
Epoch: 16, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.599 Vali Acc: 0.834 Test Loss: 0.599 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834369).  Saving model ...
Epoch: 17 cost time: 1.620215892791748
Epoch: 17, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843744).  Saving model ...
Epoch: 18 cost time: 1.4984896183013916
Epoch: 18, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.579 Vali Acc: 0.831 Test Loss: 0.579 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9228942394256592
Epoch: 19, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 1.9109210968017578
Epoch: 20, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7250006198883057
Epoch: 21, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.527 Vali Acc: 0.847 Test Loss: 0.527 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6896946430206299
Epoch: 22, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9845662117004395
Epoch: 23, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6580657958984375
Epoch: 24, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 1.7228331565856934
Epoch: 25, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.512 Vali Acc: 0.853 Test Loss: 0.512 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 26 cost time: 1.5324928760528564
Epoch: 26, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6152667999267578
Epoch: 27, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7777738571166992
Epoch: 28, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7747876644134521
Epoch: 29, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 30 cost time: 1.8290724754333496
Epoch: 30, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.503 Vali Acc: 0.853 Test Loss: 0.503 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7458937168121338
Epoch: 31, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.491 Vali Acc: 0.847 Test Loss: 0.491 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.821498155593872
Epoch: 32, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9682424068450928
Epoch: 33, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.807610034942627
Epoch: 34, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 35 cost time: 1.6461052894592285
Epoch: 35, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.481 Vali Acc: 0.853 Test Loss: 0.481 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7623519897460938
Epoch: 36, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.532505750656128
Epoch: 37, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.826138973236084
Epoch: 38, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.5971648693084717
Epoch: 39, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 40 cost time: 1.6614632606506348
Epoch: 40, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 41 cost time: 1.8558990955352783
Epoch: 41, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.0473198890686035
Epoch: 42, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.465 Vali Acc: 0.863 Test Loss: 0.465 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 43 cost time: 2.2457072734832764
Epoch: 43, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.456 Vali Acc: 0.859 Test Loss: 0.456 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.1618428230285645
Epoch: 44, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.8909587860107422
Epoch: 45, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.471 Vali Acc: 0.863 Test Loss: 0.471 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.9061951637268066
Epoch: 46, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.456 Vali Acc: 0.856 Test Loss: 0.456 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.6325881481170654
Epoch: 47, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.221043825149536
Epoch: 48, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.449 Vali Acc: 0.859 Test Loss: 0.449 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.6497747898101807
Epoch: 49, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.466 Vali Acc: 0.856 Test Loss: 0.466 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.9389314651489258
Epoch: 50, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.471 Vali Acc: 0.863 Test Loss: 0.471 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 2.2049686908721924
Epoch: 51, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.465 Vali Acc: 0.872 Test Loss: 0.465 Test Acc: 0.872
Validation loss decreased (-0.862495 --> -0.871870).  Saving model ...
Epoch: 52 cost time: 1.7944624423980713
Epoch: 52, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.461 Vali Acc: 0.872 Test Loss: 0.461 Test Acc: 0.872
Validation loss decreased (-0.871870 --> -0.871870).  Saving model ...
Epoch: 53 cost time: 1.6912755966186523
Epoch: 53, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.455 Vali Acc: 0.869 Test Loss: 0.455 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.7547004222869873
Epoch: 54, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.462 Vali Acc: 0.863 Test Loss: 0.462 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.6376705169677734
Epoch: 55, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.445 Vali Acc: 0.869 Test Loss: 0.445 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.4278512001037598
Epoch: 56, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.461 Vali Acc: 0.866 Test Loss: 0.461 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.5559663772583008
Epoch: 57, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.471 Vali Acc: 0.863 Test Loss: 0.471 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.4760894775390625
Epoch: 58, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.465 Vali Acc: 0.869 Test Loss: 0.465 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.5558900833129883
Epoch: 59, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.460 Vali Acc: 0.856 Test Loss: 0.460 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.6345083713531494
Epoch: 60, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.472 Vali Acc: 0.863 Test Loss: 0.472 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.8268170356750488
Epoch: 61, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.489 Vali Acc: 0.863 Test Loss: 0.489 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.8626799583435059
Epoch: 62, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.453 Vali Acc: 0.872 Test Loss: 0.453 Test Acc: 0.872
Validation loss decreased (-0.871870 --> -0.871870).  Saving model ...
Epoch: 63 cost time: 2.1420023441314697
Epoch: 63, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.465 Vali Acc: 0.872 Test Loss: 0.465 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.783696174621582
Epoch: 64, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.469 Vali Acc: 0.872 Test Loss: 0.469 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.871736764907837
Epoch: 65, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.484 Vali Acc: 0.869 Test Loss: 0.484 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.7546992301940918
Epoch: 66, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.480 Vali Acc: 0.866 Test Loss: 0.480 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.6489572525024414
Epoch: 67, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.466 Vali Acc: 0.869 Test Loss: 0.466 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.8847248554229736
Epoch: 68, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.460 Vali Acc: 0.863 Test Loss: 0.460 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.4555110931396484
Epoch: 69, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.478 Vali Acc: 0.872 Test Loss: 0.478 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 2.020547389984131
Epoch: 70, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874995).  Saving model ...
Epoch: 71 cost time: 1.7413883209228516
Epoch: 71, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.462 Vali Acc: 0.878 Test Loss: 0.462 Test Acc: 0.878
Validation loss decreased (-0.874995 --> -0.878120).  Saving model ...
Epoch: 72 cost time: 1.5553948879241943
Epoch: 72, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.486 Vali Acc: 0.872 Test Loss: 0.486 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.623063087463379
Epoch: 73, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.502 Vali Acc: 0.866 Test Loss: 0.502 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.9009275436401367
Epoch: 74, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.469 Vali Acc: 0.869 Test Loss: 0.469 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.498426914215088
Epoch: 75, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.8349277973175049
Epoch: 76, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.484 Vali Acc: 0.869 Test Loss: 0.484 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.6021406650543213
Epoch: 77, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.475 Vali Acc: 0.866 Test Loss: 0.475 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.726461410522461
Epoch: 78, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 1.6251020431518555
Epoch: 79, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.478 Vali Acc: 0.872 Test Loss: 0.478 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 2.118561029434204
Epoch: 80, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.482 Vali Acc: 0.869 Test Loss: 0.482 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 1.6578660011291504
Epoch: 81, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.479 Vali Acc: 0.872 Test Loss: 0.479 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 764676
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8035171031951904
Epoch: 1, Steps: 8 | Train Loss: 2.252 Vali Loss: 2.166 Vali Acc: 0.131 Test Loss: 2.166 Test Acc: 0.131
Validation loss decreased (inf --> -0.131228).  Saving model ...
Epoch: 2 cost time: 2.151087999343872
Epoch: 2, Steps: 8 | Train Loss: 2.096 Vali Loss: 2.051 Vali Acc: 0.156 Test Loss: 2.051 Test Acc: 0.156
Validation loss decreased (-0.131228 --> -0.156229).  Saving model ...
Epoch: 3 cost time: 2.7364137172698975
Epoch: 3, Steps: 8 | Train Loss: 2.014 Vali Loss: 1.999 Vali Acc: 0.237 Test Loss: 1.999 Test Acc: 0.237
Validation loss decreased (-0.156229 --> -0.237480).  Saving model ...
Epoch: 4 cost time: 1.8298377990722656
Epoch: 4, Steps: 8 | Train Loss: 1.989 Vali Loss: 1.930 Vali Acc: 0.341 Test Loss: 1.930 Test Acc: 0.341
Validation loss decreased (-0.237480 --> -0.340606).  Saving model ...
Epoch: 5 cost time: 1.952976942062378
Epoch: 5, Steps: 8 | Train Loss: 1.888 Vali Loss: 1.795 Vali Acc: 0.528 Test Loss: 1.795 Test Acc: 0.528
Validation loss decreased (-0.340606 --> -0.528107).  Saving model ...
Epoch: 6 cost time: 1.8977067470550537
Epoch: 6, Steps: 8 | Train Loss: 1.779 Vali Loss: 1.600 Vali Acc: 0.641 Test Loss: 1.600 Test Acc: 0.641
Validation loss decreased (-0.528107 --> -0.640609).  Saving model ...
Epoch: 7 cost time: 1.9220635890960693
Epoch: 7, Steps: 8 | Train Loss: 1.509 Vali Loss: 1.396 Vali Acc: 0.713 Test Loss: 1.396 Test Acc: 0.713
Validation loss decreased (-0.640609 --> -0.712486).  Saving model ...
Epoch: 8 cost time: 2.5736703872680664
Epoch: 8, Steps: 8 | Train Loss: 1.320 Vali Loss: 1.227 Vali Acc: 0.731 Test Loss: 1.227 Test Acc: 0.731
Validation loss decreased (-0.712486 --> -0.731238).  Saving model ...
Epoch: 9 cost time: 2.1462597846984863
Epoch: 9, Steps: 8 | Train Loss: 1.154 Vali Loss: 1.090 Vali Acc: 0.753 Test Loss: 1.090 Test Acc: 0.753
Validation loss decreased (-0.731238 --> -0.753114).  Saving model ...
Epoch: 10 cost time: 1.947134256362915
Epoch: 10, Steps: 8 | Train Loss: 0.988 Vali Loss: 0.983 Vali Acc: 0.766 Test Loss: 0.983 Test Acc: 0.766
Validation loss decreased (-0.753114 --> -0.765615).  Saving model ...
Epoch: 11 cost time: 2.0534236431121826
Epoch: 11, Steps: 8 | Train Loss: 0.862 Vali Loss: 0.889 Vali Acc: 0.778 Test Loss: 0.889 Test Acc: 0.778
Validation loss decreased (-0.765615 --> -0.778116).  Saving model ...
Epoch: 12 cost time: 2.069093704223633
Epoch: 12, Steps: 8 | Train Loss: 0.723 Vali Loss: 0.816 Vali Acc: 0.803 Test Loss: 0.816 Test Acc: 0.803
Validation loss decreased (-0.778116 --> -0.803117).  Saving model ...
Epoch: 13 cost time: 2.0984208583831787
Epoch: 13, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.761 Vali Acc: 0.812 Test Loss: 0.761 Test Acc: 0.812
Validation loss decreased (-0.803117 --> -0.812492).  Saving model ...
Epoch: 14 cost time: 1.970012903213501
Epoch: 14, Steps: 8 | Train Loss: 0.580 Vali Loss: 0.719 Vali Acc: 0.806 Test Loss: 0.719 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8163304328918457
Epoch: 15, Steps: 8 | Train Loss: 0.532 Vali Loss: 0.681 Vali Acc: 0.822 Test Loss: 0.681 Test Acc: 0.822
Validation loss decreased (-0.812492 --> -0.821868).  Saving model ...
Epoch: 16 cost time: 2.2719578742980957
Epoch: 16, Steps: 8 | Train Loss: 0.493 Vali Loss: 0.661 Vali Acc: 0.828 Test Loss: 0.661 Test Acc: 0.828
Validation loss decreased (-0.821868 --> -0.828118).  Saving model ...
Epoch: 17 cost time: 2.147751808166504
Epoch: 17, Steps: 8 | Train Loss: 0.470 Vali Loss: 0.634 Vali Acc: 0.825 Test Loss: 0.634 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4862492084503174
Epoch: 18, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
Validation loss decreased (-0.828118 --> -0.843744).  Saving model ...
Epoch: 19 cost time: 2.0449025630950928
Epoch: 19, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.586 Vali Acc: 0.831 Test Loss: 0.586 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.051069498062134
Epoch: 20, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.581 Vali Acc: 0.834 Test Loss: 0.581 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5135858058929443
Epoch: 21, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.562 Vali Acc: 0.838 Test Loss: 0.562 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.101269006729126
Epoch: 22, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3572373390197754
Epoch: 23, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
Validation loss decreased (-0.843744 --> -0.856245).  Saving model ...
Epoch: 24 cost time: 2.1874852180480957
Epoch: 24, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9666614532470703
Epoch: 25, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.530 Vali Acc: 0.838 Test Loss: 0.530 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9562036991119385
Epoch: 26, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1346654891967773
Epoch: 27, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.505970001220703
Epoch: 28, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.187026262283325
Epoch: 29, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.531 Vali Acc: 0.831 Test Loss: 0.531 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8363094329833984
Epoch: 30, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.501 Vali Acc: 0.838 Test Loss: 0.501 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.3447635173797607
Epoch: 31, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8200297355651855
Epoch: 32, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.1406075954437256
Epoch: 33, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 470148
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.165071964263916
Epoch: 1, Steps: 8 | Train Loss: 2.381 Vali Loss: 2.263 Vali Acc: 0.141 Test Loss: 2.263 Test Acc: 0.141
Validation loss decreased (inf --> -0.140602).  Saving model ...
Epoch: 2 cost time: 2.005629539489746
Epoch: 2, Steps: 8 | Train Loss: 2.145 Vali Loss: 2.050 Vali Acc: 0.203 Test Loss: 2.050 Test Acc: 0.203
Validation loss decreased (-0.140602 --> -0.203104).  Saving model ...
Epoch: 3 cost time: 2.0978317260742188
Epoch: 3, Steps: 8 | Train Loss: 2.007 Vali Loss: 1.963 Vali Acc: 0.331 Test Loss: 1.963 Test Acc: 0.331
Validation loss decreased (-0.203104 --> -0.331230).  Saving model ...
Epoch: 4 cost time: 2.138012409210205
Epoch: 4, Steps: 8 | Train Loss: 1.966 Vali Loss: 1.851 Vali Acc: 0.441 Test Loss: 1.851 Test Acc: 0.441
Validation loss decreased (-0.331230 --> -0.440606).  Saving model ...
Epoch: 5 cost time: 1.5439860820770264
Epoch: 5, Steps: 8 | Train Loss: 1.788 Vali Loss: 1.697 Vali Acc: 0.472 Test Loss: 1.697 Test Acc: 0.472
Validation loss decreased (-0.440606 --> -0.471858).  Saving model ...
Epoch: 6 cost time: 1.8309597969055176
Epoch: 6, Steps: 8 | Train Loss: 1.672 Vali Loss: 1.525 Vali Acc: 0.603 Test Loss: 1.525 Test Acc: 0.603
Validation loss decreased (-0.471858 --> -0.603110).  Saving model ...
Epoch: 7 cost time: 1.782435655593872
Epoch: 7, Steps: 8 | Train Loss: 1.419 Vali Loss: 1.366 Vali Acc: 0.634 Test Loss: 1.366 Test Acc: 0.634
Validation loss decreased (-0.603110 --> -0.634361).  Saving model ...
Epoch: 8 cost time: 2.013728380203247
Epoch: 8, Steps: 8 | Train Loss: 1.204 Vali Loss: 1.221 Vali Acc: 0.647 Test Loss: 1.221 Test Acc: 0.647
Validation loss decreased (-0.634361 --> -0.646863).  Saving model ...
Epoch: 9 cost time: 1.9163126945495605
Epoch: 9, Steps: 8 | Train Loss: 1.112 Vali Loss: 1.090 Vali Acc: 0.706 Test Loss: 1.090 Test Acc: 0.706
Validation loss decreased (-0.646863 --> -0.706239).  Saving model ...
Epoch: 10 cost time: 1.5328798294067383
Epoch: 10, Steps: 8 | Train Loss: 0.929 Vali Loss: 0.989 Vali Acc: 0.725 Test Loss: 0.989 Test Acc: 0.725
Validation loss decreased (-0.706239 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 1.6623809337615967
Epoch: 11, Steps: 8 | Train Loss: 0.877 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 1.3633232116699219
Epoch: 12, Steps: 8 | Train Loss: 0.744 Vali Loss: 0.835 Vali Acc: 0.756 Test Loss: 0.835 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.756242).  Saving model ...
Epoch: 13 cost time: 2.2127068042755127
Epoch: 13, Steps: 8 | Train Loss: 0.666 Vali Loss: 0.767 Vali Acc: 0.797 Test Loss: 0.767 Test Acc: 0.797
Validation loss decreased (-0.756242 --> -0.796867).  Saving model ...
Epoch: 14 cost time: 2.5388262271881104
Epoch: 14, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.735 Vali Acc: 0.797 Test Loss: 0.735 Test Acc: 0.797
Validation loss decreased (-0.796867 --> -0.796868).  Saving model ...
Epoch: 15 cost time: 1.9023826122283936
Epoch: 15, Steps: 8 | Train Loss: 0.522 Vali Loss: 0.709 Vali Acc: 0.791 Test Loss: 0.709 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0258119106292725
Epoch: 16, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.676 Vali Acc: 0.797 Test Loss: 0.676 Test Acc: 0.797
Validation loss decreased (-0.796868 --> -0.796868).  Saving model ...
Epoch: 17 cost time: 1.8859233856201172
Epoch: 17, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.663 Vali Acc: 0.809 Test Loss: 0.663 Test Acc: 0.809
Validation loss decreased (-0.796868 --> -0.809368).  Saving model ...
Epoch: 18 cost time: 1.7644691467285156
Epoch: 18, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.633 Vali Acc: 0.816 Test Loss: 0.633 Test Acc: 0.816
Validation loss decreased (-0.809368 --> -0.815619).  Saving model ...
Epoch: 19 cost time: 2.128143548965454
Epoch: 19, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.630 Vali Acc: 0.812 Test Loss: 0.630 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8619320392608643
Epoch: 20, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.610 Vali Acc: 0.812 Test Loss: 0.610 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0418484210968018
Epoch: 21, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.608 Vali Acc: 0.803 Test Loss: 0.608 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7284104824066162
Epoch: 22, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.603 Vali Acc: 0.809 Test Loss: 0.603 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9703083038330078
Epoch: 23, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8089110851287842
Epoch: 24, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.608 Vali Acc: 0.819 Test Loss: 0.608 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 25 cost time: 1.988826036453247
Epoch: 25, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 26 cost time: 2.676562547683716
Epoch: 26, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.559 Vali Acc: 0.816 Test Loss: 0.559 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0574746131896973
Epoch: 27, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 28 cost time: 2.006289482116699
Epoch: 28, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.562 Vali Acc: 0.812 Test Loss: 0.562 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.872269630432129
Epoch: 29, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.561 Vali Acc: 0.831 Test Loss: 0.561 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 30 cost time: 2.1776697635650635
Epoch: 30, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.054328203201294
Epoch: 31, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8774561882019043
Epoch: 32, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.129819393157959
Epoch: 33, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.98370361328125
Epoch: 34, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.869258165359497
Epoch: 35, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.387793779373169
Epoch: 36, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.7059707641601562
Epoch: 37, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.29121470451355
Epoch: 38, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.560 Vali Acc: 0.816 Test Loss: 0.560 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.1341919898986816
Epoch: 39, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 468484
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.151872158050537
Epoch: 1, Steps: 8 | Train Loss: 2.217 Vali Loss: 2.175 Vali Acc: 0.113 Test Loss: 2.175 Test Acc: 0.113
Validation loss decreased (inf --> -0.112478).  Saving model ...
Epoch: 2 cost time: 1.9560573101043701
Epoch: 2, Steps: 8 | Train Loss: 2.154 Vali Loss: 2.084 Vali Acc: 0.119 Test Loss: 2.084 Test Acc: 0.119
Validation loss decreased (-0.112478 --> -0.118729).  Saving model ...
Epoch: 3 cost time: 2.2525501251220703
Epoch: 3, Steps: 8 | Train Loss: 2.105 Vali Loss: 2.030 Vali Acc: 0.150 Test Loss: 2.030 Test Acc: 0.150
Validation loss decreased (-0.118729 --> -0.149980).  Saving model ...
Epoch: 4 cost time: 2.104870080947876
Epoch: 4, Steps: 8 | Train Loss: 2.003 Vali Loss: 1.930 Vali Acc: 0.384 Test Loss: 1.930 Test Acc: 0.384
Validation loss decreased (-0.149980 --> -0.384356).  Saving model ...
Epoch: 5 cost time: 2.083691120147705
Epoch: 5, Steps: 8 | Train Loss: 1.868 Vali Loss: 1.802 Vali Acc: 0.556 Test Loss: 1.802 Test Acc: 0.556
Validation loss decreased (-0.384356 --> -0.556232).  Saving model ...
Epoch: 6 cost time: 1.9906337261199951
Epoch: 6, Steps: 8 | Train Loss: 1.781 Vali Loss: 1.646 Vali Acc: 0.584 Test Loss: 1.646 Test Acc: 0.584
Validation loss decreased (-0.556232 --> -0.584359).  Saving model ...
Epoch: 7 cost time: 1.6881413459777832
Epoch: 7, Steps: 8 | Train Loss: 1.606 Vali Loss: 1.466 Vali Acc: 0.666 Test Loss: 1.466 Test Acc: 0.666
Validation loss decreased (-0.584359 --> -0.665610).  Saving model ...
Epoch: 8 cost time: 1.8366034030914307
Epoch: 8, Steps: 8 | Train Loss: 1.401 Vali Loss: 1.297 Vali Acc: 0.722 Test Loss: 1.297 Test Acc: 0.722
Validation loss decreased (-0.665610 --> -0.721862).  Saving model ...
Epoch: 9 cost time: 1.4427223205566406
Epoch: 9, Steps: 8 | Train Loss: 1.225 Vali Loss: 1.149 Vali Acc: 0.744 Test Loss: 1.149 Test Acc: 0.744
Validation loss decreased (-0.721862 --> -0.743739).  Saving model ...
Epoch: 10 cost time: 2.1289024353027344
Epoch: 10, Steps: 8 | Train Loss: 1.036 Vali Loss: 1.025 Vali Acc: 0.756 Test Loss: 1.025 Test Acc: 0.756
Validation loss decreased (-0.743739 --> -0.756240).  Saving model ...
Epoch: 11 cost time: 1.7209360599517822
Epoch: 11, Steps: 8 | Train Loss: 0.900 Vali Loss: 0.931 Vali Acc: 0.775 Test Loss: 0.931 Test Acc: 0.775
Validation loss decreased (-0.756240 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 2.1050119400024414
Epoch: 12, Steps: 8 | Train Loss: 0.847 Vali Loss: 0.842 Vali Acc: 0.787 Test Loss: 0.842 Test Acc: 0.787
Validation loss decreased (-0.774991 --> -0.787492).  Saving model ...
Epoch: 13 cost time: 1.9995439052581787
Epoch: 13, Steps: 8 | Train Loss: 0.713 Vali Loss: 0.786 Vali Acc: 0.787 Test Loss: 0.786 Test Acc: 0.787
Validation loss decreased (-0.787492 --> -0.787492).  Saving model ...
Epoch: 14 cost time: 1.7550175189971924
Epoch: 14, Steps: 8 | Train Loss: 0.667 Vali Loss: 0.745 Vali Acc: 0.791 Test Loss: 0.745 Test Acc: 0.791
Validation loss decreased (-0.787492 --> -0.790618).  Saving model ...
Epoch: 15 cost time: 2.1291699409484863
Epoch: 15, Steps: 8 | Train Loss: 0.573 Vali Loss: 0.702 Vali Acc: 0.797 Test Loss: 0.702 Test Acc: 0.797
Validation loss decreased (-0.790618 --> -0.796868).  Saving model ...
Epoch: 16 cost time: 2.298858404159546
Epoch: 16, Steps: 8 | Train Loss: 0.500 Vali Loss: 0.661 Vali Acc: 0.822 Test Loss: 0.661 Test Acc: 0.822
Validation loss decreased (-0.796868 --> -0.821868).  Saving model ...
Epoch: 17 cost time: 1.9321320056915283
Epoch: 17, Steps: 8 | Train Loss: 0.454 Vali Loss: 0.648 Vali Acc: 0.825 Test Loss: 0.648 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824994).  Saving model ...
Epoch: 18 cost time: 1.7351973056793213
Epoch: 18, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.614 Vali Acc: 0.828 Test Loss: 0.614 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 19 cost time: 2.0269863605499268
Epoch: 19, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.594 Vali Acc: 0.831 Test Loss: 0.594 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 20 cost time: 1.6900131702423096
Epoch: 20, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0375454425811768
Epoch: 21, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.569 Vali Acc: 0.838 Test Loss: 0.569 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 22 cost time: 2.7553696632385254
Epoch: 22, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.562 Vali Acc: 0.838 Test Loss: 0.562 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837494).  Saving model ...
Epoch: 23 cost time: 1.799536943435669
Epoch: 23, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5304253101348877
Epoch: 24, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846870).  Saving model ...
Epoch: 25 cost time: 1.8991615772247314
Epoch: 25, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9096894264221191
Epoch: 26, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.525 Vali Acc: 0.838 Test Loss: 0.525 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.100342273712158
Epoch: 27, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8757140636444092
Epoch: 28, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.037025213241577
Epoch: 29, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.552262306213379
Epoch: 30, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.468278169631958
Epoch: 31, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.506 Vali Acc: 0.834 Test Loss: 0.506 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.139678716659546
Epoch: 32, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.490 Vali Acc: 0.831 Test Loss: 0.490 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.1264474391937256
Epoch: 33, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.473 Vali Acc: 0.838 Test Loss: 0.473 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.286998748779297
Epoch: 34, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.491 Vali Acc: 0.822 Test Loss: 0.491 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 466820
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4964873790740967
Epoch: 1, Steps: 8 | Train Loss: 2.182 Vali Loss: 2.141 Vali Acc: 0.134 Test Loss: 2.141 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 1.4106903076171875
Epoch: 2, Steps: 8 | Train Loss: 2.180 Vali Loss: 2.050 Vali Acc: 0.281 Test Loss: 2.050 Test Acc: 0.281
Validation loss decreased (-0.134354 --> -0.281230).  Saving model ...
Epoch: 3 cost time: 1.5424258708953857
Epoch: 3, Steps: 8 | Train Loss: 2.074 Vali Loss: 1.972 Vali Acc: 0.278 Test Loss: 1.972 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8314282894134521
Epoch: 4, Steps: 8 | Train Loss: 1.965 Vali Loss: 1.886 Vali Acc: 0.366 Test Loss: 1.886 Test Acc: 0.366
Validation loss decreased (-0.281230 --> -0.365606).  Saving model ...
Epoch: 5 cost time: 1.6147091388702393
Epoch: 5, Steps: 8 | Train Loss: 1.881 Vali Loss: 1.769 Vali Acc: 0.478 Test Loss: 1.769 Test Acc: 0.478
Validation loss decreased (-0.365606 --> -0.478107).  Saving model ...
Epoch: 6 cost time: 1.4699537754058838
Epoch: 6, Steps: 8 | Train Loss: 1.746 Vali Loss: 1.598 Vali Acc: 0.606 Test Loss: 1.598 Test Acc: 0.606
Validation loss decreased (-0.478107 --> -0.606234).  Saving model ...
Epoch: 7 cost time: 1.3822126388549805
Epoch: 7, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.425 Vali Acc: 0.713 Test Loss: 1.425 Test Acc: 0.713
Validation loss decreased (-0.606234 --> -0.712486).  Saving model ...
Epoch: 8 cost time: 1.597846508026123
Epoch: 8, Steps: 8 | Train Loss: 1.385 Vali Loss: 1.257 Vali Acc: 0.734 Test Loss: 1.257 Test Acc: 0.734
Validation loss decreased (-0.712486 --> -0.734362).  Saving model ...
Epoch: 9 cost time: 1.756648063659668
Epoch: 9, Steps: 8 | Train Loss: 1.169 Vali Loss: 1.099 Vali Acc: 0.784 Test Loss: 1.099 Test Acc: 0.784
Validation loss decreased (-0.734362 --> -0.784364).  Saving model ...
Epoch: 10 cost time: 1.5425446033477783
Epoch: 10, Steps: 8 | Train Loss: 1.021 Vali Loss: 0.963 Vali Acc: 0.819 Test Loss: 0.963 Test Acc: 0.819
Validation loss decreased (-0.784364 --> -0.818740).  Saving model ...
Epoch: 11 cost time: 1.4511117935180664
Epoch: 11, Steps: 8 | Train Loss: 0.920 Vali Loss: 0.877 Vali Acc: 0.800 Test Loss: 0.877 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7540068626403809
Epoch: 12, Steps: 8 | Train Loss: 0.785 Vali Loss: 0.775 Vali Acc: 0.828 Test Loss: 0.775 Test Acc: 0.828
Validation loss decreased (-0.818740 --> -0.828117).  Saving model ...
Epoch: 13 cost time: 1.6090338230133057
Epoch: 13, Steps: 8 | Train Loss: 0.667 Vali Loss: 0.709 Vali Acc: 0.831 Test Loss: 0.709 Test Acc: 0.831
Validation loss decreased (-0.828117 --> -0.831243).  Saving model ...
Epoch: 14 cost time: 1.8095331192016602
Epoch: 14, Steps: 8 | Train Loss: 0.569 Vali Loss: 0.657 Vali Acc: 0.847 Test Loss: 0.657 Test Acc: 0.847
Validation loss decreased (-0.831243 --> -0.846868).  Saving model ...
Epoch: 15 cost time: 1.693760633468628
Epoch: 15, Steps: 8 | Train Loss: 0.515 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6994900703430176
Epoch: 16, Steps: 8 | Train Loss: 0.459 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
Validation loss decreased (-0.846868 --> -0.856244).  Saving model ...
Epoch: 17 cost time: 1.548870325088501
Epoch: 17, Steps: 8 | Train Loss: 0.466 Vali Loss: 0.551 Vali Acc: 0.869 Test Loss: 0.551 Test Acc: 0.869
Validation loss decreased (-0.856244 --> -0.868744).  Saving model ...
Epoch: 18 cost time: 1.815354347229004
Epoch: 18, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.532 Vali Acc: 0.866 Test Loss: 0.532 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.641571044921875
Epoch: 19, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.515 Vali Acc: 0.856 Test Loss: 0.515 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3909101486206055
Epoch: 20, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7524495124816895
Epoch: 21, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.502 Vali Acc: 0.872 Test Loss: 0.502 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871870).  Saving model ...
Epoch: 22 cost time: 1.9218113422393799
Epoch: 22, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 1.7513396739959717
Epoch: 23, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.482 Vali Acc: 0.866 Test Loss: 0.482 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7774431705474854
Epoch: 24, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.479 Vali Acc: 0.859 Test Loss: 0.479 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9399528503417969
Epoch: 25, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.462 Vali Acc: 0.869 Test Loss: 0.462 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.1366758346557617
Epoch: 26, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.464 Vali Acc: 0.869 Test Loss: 0.464 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7948479652404785
Epoch: 27, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 1.3636250495910645
Epoch: 28, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 29 cost time: 1.387315034866333
Epoch: 29, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.445 Vali Acc: 0.859 Test Loss: 0.445 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7610647678375244
Epoch: 30, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.445 Vali Acc: 0.872 Test Loss: 0.445 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.017812490463257
Epoch: 31, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.443 Vali Acc: 0.869 Test Loss: 0.443 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.773977518081665
Epoch: 32, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.427 Vali Acc: 0.881 Test Loss: 0.427 Test Acc: 0.881
Validation loss decreased (-0.874996 --> -0.881246).  Saving model ...
Epoch: 33 cost time: 1.4305267333984375
Epoch: 33, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.430 Vali Acc: 0.881 Test Loss: 0.430 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.437650203704834
Epoch: 34, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.422 Vali Acc: 0.869 Test Loss: 0.422 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6852917671203613
Epoch: 35, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.436 Vali Acc: 0.863 Test Loss: 0.436 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.9905657768249512
Epoch: 36, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.428 Vali Acc: 0.869 Test Loss: 0.428 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.150897741317749
Epoch: 37, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.431 Vali Acc: 0.866 Test Loss: 0.431 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.463245153427124
Epoch: 38, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.435 Vali Acc: 0.869 Test Loss: 0.435 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.0252153873443604
Epoch: 39, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.428 Vali Acc: 0.878 Test Loss: 0.428 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.8699300289154053
Epoch: 40, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.428 Vali Acc: 0.878 Test Loss: 0.428 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.837609052658081
Epoch: 41, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.5674853324890137
Epoch: 42, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 465156
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7110023498535156
Epoch: 1, Steps: 8 | Train Loss: 2.220 Vali Loss: 2.164 Vali Acc: 0.084 Test Loss: 2.164 Test Acc: 0.084
Validation loss decreased (inf --> -0.084353).  Saving model ...
Epoch: 2 cost time: 2.01112699508667
Epoch: 2, Steps: 8 | Train Loss: 2.121 Vali Loss: 2.096 Vali Acc: 0.184 Test Loss: 2.096 Test Acc: 0.184
Validation loss decreased (-0.084353 --> -0.184354).  Saving model ...
Epoch: 3 cost time: 2.0424067974090576
Epoch: 3, Steps: 8 | Train Loss: 2.065 Vali Loss: 2.050 Vali Acc: 0.241 Test Loss: 2.050 Test Acc: 0.241
Validation loss decreased (-0.184354 --> -0.240605).  Saving model ...
Epoch: 4 cost time: 1.8449733257293701
Epoch: 4, Steps: 8 | Train Loss: 2.095 Vali Loss: 1.990 Vali Acc: 0.344 Test Loss: 1.990 Test Acc: 0.344
Validation loss decreased (-0.240605 --> -0.343730).  Saving model ...
Epoch: 5 cost time: 1.9187066555023193
Epoch: 5, Steps: 8 | Train Loss: 1.976 Vali Loss: 1.920 Vali Acc: 0.438 Test Loss: 1.920 Test Acc: 0.438
Validation loss decreased (-0.343730 --> -0.437481).  Saving model ...
Epoch: 6 cost time: 1.9654030799865723
Epoch: 6, Steps: 8 | Train Loss: 1.887 Vali Loss: 1.834 Vali Acc: 0.475 Test Loss: 1.834 Test Acc: 0.475
Validation loss decreased (-0.437481 --> -0.474982).  Saving model ...
Epoch: 7 cost time: 2.474769115447998
Epoch: 7, Steps: 8 | Train Loss: 1.803 Vali Loss: 1.719 Vali Acc: 0.622 Test Loss: 1.719 Test Acc: 0.622
Validation loss decreased (-0.474982 --> -0.621858).  Saving model ...
Epoch: 8 cost time: 2.2704765796661377
Epoch: 8, Steps: 8 | Train Loss: 1.687 Vali Loss: 1.581 Vali Acc: 0.662 Test Loss: 1.581 Test Acc: 0.662
Validation loss decreased (-0.621858 --> -0.662484).  Saving model ...
Epoch: 9 cost time: 1.9234051704406738
Epoch: 9, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.431 Vali Acc: 0.688 Test Loss: 1.431 Test Acc: 0.688
Validation loss decreased (-0.662484 --> -0.687486).  Saving model ...
Epoch: 10 cost time: 2.2790164947509766
Epoch: 10, Steps: 8 | Train Loss: 1.348 Vali Loss: 1.284 Vali Acc: 0.719 Test Loss: 1.284 Test Acc: 0.719
Validation loss decreased (-0.687486 --> -0.718737).  Saving model ...
Epoch: 11 cost time: 1.7464649677276611
Epoch: 11, Steps: 8 | Train Loss: 1.157 Vali Loss: 1.143 Vali Acc: 0.759 Test Loss: 1.143 Test Acc: 0.759
Validation loss decreased (-0.718737 --> -0.759364).  Saving model ...
Epoch: 12 cost time: 1.8690900802612305
Epoch: 12, Steps: 8 | Train Loss: 1.036 Vali Loss: 1.022 Vali Acc: 0.762 Test Loss: 1.022 Test Acc: 0.762
Validation loss decreased (-0.759364 --> -0.762490).  Saving model ...
Epoch: 13 cost time: 1.725841760635376
Epoch: 13, Steps: 8 | Train Loss: 0.879 Vali Loss: 0.919 Vali Acc: 0.787 Test Loss: 0.919 Test Acc: 0.787
Validation loss decreased (-0.762490 --> -0.787491).  Saving model ...
Epoch: 14 cost time: 1.8797523975372314
Epoch: 14, Steps: 8 | Train Loss: 0.780 Vali Loss: 0.831 Vali Acc: 0.803 Test Loss: 0.831 Test Acc: 0.803
Validation loss decreased (-0.787491 --> -0.803117).  Saving model ...
Epoch: 15 cost time: 1.8678197860717773
Epoch: 15, Steps: 8 | Train Loss: 0.716 Vali Loss: 0.774 Vali Acc: 0.797 Test Loss: 0.774 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8015997409820557
Epoch: 16, Steps: 8 | Train Loss: 0.644 Vali Loss: 0.718 Vali Acc: 0.819 Test Loss: 0.718 Test Acc: 0.819
Validation loss decreased (-0.803117 --> -0.818743).  Saving model ...
Epoch: 17 cost time: 2.0837926864624023
Epoch: 17, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.678 Vali Acc: 0.834 Test Loss: 0.678 Test Acc: 0.834
Validation loss decreased (-0.818743 --> -0.834368).  Saving model ...
Epoch: 18 cost time: 2.2118265628814697
Epoch: 18, Steps: 8 | Train Loss: 0.509 Vali Loss: 0.647 Vali Acc: 0.844 Test Loss: 0.647 Test Acc: 0.844
Validation loss decreased (-0.834368 --> -0.843744).  Saving model ...
Epoch: 19 cost time: 2.2693350315093994
Epoch: 19, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.623 Vali Acc: 0.841 Test Loss: 0.623 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9924919605255127
Epoch: 20, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.593 Vali Acc: 0.847 Test Loss: 0.593 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846869).  Saving model ...
Epoch: 21 cost time: 2.152775764465332
Epoch: 21, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.580 Vali Acc: 0.847 Test Loss: 0.580 Test Acc: 0.847
Validation loss decreased (-0.846869 --> -0.846869).  Saving model ...
Epoch: 22 cost time: 1.971278190612793
Epoch: 22, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 1.818159818649292
Epoch: 23, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.382878303527832
Epoch: 24, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.533 Vali Acc: 0.847 Test Loss: 0.533 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8936166763305664
Epoch: 25, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8924267292022705
Epoch: 26, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4546196460723877
Epoch: 27, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.2570672035217285
Epoch: 28, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7818481922149658
Epoch: 29, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 1.869612693786621
Epoch: 30, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8379106521606445
Epoch: 31, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.2508292198181152
Epoch: 32, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.487 Vali Acc: 0.838 Test Loss: 0.487 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9472620487213135
Epoch: 33, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.489 Vali Acc: 0.834 Test Loss: 0.489 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.286309242248535
Epoch: 34, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.493 Vali Acc: 0.834 Test Loss: 0.493 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.024263381958008
Epoch: 35, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.491 Vali Acc: 0.831 Test Loss: 0.491 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.0563015937805176
Epoch: 36, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.7394826412200928
Epoch: 37, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.486 Vali Acc: 0.838 Test Loss: 0.486 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.3319146633148193
Epoch: 38, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.489 Vali Acc: 0.838 Test Loss: 0.489 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.349529981613159
Epoch: 39, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.472 Vali Acc: 0.847 Test Loss: 0.472 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 320388
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.063782453536987
Epoch: 1, Steps: 8 | Train Loss: 2.166 Vali Loss: 2.086 Vali Acc: 0.219 Test Loss: 2.086 Test Acc: 0.219
Validation loss decreased (inf --> -0.218729).  Saving model ...
Epoch: 2 cost time: 1.6582210063934326
Epoch: 2, Steps: 8 | Train Loss: 2.124 Vali Loss: 2.024 Vali Acc: 0.222 Test Loss: 2.024 Test Acc: 0.222
Validation loss decreased (-0.218729 --> -0.221855).  Saving model ...
Epoch: 3 cost time: 1.782766342163086
Epoch: 3, Steps: 8 | Train Loss: 2.043 Vali Loss: 1.971 Vali Acc: 0.366 Test Loss: 1.971 Test Acc: 0.366
Validation loss decreased (-0.221855 --> -0.365605).  Saving model ...
Epoch: 4 cost time: 1.560192584991455
Epoch: 4, Steps: 8 | Train Loss: 1.990 Vali Loss: 1.906 Vali Acc: 0.487 Test Loss: 1.906 Test Acc: 0.487
Validation loss decreased (-0.365605 --> -0.487481).  Saving model ...
Epoch: 5 cost time: 1.6199476718902588
Epoch: 5, Steps: 8 | Train Loss: 1.927 Vali Loss: 1.821 Vali Acc: 0.447 Test Loss: 1.821 Test Acc: 0.447
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0383799076080322
Epoch: 6, Steps: 8 | Train Loss: 1.843 Vali Loss: 1.705 Vali Acc: 0.603 Test Loss: 1.705 Test Acc: 0.603
Validation loss decreased (-0.487481 --> -0.603108).  Saving model ...
Epoch: 7 cost time: 1.7796680927276611
Epoch: 7, Steps: 8 | Train Loss: 1.712 Vali Loss: 1.569 Vali Acc: 0.672 Test Loss: 1.569 Test Acc: 0.672
Validation loss decreased (-0.603108 --> -0.671859).  Saving model ...
Epoch: 8 cost time: 1.6452653408050537
Epoch: 8, Steps: 8 | Train Loss: 1.519 Vali Loss: 1.428 Vali Acc: 0.697 Test Loss: 1.428 Test Acc: 0.697
Validation loss decreased (-0.671859 --> -0.696861).  Saving model ...
Epoch: 9 cost time: 1.6493384838104248
Epoch: 9, Steps: 8 | Train Loss: 1.411 Vali Loss: 1.282 Vali Acc: 0.750 Test Loss: 1.282 Test Acc: 0.750
Validation loss decreased (-0.696861 --> -0.749987).  Saving model ...
Epoch: 10 cost time: 1.6045773029327393
Epoch: 10, Steps: 8 | Train Loss: 1.201 Vali Loss: 1.152 Vali Acc: 0.747 Test Loss: 1.152 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2510793209075928
Epoch: 11, Steps: 8 | Train Loss: 1.088 Vali Loss: 1.027 Vali Acc: 0.769 Test Loss: 1.027 Test Acc: 0.769
Validation loss decreased (-0.749987 --> -0.768740).  Saving model ...
Epoch: 12 cost time: 1.4848999977111816
Epoch: 12, Steps: 8 | Train Loss: 0.947 Vali Loss: 0.924 Vali Acc: 0.787 Test Loss: 0.924 Test Acc: 0.787
Validation loss decreased (-0.768740 --> -0.787491).  Saving model ...
Epoch: 13 cost time: 1.8938634395599365
Epoch: 13, Steps: 8 | Train Loss: 0.806 Vali Loss: 0.846 Vali Acc: 0.787 Test Loss: 0.846 Test Acc: 0.787
Validation loss decreased (-0.787491 --> -0.787492).  Saving model ...
Epoch: 14 cost time: 1.9526703357696533
Epoch: 14, Steps: 8 | Train Loss: 0.740 Vali Loss: 0.788 Vali Acc: 0.800 Test Loss: 0.788 Test Acc: 0.800
Validation loss decreased (-0.787492 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 1.7852725982666016
Epoch: 15, Steps: 8 | Train Loss: 0.666 Vali Loss: 0.735 Vali Acc: 0.812 Test Loss: 0.735 Test Acc: 0.812
Validation loss decreased (-0.799992 --> -0.812493).  Saving model ...
Epoch: 16 cost time: 2.0016753673553467
Epoch: 16, Steps: 8 | Train Loss: 0.582 Vali Loss: 0.691 Vali Acc: 0.809 Test Loss: 0.691 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7744677066802979
Epoch: 17, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.661 Vali Acc: 0.831 Test Loss: 0.661 Test Acc: 0.831
Validation loss decreased (-0.812493 --> -0.831243).  Saving model ...
Epoch: 18 cost time: 1.8571500778198242
Epoch: 18, Steps: 8 | Train Loss: 0.472 Vali Loss: 0.647 Vali Acc: 0.812 Test Loss: 0.647 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5859737396240234
Epoch: 19, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.627 Vali Acc: 0.816 Test Loss: 0.627 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6714801788330078
Epoch: 20, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.597790241241455
Epoch: 21, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.594 Vali Acc: 0.831 Test Loss: 0.594 Test Acc: 0.831
Validation loss decreased (-0.831243 --> -0.831244).  Saving model ...
Epoch: 22 cost time: 2.1813085079193115
Epoch: 22, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.165665864944458
Epoch: 23, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.553 Vali Acc: 0.838 Test Loss: 0.553 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 24 cost time: 2.401960849761963
Epoch: 24, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.566 Vali Acc: 0.812 Test Loss: 0.566 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6762030124664307
Epoch: 25, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.196967363357544
Epoch: 26, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6756176948547363
Epoch: 27, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.6849515438079834
Epoch: 28, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.538 Vali Acc: 0.831 Test Loss: 0.538 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.1401546001434326
Epoch: 29, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.1265056133270264
Epoch: 30, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.523 Vali Acc: 0.825 Test Loss: 0.523 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.7469301223754883
Epoch: 31, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.5380470752716064
Epoch: 32, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.1015207767486572
Epoch: 33, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.509 Vali Acc: 0.828 Test Loss: 0.509 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 318724
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.022396564483643
Epoch: 1, Steps: 8 | Train Loss: 2.160 Vali Loss: 2.085 Vali Acc: 0.131 Test Loss: 2.085 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 1.9577391147613525
Epoch: 2, Steps: 8 | Train Loss: 2.074 Vali Loss: 2.002 Vali Acc: 0.209 Test Loss: 2.002 Test Acc: 0.209
Validation loss decreased (-0.131229 --> -0.209355).  Saving model ...
Epoch: 3 cost time: 2.020132541656494
Epoch: 3, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.935 Vali Acc: 0.328 Test Loss: 1.935 Test Acc: 0.328
Validation loss decreased (-0.209355 --> -0.328106).  Saving model ...
Epoch: 4 cost time: 2.3251380920410156
Epoch: 4, Steps: 8 | Train Loss: 1.960 Vali Loss: 1.849 Vali Acc: 0.403 Test Loss: 1.849 Test Acc: 0.403
Validation loss decreased (-0.328106 --> -0.403107).  Saving model ...
Epoch: 5 cost time: 2.0297720432281494
Epoch: 5, Steps: 8 | Train Loss: 1.886 Vali Loss: 1.747 Vali Acc: 0.528 Test Loss: 1.747 Test Acc: 0.528
Validation loss decreased (-0.403107 --> -0.528108).  Saving model ...
Epoch: 6 cost time: 1.6064164638519287
Epoch: 6, Steps: 8 | Train Loss: 1.720 Vali Loss: 1.604 Vali Acc: 0.594 Test Loss: 1.604 Test Acc: 0.594
Validation loss decreased (-0.528108 --> -0.593734).  Saving model ...
Epoch: 7 cost time: 1.5170669555664062
Epoch: 7, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.464 Vali Acc: 0.656 Test Loss: 1.464 Test Acc: 0.656
Validation loss decreased (-0.593734 --> -0.656235).  Saving model ...
Epoch: 8 cost time: 1.8947467803955078
Epoch: 8, Steps: 8 | Train Loss: 1.429 Vali Loss: 1.322 Vali Acc: 0.691 Test Loss: 1.322 Test Acc: 0.691
Validation loss decreased (-0.656235 --> -0.690612).  Saving model ...
Epoch: 9 cost time: 1.8670201301574707
Epoch: 9, Steps: 8 | Train Loss: 1.250 Vali Loss: 1.191 Vali Acc: 0.756 Test Loss: 1.191 Test Acc: 0.756
Validation loss decreased (-0.690612 --> -0.756238).  Saving model ...
Epoch: 10 cost time: 1.8038012981414795
Epoch: 10, Steps: 8 | Train Loss: 1.119 Vali Loss: 1.060 Vali Acc: 0.781 Test Loss: 1.060 Test Acc: 0.781
Validation loss decreased (-0.756238 --> -0.781239).  Saving model ...
Epoch: 11 cost time: 1.9970285892486572
Epoch: 11, Steps: 8 | Train Loss: 0.969 Vali Loss: 0.960 Vali Acc: 0.778 Test Loss: 0.960 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6789755821228027
Epoch: 12, Steps: 8 | Train Loss: 0.817 Vali Loss: 0.876 Vali Acc: 0.806 Test Loss: 0.876 Test Acc: 0.806
Validation loss decreased (-0.781239 --> -0.806241).  Saving model ...
Epoch: 13 cost time: 2.1046929359436035
Epoch: 13, Steps: 8 | Train Loss: 0.761 Vali Loss: 0.808 Vali Acc: 0.819 Test Loss: 0.808 Test Acc: 0.819
Validation loss decreased (-0.806241 --> -0.818742).  Saving model ...
Epoch: 14 cost time: 1.9526007175445557
Epoch: 14, Steps: 8 | Train Loss: 0.671 Vali Loss: 0.746 Vali Acc: 0.819 Test Loss: 0.746 Test Acc: 0.819
Validation loss decreased (-0.818742 --> -0.818743).  Saving model ...
Epoch: 15 cost time: 1.8745286464691162
Epoch: 15, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.704 Vali Acc: 0.816 Test Loss: 0.704 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0291507244110107
Epoch: 16, Steps: 8 | Train Loss: 0.571 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
Validation loss decreased (-0.818743 --> -0.818743).  Saving model ...
Epoch: 17 cost time: 1.99159574508667
Epoch: 17, Steps: 8 | Train Loss: 0.492 Vali Loss: 0.635 Vali Acc: 0.828 Test Loss: 0.635 Test Acc: 0.828
Validation loss decreased (-0.818743 --> -0.828119).  Saving model ...
Epoch: 18 cost time: 1.7305209636688232
Epoch: 18, Steps: 8 | Train Loss: 0.475 Vali Loss: 0.610 Vali Acc: 0.834 Test Loss: 0.610 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 19 cost time: 2.069416046142578
Epoch: 19, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.603 Vali Acc: 0.838 Test Loss: 0.603 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 20 cost time: 2.168651580810547
Epoch: 20, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.584 Vali Acc: 0.834 Test Loss: 0.584 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3423054218292236
Epoch: 21, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837494).  Saving model ...
Epoch: 22 cost time: 2.0196216106414795
Epoch: 22, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.569 Vali Acc: 0.844 Test Loss: 0.569 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843744).  Saving model ...
Epoch: 23 cost time: 2.26431941986084
Epoch: 23, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.548 Vali Acc: 0.847 Test Loss: 0.548 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 24 cost time: 1.732475996017456
Epoch: 24, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9014341831207275
Epoch: 25, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 26 cost time: 1.8445565700531006
Epoch: 26, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.533 Vali Acc: 0.847 Test Loss: 0.533 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 27 cost time: 2.27121639251709
Epoch: 27, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9584782123565674
Epoch: 28, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.3549888134002686
Epoch: 29, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8328657150268555
Epoch: 30, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7950711250305176
Epoch: 31, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.0796937942504883
Epoch: 32, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.087290048599243
Epoch: 33, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.378291606903076
Epoch: 34, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 35 cost time: 1.7228062152862549
Epoch: 35, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 36 cost time: 1.8211421966552734
Epoch: 36, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.946385145187378
Epoch: 37, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6014924049377441
Epoch: 38, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.510 Vali Acc: 0.853 Test Loss: 0.510 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.8186769485473633
Epoch: 39, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.579153537750244
Epoch: 40, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.496 Vali Acc: 0.834 Test Loss: 0.496 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.8547468185424805
Epoch: 41, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.490 Vali Acc: 0.863 Test Loss: 0.490 Test Acc: 0.863
Validation loss decreased (-0.856245 --> -0.862495).  Saving model ...
Epoch: 42 cost time: 2.067384958267212
Epoch: 42, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.0071420669555664
Epoch: 43, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.485 Vali Acc: 0.859 Test Loss: 0.485 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.6229100227355957
Epoch: 44, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.491 Vali Acc: 0.838 Test Loss: 0.491 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.9895591735839844
Epoch: 45, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.7492642402648926
Epoch: 46, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.483 Vali Acc: 0.853 Test Loss: 0.483 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.7822000980377197
Epoch: 47, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.7183752059936523
Epoch: 48, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.489 Vali Acc: 0.856 Test Loss: 0.489 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.4682235717773438
Epoch: 49, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.05389404296875
Epoch: 50, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.266444683074951
Epoch: 51, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 317060
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.319593906402588
Epoch: 1, Steps: 8 | Train Loss: 2.107 Vali Loss: 2.051 Vali Acc: 0.225 Test Loss: 2.051 Test Acc: 0.225
Validation loss decreased (inf --> -0.224979).  Saving model ...
Epoch: 2 cost time: 2.9172065258026123
Epoch: 2, Steps: 8 | Train Loss: 2.046 Vali Loss: 1.986 Vali Acc: 0.175 Test Loss: 1.986 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.180492401123047
Epoch: 3, Steps: 8 | Train Loss: 1.979 Vali Loss: 1.918 Vali Acc: 0.331 Test Loss: 1.918 Test Acc: 0.331
Validation loss decreased (-0.224979 --> -0.331231).  Saving model ...
Epoch: 4 cost time: 1.9374737739562988
Epoch: 4, Steps: 8 | Train Loss: 1.949 Vali Loss: 1.832 Vali Acc: 0.425 Test Loss: 1.832 Test Acc: 0.425
Validation loss decreased (-0.331231 --> -0.424982).  Saving model ...
Epoch: 5 cost time: 2.1541340351104736
Epoch: 5, Steps: 8 | Train Loss: 1.855 Vali Loss: 1.721 Vali Acc: 0.541 Test Loss: 1.721 Test Acc: 0.541
Validation loss decreased (-0.424982 --> -0.540608).  Saving model ...
Epoch: 6 cost time: 2.079622745513916
Epoch: 6, Steps: 8 | Train Loss: 1.713 Vali Loss: 1.593 Vali Acc: 0.572 Test Loss: 1.593 Test Acc: 0.572
Validation loss decreased (-0.540608 --> -0.571859).  Saving model ...
Epoch: 7 cost time: 1.8805792331695557
Epoch: 7, Steps: 8 | Train Loss: 1.584 Vali Loss: 1.469 Vali Acc: 0.625 Test Loss: 1.469 Test Acc: 0.625
Validation loss decreased (-0.571859 --> -0.624985).  Saving model ...
Epoch: 8 cost time: 1.6378216743469238
Epoch: 8, Steps: 8 | Train Loss: 1.421 Vali Loss: 1.325 Vali Acc: 0.694 Test Loss: 1.325 Test Acc: 0.694
Validation loss decreased (-0.624985 --> -0.693737).  Saving model ...
Epoch: 9 cost time: 1.8959951400756836
Epoch: 9, Steps: 8 | Train Loss: 1.283 Vali Loss: 1.202 Vali Acc: 0.769 Test Loss: 1.202 Test Acc: 0.769
Validation loss decreased (-0.693737 --> -0.768738).  Saving model ...
Epoch: 10 cost time: 1.8759105205535889
Epoch: 10, Steps: 8 | Train Loss: 1.110 Vali Loss: 1.101 Vali Acc: 0.784 Test Loss: 1.101 Test Acc: 0.784
Validation loss decreased (-0.768738 --> -0.784364).  Saving model ...
Epoch: 11 cost time: 2.3649790287017822
Epoch: 11, Steps: 8 | Train Loss: 1.041 Vali Loss: 0.998 Vali Acc: 0.806 Test Loss: 0.998 Test Acc: 0.806
Validation loss decreased (-0.784364 --> -0.806240).  Saving model ...
Epoch: 12 cost time: 1.947605848312378
Epoch: 12, Steps: 8 | Train Loss: 0.936 Vali Loss: 0.921 Vali Acc: 0.787 Test Loss: 0.921 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.320030450820923
Epoch: 13, Steps: 8 | Train Loss: 0.818 Vali Loss: 0.853 Vali Acc: 0.803 Test Loss: 0.853 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2007997035980225
Epoch: 14, Steps: 8 | Train Loss: 0.720 Vali Loss: 0.795 Vali Acc: 0.822 Test Loss: 0.795 Test Acc: 0.822
Validation loss decreased (-0.806240 --> -0.821867).  Saving model ...
Epoch: 15 cost time: 1.9486885070800781
Epoch: 15, Steps: 8 | Train Loss: 0.653 Vali Loss: 0.754 Vali Acc: 0.803 Test Loss: 0.754 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4478111267089844
Epoch: 16, Steps: 8 | Train Loss: 0.603 Vali Loss: 0.710 Vali Acc: 0.803 Test Loss: 0.710 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.126523733139038
Epoch: 17, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.680 Vali Acc: 0.816 Test Loss: 0.680 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5078396797180176
Epoch: 18, Steps: 8 | Train Loss: 0.488 Vali Loss: 0.648 Vali Acc: 0.819 Test Loss: 0.648 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0190482139587402
Epoch: 19, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.621 Vali Acc: 0.841 Test Loss: 0.621 Test Acc: 0.841
Validation loss decreased (-0.821867 --> -0.840619).  Saving model ...
Epoch: 20 cost time: 2.2032127380371094
Epoch: 20, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1564507484436035
Epoch: 21, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.602 Vali Acc: 0.819 Test Loss: 0.602 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8054871559143066
Epoch: 22, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.595 Vali Acc: 0.828 Test Loss: 0.595 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.985342025756836
Epoch: 23, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.578 Vali Acc: 0.828 Test Loss: 0.578 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.6036036014556885
Epoch: 24, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.560 Vali Acc: 0.834 Test Loss: 0.560 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.047255754470825
Epoch: 25, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840619).  Saving model ...
Epoch: 26 cost time: 2.0837323665618896
Epoch: 26, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.550 Vali Acc: 0.828 Test Loss: 0.550 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0196142196655273
Epoch: 27, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9225685596466064
Epoch: 28, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.2115492820739746
Epoch: 29, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.529 Vali Acc: 0.834 Test Loss: 0.529 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1050524711608887
Epoch: 30, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8130228519439697
Epoch: 31, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.2278218269348145
Epoch: 32, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.151010274887085
Epoch: 33, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.513 Vali Acc: 0.834 Test Loss: 0.513 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.283499002456665
Epoch: 34, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840620).  Saving model ...
Epoch: 35 cost time: 2.054454803466797
Epoch: 35, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.523 Vali Acc: 0.828 Test Loss: 0.523 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.422539710998535
Epoch: 36, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.501 Vali Acc: 0.831 Test Loss: 0.501 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.0487473011016846
Epoch: 37, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.491 Vali Acc: 0.838 Test Loss: 0.491 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.8841383457183838
Epoch: 38, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.1657302379608154
Epoch: 39, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 40 cost time: 2.321640968322754
Epoch: 40, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9539320468902588
Epoch: 41, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.511 Vali Acc: 0.831 Test Loss: 0.511 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.1922848224639893
Epoch: 42, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.166578769683838
Epoch: 43, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.068657875061035
Epoch: 44, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.487 Vali Acc: 0.831 Test Loss: 0.487 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.972970724105835
Epoch: 45, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.492 Vali Acc: 0.828 Test Loss: 0.492 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.1092636585235596
Epoch: 46, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.502 Vali Acc: 0.831 Test Loss: 0.502 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.6812009811401367
Epoch: 47, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.495 Vali Acc: 0.831 Test Loss: 0.495 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.776707649230957
Epoch: 48, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.495 Vali Acc: 0.828 Test Loss: 0.495 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.9173212051391602
Epoch: 49, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.502 Vali Acc: 0.831 Test Loss: 0.502 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 315396
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.355152606964111
Epoch: 1, Steps: 8 | Train Loss: 2.233 Vali Loss: 2.168 Vali Acc: 0.106 Test Loss: 2.168 Test Acc: 0.106
Validation loss decreased (inf --> -0.106228).  Saving model ...
Epoch: 2 cost time: 2.1672637462615967
Epoch: 2, Steps: 8 | Train Loss: 2.141 Vali Loss: 2.092 Vali Acc: 0.166 Test Loss: 2.092 Test Acc: 0.166
Validation loss decreased (-0.106228 --> -0.165604).  Saving model ...
Epoch: 3 cost time: 2.0961577892303467
Epoch: 3, Steps: 8 | Train Loss: 2.133 Vali Loss: 2.057 Vali Acc: 0.269 Test Loss: 2.057 Test Acc: 0.269
Validation loss decreased (-0.165604 --> -0.268729).  Saving model ...
Epoch: 4 cost time: 1.9075334072113037
Epoch: 4, Steps: 8 | Train Loss: 2.085 Vali Loss: 2.003 Vali Acc: 0.253 Test Loss: 2.003 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.941728115081787
Epoch: 5, Steps: 8 | Train Loss: 1.976 Vali Loss: 1.947 Vali Acc: 0.328 Test Loss: 1.947 Test Acc: 0.328
Validation loss decreased (-0.268729 --> -0.328106).  Saving model ...
Epoch: 6 cost time: 1.970841646194458
Epoch: 6, Steps: 8 | Train Loss: 1.961 Vali Loss: 1.877 Vali Acc: 0.459 Test Loss: 1.877 Test Acc: 0.459
Validation loss decreased (-0.328106 --> -0.459356).  Saving model ...
Epoch: 7 cost time: 1.966888427734375
Epoch: 7, Steps: 8 | Train Loss: 1.863 Vali Loss: 1.776 Vali Acc: 0.466 Test Loss: 1.776 Test Acc: 0.466
Validation loss decreased (-0.459356 --> -0.465607).  Saving model ...
Epoch: 8 cost time: 1.6582300662994385
Epoch: 8, Steps: 8 | Train Loss: 1.784 Vali Loss: 1.645 Vali Acc: 0.528 Test Loss: 1.645 Test Acc: 0.528
Validation loss decreased (-0.465607 --> -0.528109).  Saving model ...
Epoch: 9 cost time: 2.207542657852173
Epoch: 9, Steps: 8 | Train Loss: 1.610 Vali Loss: 1.495 Vali Acc: 0.609 Test Loss: 1.495 Test Acc: 0.609
Validation loss decreased (-0.528109 --> -0.609360).  Saving model ...
Epoch: 10 cost time: 1.9390184879302979
Epoch: 10, Steps: 8 | Train Loss: 1.418 Vali Loss: 1.352 Vali Acc: 0.688 Test Loss: 1.352 Test Acc: 0.688
Validation loss decreased (-0.609360 --> -0.687486).  Saving model ...
Epoch: 11 cost time: 1.6997337341308594
Epoch: 11, Steps: 8 | Train Loss: 1.279 Vali Loss: 1.217 Vali Acc: 0.709 Test Loss: 1.217 Test Acc: 0.709
Validation loss decreased (-0.687486 --> -0.709363).  Saving model ...
Epoch: 12 cost time: 2.002584457397461
Epoch: 12, Steps: 8 | Train Loss: 1.135 Vali Loss: 1.105 Vali Acc: 0.728 Test Loss: 1.105 Test Acc: 0.728
Validation loss decreased (-0.709363 --> -0.728114).  Saving model ...
Epoch: 13 cost time: 2.0096278190612793
Epoch: 13, Steps: 8 | Train Loss: 0.988 Vali Loss: 1.016 Vali Acc: 0.750 Test Loss: 1.016 Test Acc: 0.750
Validation loss decreased (-0.728114 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 1.8883280754089355
Epoch: 14, Steps: 8 | Train Loss: 0.893 Vali Loss: 0.937 Vali Acc: 0.753 Test Loss: 0.937 Test Acc: 0.753
Validation loss decreased (-0.749990 --> -0.753116).  Saving model ...
Epoch: 15 cost time: 1.6338820457458496
Epoch: 15, Steps: 8 | Train Loss: 0.794 Vali Loss: 0.872 Vali Acc: 0.772 Test Loss: 0.872 Test Acc: 0.772
Validation loss decreased (-0.753116 --> -0.771866).  Saving model ...
Epoch: 16 cost time: 2.1815412044525146
Epoch: 16, Steps: 8 | Train Loss: 0.733 Vali Loss: 0.813 Vali Acc: 0.759 Test Loss: 0.813 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1983749866485596
Epoch: 17, Steps: 8 | Train Loss: 0.656 Vali Loss: 0.778 Vali Acc: 0.775 Test Loss: 0.778 Test Acc: 0.775
Validation loss decreased (-0.771866 --> -0.774992).  Saving model ...
Epoch: 18 cost time: 1.7896134853363037
Epoch: 18, Steps: 8 | Train Loss: 0.570 Vali Loss: 0.734 Vali Acc: 0.781 Test Loss: 0.734 Test Acc: 0.781
Validation loss decreased (-0.774992 --> -0.781243).  Saving model ...
Epoch: 19 cost time: 1.9644527435302734
Epoch: 19, Steps: 8 | Train Loss: 0.557 Vali Loss: 0.696 Vali Acc: 0.800 Test Loss: 0.696 Test Acc: 0.800
Validation loss decreased (-0.781243 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 1.899918794631958
Epoch: 20, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.680 Vali Acc: 0.787 Test Loss: 0.680 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.042442560195923
Epoch: 21, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.652 Vali Acc: 0.794 Test Loss: 0.652 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6371197700500488
Epoch: 22, Steps: 8 | Train Loss: 0.419 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
Validation loss decreased (-0.799993 --> -0.809369).  Saving model ...
Epoch: 23 cost time: 2.0689480304718018
Epoch: 23, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.615 Vali Acc: 0.809 Test Loss: 0.615 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 24 cost time: 2.1358084678649902
Epoch: 24, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.617 Vali Acc: 0.806 Test Loss: 0.617 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7881152629852295
Epoch: 25, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.962437391281128
Epoch: 26, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.594 Vali Acc: 0.816 Test Loss: 0.594 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 27 cost time: 1.8278710842132568
Epoch: 27, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.584 Vali Acc: 0.825 Test Loss: 0.584 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824994).  Saving model ...
Epoch: 28 cost time: 2.1427738666534424
Epoch: 28, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.6354849338531494
Epoch: 29, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.868821620941162
Epoch: 30, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.575 Vali Acc: 0.816 Test Loss: 0.575 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.84450101852417
Epoch: 31, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.757476806640625
Epoch: 32, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 33 cost time: 1.9713716506958008
Epoch: 33, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828120).  Saving model ...
Epoch: 34 cost time: 1.6839048862457275
Epoch: 34, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.451303243637085
Epoch: 35, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.5931808948516846
Epoch: 36, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.5818939208984375
Epoch: 37, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.777496099472046
Epoch: 38, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.6408400535583496
Epoch: 39, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.543 Vali Acc: 0.831 Test Loss: 0.543 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 40 cost time: 1.754338264465332
Epoch: 40, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 41 cost time: 2.0916013717651367
Epoch: 41, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.0831685066223145
Epoch: 42, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.554 Vali Acc: 0.816 Test Loss: 0.554 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.6601331233978271
Epoch: 43, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.9578213691711426
Epoch: 44, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 45 cost time: 2.228394031524658
Epoch: 45, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.7191944122314453
Epoch: 46, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.680419683456421
Epoch: 47, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.530 Vali Acc: 0.828 Test Loss: 0.530 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.6512205600738525
Epoch: 48, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.1645030975341797
Epoch: 49, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.378202199935913
Epoch: 50, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.0350663661956787
Epoch: 51, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.7905406951904297
Epoch: 52, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.032700300216675
Epoch: 53, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.3853955268859863
Epoch: 54, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 245508
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.443614482879639
Epoch: 1, Steps: 8 | Train Loss: 2.344 Vali Loss: 2.264 Vali Acc: 0.125 Test Loss: 2.264 Test Acc: 0.125
Validation loss decreased (inf --> -0.124977).  Saving model ...
Epoch: 2 cost time: 1.4887621402740479
Epoch: 2, Steps: 8 | Train Loss: 2.239 Vali Loss: 2.125 Vali Acc: 0.087 Test Loss: 2.125 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2571568489074707
Epoch: 3, Steps: 8 | Train Loss: 2.093 Vali Loss: 2.022 Vali Acc: 0.184 Test Loss: 2.022 Test Acc: 0.184
Validation loss decreased (-0.124977 --> -0.184355).  Saving model ...
Epoch: 4 cost time: 1.7471823692321777
Epoch: 4, Steps: 8 | Train Loss: 2.065 Vali Loss: 1.973 Vali Acc: 0.244 Test Loss: 1.973 Test Acc: 0.244
Validation loss decreased (-0.184355 --> -0.243730).  Saving model ...
Epoch: 5 cost time: 1.8721282482147217
Epoch: 5, Steps: 8 | Train Loss: 2.027 Vali Loss: 1.903 Vali Acc: 0.381 Test Loss: 1.903 Test Acc: 0.381
Validation loss decreased (-0.243730 --> -0.381231).  Saving model ...
Epoch: 6 cost time: 1.8757686614990234
Epoch: 6, Steps: 8 | Train Loss: 1.900 Vali Loss: 1.809 Vali Acc: 0.509 Test Loss: 1.809 Test Acc: 0.509
Validation loss decreased (-0.381231 --> -0.509357).  Saving model ...
Epoch: 7 cost time: 1.7609996795654297
Epoch: 7, Steps: 8 | Train Loss: 1.868 Vali Loss: 1.688 Vali Acc: 0.588 Test Loss: 1.688 Test Acc: 0.588
Validation loss decreased (-0.509357 --> -0.587483).  Saving model ...
Epoch: 8 cost time: 2.0880696773529053
Epoch: 8, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.538 Vali Acc: 0.666 Test Loss: 1.538 Test Acc: 0.666
Validation loss decreased (-0.587483 --> -0.665610).  Saving model ...
Epoch: 9 cost time: 1.8432703018188477
Epoch: 9, Steps: 8 | Train Loss: 1.565 Vali Loss: 1.381 Vali Acc: 0.688 Test Loss: 1.381 Test Acc: 0.688
Validation loss decreased (-0.665610 --> -0.687486).  Saving model ...
Epoch: 10 cost time: 1.5169761180877686
Epoch: 10, Steps: 8 | Train Loss: 1.369 Vali Loss: 1.243 Vali Acc: 0.728 Test Loss: 1.243 Test Acc: 0.728
Validation loss decreased (-0.687486 --> -0.728113).  Saving model ...
Epoch: 11 cost time: 2.3969790935516357
Epoch: 11, Steps: 8 | Train Loss: 1.213 Vali Loss: 1.119 Vali Acc: 0.744 Test Loss: 1.119 Test Acc: 0.744
Validation loss decreased (-0.728113 --> -0.743739).  Saving model ...
Epoch: 12 cost time: 1.7150983810424805
Epoch: 12, Steps: 8 | Train Loss: 1.072 Vali Loss: 1.004 Vali Acc: 0.753 Test Loss: 1.004 Test Acc: 0.753
Validation loss decreased (-0.743739 --> -0.753115).  Saving model ...
Epoch: 13 cost time: 1.6588785648345947
Epoch: 13, Steps: 8 | Train Loss: 0.985 Vali Loss: 0.913 Vali Acc: 0.769 Test Loss: 0.913 Test Acc: 0.769
Validation loss decreased (-0.753115 --> -0.768741).  Saving model ...
Epoch: 14 cost time: 1.6281023025512695
Epoch: 14, Steps: 8 | Train Loss: 0.831 Vali Loss: 0.839 Vali Acc: 0.797 Test Loss: 0.839 Test Acc: 0.797
Validation loss decreased (-0.768741 --> -0.796867).  Saving model ...
Epoch: 15 cost time: 1.8753044605255127
Epoch: 15, Steps: 8 | Train Loss: 0.742 Vali Loss: 0.788 Vali Acc: 0.784 Test Loss: 0.788 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.006221294403076
Epoch: 16, Steps: 8 | Train Loss: 0.661 Vali Loss: 0.741 Vali Acc: 0.797 Test Loss: 0.741 Test Acc: 0.797
Validation loss decreased (-0.796867 --> -0.796868).  Saving model ...
Epoch: 17 cost time: 2.4283969402313232
Epoch: 17, Steps: 8 | Train Loss: 0.619 Vali Loss: 0.713 Vali Acc: 0.791 Test Loss: 0.713 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9164271354675293
Epoch: 18, Steps: 8 | Train Loss: 0.559 Vali Loss: 0.674 Vali Acc: 0.809 Test Loss: 0.674 Test Acc: 0.809
Validation loss decreased (-0.796868 --> -0.809368).  Saving model ...
Epoch: 19 cost time: 2.104161024093628
Epoch: 19, Steps: 8 | Train Loss: 0.549 Vali Loss: 0.642 Vali Acc: 0.819 Test Loss: 0.642 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818744).  Saving model ...
Epoch: 20 cost time: 2.004420280456543
Epoch: 20, Steps: 8 | Train Loss: 0.451 Vali Loss: 0.621 Vali Acc: 0.828 Test Loss: 0.621 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 21 cost time: 1.7992854118347168
Epoch: 21, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.710540533065796
Epoch: 22, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.590 Vali Acc: 0.828 Test Loss: 0.590 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 23 cost time: 1.754009485244751
Epoch: 23, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.568 Vali Acc: 0.834 Test Loss: 0.568 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 24 cost time: 1.7930147647857666
Epoch: 24, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.824141025543213
Epoch: 25, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.166991710662842
Epoch: 26, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9162101745605469
Epoch: 27, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 28 cost time: 1.965184211730957
Epoch: 28, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.137359857559204
Epoch: 29, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.521 Vali Acc: 0.819 Test Loss: 0.521 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9140377044677734
Epoch: 30, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.513 Vali Acc: 0.822 Test Loss: 0.513 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.67734694480896
Epoch: 31, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 32 cost time: 1.7578802108764648
Epoch: 32, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6026930809020996
Epoch: 33, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9885940551757812
Epoch: 34, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.880530595779419
Epoch: 35, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.605419397354126
Epoch: 36, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.7702085971832275
Epoch: 37, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 38 cost time: 1.6140871047973633
Epoch: 38, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.602712869644165
Epoch: 39, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 40 cost time: 1.623119831085205
Epoch: 40, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6775763034820557
Epoch: 41, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 42 cost time: 1.6339786052703857
Epoch: 42, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.094688653945923
Epoch: 43, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.7606980800628662
Epoch: 44, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4057395458221436
Epoch: 45, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.9346446990966797
Epoch: 46, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.849679946899414
Epoch: 47, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.7853314876556396
Epoch: 48, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.5435194969177246
Epoch: 49, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.5064418315887451
Epoch: 50, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.489 Vali Acc: 0.847 Test Loss: 0.489 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.7244329452514648
Epoch: 51, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 243844
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.898991823196411
Epoch: 1, Steps: 8 | Train Loss: 2.224 Vali Loss: 2.188 Vali Acc: 0.125 Test Loss: 2.188 Test Acc: 0.125
Validation loss decreased (inf --> -0.124978).  Saving model ...
Epoch: 2 cost time: 2.2682032585144043
Epoch: 2, Steps: 8 | Train Loss: 2.181 Vali Loss: 2.083 Vali Acc: 0.125 Test Loss: 2.083 Test Acc: 0.125
Validation loss decreased (-0.124978 --> -0.124979).  Saving model ...
Epoch: 3 cost time: 2.126507520675659
Epoch: 3, Steps: 8 | Train Loss: 2.049 Vali Loss: 2.013 Vali Acc: 0.209 Test Loss: 2.013 Test Acc: 0.209
Validation loss decreased (-0.124979 --> -0.209355).  Saving model ...
Epoch: 4 cost time: 1.632845401763916
Epoch: 4, Steps: 8 | Train Loss: 1.987 Vali Loss: 1.954 Vali Acc: 0.297 Test Loss: 1.954 Test Acc: 0.297
Validation loss decreased (-0.209355 --> -0.296855).  Saving model ...
Epoch: 5 cost time: 1.8075940608978271
Epoch: 5, Steps: 8 | Train Loss: 1.956 Vali Loss: 1.876 Vali Acc: 0.369 Test Loss: 1.876 Test Acc: 0.369
Validation loss decreased (-0.296855 --> -0.368731).  Saving model ...
Epoch: 6 cost time: 1.9493780136108398
Epoch: 6, Steps: 8 | Train Loss: 1.857 Vali Loss: 1.773 Vali Acc: 0.541 Test Loss: 1.773 Test Acc: 0.541
Validation loss decreased (-0.368731 --> -0.540607).  Saving model ...
Epoch: 7 cost time: 1.8927195072174072
Epoch: 7, Steps: 8 | Train Loss: 1.758 Vali Loss: 1.647 Vali Acc: 0.600 Test Loss: 1.647 Test Acc: 0.600
Validation loss decreased (-0.540607 --> -0.599984).  Saving model ...
Epoch: 8 cost time: 1.7655792236328125
Epoch: 8, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.491 Vali Acc: 0.662 Test Loss: 1.491 Test Acc: 0.662
Validation loss decreased (-0.599984 --> -0.662485).  Saving model ...
Epoch: 9 cost time: 1.956465721130371
Epoch: 9, Steps: 8 | Train Loss: 1.436 Vali Loss: 1.325 Vali Acc: 0.706 Test Loss: 1.325 Test Acc: 0.706
Validation loss decreased (-0.662485 --> -0.706237).  Saving model ...
Epoch: 10 cost time: 2.158269166946411
Epoch: 10, Steps: 8 | Train Loss: 1.295 Vali Loss: 1.172 Vali Acc: 0.731 Test Loss: 1.172 Test Acc: 0.731
Validation loss decreased (-0.706237 --> -0.731238).  Saving model ...
Epoch: 11 cost time: 2.0662245750427246
Epoch: 11, Steps: 8 | Train Loss: 1.081 Vali Loss: 1.050 Vali Acc: 0.750 Test Loss: 1.050 Test Acc: 0.750
Validation loss decreased (-0.731238 --> -0.749989).  Saving model ...
Epoch: 12 cost time: 1.674283742904663
Epoch: 12, Steps: 8 | Train Loss: 0.957 Vali Loss: 0.949 Vali Acc: 0.756 Test Loss: 0.949 Test Acc: 0.756
Validation loss decreased (-0.749989 --> -0.756241).  Saving model ...
Epoch: 13 cost time: 2.1981630325317383
Epoch: 13, Steps: 8 | Train Loss: 0.850 Vali Loss: 0.871 Vali Acc: 0.772 Test Loss: 0.871 Test Acc: 0.772
Validation loss decreased (-0.756241 --> -0.771866).  Saving model ...
Epoch: 14 cost time: 2.1418845653533936
Epoch: 14, Steps: 8 | Train Loss: 0.744 Vali Loss: 0.809 Vali Acc: 0.778 Test Loss: 0.809 Test Acc: 0.778
Validation loss decreased (-0.771866 --> -0.778117).  Saving model ...
Epoch: 15 cost time: 2.3849599361419678
Epoch: 15, Steps: 8 | Train Loss: 0.682 Vali Loss: 0.765 Vali Acc: 0.778 Test Loss: 0.765 Test Acc: 0.778
Validation loss decreased (-0.778117 --> -0.778117).  Saving model ...
Epoch: 16 cost time: 1.7198569774627686
Epoch: 16, Steps: 8 | Train Loss: 0.598 Vali Loss: 0.719 Vali Acc: 0.787 Test Loss: 0.719 Test Acc: 0.787
Validation loss decreased (-0.778117 --> -0.787493).  Saving model ...
Epoch: 17 cost time: 1.9838287830352783
Epoch: 17, Steps: 8 | Train Loss: 0.528 Vali Loss: 0.690 Vali Acc: 0.797 Test Loss: 0.690 Test Acc: 0.797
Validation loss decreased (-0.787493 --> -0.796868).  Saving model ...
Epoch: 18 cost time: 1.8103878498077393
Epoch: 18, Steps: 8 | Train Loss: 0.531 Vali Loss: 0.667 Vali Acc: 0.803 Test Loss: 0.667 Test Acc: 0.803
Validation loss decreased (-0.796868 --> -0.803118).  Saving model ...
Epoch: 19 cost time: 2.0760936737060547
Epoch: 19, Steps: 8 | Train Loss: 0.470 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
Validation loss decreased (-0.803118 --> -0.809369).  Saving model ...
Epoch: 20 cost time: 2.3631958961486816
Epoch: 20, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.632 Vali Acc: 0.806 Test Loss: 0.632 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1504194736480713
Epoch: 21, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.624 Vali Acc: 0.816 Test Loss: 0.624 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 22 cost time: 1.7254328727722168
Epoch: 22, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.605 Vali Acc: 0.816 Test Loss: 0.605 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 23 cost time: 2.1915462017059326
Epoch: 23, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.591 Vali Acc: 0.822 Test Loss: 0.591 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 24 cost time: 1.8231041431427002
Epoch: 24, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.799757242202759
Epoch: 25, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.380878448486328
Epoch: 26, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.568 Vali Acc: 0.828 Test Loss: 0.568 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 27 cost time: 2.162213087081909
Epoch: 27, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 28 cost time: 2.0904135704040527
Epoch: 28, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.6567575931549072
Epoch: 29, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9208407402038574
Epoch: 30, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.3380672931671143
Epoch: 31, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.5849318504333496
Epoch: 32, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.5030877590179443
Epoch: 33, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.326124668121338
Epoch: 34, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.1037518978118896
Epoch: 35, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.2678370475769043
Epoch: 36, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.541 Vali Acc: 0.816 Test Loss: 0.541 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.7849483489990234
Epoch: 37, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.529 Vali Acc: 0.825 Test Loss: 0.529 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 242180
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.062139272689819
Epoch: 1, Steps: 8 | Train Loss: 2.255 Vali Loss: 2.189 Vali Acc: 0.069 Test Loss: 2.189 Test Acc: 0.069
Validation loss decreased (inf --> -0.068728).  Saving model ...
Epoch: 2 cost time: 1.4887309074401855
Epoch: 2, Steps: 8 | Train Loss: 2.174 Vali Loss: 2.087 Vali Acc: 0.122 Test Loss: 2.087 Test Acc: 0.122
Validation loss decreased (-0.068728 --> -0.121854).  Saving model ...
Epoch: 3 cost time: 1.6603572368621826
Epoch: 3, Steps: 8 | Train Loss: 2.027 Vali Loss: 1.989 Vali Acc: 0.241 Test Loss: 1.989 Test Acc: 0.241
Validation loss decreased (-0.121854 --> -0.240605).  Saving model ...
Epoch: 4 cost time: 1.8073604106903076
Epoch: 4, Steps: 8 | Train Loss: 1.987 Vali Loss: 1.905 Vali Acc: 0.338 Test Loss: 1.905 Test Acc: 0.338
Validation loss decreased (-0.240605 --> -0.337481).  Saving model ...
Epoch: 5 cost time: 1.3955883979797363
Epoch: 5, Steps: 8 | Train Loss: 1.904 Vali Loss: 1.810 Vali Acc: 0.431 Test Loss: 1.810 Test Acc: 0.431
Validation loss decreased (-0.337481 --> -0.431232).  Saving model ...
Epoch: 6 cost time: 1.5083606243133545
Epoch: 6, Steps: 8 | Train Loss: 1.792 Vali Loss: 1.687 Vali Acc: 0.572 Test Loss: 1.687 Test Acc: 0.572
Validation loss decreased (-0.431232 --> -0.571858).  Saving model ...
Epoch: 7 cost time: 1.8477139472961426
Epoch: 7, Steps: 8 | Train Loss: 1.629 Vali Loss: 1.542 Vali Acc: 0.628 Test Loss: 1.542 Test Acc: 0.628
Validation loss decreased (-0.571858 --> -0.628110).  Saving model ...
Epoch: 8 cost time: 1.9566447734832764
Epoch: 8, Steps: 8 | Train Loss: 1.513 Vali Loss: 1.399 Vali Acc: 0.653 Test Loss: 1.399 Test Acc: 0.653
Validation loss decreased (-0.628110 --> -0.653111).  Saving model ...
Epoch: 9 cost time: 1.6598901748657227
Epoch: 9, Steps: 8 | Train Loss: 1.332 Vali Loss: 1.265 Vali Acc: 0.703 Test Loss: 1.265 Test Acc: 0.703
Validation loss decreased (-0.653111 --> -0.703112).  Saving model ...
Epoch: 10 cost time: 2.0885488986968994
Epoch: 10, Steps: 8 | Train Loss: 1.169 Vali Loss: 1.137 Vali Acc: 0.759 Test Loss: 1.137 Test Acc: 0.759
Validation loss decreased (-0.703112 --> -0.759364).  Saving model ...
Epoch: 11 cost time: 1.8091559410095215
Epoch: 11, Steps: 8 | Train Loss: 1.056 Vali Loss: 1.029 Vali Acc: 0.784 Test Loss: 1.029 Test Acc: 0.784
Validation loss decreased (-0.759364 --> -0.784365).  Saving model ...
Epoch: 12 cost time: 1.451324462890625
Epoch: 12, Steps: 8 | Train Loss: 0.910 Vali Loss: 0.937 Vali Acc: 0.794 Test Loss: 0.937 Test Acc: 0.794
Validation loss decreased (-0.784365 --> -0.793741).  Saving model ...
Epoch: 13 cost time: 2.167771100997925
Epoch: 13, Steps: 8 | Train Loss: 0.830 Vali Loss: 0.866 Vali Acc: 0.800 Test Loss: 0.866 Test Acc: 0.800
Validation loss decreased (-0.793741 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 1.9737098217010498
Epoch: 14, Steps: 8 | Train Loss: 0.732 Vali Loss: 0.800 Vali Acc: 0.791 Test Loss: 0.800 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.027301073074341
Epoch: 15, Steps: 8 | Train Loss: 0.651 Vali Loss: 0.752 Vali Acc: 0.803 Test Loss: 0.752 Test Acc: 0.803
Validation loss decreased (-0.799991 --> -0.803117).  Saving model ...
Epoch: 16 cost time: 1.4582915306091309
Epoch: 16, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2085437774658203
Epoch: 17, Steps: 8 | Train Loss: 0.553 Vali Loss: 0.677 Vali Acc: 0.800 Test Loss: 0.677 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7063708305358887
Epoch: 18, Steps: 8 | Train Loss: 0.528 Vali Loss: 0.655 Vali Acc: 0.806 Test Loss: 0.655 Test Acc: 0.806
Validation loss decreased (-0.803117 --> -0.806243).  Saving model ...
Epoch: 19 cost time: 2.1171796321868896
Epoch: 19, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.632 Vali Acc: 0.806 Test Loss: 0.632 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806244).  Saving model ...
Epoch: 20 cost time: 2.0849082469940186
Epoch: 20, Steps: 8 | Train Loss: 0.419 Vali Loss: 0.620 Vali Acc: 0.803 Test Loss: 0.620 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9951841831207275
Epoch: 21, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812494).  Saving model ...
Epoch: 22 cost time: 2.0070748329162598
Epoch: 22, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.592 Vali Acc: 0.816 Test Loss: 0.592 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 23 cost time: 2.1487014293670654
Epoch: 23, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.185701608657837
Epoch: 24, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8460640907287598
Epoch: 25, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 26 cost time: 2.4763777256011963
Epoch: 26, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.571 Vali Acc: 0.822 Test Loss: 0.571 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 27 cost time: 1.712127685546875
Epoch: 27, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.753185749053955
Epoch: 28, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 29 cost time: 1.893916368484497
Epoch: 29, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.556 Vali Acc: 0.812 Test Loss: 0.556 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.179136037826538
Epoch: 30, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824995).  Saving model ...
Epoch: 31 cost time: 1.9208133220672607
Epoch: 31, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.547 Vali Acc: 0.831 Test Loss: 0.547 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 32 cost time: 2.2085630893707275
Epoch: 32, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8988933563232422
Epoch: 33, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.34468674659729
Epoch: 34, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.9906203746795654
Epoch: 35, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.546 Vali Acc: 0.831 Test Loss: 0.546 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 36 cost time: 1.3727755546569824
Epoch: 36, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3722546100616455
Epoch: 37, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 38 cost time: 1.7554545402526855
Epoch: 38, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.529 Vali Acc: 0.834 Test Loss: 0.529 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 39 cost time: 2.009995222091675
Epoch: 39, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.008840560913086
Epoch: 40, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.537 Vali Acc: 0.825 Test Loss: 0.537 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.9403743743896484
Epoch: 41, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7273879051208496
Epoch: 42, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 43 cost time: 1.5540995597839355
Epoch: 43, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.4506003856658936
Epoch: 44, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.531 Vali Acc: 0.831 Test Loss: 0.531 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.1731152534484863
Epoch: 45, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.0896146297454834
Epoch: 46, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.543 Vali Acc: 0.831 Test Loss: 0.543 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.3117151260375977
Epoch: 47, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.542 Vali Acc: 0.819 Test Loss: 0.542 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.145406723022461
Epoch: 48, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.0715065002441406
Epoch: 49, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.9136931896209717
Epoch: 50, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.8784170150756836
Epoch: 51, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 2.213595151901245
Epoch: 52, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.543 Vali Acc: 0.834 Test Loss: 0.543 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 240516
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.237914323806763
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 1.954 Vali Acc: 0.247 Test Loss: 1.954 Test Acc: 0.247
Validation loss decreased (inf --> -0.246855).  Saving model ...
Epoch: 2 cost time: 1.6958391666412354
Epoch: 2, Steps: 8 | Train Loss: 1.842 Vali Loss: 1.448 Vali Acc: 0.625 Test Loss: 1.448 Test Acc: 0.625
Validation loss decreased (-0.246855 --> -0.624986).  Saving model ...
Epoch: 3 cost time: 1.8759045600891113
Epoch: 3, Steps: 8 | Train Loss: 1.277 Vali Loss: 0.984 Vali Acc: 0.747 Test Loss: 0.984 Test Acc: 0.747
Validation loss decreased (-0.624986 --> -0.746865).  Saving model ...
Epoch: 4 cost time: 1.7860007286071777
Epoch: 4, Steps: 8 | Train Loss: 0.871 Vali Loss: 0.687 Vali Acc: 0.794 Test Loss: 0.687 Test Acc: 0.794
Validation loss decreased (-0.746865 --> -0.793743).  Saving model ...
Epoch: 5 cost time: 1.4770615100860596
Epoch: 5, Steps: 8 | Train Loss: 0.522 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
Validation loss decreased (-0.793743 --> -0.815619).  Saving model ...
Epoch: 6 cost time: 1.5681335926055908
Epoch: 6, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.614 Vali Acc: 0.787 Test Loss: 0.614 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7101705074310303
Epoch: 7, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.521 Vali Acc: 0.859 Test Loss: 0.521 Test Acc: 0.859
Validation loss decreased (-0.815619 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 1.7596111297607422
Epoch: 8, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7269949913024902
Epoch: 9, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.561 Vali Acc: 0.831 Test Loss: 0.561 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5834438800811768
Epoch: 10, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.575 Vali Acc: 0.831 Test Loss: 0.575 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7214491367340088
Epoch: 11, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8549838066101074
Epoch: 12, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.683 Vali Acc: 0.822 Test Loss: 0.683 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9825880527496338
Epoch: 13, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.070621967315674
Epoch: 14, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.526 Vali Acc: 0.866 Test Loss: 0.526 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 15 cost time: 2.4195897579193115
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.666 Vali Acc: 0.847 Test Loss: 0.666 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1356890201568604
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.680 Vali Acc: 0.838 Test Loss: 0.680 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9299006462097168
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.689 Vali Acc: 0.834 Test Loss: 0.689 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9962434768676758
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.670 Vali Acc: 0.841 Test Loss: 0.670 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6015305519104004
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.654 Vali Acc: 0.850 Test Loss: 0.654 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8235559463500977
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.655 Vali Acc: 0.844 Test Loss: 0.655 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.2131080627441406
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.655 Vali Acc: 0.847 Test Loss: 0.655 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0134496688842773
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6789488792419434
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.9675328731536865
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.856 Test Loss: 0.654 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 11198264
model size : 47.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.216979026794434
Epoch: 1, Steps: 8 | Train Loss: 2.120 Vali Loss: 1.906 Vali Acc: 0.344 Test Loss: 1.906 Test Acc: 0.344
Validation loss decreased (inf --> -0.343731).  Saving model ...
Epoch: 2 cost time: 2.17856502532959
Epoch: 2, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.356 Vali Acc: 0.669 Test Loss: 1.356 Test Acc: 0.669
Validation loss decreased (-0.343731 --> -0.668736).  Saving model ...
Epoch: 3 cost time: 2.0332658290863037
Epoch: 3, Steps: 8 | Train Loss: 1.278 Vali Loss: 0.899 Vali Acc: 0.741 Test Loss: 0.899 Test Acc: 0.741
Validation loss decreased (-0.668736 --> -0.740616).  Saving model ...
Epoch: 4 cost time: 2.305128335952759
Epoch: 4, Steps: 8 | Train Loss: 0.766 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
Validation loss decreased (-0.740616 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 1.6800024509429932
Epoch: 5, Steps: 8 | Train Loss: 0.487 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.68896484375
Epoch: 6, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0459372997283936
Epoch: 7, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.564 Vali Acc: 0.828 Test Loss: 0.564 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 1.7829296588897705
Epoch: 8, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.561674118041992
Epoch: 9, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
Validation loss decreased (-0.828119 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 1.9667794704437256
Epoch: 10, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.573 Vali Acc: 0.834 Test Loss: 0.573 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8922100067138672
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.560 Vali Acc: 0.847 Test Loss: 0.560 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846869).  Saving model ...
Epoch: 12 cost time: 1.5029263496398926
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.535 Vali Acc: 0.853 Test Loss: 0.535 Test Acc: 0.853
Validation loss decreased (-0.846869 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 1.7856214046478271
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.565 Vali Acc: 0.841 Test Loss: 0.565 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.749387502670288
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.599 Vali Acc: 0.841 Test Loss: 0.599 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9076156616210938
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.601 Vali Acc: 0.856 Test Loss: 0.601 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856244).  Saving model ...
Epoch: 16 cost time: 1.905486822128296
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6287267208099365
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.853 Test Loss: 0.563 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7948784828186035
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.582 Vali Acc: 0.847 Test Loss: 0.582 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8321778774261475
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.594 Vali Acc: 0.847 Test Loss: 0.594 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.583477258682251
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.605 Vali Acc: 0.847 Test Loss: 0.605 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.235968828201294
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.853 Test Loss: 0.604 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.455942392349243
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856244).  Saving model ...
Epoch: 23 cost time: 1.7068862915039062
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
Validation loss decreased (-0.856244 --> -0.856244).  Saving model ...
Epoch: 24 cost time: 1.8007073402404785
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.599 Vali Acc: 0.853 Test Loss: 0.599 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9652912616729736
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.853 Test Loss: 0.607 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1729185581207275
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.3313684463500977
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.138885259628296
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9851949214935303
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.853 Test Loss: 0.620 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.072434663772583
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.125678539276123
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.615 Vali Acc: 0.853 Test Loss: 0.615 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.938037633895874
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.853 Test Loss: 0.630 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.52359938621521
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.637 Vali Acc: 0.853 Test Loss: 0.637 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 11185976
model size : 47.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9281165599823
Epoch: 1, Steps: 8 | Train Loss: 2.320 Vali Loss: 1.999 Vali Acc: 0.212 Test Loss: 1.999 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 1.8178515434265137
Epoch: 2, Steps: 8 | Train Loss: 1.883 Vali Loss: 1.454 Vali Acc: 0.691 Test Loss: 1.454 Test Acc: 0.691
Validation loss decreased (-0.212480 --> -0.690610).  Saving model ...
Epoch: 3 cost time: 1.8244578838348389
Epoch: 3, Steps: 8 | Train Loss: 1.274 Vali Loss: 0.951 Vali Acc: 0.756 Test Loss: 0.951 Test Acc: 0.756
Validation loss decreased (-0.690610 --> -0.756240).  Saving model ...
Epoch: 4 cost time: 1.4625420570373535
Epoch: 4, Steps: 8 | Train Loss: 0.772 Vali Loss: 0.665 Vali Acc: 0.806 Test Loss: 0.665 Test Acc: 0.806
Validation loss decreased (-0.756240 --> -0.806243).  Saving model ...
Epoch: 5 cost time: 1.576073169708252
Epoch: 5, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
Validation loss decreased (-0.806243 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 1.7897717952728271
Epoch: 6, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 1.5921034812927246
Epoch: 7, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9052793979644775
Epoch: 8, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.260972261428833
Epoch: 9, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 1.4986956119537354
Epoch: 10, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 1.533536672592163
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.550 Vali Acc: 0.847 Test Loss: 0.550 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6236717700958252
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.565 Vali Acc: 0.847 Test Loss: 0.565 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6969366073608398
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.584 Vali Acc: 0.841 Test Loss: 0.584 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8076057434082031
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.582 Vali Acc: 0.847 Test Loss: 0.582 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9252021312713623
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.585 Vali Acc: 0.859 Test Loss: 0.585 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859369).  Saving model ...
Epoch: 16 cost time: 1.7464325428009033
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.583 Vali Acc: 0.853 Test Loss: 0.583 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1280903816223145
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.590 Vali Acc: 0.847 Test Loss: 0.590 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.002228260040283
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9779248237609863
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.213311195373535
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.618 Vali Acc: 0.847 Test Loss: 0.618 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1282079219818115
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.615 Vali Acc: 0.847 Test Loss: 0.615 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.1752569675445557
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.616 Vali Acc: 0.853 Test Loss: 0.616 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.197033405303955
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1098763942718506
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0634710788726807
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 11173688
model size : 47.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.0842249393463135
Epoch: 1, Steps: 8 | Train Loss: 2.200 Vali Loss: 1.960 Vali Acc: 0.281 Test Loss: 1.960 Test Acc: 0.281
Validation loss decreased (inf --> -0.281230).  Saving model ...
Epoch: 2 cost time: 1.6583144664764404
Epoch: 2, Steps: 8 | Train Loss: 1.805 Vali Loss: 1.412 Vali Acc: 0.725 Test Loss: 1.412 Test Acc: 0.725
Validation loss decreased (-0.281230 --> -0.724986).  Saving model ...
Epoch: 3 cost time: 1.5566833019256592
Epoch: 3, Steps: 8 | Train Loss: 1.223 Vali Loss: 0.924 Vali Acc: 0.756 Test Loss: 0.924 Test Acc: 0.756
Validation loss decreased (-0.724986 --> -0.756241).  Saving model ...
Epoch: 4 cost time: 1.8495073318481445
Epoch: 4, Steps: 8 | Train Loss: 0.761 Vali Loss: 0.659 Vali Acc: 0.797 Test Loss: 0.659 Test Acc: 0.797
Validation loss decreased (-0.756241 --> -0.796868).  Saving model ...
Epoch: 5 cost time: 1.5416221618652344
Epoch: 5, Steps: 8 | Train Loss: 0.493 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
Validation loss decreased (-0.796868 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 1.5224063396453857
Epoch: 6, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
Validation loss decreased (-0.812494 --> -0.840619).  Saving model ...
Epoch: 7 cost time: 1.5628314018249512
Epoch: 7, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4030826091766357
Epoch: 8, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5089237689971924
Epoch: 9, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 1.7094473838806152
Epoch: 10, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.567 Vali Acc: 0.844 Test Loss: 0.567 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4357011318206787
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.597 Vali Acc: 0.831 Test Loss: 0.597 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4832570552825928
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.603 Vali Acc: 0.847 Test Loss: 0.603 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.594860553741455
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.627 Vali Acc: 0.841 Test Loss: 0.627 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4443914890289307
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6709423065185547
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9349300861358643
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7222909927368164
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.615 Vali Acc: 0.847 Test Loss: 0.615 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5442969799041748
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.611 Vali Acc: 0.863 Test Loss: 0.611 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862494).  Saving model ...
Epoch: 19 cost time: 1.489088535308838
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.615 Vali Acc: 0.859 Test Loss: 0.615 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7803277969360352
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.859 Test Loss: 0.621 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6244111061096191
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7082412242889404
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.640 Vali Acc: 0.859 Test Loss: 0.640 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.625772476196289
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.640 Vali Acc: 0.847 Test Loss: 0.640 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6146976947784424
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.638 Vali Acc: 0.856 Test Loss: 0.638 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7193748950958252
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.639 Vali Acc: 0.856 Test Loss: 0.639 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.055405378341675
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.637 Vali Acc: 0.863 Test Loss: 0.637 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6735584735870361
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.863 Test Loss: 0.646 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5814857482910156
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.651 Vali Acc: 0.859 Test Loss: 0.651 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 11161400
model size : 47.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.386679649353027
Epoch: 1, Steps: 8 | Train Loss: 2.206 Vali Loss: 1.953 Vali Acc: 0.312 Test Loss: 1.953 Test Acc: 0.312
Validation loss decreased (inf --> -0.312480).  Saving model ...
Epoch: 2 cost time: 1.8710167407989502
Epoch: 2, Steps: 8 | Train Loss: 1.889 Vali Loss: 1.444 Vali Acc: 0.784 Test Loss: 1.444 Test Acc: 0.784
Validation loss decreased (-0.312480 --> -0.784361).  Saving model ...
Epoch: 3 cost time: 2.3238260746002197
Epoch: 3, Steps: 8 | Train Loss: 1.270 Vali Loss: 0.988 Vali Acc: 0.747 Test Loss: 0.988 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8656911849975586
Epoch: 4, Steps: 8 | Train Loss: 0.834 Vali Loss: 0.655 Vali Acc: 0.819 Test Loss: 0.655 Test Acc: 0.819
Validation loss decreased (-0.784361 --> -0.818743).  Saving model ...
Epoch: 5 cost time: 1.8808965682983398
Epoch: 5, Steps: 8 | Train Loss: 0.564 Vali Loss: 0.599 Vali Acc: 0.803 Test Loss: 0.599 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0052847862243652
Epoch: 6, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.403226852416992
Epoch: 7, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
Validation loss decreased (-0.818743 --> -0.818745).  Saving model ...
Epoch: 8 cost time: 2.0486819744110107
Epoch: 8, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.500 Vali Acc: 0.859 Test Loss: 0.500 Test Acc: 0.859
Validation loss decreased (-0.818745 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 2.281741142272949
Epoch: 9, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.329738140106201
Epoch: 10, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0494184494018555
Epoch: 11, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.084376335144043
Epoch: 12, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.623 Vali Acc: 0.841 Test Loss: 0.623 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.30769944190979
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1095080375671387
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2881734371185303
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.594 Vali Acc: 0.838 Test Loss: 0.594 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.030930757522583
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.605 Vali Acc: 0.853 Test Loss: 0.605 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0117294788360596
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0434181690216064
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 9359672
model size : 40.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6083498001098633
Epoch: 1, Steps: 8 | Train Loss: 2.149 Vali Loss: 2.023 Vali Acc: 0.150 Test Loss: 2.023 Test Acc: 0.150
Validation loss decreased (inf --> -0.149980).  Saving model ...
Epoch: 2 cost time: 1.4301843643188477
Epoch: 2, Steps: 8 | Train Loss: 2.047 Vali Loss: 1.611 Vali Acc: 0.550 Test Loss: 1.611 Test Acc: 0.550
Validation loss decreased (-0.149980 --> -0.549984).  Saving model ...
Epoch: 3 cost time: 1.37986159324646
Epoch: 3, Steps: 8 | Train Loss: 1.389 Vali Loss: 1.094 Vali Acc: 0.762 Test Loss: 1.094 Test Acc: 0.762
Validation loss decreased (-0.549984 --> -0.762489).  Saving model ...
Epoch: 4 cost time: 1.4857516288757324
Epoch: 4, Steps: 8 | Train Loss: 0.930 Vali Loss: 0.739 Vali Acc: 0.806 Test Loss: 0.739 Test Acc: 0.806
Validation loss decreased (-0.762489 --> -0.806243).  Saving model ...
Epoch: 5 cost time: 1.5917081832885742
Epoch: 5, Steps: 8 | Train Loss: 0.619 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809369).  Saving model ...
Epoch: 6 cost time: 1.5938999652862549
Epoch: 6, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 7 cost time: 1.5984258651733398
Epoch: 7, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.543 Vali Acc: 0.806 Test Loss: 0.543 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9773638248443604
Epoch: 8, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.561 Vali Acc: 0.831 Test Loss: 0.561 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831244).  Saving model ...
Epoch: 9 cost time: 1.5619351863861084
Epoch: 9, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.478 Vali Acc: 0.859 Test Loss: 0.478 Test Acc: 0.859
Validation loss decreased (-0.831244 --> -0.859370).  Saving model ...
Epoch: 10 cost time: 1.5015907287597656
Epoch: 10, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.495 Vali Acc: 0.859 Test Loss: 0.495 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.27647066116333
Epoch: 11, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6612305641174316
Epoch: 12, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.641232967376709
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.596 Vali Acc: 0.838 Test Loss: 0.596 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3895883560180664
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.582 Vali Acc: 0.863 Test Loss: 0.582 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862494).  Saving model ...
Epoch: 15 cost time: 1.5905427932739258
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4332489967346191
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.575 Vali Acc: 0.853 Test Loss: 0.575 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4680817127227783
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.591 Vali Acc: 0.863 Test Loss: 0.591 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6435999870300293
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.627 Vali Acc: 0.847 Test Loss: 0.627 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4793305397033691
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4654924869537354
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.612 Vali Acc: 0.853 Test Loss: 0.612 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.305323839187622
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.208559274673462
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6597647666931152
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5310938358306885
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 9347384
model size : 40.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1442079544067383
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 1.960 Vali Acc: 0.319 Test Loss: 1.960 Test Acc: 0.319
Validation loss decreased (inf --> -0.318730).  Saving model ...
Epoch: 2 cost time: 1.583664894104004
Epoch: 2, Steps: 8 | Train Loss: 1.866 Vali Loss: 1.518 Vali Acc: 0.547 Test Loss: 1.518 Test Acc: 0.547
Validation loss decreased (-0.318730 --> -0.546860).  Saving model ...
Epoch: 3 cost time: 1.427492380142212
Epoch: 3, Steps: 8 | Train Loss: 1.299 Vali Loss: 0.989 Vali Acc: 0.766 Test Loss: 0.989 Test Acc: 0.766
Validation loss decreased (-0.546860 --> -0.765615).  Saving model ...
Epoch: 4 cost time: 1.5659184455871582
Epoch: 4, Steps: 8 | Train Loss: 0.826 Vali Loss: 0.702 Vali Acc: 0.812 Test Loss: 0.702 Test Acc: 0.812
Validation loss decreased (-0.765615 --> -0.812493).  Saving model ...
Epoch: 5 cost time: 1.4356703758239746
Epoch: 5, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
Validation loss decreased (-0.812493 --> -0.818745).  Saving model ...
Epoch: 6 cost time: 1.3706908226013184
Epoch: 6, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.584 Vali Acc: 0.806 Test Loss: 0.584 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5842311382293701
Epoch: 7, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
Validation loss decreased (-0.818745 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 1.5127315521240234
Epoch: 8, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.529 Vali Acc: 0.828 Test Loss: 0.529 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 9 cost time: 1.6997740268707275
Epoch: 9, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
Validation loss decreased (-0.828120 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 1.5470964908599854
Epoch: 10, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.769533395767212
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4863872528076172
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.559 Vali Acc: 0.847 Test Loss: 0.559 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846869).  Saving model ...
Epoch: 13 cost time: 1.3651652336120605
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1197845935821533
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.598 Vali Acc: 0.838 Test Loss: 0.598 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4686901569366455
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.617 Vali Acc: 0.838 Test Loss: 0.617 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5791335105895996
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.605 Vali Acc: 0.847 Test Loss: 0.605 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7181408405303955
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.5495853424072266
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.602 Vali Acc: 0.859 Test Loss: 0.602 Test Acc: 0.859
Validation loss decreased (-0.849994 --> -0.859369).  Saving model ...
Epoch: 19 cost time: 1.5383105278015137
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5595965385437012
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.611 Vali Acc: 0.856 Test Loss: 0.611 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8604013919830322
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2167391777038574
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3764257431030273
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9103460311889648
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6296319961547852
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.859 Test Loss: 0.633 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6755950450897217
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.636 Vali Acc: 0.859 Test Loss: 0.636 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8796019554138184
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6380589008331299
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.856 Test Loss: 0.640 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 9335096
model size : 40.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.021850109100342
Epoch: 1, Steps: 8 | Train Loss: 2.173 Vali Loss: 1.947 Vali Acc: 0.278 Test Loss: 1.947 Test Acc: 0.278
Validation loss decreased (inf --> -0.278106).  Saving model ...
Epoch: 2 cost time: 1.7753019332885742
Epoch: 2, Steps: 8 | Train Loss: 1.880 Vali Loss: 1.526 Vali Acc: 0.597 Test Loss: 1.526 Test Acc: 0.597
Validation loss decreased (-0.278106 --> -0.596860).  Saving model ...
Epoch: 3 cost time: 2.004591703414917
Epoch: 3, Steps: 8 | Train Loss: 1.398 Vali Loss: 1.036 Vali Acc: 0.747 Test Loss: 1.036 Test Acc: 0.747
Validation loss decreased (-0.596860 --> -0.746865).  Saving model ...
Epoch: 4 cost time: 2.204416513442993
Epoch: 4, Steps: 8 | Train Loss: 0.880 Vali Loss: 0.693 Vali Acc: 0.816 Test Loss: 0.693 Test Acc: 0.816
Validation loss decreased (-0.746865 --> -0.815618).  Saving model ...
Epoch: 5 cost time: 2.059077262878418
Epoch: 5, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.532 Vali Acc: 0.825 Test Loss: 0.532 Test Acc: 0.825
Validation loss decreased (-0.815618 --> -0.824995).  Saving model ...
Epoch: 6 cost time: 1.6029109954833984
Epoch: 6, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.540 Vali Acc: 0.816 Test Loss: 0.540 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.870285987854004
Epoch: 7, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 1.4926865100860596
Epoch: 8, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5948171615600586
Epoch: 9, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9945011138916016
Epoch: 10, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0262434482574463
Epoch: 11, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7923812866210938
Epoch: 12, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.172914981842041
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.613 Vali Acc: 0.844 Test Loss: 0.613 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0026164054870605
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.575 Vali Acc: 0.838 Test Loss: 0.575 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5625927448272705
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6879689693450928
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.378047227859497
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 9322808
model size : 40.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.228447198867798
Epoch: 1, Steps: 8 | Train Loss: 2.244 Vali Loss: 2.040 Vali Acc: 0.181 Test Loss: 2.040 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 1.901545524597168
Epoch: 2, Steps: 8 | Train Loss: 1.900 Vali Loss: 1.576 Vali Acc: 0.641 Test Loss: 1.576 Test Acc: 0.641
Validation loss decreased (-0.181230 --> -0.640609).  Saving model ...
Epoch: 3 cost time: 1.993638038635254
Epoch: 3, Steps: 8 | Train Loss: 1.416 Vali Loss: 1.060 Vali Acc: 0.778 Test Loss: 1.060 Test Acc: 0.778
Validation loss decreased (-0.640609 --> -0.778114).  Saving model ...
Epoch: 4 cost time: 1.5875754356384277
Epoch: 4, Steps: 8 | Train Loss: 0.954 Vali Loss: 0.751 Vali Acc: 0.800 Test Loss: 0.751 Test Acc: 0.800
Validation loss decreased (-0.778114 --> -0.799992).  Saving model ...
Epoch: 5 cost time: 1.3515028953552246
Epoch: 5, Steps: 8 | Train Loss: 0.606 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809369).  Saving model ...
Epoch: 6 cost time: 1.7469758987426758
Epoch: 6, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815620).  Saving model ...
Epoch: 7 cost time: 1.553408145904541
Epoch: 7, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0327584743499756
Epoch: 8, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.815620 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 1.2833688259124756
Epoch: 9, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.538 Vali Acc: 0.812 Test Loss: 0.538 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.890472173690796
Epoch: 10, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 1.6851654052734375
Epoch: 11, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.586 Vali Acc: 0.819 Test Loss: 0.586 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6481854915618896
Epoch: 12, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.599 Vali Acc: 0.844 Test Loss: 0.599 Test Acc: 0.844
Validation loss decreased (-0.831244 --> -0.843744).  Saving model ...
Epoch: 13 cost time: 1.710834264755249
Epoch: 13, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.584 Vali Acc: 0.853 Test Loss: 0.584 Test Acc: 0.853
Validation loss decreased (-0.843744 --> -0.853119).  Saving model ...
Epoch: 14 cost time: 1.9222197532653809
Epoch: 14, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6369099617004395
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.649 Vali Acc: 0.831 Test Loss: 0.649 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4546184539794922
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.639 Vali Acc: 0.838 Test Loss: 0.639 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6426262855529785
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6682965755462646
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.588 Vali Acc: 0.859 Test Loss: 0.588 Test Acc: 0.859
Validation loss decreased (-0.853119 --> -0.859369).  Saving model ...
Epoch: 19 cost time: 1.5802216529846191
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.590 Vali Acc: 0.863 Test Loss: 0.590 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862494).  Saving model ...
Epoch: 20 cost time: 1.762542486190796
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9521949291229248
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6402101516723633
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.652 Vali Acc: 0.847 Test Loss: 0.652 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.527069091796875
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.645 Vali Acc: 0.856 Test Loss: 0.645 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8463897705078125
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.638 Vali Acc: 0.866 Test Loss: 0.638 Test Acc: 0.866
Validation loss decreased (-0.862494 --> -0.865619).  Saving model ...
Epoch: 25 cost time: 1.5780963897705078
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.643 Vali Acc: 0.863 Test Loss: 0.643 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7480735778808594
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.650 Vali Acc: 0.856 Test Loss: 0.650 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4717271327972412
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.859 Test Loss: 0.656 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.764890193939209
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.859 Test Loss: 0.655 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.881093978881836
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.859 Test Loss: 0.654 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5433986186981201
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.661 Vali Acc: 0.856 Test Loss: 0.661 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8976998329162598
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.856 Test Loss: 0.665 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.0661509037017822
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.669 Vali Acc: 0.856 Test Loss: 0.669 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.8984997272491455
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.669 Vali Acc: 0.863 Test Loss: 0.669 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.674189805984497
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.671 Vali Acc: 0.866 Test Loss: 0.671 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 8440376
model size : 37.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6995456218719482
Epoch: 1, Steps: 8 | Train Loss: 2.162 Vali Loss: 1.983 Vali Acc: 0.178 Test Loss: 1.983 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 1.3129935264587402
Epoch: 2, Steps: 8 | Train Loss: 1.827 Vali Loss: 1.534 Vali Acc: 0.659 Test Loss: 1.534 Test Acc: 0.659
Validation loss decreased (-0.178105 --> -0.659360).  Saving model ...
Epoch: 3 cost time: 1.590707540512085
Epoch: 3, Steps: 8 | Train Loss: 1.369 Vali Loss: 1.065 Vali Acc: 0.734 Test Loss: 1.065 Test Acc: 0.734
Validation loss decreased (-0.659360 --> -0.734364).  Saving model ...
Epoch: 4 cost time: 2.0989365577697754
Epoch: 4, Steps: 8 | Train Loss: 0.906 Vali Loss: 0.741 Vali Acc: 0.772 Test Loss: 0.741 Test Acc: 0.772
Validation loss decreased (-0.734364 --> -0.771868).  Saving model ...
Epoch: 5 cost time: 2.03639554977417
Epoch: 5, Steps: 8 | Train Loss: 0.609 Vali Loss: 0.646 Vali Acc: 0.806 Test Loss: 0.646 Test Acc: 0.806
Validation loss decreased (-0.771868 --> -0.806244).  Saving model ...
Epoch: 6 cost time: 1.7459361553192139
Epoch: 6, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
Validation loss decreased (-0.806244 --> -0.824995).  Saving model ...
Epoch: 7 cost time: 1.8745830059051514
Epoch: 7, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 1.3081226348876953
Epoch: 8, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.510 Vali Acc: 0.825 Test Loss: 0.510 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9072606563568115
Epoch: 9, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 1.61885404586792
Epoch: 10, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.514 Vali Acc: 0.831 Test Loss: 0.514 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4391281604766846
Epoch: 11, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 1.6055994033813477
Epoch: 12, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.584 Vali Acc: 0.831 Test Loss: 0.584 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7526192665100098
Epoch: 13, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.554 Vali Acc: 0.834 Test Loss: 0.554 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5537679195404053
Epoch: 14, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.586 Vali Acc: 0.847 Test Loss: 0.586 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846869).  Saving model ...
Epoch: 15 cost time: 1.738424301147461
Epoch: 15, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.638 Vali Acc: 0.841 Test Loss: 0.638 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4888107776641846
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.608 Vali Acc: 0.847 Test Loss: 0.608 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6354522705078125
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.603 Vali Acc: 0.847 Test Loss: 0.603 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3167552947998047
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.634 Vali Acc: 0.838 Test Loss: 0.634 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4529657363891602
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.650 Vali Acc: 0.841 Test Loss: 0.650 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5405042171478271
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.647 Vali Acc: 0.838 Test Loss: 0.647 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.238152027130127
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.637 Vali Acc: 0.841 Test Loss: 0.637 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6043407917022705
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.639 Vali Acc: 0.838 Test Loss: 0.639 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5806105136871338
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.655 Vali Acc: 0.831 Test Loss: 0.655 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4842503070831299
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.651 Vali Acc: 0.841 Test Loss: 0.651 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 8428088
model size : 37.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.82753324508667
Epoch: 1, Steps: 8 | Train Loss: 2.111 Vali Loss: 1.943 Vali Acc: 0.366 Test Loss: 1.943 Test Acc: 0.366
Validation loss decreased (inf --> -0.365606).  Saving model ...
Epoch: 2 cost time: 1.3805537223815918
Epoch: 2, Steps: 8 | Train Loss: 1.857 Vali Loss: 1.547 Vali Acc: 0.525 Test Loss: 1.547 Test Acc: 0.525
Validation loss decreased (-0.365606 --> -0.524985).  Saving model ...
Epoch: 3 cost time: 1.521479845046997
Epoch: 3, Steps: 8 | Train Loss: 1.321 Vali Loss: 1.053 Vali Acc: 0.747 Test Loss: 1.053 Test Acc: 0.747
Validation loss decreased (-0.524985 --> -0.746864).  Saving model ...
Epoch: 4 cost time: 1.5721969604492188
Epoch: 4, Steps: 8 | Train Loss: 0.875 Vali Loss: 0.755 Vali Acc: 0.778 Test Loss: 0.755 Test Acc: 0.778
Validation loss decreased (-0.746864 --> -0.778117).  Saving model ...
Epoch: 5 cost time: 1.343440294265747
Epoch: 5, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.572 Vali Acc: 0.834 Test Loss: 0.572 Test Acc: 0.834
Validation loss decreased (-0.778117 --> -0.834369).  Saving model ...
Epoch: 6 cost time: 1.706434965133667
Epoch: 6, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.547 Vali Acc: 0.825 Test Loss: 0.547 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5145339965820312
Epoch: 7, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.523388385772705
Epoch: 8, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7254877090454102
Epoch: 9, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.579 Vali Acc: 0.838 Test Loss: 0.579 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 10 cost time: 1.658094882965088
Epoch: 10, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 1.5334415435791016
Epoch: 11, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.591 Vali Acc: 0.847 Test Loss: 0.591 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846869).  Saving model ...
Epoch: 12 cost time: 1.6392977237701416
Epoch: 12, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.619 Vali Acc: 0.819 Test Loss: 0.619 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5867574214935303
Epoch: 13, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.583 Vali Acc: 0.838 Test Loss: 0.583 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4327197074890137
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.650 Vali Acc: 0.841 Test Loss: 0.650 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.665130853652954
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.673 Vali Acc: 0.831 Test Loss: 0.673 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9783496856689453
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.649 Vali Acc: 0.831 Test Loss: 0.649 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.203075885772705
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.614 Vali Acc: 0.853 Test Loss: 0.614 Test Acc: 0.853
Validation loss decreased (-0.846869 --> -0.853119).  Saving model ...
Epoch: 18 cost time: 1.5455138683319092
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.598 Vali Acc: 0.859 Test Loss: 0.598 Test Acc: 0.859
Validation loss decreased (-0.853119 --> -0.859369).  Saving model ...
Epoch: 19 cost time: 1.3781447410583496
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4389705657958984
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.632 Vali Acc: 0.838 Test Loss: 0.632 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4437949657440186
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5496716499328613
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.863 Test Loss: 0.644 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862494).  Saving model ...
Epoch: 23 cost time: 1.769423246383667
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.648 Vali Acc: 0.863 Test Loss: 0.648 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5415761470794678
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.648 Vali Acc: 0.863 Test Loss: 0.648 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.442183256149292
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.647 Vali Acc: 0.856 Test Loss: 0.647 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.713611125946045
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7663865089416504
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.856 Test Loss: 0.656 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6571695804595947
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6593616008758545
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.856 Test Loss: 0.656 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8838841915130615
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.853 Test Loss: 0.655 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6650996208190918
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.853 Test Loss: 0.662 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.084007740020752
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.666 Vali Acc: 0.850 Test Loss: 0.666 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 8415800
model size : 37.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8780758380889893
Epoch: 1, Steps: 8 | Train Loss: 2.130 Vali Loss: 1.931 Vali Acc: 0.216 Test Loss: 1.931 Test Acc: 0.216
Validation loss decreased (inf --> -0.215606).  Saving model ...
Epoch: 2 cost time: 1.3275620937347412
Epoch: 2, Steps: 8 | Train Loss: 1.854 Vali Loss: 1.499 Vali Acc: 0.672 Test Loss: 1.499 Test Acc: 0.672
Validation loss decreased (-0.215606 --> -0.671860).  Saving model ...
Epoch: 3 cost time: 1.5854389667510986
Epoch: 3, Steps: 8 | Train Loss: 1.385 Vali Loss: 1.048 Vali Acc: 0.769 Test Loss: 1.048 Test Acc: 0.769
Validation loss decreased (-0.671860 --> -0.768740).  Saving model ...
Epoch: 4 cost time: 1.5037446022033691
Epoch: 4, Steps: 8 | Train Loss: 0.860 Vali Loss: 0.711 Vali Acc: 0.841 Test Loss: 0.711 Test Acc: 0.841
Validation loss decreased (-0.768740 --> -0.840618).  Saving model ...
Epoch: 5 cost time: 1.7343287467956543
Epoch: 5, Steps: 8 | Train Loss: 0.602 Vali Loss: 0.577 Vali Acc: 0.816 Test Loss: 0.577 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.623833179473877
Epoch: 6, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.542 Vali Acc: 0.822 Test Loss: 0.542 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3718054294586182
Epoch: 7, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.566 Vali Acc: 0.800 Test Loss: 0.566 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5832316875457764
Epoch: 8, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8544046878814697
Epoch: 9, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.519 Vali Acc: 0.828 Test Loss: 0.519 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7096045017242432
Epoch: 10, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.547 Vali Acc: 0.831 Test Loss: 0.547 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6725082397460938
Epoch: 11, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
Validation loss decreased (-0.840618 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 2.737468719482422
Epoch: 12, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.609 Vali Acc: 0.831 Test Loss: 0.609 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1474661827087402
Epoch: 13, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7133233547210693
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.580 Vali Acc: 0.844 Test Loss: 0.580 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.952300786972046
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.589 Vali Acc: 0.844 Test Loss: 0.589 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7212984561920166
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6177031993865967
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7100441455841064
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.602 Vali Acc: 0.859 Test Loss: 0.602 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859369).  Saving model ...
Epoch: 19 cost time: 1.8846919536590576
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.606 Vali Acc: 0.859 Test Loss: 0.606 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7406790256500244
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9192965030670166
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.634861946105957
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6641135215759277
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.856 Test Loss: 0.615 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9525301456451416
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.617 Vali Acc: 0.859 Test Loss: 0.617 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.3594281673431396
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.614 Vali Acc: 0.859 Test Loss: 0.614 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9118716716766357
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.608 Vali Acc: 0.859 Test Loss: 0.608 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5838005542755127
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.859 Test Loss: 0.614 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.0802178382873535
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.859 Test Loss: 0.613 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 8403512
model size : 37.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.49303674697876
Epoch: 1, Steps: 8 | Train Loss: 2.185 Vali Loss: 1.973 Vali Acc: 0.278 Test Loss: 1.973 Test Acc: 0.278
Validation loss decreased (inf --> -0.278105).  Saving model ...
Epoch: 2 cost time: 1.5581245422363281
Epoch: 2, Steps: 8 | Train Loss: 2.036 Vali Loss: 1.643 Vali Acc: 0.509 Test Loss: 1.643 Test Acc: 0.509
Validation loss decreased (-0.278105 --> -0.509359).  Saving model ...
Epoch: 3 cost time: 1.3623559474945068
Epoch: 3, Steps: 8 | Train Loss: 1.514 Vali Loss: 1.151 Vali Acc: 0.772 Test Loss: 1.151 Test Acc: 0.772
Validation loss decreased (-0.509359 --> -0.771863).  Saving model ...
Epoch: 4 cost time: 1.8689355850219727
Epoch: 4, Steps: 8 | Train Loss: 1.041 Vali Loss: 0.780 Vali Acc: 0.781 Test Loss: 0.780 Test Acc: 0.781
Validation loss decreased (-0.771863 --> -0.781242).  Saving model ...
Epoch: 5 cost time: 1.743147373199463
Epoch: 5, Steps: 8 | Train Loss: 0.637 Vali Loss: 0.657 Vali Acc: 0.812 Test Loss: 0.657 Test Acc: 0.812
Validation loss decreased (-0.781242 --> -0.812493).  Saving model ...
Epoch: 6 cost time: 2.0201451778411865
Epoch: 6, Steps: 8 | Train Loss: 0.438 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815619).  Saving model ...
Epoch: 7 cost time: 1.8184857368469238
Epoch: 7, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 8 cost time: 1.7046759128570557
Epoch: 8, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 1.9279310703277588
Epoch: 9, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.546 Vali Acc: 0.834 Test Loss: 0.546 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 1.444481611251831
Epoch: 10, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1076831817626953
Epoch: 11, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3559863567352295
Epoch: 12, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.588 Vali Acc: 0.838 Test Loss: 0.588 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837494).  Saving model ...
Epoch: 13 cost time: 1.7155249118804932
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.625 Vali Acc: 0.828 Test Loss: 0.625 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.722740650177002
Epoch: 14, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843744).  Saving model ...
Epoch: 15 cost time: 1.817840814590454
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.616 Vali Acc: 0.831 Test Loss: 0.616 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7013800144195557
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.619 Vali Acc: 0.838 Test Loss: 0.619 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.516740083694458
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.625 Vali Acc: 0.847 Test Loss: 0.625 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846869).  Saving model ...
Epoch: 18 cost time: 1.5765998363494873
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.640 Vali Acc: 0.844 Test Loss: 0.640 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6092727184295654
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.630 Vali Acc: 0.838 Test Loss: 0.630 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8002612590789795
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.627 Vali Acc: 0.831 Test Loss: 0.627 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4824802875518799
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.641 Vali Acc: 0.831 Test Loss: 0.641 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.072723150253296
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.652 Vali Acc: 0.831 Test Loss: 0.652 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.510897159576416
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.660 Vali Acc: 0.844 Test Loss: 0.660 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7433876991271973
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.653 Vali Acc: 0.834 Test Loss: 0.653 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.349885940551758
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.647 Vali Acc: 0.838 Test Loss: 0.647 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.1454901695251465
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.652 Vali Acc: 0.844 Test Loss: 0.652 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.96993088722229
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.662 Vali Acc: 0.838 Test Loss: 0.662 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 7980728
model size : 35.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.748732566833496
Epoch: 1, Steps: 8 | Train Loss: 2.117 Vali Loss: 1.945 Vali Acc: 0.263 Test Loss: 1.945 Test Acc: 0.263
Validation loss decreased (inf --> -0.262481).  Saving model ...
Epoch: 2 cost time: 1.926102876663208
Epoch: 2, Steps: 8 | Train Loss: 1.868 Vali Loss: 1.522 Vali Acc: 0.641 Test Loss: 1.522 Test Acc: 0.641
Validation loss decreased (-0.262481 --> -0.640610).  Saving model ...
Epoch: 3 cost time: 1.8164010047912598
Epoch: 3, Steps: 8 | Train Loss: 1.380 Vali Loss: 1.099 Vali Acc: 0.709 Test Loss: 1.099 Test Acc: 0.709
Validation loss decreased (-0.640610 --> -0.709364).  Saving model ...
Epoch: 4 cost time: 1.76999831199646
Epoch: 4, Steps: 8 | Train Loss: 0.963 Vali Loss: 0.782 Vali Acc: 0.766 Test Loss: 0.782 Test Acc: 0.766
Validation loss decreased (-0.709364 --> -0.765617).  Saving model ...
Epoch: 5 cost time: 1.844545841217041
Epoch: 5, Steps: 8 | Train Loss: 0.611 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
Validation loss decreased (-0.765617 --> -0.818744).  Saving model ...
Epoch: 6 cost time: 1.6921765804290771
Epoch: 6, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.579 Vali Acc: 0.816 Test Loss: 0.579 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5210983753204346
Epoch: 7, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 1.9000284671783447
Epoch: 8, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.578 Vali Acc: 0.828 Test Loss: 0.578 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 1.7223880290985107
Epoch: 9, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5205261707305908
Epoch: 10, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.589 Vali Acc: 0.834 Test Loss: 0.589 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 11 cost time: 1.6578826904296875
Epoch: 11, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.568 Vali Acc: 0.834 Test Loss: 0.568 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834369).  Saving model ...
Epoch: 12 cost time: 1.6758935451507568
Epoch: 12, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.533 Vali Acc: 0.866 Test Loss: 0.533 Test Acc: 0.866
Validation loss decreased (-0.834369 --> -0.865620).  Saving model ...
Epoch: 13 cost time: 1.5065834522247314
Epoch: 13, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.621 Vali Acc: 0.831 Test Loss: 0.621 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5414421558380127
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.613 Vali Acc: 0.844 Test Loss: 0.613 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7747573852539062
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.616 Vali Acc: 0.859 Test Loss: 0.616 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5678510665893555
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.631 Vali Acc: 0.847 Test Loss: 0.631 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5528466701507568
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.627 Vali Acc: 0.856 Test Loss: 0.627 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7194762229919434
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8980557918548584
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.633 Vali Acc: 0.859 Test Loss: 0.633 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.005183219909668
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.625 Vali Acc: 0.859 Test Loss: 0.625 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0672736167907715
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.1016013622283936
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.624 Vali Acc: 0.853 Test Loss: 0.624 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 7968440
model size : 35.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.996394872665405
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 1.914 Vali Acc: 0.234 Test Loss: 1.914 Test Acc: 0.234
Validation loss decreased (inf --> -0.234356).  Saving model ...
Epoch: 2 cost time: 1.8140323162078857
Epoch: 2, Steps: 8 | Train Loss: 1.917 Vali Loss: 1.522 Vali Acc: 0.725 Test Loss: 1.522 Test Acc: 0.725
Validation loss decreased (-0.234356 --> -0.724985).  Saving model ...
Epoch: 3 cost time: 1.8491179943084717
Epoch: 3, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.108 Vali Acc: 0.744 Test Loss: 1.108 Test Acc: 0.744
Validation loss decreased (-0.724985 --> -0.743739).  Saving model ...
Epoch: 4 cost time: 2.0225372314453125
Epoch: 4, Steps: 8 | Train Loss: 0.873 Vali Loss: 0.787 Vali Acc: 0.772 Test Loss: 0.787 Test Acc: 0.772
Validation loss decreased (-0.743739 --> -0.771867).  Saving model ...
Epoch: 5 cost time: 2.216367483139038
Epoch: 5, Steps: 8 | Train Loss: 0.683 Vali Loss: 0.652 Vali Acc: 0.781 Test Loss: 0.652 Test Acc: 0.781
Validation loss decreased (-0.771867 --> -0.781243).  Saving model ...
Epoch: 6 cost time: 1.8559210300445557
Epoch: 6, Steps: 8 | Train Loss: 0.482 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
Validation loss decreased (-0.781243 --> -0.818745).  Saving model ...
Epoch: 7 cost time: 1.7218341827392578
Epoch: 7, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
Validation loss decreased (-0.818745 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 1.5608501434326172
Epoch: 8, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.631 Vali Acc: 0.775 Test Loss: 0.631 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1139800548553467
Epoch: 9, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.536 Vali Acc: 0.831 Test Loss: 0.536 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.34421706199646
Epoch: 10, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.551 Vali Acc: 0.834 Test Loss: 0.551 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5054619312286377
Epoch: 11, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2188847064971924
Epoch: 12, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.583 Vali Acc: 0.853 Test Loss: 0.583 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853119).  Saving model ...
Epoch: 13 cost time: 2.133681297302246
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.734208583831787
Epoch: 14, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.632 Vali Acc: 0.825 Test Loss: 0.632 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9018971920013428
Epoch: 15, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.650 Vali Acc: 0.838 Test Loss: 0.650 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0344228744506836
Epoch: 16, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.612 Vali Acc: 0.841 Test Loss: 0.612 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9642860889434814
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.670 Vali Acc: 0.825 Test Loss: 0.670 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9140076637268066
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.680 Vali Acc: 0.822 Test Loss: 0.680 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.747262716293335
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.661 Vali Acc: 0.838 Test Loss: 0.661 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.28932523727417
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.648 Vali Acc: 0.844 Test Loss: 0.648 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.101515531539917
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.652 Vali Acc: 0.838 Test Loss: 0.652 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8705003261566162
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.656 Vali Acc: 0.841 Test Loss: 0.656 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 7956152
model size : 35.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.735942840576172
Epoch: 1, Steps: 8 | Train Loss: 2.280 Vali Loss: 1.991 Vali Acc: 0.228 Test Loss: 1.991 Test Acc: 0.228
Validation loss decreased (inf --> -0.228105).  Saving model ...
Epoch: 2 cost time: 1.6945207118988037
Epoch: 2, Steps: 8 | Train Loss: 1.895 Vali Loss: 1.577 Vali Acc: 0.522 Test Loss: 1.577 Test Acc: 0.522
Validation loss decreased (-0.228105 --> -0.521859).  Saving model ...
Epoch: 3 cost time: 2.064131736755371
Epoch: 3, Steps: 8 | Train Loss: 1.354 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
Validation loss decreased (-0.521859 --> -0.674989).  Saving model ...
Epoch: 4 cost time: 1.6426656246185303
Epoch: 4, Steps: 8 | Train Loss: 0.941 Vali Loss: 0.726 Vali Acc: 0.834 Test Loss: 0.726 Test Acc: 0.834
Validation loss decreased (-0.674989 --> -0.834368).  Saving model ...
Epoch: 5 cost time: 2.037935972213745
Epoch: 5, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9620707035064697
Epoch: 6, Steps: 8 | Train Loss: 0.407 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2133281230926514
Epoch: 7, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7564353942871094
Epoch: 8, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.560 Vali Acc: 0.831 Test Loss: 0.560 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.830367088317871
Epoch: 9, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
Validation loss decreased (-0.834368 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 2.0390915870666504
Epoch: 10, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.844649076461792
Epoch: 11, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.580 Vali Acc: 0.831 Test Loss: 0.580 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8297553062438965
Epoch: 12, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9276087284088135
Epoch: 13, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.635 Vali Acc: 0.831 Test Loss: 0.635 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8648040294647217
Epoch: 14, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.641 Vali Acc: 0.834 Test Loss: 0.641 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7814178466796875
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2262871265411377
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6397075653076172
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.611 Vali Acc: 0.838 Test Loss: 0.611 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5534982681274414
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.610 Vali Acc: 0.847 Test Loss: 0.610 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0930707454681396
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.614 Vali Acc: 0.847 Test Loss: 0.614 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 7943864
model size : 35.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.74381160736084
Epoch: 1, Steps: 8 | Train Loss: 2.162 Vali Loss: 2.041 Vali Acc: 0.228 Test Loss: 2.041 Test Acc: 0.228
Validation loss decreased (inf --> -0.228105).  Saving model ...
Epoch: 2 cost time: 1.4823822975158691
Epoch: 2, Steps: 8 | Train Loss: 1.939 Vali Loss: 1.783 Vali Acc: 0.272 Test Loss: 1.783 Test Acc: 0.272
Validation loss decreased (-0.228105 --> -0.271857).  Saving model ...
Epoch: 3 cost time: 1.9241995811462402
Epoch: 3, Steps: 8 | Train Loss: 1.635 Vali Loss: 1.381 Vali Acc: 0.700 Test Loss: 1.381 Test Acc: 0.700
Validation loss decreased (-0.271857 --> -0.699986).  Saving model ...
Epoch: 4 cost time: 1.6899583339691162
Epoch: 4, Steps: 8 | Train Loss: 1.208 Vali Loss: 1.005 Vali Acc: 0.769 Test Loss: 1.005 Test Acc: 0.769
Validation loss decreased (-0.699986 --> -0.768740).  Saving model ...
Epoch: 5 cost time: 1.5992579460144043
Epoch: 5, Steps: 8 | Train Loss: 0.822 Vali Loss: 0.770 Vali Acc: 0.794 Test Loss: 0.770 Test Acc: 0.794
Validation loss decreased (-0.768740 --> -0.793742).  Saving model ...
Epoch: 6 cost time: 2.366258382797241
Epoch: 6, Steps: 8 | Train Loss: 0.656 Vali Loss: 0.638 Vali Acc: 0.809 Test Loss: 0.638 Test Acc: 0.809
Validation loss decreased (-0.793742 --> -0.809369).  Saving model ...
Epoch: 7 cost time: 1.5752580165863037
Epoch: 7, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.599 Vali Acc: 0.812 Test Loss: 0.599 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 8 cost time: 1.6686062812805176
Epoch: 8, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
Validation loss decreased (-0.812494 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 2.0844831466674805
Epoch: 9, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
Validation loss decreased (-0.824994 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 2.0687806606292725
Epoch: 10, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.094632387161255
Epoch: 11, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.537 Vali Acc: 0.847 Test Loss: 0.537 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3524229526519775
Epoch: 12, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.534 Vali Acc: 0.838 Test Loss: 0.534 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.830441951751709
Epoch: 13, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8106200695037842
Epoch: 14, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.855724573135376
Epoch: 15, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6322300434112549
Epoch: 16, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8113250732421875
Epoch: 17, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 1.9311497211456299
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.548 Vali Acc: 0.853 Test Loss: 0.548 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 19 cost time: 2.176779270172119
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9764249324798584
Epoch: 20, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.564 Vali Acc: 0.831 Test Loss: 0.564 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7993457317352295
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3320000171661377
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.163525104522705
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4160435199737549
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.554 Vali Acc: 0.847 Test Loss: 0.554 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5543856620788574
Epoch: 25, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6328630447387695
Epoch: 26, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.549 Vali Acc: 0.853 Test Loss: 0.549 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.902162790298462
Epoch: 27, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.563 Vali Acc: 0.853 Test Loss: 0.563 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9876854419708252
Epoch: 28, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856244).  Saving model ...
Epoch: 29 cost time: 1.4224433898925781
Epoch: 29, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.768507480621338
Epoch: 30, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.8632323741912842
Epoch: 31, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.568 Vali Acc: 0.844 Test Loss: 0.568 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.3407857418060303
Epoch: 32, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.570 Vali Acc: 0.847 Test Loss: 0.570 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.9230384826660156
Epoch: 33, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.578 Vali Acc: 0.844 Test Loss: 0.578 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.2508914470672607
Epoch: 34, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.285309076309204
Epoch: 35, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.9792041778564453
Epoch: 36, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.594 Vali Acc: 0.847 Test Loss: 0.594 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.082853317260742
Epoch: 37, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.594 Vali Acc: 0.847 Test Loss: 0.594 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.272879123687744
Epoch: 38, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 3767736
model size : 16.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.748911142349243
Epoch: 1, Steps: 8 | Train Loss: 2.168 Vali Loss: 2.053 Vali Acc: 0.156 Test Loss: 2.053 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 1.53035569190979
Epoch: 2, Steps: 8 | Train Loss: 1.982 Vali Loss: 1.841 Vali Acc: 0.412 Test Loss: 1.841 Test Acc: 0.412
Validation loss decreased (-0.156229 --> -0.412482).  Saving model ...
Epoch: 3 cost time: 1.9471039772033691
Epoch: 3, Steps: 8 | Train Loss: 1.731 Vali Loss: 1.527 Vali Acc: 0.603 Test Loss: 1.527 Test Acc: 0.603
Validation loss decreased (-0.412482 --> -0.603110).  Saving model ...
Epoch: 4 cost time: 1.8196284770965576
Epoch: 4, Steps: 8 | Train Loss: 1.371 Vali Loss: 1.146 Vali Acc: 0.744 Test Loss: 1.146 Test Acc: 0.744
Validation loss decreased (-0.603110 --> -0.743739).  Saving model ...
Epoch: 5 cost time: 2.0062263011932373
Epoch: 5, Steps: 8 | Train Loss: 0.982 Vali Loss: 0.843 Vali Acc: 0.781 Test Loss: 0.843 Test Acc: 0.781
Validation loss decreased (-0.743739 --> -0.781242).  Saving model ...
Epoch: 6 cost time: 1.9464373588562012
Epoch: 6, Steps: 8 | Train Loss: 0.736 Vali Loss: 0.695 Vali Acc: 0.794 Test Loss: 0.695 Test Acc: 0.794
Validation loss decreased (-0.781242 --> -0.793743).  Saving model ...
Epoch: 7 cost time: 1.788574457168579
Epoch: 7, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.604 Vali Acc: 0.812 Test Loss: 0.604 Test Acc: 0.812
Validation loss decreased (-0.793743 --> -0.812494).  Saving model ...
Epoch: 8 cost time: 1.9946460723876953
Epoch: 8, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 1.5464565753936768
Epoch: 9, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.579 Vali Acc: 0.816 Test Loss: 0.579 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4038982391357422
Epoch: 10, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.548 Vali Acc: 0.834 Test Loss: 0.548 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 1.5583112239837646
Epoch: 11, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.531 Vali Acc: 0.822 Test Loss: 0.531 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6846537590026855
Epoch: 12, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
Validation loss decreased (-0.834370 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 1.974348783493042
Epoch: 13, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9848356246948242
Epoch: 14, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7386550903320312
Epoch: 15, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9243981838226318
Epoch: 16, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.731684684753418
Epoch: 17, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6934969425201416
Epoch: 18, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7283837795257568
Epoch: 19, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8695456981658936
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6821379661560059
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.567 Vali Acc: 0.838 Test Loss: 0.567 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6971683502197266
Epoch: 22, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.571 Vali Acc: 0.834 Test Loss: 0.571 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 3761592
model size : 16.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.010993719100952
Epoch: 1, Steps: 8 | Train Loss: 2.136 Vali Loss: 2.034 Vali Acc: 0.184 Test Loss: 2.034 Test Acc: 0.184
Validation loss decreased (inf --> -0.184355).  Saving model ...
Epoch: 2 cost time: 1.4773879051208496
Epoch: 2, Steps: 8 | Train Loss: 2.030 Vali Loss: 1.859 Vali Acc: 0.425 Test Loss: 1.859 Test Acc: 0.425
Validation loss decreased (-0.184355 --> -0.424981).  Saving model ...
Epoch: 3 cost time: 1.8079869747161865
Epoch: 3, Steps: 8 | Train Loss: 1.707 Vali Loss: 1.512 Vali Acc: 0.597 Test Loss: 1.512 Test Acc: 0.597
Validation loss decreased (-0.424981 --> -0.596860).  Saving model ...
Epoch: 4 cost time: 1.8626248836517334
Epoch: 4, Steps: 8 | Train Loss: 1.381 Vali Loss: 1.137 Vali Acc: 0.744 Test Loss: 1.137 Test Acc: 0.744
Validation loss decreased (-0.596860 --> -0.743739).  Saving model ...
Epoch: 5 cost time: 1.473802089691162
Epoch: 5, Steps: 8 | Train Loss: 0.965 Vali Loss: 0.798 Vali Acc: 0.831 Test Loss: 0.798 Test Acc: 0.831
Validation loss decreased (-0.743739 --> -0.831242).  Saving model ...
Epoch: 6 cost time: 1.4779303073883057
Epoch: 6, Steps: 8 | Train Loss: 0.630 Vali Loss: 0.658 Vali Acc: 0.794 Test Loss: 0.658 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.957848072052002
Epoch: 7, Steps: 8 | Train Loss: 0.452 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6935529708862305
Epoch: 8, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
Validation loss decreased (-0.831242 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 1.9893465042114258
Epoch: 9, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 1.4916698932647705
Epoch: 10, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 1.535299301147461
Epoch: 11, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4135839939117432
Epoch: 12, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.502 Vali Acc: 0.866 Test Loss: 0.502 Test Acc: 0.866
Validation loss decreased (-0.849995 --> -0.865620).  Saving model ...
Epoch: 13 cost time: 1.7085750102996826
Epoch: 13, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.489 Vali Acc: 0.863 Test Loss: 0.489 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8873910903930664
Epoch: 14, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.454268455505371
Epoch: 15, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.499 Vali Acc: 0.847 Test Loss: 0.499 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8668138980865479
Epoch: 16, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.536 Vali Acc: 0.847 Test Loss: 0.536 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.497636079788208
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.538 Vali Acc: 0.859 Test Loss: 0.538 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5276598930358887
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.503 Vali Acc: 0.859 Test Loss: 0.503 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6377410888671875
Epoch: 19, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.515 Vali Acc: 0.853 Test Loss: 0.515 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4730825424194336
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5656688213348389
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.537 Vali Acc: 0.859 Test Loss: 0.537 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4387311935424805
Epoch: 22, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.544 Vali Acc: 0.853 Test Loss: 0.544 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 3755448
model size : 16.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8688600063323975
Epoch: 1, Steps: 8 | Train Loss: 2.177 Vali Loss: 2.073 Vali Acc: 0.147 Test Loss: 2.073 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 1.7686500549316406
Epoch: 2, Steps: 8 | Train Loss: 1.987 Vali Loss: 1.825 Vali Acc: 0.447 Test Loss: 1.825 Test Acc: 0.447
Validation loss decreased (-0.146854 --> -0.446857).  Saving model ...
Epoch: 3 cost time: 1.6378953456878662
Epoch: 3, Steps: 8 | Train Loss: 1.732 Vali Loss: 1.489 Vali Acc: 0.653 Test Loss: 1.489 Test Acc: 0.653
Validation loss decreased (-0.446857 --> -0.653110).  Saving model ...
Epoch: 4 cost time: 1.5681965351104736
Epoch: 4, Steps: 8 | Train Loss: 1.325 Vali Loss: 1.132 Vali Acc: 0.781 Test Loss: 1.132 Test Acc: 0.781
Validation loss decreased (-0.653110 --> -0.781239).  Saving model ...
Epoch: 5 cost time: 1.6616597175598145
Epoch: 5, Steps: 8 | Train Loss: 0.940 Vali Loss: 0.851 Vali Acc: 0.775 Test Loss: 0.851 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8038432598114014
Epoch: 6, Steps: 8 | Train Loss: 0.674 Vali Loss: 0.655 Vali Acc: 0.831 Test Loss: 0.655 Test Acc: 0.831
Validation loss decreased (-0.781239 --> -0.831243).  Saving model ...
Epoch: 7 cost time: 1.5395774841308594
Epoch: 7, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.620 Vali Acc: 0.797 Test Loss: 0.620 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7624335289001465
Epoch: 8, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.580 Vali Acc: 0.825 Test Loss: 0.580 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.814192771911621
Epoch: 9, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.542 Vali Acc: 0.822 Test Loss: 0.542 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5841913223266602
Epoch: 10, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
Validation loss decreased (-0.831243 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 1.523043155670166
Epoch: 11, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 1.5362353324890137
Epoch: 12, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.550 Vali Acc: 0.812 Test Loss: 0.550 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.823758602142334
Epoch: 13, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.538 Vali Acc: 0.847 Test Loss: 0.538 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 1.273383378982544
Epoch: 14, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.526 Vali Acc: 0.828 Test Loss: 0.526 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4606611728668213
Epoch: 15, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5214910507202148
Epoch: 16, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 1.804103136062622
Epoch: 17, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8066847324371338
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8631553649902344
Epoch: 19, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.567 Vali Acc: 0.841 Test Loss: 0.567 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9056453704833984
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3428208827972412
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 1.6038949489593506
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.530 Vali Acc: 0.847 Test Loss: 0.530 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7984061241149902
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6020197868347168
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.548 Vali Acc: 0.847 Test Loss: 0.548 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3873646259307861
Epoch: 25, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.617082118988037
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4454660415649414
Epoch: 27, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9414684772491455
Epoch: 28, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.8781273365020752
Epoch: 29, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.551 Vali Acc: 0.847 Test Loss: 0.551 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.93556809425354
Epoch: 30, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.553 Vali Acc: 0.847 Test Loss: 0.553 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6557726860046387
Epoch: 31, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 3749304
model size : 16.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.84197735786438
Epoch: 1, Steps: 8 | Train Loss: 2.238 Vali Loss: 2.128 Vali Acc: 0.116 Test Loss: 2.128 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 1.6950585842132568
Epoch: 2, Steps: 8 | Train Loss: 2.030 Vali Loss: 1.932 Vali Acc: 0.247 Test Loss: 1.932 Test Acc: 0.247
Validation loss decreased (-0.115604 --> -0.246856).  Saving model ...
Epoch: 3 cost time: 1.4577083587646484
Epoch: 3, Steps: 8 | Train Loss: 1.900 Vali Loss: 1.648 Vali Acc: 0.656 Test Loss: 1.648 Test Acc: 0.656
Validation loss decreased (-0.246856 --> -0.656234).  Saving model ...
Epoch: 4 cost time: 1.839444637298584
Epoch: 4, Steps: 8 | Train Loss: 1.527 Vali Loss: 1.316 Vali Acc: 0.675 Test Loss: 1.316 Test Acc: 0.675
Validation loss decreased (-0.656234 --> -0.674987).  Saving model ...
Epoch: 5 cost time: 1.4786107540130615
Epoch: 5, Steps: 8 | Train Loss: 1.159 Vali Loss: 0.955 Vali Acc: 0.797 Test Loss: 0.955 Test Acc: 0.797
Validation loss decreased (-0.674987 --> -0.796865).  Saving model ...
Epoch: 6 cost time: 1.6583282947540283
Epoch: 6, Steps: 8 | Train Loss: 0.804 Vali Loss: 0.735 Vali Acc: 0.794 Test Loss: 0.735 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6698317527770996
Epoch: 7, Steps: 8 | Train Loss: 0.559 Vali Loss: 0.584 Vali Acc: 0.853 Test Loss: 0.584 Test Acc: 0.853
Validation loss decreased (-0.796865 --> -0.853119).  Saving model ...
Epoch: 8 cost time: 1.9267053604125977
Epoch: 8, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8737871646881104
Epoch: 9, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9833858013153076
Epoch: 10, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9732592105865479
Epoch: 11, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.505033254623413
Epoch: 12, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4559345245361328
Epoch: 13, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6193058490753174
Epoch: 14, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4789021015167236
Epoch: 15, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.763524055480957
Epoch: 16, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8389816284179688
Epoch: 17, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 2846648
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.342612981796265
Epoch: 1, Steps: 8 | Train Loss: 2.176 Vali Loss: 2.015 Vali Acc: 0.200 Test Loss: 2.015 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 1.811697244644165
Epoch: 2, Steps: 8 | Train Loss: 1.972 Vali Loss: 1.816 Vali Acc: 0.356 Test Loss: 1.816 Test Acc: 0.356
Validation loss decreased (-0.199980 --> -0.356232).  Saving model ...
Epoch: 3 cost time: 1.4945924282073975
Epoch: 3, Steps: 8 | Train Loss: 1.763 Vali Loss: 1.518 Vali Acc: 0.616 Test Loss: 1.518 Test Acc: 0.616
Validation loss decreased (-0.356232 --> -0.615610).  Saving model ...
Epoch: 4 cost time: 1.5398411750793457
Epoch: 4, Steps: 8 | Train Loss: 1.456 Vali Loss: 1.192 Vali Acc: 0.772 Test Loss: 1.192 Test Acc: 0.772
Validation loss decreased (-0.615610 --> -0.771863).  Saving model ...
Epoch: 5 cost time: 1.9098484516143799
Epoch: 5, Steps: 8 | Train Loss: 1.064 Vali Loss: 0.943 Vali Acc: 0.747 Test Loss: 0.943 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.001859664916992
Epoch: 6, Steps: 8 | Train Loss: 0.749 Vali Loss: 0.702 Vali Acc: 0.809 Test Loss: 0.702 Test Acc: 0.809
Validation loss decreased (-0.771863 --> -0.809368).  Saving model ...
Epoch: 7 cost time: 1.621227502822876
Epoch: 7, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.627 Vali Acc: 0.831 Test Loss: 0.627 Test Acc: 0.831
Validation loss decreased (-0.809368 --> -0.831244).  Saving model ...
Epoch: 8 cost time: 1.6207494735717773
Epoch: 8, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.579 Vali Acc: 0.806 Test Loss: 0.579 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0339298248291016
Epoch: 9, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3136701583862305
Epoch: 10, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 1.8323328495025635
Epoch: 11, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.864302635192871
Epoch: 12, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6956942081451416
Epoch: 13, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 14 cost time: 1.9646809101104736
Epoch: 14, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 15 cost time: 1.8013570308685303
Epoch: 15, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.531 Vali Acc: 0.831 Test Loss: 0.531 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0192434787750244
Epoch: 16, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4657249450683594
Epoch: 17, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5423533916473389
Epoch: 18, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.555 Vali Acc: 0.834 Test Loss: 0.555 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6569418907165527
Epoch: 19, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.556 Vali Acc: 0.847 Test Loss: 0.556 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846869).  Saving model ...
Epoch: 20 cost time: 1.7705645561218262
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 1.6470818519592285
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.536 Vali Acc: 0.847 Test Loss: 0.536 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.072600841522217
Epoch: 22, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.628326416015625
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.582 Vali Acc: 0.847 Test Loss: 0.582 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3980803489685059
Epoch: 24, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4326868057250977
Epoch: 25, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.584 Vali Acc: 0.838 Test Loss: 0.584 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7540414333343506
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.651029348373413
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8131592273712158
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.589 Vali Acc: 0.847 Test Loss: 0.589 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.669166088104248
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.361074447631836
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.602 Vali Acc: 0.847 Test Loss: 0.602 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 2840504
model size : 13.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.560589075088501
Epoch: 1, Steps: 8 | Train Loss: 2.222 Vali Loss: 2.053 Vali Acc: 0.269 Test Loss: 2.053 Test Acc: 0.269
Validation loss decreased (inf --> -0.268729).  Saving model ...
Epoch: 2 cost time: 1.4523041248321533
Epoch: 2, Steps: 8 | Train Loss: 2.044 Vali Loss: 1.856 Vali Acc: 0.312 Test Loss: 1.856 Test Acc: 0.312
Validation loss decreased (-0.268729 --> -0.312481).  Saving model ...
Epoch: 3 cost time: 1.496424913406372
Epoch: 3, Steps: 8 | Train Loss: 1.811 Vali Loss: 1.552 Vali Acc: 0.581 Test Loss: 1.552 Test Acc: 0.581
Validation loss decreased (-0.312481 --> -0.581234).  Saving model ...
Epoch: 4 cost time: 1.3018848896026611
Epoch: 4, Steps: 8 | Train Loss: 1.487 Vali Loss: 1.193 Vali Acc: 0.741 Test Loss: 1.193 Test Acc: 0.741
Validation loss decreased (-0.581234 --> -0.740613).  Saving model ...
Epoch: 5 cost time: 1.431645393371582
Epoch: 5, Steps: 8 | Train Loss: 1.030 Vali Loss: 0.889 Vali Acc: 0.775 Test Loss: 0.889 Test Acc: 0.775
Validation loss decreased (-0.740613 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 1.3384850025177002
Epoch: 6, Steps: 8 | Train Loss: 0.767 Vali Loss: 0.687 Vali Acc: 0.816 Test Loss: 0.687 Test Acc: 0.816
Validation loss decreased (-0.774991 --> -0.815618).  Saving model ...
Epoch: 7 cost time: 1.4651579856872559
Epoch: 7, Steps: 8 | Train Loss: 0.534 Vali Loss: 0.577 Vali Acc: 0.834 Test Loss: 0.577 Test Acc: 0.834
Validation loss decreased (-0.815618 --> -0.834369).  Saving model ...
Epoch: 8 cost time: 1.7017033100128174
Epoch: 8, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 1.5126872062683105
Epoch: 9, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.541 Vali Acc: 0.834 Test Loss: 0.541 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.544581413269043
Epoch: 10, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.534 Vali Acc: 0.841 Test Loss: 0.534 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 1.6187646389007568
Epoch: 11, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.509 Vali Acc: 0.859 Test Loss: 0.509 Test Acc: 0.859
Validation loss decreased (-0.840620 --> -0.859370).  Saving model ...
Epoch: 12 cost time: 1.5047717094421387
Epoch: 12, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3852672576904297
Epoch: 13, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.518 Vali Acc: 0.847 Test Loss: 0.518 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.635206937789917
Epoch: 14, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7026467323303223
Epoch: 15, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9170129299163818
Epoch: 16, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.918257474899292
Epoch: 17, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.532 Vali Acc: 0.853 Test Loss: 0.532 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4304471015930176
Epoch: 18, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.775521993637085
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.545 Vali Acc: 0.847 Test Loss: 0.545 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8957853317260742
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.550 Vali Acc: 0.853 Test Loss: 0.550 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6974389553070068
Epoch: 21, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 2834360
model size : 13.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.13114070892334
Epoch: 1, Steps: 8 | Train Loss: 2.147 Vali Loss: 1.993 Vali Acc: 0.222 Test Loss: 1.993 Test Acc: 0.222
Validation loss decreased (inf --> -0.221855).  Saving model ...
Epoch: 2 cost time: 1.779038906097412
Epoch: 2, Steps: 8 | Train Loss: 1.968 Vali Loss: 1.831 Vali Acc: 0.362 Test Loss: 1.831 Test Acc: 0.362
Validation loss decreased (-0.221855 --> -0.362482).  Saving model ...
Epoch: 3 cost time: 1.5247018337249756
Epoch: 3, Steps: 8 | Train Loss: 1.742 Vali Loss: 1.514 Vali Acc: 0.628 Test Loss: 1.514 Test Acc: 0.628
Validation loss decreased (-0.362482 --> -0.628110).  Saving model ...
Epoch: 4 cost time: 1.65140700340271
Epoch: 4, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.173 Vali Acc: 0.703 Test Loss: 1.173 Test Acc: 0.703
Validation loss decreased (-0.628110 --> -0.703113).  Saving model ...
Epoch: 5 cost time: 2.1022138595581055
Epoch: 5, Steps: 8 | Train Loss: 1.010 Vali Loss: 0.862 Vali Acc: 0.800 Test Loss: 0.862 Test Acc: 0.800
Validation loss decreased (-0.703113 --> -0.799991).  Saving model ...
Epoch: 6 cost time: 2.178497791290283
Epoch: 6, Steps: 8 | Train Loss: 0.744 Vali Loss: 0.680 Vali Acc: 0.787 Test Loss: 0.680 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9600679874420166
Epoch: 7, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
Validation loss decreased (-0.799991 --> -0.809369).  Saving model ...
Epoch: 8 cost time: 2.3978731632232666
Epoch: 8, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
Validation loss decreased (-0.809369 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 1.5804409980773926
Epoch: 9, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2737553119659424
Epoch: 10, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9675865173339844
Epoch: 11, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 12 cost time: 1.678227186203003
Epoch: 12, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.526 Vali Acc: 0.831 Test Loss: 0.526 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.851238489151001
Epoch: 13, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5492331981658936
Epoch: 14, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 1.4884178638458252
Epoch: 15, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7493329048156738
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.796679973602295
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9802727699279785
Epoch: 18, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.536 Vali Acc: 0.847 Test Loss: 0.536 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.02933669090271
Epoch: 19, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.850797176361084
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.448596954345703
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.549 Vali Acc: 0.847 Test Loss: 0.549 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0074849128723145
Epoch: 22, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6442010402679443
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.584 Vali Acc: 0.841 Test Loss: 0.584 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.897742509841919
Epoch: 24, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.590 Vali Acc: 0.838 Test Loss: 0.590 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 2828216
model size : 13.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.0950963497161865
Epoch: 1, Steps: 8 | Train Loss: 2.144 Vali Loss: 2.040 Vali Acc: 0.181 Test Loss: 2.040 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 1.784576177597046
Epoch: 2, Steps: 8 | Train Loss: 2.036 Vali Loss: 1.897 Vali Acc: 0.419 Test Loss: 1.897 Test Acc: 0.419
Validation loss decreased (-0.181230 --> -0.418731).  Saving model ...
Epoch: 3 cost time: 1.684654951095581
Epoch: 3, Steps: 8 | Train Loss: 1.823 Vali Loss: 1.638 Vali Acc: 0.503 Test Loss: 1.638 Test Acc: 0.503
Validation loss decreased (-0.418731 --> -0.503109).  Saving model ...
Epoch: 4 cost time: 1.5454223155975342
Epoch: 4, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.308 Vali Acc: 0.741 Test Loss: 1.308 Test Acc: 0.741
Validation loss decreased (-0.503109 --> -0.740612).  Saving model ...
Epoch: 5 cost time: 1.734130620956421
Epoch: 5, Steps: 8 | Train Loss: 1.168 Vali Loss: 0.972 Vali Acc: 0.787 Test Loss: 0.972 Test Acc: 0.787
Validation loss decreased (-0.740612 --> -0.787490).  Saving model ...
Epoch: 6 cost time: 1.5292301177978516
Epoch: 6, Steps: 8 | Train Loss: 0.810 Vali Loss: 0.735 Vali Acc: 0.803 Test Loss: 0.735 Test Acc: 0.803
Validation loss decreased (-0.787490 --> -0.803118).  Saving model ...
Epoch: 7 cost time: 1.5490248203277588
Epoch: 7, Steps: 8 | Train Loss: 0.573 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
Validation loss decreased (-0.803118 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 1.6286649703979492
Epoch: 8, Steps: 8 | Train Loss: 0.472 Vali Loss: 0.576 Vali Acc: 0.825 Test Loss: 0.576 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 1.8835690021514893
Epoch: 9, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840619).  Saving model ...
Epoch: 10 cost time: 1.7020201683044434
Epoch: 10, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.520451545715332
Epoch: 11, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0309557914733887
Epoch: 12, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8764290809631348
Epoch: 13, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0016894340515137
Epoch: 14, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.530 Vali Acc: 0.825 Test Loss: 0.530 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0992629528045654
Epoch: 15, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.70377779006958
Epoch: 16, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9178354740142822
Epoch: 17, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7758777141571045
Epoch: 18, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9286465644836426
Epoch: 19, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 2386104
model size : 11.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.587204933166504
Epoch: 1, Steps: 8 | Train Loss: 2.284 Vali Loss: 2.141 Vali Acc: 0.153 Test Loss: 2.141 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 1.7540996074676514
Epoch: 2, Steps: 8 | Train Loss: 2.039 Vali Loss: 1.952 Vali Acc: 0.312 Test Loss: 1.952 Test Acc: 0.312
Validation loss decreased (-0.153104 --> -0.312480).  Saving model ...
Epoch: 3 cost time: 2.470335006713867
Epoch: 3, Steps: 8 | Train Loss: 1.890 Vali Loss: 1.696 Vali Acc: 0.550 Test Loss: 1.696 Test Acc: 0.550
Validation loss decreased (-0.312480 --> -0.549983).  Saving model ...
Epoch: 4 cost time: 2.0495052337646484
Epoch: 4, Steps: 8 | Train Loss: 1.528 Vali Loss: 1.381 Vali Acc: 0.731 Test Loss: 1.381 Test Acc: 0.731
Validation loss decreased (-0.549983 --> -0.731236).  Saving model ...
Epoch: 5 cost time: 1.4280235767364502
Epoch: 5, Steps: 8 | Train Loss: 1.271 Vali Loss: 1.061 Vali Acc: 0.747 Test Loss: 1.061 Test Acc: 0.747
Validation loss decreased (-0.731236 --> -0.746864).  Saving model ...
Epoch: 6 cost time: 1.3958327770233154
Epoch: 6, Steps: 8 | Train Loss: 0.861 Vali Loss: 0.803 Vali Acc: 0.806 Test Loss: 0.803 Test Acc: 0.806
Validation loss decreased (-0.746864 --> -0.806242).  Saving model ...
Epoch: 7 cost time: 2.32773494720459
Epoch: 7, Steps: 8 | Train Loss: 0.641 Vali Loss: 0.648 Vali Acc: 0.831 Test Loss: 0.648 Test Acc: 0.831
Validation loss decreased (-0.806242 --> -0.831244).  Saving model ...
Epoch: 8 cost time: 2.1532819271087646
Epoch: 8, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8423454761505127
Epoch: 9, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 1.7125799655914307
Epoch: 10, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3501977920532227
Epoch: 11, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.184098720550537
Epoch: 12, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3054332733154297
Epoch: 13, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3638699054718018
Epoch: 14, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 2.344897747039795
Epoch: 15, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.570 Vali Acc: 0.825 Test Loss: 0.570 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.509605884552002
Epoch: 16, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3066136837005615
Epoch: 17, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3793699741363525
Epoch: 18, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.3769490718841553
Epoch: 19, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.586 Vali Acc: 0.838 Test Loss: 0.586 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.3678863048553467
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.585 Vali Acc: 0.838 Test Loss: 0.585 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.2357850074768066
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.587 Vali Acc: 0.838 Test Loss: 0.587 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9896180629730225
Epoch: 22, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840619).  Saving model ...
Epoch: 23 cost time: 2.093590497970581
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.605 Vali Acc: 0.831 Test Loss: 0.605 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7638518810272217
Epoch: 24, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840619).  Saving model ...
Epoch: 25 cost time: 2.457791805267334
Epoch: 25, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.608 Vali Acc: 0.828 Test Loss: 0.608 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1999011039733887
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.614 Vali Acc: 0.825 Test Loss: 0.614 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7430706024169922
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.616 Vali Acc: 0.828 Test Loss: 0.616 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8673763275146484
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9397130012512207
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.615 Vali Acc: 0.834 Test Loss: 0.615 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9049155712127686
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.617 Vali Acc: 0.831 Test Loss: 0.617 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.9506707191467285
Epoch: 31, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.616 Vali Acc: 0.831 Test Loss: 0.616 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.124444007873535
Epoch: 32, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.619 Vali Acc: 0.834 Test Loss: 0.619 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.796030044555664
Epoch: 33, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.622 Vali Acc: 0.831 Test Loss: 0.622 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.830573558807373
Epoch: 34, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.627 Vali Acc: 0.828 Test Loss: 0.627 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 2379960
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.819746255874634
Epoch: 1, Steps: 8 | Train Loss: 2.150 Vali Loss: 2.022 Vali Acc: 0.222 Test Loss: 2.022 Test Acc: 0.222
Validation loss decreased (inf --> -0.221855).  Saving model ...
Epoch: 2 cost time: 1.8143775463104248
Epoch: 2, Steps: 8 | Train Loss: 1.996 Vali Loss: 1.854 Vali Acc: 0.353 Test Loss: 1.854 Test Acc: 0.353
Validation loss decreased (-0.221855 --> -0.353106).  Saving model ...
Epoch: 3 cost time: 1.5921330451965332
Epoch: 3, Steps: 8 | Train Loss: 1.765 Vali Loss: 1.579 Vali Acc: 0.575 Test Loss: 1.579 Test Acc: 0.575
Validation loss decreased (-0.353106 --> -0.574984).  Saving model ...
Epoch: 4 cost time: 1.7600715160369873
Epoch: 4, Steps: 8 | Train Loss: 1.474 Vali Loss: 1.263 Vali Acc: 0.731 Test Loss: 1.263 Test Acc: 0.731
Validation loss decreased (-0.574984 --> -0.731237).  Saving model ...
Epoch: 5 cost time: 1.6361908912658691
Epoch: 5, Steps: 8 | Train Loss: 1.121 Vali Loss: 0.956 Vali Acc: 0.778 Test Loss: 0.956 Test Acc: 0.778
Validation loss decreased (-0.731237 --> -0.778115).  Saving model ...
Epoch: 6 cost time: 1.2286877632141113
Epoch: 6, Steps: 8 | Train Loss: 0.822 Vali Loss: 0.747 Vali Acc: 0.803 Test Loss: 0.747 Test Acc: 0.803
Validation loss decreased (-0.778115 --> -0.803118).  Saving model ...
Epoch: 7 cost time: 1.5829687118530273
Epoch: 7, Steps: 8 | Train Loss: 0.648 Vali Loss: 0.651 Vali Acc: 0.794 Test Loss: 0.651 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.795663833618164
Epoch: 8, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
Validation loss decreased (-0.803118 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 1.3730854988098145
Epoch: 9, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.552 Vali Acc: 0.806 Test Loss: 0.552 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3672854900360107
Epoch: 10, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821870).  Saving model ...
Epoch: 11 cost time: 1.4645130634307861
Epoch: 11, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
Validation loss decreased (-0.821870 --> -0.834370).  Saving model ...
Epoch: 12 cost time: 1.8722643852233887
Epoch: 12, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 1.8702716827392578
Epoch: 13, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 1.5245118141174316
Epoch: 14, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6979293823242188
Epoch: 15, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4618728160858154
Epoch: 16, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6049082279205322
Epoch: 17, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8635501861572266
Epoch: 18, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5189683437347412
Epoch: 19, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.526 Vali Acc: 0.853 Test Loss: 0.526 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 20 cost time: 1.4814174175262451
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.334486722946167
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1340279579162598
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.724316120147705
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.721245527267456
Epoch: 24, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6418004035949707
Epoch: 25, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5205574035644531
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.955152988433838
Epoch: 27, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6220459938049316
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3254759311676025
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 2373816
model size : 11.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7122855186462402
Epoch: 1, Steps: 8 | Train Loss: 2.307 Vali Loss: 2.179 Vali Acc: 0.053 Test Loss: 2.179 Test Acc: 0.053
Validation loss decreased (inf --> -0.053103).  Saving model ...
Epoch: 2 cost time: 1.2580480575561523
Epoch: 2, Steps: 8 | Train Loss: 2.124 Vali Loss: 1.999 Vali Acc: 0.141 Test Loss: 1.999 Test Acc: 0.141
Validation loss decreased (-0.053103 --> -0.140605).  Saving model ...
Epoch: 3 cost time: 1.3320832252502441
Epoch: 3, Steps: 8 | Train Loss: 1.914 Vali Loss: 1.720 Vali Acc: 0.622 Test Loss: 1.720 Test Acc: 0.622
Validation loss decreased (-0.140605 --> -0.621858).  Saving model ...
Epoch: 4 cost time: 1.8139734268188477
Epoch: 4, Steps: 8 | Train Loss: 1.610 Vali Loss: 1.409 Vali Acc: 0.731 Test Loss: 1.409 Test Acc: 0.731
Validation loss decreased (-0.621858 --> -0.731236).  Saving model ...
Epoch: 5 cost time: 1.421839952468872
Epoch: 5, Steps: 8 | Train Loss: 1.270 Vali Loss: 1.057 Vali Acc: 0.753 Test Loss: 1.057 Test Acc: 0.753
Validation loss decreased (-0.731236 --> -0.753114).  Saving model ...
Epoch: 6 cost time: 1.3997628688812256
Epoch: 6, Steps: 8 | Train Loss: 0.883 Vali Loss: 0.759 Vali Acc: 0.819 Test Loss: 0.759 Test Acc: 0.819
Validation loss decreased (-0.753114 --> -0.818742).  Saving model ...
Epoch: 7 cost time: 1.8508789539337158
Epoch: 7, Steps: 8 | Train Loss: 0.571 Vali Loss: 0.629 Vali Acc: 0.816 Test Loss: 0.629 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6426417827606201
Epoch: 8, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.571 Vali Acc: 0.822 Test Loss: 0.571 Test Acc: 0.822
Validation loss decreased (-0.818742 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 1.8016636371612549
Epoch: 9, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.545 Vali Acc: 0.838 Test Loss: 0.545 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 1.9015636444091797
Epoch: 10, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4684257507324219
Epoch: 11, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 1.4215831756591797
Epoch: 12, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.493051528930664
Epoch: 13, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4068036079406738
Epoch: 14, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.560 Vali Acc: 0.831 Test Loss: 0.560 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5521631240844727
Epoch: 15, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 1.8335773944854736
Epoch: 16, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 1.7653379440307617
Epoch: 17, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.543 Vali Acc: 0.831 Test Loss: 0.543 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2068431377410889
Epoch: 18, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.529987096786499
Epoch: 19, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6801292896270752
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.681779384613037
Epoch: 21, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4738681316375732
Epoch: 22, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.06708025932312
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.571 Vali Acc: 0.834 Test Loss: 0.571 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4985413551330566
Epoch: 24, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.579 Vali Acc: 0.838 Test Loss: 0.579 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.0143518447875977
Epoch: 25, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.589 Vali Acc: 0.847 Test Loss: 0.589 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6732220649719238
Epoch: 26, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.591 Vali Acc: 0.841 Test Loss: 0.591 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 2367672
model size : 11.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.369498014450073
Epoch: 1, Steps: 8 | Train Loss: 2.340 Vali Loss: 2.137 Vali Acc: 0.178 Test Loss: 2.137 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 1.5634243488311768
Epoch: 2, Steps: 8 | Train Loss: 2.094 Vali Loss: 1.994 Vali Acc: 0.181 Test Loss: 1.994 Test Acc: 0.181
Validation loss decreased (-0.178104 --> -0.181230).  Saving model ...
Epoch: 3 cost time: 1.7109777927398682
Epoch: 3, Steps: 8 | Train Loss: 1.935 Vali Loss: 1.776 Vali Acc: 0.512 Test Loss: 1.776 Test Acc: 0.512
Validation loss decreased (-0.181230 --> -0.512482).  Saving model ...
Epoch: 4 cost time: 1.659499168395996
Epoch: 4, Steps: 8 | Train Loss: 1.698 Vali Loss: 1.522 Vali Acc: 0.594 Test Loss: 1.522 Test Acc: 0.594
Validation loss decreased (-0.512482 --> -0.593735).  Saving model ...
Epoch: 5 cost time: 2.073279619216919
Epoch: 5, Steps: 8 | Train Loss: 1.380 Vali Loss: 1.180 Vali Acc: 0.759 Test Loss: 1.180 Test Acc: 0.759
Validation loss decreased (-0.593735 --> -0.759363).  Saving model ...
Epoch: 6 cost time: 1.6680989265441895
Epoch: 6, Steps: 8 | Train Loss: 1.044 Vali Loss: 0.884 Vali Acc: 0.778 Test Loss: 0.884 Test Acc: 0.778
Validation loss decreased (-0.759363 --> -0.778116).  Saving model ...
Epoch: 7 cost time: 1.5570883750915527
Epoch: 7, Steps: 8 | Train Loss: 0.736 Vali Loss: 0.715 Vali Acc: 0.806 Test Loss: 0.715 Test Acc: 0.806
Validation loss decreased (-0.778116 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 1.4177772998809814
Epoch: 8, Steps: 8 | Train Loss: 0.531 Vali Loss: 0.594 Vali Acc: 0.831 Test Loss: 0.594 Test Acc: 0.831
Validation loss decreased (-0.806243 --> -0.831244).  Saving model ...
Epoch: 9 cost time: 1.6921157836914062
Epoch: 9, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7657346725463867
Epoch: 10, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4166412353515625
Epoch: 11, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 1.9564471244812012
Epoch: 12, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6546244621276855
Epoch: 13, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 14 cost time: 1.3616328239440918
Epoch: 14, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.514 Vali Acc: 0.853 Test Loss: 0.514 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 1.8612585067749023
Epoch: 15, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8016693592071533
Epoch: 16, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.554 Vali Acc: 0.838 Test Loss: 0.554 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7726008892059326
Epoch: 17, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5462934970855713
Epoch: 18, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.555 Vali Acc: 0.847 Test Loss: 0.555 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4265506267547607
Epoch: 19, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7057716846466064
Epoch: 20, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5466175079345703
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.560 Vali Acc: 0.847 Test Loss: 0.560 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6682777404785156
Epoch: 22, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4217314720153809
Epoch: 23, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.580834150314331
Epoch: 24, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.564 Vali Acc: 0.834 Test Loss: 0.564 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 2155832
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.813347339630127
Epoch: 1, Steps: 8 | Train Loss: 2.204 Vali Loss: 2.078 Vali Acc: 0.138 Test Loss: 2.078 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 2.268782377243042
Epoch: 2, Steps: 8 | Train Loss: 2.076 Vali Loss: 1.967 Vali Acc: 0.266 Test Loss: 1.967 Test Acc: 0.266
Validation loss decreased (-0.137479 --> -0.265605).  Saving model ...
Epoch: 3 cost time: 1.4662108421325684
Epoch: 3, Steps: 8 | Train Loss: 1.923 Vali Loss: 1.751 Vali Acc: 0.566 Test Loss: 1.751 Test Acc: 0.566
Validation loss decreased (-0.265605 --> -0.565607).  Saving model ...
Epoch: 4 cost time: 2.303576707839966
Epoch: 4, Steps: 8 | Train Loss: 1.682 Vali Loss: 1.490 Vali Acc: 0.713 Test Loss: 1.490 Test Acc: 0.713
Validation loss decreased (-0.565607 --> -0.712485).  Saving model ...
Epoch: 5 cost time: 1.8642535209655762
Epoch: 5, Steps: 8 | Train Loss: 1.423 Vali Loss: 1.182 Vali Acc: 0.719 Test Loss: 1.182 Test Acc: 0.719
Validation loss decreased (-0.712485 --> -0.718738).  Saving model ...
Epoch: 6 cost time: 1.933528184890747
Epoch: 6, Steps: 8 | Train Loss: 1.014 Vali Loss: 0.885 Vali Acc: 0.794 Test Loss: 0.885 Test Acc: 0.794
Validation loss decreased (-0.718738 --> -0.793741).  Saving model ...
Epoch: 7 cost time: 1.7194011211395264
Epoch: 7, Steps: 8 | Train Loss: 0.718 Vali Loss: 0.709 Vali Acc: 0.794 Test Loss: 0.709 Test Acc: 0.794
Validation loss decreased (-0.793741 --> -0.793743).  Saving model ...
Epoch: 8 cost time: 1.80660080909729
Epoch: 8, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.641 Vali Acc: 0.787 Test Loss: 0.641 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8182547092437744
Epoch: 9, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
Validation loss decreased (-0.793743 --> -0.837494).  Saving model ...
Epoch: 10 cost time: 2.189509153366089
Epoch: 10, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.878340482711792
Epoch: 11, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.550 Vali Acc: 0.806 Test Loss: 0.550 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0298192501068115
Epoch: 12, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843745).  Saving model ...
Epoch: 13 cost time: 2.115053176879883
Epoch: 13, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.862267017364502
Epoch: 14, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.556 Vali Acc: 0.834 Test Loss: 0.556 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.933347225189209
Epoch: 15, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7647812366485596
Epoch: 16, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4326119422912598
Epoch: 17, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.955204725265503
Epoch: 18, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.545 Vali Acc: 0.834 Test Loss: 0.545 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2361204624176025
Epoch: 19, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.551 Vali Acc: 0.838 Test Loss: 0.551 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.064567804336548
Epoch: 20, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.397017240524292
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.567 Vali Acc: 0.831 Test Loss: 0.567 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.057831287384033
Epoch: 22, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.577 Vali Acc: 0.838 Test Loss: 0.577 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 2149688
model size : 10.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2202064990997314
Epoch: 1, Steps: 8 | Train Loss: 2.178 Vali Loss: 2.087 Vali Acc: 0.178 Test Loss: 2.087 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 1.5037727355957031
Epoch: 2, Steps: 8 | Train Loss: 2.006 Vali Loss: 1.882 Vali Acc: 0.344 Test Loss: 1.882 Test Acc: 0.344
Validation loss decreased (-0.178104 --> -0.343731).  Saving model ...
Epoch: 3 cost time: 1.5422182083129883
Epoch: 3, Steps: 8 | Train Loss: 1.766 Vali Loss: 1.593 Vali Acc: 0.650 Test Loss: 1.593 Test Acc: 0.650
Validation loss decreased (-0.343731 --> -0.649984).  Saving model ...
Epoch: 4 cost time: 1.4261488914489746
Epoch: 4, Steps: 8 | Train Loss: 1.477 Vali Loss: 1.240 Vali Acc: 0.747 Test Loss: 1.240 Test Acc: 0.747
Validation loss decreased (-0.649984 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 1.6877365112304688
Epoch: 5, Steps: 8 | Train Loss: 1.099 Vali Loss: 0.954 Vali Acc: 0.778 Test Loss: 0.954 Test Acc: 0.778
Validation loss decreased (-0.746863 --> -0.778115).  Saving model ...
Epoch: 6 cost time: 1.4268734455108643
Epoch: 6, Steps: 8 | Train Loss: 0.830 Vali Loss: 0.733 Vali Acc: 0.800 Test Loss: 0.733 Test Acc: 0.800
Validation loss decreased (-0.778115 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 1.6582002639770508
Epoch: 7, Steps: 8 | Train Loss: 0.615 Vali Loss: 0.620 Vali Acc: 0.838 Test Loss: 0.620 Test Acc: 0.838
Validation loss decreased (-0.799993 --> -0.837494).  Saving model ...
Epoch: 8 cost time: 1.582732915878296
Epoch: 8, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.575 Vali Acc: 0.806 Test Loss: 0.575 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4197733402252197
Epoch: 9, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 1.6240549087524414
Epoch: 10, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8467602729797363
Epoch: 11, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.512 Vali Acc: 0.828 Test Loss: 0.512 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.721569538116455
Epoch: 12, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.510 Vali Acc: 0.859 Test Loss: 0.510 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859370).  Saving model ...
Epoch: 13 cost time: 1.4299232959747314
Epoch: 13, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.538 Vali Acc: 0.831 Test Loss: 0.538 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5361108779907227
Epoch: 14, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.471703052520752
Epoch: 15, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.521 Vali Acc: 0.859 Test Loss: 0.521 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6871352195739746
Epoch: 16, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3649673461914062
Epoch: 17, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.577 Vali Acc: 0.841 Test Loss: 0.577 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5712735652923584
Epoch: 18, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.566 Vali Acc: 0.838 Test Loss: 0.566 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1733336448669434
Epoch: 19, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.547 Vali Acc: 0.853 Test Loss: 0.547 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.296644926071167
Epoch: 20, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4337084293365479
Epoch: 21, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.578 Vali Acc: 0.853 Test Loss: 0.578 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.732041835784912
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.569 Vali Acc: 0.863 Test Loss: 0.569 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862494).  Saving model ...
Epoch: 23 cost time: 1.505540370941162
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.558 Vali Acc: 0.853 Test Loss: 0.558 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2833621501922607
Epoch: 24, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.570 Vali Acc: 0.869 Test Loss: 0.570 Test Acc: 0.869
Validation loss decreased (-0.862494 --> -0.868744).  Saving model ...
Epoch: 25 cost time: 1.3203277587890625
Epoch: 25, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.587 Vali Acc: 0.866 Test Loss: 0.587 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3139934539794922
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.859 Test Loss: 0.596 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5254621505737305
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.606 Vali Acc: 0.856 Test Loss: 0.606 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3872439861297607
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.600 Vali Acc: 0.866 Test Loss: 0.600 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4590508937835693
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.605 Vali Acc: 0.856 Test Loss: 0.605 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.431361436843872
Epoch: 30, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.609 Vali Acc: 0.863 Test Loss: 0.609 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2973885536193848
Epoch: 31, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.609 Vali Acc: 0.863 Test Loss: 0.609 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5171751976013184
Epoch: 32, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.609 Vali Acc: 0.863 Test Loss: 0.609 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.529637098312378
Epoch: 33, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.623 Vali Acc: 0.859 Test Loss: 0.623 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.537017583847046
Epoch: 34, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.630 Vali Acc: 0.866 Test Loss: 0.630 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 2143544
model size : 10.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8768489360809326
Epoch: 1, Steps: 8 | Train Loss: 2.209 Vali Loss: 2.029 Vali Acc: 0.250 Test Loss: 2.029 Test Acc: 0.250
Validation loss decreased (inf --> -0.249980).  Saving model ...
Epoch: 2 cost time: 1.6514360904693604
Epoch: 2, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.893 Vali Acc: 0.356 Test Loss: 1.893 Test Acc: 0.356
Validation loss decreased (-0.249980 --> -0.356231).  Saving model ...
Epoch: 3 cost time: 1.5033109188079834
Epoch: 3, Steps: 8 | Train Loss: 1.812 Vali Loss: 1.616 Vali Acc: 0.600 Test Loss: 1.616 Test Acc: 0.600
Validation loss decreased (-0.356231 --> -0.599984).  Saving model ...
Epoch: 4 cost time: 1.5960030555725098
Epoch: 4, Steps: 8 | Train Loss: 1.480 Vali Loss: 1.314 Vali Acc: 0.691 Test Loss: 1.314 Test Acc: 0.691
Validation loss decreased (-0.599984 --> -0.690612).  Saving model ...
Epoch: 5 cost time: 1.7001349925994873
Epoch: 5, Steps: 8 | Train Loss: 1.127 Vali Loss: 0.971 Vali Acc: 0.775 Test Loss: 0.971 Test Acc: 0.775
Validation loss decreased (-0.690612 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 1.6761562824249268
Epoch: 6, Steps: 8 | Train Loss: 0.864 Vali Loss: 0.758 Vali Acc: 0.778 Test Loss: 0.758 Test Acc: 0.778
Validation loss decreased (-0.774990 --> -0.778117).  Saving model ...
Epoch: 7 cost time: 1.3905470371246338
Epoch: 7, Steps: 8 | Train Loss: 0.601 Vali Loss: 0.665 Vali Acc: 0.806 Test Loss: 0.665 Test Acc: 0.806
Validation loss decreased (-0.778117 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 1.3273446559906006
Epoch: 8, Steps: 8 | Train Loss: 0.450 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
Validation loss decreased (-0.806243 --> -0.818744).  Saving model ...
Epoch: 9 cost time: 1.8887619972229004
Epoch: 9, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.818744 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 1.4798002243041992
Epoch: 10, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5883455276489258
Epoch: 11, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.650024652481079
Epoch: 12, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.541 Vali Acc: 0.847 Test Loss: 0.541 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 13 cost time: 1.5645089149475098
Epoch: 13, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2468481063842773
Epoch: 14, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 1.1537232398986816
Epoch: 15, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.559 Vali Acc: 0.847 Test Loss: 0.559 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.298074722290039
Epoch: 16, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2951381206512451
Epoch: 17, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4937818050384521
Epoch: 18, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.572 Vali Acc: 0.831 Test Loss: 0.572 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.524932622909546
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.574 Vali Acc: 0.828 Test Loss: 0.574 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.672126054763794
Epoch: 20, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.589 Vali Acc: 0.838 Test Loss: 0.589 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3296327590942383
Epoch: 21, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4195270538330078
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.581 Vali Acc: 0.853 Test Loss: 0.581 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853119).  Saving model ...
Epoch: 23 cost time: 1.2165768146514893
Epoch: 23, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.606 Vali Acc: 0.841 Test Loss: 0.606 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4952788352966309
Epoch: 24, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.611 Vali Acc: 0.838 Test Loss: 0.611 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.641026496887207
Epoch: 25, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.633 Vali Acc: 0.831 Test Loss: 0.633 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3984355926513672
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.628 Vali Acc: 0.834 Test Loss: 0.628 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4083726406097412
Epoch: 27, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.632 Vali Acc: 0.831 Test Loss: 0.632 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7587811946868896
Epoch: 28, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.265955924987793
Epoch: 29, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3915622234344482
Epoch: 30, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.647 Vali Acc: 0.819 Test Loss: 0.647 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3472397327423096
Epoch: 31, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.686 Vali Acc: 0.819 Test Loss: 0.686 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4261665344238281
Epoch: 32, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.668 Vali Acc: 0.838 Test Loss: 0.668 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 2137400
model size : 10.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3044211864471436
Epoch: 1, Steps: 8 | Train Loss: 2.183 Vali Loss: 2.109 Vali Acc: 0.116 Test Loss: 2.109 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 1.519923448562622
Epoch: 2, Steps: 8 | Train Loss: 2.106 Vali Loss: 1.985 Vali Acc: 0.197 Test Loss: 1.985 Test Acc: 0.197
Validation loss decreased (-0.115604 --> -0.196855).  Saving model ...
Epoch: 3 cost time: 1.3762505054473877
Epoch: 3, Steps: 8 | Train Loss: 1.929 Vali Loss: 1.827 Vali Acc: 0.378 Test Loss: 1.827 Test Acc: 0.378
Validation loss decreased (-0.196855 --> -0.378107).  Saving model ...
Epoch: 4 cost time: 1.3991155624389648
Epoch: 4, Steps: 8 | Train Loss: 1.773 Vali Loss: 1.608 Vali Acc: 0.653 Test Loss: 1.608 Test Acc: 0.653
Validation loss decreased (-0.378107 --> -0.653109).  Saving model ...
Epoch: 5 cost time: 1.4366345405578613
Epoch: 5, Steps: 8 | Train Loss: 1.500 Vali Loss: 1.321 Vali Acc: 0.719 Test Loss: 1.321 Test Acc: 0.719
Validation loss decreased (-0.653109 --> -0.718737).  Saving model ...
Epoch: 6 cost time: 1.2413506507873535
Epoch: 6, Steps: 8 | Train Loss: 1.143 Vali Loss: 1.049 Vali Acc: 0.787 Test Loss: 1.049 Test Acc: 0.787
Validation loss decreased (-0.718737 --> -0.787490).  Saving model ...
Epoch: 7 cost time: 1.465528964996338
Epoch: 7, Steps: 8 | Train Loss: 0.882 Vali Loss: 0.871 Vali Acc: 0.803 Test Loss: 0.871 Test Acc: 0.803
Validation loss decreased (-0.787490 --> -0.803116).  Saving model ...
Epoch: 8 cost time: 1.60136079788208
Epoch: 8, Steps: 8 | Train Loss: 0.748 Vali Loss: 0.745 Vali Acc: 0.794 Test Loss: 0.745 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.738741159439087
Epoch: 9, Steps: 8 | Train Loss: 0.540 Vali Loss: 0.668 Vali Acc: 0.809 Test Loss: 0.668 Test Acc: 0.809
Validation loss decreased (-0.803116 --> -0.809368).  Saving model ...
Epoch: 10 cost time: 1.6823601722717285
Epoch: 10, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
Validation loss decreased (-0.809368 --> -0.828119).  Saving model ...
Epoch: 11 cost time: 1.5307197570800781
Epoch: 11, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.579 Vali Acc: 0.816 Test Loss: 0.579 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.642327070236206
Epoch: 12, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
Validation loss decreased (-0.828119 --> -0.843745).  Saving model ...
Epoch: 13 cost time: 1.8980636596679688
Epoch: 13, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5534100532531738
Epoch: 14, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5813088417053223
Epoch: 15, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.520 Vali Acc: 0.834 Test Loss: 0.520 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9456405639648438
Epoch: 16, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4857170581817627
Epoch: 17, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.507 Vali Acc: 0.847 Test Loss: 0.507 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 18 cost time: 1.4434711933135986
Epoch: 18, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5458693504333496
Epoch: 19, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1934723854064941
Epoch: 20, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.514 Vali Acc: 0.831 Test Loss: 0.514 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.616196870803833
Epoch: 21, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5697581768035889
Epoch: 22, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 23 cost time: 1.533797264099121
Epoch: 23, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.506 Vali Acc: 0.847 Test Loss: 0.506 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.632253646850586
Epoch: 24, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.480680227279663
Epoch: 25, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.512 Vali Acc: 0.831 Test Loss: 0.512 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.803300142288208
Epoch: 26, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.529 Vali Acc: 0.828 Test Loss: 0.529 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3504910469055176
Epoch: 27, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5181386470794678
Epoch: 28, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5052814483642578
Epoch: 29, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5163657665252686
Epoch: 30, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.419727087020874
Epoch: 31, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.506939172744751
Epoch: 32, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 1428728
model size : 6.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4948432445526123
Epoch: 1, Steps: 8 | Train Loss: 2.213 Vali Loss: 2.100 Vali Acc: 0.178 Test Loss: 2.100 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 1.6456785202026367
Epoch: 2, Steps: 8 | Train Loss: 2.090 Vali Loss: 1.978 Vali Acc: 0.256 Test Loss: 1.978 Test Acc: 0.256
Validation loss decreased (-0.178104 --> -0.256230).  Saving model ...
Epoch: 3 cost time: 1.8836936950683594
Epoch: 3, Steps: 8 | Train Loss: 1.958 Vali Loss: 1.827 Vali Acc: 0.478 Test Loss: 1.827 Test Acc: 0.478
Validation loss decreased (-0.256230 --> -0.478107).  Saving model ...
Epoch: 4 cost time: 2.138665199279785
Epoch: 4, Steps: 8 | Train Loss: 1.811 Vali Loss: 1.610 Vali Acc: 0.603 Test Loss: 1.610 Test Acc: 0.603
Validation loss decreased (-0.478107 --> -0.603109).  Saving model ...
Epoch: 5 cost time: 1.3337457180023193
Epoch: 5, Steps: 8 | Train Loss: 1.506 Vali Loss: 1.321 Vali Acc: 0.713 Test Loss: 1.321 Test Acc: 0.713
Validation loss decreased (-0.603109 --> -0.712487).  Saving model ...
Epoch: 6 cost time: 1.3530218601226807
Epoch: 6, Steps: 8 | Train Loss: 1.248 Vali Loss: 1.058 Vali Acc: 0.772 Test Loss: 1.058 Test Acc: 0.772
Validation loss decreased (-0.712487 --> -0.771864).  Saving model ...
Epoch: 7 cost time: 1.6266562938690186
Epoch: 7, Steps: 8 | Train Loss: 0.921 Vali Loss: 0.851 Vali Acc: 0.778 Test Loss: 0.851 Test Acc: 0.778
Validation loss decreased (-0.771864 --> -0.778116).  Saving model ...
Epoch: 8 cost time: 1.7678682804107666
Epoch: 8, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.722 Vali Acc: 0.803 Test Loss: 0.722 Test Acc: 0.803
Validation loss decreased (-0.778116 --> -0.803118).  Saving model ...
Epoch: 9 cost time: 1.8828625679016113
Epoch: 9, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.636 Vali Acc: 0.825 Test Loss: 0.636 Test Acc: 0.825
Validation loss decreased (-0.803118 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 1.3558385372161865
Epoch: 10, Steps: 8 | Train Loss: 0.475 Vali Loss: 0.594 Vali Acc: 0.819 Test Loss: 0.594 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8100922107696533
Epoch: 11, Steps: 8 | Train Loss: 0.399 Vali Loss: 0.564 Vali Acc: 0.831 Test Loss: 0.564 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 1.5601532459259033
Epoch: 12, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.543 Vali Acc: 0.853 Test Loss: 0.543 Test Acc: 0.853
Validation loss decreased (-0.831244 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 1.302462100982666
Epoch: 13, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.853243350982666
Epoch: 14, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.527 Vali Acc: 0.847 Test Loss: 0.527 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5491645336151123
Epoch: 15, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 16 cost time: 1.533454418182373
Epoch: 16, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7225518226623535
Epoch: 17, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2749695777893066
Epoch: 18, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3173904418945312
Epoch: 19, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4725885391235352
Epoch: 20, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.08087420463562
Epoch: 21, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.337587594985962
Epoch: 22, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.504 Vali Acc: 0.863 Test Loss: 0.504 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 23 cost time: 1.678086280822754
Epoch: 23, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.509 Vali Acc: 0.859 Test Loss: 0.509 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6423203945159912
Epoch: 24, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.506 Vali Acc: 0.847 Test Loss: 0.506 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5314829349517822
Epoch: 25, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.384582281112671
Epoch: 26, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.524 Vali Acc: 0.847 Test Loss: 0.524 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5464091300964355
Epoch: 27, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.484203815460205
Epoch: 28, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4886763095855713
Epoch: 29, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.519 Vali Acc: 0.859 Test Loss: 0.519 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5883169174194336
Epoch: 30, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4023308753967285
Epoch: 31, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.5524828433990479
Epoch: 32, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.517 Vali Acc: 0.856 Test Loss: 0.517 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 1425656
model size : 6.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.392385959625244
Epoch: 1, Steps: 8 | Train Loss: 2.180 Vali Loss: 2.033 Vali Acc: 0.225 Test Loss: 2.033 Test Acc: 0.225
Validation loss decreased (inf --> -0.224980).  Saving model ...
Epoch: 2 cost time: 1.4528155326843262
Epoch: 2, Steps: 8 | Train Loss: 1.991 Vali Loss: 1.907 Vali Acc: 0.266 Test Loss: 1.907 Test Acc: 0.266
Validation loss decreased (-0.224980 --> -0.265606).  Saving model ...
Epoch: 3 cost time: 1.7996165752410889
Epoch: 3, Steps: 8 | Train Loss: 1.898 Vali Loss: 1.711 Vali Acc: 0.537 Test Loss: 1.711 Test Acc: 0.537
Validation loss decreased (-0.265606 --> -0.537483).  Saving model ...
Epoch: 4 cost time: 1.759558916091919
Epoch: 4, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.462 Vali Acc: 0.637 Test Loss: 1.462 Test Acc: 0.637
Validation loss decreased (-0.537483 --> -0.637485).  Saving model ...
Epoch: 5 cost time: 1.6237547397613525
Epoch: 5, Steps: 8 | Train Loss: 1.331 Vali Loss: 1.169 Vali Acc: 0.747 Test Loss: 1.169 Test Acc: 0.747
Validation loss decreased (-0.637485 --> -0.746863).  Saving model ...
Epoch: 6 cost time: 1.5624363422393799
Epoch: 6, Steps: 8 | Train Loss: 1.046 Vali Loss: 0.928 Vali Acc: 0.819 Test Loss: 0.928 Test Acc: 0.819
Validation loss decreased (-0.746863 --> -0.818741).  Saving model ...
Epoch: 7 cost time: 1.4596097469329834
Epoch: 7, Steps: 8 | Train Loss: 0.792 Vali Loss: 0.759 Vali Acc: 0.828 Test Loss: 0.759 Test Acc: 0.828
Validation loss decreased (-0.818741 --> -0.828117).  Saving model ...
Epoch: 8 cost time: 1.079667329788208
Epoch: 8, Steps: 8 | Train Loss: 0.633 Vali Loss: 0.682 Vali Acc: 0.797 Test Loss: 0.682 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7265419960021973
Epoch: 9, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
Validation loss decreased (-0.828117 --> -0.843744).  Saving model ...
Epoch: 10 cost time: 1.4697461128234863
Epoch: 10, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8365204334259033
Epoch: 11, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 12 cost time: 1.6043462753295898
Epoch: 12, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 13 cost time: 1.7194678783416748
Epoch: 13, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 1.4378678798675537
Epoch: 14, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7686560153961182
Epoch: 15, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5280606746673584
Epoch: 16, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8338735103607178
Epoch: 17, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.497 Vali Acc: 0.844 Test Loss: 0.497 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3816847801208496
Epoch: 18, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 19 cost time: 1.6678905487060547
Epoch: 19, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.500 Vali Acc: 0.853 Test Loss: 0.500 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1739764213562012
Epoch: 20, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.506462812423706
Epoch: 21, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6349163055419922
Epoch: 22, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6894800662994385
Epoch: 23, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.500 Vali Acc: 0.853 Test Loss: 0.500 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6307182312011719
Epoch: 24, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4908101558685303
Epoch: 25, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.510 Vali Acc: 0.856 Test Loss: 0.510 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3585424423217773
Epoch: 26, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.501 Vali Acc: 0.859 Test Loss: 0.501 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.57718825340271
Epoch: 27, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.509 Vali Acc: 0.853 Test Loss: 0.509 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5790867805480957
Epoch: 28, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 1422584
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.233643293380737
Epoch: 1, Steps: 8 | Train Loss: 2.166 Vali Loss: 2.107 Vali Acc: 0.122 Test Loss: 2.107 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 2.012080669403076
Epoch: 2, Steps: 8 | Train Loss: 2.042 Vali Loss: 1.966 Vali Acc: 0.275 Test Loss: 1.966 Test Acc: 0.275
Validation loss decreased (-0.121854 --> -0.274980).  Saving model ...
Epoch: 3 cost time: 1.3666422367095947
Epoch: 3, Steps: 8 | Train Loss: 1.919 Vali Loss: 1.799 Vali Acc: 0.434 Test Loss: 1.799 Test Acc: 0.434
Validation loss decreased (-0.274980 --> -0.434357).  Saving model ...
Epoch: 4 cost time: 2.208568572998047
Epoch: 4, Steps: 8 | Train Loss: 1.718 Vali Loss: 1.585 Vali Acc: 0.578 Test Loss: 1.585 Test Acc: 0.578
Validation loss decreased (-0.434357 --> -0.578109).  Saving model ...
Epoch: 5 cost time: 1.842404842376709
Epoch: 5, Steps: 8 | Train Loss: 1.455 Vali Loss: 1.281 Vali Acc: 0.722 Test Loss: 1.281 Test Acc: 0.722
Validation loss decreased (-0.578109 --> -0.721862).  Saving model ...
Epoch: 6 cost time: 1.6619014739990234
Epoch: 6, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.035 Vali Acc: 0.794 Test Loss: 1.035 Test Acc: 0.794
Validation loss decreased (-0.721862 --> -0.793740).  Saving model ...
Epoch: 7 cost time: 1.845801591873169
Epoch: 7, Steps: 8 | Train Loss: 0.857 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8525469303131104
Epoch: 8, Steps: 8 | Train Loss: 0.723 Vali Loss: 0.715 Vali Acc: 0.784 Test Loss: 0.715 Test Acc: 0.784
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.042121410369873
Epoch: 9, Steps: 8 | Train Loss: 0.581 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
Validation loss decreased (-0.793740 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 2.175158977508545
Epoch: 10, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.590 Vali Acc: 0.838 Test Loss: 0.590 Test Acc: 0.838
Validation loss decreased (-0.821869 --> -0.837494).  Saving model ...
Epoch: 11 cost time: 2.2208361625671387
Epoch: 11, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.543 Vali Acc: 0.834 Test Loss: 0.543 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4220480918884277
Epoch: 12, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.546 Vali Acc: 0.819 Test Loss: 0.546 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.229314088821411
Epoch: 13, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.712514877319336
Epoch: 14, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 15 cost time: 1.6258289813995361
Epoch: 15, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.200775146484375
Epoch: 16, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 17 cost time: 1.7979645729064941
Epoch: 17, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1531245708465576
Epoch: 18, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.540926933288574
Epoch: 19, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 2.7615103721618652
Epoch: 20, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.515 Vali Acc: 0.834 Test Loss: 0.515 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.233823299407959
Epoch: 21, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 2.031029224395752
Epoch: 22, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.116581678390503
Epoch: 23, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 24 cost time: 1.671452283859253
Epoch: 24, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1621387004852295
Epoch: 25, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9766156673431396
Epoch: 26, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.515 Vali Acc: 0.847 Test Loss: 0.515 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7832722663879395
Epoch: 27, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.7898590564727783
Epoch: 28, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.369130849838257
Epoch: 29, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.130513906478882
Epoch: 30, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.2573366165161133
Epoch: 31, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.961867094039917
Epoch: 32, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7144536972045898
Epoch: 33, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 1419512
model size : 6.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.222461938858032
Epoch: 1, Steps: 8 | Train Loss: 2.090 Vali Loss: 1.989 Vali Acc: 0.297 Test Loss: 1.989 Test Acc: 0.297
Validation loss decreased (inf --> -0.296855).  Saving model ...
Epoch: 2 cost time: 1.5532350540161133
Epoch: 2, Steps: 8 | Train Loss: 2.001 Vali Loss: 1.879 Vali Acc: 0.362 Test Loss: 1.879 Test Acc: 0.362
Validation loss decreased (-0.296855 --> -0.362481).  Saving model ...
Epoch: 3 cost time: 1.9152727127075195
Epoch: 3, Steps: 8 | Train Loss: 1.882 Vali Loss: 1.713 Vali Acc: 0.572 Test Loss: 1.713 Test Acc: 0.572
Validation loss decreased (-0.362481 --> -0.571858).  Saving model ...
Epoch: 4 cost time: 1.6715807914733887
Epoch: 4, Steps: 8 | Train Loss: 1.621 Vali Loss: 1.498 Vali Acc: 0.681 Test Loss: 1.498 Test Acc: 0.681
Validation loss decreased (-0.571858 --> -0.681235).  Saving model ...
Epoch: 5 cost time: 1.5738141536712646
Epoch: 5, Steps: 8 | Train Loss: 1.449 Vali Loss: 1.259 Vali Acc: 0.722 Test Loss: 1.259 Test Acc: 0.722
Validation loss decreased (-0.681235 --> -0.721862).  Saving model ...
Epoch: 6 cost time: 1.8056297302246094
Epoch: 6, Steps: 8 | Train Loss: 1.121 Vali Loss: 1.021 Vali Acc: 0.784 Test Loss: 1.021 Test Acc: 0.784
Validation loss decreased (-0.721862 --> -0.784365).  Saving model ...
Epoch: 7 cost time: 1.9478058815002441
Epoch: 7, Steps: 8 | Train Loss: 0.852 Vali Loss: 0.848 Vali Acc: 0.787 Test Loss: 0.848 Test Acc: 0.787
Validation loss decreased (-0.784365 --> -0.787492).  Saving model ...
Epoch: 8 cost time: 1.888228416442871
Epoch: 8, Steps: 8 | Train Loss: 0.670 Vali Loss: 0.723 Vali Acc: 0.803 Test Loss: 0.723 Test Acc: 0.803
Validation loss decreased (-0.787492 --> -0.803118).  Saving model ...
Epoch: 9 cost time: 2.2138710021972656
Epoch: 9, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
Validation loss decreased (-0.803118 --> -0.809369).  Saving model ...
Epoch: 10 cost time: 1.8009324073791504
Epoch: 10, Steps: 8 | Train Loss: 0.454 Vali Loss: 0.592 Vali Acc: 0.812 Test Loss: 0.592 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 11 cost time: 1.4193484783172607
Epoch: 11, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 12 cost time: 1.6896512508392334
Epoch: 12, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 2.020465135574341
Epoch: 13, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 1.8913040161132812
Epoch: 14, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.542 Vali Acc: 0.822 Test Loss: 0.542 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0293891429901123
Epoch: 15, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834370).  Saving model ...
Epoch: 16 cost time: 1.7715182304382324
Epoch: 16, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 17 cost time: 1.6637485027313232
Epoch: 17, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1544415950775146
Epoch: 18, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8016541004180908
Epoch: 19, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7114019393920898
Epoch: 20, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 21 cost time: 1.4451515674591064
Epoch: 21, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.518 Vali Acc: 0.841 Test Loss: 0.518 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4458212852478027
Epoch: 22, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 23 cost time: 1.7645366191864014
Epoch: 23, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0418825149536133
Epoch: 24, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 2.6913883686065674
Epoch: 25, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4905989170074463
Epoch: 26, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.866788625717163
Epoch: 27, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.524 Vali Acc: 0.847 Test Loss: 0.524 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8498027324676514
Epoch: 28, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9565846920013428
Epoch: 29, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.071451425552368
Epoch: 30, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6660501956939697
Epoch: 31, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.520 Vali Acc: 0.847 Test Loss: 0.520 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.401841640472412
Epoch: 32, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.518 Vali Acc: 0.853 Test Loss: 0.518 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 33 cost time: 1.7117819786071777
Epoch: 33, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.848724126815796
Epoch: 34, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.3972065448760986
Epoch: 35, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7046828269958496
Epoch: 36, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.530 Vali Acc: 0.847 Test Loss: 0.530 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6091175079345703
Epoch: 37, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.8065857887268066
Epoch: 38, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.6676068305969238
Epoch: 39, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.747122049331665
Epoch: 40, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 41 cost time: 1.429513692855835
Epoch: 41, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4819285869598389
Epoch: 42, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.530 Vali Acc: 0.847 Test Loss: 0.530 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.708592176437378
Epoch: 43, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.8663890361785889
Epoch: 44, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.814403772354126
Epoch: 45, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.6859660148620605
Epoch: 46, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.8104143142700195
Epoch: 47, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.546 Vali Acc: 0.853 Test Loss: 0.546 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.887491226196289
Epoch: 48, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.539 Vali Acc: 0.853 Test Loss: 0.539 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.396758794784546
Epoch: 49, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.8357279300689697
Epoch: 50, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.541 Vali Acc: 0.853 Test Loss: 0.541 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 966392
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.569488048553467
Epoch: 1, Steps: 8 | Train Loss: 2.228 Vali Loss: 2.120 Vali Acc: 0.116 Test Loss: 2.120 Test Acc: 0.116
Validation loss decreased (inf --> -0.115604).  Saving model ...
Epoch: 2 cost time: 1.7576987743377686
Epoch: 2, Steps: 8 | Train Loss: 2.084 Vali Loss: 1.971 Vali Acc: 0.253 Test Loss: 1.971 Test Acc: 0.253
Validation loss decreased (-0.115604 --> -0.253105).  Saving model ...
Epoch: 3 cost time: 1.5187206268310547
Epoch: 3, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.832 Vali Acc: 0.403 Test Loss: 1.832 Test Acc: 0.403
Validation loss decreased (-0.253105 --> -0.403107).  Saving model ...
Epoch: 4 cost time: 1.2876994609832764
Epoch: 4, Steps: 8 | Train Loss: 1.762 Vali Loss: 1.635 Vali Acc: 0.553 Test Loss: 1.635 Test Acc: 0.553
Validation loss decreased (-0.403107 --> -0.553109).  Saving model ...
Epoch: 5 cost time: 1.4844346046447754
Epoch: 5, Steps: 8 | Train Loss: 1.558 Vali Loss: 1.405 Vali Acc: 0.716 Test Loss: 1.405 Test Acc: 0.716
Validation loss decreased (-0.553109 --> -0.715611).  Saving model ...
Epoch: 6 cost time: 1.880997896194458
Epoch: 6, Steps: 8 | Train Loss: 1.302 Vali Loss: 1.138 Vali Acc: 0.741 Test Loss: 1.138 Test Acc: 0.741
Validation loss decreased (-0.715611 --> -0.740614).  Saving model ...
Epoch: 7 cost time: 1.4637224674224854
Epoch: 7, Steps: 8 | Train Loss: 1.010 Vali Loss: 0.919 Vali Acc: 0.778 Test Loss: 0.919 Test Acc: 0.778
Validation loss decreased (-0.740614 --> -0.778116).  Saving model ...
Epoch: 8 cost time: 1.3817687034606934
Epoch: 8, Steps: 8 | Train Loss: 0.804 Vali Loss: 0.802 Vali Acc: 0.778 Test Loss: 0.802 Test Acc: 0.778
Validation loss decreased (-0.778116 --> -0.778117).  Saving model ...
Epoch: 9 cost time: 1.580742597579956
Epoch: 9, Steps: 8 | Train Loss: 0.646 Vali Loss: 0.671 Vali Acc: 0.828 Test Loss: 0.671 Test Acc: 0.828
Validation loss decreased (-0.778117 --> -0.828118).  Saving model ...
Epoch: 10 cost time: 1.3511598110198975
Epoch: 10, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.616 Vali Acc: 0.812 Test Loss: 0.616 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.320112943649292
Epoch: 11, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.591 Vali Acc: 0.800 Test Loss: 0.591 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9726834297180176
Epoch: 12, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6356475353240967
Epoch: 13, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9402410984039307
Epoch: 14, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.586867094039917
Epoch: 15, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
Validation loss decreased (-0.828118 --> -0.834370).  Saving model ...
Epoch: 16 cost time: 1.2363824844360352
Epoch: 16, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.526 Vali Acc: 0.828 Test Loss: 0.526 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3705081939697266
Epoch: 17, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4471232891082764
Epoch: 18, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.525 Vali Acc: 0.831 Test Loss: 0.525 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6035523414611816
Epoch: 19, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.528 Vali Acc: 0.828 Test Loss: 0.528 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.632413387298584
Epoch: 20, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6578822135925293
Epoch: 21, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.520 Vali Acc: 0.831 Test Loss: 0.520 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5288419723510742
Epoch: 22, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 23 cost time: 1.45212984085083
Epoch: 23, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 24 cost time: 1.590162992477417
Epoch: 24, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5556817054748535
Epoch: 25, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.463869333267212
Epoch: 26, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.047837495803833
Epoch: 27, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5554885864257812
Epoch: 28, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.552 Vali Acc: 0.822 Test Loss: 0.552 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.599114179611206
Epoch: 29, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.260974407196045
Epoch: 30, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.551 Vali Acc: 0.816 Test Loss: 0.551 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.7434790134429932
Epoch: 31, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6355788707733154
Epoch: 32, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.5981690883636475
Epoch: 33, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.571 Vali Acc: 0.822 Test Loss: 0.571 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 963320
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.2872326374053955
Epoch: 1, Steps: 8 | Train Loss: 2.199 Vali Loss: 2.060 Vali Acc: 0.119 Test Loss: 2.060 Test Acc: 0.119
Validation loss decreased (inf --> -0.118729).  Saving model ...
Epoch: 2 cost time: 1.3726210594177246
Epoch: 2, Steps: 8 | Train Loss: 2.072 Vali Loss: 1.939 Vali Acc: 0.384 Test Loss: 1.939 Test Acc: 0.384
Validation loss decreased (-0.118729 --> -0.384356).  Saving model ...
Epoch: 3 cost time: 1.4632039070129395
Epoch: 3, Steps: 8 | Train Loss: 1.957 Vali Loss: 1.816 Vali Acc: 0.434 Test Loss: 1.816 Test Acc: 0.434
Validation loss decreased (-0.384356 --> -0.434357).  Saving model ...
Epoch: 4 cost time: 1.4600143432617188
Epoch: 4, Steps: 8 | Train Loss: 1.797 Vali Loss: 1.617 Vali Acc: 0.628 Test Loss: 1.617 Test Acc: 0.628
Validation loss decreased (-0.434357 --> -0.628109).  Saving model ...
Epoch: 5 cost time: 1.7252635955810547
Epoch: 5, Steps: 8 | Train Loss: 1.584 Vali Loss: 1.376 Vali Acc: 0.709 Test Loss: 1.376 Test Acc: 0.709
Validation loss decreased (-0.628109 --> -0.709361).  Saving model ...
Epoch: 6 cost time: 1.6422712802886963
Epoch: 6, Steps: 8 | Train Loss: 1.324 Vali Loss: 1.113 Vali Acc: 0.791 Test Loss: 1.113 Test Acc: 0.791
Validation loss decreased (-0.709361 --> -0.790614).  Saving model ...
Epoch: 7 cost time: 1.3360543251037598
Epoch: 7, Steps: 8 | Train Loss: 1.008 Vali Loss: 0.893 Vali Acc: 0.803 Test Loss: 0.893 Test Acc: 0.803
Validation loss decreased (-0.790614 --> -0.803116).  Saving model ...
Epoch: 8 cost time: 1.730844259262085
Epoch: 8, Steps: 8 | Train Loss: 0.762 Vali Loss: 0.742 Vali Acc: 0.812 Test Loss: 0.742 Test Acc: 0.812
Validation loss decreased (-0.803116 --> -0.812493).  Saving model ...
Epoch: 9 cost time: 1.8043596744537354
Epoch: 9, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.655 Vali Acc: 0.822 Test Loss: 0.655 Test Acc: 0.822
Validation loss decreased (-0.812493 --> -0.821868).  Saving model ...
Epoch: 10 cost time: 1.524486780166626
Epoch: 10, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.589 Vali Acc: 0.841 Test Loss: 0.589 Test Acc: 0.841
Validation loss decreased (-0.821868 --> -0.840619).  Saving model ...
Epoch: 11 cost time: 1.819983720779419
Epoch: 11, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7939693927764893
Epoch: 12, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.664581060409546
Epoch: 13, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2954330444335938
Epoch: 14, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9732520580291748
Epoch: 15, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.521 Vali Acc: 0.831 Test Loss: 0.521 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5915331840515137
Epoch: 16, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 17 cost time: 1.800645112991333
Epoch: 17, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.511 Vali Acc: 0.831 Test Loss: 0.511 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8980798721313477
Epoch: 18, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.526 Vali Acc: 0.828 Test Loss: 0.526 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5064525604248047
Epoch: 19, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6636688709259033
Epoch: 20, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.828925371170044
Epoch: 21, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7419559955596924
Epoch: 22, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7580835819244385
Epoch: 23, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.571687936782837
Epoch: 24, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3458049297332764
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 26 cost time: 1.4086663722991943
Epoch: 26, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5525498390197754
Epoch: 27, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6341197490692139
Epoch: 28, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5821890830993652
Epoch: 29, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4910030364990234
Epoch: 30, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3063981533050537
Epoch: 31, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.5355892181396484
Epoch: 32, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.509 Vali Acc: 0.856 Test Loss: 0.509 Test Acc: 0.856
Validation loss decreased (-0.856245 --> -0.856245).  Saving model ...
Epoch: 33 cost time: 2.164100170135498
Epoch: 33, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.517 Vali Acc: 0.853 Test Loss: 0.517 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.431370735168457
Epoch: 34, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.525 Vali Acc: 0.853 Test Loss: 0.525 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.750476360321045
Epoch: 35, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5895805358886719
Epoch: 36, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4741795063018799
Epoch: 37, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.641834020614624
Epoch: 38, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.0148696899414062
Epoch: 39, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.4317903518676758
Epoch: 40, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.532 Vali Acc: 0.853 Test Loss: 0.532 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2190375328063965
Epoch: 41, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1858160495758057
Epoch: 42, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 960248
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 5.4554901123046875
Epoch: 1, Steps: 8 | Train Loss: 2.139 Vali Loss: 2.058 Vali Acc: 0.188 Test Loss: 2.058 Test Acc: 0.188
Validation loss decreased (inf --> -0.187479).  Saving model ...
Epoch: 2 cost time: 2.46048641204834
Epoch: 2, Steps: 8 | Train Loss: 2.041 Vali Loss: 1.936 Vali Acc: 0.322 Test Loss: 1.936 Test Acc: 0.322
Validation loss decreased (-0.187479 --> -0.321856).  Saving model ...
Epoch: 3 cost time: 2.1026363372802734
Epoch: 3, Steps: 8 | Train Loss: 1.926 Vali Loss: 1.792 Vali Acc: 0.472 Test Loss: 1.792 Test Acc: 0.472
Validation loss decreased (-0.321856 --> -0.471857).  Saving model ...
Epoch: 4 cost time: 1.5915448665618896
Epoch: 4, Steps: 8 | Train Loss: 1.727 Vali Loss: 1.596 Vali Acc: 0.550 Test Loss: 1.596 Test Acc: 0.550
Validation loss decreased (-0.471857 --> -0.549984).  Saving model ...
Epoch: 5 cost time: 1.866447925567627
Epoch: 5, Steps: 8 | Train Loss: 1.495 Vali Loss: 1.360 Vali Acc: 0.666 Test Loss: 1.360 Test Acc: 0.666
Validation loss decreased (-0.549984 --> -0.665611).  Saving model ...
Epoch: 6 cost time: 1.883662223815918
Epoch: 6, Steps: 8 | Train Loss: 1.197 Vali Loss: 1.117 Vali Acc: 0.728 Test Loss: 1.117 Test Acc: 0.728
Validation loss decreased (-0.665611 --> -0.728114).  Saving model ...
Epoch: 7 cost time: 2.0586085319519043
Epoch: 7, Steps: 8 | Train Loss: 0.978 Vali Loss: 0.924 Vali Acc: 0.731 Test Loss: 0.924 Test Acc: 0.731
Validation loss decreased (-0.728114 --> -0.731241).  Saving model ...
Epoch: 8 cost time: 2.1311137676239014
Epoch: 8, Steps: 8 | Train Loss: 0.763 Vali Loss: 0.773 Vali Acc: 0.781 Test Loss: 0.773 Test Acc: 0.781
Validation loss decreased (-0.731241 --> -0.781242).  Saving model ...
Epoch: 9 cost time: 1.6083614826202393
Epoch: 9, Steps: 8 | Train Loss: 0.578 Vali Loss: 0.690 Vali Acc: 0.787 Test Loss: 0.690 Test Acc: 0.787
Validation loss decreased (-0.781242 --> -0.787493).  Saving model ...
Epoch: 10 cost time: 1.9949986934661865
Epoch: 10, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.638 Vali Acc: 0.812 Test Loss: 0.638 Test Acc: 0.812
Validation loss decreased (-0.787493 --> -0.812494).  Saving model ...
Epoch: 11 cost time: 2.000645160675049
Epoch: 11, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 12 cost time: 1.881669044494629
Epoch: 12, Steps: 8 | Train Loss: 0.327 Vali Loss: 0.572 Vali Acc: 0.806 Test Loss: 0.572 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8485472202301025
Epoch: 13, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.555 Vali Acc: 0.828 Test Loss: 0.555 Test Acc: 0.828
Validation loss decreased (-0.812494 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 1.8491485118865967
Epoch: 14, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.069099187850952
Epoch: 15, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.550 Vali Acc: 0.828 Test Loss: 0.550 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 16 cost time: 2.2254390716552734
Epoch: 16, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.542 Vali Acc: 0.828 Test Loss: 0.542 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828120).  Saving model ...
Epoch: 17 cost time: 2.0698935985565186
Epoch: 17, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 18 cost time: 1.7756881713867188
Epoch: 18, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 19 cost time: 1.5417118072509766
Epoch: 19, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8209831714630127
Epoch: 20, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0786383152008057
Epoch: 21, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8655967712402344
Epoch: 22, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.062340259552002
Epoch: 23, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.521 Vali Acc: 0.831 Test Loss: 0.521 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.80781888961792
Epoch: 24, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.276249885559082
Epoch: 25, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 1.9550104141235352
Epoch: 26, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4830269813537598
Epoch: 27, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.525 Vali Acc: 0.847 Test Loss: 0.525 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.334007740020752
Epoch: 28, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9235992431640625
Epoch: 29, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1486480236053467
Epoch: 30, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.6491367816925049
Epoch: 31, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.5988082885742188
Epoch: 32, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.7845501899719238
Epoch: 33, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.530 Vali Acc: 0.847 Test Loss: 0.530 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.1084113121032715
Epoch: 34, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.525 Vali Acc: 0.853 Test Loss: 0.525 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 35 cost time: 1.6432230472564697
Epoch: 35, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6014165878295898
Epoch: 36, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.891449213027954
Epoch: 37, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.543 Vali Acc: 0.853 Test Loss: 0.543 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.5051703453063965
Epoch: 38, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 39 cost time: 1.725130319595337
Epoch: 39, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.527 Vali Acc: 0.853 Test Loss: 0.527 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.015286684036255
Epoch: 40, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.534 Vali Acc: 0.859 Test Loss: 0.534 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 41 cost time: 1.950552225112915
Epoch: 41, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.8241348266601562
Epoch: 42, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.50600004196167
Epoch: 43, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.540 Vali Acc: 0.859 Test Loss: 0.540 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.876251220703125
Epoch: 44, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.9547038078308105
Epoch: 45, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.535 Vali Acc: 0.863 Test Loss: 0.535 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 46 cost time: 2.130079507827759
Epoch: 46, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.532 Vali Acc: 0.863 Test Loss: 0.532 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 47 cost time: 1.7075989246368408
Epoch: 47, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.538 Vali Acc: 0.859 Test Loss: 0.538 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.9421360492706299
Epoch: 48, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.541 Vali Acc: 0.859 Test Loss: 0.541 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.9186878204345703
Epoch: 49, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.538 Vali Acc: 0.863 Test Loss: 0.538 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.782015323638916
Epoch: 50, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.543 Vali Acc: 0.859 Test Loss: 0.543 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.7613890171051025
Epoch: 51, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.1218769550323486
Epoch: 52, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.549 Vali Acc: 0.859 Test Loss: 0.549 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.8139986991882324
Epoch: 53, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.551 Vali Acc: 0.863 Test Loss: 0.551 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.792433261871338
Epoch: 54, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.551 Vali Acc: 0.866 Test Loss: 0.551 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 55 cost time: 1.8214361667633057
Epoch: 55, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.0783472061157227
Epoch: 56, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.0511393547058105
Epoch: 57, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.554 Vali Acc: 0.863 Test Loss: 0.554 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.6360116004943848
Epoch: 58, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.557 Vali Acc: 0.869 Test Loss: 0.557 Test Acc: 0.869
Validation loss decreased (-0.865619 --> -0.868744).  Saving model ...
Epoch: 59 cost time: 1.8726651668548584
Epoch: 59, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.556 Vali Acc: 0.869 Test Loss: 0.556 Test Acc: 0.869
Validation loss decreased (-0.868744 --> -0.868744).  Saving model ...
Epoch: 60 cost time: 2.164799213409424
Epoch: 60, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.866 Test Loss: 0.558 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.0151360034942627
Epoch: 61, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.866 Test Loss: 0.558 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.8504316806793213
Epoch: 62, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.555 Vali Acc: 0.869 Test Loss: 0.555 Test Acc: 0.869
Validation loss decreased (-0.868744 --> -0.868744).  Saving model ...
Epoch: 63 cost time: 1.9547710418701172
Epoch: 63, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871869).  Saving model ...
Epoch: 64 cost time: 1.9365696907043457
Epoch: 64, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.869 Test Loss: 0.556 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.6167733669281006
Epoch: 65, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.560 Vali Acc: 0.869 Test Loss: 0.560 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.6614110469818115
Epoch: 66, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.560 Vali Acc: 0.866 Test Loss: 0.560 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.9291040897369385
Epoch: 67, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.560 Vali Acc: 0.866 Test Loss: 0.560 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 2.0305263996124268
Epoch: 68, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.563 Vali Acc: 0.866 Test Loss: 0.563 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.7421233654022217
Epoch: 69, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.557 Vali Acc: 0.869 Test Loss: 0.557 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 2.246997117996216
Epoch: 70, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.559 Vali Acc: 0.869 Test Loss: 0.559 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.91776442527771
Epoch: 71, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.866 Test Loss: 0.567 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 2.1271867752075195
Epoch: 72, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.866 Test Loss: 0.570 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.9715516567230225
Epoch: 73, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.568 Vali Acc: 0.863 Test Loss: 0.568 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 957176
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8443405628204346
Epoch: 1, Steps: 8 | Train Loss: 2.210 Vali Loss: 2.108 Vali Acc: 0.059 Test Loss: 2.108 Test Acc: 0.059
Validation loss decreased (inf --> -0.059354).  Saving model ...
Epoch: 2 cost time: 1.9010629653930664
Epoch: 2, Steps: 8 | Train Loss: 2.084 Vali Loss: 2.007 Vali Acc: 0.184 Test Loss: 2.007 Test Acc: 0.184
Validation loss decreased (-0.059354 --> -0.184355).  Saving model ...
Epoch: 3 cost time: 1.5520849227905273
Epoch: 3, Steps: 8 | Train Loss: 1.956 Vali Loss: 1.889 Vali Acc: 0.381 Test Loss: 1.889 Test Acc: 0.381
Validation loss decreased (-0.184355 --> -0.381231).  Saving model ...
Epoch: 4 cost time: 1.4164726734161377
Epoch: 4, Steps: 8 | Train Loss: 1.844 Vali Loss: 1.732 Vali Acc: 0.544 Test Loss: 1.732 Test Acc: 0.544
Validation loss decreased (-0.381231 --> -0.543733).  Saving model ...
Epoch: 5 cost time: 2.1540517807006836
Epoch: 5, Steps: 8 | Train Loss: 1.673 Vali Loss: 1.539 Vali Acc: 0.688 Test Loss: 1.539 Test Acc: 0.688
Validation loss decreased (-0.543733 --> -0.687485).  Saving model ...
Epoch: 6 cost time: 1.6207630634307861
Epoch: 6, Steps: 8 | Train Loss: 1.428 Vali Loss: 1.294 Vali Acc: 0.709 Test Loss: 1.294 Test Acc: 0.709
Validation loss decreased (-0.687485 --> -0.709362).  Saving model ...
Epoch: 7 cost time: 1.3348736763000488
Epoch: 7, Steps: 8 | Train Loss: 1.148 Vali Loss: 1.069 Vali Acc: 0.747 Test Loss: 1.069 Test Acc: 0.747
Validation loss decreased (-0.709362 --> -0.746864).  Saving model ...
Epoch: 8 cost time: 1.3702232837677002
Epoch: 8, Steps: 8 | Train Loss: 0.884 Vali Loss: 0.887 Vali Acc: 0.753 Test Loss: 0.887 Test Acc: 0.753
Validation loss decreased (-0.746864 --> -0.753116).  Saving model ...
Epoch: 9 cost time: 1.4598972797393799
Epoch: 9, Steps: 8 | Train Loss: 0.729 Vali Loss: 0.761 Vali Acc: 0.781 Test Loss: 0.761 Test Acc: 0.781
Validation loss decreased (-0.753116 --> -0.781242).  Saving model ...
Epoch: 10 cost time: 1.5722336769104004
Epoch: 10, Steps: 8 | Train Loss: 0.569 Vali Loss: 0.671 Vali Acc: 0.803 Test Loss: 0.671 Test Acc: 0.803
Validation loss decreased (-0.781242 --> -0.803118).  Saving model ...
Epoch: 11 cost time: 1.3518869876861572
Epoch: 11, Steps: 8 | Train Loss: 0.462 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
Validation loss decreased (-0.803118 --> -0.809369).  Saving model ...
Epoch: 12 cost time: 1.306885004043579
Epoch: 12, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6101107597351074
Epoch: 13, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.575 Vali Acc: 0.825 Test Loss: 0.575 Test Acc: 0.825
Validation loss decreased (-0.809369 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 1.5934219360351562
Epoch: 14, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.291593313217163
Epoch: 15, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.561 Vali Acc: 0.816 Test Loss: 0.561 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.414283275604248
Epoch: 16, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.527 Vali Acc: 0.825 Test Loss: 0.527 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 17 cost time: 1.587972640991211
Epoch: 17, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7879972457885742
Epoch: 18, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.564 Vali Acc: 0.816 Test Loss: 0.564 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6271913051605225
Epoch: 19, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5044610500335693
Epoch: 20, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 21 cost time: 1.4095163345336914
Epoch: 21, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.552112340927124
Epoch: 22, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.482191562652588
Epoch: 23, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.553 Vali Acc: 0.816 Test Loss: 0.553 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4924426078796387
Epoch: 24, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.368218183517456
Epoch: 25, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3402059078216553
Epoch: 26, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.564 Vali Acc: 0.816 Test Loss: 0.564 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.467301845550537
Epoch: 27, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6959097385406494
Epoch: 28, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.564 Vali Acc: 0.816 Test Loss: 0.564 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5080268383026123
Epoch: 29, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3594205379486084
Epoch: 30, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.582 Vali Acc: 0.816 Test Loss: 0.582 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 735224
model size : 4.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.710747480392456
Epoch: 1, Steps: 8 | Train Loss: 2.269 Vali Loss: 2.179 Vali Acc: 0.103 Test Loss: 2.179 Test Acc: 0.103
Validation loss decreased (inf --> -0.103103).  Saving model ...
Epoch: 2 cost time: 1.3896751403808594
Epoch: 2, Steps: 8 | Train Loss: 2.137 Vali Loss: 2.046 Vali Acc: 0.134 Test Loss: 2.046 Test Acc: 0.134
Validation loss decreased (-0.103103 --> -0.134355).  Saving model ...
Epoch: 3 cost time: 1.669074535369873
Epoch: 3, Steps: 8 | Train Loss: 2.009 Vali Loss: 1.921 Vali Acc: 0.306 Test Loss: 1.921 Test Acc: 0.306
Validation loss decreased (-0.134355 --> -0.306231).  Saving model ...
Epoch: 4 cost time: 1.7878026962280273
Epoch: 4, Steps: 8 | Train Loss: 1.847 Vali Loss: 1.758 Vali Acc: 0.528 Test Loss: 1.758 Test Acc: 0.528
Validation loss decreased (-0.306231 --> -0.528107).  Saving model ...
Epoch: 5 cost time: 1.6566638946533203
Epoch: 5, Steps: 8 | Train Loss: 1.682 Vali Loss: 1.537 Vali Acc: 0.647 Test Loss: 1.537 Test Acc: 0.647
Validation loss decreased (-0.528107 --> -0.646860).  Saving model ...
Epoch: 6 cost time: 1.62050199508667
Epoch: 6, Steps: 8 | Train Loss: 1.422 Vali Loss: 1.295 Vali Acc: 0.722 Test Loss: 1.295 Test Acc: 0.722
Validation loss decreased (-0.646860 --> -0.721862).  Saving model ...
Epoch: 7 cost time: 1.657754898071289
Epoch: 7, Steps: 8 | Train Loss: 1.143 Vali Loss: 1.057 Vali Acc: 0.759 Test Loss: 1.057 Test Acc: 0.759
Validation loss decreased (-0.721862 --> -0.759364).  Saving model ...
Epoch: 8 cost time: 1.615490436553955
Epoch: 8, Steps: 8 | Train Loss: 0.943 Vali Loss: 0.859 Vali Acc: 0.803 Test Loss: 0.859 Test Acc: 0.803
Validation loss decreased (-0.759364 --> -0.803116).  Saving model ...
Epoch: 9 cost time: 1.632462501525879
Epoch: 9, Steps: 8 | Train Loss: 0.699 Vali Loss: 0.728 Vali Acc: 0.816 Test Loss: 0.728 Test Acc: 0.816
Validation loss decreased (-0.803116 --> -0.815618).  Saving model ...
Epoch: 10 cost time: 1.9930908679962158
Epoch: 10, Steps: 8 | Train Loss: 0.579 Vali Loss: 0.652 Vali Acc: 0.809 Test Loss: 0.652 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5785729885101318
Epoch: 11, Steps: 8 | Train Loss: 0.470 Vali Loss: 0.614 Vali Acc: 0.831 Test Loss: 0.614 Test Acc: 0.831
Validation loss decreased (-0.815618 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 1.7927358150482178
Epoch: 12, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 13 cost time: 1.3904705047607422
Epoch: 13, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840620).  Saving model ...
Epoch: 14 cost time: 1.9730250835418701
Epoch: 14, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 1.5873165130615234
Epoch: 15, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7791666984558105
Epoch: 16, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 17 cost time: 2.046095371246338
Epoch: 17, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.510 Vali Acc: 0.847 Test Loss: 0.510 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9158263206481934
Epoch: 18, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7056124210357666
Epoch: 19, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.972132682800293
Epoch: 20, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.498 Vali Acc: 0.853 Test Loss: 0.498 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 21 cost time: 1.8257060050964355
Epoch: 21, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.481355905532837
Epoch: 22, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 23 cost time: 1.5093553066253662
Epoch: 23, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4948809146881104
Epoch: 24, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.502 Vali Acc: 0.853 Test Loss: 0.502 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5931684970855713
Epoch: 25, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.676238775253296
Epoch: 26, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.493 Vali Acc: 0.853 Test Loss: 0.493 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7713918685913086
Epoch: 27, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7779631614685059
Epoch: 28, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.507 Vali Acc: 0.856 Test Loss: 0.507 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.2133772373199463
Epoch: 29, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7094342708587646
Epoch: 30, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.506 Vali Acc: 0.856 Test Loss: 0.506 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.43849778175354
Epoch: 31, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.4968690872192383
Epoch: 32, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 732152
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5499327182769775
Epoch: 1, Steps: 8 | Train Loss: 2.211 Vali Loss: 2.135 Vali Acc: 0.094 Test Loss: 2.135 Test Acc: 0.094
Validation loss decreased (inf --> -0.093729).  Saving model ...
Epoch: 2 cost time: 1.52528977394104
Epoch: 2, Steps: 8 | Train Loss: 2.078 Vali Loss: 2.013 Vali Acc: 0.222 Test Loss: 2.013 Test Acc: 0.222
Validation loss decreased (-0.093729 --> -0.221855).  Saving model ...
Epoch: 3 cost time: 1.4025886058807373
Epoch: 3, Steps: 8 | Train Loss: 1.924 Vali Loss: 1.887 Vali Acc: 0.444 Test Loss: 1.887 Test Acc: 0.444
Validation loss decreased (-0.221855 --> -0.443731).  Saving model ...
Epoch: 4 cost time: 1.6043779850006104
Epoch: 4, Steps: 8 | Train Loss: 1.813 Vali Loss: 1.716 Vali Acc: 0.628 Test Loss: 1.716 Test Acc: 0.628
Validation loss decreased (-0.443731 --> -0.628108).  Saving model ...
Epoch: 5 cost time: 1.8304407596588135
Epoch: 5, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.508 Vali Acc: 0.725 Test Loss: 1.508 Test Acc: 0.725
Validation loss decreased (-0.628108 --> -0.724985).  Saving model ...
Epoch: 6 cost time: 1.761653184890747
Epoch: 6, Steps: 8 | Train Loss: 1.374 Vali Loss: 1.260 Vali Acc: 0.766 Test Loss: 1.260 Test Acc: 0.766
Validation loss decreased (-0.724985 --> -0.765612).  Saving model ...
Epoch: 7 cost time: 1.4753382205963135
Epoch: 7, Steps: 8 | Train Loss: 1.105 Vali Loss: 1.037 Vali Acc: 0.762 Test Loss: 1.037 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0730741024017334
Epoch: 8, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.850 Vali Acc: 0.797 Test Loss: 0.850 Test Acc: 0.797
Validation loss decreased (-0.765612 --> -0.796867).  Saving model ...
Epoch: 9 cost time: 1.6410582065582275
Epoch: 9, Steps: 8 | Train Loss: 0.716 Vali Loss: 0.719 Vali Acc: 0.806 Test Loss: 0.719 Test Acc: 0.806
Validation loss decreased (-0.796867 --> -0.806243).  Saving model ...
Epoch: 10 cost time: 1.5223298072814941
Epoch: 10, Steps: 8 | Train Loss: 0.552 Vali Loss: 0.642 Vali Acc: 0.809 Test Loss: 0.642 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809369).  Saving model ...
Epoch: 11 cost time: 2.400219202041626
Epoch: 11, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.590 Vali Acc: 0.831 Test Loss: 0.590 Test Acc: 0.831
Validation loss decreased (-0.809369 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 1.743476152420044
Epoch: 12, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840619).  Saving model ...
Epoch: 13 cost time: 1.6345524787902832
Epoch: 13, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4753828048706055
Epoch: 14, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4762842655181885
Epoch: 15, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.544 Vali Acc: 0.838 Test Loss: 0.544 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1980173587799072
Epoch: 16, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843745).  Saving model ...
Epoch: 17 cost time: 2.6926982402801514
Epoch: 17, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.548 Vali Acc: 0.834 Test Loss: 0.548 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0274910926818848
Epoch: 18, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9303350448608398
Epoch: 19, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 1.69838547706604
Epoch: 20, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.484023094177246
Epoch: 21, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.546 Vali Acc: 0.834 Test Loss: 0.546 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0358221530914307
Epoch: 22, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.530 Vali Acc: 0.847 Test Loss: 0.530 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.462277889251709
Epoch: 23, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9375827312469482
Epoch: 24, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.615553617477417
Epoch: 25, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.896998405456543
Epoch: 26, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.358052968978882
Epoch: 27, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.558 Vali Acc: 0.834 Test Loss: 0.558 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6974573135375977
Epoch: 28, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8129212856292725
Epoch: 29, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 729080
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.1504621505737305
Epoch: 1, Steps: 8 | Train Loss: 2.185 Vali Loss: 2.118 Vali Acc: 0.163 Test Loss: 2.118 Test Acc: 0.163
Validation loss decreased (inf --> -0.162479).  Saving model ...
Epoch: 2 cost time: 1.369077205657959
Epoch: 2, Steps: 8 | Train Loss: 2.051 Vali Loss: 2.017 Vali Acc: 0.225 Test Loss: 2.017 Test Acc: 0.225
Validation loss decreased (-0.162479 --> -0.224980).  Saving model ...
Epoch: 3 cost time: 1.5629963874816895
Epoch: 3, Steps: 8 | Train Loss: 2.015 Vali Loss: 1.903 Vali Acc: 0.328 Test Loss: 1.903 Test Acc: 0.328
Validation loss decreased (-0.224980 --> -0.328106).  Saving model ...
Epoch: 4 cost time: 1.465172290802002
Epoch: 4, Steps: 8 | Train Loss: 1.843 Vali Loss: 1.748 Vali Acc: 0.562 Test Loss: 1.748 Test Acc: 0.562
Validation loss decreased (-0.328106 --> -0.562483).  Saving model ...
Epoch: 5 cost time: 1.5590872764587402
Epoch: 5, Steps: 8 | Train Loss: 1.692 Vali Loss: 1.551 Vali Acc: 0.684 Test Loss: 1.551 Test Acc: 0.684
Validation loss decreased (-0.562483 --> -0.684359).  Saving model ...
Epoch: 6 cost time: 1.8403396606445312
Epoch: 6, Steps: 8 | Train Loss: 1.498 Vali Loss: 1.328 Vali Acc: 0.691 Test Loss: 1.328 Test Acc: 0.691
Validation loss decreased (-0.684359 --> -0.690612).  Saving model ...
Epoch: 7 cost time: 1.5339083671569824
Epoch: 7, Steps: 8 | Train Loss: 1.279 Vali Loss: 1.078 Vali Acc: 0.766 Test Loss: 1.078 Test Acc: 0.766
Validation loss decreased (-0.690612 --> -0.765614).  Saving model ...
Epoch: 8 cost time: 1.280409812927246
Epoch: 8, Steps: 8 | Train Loss: 0.961 Vali Loss: 0.867 Vali Acc: 0.809 Test Loss: 0.867 Test Acc: 0.809
Validation loss decreased (-0.765614 --> -0.809366).  Saving model ...
Epoch: 9 cost time: 1.2871437072753906
Epoch: 9, Steps: 8 | Train Loss: 0.737 Vali Loss: 0.740 Vali Acc: 0.819 Test Loss: 0.740 Test Acc: 0.819
Validation loss decreased (-0.809366 --> -0.818743).  Saving model ...
Epoch: 10 cost time: 1.6400730609893799
Epoch: 10, Steps: 8 | Train Loss: 0.586 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4995129108428955
Epoch: 11, Steps: 8 | Train Loss: 0.501 Vali Loss: 0.610 Vali Acc: 0.812 Test Loss: 0.610 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5383179187774658
Epoch: 12, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
Validation loss decreased (-0.818743 --> -0.828119).  Saving model ...
Epoch: 13 cost time: 1.487908124923706
Epoch: 13, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5368359088897705
Epoch: 14, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
Validation loss decreased (-0.828119 --> -0.843744).  Saving model ...
Epoch: 15 cost time: 1.1318025588989258
Epoch: 15, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6423072814941406
Epoch: 16, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1788139343261719
Epoch: 17, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3131203651428223
Epoch: 18, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4720897674560547
Epoch: 19, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.560 Vali Acc: 0.838 Test Loss: 0.560 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6690759658813477
Epoch: 20, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.561 Vali Acc: 0.831 Test Loss: 0.561 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5746541023254395
Epoch: 21, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.564 Vali Acc: 0.834 Test Loss: 0.564 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2489104270935059
Epoch: 22, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.569 Vali Acc: 0.831 Test Loss: 0.569 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3150994777679443
Epoch: 23, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.568 Vali Acc: 0.831 Test Loss: 0.568 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4268901348114014
Epoch: 24, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.570 Vali Acc: 0.825 Test Loss: 0.570 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 726008
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.456526756286621
Epoch: 1, Steps: 8 | Train Loss: 2.260 Vali Loss: 2.141 Vali Acc: 0.234 Test Loss: 2.141 Test Acc: 0.234
Validation loss decreased (inf --> -0.234354).  Saving model ...
Epoch: 2 cost time: 1.7269511222839355
Epoch: 2, Steps: 8 | Train Loss: 2.134 Vali Loss: 1.976 Vali Acc: 0.275 Test Loss: 1.976 Test Acc: 0.275
Validation loss decreased (-0.234354 --> -0.274980).  Saving model ...
Epoch: 3 cost time: 2.032386064529419
Epoch: 3, Steps: 8 | Train Loss: 1.943 Vali Loss: 1.840 Vali Acc: 0.447 Test Loss: 1.840 Test Acc: 0.447
Validation loss decreased (-0.274980 --> -0.446857).  Saving model ...
Epoch: 4 cost time: 1.98048996925354
Epoch: 4, Steps: 8 | Train Loss: 1.782 Vali Loss: 1.662 Vali Acc: 0.556 Test Loss: 1.662 Test Acc: 0.556
Validation loss decreased (-0.446857 --> -0.556233).  Saving model ...
Epoch: 5 cost time: 1.4886598587036133
Epoch: 5, Steps: 8 | Train Loss: 1.594 Vali Loss: 1.453 Vali Acc: 0.716 Test Loss: 1.453 Test Acc: 0.716
Validation loss decreased (-0.556233 --> -0.715610).  Saving model ...
Epoch: 6 cost time: 1.5253636837005615
Epoch: 6, Steps: 8 | Train Loss: 1.375 Vali Loss: 1.232 Vali Acc: 0.725 Test Loss: 1.232 Test Acc: 0.725
Validation loss decreased (-0.715610 --> -0.724988).  Saving model ...
Epoch: 7 cost time: 1.6288695335388184
Epoch: 7, Steps: 8 | Train Loss: 1.127 Vali Loss: 1.015 Vali Acc: 0.772 Test Loss: 1.015 Test Acc: 0.772
Validation loss decreased (-0.724988 --> -0.771865).  Saving model ...
Epoch: 8 cost time: 1.7285900115966797
Epoch: 8, Steps: 8 | Train Loss: 0.892 Vali Loss: 0.842 Vali Acc: 0.800 Test Loss: 0.842 Test Acc: 0.800
Validation loss decreased (-0.771865 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 1.5321884155273438
Epoch: 9, Steps: 8 | Train Loss: 0.744 Vali Loss: 0.737 Vali Acc: 0.797 Test Loss: 0.737 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.652045488357544
Epoch: 10, Steps: 8 | Train Loss: 0.620 Vali Loss: 0.630 Vali Acc: 0.831 Test Loss: 0.630 Test Acc: 0.831
Validation loss decreased (-0.799992 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 1.2983462810516357
Epoch: 11, Steps: 8 | Train Loss: 0.521 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5401687622070312
Epoch: 12, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7300827503204346
Epoch: 13, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 14 cost time: 1.6736648082733154
Epoch: 14, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 15 cost time: 1.697413444519043
Epoch: 15, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.520 Vali Acc: 0.828 Test Loss: 0.520 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.469902753829956
Epoch: 16, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.500 Vali Acc: 0.847 Test Loss: 0.500 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 17 cost time: 1.3673672676086426
Epoch: 17, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.496 Vali Acc: 0.859 Test Loss: 0.496 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859370).  Saving model ...
Epoch: 18 cost time: 1.345362901687622
Epoch: 18, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4384071826934814
Epoch: 19, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4523992538452148
Epoch: 20, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4501633644104004
Epoch: 21, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8596792221069336
Epoch: 22, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6796104907989502
Epoch: 23, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.492 Vali Acc: 0.853 Test Loss: 0.492 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8476622104644775
Epoch: 24, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4012563228607178
Epoch: 25, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8720340728759766
Epoch: 26, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6668167114257812
Epoch: 27, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 619640
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9043281078338623
Epoch: 1, Steps: 8 | Train Loss: 2.062 Vali Loss: 1.980 Vali Acc: 0.222 Test Loss: 1.980 Test Acc: 0.222
Validation loss decreased (inf --> -0.221855).  Saving model ...
Epoch: 2 cost time: 1.1872923374176025
Epoch: 2, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.882 Vali Acc: 0.384 Test Loss: 1.882 Test Acc: 0.384
Validation loss decreased (-0.221855 --> -0.384356).  Saving model ...
Epoch: 3 cost time: 1.2249000072479248
Epoch: 3, Steps: 8 | Train Loss: 1.873 Vali Loss: 1.746 Vali Acc: 0.562 Test Loss: 1.746 Test Acc: 0.562
Validation loss decreased (-0.384356 --> -0.562483).  Saving model ...
Epoch: 4 cost time: 1.3640172481536865
Epoch: 4, Steps: 8 | Train Loss: 1.677 Vali Loss: 1.565 Vali Acc: 0.709 Test Loss: 1.565 Test Acc: 0.709
Validation loss decreased (-0.562483 --> -0.709359).  Saving model ...
Epoch: 5 cost time: 1.7032623291015625
Epoch: 5, Steps: 8 | Train Loss: 1.484 Vali Loss: 1.348 Vali Acc: 0.762 Test Loss: 1.348 Test Acc: 0.762
Validation loss decreased (-0.709359 --> -0.762487).  Saving model ...
Epoch: 6 cost time: 1.4798698425292969
Epoch: 6, Steps: 8 | Train Loss: 1.278 Vali Loss: 1.125 Vali Acc: 0.769 Test Loss: 1.125 Test Acc: 0.769
Validation loss decreased (-0.762487 --> -0.768739).  Saving model ...
Epoch: 7 cost time: 1.684464931488037
Epoch: 7, Steps: 8 | Train Loss: 0.977 Vali Loss: 0.922 Vali Acc: 0.797 Test Loss: 0.922 Test Acc: 0.797
Validation loss decreased (-0.768739 --> -0.796866).  Saving model ...
Epoch: 8 cost time: 1.3376655578613281
Epoch: 8, Steps: 8 | Train Loss: 0.845 Vali Loss: 0.785 Vali Acc: 0.819 Test Loss: 0.785 Test Acc: 0.819
Validation loss decreased (-0.796866 --> -0.818742).  Saving model ...
Epoch: 9 cost time: 1.7414658069610596
Epoch: 9, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.699 Vali Acc: 0.809 Test Loss: 0.699 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4490723609924316
Epoch: 10, Steps: 8 | Train Loss: 0.559 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4661784172058105
Epoch: 11, Steps: 8 | Train Loss: 0.466 Vali Loss: 0.606 Vali Acc: 0.812 Test Loss: 0.606 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3498120307922363
Epoch: 12, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.571 Vali Acc: 0.831 Test Loss: 0.571 Test Acc: 0.831
Validation loss decreased (-0.818742 --> -0.831244).  Saving model ...
Epoch: 13 cost time: 1.6725008487701416
Epoch: 13, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.561 Vali Acc: 0.831 Test Loss: 0.561 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 14 cost time: 1.462561845779419
Epoch: 14, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3254830837249756
Epoch: 15, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.554 Vali Acc: 0.819 Test Loss: 0.554 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.302889347076416
Epoch: 16, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6870288848876953
Epoch: 17, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837495).  Saving model ...
Epoch: 18 cost time: 1.4065907001495361
Epoch: 18, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.473008155822754
Epoch: 19, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 1.4427800178527832
Epoch: 20, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.537 Vali Acc: 0.831 Test Loss: 0.537 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4204442501068115
Epoch: 21, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3924405574798584
Epoch: 22, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.503096342086792
Epoch: 23, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4641504287719727
Epoch: 24, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5231943130493164
Epoch: 25, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.528003454208374
Epoch: 26, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7523910999298096
Epoch: 27, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.559 Vali Acc: 0.834 Test Loss: 0.559 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4008853435516357
Epoch: 28, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6354331970214844
Epoch: 29, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 616568
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.339548110961914
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 2.069 Vali Acc: 0.216 Test Loss: 2.069 Test Acc: 0.216
Validation loss decreased (inf --> -0.215604).  Saving model ...
Epoch: 2 cost time: 1.7979583740234375
Epoch: 2, Steps: 8 | Train Loss: 2.014 Vali Loss: 1.954 Vali Acc: 0.266 Test Loss: 1.954 Test Acc: 0.266
Validation loss decreased (-0.215604 --> -0.265605).  Saving model ...
Epoch: 3 cost time: 1.446892261505127
Epoch: 3, Steps: 8 | Train Loss: 1.891 Vali Loss: 1.809 Vali Acc: 0.491 Test Loss: 1.809 Test Acc: 0.491
Validation loss decreased (-0.265605 --> -0.490607).  Saving model ...
Epoch: 4 cost time: 1.251321792602539
Epoch: 4, Steps: 8 | Train Loss: 1.758 Vali Loss: 1.620 Vali Acc: 0.644 Test Loss: 1.620 Test Acc: 0.644
Validation loss decreased (-0.490607 --> -0.643734).  Saving model ...
Epoch: 5 cost time: 1.5723812580108643
Epoch: 5, Steps: 8 | Train Loss: 1.516 Vali Loss: 1.406 Vali Acc: 0.631 Test Loss: 1.406 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.482494592666626
Epoch: 6, Steps: 8 | Train Loss: 1.283 Vali Loss: 1.167 Vali Acc: 0.703 Test Loss: 1.167 Test Acc: 0.703
Validation loss decreased (-0.643734 --> -0.703113).  Saving model ...
Epoch: 7 cost time: 1.5258710384368896
Epoch: 7, Steps: 8 | Train Loss: 1.096 Vali Loss: 0.961 Vali Acc: 0.778 Test Loss: 0.961 Test Acc: 0.778
Validation loss decreased (-0.703113 --> -0.778115).  Saving model ...
Epoch: 8 cost time: 1.3201730251312256
Epoch: 8, Steps: 8 | Train Loss: 0.834 Vali Loss: 0.806 Vali Acc: 0.787 Test Loss: 0.806 Test Acc: 0.787
Validation loss decreased (-0.778115 --> -0.787492).  Saving model ...
Epoch: 9 cost time: 1.7334203720092773
Epoch: 9, Steps: 8 | Train Loss: 0.686 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
Validation loss decreased (-0.787492 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 1.4798033237457275
Epoch: 10, Steps: 8 | Train Loss: 0.536 Vali Loss: 0.625 Vali Acc: 0.819 Test Loss: 0.625 Test Acc: 0.819
Validation loss decreased (-0.799993 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 1.30466890335083
Epoch: 11, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.583 Vali Acc: 0.825 Test Loss: 0.583 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 1.6482200622558594
Epoch: 12, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.565 Vali Acc: 0.828 Test Loss: 0.565 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 13 cost time: 1.3575422763824463
Epoch: 13, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
Validation loss decreased (-0.828119 --> -0.843745).  Saving model ...
Epoch: 14 cost time: 1.429896593093872
Epoch: 14, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.529 Vali Acc: 0.859 Test Loss: 0.529 Test Acc: 0.859
Validation loss decreased (-0.843745 --> -0.859370).  Saving model ...
Epoch: 15 cost time: 1.3735229969024658
Epoch: 15, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4385433197021484
Epoch: 16, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.513 Vali Acc: 0.863 Test Loss: 0.513 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 17 cost time: 1.4667532444000244
Epoch: 17, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.501 Vali Acc: 0.859 Test Loss: 0.501 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2824804782867432
Epoch: 18, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.500 Vali Acc: 0.853 Test Loss: 0.500 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3944170475006104
Epoch: 19, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.503 Vali Acc: 0.853 Test Loss: 0.503 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2284414768218994
Epoch: 20, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.550325632095337
Epoch: 21, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.497 Vali Acc: 0.844 Test Loss: 0.497 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7783222198486328
Epoch: 22, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.500 Vali Acc: 0.853 Test Loss: 0.500 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7004482746124268
Epoch: 23, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3886737823486328
Epoch: 24, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5958731174468994
Epoch: 25, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8213086128234863
Epoch: 26, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 613496
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7579588890075684
Epoch: 1, Steps: 8 | Train Loss: 2.310 Vali Loss: 2.201 Vali Acc: 0.087 Test Loss: 2.201 Test Acc: 0.087
Validation loss decreased (inf --> -0.087478).  Saving model ...
Epoch: 2 cost time: 1.7835192680358887
Epoch: 2, Steps: 8 | Train Loss: 2.144 Vali Loss: 2.034 Vali Acc: 0.219 Test Loss: 2.034 Test Acc: 0.219
Validation loss decreased (-0.087478 --> -0.218730).  Saving model ...
Epoch: 3 cost time: 1.780139446258545
Epoch: 3, Steps: 8 | Train Loss: 2.016 Vali Loss: 1.940 Vali Acc: 0.269 Test Loss: 1.940 Test Acc: 0.269
Validation loss decreased (-0.218730 --> -0.268731).  Saving model ...
Epoch: 4 cost time: 2.295974016189575
Epoch: 4, Steps: 8 | Train Loss: 1.852 Vali Loss: 1.780 Vali Acc: 0.500 Test Loss: 1.780 Test Acc: 0.500
Validation loss decreased (-0.268731 --> -0.499982).  Saving model ...
Epoch: 5 cost time: 1.7470600605010986
Epoch: 5, Steps: 8 | Train Loss: 1.705 Vali Loss: 1.576 Vali Acc: 0.716 Test Loss: 1.576 Test Acc: 0.716
Validation loss decreased (-0.499982 --> -0.715609).  Saving model ...
Epoch: 6 cost time: 1.636234998703003
Epoch: 6, Steps: 8 | Train Loss: 1.513 Vali Loss: 1.329 Vali Acc: 0.750 Test Loss: 1.329 Test Acc: 0.750
Validation loss decreased (-0.715609 --> -0.749987).  Saving model ...
Epoch: 7 cost time: 1.7164268493652344
Epoch: 7, Steps: 8 | Train Loss: 1.205 Vali Loss: 1.077 Vali Acc: 0.775 Test Loss: 1.077 Test Acc: 0.775
Validation loss decreased (-0.749987 --> -0.774989).  Saving model ...
Epoch: 8 cost time: 1.9312264919281006
Epoch: 8, Steps: 8 | Train Loss: 0.967 Vali Loss: 0.859 Vali Acc: 0.803 Test Loss: 0.859 Test Acc: 0.803
Validation loss decreased (-0.774989 --> -0.803116).  Saving model ...
Epoch: 9 cost time: 1.6220333576202393
Epoch: 9, Steps: 8 | Train Loss: 0.709 Vali Loss: 0.726 Vali Acc: 0.794 Test Loss: 0.726 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9685137271881104
Epoch: 10, Steps: 8 | Train Loss: 0.557 Vali Loss: 0.634 Vali Acc: 0.831 Test Loss: 0.634 Test Acc: 0.831
Validation loss decreased (-0.803116 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 1.712287425994873
Epoch: 11, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.598 Vali Acc: 0.822 Test Loss: 0.598 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0612528324127197
Epoch: 12, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 13 cost time: 1.6890273094177246
Epoch: 13, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.550 Vali Acc: 0.834 Test Loss: 0.550 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1938605308532715
Epoch: 14, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840620).  Saving model ...
Epoch: 15 cost time: 1.424670696258545
Epoch: 15, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5610742568969727
Epoch: 16, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.515 Vali Acc: 0.838 Test Loss: 0.515 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9863958358764648
Epoch: 17, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.524 Vali Acc: 0.831 Test Loss: 0.524 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6254661083221436
Epoch: 18, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 19 cost time: 1.948329210281372
Epoch: 19, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.504 Vali Acc: 0.847 Test Loss: 0.504 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 20 cost time: 1.4532301425933838
Epoch: 20, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7191238403320312
Epoch: 21, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.522 Vali Acc: 0.834 Test Loss: 0.522 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8880846500396729
Epoch: 22, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8334968090057373
Epoch: 23, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 1.7382640838623047
Epoch: 24, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.516 Vali Acc: 0.847 Test Loss: 0.516 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0712342262268066
Epoch: 25, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.519 Vali Acc: 0.847 Test Loss: 0.519 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6230089664459229
Epoch: 26, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7717082500457764
Epoch: 27, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9436566829681396
Epoch: 28, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.525 Vali Acc: 0.853 Test Loss: 0.525 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 29 cost time: 1.5143544673919678
Epoch: 29, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.188732624053955
Epoch: 30, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.864954948425293
Epoch: 31, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3380353450775146
Epoch: 32, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.7869434356689453
Epoch: 33, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.694664478302002
Epoch: 34, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.8366789817810059
Epoch: 35, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.545 Vali Acc: 0.853 Test Loss: 0.545 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.2409114837646484
Epoch: 36, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.241915225982666
Epoch: 37, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 38 cost time: 1.6763410568237305
Epoch: 38, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.558 Vali Acc: 0.853 Test Loss: 0.558 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.0692596435546875
Epoch: 39, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.2317652702331543
Epoch: 40, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.550 Vali Acc: 0.853 Test Loss: 0.550 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.513530969619751
Epoch: 41, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.7603726387023926
Epoch: 42, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.567 Vali Acc: 0.853 Test Loss: 0.567 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.437105417251587
Epoch: 43, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.5994617938995361
Epoch: 44, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.6187498569488525
Epoch: 45, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.568 Vali Acc: 0.859 Test Loss: 0.568 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859369).  Saving model ...
Epoch: 46 cost time: 1.9979443550109863
Epoch: 46, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.567 Vali Acc: 0.859 Test Loss: 0.567 Test Acc: 0.859
Validation loss decreased (-0.859369 --> -0.859369).  Saving model ...
Epoch: 47 cost time: 1.7412734031677246
Epoch: 47, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.570 Vali Acc: 0.859 Test Loss: 0.570 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.641749382019043
Epoch: 48, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.573 Vali Acc: 0.856 Test Loss: 0.573 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.9221367835998535
Epoch: 49, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.574 Vali Acc: 0.853 Test Loss: 0.574 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.594303846359253
Epoch: 50, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.6643152236938477
Epoch: 51, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.585 Vali Acc: 0.859 Test Loss: 0.585 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.8629913330078125
Epoch: 52, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.581 Vali Acc: 0.859 Test Loss: 0.581 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 2.127037525177002
Epoch: 53, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.580 Vali Acc: 0.863 Test Loss: 0.580 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862494).  Saving model ...
Epoch: 54 cost time: 1.846764326095581
Epoch: 54, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.581 Vali Acc: 0.859 Test Loss: 0.581 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.8246564865112305
Epoch: 55, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.476820707321167
Epoch: 56, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.591 Vali Acc: 0.863 Test Loss: 0.591 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.923802137374878
Epoch: 57, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.590 Vali Acc: 0.859 Test Loss: 0.590 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.5575075149536133
Epoch: 58, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.589 Vali Acc: 0.863 Test Loss: 0.589 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.7373952865600586
Epoch: 59, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.591 Vali Acc: 0.859 Test Loss: 0.591 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.8902533054351807
Epoch: 60, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.595 Vali Acc: 0.863 Test Loss: 0.595 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.8513901233673096
Epoch: 61, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.599 Vali Acc: 0.863 Test Loss: 0.599 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 2.1518030166625977
Epoch: 62, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.600 Vali Acc: 0.859 Test Loss: 0.600 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 2.049832344055176
Epoch: 63, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 610424
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.102162837982178
Epoch: 1, Steps: 8 | Train Loss: 2.359 Vali Loss: 2.184 Vali Acc: 0.134 Test Loss: 2.184 Test Acc: 0.134
Validation loss decreased (inf --> -0.134353).  Saving model ...
Epoch: 2 cost time: 1.3171443939208984
Epoch: 2, Steps: 8 | Train Loss: 2.125 Vali Loss: 2.017 Vali Acc: 0.181 Test Loss: 2.017 Test Acc: 0.181
Validation loss decreased (-0.134353 --> -0.181230).  Saving model ...
Epoch: 3 cost time: 1.469836950302124
Epoch: 3, Steps: 8 | Train Loss: 2.027 Vali Loss: 1.896 Vali Acc: 0.394 Test Loss: 1.896 Test Acc: 0.394
Validation loss decreased (-0.181230 --> -0.393731).  Saving model ...
Epoch: 4 cost time: 1.1947007179260254
Epoch: 4, Steps: 8 | Train Loss: 1.892 Vali Loss: 1.729 Vali Acc: 0.525 Test Loss: 1.729 Test Acc: 0.525
Validation loss decreased (-0.393731 --> -0.524983).  Saving model ...
Epoch: 5 cost time: 1.5836222171783447
Epoch: 5, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.532 Vali Acc: 0.637 Test Loss: 1.532 Test Acc: 0.637
Validation loss decreased (-0.524983 --> -0.637485).  Saving model ...
Epoch: 6 cost time: 1.7393229007720947
Epoch: 6, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.335 Vali Acc: 0.669 Test Loss: 1.335 Test Acc: 0.669
Validation loss decreased (-0.637485 --> -0.668737).  Saving model ...
Epoch: 7 cost time: 1.5170965194702148
Epoch: 7, Steps: 8 | Train Loss: 1.302 Vali Loss: 1.170 Vali Acc: 0.719 Test Loss: 1.170 Test Acc: 0.719
Validation loss decreased (-0.668737 --> -0.718738).  Saving model ...
Epoch: 8 cost time: 1.485978364944458
Epoch: 8, Steps: 8 | Train Loss: 1.083 Vali Loss: 1.012 Vali Acc: 0.766 Test Loss: 1.012 Test Acc: 0.766
Validation loss decreased (-0.718738 --> -0.765615).  Saving model ...
Epoch: 9 cost time: 1.9551420211791992
Epoch: 9, Steps: 8 | Train Loss: 0.921 Vali Loss: 0.887 Vali Acc: 0.784 Test Loss: 0.887 Test Acc: 0.784
Validation loss decreased (-0.765615 --> -0.784366).  Saving model ...
Epoch: 10 cost time: 1.6260170936584473
Epoch: 10, Steps: 8 | Train Loss: 0.746 Vali Loss: 0.796 Vali Acc: 0.806 Test Loss: 0.796 Test Acc: 0.806
Validation loss decreased (-0.784366 --> -0.806242).  Saving model ...
Epoch: 11 cost time: 1.4345362186431885
Epoch: 11, Steps: 8 | Train Loss: 0.672 Vali Loss: 0.724 Vali Acc: 0.812 Test Loss: 0.724 Test Acc: 0.812
Validation loss decreased (-0.806242 --> -0.812493).  Saving model ...
Epoch: 12 cost time: 1.5171830654144287
Epoch: 12, Steps: 8 | Train Loss: 0.583 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
Validation loss decreased (-0.812493 --> -0.818743).  Saving model ...
Epoch: 13 cost time: 1.6403496265411377
Epoch: 13, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.652 Vali Acc: 0.825 Test Loss: 0.652 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 1.370746374130249
Epoch: 14, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.521841287612915
Epoch: 15, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.615 Vali Acc: 0.831 Test Loss: 0.615 Test Acc: 0.831
Validation loss decreased (-0.824993 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 1.4436237812042236
Epoch: 16, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.594 Vali Acc: 0.838 Test Loss: 0.594 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 17 cost time: 1.3686790466308594
Epoch: 17, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2444729804992676
Epoch: 18, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 19 cost time: 1.7575511932373047
Epoch: 19, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.560 Vali Acc: 0.838 Test Loss: 0.560 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6905171871185303
Epoch: 20, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.559 Vali Acc: 0.831 Test Loss: 0.559 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5714337825775146
Epoch: 21, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9048187732696533
Epoch: 22, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843745).  Saving model ...
Epoch: 23 cost time: 1.6979639530181885
Epoch: 23, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3826024532318115
Epoch: 24, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3613438606262207
Epoch: 25, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 26 cost time: 2.2074973583221436
Epoch: 26, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7469699382781982
Epoch: 27, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6919727325439453
Epoch: 28, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9327495098114014
Epoch: 29, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.578474760055542
Epoch: 30, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.6185142993927002
Epoch: 31, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.526 Vali Acc: 0.831 Test Loss: 0.526 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.5831947326660156
Epoch: 32, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.684525966644287
Epoch: 33, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.502023458480835
Epoch: 34, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.901587724685669
Epoch: 35, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 603288
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.472386121749878
Epoch: 1, Steps: 8 | Train Loss: 2.219 Vali Loss: 2.166 Vali Acc: 0.066 Test Loss: 2.166 Test Acc: 0.066
Validation loss decreased (inf --> -0.065603).  Saving model ...
Epoch: 2 cost time: 1.455967903137207
Epoch: 2, Steps: 8 | Train Loss: 2.176 Vali Loss: 2.047 Vali Acc: 0.194 Test Loss: 2.047 Test Acc: 0.194
Validation loss decreased (-0.065603 --> -0.193730).  Saving model ...
Epoch: 3 cost time: 1.3607609272003174
Epoch: 3, Steps: 8 | Train Loss: 2.062 Vali Loss: 1.958 Vali Acc: 0.322 Test Loss: 1.958 Test Acc: 0.322
Validation loss decreased (-0.193730 --> -0.321855).  Saving model ...
Epoch: 4 cost time: 1.4120712280273438
Epoch: 4, Steps: 8 | Train Loss: 1.990 Vali Loss: 1.849 Vali Acc: 0.497 Test Loss: 1.849 Test Acc: 0.497
Validation loss decreased (-0.321855 --> -0.496857).  Saving model ...
Epoch: 5 cost time: 1.6403377056121826
Epoch: 5, Steps: 8 | Train Loss: 1.817 Vali Loss: 1.686 Vali Acc: 0.569 Test Loss: 1.686 Test Acc: 0.569
Validation loss decreased (-0.496857 --> -0.568733).  Saving model ...
Epoch: 6 cost time: 1.3656566143035889
Epoch: 6, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.512 Vali Acc: 0.594 Test Loss: 1.512 Test Acc: 0.594
Validation loss decreased (-0.568733 --> -0.593735).  Saving model ...
Epoch: 7 cost time: 2.1272218227386475
Epoch: 7, Steps: 8 | Train Loss: 1.404 Vali Loss: 1.316 Vali Acc: 0.728 Test Loss: 1.316 Test Acc: 0.728
Validation loss decreased (-0.593735 --> -0.728112).  Saving model ...
Epoch: 8 cost time: 1.2857844829559326
Epoch: 8, Steps: 8 | Train Loss: 1.220 Vali Loss: 1.155 Vali Acc: 0.731 Test Loss: 1.155 Test Acc: 0.731
Validation loss decreased (-0.728112 --> -0.731238).  Saving model ...
Epoch: 9 cost time: 1.3308193683624268
Epoch: 9, Steps: 8 | Train Loss: 1.009 Vali Loss: 1.013 Vali Acc: 0.772 Test Loss: 1.013 Test Acc: 0.772
Validation loss decreased (-0.731238 --> -0.771865).  Saving model ...
Epoch: 10 cost time: 1.5746638774871826
Epoch: 10, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.888 Vali Acc: 0.803 Test Loss: 0.888 Test Acc: 0.803
Validation loss decreased (-0.771865 --> -0.803116).  Saving model ...
Epoch: 11 cost time: 1.5342390537261963
Epoch: 11, Steps: 8 | Train Loss: 0.730 Vali Loss: 0.796 Vali Acc: 0.809 Test Loss: 0.796 Test Acc: 0.809
Validation loss decreased (-0.803116 --> -0.809367).  Saving model ...
Epoch: 12 cost time: 1.376699686050415
Epoch: 12, Steps: 8 | Train Loss: 0.619 Vali Loss: 0.734 Vali Acc: 0.809 Test Loss: 0.734 Test Acc: 0.809
Validation loss decreased (-0.809367 --> -0.809368).  Saving model ...
Epoch: 13 cost time: 1.577735185623169
Epoch: 13, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.683 Vali Acc: 0.822 Test Loss: 0.683 Test Acc: 0.822
Validation loss decreased (-0.809368 --> -0.821868).  Saving model ...
Epoch: 14 cost time: 1.335479974746704
Epoch: 14, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.656 Vali Acc: 0.825 Test Loss: 0.656 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824993).  Saving model ...
Epoch: 15 cost time: 1.6177892684936523
Epoch: 15, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 16 cost time: 1.3447411060333252
Epoch: 16, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.595 Vali Acc: 0.825 Test Loss: 0.595 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 17 cost time: 1.3421716690063477
Epoch: 17, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.582 Vali Acc: 0.831 Test Loss: 0.582 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 18 cost time: 1.6105690002441406
Epoch: 18, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.577 Vali Acc: 0.825 Test Loss: 0.577 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.579444169998169
Epoch: 19, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 20 cost time: 1.658823013305664
Epoch: 20, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.549 Vali Acc: 0.831 Test Loss: 0.549 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6368718147277832
Epoch: 21, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843745).  Saving model ...
Epoch: 22 cost time: 1.322493076324463
Epoch: 22, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.514 Vali Acc: 0.834 Test Loss: 0.514 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5187835693359375
Epoch: 23, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.525 Vali Acc: 0.831 Test Loss: 0.525 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0775375366210938
Epoch: 24, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 25 cost time: 1.476205587387085
Epoch: 25, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6059863567352295
Epoch: 26, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.704662561416626
Epoch: 27, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6302647590637207
Epoch: 28, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5521011352539062
Epoch: 29, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.509 Vali Acc: 0.831 Test Loss: 0.509 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4909918308258057
Epoch: 30, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4345498085021973
Epoch: 31, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.3426456451416016
Epoch: 32, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2764227390289307
Epoch: 33, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.4980897903442383
Epoch: 34, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 601752
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.429346799850464
Epoch: 1, Steps: 8 | Train Loss: 2.157 Vali Loss: 2.058 Vali Acc: 0.178 Test Loss: 2.058 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 1.7377710342407227
Epoch: 2, Steps: 8 | Train Loss: 2.100 Vali Loss: 1.982 Vali Acc: 0.338 Test Loss: 1.982 Test Acc: 0.338
Validation loss decreased (-0.178104 --> -0.337480).  Saving model ...
Epoch: 3 cost time: 1.5747833251953125
Epoch: 3, Steps: 8 | Train Loss: 2.021 Vali Loss: 1.911 Vali Acc: 0.409 Test Loss: 1.911 Test Acc: 0.409
Validation loss decreased (-0.337480 --> -0.409356).  Saving model ...
Epoch: 4 cost time: 1.5933582782745361
Epoch: 4, Steps: 8 | Train Loss: 1.920 Vali Loss: 1.806 Vali Acc: 0.450 Test Loss: 1.806 Test Acc: 0.450
Validation loss decreased (-0.409356 --> -0.449982).  Saving model ...
Epoch: 5 cost time: 1.4976983070373535
Epoch: 5, Steps: 8 | Train Loss: 1.801 Vali Loss: 1.649 Vali Acc: 0.603 Test Loss: 1.649 Test Acc: 0.603
Validation loss decreased (-0.449982 --> -0.603109).  Saving model ...
Epoch: 6 cost time: 1.3727195262908936
Epoch: 6, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.466 Vali Acc: 0.694 Test Loss: 1.466 Test Acc: 0.694
Validation loss decreased (-0.603109 --> -0.693735).  Saving model ...
Epoch: 7 cost time: 1.5899701118469238
Epoch: 7, Steps: 8 | Train Loss: 1.387 Vali Loss: 1.285 Vali Acc: 0.716 Test Loss: 1.285 Test Acc: 0.716
Validation loss decreased (-0.693735 --> -0.715612).  Saving model ...
Epoch: 8 cost time: 1.555039882659912
Epoch: 8, Steps: 8 | Train Loss: 1.194 Vali Loss: 1.137 Vali Acc: 0.703 Test Loss: 1.137 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6031584739685059
Epoch: 9, Steps: 8 | Train Loss: 1.000 Vali Loss: 0.984 Vali Acc: 0.787 Test Loss: 0.984 Test Acc: 0.787
Validation loss decreased (-0.715612 --> -0.787490).  Saving model ...
Epoch: 10 cost time: 1.328754186630249
Epoch: 10, Steps: 8 | Train Loss: 0.822 Vali Loss: 0.881 Vali Acc: 0.803 Test Loss: 0.881 Test Acc: 0.803
Validation loss decreased (-0.787490 --> -0.803116).  Saving model ...
Epoch: 11 cost time: 1.525482416152954
Epoch: 11, Steps: 8 | Train Loss: 0.714 Vali Loss: 0.804 Vali Acc: 0.812 Test Loss: 0.804 Test Acc: 0.812
Validation loss decreased (-0.803116 --> -0.812492).  Saving model ...
Epoch: 12 cost time: 1.4525368213653564
Epoch: 12, Steps: 8 | Train Loss: 0.629 Vali Loss: 0.722 Vali Acc: 0.847 Test Loss: 0.722 Test Acc: 0.847
Validation loss decreased (-0.812492 --> -0.846868).  Saving model ...
Epoch: 13 cost time: 1.4834802150726318
Epoch: 13, Steps: 8 | Train Loss: 0.528 Vali Loss: 0.670 Vali Acc: 0.844 Test Loss: 0.670 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5966155529022217
Epoch: 14, Steps: 8 | Train Loss: 0.456 Vali Loss: 0.624 Vali Acc: 0.847 Test Loss: 0.624 Test Acc: 0.847
Validation loss decreased (-0.846868 --> -0.846869).  Saving model ...
Epoch: 15 cost time: 2.079646348953247
Epoch: 15, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 1.5043268203735352
Epoch: 16, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.584 Vali Acc: 0.853 Test Loss: 0.584 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853119).  Saving model ...
Epoch: 17 cost time: 1.5452945232391357
Epoch: 17, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.565 Vali Acc: 0.853 Test Loss: 0.565 Test Acc: 0.853
Validation loss decreased (-0.853119 --> -0.853119).  Saving model ...
Epoch: 18 cost time: 1.5785784721374512
Epoch: 18, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.545 Vali Acc: 0.863 Test Loss: 0.545 Test Acc: 0.863
Validation loss decreased (-0.853119 --> -0.862495).  Saving model ...
Epoch: 19 cost time: 1.5721466541290283
Epoch: 19, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.729646921157837
Epoch: 20, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.540 Vali Acc: 0.859 Test Loss: 0.540 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7224881649017334
Epoch: 21, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3716685771942139
Epoch: 22, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.476367473602295
Epoch: 23, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.511 Vali Acc: 0.863 Test Loss: 0.511 Test Acc: 0.863
Validation loss decreased (-0.862495 --> -0.862495).  Saving model ...
Epoch: 24 cost time: 1.7789802551269531
Epoch: 24, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.494 Vali Acc: 0.866 Test Loss: 0.494 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865620).  Saving model ...
Epoch: 25 cost time: 1.3993186950683594
Epoch: 25, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.496 Vali Acc: 0.859 Test Loss: 0.496 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6018667221069336
Epoch: 26, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3612229824066162
Epoch: 27, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8712568283081055
Epoch: 28, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4449892044067383
Epoch: 29, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.497 Vali Acc: 0.847 Test Loss: 0.497 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5907015800476074
Epoch: 30, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.490 Vali Acc: 0.847 Test Loss: 0.490 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5477230548858643
Epoch: 31, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.1200389862060547
Epoch: 32, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.498 Vali Acc: 0.847 Test Loss: 0.498 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4200663566589355
Epoch: 33, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.503 Vali Acc: 0.853 Test Loss: 0.503 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6184697151184082
Epoch: 34, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 600216
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.266533136367798
Epoch: 1, Steps: 8 | Train Loss: 2.396 Vali Loss: 2.268 Vali Acc: 0.122 Test Loss: 2.268 Test Acc: 0.122
Validation loss decreased (inf --> -0.121852).  Saving model ...
Epoch: 2 cost time: 1.8723866939544678
Epoch: 2, Steps: 8 | Train Loss: 2.290 Vali Loss: 2.117 Vali Acc: 0.141 Test Loss: 2.117 Test Acc: 0.141
Validation loss decreased (-0.121852 --> -0.140604).  Saving model ...
Epoch: 3 cost time: 1.561516523361206
Epoch: 3, Steps: 8 | Train Loss: 2.109 Vali Loss: 2.020 Vali Acc: 0.231 Test Loss: 2.020 Test Acc: 0.231
Validation loss decreased (-0.140604 --> -0.231230).  Saving model ...
Epoch: 4 cost time: 1.6408028602600098
Epoch: 4, Steps: 8 | Train Loss: 2.051 Vali Loss: 1.919 Vali Acc: 0.362 Test Loss: 1.919 Test Acc: 0.362
Validation loss decreased (-0.231230 --> -0.362481).  Saving model ...
Epoch: 5 cost time: 1.721893310546875
Epoch: 5, Steps: 8 | Train Loss: 1.853 Vali Loss: 1.781 Vali Acc: 0.453 Test Loss: 1.781 Test Acc: 0.453
Validation loss decreased (-0.362481 --> -0.453107).  Saving model ...
Epoch: 6 cost time: 1.6471893787384033
Epoch: 6, Steps: 8 | Train Loss: 1.717 Vali Loss: 1.621 Vali Acc: 0.584 Test Loss: 1.621 Test Acc: 0.584
Validation loss decreased (-0.453107 --> -0.584359).  Saving model ...
Epoch: 7 cost time: 1.8446245193481445
Epoch: 7, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.425 Vali Acc: 0.666 Test Loss: 1.425 Test Acc: 0.666
Validation loss decreased (-0.584359 --> -0.665611).  Saving model ...
Epoch: 8 cost time: 1.5428128242492676
Epoch: 8, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.226 Vali Acc: 0.744 Test Loss: 1.226 Test Acc: 0.744
Validation loss decreased (-0.665611 --> -0.743738).  Saving model ...
Epoch: 9 cost time: 1.5977258682250977
Epoch: 9, Steps: 8 | Train Loss: 1.090 Vali Loss: 1.059 Vali Acc: 0.772 Test Loss: 1.059 Test Acc: 0.772
Validation loss decreased (-0.743738 --> -0.771864).  Saving model ...
Epoch: 10 cost time: 1.4028174877166748
Epoch: 10, Steps: 8 | Train Loss: 0.941 Vali Loss: 0.927 Vali Acc: 0.791 Test Loss: 0.927 Test Acc: 0.791
Validation loss decreased (-0.771864 --> -0.790616).  Saving model ...
Epoch: 11 cost time: 1.6098475456237793
Epoch: 11, Steps: 8 | Train Loss: 0.763 Vali Loss: 0.823 Vali Acc: 0.809 Test Loss: 0.823 Test Acc: 0.809
Validation loss decreased (-0.790616 --> -0.809367).  Saving model ...
Epoch: 12 cost time: 1.6897010803222656
Epoch: 12, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.744 Vali Acc: 0.822 Test Loss: 0.744 Test Acc: 0.822
Validation loss decreased (-0.809367 --> -0.821868).  Saving model ...
Epoch: 13 cost time: 1.582353115081787
Epoch: 13, Steps: 8 | Train Loss: 0.543 Vali Loss: 0.688 Vali Acc: 0.831 Test Loss: 0.688 Test Acc: 0.831
Validation loss decreased (-0.821868 --> -0.831243).  Saving model ...
Epoch: 14 cost time: 1.6820542812347412
Epoch: 14, Steps: 8 | Train Loss: 0.468 Vali Loss: 0.647 Vali Acc: 0.834 Test Loss: 0.647 Test Acc: 0.834
Validation loss decreased (-0.831243 --> -0.834369).  Saving model ...
Epoch: 15 cost time: 1.6797590255737305
Epoch: 15, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.619 Vali Acc: 0.838 Test Loss: 0.619 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 16 cost time: 1.3617606163024902
Epoch: 16, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.611 Vali Acc: 0.831 Test Loss: 0.611 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5945069789886475
Epoch: 17, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.597 Vali Acc: 0.825 Test Loss: 0.597 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7546720504760742
Epoch: 18, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5172104835510254
Epoch: 19, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.569 Vali Acc: 0.834 Test Loss: 0.569 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7025425434112549
Epoch: 20, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3677713871002197
Epoch: 21, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.572 Vali Acc: 0.812 Test Loss: 0.572 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.584733009338379
Epoch: 22, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.568 Vali Acc: 0.828 Test Loss: 0.568 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2908565998077393
Epoch: 23, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4015588760375977
Epoch: 24, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.554 Vali Acc: 0.816 Test Loss: 0.554 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4738564491271973
Epoch: 25, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 598680
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.907212495803833
Epoch: 1, Steps: 8 | Train Loss: 2.315 Vali Loss: 2.200 Vali Acc: 0.138 Test Loss: 2.200 Test Acc: 0.138
Validation loss decreased (inf --> -0.137478).  Saving model ...
Epoch: 2 cost time: 1.5145542621612549
Epoch: 2, Steps: 8 | Train Loss: 2.149 Vali Loss: 2.085 Vali Acc: 0.163 Test Loss: 2.085 Test Acc: 0.163
Validation loss decreased (-0.137478 --> -0.162479).  Saving model ...
Epoch: 3 cost time: 1.7731380462646484
Epoch: 3, Steps: 8 | Train Loss: 2.063 Vali Loss: 2.012 Vali Acc: 0.250 Test Loss: 2.012 Test Acc: 0.250
Validation loss decreased (-0.162479 --> -0.249980).  Saving model ...
Epoch: 4 cost time: 1.4630279541015625
Epoch: 4, Steps: 8 | Train Loss: 1.944 Vali Loss: 1.934 Vali Acc: 0.341 Test Loss: 1.934 Test Acc: 0.341
Validation loss decreased (-0.249980 --> -0.340606).  Saving model ...
Epoch: 5 cost time: 1.6567463874816895
Epoch: 5, Steps: 8 | Train Loss: 1.912 Vali Loss: 1.810 Vali Acc: 0.469 Test Loss: 1.810 Test Acc: 0.469
Validation loss decreased (-0.340606 --> -0.468732).  Saving model ...
Epoch: 6 cost time: 1.8133876323699951
Epoch: 6, Steps: 8 | Train Loss: 1.730 Vali Loss: 1.651 Vali Acc: 0.637 Test Loss: 1.651 Test Acc: 0.637
Validation loss decreased (-0.468732 --> -0.637483).  Saving model ...
Epoch: 7 cost time: 1.5372154712677002
Epoch: 7, Steps: 8 | Train Loss: 1.512 Vali Loss: 1.468 Vali Acc: 0.675 Test Loss: 1.468 Test Acc: 0.675
Validation loss decreased (-0.637483 --> -0.674985).  Saving model ...
Epoch: 8 cost time: 1.4167325496673584
Epoch: 8, Steps: 8 | Train Loss: 1.348 Vali Loss: 1.281 Vali Acc: 0.713 Test Loss: 1.281 Test Acc: 0.713
Validation loss decreased (-0.674985 --> -0.712487).  Saving model ...
Epoch: 9 cost time: 1.811333179473877
Epoch: 9, Steps: 8 | Train Loss: 1.127 Vali Loss: 1.111 Vali Acc: 0.750 Test Loss: 1.111 Test Acc: 0.750
Validation loss decreased (-0.712487 --> -0.749989).  Saving model ...
Epoch: 10 cost time: 1.9142491817474365
Epoch: 10, Steps: 8 | Train Loss: 0.946 Vali Loss: 0.961 Vali Acc: 0.772 Test Loss: 0.961 Test Acc: 0.772
Validation loss decreased (-0.749989 --> -0.771865).  Saving model ...
Epoch: 11 cost time: 1.5159862041473389
Epoch: 11, Steps: 8 | Train Loss: 0.804 Vali Loss: 0.849 Vali Acc: 0.791 Test Loss: 0.849 Test Acc: 0.791
Validation loss decreased (-0.771865 --> -0.790617).  Saving model ...
Epoch: 12 cost time: 1.9275071620941162
Epoch: 12, Steps: 8 | Train Loss: 0.669 Vali Loss: 0.767 Vali Acc: 0.812 Test Loss: 0.767 Test Acc: 0.812
Validation loss decreased (-0.790617 --> -0.812492).  Saving model ...
Epoch: 13 cost time: 1.6911394596099854
Epoch: 13, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.698 Vali Acc: 0.841 Test Loss: 0.698 Test Acc: 0.841
Validation loss decreased (-0.812492 --> -0.840618).  Saving model ...
Epoch: 14 cost time: 1.669631004333496
Epoch: 14, Steps: 8 | Train Loss: 0.541 Vali Loss: 0.662 Vali Acc: 0.828 Test Loss: 0.662 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7838151454925537
Epoch: 15, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.630 Vali Acc: 0.834 Test Loss: 0.630 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8659138679504395
Epoch: 16, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.612 Vali Acc: 0.834 Test Loss: 0.612 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6949384212493896
Epoch: 17, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.589 Vali Acc: 0.834 Test Loss: 0.589 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9583957195281982
Epoch: 18, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.575 Vali Acc: 0.828 Test Loss: 0.575 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.906914234161377
Epoch: 19, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.866718053817749
Epoch: 20, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5604655742645264
Epoch: 21, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.553 Vali Acc: 0.831 Test Loss: 0.553 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6597471237182617
Epoch: 22, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.522134780883789
Epoch: 23, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.543 Vali Acc: 0.831 Test Loss: 0.543 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 370328
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8800034523010254
Epoch: 1, Steps: 8 | Train Loss: 2.105 Vali Loss: 2.075 Vali Acc: 0.206 Test Loss: 2.075 Test Acc: 0.206
Validation loss decreased (inf --> -0.206229).  Saving model ...
Epoch: 2 cost time: 2.066999912261963
Epoch: 2, Steps: 8 | Train Loss: 2.078 Vali Loss: 1.995 Vali Acc: 0.225 Test Loss: 1.995 Test Acc: 0.225
Validation loss decreased (-0.206229 --> -0.224980).  Saving model ...
Epoch: 3 cost time: 1.5425128936767578
Epoch: 3, Steps: 8 | Train Loss: 1.964 Vali Loss: 1.924 Vali Acc: 0.347 Test Loss: 1.924 Test Acc: 0.347
Validation loss decreased (-0.224980 --> -0.346856).  Saving model ...
Epoch: 4 cost time: 1.4592969417572021
Epoch: 4, Steps: 8 | Train Loss: 1.946 Vali Loss: 1.830 Vali Acc: 0.484 Test Loss: 1.830 Test Acc: 0.484
Validation loss decreased (-0.346856 --> -0.484357).  Saving model ...
Epoch: 5 cost time: 1.5352668762207031
Epoch: 5, Steps: 8 | Train Loss: 1.787 Vali Loss: 1.698 Vali Acc: 0.566 Test Loss: 1.698 Test Acc: 0.566
Validation loss decreased (-0.484357 --> -0.565608).  Saving model ...
Epoch: 6 cost time: 1.269995927810669
Epoch: 6, Steps: 8 | Train Loss: 1.643 Vali Loss: 1.551 Vali Acc: 0.644 Test Loss: 1.551 Test Acc: 0.644
Validation loss decreased (-0.565608 --> -0.643734).  Saving model ...
Epoch: 7 cost time: 1.7147185802459717
Epoch: 7, Steps: 8 | Train Loss: 1.513 Vali Loss: 1.376 Vali Acc: 0.691 Test Loss: 1.376 Test Acc: 0.691
Validation loss decreased (-0.643734 --> -0.690611).  Saving model ...
Epoch: 8 cost time: 1.3267054557800293
Epoch: 8, Steps: 8 | Train Loss: 1.295 Vali Loss: 1.209 Vali Acc: 0.703 Test Loss: 1.209 Test Acc: 0.703
Validation loss decreased (-0.690611 --> -0.703113).  Saving model ...
Epoch: 9 cost time: 1.6541690826416016
Epoch: 9, Steps: 8 | Train Loss: 1.084 Vali Loss: 1.058 Vali Acc: 0.734 Test Loss: 1.058 Test Acc: 0.734
Validation loss decreased (-0.703113 --> -0.734364).  Saving model ...
Epoch: 10 cost time: 1.433023452758789
Epoch: 10, Steps: 8 | Train Loss: 0.945 Vali Loss: 0.935 Vali Acc: 0.759 Test Loss: 0.935 Test Acc: 0.759
Validation loss decreased (-0.734364 --> -0.759366).  Saving model ...
Epoch: 11 cost time: 1.2047533988952637
Epoch: 11, Steps: 8 | Train Loss: 0.812 Vali Loss: 0.848 Vali Acc: 0.762 Test Loss: 0.848 Test Acc: 0.762
Validation loss decreased (-0.759366 --> -0.762492).  Saving model ...
Epoch: 12 cost time: 1.6977245807647705
Epoch: 12, Steps: 8 | Train Loss: 0.690 Vali Loss: 0.784 Vali Acc: 0.762 Test Loss: 0.784 Test Acc: 0.762
Validation loss decreased (-0.762492 --> -0.762492).  Saving model ...
Epoch: 13 cost time: 1.67527174949646
Epoch: 13, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.727 Vali Acc: 0.778 Test Loss: 0.727 Test Acc: 0.778
Validation loss decreased (-0.762492 --> -0.778118).  Saving model ...
Epoch: 14 cost time: 1.7596890926361084
Epoch: 14, Steps: 8 | Train Loss: 0.527 Vali Loss: 0.686 Vali Acc: 0.787 Test Loss: 0.686 Test Acc: 0.787
Validation loss decreased (-0.778118 --> -0.787493).  Saving model ...
Epoch: 15 cost time: 1.622323989868164
Epoch: 15, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.658 Vali Acc: 0.784 Test Loss: 0.658 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4765102863311768
Epoch: 16, Steps: 8 | Train Loss: 0.422 Vali Loss: 0.638 Vali Acc: 0.784 Test Loss: 0.638 Test Acc: 0.784
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.502859354019165
Epoch: 17, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
Validation loss decreased (-0.787493 --> -0.803119).  Saving model ...
Epoch: 18 cost time: 1.5402824878692627
Epoch: 18, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.600 Vali Acc: 0.797 Test Loss: 0.600 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.807586908340454
Epoch: 19, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 20 cost time: 1.4918556213378906
Epoch: 20, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
Validation loss decreased (-0.803119 --> -0.818744).  Saving model ...
Epoch: 21 cost time: 1.3198058605194092
Epoch: 21, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5441572666168213
Epoch: 22, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 23 cost time: 1.4100887775421143
Epoch: 23, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 24 cost time: 1.3506267070770264
Epoch: 24, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 25 cost time: 1.2920656204223633
Epoch: 25, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.542 Vali Acc: 0.831 Test Loss: 0.542 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 26 cost time: 1.2082810401916504
Epoch: 26, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.376255750656128
Epoch: 27, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 28 cost time: 1.631892442703247
Epoch: 28, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.528 Vali Acc: 0.831 Test Loss: 0.528 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5997693538665771
Epoch: 29, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7628910541534424
Epoch: 30, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 31 cost time: 1.8177971839904785
Epoch: 31, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.619394302368164
Epoch: 32, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.523 Vali Acc: 0.831 Test Loss: 0.523 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6471271514892578
Epoch: 33, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6087453365325928
Epoch: 34, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5898451805114746
Epoch: 35, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7584149837493896
Epoch: 36, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.7162864208221436
Epoch: 37, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.511 Vali Acc: 0.834 Test Loss: 0.511 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.715376615524292
Epoch: 38, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.5522634983062744
Epoch: 39, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6126914024353027
Epoch: 40, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.513 Vali Acc: 0.831 Test Loss: 0.513 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 368792
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.529118061065674
Epoch: 1, Steps: 8 | Train Loss: 2.218 Vali Loss: 2.160 Vali Acc: 0.134 Test Loss: 2.160 Test Acc: 0.134
Validation loss decreased (inf --> -0.134353).  Saving model ...
Epoch: 2 cost time: 1.7996282577514648
Epoch: 2, Steps: 8 | Train Loss: 2.146 Vali Loss: 2.045 Vali Acc: 0.178 Test Loss: 2.045 Test Acc: 0.178
Validation loss decreased (-0.134353 --> -0.178105).  Saving model ...
Epoch: 3 cost time: 1.4654908180236816
Epoch: 3, Steps: 8 | Train Loss: 2.058 Vali Loss: 1.963 Vali Acc: 0.328 Test Loss: 1.963 Test Acc: 0.328
Validation loss decreased (-0.178105 --> -0.328105).  Saving model ...
Epoch: 4 cost time: 1.8087069988250732
Epoch: 4, Steps: 8 | Train Loss: 1.960 Vali Loss: 1.884 Vali Acc: 0.366 Test Loss: 1.884 Test Acc: 0.366
Validation loss decreased (-0.328105 --> -0.365606).  Saving model ...
Epoch: 5 cost time: 1.6368494033813477
Epoch: 5, Steps: 8 | Train Loss: 1.865 Vali Loss: 1.765 Vali Acc: 0.528 Test Loss: 1.765 Test Acc: 0.528
Validation loss decreased (-0.365606 --> -0.528107).  Saving model ...
Epoch: 6 cost time: 1.965696096420288
Epoch: 6, Steps: 8 | Train Loss: 1.735 Vali Loss: 1.614 Vali Acc: 0.609 Test Loss: 1.614 Test Acc: 0.609
Validation loss decreased (-0.528107 --> -0.609359).  Saving model ...
Epoch: 7 cost time: 1.5935580730438232
Epoch: 7, Steps: 8 | Train Loss: 1.556 Vali Loss: 1.430 Vali Acc: 0.684 Test Loss: 1.430 Test Acc: 0.684
Validation loss decreased (-0.609359 --> -0.684361).  Saving model ...
Epoch: 8 cost time: 1.4717833995819092
Epoch: 8, Steps: 8 | Train Loss: 1.342 Vali Loss: 1.243 Vali Acc: 0.703 Test Loss: 1.243 Test Acc: 0.703
Validation loss decreased (-0.684361 --> -0.703113).  Saving model ...
Epoch: 9 cost time: 1.538550853729248
Epoch: 9, Steps: 8 | Train Loss: 1.158 Vali Loss: 1.078 Vali Acc: 0.741 Test Loss: 1.078 Test Acc: 0.741
Validation loss decreased (-0.703113 --> -0.740614).  Saving model ...
Epoch: 10 cost time: 1.7182157039642334
Epoch: 10, Steps: 8 | Train Loss: 0.974 Vali Loss: 0.951 Vali Acc: 0.759 Test Loss: 0.951 Test Acc: 0.759
Validation loss decreased (-0.740614 --> -0.759365).  Saving model ...
Epoch: 11 cost time: 1.8237025737762451
Epoch: 11, Steps: 8 | Train Loss: 0.808 Vali Loss: 0.847 Vali Acc: 0.769 Test Loss: 0.847 Test Acc: 0.769
Validation loss decreased (-0.759365 --> -0.768742).  Saving model ...
Epoch: 12 cost time: 1.7058045864105225
Epoch: 12, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.759 Vali Acc: 0.781 Test Loss: 0.759 Test Acc: 0.781
Validation loss decreased (-0.768742 --> -0.781242).  Saving model ...
Epoch: 13 cost time: 2.0533411502838135
Epoch: 13, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.701 Vali Acc: 0.806 Test Loss: 0.701 Test Acc: 0.806
Validation loss decreased (-0.781242 --> -0.806243).  Saving model ...
Epoch: 14 cost time: 2.1564512252807617
Epoch: 14, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.661 Vali Acc: 0.825 Test Loss: 0.661 Test Acc: 0.825
Validation loss decreased (-0.806243 --> -0.824993).  Saving model ...
Epoch: 15 cost time: 2.0192267894744873
Epoch: 15, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.634 Vali Acc: 0.825 Test Loss: 0.634 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 16 cost time: 1.6023507118225098
Epoch: 16, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.614 Vali Acc: 0.828 Test Loss: 0.614 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 17 cost time: 1.9527397155761719
Epoch: 17, Steps: 8 | Train Loss: 0.388 Vali Loss: 0.595 Vali Acc: 0.831 Test Loss: 0.595 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 18 cost time: 2.2909886837005615
Epoch: 18, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.573 Vali Acc: 0.834 Test Loss: 0.573 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 19 cost time: 1.5951547622680664
Epoch: 19, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 20 cost time: 1.735840082168579
Epoch: 20, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.557 Vali Acc: 0.841 Test Loss: 0.557 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 21 cost time: 1.9375386238098145
Epoch: 21, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840620).  Saving model ...
Epoch: 22 cost time: 1.7295241355895996
Epoch: 22, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 23 cost time: 1.7351183891296387
Epoch: 23, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7517616748809814
Epoch: 24, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 1.5894100666046143
Epoch: 25, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6450178623199463
Epoch: 26, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 27 cost time: 1.6019272804260254
Epoch: 27, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4905617237091064
Epoch: 28, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1780080795288086
Epoch: 29, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.0625452995300293
Epoch: 30, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.9478528499603271
Epoch: 31, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.066023349761963
Epoch: 32, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.511 Vali Acc: 0.838 Test Loss: 0.511 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.1901791095733643
Epoch: 33, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.5777781009674072
Epoch: 34, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.512 Vali Acc: 0.834 Test Loss: 0.512 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.3557817935943604
Epoch: 35, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.0213680267333984
Epoch: 36, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 367256
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9510018825531006
Epoch: 1, Steps: 8 | Train Loss: 2.225 Vali Loss: 2.154 Vali Acc: 0.178 Test Loss: 2.154 Test Acc: 0.178
Validation loss decreased (inf --> -0.178103).  Saving model ...
Epoch: 2 cost time: 1.4221997261047363
Epoch: 2, Steps: 8 | Train Loss: 2.117 Vali Loss: 2.065 Vali Acc: 0.172 Test Loss: 2.065 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6603014469146729
Epoch: 3, Steps: 8 | Train Loss: 2.032 Vali Loss: 1.995 Vali Acc: 0.219 Test Loss: 1.995 Test Acc: 0.219
Validation loss decreased (-0.178103 --> -0.218730).  Saving model ...
Epoch: 4 cost time: 1.380112886428833
Epoch: 4, Steps: 8 | Train Loss: 1.982 Vali Loss: 1.913 Vali Acc: 0.319 Test Loss: 1.913 Test Acc: 0.319
Validation loss decreased (-0.218730 --> -0.318731).  Saving model ...
Epoch: 5 cost time: 1.7575328350067139
Epoch: 5, Steps: 8 | Train Loss: 1.885 Vali Loss: 1.798 Vali Acc: 0.578 Test Loss: 1.798 Test Acc: 0.578
Validation loss decreased (-0.318731 --> -0.578107).  Saving model ...
Epoch: 6 cost time: 1.7137329578399658
Epoch: 6, Steps: 8 | Train Loss: 1.742 Vali Loss: 1.658 Vali Acc: 0.616 Test Loss: 1.658 Test Acc: 0.616
Validation loss decreased (-0.578107 --> -0.615608).  Saving model ...
Epoch: 7 cost time: 2.219576358795166
Epoch: 7, Steps: 8 | Train Loss: 1.613 Vali Loss: 1.476 Vali Acc: 0.681 Test Loss: 1.476 Test Acc: 0.681
Validation loss decreased (-0.615608 --> -0.681235).  Saving model ...
Epoch: 8 cost time: 1.1960854530334473
Epoch: 8, Steps: 8 | Train Loss: 1.417 Vali Loss: 1.289 Vali Acc: 0.728 Test Loss: 1.289 Test Acc: 0.728
Validation loss decreased (-0.681235 --> -0.728112).  Saving model ...
Epoch: 9 cost time: 1.656867504119873
Epoch: 9, Steps: 8 | Train Loss: 1.173 Vali Loss: 1.110 Vali Acc: 0.772 Test Loss: 1.110 Test Acc: 0.772
Validation loss decreased (-0.728112 --> -0.771864).  Saving model ...
Epoch: 10 cost time: 1.5833656787872314
Epoch: 10, Steps: 8 | Train Loss: 0.994 Vali Loss: 0.952 Vali Acc: 0.812 Test Loss: 0.952 Test Acc: 0.812
Validation loss decreased (-0.771864 --> -0.812490).  Saving model ...
Epoch: 11 cost time: 1.521761178970337
Epoch: 11, Steps: 8 | Train Loss: 0.806 Vali Loss: 0.842 Vali Acc: 0.800 Test Loss: 0.842 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7305116653442383
Epoch: 12, Steps: 8 | Train Loss: 0.687 Vali Loss: 0.756 Vali Acc: 0.812 Test Loss: 0.756 Test Acc: 0.812
Validation loss decreased (-0.812490 --> -0.812492).  Saving model ...
Epoch: 13 cost time: 1.632277250289917
Epoch: 13, Steps: 8 | Train Loss: 0.604 Vali Loss: 0.686 Vali Acc: 0.803 Test Loss: 0.686 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3717844486236572
Epoch: 14, Steps: 8 | Train Loss: 0.513 Vali Loss: 0.647 Vali Acc: 0.803 Test Loss: 0.647 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7154905796051025
Epoch: 15, Steps: 8 | Train Loss: 0.468 Vali Loss: 0.617 Vali Acc: 0.822 Test Loss: 0.617 Test Acc: 0.822
Validation loss decreased (-0.812492 --> -0.821869).  Saving model ...
Epoch: 16 cost time: 1.7685267925262451
Epoch: 16, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.595 Vali Acc: 0.806 Test Loss: 0.595 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5577282905578613
Epoch: 17, Steps: 8 | Train Loss: 0.389 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8363194465637207
Epoch: 18, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7247157096862793
Epoch: 19, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.552 Vali Acc: 0.812 Test Loss: 0.552 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.472381830215454
Epoch: 20, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821870).  Saving model ...
Epoch: 21 cost time: 1.8111016750335693
Epoch: 21, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.538 Vali Acc: 0.819 Test Loss: 0.538 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.444216251373291
Epoch: 22, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828120).  Saving model ...
Epoch: 23 cost time: 1.2311007976531982
Epoch: 23, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.526 Vali Acc: 0.828 Test Loss: 0.526 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 24 cost time: 1.4738085269927979
Epoch: 24, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1914269924163818
Epoch: 25, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 26 cost time: 1.6136224269866943
Epoch: 26, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.506 Vali Acc: 0.847 Test Loss: 0.506 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 27 cost time: 1.406938076019287
Epoch: 27, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3715119361877441
Epoch: 28, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.495 Vali Acc: 0.831 Test Loss: 0.495 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3284523487091064
Epoch: 29, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.499 Vali Acc: 0.828 Test Loss: 0.499 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2254738807678223
Epoch: 30, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.496 Vali Acc: 0.831 Test Loss: 0.496 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5778629779815674
Epoch: 31, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.493 Vali Acc: 0.831 Test Loss: 0.493 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.552588701248169
Epoch: 32, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.489 Vali Acc: 0.828 Test Loss: 0.489 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.8111329078674316
Epoch: 33, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.482 Vali Acc: 0.831 Test Loss: 0.482 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.323716163635254
Epoch: 34, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.482 Vali Acc: 0.834 Test Loss: 0.482 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.7060718536376953
Epoch: 35, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.4100029468536377
Epoch: 36, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 37 cost time: 1.6287128925323486
Epoch: 37, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5738799571990967
Epoch: 38, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.518141746520996
Epoch: 39, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 40 cost time: 1.300377607345581
Epoch: 40, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.682126760482788
Epoch: 41, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.481 Vali Acc: 0.838 Test Loss: 0.481 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.5677270889282227
Epoch: 42, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.480 Vali Acc: 0.834 Test Loss: 0.480 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.7176246643066406
Epoch: 43, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.7722408771514893
Epoch: 44, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.4552950859069824
Epoch: 45, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.328270435333252
Epoch: 46, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.6136925220489502
Epoch: 47, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.493 Vali Acc: 0.838 Test Loss: 0.493 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.378542423248291
Epoch: 48, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.4747378826141357
Epoch: 49, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 365720
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.276866674423218
Epoch: 1, Steps: 8 | Train Loss: 2.217 Vali Loss: 2.132 Vali Acc: 0.197 Test Loss: 2.132 Test Acc: 0.197
Validation loss decreased (inf --> -0.196854).  Saving model ...
Epoch: 2 cost time: 1.8108041286468506
Epoch: 2, Steps: 8 | Train Loss: 2.148 Vali Loss: 2.050 Vali Acc: 0.247 Test Loss: 2.050 Test Acc: 0.247
Validation loss decreased (-0.196854 --> -0.246855).  Saving model ...
Epoch: 3 cost time: 1.8028857707977295
Epoch: 3, Steps: 8 | Train Loss: 2.091 Vali Loss: 1.969 Vali Acc: 0.284 Test Loss: 1.969 Test Acc: 0.284
Validation loss decreased (-0.246855 --> -0.284355).  Saving model ...
Epoch: 4 cost time: 1.5988948345184326
Epoch: 4, Steps: 8 | Train Loss: 2.044 Vali Loss: 1.907 Vali Acc: 0.287 Test Loss: 1.907 Test Acc: 0.287
Validation loss decreased (-0.284355 --> -0.287481).  Saving model ...
Epoch: 5 cost time: 1.7077724933624268
Epoch: 5, Steps: 8 | Train Loss: 1.959 Vali Loss: 1.816 Vali Acc: 0.478 Test Loss: 1.816 Test Acc: 0.478
Validation loss decreased (-0.287481 --> -0.478107).  Saving model ...
Epoch: 6 cost time: 1.5070350170135498
Epoch: 6, Steps: 8 | Train Loss: 1.827 Vali Loss: 1.700 Vali Acc: 0.594 Test Loss: 1.700 Test Acc: 0.594
Validation loss decreased (-0.478107 --> -0.593733).  Saving model ...
Epoch: 7 cost time: 1.599611520767212
Epoch: 7, Steps: 8 | Train Loss: 1.716 Vali Loss: 1.560 Vali Acc: 0.619 Test Loss: 1.560 Test Acc: 0.619
Validation loss decreased (-0.593733 --> -0.618734).  Saving model ...
Epoch: 8 cost time: 1.9534859657287598
Epoch: 8, Steps: 8 | Train Loss: 1.495 Vali Loss: 1.403 Vali Acc: 0.697 Test Loss: 1.403 Test Acc: 0.697
Validation loss decreased (-0.618734 --> -0.696861).  Saving model ...
Epoch: 9 cost time: 1.3845710754394531
Epoch: 9, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.244 Vali Acc: 0.741 Test Loss: 1.244 Test Acc: 0.741
Validation loss decreased (-0.696861 --> -0.740613).  Saving model ...
Epoch: 10 cost time: 1.270294189453125
Epoch: 10, Steps: 8 | Train Loss: 1.179 Vali Loss: 1.093 Vali Acc: 0.772 Test Loss: 1.093 Test Acc: 0.772
Validation loss decreased (-0.740613 --> -0.771864).  Saving model ...
Epoch: 11 cost time: 1.638089656829834
Epoch: 11, Steps: 8 | Train Loss: 0.994 Vali Loss: 0.953 Vali Acc: 0.800 Test Loss: 0.953 Test Acc: 0.800
Validation loss decreased (-0.771864 --> -0.799990).  Saving model ...
Epoch: 12 cost time: 1.5954484939575195
Epoch: 12, Steps: 8 | Train Loss: 0.868 Vali Loss: 0.848 Vali Acc: 0.794 Test Loss: 0.848 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.638129472732544
Epoch: 13, Steps: 8 | Train Loss: 0.791 Vali Loss: 0.765 Vali Acc: 0.825 Test Loss: 0.765 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824992).  Saving model ...
Epoch: 14 cost time: 1.8022022247314453
Epoch: 14, Steps: 8 | Train Loss: 0.662 Vali Loss: 0.697 Vali Acc: 0.834 Test Loss: 0.697 Test Acc: 0.834
Validation loss decreased (-0.824992 --> -0.834368).  Saving model ...
Epoch: 15 cost time: 1.7701327800750732
Epoch: 15, Steps: 8 | Train Loss: 0.582 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
Validation loss decreased (-0.834368 --> -0.843744).  Saving model ...
Epoch: 16 cost time: 1.3922157287597656
Epoch: 16, Steps: 8 | Train Loss: 0.529 Vali Loss: 0.611 Vali Acc: 0.834 Test Loss: 0.611 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5076961517333984
Epoch: 17, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843744).  Saving model ...
Epoch: 18 cost time: 1.8038852214813232
Epoch: 18, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.577 Vali Acc: 0.831 Test Loss: 0.577 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.484752893447876
Epoch: 19, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.563 Vali Acc: 0.838 Test Loss: 0.563 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.116018295288086
Epoch: 20, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 21 cost time: 1.7215838432312012
Epoch: 21, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.532 Vali Acc: 0.853 Test Loss: 0.532 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 22 cost time: 1.9158408641815186
Epoch: 22, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.528 Vali Acc: 0.853 Test Loss: 0.528 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 23 cost time: 1.7250826358795166
Epoch: 23, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 24 cost time: 1.9025218486785889
Epoch: 24, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.518 Vali Acc: 0.847 Test Loss: 0.518 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.601865530014038
Epoch: 25, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.122814655303955
Epoch: 26, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 27 cost time: 1.9821784496307373
Epoch: 27, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.510 Vali Acc: 0.853 Test Loss: 0.510 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 28 cost time: 1.6698713302612305
Epoch: 28, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.723440408706665
Epoch: 29, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.0845394134521484
Epoch: 30, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.498 Vali Acc: 0.853 Test Loss: 0.498 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 31 cost time: 1.601555585861206
Epoch: 31, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.686232089996338
Epoch: 32, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.747988224029541
Epoch: 33, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.989769458770752
Epoch: 34, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.8675787448883057
Epoch: 35, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6311218738555908
Epoch: 36, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.496 Vali Acc: 0.844 Test Loss: 0.496 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.8543663024902344
Epoch: 37, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.9625864028930664
Epoch: 38, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.496 Vali Acc: 0.841 Test Loss: 0.496 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.8387959003448486
Epoch: 39, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.508 Vali Acc: 0.847 Test Loss: 0.508 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.164278030395508
Epoch: 40, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 253848
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.084119558334351
Epoch: 1, Steps: 8 | Train Loss: 2.228 Vali Loss: 2.164 Vali Acc: 0.131 Test Loss: 2.164 Test Acc: 0.131
Validation loss decreased (inf --> -0.131228).  Saving model ...
Epoch: 2 cost time: 1.3967695236206055
Epoch: 2, Steps: 8 | Train Loss: 2.141 Vali Loss: 2.062 Vali Acc: 0.175 Test Loss: 2.062 Test Acc: 0.175
Validation loss decreased (-0.131228 --> -0.174979).  Saving model ...
Epoch: 3 cost time: 1.6021568775177002
Epoch: 3, Steps: 8 | Train Loss: 2.006 Vali Loss: 1.990 Vali Acc: 0.250 Test Loss: 1.990 Test Acc: 0.250
Validation loss decreased (-0.174979 --> -0.249980).  Saving model ...
Epoch: 4 cost time: 1.5218486785888672
Epoch: 4, Steps: 8 | Train Loss: 1.992 Vali Loss: 1.926 Vali Acc: 0.287 Test Loss: 1.926 Test Acc: 0.287
Validation loss decreased (-0.249980 --> -0.287481).  Saving model ...
Epoch: 5 cost time: 1.4868288040161133
Epoch: 5, Steps: 8 | Train Loss: 1.900 Vali Loss: 1.829 Vali Acc: 0.444 Test Loss: 1.829 Test Acc: 0.444
Validation loss decreased (-0.287481 --> -0.443732).  Saving model ...
Epoch: 6 cost time: 1.5294549465179443
Epoch: 6, Steps: 8 | Train Loss: 1.773 Vali Loss: 1.709 Vali Acc: 0.487 Test Loss: 1.709 Test Acc: 0.487
Validation loss decreased (-0.443732 --> -0.487483).  Saving model ...
Epoch: 7 cost time: 1.5560963153839111
Epoch: 7, Steps: 8 | Train Loss: 1.620 Vali Loss: 1.561 Vali Acc: 0.506 Test Loss: 1.561 Test Acc: 0.506
Validation loss decreased (-0.487483 --> -0.506234).  Saving model ...
Epoch: 8 cost time: 1.4292559623718262
Epoch: 8, Steps: 8 | Train Loss: 1.480 Vali Loss: 1.390 Vali Acc: 0.622 Test Loss: 1.390 Test Acc: 0.622
Validation loss decreased (-0.506234 --> -0.621861).  Saving model ...
Epoch: 9 cost time: 1.3850433826446533
Epoch: 9, Steps: 8 | Train Loss: 1.264 Vali Loss: 1.222 Vali Acc: 0.694 Test Loss: 1.222 Test Acc: 0.694
Validation loss decreased (-0.621861 --> -0.693738).  Saving model ...
Epoch: 10 cost time: 1.8012778759002686
Epoch: 10, Steps: 8 | Train Loss: 1.115 Vali Loss: 1.066 Vali Acc: 0.759 Test Loss: 1.066 Test Acc: 0.759
Validation loss decreased (-0.693738 --> -0.759364).  Saving model ...
Epoch: 11 cost time: 1.4518170356750488
Epoch: 11, Steps: 8 | Train Loss: 0.902 Vali Loss: 0.936 Vali Acc: 0.769 Test Loss: 0.936 Test Acc: 0.769
Validation loss decreased (-0.759364 --> -0.768741).  Saving model ...
Epoch: 12 cost time: 1.7402894496917725
Epoch: 12, Steps: 8 | Train Loss: 0.802 Vali Loss: 0.832 Vali Acc: 0.784 Test Loss: 0.832 Test Acc: 0.784
Validation loss decreased (-0.768741 --> -0.784367).  Saving model ...
Epoch: 13 cost time: 1.593785285949707
Epoch: 13, Steps: 8 | Train Loss: 0.748 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
Validation loss decreased (-0.784367 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 1.2419142723083496
Epoch: 14, Steps: 8 | Train Loss: 0.585 Vali Loss: 0.691 Vali Acc: 0.812 Test Loss: 0.691 Test Acc: 0.812
Validation loss decreased (-0.799993 --> -0.812493).  Saving model ...
Epoch: 15 cost time: 1.3287956714630127
Epoch: 15, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.658 Vali Acc: 0.816 Test Loss: 0.658 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815618).  Saving model ...
Epoch: 16 cost time: 1.6526801586151123
Epoch: 16, Steps: 8 | Train Loss: 0.493 Vali Loss: 0.631 Vali Acc: 0.819 Test Loss: 0.631 Test Acc: 0.819
Validation loss decreased (-0.815618 --> -0.818744).  Saving model ...
Epoch: 17 cost time: 1.3743627071380615
Epoch: 17, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.603 Vali Acc: 0.819 Test Loss: 0.603 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 18 cost time: 1.7153420448303223
Epoch: 18, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 19 cost time: 1.5788965225219727
Epoch: 19, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.676539421081543
Epoch: 20, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4877026081085205
Epoch: 21, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.647371768951416
Epoch: 22, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 23 cost time: 1.3429827690124512
Epoch: 23, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837495).  Saving model ...
Epoch: 24 cost time: 1.878772258758545
Epoch: 24, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7165842056274414
Epoch: 25, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5480096340179443
Epoch: 26, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.541 Vali Acc: 0.828 Test Loss: 0.541 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6513032913208008
Epoch: 27, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 28 cost time: 1.343665361404419
Epoch: 28, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6248936653137207
Epoch: 29, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7649333477020264
Epoch: 30, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7610089778900146
Epoch: 31, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 32 cost time: 1.647754192352295
Epoch: 32, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2704882621765137
Epoch: 33, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3336150646209717
Epoch: 34, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4780097007751465
Epoch: 35, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.5456724166870117
Epoch: 36, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.607466697692871
Epoch: 37, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 38 cost time: 1.5180737972259521
Epoch: 38, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4632554054260254
Epoch: 39, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.502180576324463
Epoch: 40, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.9537243843078613
Epoch: 41, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.3950636386871338
Epoch: 42, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.7648324966430664
Epoch: 43, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3782474994659424
Epoch: 44, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.8898415565490723
Epoch: 45, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.406599998474121
Epoch: 46, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.358105182647705
Epoch: 47, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 252312
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4782676696777344
Epoch: 1, Steps: 8 | Train Loss: 2.318 Vali Loss: 2.194 Vali Acc: 0.100 Test Loss: 2.194 Test Acc: 0.100
Validation loss decreased (inf --> -0.099978).  Saving model ...
Epoch: 2 cost time: 1.333031177520752
Epoch: 2, Steps: 8 | Train Loss: 2.203 Vali Loss: 2.115 Vali Acc: 0.113 Test Loss: 2.115 Test Acc: 0.113
Validation loss decreased (-0.099978 --> -0.112479).  Saving model ...
Epoch: 3 cost time: 1.3529455661773682
Epoch: 3, Steps: 8 | Train Loss: 2.113 Vali Loss: 2.049 Vali Acc: 0.097 Test Loss: 2.049 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3732328414916992
Epoch: 4, Steps: 8 | Train Loss: 2.038 Vali Loss: 1.980 Vali Acc: 0.216 Test Loss: 1.980 Test Acc: 0.216
Validation loss decreased (-0.112479 --> -0.215605).  Saving model ...
Epoch: 5 cost time: 1.1502013206481934
Epoch: 5, Steps: 8 | Train Loss: 1.968 Vali Loss: 1.898 Vali Acc: 0.412 Test Loss: 1.898 Test Acc: 0.412
Validation loss decreased (-0.215605 --> -0.412481).  Saving model ...
Epoch: 6 cost time: 1.5437531471252441
Epoch: 6, Steps: 8 | Train Loss: 1.890 Vali Loss: 1.795 Vali Acc: 0.497 Test Loss: 1.795 Test Acc: 0.497
Validation loss decreased (-0.412481 --> -0.496857).  Saving model ...
Epoch: 7 cost time: 1.373769760131836
Epoch: 7, Steps: 8 | Train Loss: 1.761 Vali Loss: 1.677 Vali Acc: 0.547 Test Loss: 1.677 Test Acc: 0.547
Validation loss decreased (-0.496857 --> -0.546858).  Saving model ...
Epoch: 8 cost time: 1.1853477954864502
Epoch: 8, Steps: 8 | Train Loss: 1.608 Vali Loss: 1.512 Vali Acc: 0.634 Test Loss: 1.512 Test Acc: 0.634
Validation loss decreased (-0.546858 --> -0.634360).  Saving model ...
Epoch: 9 cost time: 1.146533727645874
Epoch: 9, Steps: 8 | Train Loss: 1.481 Vali Loss: 1.335 Vali Acc: 0.709 Test Loss: 1.335 Test Acc: 0.709
Validation loss decreased (-0.634360 --> -0.709362).  Saving model ...
Epoch: 10 cost time: 1.405205249786377
Epoch: 10, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.174 Vali Acc: 0.744 Test Loss: 1.174 Test Acc: 0.744
Validation loss decreased (-0.709362 --> -0.743738).  Saving model ...
Epoch: 11 cost time: 1.321699857711792
Epoch: 11, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.040 Vali Acc: 0.759 Test Loss: 1.040 Test Acc: 0.759
Validation loss decreased (-0.743738 --> -0.759365).  Saving model ...
Epoch: 12 cost time: 1.4684083461761475
Epoch: 12, Steps: 8 | Train Loss: 0.991 Vali Loss: 0.918 Vali Acc: 0.797 Test Loss: 0.918 Test Acc: 0.797
Validation loss decreased (-0.759365 --> -0.796866).  Saving model ...
Epoch: 13 cost time: 1.3120126724243164
Epoch: 13, Steps: 8 | Train Loss: 0.830 Vali Loss: 0.824 Vali Acc: 0.803 Test Loss: 0.824 Test Acc: 0.803
Validation loss decreased (-0.796866 --> -0.803117).  Saving model ...
Epoch: 14 cost time: 1.2131404876708984
Epoch: 14, Steps: 8 | Train Loss: 0.751 Vali Loss: 0.765 Vali Acc: 0.797 Test Loss: 0.765 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4226014614105225
Epoch: 15, Steps: 8 | Train Loss: 0.665 Vali Loss: 0.701 Vali Acc: 0.797 Test Loss: 0.701 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8243491649627686
Epoch: 16, Steps: 8 | Train Loss: 0.582 Vali Loss: 0.658 Vali Acc: 0.806 Test Loss: 0.658 Test Acc: 0.806
Validation loss decreased (-0.803117 --> -0.806243).  Saving model ...
Epoch: 17 cost time: 1.5677449703216553
Epoch: 17, Steps: 8 | Train Loss: 0.498 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
Validation loss decreased (-0.806243 --> -0.809369).  Saving model ...
Epoch: 18 cost time: 1.555614709854126
Epoch: 18, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.362109661102295
Epoch: 19, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.595 Vali Acc: 0.800 Test Loss: 0.595 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5696721076965332
Epoch: 20, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 21 cost time: 1.3553087711334229
Epoch: 21, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818744).  Saving model ...
Epoch: 22 cost time: 1.5132882595062256
Epoch: 22, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.546 Vali Acc: 0.812 Test Loss: 0.546 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3572824001312256
Epoch: 23, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821870).  Saving model ...
Epoch: 24 cost time: 1.2196600437164307
Epoch: 24, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 25 cost time: 1.5400683879852295
Epoch: 25, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.373976469039917
Epoch: 26, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 27 cost time: 1.5200045108795166
Epoch: 27, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 28 cost time: 1.1723761558532715
Epoch: 28, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.507 Vali Acc: 0.834 Test Loss: 0.507 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5865750312805176
Epoch: 29, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.508 Vali Acc: 0.828 Test Loss: 0.508 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3842694759368896
Epoch: 30, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.499 Vali Acc: 0.825 Test Loss: 0.499 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4919869899749756
Epoch: 31, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4601500034332275
Epoch: 32, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 33 cost time: 1.4428350925445557
Epoch: 33, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.501 Vali Acc: 0.831 Test Loss: 0.501 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6634175777435303
Epoch: 34, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2796096801757812
Epoch: 35, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.511 Vali Acc: 0.831 Test Loss: 0.511 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6782734394073486
Epoch: 36, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6195268630981445
Epoch: 37, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5043869018554688
Epoch: 38, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.498 Vali Acc: 0.834 Test Loss: 0.498 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.695878267288208
Epoch: 39, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.4745738506317139
Epoch: 40, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.498 Vali Acc: 0.834 Test Loss: 0.498 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.440356969833374
Epoch: 41, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.499 Vali Acc: 0.834 Test Loss: 0.499 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6154475212097168
Epoch: 42, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 250776
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9094784259796143
Epoch: 1, Steps: 8 | Train Loss: 2.202 Vali Loss: 2.156 Vali Acc: 0.122 Test Loss: 2.156 Test Acc: 0.122
Validation loss decreased (inf --> -0.121853).  Saving model ...
Epoch: 2 cost time: 1.4890141487121582
Epoch: 2, Steps: 8 | Train Loss: 2.138 Vali Loss: 2.023 Vali Acc: 0.178 Test Loss: 2.023 Test Acc: 0.178
Validation loss decreased (-0.121853 --> -0.178105).  Saving model ...
Epoch: 3 cost time: 1.5655467510223389
Epoch: 3, Steps: 8 | Train Loss: 1.954 Vali Loss: 1.926 Vali Acc: 0.303 Test Loss: 1.926 Test Acc: 0.303
Validation loss decreased (-0.178105 --> -0.303106).  Saving model ...
Epoch: 4 cost time: 1.5733342170715332
Epoch: 4, Steps: 8 | Train Loss: 1.896 Vali Loss: 1.830 Vali Acc: 0.394 Test Loss: 1.830 Test Acc: 0.394
Validation loss decreased (-0.303106 --> -0.393732).  Saving model ...
Epoch: 5 cost time: 1.3120880126953125
Epoch: 5, Steps: 8 | Train Loss: 1.789 Vali Loss: 1.699 Vali Acc: 0.516 Test Loss: 1.699 Test Acc: 0.516
Validation loss decreased (-0.393732 --> -0.515608).  Saving model ...
Epoch: 6 cost time: 1.4730911254882812
Epoch: 6, Steps: 8 | Train Loss: 1.612 Vali Loss: 1.545 Vali Acc: 0.575 Test Loss: 1.545 Test Acc: 0.575
Validation loss decreased (-0.515608 --> -0.574985).  Saving model ...
Epoch: 7 cost time: 1.4701364040374756
Epoch: 7, Steps: 8 | Train Loss: 1.474 Vali Loss: 1.377 Vali Acc: 0.628 Test Loss: 1.377 Test Acc: 0.628
Validation loss decreased (-0.574985 --> -0.628111).  Saving model ...
Epoch: 8 cost time: 1.4115781784057617
Epoch: 8, Steps: 8 | Train Loss: 1.263 Vali Loss: 1.217 Vali Acc: 0.697 Test Loss: 1.217 Test Acc: 0.697
Validation loss decreased (-0.628111 --> -0.696863).  Saving model ...
Epoch: 9 cost time: 1.217710256576538
Epoch: 9, Steps: 8 | Train Loss: 1.067 Vali Loss: 1.069 Vali Acc: 0.728 Test Loss: 1.069 Test Acc: 0.728
Validation loss decreased (-0.696863 --> -0.728114).  Saving model ...
Epoch: 10 cost time: 1.70218825340271
Epoch: 10, Steps: 8 | Train Loss: 0.925 Vali Loss: 0.949 Vali Acc: 0.766 Test Loss: 0.949 Test Acc: 0.766
Validation loss decreased (-0.728114 --> -0.765616).  Saving model ...
Epoch: 11 cost time: 1.1768782138824463
Epoch: 11, Steps: 8 | Train Loss: 0.757 Vali Loss: 0.853 Vali Acc: 0.775 Test Loss: 0.853 Test Acc: 0.775
Validation loss decreased (-0.765616 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 1.326906681060791
Epoch: 12, Steps: 8 | Train Loss: 0.680 Vali Loss: 0.788 Vali Acc: 0.784 Test Loss: 0.788 Test Acc: 0.784
Validation loss decreased (-0.774991 --> -0.784367).  Saving model ...
Epoch: 13 cost time: 1.2359559535980225
Epoch: 13, Steps: 8 | Train Loss: 0.602 Vali Loss: 0.725 Vali Acc: 0.803 Test Loss: 0.725 Test Acc: 0.803
Validation loss decreased (-0.784367 --> -0.803118).  Saving model ...
Epoch: 14 cost time: 1.2670059204101562
Epoch: 14, Steps: 8 | Train Loss: 0.541 Vali Loss: 0.688 Vali Acc: 0.797 Test Loss: 0.688 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2936930656433105
Epoch: 15, Steps: 8 | Train Loss: 0.474 Vali Loss: 0.665 Vali Acc: 0.803 Test Loss: 0.665 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803118).  Saving model ...
Epoch: 16 cost time: 1.5818860530853271
Epoch: 16, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.641 Vali Acc: 0.800 Test Loss: 0.641 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7817347049713135
Epoch: 17, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.617 Vali Acc: 0.803 Test Loss: 0.617 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803119).  Saving model ...
Epoch: 18 cost time: 1.7015085220336914
Epoch: 18, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.598 Vali Acc: 0.803 Test Loss: 0.598 Test Acc: 0.803
Validation loss decreased (-0.803119 --> -0.803119).  Saving model ...
Epoch: 19 cost time: 1.314124584197998
Epoch: 19, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
Validation loss decreased (-0.803119 --> -0.821869).  Saving model ...
Epoch: 20 cost time: 1.3344995975494385
Epoch: 20, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 21 cost time: 1.446514368057251
Epoch: 21, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.571 Vali Acc: 0.825 Test Loss: 0.571 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 22 cost time: 1.5455079078674316
Epoch: 22, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.562 Vali Acc: 0.828 Test Loss: 0.562 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 23 cost time: 1.4624302387237549
Epoch: 23, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.555 Vali Acc: 0.828 Test Loss: 0.555 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 24 cost time: 1.6517798900604248
Epoch: 24, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 25 cost time: 1.3145298957824707
Epoch: 25, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.548 Vali Acc: 0.847 Test Loss: 0.548 Test Acc: 0.847
Validation loss decreased (-0.831244 --> -0.846870).  Saving model ...
Epoch: 26 cost time: 1.3524363040924072
Epoch: 26, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5909273624420166
Epoch: 27, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6432979106903076
Epoch: 28, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.524 Vali Acc: 0.847 Test Loss: 0.524 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 29 cost time: 1.7345283031463623
Epoch: 29, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7059712409973145
Epoch: 30, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.535 Vali Acc: 0.847 Test Loss: 0.535 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.375833511352539
Epoch: 31, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4131922721862793
Epoch: 32, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3231220245361328
Epoch: 33, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.534 Vali Acc: 0.847 Test Loss: 0.534 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.719102382659912
Epoch: 34, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4038612842559814
Epoch: 35, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.523 Vali Acc: 0.847 Test Loss: 0.523 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 36 cost time: 1.4902219772338867
Epoch: 36, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.517 Vali Acc: 0.847 Test Loss: 0.517 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 37 cost time: 1.2345249652862549
Epoch: 37, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.6659760475158691
Epoch: 38, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3138434886932373
Epoch: 39, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.543 Vali Acc: 0.847 Test Loss: 0.543 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6942665576934814
Epoch: 40, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.6077570915222168
Epoch: 41, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.756441593170166
Epoch: 42, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3895971775054932
Epoch: 43, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.3627820014953613
Epoch: 44, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.491929531097412
Epoch: 45, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 46 cost time: 1.5474328994750977
Epoch: 46, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.5601322650909424
Epoch: 47, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.532 Vali Acc: 0.841 Test Loss: 0.532 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.8448593616485596
Epoch: 48, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.7331199645996094
Epoch: 49, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.4564766883850098
Epoch: 50, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.3239223957061768
Epoch: 51, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.5588085651397705
Epoch: 52, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.46714448928833
Epoch: 53, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.287804126739502
Epoch: 54, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.526 Vali Acc: 0.847 Test Loss: 0.526 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.5179038047790527
Epoch: 55, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 249240
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.101619482040405
Epoch: 1, Steps: 8 | Train Loss: 2.371 Vali Loss: 2.282 Vali Acc: 0.147 Test Loss: 2.282 Test Acc: 0.147
Validation loss decreased (inf --> -0.146852).  Saving model ...
Epoch: 2 cost time: 1.5794901847839355
Epoch: 2, Steps: 8 | Train Loss: 2.230 Vali Loss: 2.145 Vali Acc: 0.216 Test Loss: 2.145 Test Acc: 0.216
Validation loss decreased (-0.146852 --> -0.215604).  Saving model ...
Epoch: 3 cost time: 2.3370437622070312
Epoch: 3, Steps: 8 | Train Loss: 2.077 Vali Loss: 2.036 Vali Acc: 0.259 Test Loss: 2.036 Test Acc: 0.259
Validation loss decreased (-0.215604 --> -0.259355).  Saving model ...
Epoch: 4 cost time: 1.9440436363220215
Epoch: 4, Steps: 8 | Train Loss: 2.037 Vali Loss: 1.963 Vali Acc: 0.325 Test Loss: 1.963 Test Acc: 0.325
Validation loss decreased (-0.259355 --> -0.324980).  Saving model ...
Epoch: 5 cost time: 1.615354061126709
Epoch: 5, Steps: 8 | Train Loss: 1.959 Vali Loss: 1.891 Vali Acc: 0.419 Test Loss: 1.891 Test Acc: 0.419
Validation loss decreased (-0.324980 --> -0.418731).  Saving model ...
Epoch: 6 cost time: 1.7459087371826172
Epoch: 6, Steps: 8 | Train Loss: 1.829 Vali Loss: 1.790 Vali Acc: 0.509 Test Loss: 1.790 Test Acc: 0.509
Validation loss decreased (-0.418731 --> -0.509357).  Saving model ...
Epoch: 7 cost time: 1.701963186264038
Epoch: 7, Steps: 8 | Train Loss: 1.751 Vali Loss: 1.666 Vali Acc: 0.641 Test Loss: 1.666 Test Acc: 0.641
Validation loss decreased (-0.509357 --> -0.640608).  Saving model ...
Epoch: 8 cost time: 1.6325042247772217
Epoch: 8, Steps: 8 | Train Loss: 1.591 Vali Loss: 1.523 Vali Acc: 0.662 Test Loss: 1.523 Test Acc: 0.662
Validation loss decreased (-0.640608 --> -0.662485).  Saving model ...
Epoch: 9 cost time: 1.6928346157073975
Epoch: 9, Steps: 8 | Train Loss: 1.434 Vali Loss: 1.354 Vali Acc: 0.691 Test Loss: 1.354 Test Acc: 0.691
Validation loss decreased (-0.662485 --> -0.690611).  Saving model ...
Epoch: 10 cost time: 2.423330307006836
Epoch: 10, Steps: 8 | Train Loss: 1.264 Vali Loss: 1.186 Vali Acc: 0.744 Test Loss: 1.186 Test Acc: 0.744
Validation loss decreased (-0.690611 --> -0.743738).  Saving model ...
Epoch: 11 cost time: 1.8173775672912598
Epoch: 11, Steps: 8 | Train Loss: 1.117 Vali Loss: 1.036 Vali Acc: 0.756 Test Loss: 1.036 Test Acc: 0.756
Validation loss decreased (-0.743738 --> -0.756240).  Saving model ...
Epoch: 12 cost time: 1.928335189819336
Epoch: 12, Steps: 8 | Train Loss: 0.926 Vali Loss: 0.912 Vali Acc: 0.775 Test Loss: 0.912 Test Acc: 0.775
Validation loss decreased (-0.756240 --> -0.774991).  Saving model ...
Epoch: 13 cost time: 2.0003721714019775
Epoch: 13, Steps: 8 | Train Loss: 0.784 Vali Loss: 0.818 Vali Acc: 0.791 Test Loss: 0.818 Test Acc: 0.791
Validation loss decreased (-0.774991 --> -0.790617).  Saving model ...
Epoch: 14 cost time: 1.827505350112915
Epoch: 14, Steps: 8 | Train Loss: 0.733 Vali Loss: 0.753 Vali Acc: 0.800 Test Loss: 0.753 Test Acc: 0.800
Validation loss decreased (-0.790617 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 2.355576753616333
Epoch: 15, Steps: 8 | Train Loss: 0.605 Vali Loss: 0.702 Vali Acc: 0.812 Test Loss: 0.702 Test Acc: 0.812
Validation loss decreased (-0.799992 --> -0.812493).  Saving model ...
Epoch: 16 cost time: 2.1994242668151855
Epoch: 16, Steps: 8 | Train Loss: 0.562 Vali Loss: 0.663 Vali Acc: 0.812 Test Loss: 0.663 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812493).  Saving model ...
Epoch: 17 cost time: 1.7245380878448486
Epoch: 17, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.641 Vali Acc: 0.816 Test Loss: 0.641 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815619).  Saving model ...
Epoch: 18 cost time: 1.872312307357788
Epoch: 18, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.621 Vali Acc: 0.816 Test Loss: 0.621 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 19 cost time: 2.199953556060791
Epoch: 19, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.608 Vali Acc: 0.819 Test Loss: 0.608 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 20 cost time: 2.2086455821990967
Epoch: 20, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.592 Vali Acc: 0.831 Test Loss: 0.592 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831244).  Saving model ...
Epoch: 21 cost time: 2.1678545475006104
Epoch: 21, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.570 Vali Acc: 0.838 Test Loss: 0.570 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 22 cost time: 2.187906503677368
Epoch: 22, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.572 Vali Acc: 0.838 Test Loss: 0.572 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4032363891601562
Epoch: 23, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5022947788238525
Epoch: 24, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6899399757385254
Epoch: 25, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.543 Vali Acc: 0.847 Test Loss: 0.543 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846870).  Saving model ...
Epoch: 26 cost time: 1.4675185680389404
Epoch: 26, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.245805263519287
Epoch: 27, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6087074279785156
Epoch: 28, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9455006122589111
Epoch: 29, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.698786735534668
Epoch: 30, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.541 Vali Acc: 0.834 Test Loss: 0.541 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5625622272491455
Epoch: 31, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.531 Vali Acc: 0.831 Test Loss: 0.531 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.677722454071045
Epoch: 32, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.6642570495605469
Epoch: 33, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.532 Vali Acc: 0.831 Test Loss: 0.532 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.177166223526001
Epoch: 34, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.6688544750213623
Epoch: 35, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 195608
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.7294399738311768
Epoch: 1, Steps: 8 | Train Loss: 2.259 Vali Loss: 2.199 Vali Acc: 0.059 Test Loss: 2.199 Test Acc: 0.059
Validation loss decreased (inf --> -0.059353).  Saving model ...
Epoch: 2 cost time: 1.603395700454712
Epoch: 2, Steps: 8 | Train Loss: 2.168 Vali Loss: 2.099 Vali Acc: 0.084 Test Loss: 2.099 Test Acc: 0.084
Validation loss decreased (-0.059353 --> -0.084354).  Saving model ...
Epoch: 3 cost time: 1.9133715629577637
Epoch: 3, Steps: 8 | Train Loss: 2.134 Vali Loss: 2.032 Vali Acc: 0.191 Test Loss: 2.032 Test Acc: 0.191
Validation loss decreased (-0.084354 --> -0.190605).  Saving model ...
Epoch: 4 cost time: 1.821307897567749
Epoch: 4, Steps: 8 | Train Loss: 2.012 Vali Loss: 1.982 Vali Acc: 0.325 Test Loss: 1.982 Test Acc: 0.325
Validation loss decreased (-0.190605 --> -0.324980).  Saving model ...
Epoch: 5 cost time: 2.2925195693969727
Epoch: 5, Steps: 8 | Train Loss: 2.018 Vali Loss: 1.918 Vali Acc: 0.391 Test Loss: 1.918 Test Acc: 0.391
Validation loss decreased (-0.324980 --> -0.390606).  Saving model ...
Epoch: 6 cost time: 2.024853229522705
Epoch: 6, Steps: 8 | Train Loss: 1.919 Vali Loss: 1.840 Vali Acc: 0.475 Test Loss: 1.840 Test Acc: 0.475
Validation loss decreased (-0.390606 --> -0.474982).  Saving model ...
Epoch: 7 cost time: 2.058173894882202
Epoch: 7, Steps: 8 | Train Loss: 1.860 Vali Loss: 1.746 Vali Acc: 0.619 Test Loss: 1.746 Test Acc: 0.619
Validation loss decreased (-0.474982 --> -0.618733).  Saving model ...
Epoch: 8 cost time: 1.5583572387695312
Epoch: 8, Steps: 8 | Train Loss: 1.708 Vali Loss: 1.631 Vali Acc: 0.656 Test Loss: 1.631 Test Acc: 0.656
Validation loss decreased (-0.618733 --> -0.656234).  Saving model ...
Epoch: 9 cost time: 2.010014295578003
Epoch: 9, Steps: 8 | Train Loss: 1.585 Vali Loss: 1.485 Vali Acc: 0.688 Test Loss: 1.485 Test Acc: 0.688
Validation loss decreased (-0.656234 --> -0.687485).  Saving model ...
Epoch: 10 cost time: 1.9427132606506348
Epoch: 10, Steps: 8 | Train Loss: 1.431 Vali Loss: 1.328 Vali Acc: 0.741 Test Loss: 1.328 Test Acc: 0.741
Validation loss decreased (-0.687485 --> -0.740612).  Saving model ...
Epoch: 11 cost time: 1.6204700469970703
Epoch: 11, Steps: 8 | Train Loss: 1.273 Vali Loss: 1.173 Vali Acc: 0.738 Test Loss: 1.173 Test Acc: 0.738
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8237736225128174
Epoch: 12, Steps: 8 | Train Loss: 1.067 Vali Loss: 1.024 Vali Acc: 0.753 Test Loss: 1.024 Test Acc: 0.753
Validation loss decreased (-0.740612 --> -0.753115).  Saving model ...
Epoch: 13 cost time: 2.2275233268737793
Epoch: 13, Steps: 8 | Train Loss: 0.933 Vali Loss: 0.910 Vali Acc: 0.769 Test Loss: 0.910 Test Acc: 0.769
Validation loss decreased (-0.753115 --> -0.768741).  Saving model ...
Epoch: 14 cost time: 2.1078989505767822
Epoch: 14, Steps: 8 | Train Loss: 0.808 Vali Loss: 0.819 Vali Acc: 0.775 Test Loss: 0.819 Test Acc: 0.775
Validation loss decreased (-0.768741 --> -0.774992).  Saving model ...
Epoch: 15 cost time: 1.848041296005249
Epoch: 15, Steps: 8 | Train Loss: 0.679 Vali Loss: 0.749 Vali Acc: 0.791 Test Loss: 0.749 Test Acc: 0.791
Validation loss decreased (-0.774992 --> -0.790618).  Saving model ...
Epoch: 16 cost time: 1.8385815620422363
Epoch: 16, Steps: 8 | Train Loss: 0.598 Vali Loss: 0.697 Vali Acc: 0.794 Test Loss: 0.697 Test Acc: 0.794
Validation loss decreased (-0.790618 --> -0.793743).  Saving model ...
Epoch: 17 cost time: 1.657616138458252
Epoch: 17, Steps: 8 | Train Loss: 0.547 Vali Loss: 0.665 Vali Acc: 0.794 Test Loss: 0.665 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793743).  Saving model ...
Epoch: 18 cost time: 1.5891609191894531
Epoch: 18, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.641 Vali Acc: 0.797 Test Loss: 0.641 Test Acc: 0.797
Validation loss decreased (-0.793743 --> -0.796869).  Saving model ...
Epoch: 19 cost time: 1.9496753215789795
Epoch: 19, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.622 Vali Acc: 0.800 Test Loss: 0.622 Test Acc: 0.800
Validation loss decreased (-0.796869 --> -0.799994).  Saving model ...
Epoch: 20 cost time: 1.2828598022460938
Epoch: 20, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.608 Vali Acc: 0.803 Test Loss: 0.608 Test Acc: 0.803
Validation loss decreased (-0.799994 --> -0.803119).  Saving model ...
Epoch: 21 cost time: 1.9377577304840088
Epoch: 21, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
Validation loss decreased (-0.803119 --> -0.818744).  Saving model ...
Epoch: 22 cost time: 1.8353102207183838
Epoch: 22, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.589 Vali Acc: 0.812 Test Loss: 0.589 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7242777347564697
Epoch: 23, Steps: 8 | Train Loss: 0.300 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 24 cost time: 1.6425645351409912
Epoch: 24, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.566 Vali Acc: 0.828 Test Loss: 0.566 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 25 cost time: 1.4673893451690674
Epoch: 25, Steps: 8 | Train Loss: 0.248 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5157017707824707
Epoch: 26, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1866531372070312
Epoch: 27, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8746705055236816
Epoch: 28, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5889225006103516
Epoch: 29, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.712859869003296
Epoch: 30, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.7072539329528809
Epoch: 31, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.767509937286377
Epoch: 32, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.02174973487854
Epoch: 33, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.057528018951416
Epoch: 34, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 35 cost time: 1.3881330490112305
Epoch: 35, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8611223697662354
Epoch: 36, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7211706638336182
Epoch: 37, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.554 Vali Acc: 0.834 Test Loss: 0.554 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 38 cost time: 1.8940305709838867
Epoch: 38, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.550 Vali Acc: 0.831 Test Loss: 0.550 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.965092420578003
Epoch: 39, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 40 cost time: 1.743837594985962
Epoch: 40, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840619).  Saving model ...
Epoch: 41 cost time: 1.8670012950897217
Epoch: 41, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.0561208724975586
Epoch: 42, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.578 Vali Acc: 0.831 Test Loss: 0.578 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.883122205734253
Epoch: 43, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.575 Vali Acc: 0.831 Test Loss: 0.575 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.909719467163086
Epoch: 44, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.569 Vali Acc: 0.838 Test Loss: 0.569 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.7217390537261963
Epoch: 45, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.572 Vali Acc: 0.841 Test Loss: 0.572 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.216973304748535
Epoch: 46, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.840461254119873
Epoch: 47, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.570 Vali Acc: 0.844 Test Loss: 0.570 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 48 cost time: 1.6819617748260498
Epoch: 48, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.569 Vali Acc: 0.841 Test Loss: 0.569 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.829674243927002
Epoch: 49, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843744).  Saving model ...
Epoch: 50 cost time: 1.7497127056121826
Epoch: 50, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.6859619617462158
Epoch: 51, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.061269760131836
Epoch: 52, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.596 Vali Acc: 0.834 Test Loss: 0.596 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.7223491668701172
Epoch: 53, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.593 Vali Acc: 0.834 Test Loss: 0.593 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.5888781547546387
Epoch: 54, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.588 Vali Acc: 0.838 Test Loss: 0.588 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 2.3871397972106934
Epoch: 55, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.758606195449829
Epoch: 56, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.6195082664489746
Epoch: 57, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.784837007522583
Epoch: 58, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.9430513381958008
Epoch: 59, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 194072
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3794522285461426
Epoch: 1, Steps: 8 | Train Loss: 2.429 Vali Loss: 2.288 Vali Acc: 0.100 Test Loss: 2.288 Test Acc: 0.100
Validation loss decreased (inf --> -0.099977).  Saving model ...
Epoch: 2 cost time: 1.784670352935791
Epoch: 2, Steps: 8 | Train Loss: 2.258 Vali Loss: 2.140 Vali Acc: 0.131 Test Loss: 2.140 Test Acc: 0.131
Validation loss decreased (-0.099977 --> -0.131229).  Saving model ...
Epoch: 3 cost time: 1.8811147212982178
Epoch: 3, Steps: 8 | Train Loss: 2.144 Vali Loss: 2.050 Vali Acc: 0.197 Test Loss: 2.050 Test Acc: 0.197
Validation loss decreased (-0.131229 --> -0.196855).  Saving model ...
Epoch: 4 cost time: 2.017347812652588
Epoch: 4, Steps: 8 | Train Loss: 2.070 Vali Loss: 1.996 Vali Acc: 0.225 Test Loss: 1.996 Test Acc: 0.225
Validation loss decreased (-0.196855 --> -0.224980).  Saving model ...
Epoch: 5 cost time: 1.8741259574890137
Epoch: 5, Steps: 8 | Train Loss: 2.049 Vali Loss: 1.936 Vali Acc: 0.325 Test Loss: 1.936 Test Acc: 0.325
Validation loss decreased (-0.224980 --> -0.324981).  Saving model ...
Epoch: 6 cost time: 1.6736950874328613
Epoch: 6, Steps: 8 | Train Loss: 1.942 Vali Loss: 1.854 Vali Acc: 0.450 Test Loss: 1.854 Test Acc: 0.450
Validation loss decreased (-0.324981 --> -0.449981).  Saving model ...
Epoch: 7 cost time: 1.908947229385376
Epoch: 7, Steps: 8 | Train Loss: 1.906 Vali Loss: 1.754 Vali Acc: 0.553 Test Loss: 1.754 Test Acc: 0.553
Validation loss decreased (-0.449981 --> -0.553107).  Saving model ...
Epoch: 8 cost time: 1.6221997737884521
Epoch: 8, Steps: 8 | Train Loss: 1.744 Vali Loss: 1.630 Vali Acc: 0.637 Test Loss: 1.630 Test Acc: 0.637
Validation loss decreased (-0.553107 --> -0.637484).  Saving model ...
Epoch: 9 cost time: 1.8219630718231201
Epoch: 9, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.473 Vali Acc: 0.678 Test Loss: 1.473 Test Acc: 0.678
Validation loss decreased (-0.637484 --> -0.678110).  Saving model ...
Epoch: 10 cost time: 2.204176664352417
Epoch: 10, Steps: 8 | Train Loss: 1.439 Vali Loss: 1.301 Vali Acc: 0.716 Test Loss: 1.301 Test Acc: 0.716
Validation loss decreased (-0.678110 --> -0.715612).  Saving model ...
Epoch: 11 cost time: 1.4742155075073242
Epoch: 11, Steps: 8 | Train Loss: 1.262 Vali Loss: 1.149 Vali Acc: 0.744 Test Loss: 1.149 Test Acc: 0.744
Validation loss decreased (-0.715612 --> -0.743739).  Saving model ...
Epoch: 12 cost time: 1.473419189453125
Epoch: 12, Steps: 8 | Train Loss: 1.036 Vali Loss: 1.010 Vali Acc: 0.775 Test Loss: 1.010 Test Acc: 0.775
Validation loss decreased (-0.743739 --> -0.774990).  Saving model ...
Epoch: 13 cost time: 1.4725406169891357
Epoch: 13, Steps: 8 | Train Loss: 0.910 Vali Loss: 0.891 Vali Acc: 0.781 Test Loss: 0.891 Test Acc: 0.781
Validation loss decreased (-0.774990 --> -0.781241).  Saving model ...
Epoch: 14 cost time: 1.7393279075622559
Epoch: 14, Steps: 8 | Train Loss: 0.773 Vali Loss: 0.801 Vali Acc: 0.778 Test Loss: 0.801 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.835733413696289
Epoch: 15, Steps: 8 | Train Loss: 0.650 Vali Loss: 0.736 Vali Acc: 0.794 Test Loss: 0.736 Test Acc: 0.794
Validation loss decreased (-0.781241 --> -0.793743).  Saving model ...
Epoch: 16 cost time: 2.2065844535827637
Epoch: 16, Steps: 8 | Train Loss: 0.562 Vali Loss: 0.688 Vali Acc: 0.787 Test Loss: 0.688 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7540397644042969
Epoch: 17, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.654 Vali Acc: 0.803 Test Loss: 0.654 Test Acc: 0.803
Validation loss decreased (-0.793743 --> -0.803118).  Saving model ...
Epoch: 18 cost time: 1.3082094192504883
Epoch: 18, Steps: 8 | Train Loss: 0.451 Vali Loss: 0.636 Vali Acc: 0.800 Test Loss: 0.636 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9553916454315186
Epoch: 19, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6360101699829102
Epoch: 20, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.604 Vali Acc: 0.806 Test Loss: 0.604 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806244).  Saving model ...
Epoch: 21 cost time: 2.20798659324646
Epoch: 21, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
Validation loss decreased (-0.806244 --> -0.821869).  Saving model ...
Epoch: 22 cost time: 1.7483031749725342
Epoch: 22, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 23 cost time: 1.76430344581604
Epoch: 23, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 24 cost time: 1.4284911155700684
Epoch: 24, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 25 cost time: 1.7696001529693604
Epoch: 25, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9898653030395508
Epoch: 26, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.529759407043457
Epoch: 27, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.612807035446167
Epoch: 28, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.552 Vali Acc: 0.806 Test Loss: 0.552 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9527435302734375
Epoch: 29, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.552 Vali Acc: 0.806 Test Loss: 0.552 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8614623546600342
Epoch: 30, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 31 cost time: 1.9740283489227295
Epoch: 31, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.541 Vali Acc: 0.816 Test Loss: 0.541 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6779518127441406
Epoch: 32, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8054301738739014
Epoch: 33, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 34 cost time: 1.5435221195220947
Epoch: 34, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 35 cost time: 1.8426637649536133
Epoch: 35, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.0316245555877686
Epoch: 36, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8012964725494385
Epoch: 37, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.8401885032653809
Epoch: 38, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6892282962799072
Epoch: 39, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.6486918926239014
Epoch: 40, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.7753503322601318
Epoch: 41, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.548 Vali Acc: 0.819 Test Loss: 0.548 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.9042787551879883
Epoch: 42, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.997361183166504
Epoch: 43, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.452505350112915
Epoch: 44, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 192536
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.053567171096802
Epoch: 1, Steps: 8 | Train Loss: 2.158 Vali Loss: 2.108 Vali Acc: 0.191 Test Loss: 2.108 Test Acc: 0.191
Validation loss decreased (inf --> -0.190604).  Saving model ...
Epoch: 2 cost time: 1.2477474212646484
Epoch: 2, Steps: 8 | Train Loss: 2.059 Vali Loss: 2.030 Vali Acc: 0.253 Test Loss: 2.030 Test Acc: 0.253
Validation loss decreased (-0.190604 --> -0.253105).  Saving model ...
Epoch: 3 cost time: 2.4640464782714844
Epoch: 3, Steps: 8 | Train Loss: 1.986 Vali Loss: 1.955 Vali Acc: 0.375 Test Loss: 1.955 Test Acc: 0.375
Validation loss decreased (-0.253105 --> -0.374980).  Saving model ...
Epoch: 4 cost time: 1.4445619583129883
Epoch: 4, Steps: 8 | Train Loss: 1.960 Vali Loss: 1.881 Vali Acc: 0.425 Test Loss: 1.881 Test Acc: 0.425
Validation loss decreased (-0.374980 --> -0.424981).  Saving model ...
Epoch: 5 cost time: 1.64471435546875
Epoch: 5, Steps: 8 | Train Loss: 1.879 Vali Loss: 1.787 Vali Acc: 0.600 Test Loss: 1.787 Test Acc: 0.600
Validation loss decreased (-0.424981 --> -0.599982).  Saving model ...
Epoch: 6 cost time: 1.639949083328247
Epoch: 6, Steps: 8 | Train Loss: 1.811 Vali Loss: 1.672 Vali Acc: 0.650 Test Loss: 1.672 Test Acc: 0.650
Validation loss decreased (-0.599982 --> -0.649983).  Saving model ...
Epoch: 7 cost time: 1.3113887310028076
Epoch: 7, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.537 Vali Acc: 0.650 Test Loss: 1.537 Test Acc: 0.650
Validation loss decreased (-0.649983 --> -0.649985).  Saving model ...
Epoch: 8 cost time: 1.3449482917785645
Epoch: 8, Steps: 8 | Train Loss: 1.470 Vali Loss: 1.383 Vali Acc: 0.734 Test Loss: 1.383 Test Acc: 0.734
Validation loss decreased (-0.649985 --> -0.734361).  Saving model ...
Epoch: 9 cost time: 1.6558401584625244
Epoch: 9, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.217 Vali Acc: 0.784 Test Loss: 1.217 Test Acc: 0.784
Validation loss decreased (-0.734361 --> -0.784363).  Saving model ...
Epoch: 10 cost time: 1.4255611896514893
Epoch: 10, Steps: 8 | Train Loss: 1.194 Vali Loss: 1.067 Vali Acc: 0.791 Test Loss: 1.067 Test Acc: 0.791
Validation loss decreased (-0.784363 --> -0.790614).  Saving model ...
Epoch: 11 cost time: 1.4867022037506104
Epoch: 11, Steps: 8 | Train Loss: 1.020 Vali Loss: 0.939 Vali Acc: 0.806 Test Loss: 0.939 Test Acc: 0.806
Validation loss decreased (-0.790614 --> -0.806241).  Saving model ...
Epoch: 12 cost time: 1.341155767440796
Epoch: 12, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.836 Vali Acc: 0.800 Test Loss: 0.836 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5190293788909912
Epoch: 13, Steps: 8 | Train Loss: 0.721 Vali Loss: 0.760 Vali Acc: 0.812 Test Loss: 0.760 Test Acc: 0.812
Validation loss decreased (-0.806241 --> -0.812492).  Saving model ...
Epoch: 14 cost time: 1.6538467407226562
Epoch: 14, Steps: 8 | Train Loss: 0.628 Vali Loss: 0.705 Vali Acc: 0.806 Test Loss: 0.705 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5259010791778564
Epoch: 15, Steps: 8 | Train Loss: 0.582 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
Validation loss decreased (-0.812492 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 1.7996504306793213
Epoch: 16, Steps: 8 | Train Loss: 0.511 Vali Loss: 0.634 Vali Acc: 0.812 Test Loss: 0.634 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9909887313842773
Epoch: 17, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.616 Vali Acc: 0.800 Test Loss: 0.616 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6690130233764648
Epoch: 18, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2651047706604004
Epoch: 19, Steps: 8 | Train Loss: 0.386 Vali Loss: 0.593 Vali Acc: 0.809 Test Loss: 0.593 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5651752948760986
Epoch: 20, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9610939025878906
Epoch: 21, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5819392204284668
Epoch: 22, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.567 Vali Acc: 0.797 Test Loss: 0.567 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.802497386932373
Epoch: 23, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.562 Vali Acc: 0.809 Test Loss: 0.562 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2945191860198975
Epoch: 24, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4695656299591064
Epoch: 25, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.825
model parameter : 191000
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.233827352523804
Epoch: 1, Steps: 8 | Train Loss: 2.134 Vali Loss: 1.916 Vali Acc: 0.278 Test Loss: 1.916 Test Acc: 0.278
Validation loss decreased (inf --> -0.278106).  Saving model ...
Epoch: 2 cost time: 1.343231439590454
Epoch: 2, Steps: 8 | Train Loss: 1.783 Vali Loss: 1.400 Vali Acc: 0.662 Test Loss: 1.400 Test Acc: 0.662
Validation loss decreased (-0.278106 --> -0.662486).  Saving model ...
Epoch: 3 cost time: 1.7103009223937988
Epoch: 3, Steps: 8 | Train Loss: 1.268 Vali Loss: 0.862 Vali Acc: 0.787 Test Loss: 0.862 Test Acc: 0.787
Validation loss decreased (-0.662486 --> -0.787491).  Saving model ...
Epoch: 4 cost time: 1.702995777130127
Epoch: 4, Steps: 8 | Train Loss: 0.743 Vali Loss: 0.592 Vali Acc: 0.831 Test Loss: 0.592 Test Acc: 0.831
Validation loss decreased (-0.787491 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 1.524167537689209
Epoch: 5, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.540 Vali Acc: 0.834 Test Loss: 0.540 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 1.765744686126709
Epoch: 6, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6719865798950195
Epoch: 7, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.575 Vali Acc: 0.825 Test Loss: 0.575 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7224829196929932
Epoch: 8, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.707146167755127
Epoch: 9, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.644 Vali Acc: 0.806 Test Loss: 0.644 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.119981050491333
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.588 Vali Acc: 0.834 Test Loss: 0.588 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7972469329833984
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843744).  Saving model ...
Epoch: 12 cost time: 1.4395372867584229
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6598594188690186
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.712 Vali Acc: 0.825 Test Loss: 0.712 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3885529041290283
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.716 Vali Acc: 0.834 Test Loss: 0.716 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6724159717559814
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.772 Vali Acc: 0.822 Test Loss: 0.772 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.788684606552124
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.746 Vali Acc: 0.831 Test Loss: 0.746 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7889173030853271
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.736 Vali Acc: 0.841 Test Loss: 0.736 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7295663356781006
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.743 Vali Acc: 0.828 Test Loss: 0.743 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7357642650604248
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.751 Vali Acc: 0.834 Test Loss: 0.751 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8448727130889893
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.770 Vali Acc: 0.831 Test Loss: 0.770 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7434496879577637
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.781 Vali Acc: 0.825 Test Loss: 0.781 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 8068140
model size : 35.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8774006366729736
Epoch: 1, Steps: 8 | Train Loss: 2.135 Vali Loss: 1.879 Vali Acc: 0.356 Test Loss: 1.879 Test Acc: 0.356
Validation loss decreased (inf --> -0.356231).  Saving model ...
Epoch: 2 cost time: 1.8276422023773193
Epoch: 2, Steps: 8 | Train Loss: 1.678 Vali Loss: 1.312 Vali Acc: 0.769 Test Loss: 1.312 Test Acc: 0.769
Validation loss decreased (-0.356231 --> -0.768737).  Saving model ...
Epoch: 3 cost time: 1.8653783798217773
Epoch: 3, Steps: 8 | Train Loss: 1.137 Vali Loss: 0.830 Vali Acc: 0.781 Test Loss: 0.830 Test Acc: 0.781
Validation loss decreased (-0.768737 --> -0.781242).  Saving model ...
Epoch: 4 cost time: 1.6148247718811035
Epoch: 4, Steps: 8 | Train Loss: 0.734 Vali Loss: 0.582 Vali Acc: 0.838 Test Loss: 0.582 Test Acc: 0.838
Validation loss decreased (-0.781242 --> -0.837494).  Saving model ...
Epoch: 5 cost time: 1.5460515022277832
Epoch: 5, Steps: 8 | Train Loss: 0.449 Vali Loss: 0.530 Vali Acc: 0.816 Test Loss: 0.530 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5750837326049805
Epoch: 6, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 1.6215276718139648
Epoch: 7, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.562 Vali Acc: 0.831 Test Loss: 0.562 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5625593662261963
Epoch: 8, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.601 Vali Acc: 0.816 Test Loss: 0.601 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5955674648284912
Epoch: 9, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2639801502227783
Epoch: 10, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4840285778045654
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.694 Vali Acc: 0.831 Test Loss: 0.694 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7782127857208252
Epoch: 12, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.688 Vali Acc: 0.831 Test Loss: 0.688 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5478630065917969
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.750 Vali Acc: 0.809 Test Loss: 0.750 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.925633192062378
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.698 Vali Acc: 0.828 Test Loss: 0.698 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.527080774307251
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.700 Vali Acc: 0.834 Test Loss: 0.700 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6387965679168701
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.726 Vali Acc: 0.844 Test Loss: 0.726 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843743).  Saving model ...
Epoch: 17 cost time: 1.8104276657104492
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.746 Vali Acc: 0.841 Test Loss: 0.746 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6650075912475586
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.750 Vali Acc: 0.838 Test Loss: 0.750 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.530167579650879
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.759 Vali Acc: 0.831 Test Loss: 0.759 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6253435611724854
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.766 Vali Acc: 0.838 Test Loss: 0.766 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.554128885269165
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.770 Vali Acc: 0.841 Test Loss: 0.770 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3413617610931396
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.772 Vali Acc: 0.844 Test Loss: 0.772 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.500518798828125
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.773 Vali Acc: 0.841 Test Loss: 0.773 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5091495513916016
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.782 Vali Acc: 0.838 Test Loss: 0.782 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6603894233703613
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.794 Vali Acc: 0.841 Test Loss: 0.794 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5516831874847412
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.841 Test Loss: 0.796 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 8057644
model size : 35.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5482258796691895
Epoch: 1, Steps: 8 | Train Loss: 2.147 Vali Loss: 1.949 Vali Acc: 0.250 Test Loss: 1.949 Test Acc: 0.250
Validation loss decreased (inf --> -0.249981).  Saving model ...
Epoch: 2 cost time: 2.1722419261932373
Epoch: 2, Steps: 8 | Train Loss: 1.824 Vali Loss: 1.427 Vali Acc: 0.666 Test Loss: 1.427 Test Acc: 0.666
Validation loss decreased (-0.249981 --> -0.665611).  Saving model ...
Epoch: 3 cost time: 1.552708387374878
Epoch: 3, Steps: 8 | Train Loss: 1.158 Vali Loss: 0.913 Vali Acc: 0.778 Test Loss: 0.913 Test Acc: 0.778
Validation loss decreased (-0.665611 --> -0.778116).  Saving model ...
Epoch: 4 cost time: 1.697317123413086
Epoch: 4, Steps: 8 | Train Loss: 0.739 Vali Loss: 0.687 Vali Acc: 0.787 Test Loss: 0.687 Test Acc: 0.787
Validation loss decreased (-0.778116 --> -0.787493).  Saving model ...
Epoch: 5 cost time: 1.9903523921966553
Epoch: 5, Steps: 8 | Train Loss: 0.493 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
Validation loss decreased (-0.787493 --> -0.831244).  Saving model ...
Epoch: 6 cost time: 1.476712942123413
Epoch: 6, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.577 Vali Acc: 0.831 Test Loss: 0.577 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6054801940917969
Epoch: 7, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.639 Vali Acc: 0.797 Test Loss: 0.639 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6903705596923828
Epoch: 8, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.668 Vali Acc: 0.812 Test Loss: 0.668 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.148714542388916
Epoch: 9, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7708640098571777
Epoch: 10, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.632 Vali Acc: 0.831 Test Loss: 0.632 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.398557424545288
Epoch: 11, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.715 Vali Acc: 0.800 Test Loss: 0.715 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4724352359771729
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.692 Vali Acc: 0.825 Test Loss: 0.692 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6312756538391113
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.705 Vali Acc: 0.822 Test Loss: 0.705 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1051971912384033
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.751 Vali Acc: 0.828 Test Loss: 0.751 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4354369640350342
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.786 Vali Acc: 0.828 Test Loss: 0.786 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 8047148
model size : 35.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5879549980163574
Epoch: 1, Steps: 8 | Train Loss: 2.171 Vali Loss: 1.909 Vali Acc: 0.388 Test Loss: 1.909 Test Acc: 0.388
Validation loss decreased (inf --> -0.387481).  Saving model ...
Epoch: 2 cost time: 1.537266492843628
Epoch: 2, Steps: 8 | Train Loss: 1.871 Vali Loss: 1.392 Vali Acc: 0.700 Test Loss: 1.392 Test Acc: 0.700
Validation loss decreased (-0.387481 --> -0.699986).  Saving model ...
Epoch: 3 cost time: 1.1985599994659424
Epoch: 3, Steps: 8 | Train Loss: 1.194 Vali Loss: 0.884 Vali Acc: 0.828 Test Loss: 0.884 Test Acc: 0.828
Validation loss decreased (-0.699986 --> -0.828116).  Saving model ...
Epoch: 4 cost time: 1.2215321063995361
Epoch: 4, Steps: 8 | Train Loss: 0.806 Vali Loss: 0.626 Vali Acc: 0.816 Test Loss: 0.626 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.398052453994751
Epoch: 5, Steps: 8 | Train Loss: 0.505 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4756157398223877
Epoch: 6, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1979899406433105
Epoch: 7, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
Validation loss decreased (-0.828116 --> -0.840619).  Saving model ...
Epoch: 8 cost time: 1.6592607498168945
Epoch: 8, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.620 Vali Acc: 0.841 Test Loss: 0.620 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.539839744567871
Epoch: 9, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.702 Vali Acc: 0.784 Test Loss: 0.702 Test Acc: 0.784
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5623738765716553
Epoch: 10, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.733 Vali Acc: 0.803 Test Loss: 0.733 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4391753673553467
Epoch: 11, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.681 Vali Acc: 0.816 Test Loss: 0.681 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5132720470428467
Epoch: 12, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.697 Vali Acc: 0.822 Test Loss: 0.697 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.322303295135498
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.750 Vali Acc: 0.831 Test Loss: 0.750 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5771698951721191
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.748 Vali Acc: 0.819 Test Loss: 0.748 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4660179615020752
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.782 Vali Acc: 0.831 Test Loss: 0.782 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4444019794464111
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.801 Vali Acc: 0.838 Test Loss: 0.801 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.206350326538086
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.795 Vali Acc: 0.834 Test Loss: 0.795 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 8036652
model size : 35.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6877236366271973
Epoch: 1, Steps: 8 | Train Loss: 2.106 Vali Loss: 1.869 Vali Acc: 0.359 Test Loss: 1.869 Test Acc: 0.359
Validation loss decreased (inf --> -0.359356).  Saving model ...
Epoch: 2 cost time: 1.0519909858703613
Epoch: 2, Steps: 8 | Train Loss: 1.882 Vali Loss: 1.432 Vali Acc: 0.678 Test Loss: 1.432 Test Acc: 0.678
Validation loss decreased (-0.359356 --> -0.678111).  Saving model ...
Epoch: 3 cost time: 1.3969836235046387
Epoch: 3, Steps: 8 | Train Loss: 1.334 Vali Loss: 1.013 Vali Acc: 0.725 Test Loss: 1.013 Test Acc: 0.725
Validation loss decreased (-0.678111 --> -0.724990).  Saving model ...
Epoch: 4 cost time: 1.3777430057525635
Epoch: 4, Steps: 8 | Train Loss: 0.906 Vali Loss: 0.700 Vali Acc: 0.778 Test Loss: 0.700 Test Acc: 0.778
Validation loss decreased (-0.724990 --> -0.778118).  Saving model ...
Epoch: 5 cost time: 1.6068947315216064
Epoch: 5, Steps: 8 | Train Loss: 0.596 Vali Loss: 0.558 Vali Acc: 0.812 Test Loss: 0.558 Test Acc: 0.812
Validation loss decreased (-0.778118 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 1.4518802165985107
Epoch: 6, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821869).  Saving model ...
Epoch: 7 cost time: 1.502777338027954
Epoch: 7, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5841772556304932
Epoch: 8, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.599 Vali Acc: 0.806 Test Loss: 0.599 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5129773616790771
Epoch: 9, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.467200517654419
Epoch: 10, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.614 Vali Acc: 0.825 Test Loss: 0.614 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 1.531074047088623
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.714 Vali Acc: 0.816 Test Loss: 0.714 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5816526412963867
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.670 Vali Acc: 0.831 Test Loss: 0.670 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831243).  Saving model ...
Epoch: 13 cost time: 1.5670726299285889
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.709 Vali Acc: 0.834 Test Loss: 0.709 Test Acc: 0.834
Validation loss decreased (-0.831243 --> -0.834368).  Saving model ...
Epoch: 14 cost time: 1.5299115180969238
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.743 Vali Acc: 0.819 Test Loss: 0.743 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7189717292785645
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.747 Vali Acc: 0.825 Test Loss: 0.747 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.616941213607788
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.748 Vali Acc: 0.825 Test Loss: 0.748 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7548754215240479
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.759 Vali Acc: 0.822 Test Loss: 0.759 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.39992094039917
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.760 Vali Acc: 0.822 Test Loss: 0.760 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6068239212036133
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.771 Vali Acc: 0.831 Test Loss: 0.771 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6944241523742676
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.777 Vali Acc: 0.828 Test Loss: 0.777 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7182469367980957
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.789 Vali Acc: 0.828 Test Loss: 0.789 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6169798374176025
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.795 Vali Acc: 0.825 Test Loss: 0.795 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.656609296798706
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.802 Vali Acc: 0.831 Test Loss: 0.802 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 6754860
model size : 30.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.689417600631714
Epoch: 1, Steps: 8 | Train Loss: 2.108 Vali Loss: 1.859 Vali Acc: 0.422 Test Loss: 1.859 Test Acc: 0.422
Validation loss decreased (inf --> -0.421856).  Saving model ...
Epoch: 2 cost time: 1.2679970264434814
Epoch: 2, Steps: 8 | Train Loss: 1.810 Vali Loss: 1.374 Vali Acc: 0.703 Test Loss: 1.374 Test Acc: 0.703
Validation loss decreased (-0.421856 --> -0.703111).  Saving model ...
Epoch: 3 cost time: 1.601874589920044
Epoch: 3, Steps: 8 | Train Loss: 1.267 Vali Loss: 0.909 Vali Acc: 0.781 Test Loss: 0.909 Test Acc: 0.781
Validation loss decreased (-0.703111 --> -0.781241).  Saving model ...
Epoch: 4 cost time: 1.3909499645233154
Epoch: 4, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.636 Vali Acc: 0.834 Test Loss: 0.636 Test Acc: 0.834
Validation loss decreased (-0.781241 --> -0.834369).  Saving model ...
Epoch: 5 cost time: 1.2505123615264893
Epoch: 5, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7464075088500977
Epoch: 6, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7756633758544922
Epoch: 7, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.620 Vali Acc: 0.816 Test Loss: 0.620 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7549896240234375
Epoch: 8, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.593 Vali Acc: 0.812 Test Loss: 0.593 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.318448781967163
Epoch: 9, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.603 Vali Acc: 0.838 Test Loss: 0.603 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 10 cost time: 1.4963786602020264
Epoch: 10, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.672 Vali Acc: 0.825 Test Loss: 0.672 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.43660306930542
Epoch: 11, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.661 Vali Acc: 0.822 Test Loss: 0.661 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.36661958694458
Epoch: 12, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.735 Vali Acc: 0.819 Test Loss: 0.735 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7077088356018066
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.681 Vali Acc: 0.834 Test Loss: 0.681 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7862820625305176
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.696 Vali Acc: 0.834 Test Loss: 0.696 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0118346214294434
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.741 Vali Acc: 0.822 Test Loss: 0.741 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8453240394592285
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.788 Vali Acc: 0.819 Test Loss: 0.788 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6943881511688232
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.784 Vali Acc: 0.816 Test Loss: 0.784 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.697547197341919
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.788 Vali Acc: 0.816 Test Loss: 0.788 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.644636869430542
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.786 Vali Acc: 0.816 Test Loss: 0.786 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 6744364
model size : 30.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9963674545288086
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 1.933 Vali Acc: 0.294 Test Loss: 1.933 Test Acc: 0.294
Validation loss decreased (inf --> -0.293731).  Saving model ...
Epoch: 2 cost time: 1.309821605682373
Epoch: 2, Steps: 8 | Train Loss: 1.840 Vali Loss: 1.420 Vali Acc: 0.716 Test Loss: 1.420 Test Acc: 0.716
Validation loss decreased (-0.293731 --> -0.715611).  Saving model ...
Epoch: 3 cost time: 1.4871985912322998
Epoch: 3, Steps: 8 | Train Loss: 1.236 Vali Loss: 0.963 Vali Acc: 0.791 Test Loss: 0.963 Test Acc: 0.791
Validation loss decreased (-0.715611 --> -0.790615).  Saving model ...
Epoch: 4 cost time: 1.8280730247497559
Epoch: 4, Steps: 8 | Train Loss: 0.784 Vali Loss: 0.704 Vali Acc: 0.787 Test Loss: 0.704 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3462715148925781
Epoch: 5, Steps: 8 | Train Loss: 0.524 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.790615 --> -0.821869).  Saving model ...
Epoch: 6 cost time: 1.4317147731781006
Epoch: 6, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.546 Vali Acc: 0.812 Test Loss: 0.546 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4592394828796387
Epoch: 7, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.577 Vali Acc: 0.816 Test Loss: 0.577 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.79182767868042
Epoch: 8, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5938355922698975
Epoch: 9, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.670 Vali Acc: 0.806 Test Loss: 0.670 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2825841903686523
Epoch: 10, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.630 Vali Acc: 0.803 Test Loss: 0.630 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.270761489868164
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.747 Vali Acc: 0.812 Test Loss: 0.747 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2466988563537598
Epoch: 12, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.714 Vali Acc: 0.819 Test Loss: 0.714 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6241390705108643
Epoch: 13, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.727 Vali Acc: 0.825 Test Loss: 0.727 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 1.427865743637085
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.854 Vali Acc: 0.812 Test Loss: 0.854 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6582601070404053
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.843 Vali Acc: 0.819 Test Loss: 0.843 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5537872314453125
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.848 Vali Acc: 0.828 Test Loss: 0.848 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828117).  Saving model ...
Epoch: 17 cost time: 1.4509797096252441
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.827 Vali Acc: 0.834 Test Loss: 0.827 Test Acc: 0.834
Validation loss decreased (-0.828117 --> -0.834367).  Saving model ...
Epoch: 18 cost time: 1.3066740036010742
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.823 Vali Acc: 0.831 Test Loss: 0.823 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4351508617401123
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.828 Vali Acc: 0.825 Test Loss: 0.828 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5345540046691895
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.836 Vali Acc: 0.828 Test Loss: 0.836 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3588831424713135
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.843 Vali Acc: 0.834 Test Loss: 0.843 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4607088565826416
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.843 Vali Acc: 0.834 Test Loss: 0.843 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4008004665374756
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.844 Vali Acc: 0.834 Test Loss: 0.844 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.299973487854004
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.840 Vali Acc: 0.841 Test Loss: 0.840 Test Acc: 0.841
Validation loss decreased (-0.834367 --> -0.840617).  Saving model ...
Epoch: 25 cost time: 1.1983556747436523
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.845 Vali Acc: 0.841 Test Loss: 0.845 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.410179615020752
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.847 Vali Acc: 0.841 Test Loss: 0.847 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3638865947723389
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.841 Test Loss: 0.846 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.347975254058838
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.845 Vali Acc: 0.841 Test Loss: 0.845 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.448415994644165
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.851 Vali Acc: 0.838 Test Loss: 0.851 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0100150108337402
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.856 Vali Acc: 0.838 Test Loss: 0.856 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.257230520248413
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.856 Vali Acc: 0.841 Test Loss: 0.856 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.3204216957092285
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.841 Test Loss: 0.857 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.272592544555664
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.841 Test Loss: 0.857 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.5509507656097412
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.862 Vali Acc: 0.838 Test Loss: 0.862 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 6733868
model size : 30.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.9150753021240234
Epoch: 1, Steps: 8 | Train Loss: 2.210 Vali Loss: 1.981 Vali Acc: 0.194 Test Loss: 1.981 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 1.0400404930114746
Epoch: 2, Steps: 8 | Train Loss: 1.859 Vali Loss: 1.457 Vali Acc: 0.713 Test Loss: 1.457 Test Acc: 0.713
Validation loss decreased (-0.193730 --> -0.712485).  Saving model ...
Epoch: 3 cost time: 1.3087468147277832
Epoch: 3, Steps: 8 | Train Loss: 1.278 Vali Loss: 0.935 Vali Acc: 0.819 Test Loss: 0.935 Test Acc: 0.819
Validation loss decreased (-0.712485 --> -0.818741).  Saving model ...
Epoch: 4 cost time: 1.4166114330291748
Epoch: 4, Steps: 8 | Train Loss: 0.743 Vali Loss: 0.637 Vali Acc: 0.816 Test Loss: 0.637 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3691601753234863
Epoch: 5, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
Validation loss decreased (-0.818741 --> -0.824994).  Saving model ...
Epoch: 6 cost time: 1.155318260192871
Epoch: 6, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1504340171813965
Epoch: 7, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.601 Vali Acc: 0.822 Test Loss: 0.601 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1886489391326904
Epoch: 8, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.643 Vali Acc: 0.791 Test Loss: 0.643 Test Acc: 0.791
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2266130447387695
Epoch: 9, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.662 Vali Acc: 0.816 Test Loss: 0.662 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6321725845336914
Epoch: 10, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2705779075622559
Epoch: 11, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.664 Vali Acc: 0.828 Test Loss: 0.664 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828118).  Saving model ...
Epoch: 12 cost time: 1.5065960884094238
Epoch: 12, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3547630310058594
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.23826265335083
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.743 Vali Acc: 0.825 Test Loss: 0.743 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4027149677276611
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.764 Vali Acc: 0.822 Test Loss: 0.764 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5765726566314697
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.743 Vali Acc: 0.834 Test Loss: 0.743 Test Acc: 0.834
Validation loss decreased (-0.828118 --> -0.834368).  Saving model ...
Epoch: 17 cost time: 1.6240050792694092
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.744 Vali Acc: 0.831 Test Loss: 0.744 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5849525928497314
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.775 Vali Acc: 0.828 Test Loss: 0.775 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.490102767944336
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.795 Vali Acc: 0.825 Test Loss: 0.795 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2809383869171143
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.804 Vali Acc: 0.825 Test Loss: 0.804 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1881966590881348
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.814 Vali Acc: 0.822 Test Loss: 0.814 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4698209762573242
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.819 Test Loss: 0.816 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5566914081573486
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.814 Vali Acc: 0.822 Test Loss: 0.814 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5774693489074707
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.810 Vali Acc: 0.819 Test Loss: 0.810 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4940052032470703
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.821 Vali Acc: 0.822 Test Loss: 0.821 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.685791015625
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.822 Test Loss: 0.828 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 6723372
model size : 30.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.412038564682007
Epoch: 1, Steps: 8 | Train Loss: 2.177 Vali Loss: 1.949 Vali Acc: 0.322 Test Loss: 1.949 Test Acc: 0.322
Validation loss decreased (inf --> -0.321856).  Saving model ...
Epoch: 2 cost time: 1.7179968357086182
Epoch: 2, Steps: 8 | Train Loss: 1.840 Vali Loss: 1.464 Vali Acc: 0.691 Test Loss: 1.464 Test Acc: 0.691
Validation loss decreased (-0.321856 --> -0.690610).  Saving model ...
Epoch: 3 cost time: 1.7646069526672363
Epoch: 3, Steps: 8 | Train Loss: 1.264 Vali Loss: 0.975 Vali Acc: 0.787 Test Loss: 0.975 Test Acc: 0.787
Validation loss decreased (-0.690610 --> -0.787490).  Saving model ...
Epoch: 4 cost time: 1.3684759140014648
Epoch: 4, Steps: 8 | Train Loss: 0.834 Vali Loss: 0.688 Vali Acc: 0.800 Test Loss: 0.688 Test Acc: 0.800
Validation loss decreased (-0.787490 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 1.567765712738037
Epoch: 5, Steps: 8 | Train Loss: 0.534 Vali Loss: 0.598 Vali Acc: 0.806 Test Loss: 0.598 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.806244).  Saving model ...
Epoch: 6 cost time: 1.2490582466125488
Epoch: 6, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.680 Vali Acc: 0.775 Test Loss: 0.680 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6453263759613037
Epoch: 7, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.592 Vali Acc: 0.809 Test Loss: 0.592 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 8 cost time: 1.5899994373321533
Epoch: 8, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
Validation loss decreased (-0.809369 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 1.6414501667022705
Epoch: 9, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7516956329345703
Epoch: 10, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.683 Vali Acc: 0.809 Test Loss: 0.683 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7015461921691895
Epoch: 11, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.711 Vali Acc: 0.816 Test Loss: 0.711 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.574946641921997
Epoch: 12, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.635 Vali Acc: 0.847 Test Loss: 0.635 Test Acc: 0.847
Validation loss decreased (-0.828119 --> -0.846869).  Saving model ...
Epoch: 13 cost time: 1.9084444046020508
Epoch: 13, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.725 Vali Acc: 0.841 Test Loss: 0.725 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5591609477996826
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.804 Vali Acc: 0.822 Test Loss: 0.804 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6029083728790283
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.831 Vali Acc: 0.809 Test Loss: 0.831 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5048694610595703
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.788 Vali Acc: 0.819 Test Loss: 0.788 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.578291654586792
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.786 Vali Acc: 0.831 Test Loss: 0.786 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.704580545425415
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.792 Vali Acc: 0.838 Test Loss: 0.792 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3170201778411865
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.802 Vali Acc: 0.831 Test Loss: 0.802 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5745875835418701
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.806 Vali Acc: 0.834 Test Loss: 0.806 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2362701892852783
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.804 Vali Acc: 0.831 Test Loss: 0.804 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2670118808746338
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.813 Vali Acc: 0.828 Test Loss: 0.813 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 6098220
model size : 28.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.8650050163269043
Epoch: 1, Steps: 8 | Train Loss: 2.112 Vali Loss: 1.961 Vali Acc: 0.300 Test Loss: 1.961 Test Acc: 0.300
Validation loss decreased (inf --> -0.299980).  Saving model ...
Epoch: 2 cost time: 1.7110497951507568
Epoch: 2, Steps: 8 | Train Loss: 1.885 Vali Loss: 1.470 Vali Acc: 0.653 Test Loss: 1.470 Test Acc: 0.653
Validation loss decreased (-0.299980 --> -0.653110).  Saving model ...
Epoch: 3 cost time: 1.2414004802703857
Epoch: 3, Steps: 8 | Train Loss: 1.337 Vali Loss: 0.990 Vali Acc: 0.766 Test Loss: 0.990 Test Acc: 0.766
Validation loss decreased (-0.653110 --> -0.765615).  Saving model ...
Epoch: 4 cost time: 1.2148616313934326
Epoch: 4, Steps: 8 | Train Loss: 0.855 Vali Loss: 0.668 Vali Acc: 0.819 Test Loss: 0.668 Test Acc: 0.819
Validation loss decreased (-0.765615 --> -0.818743).  Saving model ...
Epoch: 5 cost time: 2.1767783164978027
Epoch: 5, Steps: 8 | Train Loss: 0.542 Vali Loss: 0.597 Vali Acc: 0.806 Test Loss: 0.597 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5703973770141602
Epoch: 6, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
Validation loss decreased (-0.818743 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 1.536679983139038
Epoch: 7, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.636 Vali Acc: 0.806 Test Loss: 0.636 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7243316173553467
Epoch: 8, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840619).  Saving model ...
Epoch: 9 cost time: 1.4480292797088623
Epoch: 9, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.635 Vali Acc: 0.812 Test Loss: 0.635 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.434232473373413
Epoch: 10, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.640 Vali Acc: 0.822 Test Loss: 0.640 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.187309503555298
Epoch: 11, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.662 Vali Acc: 0.819 Test Loss: 0.662 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6953096389770508
Epoch: 12, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.791 Vali Acc: 0.816 Test Loss: 0.791 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4200518131256104
Epoch: 13, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.726 Vali Acc: 0.825 Test Loss: 0.726 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4450793266296387
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.771 Vali Acc: 0.825 Test Loss: 0.771 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5691137313842773
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.737 Vali Acc: 0.831 Test Loss: 0.737 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8701705932617188
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.739 Vali Acc: 0.828 Test Loss: 0.739 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.578383445739746
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.816 Vali Acc: 0.828 Test Loss: 0.816 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4790430068969727
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.807 Vali Acc: 0.828 Test Loss: 0.807 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 6087724
model size : 28.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.952840566635132
Epoch: 1, Steps: 8 | Train Loss: 2.289 Vali Loss: 2.048 Vali Acc: 0.234 Test Loss: 2.048 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 1.3767492771148682
Epoch: 2, Steps: 8 | Train Loss: 1.909 Vali Loss: 1.516 Vali Acc: 0.656 Test Loss: 1.516 Test Acc: 0.656
Validation loss decreased (-0.234355 --> -0.656235).  Saving model ...
Epoch: 3 cost time: 1.3328232765197754
Epoch: 3, Steps: 8 | Train Loss: 1.283 Vali Loss: 1.039 Vali Acc: 0.781 Test Loss: 1.039 Test Acc: 0.781
Validation loss decreased (-0.656235 --> -0.781240).  Saving model ...
Epoch: 4 cost time: 1.4033820629119873
Epoch: 4, Steps: 8 | Train Loss: 0.859 Vali Loss: 0.711 Vali Acc: 0.791 Test Loss: 0.711 Test Acc: 0.791
Validation loss decreased (-0.781240 --> -0.790618).  Saving model ...
Epoch: 5 cost time: 1.539276123046875
Epoch: 5, Steps: 8 | Train Loss: 0.521 Vali Loss: 0.623 Vali Acc: 0.825 Test Loss: 0.623 Test Acc: 0.825
Validation loss decreased (-0.790618 --> -0.824994).  Saving model ...
Epoch: 6 cost time: 1.534780740737915
Epoch: 6, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.579 Vali Acc: 0.809 Test Loss: 0.579 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5148200988769531
Epoch: 7, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 1.3261487483978271
Epoch: 8, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3734924793243408
Epoch: 9, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5401575565338135
Epoch: 10, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.651 Vali Acc: 0.828 Test Loss: 0.651 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.512084722518921
Epoch: 11, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.659 Vali Acc: 0.816 Test Loss: 0.659 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5020208358764648
Epoch: 12, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.672 Vali Acc: 0.828 Test Loss: 0.672 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.526463270187378
Epoch: 13, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.701 Vali Acc: 0.828 Test Loss: 0.701 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3178160190582275
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.831 Vali Acc: 0.809 Test Loss: 0.831 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.299489974975586
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.836 Vali Acc: 0.816 Test Loss: 0.836 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2642724514007568
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.794 Vali Acc: 0.834 Test Loss: 0.794 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0836684703826904
Epoch: 17, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.831 Vali Acc: 0.819 Test Loss: 0.831 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 6077228
model size : 28.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6593105792999268
Epoch: 1, Steps: 8 | Train Loss: 2.178 Vali Loss: 1.907 Vali Acc: 0.334 Test Loss: 1.907 Test Acc: 0.334
Validation loss decreased (inf --> -0.334356).  Saving model ...
Epoch: 2 cost time: 1.3396329879760742
Epoch: 2, Steps: 8 | Train Loss: 1.971 Vali Loss: 1.520 Vali Acc: 0.562 Test Loss: 1.520 Test Acc: 0.562
Validation loss decreased (-0.334356 --> -0.562485).  Saving model ...
Epoch: 3 cost time: 1.5047719478607178
Epoch: 3, Steps: 8 | Train Loss: 1.438 Vali Loss: 1.040 Vali Acc: 0.772 Test Loss: 1.040 Test Acc: 0.772
Validation loss decreased (-0.562485 --> -0.771865).  Saving model ...
Epoch: 4 cost time: 1.287757396697998
Epoch: 4, Steps: 8 | Train Loss: 0.967 Vali Loss: 0.727 Vali Acc: 0.794 Test Loss: 0.727 Test Acc: 0.794
Validation loss decreased (-0.771865 --> -0.793743).  Saving model ...
Epoch: 5 cost time: 1.34468674659729
Epoch: 5, Steps: 8 | Train Loss: 0.615 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
Validation loss decreased (-0.793743 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 1.3471872806549072
Epoch: 6, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.595 Vali Acc: 0.778 Test Loss: 0.595 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4447596073150635
Epoch: 7, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3211052417755127
Epoch: 8, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.606 Vali Acc: 0.797 Test Loss: 0.606 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.294987678527832
Epoch: 9, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.594 Vali Acc: 0.816 Test Loss: 0.594 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.290332555770874
Epoch: 10, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.645 Vali Acc: 0.841 Test Loss: 0.645 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3563246726989746
Epoch: 11, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.643 Vali Acc: 0.831 Test Loss: 0.643 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3676245212554932
Epoch: 12, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.702 Vali Acc: 0.816 Test Loss: 0.702 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5394248962402344
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.745 Vali Acc: 0.825 Test Loss: 0.745 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.47770094871521
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.807 Vali Acc: 0.819 Test Loss: 0.807 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.477419137954712
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.800 Vali Acc: 0.822 Test Loss: 0.800 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 6066732
model size : 28.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.870561361312866
Epoch: 1, Steps: 8 | Train Loss: 2.140 Vali Loss: 1.952 Vali Acc: 0.316 Test Loss: 1.952 Test Acc: 0.316
Validation loss decreased (inf --> -0.315605).  Saving model ...
Epoch: 2 cost time: 1.2835016250610352
Epoch: 2, Steps: 8 | Train Loss: 1.758 Vali Loss: 1.465 Vali Acc: 0.609 Test Loss: 1.465 Test Acc: 0.609
Validation loss decreased (-0.315605 --> -0.609360).  Saving model ...
Epoch: 3 cost time: 1.4346818923950195
Epoch: 3, Steps: 8 | Train Loss: 1.286 Vali Loss: 0.972 Vali Acc: 0.778 Test Loss: 0.972 Test Acc: 0.778
Validation loss decreased (-0.609360 --> -0.778115).  Saving model ...
Epoch: 4 cost time: 1.2798681259155273
Epoch: 4, Steps: 8 | Train Loss: 0.820 Vali Loss: 0.672 Vali Acc: 0.812 Test Loss: 0.672 Test Acc: 0.812
Validation loss decreased (-0.778115 --> -0.812493).  Saving model ...
Epoch: 5 cost time: 1.732677698135376
Epoch: 5, Steps: 8 | Train Loss: 0.552 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815619).  Saving model ...
Epoch: 6 cost time: 1.3698430061340332
Epoch: 6, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 1.5997858047485352
Epoch: 7, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 1.4054303169250488
Epoch: 8, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.594 Vali Acc: 0.816 Test Loss: 0.594 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3380424976348877
Epoch: 9, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.632 Vali Acc: 0.806 Test Loss: 0.632 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4368445873260498
Epoch: 10, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.592 Vali Acc: 0.853 Test Loss: 0.592 Test Acc: 0.853
Validation loss decreased (-0.824994 --> -0.853119).  Saving model ...
Epoch: 11 cost time: 1.7176239490509033
Epoch: 11, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.786 Vali Acc: 0.787 Test Loss: 0.786 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3865485191345215
Epoch: 12, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.669 Vali Acc: 0.825 Test Loss: 0.669 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5737824440002441
Epoch: 13, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.739 Vali Acc: 0.812 Test Loss: 0.739 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3977093696594238
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.933 Vali Acc: 0.809 Test Loss: 0.933 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.549604892730713
Epoch: 15, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.933 Vali Acc: 0.822 Test Loss: 0.933 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3485898971557617
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.901 Vali Acc: 0.819 Test Loss: 0.901 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4924836158752441
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.857 Vali Acc: 0.822 Test Loss: 0.857 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4220736026763916
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.816 Vali Acc: 0.834 Test Loss: 0.816 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2105348110198975
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.799 Vali Acc: 0.834 Test Loss: 0.799 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2662465572357178
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.830 Vali Acc: 0.819 Test Loss: 0.830 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 5769900
model size : 27.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2866642475128174
Epoch: 1, Steps: 8 | Train Loss: 2.175 Vali Loss: 1.968 Vali Acc: 0.294 Test Loss: 1.968 Test Acc: 0.294
Validation loss decreased (inf --> -0.293730).  Saving model ...
Epoch: 2 cost time: 1.5263302326202393
Epoch: 2, Steps: 8 | Train Loss: 1.832 Vali Loss: 1.443 Vali Acc: 0.616 Test Loss: 1.443 Test Acc: 0.616
Validation loss decreased (-0.293730 --> -0.615611).  Saving model ...
Epoch: 3 cost time: 1.5074329376220703
Epoch: 3, Steps: 8 | Train Loss: 1.252 Vali Loss: 0.989 Vali Acc: 0.741 Test Loss: 0.989 Test Acc: 0.741
Validation loss decreased (-0.615611 --> -0.740615).  Saving model ...
Epoch: 4 cost time: 1.5678722858428955
Epoch: 4, Steps: 8 | Train Loss: 0.815 Vali Loss: 0.665 Vali Acc: 0.794 Test Loss: 0.665 Test Acc: 0.794
Validation loss decreased (-0.740615 --> -0.793743).  Saving model ...
Epoch: 5 cost time: 1.382835865020752
Epoch: 5, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.614 Vali Acc: 0.819 Test Loss: 0.614 Test Acc: 0.819
Validation loss decreased (-0.793743 --> -0.818744).  Saving model ...
Epoch: 6 cost time: 1.3091700077056885
Epoch: 6, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 1.3357460498809814
Epoch: 7, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.602 Vali Acc: 0.806 Test Loss: 0.602 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3992226123809814
Epoch: 8, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.561 Vali Acc: 0.834 Test Loss: 0.561 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834369).  Saving model ...
Epoch: 9 cost time: 1.4542369842529297
Epoch: 9, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.663 Vali Acc: 0.803 Test Loss: 0.663 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.323021650314331
Epoch: 10, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.635 Vali Acc: 0.828 Test Loss: 0.635 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.529970407485962
Epoch: 11, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.655 Vali Acc: 0.816 Test Loss: 0.655 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5051069259643555
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.768 Vali Acc: 0.806 Test Loss: 0.768 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5119330883026123
Epoch: 13, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.736 Vali Acc: 0.822 Test Loss: 0.736 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6024932861328125
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.760 Vali Acc: 0.816 Test Loss: 0.760 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2628974914550781
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.841 Vali Acc: 0.816 Test Loss: 0.841 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3355720043182373
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.826 Vali Acc: 0.816 Test Loss: 0.826 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3406832218170166
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.845 Vali Acc: 0.812 Test Loss: 0.845 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1758215427398682
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.859 Vali Acc: 0.816 Test Loss: 0.859 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 5759404
model size : 26.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2584097385406494
Epoch: 1, Steps: 8 | Train Loss: 2.069 Vali Loss: 1.894 Vali Acc: 0.384 Test Loss: 1.894 Test Acc: 0.384
Validation loss decreased (inf --> -0.384356).  Saving model ...
Epoch: 2 cost time: 1.705414056777954
Epoch: 2, Steps: 8 | Train Loss: 1.762 Vali Loss: 1.412 Vali Acc: 0.722 Test Loss: 1.412 Test Acc: 0.722
Validation loss decreased (-0.384356 --> -0.721861).  Saving model ...
Epoch: 3 cost time: 1.6383976936340332
Epoch: 3, Steps: 8 | Train Loss: 1.187 Vali Loss: 0.955 Vali Acc: 0.766 Test Loss: 0.955 Test Acc: 0.766
Validation loss decreased (-0.721861 --> -0.765615).  Saving model ...
Epoch: 4 cost time: 1.087238073348999
Epoch: 4, Steps: 8 | Train Loss: 0.816 Vali Loss: 0.668 Vali Acc: 0.816 Test Loss: 0.668 Test Acc: 0.816
Validation loss decreased (-0.765615 --> -0.815618).  Saving model ...
Epoch: 5 cost time: 1.2520041465759277
Epoch: 5, Steps: 8 | Train Loss: 0.572 Vali Loss: 0.625 Vali Acc: 0.781 Test Loss: 0.625 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2793266773223877
Epoch: 6, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.605 Vali Acc: 0.812 Test Loss: 0.605 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2803435325622559
Epoch: 7, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.639 Vali Acc: 0.800 Test Loss: 0.639 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2053256034851074
Epoch: 8, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2085480690002441
Epoch: 9, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.660 Vali Acc: 0.784 Test Loss: 0.660 Test Acc: 0.784
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.417952060699463
Epoch: 10, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.775 Vali Acc: 0.816 Test Loss: 0.775 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2313628196716309
Epoch: 11, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.705 Vali Acc: 0.816 Test Loss: 0.705 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.248516321182251
Epoch: 12, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.709 Vali Acc: 0.834 Test Loss: 0.709 Test Acc: 0.834
Validation loss decreased (-0.815618 --> -0.834368).  Saving model ...
Epoch: 13 cost time: 1.4381887912750244
Epoch: 13, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.769 Vali Acc: 0.809 Test Loss: 0.769 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3039283752441406
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.752 Vali Acc: 0.809 Test Loss: 0.752 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4035258293151855
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.774 Vali Acc: 0.809 Test Loss: 0.774 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.415675401687622
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.847 Vali Acc: 0.809 Test Loss: 0.847 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7581045627593994
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.861 Vali Acc: 0.806 Test Loss: 0.861 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1756246089935303
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.838 Vali Acc: 0.812 Test Loss: 0.838 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.323413610458374
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.780 Vali Acc: 0.828 Test Loss: 0.780 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3183231353759766
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.804 Vali Acc: 0.819 Test Loss: 0.804 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4790737628936768
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.847 Vali Acc: 0.806 Test Loss: 0.847 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3863725662231445
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.855 Vali Acc: 0.822 Test Loss: 0.855 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 5748908
model size : 26.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5194358825683594
Epoch: 1, Steps: 8 | Train Loss: 2.153 Vali Loss: 1.929 Vali Acc: 0.353 Test Loss: 1.929 Test Acc: 0.353
Validation loss decreased (inf --> -0.353106).  Saving model ...
Epoch: 2 cost time: 1.609928846359253
Epoch: 2, Steps: 8 | Train Loss: 1.774 Vali Loss: 1.432 Vali Acc: 0.741 Test Loss: 1.432 Test Acc: 0.741
Validation loss decreased (-0.353106 --> -0.740611).  Saving model ...
Epoch: 3 cost time: 1.3621649742126465
Epoch: 3, Steps: 8 | Train Loss: 1.290 Vali Loss: 0.968 Vali Acc: 0.772 Test Loss: 0.968 Test Acc: 0.772
Validation loss decreased (-0.740611 --> -0.771865).  Saving model ...
Epoch: 4 cost time: 1.7314956188201904
Epoch: 4, Steps: 8 | Train Loss: 0.793 Vali Loss: 0.646 Vali Acc: 0.828 Test Loss: 0.646 Test Acc: 0.828
Validation loss decreased (-0.771865 --> -0.828119).  Saving model ...
Epoch: 5 cost time: 1.4944632053375244
Epoch: 5, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.592 Vali Acc: 0.819 Test Loss: 0.592 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4641292095184326
Epoch: 6, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3708930015563965
Epoch: 7, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3758621215820312
Epoch: 8, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.584 Vali Acc: 0.828 Test Loss: 0.584 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 1.4705581665039062
Epoch: 9, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.666 Vali Acc: 0.806 Test Loss: 0.666 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.561807632446289
Epoch: 10, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.696 Vali Acc: 0.769 Test Loss: 0.696 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6388647556304932
Epoch: 11, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.696 Vali Acc: 0.816 Test Loss: 0.696 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4981305599212646
Epoch: 12, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.677 Vali Acc: 0.822 Test Loss: 0.677 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.53786039352417
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.667 Vali Acc: 0.834 Test Loss: 0.667 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834368).  Saving model ...
Epoch: 14 cost time: 1.545616865158081
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.768 Vali Acc: 0.825 Test Loss: 0.768 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4042460918426514
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.763 Vali Acc: 0.831 Test Loss: 0.763 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6782822608947754
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.776 Vali Acc: 0.834 Test Loss: 0.776 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.559523105621338
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.749 Vali Acc: 0.831 Test Loss: 0.749 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2388060092926025
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.739 Vali Acc: 0.834 Test Loss: 0.739 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5995326042175293
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.737 Vali Acc: 0.834 Test Loss: 0.737 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5833683013916016
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.746 Vali Acc: 0.834 Test Loss: 0.746 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5241775512695312
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.752 Vali Acc: 0.831 Test Loss: 0.752 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.877284049987793
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.758 Vali Acc: 0.834 Test Loss: 0.758 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6003806591033936
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.765 Vali Acc: 0.834 Test Loss: 0.765 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 5738412
model size : 26.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2145049571990967
Epoch: 1, Steps: 8 | Train Loss: 2.165 Vali Loss: 1.986 Vali Acc: 0.256 Test Loss: 1.986 Test Acc: 0.256
Validation loss decreased (inf --> -0.256230).  Saving model ...
Epoch: 2 cost time: 1.4526927471160889
Epoch: 2, Steps: 8 | Train Loss: 1.969 Vali Loss: 1.717 Vali Acc: 0.475 Test Loss: 1.717 Test Acc: 0.475
Validation loss decreased (-0.256230 --> -0.474983).  Saving model ...
Epoch: 3 cost time: 1.3917102813720703
Epoch: 3, Steps: 8 | Train Loss: 1.609 Vali Loss: 1.366 Vali Acc: 0.669 Test Loss: 1.366 Test Acc: 0.669
Validation loss decreased (-0.474983 --> -0.668736).  Saving model ...
Epoch: 4 cost time: 1.198049545288086
Epoch: 4, Steps: 8 | Train Loss: 1.213 Vali Loss: 0.994 Vali Acc: 0.747 Test Loss: 0.994 Test Acc: 0.747
Validation loss decreased (-0.668736 --> -0.746865).  Saving model ...
Epoch: 5 cost time: 1.1719062328338623
Epoch: 5, Steps: 8 | Train Loss: 0.854 Vali Loss: 0.743 Vali Acc: 0.784 Test Loss: 0.743 Test Acc: 0.784
Validation loss decreased (-0.746865 --> -0.784368).  Saving model ...
Epoch: 6 cost time: 1.2082972526550293
Epoch: 6, Steps: 8 | Train Loss: 0.560 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
Validation loss decreased (-0.784368 --> -0.809369).  Saving model ...
Epoch: 7 cost time: 1.2967629432678223
Epoch: 7, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
Validation loss decreased (-0.809369 --> -0.824995).  Saving model ...
Epoch: 8 cost time: 1.045644998550415
Epoch: 8, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2415759563446045
Epoch: 9, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3373734951019287
Epoch: 10, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.598 Vali Acc: 0.822 Test Loss: 0.598 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2314627170562744
Epoch: 11, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.586 Vali Acc: 0.816 Test Loss: 0.586 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2593295574188232
Epoch: 12, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.576 Vali Acc: 0.838 Test Loss: 0.576 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837494).  Saving model ...
Epoch: 13 cost time: 1.3701224327087402
Epoch: 13, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.576 Vali Acc: 0.831 Test Loss: 0.576 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.610159158706665
Epoch: 14, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.610 Vali Acc: 0.831 Test Loss: 0.610 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6579530239105225
Epoch: 15, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.622 Vali Acc: 0.825 Test Loss: 0.622 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.14422607421875
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.641 Vali Acc: 0.825 Test Loss: 0.641 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3186898231506348
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.644 Vali Acc: 0.819 Test Loss: 0.644 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.496821641921997
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.647 Vali Acc: 0.819 Test Loss: 0.647 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5961673259735107
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.641 Vali Acc: 0.819 Test Loss: 0.641 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1304705142974854
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.379335641860962
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.662 Vali Acc: 0.819 Test Loss: 0.662 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7812144756317139
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.682 Vali Acc: 0.819 Test Loss: 0.682 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 2725932
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4354424476623535
Epoch: 1, Steps: 8 | Train Loss: 2.060 Vali Loss: 1.869 Vali Acc: 0.403 Test Loss: 1.869 Test Acc: 0.403
Validation loss decreased (inf --> -0.403106).  Saving model ...
Epoch: 2 cost time: 1.2079451084136963
Epoch: 2, Steps: 8 | Train Loss: 1.816 Vali Loss: 1.653 Vali Acc: 0.556 Test Loss: 1.653 Test Acc: 0.556
Validation loss decreased (-0.403106 --> -0.556233).  Saving model ...
Epoch: 3 cost time: 1.1118133068084717
Epoch: 3, Steps: 8 | Train Loss: 1.523 Vali Loss: 1.276 Vali Acc: 0.800 Test Loss: 1.276 Test Acc: 0.800
Validation loss decreased (-0.556233 --> -0.799987).  Saving model ...
Epoch: 4 cost time: 1.4454851150512695
Epoch: 4, Steps: 8 | Train Loss: 1.113 Vali Loss: 0.926 Vali Acc: 0.819 Test Loss: 0.926 Test Acc: 0.819
Validation loss decreased (-0.799987 --> -0.818741).  Saving model ...
Epoch: 5 cost time: 1.6798386573791504
Epoch: 5, Steps: 8 | Train Loss: 0.783 Vali Loss: 0.694 Vali Acc: 0.806 Test Loss: 0.694 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5628445148468018
Epoch: 6, Steps: 8 | Train Loss: 0.515 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
Validation loss decreased (-0.818741 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 1.6010041236877441
Epoch: 7, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.541 Vali Acc: 0.831 Test Loss: 0.541 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 1.3586153984069824
Epoch: 8, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.532 Vali Acc: 0.834 Test Loss: 0.532 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 1.341761589050293
Epoch: 9, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.560 Vali Acc: 0.834 Test Loss: 0.560 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6827023029327393
Epoch: 10, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5026659965515137
Epoch: 11, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.555 Vali Acc: 0.841 Test Loss: 0.555 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840619).  Saving model ...
Epoch: 12 cost time: 1.493936538696289
Epoch: 12, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.568 Vali Acc: 0.838 Test Loss: 0.568 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.590041160583496
Epoch: 13, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.567 Vali Acc: 0.834 Test Loss: 0.567 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5648210048675537
Epoch: 14, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.568 Vali Acc: 0.831 Test Loss: 0.568 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3466901779174805
Epoch: 15, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.603 Vali Acc: 0.834 Test Loss: 0.603 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.481238842010498
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.638 Vali Acc: 0.819 Test Loss: 0.638 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6494593620300293
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.628 Vali Acc: 0.834 Test Loss: 0.628 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.356271743774414
Epoch: 18, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.644 Vali Acc: 0.828 Test Loss: 0.644 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7054109573364258
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.658 Vali Acc: 0.825 Test Loss: 0.658 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.230175495147705
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.655 Vali Acc: 0.828 Test Loss: 0.655 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4008538722991943
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.648 Vali Acc: 0.828 Test Loss: 0.648 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 2720684
model size : 12.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2432518005371094
Epoch: 1, Steps: 8 | Train Loss: 2.200 Vali Loss: 2.016 Vali Acc: 0.347 Test Loss: 2.016 Test Acc: 0.347
Validation loss decreased (inf --> -0.346855).  Saving model ...
Epoch: 2 cost time: 1.3353371620178223
Epoch: 2, Steps: 8 | Train Loss: 1.966 Vali Loss: 1.790 Vali Acc: 0.469 Test Loss: 1.790 Test Acc: 0.469
Validation loss decreased (-0.346855 --> -0.468732).  Saving model ...
Epoch: 3 cost time: 1.4441533088684082
Epoch: 3, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.399 Vali Acc: 0.759 Test Loss: 1.399 Test Acc: 0.759
Validation loss decreased (-0.468732 --> -0.759361).  Saving model ...
Epoch: 4 cost time: 1.2423992156982422
Epoch: 4, Steps: 8 | Train Loss: 1.271 Vali Loss: 1.013 Vali Acc: 0.819 Test Loss: 1.013 Test Acc: 0.819
Validation loss decreased (-0.759361 --> -0.818740).  Saving model ...
Epoch: 5 cost time: 1.4800004959106445
Epoch: 5, Steps: 8 | Train Loss: 0.923 Vali Loss: 0.718 Vali Acc: 0.816 Test Loss: 0.718 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3029274940490723
Epoch: 6, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.593 Vali Acc: 0.841 Test Loss: 0.593 Test Acc: 0.841
Validation loss decreased (-0.818740 --> -0.840619).  Saving model ...
Epoch: 7 cost time: 1.3306331634521484
Epoch: 7, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3690075874328613
Epoch: 8, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.533 Vali Acc: 0.847 Test Loss: 0.533 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 1.4909281730651855
Epoch: 9, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.465339183807373
Epoch: 10, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4505372047424316
Epoch: 11, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2229361534118652
Epoch: 12, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4163248538970947
Epoch: 13, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.588 Vali Acc: 0.838 Test Loss: 0.588 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3219854831695557
Epoch: 14, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.618 Vali Acc: 0.816 Test Loss: 0.618 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3553717136383057
Epoch: 15, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.598 Vali Acc: 0.828 Test Loss: 0.598 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7042691707611084
Epoch: 16, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.592 Vali Acc: 0.834 Test Loss: 0.592 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4158596992492676
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.633 Vali Acc: 0.834 Test Loss: 0.633 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3607494831085205
Epoch: 18, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.632 Vali Acc: 0.838 Test Loss: 0.632 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 2715436
model size : 12.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.115700721740723
Epoch: 1, Steps: 8 | Train Loss: 2.208 Vali Loss: 2.045 Vali Acc: 0.156 Test Loss: 2.045 Test Acc: 0.156
Validation loss decreased (inf --> -0.156230).  Saving model ...
Epoch: 2 cost time: 1.5550005435943604
Epoch: 2, Steps: 8 | Train Loss: 2.006 Vali Loss: 1.817 Vali Acc: 0.303 Test Loss: 1.817 Test Acc: 0.303
Validation loss decreased (-0.156230 --> -0.303107).  Saving model ...
Epoch: 3 cost time: 1.4970557689666748
Epoch: 3, Steps: 8 | Train Loss: 1.648 Vali Loss: 1.480 Vali Acc: 0.569 Test Loss: 1.480 Test Acc: 0.569
Validation loss decreased (-0.303107 --> -0.568735).  Saving model ...
Epoch: 4 cost time: 1.760986328125
Epoch: 4, Steps: 8 | Train Loss: 1.310 Vali Loss: 1.068 Vali Acc: 0.747 Test Loss: 1.068 Test Acc: 0.747
Validation loss decreased (-0.568735 --> -0.746864).  Saving model ...
Epoch: 5 cost time: 1.301316499710083
Epoch: 5, Steps: 8 | Train Loss: 0.865 Vali Loss: 0.769 Vali Acc: 0.787 Test Loss: 0.769 Test Acc: 0.787
Validation loss decreased (-0.746864 --> -0.787492).  Saving model ...
Epoch: 6 cost time: 1.8669166564941406
Epoch: 6, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.620 Vali Acc: 0.806 Test Loss: 0.620 Test Acc: 0.806
Validation loss decreased (-0.787492 --> -0.806244).  Saving model ...
Epoch: 7 cost time: 1.5766265392303467
Epoch: 7, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
Validation loss decreased (-0.806244 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 1.2674708366394043
Epoch: 8, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8330185413360596
Epoch: 9, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.550 Vali Acc: 0.831 Test Loss: 0.550 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.278716802597046
Epoch: 10, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5324056148529053
Epoch: 11, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4059805870056152
Epoch: 12, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.575 Vali Acc: 0.831 Test Loss: 0.575 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5364503860473633
Epoch: 13, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.602 Vali Acc: 0.834 Test Loss: 0.602 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5778214931488037
Epoch: 14, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.593 Vali Acc: 0.838 Test Loss: 0.593 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4738831520080566
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.595 Vali Acc: 0.834 Test Loss: 0.595 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.461430311203003
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4550185203552246
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.648 Vali Acc: 0.822 Test Loss: 0.648 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 2710188
model size : 12.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0172383785247803
Epoch: 1, Steps: 8 | Train Loss: 2.144 Vali Loss: 1.952 Vali Acc: 0.259 Test Loss: 1.952 Test Acc: 0.259
Validation loss decreased (inf --> -0.259355).  Saving model ...
Epoch: 2 cost time: 1.3533565998077393
Epoch: 2, Steps: 8 | Train Loss: 1.900 Vali Loss: 1.745 Vali Acc: 0.431 Test Loss: 1.745 Test Acc: 0.431
Validation loss decreased (-0.259355 --> -0.431233).  Saving model ...
Epoch: 3 cost time: 1.4297614097595215
Epoch: 3, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.397 Vali Acc: 0.722 Test Loss: 1.397 Test Acc: 0.722
Validation loss decreased (-0.431233 --> -0.721861).  Saving model ...
Epoch: 4 cost time: 1.3302595615386963
Epoch: 4, Steps: 8 | Train Loss: 1.208 Vali Loss: 1.014 Vali Acc: 0.800 Test Loss: 1.014 Test Acc: 0.800
Validation loss decreased (-0.721861 --> -0.799990).  Saving model ...
Epoch: 5 cost time: 1.4241573810577393
Epoch: 5, Steps: 8 | Train Loss: 0.844 Vali Loss: 0.747 Vali Acc: 0.794 Test Loss: 0.747 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4751591682434082
Epoch: 6, Steps: 8 | Train Loss: 0.601 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
Validation loss decreased (-0.799990 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 1.4243416786193848
Epoch: 7, Steps: 8 | Train Loss: 0.496 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
Validation loss decreased (-0.818744 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 1.4269578456878662
Epoch: 8, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1220669746398926
Epoch: 9, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.496 Vali Acc: 0.856 Test Loss: 0.496 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 1.2933881282806396
Epoch: 10, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.553 Vali Acc: 0.816 Test Loss: 0.553 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4648780822753906
Epoch: 11, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5873198509216309
Epoch: 12, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.579 Vali Acc: 0.831 Test Loss: 0.579 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.499194860458374
Epoch: 13, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.595 Vali Acc: 0.825 Test Loss: 0.595 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4999091625213623
Epoch: 14, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.624 Vali Acc: 0.819 Test Loss: 0.624 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4791810512542725
Epoch: 15, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.226287841796875
Epoch: 16, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.608 Vali Acc: 0.822 Test Loss: 0.608 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3363068103790283
Epoch: 17, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.647 Vali Acc: 0.812 Test Loss: 0.647 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3882744312286377
Epoch: 18, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.635 Vali Acc: 0.819 Test Loss: 0.635 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3294134140014648
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 2068012
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.20461630821228
Epoch: 1, Steps: 8 | Train Loss: 2.223 Vali Loss: 2.066 Vali Acc: 0.188 Test Loss: 2.066 Test Acc: 0.188
Validation loss decreased (inf --> -0.187479).  Saving model ...
Epoch: 2 cost time: 1.4561302661895752
Epoch: 2, Steps: 8 | Train Loss: 2.051 Vali Loss: 1.841 Vali Acc: 0.194 Test Loss: 1.841 Test Acc: 0.194
Validation loss decreased (-0.187479 --> -0.193732).  Saving model ...
Epoch: 3 cost time: 1.8062808513641357
Epoch: 3, Steps: 8 | Train Loss: 1.672 Vali Loss: 1.467 Vali Acc: 0.669 Test Loss: 1.467 Test Acc: 0.669
Validation loss decreased (-0.193732 --> -0.668735).  Saving model ...
Epoch: 4 cost time: 1.737795352935791
Epoch: 4, Steps: 8 | Train Loss: 1.381 Vali Loss: 1.079 Vali Acc: 0.759 Test Loss: 1.079 Test Acc: 0.759
Validation loss decreased (-0.668735 --> -0.759364).  Saving model ...
Epoch: 5 cost time: 1.2200865745544434
Epoch: 5, Steps: 8 | Train Loss: 0.960 Vali Loss: 0.790 Vali Acc: 0.834 Test Loss: 0.790 Test Acc: 0.834
Validation loss decreased (-0.759364 --> -0.834367).  Saving model ...
Epoch: 6 cost time: 1.643963098526001
Epoch: 6, Steps: 8 | Train Loss: 0.729 Vali Loss: 0.641 Vali Acc: 0.806 Test Loss: 0.641 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4638392925262451
Epoch: 7, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.576 Vali Acc: 0.825 Test Loss: 0.576 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6989219188690186
Epoch: 8, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4837427139282227
Epoch: 9, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.576 Vali Acc: 0.806 Test Loss: 0.576 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6949563026428223
Epoch: 10, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.618 Vali Acc: 0.819 Test Loss: 0.618 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2532548904418945
Epoch: 11, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.582 Vali Acc: 0.816 Test Loss: 0.582 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.530691385269165
Epoch: 12, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.597 Vali Acc: 0.825 Test Loss: 0.597 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0702712535858154
Epoch: 13, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7803406715393066
Epoch: 14, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.622 Vali Acc: 0.816 Test Loss: 0.622 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6167004108428955
Epoch: 15, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.649 Vali Acc: 0.809 Test Loss: 0.649 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 2062764
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.239764451980591
Epoch: 1, Steps: 8 | Train Loss: 2.199 Vali Loss: 1.976 Vali Acc: 0.281 Test Loss: 1.976 Test Acc: 0.281
Validation loss decreased (inf --> -0.281230).  Saving model ...
Epoch: 2 cost time: 1.5177178382873535
Epoch: 2, Steps: 8 | Train Loss: 2.023 Vali Loss: 1.839 Vali Acc: 0.275 Test Loss: 1.839 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0241575241088867
Epoch: 3, Steps: 8 | Train Loss: 1.673 Vali Loss: 1.402 Vali Acc: 0.719 Test Loss: 1.402 Test Acc: 0.719
Validation loss decreased (-0.281230 --> -0.718736).  Saving model ...
Epoch: 4 cost time: 1.2797045707702637
Epoch: 4, Steps: 8 | Train Loss: 1.312 Vali Loss: 1.041 Vali Acc: 0.791 Test Loss: 1.041 Test Acc: 0.791
Validation loss decreased (-0.718736 --> -0.790615).  Saving model ...
Epoch: 5 cost time: 1.7840354442596436
Epoch: 5, Steps: 8 | Train Loss: 0.893 Vali Loss: 0.793 Vali Acc: 0.775 Test Loss: 0.793 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5721993446350098
Epoch: 6, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.612 Vali Acc: 0.819 Test Loss: 0.612 Test Acc: 0.819
Validation loss decreased (-0.790615 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 1.386362075805664
Epoch: 7, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.564 Vali Acc: 0.831 Test Loss: 0.564 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831244).  Saving model ...
Epoch: 8 cost time: 1.711728811264038
Epoch: 8, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.569 Vali Acc: 0.812 Test Loss: 0.569 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.482642650604248
Epoch: 9, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 1.6943528652191162
Epoch: 10, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4222733974456787
Epoch: 11, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.535595417022705
Epoch: 12, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5026938915252686
Epoch: 13, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.601 Vali Acc: 0.834 Test Loss: 0.601 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7580516338348389
Epoch: 14, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.628 Vali Acc: 0.834 Test Loss: 0.628 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8722715377807617
Epoch: 15, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.552424430847168
Epoch: 16, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.683 Vali Acc: 0.831 Test Loss: 0.683 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4270002841949463
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.676 Vali Acc: 0.822 Test Loss: 0.676 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4612090587615967
Epoch: 18, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.680 Vali Acc: 0.831 Test Loss: 0.680 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.44627046585083
Epoch: 19, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.690 Vali Acc: 0.822 Test Loss: 0.690 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 2057516
model size : 10.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.181414842605591
Epoch: 1, Steps: 8 | Train Loss: 2.130 Vali Loss: 2.042 Vali Acc: 0.200 Test Loss: 2.042 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 1.1889865398406982
Epoch: 2, Steps: 8 | Train Loss: 1.932 Vali Loss: 1.807 Vali Acc: 0.356 Test Loss: 1.807 Test Acc: 0.356
Validation loss decreased (-0.199980 --> -0.356232).  Saving model ...
Epoch: 3 cost time: 1.2820396423339844
Epoch: 3, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.445 Vali Acc: 0.631 Test Loss: 1.445 Test Acc: 0.631
Validation loss decreased (-0.356232 --> -0.631236).  Saving model ...
Epoch: 4 cost time: 1.301464319229126
Epoch: 4, Steps: 8 | Train Loss: 1.274 Vali Loss: 1.062 Vali Acc: 0.756 Test Loss: 1.062 Test Acc: 0.756
Validation loss decreased (-0.631236 --> -0.756239).  Saving model ...
Epoch: 5 cost time: 1.202118158340454
Epoch: 5, Steps: 8 | Train Loss: 0.831 Vali Loss: 0.778 Vali Acc: 0.787 Test Loss: 0.778 Test Acc: 0.787
Validation loss decreased (-0.756239 --> -0.787492).  Saving model ...
Epoch: 6 cost time: 1.607658863067627
Epoch: 6, Steps: 8 | Train Loss: 0.649 Vali Loss: 0.629 Vali Acc: 0.812 Test Loss: 0.629 Test Acc: 0.812
Validation loss decreased (-0.787492 --> -0.812494).  Saving model ...
Epoch: 7 cost time: 1.1615307331085205
Epoch: 7, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
Validation loss decreased (-0.812494 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 1.2603373527526855
Epoch: 8, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3567206859588623
Epoch: 9, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.585 Vali Acc: 0.812 Test Loss: 0.585 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4260632991790771
Epoch: 10, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.540 Vali Acc: 0.834 Test Loss: 0.540 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 1.414278507232666
Epoch: 11, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3660006523132324
Epoch: 12, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.619 Vali Acc: 0.816 Test Loss: 0.619 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4187166690826416
Epoch: 13, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4150314331054688
Epoch: 14, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.614 Vali Acc: 0.816 Test Loss: 0.614 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3848190307617188
Epoch: 15, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.642 Vali Acc: 0.825 Test Loss: 0.642 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2059345245361328
Epoch: 16, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.650 Vali Acc: 0.819 Test Loss: 0.650 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2275373935699463
Epoch: 17, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.641 Vali Acc: 0.816 Test Loss: 0.641 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1510002613067627
Epoch: 18, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.648 Vali Acc: 0.816 Test Loss: 0.648 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6179449558258057
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.698 Vali Acc: 0.819 Test Loss: 0.698 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1452970504760742
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.710 Vali Acc: 0.812 Test Loss: 0.710 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 2052268
model size : 10.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2507832050323486
Epoch: 1, Steps: 8 | Train Loss: 2.118 Vali Loss: 2.003 Vali Acc: 0.234 Test Loss: 2.003 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 1.3510823249816895
Epoch: 2, Steps: 8 | Train Loss: 1.978 Vali Loss: 1.779 Vali Acc: 0.522 Test Loss: 1.779 Test Acc: 0.522
Validation loss decreased (-0.234355 --> -0.521857).  Saving model ...
Epoch: 3 cost time: 1.4746160507202148
Epoch: 3, Steps: 8 | Train Loss: 1.682 Vali Loss: 1.483 Vali Acc: 0.675 Test Loss: 1.483 Test Acc: 0.675
Validation loss decreased (-0.521857 --> -0.674985).  Saving model ...
Epoch: 4 cost time: 1.3850302696228027
Epoch: 4, Steps: 8 | Train Loss: 1.365 Vali Loss: 1.139 Vali Acc: 0.762 Test Loss: 1.139 Test Acc: 0.762
Validation loss decreased (-0.674985 --> -0.762489).  Saving model ...
Epoch: 5 cost time: 1.6755521297454834
Epoch: 5, Steps: 8 | Train Loss: 0.987 Vali Loss: 0.844 Vali Acc: 0.778 Test Loss: 0.844 Test Acc: 0.778
Validation loss decreased (-0.762489 --> -0.778117).  Saving model ...
Epoch: 6 cost time: 1.497898817062378
Epoch: 6, Steps: 8 | Train Loss: 0.706 Vali Loss: 0.641 Vali Acc: 0.809 Test Loss: 0.641 Test Acc: 0.809
Validation loss decreased (-0.778117 --> -0.809369).  Saving model ...
Epoch: 7 cost time: 1.3098227977752686
Epoch: 7, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 8 cost time: 1.2330081462860107
Epoch: 8, Steps: 8 | Train Loss: 0.441 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 1.1896684169769287
Epoch: 9, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828120).  Saving model ...
Epoch: 10 cost time: 1.6023218631744385
Epoch: 10, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.538 Vali Acc: 0.816 Test Loss: 0.538 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7067348957061768
Epoch: 11, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.594531774520874
Epoch: 12, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.552 Vali Acc: 0.822 Test Loss: 0.552 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3736445903778076
Epoch: 13, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.617 Vali Acc: 0.806 Test Loss: 0.617 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.355945348739624
Epoch: 14, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4525823593139648
Epoch: 15, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.608 Vali Acc: 0.825 Test Loss: 0.608 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5534358024597168
Epoch: 16, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.666 Vali Acc: 0.812 Test Loss: 0.666 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.594555139541626
Epoch: 17, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.700 Vali Acc: 0.800 Test Loss: 0.700 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4750781059265137
Epoch: 18, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.667 Vali Acc: 0.812 Test Loss: 0.667 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4168508052825928
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.682 Vali Acc: 0.819 Test Loss: 0.682 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 1739052
model size : 9.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.6335675716400146
Epoch: 1, Steps: 8 | Train Loss: 2.071 Vali Loss: 1.951 Vali Acc: 0.312 Test Loss: 1.951 Test Acc: 0.312
Validation loss decreased (inf --> -0.312480).  Saving model ...
Epoch: 2 cost time: 1.3112819194793701
Epoch: 2, Steps: 8 | Train Loss: 1.998 Vali Loss: 1.780 Vali Acc: 0.381 Test Loss: 1.780 Test Acc: 0.381
Validation loss decreased (-0.312480 --> -0.381232).  Saving model ...
Epoch: 3 cost time: 1.2419004440307617
Epoch: 3, Steps: 8 | Train Loss: 1.683 Vali Loss: 1.467 Vali Acc: 0.681 Test Loss: 1.467 Test Acc: 0.681
Validation loss decreased (-0.381232 --> -0.681235).  Saving model ...
Epoch: 4 cost time: 1.1768383979797363
Epoch: 4, Steps: 8 | Train Loss: 1.312 Vali Loss: 1.121 Vali Acc: 0.803 Test Loss: 1.121 Test Acc: 0.803
Validation loss decreased (-0.681235 --> -0.803114).  Saving model ...
Epoch: 5 cost time: 1.1912000179290771
Epoch: 5, Steps: 8 | Train Loss: 0.969 Vali Loss: 0.818 Vali Acc: 0.828 Test Loss: 0.818 Test Acc: 0.828
Validation loss decreased (-0.803114 --> -0.828117).  Saving model ...
Epoch: 6 cost time: 1.2715189456939697
Epoch: 6, Steps: 8 | Train Loss: 0.780 Vali Loss: 0.639 Vali Acc: 0.825 Test Loss: 0.639 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2429296970367432
Epoch: 7, Steps: 8 | Train Loss: 0.492 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
Validation loss decreased (-0.828117 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 1.2060637474060059
Epoch: 8, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.567 Vali Acc: 0.812 Test Loss: 0.567 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4388184547424316
Epoch: 9, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3561763763427734
Epoch: 10, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 1.437422752380371
Epoch: 11, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.556 Vali Acc: 0.834 Test Loss: 0.556 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2742197513580322
Epoch: 12, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3926663398742676
Epoch: 13, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.594 Vali Acc: 0.834 Test Loss: 0.594 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2984933853149414
Epoch: 14, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.603 Vali Acc: 0.822 Test Loss: 0.603 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3012595176696777
Epoch: 15, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.632 Vali Acc: 0.825 Test Loss: 0.632 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3144783973693848
Epoch: 16, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.651 Vali Acc: 0.819 Test Loss: 0.651 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3234326839447021
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.654 Vali Acc: 0.822 Test Loss: 0.654 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3098678588867188
Epoch: 18, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.683 Vali Acc: 0.825 Test Loss: 0.683 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2351317405700684
Epoch: 19, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.688 Vali Acc: 0.819 Test Loss: 0.688 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9120903015136719
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.696 Vali Acc: 0.819 Test Loss: 0.696 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 1733804
model size : 9.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2451159954071045
Epoch: 1, Steps: 8 | Train Loss: 2.196 Vali Loss: 2.055 Vali Acc: 0.228 Test Loss: 2.055 Test Acc: 0.228
Validation loss decreased (inf --> -0.228104).  Saving model ...
Epoch: 2 cost time: 1.3391618728637695
Epoch: 2, Steps: 8 | Train Loss: 2.042 Vali Loss: 1.838 Vali Acc: 0.450 Test Loss: 1.838 Test Acc: 0.450
Validation loss decreased (-0.228104 --> -0.449982).  Saving model ...
Epoch: 3 cost time: 1.1346099376678467
Epoch: 3, Steps: 8 | Train Loss: 1.780 Vali Loss: 1.543 Vali Acc: 0.619 Test Loss: 1.543 Test Acc: 0.619
Validation loss decreased (-0.449982 --> -0.618735).  Saving model ...
Epoch: 4 cost time: 1.1580829620361328
Epoch: 4, Steps: 8 | Train Loss: 1.393 Vali Loss: 1.201 Vali Acc: 0.769 Test Loss: 1.201 Test Acc: 0.769
Validation loss decreased (-0.618735 --> -0.768738).  Saving model ...
Epoch: 5 cost time: 1.3911917209625244
Epoch: 5, Steps: 8 | Train Loss: 1.062 Vali Loss: 0.880 Vali Acc: 0.803 Test Loss: 0.880 Test Acc: 0.803
Validation loss decreased (-0.768738 --> -0.803116).  Saving model ...
Epoch: 6 cost time: 1.305438756942749
Epoch: 6, Steps: 8 | Train Loss: 0.770 Vali Loss: 0.685 Vali Acc: 0.828 Test Loss: 0.685 Test Acc: 0.828
Validation loss decreased (-0.803116 --> -0.828118).  Saving model ...
Epoch: 7 cost time: 1.673346757888794
Epoch: 7, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2997479438781738
Epoch: 8, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5479307174682617
Epoch: 9, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.568 Vali Acc: 0.831 Test Loss: 0.568 Test Acc: 0.831
Validation loss decreased (-0.828118 --> -0.831244).  Saving model ...
Epoch: 10 cost time: 1.2190454006195068
Epoch: 10, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.555 Vali Acc: 0.831 Test Loss: 0.555 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 1.3427820205688477
Epoch: 11, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.588 Vali Acc: 0.809 Test Loss: 0.588 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4570081233978271
Epoch: 12, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.607 Vali Acc: 0.819 Test Loss: 0.607 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.417747974395752
Epoch: 13, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.584 Vali Acc: 0.828 Test Loss: 0.584 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2986376285552979
Epoch: 14, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.617 Vali Acc: 0.834 Test Loss: 0.617 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 15 cost time: 1.3537495136260986
Epoch: 15, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.614 Vali Acc: 0.838 Test Loss: 0.614 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 16 cost time: 1.4008080959320068
Epoch: 16, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.630 Vali Acc: 0.831 Test Loss: 0.630 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.316976547241211
Epoch: 17, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.648 Vali Acc: 0.822 Test Loss: 0.648 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4645721912384033
Epoch: 18, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.661 Vali Acc: 0.831 Test Loss: 0.661 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3118607997894287
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.677 Vali Acc: 0.831 Test Loss: 0.677 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4457473754882812
Epoch: 20, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.676 Vali Acc: 0.828 Test Loss: 0.676 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.470205545425415
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.700 Vali Acc: 0.822 Test Loss: 0.700 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1770994663238525
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3141274452209473
Epoch: 23, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.707 Vali Acc: 0.828 Test Loss: 0.707 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.351302146911621
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.713 Vali Acc: 0.825 Test Loss: 0.713 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2791345119476318
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.713 Vali Acc: 0.822 Test Loss: 0.713 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 1728556
model size : 9.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.758431911468506
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 2.047 Vali Acc: 0.191 Test Loss: 2.047 Test Acc: 0.191
Validation loss decreased (inf --> -0.190605).  Saving model ...
Epoch: 2 cost time: 1.4036617279052734
Epoch: 2, Steps: 8 | Train Loss: 2.045 Vali Loss: 1.892 Vali Acc: 0.419 Test Loss: 1.892 Test Acc: 0.419
Validation loss decreased (-0.190605 --> -0.418731).  Saving model ...
Epoch: 3 cost time: 1.2721786499023438
Epoch: 3, Steps: 8 | Train Loss: 1.756 Vali Loss: 1.572 Vali Acc: 0.597 Test Loss: 1.572 Test Acc: 0.597
Validation loss decreased (-0.418731 --> -0.596859).  Saving model ...
Epoch: 4 cost time: 1.1882014274597168
Epoch: 4, Steps: 8 | Train Loss: 1.455 Vali Loss: 1.236 Vali Acc: 0.772 Test Loss: 1.236 Test Acc: 0.772
Validation loss decreased (-0.596859 --> -0.771863).  Saving model ...
Epoch: 5 cost time: 1.2316722869873047
Epoch: 5, Steps: 8 | Train Loss: 1.124 Vali Loss: 0.922 Vali Acc: 0.809 Test Loss: 0.922 Test Acc: 0.809
Validation loss decreased (-0.771863 --> -0.809366).  Saving model ...
Epoch: 6 cost time: 1.4095497131347656
Epoch: 6, Steps: 8 | Train Loss: 0.756 Vali Loss: 0.700 Vali Acc: 0.794 Test Loss: 0.700 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.367842435836792
Epoch: 7, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
Validation loss decreased (-0.809366 --> -0.831244).  Saving model ...
Epoch: 8 cost time: 1.2899341583251953
Epoch: 8, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1456680297851562
Epoch: 9, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.506 Vali Acc: 0.831 Test Loss: 0.506 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 1.384044885635376
Epoch: 10, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 1.3061959743499756
Epoch: 11, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5446722507476807
Epoch: 12, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2190868854522705
Epoch: 13, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4785284996032715
Epoch: 14, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.613743543624878
Epoch: 15, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.656 Vali Acc: 0.803 Test Loss: 0.656 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3985671997070312
Epoch: 16, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.584 Vali Acc: 0.828 Test Loss: 0.584 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9220466613769531
Epoch: 17, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843744).  Saving model ...
Epoch: 18 cost time: 1.6891825199127197
Epoch: 18, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.664 Vali Acc: 0.822 Test Loss: 0.664 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.289896011352539
Epoch: 19, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.672 Vali Acc: 0.819 Test Loss: 0.672 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.577178716659546
Epoch: 20, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.674 Vali Acc: 0.819 Test Loss: 0.674 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4066929817199707
Epoch: 21, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.682 Vali Acc: 0.816 Test Loss: 0.682 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3050978183746338
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.685 Vali Acc: 0.816 Test Loss: 0.685 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3754780292510986
Epoch: 23, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.695 Vali Acc: 0.812 Test Loss: 0.695 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5758442878723145
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.694 Vali Acc: 0.816 Test Loss: 0.694 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4419591426849365
Epoch: 25, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.697 Vali Acc: 0.812 Test Loss: 0.697 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.536280870437622
Epoch: 26, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.696 Vali Acc: 0.809 Test Loss: 0.696 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3921210765838623
Epoch: 27, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.705 Vali Acc: 0.809 Test Loss: 0.705 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 1723308
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1454365253448486
Epoch: 1, Steps: 8 | Train Loss: 2.209 Vali Loss: 2.101 Vali Acc: 0.131 Test Loss: 2.101 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 1.1697936058044434
Epoch: 2, Steps: 8 | Train Loss: 2.016 Vali Loss: 1.916 Vali Acc: 0.319 Test Loss: 1.916 Test Acc: 0.319
Validation loss decreased (-0.131229 --> -0.318731).  Saving model ...
Epoch: 3 cost time: 1.143977403640747
Epoch: 3, Steps: 8 | Train Loss: 1.818 Vali Loss: 1.622 Vali Acc: 0.594 Test Loss: 1.622 Test Acc: 0.594
Validation loss decreased (-0.318731 --> -0.593734).  Saving model ...
Epoch: 4 cost time: 1.207972764968872
Epoch: 4, Steps: 8 | Train Loss: 1.525 Vali Loss: 1.321 Vali Acc: 0.709 Test Loss: 1.321 Test Acc: 0.709
Validation loss decreased (-0.593734 --> -0.709362).  Saving model ...
Epoch: 5 cost time: 1.031855821609497
Epoch: 5, Steps: 8 | Train Loss: 1.174 Vali Loss: 0.991 Vali Acc: 0.759 Test Loss: 0.991 Test Acc: 0.759
Validation loss decreased (-0.709362 --> -0.759365).  Saving model ...
Epoch: 6 cost time: 1.442556381225586
Epoch: 6, Steps: 8 | Train Loss: 0.867 Vali Loss: 0.739 Vali Acc: 0.806 Test Loss: 0.739 Test Acc: 0.806
Validation loss decreased (-0.759365 --> -0.806243).  Saving model ...
Epoch: 7 cost time: 1.3056831359863281
Epoch: 7, Steps: 8 | Train Loss: 0.573 Vali Loss: 0.625 Vali Acc: 0.806 Test Loss: 0.625 Test Acc: 0.806
Validation loss decreased (-0.806243 --> -0.806244).  Saving model ...
Epoch: 8 cost time: 1.4108903408050537
Epoch: 8, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
Validation loss decreased (-0.806244 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 1.3907191753387451
Epoch: 9, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.276261329650879
Epoch: 10, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2184865474700928
Epoch: 11, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.581 Vali Acc: 0.806 Test Loss: 0.581 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.310180425643921
Epoch: 12, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4903137683868408
Epoch: 13, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3763315677642822
Epoch: 14, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.609 Vali Acc: 0.819 Test Loss: 0.609 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2854089736938477
Epoch: 15, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.618 Vali Acc: 0.825 Test Loss: 0.618 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.153904676437378
Epoch: 16, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.633 Vali Acc: 0.825 Test Loss: 0.633 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5482048988342285
Epoch: 17, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.633 Vali Acc: 0.828 Test Loss: 0.633 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 18 cost time: 1.2642505168914795
Epoch: 18, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.657 Vali Acc: 0.828 Test Loss: 0.657 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.938309907913208
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5318529605865479
Epoch: 20, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5555577278137207
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.668 Vali Acc: 0.825 Test Loss: 0.668 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4513275623321533
Epoch: 22, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.672 Vali Acc: 0.831 Test Loss: 0.672 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831243).  Saving model ...
Epoch: 23 cost time: 1.3677246570587158
Epoch: 23, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.686 Vali Acc: 0.819 Test Loss: 0.686 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5917603969573975
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.697 Vali Acc: 0.819 Test Loss: 0.697 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5144262313842773
Epoch: 25, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2497615814208984
Epoch: 26, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.706 Vali Acc: 0.816 Test Loss: 0.706 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1127598285675049
Epoch: 27, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.715 Vali Acc: 0.816 Test Loss: 0.715 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.459822177886963
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.718 Vali Acc: 0.812 Test Loss: 0.718 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.360475778579712
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.723 Vali Acc: 0.816 Test Loss: 0.723 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.156381607055664
Epoch: 30, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.730 Vali Acc: 0.819 Test Loss: 0.730 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4459238052368164
Epoch: 31, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.739 Vali Acc: 0.812 Test Loss: 0.739 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6224937438964844
Epoch: 32, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.742 Vali Acc: 0.812 Test Loss: 0.742 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 1574572
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1592113971710205
Epoch: 1, Steps: 8 | Train Loss: 2.254 Vali Loss: 2.039 Vali Acc: 0.163 Test Loss: 2.039 Test Acc: 0.163
Validation loss decreased (inf --> -0.162480).  Saving model ...
Epoch: 2 cost time: 1.5059993267059326
Epoch: 2, Steps: 8 | Train Loss: 2.042 Vali Loss: 1.876 Vali Acc: 0.375 Test Loss: 1.876 Test Acc: 0.375
Validation loss decreased (-0.162480 --> -0.374981).  Saving model ...
Epoch: 3 cost time: 1.354642391204834
Epoch: 3, Steps: 8 | Train Loss: 1.799 Vali Loss: 1.568 Vali Acc: 0.694 Test Loss: 1.568 Test Acc: 0.694
Validation loss decreased (-0.374981 --> -0.693734).  Saving model ...
Epoch: 4 cost time: 1.2396891117095947
Epoch: 4, Steps: 8 | Train Loss: 1.452 Vali Loss: 1.274 Vali Acc: 0.725 Test Loss: 1.274 Test Acc: 0.725
Validation loss decreased (-0.693734 --> -0.724987).  Saving model ...
Epoch: 5 cost time: 1.286536693572998
Epoch: 5, Steps: 8 | Train Loss: 1.146 Vali Loss: 0.966 Vali Acc: 0.791 Test Loss: 0.966 Test Acc: 0.791
Validation loss decreased (-0.724987 --> -0.790615).  Saving model ...
Epoch: 6 cost time: 1.5094828605651855
Epoch: 6, Steps: 8 | Train Loss: 0.844 Vali Loss: 0.742 Vali Acc: 0.828 Test Loss: 0.742 Test Acc: 0.828
Validation loss decreased (-0.790615 --> -0.828118).  Saving model ...
Epoch: 7 cost time: 1.3754620552062988
Epoch: 7, Steps: 8 | Train Loss: 0.603 Vali Loss: 0.630 Vali Acc: 0.803 Test Loss: 0.630 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7663986682891846
Epoch: 8, Steps: 8 | Train Loss: 0.482 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
Validation loss decreased (-0.828118 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 1.3965120315551758
Epoch: 9, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4359736442565918
Epoch: 10, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.588432788848877
Epoch: 11, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.576 Vali Acc: 0.809 Test Loss: 0.576 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7248849868774414
Epoch: 12, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.582 Vali Acc: 0.816 Test Loss: 0.582 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4743068218231201
Epoch: 13, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840619).  Saving model ...
Epoch: 14 cost time: 1.55609130859375
Epoch: 14, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.638 Vali Acc: 0.812 Test Loss: 0.638 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4148585796356201
Epoch: 15, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.635 Vali Acc: 0.819 Test Loss: 0.635 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.268286943435669
Epoch: 16, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.649 Vali Acc: 0.809 Test Loss: 0.649 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4394819736480713
Epoch: 17, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.675 Vali Acc: 0.825 Test Loss: 0.675 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5584743022918701
Epoch: 18, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.653 Vali Acc: 0.819 Test Loss: 0.653 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4200987815856934
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.311838150024414
Epoch: 20, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.705 Vali Acc: 0.812 Test Loss: 0.705 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1846859455108643
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.707 Vali Acc: 0.816 Test Loss: 0.707 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1196198463439941
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.693 Vali Acc: 0.812 Test Loss: 0.693 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1705513000488281
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.700 Vali Acc: 0.809 Test Loss: 0.700 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 1569324
model size : 8.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1485435962677
Epoch: 1, Steps: 8 | Train Loss: 2.103 Vali Loss: 1.970 Vali Acc: 0.347 Test Loss: 1.970 Test Acc: 0.347
Validation loss decreased (inf --> -0.346855).  Saving model ...
Epoch: 2 cost time: 1.2438409328460693
Epoch: 2, Steps: 8 | Train Loss: 1.961 Vali Loss: 1.767 Vali Acc: 0.356 Test Loss: 1.767 Test Acc: 0.356
Validation loss decreased (-0.346855 --> -0.356232).  Saving model ...
Epoch: 3 cost time: 1.3023366928100586
Epoch: 3, Steps: 8 | Train Loss: 1.654 Vali Loss: 1.450 Vali Acc: 0.697 Test Loss: 1.450 Test Acc: 0.697
Validation loss decreased (-0.356232 --> -0.696860).  Saving model ...
Epoch: 4 cost time: 1.353534460067749
Epoch: 4, Steps: 8 | Train Loss: 1.408 Vali Loss: 1.139 Vali Acc: 0.756 Test Loss: 1.139 Test Acc: 0.756
Validation loss decreased (-0.696860 --> -0.756239).  Saving model ...
Epoch: 5 cost time: 1.2003068923950195
Epoch: 5, Steps: 8 | Train Loss: 1.003 Vali Loss: 0.860 Vali Acc: 0.812 Test Loss: 0.860 Test Acc: 0.812
Validation loss decreased (-0.756239 --> -0.812491).  Saving model ...
Epoch: 6 cost time: 1.0310404300689697
Epoch: 6, Steps: 8 | Train Loss: 0.721 Vali Loss: 0.670 Vali Acc: 0.812 Test Loss: 0.670 Test Acc: 0.812
Validation loss decreased (-0.812491 --> -0.812493).  Saving model ...
Epoch: 7 cost time: 1.3237924575805664
Epoch: 7, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.569 Vali Acc: 0.825 Test Loss: 0.569 Test Acc: 0.825
Validation loss decreased (-0.812493 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 1.3103549480438232
Epoch: 8, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
Validation loss decreased (-0.824994 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 1.2834875583648682
Epoch: 9, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1870603561401367
Epoch: 10, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3854689598083496
Epoch: 11, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.570 Vali Acc: 0.812 Test Loss: 0.570 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1453776359558105
Epoch: 12, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.598 Vali Acc: 0.812 Test Loss: 0.598 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0583703517913818
Epoch: 13, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.606 Vali Acc: 0.797 Test Loss: 0.606 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4804065227508545
Epoch: 14, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.597 Vali Acc: 0.831 Test Loss: 0.597 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0956032276153564
Epoch: 15, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.641 Vali Acc: 0.812 Test Loss: 0.641 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4450886249542236
Epoch: 16, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3251826763153076
Epoch: 17, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1959025859832764
Epoch: 18, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.682 Vali Acc: 0.822 Test Loss: 0.682 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 1564076
model size : 8.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0631814002990723
Epoch: 1, Steps: 8 | Train Loss: 2.149 Vali Loss: 1.984 Vali Acc: 0.300 Test Loss: 1.984 Test Acc: 0.300
Validation loss decreased (inf --> -0.299980).  Saving model ...
Epoch: 2 cost time: 1.2907066345214844
Epoch: 2, Steps: 8 | Train Loss: 1.995 Vali Loss: 1.802 Vali Acc: 0.384 Test Loss: 1.802 Test Acc: 0.384
Validation loss decreased (-0.299980 --> -0.384357).  Saving model ...
Epoch: 3 cost time: 1.0797250270843506
Epoch: 3, Steps: 8 | Train Loss: 1.736 Vali Loss: 1.505 Vali Acc: 0.653 Test Loss: 1.505 Test Acc: 0.653
Validation loss decreased (-0.384357 --> -0.653110).  Saving model ...
Epoch: 4 cost time: 1.2488954067230225
Epoch: 4, Steps: 8 | Train Loss: 1.454 Vali Loss: 1.199 Vali Acc: 0.719 Test Loss: 1.199 Test Acc: 0.719
Validation loss decreased (-0.653110 --> -0.718738).  Saving model ...
Epoch: 5 cost time: 1.345686674118042
Epoch: 5, Steps: 8 | Train Loss: 1.017 Vali Loss: 0.911 Vali Acc: 0.819 Test Loss: 0.911 Test Acc: 0.819
Validation loss decreased (-0.718738 --> -0.818741).  Saving model ...
Epoch: 6 cost time: 1.0834109783172607
Epoch: 6, Steps: 8 | Train Loss: 0.764 Vali Loss: 0.697 Vali Acc: 0.797 Test Loss: 0.697 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.157240867614746
Epoch: 7, Steps: 8 | Train Loss: 0.572 Vali Loss: 0.596 Vali Acc: 0.822 Test Loss: 0.596 Test Acc: 0.822
Validation loss decreased (-0.818741 --> -0.821869).  Saving model ...
Epoch: 8 cost time: 1.121795415878296
Epoch: 8, Steps: 8 | Train Loss: 0.407 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828120).  Saving model ...
Epoch: 9 cost time: 1.2715020179748535
Epoch: 9, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.531 Vali Acc: 0.828 Test Loss: 0.531 Test Acc: 0.828
Validation loss decreased (-0.828120 --> -0.828120).  Saving model ...
Epoch: 10 cost time: 1.116147756576538
Epoch: 10, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.565 Vali Acc: 0.806 Test Loss: 0.565 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.483980417251587
Epoch: 11, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.580 Vali Acc: 0.825 Test Loss: 0.580 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1548662185668945
Epoch: 12, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.562 Vali Acc: 0.831 Test Loss: 0.562 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831244).  Saving model ...
Epoch: 13 cost time: 1.1958868503570557
Epoch: 13, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4398810863494873
Epoch: 14, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.596 Vali Acc: 0.831 Test Loss: 0.596 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3160195350646973
Epoch: 15, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.594 Vali Acc: 0.819 Test Loss: 0.594 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1677045822143555
Epoch: 16, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.630 Vali Acc: 0.825 Test Loss: 0.630 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2036724090576172
Epoch: 17, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.687 Vali Acc: 0.822 Test Loss: 0.687 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2307147979736328
Epoch: 18, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.670 Vali Acc: 0.825 Test Loss: 0.670 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.423194408416748
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.658 Vali Acc: 0.822 Test Loss: 0.658 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.15864896774292
Epoch: 20, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.676 Vali Acc: 0.816 Test Loss: 0.676 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2396061420440674
Epoch: 21, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.705 Vali Acc: 0.816 Test Loss: 0.705 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1123220920562744
Epoch: 22, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.711 Vali Acc: 0.819 Test Loss: 0.711 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 1558828
model size : 8.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.141191005706787
Epoch: 1, Steps: 8 | Train Loss: 2.092 Vali Loss: 2.019 Vali Acc: 0.219 Test Loss: 2.019 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 1.2103407382965088
Epoch: 2, Steps: 8 | Train Loss: 1.983 Vali Loss: 1.881 Vali Acc: 0.375 Test Loss: 1.881 Test Acc: 0.375
Validation loss decreased (-0.218730 --> -0.374981).  Saving model ...
Epoch: 3 cost time: 1.334049940109253
Epoch: 3, Steps: 8 | Train Loss: 1.833 Vali Loss: 1.674 Vali Acc: 0.594 Test Loss: 1.674 Test Acc: 0.594
Validation loss decreased (-0.374981 --> -0.593733).  Saving model ...
Epoch: 4 cost time: 1.2978768348693848
Epoch: 4, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.403 Vali Acc: 0.709 Test Loss: 1.403 Test Acc: 0.709
Validation loss decreased (-0.593733 --> -0.709361).  Saving model ...
Epoch: 5 cost time: 1.42319655418396
Epoch: 5, Steps: 8 | Train Loss: 1.254 Vali Loss: 1.106 Vali Acc: 0.769 Test Loss: 1.106 Test Acc: 0.769
Validation loss decreased (-0.709361 --> -0.768739).  Saving model ...
Epoch: 6 cost time: 1.6337077617645264
Epoch: 6, Steps: 8 | Train Loss: 0.958 Vali Loss: 0.844 Vali Acc: 0.800 Test Loss: 0.844 Test Acc: 0.800
Validation loss decreased (-0.768739 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 1.5018510818481445
Epoch: 7, Steps: 8 | Train Loss: 0.705 Vali Loss: 0.675 Vali Acc: 0.834 Test Loss: 0.675 Test Acc: 0.834
Validation loss decreased (-0.799992 --> -0.834368).  Saving model ...
Epoch: 8 cost time: 1.6117732524871826
Epoch: 8, Steps: 8 | Train Loss: 0.521 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7498366832733154
Epoch: 9, Steps: 8 | Train Loss: 0.456 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6360387802124023
Epoch: 10, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
Validation loss decreased (-0.834368 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 1.5705623626708984
Epoch: 11, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5960700511932373
Epoch: 12, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.327650547027588
Epoch: 13, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.523923635482788
Epoch: 14, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.61142897605896
Epoch: 15, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.545 Vali Acc: 0.838 Test Loss: 0.545 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5784969329833984
Epoch: 16, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2131097316741943
Epoch: 17, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4590895175933838
Epoch: 18, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5918357372283936
Epoch: 19, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5330026149749756
Epoch: 20, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 1037868
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1561992168426514
Epoch: 1, Steps: 8 | Train Loss: 2.281 Vali Loss: 2.155 Vali Acc: 0.116 Test Loss: 2.155 Test Acc: 0.116
Validation loss decreased (inf --> -0.115603).  Saving model ...
Epoch: 2 cost time: 1.429771900177002
Epoch: 2, Steps: 8 | Train Loss: 2.134 Vali Loss: 2.012 Vali Acc: 0.159 Test Loss: 2.012 Test Acc: 0.159
Validation loss decreased (-0.115603 --> -0.159355).  Saving model ...
Epoch: 3 cost time: 1.2485568523406982
Epoch: 3, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.814 Vali Acc: 0.463 Test Loss: 1.814 Test Acc: 0.463
Validation loss decreased (-0.159355 --> -0.462482).  Saving model ...
Epoch: 4 cost time: 1.3578681945800781
Epoch: 4, Steps: 8 | Train Loss: 1.795 Vali Loss: 1.600 Vali Acc: 0.616 Test Loss: 1.600 Test Acc: 0.616
Validation loss decreased (-0.462482 --> -0.615609).  Saving model ...
Epoch: 5 cost time: 1.2591938972473145
Epoch: 5, Steps: 8 | Train Loss: 1.454 Vali Loss: 1.317 Vali Acc: 0.684 Test Loss: 1.317 Test Acc: 0.684
Validation loss decreased (-0.615609 --> -0.684362).  Saving model ...
Epoch: 6 cost time: 1.3264844417572021
Epoch: 6, Steps: 8 | Train Loss: 1.156 Vali Loss: 1.017 Vali Acc: 0.772 Test Loss: 1.017 Test Acc: 0.772
Validation loss decreased (-0.684362 --> -0.771865).  Saving model ...
Epoch: 7 cost time: 1.1193013191223145
Epoch: 7, Steps: 8 | Train Loss: 0.875 Vali Loss: 0.807 Vali Acc: 0.781 Test Loss: 0.807 Test Acc: 0.781
Validation loss decreased (-0.771865 --> -0.781242).  Saving model ...
Epoch: 8 cost time: 1.0794305801391602
Epoch: 8, Steps: 8 | Train Loss: 0.657 Vali Loss: 0.669 Vali Acc: 0.800 Test Loss: 0.669 Test Acc: 0.800
Validation loss decreased (-0.781242 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 1.3380498886108398
Epoch: 9, Steps: 8 | Train Loss: 0.502 Vali Loss: 0.617 Vali Acc: 0.812 Test Loss: 0.617 Test Acc: 0.812
Validation loss decreased (-0.799993 --> -0.812494).  Saving model ...
Epoch: 10 cost time: 1.5602080821990967
Epoch: 10, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.572 Vali Acc: 0.831 Test Loss: 0.572 Test Acc: 0.831
Validation loss decreased (-0.812494 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 1.3427417278289795
Epoch: 11, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0053300857543945
Epoch: 12, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.580 Vali Acc: 0.819 Test Loss: 0.580 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3562304973602295
Epoch: 13, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.574 Vali Acc: 0.828 Test Loss: 0.574 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2547645568847656
Epoch: 14, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.560 Vali Acc: 0.831 Test Loss: 0.560 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 15 cost time: 1.2578513622283936
Epoch: 15, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.562 Vali Acc: 0.831 Test Loss: 0.562 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.357957363128662
Epoch: 16, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3528354167938232
Epoch: 17, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.577 Vali Acc: 0.816 Test Loss: 0.577 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2592856884002686
Epoch: 18, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3932058811187744
Epoch: 19, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1823477745056152
Epoch: 20, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.591 Vali Acc: 0.822 Test Loss: 0.591 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.699479579925537
Epoch: 21, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.596 Vali Acc: 0.831 Test Loss: 0.596 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6057746410369873
Epoch: 22, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.595 Vali Acc: 0.825 Test Loss: 0.595 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.456240177154541
Epoch: 23, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.608 Vali Acc: 0.819 Test Loss: 0.608 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2893249988555908
Epoch: 24, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.621 Vali Acc: 0.819 Test Loss: 0.621 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 1035244
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1565842628479004
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 2.027 Vali Acc: 0.219 Test Loss: 2.027 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 1.229006052017212
Epoch: 2, Steps: 8 | Train Loss: 2.030 Vali Loss: 1.868 Vali Acc: 0.359 Test Loss: 1.868 Test Acc: 0.359
Validation loss decreased (-0.218730 --> -0.359356).  Saving model ...
Epoch: 3 cost time: 1.1981053352355957
Epoch: 3, Steps: 8 | Train Loss: 1.827 Vali Loss: 1.645 Vali Acc: 0.634 Test Loss: 1.645 Test Acc: 0.634
Validation loss decreased (-0.359356 --> -0.634359).  Saving model ...
Epoch: 4 cost time: 1.2581024169921875
Epoch: 4, Steps: 8 | Train Loss: 1.605 Vali Loss: 1.380 Vali Acc: 0.791 Test Loss: 1.380 Test Acc: 0.791
Validation loss decreased (-0.634359 --> -0.790611).  Saving model ...
Epoch: 5 cost time: 1.1743495464324951
Epoch: 5, Steps: 8 | Train Loss: 1.336 Vali Loss: 1.095 Vali Acc: 0.744 Test Loss: 1.095 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3513720035552979
Epoch: 6, Steps: 8 | Train Loss: 1.006 Vali Loss: 0.857 Vali Acc: 0.775 Test Loss: 0.857 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1587417125701904
Epoch: 7, Steps: 8 | Train Loss: 0.726 Vali Loss: 0.680 Vali Acc: 0.831 Test Loss: 0.680 Test Acc: 0.831
Validation loss decreased (-0.790611 --> -0.831243).  Saving model ...
Epoch: 8 cost time: 1.2566516399383545
Epoch: 8, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.609 Vali Acc: 0.809 Test Loss: 0.609 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1237916946411133
Epoch: 9, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
Validation loss decreased (-0.831243 --> -0.837494).  Saving model ...
Epoch: 10 cost time: 1.4286770820617676
Epoch: 10, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843744).  Saving model ...
Epoch: 11 cost time: 1.1709771156311035
Epoch: 11, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2437043190002441
Epoch: 12, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.544 Vali Acc: 0.834 Test Loss: 0.544 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.060326337814331
Epoch: 13, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4230332374572754
Epoch: 14, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.546 Vali Acc: 0.847 Test Loss: 0.546 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 1.4969346523284912
Epoch: 15, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.551 Vali Acc: 0.838 Test Loss: 0.551 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2538514137268066
Epoch: 16, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0991158485412598
Epoch: 17, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0421454906463623
Epoch: 18, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.572 Vali Acc: 0.841 Test Loss: 0.572 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3406670093536377
Epoch: 19, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.256972312927246
Epoch: 20, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2330236434936523
Epoch: 21, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.585 Vali Acc: 0.838 Test Loss: 0.585 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5451383590698242
Epoch: 22, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.602 Vali Acc: 0.838 Test Loss: 0.602 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4270823001861572
Epoch: 23, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2769486904144287
Epoch: 24, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 1032620
model size : 5.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1918187141418457
Epoch: 1, Steps: 8 | Train Loss: 2.155 Vali Loss: 2.061 Vali Acc: 0.241 Test Loss: 2.061 Test Acc: 0.241
Validation loss decreased (inf --> -0.240604).  Saving model ...
Epoch: 2 cost time: 1.018531084060669
Epoch: 2, Steps: 8 | Train Loss: 2.064 Vali Loss: 1.914 Vali Acc: 0.344 Test Loss: 1.914 Test Acc: 0.344
Validation loss decreased (-0.240604 --> -0.343731).  Saving model ...
Epoch: 3 cost time: 1.0940234661102295
Epoch: 3, Steps: 8 | Train Loss: 1.867 Vali Loss: 1.696 Vali Acc: 0.550 Test Loss: 1.696 Test Acc: 0.550
Validation loss decreased (-0.343731 --> -0.549983).  Saving model ...
Epoch: 4 cost time: 1.0594165325164795
Epoch: 4, Steps: 8 | Train Loss: 1.602 Vali Loss: 1.424 Vali Acc: 0.694 Test Loss: 1.424 Test Acc: 0.694
Validation loss decreased (-0.549983 --> -0.693736).  Saving model ...
Epoch: 5 cost time: 1.1794850826263428
Epoch: 5, Steps: 8 | Train Loss: 1.232 Vali Loss: 1.101 Vali Acc: 0.800 Test Loss: 1.101 Test Acc: 0.800
Validation loss decreased (-0.693736 --> -0.799989).  Saving model ...
Epoch: 6 cost time: 1.392198085784912
Epoch: 6, Steps: 8 | Train Loss: 0.972 Vali Loss: 0.834 Vali Acc: 0.819 Test Loss: 0.834 Test Acc: 0.819
Validation loss decreased (-0.799989 --> -0.818742).  Saving model ...
Epoch: 7 cost time: 1.4264545440673828
Epoch: 7, Steps: 8 | Train Loss: 0.725 Vali Loss: 0.692 Vali Acc: 0.797 Test Loss: 0.692 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4577431678771973
Epoch: 8, Steps: 8 | Train Loss: 0.536 Vali Loss: 0.603 Vali Acc: 0.838 Test Loss: 0.603 Test Acc: 0.838
Validation loss decreased (-0.818742 --> -0.837494).  Saving model ...
Epoch: 9 cost time: 1.3790700435638428
Epoch: 9, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.583 Vali Acc: 0.812 Test Loss: 0.583 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7694363594055176
Epoch: 10, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.578 Vali Acc: 0.809 Test Loss: 0.578 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4410033226013184
Epoch: 11, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2318356037139893
Epoch: 12, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2612476348876953
Epoch: 13, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.71128249168396
Epoch: 14, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.807926893234253
Epoch: 15, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3550078868865967
Epoch: 16, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2190139293670654
Epoch: 17, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.374830722808838
Epoch: 18, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.584 Vali Acc: 0.825 Test Loss: 0.584 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 1029996
model size : 5.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9655535221099854
Epoch: 1, Steps: 8 | Train Loss: 2.160 Vali Loss: 2.061 Vali Acc: 0.200 Test Loss: 2.061 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 1.40138840675354
Epoch: 2, Steps: 8 | Train Loss: 2.060 Vali Loss: 1.938 Vali Acc: 0.231 Test Loss: 1.938 Test Acc: 0.231
Validation loss decreased (-0.199979 --> -0.231231).  Saving model ...
Epoch: 3 cost time: 1.4066383838653564
Epoch: 3, Steps: 8 | Train Loss: 1.924 Vali Loss: 1.745 Vali Acc: 0.547 Test Loss: 1.745 Test Acc: 0.547
Validation loss decreased (-0.231231 --> -0.546858).  Saving model ...
Epoch: 4 cost time: 1.3241329193115234
Epoch: 4, Steps: 8 | Train Loss: 1.708 Vali Loss: 1.531 Vali Acc: 0.672 Test Loss: 1.531 Test Acc: 0.672
Validation loss decreased (-0.546858 --> -0.671860).  Saving model ...
Epoch: 5 cost time: 1.4309453964233398
Epoch: 5, Steps: 8 | Train Loss: 1.414 Vali Loss: 1.257 Vali Acc: 0.794 Test Loss: 1.257 Test Acc: 0.794
Validation loss decreased (-0.671860 --> -0.793737).  Saving model ...
Epoch: 6 cost time: 1.4286587238311768
Epoch: 6, Steps: 8 | Train Loss: 1.150 Vali Loss: 0.993 Vali Acc: 0.753 Test Loss: 0.993 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3800315856933594
Epoch: 7, Steps: 8 | Train Loss: 0.851 Vali Loss: 0.749 Vali Acc: 0.822 Test Loss: 0.749 Test Acc: 0.822
Validation loss decreased (-0.793737 --> -0.821868).  Saving model ...
Epoch: 8 cost time: 1.7392854690551758
Epoch: 8, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
Validation loss decreased (-0.821868 --> -0.856244).  Saving model ...
Epoch: 9 cost time: 1.663583517074585
Epoch: 9, Steps: 8 | Train Loss: 0.482 Vali Loss: 0.568 Vali Acc: 0.812 Test Loss: 0.568 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5113472938537598
Epoch: 10, Steps: 8 | Train Loss: 0.395 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7917866706848145
Epoch: 11, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3092894554138184
Epoch: 12, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.521 Vali Acc: 0.834 Test Loss: 0.521 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.507323980331421
Epoch: 13, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.312958002090454
Epoch: 14, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.177293062210083
Epoch: 15, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.533233880996704
Epoch: 16, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6513242721557617
Epoch: 17, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4909491539001465
Epoch: 18, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.565 Vali Acc: 0.834 Test Loss: 0.565 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 707628
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5331461429595947
Epoch: 1, Steps: 8 | Train Loss: 2.144 Vali Loss: 2.000 Vali Acc: 0.225 Test Loss: 2.000 Test Acc: 0.225
Validation loss decreased (inf --> -0.224980).  Saving model ...
Epoch: 2 cost time: 1.4445765018463135
Epoch: 2, Steps: 8 | Train Loss: 2.027 Vali Loss: 1.863 Vali Acc: 0.469 Test Loss: 1.863 Test Acc: 0.469
Validation loss decreased (-0.224980 --> -0.468731).  Saving model ...
Epoch: 3 cost time: 1.1062476634979248
Epoch: 3, Steps: 8 | Train Loss: 1.832 Vali Loss: 1.701 Vali Acc: 0.509 Test Loss: 1.701 Test Acc: 0.509
Validation loss decreased (-0.468731 --> -0.509358).  Saving model ...
Epoch: 4 cost time: 1.2117676734924316
Epoch: 4, Steps: 8 | Train Loss: 1.643 Vali Loss: 1.468 Vali Acc: 0.725 Test Loss: 1.468 Test Acc: 0.725
Validation loss decreased (-0.509358 --> -0.724985).  Saving model ...
Epoch: 5 cost time: 1.1558036804199219
Epoch: 5, Steps: 8 | Train Loss: 1.369 Vali Loss: 1.209 Vali Acc: 0.775 Test Loss: 1.209 Test Acc: 0.775
Validation loss decreased (-0.724985 --> -0.774988).  Saving model ...
Epoch: 6 cost time: 1.3071563243865967
Epoch: 6, Steps: 8 | Train Loss: 1.096 Vali Loss: 0.950 Vali Acc: 0.781 Test Loss: 0.950 Test Acc: 0.781
Validation loss decreased (-0.774988 --> -0.781241).  Saving model ...
Epoch: 7 cost time: 1.167562484741211
Epoch: 7, Steps: 8 | Train Loss: 0.785 Vali Loss: 0.736 Vali Acc: 0.816 Test Loss: 0.736 Test Acc: 0.816
Validation loss decreased (-0.781241 --> -0.815618).  Saving model ...
Epoch: 8 cost time: 1.1315650939941406
Epoch: 8, Steps: 8 | Train Loss: 0.690 Vali Loss: 0.649 Vali Acc: 0.803 Test Loss: 0.649 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2205321788787842
Epoch: 9, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
Validation loss decreased (-0.815618 --> -0.843744).  Saving model ...
Epoch: 10 cost time: 1.0526692867279053
Epoch: 10, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2613389492034912
Epoch: 11, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5703368186950684
Epoch: 12, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1936843395233154
Epoch: 13, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 14 cost time: 1.752467155456543
Epoch: 14, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.553377628326416
Epoch: 15, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.36916184425354
Epoch: 16, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7484986782073975
Epoch: 17, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2902822494506836
Epoch: 18, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.554 Vali Acc: 0.847 Test Loss: 0.554 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3745667934417725
Epoch: 19, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.556 Vali Acc: 0.859 Test Loss: 0.556 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859369).  Saving model ...
Epoch: 20 cost time: 1.1889407634735107
Epoch: 20, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3351836204528809
Epoch: 21, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.547537088394165
Epoch: 22, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.590 Vali Acc: 0.847 Test Loss: 0.590 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.129042625427246
Epoch: 23, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.590 Vali Acc: 0.847 Test Loss: 0.590 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3065965175628662
Epoch: 24, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.599 Vali Acc: 0.841 Test Loss: 0.599 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0091962814331055
Epoch: 25, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.612 Vali Acc: 0.844 Test Loss: 0.612 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1175549030303955
Epoch: 26, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.610 Vali Acc: 0.838 Test Loss: 0.610 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1310350894927979
Epoch: 27, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.604 Vali Acc: 0.847 Test Loss: 0.604 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0769822597503662
Epoch: 28, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5469887256622314
Epoch: 29, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.611 Vali Acc: 0.847 Test Loss: 0.611 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 705004
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.074833869934082
Epoch: 1, Steps: 8 | Train Loss: 2.282 Vali Loss: 2.116 Vali Acc: 0.147 Test Loss: 2.116 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 1.0740845203399658
Epoch: 2, Steps: 8 | Train Loss: 2.119 Vali Loss: 1.952 Vali Acc: 0.231 Test Loss: 1.952 Test Acc: 0.231
Validation loss decreased (-0.146854 --> -0.231230).  Saving model ...
Epoch: 3 cost time: 1.2170689105987549
Epoch: 3, Steps: 8 | Train Loss: 1.992 Vali Loss: 1.808 Vali Acc: 0.366 Test Loss: 1.808 Test Acc: 0.366
Validation loss decreased (-0.231230 --> -0.365607).  Saving model ...
Epoch: 4 cost time: 1.272618055343628
Epoch: 4, Steps: 8 | Train Loss: 1.735 Vali Loss: 1.554 Vali Acc: 0.603 Test Loss: 1.554 Test Acc: 0.603
Validation loss decreased (-0.365607 --> -0.603109).  Saving model ...
Epoch: 5 cost time: 1.3009719848632812
Epoch: 5, Steps: 8 | Train Loss: 1.437 Vali Loss: 1.275 Vali Acc: 0.716 Test Loss: 1.275 Test Acc: 0.716
Validation loss decreased (-0.603109 --> -0.715612).  Saving model ...
Epoch: 6 cost time: 1.124828815460205
Epoch: 6, Steps: 8 | Train Loss: 1.144 Vali Loss: 0.977 Vali Acc: 0.791 Test Loss: 0.977 Test Acc: 0.791
Validation loss decreased (-0.715612 --> -0.790615).  Saving model ...
Epoch: 7 cost time: 1.1738135814666748
Epoch: 7, Steps: 8 | Train Loss: 0.858 Vali Loss: 0.761 Vali Acc: 0.812 Test Loss: 0.761 Test Acc: 0.812
Validation loss decreased (-0.790615 --> -0.812492).  Saving model ...
Epoch: 8 cost time: 0.9860091209411621
Epoch: 8, Steps: 8 | Train Loss: 0.653 Vali Loss: 0.639 Vali Acc: 0.838 Test Loss: 0.639 Test Acc: 0.838
Validation loss decreased (-0.812492 --> -0.837494).  Saving model ...
Epoch: 9 cost time: 1.0866429805755615
Epoch: 9, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.592 Vali Acc: 0.819 Test Loss: 0.592 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1428742408752441
Epoch: 10, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.061854362487793
Epoch: 11, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.259068489074707
Epoch: 12, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.112393856048584
Epoch: 13, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (-0.837494 --> -0.843745).  Saving model ...
Epoch: 14 cost time: 1.2192015647888184
Epoch: 14, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.176074743270874
Epoch: 15, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.550 Vali Acc: 0.834 Test Loss: 0.550 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.014392614364624
Epoch: 16, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1290628910064697
Epoch: 17, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.1581048965454102
Epoch: 18, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.569 Vali Acc: 0.831 Test Loss: 0.569 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1648342609405518
Epoch: 19, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.576 Vali Acc: 0.838 Test Loss: 0.576 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.140213966369629
Epoch: 20, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.567 Vali Acc: 0.847 Test Loss: 0.567 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.17732834815979
Epoch: 21, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.570 Vali Acc: 0.853 Test Loss: 0.570 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853119).  Saving model ...
Epoch: 22 cost time: 1.2029101848602295
Epoch: 22, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.595 Vali Acc: 0.841 Test Loss: 0.595 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1942253112792969
Epoch: 23, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.603 Vali Acc: 0.844 Test Loss: 0.603 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.059948205947876
Epoch: 24, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3908889293670654
Epoch: 25, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.607 Vali Acc: 0.841 Test Loss: 0.607 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1763231754302979
Epoch: 26, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.620 Vali Acc: 0.841 Test Loss: 0.620 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1931705474853516
Epoch: 27, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.619 Vali Acc: 0.847 Test Loss: 0.619 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1038236618041992
Epoch: 28, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.618 Vali Acc: 0.847 Test Loss: 0.618 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0340559482574463
Epoch: 29, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.630 Vali Acc: 0.838 Test Loss: 0.630 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1751148700714111
Epoch: 30, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.639 Vali Acc: 0.841 Test Loss: 0.639 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6242091655731201
Epoch: 31, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 702380
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8773837089538574
Epoch: 1, Steps: 8 | Train Loss: 2.278 Vali Loss: 2.157 Vali Acc: 0.147 Test Loss: 2.157 Test Acc: 0.147
Validation loss decreased (inf --> -0.146853).  Saving model ...
Epoch: 2 cost time: 1.0523719787597656
Epoch: 2, Steps: 8 | Train Loss: 2.137 Vali Loss: 2.022 Vali Acc: 0.194 Test Loss: 2.022 Test Acc: 0.194
Validation loss decreased (-0.146853 --> -0.193730).  Saving model ...
Epoch: 3 cost time: 1.2303681373596191
Epoch: 3, Steps: 8 | Train Loss: 1.966 Vali Loss: 1.855 Vali Acc: 0.416 Test Loss: 1.855 Test Acc: 0.416
Validation loss decreased (-0.193730 --> -0.415606).  Saving model ...
Epoch: 4 cost time: 1.4877684116363525
Epoch: 4, Steps: 8 | Train Loss: 1.817 Vali Loss: 1.651 Vali Acc: 0.644 Test Loss: 1.651 Test Acc: 0.644
Validation loss decreased (-0.415606 --> -0.643733).  Saving model ...
Epoch: 5 cost time: 1.0445966720581055
Epoch: 5, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.390 Vali Acc: 0.753 Test Loss: 1.390 Test Acc: 0.753
Validation loss decreased (-0.643733 --> -0.753111).  Saving model ...
Epoch: 6 cost time: 1.272252082824707
Epoch: 6, Steps: 8 | Train Loss: 1.248 Vali Loss: 1.089 Vali Acc: 0.778 Test Loss: 1.089 Test Acc: 0.778
Validation loss decreased (-0.753111 --> -0.778114).  Saving model ...
Epoch: 7 cost time: 1.1363046169281006
Epoch: 7, Steps: 8 | Train Loss: 0.880 Vali Loss: 0.843 Vali Acc: 0.794 Test Loss: 0.843 Test Acc: 0.794
Validation loss decreased (-0.778114 --> -0.793742).  Saving model ...
Epoch: 8 cost time: 1.225724458694458
Epoch: 8, Steps: 8 | Train Loss: 0.685 Vali Loss: 0.681 Vali Acc: 0.822 Test Loss: 0.681 Test Acc: 0.822
Validation loss decreased (-0.793742 --> -0.821868).  Saving model ...
Epoch: 9 cost time: 1.145435094833374
Epoch: 9, Steps: 8 | Train Loss: 0.527 Vali Loss: 0.614 Vali Acc: 0.825 Test Loss: 0.614 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 0.9643197059631348
Epoch: 10, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.564 Vali Acc: 0.831 Test Loss: 0.564 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 11 cost time: 1.1434011459350586
Epoch: 11, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3153021335601807
Epoch: 12, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.583 Vali Acc: 0.812 Test Loss: 0.583 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2751781940460205
Epoch: 13, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2925951480865479
Epoch: 14, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0854277610778809
Epoch: 15, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.553 Vali Acc: 0.831 Test Loss: 0.553 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 1.218907356262207
Epoch: 16, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2937915325164795
Epoch: 17, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3231959342956543
Epoch: 18, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.576 Vali Acc: 0.834 Test Loss: 0.576 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 19 cost time: 1.095505952835083
Epoch: 19, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.573 Vali Acc: 0.838 Test Loss: 0.573 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 20 cost time: 1.1948025226593018
Epoch: 20, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.575 Vali Acc: 0.834 Test Loss: 0.575 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0988373756408691
Epoch: 21, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.581 Vali Acc: 0.841 Test Loss: 0.581 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 22 cost time: 1.2137889862060547
Epoch: 22, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 23 cost time: 1.1873538494110107
Epoch: 23, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.609 Vali Acc: 0.838 Test Loss: 0.609 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4887733459472656
Epoch: 24, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.613 Vali Acc: 0.838 Test Loss: 0.613 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4648876190185547
Epoch: 25, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.616 Vali Acc: 0.834 Test Loss: 0.616 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3169095516204834
Epoch: 26, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.620 Vali Acc: 0.831 Test Loss: 0.620 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.558394193649292
Epoch: 27, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.625 Vali Acc: 0.834 Test Loss: 0.625 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2504267692565918
Epoch: 28, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.630 Vali Acc: 0.831 Test Loss: 0.630 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4748456478118896
Epoch: 29, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.636 Vali Acc: 0.828 Test Loss: 0.636 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3502323627471924
Epoch: 30, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.646 Vali Acc: 0.831 Test Loss: 0.646 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.49422025680542
Epoch: 31, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.646 Vali Acc: 0.828 Test Loss: 0.646 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.692173957824707
Epoch: 32, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.651 Vali Acc: 0.831 Test Loss: 0.651 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 699756
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.113454341888428
Epoch: 1, Steps: 8 | Train Loss: 2.203 Vali Loss: 2.071 Vali Acc: 0.147 Test Loss: 2.071 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 1.1728615760803223
Epoch: 2, Steps: 8 | Train Loss: 2.010 Vali Loss: 1.935 Vali Acc: 0.422 Test Loss: 1.935 Test Acc: 0.422
Validation loss decreased (-0.146854 --> -0.421856).  Saving model ...
Epoch: 3 cost time: 1.1146278381347656
Epoch: 3, Steps: 8 | Train Loss: 1.915 Vali Loss: 1.777 Vali Acc: 0.487 Test Loss: 1.777 Test Acc: 0.487
Validation loss decreased (-0.421856 --> -0.487482).  Saving model ...
Epoch: 4 cost time: 1.2956442832946777
Epoch: 4, Steps: 8 | Train Loss: 1.703 Vali Loss: 1.569 Vali Acc: 0.678 Test Loss: 1.569 Test Acc: 0.678
Validation loss decreased (-0.487482 --> -0.678109).  Saving model ...
Epoch: 5 cost time: 1.3627533912658691
Epoch: 5, Steps: 8 | Train Loss: 1.464 Vali Loss: 1.327 Vali Acc: 0.719 Test Loss: 1.327 Test Acc: 0.719
Validation loss decreased (-0.678109 --> -0.718737).  Saving model ...
Epoch: 6 cost time: 1.4945273399353027
Epoch: 6, Steps: 8 | Train Loss: 1.195 Vali Loss: 1.071 Vali Acc: 0.772 Test Loss: 1.071 Test Acc: 0.772
Validation loss decreased (-0.718737 --> -0.771864).  Saving model ...
Epoch: 7 cost time: 1.3723177909851074
Epoch: 7, Steps: 8 | Train Loss: 0.916 Vali Loss: 0.826 Vali Acc: 0.797 Test Loss: 0.826 Test Acc: 0.797
Validation loss decreased (-0.771864 --> -0.796867).  Saving model ...
Epoch: 8 cost time: 1.3872566223144531
Epoch: 8, Steps: 8 | Train Loss: 0.713 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
Validation loss decreased (-0.796867 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 1.6133794784545898
Epoch: 9, Steps: 8 | Train Loss: 0.529 Vali Loss: 0.611 Vali Acc: 0.806 Test Loss: 0.611 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.806244).  Saving model ...
Epoch: 10 cost time: 1.2780888080596924
Epoch: 10, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.571 Vali Acc: 0.812 Test Loss: 0.571 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812494).  Saving model ...
Epoch: 11 cost time: 1.4122328758239746
Epoch: 11, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 12 cost time: 1.1999106407165527
Epoch: 12, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
Validation loss decreased (-0.812494 --> -0.828120).  Saving model ...
Epoch: 13 cost time: 1.0057241916656494
Epoch: 13, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2219960689544678
Epoch: 14, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0656523704528809
Epoch: 15, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.539 Vali Acc: 0.812 Test Loss: 0.539 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1526210308074951
Epoch: 16, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.547 Vali Acc: 0.812 Test Loss: 0.547 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0931732654571533
Epoch: 17, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.150784969329834
Epoch: 18, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6654560565948486
Epoch: 19, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3191332817077637
Epoch: 20, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.567 Vali Acc: 0.816 Test Loss: 0.567 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5894582271575928
Epoch: 21, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1936676502227783
Epoch: 22, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.603 Vali Acc: 0.816 Test Loss: 0.603 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 542508
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 4.107840299606323
Epoch: 1, Steps: 8 | Train Loss: 2.098 Vali Loss: 2.006 Vali Acc: 0.259 Test Loss: 2.006 Test Acc: 0.259
Validation loss decreased (inf --> -0.259355).  Saving model ...
Epoch: 2 cost time: 1.2345812320709229
Epoch: 2, Steps: 8 | Train Loss: 2.003 Vali Loss: 1.865 Vali Acc: 0.409 Test Loss: 1.865 Test Acc: 0.409
Validation loss decreased (-0.259355 --> -0.409356).  Saving model ...
Epoch: 3 cost time: 1.1189136505126953
Epoch: 3, Steps: 8 | Train Loss: 1.818 Vali Loss: 1.697 Vali Acc: 0.559 Test Loss: 1.697 Test Acc: 0.559
Validation loss decreased (-0.409356 --> -0.559358).  Saving model ...
Epoch: 4 cost time: 1.405996322631836
Epoch: 4, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.460 Vali Acc: 0.709 Test Loss: 1.460 Test Acc: 0.709
Validation loss decreased (-0.559358 --> -0.709360).  Saving model ...
Epoch: 5 cost time: 1.45725417137146
Epoch: 5, Steps: 8 | Train Loss: 1.341 Vali Loss: 1.223 Vali Acc: 0.741 Test Loss: 1.223 Test Acc: 0.741
Validation loss decreased (-0.709360 --> -0.740613).  Saving model ...
Epoch: 6 cost time: 1.3413736820220947
Epoch: 6, Steps: 8 | Train Loss: 1.096 Vali Loss: 0.990 Vali Acc: 0.759 Test Loss: 0.990 Test Acc: 0.759
Validation loss decreased (-0.740613 --> -0.759365).  Saving model ...
Epoch: 7 cost time: 1.1965503692626953
Epoch: 7, Steps: 8 | Train Loss: 0.804 Vali Loss: 0.799 Vali Acc: 0.794 Test Loss: 0.799 Test Acc: 0.794
Validation loss decreased (-0.759365 --> -0.793742).  Saving model ...
Epoch: 8 cost time: 1.3710877895355225
Epoch: 8, Steps: 8 | Train Loss: 0.636 Vali Loss: 0.669 Vali Acc: 0.825 Test Loss: 0.669 Test Acc: 0.825
Validation loss decreased (-0.793742 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 1.495528221130371
Epoch: 9, Steps: 8 | Train Loss: 0.481 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2896008491516113
Epoch: 10, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828119).  Saving model ...
Epoch: 11 cost time: 1.478285551071167
Epoch: 11, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 12 cost time: 1.3499131202697754
Epoch: 12, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 13 cost time: 1.3713912963867188
Epoch: 13, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 14 cost time: 1.1642296314239502
Epoch: 14, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4284777641296387
Epoch: 15, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.513577938079834
Epoch: 16, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 17 cost time: 1.1735148429870605
Epoch: 17, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.559 Vali Acc: 0.831 Test Loss: 0.559 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1082508563995361
Epoch: 18, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.573 Vali Acc: 0.838 Test Loss: 0.573 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837494).  Saving model ...
Epoch: 19 cost time: 1.1478734016418457
Epoch: 19, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.593 Vali Acc: 0.834 Test Loss: 0.593 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2385921478271484
Epoch: 20, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.598 Vali Acc: 0.841 Test Loss: 0.598 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840619).  Saving model ...
Epoch: 21 cost time: 1.1990821361541748
Epoch: 21, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.616 Vali Acc: 0.838 Test Loss: 0.616 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4130489826202393
Epoch: 22, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.611 Vali Acc: 0.841 Test Loss: 0.611 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0843231678009033
Epoch: 23, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 1.1288142204284668
Epoch: 24, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.610 Vali Acc: 0.841 Test Loss: 0.610 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2015471458435059
Epoch: 25, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.614 Vali Acc: 0.838 Test Loss: 0.614 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.396522045135498
Epoch: 26, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.623 Vali Acc: 0.841 Test Loss: 0.623 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2062513828277588
Epoch: 27, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.628 Vali Acc: 0.844 Test Loss: 0.628 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3588104248046875
Epoch: 28, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.635 Vali Acc: 0.847 Test Loss: 0.635 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3112945556640625
Epoch: 29, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.642 Vali Acc: 0.838 Test Loss: 0.642 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3606321811676025
Epoch: 30, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.656 Vali Acc: 0.831 Test Loss: 0.656 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2851147651672363
Epoch: 31, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.666 Vali Acc: 0.834 Test Loss: 0.666 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.5674402713775635
Epoch: 32, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.671 Vali Acc: 0.838 Test Loss: 0.671 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.38675856590271
Epoch: 33, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.664 Vali Acc: 0.838 Test Loss: 0.664 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 539884
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5949082374572754
Epoch: 1, Steps: 8 | Train Loss: 2.186 Vali Loss: 2.082 Vali Acc: 0.141 Test Loss: 2.082 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 1.1270384788513184
Epoch: 2, Steps: 8 | Train Loss: 2.051 Vali Loss: 1.968 Vali Acc: 0.222 Test Loss: 1.968 Test Acc: 0.222
Validation loss decreased (-0.140604 --> -0.221855).  Saving model ...
Epoch: 3 cost time: 1.1808111667633057
Epoch: 3, Steps: 8 | Train Loss: 1.974 Vali Loss: 1.830 Vali Acc: 0.441 Test Loss: 1.830 Test Acc: 0.441
Validation loss decreased (-0.221855 --> -0.440607).  Saving model ...
Epoch: 4 cost time: 1.1098785400390625
Epoch: 4, Steps: 8 | Train Loss: 1.786 Vali Loss: 1.636 Vali Acc: 0.634 Test Loss: 1.636 Test Acc: 0.634
Validation loss decreased (-0.440607 --> -0.634359).  Saving model ...
Epoch: 5 cost time: 1.2899210453033447
Epoch: 5, Steps: 8 | Train Loss: 1.590 Vali Loss: 1.414 Vali Acc: 0.725 Test Loss: 1.414 Test Acc: 0.725
Validation loss decreased (-0.634359 --> -0.724986).  Saving model ...
Epoch: 6 cost time: 1.1633868217468262
Epoch: 6, Steps: 8 | Train Loss: 1.331 Vali Loss: 1.189 Vali Acc: 0.772 Test Loss: 1.189 Test Acc: 0.772
Validation loss decreased (-0.724986 --> -0.771863).  Saving model ...
Epoch: 7 cost time: 1.5140290260314941
Epoch: 7, Steps: 8 | Train Loss: 1.046 Vali Loss: 0.936 Vali Acc: 0.800 Test Loss: 0.936 Test Acc: 0.800
Validation loss decreased (-0.771863 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 1.2970051765441895
Epoch: 8, Steps: 8 | Train Loss: 0.797 Vali Loss: 0.750 Vali Acc: 0.828 Test Loss: 0.750 Test Acc: 0.828
Validation loss decreased (-0.799991 --> -0.828118).  Saving model ...
Epoch: 9 cost time: 1.3450136184692383
Epoch: 9, Steps: 8 | Train Loss: 0.607 Vali Loss: 0.648 Vali Acc: 0.812 Test Loss: 0.648 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1234350204467773
Epoch: 10, Steps: 8 | Train Loss: 0.521 Vali Loss: 0.587 Vali Acc: 0.825 Test Loss: 0.587 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.445833683013916
Epoch: 11, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.592867136001587
Epoch: 12, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.828118 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 1.5496940612792969
Epoch: 13, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4901554584503174
Epoch: 14, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.554 Vali Acc: 0.819 Test Loss: 0.554 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.076798677444458
Epoch: 15, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0623080730438232
Epoch: 16, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.327749490737915
Epoch: 17, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4151546955108643
Epoch: 18, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.568 Vali Acc: 0.828 Test Loss: 0.568 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.224820613861084
Epoch: 19, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3335850238800049
Epoch: 20, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.591 Vali Acc: 0.816 Test Loss: 0.591 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1181612014770508
Epoch: 21, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1649129390716553
Epoch: 22, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.608 Vali Acc: 0.825 Test Loss: 0.608 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 537260
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2712552547454834
Epoch: 1, Steps: 8 | Train Loss: 2.240 Vali Loss: 2.129 Vali Acc: 0.094 Test Loss: 2.129 Test Acc: 0.094
Validation loss decreased (inf --> -0.093729).  Saving model ...
Epoch: 2 cost time: 1.4606668949127197
Epoch: 2, Steps: 8 | Train Loss: 2.104 Vali Loss: 2.018 Vali Acc: 0.259 Test Loss: 2.018 Test Acc: 0.259
Validation loss decreased (-0.093729 --> -0.259355).  Saving model ...
Epoch: 3 cost time: 1.5676302909851074
Epoch: 3, Steps: 8 | Train Loss: 2.001 Vali Loss: 1.877 Vali Acc: 0.450 Test Loss: 1.877 Test Acc: 0.450
Validation loss decreased (-0.259355 --> -0.449981).  Saving model ...
Epoch: 4 cost time: 1.2804374694824219
Epoch: 4, Steps: 8 | Train Loss: 1.810 Vali Loss: 1.692 Vali Acc: 0.672 Test Loss: 1.692 Test Acc: 0.672
Validation loss decreased (-0.449981 --> -0.671858).  Saving model ...
Epoch: 5 cost time: 1.1639604568481445
Epoch: 5, Steps: 8 | Train Loss: 1.572 Vali Loss: 1.471 Vali Acc: 0.734 Test Loss: 1.471 Test Acc: 0.734
Validation loss decreased (-0.671858 --> -0.734360).  Saving model ...
Epoch: 6 cost time: 1.321256399154663
Epoch: 6, Steps: 8 | Train Loss: 1.373 Vali Loss: 1.210 Vali Acc: 0.769 Test Loss: 1.210 Test Acc: 0.769
Validation loss decreased (-0.734360 --> -0.768738).  Saving model ...
Epoch: 7 cost time: 1.2566375732421875
Epoch: 7, Steps: 8 | Train Loss: 1.062 Vali Loss: 0.942 Vali Acc: 0.797 Test Loss: 0.942 Test Acc: 0.797
Validation loss decreased (-0.768738 --> -0.796866).  Saving model ...
Epoch: 8 cost time: 1.3254954814910889
Epoch: 8, Steps: 8 | Train Loss: 0.800 Vali Loss: 0.761 Vali Acc: 0.800 Test Loss: 0.761 Test Acc: 0.800
Validation loss decreased (-0.796866 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 1.45432710647583
Epoch: 9, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809369).  Saving model ...
Epoch: 10 cost time: 1.2437140941619873
Epoch: 10, Steps: 8 | Train Loss: 0.485 Vali Loss: 0.568 Vali Acc: 0.828 Test Loss: 0.568 Test Acc: 0.828
Validation loss decreased (-0.809369 --> -0.828119).  Saving model ...
Epoch: 11 cost time: 1.1163458824157715
Epoch: 11, Steps: 8 | Train Loss: 0.388 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5017194747924805
Epoch: 12, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.540 Vali Acc: 0.819 Test Loss: 0.540 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0219030380249023
Epoch: 13, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
Validation loss decreased (-0.828119 --> -0.853120).  Saving model ...
Epoch: 14 cost time: 1.5616650581359863
Epoch: 14, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4095945358276367
Epoch: 15, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3957297801971436
Epoch: 16, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3381142616271973
Epoch: 17, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4055490493774414
Epoch: 18, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3224613666534424
Epoch: 19, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.544 Vali Acc: 0.831 Test Loss: 0.544 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3881640434265137
Epoch: 20, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4233195781707764
Epoch: 21, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.398139238357544
Epoch: 22, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6868526935577393
Epoch: 23, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.575 Vali Acc: 0.831 Test Loss: 0.575 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 534636
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2935380935668945
Epoch: 1, Steps: 8 | Train Loss: 2.141 Vali Loss: 2.028 Vali Acc: 0.128 Test Loss: 2.028 Test Acc: 0.128
Validation loss decreased (inf --> -0.128105).  Saving model ...
Epoch: 2 cost time: 1.4154877662658691
Epoch: 2, Steps: 8 | Train Loss: 2.019 Vali Loss: 1.894 Vali Acc: 0.312 Test Loss: 1.894 Test Acc: 0.312
Validation loss decreased (-0.128105 --> -0.312481).  Saving model ...
Epoch: 3 cost time: 1.0486209392547607
Epoch: 3, Steps: 8 | Train Loss: 1.864 Vali Loss: 1.711 Vali Acc: 0.534 Test Loss: 1.711 Test Acc: 0.534
Validation loss decreased (-0.312481 --> -0.534358).  Saving model ...
Epoch: 4 cost time: 1.0023095607757568
Epoch: 4, Steps: 8 | Train Loss: 1.646 Vali Loss: 1.494 Vali Acc: 0.750 Test Loss: 1.494 Test Acc: 0.750
Validation loss decreased (-0.534358 --> -0.749985).  Saving model ...
Epoch: 5 cost time: 1.1818509101867676
Epoch: 5, Steps: 8 | Train Loss: 1.396 Vali Loss: 1.268 Vali Acc: 0.775 Test Loss: 1.268 Test Acc: 0.775
Validation loss decreased (-0.749985 --> -0.774987).  Saving model ...
Epoch: 6 cost time: 1.1838350296020508
Epoch: 6, Steps: 8 | Train Loss: 1.215 Vali Loss: 1.052 Vali Acc: 0.778 Test Loss: 1.052 Test Acc: 0.778
Validation loss decreased (-0.774987 --> -0.778114).  Saving model ...
Epoch: 7 cost time: 1.3296470642089844
Epoch: 7, Steps: 8 | Train Loss: 0.941 Vali Loss: 0.850 Vali Acc: 0.816 Test Loss: 0.850 Test Acc: 0.816
Validation loss decreased (-0.778114 --> -0.815617).  Saving model ...
Epoch: 8 cost time: 1.0625216960906982
Epoch: 8, Steps: 8 | Train Loss: 0.709 Vali Loss: 0.706 Vali Acc: 0.812 Test Loss: 0.706 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.237234115600586
Epoch: 9, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.621 Vali Acc: 0.819 Test Loss: 0.621 Test Acc: 0.819
Validation loss decreased (-0.815617 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 1.017554759979248
Epoch: 10, Steps: 8 | Train Loss: 0.452 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 1.1235628128051758
Epoch: 11, Steps: 8 | Train Loss: 0.407 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 1.4123327732086182
Epoch: 12, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.569 Vali Acc: 0.812 Test Loss: 0.569 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4748189449310303
Epoch: 13, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831244).  Saving model ...
Epoch: 14 cost time: 1.0328590869903564
Epoch: 14, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.555 Vali Acc: 0.828 Test Loss: 0.555 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.017085075378418
Epoch: 15, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.580 Vali Acc: 0.825 Test Loss: 0.580 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1493480205535889
Epoch: 16, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.560 Vali Acc: 0.831 Test Loss: 0.560 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.344982624053955
Epoch: 17, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840619).  Saving model ...
Epoch: 18 cost time: 1.143589735031128
Epoch: 18, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.567 Vali Acc: 0.834 Test Loss: 0.567 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5364177227020264
Epoch: 19, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.585 Vali Acc: 0.828 Test Loss: 0.585 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4012868404388428
Epoch: 20, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2627708911895752
Epoch: 21, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.010969877243042
Epoch: 22, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.606 Vali Acc: 0.838 Test Loss: 0.606 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.157588005065918
Epoch: 23, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.606 Vali Acc: 0.834 Test Loss: 0.606 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3403534889221191
Epoch: 24, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.610 Vali Acc: 0.831 Test Loss: 0.610 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.482257604598999
Epoch: 25, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.619 Vali Acc: 0.834 Test Loss: 0.619 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.156984806060791
Epoch: 26, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.632 Vali Acc: 0.834 Test Loss: 0.632 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1008846759796143
Epoch: 27, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.629 Vali Acc: 0.838 Test Loss: 0.629 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 459948
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2429630756378174
Epoch: 1, Steps: 8 | Train Loss: 2.130 Vali Loss: 2.013 Vali Acc: 0.250 Test Loss: 2.013 Test Acc: 0.250
Validation loss decreased (inf --> -0.249980).  Saving model ...
Epoch: 2 cost time: 1.3150112628936768
Epoch: 2, Steps: 8 | Train Loss: 1.994 Vali Loss: 1.881 Vali Acc: 0.322 Test Loss: 1.881 Test Acc: 0.322
Validation loss decreased (-0.249980 --> -0.321856).  Saving model ...
Epoch: 3 cost time: 1.123931884765625
Epoch: 3, Steps: 8 | Train Loss: 1.898 Vali Loss: 1.718 Vali Acc: 0.591 Test Loss: 1.718 Test Acc: 0.591
Validation loss decreased (-0.321856 --> -0.590608).  Saving model ...
Epoch: 4 cost time: 1.5718762874603271
Epoch: 4, Steps: 8 | Train Loss: 1.676 Vali Loss: 1.524 Vali Acc: 0.597 Test Loss: 1.524 Test Acc: 0.597
Validation loss decreased (-0.590608 --> -0.596860).  Saving model ...
Epoch: 5 cost time: 1.0940322875976562
Epoch: 5, Steps: 8 | Train Loss: 1.463 Vali Loss: 1.294 Vali Acc: 0.750 Test Loss: 1.294 Test Acc: 0.750
Validation loss decreased (-0.596860 --> -0.749987).  Saving model ...
Epoch: 6 cost time: 1.131800889968872
Epoch: 6, Steps: 8 | Train Loss: 1.194 Vali Loss: 1.068 Vali Acc: 0.787 Test Loss: 1.068 Test Acc: 0.787
Validation loss decreased (-0.749987 --> -0.787489).  Saving model ...
Epoch: 7 cost time: 1.2940771579742432
Epoch: 7, Steps: 8 | Train Loss: 0.971 Vali Loss: 0.867 Vali Acc: 0.787 Test Loss: 0.867 Test Acc: 0.787
Validation loss decreased (-0.787489 --> -0.787491).  Saving model ...
Epoch: 8 cost time: 1.1565158367156982
Epoch: 8, Steps: 8 | Train Loss: 0.762 Vali Loss: 0.711 Vali Acc: 0.803 Test Loss: 0.711 Test Acc: 0.803
Validation loss decreased (-0.787491 --> -0.803118).  Saving model ...
Epoch: 9 cost time: 1.2795050144195557
Epoch: 9, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.622 Vali Acc: 0.803 Test Loss: 0.622 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803119).  Saving model ...
Epoch: 10 cost time: 1.2816197872161865
Epoch: 10, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.556 Vali Acc: 0.853 Test Loss: 0.556 Test Acc: 0.853
Validation loss decreased (-0.803119 --> -0.853119).  Saving model ...
Epoch: 11 cost time: 1.2789173126220703
Epoch: 11, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1213607788085938
Epoch: 12, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4090540409088135
Epoch: 13, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1319234371185303
Epoch: 14, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.451059103012085
Epoch: 15, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1295297145843506
Epoch: 16, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1931018829345703
Epoch: 17, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2383334636688232
Epoch: 18, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.565 Vali Acc: 0.831 Test Loss: 0.565 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4500651359558105
Epoch: 19, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0866599082946777
Epoch: 20, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 457324
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4445948600769043
Epoch: 1, Steps: 8 | Train Loss: 2.111 Vali Loss: 1.991 Vali Acc: 0.278 Test Loss: 1.991 Test Acc: 0.278
Validation loss decreased (inf --> -0.278105).  Saving model ...
Epoch: 2 cost time: 1.240591287612915
Epoch: 2, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.878 Vali Acc: 0.369 Test Loss: 1.878 Test Acc: 0.369
Validation loss decreased (-0.278105 --> -0.368731).  Saving model ...
Epoch: 3 cost time: 1.290121078491211
Epoch: 3, Steps: 8 | Train Loss: 1.866 Vali Loss: 1.728 Vali Acc: 0.619 Test Loss: 1.728 Test Acc: 0.619
Validation loss decreased (-0.368731 --> -0.618733).  Saving model ...
Epoch: 4 cost time: 1.1495671272277832
Epoch: 4, Steps: 8 | Train Loss: 1.647 Vali Loss: 1.537 Vali Acc: 0.700 Test Loss: 1.537 Test Acc: 0.700
Validation loss decreased (-0.618733 --> -0.699985).  Saving model ...
Epoch: 5 cost time: 1.417484998703003
Epoch: 5, Steps: 8 | Train Loss: 1.411 Vali Loss: 1.324 Vali Acc: 0.713 Test Loss: 1.324 Test Acc: 0.713
Validation loss decreased (-0.699985 --> -0.712487).  Saving model ...
Epoch: 6 cost time: 1.1856589317321777
Epoch: 6, Steps: 8 | Train Loss: 1.231 Vali Loss: 1.079 Vali Acc: 0.772 Test Loss: 1.079 Test Acc: 0.772
Validation loss decreased (-0.712487 --> -0.771864).  Saving model ...
Epoch: 7 cost time: 1.2064404487609863
Epoch: 7, Steps: 8 | Train Loss: 0.929 Vali Loss: 0.868 Vali Acc: 0.800 Test Loss: 0.868 Test Acc: 0.800
Validation loss decreased (-0.771864 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 1.0397319793701172
Epoch: 8, Steps: 8 | Train Loss: 0.706 Vali Loss: 0.716 Vali Acc: 0.797 Test Loss: 0.716 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1144311428070068
Epoch: 9, Steps: 8 | Train Loss: 0.603 Vali Loss: 0.638 Vali Acc: 0.800 Test Loss: 0.638 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799994).  Saving model ...
Epoch: 10 cost time: 1.4692368507385254
Epoch: 10, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
Validation loss decreased (-0.799994 --> -0.815619).  Saving model ...
Epoch: 11 cost time: 1.2481281757354736
Epoch: 11, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 1.2030253410339355
Epoch: 12, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.575 Vali Acc: 0.806 Test Loss: 0.575 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3661623001098633
Epoch: 13, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3275976181030273
Epoch: 14, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1969659328460693
Epoch: 15, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 16 cost time: 1.0721101760864258
Epoch: 16, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5092401504516602
Epoch: 17, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 18 cost time: 1.218183994293213
Epoch: 18, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834369).  Saving model ...
Epoch: 19 cost time: 1.121701955795288
Epoch: 19, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840619).  Saving model ...
Epoch: 20 cost time: 1.4436898231506348
Epoch: 20, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.567 Vali Acc: 0.841 Test Loss: 0.567 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840619).  Saving model ...
Epoch: 21 cost time: 1.2875468730926514
Epoch: 21, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.577 Vali Acc: 0.841 Test Loss: 0.577 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5349667072296143
Epoch: 22, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.591 Vali Acc: 0.838 Test Loss: 0.591 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3513312339782715
Epoch: 23, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.588 Vali Acc: 0.841 Test Loss: 0.588 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3588545322418213
Epoch: 24, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.598 Vali Acc: 0.834 Test Loss: 0.598 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4558124542236328
Epoch: 25, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.617 Vali Acc: 0.841 Test Loss: 0.617 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4897654056549072
Epoch: 26, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 27 cost time: 1.685899019241333
Epoch: 27, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.611 Vali Acc: 0.838 Test Loss: 0.611 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3415935039520264
Epoch: 28, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.615 Vali Acc: 0.831 Test Loss: 0.615 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5366630554199219
Epoch: 29, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.632 Vali Acc: 0.834 Test Loss: 0.632 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7618956565856934
Epoch: 30, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.631 Vali Acc: 0.838 Test Loss: 0.631 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.1114535331726074
Epoch: 31, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.635 Vali Acc: 0.838 Test Loss: 0.635 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.9163129329681396
Epoch: 32, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.643 Vali Acc: 0.838 Test Loss: 0.643 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.751526117324829
Epoch: 33, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.644 Vali Acc: 0.831 Test Loss: 0.644 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.452599048614502
Epoch: 34, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.647 Vali Acc: 0.834 Test Loss: 0.647 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.736210584640503
Epoch: 35, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.656 Vali Acc: 0.831 Test Loss: 0.656 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.4625518321990967
Epoch: 36, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.663 Vali Acc: 0.831 Test Loss: 0.663 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 454700
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.698044538497925
Epoch: 1, Steps: 8 | Train Loss: 2.109 Vali Loss: 2.032 Vali Acc: 0.175 Test Loss: 2.032 Test Acc: 0.175
Validation loss decreased (inf --> -0.174980).  Saving model ...
Epoch: 2 cost time: 1.3449299335479736
Epoch: 2, Steps: 8 | Train Loss: 2.015 Vali Loss: 1.903 Vali Acc: 0.356 Test Loss: 1.903 Test Acc: 0.356
Validation loss decreased (-0.174980 --> -0.356231).  Saving model ...
Epoch: 3 cost time: 1.1619925498962402
Epoch: 3, Steps: 8 | Train Loss: 1.872 Vali Loss: 1.753 Vali Acc: 0.472 Test Loss: 1.753 Test Acc: 0.472
Validation loss decreased (-0.356231 --> -0.471857).  Saving model ...
Epoch: 4 cost time: 1.217160701751709
Epoch: 4, Steps: 8 | Train Loss: 1.708 Vali Loss: 1.557 Vali Acc: 0.713 Test Loss: 1.557 Test Acc: 0.713
Validation loss decreased (-0.471857 --> -0.712484).  Saving model ...
Epoch: 5 cost time: 1.4729068279266357
Epoch: 5, Steps: 8 | Train Loss: 1.469 Vali Loss: 1.329 Vali Acc: 0.753 Test Loss: 1.329 Test Acc: 0.753
Validation loss decreased (-0.712484 --> -0.753112).  Saving model ...
Epoch: 6 cost time: 1.3143117427825928
Epoch: 6, Steps: 8 | Train Loss: 1.194 Vali Loss: 1.078 Vali Acc: 0.753 Test Loss: 1.078 Test Acc: 0.753
Validation loss decreased (-0.753112 --> -0.753114).  Saving model ...
Epoch: 7 cost time: 1.5756895542144775
Epoch: 7, Steps: 8 | Train Loss: 0.919 Vali Loss: 0.856 Vali Acc: 0.809 Test Loss: 0.856 Test Acc: 0.809
Validation loss decreased (-0.753114 --> -0.809366).  Saving model ...
Epoch: 8 cost time: 1.3390278816223145
Epoch: 8, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.699 Vali Acc: 0.822 Test Loss: 0.699 Test Acc: 0.822
Validation loss decreased (-0.809366 --> -0.821868).  Saving model ...
Epoch: 9 cost time: 1.338083267211914
Epoch: 9, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.609 Vali Acc: 0.819 Test Loss: 0.609 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5829336643218994
Epoch: 10, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
Validation loss decreased (-0.821868 --> -0.828119).  Saving model ...
Epoch: 11 cost time: 1.2153468132019043
Epoch: 11, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.537 Vali Acc: 0.847 Test Loss: 0.537 Test Acc: 0.847
Validation loss decreased (-0.828119 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 1.1162118911743164
Epoch: 12, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0971057415008545
Epoch: 13, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0920732021331787
Epoch: 14, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7027533054351807
Epoch: 15, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.538 Vali Acc: 0.819 Test Loss: 0.538 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.316544771194458
Epoch: 16, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0219333171844482
Epoch: 17, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1835212707519531
Epoch: 18, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.549 Vali Acc: 0.806 Test Loss: 0.549 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.403590440750122
Epoch: 19, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.558 Vali Acc: 0.816 Test Loss: 0.558 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2068281173706055
Epoch: 20, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.556 Vali Acc: 0.812 Test Loss: 0.556 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7033274173736572
Epoch: 21, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 452076
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3558309078216553
Epoch: 1, Steps: 8 | Train Loss: 2.182 Vali Loss: 2.098 Vali Acc: 0.131 Test Loss: 2.098 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 1.472637414932251
Epoch: 2, Steps: 8 | Train Loss: 2.055 Vali Loss: 1.951 Vali Acc: 0.297 Test Loss: 1.951 Test Acc: 0.297
Validation loss decreased (-0.131229 --> -0.296855).  Saving model ...
Epoch: 3 cost time: 1.622636079788208
Epoch: 3, Steps: 8 | Train Loss: 1.946 Vali Loss: 1.828 Vali Acc: 0.491 Test Loss: 1.828 Test Acc: 0.491
Validation loss decreased (-0.296855 --> -0.490607).  Saving model ...
Epoch: 4 cost time: 1.9623637199401855
Epoch: 4, Steps: 8 | Train Loss: 1.770 Vali Loss: 1.657 Vali Acc: 0.650 Test Loss: 1.657 Test Acc: 0.650
Validation loss decreased (-0.490607 --> -0.649983).  Saving model ...
Epoch: 5 cost time: 1.6226167678833008
Epoch: 5, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.454 Vali Acc: 0.681 Test Loss: 1.454 Test Acc: 0.681
Validation loss decreased (-0.649983 --> -0.681235).  Saving model ...
Epoch: 6 cost time: 1.2300968170166016
Epoch: 6, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.226 Vali Acc: 0.759 Test Loss: 1.226 Test Acc: 0.759
Validation loss decreased (-0.681235 --> -0.759363).  Saving model ...
Epoch: 7 cost time: 1.3692071437835693
Epoch: 7, Steps: 8 | Train Loss: 1.136 Vali Loss: 1.004 Vali Acc: 0.784 Test Loss: 1.004 Test Acc: 0.784
Validation loss decreased (-0.759363 --> -0.784365).  Saving model ...
Epoch: 8 cost time: 1.3030853271484375
Epoch: 8, Steps: 8 | Train Loss: 0.886 Vali Loss: 0.838 Vali Acc: 0.803 Test Loss: 0.838 Test Acc: 0.803
Validation loss decreased (-0.784365 --> -0.803117).  Saving model ...
Epoch: 9 cost time: 1.3498551845550537
Epoch: 9, Steps: 8 | Train Loss: 0.713 Vali Loss: 0.719 Vali Acc: 0.803 Test Loss: 0.719 Test Acc: 0.803
Validation loss decreased (-0.803117 --> -0.803118).  Saving model ...
Epoch: 10 cost time: 1.7031784057617188
Epoch: 10, Steps: 8 | Train Loss: 0.644 Vali Loss: 0.646 Vali Acc: 0.803 Test Loss: 0.646 Test Acc: 0.803
Validation loss decreased (-0.803118 --> -0.803119).  Saving model ...
Epoch: 11 cost time: 1.5949456691741943
Epoch: 11, Steps: 8 | Train Loss: 0.473 Vali Loss: 0.601 Vali Acc: 0.812 Test Loss: 0.601 Test Acc: 0.812
Validation loss decreased (-0.803119 --> -0.812494).  Saving model ...
Epoch: 12 cost time: 1.5015850067138672
Epoch: 12, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4143273830413818
Epoch: 13, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.570 Vali Acc: 0.803 Test Loss: 0.570 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4301738739013672
Epoch: 14, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.568 Vali Acc: 0.828 Test Loss: 0.568 Test Acc: 0.828
Validation loss decreased (-0.812494 --> -0.828119).  Saving model ...
Epoch: 15 cost time: 1.3123934268951416
Epoch: 15, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6715664863586426
Epoch: 16, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3044633865356445
Epoch: 17, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5818438529968262
Epoch: 18, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7948048114776611
Epoch: 19, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 20 cost time: 1.46870756149292
Epoch: 20, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 21 cost time: 1.504615306854248
Epoch: 21, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 22 cost time: 1.302217960357666
Epoch: 22, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.546 Vali Acc: 0.834 Test Loss: 0.546 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5397865772247314
Epoch: 23, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.545 Vali Acc: 0.834 Test Loss: 0.545 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6735363006591797
Epoch: 24, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4030349254608154
Epoch: 25, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5265939235687256
Epoch: 26, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.509394884109497
Epoch: 27, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.553 Vali Acc: 0.838 Test Loss: 0.553 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3592276573181152
Epoch: 28, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.543 Vali Acc: 0.841 Test Loss: 0.543 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.522524356842041
Epoch: 29, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2648732662200928
Epoch: 30, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4422507286071777
Epoch: 31, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 439596
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.773395538330078
Epoch: 1, Steps: 8 | Train Loss: 2.171 Vali Loss: 2.075 Vali Acc: 0.153 Test Loss: 2.075 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 1.4769434928894043
Epoch: 2, Steps: 8 | Train Loss: 2.096 Vali Loss: 1.999 Vali Acc: 0.237 Test Loss: 1.999 Test Acc: 0.237
Validation loss decreased (-0.153104 --> -0.237480).  Saving model ...
Epoch: 3 cost time: 1.1521422863006592
Epoch: 3, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.898 Vali Acc: 0.306 Test Loss: 1.898 Test Acc: 0.306
Validation loss decreased (-0.237480 --> -0.306231).  Saving model ...
Epoch: 4 cost time: 1.1644415855407715
Epoch: 4, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.762 Vali Acc: 0.588 Test Loss: 1.762 Test Acc: 0.588
Validation loss decreased (-0.306231 --> -0.587482).  Saving model ...
Epoch: 5 cost time: 1.4787147045135498
Epoch: 5, Steps: 8 | Train Loss: 1.705 Vali Loss: 1.590 Vali Acc: 0.588 Test Loss: 1.590 Test Acc: 0.588
Validation loss decreased (-0.587482 --> -0.587484).  Saving model ...
Epoch: 6 cost time: 1.270916223526001
Epoch: 6, Steps: 8 | Train Loss: 1.550 Vali Loss: 1.372 Vali Acc: 0.684 Test Loss: 1.372 Test Acc: 0.684
Validation loss decreased (-0.587484 --> -0.684361).  Saving model ...
Epoch: 7 cost time: 1.2519516944885254
Epoch: 7, Steps: 8 | Train Loss: 1.241 Vali Loss: 1.133 Vali Acc: 0.784 Test Loss: 1.133 Test Acc: 0.784
Validation loss decreased (-0.684361 --> -0.784364).  Saving model ...
Epoch: 8 cost time: 0.9962234497070312
Epoch: 8, Steps: 8 | Train Loss: 1.043 Vali Loss: 0.937 Vali Acc: 0.794 Test Loss: 0.937 Test Acc: 0.794
Validation loss decreased (-0.784364 --> -0.793741).  Saving model ...
Epoch: 9 cost time: 1.2977595329284668
Epoch: 9, Steps: 8 | Train Loss: 0.792 Vali Loss: 0.785 Vali Acc: 0.787 Test Loss: 0.785 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2302775382995605
Epoch: 10, Steps: 8 | Train Loss: 0.641 Vali Loss: 0.685 Vali Acc: 0.809 Test Loss: 0.685 Test Acc: 0.809
Validation loss decreased (-0.793741 --> -0.809368).  Saving model ...
Epoch: 11 cost time: 1.209285020828247
Epoch: 11, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.631 Vali Acc: 0.812 Test Loss: 0.631 Test Acc: 0.812
Validation loss decreased (-0.809368 --> -0.812494).  Saving model ...
Epoch: 12 cost time: 1.356738805770874
Epoch: 12, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 13 cost time: 1.3219282627105713
Epoch: 13, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9768774509429932
Epoch: 14, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 15 cost time: 1.4032506942749023
Epoch: 15, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2785406112670898
Epoch: 16, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1248350143432617
Epoch: 17, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.552 Vali Acc: 0.812 Test Loss: 0.552 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0733251571655273
Epoch: 18, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.548 Vali Acc: 0.819 Test Loss: 0.548 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818745).  Saving model ...
Epoch: 19 cost time: 1.0097041130065918
Epoch: 19, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
Validation loss decreased (-0.818745 --> -0.818745).  Saving model ...
Epoch: 20 cost time: 1.1109118461608887
Epoch: 20, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
Validation loss decreased (-0.818745 --> -0.828120).  Saving model ...
Epoch: 21 cost time: 1.2501428127288818
Epoch: 21, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.546 Vali Acc: 0.812 Test Loss: 0.546 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4430346488952637
Epoch: 22, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.455366611480713
Epoch: 23, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.546 Vali Acc: 0.825 Test Loss: 0.546 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0803413391113281
Epoch: 24, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3961892127990723
Epoch: 25, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.014798879623413
Epoch: 26, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.253748893737793
Epoch: 27, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3174045085906982
Epoch: 28, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1490004062652588
Epoch: 29, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9698035717010498
Epoch: 30, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 438284
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9292237758636475
Epoch: 1, Steps: 8 | Train Loss: 2.227 Vali Loss: 2.119 Vali Acc: 0.234 Test Loss: 2.119 Test Acc: 0.234
Validation loss decreased (inf --> -0.234354).  Saving model ...
Epoch: 2 cost time: 1.1979129314422607
Epoch: 2, Steps: 8 | Train Loss: 2.091 Vali Loss: 1.996 Vali Acc: 0.275 Test Loss: 1.996 Test Acc: 0.275
Validation loss decreased (-0.234354 --> -0.274980).  Saving model ...
Epoch: 3 cost time: 1.423025369644165
Epoch: 3, Steps: 8 | Train Loss: 2.033 Vali Loss: 1.907 Vali Acc: 0.356 Test Loss: 1.907 Test Acc: 0.356
Validation loss decreased (-0.274980 --> -0.356231).  Saving model ...
Epoch: 4 cost time: 1.409348964691162
Epoch: 4, Steps: 8 | Train Loss: 1.919 Vali Loss: 1.774 Vali Acc: 0.544 Test Loss: 1.774 Test Acc: 0.544
Validation loss decreased (-0.356231 --> -0.543732).  Saving model ...
Epoch: 5 cost time: 1.2203559875488281
Epoch: 5, Steps: 8 | Train Loss: 1.753 Vali Loss: 1.596 Vali Acc: 0.675 Test Loss: 1.596 Test Acc: 0.675
Validation loss decreased (-0.543732 --> -0.674984).  Saving model ...
Epoch: 6 cost time: 1.2183594703674316
Epoch: 6, Steps: 8 | Train Loss: 1.502 Vali Loss: 1.381 Vali Acc: 0.741 Test Loss: 1.381 Test Acc: 0.741
Validation loss decreased (-0.674984 --> -0.740611).  Saving model ...
Epoch: 7 cost time: 1.3477284908294678
Epoch: 7, Steps: 8 | Train Loss: 1.291 Vali Loss: 1.153 Vali Acc: 0.778 Test Loss: 1.153 Test Acc: 0.778
Validation loss decreased (-0.740611 --> -0.778113).  Saving model ...
Epoch: 8 cost time: 1.2326269149780273
Epoch: 8, Steps: 8 | Train Loss: 1.027 Vali Loss: 0.956 Vali Acc: 0.787 Test Loss: 0.956 Test Acc: 0.787
Validation loss decreased (-0.778113 --> -0.787490).  Saving model ...
Epoch: 9 cost time: 1.8219659328460693
Epoch: 9, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.812 Vali Acc: 0.784 Test Loss: 0.812 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9615702629089355
Epoch: 10, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.699 Vali Acc: 0.828 Test Loss: 0.699 Test Acc: 0.828
Validation loss decreased (-0.787490 --> -0.828118).  Saving model ...
Epoch: 11 cost time: 1.4721179008483887
Epoch: 11, Steps: 8 | Train Loss: 0.561 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
Validation loss decreased (-0.828118 --> -0.828119).  Saving model ...
Epoch: 12 cost time: 1.3003640174865723
Epoch: 12, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.602 Vali Acc: 0.819 Test Loss: 0.602 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4794535636901855
Epoch: 13, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.580 Vali Acc: 0.828 Test Loss: 0.580 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 1.4537405967712402
Epoch: 14, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.560 Vali Acc: 0.834 Test Loss: 0.560 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 15 cost time: 1.626171350479126
Epoch: 15, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
Validation loss decreased (-0.834369 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 1.544757604598999
Epoch: 16, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 17 cost time: 1.050767183303833
Epoch: 17, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3801336288452148
Epoch: 18, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.537 Vali Acc: 0.831 Test Loss: 0.537 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1395094394683838
Epoch: 19, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3765640258789062
Epoch: 20, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.525 Vali Acc: 0.859 Test Loss: 0.525 Test Acc: 0.859
Validation loss decreased (-0.843745 --> -0.859370).  Saving model ...
Epoch: 21 cost time: 1.150921106338501
Epoch: 21, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2519569396972656
Epoch: 22, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6264700889587402
Epoch: 23, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3457236289978027
Epoch: 24, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.526 Vali Acc: 0.847 Test Loss: 0.526 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5328459739685059
Epoch: 25, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.526 Vali Acc: 0.853 Test Loss: 0.526 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1971192359924316
Epoch: 26, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.526 Vali Acc: 0.847 Test Loss: 0.526 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.434783935546875
Epoch: 27, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.544 Vali Acc: 0.834 Test Loss: 0.544 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4359815120697021
Epoch: 28, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.550 Vali Acc: 0.831 Test Loss: 0.550 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4430482387542725
Epoch: 29, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4092283248901367
Epoch: 30, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 436972
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1853408813476562
Epoch: 1, Steps: 8 | Train Loss: 2.255 Vali Loss: 2.151 Vali Acc: 0.069 Test Loss: 2.151 Test Acc: 0.069
Validation loss decreased (inf --> -0.068728).  Saving model ...
Epoch: 2 cost time: 1.165515661239624
Epoch: 2, Steps: 8 | Train Loss: 2.103 Vali Loss: 2.015 Vali Acc: 0.212 Test Loss: 2.015 Test Acc: 0.212
Validation loss decreased (-0.068728 --> -0.212480).  Saving model ...
Epoch: 3 cost time: 1.4960834980010986
Epoch: 3, Steps: 8 | Train Loss: 1.971 Vali Loss: 1.902 Vali Acc: 0.350 Test Loss: 1.902 Test Acc: 0.350
Validation loss decreased (-0.212480 --> -0.349981).  Saving model ...
Epoch: 4 cost time: 1.1816294193267822
Epoch: 4, Steps: 8 | Train Loss: 1.855 Vali Loss: 1.732 Vali Acc: 0.466 Test Loss: 1.732 Test Acc: 0.466
Validation loss decreased (-0.349981 --> -0.465608).  Saving model ...
Epoch: 5 cost time: 1.432018518447876
Epoch: 5, Steps: 8 | Train Loss: 1.705 Vali Loss: 1.514 Vali Acc: 0.622 Test Loss: 1.514 Test Acc: 0.622
Validation loss decreased (-0.465608 --> -0.621860).  Saving model ...
Epoch: 6 cost time: 1.554224967956543
Epoch: 6, Steps: 8 | Train Loss: 1.403 Vali Loss: 1.273 Vali Acc: 0.694 Test Loss: 1.273 Test Acc: 0.694
Validation loss decreased (-0.621860 --> -0.693737).  Saving model ...
Epoch: 7 cost time: 1.3326189517974854
Epoch: 7, Steps: 8 | Train Loss: 1.129 Vali Loss: 1.049 Vali Acc: 0.747 Test Loss: 1.049 Test Acc: 0.747
Validation loss decreased (-0.693737 --> -0.746865).  Saving model ...
Epoch: 8 cost time: 1.4065229892730713
Epoch: 8, Steps: 8 | Train Loss: 0.902 Vali Loss: 0.865 Vali Acc: 0.784 Test Loss: 0.865 Test Acc: 0.784
Validation loss decreased (-0.746865 --> -0.784366).  Saving model ...
Epoch: 9 cost time: 1.2374813556671143
Epoch: 9, Steps: 8 | Train Loss: 0.766 Vali Loss: 0.750 Vali Acc: 0.787 Test Loss: 0.750 Test Acc: 0.787
Validation loss decreased (-0.784366 --> -0.787492).  Saving model ...
Epoch: 10 cost time: 1.1812403202056885
Epoch: 10, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.676 Vali Acc: 0.806 Test Loss: 0.676 Test Acc: 0.806
Validation loss decreased (-0.787492 --> -0.806243).  Saving model ...
Epoch: 11 cost time: 1.6148996353149414
Epoch: 11, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.628 Vali Acc: 0.819 Test Loss: 0.628 Test Acc: 0.819
Validation loss decreased (-0.806243 --> -0.818744).  Saving model ...
Epoch: 12 cost time: 1.6403326988220215
Epoch: 12, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 1.6702075004577637
Epoch: 13, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 1.4758176803588867
Epoch: 14, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.562 Vali Acc: 0.831 Test Loss: 0.562 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 15 cost time: 1.2442326545715332
Epoch: 15, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.561 Vali Acc: 0.831 Test Loss: 0.561 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831244).  Saving model ...
Epoch: 16 cost time: 1.7035975456237793
Epoch: 16, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1610839366912842
Epoch: 17, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.598318099975586
Epoch: 18, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4739806652069092
Epoch: 19, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.545 Vali Acc: 0.816 Test Loss: 0.545 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6718096733093262
Epoch: 20, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3587770462036133
Epoch: 21, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.552 Vali Acc: 0.822 Test Loss: 0.552 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4057261943817139
Epoch: 22, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2509307861328125
Epoch: 23, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.235314130783081
Epoch: 24, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4307591915130615
Epoch: 25, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 435660
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.919570207595825
Epoch: 1, Steps: 8 | Train Loss: 2.243 Vali Loss: 2.175 Vali Acc: 0.150 Test Loss: 2.175 Test Acc: 0.150
Validation loss decreased (inf --> -0.149978).  Saving model ...
Epoch: 2 cost time: 0.9719295501708984
Epoch: 2, Steps: 8 | Train Loss: 2.109 Vali Loss: 2.044 Vali Acc: 0.225 Test Loss: 2.044 Test Acc: 0.225
Validation loss decreased (-0.149978 --> -0.224980).  Saving model ...
Epoch: 3 cost time: 1.1093735694885254
Epoch: 3, Steps: 8 | Train Loss: 2.024 Vali Loss: 1.951 Vali Acc: 0.163 Test Loss: 1.951 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.263120412826538
Epoch: 4, Steps: 8 | Train Loss: 1.947 Vali Loss: 1.841 Vali Acc: 0.256 Test Loss: 1.841 Test Acc: 0.256
Validation loss decreased (-0.224980 --> -0.256232).  Saving model ...
Epoch: 5 cost time: 1.0514986515045166
Epoch: 5, Steps: 8 | Train Loss: 1.775 Vali Loss: 1.681 Vali Acc: 0.634 Test Loss: 1.681 Test Acc: 0.634
Validation loss decreased (-0.256232 --> -0.634358).  Saving model ...
Epoch: 6 cost time: 1.0696167945861816
Epoch: 6, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.490 Vali Acc: 0.703 Test Loss: 1.490 Test Acc: 0.703
Validation loss decreased (-0.634358 --> -0.703110).  Saving model ...
Epoch: 7 cost time: 1.0571866035461426
Epoch: 7, Steps: 8 | Train Loss: 1.352 Vali Loss: 1.255 Vali Acc: 0.738 Test Loss: 1.255 Test Acc: 0.738
Validation loss decreased (-0.703110 --> -0.737487).  Saving model ...
Epoch: 8 cost time: 0.9223170280456543
Epoch: 8, Steps: 8 | Train Loss: 1.068 Vali Loss: 1.025 Vali Acc: 0.806 Test Loss: 1.025 Test Acc: 0.806
Validation loss decreased (-0.737487 --> -0.806240).  Saving model ...
Epoch: 9 cost time: 1.0091016292572021
Epoch: 9, Steps: 8 | Train Loss: 0.848 Vali Loss: 0.849 Vali Acc: 0.809 Test Loss: 0.849 Test Acc: 0.809
Validation loss decreased (-0.806240 --> -0.809367).  Saving model ...
Epoch: 10 cost time: 1.023247241973877
Epoch: 10, Steps: 8 | Train Loss: 0.726 Vali Loss: 0.727 Vali Acc: 0.812 Test Loss: 0.727 Test Acc: 0.812
Validation loss decreased (-0.809367 --> -0.812493).  Saving model ...
Epoch: 11 cost time: 0.9449236392974854
Epoch: 11, Steps: 8 | Train Loss: 0.603 Vali Loss: 0.657 Vali Acc: 0.809 Test Loss: 0.657 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0696828365325928
Epoch: 12, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.620 Vali Acc: 0.816 Test Loss: 0.620 Test Acc: 0.816
Validation loss decreased (-0.812493 --> -0.815619).  Saving model ...
Epoch: 13 cost time: 1.5426383018493652
Epoch: 13, Steps: 8 | Train Loss: 0.449 Vali Loss: 0.584 Vali Acc: 0.834 Test Loss: 0.584 Test Acc: 0.834
Validation loss decreased (-0.815619 --> -0.834369).  Saving model ...
Epoch: 14 cost time: 1.0373790264129639
Epoch: 14, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9023478031158447
Epoch: 15, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0497338771820068
Epoch: 16, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1080751419067383
Epoch: 17, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2015936374664307
Epoch: 18, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.324753999710083
Epoch: 19, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.383070707321167
Epoch: 20, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3267590999603271
Epoch: 21, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2566721439361572
Epoch: 22, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0776278972625732
Epoch: 23, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 273196
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.623135566711426
Epoch: 1, Steps: 8 | Train Loss: 2.288 Vali Loss: 2.161 Vali Acc: 0.125 Test Loss: 2.161 Test Acc: 0.125
Validation loss decreased (inf --> -0.124978).  Saving model ...
Epoch: 2 cost time: 1.2701170444488525
Epoch: 2, Steps: 8 | Train Loss: 2.129 Vali Loss: 2.028 Vali Acc: 0.172 Test Loss: 2.028 Test Acc: 0.172
Validation loss decreased (-0.124978 --> -0.171855).  Saving model ...
Epoch: 3 cost time: 1.217087745666504
Epoch: 3, Steps: 8 | Train Loss: 2.025 Vali Loss: 1.910 Vali Acc: 0.331 Test Loss: 1.910 Test Acc: 0.331
Validation loss decreased (-0.171855 --> -0.331231).  Saving model ...
Epoch: 4 cost time: 1.4622156620025635
Epoch: 4, Steps: 8 | Train Loss: 1.894 Vali Loss: 1.775 Vali Acc: 0.509 Test Loss: 1.775 Test Acc: 0.509
Validation loss decreased (-0.331231 --> -0.509357).  Saving model ...
Epoch: 5 cost time: 1.4757788181304932
Epoch: 5, Steps: 8 | Train Loss: 1.746 Vali Loss: 1.602 Vali Acc: 0.631 Test Loss: 1.602 Test Acc: 0.631
Validation loss decreased (-0.509357 --> -0.631234).  Saving model ...
Epoch: 6 cost time: 1.0576651096343994
Epoch: 6, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.398 Vali Acc: 0.666 Test Loss: 1.398 Test Acc: 0.666
Validation loss decreased (-0.631234 --> -0.665611).  Saving model ...
Epoch: 7 cost time: 1.1680362224578857
Epoch: 7, Steps: 8 | Train Loss: 1.270 Vali Loss: 1.188 Vali Acc: 0.766 Test Loss: 1.188 Test Acc: 0.766
Validation loss decreased (-0.665611 --> -0.765613).  Saving model ...
Epoch: 8 cost time: 1.2329754829406738
Epoch: 8, Steps: 8 | Train Loss: 1.070 Vali Loss: 0.988 Vali Acc: 0.759 Test Loss: 0.988 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.451737642288208
Epoch: 9, Steps: 8 | Train Loss: 0.844 Vali Loss: 0.830 Vali Acc: 0.784 Test Loss: 0.830 Test Acc: 0.784
Validation loss decreased (-0.765613 --> -0.784367).  Saving model ...
Epoch: 10 cost time: 1.0836069583892822
Epoch: 10, Steps: 8 | Train Loss: 0.718 Vali Loss: 0.740 Vali Acc: 0.787 Test Loss: 0.740 Test Acc: 0.787
Validation loss decreased (-0.784367 --> -0.787493).  Saving model ...
Epoch: 11 cost time: 1.236731767654419
Epoch: 11, Steps: 8 | Train Loss: 0.615 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
Validation loss decreased (-0.787493 --> -0.809368).  Saving model ...
Epoch: 12 cost time: 1.3150134086608887
Epoch: 12, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
Validation loss decreased (-0.809368 --> -0.815619).  Saving model ...
Epoch: 13 cost time: 1.214707374572754
Epoch: 13, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 14 cost time: 1.2476487159729004
Epoch: 14, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.585 Vali Acc: 0.812 Test Loss: 0.585 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4607715606689453
Epoch: 15, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
Validation loss decreased (-0.815619 --> -0.815619).  Saving model ...
Epoch: 16 cost time: 1.310389518737793
Epoch: 16, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.576 Vali Acc: 0.806 Test Loss: 0.576 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3071129322052002
Epoch: 17, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 18 cost time: 1.2677931785583496
Epoch: 18, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.550 Vali Acc: 0.828 Test Loss: 0.550 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 19 cost time: 1.1988513469696045
Epoch: 19, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 20 cost time: 1.1920220851898193
Epoch: 20, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.553 Vali Acc: 0.831 Test Loss: 0.553 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.046381950378418
Epoch: 21, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.42716383934021
Epoch: 22, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1582832336425781
Epoch: 23, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1603655815124512
Epoch: 24, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3002126216888428
Epoch: 25, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3175671100616455
Epoch: 26, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.547 Vali Acc: 0.828 Test Loss: 0.547 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8567571640014648
Epoch: 27, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.36055588722229
Epoch: 28, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3592584133148193
Epoch: 29, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.557 Vali Acc: 0.828 Test Loss: 0.557 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 271884
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9821856021881104
Epoch: 1, Steps: 8 | Train Loss: 2.206 Vali Loss: 2.169 Vali Acc: 0.138 Test Loss: 2.169 Test Acc: 0.138
Validation loss decreased (inf --> -0.137478).  Saving model ...
Epoch: 2 cost time: 1.0675501823425293
Epoch: 2, Steps: 8 | Train Loss: 2.086 Vali Loss: 2.033 Vali Acc: 0.259 Test Loss: 2.033 Test Acc: 0.259
Validation loss decreased (-0.137478 --> -0.259355).  Saving model ...
Epoch: 3 cost time: 1.1839299201965332
Epoch: 3, Steps: 8 | Train Loss: 2.000 Vali Loss: 1.943 Vali Acc: 0.300 Test Loss: 1.943 Test Acc: 0.300
Validation loss decreased (-0.259355 --> -0.299981).  Saving model ...
Epoch: 4 cost time: 1.1953623294830322
Epoch: 4, Steps: 8 | Train Loss: 1.883 Vali Loss: 1.842 Vali Acc: 0.400 Test Loss: 1.842 Test Acc: 0.400
Validation loss decreased (-0.299981 --> -0.399982).  Saving model ...
Epoch: 5 cost time: 1.0495531558990479
Epoch: 5, Steps: 8 | Train Loss: 1.791 Vali Loss: 1.697 Vali Acc: 0.553 Test Loss: 1.697 Test Acc: 0.553
Validation loss decreased (-0.399982 --> -0.553108).  Saving model ...
Epoch: 6 cost time: 1.0474154949188232
Epoch: 6, Steps: 8 | Train Loss: 1.603 Vali Loss: 1.528 Vali Acc: 0.650 Test Loss: 1.528 Test Acc: 0.650
Validation loss decreased (-0.553108 --> -0.649985).  Saving model ...
Epoch: 7 cost time: 1.0051565170288086
Epoch: 7, Steps: 8 | Train Loss: 1.401 Vali Loss: 1.313 Vali Acc: 0.694 Test Loss: 1.313 Test Acc: 0.694
Validation loss decreased (-0.649985 --> -0.693737).  Saving model ...
Epoch: 8 cost time: 0.9913325309753418
Epoch: 8, Steps: 8 | Train Loss: 1.176 Vali Loss: 1.111 Vali Acc: 0.741 Test Loss: 1.111 Test Acc: 0.741
Validation loss decreased (-0.693737 --> -0.740614).  Saving model ...
Epoch: 9 cost time: 1.0930230617523193
Epoch: 9, Steps: 8 | Train Loss: 0.975 Vali Loss: 0.926 Vali Acc: 0.753 Test Loss: 0.926 Test Acc: 0.753
Validation loss decreased (-0.740614 --> -0.753116).  Saving model ...
Epoch: 10 cost time: 1.8329741954803467
Epoch: 10, Steps: 8 | Train Loss: 0.823 Vali Loss: 0.785 Vali Acc: 0.784 Test Loss: 0.785 Test Acc: 0.784
Validation loss decreased (-0.753116 --> -0.784367).  Saving model ...
Epoch: 11 cost time: 1.2668790817260742
Epoch: 11, Steps: 8 | Train Loss: 0.645 Vali Loss: 0.696 Vali Acc: 0.787 Test Loss: 0.696 Test Acc: 0.787
Validation loss decreased (-0.784367 --> -0.787493).  Saving model ...
Epoch: 12 cost time: 1.326524257659912
Epoch: 12, Steps: 8 | Train Loss: 0.550 Vali Loss: 0.641 Vali Acc: 0.797 Test Loss: 0.641 Test Acc: 0.797
Validation loss decreased (-0.787493 --> -0.796869).  Saving model ...
Epoch: 13 cost time: 1.1304445266723633
Epoch: 13, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
Validation loss decreased (-0.796869 --> -0.803119).  Saving model ...
Epoch: 14 cost time: 1.022660255432129
Epoch: 14, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.594 Vali Acc: 0.809 Test Loss: 0.594 Test Acc: 0.809
Validation loss decreased (-0.803119 --> -0.809369).  Saving model ...
Epoch: 15 cost time: 1.1200847625732422
Epoch: 15, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812494).  Saving model ...
Epoch: 16 cost time: 1.1171419620513916
Epoch: 16, Steps: 8 | Train Loss: 0.317 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 17 cost time: 0.9285085201263428
Epoch: 17, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.584 Vali Acc: 0.803 Test Loss: 0.584 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.236745834350586
Epoch: 18, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.586 Vali Acc: 0.806 Test Loss: 0.586 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1176173686981201
Epoch: 19, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.595 Vali Acc: 0.797 Test Loss: 0.595 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0957367420196533
Epoch: 20, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2609789371490479
Epoch: 21, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.567 Vali Acc: 0.816 Test Loss: 0.567 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 22 cost time: 1.14796781539917
Epoch: 22, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5721871852874756
Epoch: 23, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 24 cost time: 1.0683717727661133
Epoch: 24, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.581 Vali Acc: 0.800 Test Loss: 0.581 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2063071727752686
Epoch: 25, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.586 Vali Acc: 0.803 Test Loss: 0.586 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5074429512023926
Epoch: 26, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3384108543395996
Epoch: 27, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2789933681488037
Epoch: 28, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.596 Vali Acc: 0.812 Test Loss: 0.596 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.018165111541748
Epoch: 29, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.260450839996338
Epoch: 30, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3161468505859375
Epoch: 31, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.601 Vali Acc: 0.806 Test Loss: 0.601 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2583775520324707
Epoch: 32, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.5491042137145996
Epoch: 33, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.625 Vali Acc: 0.803 Test Loss: 0.625 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.81875
model parameter : 270572
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3756566047668457
Epoch: 1, Steps: 8 | Train Loss: 2.209 Vali Loss: 2.115 Vali Acc: 0.131 Test Loss: 2.115 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 1.0653140544891357
Epoch: 2, Steps: 8 | Train Loss: 2.146 Vali Loss: 2.016 Vali Acc: 0.144 Test Loss: 2.016 Test Acc: 0.144
Validation loss decreased (-0.131229 --> -0.143730).  Saving model ...
Epoch: 3 cost time: 1.1894798278808594
Epoch: 3, Steps: 8 | Train Loss: 2.043 Vali Loss: 1.930 Vali Acc: 0.322 Test Loss: 1.930 Test Acc: 0.322
Validation loss decreased (-0.143730 --> -0.321856).  Saving model ...
Epoch: 4 cost time: 1.2831521034240723
Epoch: 4, Steps: 8 | Train Loss: 1.945 Vali Loss: 1.823 Vali Acc: 0.409 Test Loss: 1.823 Test Acc: 0.409
Validation loss decreased (-0.321856 --> -0.409357).  Saving model ...
Epoch: 5 cost time: 1.211883783340454
Epoch: 5, Steps: 8 | Train Loss: 1.770 Vali Loss: 1.677 Vali Acc: 0.575 Test Loss: 1.677 Test Acc: 0.575
Validation loss decreased (-0.409357 --> -0.574983).  Saving model ...
Epoch: 6 cost time: 1.191521167755127
Epoch: 6, Steps: 8 | Train Loss: 1.675 Vali Loss: 1.493 Vali Acc: 0.703 Test Loss: 1.493 Test Acc: 0.703
Validation loss decreased (-0.574983 --> -0.703110).  Saving model ...
Epoch: 7 cost time: 1.4029085636138916
Epoch: 7, Steps: 8 | Train Loss: 1.442 Vali Loss: 1.271 Vali Acc: 0.784 Test Loss: 1.271 Test Acc: 0.784
Validation loss decreased (-0.703110 --> -0.784362).  Saving model ...
Epoch: 8 cost time: 1.332721471786499
Epoch: 8, Steps: 8 | Train Loss: 1.165 Vali Loss: 1.062 Vali Acc: 0.809 Test Loss: 1.062 Test Acc: 0.809
Validation loss decreased (-0.784362 --> -0.809364).  Saving model ...
Epoch: 9 cost time: 1.1831600666046143
Epoch: 9, Steps: 8 | Train Loss: 0.948 Vali Loss: 0.869 Vali Acc: 0.816 Test Loss: 0.869 Test Acc: 0.816
Validation loss decreased (-0.809364 --> -0.815616).  Saving model ...
Epoch: 10 cost time: 1.4008564949035645
Epoch: 10, Steps: 8 | Train Loss: 0.808 Vali Loss: 0.760 Vali Acc: 0.787 Test Loss: 0.760 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4959077835083008
Epoch: 11, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.665 Vali Acc: 0.806 Test Loss: 0.665 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4790067672729492
Epoch: 12, Steps: 8 | Train Loss: 0.553 Vali Loss: 0.612 Vali Acc: 0.819 Test Loss: 0.612 Test Acc: 0.819
Validation loss decreased (-0.815616 --> -0.818744).  Saving model ...
Epoch: 13 cost time: 1.259491205215454
Epoch: 13, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 0.9728071689605713
Epoch: 14, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.560 Vali Acc: 0.816 Test Loss: 0.560 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.109947919845581
Epoch: 15, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2007238864898682
Epoch: 16, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4564390182495117
Epoch: 17, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.523 Vali Acc: 0.834 Test Loss: 0.523 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 18 cost time: 1.1385815143585205
Epoch: 18, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.521 Vali Acc: 0.828 Test Loss: 0.521 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2715158462524414
Epoch: 19, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3607733249664307
Epoch: 20, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 21 cost time: 1.1121838092803955
Epoch: 21, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.518 Vali Acc: 0.847 Test Loss: 0.518 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 22 cost time: 1.1979050636291504
Epoch: 22, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4612035751342773
Epoch: 23, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.079679250717163
Epoch: 24, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.515 Vali Acc: 0.847 Test Loss: 0.515 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 25 cost time: 1.2162036895751953
Epoch: 25, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.213578224182129
Epoch: 26, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1454119682312012
Epoch: 27, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.534 Vali Acc: 0.834 Test Loss: 0.534 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6502177715301514
Epoch: 28, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.130312204360962
Epoch: 29, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.153475284576416
Epoch: 30, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 1.0079941749572754
Epoch: 31, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.534 Vali Acc: 0.838 Test Loss: 0.534 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2957942485809326
Epoch: 32, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7563412189483643
Epoch: 33, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.228883981704712
Epoch: 34, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.538 Vali Acc: 0.831 Test Loss: 0.538 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.514052152633667
Epoch: 35, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1813862323760986
Epoch: 36, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.546 Vali Acc: 0.841 Test Loss: 0.546 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1319656372070312
Epoch: 37, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.552 Vali Acc: 0.841 Test Loss: 0.552 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.7256569862365723
Epoch: 38, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.425645112991333
Epoch: 39, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.544 Vali Acc: 0.838 Test Loss: 0.544 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.5696604251861572
Epoch: 40, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.544 Vali Acc: 0.834 Test Loss: 0.544 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 269260
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.952383518218994
Epoch: 1, Steps: 8 | Train Loss: 2.217 Vali Loss: 2.158 Vali Acc: 0.056 Test Loss: 2.158 Test Acc: 0.056
Validation loss decreased (inf --> -0.056228).  Saving model ...
Epoch: 2 cost time: 1.231703281402588
Epoch: 2, Steps: 8 | Train Loss: 2.127 Vali Loss: 2.067 Vali Acc: 0.156 Test Loss: 2.067 Test Acc: 0.156
Validation loss decreased (-0.056228 --> -0.156229).  Saving model ...
Epoch: 3 cost time: 1.129154920578003
Epoch: 3, Steps: 8 | Train Loss: 2.034 Vali Loss: 1.982 Vali Acc: 0.234 Test Loss: 1.982 Test Acc: 0.234
Validation loss decreased (-0.156229 --> -0.234355).  Saving model ...
Epoch: 4 cost time: 0.9681973457336426
Epoch: 4, Steps: 8 | Train Loss: 1.921 Vali Loss: 1.882 Vali Acc: 0.362 Test Loss: 1.882 Test Acc: 0.362
Validation loss decreased (-0.234355 --> -0.362481).  Saving model ...
Epoch: 5 cost time: 1.1419341564178467
Epoch: 5, Steps: 8 | Train Loss: 1.842 Vali Loss: 1.756 Vali Acc: 0.503 Test Loss: 1.756 Test Acc: 0.503
Validation loss decreased (-0.362481 --> -0.503107).  Saving model ...
Epoch: 6 cost time: 1.630861759185791
Epoch: 6, Steps: 8 | Train Loss: 1.679 Vali Loss: 1.599 Vali Acc: 0.653 Test Loss: 1.599 Test Acc: 0.653
Validation loss decreased (-0.503107 --> -0.653109).  Saving model ...
Epoch: 7 cost time: 1.5377757549285889
Epoch: 7, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.411 Vali Acc: 0.719 Test Loss: 1.411 Test Acc: 0.719
Validation loss decreased (-0.653109 --> -0.718736).  Saving model ...
Epoch: 8 cost time: 1.2030613422393799
Epoch: 8, Steps: 8 | Train Loss: 1.325 Vali Loss: 1.209 Vali Acc: 0.762 Test Loss: 1.209 Test Acc: 0.762
Validation loss decreased (-0.718736 --> -0.762488).  Saving model ...
Epoch: 9 cost time: 1.430985927581787
Epoch: 9, Steps: 8 | Train Loss: 1.097 Vali Loss: 1.000 Vali Acc: 0.791 Test Loss: 1.000 Test Acc: 0.791
Validation loss decreased (-0.762488 --> -0.790615).  Saving model ...
Epoch: 10 cost time: 1.4239778518676758
Epoch: 10, Steps: 8 | Train Loss: 0.894 Vali Loss: 0.827 Vali Acc: 0.812 Test Loss: 0.827 Test Acc: 0.812
Validation loss decreased (-0.790615 --> -0.812492).  Saving model ...
Epoch: 11 cost time: 1.2376933097839355
Epoch: 11, Steps: 8 | Train Loss: 0.709 Vali Loss: 0.713 Vali Acc: 0.828 Test Loss: 0.713 Test Acc: 0.828
Validation loss decreased (-0.812492 --> -0.828118).  Saving model ...
Epoch: 12 cost time: 1.9682042598724365
Epoch: 12, Steps: 8 | Train Loss: 0.599 Vali Loss: 0.635 Vali Acc: 0.812 Test Loss: 0.635 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4856393337249756
Epoch: 13, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.597 Vali Acc: 0.831 Test Loss: 0.597 Test Acc: 0.831
Validation loss decreased (-0.828118 --> -0.831244).  Saving model ...
Epoch: 14 cost time: 1.171133041381836
Epoch: 14, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4256789684295654
Epoch: 15, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.552 Vali Acc: 0.822 Test Loss: 0.552 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6039373874664307
Epoch: 16, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.542 Vali Acc: 0.822 Test Loss: 0.542 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6893033981323242
Epoch: 17, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6784946918487549
Epoch: 18, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.552 Vali Acc: 0.834 Test Loss: 0.552 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 19 cost time: 1.3292276859283447
Epoch: 19, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.705061912536621
Epoch: 20, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.538 Vali Acc: 0.838 Test Loss: 0.538 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 21 cost time: 1.5690689086914062
Epoch: 21, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.90724515914917
Epoch: 22, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.837495 --> -0.837495).  Saving model ...
Epoch: 23 cost time: 1.7554075717926025
Epoch: 23, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.543 Vali Acc: 0.831 Test Loss: 0.543 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4825458526611328
Epoch: 24, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.539 Vali Acc: 0.834 Test Loss: 0.539 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3900532722473145
Epoch: 25, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6243503093719482
Epoch: 26, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.550 Vali Acc: 0.834 Test Loss: 0.550 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.475398302078247
Epoch: 27, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4111523628234863
Epoch: 28, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7321381568908691
Epoch: 29, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.556 Vali Acc: 0.831 Test Loss: 0.556 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8539795875549316
Epoch: 30, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6613268852233887
Epoch: 31, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.279405117034912
Epoch: 32, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.560 Vali Acc: 0.834 Test Loss: 0.560 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 189996
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.377408981323242
Epoch: 1, Steps: 8 | Train Loss: 2.226 Vali Loss: 2.162 Vali Acc: 0.138 Test Loss: 2.162 Test Acc: 0.138
Validation loss decreased (inf --> -0.137478).  Saving model ...
Epoch: 2 cost time: 1.3472182750701904
Epoch: 2, Steps: 8 | Train Loss: 2.160 Vali Loss: 2.062 Vali Acc: 0.184 Test Loss: 2.062 Test Acc: 0.184
Validation loss decreased (-0.137478 --> -0.184354).  Saving model ...
Epoch: 3 cost time: 1.3499059677124023
Epoch: 3, Steps: 8 | Train Loss: 2.017 Vali Loss: 1.962 Vali Acc: 0.237 Test Loss: 1.962 Test Acc: 0.237
Validation loss decreased (-0.184354 --> -0.237480).  Saving model ...
Epoch: 4 cost time: 1.2448346614837646
Epoch: 4, Steps: 8 | Train Loss: 1.919 Vali Loss: 1.856 Vali Acc: 0.384 Test Loss: 1.856 Test Acc: 0.384
Validation loss decreased (-0.237480 --> -0.384356).  Saving model ...
Epoch: 5 cost time: 1.5204195976257324
Epoch: 5, Steps: 8 | Train Loss: 1.824 Vali Loss: 1.715 Vali Acc: 0.559 Test Loss: 1.715 Test Acc: 0.559
Validation loss decreased (-0.384356 --> -0.559358).  Saving model ...
Epoch: 6 cost time: 1.3228838443756104
Epoch: 6, Steps: 8 | Train Loss: 1.602 Vali Loss: 1.543 Vali Acc: 0.647 Test Loss: 1.543 Test Acc: 0.647
Validation loss decreased (-0.559358 --> -0.646860).  Saving model ...
Epoch: 7 cost time: 1.4281401634216309
Epoch: 7, Steps: 8 | Train Loss: 1.494 Vali Loss: 1.342 Vali Acc: 0.716 Test Loss: 1.342 Test Acc: 0.716
Validation loss decreased (-0.646860 --> -0.715612).  Saving model ...
Epoch: 8 cost time: 1.3659799098968506
Epoch: 8, Steps: 8 | Train Loss: 1.235 Vali Loss: 1.143 Vali Acc: 0.719 Test Loss: 1.143 Test Acc: 0.719
Validation loss decreased (-0.715612 --> -0.718739).  Saving model ...
Epoch: 9 cost time: 1.162700891494751
Epoch: 9, Steps: 8 | Train Loss: 1.043 Vali Loss: 0.961 Vali Acc: 0.778 Test Loss: 0.961 Test Acc: 0.778
Validation loss decreased (-0.718739 --> -0.778115).  Saving model ...
Epoch: 10 cost time: 1.388129711151123
Epoch: 10, Steps: 8 | Train Loss: 0.835 Vali Loss: 0.817 Vali Acc: 0.797 Test Loss: 0.817 Test Acc: 0.797
Validation loss decreased (-0.778115 --> -0.796867).  Saving model ...
Epoch: 11 cost time: 1.1553101539611816
Epoch: 11, Steps: 8 | Train Loss: 0.728 Vali Loss: 0.705 Vali Acc: 0.825 Test Loss: 0.705 Test Acc: 0.825
Validation loss decreased (-0.796867 --> -0.824993).  Saving model ...
Epoch: 12 cost time: 1.3055312633514404
Epoch: 12, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.633 Vali Acc: 0.834 Test Loss: 0.633 Test Acc: 0.834
Validation loss decreased (-0.824993 --> -0.834369).  Saving model ...
Epoch: 13 cost time: 1.2492883205413818
Epoch: 13, Steps: 8 | Train Loss: 0.519 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843744).  Saving model ...
Epoch: 14 cost time: 1.4080290794372559
Epoch: 14, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2624905109405518
Epoch: 15, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.236013412475586
Epoch: 16, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.527590274810791
Epoch: 17, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.699756145477295
Epoch: 18, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.534 Vali Acc: 0.831 Test Loss: 0.534 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.13043212890625
Epoch: 19, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 20 cost time: 1.6902191638946533
Epoch: 20, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.521 Vali Acc: 0.834 Test Loss: 0.521 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4353525638580322
Epoch: 21, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7004210948944092
Epoch: 22, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.528 Vali Acc: 0.834 Test Loss: 0.528 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5727441310882568
Epoch: 23, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.561023235321045
Epoch: 24, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5554163455963135
Epoch: 25, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.529 Vali Acc: 0.825 Test Loss: 0.529 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3170404434204102
Epoch: 26, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.523 Vali Acc: 0.841 Test Loss: 0.523 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.141608476638794
Epoch: 27, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.525 Vali Acc: 0.847 Test Loss: 0.525 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 28 cost time: 1.3847904205322266
Epoch: 28, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.546 Vali Acc: 0.831 Test Loss: 0.546 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3232851028442383
Epoch: 29, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7763149738311768
Epoch: 30, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5009655952453613
Epoch: 31, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.47090482711792
Epoch: 32, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.3491685390472412
Epoch: 33, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3897342681884766
Epoch: 34, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1727547645568848
Epoch: 35, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3949403762817383
Epoch: 36, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.070098638534546
Epoch: 37, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.561 Vali Acc: 0.828 Test Loss: 0.561 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 188684
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.319065570831299
Epoch: 1, Steps: 8 | Train Loss: 2.355 Vali Loss: 2.234 Vali Acc: 0.050 Test Loss: 2.234 Test Acc: 0.050
Validation loss decreased (inf --> -0.049978).  Saving model ...
Epoch: 2 cost time: 1.1965696811676025
Epoch: 2, Steps: 8 | Train Loss: 2.200 Vali Loss: 2.110 Vali Acc: 0.150 Test Loss: 2.110 Test Acc: 0.150
Validation loss decreased (-0.049978 --> -0.149979).  Saving model ...
Epoch: 3 cost time: 1.0799643993377686
Epoch: 3, Steps: 8 | Train Loss: 2.069 Vali Loss: 2.021 Vali Acc: 0.231 Test Loss: 2.021 Test Acc: 0.231
Validation loss decreased (-0.149979 --> -0.231230).  Saving model ...
Epoch: 4 cost time: 1.4531946182250977
Epoch: 4, Steps: 8 | Train Loss: 1.982 Vali Loss: 1.910 Vali Acc: 0.347 Test Loss: 1.910 Test Acc: 0.347
Validation loss decreased (-0.231230 --> -0.346856).  Saving model ...
Epoch: 5 cost time: 1.4528803825378418
Epoch: 5, Steps: 8 | Train Loss: 1.833 Vali Loss: 1.783 Vali Acc: 0.550 Test Loss: 1.783 Test Acc: 0.550
Validation loss decreased (-0.346856 --> -0.549982).  Saving model ...
Epoch: 6 cost time: 1.3033831119537354
Epoch: 6, Steps: 8 | Train Loss: 1.741 Vali Loss: 1.644 Vali Acc: 0.641 Test Loss: 1.644 Test Acc: 0.641
Validation loss decreased (-0.549982 --> -0.640609).  Saving model ...
Epoch: 7 cost time: 1.524733543395996
Epoch: 7, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.449 Vali Acc: 0.728 Test Loss: 1.449 Test Acc: 0.728
Validation loss decreased (-0.640609 --> -0.728111).  Saving model ...
Epoch: 8 cost time: 1.191361904144287
Epoch: 8, Steps: 8 | Train Loss: 1.328 Vali Loss: 1.246 Vali Acc: 0.725 Test Loss: 1.246 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3211114406585693
Epoch: 9, Steps: 8 | Train Loss: 1.139 Vali Loss: 1.037 Vali Acc: 0.759 Test Loss: 1.037 Test Acc: 0.759
Validation loss decreased (-0.728111 --> -0.759365).  Saving model ...
Epoch: 10 cost time: 1.3133885860443115
Epoch: 10, Steps: 8 | Train Loss: 0.901 Vali Loss: 0.854 Vali Acc: 0.784 Test Loss: 0.854 Test Acc: 0.784
Validation loss decreased (-0.759365 --> -0.784366).  Saving model ...
Epoch: 11 cost time: 1.4520444869995117
Epoch: 11, Steps: 8 | Train Loss: 0.720 Vali Loss: 0.726 Vali Acc: 0.794 Test Loss: 0.726 Test Acc: 0.794
Validation loss decreased (-0.784366 --> -0.793743).  Saving model ...
Epoch: 12 cost time: 1.6218657493591309
Epoch: 12, Steps: 8 | Train Loss: 0.662 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
Validation loss decreased (-0.793743 --> -0.803118).  Saving model ...
Epoch: 13 cost time: 1.4781780242919922
Epoch: 13, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.607 Vali Acc: 0.806 Test Loss: 0.607 Test Acc: 0.806
Validation loss decreased (-0.803118 --> -0.806244).  Saving model ...
Epoch: 14 cost time: 1.1734392642974854
Epoch: 14, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.573 Vali Acc: 0.819 Test Loss: 0.573 Test Acc: 0.819
Validation loss decreased (-0.806244 --> -0.818744).  Saving model ...
Epoch: 15 cost time: 1.182112455368042
Epoch: 15, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.549 Vali Acc: 0.831 Test Loss: 0.549 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831245).  Saving model ...
Epoch: 16 cost time: 1.2947807312011719
Epoch: 16, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1755547523498535
Epoch: 17, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.555 Vali Acc: 0.806 Test Loss: 0.555 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3425381183624268
Epoch: 18, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.552 Vali Acc: 0.822 Test Loss: 0.552 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2595863342285156
Epoch: 19, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.552 Vali Acc: 0.812 Test Loss: 0.552 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6267387866973877
Epoch: 20, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0789167881011963
Epoch: 21, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3218755722045898
Epoch: 22, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.552 Vali Acc: 0.822 Test Loss: 0.552 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.256338357925415
Epoch: 23, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.533 Vali Acc: 0.831 Test Loss: 0.533 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 24 cost time: 1.3429067134857178
Epoch: 24, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.542 Vali Acc: 0.828 Test Loss: 0.542 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2004871368408203
Epoch: 25, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.547 Vali Acc: 0.828 Test Loss: 0.547 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.118607997894287
Epoch: 26, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2107422351837158
Epoch: 27, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2318856716156006
Epoch: 28, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3365144729614258
Epoch: 29, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.487915277481079
Epoch: 30, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.561 Vali Acc: 0.828 Test Loss: 0.561 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1666853427886963
Epoch: 31, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3063499927520752
Epoch: 32, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.562 Vali Acc: 0.831 Test Loss: 0.562 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1562705039978027
Epoch: 33, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.572 Vali Acc: 0.825 Test Loss: 0.572 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 187372
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4105212688446045
Epoch: 1, Steps: 8 | Train Loss: 2.322 Vali Loss: 2.176 Vali Acc: 0.175 Test Loss: 2.176 Test Acc: 0.175
Validation loss decreased (inf --> -0.174978).  Saving model ...
Epoch: 2 cost time: 1.134434700012207
Epoch: 2, Steps: 8 | Train Loss: 2.169 Vali Loss: 2.016 Vali Acc: 0.247 Test Loss: 2.016 Test Acc: 0.247
Validation loss decreased (-0.174978 --> -0.246855).  Saving model ...
Epoch: 3 cost time: 0.8805851936340332
Epoch: 3, Steps: 8 | Train Loss: 2.018 Vali Loss: 1.905 Vali Acc: 0.316 Test Loss: 1.905 Test Acc: 0.316
Validation loss decreased (-0.246855 --> -0.315606).  Saving model ...
Epoch: 4 cost time: 1.185436725616455
Epoch: 4, Steps: 8 | Train Loss: 1.900 Vali Loss: 1.786 Vali Acc: 0.431 Test Loss: 1.786 Test Acc: 0.431
Validation loss decreased (-0.315606 --> -0.431232).  Saving model ...
Epoch: 5 cost time: 1.0304110050201416
Epoch: 5, Steps: 8 | Train Loss: 1.769 Vali Loss: 1.625 Vali Acc: 0.647 Test Loss: 1.625 Test Acc: 0.647
Validation loss decreased (-0.431232 --> -0.646859).  Saving model ...
Epoch: 6 cost time: 1.0585479736328125
Epoch: 6, Steps: 8 | Train Loss: 1.584 Vali Loss: 1.448 Vali Acc: 0.716 Test Loss: 1.448 Test Acc: 0.716
Validation loss decreased (-0.646859 --> -0.715611).  Saving model ...
Epoch: 7 cost time: 1.241253137588501
Epoch: 7, Steps: 8 | Train Loss: 1.390 Vali Loss: 1.244 Vali Acc: 0.759 Test Loss: 1.244 Test Acc: 0.759
Validation loss decreased (-0.715611 --> -0.759363).  Saving model ...
Epoch: 8 cost time: 1.1312439441680908
Epoch: 8, Steps: 8 | Train Loss: 1.191 Vali Loss: 1.047 Vali Acc: 0.775 Test Loss: 1.047 Test Acc: 0.775
Validation loss decreased (-0.759363 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 1.249070405960083
Epoch: 9, Steps: 8 | Train Loss: 0.948 Vali Loss: 0.881 Vali Acc: 0.778 Test Loss: 0.881 Test Acc: 0.778
Validation loss decreased (-0.774990 --> -0.778116).  Saving model ...
Epoch: 10 cost time: 1.4432768821716309
Epoch: 10, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.744 Vali Acc: 0.794 Test Loss: 0.744 Test Acc: 0.794
Validation loss decreased (-0.778116 --> -0.793743).  Saving model ...
Epoch: 11 cost time: 1.201916217803955
Epoch: 11, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.666 Vali Acc: 0.797 Test Loss: 0.666 Test Acc: 0.797
Validation loss decreased (-0.793743 --> -0.796868).  Saving model ...
Epoch: 12 cost time: 1.3296153545379639
Epoch: 12, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.616 Vali Acc: 0.806 Test Loss: 0.616 Test Acc: 0.806
Validation loss decreased (-0.796868 --> -0.806244).  Saving model ...
Epoch: 13 cost time: 1.1853089332580566
Epoch: 13, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.585 Vali Acc: 0.803 Test Loss: 0.585 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4455158710479736
Epoch: 14, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
Validation loss decreased (-0.806244 --> -0.809369).  Saving model ...
Epoch: 15 cost time: 1.2277605533599854
Epoch: 15, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818745).  Saving model ...
Epoch: 16 cost time: 1.469395399093628
Epoch: 16, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.529 Vali Acc: 0.834 Test Loss: 0.529 Test Acc: 0.834
Validation loss decreased (-0.818745 --> -0.834370).  Saving model ...
Epoch: 17 cost time: 1.1862149238586426
Epoch: 17, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 18 cost time: 1.1116292476654053
Epoch: 18, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
Validation loss decreased (-0.843745 --> -0.843745).  Saving model ...
Epoch: 19 cost time: 1.1710805892944336
Epoch: 19, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.175955057144165
Epoch: 20, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.528 Vali Acc: 0.834 Test Loss: 0.528 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2675771713256836
Epoch: 21, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.30228590965271
Epoch: 22, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.530 Vali Acc: 0.831 Test Loss: 0.530 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3310117721557617
Epoch: 23, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3095872402191162
Epoch: 24, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2017779350280762
Epoch: 25, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1740374565124512
Epoch: 26, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3405961990356445
Epoch: 27, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.370373249053955
Epoch: 28, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 186060
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.747795581817627
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 2.062 Vali Acc: 0.150 Test Loss: 2.062 Test Acc: 0.150
Validation loss decreased (inf --> -0.149979).  Saving model ...
Epoch: 2 cost time: 1.3996124267578125
Epoch: 2, Steps: 8 | Train Loss: 2.062 Vali Loss: 2.015 Vali Acc: 0.194 Test Loss: 2.015 Test Acc: 0.194
Validation loss decreased (-0.149979 --> -0.193730).  Saving model ...
Epoch: 3 cost time: 1.38751220703125
Epoch: 3, Steps: 8 | Train Loss: 2.026 Vali Loss: 1.949 Vali Acc: 0.325 Test Loss: 1.949 Test Acc: 0.325
Validation loss decreased (-0.193730 --> -0.324981).  Saving model ...
Epoch: 4 cost time: 1.318962574005127
Epoch: 4, Steps: 8 | Train Loss: 1.949 Vali Loss: 1.871 Vali Acc: 0.416 Test Loss: 1.871 Test Acc: 0.416
Validation loss decreased (-0.324981 --> -0.415606).  Saving model ...
Epoch: 5 cost time: 1.1882264614105225
Epoch: 5, Steps: 8 | Train Loss: 1.874 Vali Loss: 1.780 Vali Acc: 0.534 Test Loss: 1.780 Test Acc: 0.534
Validation loss decreased (-0.415606 --> -0.534357).  Saving model ...
Epoch: 6 cost time: 1.3977768421173096
Epoch: 6, Steps: 8 | Train Loss: 1.763 Vali Loss: 1.676 Vali Acc: 0.628 Test Loss: 1.676 Test Acc: 0.628
Validation loss decreased (-0.534357 --> -0.628108).  Saving model ...
Epoch: 7 cost time: 1.3663759231567383
Epoch: 7, Steps: 8 | Train Loss: 1.631 Vali Loss: 1.531 Vali Acc: 0.703 Test Loss: 1.531 Test Acc: 0.703
Validation loss decreased (-0.628108 --> -0.703110).  Saving model ...
Epoch: 8 cost time: 1.0221569538116455
Epoch: 8, Steps: 8 | Train Loss: 1.458 Vali Loss: 1.356 Vali Acc: 0.731 Test Loss: 1.356 Test Acc: 0.731
Validation loss decreased (-0.703110 --> -0.731236).  Saving model ...
Epoch: 9 cost time: 1.3401894569396973
Epoch: 9, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.164 Vali Acc: 0.759 Test Loss: 1.164 Test Acc: 0.759
Validation loss decreased (-0.731236 --> -0.759363).  Saving model ...
Epoch: 10 cost time: 1.7189357280731201
Epoch: 10, Steps: 8 | Train Loss: 1.072 Vali Loss: 0.996 Vali Acc: 0.744 Test Loss: 0.996 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1762721538543701
Epoch: 11, Steps: 8 | Train Loss: 0.856 Vali Loss: 0.843 Vali Acc: 0.781 Test Loss: 0.843 Test Acc: 0.781
Validation loss decreased (-0.759363 --> -0.781242).  Saving model ...
Epoch: 12 cost time: 1.4850640296936035
Epoch: 12, Steps: 8 | Train Loss: 0.736 Vali Loss: 0.744 Vali Acc: 0.784 Test Loss: 0.744 Test Acc: 0.784
Validation loss decreased (-0.781242 --> -0.784368).  Saving model ...
Epoch: 13 cost time: 1.385443925857544
Epoch: 13, Steps: 8 | Train Loss: 0.606 Vali Loss: 0.671 Vali Acc: 0.809 Test Loss: 0.671 Test Acc: 0.809
Validation loss decreased (-0.784368 --> -0.809368).  Saving model ...
Epoch: 14 cost time: 1.3391022682189941
Epoch: 14, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.627 Vali Acc: 0.816 Test Loss: 0.627 Test Acc: 0.816
Validation loss decreased (-0.809368 --> -0.815619).  Saving model ...
Epoch: 15 cost time: 1.4716334342956543
Epoch: 15, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.610 Vali Acc: 0.809 Test Loss: 0.610 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4114353656768799
Epoch: 16, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 17 cost time: 1.4122827053070068
Epoch: 17, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.570 Vali Acc: 0.812 Test Loss: 0.570 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3950316905975342
Epoch: 18, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1920084953308105
Epoch: 19, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.567 Vali Acc: 0.816 Test Loss: 0.567 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1829442977905273
Epoch: 20, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.567 Vali Acc: 0.812 Test Loss: 0.567 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2133147716522217
Epoch: 21, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.563 Vali Acc: 0.812 Test Loss: 0.563 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1705398559570312
Epoch: 22, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.559 Vali Acc: 0.809 Test Loss: 0.559 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.179821491241455
Epoch: 23, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.563725233078003
Epoch: 24, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.564 Vali Acc: 0.812 Test Loss: 0.564 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1380550861358643
Epoch: 25, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3344676494598389
Epoch: 26, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.81875
model parameter : 148396
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8664724826812744
Epoch: 1, Steps: 8 | Train Loss: 2.145 Vali Loss: 2.058 Vali Acc: 0.219 Test Loss: 2.058 Test Acc: 0.219
Validation loss decreased (inf --> -0.218729).  Saving model ...
Epoch: 2 cost time: 1.200596570968628
Epoch: 2, Steps: 8 | Train Loss: 2.058 Vali Loss: 1.986 Vali Acc: 0.253 Test Loss: 1.986 Test Acc: 0.253
Validation loss decreased (-0.218729 --> -0.253105).  Saving model ...
Epoch: 3 cost time: 1.0898017883300781
Epoch: 3, Steps: 8 | Train Loss: 1.993 Vali Loss: 1.913 Vali Acc: 0.388 Test Loss: 1.913 Test Acc: 0.388
Validation loss decreased (-0.253105 --> -0.387481).  Saving model ...
Epoch: 4 cost time: 1.1441075801849365
Epoch: 4, Steps: 8 | Train Loss: 1.896 Vali Loss: 1.825 Vali Acc: 0.497 Test Loss: 1.825 Test Acc: 0.497
Validation loss decreased (-0.387481 --> -0.496857).  Saving model ...
Epoch: 5 cost time: 1.0903854370117188
Epoch: 5, Steps: 8 | Train Loss: 1.787 Vali Loss: 1.714 Vali Acc: 0.650 Test Loss: 1.714 Test Acc: 0.650
Validation loss decreased (-0.496857 --> -0.649983).  Saving model ...
Epoch: 6 cost time: 1.1935539245605469
Epoch: 6, Steps: 8 | Train Loss: 1.700 Vali Loss: 1.577 Vali Acc: 0.759 Test Loss: 1.577 Test Acc: 0.759
Validation loss decreased (-0.649983 --> -0.759359).  Saving model ...
Epoch: 7 cost time: 0.9652767181396484
Epoch: 7, Steps: 8 | Train Loss: 1.520 Vali Loss: 1.408 Vali Acc: 0.753 Test Loss: 1.408 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6658685207366943
Epoch: 8, Steps: 8 | Train Loss: 1.348 Vali Loss: 1.219 Vali Acc: 0.762 Test Loss: 1.219 Test Acc: 0.762
Validation loss decreased (-0.759359 --> -0.762488).  Saving model ...
Epoch: 9 cost time: 1.253617525100708
Epoch: 9, Steps: 8 | Train Loss: 1.152 Vali Loss: 1.028 Vali Acc: 0.803 Test Loss: 1.028 Test Acc: 0.803
Validation loss decreased (-0.762488 --> -0.803115).  Saving model ...
Epoch: 10 cost time: 1.1072325706481934
Epoch: 10, Steps: 8 | Train Loss: 0.931 Vali Loss: 0.871 Vali Acc: 0.806 Test Loss: 0.871 Test Acc: 0.806
Validation loss decreased (-0.803115 --> -0.806241).  Saving model ...
Epoch: 11 cost time: 1.265218734741211
Epoch: 11, Steps: 8 | Train Loss: 0.781 Vali Loss: 0.757 Vali Acc: 0.812 Test Loss: 0.757 Test Acc: 0.812
Validation loss decreased (-0.806241 --> -0.812492).  Saving model ...
Epoch: 12 cost time: 1.2528331279754639
Epoch: 12, Steps: 8 | Train Loss: 0.604 Vali Loss: 0.688 Vali Acc: 0.809 Test Loss: 0.688 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.134258508682251
Epoch: 13, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.638 Vali Acc: 0.809 Test Loss: 0.638 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0663261413574219
Epoch: 14, Steps: 8 | Train Loss: 0.434 Vali Loss: 0.609 Vali Acc: 0.812 Test Loss: 0.609 Test Acc: 0.812
Validation loss decreased (-0.812492 --> -0.812494).  Saving model ...
Epoch: 15 cost time: 1.2773821353912354
Epoch: 15, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.591 Vali Acc: 0.812 Test Loss: 0.591 Test Acc: 0.812
Validation loss decreased (-0.812494 --> -0.812494).  Saving model ...
Epoch: 16 cost time: 1.4599463939666748
Epoch: 16, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.585 Vali Acc: 0.803 Test Loss: 0.585 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4869434833526611
Epoch: 17, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
Validation loss decreased (-0.812494 --> -0.815619).  Saving model ...
Epoch: 18 cost time: 1.1387174129486084
Epoch: 18, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.572 Vali Acc: 0.812 Test Loss: 0.572 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4168171882629395
Epoch: 19, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.581 Vali Acc: 0.806 Test Loss: 0.581 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4692974090576172
Epoch: 20, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.573 Vali Acc: 0.806 Test Loss: 0.573 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2694065570831299
Epoch: 21, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818744).  Saving model ...
Epoch: 22 cost time: 1.5551393032073975
Epoch: 22, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818744).  Saving model ...
Epoch: 23 cost time: 1.5296399593353271
Epoch: 23, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.572 Vali Acc: 0.812 Test Loss: 0.572 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1191399097442627
Epoch: 24, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.580 Vali Acc: 0.806 Test Loss: 0.580 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1280195713043213
Epoch: 25, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.589 Vali Acc: 0.800 Test Loss: 0.589 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2450487613677979
Epoch: 26, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.579 Vali Acc: 0.806 Test Loss: 0.579 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3293256759643555
Epoch: 27, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.573 Vali Acc: 0.828 Test Loss: 0.573 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 28 cost time: 1.1947638988494873
Epoch: 28, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.579 Vali Acc: 0.816 Test Loss: 0.579 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1008026599884033
Epoch: 29, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2778892517089844
Epoch: 30, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.602 Vali Acc: 0.797 Test Loss: 0.602 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.185558557510376
Epoch: 31, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2975742816925049
Epoch: 32, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0010616779327393
Epoch: 33, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.608 Vali Acc: 0.806 Test Loss: 0.608 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.055250644683838
Epoch: 34, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.611 Vali Acc: 0.809 Test Loss: 0.611 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.255925178527832
Epoch: 35, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.298598289489746
Epoch: 36, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.620 Vali Acc: 0.806 Test Loss: 0.620 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2155108451843262
Epoch: 37, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.628 Vali Acc: 0.812 Test Loss: 0.628 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 147084
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.5763697624206543
Epoch: 1, Steps: 8 | Train Loss: 2.186 Vali Loss: 2.077 Vali Acc: 0.163 Test Loss: 2.077 Test Acc: 0.163
Validation loss decreased (inf --> -0.162479).  Saving model ...
Epoch: 2 cost time: 1.3234825134277344
Epoch: 2, Steps: 8 | Train Loss: 2.052 Vali Loss: 1.954 Vali Acc: 0.222 Test Loss: 1.954 Test Acc: 0.222
Validation loss decreased (-0.162479 --> -0.221855).  Saving model ...
Epoch: 3 cost time: 1.1262047290802002
Epoch: 3, Steps: 8 | Train Loss: 1.919 Vali Loss: 1.868 Vali Acc: 0.331 Test Loss: 1.868 Test Acc: 0.331
Validation loss decreased (-0.221855 --> -0.331231).  Saving model ...
Epoch: 4 cost time: 1.1755592823028564
Epoch: 4, Steps: 8 | Train Loss: 1.879 Vali Loss: 1.782 Vali Acc: 0.400 Test Loss: 1.782 Test Acc: 0.400
Validation loss decreased (-0.331231 --> -0.399982).  Saving model ...
Epoch: 5 cost time: 1.467268943786621
Epoch: 5, Steps: 8 | Train Loss: 1.756 Vali Loss: 1.664 Vali Acc: 0.519 Test Loss: 1.664 Test Acc: 0.519
Validation loss decreased (-0.399982 --> -0.518733).  Saving model ...
Epoch: 6 cost time: 1.1969997882843018
Epoch: 6, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.518 Vali Acc: 0.688 Test Loss: 1.518 Test Acc: 0.688
Validation loss decreased (-0.518733 --> -0.687485).  Saving model ...
Epoch: 7 cost time: 1.3689477443695068
Epoch: 7, Steps: 8 | Train Loss: 1.479 Vali Loss: 1.361 Vali Acc: 0.697 Test Loss: 1.361 Test Acc: 0.697
Validation loss decreased (-0.687485 --> -0.696861).  Saving model ...
Epoch: 8 cost time: 1.2474350929260254
Epoch: 8, Steps: 8 | Train Loss: 1.276 Vali Loss: 1.191 Vali Acc: 0.744 Test Loss: 1.191 Test Acc: 0.744
Validation loss decreased (-0.696861 --> -0.743738).  Saving model ...
Epoch: 9 cost time: 1.055128812789917
Epoch: 9, Steps: 8 | Train Loss: 1.117 Vali Loss: 1.024 Vali Acc: 0.803 Test Loss: 1.024 Test Acc: 0.803
Validation loss decreased (-0.743738 --> -0.803115).  Saving model ...
Epoch: 10 cost time: 1.1540424823760986
Epoch: 10, Steps: 8 | Train Loss: 0.954 Vali Loss: 0.868 Vali Acc: 0.800 Test Loss: 0.868 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1020276546478271
Epoch: 11, Steps: 8 | Train Loss: 0.730 Vali Loss: 0.748 Vali Acc: 0.816 Test Loss: 0.748 Test Acc: 0.816
Validation loss decreased (-0.803115 --> -0.815618).  Saving model ...
Epoch: 12 cost time: 1.3767192363739014
Epoch: 12, Steps: 8 | Train Loss: 0.649 Vali Loss: 0.666 Vali Acc: 0.819 Test Loss: 0.666 Test Acc: 0.819
Validation loss decreased (-0.815618 --> -0.818743).  Saving model ...
Epoch: 13 cost time: 1.3783812522888184
Epoch: 13, Steps: 8 | Train Loss: 0.526 Vali Loss: 0.625 Vali Acc: 0.819 Test Loss: 0.625 Test Acc: 0.819
Validation loss decreased (-0.818743 --> -0.818744).  Saving model ...
Epoch: 14 cost time: 1.0956380367279053
Epoch: 14, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.587 Vali Acc: 0.825 Test Loss: 0.587 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 15 cost time: 1.3120219707489014
Epoch: 15, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.197023630142212
Epoch: 16, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.567 Vali Acc: 0.816 Test Loss: 0.567 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3955178260803223
Epoch: 17, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 18 cost time: 1.4760982990264893
Epoch: 18, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828120).  Saving model ...
Epoch: 19 cost time: 1.7557415962219238
Epoch: 19, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2891733646392822
Epoch: 20, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.539 Vali Acc: 0.831 Test Loss: 0.539 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 21 cost time: 0.9981069564819336
Epoch: 21, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 22 cost time: 1.4235384464263916
Epoch: 22, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3454370498657227
Epoch: 23, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.544 Vali Acc: 0.831 Test Loss: 0.544 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2501888275146484
Epoch: 24, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1768348217010498
Epoch: 25, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.553 Vali Acc: 0.831 Test Loss: 0.553 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1037652492523193
Epoch: 26, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.104313850402832
Epoch: 27, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.559 Vali Acc: 0.825 Test Loss: 0.559 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2664594650268555
Epoch: 28, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2876954078674316
Epoch: 29, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.475193738937378
Epoch: 30, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5989758968353271
Epoch: 31, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843744).  Saving model ...
Epoch: 32 cost time: 1.7013494968414307
Epoch: 32, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7608642578125
Epoch: 33, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.559 Vali Acc: 0.841 Test Loss: 0.559 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2309715747833252
Epoch: 34, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.567 Vali Acc: 0.834 Test Loss: 0.567 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4623751640319824
Epoch: 35, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.570 Vali Acc: 0.838 Test Loss: 0.570 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.5157134532928467
Epoch: 36, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.579 Vali Acc: 0.834 Test Loss: 0.579 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2976865768432617
Epoch: 37, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.583 Vali Acc: 0.841 Test Loss: 0.583 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0284175872802734
Epoch: 38, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.121833086013794
Epoch: 39, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.579 Vali Acc: 0.831 Test Loss: 0.579 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1858997344970703
Epoch: 40, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.586 Vali Acc: 0.825 Test Loss: 0.586 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0210909843444824
Epoch: 41, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.597 Vali Acc: 0.834 Test Loss: 0.597 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 145772
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1793923377990723
Epoch: 1, Steps: 8 | Train Loss: 2.219 Vali Loss: 2.165 Vali Acc: 0.141 Test Loss: 2.165 Test Acc: 0.141
Validation loss decreased (inf --> -0.140603).  Saving model ...
Epoch: 2 cost time: 1.2860753536224365
Epoch: 2, Steps: 8 | Train Loss: 2.177 Vali Loss: 2.080 Vali Acc: 0.159 Test Loss: 2.080 Test Acc: 0.159
Validation loss decreased (-0.140603 --> -0.159354).  Saving model ...
Epoch: 3 cost time: 1.0775666236877441
Epoch: 3, Steps: 8 | Train Loss: 2.057 Vali Loss: 2.005 Vali Acc: 0.250 Test Loss: 2.005 Test Acc: 0.250
Validation loss decreased (-0.159354 --> -0.249980).  Saving model ...
Epoch: 4 cost time: 1.1068999767303467
Epoch: 4, Steps: 8 | Train Loss: 1.985 Vali Loss: 1.908 Vali Acc: 0.409 Test Loss: 1.908 Test Acc: 0.409
Validation loss decreased (-0.249980 --> -0.409356).  Saving model ...
Epoch: 5 cost time: 1.2143058776855469
Epoch: 5, Steps: 8 | Train Loss: 1.896 Vali Loss: 1.798 Vali Acc: 0.497 Test Loss: 1.798 Test Acc: 0.497
Validation loss decreased (-0.409356 --> -0.496857).  Saving model ...
Epoch: 6 cost time: 0.9268021583557129
Epoch: 6, Steps: 8 | Train Loss: 1.792 Vali Loss: 1.663 Vali Acc: 0.669 Test Loss: 1.663 Test Acc: 0.669
Validation loss decreased (-0.496857 --> -0.668733).  Saving model ...
Epoch: 7 cost time: 1.0520737171173096
Epoch: 7, Steps: 8 | Train Loss: 1.585 Vali Loss: 1.492 Vali Acc: 0.719 Test Loss: 1.492 Test Acc: 0.719
Validation loss decreased (-0.668733 --> -0.718735).  Saving model ...
Epoch: 8 cost time: 1.0836033821105957
Epoch: 8, Steps: 8 | Train Loss: 1.500 Vali Loss: 1.310 Vali Acc: 0.728 Test Loss: 1.310 Test Acc: 0.728
Validation loss decreased (-0.718735 --> -0.728112).  Saving model ...
Epoch: 9 cost time: 1.1857209205627441
Epoch: 9, Steps: 8 | Train Loss: 1.241 Vali Loss: 1.109 Vali Acc: 0.787 Test Loss: 1.109 Test Acc: 0.787
Validation loss decreased (-0.728112 --> -0.787489).  Saving model ...
Epoch: 10 cost time: 1.137939691543579
Epoch: 10, Steps: 8 | Train Loss: 1.042 Vali Loss: 0.939 Vali Acc: 0.797 Test Loss: 0.939 Test Acc: 0.797
Validation loss decreased (-0.787489 --> -0.796866).  Saving model ...
Epoch: 11 cost time: 1.1389176845550537
Epoch: 11, Steps: 8 | Train Loss: 0.856 Vali Loss: 0.802 Vali Acc: 0.797 Test Loss: 0.802 Test Acc: 0.797
Validation loss decreased (-0.796866 --> -0.796867).  Saving model ...
Epoch: 12 cost time: 1.1045472621917725
Epoch: 12, Steps: 8 | Train Loss: 0.770 Vali Loss: 0.703 Vali Acc: 0.797 Test Loss: 0.703 Test Acc: 0.797
Validation loss decreased (-0.796867 --> -0.796868).  Saving model ...
Epoch: 13 cost time: 1.0644817352294922
Epoch: 13, Steps: 8 | Train Loss: 0.612 Vali Loss: 0.641 Vali Acc: 0.803 Test Loss: 0.641 Test Acc: 0.803
Validation loss decreased (-0.796868 --> -0.803119).  Saving model ...
Epoch: 14 cost time: 1.1359162330627441
Epoch: 14, Steps: 8 | Train Loss: 0.562 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
Validation loss decreased (-0.803119 --> -0.809369).  Saving model ...
Epoch: 15 cost time: 1.1908771991729736
Epoch: 15, Steps: 8 | Train Loss: 0.472 Vali Loss: 0.583 Vali Acc: 0.806 Test Loss: 0.583 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0677893161773682
Epoch: 16, Steps: 8 | Train Loss: 0.388 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821869).  Saving model ...
Epoch: 17 cost time: 1.1445775032043457
Epoch: 17, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.542 Vali Acc: 0.828 Test Loss: 0.542 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828120).  Saving model ...
Epoch: 18 cost time: 1.3179049491882324
Epoch: 18, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.273247480392456
Epoch: 19, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.549 Vali Acc: 0.812 Test Loss: 0.549 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2299320697784424
Epoch: 20, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.533 Vali Acc: 0.831 Test Loss: 0.533 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 21 cost time: 1.2474822998046875
Epoch: 21, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 22 cost time: 1.0154004096984863
Epoch: 22, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.20387864112854
Epoch: 23, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.554 Vali Acc: 0.819 Test Loss: 0.554 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3633840084075928
Epoch: 24, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.560 Vali Acc: 0.825 Test Loss: 0.560 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2685108184814453
Epoch: 25, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1994545459747314
Epoch: 26, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.544 Vali Acc: 0.834 Test Loss: 0.544 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1932151317596436
Epoch: 27, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3602685928344727
Epoch: 28, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.296755075454712
Epoch: 29, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.563 Vali Acc: 0.828 Test Loss: 0.563 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3446245193481445
Epoch: 30, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4287002086639404
Epoch: 31, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 144460
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.970945119857788
Epoch: 1, Steps: 8 | Train Loss: 2.106 Vali Loss: 1.842 Vali Acc: 0.475 Test Loss: 1.842 Test Acc: 0.475
Validation loss decreased (inf --> -0.474982).  Saving model ...
Epoch: 2 cost time: 0.9846103191375732
Epoch: 2, Steps: 8 | Train Loss: 1.646 Vali Loss: 1.215 Vali Acc: 0.725 Test Loss: 1.215 Test Acc: 0.725
Validation loss decreased (-0.474982 --> -0.724988).  Saving model ...
Epoch: 3 cost time: 0.8399317264556885
Epoch: 3, Steps: 8 | Train Loss: 1.086 Vali Loss: 0.783 Vali Acc: 0.787 Test Loss: 0.783 Test Acc: 0.787
Validation loss decreased (-0.724988 --> -0.787492).  Saving model ...
Epoch: 4 cost time: 0.9105594158172607
Epoch: 4, Steps: 8 | Train Loss: 0.710 Vali Loss: 0.626 Vali Acc: 0.819 Test Loss: 0.626 Test Acc: 0.819
Validation loss decreased (-0.787492 --> -0.818744).  Saving model ...
Epoch: 5 cost time: 0.9289929866790771
Epoch: 5, Steps: 8 | Train Loss: 0.481 Vali Loss: 0.638 Vali Acc: 0.803 Test Loss: 0.638 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9030337333679199
Epoch: 6, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.743 Vali Acc: 0.787 Test Loss: 0.743 Test Acc: 0.787
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0262012481689453
Epoch: 7, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.674 Vali Acc: 0.791 Test Loss: 0.674 Test Acc: 0.791
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0881364345550537
Epoch: 8, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.682 Vali Acc: 0.812 Test Loss: 0.682 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2553379535675049
Epoch: 9, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.754 Vali Acc: 0.806 Test Loss: 0.754 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9860570430755615
Epoch: 10, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.779 Vali Acc: 0.806 Test Loss: 0.779 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.276210069656372
Epoch: 11, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.842 Vali Acc: 0.812 Test Loss: 0.842 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1348161697387695
Epoch: 12, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.849 Vali Acc: 0.822 Test Loss: 0.849 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821867).  Saving model ...
Epoch: 13 cost time: 1.089613437652588
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.006 Vali Acc: 0.784 Test Loss: 1.006 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9600052833557129
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.018 Vali Acc: 0.800 Test Loss: 1.018 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8424725532531738
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.005 Vali Acc: 0.822 Test Loss: 1.005 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9683756828308105
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.058 Vali Acc: 0.812 Test Loss: 1.058 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.158616065979004
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.078 Vali Acc: 0.800 Test Loss: 1.078 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9312117099761963
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.068 Vali Acc: 0.806 Test Loss: 1.068 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0451560020446777
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.086 Vali Acc: 0.809 Test Loss: 1.086 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0377492904663086
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.103 Vali Acc: 0.812 Test Loss: 1.103 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0171866416931152
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.113 Vali Acc: 0.812 Test Loss: 1.113 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.030777931213379
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.114 Vali Acc: 0.812 Test Loss: 1.114 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.821875
model parameter : 4967712
model size : 23.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.217170000076294
Epoch: 1, Steps: 8 | Train Loss: 2.081 Vali Loss: 1.853 Vali Acc: 0.297 Test Loss: 1.853 Test Acc: 0.297
Validation loss decreased (inf --> -0.296856).  Saving model ...
Epoch: 2 cost time: 1.0919122695922852
Epoch: 2, Steps: 8 | Train Loss: 1.652 Vali Loss: 1.234 Vali Acc: 0.716 Test Loss: 1.234 Test Acc: 0.716
Validation loss decreased (-0.296856 --> -0.715613).  Saving model ...
Epoch: 3 cost time: 0.8094241619110107
Epoch: 3, Steps: 8 | Train Loss: 0.980 Vali Loss: 0.765 Vali Acc: 0.819 Test Loss: 0.765 Test Acc: 0.819
Validation loss decreased (-0.715613 --> -0.818742).  Saving model ...
Epoch: 4 cost time: 1.0354435443878174
Epoch: 4, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.618 Vali Acc: 0.775 Test Loss: 0.618 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9640862941741943
Epoch: 5, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.582 Vali Acc: 0.797 Test Loss: 0.582 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9153850078582764
Epoch: 6, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.695 Vali Acc: 0.791 Test Loss: 0.695 Test Acc: 0.791
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9949033260345459
Epoch: 7, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.633 Vali Acc: 0.800 Test Loss: 0.633 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3358750343322754
Epoch: 8, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.638 Vali Acc: 0.819 Test Loss: 0.638 Test Acc: 0.819
Validation loss decreased (-0.818742 --> -0.818744).  Saving model ...
Epoch: 9 cost time: 1.0658447742462158
Epoch: 9, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.713 Vali Acc: 0.800 Test Loss: 0.713 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0541443824768066
Epoch: 10, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.787 Vali Acc: 0.812 Test Loss: 0.787 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9942412376403809
Epoch: 11, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.845 Vali Acc: 0.819 Test Loss: 0.845 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9030551910400391
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.962 Vali Acc: 0.794 Test Loss: 0.962 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1692216396331787
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.986 Vali Acc: 0.819 Test Loss: 0.986 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2792141437530518
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.089 Vali Acc: 0.812 Test Loss: 1.089 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9961867332458496
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.085 Vali Acc: 0.809 Test Loss: 1.085 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1511180400848389
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.106 Vali Acc: 0.797 Test Loss: 1.106 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1546368598937988
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.096 Vali Acc: 0.800 Test Loss: 1.096 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0743227005004883
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.092 Vali Acc: 0.803 Test Loss: 1.092 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.81875
model parameter : 4960800
model size : 23.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9225237369537354
Epoch: 1, Steps: 8 | Train Loss: 2.091 Vali Loss: 1.863 Vali Acc: 0.341 Test Loss: 1.863 Test Acc: 0.341
Validation loss decreased (inf --> -0.340606).  Saving model ...
Epoch: 2 cost time: 1.149282693862915
Epoch: 2, Steps: 8 | Train Loss: 1.670 Vali Loss: 1.231 Vali Acc: 0.694 Test Loss: 1.231 Test Acc: 0.694
Validation loss decreased (-0.340606 --> -0.693738).  Saving model ...
Epoch: 3 cost time: 1.6224479675292969
Epoch: 3, Steps: 8 | Train Loss: 1.059 Vali Loss: 0.774 Vali Acc: 0.797 Test Loss: 0.774 Test Acc: 0.797
Validation loss decreased (-0.693738 --> -0.796867).  Saving model ...
Epoch: 4 cost time: 1.243286371231079
Epoch: 4, Steps: 8 | Train Loss: 0.625 Vali Loss: 0.579 Vali Acc: 0.841 Test Loss: 0.579 Test Acc: 0.841
Validation loss decreased (-0.796867 --> -0.840619).  Saving model ...
Epoch: 5 cost time: 0.9287033081054688
Epoch: 5, Steps: 8 | Train Loss: 0.451 Vali Loss: 0.577 Vali Acc: 0.812 Test Loss: 0.577 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8077096939086914
Epoch: 6, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3605952262878418
Epoch: 7, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.637 Vali Acc: 0.806 Test Loss: 0.637 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2146196365356445
Epoch: 8, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1244287490844727
Epoch: 9, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.702 Vali Acc: 0.816 Test Loss: 0.702 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0291409492492676
Epoch: 10, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.894 Vali Acc: 0.806 Test Loss: 0.894 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.206505298614502
Epoch: 11, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.848 Vali Acc: 0.812 Test Loss: 0.848 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2826471328735352
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.915 Vali Acc: 0.806 Test Loss: 0.915 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3167157173156738
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.980 Vali Acc: 0.797 Test Loss: 0.980 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.106717586517334
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.133 Vali Acc: 0.803 Test Loss: 1.133 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 4953888
model size : 23.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.202552556991577
Epoch: 1, Steps: 8 | Train Loss: 2.236 Vali Loss: 2.012 Vali Acc: 0.144 Test Loss: 2.012 Test Acc: 0.144
Validation loss decreased (inf --> -0.143730).  Saving model ...
Epoch: 2 cost time: 1.456313133239746
Epoch: 2, Steps: 8 | Train Loss: 1.774 Vali Loss: 1.343 Vali Acc: 0.647 Test Loss: 1.343 Test Acc: 0.647
Validation loss decreased (-0.143730 --> -0.646862).  Saving model ...
Epoch: 3 cost time: 0.9909660816192627
Epoch: 3, Steps: 8 | Train Loss: 1.163 Vali Loss: 0.820 Vali Acc: 0.791 Test Loss: 0.820 Test Acc: 0.791
Validation loss decreased (-0.646862 --> -0.790617).  Saving model ...
Epoch: 4 cost time: 0.9343178272247314
Epoch: 4, Steps: 8 | Train Loss: 0.708 Vali Loss: 0.699 Vali Acc: 0.759 Test Loss: 0.699 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1411213874816895
Epoch: 5, Steps: 8 | Train Loss: 0.500 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
Validation loss decreased (-0.790617 --> -0.824995).  Saving model ...
Epoch: 6 cost time: 0.9340646266937256
Epoch: 6, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.655 Vali Acc: 0.794 Test Loss: 0.655 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9812159538269043
Epoch: 7, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.619 Vali Acc: 0.825 Test Loss: 0.619 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0665605068206787
Epoch: 8, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.706 Vali Acc: 0.794 Test Loss: 0.706 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9794783592224121
Epoch: 9, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.105442762374878
Epoch: 10, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.687 Vali Acc: 0.809 Test Loss: 0.687 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9761581420898438
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.849 Vali Acc: 0.819 Test Loss: 0.849 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8829011917114258
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.834 Vali Acc: 0.838 Test Loss: 0.834 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837492).  Saving model ...
Epoch: 13 cost time: 0.9781639575958252
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.959 Vali Acc: 0.834 Test Loss: 0.959 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9751148223876953
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.157 Vali Acc: 0.797 Test Loss: 1.157 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.213317632675171
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.104 Vali Acc: 0.797 Test Loss: 1.104 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.055018424987793
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.075 Vali Acc: 0.803 Test Loss: 1.075 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0793259143829346
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.244 Vali Acc: 0.791 Test Loss: 1.244 Test Acc: 0.791
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0702056884765625
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.260 Vali Acc: 0.794 Test Loss: 1.260 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1569068431854248
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.291 Vali Acc: 0.787 Test Loss: 1.291 Test Acc: 0.787
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1272239685058594
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.288 Vali Acc: 0.784 Test Loss: 1.288 Test Acc: 0.784
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2346291542053223
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.293 Vali Acc: 0.800 Test Loss: 1.293 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3931422233581543
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.301 Vali Acc: 0.803 Test Loss: 1.301 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 4946976
model size : 23.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.120805025100708
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 1.866 Vali Acc: 0.325 Test Loss: 1.866 Test Acc: 0.325
Validation loss decreased (inf --> -0.324981).  Saving model ...
Epoch: 2 cost time: 1.153259038925171
Epoch: 2, Steps: 8 | Train Loss: 1.772 Vali Loss: 1.240 Vali Acc: 0.772 Test Loss: 1.240 Test Acc: 0.772
Validation loss decreased (-0.324981 --> -0.771863).  Saving model ...
Epoch: 3 cost time: 1.0989105701446533
Epoch: 3, Steps: 8 | Train Loss: 1.032 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
Validation loss decreased (-0.771863 --> -0.774992).  Saving model ...
Epoch: 4 cost time: 0.9202663898468018
Epoch: 4, Steps: 8 | Train Loss: 0.653 Vali Loss: 0.646 Vali Acc: 0.791 Test Loss: 0.646 Test Acc: 0.791
Validation loss decreased (-0.774992 --> -0.790619).  Saving model ...
Epoch: 5 cost time: 1.1022696495056152
Epoch: 5, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
Validation loss decreased (-0.790619 --> -0.809369).  Saving model ...
Epoch: 6 cost time: 1.0365221500396729
Epoch: 6, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.601 Vali Acc: 0.800 Test Loss: 0.601 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4178473949432373
Epoch: 7, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.666 Vali Acc: 0.800 Test Loss: 0.666 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3302631378173828
Epoch: 8, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
Validation loss decreased (-0.809369 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 1.1044251918792725
Epoch: 9, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.889 Vali Acc: 0.759 Test Loss: 0.889 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3533337116241455
Epoch: 10, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.799 Vali Acc: 0.816 Test Loss: 0.799 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4497227668762207
Epoch: 11, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.771 Vali Acc: 0.816 Test Loss: 0.771 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1520745754241943
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.087 Vali Acc: 0.797 Test Loss: 1.087 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.069540023803711
Epoch: 13, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.194 Vali Acc: 0.759 Test Loss: 1.194 Test Acc: 0.759
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.122208833694458
Epoch: 14, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.178 Vali Acc: 0.809 Test Loss: 1.178 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.043363332748413
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.210 Vali Acc: 0.809 Test Loss: 1.210 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1268889904022217
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.150 Vali Acc: 0.825 Test Loss: 1.150 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1731102466583252
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.209 Vali Acc: 0.816 Test Loss: 1.209 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0421855449676514
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.238 Vali Acc: 0.800 Test Loss: 1.238 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.825
model parameter : 4179744
model size : 20.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7357494831085205
Epoch: 1, Steps: 8 | Train Loss: 2.225 Vali Loss: 1.912 Vali Acc: 0.256 Test Loss: 1.912 Test Acc: 0.256
Validation loss decreased (inf --> -0.256231).  Saving model ...
Epoch: 2 cost time: 1.245814323425293
Epoch: 2, Steps: 8 | Train Loss: 1.821 Vali Loss: 1.291 Vali Acc: 0.772 Test Loss: 1.291 Test Acc: 0.772
Validation loss decreased (-0.256231 --> -0.771862).  Saving model ...
Epoch: 3 cost time: 1.0551526546478271
Epoch: 3, Steps: 8 | Train Loss: 1.178 Vali Loss: 0.886 Vali Acc: 0.791 Test Loss: 0.886 Test Acc: 0.791
Validation loss decreased (-0.771862 --> -0.790616).  Saving model ...
Epoch: 4 cost time: 1.1281468868255615
Epoch: 4, Steps: 8 | Train Loss: 0.792 Vali Loss: 0.655 Vali Acc: 0.791 Test Loss: 0.655 Test Acc: 0.791
Validation loss decreased (-0.790616 --> -0.790618).  Saving model ...
Epoch: 5 cost time: 1.247713565826416
Epoch: 5, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.619 Vali Acc: 0.797 Test Loss: 0.619 Test Acc: 0.797
Validation loss decreased (-0.790618 --> -0.796869).  Saving model ...
Epoch: 6 cost time: 0.9208638668060303
Epoch: 6, Steps: 8 | Train Loss: 0.403 Vali Loss: 0.602 Vali Acc: 0.800 Test Loss: 0.602 Test Acc: 0.800
Validation loss decreased (-0.796869 --> -0.799994).  Saving model ...
Epoch: 7 cost time: 1.2594914436340332
Epoch: 7, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.604 Vali Acc: 0.800 Test Loss: 0.604 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1232151985168457
Epoch: 8, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.682 Vali Acc: 0.809 Test Loss: 0.682 Test Acc: 0.809
Validation loss decreased (-0.799994 --> -0.809368).  Saving model ...
Epoch: 9 cost time: 1.0904788970947266
Epoch: 9, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.649 Vali Acc: 0.809 Test Loss: 0.649 Test Acc: 0.809
Validation loss decreased (-0.809368 --> -0.809369).  Saving model ...
Epoch: 10 cost time: 1.0066289901733398
Epoch: 10, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.827 Vali Acc: 0.806 Test Loss: 0.827 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0880987644195557
Epoch: 11, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.764 Vali Acc: 0.816 Test Loss: 0.764 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815617).  Saving model ...
Epoch: 12 cost time: 1.3952522277832031
Epoch: 12, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.827 Vali Acc: 0.806 Test Loss: 0.827 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.183328628540039
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.001 Vali Acc: 0.791 Test Loss: 1.001 Test Acc: 0.791
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0901668071746826
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.026 Vali Acc: 0.794 Test Loss: 1.026 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.044837474822998
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.103 Vali Acc: 0.819 Test Loss: 1.103 Test Acc: 0.819
Validation loss decreased (-0.815617 --> -0.818739).  Saving model ...
Epoch: 16 cost time: 1.0480461120605469
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.230 Vali Acc: 0.800 Test Loss: 1.230 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1002299785614014
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.224 Vali Acc: 0.797 Test Loss: 1.224 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0747923851013184
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.215 Vali Acc: 0.812 Test Loss: 1.215 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0510029792785645
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.242 Vali Acc: 0.806 Test Loss: 1.242 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0736262798309326
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.306 Vali Acc: 0.800 Test Loss: 1.306 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4473414421081543
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.255 Vali Acc: 0.791 Test Loss: 1.255 Test Acc: 0.791
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1995751857757568
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.233 Vali Acc: 0.791 Test Loss: 1.233 Test Acc: 0.791
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1411995887756348
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.229 Vali Acc: 0.797 Test Loss: 1.229 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.059061050415039
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.809 Test Loss: 1.229 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.037750244140625
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.812 Test Loss: 1.230 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.81875
model parameter : 4172832
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9932637214660645
Epoch: 1, Steps: 8 | Train Loss: 2.131 Vali Loss: 1.912 Vali Acc: 0.303 Test Loss: 1.912 Test Acc: 0.303
Validation loss decreased (inf --> -0.303106).  Saving model ...
Epoch: 2 cost time: 1.0508475303649902
Epoch: 2, Steps: 8 | Train Loss: 1.822 Vali Loss: 1.322 Vali Acc: 0.672 Test Loss: 1.322 Test Acc: 0.672
Validation loss decreased (-0.303106 --> -0.671862).  Saving model ...
Epoch: 3 cost time: 0.950667142868042
Epoch: 3, Steps: 8 | Train Loss: 1.178 Vali Loss: 0.863 Vali Acc: 0.769 Test Loss: 0.863 Test Acc: 0.769
Validation loss decreased (-0.671862 --> -0.768741).  Saving model ...
Epoch: 4 cost time: 1.0271925926208496
Epoch: 4, Steps: 8 | Train Loss: 0.743 Vali Loss: 0.649 Vali Acc: 0.797 Test Loss: 0.649 Test Acc: 0.797
Validation loss decreased (-0.768741 --> -0.796869).  Saving model ...
Epoch: 5 cost time: 0.9923765659332275
Epoch: 5, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.637 Vali Acc: 0.781 Test Loss: 0.637 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9733767509460449
Epoch: 6, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.685 Vali Acc: 0.778 Test Loss: 0.685 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9063913822174072
Epoch: 7, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.647 Vali Acc: 0.797 Test Loss: 0.647 Test Acc: 0.797
Validation loss decreased (-0.796869 --> -0.796869).  Saving model ...
Epoch: 8 cost time: 1.037388563156128
Epoch: 8, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.800 Vali Acc: 0.762 Test Loss: 0.800 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.123154640197754
Epoch: 9, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.832 Vali Acc: 0.753 Test Loss: 0.832 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3381154537200928
Epoch: 10, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.947 Vali Acc: 0.781 Test Loss: 0.947 Test Acc: 0.781
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0608465671539307
Epoch: 11, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.716 Vali Acc: 0.819 Test Loss: 0.716 Test Acc: 0.819
Validation loss decreased (-0.796869 --> -0.818743).  Saving model ...
Epoch: 12 cost time: 1.1477680206298828
Epoch: 12, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.909 Vali Acc: 0.791 Test Loss: 0.909 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.096768856048584
Epoch: 13, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.022 Vali Acc: 0.806 Test Loss: 1.022 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0007023811340332
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.172 Vali Acc: 0.784 Test Loss: 1.172 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2323215007781982
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.310 Vali Acc: 0.778 Test Loss: 1.310 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9209225177764893
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.185 Vali Acc: 0.809 Test Loss: 1.185 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0959138870239258
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.189 Vali Acc: 0.809 Test Loss: 1.189 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0874035358428955
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.176 Vali Acc: 0.809 Test Loss: 1.176 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1525776386260986
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.178 Vali Acc: 0.819 Test Loss: 1.178 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0564112663269043
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.183 Vali Acc: 0.809 Test Loss: 1.183 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3312880992889404
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.191 Vali Acc: 0.809 Test Loss: 1.191 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.81875
model parameter : 4165920
model size : 20.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.806659460067749
Epoch: 1, Steps: 8 | Train Loss: 2.170 Vali Loss: 1.930 Vali Acc: 0.350 Test Loss: 1.930 Test Acc: 0.350
Validation loss decreased (inf --> -0.349981).  Saving model ...
Epoch: 2 cost time: 1.033503532409668
Epoch: 2, Steps: 8 | Train Loss: 1.776 Vali Loss: 1.330 Vali Acc: 0.706 Test Loss: 1.330 Test Acc: 0.706
Validation loss decreased (-0.349981 --> -0.706237).  Saving model ...
Epoch: 3 cost time: 1.1235191822052002
Epoch: 3, Steps: 8 | Train Loss: 1.152 Vali Loss: 0.879 Vali Acc: 0.791 Test Loss: 0.879 Test Acc: 0.791
Validation loss decreased (-0.706237 --> -0.790616).  Saving model ...
Epoch: 4 cost time: 1.1038997173309326
Epoch: 4, Steps: 8 | Train Loss: 0.765 Vali Loss: 0.691 Vali Acc: 0.766 Test Loss: 0.691 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2169437408447266
Epoch: 5, Steps: 8 | Train Loss: 0.526 Vali Loss: 0.703 Vali Acc: 0.759 Test Loss: 0.703 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1493101119995117
Epoch: 6, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.627 Vali Acc: 0.794 Test Loss: 0.627 Test Acc: 0.794
Validation loss decreased (-0.790616 --> -0.793744).  Saving model ...
Epoch: 7 cost time: 1.3577897548675537
Epoch: 7, Steps: 8 | Train Loss: 0.340 Vali Loss: 0.700 Vali Acc: 0.762 Test Loss: 0.700 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2378029823303223
Epoch: 8, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.726 Vali Acc: 0.809 Test Loss: 0.726 Test Acc: 0.809
Validation loss decreased (-0.793744 --> -0.809368).  Saving model ...
Epoch: 9 cost time: 1.0620713233947754
Epoch: 9, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.868 Vali Acc: 0.778 Test Loss: 0.868 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1776683330535889
Epoch: 10, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.219 Vali Acc: 0.681 Test Loss: 1.219 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.124525547027588
Epoch: 11, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.898 Vali Acc: 0.772 Test Loss: 0.898 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3481509685516357
Epoch: 12, Steps: 8 | Train Loss: 0.339 Vali Loss: 0.979 Vali Acc: 0.784 Test Loss: 0.979 Test Acc: 0.784
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0175061225891113
Epoch: 13, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.103 Vali Acc: 0.794 Test Loss: 1.103 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0983541011810303
Epoch: 14, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.034 Vali Acc: 0.794 Test Loss: 1.034 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2325987815856934
Epoch: 15, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.023 Vali Acc: 0.819 Test Loss: 1.023 Test Acc: 0.819
Validation loss decreased (-0.809368 --> -0.818740).  Saving model ...
Epoch: 16 cost time: 0.8794982433319092
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.222 Vali Acc: 0.781 Test Loss: 1.222 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9993784427642822
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.315 Vali Acc: 0.772 Test Loss: 1.315 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3643500804901123
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.402 Vali Acc: 0.784 Test Loss: 1.402 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3245258331298828
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.396 Vali Acc: 0.791 Test Loss: 1.396 Test Acc: 0.791
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1285908222198486
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.344 Vali Acc: 0.800 Test Loss: 1.344 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0396511554718018
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.264 Vali Acc: 0.812 Test Loss: 1.264 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0880684852600098
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.231 Vali Acc: 0.816 Test Loss: 1.231 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.237516164779663
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.215 Vali Acc: 0.816 Test Loss: 1.215 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.042102336883545
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.819 Test Loss: 1.213 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9819357395172119
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.816 Test Loss: 1.216 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.81875
model parameter : 4159008
model size : 20.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.2425413131713867
Epoch: 1, Steps: 8 | Train Loss: 2.192 Vali Loss: 1.929 Vali Acc: 0.331 Test Loss: 1.929 Test Acc: 0.331
Validation loss decreased (inf --> -0.331231).  Saving model ...
Epoch: 2 cost time: 1.1980297565460205
Epoch: 2, Steps: 8 | Train Loss: 1.746 Vali Loss: 1.291 Vali Acc: 0.759 Test Loss: 1.291 Test Acc: 0.759
Validation loss decreased (-0.331231 --> -0.759362).  Saving model ...
Epoch: 3 cost time: 1.014688491821289
Epoch: 3, Steps: 8 | Train Loss: 1.115 Vali Loss: 0.867 Vali Acc: 0.750 Test Loss: 0.867 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5760376453399658
Epoch: 4, Steps: 8 | Train Loss: 0.750 Vali Loss: 0.622 Vali Acc: 0.847 Test Loss: 0.622 Test Acc: 0.847
Validation loss decreased (-0.759362 --> -0.846869).  Saving model ...
Epoch: 5 cost time: 1.0435638427734375
Epoch: 5, Steps: 8 | Train Loss: 0.536 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.3635227680206299
Epoch: 6, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.577 Vali Acc: 0.816 Test Loss: 0.577 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2549641132354736
Epoch: 7, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.636 Vali Acc: 0.791 Test Loss: 0.636 Test Acc: 0.791
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2625772953033447
Epoch: 8, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.702 Vali Acc: 0.784 Test Loss: 0.702 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2494604587554932
Epoch: 9, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.669 Vali Acc: 0.809 Test Loss: 0.669 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3213512897491455
Epoch: 10, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.719 Vali Acc: 0.812 Test Loss: 0.719 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1733310222625732
Epoch: 11, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.760 Vali Acc: 0.806 Test Loss: 0.760 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.263974905014038
Epoch: 12, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.874 Vali Acc: 0.803 Test Loss: 0.874 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3133959770202637
Epoch: 13, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.948 Vali Acc: 0.812 Test Loss: 0.948 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0656089782714844
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.045 Vali Acc: 0.819 Test Loss: 1.045 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.11275053024292
Epoch: 15, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.045 Vali Acc: 0.784 Test Loss: 1.045 Test Acc: 0.784
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 3785760
model size : 19.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.148756742477417
Epoch: 1, Steps: 8 | Train Loss: 2.199 Vali Loss: 1.960 Vali Acc: 0.394 Test Loss: 1.960 Test Acc: 0.394
Validation loss decreased (inf --> -0.393730).  Saving model ...
Epoch: 2 cost time: 1.2240381240844727
Epoch: 2, Steps: 8 | Train Loss: 1.741 Vali Loss: 1.312 Vali Acc: 0.716 Test Loss: 1.312 Test Acc: 0.716
Validation loss decreased (-0.393730 --> -0.715612).  Saving model ...
Epoch: 3 cost time: 1.1302554607391357
Epoch: 3, Steps: 8 | Train Loss: 1.067 Vali Loss: 0.855 Vali Acc: 0.775 Test Loss: 0.855 Test Acc: 0.775
Validation loss decreased (-0.715612 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 0.9436640739440918
Epoch: 4, Steps: 8 | Train Loss: 0.774 Vali Loss: 0.613 Vali Acc: 0.819 Test Loss: 0.613 Test Acc: 0.819
Validation loss decreased (-0.774991 --> -0.818744).  Saving model ...
Epoch: 5 cost time: 0.9971790313720703
Epoch: 5, Steps: 8 | Train Loss: 0.553 Vali Loss: 0.552 Vali Acc: 0.831 Test Loss: 0.552 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831244).  Saving model ...
Epoch: 6 cost time: 0.9888885021209717
Epoch: 6, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.580 Vali Acc: 0.816 Test Loss: 0.580 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3869128227233887
Epoch: 7, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.617 Vali Acc: 0.809 Test Loss: 0.617 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.120748519897461
Epoch: 8, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.678 Vali Acc: 0.806 Test Loss: 0.678 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1305346488952637
Epoch: 9, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.709 Vali Acc: 0.806 Test Loss: 0.709 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2570281028747559
Epoch: 10, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.678 Vali Acc: 0.809 Test Loss: 0.678 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0181410312652588
Epoch: 11, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.803 Vali Acc: 0.825 Test Loss: 0.803 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0338213443756104
Epoch: 12, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.897 Vali Acc: 0.791 Test Loss: 0.897 Test Acc: 0.791
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2145376205444336
Epoch: 13, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.989 Vali Acc: 0.812 Test Loss: 0.989 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1016786098480225
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.087 Vali Acc: 0.766 Test Loss: 1.087 Test Acc: 0.766
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.194772481918335
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.216 Vali Acc: 0.794 Test Loss: 1.216 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 3778848
model size : 19.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1140172481536865
Epoch: 1, Steps: 8 | Train Loss: 2.221 Vali Loss: 1.944 Vali Acc: 0.241 Test Loss: 1.944 Test Acc: 0.241
Validation loss decreased (inf --> -0.240606).  Saving model ...
Epoch: 2 cost time: 0.8461999893188477
Epoch: 2, Steps: 8 | Train Loss: 1.708 Vali Loss: 1.281 Vali Acc: 0.747 Test Loss: 1.281 Test Acc: 0.747
Validation loss decreased (-0.240606 --> -0.746862).  Saving model ...
Epoch: 3 cost time: 0.9693431854248047
Epoch: 3, Steps: 8 | Train Loss: 1.130 Vali Loss: 0.871 Vali Acc: 0.738 Test Loss: 0.871 Test Acc: 0.738
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9523193836212158
Epoch: 4, Steps: 8 | Train Loss: 0.762 Vali Loss: 0.652 Vali Acc: 0.794 Test Loss: 0.652 Test Acc: 0.794
Validation loss decreased (-0.746862 --> -0.793743).  Saving model ...
Epoch: 5 cost time: 0.9646904468536377
Epoch: 5, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.703 Vali Acc: 0.778 Test Loss: 0.703 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0593373775482178
Epoch: 6, Steps: 8 | Train Loss: 0.468 Vali Loss: 0.538 Vali Acc: 0.838 Test Loss: 0.538 Test Acc: 0.838
Validation loss decreased (-0.793743 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 1.0357177257537842
Epoch: 7, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.629 Vali Acc: 0.809 Test Loss: 0.629 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.940352201461792
Epoch: 8, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.601 Vali Acc: 0.816 Test Loss: 0.601 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1509606838226318
Epoch: 9, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.757 Vali Acc: 0.797 Test Loss: 0.757 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0620200634002686
Epoch: 10, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.703 Vali Acc: 0.812 Test Loss: 0.703 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9481596946716309
Epoch: 11, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.859 Vali Acc: 0.800 Test Loss: 0.859 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9704034328460693
Epoch: 12, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.853 Vali Acc: 0.797 Test Loss: 0.853 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.111999273300171
Epoch: 13, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.053 Vali Acc: 0.794 Test Loss: 1.053 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9559428691864014
Epoch: 14, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.868 Vali Acc: 0.825 Test Loss: 0.868 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0097770690917969
Epoch: 15, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.935 Vali Acc: 0.809 Test Loss: 0.935 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0076088905334473
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.047 Vali Acc: 0.800 Test Loss: 1.047 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 3771936
model size : 19.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.523812770843506
Epoch: 1, Steps: 8 | Train Loss: 2.137 Vali Loss: 1.925 Vali Acc: 0.366 Test Loss: 1.925 Test Acc: 0.366
Validation loss decreased (inf --> -0.365606).  Saving model ...
Epoch: 2 cost time: 1.235795259475708
Epoch: 2, Steps: 8 | Train Loss: 1.715 Vali Loss: 1.317 Vali Acc: 0.716 Test Loss: 1.317 Test Acc: 0.716
Validation loss decreased (-0.365606 --> -0.715612).  Saving model ...
Epoch: 3 cost time: 1.1846487522125244
Epoch: 3, Steps: 8 | Train Loss: 1.284 Vali Loss: 0.835 Vali Acc: 0.809 Test Loss: 0.835 Test Acc: 0.809
Validation loss decreased (-0.715612 --> -0.809367).  Saving model ...
Epoch: 4 cost time: 1.0832042694091797
Epoch: 4, Steps: 8 | Train Loss: 0.948 Vali Loss: 0.658 Vali Acc: 0.803 Test Loss: 0.658 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2526051998138428
Epoch: 5, Steps: 8 | Train Loss: 0.585 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
Validation loss decreased (-0.809367 --> -0.831244).  Saving model ...
Epoch: 6 cost time: 1.2755167484283447
Epoch: 6, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5480937957763672
Epoch: 7, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.819 Vali Acc: 0.753 Test Loss: 0.819 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3643386363983154
Epoch: 8, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.914 Vali Acc: 0.784 Test Loss: 0.914 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2266860008239746
Epoch: 9, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.853 Vali Acc: 0.753 Test Loss: 0.853 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1939964294433594
Epoch: 10, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.927 Vali Acc: 0.778 Test Loss: 0.927 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2420709133148193
Epoch: 11, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.747 Vali Acc: 0.822 Test Loss: 0.747 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2823548316955566
Epoch: 12, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.772 Vali Acc: 0.812 Test Loss: 0.772 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0794458389282227
Epoch: 13, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.922 Vali Acc: 0.816 Test Loss: 0.922 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0157439708709717
Epoch: 14, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.975 Vali Acc: 0.797 Test Loss: 0.975 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2421855926513672
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.080 Vali Acc: 0.803 Test Loss: 1.080 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 3765024
model size : 19.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.941265821456909
Epoch: 1, Steps: 8 | Train Loss: 2.083 Vali Loss: 1.856 Vali Acc: 0.350 Test Loss: 1.856 Test Acc: 0.350
Validation loss decreased (inf --> -0.349981).  Saving model ...
Epoch: 2 cost time: 1.188572883605957
Epoch: 2, Steps: 8 | Train Loss: 1.715 Vali Loss: 1.285 Vali Acc: 0.684 Test Loss: 1.285 Test Acc: 0.684
Validation loss decreased (-0.349981 --> -0.684362).  Saving model ...
Epoch: 3 cost time: 1.1770210266113281
Epoch: 3, Steps: 8 | Train Loss: 1.126 Vali Loss: 0.885 Vali Acc: 0.806 Test Loss: 0.885 Test Acc: 0.806
Validation loss decreased (-0.684362 --> -0.806241).  Saving model ...
Epoch: 4 cost time: 1.2940688133239746
Epoch: 4, Steps: 8 | Train Loss: 0.744 Vali Loss: 0.728 Vali Acc: 0.775 Test Loss: 0.728 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.201977252960205
Epoch: 5, Steps: 8 | Train Loss: 0.623 Vali Loss: 0.680 Vali Acc: 0.769 Test Loss: 0.680 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0842232704162598
Epoch: 6, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.800 Vali Acc: 0.778 Test Loss: 0.800 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.274282455444336
Epoch: 7, Steps: 8 | Train Loss: 0.741 Vali Loss: 0.661 Vali Acc: 0.794 Test Loss: 0.661 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.041456699371338
Epoch: 8, Steps: 8 | Train Loss: 0.388 Vali Loss: 0.747 Vali Acc: 0.772 Test Loss: 0.747 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.964914083480835
Epoch: 9, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.756 Vali Acc: 0.772 Test Loss: 0.756 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9482827186584473
Epoch: 10, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.723 Vali Acc: 0.791 Test Loss: 0.723 Test Acc: 0.791
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0788977146148682
Epoch: 11, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.956 Vali Acc: 0.775 Test Loss: 0.956 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9382674694061279
Epoch: 12, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.873 Vali Acc: 0.812 Test Loss: 0.873 Test Acc: 0.812
Validation loss decreased (-0.806241 --> -0.812491).  Saving model ...
Epoch: 13 cost time: 0.895397424697876
Epoch: 13, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.036 Vali Acc: 0.816 Test Loss: 1.036 Test Acc: 0.816
Validation loss decreased (-0.812491 --> -0.815615).  Saving model ...
Epoch: 14 cost time: 1.3191828727722168
Epoch: 14, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.150 Vali Acc: 0.800 Test Loss: 1.150 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3257384300231934
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.092 Vali Acc: 0.809 Test Loss: 1.092 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0010576248168945
Epoch: 16, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.364 Vali Acc: 0.784 Test Loss: 1.364 Test Acc: 0.784
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0554492473602295
Epoch: 17, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.514 Vali Acc: 0.787 Test Loss: 1.514 Test Acc: 0.787
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.075026512145996
Epoch: 18, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.400 Vali Acc: 0.784 Test Loss: 1.400 Test Acc: 0.784
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.214134693145752
Epoch: 19, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.405 Vali Acc: 0.775 Test Loss: 1.405 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9240078926086426
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.637 Vali Acc: 0.769 Test Loss: 1.637 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.206235408782959
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.713 Vali Acc: 0.769 Test Loss: 1.713 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.300210952758789
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.611 Vali Acc: 0.778 Test Loss: 1.611 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9827823638916016
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.548 Vali Acc: 0.787 Test Loss: 1.548 Test Acc: 0.787
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.815625
model parameter : 3588768
model size : 18.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.795138359069824
Epoch: 1, Steps: 8 | Train Loss: 2.124 Vali Loss: 1.915 Vali Acc: 0.247 Test Loss: 1.915 Test Acc: 0.247
Validation loss decreased (inf --> -0.246856).  Saving model ...
Epoch: 2 cost time: 0.9152233600616455
Epoch: 2, Steps: 8 | Train Loss: 1.783 Vali Loss: 1.318 Vali Acc: 0.688 Test Loss: 1.318 Test Acc: 0.688
Validation loss decreased (-0.246856 --> -0.687487).  Saving model ...
Epoch: 3 cost time: 0.8820221424102783
Epoch: 3, Steps: 8 | Train Loss: 1.132 Vali Loss: 0.840 Vali Acc: 0.803 Test Loss: 0.840 Test Acc: 0.803
Validation loss decreased (-0.687487 --> -0.803117).  Saving model ...
Epoch: 4 cost time: 0.7872569561004639
Epoch: 4, Steps: 8 | Train Loss: 0.724 Vali Loss: 0.619 Vali Acc: 0.816 Test Loss: 0.619 Test Acc: 0.816
Validation loss decreased (-0.803117 --> -0.815619).  Saving model ...
Epoch: 5 cost time: 0.775320291519165
Epoch: 5, Steps: 8 | Train Loss: 0.554 Vali Loss: 0.590 Vali Acc: 0.806 Test Loss: 0.590 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8214542865753174
Epoch: 6, Steps: 8 | Train Loss: 0.509 Vali Loss: 0.611 Vali Acc: 0.794 Test Loss: 0.611 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1108109951019287
Epoch: 7, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.718 Vali Acc: 0.766 Test Loss: 0.718 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8150477409362793
Epoch: 8, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.687 Vali Acc: 0.791 Test Loss: 0.687 Test Acc: 0.791
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8773765563964844
Epoch: 9, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.673 Vali Acc: 0.816 Test Loss: 0.673 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7712626457214355
Epoch: 10, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.719 Vali Acc: 0.800 Test Loss: 0.719 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2365269660949707
Epoch: 11, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.737 Vali Acc: 0.819 Test Loss: 0.737 Test Acc: 0.819
Validation loss decreased (-0.815619 --> -0.818743).  Saving model ...
Epoch: 12 cost time: 0.8396916389465332
Epoch: 12, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.840 Vali Acc: 0.806 Test Loss: 0.840 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9805605411529541
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.816 Vali Acc: 0.812 Test Loss: 0.816 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9477698802947998
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.028 Vali Acc: 0.800 Test Loss: 1.028 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8151533603668213
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.974 Vali Acc: 0.800 Test Loss: 0.974 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0854225158691406
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.009 Vali Acc: 0.819 Test Loss: 1.009 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8793692588806152
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.201 Vali Acc: 0.787 Test Loss: 1.201 Test Acc: 0.787
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.055358648300171
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.220 Vali Acc: 0.784 Test Loss: 1.220 Test Acc: 0.784
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9157624244689941
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.143 Vali Acc: 0.800 Test Loss: 1.143 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9884884357452393
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.081 Vali Acc: 0.806 Test Loss: 1.081 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3181657791137695
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.070 Vali Acc: 0.816 Test Loss: 1.070 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.81875
model parameter : 3581856
model size : 18.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1621062755584717
Epoch: 1, Steps: 8 | Train Loss: 2.160 Vali Loss: 1.923 Vali Acc: 0.278 Test Loss: 1.923 Test Acc: 0.278
Validation loss decreased (inf --> -0.278106).  Saving model ...
Epoch: 2 cost time: 1.0370628833770752
Epoch: 2, Steps: 8 | Train Loss: 1.722 Vali Loss: 1.309 Vali Acc: 0.731 Test Loss: 1.309 Test Acc: 0.731
Validation loss decreased (-0.278106 --> -0.731237).  Saving model ...
Epoch: 3 cost time: 1.0528912544250488
Epoch: 3, Steps: 8 | Train Loss: 1.133 Vali Loss: 0.862 Vali Acc: 0.778 Test Loss: 0.862 Test Acc: 0.778
Validation loss decreased (-0.731237 --> -0.778116).  Saving model ...
Epoch: 4 cost time: 1.1454157829284668
Epoch: 4, Steps: 8 | Train Loss: 0.708 Vali Loss: 0.729 Vali Acc: 0.756 Test Loss: 0.729 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0459542274475098
Epoch: 5, Steps: 8 | Train Loss: 0.554 Vali Loss: 0.634 Vali Acc: 0.781 Test Loss: 0.634 Test Acc: 0.781
Validation loss decreased (-0.778116 --> -0.781244).  Saving model ...
Epoch: 6 cost time: 1.1924943923950195
Epoch: 6, Steps: 8 | Train Loss: 0.419 Vali Loss: 0.597 Vali Acc: 0.803 Test Loss: 0.597 Test Acc: 0.803
Validation loss decreased (-0.781244 --> -0.803119).  Saving model ...
Epoch: 7 cost time: 0.9524734020233154
Epoch: 7, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.650 Vali Acc: 0.797 Test Loss: 0.650 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9304275512695312
Epoch: 8, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
Validation loss decreased (-0.803119 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 1.0574181079864502
Epoch: 9, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.631 Vali Acc: 0.800 Test Loss: 0.631 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8758876323699951
Epoch: 10, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.812 Vali Acc: 0.791 Test Loss: 0.812 Test Acc: 0.791
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9492354393005371
Epoch: 11, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.749 Vali Acc: 0.825 Test Loss: 0.749 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824993).  Saving model ...
Epoch: 12 cost time: 0.9558320045471191
Epoch: 12, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.820 Vali Acc: 0.803 Test Loss: 0.820 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9179520606994629
Epoch: 13, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.024 Vali Acc: 0.803 Test Loss: 1.024 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9994497299194336
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.078 Vali Acc: 0.803 Test Loss: 1.078 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8786458969116211
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.163 Vali Acc: 0.797 Test Loss: 1.163 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0400049686431885
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.445 Vali Acc: 0.781 Test Loss: 1.445 Test Acc: 0.781
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.094226360321045
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.312 Vali Acc: 0.778 Test Loss: 1.312 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9383354187011719
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.287 Vali Acc: 0.787 Test Loss: 1.287 Test Acc: 0.787
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9131002426147461
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.302 Vali Acc: 0.797 Test Loss: 1.302 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1207516193389893
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.289 Vali Acc: 0.803 Test Loss: 1.289 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0799319744110107
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.285 Vali Acc: 0.797 Test Loss: 1.285 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.825
model parameter : 3574944
model size : 18.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0192363262176514
Epoch: 1, Steps: 8 | Train Loss: 2.202 Vali Loss: 1.933 Vali Acc: 0.231 Test Loss: 1.933 Test Acc: 0.231
Validation loss decreased (inf --> -0.231231).  Saving model ...
Epoch: 2 cost time: 0.9267418384552002
Epoch: 2, Steps: 8 | Train Loss: 1.781 Vali Loss: 1.301 Vali Acc: 0.650 Test Loss: 1.301 Test Acc: 0.650
Validation loss decreased (-0.231231 --> -0.649987).  Saving model ...
Epoch: 3 cost time: 1.0587384700775146
Epoch: 3, Steps: 8 | Train Loss: 1.225 Vali Loss: 0.858 Vali Acc: 0.784 Test Loss: 0.858 Test Acc: 0.784
Validation loss decreased (-0.649987 --> -0.784366).  Saving model ...
Epoch: 4 cost time: 1.2906582355499268
Epoch: 4, Steps: 8 | Train Loss: 0.803 Vali Loss: 0.695 Vali Acc: 0.778 Test Loss: 0.695 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8248696327209473
Epoch: 5, Steps: 8 | Train Loss: 0.564 Vali Loss: 0.617 Vali Acc: 0.809 Test Loss: 0.617 Test Acc: 0.809
Validation loss decreased (-0.784366 --> -0.809369).  Saving model ...
Epoch: 6 cost time: 0.847205400466919
Epoch: 6, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.612 Vali Acc: 0.809 Test Loss: 0.612 Test Acc: 0.809
Validation loss decreased (-0.809369 --> -0.809369).  Saving model ...
Epoch: 7 cost time: 0.9937739372253418
Epoch: 7, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.616 Vali Acc: 0.806 Test Loss: 0.616 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0175964832305908
Epoch: 8, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.612 Vali Acc: 0.816 Test Loss: 0.612 Test Acc: 0.816
Validation loss decreased (-0.809369 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.928931474685669
Epoch: 9, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.655 Vali Acc: 0.806 Test Loss: 0.655 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1568551063537598
Epoch: 10, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.713 Vali Acc: 0.816 Test Loss: 0.713 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0550713539123535
Epoch: 11, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.796 Vali Acc: 0.794 Test Loss: 0.796 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0149943828582764
Epoch: 12, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.800 Vali Acc: 0.806 Test Loss: 0.800 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9957866668701172
Epoch: 13, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.910 Vali Acc: 0.809 Test Loss: 0.910 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1454572677612305
Epoch: 14, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.893 Vali Acc: 0.825 Test Loss: 0.893 Test Acc: 0.825
Validation loss decreased (-0.815619 --> -0.824991).  Saving model ...
Epoch: 15 cost time: 0.9513373374938965
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.943 Vali Acc: 0.825 Test Loss: 0.943 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8520934581756592
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.979 Vali Acc: 0.831 Test Loss: 0.979 Test Acc: 0.831
Validation loss decreased (-0.824991 --> -0.831240).  Saving model ...
Epoch: 17 cost time: 0.9198505878448486
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.056 Vali Acc: 0.828 Test Loss: 1.056 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0747652053833008
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.999 Vali Acc: 0.831 Test Loss: 0.999 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0890145301818848
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.077 Vali Acc: 0.803 Test Loss: 1.077 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.080061435699463
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.163 Vali Acc: 0.806 Test Loss: 1.163 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9834043979644775
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.186 Vali Acc: 0.803 Test Loss: 1.186 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0027337074279785
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.180 Vali Acc: 0.809 Test Loss: 1.180 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9919099807739258
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.167 Vali Acc: 0.806 Test Loss: 1.167 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9916260242462158
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.164 Vali Acc: 0.809 Test Loss: 1.164 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9773430824279785
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.160 Vali Acc: 0.809 Test Loss: 1.160 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2238359451293945
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.156 Vali Acc: 0.809 Test Loss: 1.156 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 3568032
model size : 18.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.834825038909912
Epoch: 1, Steps: 8 | Train Loss: 2.189 Vali Loss: 1.991 Vali Acc: 0.259 Test Loss: 1.991 Test Acc: 0.259
Validation loss decreased (inf --> -0.259355).  Saving model ...
Epoch: 2 cost time: 1.0836164951324463
Epoch: 2, Steps: 8 | Train Loss: 1.916 Vali Loss: 1.638 Vali Acc: 0.484 Test Loss: 1.638 Test Acc: 0.484
Validation loss decreased (-0.259355 --> -0.484359).  Saving model ...
Epoch: 3 cost time: 1.045445203781128
Epoch: 3, Steps: 8 | Train Loss: 1.527 Vali Loss: 1.271 Vali Acc: 0.675 Test Loss: 1.271 Test Acc: 0.675
Validation loss decreased (-0.484359 --> -0.674987).  Saving model ...
Epoch: 4 cost time: 1.101088523864746
Epoch: 4, Steps: 8 | Train Loss: 1.084 Vali Loss: 0.893 Vali Acc: 0.781 Test Loss: 0.893 Test Acc: 0.781
Validation loss decreased (-0.674987 --> -0.781241).  Saving model ...
Epoch: 5 cost time: 1.1475138664245605
Epoch: 5, Steps: 8 | Train Loss: 0.766 Vali Loss: 0.654 Vali Acc: 0.822 Test Loss: 0.654 Test Acc: 0.822
Validation loss decreased (-0.781241 --> -0.821868).  Saving model ...
Epoch: 6 cost time: 1.0923593044281006
Epoch: 6, Steps: 8 | Train Loss: 0.532 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
Validation loss decreased (-0.821868 --> -0.843744).  Saving model ...
Epoch: 7 cost time: 1.0466525554656982
Epoch: 7, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.527 Vali Acc: 0.841 Test Loss: 0.527 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.158493995666504
Epoch: 8, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0370283126831055
Epoch: 9, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.606 Vali Acc: 0.812 Test Loss: 0.606 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9033911228179932
Epoch: 10, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0809056758880615
Epoch: 11, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.587 Vali Acc: 0.838 Test Loss: 0.587 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9744625091552734
Epoch: 12, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.633 Vali Acc: 0.831 Test Loss: 0.633 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2531726360321045
Epoch: 13, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.670 Vali Acc: 0.809 Test Loss: 0.670 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9353439807891846
Epoch: 14, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.748 Vali Acc: 0.819 Test Loss: 0.748 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9729456901550293
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.795 Vali Acc: 0.828 Test Loss: 0.795 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1199121475219727
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.783 Vali Acc: 0.831 Test Loss: 0.783 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 1698976
model size : 8.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8885338306427
Epoch: 1, Steps: 8 | Train Loss: 2.124 Vali Loss: 1.971 Vali Acc: 0.319 Test Loss: 1.971 Test Acc: 0.319
Validation loss decreased (inf --> -0.318730).  Saving model ...
Epoch: 2 cost time: 1.064866542816162
Epoch: 2, Steps: 8 | Train Loss: 1.988 Vali Loss: 1.656 Vali Acc: 0.519 Test Loss: 1.656 Test Acc: 0.519
Validation loss decreased (-0.318730 --> -0.518733).  Saving model ...
Epoch: 3 cost time: 1.0809283256530762
Epoch: 3, Steps: 8 | Train Loss: 1.440 Vali Loss: 1.252 Vali Acc: 0.688 Test Loss: 1.252 Test Acc: 0.688
Validation loss decreased (-0.518733 --> -0.687487).  Saving model ...
Epoch: 4 cost time: 1.0098092555999756
Epoch: 4, Steps: 8 | Train Loss: 1.100 Vali Loss: 0.924 Vali Acc: 0.800 Test Loss: 0.924 Test Acc: 0.800
Validation loss decreased (-0.687487 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 1.0024158954620361
Epoch: 5, Steps: 8 | Train Loss: 0.815 Vali Loss: 0.692 Vali Acc: 0.803 Test Loss: 0.692 Test Acc: 0.803
Validation loss decreased (-0.799991 --> -0.803118).  Saving model ...
Epoch: 6 cost time: 1.0700814723968506
Epoch: 6, Steps: 8 | Train Loss: 0.591 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
Validation loss decreased (-0.803118 --> -0.821869).  Saving model ...
Epoch: 7 cost time: 0.9668903350830078
Epoch: 7, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.538 Vali Acc: 0.816 Test Loss: 0.538 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9733483791351318
Epoch: 8, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821870).  Saving model ...
Epoch: 9 cost time: 1.1869151592254639
Epoch: 9, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.547 Vali Acc: 0.812 Test Loss: 0.547 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1483473777770996
Epoch: 10, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.578 Vali Acc: 0.828 Test Loss: 0.578 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828119).  Saving model ...
Epoch: 11 cost time: 1.0083558559417725
Epoch: 11, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.641 Vali Acc: 0.809 Test Loss: 0.641 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9678232669830322
Epoch: 12, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.647 Vali Acc: 0.825 Test Loss: 0.647 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.958775520324707
Epoch: 13, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.697 Vali Acc: 0.816 Test Loss: 0.697 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.862872838973999
Epoch: 14, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.733 Vali Acc: 0.822 Test Loss: 0.733 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8176732063293457
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.729 Vali Acc: 0.828 Test Loss: 0.729 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9374055862426758
Epoch: 16, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.780 Vali Acc: 0.825 Test Loss: 0.780 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2066655158996582
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.800 Vali Acc: 0.816 Test Loss: 0.800 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.906224250793457
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.794 Vali Acc: 0.828 Test Loss: 0.794 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0367155075073242
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.837 Vali Acc: 0.825 Test Loss: 0.837 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0565612316131592
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.870 Vali Acc: 0.816 Test Loss: 0.870 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 1695520
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1122684478759766
Epoch: 1, Steps: 8 | Train Loss: 2.128 Vali Loss: 1.943 Vali Acc: 0.284 Test Loss: 1.943 Test Acc: 0.284
Validation loss decreased (inf --> -0.284356).  Saving model ...
Epoch: 2 cost time: 1.2305407524108887
Epoch: 2, Steps: 8 | Train Loss: 1.890 Vali Loss: 1.618 Vali Acc: 0.591 Test Loss: 1.618 Test Acc: 0.591
Validation loss decreased (-0.284356 --> -0.590609).  Saving model ...
Epoch: 3 cost time: 1.2357659339904785
Epoch: 3, Steps: 8 | Train Loss: 1.463 Vali Loss: 1.229 Vali Acc: 0.731 Test Loss: 1.229 Test Acc: 0.731
Validation loss decreased (-0.590609 --> -0.731238).  Saving model ...
Epoch: 4 cost time: 1.0354225635528564
Epoch: 4, Steps: 8 | Train Loss: 1.055 Vali Loss: 0.887 Vali Acc: 0.775 Test Loss: 0.887 Test Acc: 0.775
Validation loss decreased (-0.731238 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 1.0808773040771484
Epoch: 5, Steps: 8 | Train Loss: 0.761 Vali Loss: 0.656 Vali Acc: 0.812 Test Loss: 0.656 Test Acc: 0.812
Validation loss decreased (-0.774991 --> -0.812493).  Saving model ...
Epoch: 6 cost time: 0.9714632034301758
Epoch: 6, Steps: 8 | Train Loss: 0.548 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
Validation loss decreased (-0.812493 --> -0.812494).  Saving model ...
Epoch: 7 cost time: 1.1118354797363281
Epoch: 7, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8861589431762695
Epoch: 8, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.587 Vali Acc: 0.806 Test Loss: 0.587 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9185295104980469
Epoch: 9, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.663 Vali Acc: 0.787 Test Loss: 0.663 Test Acc: 0.787
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9840757846832275
Epoch: 10, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.669 Vali Acc: 0.791 Test Loss: 0.669 Test Acc: 0.791
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0116379261016846
Epoch: 11, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.697 Vali Acc: 0.794 Test Loss: 0.697 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9715378284454346
Epoch: 12, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.719 Vali Acc: 0.809 Test Loss: 0.719 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9001619815826416
Epoch: 13, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.761 Vali Acc: 0.803 Test Loss: 0.761 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9944732189178467
Epoch: 14, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.705 Vali Acc: 0.822 Test Loss: 0.705 Test Acc: 0.822
Validation loss decreased (-0.812494 --> -0.821868).  Saving model ...
Epoch: 15 cost time: 0.8972196578979492
Epoch: 15, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.755 Vali Acc: 0.812 Test Loss: 0.755 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8789196014404297
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.763 Vali Acc: 0.825 Test Loss: 0.763 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 0.9128305912017822
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.813 Vali Acc: 0.828 Test Loss: 0.813 Test Acc: 0.828
Validation loss decreased (-0.824992 --> -0.828117).  Saving model ...
Epoch: 18 cost time: 0.9446613788604736
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.852 Vali Acc: 0.828 Test Loss: 0.852 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.964792013168335
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.828 Vali Acc: 0.834 Test Loss: 0.828 Test Acc: 0.834
Validation loss decreased (-0.828117 --> -0.834367).  Saving model ...
Epoch: 20 cost time: 1.1022496223449707
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.903 Vali Acc: 0.825 Test Loss: 0.903 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0107557773590088
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.885 Vali Acc: 0.819 Test Loss: 0.885 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1474153995513916
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.885 Vali Acc: 0.822 Test Loss: 0.885 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0141592025756836
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.905 Vali Acc: 0.828 Test Loss: 0.905 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.054009199142456
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.907 Vali Acc: 0.831 Test Loss: 0.907 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9798097610473633
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.911 Vali Acc: 0.831 Test Loss: 0.911 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9362115859985352
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.923 Vali Acc: 0.831 Test Loss: 0.923 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1531479358673096
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.936 Vali Acc: 0.831 Test Loss: 0.936 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.98335862159729
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.948 Vali Acc: 0.831 Test Loss: 0.948 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.109410285949707
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.951 Vali Acc: 0.834 Test Loss: 0.951 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 1692064
model size : 8.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.993863105773926
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 1.991 Vali Acc: 0.178 Test Loss: 1.991 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 1.1672210693359375
Epoch: 2, Steps: 8 | Train Loss: 1.950 Vali Loss: 1.703 Vali Acc: 0.362 Test Loss: 1.703 Test Acc: 0.362
Validation loss decreased (-0.178105 --> -0.362483).  Saving model ...
Epoch: 3 cost time: 1.2729687690734863
Epoch: 3, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.317 Vali Acc: 0.662 Test Loss: 1.317 Test Acc: 0.662
Validation loss decreased (-0.362483 --> -0.662487).  Saving model ...
Epoch: 4 cost time: 1.0000975131988525
Epoch: 4, Steps: 8 | Train Loss: 1.114 Vali Loss: 0.940 Vali Acc: 0.787 Test Loss: 0.940 Test Acc: 0.787
Validation loss decreased (-0.662487 --> -0.787491).  Saving model ...
Epoch: 5 cost time: 0.7992711067199707
Epoch: 5, Steps: 8 | Train Loss: 0.783 Vali Loss: 0.690 Vali Acc: 0.787 Test Loss: 0.690 Test Acc: 0.787
Validation loss decreased (-0.787491 --> -0.787493).  Saving model ...
Epoch: 6 cost time: 1.0319852828979492
Epoch: 6, Steps: 8 | Train Loss: 0.530 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
Validation loss decreased (-0.787493 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 1.0867435932159424
Epoch: 7, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.525 Vali Acc: 0.834 Test Loss: 0.525 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 1.189026117324829
Epoch: 8, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
Validation loss decreased (-0.834370 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 1.0540027618408203
Epoch: 9, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.589 Vali Acc: 0.809 Test Loss: 0.589 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1457901000976562
Epoch: 10, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.638 Vali Acc: 0.809 Test Loss: 0.638 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.051546573638916
Epoch: 11, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.603 Vali Acc: 0.831 Test Loss: 0.603 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2135589122772217
Epoch: 12, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.661 Vali Acc: 0.825 Test Loss: 0.661 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9393517971038818
Epoch: 13, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.663 Vali Acc: 0.822 Test Loss: 0.663 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.060755729675293
Epoch: 14, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.789 Vali Acc: 0.803 Test Loss: 0.789 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0475828647613525
Epoch: 15, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.737 Vali Acc: 0.825 Test Loss: 0.737 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1929891109466553
Epoch: 16, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.747 Vali Acc: 0.834 Test Loss: 0.747 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2527744770050049
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.810 Vali Acc: 0.822 Test Loss: 0.810 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2472219467163086
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.851 Vali Acc: 0.812 Test Loss: 0.851 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 1688608
model size : 8.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1002824306488037
Epoch: 1, Steps: 8 | Train Loss: 2.105 Vali Loss: 1.922 Vali Acc: 0.306 Test Loss: 1.922 Test Acc: 0.306
Validation loss decreased (inf --> -0.306231).  Saving model ...
Epoch: 2 cost time: 1.2380027770996094
Epoch: 2, Steps: 8 | Train Loss: 1.814 Vali Loss: 1.603 Vali Acc: 0.609 Test Loss: 1.603 Test Acc: 0.609
Validation loss decreased (-0.306231 --> -0.609359).  Saving model ...
Epoch: 3 cost time: 1.1411995887756348
Epoch: 3, Steps: 8 | Train Loss: 1.542 Vali Loss: 1.238 Vali Acc: 0.762 Test Loss: 1.238 Test Acc: 0.762
Validation loss decreased (-0.609359 --> -0.762488).  Saving model ...
Epoch: 4 cost time: 0.8847968578338623
Epoch: 4, Steps: 8 | Train Loss: 1.105 Vali Loss: 0.908 Vali Acc: 0.766 Test Loss: 0.908 Test Acc: 0.766
Validation loss decreased (-0.762488 --> -0.765616).  Saving model ...
Epoch: 5 cost time: 1.0444583892822266
Epoch: 5, Steps: 8 | Train Loss: 0.805 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
Validation loss decreased (-0.765616 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 1.2630856037139893
Epoch: 6, Steps: 8 | Train Loss: 0.592 Vali Loss: 0.590 Vali Acc: 0.828 Test Loss: 0.590 Test Acc: 0.828
Validation loss decreased (-0.799993 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 1.0081639289855957
Epoch: 7, Steps: 8 | Train Loss: 0.447 Vali Loss: 0.585 Vali Acc: 0.794 Test Loss: 0.585 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1141350269317627
Epoch: 8, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 1.0460169315338135
Epoch: 9, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2033615112304688
Epoch: 10, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1375930309295654
Epoch: 11, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2940497398376465
Epoch: 12, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.609 Vali Acc: 0.819 Test Loss: 0.609 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.22650146484375
Epoch: 13, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.650 Vali Acc: 0.828 Test Loss: 0.650 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3298516273498535
Epoch: 14, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.736 Vali Acc: 0.812 Test Loss: 0.736 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0301897525787354
Epoch: 15, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.700 Vali Acc: 0.819 Test Loss: 0.700 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.207524299621582
Epoch: 16, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.811 Vali Acc: 0.828 Test Loss: 0.811 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1661553382873535
Epoch: 17, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.873 Vali Acc: 0.819 Test Loss: 0.873 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2723236083984375
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.820 Vali Acc: 0.819 Test Loss: 0.820 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 1304224
model size : 7.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.900798797607422
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 2.038 Vali Acc: 0.253 Test Loss: 2.038 Test Acc: 0.253
Validation loss decreased (inf --> -0.253105).  Saving model ...
Epoch: 2 cost time: 1.1126797199249268
Epoch: 2, Steps: 8 | Train Loss: 1.969 Vali Loss: 1.711 Vali Acc: 0.537 Test Loss: 1.711 Test Acc: 0.537
Validation loss decreased (-0.253105 --> -0.537483).  Saving model ...
Epoch: 3 cost time: 1.0545132160186768
Epoch: 3, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.327 Vali Acc: 0.694 Test Loss: 1.327 Test Acc: 0.694
Validation loss decreased (-0.537483 --> -0.693737).  Saving model ...
Epoch: 4 cost time: 0.936985969543457
Epoch: 4, Steps: 8 | Train Loss: 1.165 Vali Loss: 1.019 Vali Acc: 0.753 Test Loss: 1.019 Test Acc: 0.753
Validation loss decreased (-0.693737 --> -0.753115).  Saving model ...
Epoch: 5 cost time: 1.52201247215271
Epoch: 5, Steps: 8 | Train Loss: 0.822 Vali Loss: 0.763 Vali Acc: 0.828 Test Loss: 0.763 Test Acc: 0.828
Validation loss decreased (-0.753115 --> -0.828117).  Saving model ...
Epoch: 6 cost time: 1.0304317474365234
Epoch: 6, Steps: 8 | Train Loss: 0.678 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1112737655639648
Epoch: 7, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
Validation loss decreased (-0.828117 --> -0.834369).  Saving model ...
Epoch: 8 cost time: 1.1048362255096436
Epoch: 8, Steps: 8 | Train Loss: 0.434 Vali Loss: 0.592 Vali Acc: 0.800 Test Loss: 0.592 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0412404537200928
Epoch: 9, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.547 Vali Acc: 0.834 Test Loss: 0.547 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 1.090388536453247
Epoch: 10, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.591 Vali Acc: 0.825 Test Loss: 0.591 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9519550800323486
Epoch: 11, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0863628387451172
Epoch: 12, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.628 Vali Acc: 0.797 Test Loss: 0.628 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0477073192596436
Epoch: 13, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.616 Vali Acc: 0.828 Test Loss: 0.616 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1989939212799072
Epoch: 14, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.677 Vali Acc: 0.809 Test Loss: 0.677 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2106623649597168
Epoch: 15, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.691 Vali Acc: 0.831 Test Loss: 0.691 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0771121978759766
Epoch: 16, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.749 Vali Acc: 0.819 Test Loss: 0.749 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9717943668365479
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.795 Vali Acc: 0.822 Test Loss: 0.795 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0904669761657715
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.812 Vali Acc: 0.822 Test Loss: 0.812 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0333869457244873
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.811 Vali Acc: 0.812 Test Loss: 0.811 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 1300768
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.127751588821411
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 1.982 Vali Acc: 0.263 Test Loss: 1.982 Test Acc: 0.263
Validation loss decreased (inf --> -0.262480).  Saving model ...
Epoch: 2 cost time: 1.185584306716919
Epoch: 2, Steps: 8 | Train Loss: 1.828 Vali Loss: 1.685 Vali Acc: 0.531 Test Loss: 1.685 Test Acc: 0.531
Validation loss decreased (-0.262480 --> -0.531233).  Saving model ...
Epoch: 3 cost time: 1.2070205211639404
Epoch: 3, Steps: 8 | Train Loss: 1.553 Vali Loss: 1.294 Vali Acc: 0.706 Test Loss: 1.294 Test Acc: 0.706
Validation loss decreased (-0.531233 --> -0.706237).  Saving model ...
Epoch: 4 cost time: 0.98610520362854
Epoch: 4, Steps: 8 | Train Loss: 1.132 Vali Loss: 0.967 Vali Acc: 0.766 Test Loss: 0.967 Test Acc: 0.766
Validation loss decreased (-0.706237 --> -0.765615).  Saving model ...
Epoch: 5 cost time: 1.176830768585205
Epoch: 5, Steps: 8 | Train Loss: 0.780 Vali Loss: 0.746 Vali Acc: 0.778 Test Loss: 0.746 Test Acc: 0.778
Validation loss decreased (-0.765615 --> -0.778118).  Saving model ...
Epoch: 6 cost time: 1.4107487201690674
Epoch: 6, Steps: 8 | Train Loss: 0.760 Vali Loss: 0.595 Vali Acc: 0.828 Test Loss: 0.595 Test Acc: 0.828
Validation loss decreased (-0.778118 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 1.137037754058838
Epoch: 7, Steps: 8 | Train Loss: 0.505 Vali Loss: 0.554 Vali Acc: 0.806 Test Loss: 0.554 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.223536491394043
Epoch: 8, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.562 Vali Acc: 0.828 Test Loss: 0.562 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 1.3059720993041992
Epoch: 9, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3080039024353027
Epoch: 10, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.569 Vali Acc: 0.825 Test Loss: 0.569 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.157623052597046
Epoch: 11, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3441309928894043
Epoch: 12, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.601 Vali Acc: 0.834 Test Loss: 0.601 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 13 cost time: 1.4356138706207275
Epoch: 13, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.678 Vali Acc: 0.812 Test Loss: 0.678 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2198331356048584
Epoch: 14, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.742 Vali Acc: 0.800 Test Loss: 0.742 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2716624736785889
Epoch: 15, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.689 Vali Acc: 0.819 Test Loss: 0.689 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4898431301116943
Epoch: 16, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.770 Vali Acc: 0.812 Test Loss: 0.770 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2898406982421875
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.819 Vali Acc: 0.809 Test Loss: 0.819 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.665112018585205
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.864 Vali Acc: 0.831 Test Loss: 0.864 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3820569515228271
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.880 Vali Acc: 0.825 Test Loss: 0.880 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.107212781906128
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.897 Vali Acc: 0.816 Test Loss: 0.897 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0095138549804688
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.911 Vali Acc: 0.812 Test Loss: 0.911 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9493081569671631
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.920 Vali Acc: 0.816 Test Loss: 0.920 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 1297312
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.795074701309204
Epoch: 1, Steps: 8 | Train Loss: 2.197 Vali Loss: 2.000 Vali Acc: 0.241 Test Loss: 2.000 Test Acc: 0.241
Validation loss decreased (inf --> -0.240605).  Saving model ...
Epoch: 2 cost time: 1.0886104106903076
Epoch: 2, Steps: 8 | Train Loss: 1.983 Vali Loss: 1.741 Vali Acc: 0.434 Test Loss: 1.741 Test Acc: 0.434
Validation loss decreased (-0.240605 --> -0.434358).  Saving model ...
Epoch: 3 cost time: 1.0997605323791504
Epoch: 3, Steps: 8 | Train Loss: 1.560 Vali Loss: 1.337 Vali Acc: 0.644 Test Loss: 1.337 Test Acc: 0.644
Validation loss decreased (-0.434358 --> -0.643737).  Saving model ...
Epoch: 4 cost time: 0.9514737129211426
Epoch: 4, Steps: 8 | Train Loss: 1.147 Vali Loss: 0.990 Vali Acc: 0.756 Test Loss: 0.990 Test Acc: 0.756
Validation loss decreased (-0.643737 --> -0.756240).  Saving model ...
Epoch: 5 cost time: 1.1127028465270996
Epoch: 5, Steps: 8 | Train Loss: 0.896 Vali Loss: 0.728 Vali Acc: 0.828 Test Loss: 0.728 Test Acc: 0.828
Validation loss decreased (-0.756240 --> -0.828118).  Saving model ...
Epoch: 6 cost time: 0.8503396511077881
Epoch: 6, Steps: 8 | Train Loss: 0.642 Vali Loss: 0.623 Vali Acc: 0.847 Test Loss: 0.623 Test Acc: 0.847
Validation loss decreased (-0.828118 --> -0.846869).  Saving model ...
Epoch: 7 cost time: 1.0228846073150635
Epoch: 7, Steps: 8 | Train Loss: 0.463 Vali Loss: 0.578 Vali Acc: 0.791 Test Loss: 0.578 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9880893230438232
Epoch: 8, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0237045288085938
Epoch: 9, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.590 Vali Acc: 0.803 Test Loss: 0.590 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.046741008758545
Epoch: 10, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1965668201446533
Epoch: 11, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.104459524154663
Epoch: 12, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.654 Vali Acc: 0.803 Test Loss: 0.654 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9759571552276611
Epoch: 13, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.655 Vali Acc: 0.806 Test Loss: 0.655 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.977008581161499
Epoch: 14, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.705 Vali Acc: 0.809 Test Loss: 0.705 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1656954288482666
Epoch: 15, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.778 Vali Acc: 0.809 Test Loss: 0.778 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0032150745391846
Epoch: 16, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.733 Vali Acc: 0.816 Test Loss: 0.733 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 1293856
model size : 7.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8340938091278076
Epoch: 1, Steps: 8 | Train Loss: 2.159 Vali Loss: 1.902 Vali Acc: 0.425 Test Loss: 1.902 Test Acc: 0.425
Validation loss decreased (inf --> -0.424981).  Saving model ...
Epoch: 2 cost time: 1.134122371673584
Epoch: 2, Steps: 8 | Train Loss: 1.862 Vali Loss: 1.598 Vali Acc: 0.628 Test Loss: 1.598 Test Acc: 0.628
Validation loss decreased (-0.424981 --> -0.628109).  Saving model ...
Epoch: 3 cost time: 1.1111993789672852
Epoch: 3, Steps: 8 | Train Loss: 1.528 Vali Loss: 1.247 Vali Acc: 0.662 Test Loss: 1.247 Test Acc: 0.662
Validation loss decreased (-0.628109 --> -0.662488).  Saving model ...
Epoch: 4 cost time: 1.229227066040039
Epoch: 4, Steps: 8 | Train Loss: 1.106 Vali Loss: 0.944 Vali Acc: 0.778 Test Loss: 0.944 Test Acc: 0.778
Validation loss decreased (-0.662488 --> -0.778116).  Saving model ...
Epoch: 5 cost time: 1.0123279094696045
Epoch: 5, Steps: 8 | Train Loss: 0.793 Vali Loss: 0.725 Vali Acc: 0.800 Test Loss: 0.725 Test Acc: 0.800
Validation loss decreased (-0.778116 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 1.0190722942352295
Epoch: 6, Steps: 8 | Train Loss: 0.609 Vali Loss: 0.583 Vali Acc: 0.834 Test Loss: 0.583 Test Acc: 0.834
Validation loss decreased (-0.799993 --> -0.834369).  Saving model ...
Epoch: 7 cost time: 1.1867291927337646
Epoch: 7, Steps: 8 | Train Loss: 0.513 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 1.158538818359375
Epoch: 8, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.530 Vali Acc: 0.816 Test Loss: 0.530 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2512037754058838
Epoch: 9, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1971824169158936
Epoch: 10, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.607 Vali Acc: 0.800 Test Loss: 0.607 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2612073421478271
Epoch: 11, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.581 Vali Acc: 0.831 Test Loss: 0.581 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1958961486816406
Epoch: 12, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.608 Vali Acc: 0.803 Test Loss: 0.608 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1449856758117676
Epoch: 13, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.610 Vali Acc: 0.828 Test Loss: 0.610 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2518208026885986
Epoch: 14, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.683 Vali Acc: 0.816 Test Loss: 0.683 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1373326778411865
Epoch: 15, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.689 Vali Acc: 0.825 Test Loss: 0.689 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0961432456970215
Epoch: 16, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.721 Vali Acc: 0.816 Test Loss: 0.721 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1491806507110596
Epoch: 17, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.823 Vali Acc: 0.809 Test Loss: 0.823 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 1106848
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.728445291519165
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 1.952 Vali Acc: 0.322 Test Loss: 1.952 Test Acc: 0.322
Validation loss decreased (inf --> -0.321855).  Saving model ...
Epoch: 2 cost time: 1.2022039890289307
Epoch: 2, Steps: 8 | Train Loss: 1.901 Vali Loss: 1.644 Vali Acc: 0.609 Test Loss: 1.644 Test Acc: 0.609
Validation loss decreased (-0.321855 --> -0.609359).  Saving model ...
Epoch: 3 cost time: 0.8344857692718506
Epoch: 3, Steps: 8 | Train Loss: 1.494 Vali Loss: 1.264 Vali Acc: 0.741 Test Loss: 1.264 Test Acc: 0.741
Validation loss decreased (-0.609359 --> -0.740612).  Saving model ...
Epoch: 4 cost time: 0.9853630065917969
Epoch: 4, Steps: 8 | Train Loss: 1.119 Vali Loss: 0.928 Vali Acc: 0.816 Test Loss: 0.928 Test Acc: 0.816
Validation loss decreased (-0.740612 --> -0.815616).  Saving model ...
Epoch: 5 cost time: 1.1519219875335693
Epoch: 5, Steps: 8 | Train Loss: 0.781 Vali Loss: 0.712 Vali Acc: 0.806 Test Loss: 0.712 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2638332843780518
Epoch: 6, Steps: 8 | Train Loss: 0.623 Vali Loss: 0.588 Vali Acc: 0.831 Test Loss: 0.588 Test Acc: 0.831
Validation loss decreased (-0.815616 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 1.1975257396697998
Epoch: 7, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 1.191788673400879
Epoch: 8, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 0.9906036853790283
Epoch: 9, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.579 Vali Acc: 0.816 Test Loss: 0.579 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.140693187713623
Epoch: 10, Steps: 8 | Train Loss: 0.259 Vali Loss: 0.528 Vali Acc: 0.834 Test Loss: 0.528 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.144028902053833
Epoch: 11, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.563 Vali Acc: 0.831 Test Loss: 0.563 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0800039768218994
Epoch: 12, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0933256149291992
Epoch: 13, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.666 Vali Acc: 0.803 Test Loss: 0.666 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1381406784057617
Epoch: 14, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.682 Vali Acc: 0.816 Test Loss: 0.682 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1136817932128906
Epoch: 15, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.675 Vali Acc: 0.822 Test Loss: 0.675 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0698015689849854
Epoch: 16, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.741 Vali Acc: 0.828 Test Loss: 0.741 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.142298936843872
Epoch: 17, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.793 Vali Acc: 0.822 Test Loss: 0.793 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0693581104278564
Epoch: 18, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.796 Vali Acc: 0.812 Test Loss: 0.796 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 1103392
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6541271209716797
Epoch: 1, Steps: 8 | Train Loss: 2.188 Vali Loss: 2.023 Vali Acc: 0.188 Test Loss: 2.023 Test Acc: 0.188
Validation loss decreased (inf --> -0.187480).  Saving model ...
Epoch: 2 cost time: 1.0252103805541992
Epoch: 2, Steps: 8 | Train Loss: 2.019 Vali Loss: 1.717 Vali Acc: 0.544 Test Loss: 1.717 Test Acc: 0.544
Validation loss decreased (-0.187480 --> -0.543733).  Saving model ...
Epoch: 3 cost time: 1.0066502094268799
Epoch: 3, Steps: 8 | Train Loss: 1.567 Vali Loss: 1.358 Vali Acc: 0.659 Test Loss: 1.358 Test Acc: 0.659
Validation loss decreased (-0.543733 --> -0.659361).  Saving model ...
Epoch: 4 cost time: 1.152113914489746
Epoch: 4, Steps: 8 | Train Loss: 1.216 Vali Loss: 1.020 Vali Acc: 0.725 Test Loss: 1.020 Test Acc: 0.725
Validation loss decreased (-0.659361 --> -0.724990).  Saving model ...
Epoch: 5 cost time: 1.070263147354126
Epoch: 5, Steps: 8 | Train Loss: 0.805 Vali Loss: 0.744 Vali Acc: 0.800 Test Loss: 0.744 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 1.2957708835601807
Epoch: 6, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.634 Vali Acc: 0.819 Test Loss: 0.634 Test Acc: 0.819
Validation loss decreased (-0.799993 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 1.0213735103607178
Epoch: 7, Steps: 8 | Train Loss: 0.561 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
Validation loss decreased (-0.818744 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.9689850807189941
Epoch: 8, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1129870414733887
Epoch: 9, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0931205749511719
Epoch: 10, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1221277713775635
Epoch: 11, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.597 Vali Acc: 0.812 Test Loss: 0.597 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0896880626678467
Epoch: 12, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.622 Vali Acc: 0.816 Test Loss: 0.622 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.048187255859375
Epoch: 13, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.648 Vali Acc: 0.806 Test Loss: 0.648 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0930471420288086
Epoch: 14, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2079558372497559
Epoch: 15, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.676 Vali Acc: 0.819 Test Loss: 0.676 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1345493793487549
Epoch: 16, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1547510623931885
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.743 Vali Acc: 0.828 Test Loss: 0.743 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 1099936
model size : 6.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0868661403656006
Epoch: 1, Steps: 8 | Train Loss: 2.245 Vali Loss: 2.043 Vali Acc: 0.153 Test Loss: 2.043 Test Acc: 0.153
Validation loss decreased (inf --> -0.153105).  Saving model ...
Epoch: 2 cost time: 1.0399463176727295
Epoch: 2, Steps: 8 | Train Loss: 2.002 Vali Loss: 1.744 Vali Acc: 0.331 Test Loss: 1.744 Test Acc: 0.331
Validation loss decreased (-0.153105 --> -0.331233).  Saving model ...
Epoch: 3 cost time: 1.0235178470611572
Epoch: 3, Steps: 8 | Train Loss: 1.594 Vali Loss: 1.366 Vali Acc: 0.653 Test Loss: 1.366 Test Acc: 0.653
Validation loss decreased (-0.331233 --> -0.653111).  Saving model ...
Epoch: 4 cost time: 1.0710082054138184
Epoch: 4, Steps: 8 | Train Loss: 1.274 Vali Loss: 1.034 Vali Acc: 0.797 Test Loss: 1.034 Test Acc: 0.797
Validation loss decreased (-0.653111 --> -0.796865).  Saving model ...
Epoch: 5 cost time: 0.9791586399078369
Epoch: 5, Steps: 8 | Train Loss: 0.845 Vali Loss: 0.790 Vali Acc: 0.775 Test Loss: 0.790 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0488076210021973
Epoch: 6, Steps: 8 | Train Loss: 0.680 Vali Loss: 0.619 Vali Acc: 0.816 Test Loss: 0.619 Test Acc: 0.816
Validation loss decreased (-0.796865 --> -0.815619).  Saving model ...
Epoch: 7 cost time: 1.0270745754241943
Epoch: 7, Steps: 8 | Train Loss: 0.545 Vali Loss: 0.588 Vali Acc: 0.812 Test Loss: 0.588 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0592525005340576
Epoch: 8, Steps: 8 | Train Loss: 0.400 Vali Loss: 0.562 Vali Acc: 0.812 Test Loss: 0.562 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1591262817382812
Epoch: 9, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.9945878982543945
Epoch: 10, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824995).  Saving model ...
Epoch: 11 cost time: 1.159775972366333
Epoch: 11, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.594 Vali Acc: 0.819 Test Loss: 0.594 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.116976261138916
Epoch: 12, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.155925989151001
Epoch: 13, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.639 Vali Acc: 0.825 Test Loss: 0.639 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2192673683166504
Epoch: 14, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.658 Vali Acc: 0.822 Test Loss: 0.658 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.258652925491333
Epoch: 15, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.720 Vali Acc: 0.834 Test Loss: 0.720 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834368).  Saving model ...
Epoch: 16 cost time: 1.1295475959777832
Epoch: 16, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.797 Vali Acc: 0.809 Test Loss: 0.797 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0572843551635742
Epoch: 17, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.831 Vali Acc: 0.822 Test Loss: 0.831 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9700241088867188
Epoch: 18, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.807 Vali Acc: 0.828 Test Loss: 0.807 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8503878116607666
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.873 Vali Acc: 0.819 Test Loss: 0.873 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.175182819366455
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.915 Vali Acc: 0.819 Test Loss: 0.915 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0260899066925049
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.978 Vali Acc: 0.816 Test Loss: 0.978 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9462625980377197
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.966 Vali Acc: 0.822 Test Loss: 0.966 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1090621948242188
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.977 Vali Acc: 0.816 Test Loss: 0.977 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9106326103210449
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.972 Vali Acc: 0.812 Test Loss: 0.972 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0911595821380615
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.972 Vali Acc: 0.809 Test Loss: 0.972 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 1096480
model size : 6.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.80561900138855
Epoch: 1, Steps: 8 | Train Loss: 2.082 Vali Loss: 1.937 Vali Acc: 0.334 Test Loss: 1.937 Test Acc: 0.334
Validation loss decreased (inf --> -0.334356).  Saving model ...
Epoch: 2 cost time: 0.9229063987731934
Epoch: 2, Steps: 8 | Train Loss: 1.833 Vali Loss: 1.632 Vali Acc: 0.606 Test Loss: 1.632 Test Acc: 0.606
Validation loss decreased (-0.334356 --> -0.606234).  Saving model ...
Epoch: 3 cost time: 0.9500148296356201
Epoch: 3, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.273 Vali Acc: 0.750 Test Loss: 1.273 Test Acc: 0.750
Validation loss decreased (-0.606234 --> -0.749987).  Saving model ...
Epoch: 4 cost time: 1.0403814315795898
Epoch: 4, Steps: 8 | Train Loss: 1.172 Vali Loss: 0.979 Vali Acc: 0.797 Test Loss: 0.979 Test Acc: 0.797
Validation loss decreased (-0.749987 --> -0.796865).  Saving model ...
Epoch: 5 cost time: 1.0611488819122314
Epoch: 5, Steps: 8 | Train Loss: 0.883 Vali Loss: 0.763 Vali Acc: 0.803 Test Loss: 0.763 Test Acc: 0.803
Validation loss decreased (-0.796865 --> -0.803117).  Saving model ...
Epoch: 6 cost time: 1.088202953338623
Epoch: 6, Steps: 8 | Train Loss: 0.683 Vali Loss: 0.637 Vali Acc: 0.822 Test Loss: 0.637 Test Acc: 0.822
Validation loss decreased (-0.803117 --> -0.821869).  Saving model ...
Epoch: 7 cost time: 0.9485592842102051
Epoch: 7, Steps: 8 | Train Loss: 0.534 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0991792678833008
Epoch: 8, Steps: 8 | Train Loss: 0.501 Vali Loss: 0.561 Vali Acc: 0.831 Test Loss: 0.561 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831244).  Saving model ...
Epoch: 9 cost time: 0.8927788734436035
Epoch: 9, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0100715160369873
Epoch: 10, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.596 Vali Acc: 0.806 Test Loss: 0.596 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0191128253936768
Epoch: 11, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.619 Vali Acc: 0.800 Test Loss: 0.619 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1951358318328857
Epoch: 12, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.613 Vali Acc: 0.806 Test Loss: 0.613 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0322368144989014
Epoch: 13, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.624 Vali Acc: 0.806 Test Loss: 0.624 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1177096366882324
Epoch: 14, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.627 Vali Acc: 0.806 Test Loss: 0.627 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6466116905212402
Epoch: 15, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.734 Vali Acc: 0.803 Test Loss: 0.734 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.030454397201538
Epoch: 16, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.728 Vali Acc: 0.812 Test Loss: 0.728 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.017559289932251
Epoch: 17, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.773 Vali Acc: 0.809 Test Loss: 0.773 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9590497016906738
Epoch: 18, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.818 Vali Acc: 0.809 Test Loss: 0.818 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 1008160
model size : 6.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.157388925552368
Epoch: 1, Steps: 8 | Train Loss: 2.170 Vali Loss: 1.949 Vali Acc: 0.400 Test Loss: 1.949 Test Acc: 0.400
Validation loss decreased (inf --> -0.399981).  Saving model ...
Epoch: 2 cost time: 1.0957860946655273
Epoch: 2, Steps: 8 | Train Loss: 1.905 Vali Loss: 1.668 Vali Acc: 0.559 Test Loss: 1.668 Test Acc: 0.559
Validation loss decreased (-0.399981 --> -0.559358).  Saving model ...
Epoch: 3 cost time: 1.2502551078796387
Epoch: 3, Steps: 8 | Train Loss: 1.518 Vali Loss: 1.294 Vali Acc: 0.709 Test Loss: 1.294 Test Acc: 0.709
Validation loss decreased (-0.559358 --> -0.709362).  Saving model ...
Epoch: 4 cost time: 0.9973893165588379
Epoch: 4, Steps: 8 | Train Loss: 1.141 Vali Loss: 0.972 Vali Acc: 0.781 Test Loss: 0.972 Test Acc: 0.781
Validation loss decreased (-0.709362 --> -0.781240).  Saving model ...
Epoch: 5 cost time: 1.0370063781738281
Epoch: 5, Steps: 8 | Train Loss: 0.840 Vali Loss: 0.756 Vali Acc: 0.806 Test Loss: 0.756 Test Acc: 0.806
Validation loss decreased (-0.781240 --> -0.806242).  Saving model ...
Epoch: 6 cost time: 1.130793809890747
Epoch: 6, Steps: 8 | Train Loss: 0.633 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
Validation loss decreased (-0.806242 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 0.948197603225708
Epoch: 7, Steps: 8 | Train Loss: 0.500 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.99967360496521
Epoch: 8, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.534 Vali Acc: 0.847 Test Loss: 0.534 Test Acc: 0.847
Validation loss decreased (-0.828119 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.9577739238739014
Epoch: 9, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.519 Vali Acc: 0.831 Test Loss: 0.519 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2777094841003418
Epoch: 10, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.541 Vali Acc: 0.828 Test Loss: 0.541 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1429147720336914
Epoch: 11, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.588 Vali Acc: 0.812 Test Loss: 0.588 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.112959623336792
Epoch: 12, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0342509746551514
Epoch: 13, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.612 Vali Acc: 0.828 Test Loss: 0.612 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.238124132156372
Epoch: 14, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0822279453277588
Epoch: 15, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.708 Vali Acc: 0.816 Test Loss: 0.708 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1418659687042236
Epoch: 16, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.696 Vali Acc: 0.822 Test Loss: 0.696 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1696906089782715
Epoch: 17, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.763 Vali Acc: 0.825 Test Loss: 0.763 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0491430759429932
Epoch: 18, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.841 Vali Acc: 0.809 Test Loss: 0.841 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 1004704
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8700835704803467
Epoch: 1, Steps: 8 | Train Loss: 2.066 Vali Loss: 1.940 Vali Acc: 0.291 Test Loss: 1.940 Test Acc: 0.291
Validation loss decreased (inf --> -0.290606).  Saving model ...
Epoch: 2 cost time: 0.9575715065002441
Epoch: 2, Steps: 8 | Train Loss: 1.875 Vali Loss: 1.670 Vali Acc: 0.409 Test Loss: 1.670 Test Acc: 0.409
Validation loss decreased (-0.290606 --> -0.409358).  Saving model ...
Epoch: 3 cost time: 0.7979962825775146
Epoch: 3, Steps: 8 | Train Loss: 1.558 Vali Loss: 1.324 Vali Acc: 0.716 Test Loss: 1.324 Test Acc: 0.716
Validation loss decreased (-0.409358 --> -0.715612).  Saving model ...
Epoch: 4 cost time: 1.030606985092163
Epoch: 4, Steps: 8 | Train Loss: 1.200 Vali Loss: 1.004 Vali Acc: 0.756 Test Loss: 1.004 Test Acc: 0.756
Validation loss decreased (-0.715612 --> -0.756240).  Saving model ...
Epoch: 5 cost time: 1.021040678024292
Epoch: 5, Steps: 8 | Train Loss: 0.849 Vali Loss: 0.773 Vali Acc: 0.831 Test Loss: 0.773 Test Acc: 0.831
Validation loss decreased (-0.756240 --> -0.831242).  Saving model ...
Epoch: 6 cost time: 1.2286739349365234
Epoch: 6, Steps: 8 | Train Loss: 0.696 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1853103637695312
Epoch: 7, Steps: 8 | Train Loss: 0.529 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1133661270141602
Epoch: 8, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.001305341720581
Epoch: 9, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.606 Vali Acc: 0.794 Test Loss: 0.606 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.907386302947998
Epoch: 10, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0286433696746826
Epoch: 11, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0891797542572021
Epoch: 12, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.646 Vali Acc: 0.809 Test Loss: 0.646 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0690867900848389
Epoch: 13, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1376020908355713
Epoch: 14, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.666 Vali Acc: 0.822 Test Loss: 0.666 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9909548759460449
Epoch: 15, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.672 Vali Acc: 0.812 Test Loss: 0.672 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 1001248
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.21201491355896
Epoch: 1, Steps: 8 | Train Loss: 2.132 Vali Loss: 1.992 Vali Acc: 0.250 Test Loss: 1.992 Test Acc: 0.250
Validation loss decreased (inf --> -0.249980).  Saving model ...
Epoch: 2 cost time: 1.2405221462249756
Epoch: 2, Steps: 8 | Train Loss: 1.953 Vali Loss: 1.663 Vali Acc: 0.613 Test Loss: 1.663 Test Acc: 0.613
Validation loss decreased (-0.249980 --> -0.612483).  Saving model ...
Epoch: 3 cost time: 1.2540168762207031
Epoch: 3, Steps: 8 | Train Loss: 1.543 Vali Loss: 1.299 Vali Acc: 0.741 Test Loss: 1.299 Test Acc: 0.741
Validation loss decreased (-0.612483 --> -0.740612).  Saving model ...
Epoch: 4 cost time: 0.9621901512145996
Epoch: 4, Steps: 8 | Train Loss: 1.177 Vali Loss: 0.991 Vali Acc: 0.784 Test Loss: 0.991 Test Acc: 0.784
Validation loss decreased (-0.740612 --> -0.784365).  Saving model ...
Epoch: 5 cost time: 0.9076366424560547
Epoch: 5, Steps: 8 | Train Loss: 0.900 Vali Loss: 0.787 Vali Acc: 0.794 Test Loss: 0.787 Test Acc: 0.794
Validation loss decreased (-0.784365 --> -0.793742).  Saving model ...
Epoch: 6 cost time: 1.0192136764526367
Epoch: 6, Steps: 8 | Train Loss: 0.637 Vali Loss: 0.631 Vali Acc: 0.834 Test Loss: 0.631 Test Acc: 0.834
Validation loss decreased (-0.793742 --> -0.834369).  Saving model ...
Epoch: 7 cost time: 0.8851401805877686
Epoch: 7, Steps: 8 | Train Loss: 0.499 Vali Loss: 0.611 Vali Acc: 0.797 Test Loss: 0.611 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.920255184173584
Epoch: 8, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
Validation loss decreased (-0.834369 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.9319348335266113
Epoch: 9, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.531 Vali Acc: 0.819 Test Loss: 0.531 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1308765411376953
Epoch: 10, Steps: 8 | Train Loss: 0.313 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1343395709991455
Epoch: 11, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0885741710662842
Epoch: 12, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.654 Vali Acc: 0.784 Test Loss: 0.654 Test Acc: 0.784
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9783129692077637
Epoch: 13, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.677 Vali Acc: 0.825 Test Loss: 0.677 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1722893714904785
Epoch: 14, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.725 Vali Acc: 0.800 Test Loss: 0.725 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0386695861816406
Epoch: 15, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.702 Vali Acc: 0.822 Test Loss: 0.702 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.031567096710205
Epoch: 16, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.784 Vali Acc: 0.819 Test Loss: 0.784 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1554152965545654
Epoch: 17, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.786 Vali Acc: 0.812 Test Loss: 0.786 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.163388729095459
Epoch: 18, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.840 Vali Acc: 0.816 Test Loss: 0.840 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 997792
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.340131998062134
Epoch: 1, Steps: 8 | Train Loss: 2.327 Vali Loss: 2.088 Vali Acc: 0.178 Test Loss: 2.088 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 0.9927127361297607
Epoch: 2, Steps: 8 | Train Loss: 1.995 Vali Loss: 1.827 Vali Acc: 0.366 Test Loss: 1.827 Test Acc: 0.366
Validation loss decreased (-0.178104 --> -0.365607).  Saving model ...
Epoch: 3 cost time: 1.131303310394287
Epoch: 3, Steps: 8 | Train Loss: 1.789 Vali Loss: 1.543 Vali Acc: 0.594 Test Loss: 1.543 Test Acc: 0.594
Validation loss decreased (-0.365607 --> -0.593735).  Saving model ...
Epoch: 4 cost time: 0.9531679153442383
Epoch: 4, Steps: 8 | Train Loss: 1.401 Vali Loss: 1.237 Vali Acc: 0.775 Test Loss: 1.237 Test Acc: 0.775
Validation loss decreased (-0.593735 --> -0.774988).  Saving model ...
Epoch: 5 cost time: 1.0789144039154053
Epoch: 5, Steps: 8 | Train Loss: 1.115 Vali Loss: 0.945 Vali Acc: 0.825 Test Loss: 0.945 Test Acc: 0.825
Validation loss decreased (-0.774988 --> -0.824991).  Saving model ...
Epoch: 6 cost time: 0.9170961380004883
Epoch: 6, Steps: 8 | Train Loss: 0.822 Vali Loss: 0.739 Vali Acc: 0.816 Test Loss: 0.739 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9015622138977051
Epoch: 7, Steps: 8 | Train Loss: 0.632 Vali Loss: 0.593 Vali Acc: 0.847 Test Loss: 0.593 Test Acc: 0.847
Validation loss decreased (-0.824991 --> -0.846869).  Saving model ...
Epoch: 8 cost time: 0.9728901386260986
Epoch: 8, Steps: 8 | Train Loss: 0.488 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0463297367095947
Epoch: 9, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0857627391815186
Epoch: 10, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9265506267547607
Epoch: 11, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3867321014404297
Epoch: 12, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9804604053497314
Epoch: 13, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0919396877288818
Epoch: 14, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.581 Vali Acc: 0.831 Test Loss: 0.581 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0943183898925781
Epoch: 15, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.595 Vali Acc: 0.819 Test Loss: 0.595 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0021860599517822
Epoch: 16, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.838451623916626
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.660 Vali Acc: 0.825 Test Loss: 0.660 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 654432
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.85615873336792
Epoch: 1, Steps: 8 | Train Loss: 2.224 Vali Loss: 2.050 Vali Acc: 0.216 Test Loss: 2.050 Test Acc: 0.216
Validation loss decreased (inf --> -0.215604).  Saving model ...
Epoch: 2 cost time: 0.9638590812683105
Epoch: 2, Steps: 8 | Train Loss: 2.016 Vali Loss: 1.840 Vali Acc: 0.388 Test Loss: 1.840 Test Acc: 0.388
Validation loss decreased (-0.215604 --> -0.387482).  Saving model ...
Epoch: 3 cost time: 1.2498235702514648
Epoch: 3, Steps: 8 | Train Loss: 1.745 Vali Loss: 1.532 Vali Acc: 0.713 Test Loss: 1.532 Test Acc: 0.713
Validation loss decreased (-0.387482 --> -0.712485).  Saving model ...
Epoch: 4 cost time: 1.0108225345611572
Epoch: 4, Steps: 8 | Train Loss: 1.414 Vali Loss: 1.227 Vali Acc: 0.766 Test Loss: 1.227 Test Acc: 0.766
Validation loss decreased (-0.712485 --> -0.765613).  Saving model ...
Epoch: 5 cost time: 0.9905765056610107
Epoch: 5, Steps: 8 | Train Loss: 1.089 Vali Loss: 0.938 Vali Acc: 0.819 Test Loss: 0.938 Test Acc: 0.819
Validation loss decreased (-0.765613 --> -0.818741).  Saving model ...
Epoch: 6 cost time: 1.0690913200378418
Epoch: 6, Steps: 8 | Train Loss: 0.784 Vali Loss: 0.709 Vali Acc: 0.828 Test Loss: 0.709 Test Acc: 0.828
Validation loss decreased (-0.818741 --> -0.828118).  Saving model ...
Epoch: 7 cost time: 1.0131235122680664
Epoch: 7, Steps: 8 | Train Loss: 0.586 Vali Loss: 0.600 Vali Acc: 0.806 Test Loss: 0.600 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.896498441696167
Epoch: 8, Steps: 8 | Train Loss: 0.468 Vali Loss: 0.526 Vali Acc: 0.831 Test Loss: 0.526 Test Acc: 0.831
Validation loss decreased (-0.828118 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 0.9585630893707275
Epoch: 9, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.522 Vali Acc: 0.831 Test Loss: 0.522 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 0.8535492420196533
Epoch: 10, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8983371257781982
Epoch: 11, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8191227912902832
Epoch: 12, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9898233413696289
Epoch: 13, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8556196689605713
Epoch: 14, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1204254627227783
Epoch: 15, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.620 Vali Acc: 0.819 Test Loss: 0.620 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0775861740112305
Epoch: 16, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.312101125717163
Epoch: 17, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.633 Vali Acc: 0.834 Test Loss: 0.633 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834369).  Saving model ...
Epoch: 18 cost time: 0.9991824626922607
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.648 Vali Acc: 0.834 Test Loss: 0.648 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9664933681488037
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.685 Vali Acc: 0.825 Test Loss: 0.685 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8722307682037354
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.696 Vali Acc: 0.825 Test Loss: 0.696 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9867639541625977
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.705 Vali Acc: 0.834 Test Loss: 0.705 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8860878944396973
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.708 Vali Acc: 0.828 Test Loss: 0.708 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0921804904937744
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0595283508300781
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.734 Vali Acc: 0.828 Test Loss: 0.734 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.007389783859253
Epoch: 25, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.747 Vali Acc: 0.834 Test Loss: 0.747 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8829855918884277
Epoch: 26, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.766 Vali Acc: 0.825 Test Loss: 0.766 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0214903354644775
Epoch: 27, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.768 Vali Acc: 0.828 Test Loss: 0.768 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 652704
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6609296798706055
Epoch: 1, Steps: 8 | Train Loss: 2.091 Vali Loss: 1.954 Vali Acc: 0.244 Test Loss: 1.954 Test Acc: 0.244
Validation loss decreased (inf --> -0.243730).  Saving model ...
Epoch: 2 cost time: 0.9535024166107178
Epoch: 2, Steps: 8 | Train Loss: 1.942 Vali Loss: 1.777 Vali Acc: 0.481 Test Loss: 1.777 Test Acc: 0.481
Validation loss decreased (-0.243730 --> -0.481232).  Saving model ...
Epoch: 3 cost time: 0.887814998626709
Epoch: 3, Steps: 8 | Train Loss: 1.745 Vali Loss: 1.519 Vali Acc: 0.694 Test Loss: 1.519 Test Acc: 0.694
Validation loss decreased (-0.481232 --> -0.693735).  Saving model ...
Epoch: 4 cost time: 1.104363203048706
Epoch: 4, Steps: 8 | Train Loss: 1.432 Vali Loss: 1.245 Vali Acc: 0.747 Test Loss: 1.245 Test Acc: 0.747
Validation loss decreased (-0.693735 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 0.8874838352203369
Epoch: 5, Steps: 8 | Train Loss: 1.152 Vali Loss: 0.974 Vali Acc: 0.781 Test Loss: 0.974 Test Acc: 0.781
Validation loss decreased (-0.746863 --> -0.781240).  Saving model ...
Epoch: 6 cost time: 0.855170726776123
Epoch: 6, Steps: 8 | Train Loss: 0.905 Vali Loss: 0.765 Vali Acc: 0.794 Test Loss: 0.765 Test Acc: 0.794
Validation loss decreased (-0.781240 --> -0.793742).  Saving model ...
Epoch: 7 cost time: 1.1007006168365479
Epoch: 7, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.638 Vali Acc: 0.797 Test Loss: 0.638 Test Acc: 0.797
Validation loss decreased (-0.793742 --> -0.796869).  Saving model ...
Epoch: 8 cost time: 0.8533861637115479
Epoch: 8, Steps: 8 | Train Loss: 0.549 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
Validation loss decreased (-0.796869 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.9213454723358154
Epoch: 9, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8309822082519531
Epoch: 10, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.553 Vali Acc: 0.816 Test Loss: 0.553 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0901546478271484
Epoch: 11, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 0.8342251777648926
Epoch: 12, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.533 Vali Acc: 0.828 Test Loss: 0.533 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0747251510620117
Epoch: 13, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6908388137817383
Epoch: 14, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.887279748916626
Epoch: 15, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.145357370376587
Epoch: 16, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.630 Vali Acc: 0.838 Test Loss: 0.630 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9723823070526123
Epoch: 17, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9695272445678711
Epoch: 18, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.637 Vali Acc: 0.838 Test Loss: 0.637 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9596295356750488
Epoch: 19, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.645 Vali Acc: 0.841 Test Loss: 0.645 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9032604694366455
Epoch: 20, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.694 Vali Acc: 0.831 Test Loss: 0.694 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2622120380401611
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.676 Vali Acc: 0.831 Test Loss: 0.676 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 650976
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.069735527038574
Epoch: 1, Steps: 8 | Train Loss: 2.169 Vali Loss: 1.991 Vali Acc: 0.247 Test Loss: 1.991 Test Acc: 0.247
Validation loss decreased (inf --> -0.246855).  Saving model ...
Epoch: 2 cost time: 0.8384377956390381
Epoch: 2, Steps: 8 | Train Loss: 1.967 Vali Loss: 1.788 Vali Acc: 0.472 Test Loss: 1.788 Test Acc: 0.472
Validation loss decreased (-0.246855 --> -0.471857).  Saving model ...
Epoch: 3 cost time: 0.8082997798919678
Epoch: 3, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.524 Vali Acc: 0.716 Test Loss: 1.524 Test Acc: 0.716
Validation loss decreased (-0.471857 --> -0.715610).  Saving model ...
Epoch: 4 cost time: 0.886972188949585
Epoch: 4, Steps: 8 | Train Loss: 1.437 Vali Loss: 1.237 Vali Acc: 0.791 Test Loss: 1.237 Test Acc: 0.791
Validation loss decreased (-0.715610 --> -0.790613).  Saving model ...
Epoch: 5 cost time: 1.0078773498535156
Epoch: 5, Steps: 8 | Train Loss: 1.115 Vali Loss: 0.964 Vali Acc: 0.791 Test Loss: 0.964 Test Acc: 0.791
Validation loss decreased (-0.790613 --> -0.790615).  Saving model ...
Epoch: 6 cost time: 0.8318536281585693
Epoch: 6, Steps: 8 | Train Loss: 0.833 Vali Loss: 0.748 Vali Acc: 0.822 Test Loss: 0.748 Test Acc: 0.822
Validation loss decreased (-0.790615 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 0.8768622875213623
Epoch: 7, Steps: 8 | Train Loss: 0.662 Vali Loss: 0.646 Vali Acc: 0.819 Test Loss: 0.646 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0125126838684082
Epoch: 8, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
Validation loss decreased (-0.821868 --> -0.821869).  Saving model ...
Epoch: 9 cost time: 0.828798770904541
Epoch: 9, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.519 Vali Acc: 0.847 Test Loss: 0.519 Test Acc: 0.847
Validation loss decreased (-0.821869 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 1.0320618152618408
Epoch: 10, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.541 Vali Acc: 0.834 Test Loss: 0.541 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.329864740371704
Epoch: 11, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9629390239715576
Epoch: 12, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9558835029602051
Epoch: 13, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9248332977294922
Epoch: 14, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.564 Vali Acc: 0.841 Test Loss: 0.564 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9568631649017334
Epoch: 15, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.582 Vali Acc: 0.834 Test Loss: 0.582 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9510183334350586
Epoch: 16, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.615 Vali Acc: 0.831 Test Loss: 0.615 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8746070861816406
Epoch: 17, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.621 Vali Acc: 0.841 Test Loss: 0.621 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7941324710845947
Epoch: 18, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.93924880027771
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.651 Vali Acc: 0.831 Test Loss: 0.651 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 649248
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.358928680419922
Epoch: 1, Steps: 8 | Train Loss: 2.223 Vali Loss: 2.127 Vali Acc: 0.081 Test Loss: 2.127 Test Acc: 0.081
Validation loss decreased (inf --> -0.081229).  Saving model ...
Epoch: 2 cost time: 1.0410468578338623
Epoch: 2, Steps: 8 | Train Loss: 2.022 Vali Loss: 1.932 Vali Acc: 0.347 Test Loss: 1.932 Test Acc: 0.347
Validation loss decreased (-0.081229 --> -0.346856).  Saving model ...
Epoch: 3 cost time: 1.1516547203063965
Epoch: 3, Steps: 8 | Train Loss: 1.865 Vali Loss: 1.674 Vali Acc: 0.531 Test Loss: 1.674 Test Acc: 0.531
Validation loss decreased (-0.346856 --> -0.531233).  Saving model ...
Epoch: 4 cost time: 1.0447430610656738
Epoch: 4, Steps: 8 | Train Loss: 1.526 Vali Loss: 1.406 Vali Acc: 0.684 Test Loss: 1.406 Test Acc: 0.684
Validation loss decreased (-0.531233 --> -0.684361).  Saving model ...
Epoch: 5 cost time: 1.0842838287353516
Epoch: 5, Steps: 8 | Train Loss: 1.287 Vali Loss: 1.131 Vali Acc: 0.766 Test Loss: 1.131 Test Acc: 0.766
Validation loss decreased (-0.684361 --> -0.765614).  Saving model ...
Epoch: 6 cost time: 1.3253133296966553
Epoch: 6, Steps: 8 | Train Loss: 1.040 Vali Loss: 0.888 Vali Acc: 0.816 Test Loss: 0.888 Test Acc: 0.816
Validation loss decreased (-0.765614 --> -0.815616).  Saving model ...
Epoch: 7 cost time: 1.0514836311340332
Epoch: 7, Steps: 8 | Train Loss: 0.775 Vali Loss: 0.719 Vali Acc: 0.828 Test Loss: 0.719 Test Acc: 0.828
Validation loss decreased (-0.815616 --> -0.828118).  Saving model ...
Epoch: 8 cost time: 1.0109002590179443
Epoch: 8, Steps: 8 | Train Loss: 0.591 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2889084815979004
Epoch: 9, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.165851354598999
Epoch: 10, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.534 Vali Acc: 0.838 Test Loss: 0.534 Test Acc: 0.838
Validation loss decreased (-0.828118 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 1.2903153896331787
Epoch: 11, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 12 cost time: 1.2473845481872559
Epoch: 12, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.575 Vali Acc: 0.812 Test Loss: 0.575 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1228129863739014
Epoch: 13, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.98577880859375
Epoch: 14, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0732996463775635
Epoch: 15, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.573 Vali Acc: 0.847 Test Loss: 0.573 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846869).  Saving model ...
Epoch: 16 cost time: 1.0018501281738281
Epoch: 16, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.618 Vali Acc: 0.819 Test Loss: 0.618 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1225998401641846
Epoch: 17, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.606 Vali Acc: 0.841 Test Loss: 0.606 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3661458492279053
Epoch: 18, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.648 Vali Acc: 0.834 Test Loss: 0.648 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3919925689697266
Epoch: 19, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.657 Vali Acc: 0.828 Test Loss: 0.657 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1084463596343994
Epoch: 20, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.670 Vali Acc: 0.825 Test Loss: 0.670 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2179522514343262
Epoch: 21, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.699 Vali Acc: 0.841 Test Loss: 0.699 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1416950225830078
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.696 Vali Acc: 0.825 Test Loss: 0.696 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1830458641052246
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.711 Vali Acc: 0.831 Test Loss: 0.711 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1514267921447754
Epoch: 24, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.732 Vali Acc: 0.831 Test Loss: 0.732 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1503257751464844
Epoch: 25, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.747 Vali Acc: 0.838 Test Loss: 0.747 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 456288
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.008087635040283
Epoch: 1, Steps: 8 | Train Loss: 2.267 Vali Loss: 2.077 Vali Acc: 0.203 Test Loss: 2.077 Test Acc: 0.203
Validation loss decreased (inf --> -0.203104).  Saving model ...
Epoch: 2 cost time: 0.8011560440063477
Epoch: 2, Steps: 8 | Train Loss: 2.054 Vali Loss: 1.897 Vali Acc: 0.325 Test Loss: 1.897 Test Acc: 0.325
Validation loss decreased (-0.203104 --> -0.324981).  Saving model ...
Epoch: 3 cost time: 0.756542444229126
Epoch: 3, Steps: 8 | Train Loss: 1.842 Vali Loss: 1.618 Vali Acc: 0.578 Test Loss: 1.618 Test Acc: 0.578
Validation loss decreased (-0.324981 --> -0.578109).  Saving model ...
Epoch: 4 cost time: 0.9601051807403564
Epoch: 4, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.349 Vali Acc: 0.681 Test Loss: 1.349 Test Acc: 0.681
Validation loss decreased (-0.578109 --> -0.681237).  Saving model ...
Epoch: 5 cost time: 0.862454891204834
Epoch: 5, Steps: 8 | Train Loss: 1.214 Vali Loss: 1.091 Vali Acc: 0.775 Test Loss: 1.091 Test Acc: 0.775
Validation loss decreased (-0.681237 --> -0.774989).  Saving model ...
Epoch: 6 cost time: 0.8459877967834473
Epoch: 6, Steps: 8 | Train Loss: 0.938 Vali Loss: 0.864 Vali Acc: 0.766 Test Loss: 0.864 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8296768665313721
Epoch: 7, Steps: 8 | Train Loss: 0.734 Vali Loss: 0.711 Vali Acc: 0.825 Test Loss: 0.711 Test Acc: 0.825
Validation loss decreased (-0.774989 --> -0.824993).  Saving model ...
Epoch: 8 cost time: 0.8060517311096191
Epoch: 8, Steps: 8 | Train Loss: 0.594 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9842610359191895
Epoch: 9, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.592 Vali Acc: 0.816 Test Loss: 0.592 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9330575466156006
Epoch: 10, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.583 Vali Acc: 0.806 Test Loss: 0.583 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8747715950012207
Epoch: 11, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.538 Vali Acc: 0.834 Test Loss: 0.538 Test Acc: 0.834
Validation loss decreased (-0.824993 --> -0.834370).  Saving model ...
Epoch: 12 cost time: 0.869499683380127
Epoch: 12, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9301705360412598
Epoch: 13, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.608 Vali Acc: 0.800 Test Loss: 0.608 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7900073528289795
Epoch: 14, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.562 Vali Acc: 0.834 Test Loss: 0.562 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.082714319229126
Epoch: 15, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.597 Vali Acc: 0.822 Test Loss: 0.597 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1345503330230713
Epoch: 16, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.612 Vali Acc: 0.819 Test Loss: 0.612 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0960679054260254
Epoch: 17, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.625 Vali Acc: 0.816 Test Loss: 0.625 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.213860034942627
Epoch: 18, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.649 Vali Acc: 0.806 Test Loss: 0.649 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9689126014709473
Epoch: 19, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.687 Vali Acc: 0.812 Test Loss: 0.687 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1170110702514648
Epoch: 20, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.680 Vali Acc: 0.831 Test Loss: 0.680 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1111927032470703
Epoch: 21, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.690 Vali Acc: 0.825 Test Loss: 0.690 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 454560
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.725207805633545
Epoch: 1, Steps: 8 | Train Loss: 2.088 Vali Loss: 1.960 Vali Acc: 0.266 Test Loss: 1.960 Test Acc: 0.266
Validation loss decreased (inf --> -0.265605).  Saving model ...
Epoch: 2 cost time: 1.0502347946166992
Epoch: 2, Steps: 8 | Train Loss: 1.923 Vali Loss: 1.769 Vali Acc: 0.466 Test Loss: 1.769 Test Acc: 0.466
Validation loss decreased (-0.265605 --> -0.465607).  Saving model ...
Epoch: 3 cost time: 1.0691769123077393
Epoch: 3, Steps: 8 | Train Loss: 1.673 Vali Loss: 1.508 Vali Acc: 0.731 Test Loss: 1.508 Test Acc: 0.731
Validation loss decreased (-0.465607 --> -0.731235).  Saving model ...
Epoch: 4 cost time: 1.5082063674926758
Epoch: 4, Steps: 8 | Train Loss: 1.374 Vali Loss: 1.259 Vali Acc: 0.725 Test Loss: 1.259 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0946595668792725
Epoch: 5, Steps: 8 | Train Loss: 1.167 Vali Loss: 1.010 Vali Acc: 0.800 Test Loss: 1.010 Test Acc: 0.800
Validation loss decreased (-0.731235 --> -0.799990).  Saving model ...
Epoch: 6 cost time: 0.9657943248748779
Epoch: 6, Steps: 8 | Train Loss: 0.864 Vali Loss: 0.810 Vali Acc: 0.803 Test Loss: 0.810 Test Acc: 0.803
Validation loss decreased (-0.799990 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 1.0832138061523438
Epoch: 7, Steps: 8 | Train Loss: 0.711 Vali Loss: 0.647 Vali Acc: 0.828 Test Loss: 0.647 Test Acc: 0.828
Validation loss decreased (-0.803117 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 0.9851341247558594
Epoch: 8, Steps: 8 | Train Loss: 0.550 Vali Loss: 0.585 Vali Acc: 0.825 Test Loss: 0.585 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1398365497589111
Epoch: 9, Steps: 8 | Train Loss: 0.414 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 1.2358877658843994
Epoch: 10, Steps: 8 | Train Loss: 0.367 Vali Loss: 0.510 Vali Acc: 0.847 Test Loss: 0.510 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 1.053257942199707
Epoch: 11, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0392134189605713
Epoch: 12, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8259742259979248
Epoch: 13, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.569 Vali Acc: 0.831 Test Loss: 0.569 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0203766822814941
Epoch: 14, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.612 Vali Acc: 0.791 Test Loss: 0.612 Test Acc: 0.791
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0342817306518555
Epoch: 15, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.577 Vali Acc: 0.838 Test Loss: 0.577 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9808521270751953
Epoch: 16, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9357602596282959
Epoch: 17, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.626 Vali Acc: 0.831 Test Loss: 0.626 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8717050552368164
Epoch: 18, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.635 Vali Acc: 0.825 Test Loss: 0.635 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9643664360046387
Epoch: 19, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.657 Vali Acc: 0.834 Test Loss: 0.657 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0914711952209473
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.659 Vali Acc: 0.819 Test Loss: 0.659 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 452832
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7670328617095947
Epoch: 1, Steps: 8 | Train Loss: 2.165 Vali Loss: 2.057 Vali Acc: 0.128 Test Loss: 2.057 Test Acc: 0.128
Validation loss decreased (inf --> -0.128104).  Saving model ...
Epoch: 2 cost time: 1.1439270973205566
Epoch: 2, Steps: 8 | Train Loss: 2.040 Vali Loss: 1.878 Vali Acc: 0.328 Test Loss: 1.878 Test Acc: 0.328
Validation loss decreased (-0.128104 --> -0.328106).  Saving model ...
Epoch: 3 cost time: 0.9894633293151855
Epoch: 3, Steps: 8 | Train Loss: 1.800 Vali Loss: 1.607 Vali Acc: 0.697 Test Loss: 1.607 Test Acc: 0.697
Validation loss decreased (-0.328106 --> -0.696859).  Saving model ...
Epoch: 4 cost time: 0.9767491817474365
Epoch: 4, Steps: 8 | Train Loss: 1.486 Vali Loss: 1.343 Vali Acc: 0.750 Test Loss: 1.343 Test Acc: 0.750
Validation loss decreased (-0.696859 --> -0.749987).  Saving model ...
Epoch: 5 cost time: 0.9349195957183838
Epoch: 5, Steps: 8 | Train Loss: 1.197 Vali Loss: 1.095 Vali Acc: 0.775 Test Loss: 1.095 Test Acc: 0.775
Validation loss decreased (-0.749987 --> -0.774989).  Saving model ...
Epoch: 6 cost time: 1.0214653015136719
Epoch: 6, Steps: 8 | Train Loss: 1.008 Vali Loss: 0.854 Vali Acc: 0.812 Test Loss: 0.854 Test Acc: 0.812
Validation loss decreased (-0.774989 --> -0.812491).  Saving model ...
Epoch: 7 cost time: 0.8528447151184082
Epoch: 7, Steps: 8 | Train Loss: 0.732 Vali Loss: 0.720 Vali Acc: 0.797 Test Loss: 0.720 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.034477949142456
Epoch: 8, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.599 Vali Acc: 0.825 Test Loss: 0.599 Test Acc: 0.825
Validation loss decreased (-0.812491 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 1.2092335224151611
Epoch: 9, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0843911170959473
Epoch: 10, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 1.180668830871582
Epoch: 11, Steps: 8 | Train Loss: 0.288 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9627852439880371
Epoch: 12, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.564 Vali Acc: 0.828 Test Loss: 0.564 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1601815223693848
Epoch: 13, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2635414600372314
Epoch: 14, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.090414047241211
Epoch: 15, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2083740234375
Epoch: 16, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9810106754302979
Epoch: 17, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.615 Vali Acc: 0.819 Test Loss: 0.615 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3586022853851318
Epoch: 18, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.629 Vali Acc: 0.831 Test Loss: 0.629 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1323370933532715
Epoch: 19, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.684 Vali Acc: 0.819 Test Loss: 0.684 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0234580039978027
Epoch: 20, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.684 Vali Acc: 0.816 Test Loss: 0.684 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 451104
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1632676124572754
Epoch: 1, Steps: 8 | Train Loss: 2.183 Vali Loss: 2.045 Vali Acc: 0.203 Test Loss: 2.045 Test Acc: 0.203
Validation loss decreased (inf --> -0.203105).  Saving model ...
Epoch: 2 cost time: 1.2561931610107422
Epoch: 2, Steps: 8 | Train Loss: 1.999 Vali Loss: 1.855 Vali Acc: 0.444 Test Loss: 1.855 Test Acc: 0.444
Validation loss decreased (-0.203105 --> -0.443731).  Saving model ...
Epoch: 3 cost time: 0.9628903865814209
Epoch: 3, Steps: 8 | Train Loss: 1.750 Vali Loss: 1.612 Vali Acc: 0.622 Test Loss: 1.612 Test Acc: 0.622
Validation loss decreased (-0.443731 --> -0.621859).  Saving model ...
Epoch: 4 cost time: 0.9819319248199463
Epoch: 4, Steps: 8 | Train Loss: 1.508 Vali Loss: 1.330 Vali Acc: 0.784 Test Loss: 1.330 Test Acc: 0.784
Validation loss decreased (-0.621859 --> -0.784362).  Saving model ...
Epoch: 5 cost time: 0.8039319515228271
Epoch: 5, Steps: 8 | Train Loss: 1.214 Vali Loss: 1.076 Vali Acc: 0.791 Test Loss: 1.076 Test Acc: 0.791
Validation loss decreased (-0.784362 --> -0.790614).  Saving model ...
Epoch: 6 cost time: 0.8644609451293945
Epoch: 6, Steps: 8 | Train Loss: 0.993 Vali Loss: 0.872 Vali Acc: 0.812 Test Loss: 0.872 Test Acc: 0.812
Validation loss decreased (-0.790614 --> -0.812491).  Saving model ...
Epoch: 7 cost time: 1.0541951656341553
Epoch: 7, Steps: 8 | Train Loss: 0.741 Vali Loss: 0.707 Vali Acc: 0.831 Test Loss: 0.707 Test Acc: 0.831
Validation loss decreased (-0.812491 --> -0.831243).  Saving model ...
Epoch: 8 cost time: 0.9451146125793457
Epoch: 8, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8325197696685791
Epoch: 9, Steps: 8 | Train Loss: 0.494 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
Validation loss decreased (-0.831243 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 1.0425817966461182
Epoch: 10, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
Validation loss decreased (-0.846870 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 0.9068737030029297
Epoch: 11, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.542 Vali Acc: 0.812 Test Loss: 0.542 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9724307060241699
Epoch: 12, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9703810214996338
Epoch: 13, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.531 Vali Acc: 0.834 Test Loss: 0.531 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0240614414215088
Epoch: 14, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2525780200958252
Epoch: 15, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.575 Vali Acc: 0.816 Test Loss: 0.575 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0302371978759766
Epoch: 16, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.595 Vali Acc: 0.812 Test Loss: 0.595 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.028749704360962
Epoch: 17, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.185734748840332
Epoch: 18, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0214943885803223
Epoch: 19, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.627 Vali Acc: 0.828 Test Loss: 0.627 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0318658351898193
Epoch: 20, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.657 Vali Acc: 0.812 Test Loss: 0.657 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 357216
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1158859729766846
Epoch: 1, Steps: 8 | Train Loss: 2.172 Vali Loss: 2.037 Vali Acc: 0.172 Test Loss: 2.037 Test Acc: 0.172
Validation loss decreased (inf --> -0.171855).  Saving model ...
Epoch: 2 cost time: 1.006700038909912
Epoch: 2, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.866 Vali Acc: 0.319 Test Loss: 1.866 Test Acc: 0.319
Validation loss decreased (-0.171855 --> -0.318731).  Saving model ...
Epoch: 3 cost time: 1.0373849868774414
Epoch: 3, Steps: 8 | Train Loss: 1.765 Vali Loss: 1.598 Vali Acc: 0.625 Test Loss: 1.598 Test Acc: 0.625
Validation loss decreased (-0.318731 --> -0.624984).  Saving model ...
Epoch: 4 cost time: 0.9164650440216064
Epoch: 4, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.359 Vali Acc: 0.731 Test Loss: 1.359 Test Acc: 0.731
Validation loss decreased (-0.624984 --> -0.731236).  Saving model ...
Epoch: 5 cost time: 0.8950760364532471
Epoch: 5, Steps: 8 | Train Loss: 1.250 Vali Loss: 1.107 Vali Acc: 0.800 Test Loss: 1.107 Test Acc: 0.800
Validation loss decreased (-0.731236 --> -0.799989).  Saving model ...
Epoch: 6 cost time: 0.8656535148620605
Epoch: 6, Steps: 8 | Train Loss: 1.005 Vali Loss: 0.894 Vali Acc: 0.791 Test Loss: 0.894 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.907543420791626
Epoch: 7, Steps: 8 | Train Loss: 0.768 Vali Loss: 0.733 Vali Acc: 0.822 Test Loss: 0.733 Test Acc: 0.822
Validation loss decreased (-0.799989 --> -0.821868).  Saving model ...
Epoch: 8 cost time: 0.9684925079345703
Epoch: 8, Steps: 8 | Train Loss: 0.628 Vali Loss: 0.635 Vali Acc: 0.825 Test Loss: 0.635 Test Acc: 0.825
Validation loss decreased (-0.821868 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 0.8847405910491943
Epoch: 9, Steps: 8 | Train Loss: 0.505 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.2182016372680664
Epoch: 10, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.557 Vali Acc: 0.812 Test Loss: 0.557 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9160726070404053
Epoch: 11, Steps: 8 | Train Loss: 0.355 Vali Loss: 0.535 Vali Acc: 0.853 Test Loss: 0.535 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 1.2304885387420654
Epoch: 12, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0424275398254395
Epoch: 13, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2759008407592773
Epoch: 14, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.563 Vali Acc: 0.816 Test Loss: 0.563 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9677205085754395
Epoch: 15, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0255863666534424
Epoch: 16, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2763659954071045
Epoch: 17, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.623 Vali Acc: 0.819 Test Loss: 0.623 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.008289098739624
Epoch: 18, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.614 Vali Acc: 0.819 Test Loss: 0.614 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9507706165313721
Epoch: 19, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.626 Vali Acc: 0.825 Test Loss: 0.626 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9583146572113037
Epoch: 20, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.673 Vali Acc: 0.816 Test Loss: 0.673 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8861963748931885
Epoch: 21, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.694 Vali Acc: 0.812 Test Loss: 0.694 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 355488
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.679643154144287
Epoch: 1, Steps: 8 | Train Loss: 2.213 Vali Loss: 2.041 Vali Acc: 0.228 Test Loss: 2.041 Test Acc: 0.228
Validation loss decreased (inf --> -0.228105).  Saving model ...
Epoch: 2 cost time: 1.0341975688934326
Epoch: 2, Steps: 8 | Train Loss: 1.988 Vali Loss: 1.855 Vali Acc: 0.469 Test Loss: 1.855 Test Acc: 0.469
Validation loss decreased (-0.228105 --> -0.468731).  Saving model ...
Epoch: 3 cost time: 0.92572021484375
Epoch: 3, Steps: 8 | Train Loss: 1.830 Vali Loss: 1.611 Vali Acc: 0.613 Test Loss: 1.611 Test Acc: 0.613
Validation loss decreased (-0.468731 --> -0.612484).  Saving model ...
Epoch: 4 cost time: 1.0419049263000488
Epoch: 4, Steps: 8 | Train Loss: 1.509 Vali Loss: 1.347 Vali Acc: 0.694 Test Loss: 1.347 Test Acc: 0.694
Validation loss decreased (-0.612484 --> -0.693737).  Saving model ...
Epoch: 5 cost time: 0.812169075012207
Epoch: 5, Steps: 8 | Train Loss: 1.273 Vali Loss: 1.091 Vali Acc: 0.797 Test Loss: 1.091 Test Acc: 0.797
Validation loss decreased (-0.693737 --> -0.796864).  Saving model ...
Epoch: 6 cost time: 0.7704315185546875
Epoch: 6, Steps: 8 | Train Loss: 0.979 Vali Loss: 0.882 Vali Acc: 0.800 Test Loss: 0.882 Test Acc: 0.800
Validation loss decreased (-0.796864 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 0.7889230251312256
Epoch: 7, Steps: 8 | Train Loss: 0.770 Vali Loss: 0.722 Vali Acc: 0.816 Test Loss: 0.722 Test Acc: 0.816
Validation loss decreased (-0.799991 --> -0.815618).  Saving model ...
Epoch: 8 cost time: 0.6479740142822266
Epoch: 8, Steps: 8 | Train Loss: 0.662 Vali Loss: 0.612 Vali Acc: 0.834 Test Loss: 0.612 Test Acc: 0.834
Validation loss decreased (-0.815618 --> -0.834369).  Saving model ...
Epoch: 9 cost time: 0.8003034591674805
Epoch: 9, Steps: 8 | Train Loss: 0.504 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9765324592590332
Epoch: 10, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 1.0995409488677979
Epoch: 11, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.560 Vali Acc: 0.816 Test Loss: 0.560 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0977783203125
Epoch: 12, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8340895175933838
Epoch: 13, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.534 Vali Acc: 0.828 Test Loss: 0.534 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0612876415252686
Epoch: 14, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9346675872802734
Epoch: 15, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.553 Vali Acc: 0.831 Test Loss: 0.553 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9905087947845459
Epoch: 16, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.05849027633667
Epoch: 17, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.634 Vali Acc: 0.800 Test Loss: 0.634 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9539594650268555
Epoch: 18, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.630 Vali Acc: 0.828 Test Loss: 0.630 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9638636112213135
Epoch: 19, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.643 Vali Acc: 0.841 Test Loss: 0.643 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9064927101135254
Epoch: 20, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.659 Vali Acc: 0.816 Test Loss: 0.659 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 353760
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0109670162200928
Epoch: 1, Steps: 8 | Train Loss: 2.221 Vali Loss: 2.062 Vali Acc: 0.247 Test Loss: 2.062 Test Acc: 0.247
Validation loss decreased (inf --> -0.246854).  Saving model ...
Epoch: 2 cost time: 1.046567678451538
Epoch: 2, Steps: 8 | Train Loss: 1.989 Vali Loss: 1.864 Vali Acc: 0.378 Test Loss: 1.864 Test Acc: 0.378
Validation loss decreased (-0.246854 --> -0.378106).  Saving model ...
Epoch: 3 cost time: 0.9290444850921631
Epoch: 3, Steps: 8 | Train Loss: 1.816 Vali Loss: 1.594 Vali Acc: 0.637 Test Loss: 1.594 Test Acc: 0.637
Validation loss decreased (-0.378106 --> -0.637484).  Saving model ...
Epoch: 4 cost time: 0.9221546649932861
Epoch: 4, Steps: 8 | Train Loss: 1.499 Vali Loss: 1.314 Vali Acc: 0.694 Test Loss: 1.314 Test Acc: 0.694
Validation loss decreased (-0.637484 --> -0.693737).  Saving model ...
Epoch: 5 cost time: 1.042203426361084
Epoch: 5, Steps: 8 | Train Loss: 1.192 Vali Loss: 1.060 Vali Acc: 0.778 Test Loss: 1.060 Test Acc: 0.778
Validation loss decreased (-0.693737 --> -0.778114).  Saving model ...
Epoch: 6 cost time: 1.0110621452331543
Epoch: 6, Steps: 8 | Train Loss: 0.926 Vali Loss: 0.855 Vali Acc: 0.806 Test Loss: 0.855 Test Acc: 0.806
Validation loss decreased (-0.778114 --> -0.806241).  Saving model ...
Epoch: 7 cost time: 1.1398799419403076
Epoch: 7, Steps: 8 | Train Loss: 0.804 Vali Loss: 0.708 Vali Acc: 0.819 Test Loss: 0.708 Test Acc: 0.819
Validation loss decreased (-0.806241 --> -0.818743).  Saving model ...
Epoch: 8 cost time: 1.0854461193084717
Epoch: 8, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.220189094543457
Epoch: 9, Steps: 8 | Train Loss: 0.482 Vali Loss: 0.559 Vali Acc: 0.847 Test Loss: 0.559 Test Acc: 0.847
Validation loss decreased (-0.818743 --> -0.846869).  Saving model ...
Epoch: 10 cost time: 1.1662375926971436
Epoch: 10, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.543 Vali Acc: 0.831 Test Loss: 0.543 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9422430992126465
Epoch: 11, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.545 Vali Acc: 0.838 Test Loss: 0.545 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9682650566101074
Epoch: 12, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1054325103759766
Epoch: 13, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9696784019470215
Epoch: 14, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.593 Vali Acc: 0.825 Test Loss: 0.593 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.047785997390747
Epoch: 15, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0945160388946533
Epoch: 16, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.637 Vali Acc: 0.816 Test Loss: 0.637 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2186059951782227
Epoch: 17, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.609 Vali Acc: 0.831 Test Loss: 0.609 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1795413494110107
Epoch: 18, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.609 Vali Acc: 0.831 Test Loss: 0.609 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2958879470825195
Epoch: 19, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.655 Vali Acc: 0.831 Test Loss: 0.655 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 352032
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8509929180145264
Epoch: 1, Steps: 8 | Train Loss: 2.155 Vali Loss: 2.070 Vali Acc: 0.141 Test Loss: 2.070 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 0.9684836864471436
Epoch: 2, Steps: 8 | Train Loss: 1.975 Vali Loss: 1.880 Vali Acc: 0.362 Test Loss: 1.880 Test Acc: 0.362
Validation loss decreased (-0.140604 --> -0.362481).  Saving model ...
Epoch: 3 cost time: 1.23423171043396
Epoch: 3, Steps: 8 | Train Loss: 1.811 Vali Loss: 1.631 Vali Acc: 0.619 Test Loss: 1.631 Test Acc: 0.619
Validation loss decreased (-0.362481 --> -0.618734).  Saving model ...
Epoch: 4 cost time: 1.3109872341156006
Epoch: 4, Steps: 8 | Train Loss: 1.502 Vali Loss: 1.368 Vali Acc: 0.756 Test Loss: 1.368 Test Acc: 0.756
Validation loss decreased (-0.618734 --> -0.756236).  Saving model ...
Epoch: 5 cost time: 1.0607779026031494
Epoch: 5, Steps: 8 | Train Loss: 1.284 Vali Loss: 1.111 Vali Acc: 0.800 Test Loss: 1.111 Test Acc: 0.800
Validation loss decreased (-0.756236 --> -0.799989).  Saving model ...
Epoch: 6 cost time: 0.9038755893707275
Epoch: 6, Steps: 8 | Train Loss: 1.018 Vali Loss: 0.911 Vali Acc: 0.825 Test Loss: 0.911 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 1.132655382156372
Epoch: 7, Steps: 8 | Train Loss: 0.770 Vali Loss: 0.754 Vali Acc: 0.806 Test Loss: 0.754 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1327054500579834
Epoch: 8, Steps: 8 | Train Loss: 0.620 Vali Loss: 0.645 Vali Acc: 0.847 Test Loss: 0.645 Test Acc: 0.847
Validation loss decreased (-0.824991 --> -0.846869).  Saving model ...
Epoch: 9 cost time: 0.9561617374420166
Epoch: 9, Steps: 8 | Train Loss: 0.508 Vali Loss: 0.602 Vali Acc: 0.806 Test Loss: 0.602 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4277689456939697
Epoch: 10, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.563 Vali Acc: 0.834 Test Loss: 0.563 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.147949457168579
Epoch: 11, Steps: 8 | Train Loss: 0.374 Vali Loss: 0.577 Vali Acc: 0.806 Test Loss: 0.577 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0245952606201172
Epoch: 12, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0175912380218506
Epoch: 13, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0525143146514893
Epoch: 14, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9104840755462646
Epoch: 15, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8058934211730957
Epoch: 16, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.598 Vali Acc: 0.806 Test Loss: 0.598 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.833336591720581
Epoch: 17, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.622 Vali Acc: 0.828 Test Loss: 0.622 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9920597076416016
Epoch: 18, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.637 Vali Acc: 0.812 Test Loss: 0.637 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 307680
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.458467721939087
Epoch: 1, Steps: 8 | Train Loss: 2.242 Vali Loss: 2.075 Vali Acc: 0.150 Test Loss: 2.075 Test Acc: 0.150
Validation loss decreased (inf --> -0.149979).  Saving model ...
Epoch: 2 cost time: 0.9390275478363037
Epoch: 2, Steps: 8 | Train Loss: 2.039 Vali Loss: 1.879 Vali Acc: 0.303 Test Loss: 1.879 Test Acc: 0.303
Validation loss decreased (-0.149979 --> -0.303106).  Saving model ...
Epoch: 3 cost time: 0.7884767055511475
Epoch: 3, Steps: 8 | Train Loss: 1.829 Vali Loss: 1.641 Vali Acc: 0.644 Test Loss: 1.641 Test Acc: 0.644
Validation loss decreased (-0.303106 --> -0.643734).  Saving model ...
Epoch: 4 cost time: 0.8603310585021973
Epoch: 4, Steps: 8 | Train Loss: 1.516 Vali Loss: 1.389 Vali Acc: 0.716 Test Loss: 1.389 Test Acc: 0.716
Validation loss decreased (-0.643734 --> -0.715611).  Saving model ...
Epoch: 5 cost time: 1.1857452392578125
Epoch: 5, Steps: 8 | Train Loss: 1.269 Vali Loss: 1.137 Vali Acc: 0.747 Test Loss: 1.137 Test Acc: 0.747
Validation loss decreased (-0.715611 --> -0.746864).  Saving model ...
Epoch: 6 cost time: 0.7829341888427734
Epoch: 6, Steps: 8 | Train Loss: 1.011 Vali Loss: 0.916 Vali Acc: 0.806 Test Loss: 0.916 Test Acc: 0.806
Validation loss decreased (-0.746864 --> -0.806241).  Saving model ...
Epoch: 7 cost time: 0.9257237911224365
Epoch: 7, Steps: 8 | Train Loss: 0.811 Vali Loss: 0.754 Vali Acc: 0.812 Test Loss: 0.754 Test Acc: 0.812
Validation loss decreased (-0.806241 --> -0.812492).  Saving model ...
Epoch: 8 cost time: 1.0589756965637207
Epoch: 8, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.645 Vali Acc: 0.841 Test Loss: 0.645 Test Acc: 0.841
Validation loss decreased (-0.812492 --> -0.840619).  Saving model ...
Epoch: 9 cost time: 0.9946372509002686
Epoch: 9, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.576 Vali Acc: 0.825 Test Loss: 0.576 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.885451078414917
Epoch: 10, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
Validation loss decreased (-0.840619 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.7947134971618652
Epoch: 11, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9216406345367432
Epoch: 12, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.566 Vali Acc: 0.806 Test Loss: 0.566 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9948327541351318
Epoch: 13, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9581284523010254
Epoch: 14, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.577 Vali Acc: 0.806 Test Loss: 0.577 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0211477279663086
Epoch: 15, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0276639461517334
Epoch: 16, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.586 Vali Acc: 0.816 Test Loss: 0.586 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9818868637084961
Epoch: 17, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.625 Vali Acc: 0.812 Test Loss: 0.625 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8637917041778564
Epoch: 18, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.629 Vali Acc: 0.825 Test Loss: 0.629 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8885552883148193
Epoch: 19, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.629 Vali Acc: 0.812 Test Loss: 0.629 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8661057949066162
Epoch: 20, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.677 Vali Acc: 0.816 Test Loss: 0.677 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 305952
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3469605445861816
Epoch: 1, Steps: 8 | Train Loss: 2.202 Vali Loss: 2.100 Vali Acc: 0.094 Test Loss: 2.100 Test Acc: 0.094
Validation loss decreased (inf --> -0.093729).  Saving model ...
Epoch: 2 cost time: 1.069685459136963
Epoch: 2, Steps: 8 | Train Loss: 2.073 Vali Loss: 1.924 Vali Acc: 0.297 Test Loss: 1.924 Test Acc: 0.297
Validation loss decreased (-0.093729 --> -0.296856).  Saving model ...
Epoch: 3 cost time: 0.9324820041656494
Epoch: 3, Steps: 8 | Train Loss: 1.848 Vali Loss: 1.661 Vali Acc: 0.644 Test Loss: 1.661 Test Acc: 0.644
Validation loss decreased (-0.296856 --> -0.643733).  Saving model ...
Epoch: 4 cost time: 0.814124345779419
Epoch: 4, Steps: 8 | Train Loss: 1.585 Vali Loss: 1.425 Vali Acc: 0.694 Test Loss: 1.425 Test Acc: 0.694
Validation loss decreased (-0.643733 --> -0.693736).  Saving model ...
Epoch: 5 cost time: 0.9648866653442383
Epoch: 5, Steps: 8 | Train Loss: 1.268 Vali Loss: 1.166 Vali Acc: 0.769 Test Loss: 1.166 Test Acc: 0.769
Validation loss decreased (-0.693736 --> -0.768738).  Saving model ...
Epoch: 6 cost time: 1.0400874614715576
Epoch: 6, Steps: 8 | Train Loss: 1.027 Vali Loss: 0.947 Vali Acc: 0.809 Test Loss: 0.947 Test Acc: 0.809
Validation loss decreased (-0.768738 --> -0.809366).  Saving model ...
Epoch: 7 cost time: 1.181490421295166
Epoch: 7, Steps: 8 | Train Loss: 0.849 Vali Loss: 0.763 Vali Acc: 0.809 Test Loss: 0.763 Test Acc: 0.809
Validation loss decreased (-0.809366 --> -0.809367).  Saving model ...
Epoch: 8 cost time: 0.9274897575378418
Epoch: 8, Steps: 8 | Train Loss: 0.688 Vali Loss: 0.677 Vali Acc: 0.809 Test Loss: 0.677 Test Acc: 0.809
Validation loss decreased (-0.809367 --> -0.809368).  Saving model ...
Epoch: 9 cost time: 1.0688083171844482
Epoch: 9, Steps: 8 | Train Loss: 0.552 Vali Loss: 0.595 Vali Acc: 0.828 Test Loss: 0.595 Test Acc: 0.828
Validation loss decreased (-0.809368 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.7181634902954102
Epoch: 10, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8039965629577637
Epoch: 11, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9445502758026123
Epoch: 12, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0039541721343994
Epoch: 13, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8651776313781738
Epoch: 14, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.572 Vali Acc: 0.806 Test Loss: 0.572 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.091731309890747
Epoch: 15, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0478901863098145
Epoch: 16, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.581 Vali Acc: 0.812 Test Loss: 0.581 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8993291854858398
Epoch: 17, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1441948413848877
Epoch: 18, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.636 Vali Acc: 0.812 Test Loss: 0.636 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9769222736358643
Epoch: 19, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.657 Vali Acc: 0.809 Test Loss: 0.657 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.828125
model parameter : 304224
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.264272689819336
Epoch: 1, Steps: 8 | Train Loss: 2.159 Vali Loss: 2.087 Vali Acc: 0.169 Test Loss: 2.087 Test Acc: 0.169
Validation loss decreased (inf --> -0.168729).  Saving model ...
Epoch: 2 cost time: 1.2606525421142578
Epoch: 2, Steps: 8 | Train Loss: 2.002 Vali Loss: 1.912 Vali Acc: 0.275 Test Loss: 1.912 Test Acc: 0.275
Validation loss decreased (-0.168729 --> -0.274981).  Saving model ...
Epoch: 3 cost time: 0.8998429775238037
Epoch: 3, Steps: 8 | Train Loss: 1.799 Vali Loss: 1.651 Vali Acc: 0.606 Test Loss: 1.651 Test Acc: 0.606
Validation loss decreased (-0.274981 --> -0.606233).  Saving model ...
Epoch: 4 cost time: 1.2406659126281738
Epoch: 4, Steps: 8 | Train Loss: 1.520 Vali Loss: 1.402 Vali Acc: 0.691 Test Loss: 1.402 Test Acc: 0.691
Validation loss decreased (-0.606233 --> -0.690611).  Saving model ...
Epoch: 5 cost time: 1.2844316959381104
Epoch: 5, Steps: 8 | Train Loss: 1.304 Vali Loss: 1.164 Vali Acc: 0.759 Test Loss: 1.164 Test Acc: 0.759
Validation loss decreased (-0.690611 --> -0.759363).  Saving model ...
Epoch: 6 cost time: 0.9900250434875488
Epoch: 6, Steps: 8 | Train Loss: 1.014 Vali Loss: 0.944 Vali Acc: 0.800 Test Loss: 0.944 Test Acc: 0.800
Validation loss decreased (-0.759363 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 0.875389814376831
Epoch: 7, Steps: 8 | Train Loss: 0.845 Vali Loss: 0.773 Vali Acc: 0.803 Test Loss: 0.773 Test Acc: 0.803
Validation loss decreased (-0.799991 --> -0.803117).  Saving model ...
Epoch: 8 cost time: 0.872535228729248
Epoch: 8, Steps: 8 | Train Loss: 0.668 Vali Loss: 0.660 Vali Acc: 0.831 Test Loss: 0.660 Test Acc: 0.831
Validation loss decreased (-0.803117 --> -0.831243).  Saving model ...
Epoch: 9 cost time: 0.8398480415344238
Epoch: 9, Steps: 8 | Train Loss: 0.510 Vali Loss: 0.616 Vali Acc: 0.828 Test Loss: 0.616 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1175453662872314
Epoch: 10, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.571 Vali Acc: 0.816 Test Loss: 0.571 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0847172737121582
Epoch: 11, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7759582996368408
Epoch: 12, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.568 Vali Acc: 0.812 Test Loss: 0.568 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8664920330047607
Epoch: 13, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
Validation loss decreased (-0.831243 --> -0.834370).  Saving model ...
Epoch: 14 cost time: 0.9793570041656494
Epoch: 14, Steps: 8 | Train Loss: 0.212 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 15 cost time: 1.0099692344665527
Epoch: 15, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.595 Vali Acc: 0.825 Test Loss: 0.595 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1761138439178467
Epoch: 16, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.165461778640747
Epoch: 17, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.587 Vali Acc: 0.828 Test Loss: 0.587 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0661895275115967
Epoch: 18, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.646 Vali Acc: 0.806 Test Loss: 0.646 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1840085983276367
Epoch: 19, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.657 Vali Acc: 0.825 Test Loss: 0.657 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.162538766860962
Epoch: 20, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.650 Vali Acc: 0.828 Test Loss: 0.650 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9743895530700684
Epoch: 21, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.688 Vali Acc: 0.816 Test Loss: 0.688 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8850967884063721
Epoch: 22, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.709 Vali Acc: 0.828 Test Loss: 0.709 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9020693302154541
Epoch: 23, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.724 Vali Acc: 0.825 Test Loss: 0.724 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1231374740600586
Epoch: 24, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.717 Vali Acc: 0.825 Test Loss: 0.717 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 302496
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.887099027633667
Epoch: 1, Steps: 8 | Train Loss: 2.310 Vali Loss: 2.219 Vali Acc: 0.072 Test Loss: 2.219 Test Acc: 0.072
Validation loss decreased (inf --> -0.071853).  Saving model ...
Epoch: 2 cost time: 0.8946647644042969
Epoch: 2, Steps: 8 | Train Loss: 2.135 Vali Loss: 2.064 Vali Acc: 0.131 Test Loss: 2.064 Test Acc: 0.131
Validation loss decreased (-0.071853 --> -0.131229).  Saving model ...
Epoch: 3 cost time: 1.0876517295837402
Epoch: 3, Steps: 8 | Train Loss: 2.021 Vali Loss: 1.912 Vali Acc: 0.303 Test Loss: 1.912 Test Acc: 0.303
Validation loss decreased (-0.131229 --> -0.303106).  Saving model ...
Epoch: 4 cost time: 0.9541516304016113
Epoch: 4, Steps: 8 | Train Loss: 1.844 Vali Loss: 1.693 Vali Acc: 0.572 Test Loss: 1.693 Test Acc: 0.572
Validation loss decreased (-0.303106 --> -0.571858).  Saving model ...
Epoch: 5 cost time: 1.0308375358581543
Epoch: 5, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.486 Vali Acc: 0.675 Test Loss: 1.486 Test Acc: 0.675
Validation loss decreased (-0.571858 --> -0.674985).  Saving model ...
Epoch: 6 cost time: 0.8204391002655029
Epoch: 6, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.250 Vali Acc: 0.741 Test Loss: 1.250 Test Acc: 0.741
Validation loss decreased (-0.674985 --> -0.740613).  Saving model ...
Epoch: 7 cost time: 0.8400449752807617
Epoch: 7, Steps: 8 | Train Loss: 1.105 Vali Loss: 1.014 Vali Acc: 0.762 Test Loss: 1.014 Test Acc: 0.762
Validation loss decreased (-0.740613 --> -0.762490).  Saving model ...
Epoch: 8 cost time: 1.126983642578125
Epoch: 8, Steps: 8 | Train Loss: 0.914 Vali Loss: 0.823 Vali Acc: 0.781 Test Loss: 0.823 Test Acc: 0.781
Validation loss decreased (-0.762490 --> -0.781242).  Saving model ...
Epoch: 9 cost time: 0.8286216259002686
Epoch: 9, Steps: 8 | Train Loss: 0.714 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
Validation loss decreased (-0.781242 --> -0.803118).  Saving model ...
Epoch: 10 cost time: 1.0962724685668945
Epoch: 10, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.614 Vali Acc: 0.844 Test Loss: 0.614 Test Acc: 0.844
Validation loss decreased (-0.803118 --> -0.843744).  Saving model ...
Epoch: 11 cost time: 0.8403816223144531
Epoch: 11, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.568 Vali Acc: 0.828 Test Loss: 0.568 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9932188987731934
Epoch: 12, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8998434543609619
Epoch: 13, Steps: 8 | Train Loss: 0.301 Vali Loss: 0.546 Vali Acc: 0.831 Test Loss: 0.546 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0659356117248535
Epoch: 14, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.518 Vali Acc: 0.834 Test Loss: 0.518 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0941133499145508
Epoch: 15, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 1.081944227218628
Epoch: 16, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0457117557525635
Epoch: 17, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8555927276611328
Epoch: 18, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.097470998764038
Epoch: 19, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0775432586669922
Epoch: 20, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.559 Vali Acc: 0.831 Test Loss: 0.559 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1470565795898438
Epoch: 21, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1056370735168457
Epoch: 22, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.581 Vali Acc: 0.838 Test Loss: 0.581 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.11665678024292
Epoch: 23, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.571 Vali Acc: 0.834 Test Loss: 0.571 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.027984380722046
Epoch: 24, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0924479961395264
Epoch: 25, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.588 Vali Acc: 0.828 Test Loss: 0.588 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 279616
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.836573362350464
Epoch: 1, Steps: 8 | Train Loss: 2.412 Vali Loss: 2.237 Vali Acc: 0.131 Test Loss: 2.237 Test Acc: 0.131
Validation loss decreased (inf --> -0.131228).  Saving model ...
Epoch: 2 cost time: 1.2021782398223877
Epoch: 2, Steps: 8 | Train Loss: 2.162 Vali Loss: 2.017 Vali Acc: 0.234 Test Loss: 2.017 Test Acc: 0.234
Validation loss decreased (-0.131228 --> -0.234355).  Saving model ...
Epoch: 3 cost time: 1.1485159397125244
Epoch: 3, Steps: 8 | Train Loss: 2.014 Vali Loss: 1.876 Vali Acc: 0.406 Test Loss: 1.876 Test Acc: 0.406
Validation loss decreased (-0.234355 --> -0.406231).  Saving model ...
Epoch: 4 cost time: 0.8161165714263916
Epoch: 4, Steps: 8 | Train Loss: 1.838 Vali Loss: 1.679 Vali Acc: 0.606 Test Loss: 1.679 Test Acc: 0.606
Validation loss decreased (-0.406231 --> -0.606233).  Saving model ...
Epoch: 5 cost time: 0.8973433971405029
Epoch: 5, Steps: 8 | Train Loss: 1.606 Vali Loss: 1.472 Vali Acc: 0.731 Test Loss: 1.472 Test Acc: 0.731
Validation loss decreased (-0.606233 --> -0.731235).  Saving model ...
Epoch: 6 cost time: 1.0358901023864746
Epoch: 6, Steps: 8 | Train Loss: 1.361 Vali Loss: 1.229 Vali Acc: 0.787 Test Loss: 1.229 Test Acc: 0.787
Validation loss decreased (-0.731235 --> -0.787488).  Saving model ...
Epoch: 7 cost time: 0.9004781246185303
Epoch: 7, Steps: 8 | Train Loss: 1.106 Vali Loss: 0.974 Vali Acc: 0.822 Test Loss: 0.974 Test Acc: 0.822
Validation loss decreased (-0.787488 --> -0.821865).  Saving model ...
Epoch: 8 cost time: 1.038344383239746
Epoch: 8, Steps: 8 | Train Loss: 0.838 Vali Loss: 0.778 Vali Acc: 0.812 Test Loss: 0.778 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1010525226593018
Epoch: 9, Steps: 8 | Train Loss: 0.682 Vali Loss: 0.667 Vali Acc: 0.803 Test Loss: 0.667 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9152777194976807
Epoch: 10, Steps: 8 | Train Loss: 0.540 Vali Loss: 0.597 Vali Acc: 0.809 Test Loss: 0.597 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0021929740905762
Epoch: 11, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.561 Vali Acc: 0.812 Test Loss: 0.561 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0121588706970215
Epoch: 12, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.527 Vali Acc: 0.822 Test Loss: 0.527 Test Acc: 0.822
Validation loss decreased (-0.821865 --> -0.821870).  Saving model ...
Epoch: 13 cost time: 0.806138277053833
Epoch: 13, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.164219856262207
Epoch: 14, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.525 Vali Acc: 0.834 Test Loss: 0.525 Test Acc: 0.834
Validation loss decreased (-0.821870 --> -0.834370).  Saving model ...
Epoch: 15 cost time: 1.0436155796051025
Epoch: 15, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1167967319488525
Epoch: 16, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.528 Vali Acc: 0.831 Test Loss: 0.528 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1945176124572754
Epoch: 17, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1449365615844727
Epoch: 18, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0096354484558105
Epoch: 19, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.11497163772583
Epoch: 20, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.560 Vali Acc: 0.825 Test Loss: 0.560 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9408693313598633
Epoch: 21, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9951047897338867
Epoch: 22, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0307672023773193
Epoch: 23, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.596 Vali Acc: 0.828 Test Loss: 0.596 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0305235385894775
Epoch: 24, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.596 Vali Acc: 0.816 Test Loss: 0.596 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 278752
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1248416900634766
Epoch: 1, Steps: 8 | Train Loss: 2.228 Vali Loss: 2.078 Vali Acc: 0.131 Test Loss: 2.078 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 0.9547131061553955
Epoch: 2, Steps: 8 | Train Loss: 2.082 Vali Loss: 1.945 Vali Acc: 0.297 Test Loss: 1.945 Test Acc: 0.297
Validation loss decreased (-0.131229 --> -0.296856).  Saving model ...
Epoch: 3 cost time: 0.8501114845275879
Epoch: 3, Steps: 8 | Train Loss: 1.906 Vali Loss: 1.799 Vali Acc: 0.428 Test Loss: 1.799 Test Acc: 0.428
Validation loss decreased (-0.296856 --> -0.428107).  Saving model ...
Epoch: 4 cost time: 0.9768862724304199
Epoch: 4, Steps: 8 | Train Loss: 1.781 Vali Loss: 1.597 Vali Acc: 0.644 Test Loss: 1.597 Test Acc: 0.644
Validation loss decreased (-0.428107 --> -0.643734).  Saving model ...
Epoch: 5 cost time: 1.0033118724822998
Epoch: 5, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.389 Vali Acc: 0.703 Test Loss: 1.389 Test Acc: 0.703
Validation loss decreased (-0.643734 --> -0.703111).  Saving model ...
Epoch: 6 cost time: 1.092602252960205
Epoch: 6, Steps: 8 | Train Loss: 1.308 Vali Loss: 1.134 Vali Acc: 0.753 Test Loss: 1.134 Test Acc: 0.753
Validation loss decreased (-0.703111 --> -0.753114).  Saving model ...
Epoch: 7 cost time: 0.8930056095123291
Epoch: 7, Steps: 8 | Train Loss: 1.059 Vali Loss: 0.904 Vali Acc: 0.806 Test Loss: 0.904 Test Acc: 0.806
Validation loss decreased (-0.753114 --> -0.806241).  Saving model ...
Epoch: 8 cost time: 0.9192345142364502
Epoch: 8, Steps: 8 | Train Loss: 0.817 Vali Loss: 0.747 Vali Acc: 0.809 Test Loss: 0.747 Test Acc: 0.809
Validation loss decreased (-0.806241 --> -0.809368).  Saving model ...
Epoch: 9 cost time: 0.9110333919525146
Epoch: 9, Steps: 8 | Train Loss: 0.594 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
Validation loss decreased (-0.809368 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.771925687789917
Epoch: 10, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.597 Vali Acc: 0.800 Test Loss: 0.597 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0416629314422607
Epoch: 11, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 0.8674471378326416
Epoch: 12, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1506171226501465
Epoch: 13, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.550 Vali Acc: 0.831 Test Loss: 0.550 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831244).  Saving model ...
Epoch: 14 cost time: 0.8755252361297607
Epoch: 14, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.555 Vali Acc: 0.831 Test Loss: 0.555 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1912565231323242
Epoch: 15, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.561 Vali Acc: 0.831 Test Loss: 0.561 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1715009212493896
Epoch: 16, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.575 Vali Acc: 0.825 Test Loss: 0.575 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0512661933898926
Epoch: 17, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1023833751678467
Epoch: 18, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.571 Vali Acc: 0.825 Test Loss: 0.571 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8293404579162598
Epoch: 19, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7570977210998535
Epoch: 20, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.592 Vali Acc: 0.825 Test Loss: 0.592 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9043028354644775
Epoch: 21, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.598 Vali Acc: 0.828 Test Loss: 0.598 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9851620197296143
Epoch: 22, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.592 Vali Acc: 0.831 Test Loss: 0.592 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.030261516571045
Epoch: 23, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.608 Vali Acc: 0.822 Test Loss: 0.608 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 277888
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.375980854034424
Epoch: 1, Steps: 8 | Train Loss: 2.110 Vali Loss: 2.025 Vali Acc: 0.081 Test Loss: 2.025 Test Acc: 0.081
Validation loss decreased (inf --> -0.081230).  Saving model ...
Epoch: 2 cost time: 0.8967108726501465
Epoch: 2, Steps: 8 | Train Loss: 2.024 Vali Loss: 1.906 Vali Acc: 0.344 Test Loss: 1.906 Test Acc: 0.344
Validation loss decreased (-0.081230 --> -0.343731).  Saving model ...
Epoch: 3 cost time: 0.9845983982086182
Epoch: 3, Steps: 8 | Train Loss: 1.899 Vali Loss: 1.762 Vali Acc: 0.478 Test Loss: 1.762 Test Acc: 0.478
Validation loss decreased (-0.343731 --> -0.478107).  Saving model ...
Epoch: 4 cost time: 1.169715166091919
Epoch: 4, Steps: 8 | Train Loss: 1.713 Vali Loss: 1.578 Vali Acc: 0.628 Test Loss: 1.578 Test Acc: 0.628
Validation loss decreased (-0.478107 --> -0.628109).  Saving model ...
Epoch: 5 cost time: 0.8658711910247803
Epoch: 5, Steps: 8 | Train Loss: 1.495 Vali Loss: 1.369 Vali Acc: 0.725 Test Loss: 1.369 Test Acc: 0.725
Validation loss decreased (-0.628109 --> -0.724986).  Saving model ...
Epoch: 6 cost time: 0.8330130577087402
Epoch: 6, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.123 Vali Acc: 0.759 Test Loss: 1.123 Test Acc: 0.759
Validation loss decreased (-0.724986 --> -0.759364).  Saving model ...
Epoch: 7 cost time: 0.9409492015838623
Epoch: 7, Steps: 8 | Train Loss: 1.030 Vali Loss: 0.909 Vali Acc: 0.781 Test Loss: 0.909 Test Acc: 0.781
Validation loss decreased (-0.759364 --> -0.781241).  Saving model ...
Epoch: 8 cost time: 0.916126012802124
Epoch: 8, Steps: 8 | Train Loss: 0.762 Vali Loss: 0.745 Vali Acc: 0.812 Test Loss: 0.745 Test Acc: 0.812
Validation loss decreased (-0.781241 --> -0.812493).  Saving model ...
Epoch: 9 cost time: 0.9725608825683594
Epoch: 9, Steps: 8 | Train Loss: 0.611 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
Validation loss decreased (-0.812493 --> -0.821869).  Saving model ...
Epoch: 10 cost time: 0.8714432716369629
Epoch: 10, Steps: 8 | Train Loss: 0.552 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8487410545349121
Epoch: 11, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.7336010932922363
Epoch: 12, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.557 Vali Acc: 0.819 Test Loss: 0.557 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9303934574127197
Epoch: 13, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9009037017822266
Epoch: 14, Steps: 8 | Train Loss: 0.216 Vali Loss: 0.555 Vali Acc: 0.806 Test Loss: 0.555 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.103994607925415
Epoch: 15, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 16 cost time: 0.8393795490264893
Epoch: 16, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8250267505645752
Epoch: 17, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8360779285430908
Epoch: 18, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.586 Vali Acc: 0.816 Test Loss: 0.586 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9883079528808594
Epoch: 19, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.056246042251587
Epoch: 20, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.585 Vali Acc: 0.831 Test Loss: 0.585 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831244).  Saving model ...
Epoch: 21 cost time: 0.8731482028961182
Epoch: 21, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8820290565490723
Epoch: 22, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.623 Vali Acc: 0.812 Test Loss: 0.623 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9432706832885742
Epoch: 23, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.093930721282959
Epoch: 24, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.634 Vali Acc: 0.812 Test Loss: 0.634 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9882161617279053
Epoch: 25, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9008359909057617
Epoch: 26, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.659 Vali Acc: 0.809 Test Loss: 0.659 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8912992477416992
Epoch: 27, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.666 Vali Acc: 0.809 Test Loss: 0.666 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7871530055999756
Epoch: 28, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.664 Vali Acc: 0.822 Test Loss: 0.664 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7889344692230225
Epoch: 29, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.660 Vali Acc: 0.822 Test Loss: 0.660 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8701930046081543
Epoch: 30, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.668 Vali Acc: 0.819 Test Loss: 0.668 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 277024
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.926380157470703
Epoch: 1, Steps: 8 | Train Loss: 2.239 Vali Loss: 2.143 Vali Acc: 0.050 Test Loss: 2.143 Test Acc: 0.050
Validation loss decreased (inf --> -0.049979).  Saving model ...
Epoch: 2 cost time: 0.9442732334136963
Epoch: 2, Steps: 8 | Train Loss: 2.072 Vali Loss: 1.999 Vali Acc: 0.284 Test Loss: 1.999 Test Acc: 0.284
Validation loss decreased (-0.049979 --> -0.284355).  Saving model ...
Epoch: 3 cost time: 0.8982236385345459
Epoch: 3, Steps: 8 | Train Loss: 1.974 Vali Loss: 1.881 Vali Acc: 0.316 Test Loss: 1.881 Test Acc: 0.316
Validation loss decreased (-0.284355 --> -0.315606).  Saving model ...
Epoch: 4 cost time: 1.1490936279296875
Epoch: 4, Steps: 8 | Train Loss: 1.787 Vali Loss: 1.718 Vali Acc: 0.472 Test Loss: 1.718 Test Acc: 0.472
Validation loss decreased (-0.315606 --> -0.471858).  Saving model ...
Epoch: 5 cost time: 0.985689640045166
Epoch: 5, Steps: 8 | Train Loss: 1.595 Vali Loss: 1.536 Vali Acc: 0.659 Test Loss: 1.536 Test Acc: 0.659
Validation loss decreased (-0.471858 --> -0.659360).  Saving model ...
Epoch: 6 cost time: 0.8637344837188721
Epoch: 6, Steps: 8 | Train Loss: 1.432 Vali Loss: 1.314 Vali Acc: 0.741 Test Loss: 1.314 Test Acc: 0.741
Validation loss decreased (-0.659360 --> -0.740612).  Saving model ...
Epoch: 7 cost time: 0.92877197265625
Epoch: 7, Steps: 8 | Train Loss: 1.178 Vali Loss: 1.105 Vali Acc: 0.766 Test Loss: 1.105 Test Acc: 0.766
Validation loss decreased (-0.740612 --> -0.765614).  Saving model ...
Epoch: 8 cost time: 1.000314712524414
Epoch: 8, Steps: 8 | Train Loss: 0.981 Vali Loss: 0.919 Vali Acc: 0.778 Test Loss: 0.919 Test Acc: 0.778
Validation loss decreased (-0.765614 --> -0.778116).  Saving model ...
Epoch: 9 cost time: 1.1036796569824219
Epoch: 9, Steps: 8 | Train Loss: 0.761 Vali Loss: 0.772 Vali Acc: 0.803 Test Loss: 0.772 Test Acc: 0.803
Validation loss decreased (-0.778116 --> -0.803117).  Saving model ...
Epoch: 10 cost time: 0.9116055965423584
Epoch: 10, Steps: 8 | Train Loss: 0.706 Vali Loss: 0.685 Vali Acc: 0.797 Test Loss: 0.685 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8108019828796387
Epoch: 11, Steps: 8 | Train Loss: 0.498 Vali Loss: 0.601 Vali Acc: 0.828 Test Loss: 0.601 Test Acc: 0.828
Validation loss decreased (-0.803117 --> -0.828119).  Saving model ...
Epoch: 12 cost time: 0.8241901397705078
Epoch: 12, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
Validation loss decreased (-0.828119 --> -0.828119).  Saving model ...
Epoch: 13 cost time: 1.0270657539367676
Epoch: 13, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837494).  Saving model ...
Epoch: 14 cost time: 0.8795449733734131
Epoch: 14, Steps: 8 | Train Loss: 0.302 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9849045276641846
Epoch: 15, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8623337745666504
Epoch: 16, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.563 Vali Acc: 0.819 Test Loss: 0.563 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9140729904174805
Epoch: 17, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9143078327178955
Epoch: 18, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8715705871582031
Epoch: 19, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.999701976776123
Epoch: 20, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8802962303161621
Epoch: 21, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.606 Vali Acc: 0.828 Test Loss: 0.606 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8744256496429443
Epoch: 22, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.597 Vali Acc: 0.831 Test Loss: 0.597 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8042383193969727
Epoch: 23, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.596 Vali Acc: 0.834 Test Loss: 0.596 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 179776
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.602773666381836
Epoch: 1, Steps: 8 | Train Loss: 2.169 Vali Loss: 2.093 Vali Acc: 0.153 Test Loss: 2.093 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 1.2330639362335205
Epoch: 2, Steps: 8 | Train Loss: 2.060 Vali Loss: 1.980 Vali Acc: 0.303 Test Loss: 1.980 Test Acc: 0.303
Validation loss decreased (-0.153104 --> -0.303105).  Saving model ...
Epoch: 3 cost time: 0.921475887298584
Epoch: 3, Steps: 8 | Train Loss: 1.951 Vali Loss: 1.849 Vali Acc: 0.394 Test Loss: 1.849 Test Acc: 0.394
Validation loss decreased (-0.303105 --> -0.393732).  Saving model ...
Epoch: 4 cost time: 1.2332773208618164
Epoch: 4, Steps: 8 | Train Loss: 1.768 Vali Loss: 1.677 Vali Acc: 0.537 Test Loss: 1.677 Test Acc: 0.537
Validation loss decreased (-0.393732 --> -0.537483).  Saving model ...
Epoch: 5 cost time: 1.3252489566802979
Epoch: 5, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.485 Vali Acc: 0.619 Test Loss: 1.485 Test Acc: 0.619
Validation loss decreased (-0.537483 --> -0.618735).  Saving model ...
Epoch: 6 cost time: 1.0392420291900635
Epoch: 6, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.289 Vali Acc: 0.703 Test Loss: 1.289 Test Acc: 0.703
Validation loss decreased (-0.618735 --> -0.703112).  Saving model ...
Epoch: 7 cost time: 1.2433643341064453
Epoch: 7, Steps: 8 | Train Loss: 1.162 Vali Loss: 1.078 Vali Acc: 0.766 Test Loss: 1.078 Test Acc: 0.766
Validation loss decreased (-0.703112 --> -0.765614).  Saving model ...
Epoch: 8 cost time: 1.571817398071289
Epoch: 8, Steps: 8 | Train Loss: 0.959 Vali Loss: 0.900 Vali Acc: 0.781 Test Loss: 0.900 Test Acc: 0.781
Validation loss decreased (-0.765614 --> -0.781241).  Saving model ...
Epoch: 9 cost time: 1.1737217903137207
Epoch: 9, Steps: 8 | Train Loss: 0.798 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
Validation loss decreased (-0.781241 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 1.1953940391540527
Epoch: 10, Steps: 8 | Train Loss: 0.604 Vali Loss: 0.660 Vali Acc: 0.816 Test Loss: 0.660 Test Acc: 0.816
Validation loss decreased (-0.799993 --> -0.815618).  Saving model ...
Epoch: 11 cost time: 1.1973676681518555
Epoch: 11, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
Validation loss decreased (-0.815618 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 0.8883707523345947
Epoch: 12, Steps: 8 | Train Loss: 0.412 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 1.1121129989624023
Epoch: 13, Steps: 8 | Train Loss: 0.348 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
Validation loss decreased (-0.824994 --> -0.843745).  Saving model ...
Epoch: 14 cost time: 0.9001598358154297
Epoch: 14, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0305876731872559
Epoch: 15, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3497076034545898
Epoch: 16, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.242856740951538
Epoch: 17, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0268797874450684
Epoch: 18, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0399260520935059
Epoch: 19, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.007603645324707
Epoch: 20, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.106736660003662
Epoch: 21, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.584 Vali Acc: 0.828 Test Loss: 0.584 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.161750078201294
Epoch: 22, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7952258586883545
Epoch: 23, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.598 Vali Acc: 0.828 Test Loss: 0.598 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 178912
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6975042819976807
Epoch: 1, Steps: 8 | Train Loss: 2.214 Vali Loss: 2.110 Vali Acc: 0.066 Test Loss: 2.110 Test Acc: 0.066
Validation loss decreased (inf --> -0.065604).  Saving model ...
Epoch: 2 cost time: 0.828054666519165
Epoch: 2, Steps: 8 | Train Loss: 2.070 Vali Loss: 1.981 Vali Acc: 0.234 Test Loss: 1.981 Test Acc: 0.234
Validation loss decreased (-0.065604 --> -0.234355).  Saving model ...
Epoch: 3 cost time: 0.7777519226074219
Epoch: 3, Steps: 8 | Train Loss: 1.909 Vali Loss: 1.850 Vali Acc: 0.366 Test Loss: 1.850 Test Acc: 0.366
Validation loss decreased (-0.234355 --> -0.365606).  Saving model ...
Epoch: 4 cost time: 0.81437087059021
Epoch: 4, Steps: 8 | Train Loss: 1.754 Vali Loss: 1.666 Vali Acc: 0.559 Test Loss: 1.666 Test Acc: 0.559
Validation loss decreased (-0.365606 --> -0.559358).  Saving model ...
Epoch: 5 cost time: 0.8872935771942139
Epoch: 5, Steps: 8 | Train Loss: 1.598 Vali Loss: 1.475 Vali Acc: 0.716 Test Loss: 1.475 Test Acc: 0.716
Validation loss decreased (-0.559358 --> -0.715610).  Saving model ...
Epoch: 6 cost time: 0.8881776332855225
Epoch: 6, Steps: 8 | Train Loss: 1.349 Vali Loss: 1.276 Vali Acc: 0.762 Test Loss: 1.276 Test Acc: 0.762
Validation loss decreased (-0.715610 --> -0.762487).  Saving model ...
Epoch: 7 cost time: 0.8167548179626465
Epoch: 7, Steps: 8 | Train Loss: 1.197 Vali Loss: 1.066 Vali Acc: 0.797 Test Loss: 1.066 Test Acc: 0.797
Validation loss decreased (-0.762487 --> -0.796864).  Saving model ...
Epoch: 8 cost time: 0.9727187156677246
Epoch: 8, Steps: 8 | Train Loss: 1.002 Vali Loss: 0.905 Vali Acc: 0.800 Test Loss: 0.905 Test Acc: 0.800
Validation loss decreased (-0.796864 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.8905229568481445
Epoch: 9, Steps: 8 | Train Loss: 0.873 Vali Loss: 0.772 Vali Acc: 0.797 Test Loss: 0.772 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8505892753601074
Epoch: 10, Steps: 8 | Train Loss: 0.649 Vali Loss: 0.672 Vali Acc: 0.819 Test Loss: 0.672 Test Acc: 0.819
Validation loss decreased (-0.799991 --> -0.818743).  Saving model ...
Epoch: 11 cost time: 0.8617055416107178
Epoch: 11, Steps: 8 | Train Loss: 0.527 Vali Loss: 0.613 Vali Acc: 0.806 Test Loss: 0.613 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8253865242004395
Epoch: 12, Steps: 8 | Train Loss: 0.459 Vali Loss: 0.566 Vali Acc: 0.825 Test Loss: 0.566 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.8504579067230225
Epoch: 13, Steps: 8 | Train Loss: 0.392 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8778703212738037
Epoch: 14, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.536 Vali Acc: 0.812 Test Loss: 0.536 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9878044128417969
Epoch: 15, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8308508396148682
Epoch: 16, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.530 Vali Acc: 0.838 Test Loss: 0.530 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 17 cost time: 0.8154153823852539
Epoch: 17, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.127490758895874
Epoch: 18, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.568 Vali Acc: 0.812 Test Loss: 0.568 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1748554706573486
Epoch: 19, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0611858367919922
Epoch: 20, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.580 Vali Acc: 0.816 Test Loss: 0.580 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9516634941101074
Epoch: 21, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.591 Vali Acc: 0.812 Test Loss: 0.591 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7980754375457764
Epoch: 22, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.604 Vali Acc: 0.812 Test Loss: 0.604 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8201799392700195
Epoch: 23, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.594 Vali Acc: 0.825 Test Loss: 0.594 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7686748504638672
Epoch: 24, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.594 Vali Acc: 0.831 Test Loss: 0.594 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0039854049682617
Epoch: 25, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.612 Vali Acc: 0.825 Test Loss: 0.612 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8703346252441406
Epoch: 26, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.629 Vali Acc: 0.816 Test Loss: 0.629 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 178048
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.66853404045105
Epoch: 1, Steps: 8 | Train Loss: 2.189 Vali Loss: 2.079 Vali Acc: 0.212 Test Loss: 2.079 Test Acc: 0.212
Validation loss decreased (inf --> -0.212479).  Saving model ...
Epoch: 2 cost time: 0.9417228698730469
Epoch: 2, Steps: 8 | Train Loss: 2.059 Vali Loss: 1.951 Vali Acc: 0.338 Test Loss: 1.951 Test Acc: 0.338
Validation loss decreased (-0.212479 --> -0.337480).  Saving model ...
Epoch: 3 cost time: 1.061429738998413
Epoch: 3, Steps: 8 | Train Loss: 1.932 Vali Loss: 1.846 Vali Acc: 0.306 Test Loss: 1.846 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0161571502685547
Epoch: 4, Steps: 8 | Train Loss: 1.799 Vali Loss: 1.682 Vali Acc: 0.575 Test Loss: 1.682 Test Acc: 0.575
Validation loss decreased (-0.337480 --> -0.574983).  Saving model ...
Epoch: 5 cost time: 0.7573485374450684
Epoch: 5, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.502 Vali Acc: 0.697 Test Loss: 1.502 Test Acc: 0.697
Validation loss decreased (-0.574983 --> -0.696860).  Saving model ...
Epoch: 6 cost time: 1.187804937362671
Epoch: 6, Steps: 8 | Train Loss: 1.428 Vali Loss: 1.313 Vali Acc: 0.728 Test Loss: 1.313 Test Acc: 0.728
Validation loss decreased (-0.696860 --> -0.728112).  Saving model ...
Epoch: 7 cost time: 0.9588446617126465
Epoch: 7, Steps: 8 | Train Loss: 1.176 Vali Loss: 1.099 Vali Acc: 0.794 Test Loss: 1.099 Test Acc: 0.794
Validation loss decreased (-0.728112 --> -0.793739).  Saving model ...
Epoch: 8 cost time: 0.90047287940979
Epoch: 8, Steps: 8 | Train Loss: 1.022 Vali Loss: 0.908 Vali Acc: 0.794 Test Loss: 0.908 Test Acc: 0.794
Validation loss decreased (-0.793739 --> -0.793741).  Saving model ...
Epoch: 9 cost time: 0.858879566192627
Epoch: 9, Steps: 8 | Train Loss: 0.791 Vali Loss: 0.762 Vali Acc: 0.828 Test Loss: 0.762 Test Acc: 0.828
Validation loss decreased (-0.793741 --> -0.828117).  Saving model ...
Epoch: 10 cost time: 0.7847564220428467
Epoch: 10, Steps: 8 | Train Loss: 0.635 Vali Loss: 0.653 Vali Acc: 0.834 Test Loss: 0.653 Test Acc: 0.834
Validation loss decreased (-0.828117 --> -0.834368).  Saving model ...
Epoch: 11 cost time: 0.9391701221466064
Epoch: 11, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.602 Vali Acc: 0.816 Test Loss: 0.602 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9630796909332275
Epoch: 12, Steps: 8 | Train Loss: 0.421 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1824367046356201
Epoch: 13, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1453096866607666
Epoch: 14, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.548 Vali Acc: 0.819 Test Loss: 0.548 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9279119968414307
Epoch: 15, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9032745361328125
Epoch: 16, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.554 Vali Acc: 0.816 Test Loss: 0.554 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1040053367614746
Epoch: 17, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2189815044403076
Epoch: 18, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.04360032081604
Epoch: 19, Steps: 8 | Train Loss: 0.133 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.073028564453125
Epoch: 20, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 177184
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4620039463043213
Epoch: 1, Steps: 8 | Train Loss: 2.139 Vali Loss: 2.013 Vali Acc: 0.181 Test Loss: 2.013 Test Acc: 0.181
Validation loss decreased (inf --> -0.181230).  Saving model ...
Epoch: 2 cost time: 1.318070888519287
Epoch: 2, Steps: 8 | Train Loss: 2.005 Vali Loss: 1.898 Vali Acc: 0.447 Test Loss: 1.898 Test Acc: 0.447
Validation loss decreased (-0.181230 --> -0.446856).  Saving model ...
Epoch: 3 cost time: 0.9287545680999756
Epoch: 3, Steps: 8 | Train Loss: 1.874 Vali Loss: 1.768 Vali Acc: 0.575 Test Loss: 1.768 Test Acc: 0.575
Validation loss decreased (-0.446856 --> -0.574982).  Saving model ...
Epoch: 4 cost time: 1.1216204166412354
Epoch: 4, Steps: 8 | Train Loss: 1.706 Vali Loss: 1.602 Vali Acc: 0.659 Test Loss: 1.602 Test Acc: 0.659
Validation loss decreased (-0.574982 --> -0.659359).  Saving model ...
Epoch: 5 cost time: 1.144777536392212
Epoch: 5, Steps: 8 | Train Loss: 1.514 Vali Loss: 1.426 Vali Acc: 0.741 Test Loss: 1.426 Test Acc: 0.741
Validation loss decreased (-0.659359 --> -0.740611).  Saving model ...
Epoch: 6 cost time: 1.1760807037353516
Epoch: 6, Steps: 8 | Train Loss: 1.371 Vali Loss: 1.244 Vali Acc: 0.762 Test Loss: 1.244 Test Acc: 0.762
Validation loss decreased (-0.740611 --> -0.762488).  Saving model ...
Epoch: 7 cost time: 1.2136073112487793
Epoch: 7, Steps: 8 | Train Loss: 1.136 Vali Loss: 1.049 Vali Acc: 0.781 Test Loss: 1.049 Test Acc: 0.781
Validation loss decreased (-0.762488 --> -0.781240).  Saving model ...
Epoch: 8 cost time: 1.1502351760864258
Epoch: 8, Steps: 8 | Train Loss: 0.954 Vali Loss: 0.875 Vali Acc: 0.797 Test Loss: 0.875 Test Acc: 0.797
Validation loss decreased (-0.781240 --> -0.796866).  Saving model ...
Epoch: 9 cost time: 0.992119312286377
Epoch: 9, Steps: 8 | Train Loss: 0.758 Vali Loss: 0.734 Vali Acc: 0.819 Test Loss: 0.734 Test Acc: 0.819
Validation loss decreased (-0.796866 --> -0.818743).  Saving model ...
Epoch: 10 cost time: 1.3871846199035645
Epoch: 10, Steps: 8 | Train Loss: 0.617 Vali Loss: 0.649 Vali Acc: 0.816 Test Loss: 0.649 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0014469623565674
Epoch: 11, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1429145336151123
Epoch: 12, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.549 Vali Acc: 0.838 Test Loss: 0.549 Test Acc: 0.838
Validation loss decreased (-0.818743 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 1.089123010635376
Epoch: 13, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 14 cost time: 1.1314787864685059
Epoch: 14, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.528 Vali Acc: 0.831 Test Loss: 0.528 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2404999732971191
Epoch: 15, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.531 Vali Acc: 0.822 Test Loss: 0.531 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0381193161010742
Epoch: 16, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.523 Vali Acc: 0.825 Test Loss: 0.523 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0999774932861328
Epoch: 17, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.522 Vali Acc: 0.825 Test Loss: 0.522 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1860613822937012
Epoch: 18, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.179966926574707
Epoch: 19, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2822275161743164
Epoch: 20, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.560 Vali Acc: 0.825 Test Loss: 0.560 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0393726825714111
Epoch: 21, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.567 Vali Acc: 0.812 Test Loss: 0.567 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9481503963470459
Epoch: 22, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1524388790130615
Epoch: 23, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.582 Vali Acc: 0.819 Test Loss: 0.582 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 129856
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.06644344329834
Epoch: 1, Steps: 8 | Train Loss: 2.187 Vali Loss: 2.073 Vali Acc: 0.122 Test Loss: 2.073 Test Acc: 0.122
Validation loss decreased (inf --> -0.121854).  Saving model ...
Epoch: 2 cost time: 1.0310614109039307
Epoch: 2, Steps: 8 | Train Loss: 2.062 Vali Loss: 1.954 Vali Acc: 0.275 Test Loss: 1.954 Test Acc: 0.275
Validation loss decreased (-0.121854 --> -0.274980).  Saving model ...
Epoch: 3 cost time: 0.9395840167999268
Epoch: 3, Steps: 8 | Train Loss: 1.906 Vali Loss: 1.817 Vali Acc: 0.503 Test Loss: 1.817 Test Acc: 0.503
Validation loss decreased (-0.274980 --> -0.503107).  Saving model ...
Epoch: 4 cost time: 0.9097871780395508
Epoch: 4, Steps: 8 | Train Loss: 1.756 Vali Loss: 1.653 Vali Acc: 0.644 Test Loss: 1.653 Test Acc: 0.644
Validation loss decreased (-0.503107 --> -0.643733).  Saving model ...
Epoch: 5 cost time: 0.9725408554077148
Epoch: 5, Steps: 8 | Train Loss: 1.607 Vali Loss: 1.459 Vali Acc: 0.738 Test Loss: 1.459 Test Acc: 0.738
Validation loss decreased (-0.643733 --> -0.737485).  Saving model ...
Epoch: 6 cost time: 0.8445734977722168
Epoch: 6, Steps: 8 | Train Loss: 1.398 Vali Loss: 1.267 Vali Acc: 0.750 Test Loss: 1.267 Test Acc: 0.750
Validation loss decreased (-0.737485 --> -0.749987).  Saving model ...
Epoch: 7 cost time: 0.8552806377410889
Epoch: 7, Steps: 8 | Train Loss: 1.159 Vali Loss: 1.064 Vali Acc: 0.794 Test Loss: 1.064 Test Acc: 0.794
Validation loss decreased (-0.749987 --> -0.793739).  Saving model ...
Epoch: 8 cost time: 0.9675395488739014
Epoch: 8, Steps: 8 | Train Loss: 0.950 Vali Loss: 0.895 Vali Acc: 0.797 Test Loss: 0.895 Test Acc: 0.797
Validation loss decreased (-0.793739 --> -0.796866).  Saving model ...
Epoch: 9 cost time: 0.9036707878112793
Epoch: 9, Steps: 8 | Train Loss: 0.752 Vali Loss: 0.748 Vali Acc: 0.806 Test Loss: 0.748 Test Acc: 0.806
Validation loss decreased (-0.796866 --> -0.806243).  Saving model ...
Epoch: 10 cost time: 0.874683141708374
Epoch: 10, Steps: 8 | Train Loss: 0.619 Vali Loss: 0.650 Vali Acc: 0.812 Test Loss: 0.650 Test Acc: 0.812
Validation loss decreased (-0.806243 --> -0.812493).  Saving model ...
Epoch: 11 cost time: 0.971088171005249
Epoch: 11, Steps: 8 | Train Loss: 0.532 Vali Loss: 0.601 Vali Acc: 0.822 Test Loss: 0.601 Test Acc: 0.822
Validation loss decreased (-0.812493 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.7592747211456299
Epoch: 12, Steps: 8 | Train Loss: 0.451 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
Validation loss decreased (-0.821869 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 0.9532701969146729
Epoch: 13, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.541 Vali Acc: 0.828 Test Loss: 0.541 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828120).  Saving model ...
Epoch: 14 cost time: 1.1438047885894775
Epoch: 14, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.535 Vali Acc: 0.819 Test Loss: 0.535 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0064764022827148
Epoch: 15, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.538 Vali Acc: 0.841 Test Loss: 0.538 Test Acc: 0.841
Validation loss decreased (-0.828120 --> -0.840620).  Saving model ...
Epoch: 16 cost time: 1.005704641342163
Epoch: 16, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2169897556304932
Epoch: 17, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.533 Vali Acc: 0.831 Test Loss: 0.533 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0816915035247803
Epoch: 18, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9780664443969727
Epoch: 19, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0447807312011719
Epoch: 20, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9599084854125977
Epoch: 21, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.570 Vali Acc: 0.825 Test Loss: 0.570 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9915885925292969
Epoch: 22, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2099404335021973
Epoch: 23, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0866758823394775
Epoch: 24, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0134227275848389
Epoch: 25, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.605 Vali Acc: 0.825 Test Loss: 0.605 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.840625
model parameter : 128992
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.095280885696411
Epoch: 1, Steps: 8 | Train Loss: 2.246 Vali Loss: 2.127 Vali Acc: 0.203 Test Loss: 2.127 Test Acc: 0.203
Validation loss decreased (inf --> -0.203104).  Saving model ...
Epoch: 2 cost time: 1.1409780979156494
Epoch: 2, Steps: 8 | Train Loss: 2.088 Vali Loss: 1.994 Vali Acc: 0.291 Test Loss: 1.994 Test Acc: 0.291
Validation loss decreased (-0.203104 --> -0.290605).  Saving model ...
Epoch: 3 cost time: 1.068753957748413
Epoch: 3, Steps: 8 | Train Loss: 1.989 Vali Loss: 1.877 Vali Acc: 0.378 Test Loss: 1.877 Test Acc: 0.378
Validation loss decreased (-0.290605 --> -0.378106).  Saving model ...
Epoch: 4 cost time: 0.9345314502716064
Epoch: 4, Steps: 8 | Train Loss: 1.856 Vali Loss: 1.696 Vali Acc: 0.597 Test Loss: 1.696 Test Acc: 0.597
Validation loss decreased (-0.378106 --> -0.596858).  Saving model ...
Epoch: 5 cost time: 0.8756635189056396
Epoch: 5, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.524 Vali Acc: 0.650 Test Loss: 1.524 Test Acc: 0.650
Validation loss decreased (-0.596858 --> -0.649985).  Saving model ...
Epoch: 6 cost time: 0.9747335910797119
Epoch: 6, Steps: 8 | Train Loss: 1.431 Vali Loss: 1.335 Vali Acc: 0.738 Test Loss: 1.335 Test Acc: 0.738
Validation loss decreased (-0.649985 --> -0.737487).  Saving model ...
Epoch: 7 cost time: 1.2332873344421387
Epoch: 7, Steps: 8 | Train Loss: 1.219 Vali Loss: 1.147 Vali Acc: 0.784 Test Loss: 1.147 Test Acc: 0.784
Validation loss decreased (-0.737487 --> -0.784364).  Saving model ...
Epoch: 8 cost time: 0.951120138168335
Epoch: 8, Steps: 8 | Train Loss: 1.028 Vali Loss: 0.966 Vali Acc: 0.784 Test Loss: 0.966 Test Acc: 0.784
Validation loss decreased (-0.784364 --> -0.784365).  Saving model ...
Epoch: 9 cost time: 0.8773586750030518
Epoch: 9, Steps: 8 | Train Loss: 0.839 Vali Loss: 0.817 Vali Acc: 0.800 Test Loss: 0.817 Test Acc: 0.800
Validation loss decreased (-0.784365 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.8912925720214844
Epoch: 10, Steps: 8 | Train Loss: 0.660 Vali Loss: 0.695 Vali Acc: 0.812 Test Loss: 0.695 Test Acc: 0.812
Validation loss decreased (-0.799992 --> -0.812493).  Saving model ...
Epoch: 11 cost time: 0.9364683628082275
Epoch: 11, Steps: 8 | Train Loss: 0.546 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
Validation loss decreased (-0.812493 --> -0.821869).  Saving model ...
Epoch: 12 cost time: 0.9329402446746826
Epoch: 12, Steps: 8 | Train Loss: 0.466 Vali Loss: 0.571 Vali Acc: 0.828 Test Loss: 0.571 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828119).  Saving model ...
Epoch: 13 cost time: 0.9204044342041016
Epoch: 13, Steps: 8 | Train Loss: 0.435 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.978081226348877
Epoch: 14, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834370).  Saving model ...
Epoch: 15 cost time: 0.8564987182617188
Epoch: 15, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
Validation loss decreased (-0.834370 --> -0.834370).  Saving model ...
Epoch: 16 cost time: 0.8592984676361084
Epoch: 16, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.535 Vali Acc: 0.825 Test Loss: 0.535 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9316072463989258
Epoch: 17, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9490010738372803
Epoch: 18, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9946014881134033
Epoch: 19, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8895437717437744
Epoch: 20, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.553 Vali Acc: 0.828 Test Loss: 0.553 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8534018993377686
Epoch: 21, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.563 Vali Acc: 0.828 Test Loss: 0.563 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8093576431274414
Epoch: 22, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9249849319458008
Epoch: 23, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.576 Vali Acc: 0.819 Test Loss: 0.576 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1152112483978271
Epoch: 24, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.593 Vali Acc: 0.825 Test Loss: 0.593 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0364439487457275
Epoch: 25, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 128128
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.192326068878174
Epoch: 1, Steps: 8 | Train Loss: 2.190 Vali Loss: 2.117 Vali Acc: 0.087 Test Loss: 2.117 Test Acc: 0.087
Validation loss decreased (inf --> -0.087479).  Saving model ...
Epoch: 2 cost time: 1.1456341743469238
Epoch: 2, Steps: 8 | Train Loss: 2.075 Vali Loss: 2.000 Vali Acc: 0.241 Test Loss: 2.000 Test Acc: 0.241
Validation loss decreased (-0.087479 --> -0.240605).  Saving model ...
Epoch: 3 cost time: 0.9474329948425293
Epoch: 3, Steps: 8 | Train Loss: 1.961 Vali Loss: 1.868 Vali Acc: 0.331 Test Loss: 1.868 Test Acc: 0.331
Validation loss decreased (-0.240605 --> -0.331231).  Saving model ...
Epoch: 4 cost time: 0.9395308494567871
Epoch: 4, Steps: 8 | Train Loss: 1.854 Vali Loss: 1.703 Vali Acc: 0.516 Test Loss: 1.703 Test Acc: 0.516
Validation loss decreased (-0.331231 --> -0.515608).  Saving model ...
Epoch: 5 cost time: 1.0964069366455078
Epoch: 5, Steps: 8 | Train Loss: 1.643 Vali Loss: 1.529 Vali Acc: 0.647 Test Loss: 1.529 Test Acc: 0.647
Validation loss decreased (-0.515608 --> -0.646860).  Saving model ...
Epoch: 6 cost time: 1.0667176246643066
Epoch: 6, Steps: 8 | Train Loss: 1.453 Vali Loss: 1.336 Vali Acc: 0.700 Test Loss: 1.336 Test Acc: 0.700
Validation loss decreased (-0.646860 --> -0.699987).  Saving model ...
Epoch: 7 cost time: 0.9579060077667236
Epoch: 7, Steps: 8 | Train Loss: 1.210 Vali Loss: 1.131 Vali Acc: 0.762 Test Loss: 1.131 Test Acc: 0.762
Validation loss decreased (-0.699987 --> -0.762489).  Saving model ...
Epoch: 8 cost time: 0.8654236793518066
Epoch: 8, Steps: 8 | Train Loss: 1.011 Vali Loss: 0.945 Vali Acc: 0.784 Test Loss: 0.945 Test Acc: 0.784
Validation loss decreased (-0.762489 --> -0.784366).  Saving model ...
Epoch: 9 cost time: 0.9173948764801025
Epoch: 9, Steps: 8 | Train Loss: 0.825 Vali Loss: 0.803 Vali Acc: 0.797 Test Loss: 0.803 Test Acc: 0.797
Validation loss decreased (-0.784366 --> -0.796867).  Saving model ...
Epoch: 10 cost time: 0.9125406742095947
Epoch: 10, Steps: 8 | Train Loss: 0.664 Vali Loss: 0.688 Vali Acc: 0.803 Test Loss: 0.688 Test Acc: 0.803
Validation loss decreased (-0.796867 --> -0.803118).  Saving model ...
Epoch: 11 cost time: 0.886786937713623
Epoch: 11, Steps: 8 | Train Loss: 0.572 Vali Loss: 0.628 Vali Acc: 0.816 Test Loss: 0.628 Test Acc: 0.816
Validation loss decreased (-0.803118 --> -0.815619).  Saving model ...
Epoch: 12 cost time: 0.8345038890838623
Epoch: 12, Steps: 8 | Train Loss: 0.488 Vali Loss: 0.596 Vali Acc: 0.822 Test Loss: 0.596 Test Acc: 0.822
Validation loss decreased (-0.815619 --> -0.821869).  Saving model ...
Epoch: 13 cost time: 0.8609669208526611
Epoch: 13, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.564 Vali Acc: 0.816 Test Loss: 0.564 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0555624961853027
Epoch: 14, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.551 Vali Acc: 0.831 Test Loss: 0.551 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831244).  Saving model ...
Epoch: 15 cost time: 0.9016890525817871
Epoch: 15, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0352134704589844
Epoch: 16, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9244298934936523
Epoch: 17, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9954516887664795
Epoch: 18, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0075161457061768
Epoch: 19, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9147796630859375
Epoch: 20, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9723720550537109
Epoch: 21, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.593 Vali Acc: 0.812 Test Loss: 0.593 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0883359909057617
Epoch: 22, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.601 Vali Acc: 0.812 Test Loss: 0.601 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.29807710647583
Epoch: 23, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0829145908355713
Epoch: 24, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.616 Vali Acc: 0.819 Test Loss: 0.616 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 127264
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3622756004333496
Epoch: 1, Steps: 8 | Train Loss: 2.222 Vali Loss: 2.110 Vali Acc: 0.044 Test Loss: 2.110 Test Acc: 0.044
Validation loss decreased (inf --> -0.043729).  Saving model ...
Epoch: 2 cost time: 1.4365310668945312
Epoch: 2, Steps: 8 | Train Loss: 2.078 Vali Loss: 2.003 Vali Acc: 0.266 Test Loss: 2.003 Test Acc: 0.266
Validation loss decreased (-0.043729 --> -0.265605).  Saving model ...
Epoch: 3 cost time: 0.9765503406524658
Epoch: 3, Steps: 8 | Train Loss: 2.000 Vali Loss: 1.866 Vali Acc: 0.428 Test Loss: 1.866 Test Acc: 0.428
Validation loss decreased (-0.265605 --> -0.428106).  Saving model ...
Epoch: 4 cost time: 0.866300106048584
Epoch: 4, Steps: 8 | Train Loss: 1.825 Vali Loss: 1.696 Vali Acc: 0.622 Test Loss: 1.696 Test Acc: 0.622
Validation loss decreased (-0.428106 --> -0.621858).  Saving model ...
Epoch: 5 cost time: 1.1921615600585938
Epoch: 5, Steps: 8 | Train Loss: 1.640 Vali Loss: 1.528 Vali Acc: 0.662 Test Loss: 1.528 Test Acc: 0.662
Validation loss decreased (-0.621858 --> -0.662485).  Saving model ...
Epoch: 6 cost time: 0.9263041019439697
Epoch: 6, Steps: 8 | Train Loss: 1.466 Vali Loss: 1.342 Vali Acc: 0.741 Test Loss: 1.342 Test Acc: 0.741
Validation loss decreased (-0.662485 --> -0.740612).  Saving model ...
Epoch: 7 cost time: 1.091517686843872
Epoch: 7, Steps: 8 | Train Loss: 1.258 Vali Loss: 1.151 Vali Acc: 0.784 Test Loss: 1.151 Test Acc: 0.784
Validation loss decreased (-0.740612 --> -0.784363).  Saving model ...
Epoch: 8 cost time: 0.9182796478271484
Epoch: 8, Steps: 8 | Train Loss: 1.059 Vali Loss: 0.984 Vali Acc: 0.775 Test Loss: 0.984 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1030898094177246
Epoch: 9, Steps: 8 | Train Loss: 0.892 Vali Loss: 0.822 Vali Acc: 0.797 Test Loss: 0.822 Test Acc: 0.797
Validation loss decreased (-0.784363 --> -0.796867).  Saving model ...
Epoch: 10 cost time: 1.0084211826324463
Epoch: 10, Steps: 8 | Train Loss: 0.691 Vali Loss: 0.713 Vali Acc: 0.831 Test Loss: 0.713 Test Acc: 0.831
Validation loss decreased (-0.796867 --> -0.831243).  Saving model ...
Epoch: 11 cost time: 1.048309087753296
Epoch: 11, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.630 Vali Acc: 0.819 Test Loss: 0.630 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0472471714019775
Epoch: 12, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.594 Vali Acc: 0.809 Test Loss: 0.594 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0527570247650146
Epoch: 13, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9461281299591064
Epoch: 14, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.535 Vali Acc: 0.834 Test Loss: 0.535 Test Acc: 0.834
Validation loss decreased (-0.831243 --> -0.834370).  Saving model ...
Epoch: 15 cost time: 1.0481908321380615
Epoch: 15, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.535 Vali Acc: 0.831 Test Loss: 0.535 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9840481281280518
Epoch: 16, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0071122646331787
Epoch: 17, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.547 Vali Acc: 0.828 Test Loss: 0.547 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1698713302612305
Epoch: 18, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9510688781738281
Epoch: 19, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1836695671081543
Epoch: 20, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0906267166137695
Epoch: 21, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.556 Vali Acc: 0.834 Test Loss: 0.556 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8785955905914307
Epoch: 22, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9254364967346191
Epoch: 23, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.565 Vali Acc: 0.831 Test Loss: 0.565 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9458928108215332
Epoch: 24, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 104896
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1711831092834473
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 2.065 Vali Acc: 0.175 Test Loss: 2.065 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 1.1234714984893799
Epoch: 2, Steps: 8 | Train Loss: 2.064 Vali Loss: 1.954 Vali Acc: 0.297 Test Loss: 1.954 Test Acc: 0.297
Validation loss decreased (-0.174979 --> -0.296855).  Saving model ...
Epoch: 3 cost time: 0.9742064476013184
Epoch: 3, Steps: 8 | Train Loss: 1.964 Vali Loss: 1.835 Vali Acc: 0.378 Test Loss: 1.835 Test Acc: 0.378
Validation loss decreased (-0.296855 --> -0.378107).  Saving model ...
Epoch: 4 cost time: 0.9325711727142334
Epoch: 4, Steps: 8 | Train Loss: 1.770 Vali Loss: 1.691 Vali Acc: 0.650 Test Loss: 1.691 Test Acc: 0.650
Validation loss decreased (-0.378107 --> -0.649983).  Saving model ...
Epoch: 5 cost time: 0.9467339515686035
Epoch: 5, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.538 Vali Acc: 0.634 Test Loss: 1.538 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0271477699279785
Epoch: 6, Steps: 8 | Train Loss: 1.443 Vali Loss: 1.362 Vali Acc: 0.716 Test Loss: 1.362 Test Acc: 0.716
Validation loss decreased (-0.649983 --> -0.715611).  Saving model ...
Epoch: 7 cost time: 0.9249656200408936
Epoch: 7, Steps: 8 | Train Loss: 1.251 Vali Loss: 1.191 Vali Acc: 0.759 Test Loss: 1.191 Test Acc: 0.759
Validation loss decreased (-0.715611 --> -0.759363).  Saving model ...
Epoch: 8 cost time: 0.8069727420806885
Epoch: 8, Steps: 8 | Train Loss: 1.068 Vali Loss: 1.031 Vali Acc: 0.759 Test Loss: 1.031 Test Acc: 0.759
Validation loss decreased (-0.759363 --> -0.759365).  Saving model ...
Epoch: 9 cost time: 0.9638462066650391
Epoch: 9, Steps: 8 | Train Loss: 0.937 Vali Loss: 0.879 Vali Acc: 0.772 Test Loss: 0.879 Test Acc: 0.772
Validation loss decreased (-0.759365 --> -0.771866).  Saving model ...
Epoch: 10 cost time: 0.9421918392181396
Epoch: 10, Steps: 8 | Train Loss: 0.790 Vali Loss: 0.762 Vali Acc: 0.806 Test Loss: 0.762 Test Acc: 0.806
Validation loss decreased (-0.771866 --> -0.806242).  Saving model ...
Epoch: 11 cost time: 1.0137383937835693
Epoch: 11, Steps: 8 | Train Loss: 0.608 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8840250968933105
Epoch: 12, Steps: 8 | Train Loss: 0.549 Vali Loss: 0.620 Vali Acc: 0.800 Test Loss: 0.620 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9513440132141113
Epoch: 13, Steps: 8 | Train Loss: 0.476 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
Validation loss decreased (-0.806242 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 0.9213519096374512
Epoch: 14, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 15 cost time: 0.8953580856323242
Epoch: 15, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.552 Vali Acc: 0.806 Test Loss: 0.552 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9910643100738525
Epoch: 16, Steps: 8 | Train Loss: 0.311 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 17 cost time: 1.0451552867889404
Epoch: 17, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9713559150695801
Epoch: 18, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8768002986907959
Epoch: 19, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.551 Vali Acc: 0.812 Test Loss: 0.551 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.056649923324585
Epoch: 20, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.10386323928833
Epoch: 21, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9001529216766357
Epoch: 22, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.584 Vali Acc: 0.803 Test Loss: 0.584 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.955174446105957
Epoch: 23, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.581 Vali Acc: 0.828 Test Loss: 0.581 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0906345844268799
Epoch: 24, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9632847309112549
Epoch: 25, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8059217929840088
Epoch: 26, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.615 Vali Acc: 0.831 Test Loss: 0.615 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831244).  Saving model ...
Epoch: 27 cost time: 0.958425760269165
Epoch: 27, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.618 Vali Acc: 0.825 Test Loss: 0.618 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8882215023040771
Epoch: 28, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.635 Vali Acc: 0.819 Test Loss: 0.635 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0704271793365479
Epoch: 29, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.649 Vali Acc: 0.809 Test Loss: 0.649 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0119059085845947
Epoch: 30, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.656 Vali Acc: 0.816 Test Loss: 0.656 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8057630062103271
Epoch: 31, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.665 Vali Acc: 0.809 Test Loss: 0.665 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7432019710540771
Epoch: 32, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.681 Vali Acc: 0.809 Test Loss: 0.681 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8027420043945312
Epoch: 33, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.697 Vali Acc: 0.803 Test Loss: 0.697 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9847416877746582
Epoch: 34, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.697 Vali Acc: 0.816 Test Loss: 0.697 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8061442375183105
Epoch: 35, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.690 Vali Acc: 0.809 Test Loss: 0.690 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8704478740692139
Epoch: 36, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.691 Vali Acc: 0.816 Test Loss: 0.691 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.83125
model parameter : 104032
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.965388298034668
Epoch: 1, Steps: 8 | Train Loss: 2.153 Vali Loss: 2.116 Vali Acc: 0.175 Test Loss: 2.116 Test Acc: 0.175
Validation loss decreased (inf --> -0.174979).  Saving model ...
Epoch: 2 cost time: 1.1971192359924316
Epoch: 2, Steps: 8 | Train Loss: 2.058 Vali Loss: 1.993 Vali Acc: 0.328 Test Loss: 1.993 Test Acc: 0.328
Validation loss decreased (-0.174979 --> -0.328105).  Saving model ...
Epoch: 3 cost time: 0.8826172351837158
Epoch: 3, Steps: 8 | Train Loss: 1.944 Vali Loss: 1.864 Vali Acc: 0.425 Test Loss: 1.864 Test Acc: 0.425
Validation loss decreased (-0.328105 --> -0.424981).  Saving model ...
Epoch: 4 cost time: 0.9608962535858154
Epoch: 4, Steps: 8 | Train Loss: 1.807 Vali Loss: 1.709 Vali Acc: 0.550 Test Loss: 1.709 Test Acc: 0.550
Validation loss decreased (-0.424981 --> -0.549983).  Saving model ...
Epoch: 5 cost time: 1.0556557178497314
Epoch: 5, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.549 Vali Acc: 0.622 Test Loss: 1.549 Test Acc: 0.622
Validation loss decreased (-0.549983 --> -0.621860).  Saving model ...
Epoch: 6 cost time: 0.9495468139648438
Epoch: 6, Steps: 8 | Train Loss: 1.483 Vali Loss: 1.378 Vali Acc: 0.662 Test Loss: 1.378 Test Acc: 0.662
Validation loss decreased (-0.621860 --> -0.662486).  Saving model ...
Epoch: 7 cost time: 0.9202935695648193
Epoch: 7, Steps: 8 | Train Loss: 1.284 Vali Loss: 1.188 Vali Acc: 0.738 Test Loss: 1.188 Test Acc: 0.738
Validation loss decreased (-0.662486 --> -0.737488).  Saving model ...
Epoch: 8 cost time: 0.89585280418396
Epoch: 8, Steps: 8 | Train Loss: 1.054 Vali Loss: 1.003 Vali Acc: 0.794 Test Loss: 1.003 Test Acc: 0.794
Validation loss decreased (-0.737488 --> -0.793740).  Saving model ...
Epoch: 9 cost time: 1.0006942749023438
Epoch: 9, Steps: 8 | Train Loss: 0.871 Vali Loss: 0.854 Vali Acc: 0.803 Test Loss: 0.854 Test Acc: 0.803
Validation loss decreased (-0.793740 --> -0.803116).  Saving model ...
Epoch: 10 cost time: 0.9569084644317627
Epoch: 10, Steps: 8 | Train Loss: 0.726 Vali Loss: 0.740 Vali Acc: 0.794 Test Loss: 0.740 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0032615661621094
Epoch: 11, Steps: 8 | Train Loss: 0.605 Vali Loss: 0.651 Vali Acc: 0.809 Test Loss: 0.651 Test Acc: 0.809
Validation loss decreased (-0.803116 --> -0.809368).  Saving model ...
Epoch: 12 cost time: 1.0319626331329346
Epoch: 12, Steps: 8 | Train Loss: 0.534 Vali Loss: 0.617 Vali Acc: 0.828 Test Loss: 0.617 Test Acc: 0.828
Validation loss decreased (-0.809368 --> -0.828119).  Saving model ...
Epoch: 13 cost time: 1.2671287059783936
Epoch: 13, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.588 Vali Acc: 0.806 Test Loss: 0.588 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2965960502624512
Epoch: 14, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9835517406463623
Epoch: 15, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.049628734588623
Epoch: 16, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9969949722290039
Epoch: 17, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.558 Vali Acc: 0.831 Test Loss: 0.558 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 18 cost time: 0.8827388286590576
Epoch: 18, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0307979583740234
Epoch: 19, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8779473304748535
Epoch: 20, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.568 Vali Acc: 0.834 Test Loss: 0.568 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 21 cost time: 0.9990215301513672
Epoch: 21, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8809702396392822
Epoch: 22, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1045441627502441
Epoch: 23, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.610 Vali Acc: 0.819 Test Loss: 0.610 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9928557872772217
Epoch: 24, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.613 Vali Acc: 0.812 Test Loss: 0.613 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3738269805908203
Epoch: 25, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.617 Vali Acc: 0.816 Test Loss: 0.617 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0259664058685303
Epoch: 26, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.625 Vali Acc: 0.816 Test Loss: 0.625 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9706268310546875
Epoch: 27, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.629 Vali Acc: 0.819 Test Loss: 0.629 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0837464332580566
Epoch: 28, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.639 Vali Acc: 0.819 Test Loss: 0.639 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.179960012435913
Epoch: 29, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.653 Vali Acc: 0.812 Test Loss: 0.653 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2786717414855957
Epoch: 30, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.673 Vali Acc: 0.809 Test Loss: 0.673 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.834375
model parameter : 103168
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.097226142883301
Epoch: 1, Steps: 8 | Train Loss: 2.183 Vali Loss: 2.079 Vali Acc: 0.181 Test Loss: 2.079 Test Acc: 0.181
Validation loss decreased (inf --> -0.181229).  Saving model ...
Epoch: 2 cost time: 1.2122623920440674
Epoch: 2, Steps: 8 | Train Loss: 2.064 Vali Loss: 1.972 Vali Acc: 0.253 Test Loss: 1.972 Test Acc: 0.253
Validation loss decreased (-0.181229 --> -0.253105).  Saving model ...
Epoch: 3 cost time: 0.9152495861053467
Epoch: 3, Steps: 8 | Train Loss: 1.953 Vali Loss: 1.871 Vali Acc: 0.316 Test Loss: 1.871 Test Acc: 0.316
Validation loss decreased (-0.253105 --> -0.315606).  Saving model ...
Epoch: 4 cost time: 0.7997605800628662
Epoch: 4, Steps: 8 | Train Loss: 1.800 Vali Loss: 1.703 Vali Acc: 0.613 Test Loss: 1.703 Test Acc: 0.613
Validation loss decreased (-0.315606 --> -0.612483).  Saving model ...
Epoch: 5 cost time: 0.8411166667938232
Epoch: 5, Steps: 8 | Train Loss: 1.626 Vali Loss: 1.533 Vali Acc: 0.709 Test Loss: 1.533 Test Acc: 0.709
Validation loss decreased (-0.612483 --> -0.709360).  Saving model ...
Epoch: 6 cost time: 0.7365057468414307
Epoch: 6, Steps: 8 | Train Loss: 1.477 Vali Loss: 1.362 Vali Acc: 0.772 Test Loss: 1.362 Test Acc: 0.772
Validation loss decreased (-0.709360 --> -0.771861).  Saving model ...
Epoch: 7 cost time: 0.8445863723754883
Epoch: 7, Steps: 8 | Train Loss: 1.305 Vali Loss: 1.190 Vali Acc: 0.794 Test Loss: 1.190 Test Acc: 0.794
Validation loss decreased (-0.771861 --> -0.793738).  Saving model ...
Epoch: 8 cost time: 0.9144842624664307
Epoch: 8, Steps: 8 | Train Loss: 1.091 Vali Loss: 1.008 Vali Acc: 0.825 Test Loss: 1.008 Test Acc: 0.825
Validation loss decreased (-0.793738 --> -0.824990).  Saving model ...
Epoch: 9 cost time: 0.9846482276916504
Epoch: 9, Steps: 8 | Train Loss: 0.940 Vali Loss: 0.855 Vali Acc: 0.809 Test Loss: 0.855 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0141730308532715
Epoch: 10, Steps: 8 | Train Loss: 0.775 Vali Loss: 0.745 Vali Acc: 0.809 Test Loss: 0.745 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1441421508789062
Epoch: 11, Steps: 8 | Train Loss: 0.648 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9458217620849609
Epoch: 12, Steps: 8 | Train Loss: 0.542 Vali Loss: 0.596 Vali Acc: 0.825 Test Loss: 0.596 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 0.8263354301452637
Epoch: 13, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
Validation loss decreased (-0.824994 --> -0.843744).  Saving model ...
Epoch: 14 cost time: 0.869793176651001
Epoch: 14, Steps: 8 | Train Loss: 0.398 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.967764139175415
Epoch: 15, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.550 Vali Acc: 0.831 Test Loss: 0.550 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9467132091522217
Epoch: 16, Steps: 8 | Train Loss: 0.324 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9897511005401611
Epoch: 17, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.086620807647705
Epoch: 18, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8641879558563232
Epoch: 19, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.549 Vali Acc: 0.822 Test Loss: 0.549 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9944393634796143
Epoch: 20, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7614049911499023
Epoch: 21, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7909743785858154
Epoch: 22, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.596 Vali Acc: 0.825 Test Loss: 0.596 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7593221664428711
Epoch: 23, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_Crossformer_UEA_ftM_sl315_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 102304
model size : 1.07MB
