Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7422543
	speed: 0.2037s/iter; left time: 7495.6298s
	iters: 200, epoch: 1 | loss: 1.1296486
	speed: 0.1997s/iter; left time: 7330.9230s
	iters: 300, epoch: 1 | loss: 1.1265509
	speed: 0.2321s/iter; left time: 8495.6382s
Epoch: 1 cost time: 79.44956088066101
Epoch: 1, Steps: 369 | Train Loss: 0.868 Vali Loss: 0.742 Vali Acc: 0.654 Test Loss: 0.742 Test Acc: 0.654
Validation loss decreased (inf --> -0.653795).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0286454
	speed: 1.1108s/iter; left time: 40467.1428s
	iters: 200, epoch: 2 | loss: 0.5365106
	speed: 0.3283s/iter; left time: 11928.0376s
	iters: 300, epoch: 2 | loss: 0.6992429
	speed: 0.4244s/iter; left time: 15378.6408s
Epoch: 2 cost time: 145.05381608009338
Epoch: 2, Steps: 369 | Train Loss: 0.854 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2403896
	speed: 1.1764s/iter; left time: 42422.8259s
	iters: 200, epoch: 3 | loss: 0.7411729
	speed: 0.3912s/iter; left time: 14067.3704s
	iters: 300, epoch: 3 | loss: 0.6326401
	speed: 0.3320s/iter; left time: 11906.9435s
Epoch: 3 cost time: 133.54673957824707
Epoch: 3, Steps: 369 | Train Loss: 0.909 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7287103
	speed: 1.1818s/iter; left time: 42181.5670s
	iters: 200, epoch: 4 | loss: 0.9426694
	speed: 0.3627s/iter; left time: 12909.2816s
	iters: 300, epoch: 4 | loss: 0.8077882
	speed: 0.3319s/iter; left time: 11781.7601s
Epoch: 4 cost time: 131.00764155387878
Epoch: 4, Steps: 369 | Train Loss: 0.869 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.9706972
	speed: 1.0882s/iter; left time: 38439.3539s
	iters: 200, epoch: 5 | loss: 0.9023964
	speed: 0.3111s/iter; left time: 10958.6914s
	iters: 300, epoch: 5 | loss: 0.6726015
	speed: 0.3886s/iter; left time: 13647.8959s
Epoch: 5 cost time: 126.02832627296448
Epoch: 5, Steps: 369 | Train Loss: 0.930 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6590001
	speed: 1.0947s/iter; left time: 38266.0754s
	iters: 200, epoch: 6 | loss: 0.7479140
	speed: 0.2640s/iter; left time: 9200.6240s
	iters: 300, epoch: 6 | loss: 0.8005890
	speed: 0.4214s/iter; left time: 14647.2354s
Epoch: 6 cost time: 122.91581845283508
Epoch: 6, Steps: 369 | Train Loss: 0.813 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7206505
	speed: 1.0781s/iter; left time: 37287.1674s
	iters: 200, epoch: 7 | loss: 0.8183036
	speed: 0.3592s/iter; left time: 12387.4457s
	iters: 300, epoch: 7 | loss: 0.8263059
	speed: 0.2921s/iter; left time: 10042.7755s
Epoch: 7 cost time: 121.89778661727905
Epoch: 7, Steps: 369 | Train Loss: 0.740 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6543860
	speed: 1.1207s/iter; left time: 38347.9673s
	iters: 200, epoch: 8 | loss: 0.6200204
	speed: 0.3422s/iter; left time: 11674.8227s
	iters: 300, epoch: 8 | loss: 0.7074919
	speed: 0.3808s/iter; left time: 12955.6075s
Epoch: 8 cost time: 129.87166047096252
Epoch: 8, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6785156
	speed: 1.0150s/iter; left time: 34356.4325s
	iters: 200, epoch: 9 | loss: 0.6708013
	speed: 0.2716s/iter; left time: 9167.3703s
	iters: 300, epoch: 9 | loss: 0.8230970
	speed: 0.3578s/iter; left time: 12037.9663s
Epoch: 9 cost time: 116.09808278083801
Epoch: 9, Steps: 369 | Train Loss: 0.762 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7730885
	speed: 1.1053s/iter; left time: 37004.7485s
	iters: 200, epoch: 10 | loss: 0.6861860
	speed: 0.3055s/iter; left time: 10195.9611s
	iters: 300, epoch: 10 | loss: 0.7651946
	speed: 0.3208s/iter; left time: 10675.4411s
Epoch: 10 cost time: 113.71475601196289
Epoch: 10, Steps: 369 | Train Loss: 0.729 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.7488388
	speed: 1.0216s/iter; left time: 33827.2863s
	iters: 200, epoch: 11 | loss: 0.7138380
	speed: 0.3267s/iter; left time: 10785.0777s
	iters: 300, epoch: 11 | loss: 0.6984048
	speed: 0.3271s/iter; left time: 10764.0764s
Epoch: 11 cost time: 129.322692155838
Epoch: 11, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6538024971623155
model parameter : 14558526
model size : 60.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7103629
	speed: 0.2336s/iter; left time: 8597.0084s
	iters: 200, epoch: 1 | loss: 0.4550859
	speed: 0.3489s/iter; left time: 12806.0842s
	iters: 300, epoch: 1 | loss: 1.7788407
	speed: 0.3405s/iter; left time: 12463.1210s
Epoch: 1 cost time: 113.67932200431824
Epoch: 1, Steps: 369 | Train Loss: 0.987 Vali Loss: 0.824 Vali Acc: 0.562 Test Loss: 0.824 Test Acc: 0.562
Validation loss decreased (inf --> -0.561853).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9504169
	speed: 0.9681s/iter; left time: 35268.5851s
	iters: 200, epoch: 2 | loss: 1.8925781
	speed: 0.1870s/iter; left time: 6795.3102s
	iters: 300, epoch: 2 | loss: 0.6442727
	speed: 0.3357s/iter; left time: 12161.5505s
Epoch: 2 cost time: 105.51232123374939
Epoch: 2, Steps: 369 | Train Loss: 0.841 Vali Loss: 0.638 Vali Acc: 0.636 Test Loss: 0.638 Test Acc: 0.636
Validation loss decreased (-0.561853 --> -0.635635).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0350788
	speed: 1.2306s/iter; left time: 44380.3537s
	iters: 200, epoch: 3 | loss: 0.8692736
	speed: 0.3863s/iter; left time: 13890.9516s
	iters: 300, epoch: 3 | loss: 0.7379145
	speed: 0.3135s/iter; left time: 11242.3584s
Epoch: 3 cost time: 140.26974892616272
Epoch: 3, Steps: 369 | Train Loss: 0.914 Vali Loss: 0.859 Vali Acc: 0.500 Test Loss: 0.859 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1905960
	speed: 1.1763s/iter; left time: 41985.3975s
	iters: 200, epoch: 4 | loss: 0.8333099
	speed: 0.3650s/iter; left time: 12990.3017s
	iters: 300, epoch: 4 | loss: 0.4949900
	speed: 0.4170s/iter; left time: 14799.6727s
Epoch: 4 cost time: 134.12998414039612
Epoch: 4, Steps: 369 | Train Loss: 0.881 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.1884730
	speed: 1.2231s/iter; left time: 43207.5460s
	iters: 200, epoch: 5 | loss: 0.8566344
	speed: 0.3857s/iter; left time: 13585.9943s
	iters: 300, epoch: 5 | loss: 0.6886317
	speed: 0.4081s/iter; left time: 14332.8379s
Epoch: 5 cost time: 145.46670365333557
Epoch: 5, Steps: 369 | Train Loss: 0.816 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.2923582
	speed: 1.0900s/iter; left time: 38101.4325s
	iters: 200, epoch: 6 | loss: 0.6603811
	speed: 0.3834s/iter; left time: 13364.6252s
	iters: 300, epoch: 6 | loss: 0.6637986
	speed: 0.3640s/iter; left time: 12651.4083s
Epoch: 6 cost time: 136.9996087551117
Epoch: 6, Steps: 369 | Train Loss: 0.747 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7363854
	speed: 1.2278s/iter; left time: 42467.1125s
	iters: 200, epoch: 7 | loss: 0.7879941
	speed: 0.2951s/iter; left time: 10178.1505s
	iters: 300, epoch: 7 | loss: 0.6490512
	speed: 0.3908s/iter; left time: 13437.0953s
Epoch: 7 cost time: 136.64038157463074
Epoch: 7, Steps: 369 | Train Loss: 0.729 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7118316
	speed: 1.2945s/iter; left time: 44293.8609s
	iters: 200, epoch: 8 | loss: 0.6515266
	speed: 0.4055s/iter; left time: 13835.6642s
	iters: 300, epoch: 8 | loss: 0.6934823
	speed: 0.3915s/iter; left time: 13317.5902s
Epoch: 8 cost time: 148.26528191566467
Epoch: 8, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6657982
	speed: 1.1136s/iter; left time: 37693.9633s
	iters: 200, epoch: 9 | loss: 0.7042797
	speed: 0.4213s/iter; left time: 14219.5782s
	iters: 300, epoch: 9 | loss: 0.7392538
	speed: 0.4086s/iter; left time: 13748.2130s
Epoch: 9 cost time: 145.5111222267151
Epoch: 9, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.8702594
	speed: 1.3754s/iter; left time: 46048.5141s
	iters: 200, epoch: 10 | loss: 0.7338207
	speed: 0.2905s/iter; left time: 9697.9413s
	iters: 300, epoch: 10 | loss: 0.7242408
	speed: 0.3799s/iter; left time: 12642.0304s
Epoch: 10 cost time: 144.68270325660706
Epoch: 10, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6877570
	speed: 1.2645s/iter; left time: 41868.9136s
	iters: 200, epoch: 11 | loss: 0.7128169
	speed: 0.3111s/iter; left time: 10270.9874s
	iters: 300, epoch: 11 | loss: 0.7136385
	speed: 0.4192s/iter; left time: 13797.5636s
Epoch: 11 cost time: 138.63063144683838
Epoch: 11, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7362053
	speed: 1.2810s/iter; left time: 41943.2440s
	iters: 200, epoch: 12 | loss: 0.7005544
	speed: 0.4144s/iter; left time: 13525.4311s
	iters: 300, epoch: 12 | loss: 0.7332318
	speed: 0.3745s/iter; left time: 12187.6715s
Epoch: 12 cost time: 150.78716588020325
Epoch: 12, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6356413166855845
model parameter : 14555454
model size : 60.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2699990
	speed: 0.4332s/iter; left time: 15940.7304s
	iters: 200, epoch: 1 | loss: 0.6422822
	speed: 0.4150s/iter; left time: 15229.1866s
	iters: 300, epoch: 1 | loss: 0.6498856
	speed: 0.3639s/iter; left time: 13319.6822s
Epoch: 1 cost time: 148.7186689376831
Epoch: 1, Steps: 369 | Train Loss: 0.905 Vali Loss: 0.658 Vali Acc: 0.670 Test Loss: 0.658 Test Acc: 0.670
Validation loss decreased (inf --> -0.669971).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9555476
	speed: 1.2017s/iter; left time: 43779.5674s
	iters: 200, epoch: 2 | loss: 1.1178800
	speed: 0.3920s/iter; left time: 14243.8169s
	iters: 300, epoch: 2 | loss: 1.1251616
	speed: 0.3561s/iter; left time: 12901.4508s
Epoch: 2 cost time: 135.31111550331116
Epoch: 2, Steps: 369 | Train Loss: 0.831 Vali Loss: 0.726 Vali Acc: 0.587 Test Loss: 0.726 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1113521
	speed: 1.1519s/iter; left time: 41539.4369s
	iters: 200, epoch: 3 | loss: 1.2707551
	speed: 0.4094s/iter; left time: 14721.6534s
	iters: 300, epoch: 3 | loss: 0.6942342
	speed: 0.3717s/iter; left time: 13329.6046s
Epoch: 3 cost time: 136.52861428260803
Epoch: 3, Steps: 369 | Train Loss: 0.909 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6146662
	speed: 1.2465s/iter; left time: 44493.7088s
	iters: 200, epoch: 4 | loss: 0.6269057
	speed: 0.4328s/iter; left time: 15406.2614s
	iters: 300, epoch: 4 | loss: 0.6465780
	speed: 0.3867s/iter; left time: 13726.9241s
Epoch: 4 cost time: 148.9615306854248
Epoch: 4, Steps: 369 | Train Loss: 0.886 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.5536540
	speed: 1.1427s/iter; left time: 40366.2873s
	iters: 200, epoch: 5 | loss: 0.7948321
	speed: 0.3761s/iter; left time: 13249.7814s
	iters: 300, epoch: 5 | loss: 0.8601019
	speed: 0.3884s/iter; left time: 13641.4836s
Epoch: 5 cost time: 133.1896948814392
Epoch: 5, Steps: 369 | Train Loss: 0.935 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.9652731
	speed: 1.0906s/iter; left time: 38121.4117s
	iters: 200, epoch: 6 | loss: 0.6326637
	speed: 0.3918s/iter; left time: 13657.1595s
	iters: 300, epoch: 6 | loss: 0.6888516
	speed: 0.3857s/iter; left time: 13405.4338s
Epoch: 6 cost time: 134.45987606048584
Epoch: 6, Steps: 369 | Train Loss: 0.849 Vali Loss: 0.802 Vali Acc: 0.500 Test Loss: 0.802 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7249460
	speed: 1.1037s/iter; left time: 38173.5387s
	iters: 200, epoch: 7 | loss: 0.6354628
	speed: 0.3413s/iter; left time: 11772.0089s
	iters: 300, epoch: 7 | loss: 0.7144968
	speed: 0.3967s/iter; left time: 13641.1481s
Epoch: 7 cost time: 127.32419300079346
Epoch: 7, Steps: 369 | Train Loss: 0.751 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7461768
	speed: 1.1049s/iter; left time: 37807.8959s
	iters: 200, epoch: 8 | loss: 0.6660523
	speed: 0.3440s/iter; left time: 11738.2736s
	iters: 300, epoch: 8 | loss: 0.6703863
	speed: 0.3335s/iter; left time: 11343.6771s
Epoch: 8 cost time: 119.69718217849731
Epoch: 8, Steps: 369 | Train Loss: 0.730 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7303455
	speed: 1.1674s/iter; left time: 39514.5749s
	iters: 200, epoch: 9 | loss: 0.7267755
	speed: 0.2440s/iter; left time: 8236.0093s
	iters: 300, epoch: 9 | loss: 0.8327250
	speed: 0.3490s/iter; left time: 11743.5372s
Epoch: 9 cost time: 115.66177296638489
Epoch: 9, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7412774
	speed: 1.1881s/iter; left time: 39779.1203s
	iters: 200, epoch: 10 | loss: 0.7433177
	speed: 0.3171s/iter; left time: 10584.4032s
	iters: 300, epoch: 10 | loss: 0.7024993
	speed: 0.2958s/iter; left time: 9845.7521s
Epoch: 10 cost time: 120.77987098693848
Epoch: 10, Steps: 369 | Train Loss: 0.732 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6673844
	speed: 1.2437s/iter; left time: 41179.5050s
	iters: 200, epoch: 11 | loss: 0.6365072
	speed: 0.3503s/iter; left time: 11563.9286s
	iters: 300, epoch: 11 | loss: 0.7542362
	speed: 0.3282s/iter; left time: 10802.5962s
Epoch: 11 cost time: 127.75610089302063
Epoch: 11, Steps: 369 | Train Loss: 0.735 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6699772985244041
model parameter : 14552382
model size : 60.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0706111
	speed: 0.3677s/iter; left time: 13532.4797s
	iters: 200, epoch: 1 | loss: 0.8262966
	speed: 0.2824s/iter; left time: 10363.4320s
	iters: 300, epoch: 1 | loss: 1.3597598
	speed: 0.2946s/iter; left time: 10782.3371s
Epoch: 1 cost time: 119.26070737838745
Epoch: 1, Steps: 369 | Train Loss: 0.896 Vali Loss: 1.022 Vali Acc: 0.515 Test Loss: 1.022 Test Acc: 0.515
Validation loss decreased (inf --> -0.514746).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6133314
	speed: 1.1722s/iter; left time: 42704.6256s
	iters: 200, epoch: 2 | loss: 0.9122861
	speed: 0.3330s/iter; left time: 12097.3906s
	iters: 300, epoch: 2 | loss: 1.0880035
	speed: 0.2359s/iter; left time: 8546.5670s
Epoch: 2 cost time: 107.48250436782837
Epoch: 2, Steps: 369 | Train Loss: 0.879 Vali Loss: 1.207 Vali Acc: 0.501 Test Loss: 1.207 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8404239
	speed: 1.1280s/iter; left time: 40678.4730s
	iters: 200, epoch: 3 | loss: 1.0829076
	speed: 0.3577s/iter; left time: 12865.1940s
	iters: 300, epoch: 3 | loss: 0.8704473
	speed: 0.3233s/iter; left time: 11595.9065s
Epoch: 3 cost time: 132.76807761192322
Epoch: 3, Steps: 369 | Train Loss: 0.907 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.1390947
	speed: 1.1219s/iter; left time: 40046.3030s
	iters: 200, epoch: 4 | loss: 0.6481496
	speed: 0.3150s/iter; left time: 11212.7019s
	iters: 300, epoch: 4 | loss: 0.6324767
	speed: 0.2952s/iter; left time: 10477.6824s
Epoch: 4 cost time: 119.59788227081299
Epoch: 4, Steps: 369 | Train Loss: 0.877 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6688046
	speed: 1.0853s/iter; left time: 38336.9422s
	iters: 200, epoch: 5 | loss: 0.9351295
	speed: 0.2804s/iter; left time: 9875.8838s
	iters: 300, epoch: 5 | loss: 0.8715076
	speed: 0.3774s/iter; left time: 13255.9089s
Epoch: 5 cost time: 120.80586671829224
Epoch: 5, Steps: 369 | Train Loss: 0.835 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.8517565
	speed: 1.1007s/iter; left time: 38477.2850s
	iters: 200, epoch: 6 | loss: 0.7081962
	speed: 0.3142s/iter; left time: 10950.8577s
	iters: 300, epoch: 6 | loss: 0.9503139
	speed: 0.2730s/iter; left time: 9488.4979s
Epoch: 6 cost time: 117.65392637252808
Epoch: 6, Steps: 369 | Train Loss: 0.757 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7825333
	speed: 1.1046s/iter; left time: 38203.8841s
	iters: 200, epoch: 7 | loss: 0.5313518
	speed: 0.2976s/iter; left time: 10262.2686s
	iters: 300, epoch: 7 | loss: 0.7600026
	speed: 0.3293s/iter; left time: 11324.8940s
Epoch: 7 cost time: 112.59276270866394
Epoch: 7, Steps: 369 | Train Loss: 0.740 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7594454
	speed: 1.0228s/iter; left time: 34996.8835s
	iters: 200, epoch: 8 | loss: 0.6922123
	speed: 0.2980s/iter; left time: 10168.2283s
	iters: 300, epoch: 8 | loss: 0.7243124
	speed: 0.3107s/iter; left time: 10568.9199s
Epoch: 8 cost time: 111.98652648925781
Epoch: 8, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7053521
	speed: 1.0585s/iter; left time: 35828.3273s
	iters: 200, epoch: 9 | loss: 0.6923919
	speed: 0.3116s/iter; left time: 10517.4977s
	iters: 300, epoch: 9 | loss: 0.7197312
	speed: 0.3130s/iter; left time: 10531.5873s
Epoch: 9 cost time: 120.35028958320618
Epoch: 9, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6799837
	speed: 1.0649s/iter; left time: 35654.4156s
	iters: 200, epoch: 10 | loss: 0.6911221
	speed: 0.2650s/iter; left time: 8845.7282s
	iters: 300, epoch: 10 | loss: 0.7043632
	speed: 0.3186s/iter; left time: 10602.8649s
Epoch: 10 cost time: 113.94682955741882
Epoch: 10, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6677088
	speed: 1.0374s/iter; left time: 34350.7409s
	iters: 200, epoch: 11 | loss: 0.7469521
	speed: 0.3040s/iter; left time: 10034.6715s
	iters: 300, epoch: 11 | loss: 0.7393092
	speed: 0.3215s/iter; left time: 10580.2208s
Epoch: 11 cost time: 110.35748791694641
Epoch: 11, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.514755959137344
model parameter : 14549310
model size : 60.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7746254
	speed: 0.3273s/iter; left time: 12046.7708s
	iters: 200, epoch: 1 | loss: 0.8305882
	speed: 0.2798s/iter; left time: 10268.8779s
	iters: 300, epoch: 1 | loss: 2.3906214
	speed: 0.2981s/iter; left time: 10911.7653s
Epoch: 1 cost time: 113.15067553520203
Epoch: 1, Steps: 369 | Train Loss: 0.902 Vali Loss: 1.044 Vali Acc: 0.501 Test Loss: 1.044 Test Acc: 0.501
Validation loss decreased (inf --> -0.501125).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2189432
	speed: 1.0649s/iter; left time: 38795.8555s
	iters: 200, epoch: 2 | loss: 1.3707172
	speed: 0.2949s/iter; left time: 10713.0707s
	iters: 300, epoch: 2 | loss: 0.5745816
	speed: 0.2723s/iter; left time: 9865.4861s
Epoch: 2 cost time: 105.56790924072266
Epoch: 2, Steps: 369 | Train Loss: 0.847 Vali Loss: 0.669 Vali Acc: 0.645 Test Loss: 0.669 Test Acc: 0.645
Validation loss decreased (-0.501125 --> -0.644715).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7423667
	speed: 1.0347s/iter; left time: 37313.0235s
	iters: 200, epoch: 3 | loss: 0.8219124
	speed: 0.2891s/iter; left time: 10396.2020s
	iters: 300, epoch: 3 | loss: 1.5823529
	speed: 0.2864s/iter; left time: 10271.6098s
Epoch: 3 cost time: 110.28918075561523
Epoch: 3, Steps: 369 | Train Loss: 0.871 Vali Loss: 0.873 Vali Acc: 0.500 Test Loss: 0.873 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4640595
	speed: 1.0766s/iter; left time: 38426.4926s
	iters: 200, epoch: 4 | loss: 0.8733101
	speed: 0.3007s/iter; left time: 10704.8160s
	iters: 300, epoch: 4 | loss: 0.9707107
	speed: 0.2663s/iter; left time: 9450.4974s
Epoch: 4 cost time: 111.78817534446716
Epoch: 4, Steps: 369 | Train Loss: 0.861 Vali Loss: 0.793 Vali Acc: 0.500 Test Loss: 0.793 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 3.5263603
	speed: 1.0082s/iter; left time: 35615.6250s
	iters: 200, epoch: 5 | loss: 0.8323694
	speed: 0.3142s/iter; left time: 11066.8683s
	iters: 300, epoch: 5 | loss: 2.3108413
	speed: 0.3337s/iter; left time: 11720.5164s
Epoch: 5 cost time: 113.76960182189941
Epoch: 5, Steps: 369 | Train Loss: 1.084 Vali Loss: 1.867 Vali Acc: 0.500 Test Loss: 1.867 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.9628224
	speed: 1.0306s/iter; left time: 36025.1201s
	iters: 200, epoch: 6 | loss: 0.6071138
	speed: 0.2840s/iter; left time: 9899.2484s
	iters: 300, epoch: 6 | loss: 0.7607847
	speed: 0.3225s/iter; left time: 11209.7627s
Epoch: 6 cost time: 116.96028923988342
Epoch: 6, Steps: 369 | Train Loss: 0.886 Vali Loss: 0.934 Vali Acc: 0.500 Test Loss: 0.934 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7381528
	speed: 1.0643s/iter; left time: 36811.8392s
	iters: 200, epoch: 7 | loss: 0.7342324
	speed: 0.2746s/iter; left time: 9468.7590s
	iters: 300, epoch: 7 | loss: 0.8338207
	speed: 0.2373s/iter; left time: 8159.9340s
Epoch: 7 cost time: 105.87354612350464
Epoch: 7, Steps: 369 | Train Loss: 0.767 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7588012
	speed: 1.0437s/iter; left time: 35714.6825s
	iters: 200, epoch: 8 | loss: 0.6916170
	speed: 0.2799s/iter; left time: 9548.9175s
	iters: 300, epoch: 8 | loss: 0.7484343
	speed: 0.3082s/iter; left time: 10483.6148s
Epoch: 8 cost time: 102.78447270393372
Epoch: 8, Steps: 369 | Train Loss: 0.737 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6841543
	speed: 0.9789s/iter; left time: 33136.1440s
	iters: 200, epoch: 9 | loss: 0.9035096
	speed: 0.2790s/iter; left time: 9416.9805s
	iters: 300, epoch: 9 | loss: 0.8835722
	speed: 0.2882s/iter; left time: 9696.4800s
Epoch: 9 cost time: 109.81071400642395
Epoch: 9, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6751808
	speed: 0.9979s/iter; left time: 33409.8737s
	iters: 200, epoch: 10 | loss: 0.7034968
	speed: 0.3095s/iter; left time: 10332.0006s
	iters: 300, epoch: 10 | loss: 0.7382635
	speed: 0.2947s/iter; left time: 9806.7477s
Epoch: 10 cost time: 113.38328886032104
Epoch: 10, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6896178
	speed: 0.9619s/iter; left time: 31849.0091s
	iters: 200, epoch: 11 | loss: 0.7861877
	speed: 0.2825s/iter; left time: 9326.0183s
	iters: 300, epoch: 11 | loss: 0.7387334
	speed: 0.3151s/iter; left time: 10371.5682s
Epoch: 11 cost time: 106.04373383522034
Epoch: 11, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.6823328
	speed: 0.9774s/iter; left time: 32001.7997s
	iters: 200, epoch: 12 | loss: 0.6938348
	speed: 0.2883s/iter; left time: 9409.2804s
	iters: 300, epoch: 12 | loss: 0.6842458
	speed: 0.2361s/iter; left time: 7683.3518s
Epoch: 12 cost time: 99.32463455200195
Epoch: 12, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.64472190692395
model parameter : 12194622
model size : 51.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5989376
	speed: 0.2844s/iter; left time: 10464.5261s
	iters: 200, epoch: 1 | loss: 0.5303191
	speed: 0.2475s/iter; left time: 9082.5270s
	iters: 300, epoch: 1 | loss: 0.8150847
	speed: 0.3126s/iter; left time: 11443.0206s
Epoch: 1 cost time: 106.9667899608612
Epoch: 1, Steps: 369 | Train Loss: 0.889 Vali Loss: 0.724 Vali Acc: 0.555 Test Loss: 0.724 Test Acc: 0.555
Validation loss decreased (inf --> -0.555044).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7279171
	speed: 0.9903s/iter; left time: 36079.2733s
	iters: 200, epoch: 2 | loss: 0.7093605
	speed: 0.2797s/iter; left time: 10163.5539s
	iters: 300, epoch: 2 | loss: 1.7720168
	speed: 0.3119s/iter; left time: 11299.8081s
Epoch: 2 cost time: 106.42483615875244
Epoch: 2, Steps: 369 | Train Loss: 0.840 Vali Loss: 1.075 Vali Acc: 0.500 Test Loss: 1.075 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2838581
	speed: 1.0591s/iter; left time: 38193.4218s
	iters: 200, epoch: 3 | loss: 1.1169112
	speed: 0.3083s/iter; left time: 11088.4818s
	iters: 300, epoch: 3 | loss: 0.6303467
	speed: 0.2959s/iter; left time: 10612.5493s
Epoch: 3 cost time: 117.38489365577698
Epoch: 3, Steps: 369 | Train Loss: 0.888 Vali Loss: 1.006 Vali Acc: 0.500 Test Loss: 1.006 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7861550
	speed: 1.0551s/iter; left time: 37659.3902s
	iters: 200, epoch: 4 | loss: 0.7604169
	speed: 0.2729s/iter; left time: 9713.2894s
	iters: 300, epoch: 4 | loss: 0.9596805
	speed: 0.3060s/iter; left time: 10860.6946s
Epoch: 4 cost time: 112.3080985546112
Epoch: 4, Steps: 369 | Train Loss: 0.888 Vali Loss: 0.872 Vali Acc: 0.500 Test Loss: 0.872 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.7834179
	speed: 1.0669s/iter; left time: 37688.6048s
	iters: 200, epoch: 5 | loss: 0.8570479
	speed: 0.2793s/iter; left time: 9838.0244s
	iters: 300, epoch: 5 | loss: 0.6847623
	speed: 0.2854s/iter; left time: 10026.3543s
Epoch: 5 cost time: 106.8209331035614
Epoch: 5, Steps: 369 | Train Loss: 0.813 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7865767
	speed: 0.9674s/iter; left time: 33818.1739s
	iters: 200, epoch: 6 | loss: 0.6437743
	speed: 0.3316s/iter; left time: 11556.7921s
	iters: 300, epoch: 6 | loss: 0.6809933
	speed: 0.2409s/iter; left time: 8372.8223s
Epoch: 6 cost time: 107.44982409477234
Epoch: 6, Steps: 369 | Train Loss: 0.796 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.8069338
	speed: 1.0224s/iter; left time: 35363.1441s
	iters: 200, epoch: 7 | loss: 0.7301978
	speed: 0.2890s/iter; left time: 9965.6186s
	iters: 300, epoch: 7 | loss: 0.6666622
	speed: 0.3293s/iter; left time: 11324.8319s
Epoch: 7 cost time: 114.30145502090454
Epoch: 7, Steps: 369 | Train Loss: 0.729 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7208799
	speed: 0.9443s/iter; left time: 32312.4989s
	iters: 200, epoch: 8 | loss: 0.7771502
	speed: 0.2477s/iter; left time: 8452.4027s
	iters: 300, epoch: 8 | loss: 0.7392216
	speed: 0.3099s/iter; left time: 10543.1411s
Epoch: 8 cost time: 108.30593538284302
Epoch: 8, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7386132
	speed: 0.9920s/iter; left time: 33576.8821s
	iters: 200, epoch: 9 | loss: 0.7460939
	speed: 0.2482s/iter; left time: 8376.2704s
	iters: 300, epoch: 9 | loss: 0.7577071
	speed: 0.2897s/iter; left time: 9746.9279s
Epoch: 9 cost time: 98.05930376052856
Epoch: 9, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6803908
	speed: 1.0331s/iter; left time: 34586.7097s
	iters: 200, epoch: 10 | loss: 0.7092398
	speed: 0.3014s/iter; left time: 10061.5187s
	iters: 300, epoch: 10 | loss: 0.6961585
	speed: 0.2912s/iter; left time: 9690.1382s
Epoch: 10 cost time: 107.31151413917542
Epoch: 10, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6478427
	speed: 0.9714s/iter; left time: 32162.5832s
	iters: 200, epoch: 11 | loss: 0.7093038
	speed: 0.2940s/iter; left time: 9705.0303s
	iters: 300, epoch: 11 | loss: 0.6931286
	speed: 0.2977s/iter; left time: 9798.8601s
Epoch: 11 cost time: 112.68626642227173
Epoch: 11, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5550510783200908
model parameter : 12191550
model size : 51.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8078074
	speed: 0.3260s/iter; left time: 11998.1833s
	iters: 200, epoch: 1 | loss: 0.8528262
	speed: 0.2584s/iter; left time: 9485.0579s
	iters: 300, epoch: 1 | loss: 0.6408191
	speed: 0.2459s/iter; left time: 8999.7552s
Epoch: 1 cost time: 102.53205037117004
Epoch: 1, Steps: 369 | Train Loss: 0.962 Vali Loss: 1.411 Vali Acc: 0.500 Test Loss: 1.411 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4759893
	speed: 1.0090s/iter; left time: 36758.7043s
	iters: 200, epoch: 2 | loss: 0.7608464
	speed: 0.2328s/iter; left time: 8458.5176s
	iters: 300, epoch: 2 | loss: 0.6892673
	speed: 0.2539s/iter; left time: 9198.9173s
Epoch: 2 cost time: 99.03793787956238
Epoch: 2, Steps: 369 | Train Loss: 0.805 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499988).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9432514
	speed: 0.9387s/iter; left time: 33853.8722s
	iters: 200, epoch: 3 | loss: 0.7152091
	speed: 0.2435s/iter; left time: 8758.3210s
	iters: 300, epoch: 3 | loss: 0.9527632
	speed: 0.3107s/iter; left time: 11143.8502s
Epoch: 3 cost time: 101.63995432853699
Epoch: 3, Steps: 369 | Train Loss: 0.917 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499993).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7434543
	speed: 0.9683s/iter; left time: 34563.1222s
	iters: 200, epoch: 4 | loss: 0.8787690
	speed: 0.2385s/iter; left time: 8490.4884s
	iters: 300, epoch: 4 | loss: 1.0727838
	speed: 0.2685s/iter; left time: 9531.0596s
Epoch: 4 cost time: 97.75956559181213
Epoch: 4, Steps: 369 | Train Loss: 0.928 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6445162
	speed: 0.9320s/iter; left time: 32921.9214s
	iters: 200, epoch: 5 | loss: 0.8699189
	speed: 0.2698s/iter; left time: 9505.1376s
	iters: 300, epoch: 5 | loss: 0.7220470
	speed: 0.2777s/iter; left time: 9754.9847s
Epoch: 5 cost time: 99.69445610046387
Epoch: 5, Steps: 369 | Train Loss: 0.915 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7800930
	speed: 0.9720s/iter; left time: 33977.4880s
	iters: 200, epoch: 6 | loss: 0.8451899
	speed: 0.2667s/iter; left time: 9296.5698s
	iters: 300, epoch: 6 | loss: 0.7892400
	speed: 0.2227s/iter; left time: 7740.7687s
Epoch: 6 cost time: 94.58218169212341
Epoch: 6, Steps: 369 | Train Loss: 0.787 Vali Loss: 0.931 Vali Acc: 0.500 Test Loss: 0.931 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.9461766
	speed: 0.8741s/iter; left time: 30231.9110s
	iters: 200, epoch: 7 | loss: 0.6925721
	speed: 0.2806s/iter; left time: 9677.7091s
	iters: 300, epoch: 7 | loss: 0.7333012
	speed: 0.3014s/iter; left time: 10365.7145s
Epoch: 7 cost time: 103.41506695747375
Epoch: 7, Steps: 369 | Train Loss: 0.733 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7839437
	speed: 0.9064s/iter; left time: 31016.7105s
	iters: 200, epoch: 8 | loss: 0.6656170
	speed: 0.2446s/iter; left time: 8344.2754s
	iters: 300, epoch: 8 | loss: 0.7884949
	speed: 0.2183s/iter; left time: 7425.8279s
Epoch: 8 cost time: 93.50101161003113
Epoch: 8, Steps: 369 | Train Loss: 0.734 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.7141280
	speed: 0.9403s/iter; left time: 31827.8694s
	iters: 200, epoch: 9 | loss: 0.8223670
	speed: 0.2615s/iter; left time: 8825.5806s
	iters: 300, epoch: 9 | loss: 0.6732152
	speed: 0.2659s/iter; left time: 8947.4168s
Epoch: 9 cost time: 99.7187225818634
Epoch: 9, Steps: 369 | Train Loss: 0.759 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7345313
	speed: 0.8627s/iter; left time: 28884.2929s
	iters: 200, epoch: 10 | loss: 0.6887898
	speed: 0.2851s/iter; left time: 9516.8109s
	iters: 300, epoch: 10 | loss: 0.7687276
	speed: 0.2980s/iter; left time: 9917.7875s
Epoch: 10 cost time: 102.09921669960022
Epoch: 10, Steps: 369 | Train Loss: 0.744 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.7026607
	speed: 0.8432s/iter; left time: 27918.7074s
	iters: 200, epoch: 11 | loss: 0.7484143
	speed: 0.2133s/iter; left time: 7042.3053s
	iters: 300, epoch: 11 | loss: 0.7762432
	speed: 0.2309s/iter; left time: 7599.8355s
Epoch: 11 cost time: 85.74611902236938
Epoch: 11, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6204889
	speed: 0.9996s/iter; left time: 32727.4949s
	iters: 200, epoch: 12 | loss: 0.6717521
	speed: 0.2452s/iter; left time: 8002.9646s
	iters: 300, epoch: 12 | loss: 0.8287709
	speed: 0.1772s/iter; left time: 5766.9054s
Epoch: 12 cost time: 86.1713764667511
Epoch: 12, Steps: 369 | Train Loss: 0.744 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6020079
	speed: 0.8096s/iter; left time: 26209.7559s
	iters: 200, epoch: 13 | loss: 0.8180142
	speed: 0.2747s/iter; left time: 8864.6447s
	iters: 300, epoch: 13 | loss: 0.6852326
	speed: 0.2451s/iter; left time: 7886.1590s
Epoch: 13 cost time: 95.32054853439331
Epoch: 13, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7083068
	speed: 0.7907s/iter; left time: 25305.5020s
	iters: 200, epoch: 14 | loss: 0.6828232
	speed: 0.2193s/iter; left time: 6994.9715s
	iters: 300, epoch: 14 | loss: 0.6922946
	speed: 0.2704s/iter; left time: 8598.2784s
Epoch: 14 cost time: 88.03654336929321
Epoch: 14, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6505404
	speed: 0.8922s/iter; left time: 28225.9740s
	iters: 200, epoch: 15 | loss: 0.6838370
	speed: 0.2387s/iter; left time: 7526.8508s
	iters: 300, epoch: 15 | loss: 0.7100847
	speed: 0.2251s/iter; left time: 7076.5246s
Epoch: 15 cost time: 85.85471796989441
Epoch: 15, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6859979
	speed: 0.8264s/iter; left time: 25839.4491s
	iters: 200, epoch: 16 | loss: 0.7954826
	speed: 0.1808s/iter; left time: 5636.1272s
	iters: 300, epoch: 16 | loss: 0.6812671
	speed: 0.2056s/iter; left time: 6387.2993s
Epoch: 16 cost time: 78.80043935775757
Epoch: 16, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6977636
	speed: 0.8396s/iter; left time: 25942.1697s
	iters: 200, epoch: 17 | loss: 0.6952274
	speed: 0.2567s/iter; left time: 7904.5827s
	iters: 300, epoch: 17 | loss: 0.6950607
	speed: 0.2302s/iter; left time: 7065.0091s
Epoch: 17 cost time: 90.95359134674072
Epoch: 17, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.7077053
	speed: 0.8778s/iter; left time: 26796.3429s
	iters: 200, epoch: 18 | loss: 0.7046039
	speed: 0.2632s/iter; left time: 8008.7661s
	iters: 300, epoch: 18 | loss: 0.7425236
	speed: 0.2574s/iter; left time: 7805.1932s
Epoch: 18 cost time: 97.81614875793457
Epoch: 18, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.6595924
	speed: 0.8858s/iter; left time: 26713.5061s
	iters: 200, epoch: 19 | loss: 0.6742308
	speed: 0.2450s/iter; left time: 7365.3120s
	iters: 300, epoch: 19 | loss: 0.7085435
	speed: 0.2515s/iter; left time: 7533.4549s
Epoch: 19 cost time: 91.6127073764801
Epoch: 19, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.7157789
	speed: 0.9613s/iter; left time: 28635.9314s
	iters: 200, epoch: 20 | loss: 0.7011939
	speed: 0.2315s/iter; left time: 6872.9655s
	iters: 300, epoch: 20 | loss: 0.7179838
	speed: 0.2170s/iter; left time: 6422.4819s
Epoch: 20 cost time: 90.22765970230103
Epoch: 20, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.6815839
	speed: 0.9380s/iter; left time: 27597.2888s
	iters: 200, epoch: 21 | loss: 0.6883336
	speed: 0.2582s/iter; left time: 7571.9947s
	iters: 300, epoch: 21 | loss: 0.6982007
	speed: 0.2481s/iter; left time: 7250.9933s
Epoch: 21 cost time: 98.1168007850647
Epoch: 21, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.6480934
	speed: 0.8571s/iter; left time: 24901.2243s
	iters: 200, epoch: 22 | loss: 0.6768981
	speed: 0.2620s/iter; left time: 7586.4466s
	iters: 300, epoch: 22 | loss: 0.6757050
	speed: 0.2743s/iter; left time: 7914.3815s
Epoch: 22 cost time: 99.38780069351196
Epoch: 22, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.7000046
	speed: 1.0519s/iter; left time: 30172.4726s
	iters: 200, epoch: 23 | loss: 0.6855221
	speed: 0.3172s/iter; left time: 9065.6235s
	iters: 300, epoch: 23 | loss: 0.7155751
	speed: 0.3717s/iter; left time: 10587.5722s
Epoch: 23 cost time: 126.10410952568054
Epoch: 23, Steps: 369 | Train Loss: 0.699 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.6900790
	speed: 1.0525s/iter; left time: 29801.7391s
	iters: 200, epoch: 24 | loss: 0.6841290
	speed: 0.3265s/iter; left time: 9211.3484s
	iters: 300, epoch: 24 | loss: 0.7062241
	speed: 0.3312s/iter; left time: 9310.8995s
Epoch: 24 cost time: 121.93876910209656
Epoch: 24, Steps: 369 | Train Loss: 0.699 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.6988623
	speed: 1.0288s/iter; left time: 28749.7758s
	iters: 200, epoch: 25 | loss: 0.6967729
	speed: 0.3049s/iter; left time: 8489.2326s
	iters: 300, epoch: 25 | loss: 0.7214327
	speed: 0.3244s/iter; left time: 8999.1121s
Epoch: 25 cost time: 114.21825504302979
Epoch: 25, Steps: 369 | Train Loss: 0.699 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.7214670
	speed: 1.0657s/iter; left time: 29388.6985s
	iters: 200, epoch: 26 | loss: 0.6980009
	speed: 0.2137s/iter; left time: 5872.0747s
	iters: 300, epoch: 26 | loss: 0.6904464
	speed: 0.3035s/iter; left time: 8309.4081s
Epoch: 26 cost time: 103.08170104026794
Epoch: 26, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.6868008
	speed: 1.0794s/iter; left time: 29367.9199s
	iters: 200, epoch: 27 | loss: 0.6835927
	speed: 0.3048s/iter; left time: 8263.0684s
	iters: 300, epoch: 27 | loss: 0.6834741
	speed: 0.3032s/iter; left time: 8187.6426s
Epoch: 27 cost time: 118.28653335571289
Epoch: 27, Steps: 369 | Train Loss: 0.699 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.6958731
	speed: 1.1351s/iter; left time: 30463.6201s
	iters: 200, epoch: 28 | loss: 0.6757155
	speed: 0.2769s/iter; left time: 7403.5489s
	iters: 300, epoch: 28 | loss: 0.7058721
	speed: 0.2080s/iter; left time: 5541.1463s
Epoch: 28 cost time: 104.61164593696594
Epoch: 28, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.6932658
	speed: 1.0235s/iter; left time: 27092.0461s
	iters: 200, epoch: 29 | loss: 0.7035726
	speed: 0.3591s/iter; left time: 9467.8776s
	iters: 300, epoch: 29 | loss: 0.7415292
	speed: 0.3171s/iter; left time: 8329.0052s
Epoch: 29 cost time: 123.35818719863892
Epoch: 29, Steps: 369 | Train Loss: 0.699 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.6987824
	speed: 1.0686s/iter; left time: 27890.0287s
	iters: 200, epoch: 30 | loss: 0.7077519
	speed: 0.1949s/iter; left time: 5066.8971s
	iters: 300, epoch: 30 | loss: 0.7049338
	speed: 0.2886s/iter; left time: 7475.2951s
Epoch: 30 cost time: 101.19777059555054
Epoch: 30, Steps: 369 | Train Loss: 0.696 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.7104326
	speed: 1.0517s/iter; left time: 27061.4157s
	iters: 200, epoch: 31 | loss: 0.7209290
	speed: 0.2876s/iter; left time: 7371.5783s
	iters: 300, epoch: 31 | loss: 0.6899837
	speed: 0.3009s/iter; left time: 7682.1188s
Epoch: 31 cost time: 113.32639360427856
Epoch: 31, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.7023873
	speed: 1.0474s/iter; left time: 26565.2649s
	iters: 200, epoch: 32 | loss: 0.6800655
	speed: 0.2648s/iter; left time: 6690.6284s
	iters: 300, epoch: 32 | loss: 0.6508769
	speed: 0.2240s/iter; left time: 5637.1197s
Epoch: 32 cost time: 102.62746381759644
Epoch: 32, Steps: 369 | Train Loss: 0.697 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.7040591
	speed: 1.0500s/iter; left time: 26243.8400s
	iters: 200, epoch: 33 | loss: 0.6712392
	speed: 0.2940s/iter; left time: 7318.7719s
	iters: 300, epoch: 33 | loss: 0.7190017
	speed: 0.2096s/iter; left time: 5197.0898s
Epoch: 33 cost time: 97.61769556999207
Epoch: 33, Steps: 369 | Train Loss: 0.698 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 12188478
model size : 51.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5150422
	speed: 0.3350s/iter; left time: 12327.5255s
	iters: 200, epoch: 1 | loss: 0.5529822
	speed: 0.2987s/iter; left time: 10961.0406s
	iters: 300, epoch: 1 | loss: 0.5605122
	speed: 0.2815s/iter; left time: 10303.2387s
Epoch: 1 cost time: 111.85703134536743
Epoch: 1, Steps: 369 | Train Loss: 0.843 Vali Loss: 0.836 Vali Acc: 0.607 Test Loss: 0.836 Test Acc: 0.607
Validation loss decreased (inf --> -0.606689).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6251432
	speed: 0.9759s/iter; left time: 35554.0400s
	iters: 200, epoch: 2 | loss: 0.5539640
	speed: 0.2169s/iter; left time: 7881.3931s
	iters: 300, epoch: 2 | loss: 0.7901314
	speed: 0.2428s/iter; left time: 8795.9486s
Epoch: 2 cost time: 94.57321405410767
Epoch: 2, Steps: 369 | Train Loss: 0.815 Vali Loss: 0.662 Vali Acc: 0.629 Test Loss: 0.662 Test Acc: 0.629
Validation loss decreased (-0.606689 --> -0.628540).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9665030
	speed: 0.9643s/iter; left time: 34777.2412s
	iters: 200, epoch: 3 | loss: 1.5743132
	speed: 0.3051s/iter; left time: 10970.7424s
	iters: 300, epoch: 3 | loss: 0.7262896
	speed: 0.2850s/iter; left time: 10221.5652s
Epoch: 3 cost time: 109.5724036693573
Epoch: 3, Steps: 369 | Train Loss: 0.918 Vali Loss: 2.474 Vali Acc: 0.500 Test Loss: 2.474 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7338333
	speed: 0.9845s/iter; left time: 35139.7526s
	iters: 200, epoch: 4 | loss: 1.0659761
	speed: 0.3329s/iter; left time: 11848.1398s
	iters: 300, epoch: 4 | loss: 1.4871695
	speed: 0.3246s/iter; left time: 11520.4194s
Epoch: 4 cost time: 124.16885876655579
Epoch: 4, Steps: 369 | Train Loss: 0.970 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8635181
	speed: 1.1200s/iter; left time: 39565.0659s
	iters: 200, epoch: 5 | loss: 0.6924431
	speed: 0.3184s/iter; left time: 11216.5985s
	iters: 300, epoch: 5 | loss: 0.9775425
	speed: 0.3349s/iter; left time: 11762.3360s
Epoch: 5 cost time: 126.49778532981873
Epoch: 5, Steps: 369 | Train Loss: 0.970 Vali Loss: 0.852 Vali Acc: 0.500 Test Loss: 0.852 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7449104
	speed: 0.9338s/iter; left time: 32643.4558s
	iters: 200, epoch: 6 | loss: 0.7557733
	speed: 0.3074s/iter; left time: 10715.0245s
	iters: 300, epoch: 6 | loss: 0.7429386
	speed: 0.3549s/iter; left time: 12335.2839s
Epoch: 6 cost time: 110.68943190574646
Epoch: 6, Steps: 369 | Train Loss: 0.944 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7544265
	speed: 1.0809s/iter; left time: 37383.8172s
	iters: 200, epoch: 7 | loss: 0.7173010
	speed: 0.3303s/iter; left time: 11389.8505s
	iters: 300, epoch: 7 | loss: 0.7910522
	speed: 0.2519s/iter; left time: 8662.9404s
Epoch: 7 cost time: 114.49900269508362
Epoch: 7, Steps: 369 | Train Loss: 0.769 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7144983
	speed: 1.0666s/iter; left time: 36497.3515s
	iters: 200, epoch: 8 | loss: 0.7202882
	speed: 0.3442s/iter; left time: 11744.2948s
	iters: 300, epoch: 8 | loss: 0.6327419
	speed: 0.3172s/iter; left time: 10788.9331s
Epoch: 8 cost time: 122.5686137676239
Epoch: 8, Steps: 369 | Train Loss: 0.728 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7395827
	speed: 1.0313s/iter; left time: 34910.0471s
	iters: 200, epoch: 9 | loss: 0.7055029
	speed: 0.2352s/iter; left time: 7936.8477s
	iters: 300, epoch: 9 | loss: 0.7027370
	speed: 0.3243s/iter; left time: 10911.2439s
Epoch: 9 cost time: 108.04901242256165
Epoch: 9, Steps: 369 | Train Loss: 0.719 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.7241490
	speed: 1.1038s/iter; left time: 36956.0519s
	iters: 200, epoch: 10 | loss: 0.7371249
	speed: 0.3307s/iter; left time: 11039.1568s
	iters: 300, epoch: 10 | loss: 0.6630729
	speed: 0.2816s/iter; left time: 9370.0431s
Epoch: 10 cost time: 122.71105146408081
Epoch: 10, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7045069
	speed: 0.9928s/iter; left time: 32871.5988s
	iters: 200, epoch: 11 | loss: 0.7707598
	speed: 0.2737s/iter; left time: 9035.4515s
	iters: 300, epoch: 11 | loss: 0.6897632
	speed: 0.3268s/iter; left time: 10754.2875s
Epoch: 11 cost time: 109.44686841964722
Epoch: 11, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.6947778
	speed: 1.0532s/iter; left time: 34483.6042s
	iters: 200, epoch: 12 | loss: 0.7346028
	speed: 0.3575s/iter; left time: 11670.6971s
	iters: 300, epoch: 12 | loss: 0.7006880
	speed: 0.3607s/iter; left time: 11738.2775s
Epoch: 12 cost time: 124.55502414703369
Epoch: 12, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6285471055618616
model parameter : 12185406
model size : 51.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6694579
	speed: 0.3090s/iter; left time: 11372.7963s
	iters: 200, epoch: 1 | loss: 0.7457301
	speed: 0.2955s/iter; left time: 10844.4005s
	iters: 300, epoch: 1 | loss: 1.0386814
	speed: 0.2282s/iter; left time: 8351.2828s
Epoch: 1 cost time: 102.7048032283783
Epoch: 1, Steps: 369 | Train Loss: 0.870 Vali Loss: 0.749 Vali Acc: 0.543 Test Loss: 0.749 Test Acc: 0.543
Validation loss decreased (inf --> -0.542842).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8150603
	speed: 1.0031s/iter; left time: 36545.5568s
	iters: 200, epoch: 2 | loss: 0.6587737
	speed: 0.3534s/iter; left time: 12838.1224s
	iters: 300, epoch: 2 | loss: 0.6417179
	speed: 0.3592s/iter; left time: 13013.9799s
Epoch: 2 cost time: 123.8382625579834
Epoch: 2, Steps: 369 | Train Loss: 0.767 Vali Loss: 0.811 Vali Acc: 0.573 Test Loss: 0.811 Test Acc: 0.573
Validation loss decreased (-0.542842 --> -0.572920).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8075895
	speed: 0.9964s/iter; left time: 35932.0244s
	iters: 200, epoch: 3 | loss: 1.0181551
	speed: 0.3216s/iter; left time: 11564.9353s
	iters: 300, epoch: 3 | loss: 0.8389022
	speed: 0.3137s/iter; left time: 11248.9910s
Epoch: 3 cost time: 111.26815938949585
Epoch: 3, Steps: 369 | Train Loss: 0.911 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6453212
	speed: 0.9238s/iter; left time: 32972.6281s
	iters: 200, epoch: 4 | loss: 0.7584621
	speed: 0.3226s/iter; left time: 11482.6505s
	iters: 300, epoch: 4 | loss: 0.7706798
	speed: 0.3040s/iter; left time: 10789.0539s
Epoch: 4 cost time: 110.02963757514954
Epoch: 4, Steps: 369 | Train Loss: 0.860 Vali Loss: 0.813 Vali Acc: 0.500 Test Loss: 0.813 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6919838
	speed: 0.9496s/iter; left time: 33544.2419s
	iters: 200, epoch: 5 | loss: 1.0071018
	speed: 0.3343s/iter; left time: 11776.2466s
	iters: 300, epoch: 5 | loss: 0.7946417
	speed: 0.2725s/iter; left time: 9573.2051s
Epoch: 5 cost time: 116.63227462768555
Epoch: 5, Steps: 369 | Train Loss: 0.828 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6939538
	speed: 1.0165s/iter; left time: 35532.4821s
	iters: 200, epoch: 6 | loss: 0.8123590
	speed: 0.2584s/iter; left time: 9006.7934s
	iters: 300, epoch: 6 | loss: 0.6960592
	speed: 0.3038s/iter; left time: 10558.6306s
Epoch: 6 cost time: 108.52314901351929
Epoch: 6, Steps: 369 | Train Loss: 0.799 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6823323
	speed: 1.0309s/iter; left time: 35656.0412s
	iters: 200, epoch: 7 | loss: 0.7604563
	speed: 0.2970s/iter; left time: 10244.0996s
	iters: 300, epoch: 7 | loss: 0.8040403
	speed: 0.1946s/iter; left time: 6692.7529s
Epoch: 7 cost time: 98.64518904685974
Epoch: 7, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6994501
	speed: 0.9569s/iter; left time: 32741.6373s
	iters: 200, epoch: 8 | loss: 0.6914536
	speed: 0.3353s/iter; left time: 11439.5127s
	iters: 300, epoch: 8 | loss: 0.6890789
	speed: 0.2915s/iter; left time: 9915.5091s
Epoch: 8 cost time: 115.03737568855286
Epoch: 8, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7323703
	speed: 0.9534s/iter; left time: 32270.7622s
	iters: 200, epoch: 9 | loss: 0.6786302
	speed: 0.2978s/iter; left time: 10052.1126s
	iters: 300, epoch: 9 | loss: 0.7534430
	speed: 0.3724s/iter; left time: 12530.4716s
Epoch: 9 cost time: 118.68845558166504
Epoch: 9, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6931095
	speed: 1.0481s/iter; left time: 35090.9995s
	iters: 200, epoch: 10 | loss: 0.6708191
	speed: 0.2927s/iter; left time: 9769.7931s
	iters: 300, epoch: 10 | loss: 0.6772950
	speed: 0.4054s/iter; left time: 13490.5822s
Epoch: 10 cost time: 125.53536438941956
Epoch: 10, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6711686
	speed: 1.1554s/iter; left time: 38255.5985s
	iters: 200, epoch: 11 | loss: 0.7185349
	speed: 0.2799s/iter; left time: 9238.7576s
	iters: 300, epoch: 11 | loss: 0.6276195
	speed: 0.2794s/iter; left time: 9194.3282s
Epoch: 11 cost time: 119.80730175971985
Epoch: 11, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.6934160
	speed: 1.1524s/iter; left time: 37733.2253s
	iters: 200, epoch: 12 | loss: 0.6972104
	speed: 0.3029s/iter; left time: 9886.1044s
	iters: 300, epoch: 12 | loss: 0.6910659
	speed: 0.3475s/iter; left time: 11307.6724s
Epoch: 12 cost time: 121.72970128059387
Epoch: 12, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5729284903518729
model parameter : 11012670
model size : 47.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9911500
	speed: 0.3390s/iter; left time: 12474.6715s
	iters: 200, epoch: 1 | loss: 0.8052121
	speed: 0.2974s/iter; left time: 10913.1997s
	iters: 300, epoch: 1 | loss: 0.9737201
	speed: 0.2276s/iter; left time: 8330.3400s
Epoch: 1 cost time: 107.77372026443481
Epoch: 1, Steps: 369 | Train Loss: 0.899 Vali Loss: 1.130 Vali Acc: 0.502 Test Loss: 1.130 Test Acc: 0.502
Validation loss decreased (inf --> -0.501691).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0190086
	speed: 1.0945s/iter; left time: 39874.1072s
	iters: 200, epoch: 2 | loss: 0.9010566
	speed: 0.3153s/iter; left time: 11457.2327s
	iters: 300, epoch: 2 | loss: 0.4629374
	speed: 0.2924s/iter; left time: 10592.6634s
Epoch: 2 cost time: 114.9993896484375
Epoch: 2, Steps: 369 | Train Loss: 0.782 Vali Loss: 0.632 Vali Acc: 0.666 Test Loss: 0.632 Test Acc: 0.666
Validation loss decreased (-0.501691 --> -0.665998).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7261118
	speed: 1.0235s/iter; left time: 36909.8371s
	iters: 200, epoch: 3 | loss: 1.3098835
	speed: 0.3260s/iter; left time: 11725.3245s
	iters: 300, epoch: 3 | loss: 1.1332735
	speed: 0.3233s/iter; left time: 11595.4756s
Epoch: 3 cost time: 117.3156840801239
Epoch: 3, Steps: 369 | Train Loss: 0.909 Vali Loss: 0.903 Vali Acc: 0.500 Test Loss: 0.903 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.2150007
	speed: 0.9872s/iter; left time: 35237.7280s
	iters: 200, epoch: 4 | loss: 0.8824320
	speed: 0.3369s/iter; left time: 11992.3505s
	iters: 300, epoch: 4 | loss: 0.6712601
	speed: 0.3130s/iter; left time: 11108.2428s
Epoch: 4 cost time: 118.78754138946533
Epoch: 4, Steps: 369 | Train Loss: 0.915 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8302062
	speed: 1.1092s/iter; left time: 39183.2123s
	iters: 200, epoch: 5 | loss: 0.6479840
	speed: 0.3366s/iter; left time: 11857.1972s
	iters: 300, epoch: 5 | loss: 0.7992956
	speed: 0.3091s/iter; left time: 10857.4964s
Epoch: 5 cost time: 125.0604259967804
Epoch: 5, Steps: 369 | Train Loss: 0.858 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6366426
	speed: 1.0216s/iter; left time: 35711.8745s
	iters: 200, epoch: 6 | loss: 1.0906889
	speed: 0.2925s/iter; left time: 10195.1968s
	iters: 300, epoch: 6 | loss: 0.6798393
	speed: 0.3112s/iter; left time: 10814.7953s
Epoch: 6 cost time: 111.97290420532227
Epoch: 6, Steps: 369 | Train Loss: 0.771 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7052487
	speed: 1.1081s/iter; left time: 38325.4084s
	iters: 200, epoch: 7 | loss: 0.7274641
	speed: 0.3619s/iter; left time: 12479.6925s
	iters: 300, epoch: 7 | loss: 0.7479758
	speed: 0.2531s/iter; left time: 8702.8306s
Epoch: 7 cost time: 121.98293733596802
Epoch: 7, Steps: 369 | Train Loss: 0.737 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6905144
	speed: 1.1233s/iter; left time: 38436.7485s
	iters: 200, epoch: 8 | loss: 0.7578813
	speed: 0.3278s/iter; left time: 11185.5840s
	iters: 300, epoch: 8 | loss: 0.6920858
	speed: 0.3245s/iter; left time: 11038.1481s
Epoch: 8 cost time: 115.52343463897705
Epoch: 8, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6495984
	speed: 0.9466s/iter; left time: 32042.9970s
	iters: 200, epoch: 9 | loss: 0.6724510
	speed: 0.3136s/iter; left time: 10584.1282s
	iters: 300, epoch: 9 | loss: 0.7142025
	speed: 0.3359s/iter; left time: 11301.3272s
Epoch: 9 cost time: 120.16415143013
Epoch: 9, Steps: 369 | Train Loss: 0.719 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.7267895
	speed: 1.0178s/iter; left time: 34075.5779s
	iters: 200, epoch: 10 | loss: 0.6592889
	speed: 0.3238s/iter; left time: 10809.1357s
	iters: 300, epoch: 10 | loss: 0.6799189
	speed: 0.3472s/iter; left time: 11555.8288s
Epoch: 10 cost time: 120.80179023742676
Epoch: 10, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7018647
	speed: 1.0258s/iter; left time: 33966.7706s
	iters: 200, epoch: 11 | loss: 0.7154583
	speed: 0.2953s/iter; left time: 9747.7866s
	iters: 300, epoch: 11 | loss: 0.6896543
	speed: 0.2879s/iter; left time: 9475.0388s
Epoch: 11 cost time: 107.07355093955994
Epoch: 11, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7163812
	speed: 1.0277s/iter; left time: 33649.9410s
	iters: 200, epoch: 12 | loss: 0.7245248
	speed: 0.3026s/iter; left time: 9878.3983s
	iters: 300, epoch: 12 | loss: 0.7147955
	speed: 0.3096s/iter; left time: 10074.6318s
Epoch: 12 cost time: 112.7833468914032
Epoch: 12, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6660045402951191
model parameter : 11009598
model size : 47.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2771227
	speed: 0.3423s/iter; left time: 12597.4930s
	iters: 200, epoch: 1 | loss: 0.5513066
	speed: 0.3181s/iter; left time: 11672.9607s
	iters: 300, epoch: 1 | loss: 0.6845155
	speed: 0.3013s/iter; left time: 11027.9648s
Epoch: 1 cost time: 118.24721074104309
Epoch: 1, Steps: 369 | Train Loss: 0.838 Vali Loss: 0.613 Vali Acc: 0.663 Test Loss: 0.613 Test Acc: 0.663
Validation loss decreased (inf --> -0.662877).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4944052
	speed: 1.0375s/iter; left time: 37796.9608s
	iters: 200, epoch: 2 | loss: 0.5390779
	speed: 0.2892s/iter; left time: 10506.2773s
	iters: 300, epoch: 2 | loss: 0.6416402
	speed: 0.3096s/iter; left time: 11216.8942s
Epoch: 2 cost time: 116.03036689758301
Epoch: 2, Steps: 369 | Train Loss: 0.773 Vali Loss: 0.728 Vali Acc: 0.646 Test Loss: 0.728 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7575871
	speed: 1.0367s/iter; left time: 37387.0526s
	iters: 200, epoch: 3 | loss: 0.8453300
	speed: 0.2489s/iter; left time: 8949.5137s
	iters: 300, epoch: 3 | loss: 0.6294657
	speed: 0.3395s/iter; left time: 12177.2718s
Epoch: 3 cost time: 109.0490300655365
Epoch: 3, Steps: 369 | Train Loss: 0.926 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8311695
	speed: 1.0320s/iter; left time: 36836.4894s
	iters: 200, epoch: 4 | loss: 0.7554738
	speed: 0.3336s/iter; left time: 11875.1493s
	iters: 300, epoch: 4 | loss: 0.8659285
	speed: 0.3026s/iter; left time: 10740.2453s
Epoch: 4 cost time: 120.02253890037537
Epoch: 4, Steps: 369 | Train Loss: 0.894 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8554283
	speed: 1.0114s/iter; left time: 35726.4368s
	iters: 200, epoch: 5 | loss: 0.8765935
	speed: 0.3324s/iter; left time: 11710.4197s
	iters: 300, epoch: 5 | loss: 0.7227269
	speed: 0.3571s/iter; left time: 12542.7622s
Epoch: 5 cost time: 123.77045273780823
Epoch: 5, Steps: 369 | Train Loss: 0.842 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7029996
	speed: 0.9421s/iter; left time: 32931.9161s
	iters: 200, epoch: 6 | loss: 0.6964679
	speed: 0.2839s/iter; left time: 9895.0762s
	iters: 300, epoch: 6 | loss: 0.7046351
	speed: 0.3321s/iter; left time: 11540.9641s
Epoch: 6 cost time: 115.89803504943848
Epoch: 6, Steps: 369 | Train Loss: 0.754 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6944346
	speed: 1.0089s/iter; left time: 34893.6126s
	iters: 200, epoch: 7 | loss: 0.6925143
	speed: 0.3149s/iter; left time: 10861.6746s
	iters: 300, epoch: 7 | loss: 0.6758465
	speed: 0.3187s/iter; left time: 10959.9996s
Epoch: 7 cost time: 117.68303179740906
Epoch: 7, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7042233
	speed: 0.9801s/iter; left time: 33536.9469s
	iters: 200, epoch: 8 | loss: 0.6988084
	speed: 0.2449s/iter; left time: 8355.7049s
	iters: 300, epoch: 8 | loss: 1.3720527
	speed: 0.2235s/iter; left time: 7603.9541s
Epoch: 8 cost time: 96.91908979415894
Epoch: 8, Steps: 369 | Train Loss: 0.823 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7524409
	speed: 0.9833s/iter; left time: 33283.6123s
	iters: 200, epoch: 9 | loss: 0.6683121
	speed: 0.3058s/iter; left time: 10319.6250s
	iters: 300, epoch: 9 | loss: 0.7592812
	speed: 0.3035s/iter; left time: 10211.2993s
Epoch: 9 cost time: 112.83947777748108
Epoch: 9, Steps: 369 | Train Loss: 0.761 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6826724
	speed: 0.9455s/iter; left time: 31654.9346s
	iters: 200, epoch: 10 | loss: 0.7820132
	speed: 0.2264s/iter; left time: 7556.0720s
	iters: 300, epoch: 10 | loss: 0.8124666
	speed: 0.3046s/iter; left time: 10136.8667s
Epoch: 10 cost time: 104.81602907180786
Epoch: 10, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6667569
	speed: 0.9768s/iter; left time: 32341.4928s
	iters: 200, epoch: 11 | loss: 0.7412065
	speed: 0.2859s/iter; left time: 9439.2410s
	iters: 300, epoch: 11 | loss: 0.6384973
	speed: 0.2864s/iter; left time: 9427.0299s
Epoch: 11 cost time: 108.5484926700592
Epoch: 11, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.662883087400681
model parameter : 11006526
model size : 47.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9810901
	speed: 0.3192s/iter; left time: 11748.5920s
	iters: 200, epoch: 1 | loss: 0.5873460
	speed: 0.2648s/iter; left time: 9717.9050s
	iters: 300, epoch: 1 | loss: 0.9360535
	speed: 0.2512s/iter; left time: 9193.8539s
Epoch: 1 cost time: 103.11163663864136
Epoch: 1, Steps: 369 | Train Loss: 0.855 Vali Loss: 0.809 Vali Acc: 0.550 Test Loss: 0.809 Test Acc: 0.550
Validation loss decreased (inf --> -0.550219).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5709741
	speed: 0.9290s/iter; left time: 33846.1758s
	iters: 200, epoch: 2 | loss: 0.6445227
	speed: 0.4094s/iter; left time: 14874.4100s
	iters: 300, epoch: 2 | loss: 0.4125736
	speed: 0.3286s/iter; left time: 11904.1447s
Epoch: 2 cost time: 121.81002283096313
Epoch: 2, Steps: 369 | Train Loss: 0.794 Vali Loss: 0.905 Vali Acc: 0.500 Test Loss: 0.905 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8989239
	speed: 0.8406s/iter; left time: 30316.2826s
	iters: 200, epoch: 3 | loss: 0.7752060
	speed: 0.2939s/iter; left time: 10569.7434s
	iters: 300, epoch: 3 | loss: 0.7397560
	speed: 0.3184s/iter; left time: 11419.3567s
Epoch: 3 cost time: 103.04602146148682
Epoch: 3, Steps: 369 | Train Loss: 0.890 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7592434
	speed: 0.9339s/iter; left time: 33333.6401s
	iters: 200, epoch: 4 | loss: 0.6725699
	speed: 0.2973s/iter; left time: 10580.6851s
	iters: 300, epoch: 4 | loss: 0.6027911
	speed: 0.3078s/iter; left time: 10923.4129s
Epoch: 4 cost time: 113.78267216682434
Epoch: 4, Steps: 369 | Train Loss: 0.851 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.7735527
	speed: 0.8895s/iter; left time: 31420.7098s
	iters: 200, epoch: 5 | loss: 0.7721888
	speed: 0.2967s/iter; left time: 10450.9538s
	iters: 300, epoch: 5 | loss: 0.8552573
	speed: 0.2810s/iter; left time: 9871.7602s
Epoch: 5 cost time: 101.11606931686401
Epoch: 5, Steps: 369 | Train Loss: 0.842 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.0574404
	speed: 0.9157s/iter; left time: 32008.9934s
	iters: 200, epoch: 6 | loss: 0.8161315
	speed: 0.2803s/iter; left time: 9770.4878s
	iters: 300, epoch: 6 | loss: 1.2378285
	speed: 0.2701s/iter; left time: 9386.8179s
Epoch: 6 cost time: 94.86941027641296
Epoch: 6, Steps: 369 | Train Loss: 0.869 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6365624
	speed: 0.8488s/iter; left time: 29358.7865s
	iters: 200, epoch: 7 | loss: 0.7938218
	speed: 0.3073s/iter; left time: 10599.4233s
	iters: 300, epoch: 7 | loss: 0.8008858
	speed: 0.2489s/iter; left time: 8558.2077s
Epoch: 7 cost time: 97.49564790725708
Epoch: 7, Steps: 369 | Train Loss: 0.741 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7299679
	speed: 0.8325s/iter; left time: 28486.4564s
	iters: 200, epoch: 8 | loss: 0.7704319
	speed: 0.2465s/iter; left time: 8411.4141s
	iters: 300, epoch: 8 | loss: 0.6854353
	speed: 0.2753s/iter; left time: 9366.6660s
Epoch: 8 cost time: 94.70822429656982
Epoch: 8, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7042984
	speed: 0.8555s/iter; left time: 28958.0797s
	iters: 200, epoch: 9 | loss: 0.6400592
	speed: 0.2686s/iter; left time: 9065.8328s
	iters: 300, epoch: 9 | loss: 0.6932940
	speed: 0.2506s/iter; left time: 8433.5176s
Epoch: 9 cost time: 95.36177229881287
Epoch: 9, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6983079
	speed: 0.9265s/iter; left time: 31018.8151s
	iters: 200, epoch: 10 | loss: 0.6787778
	speed: 0.2635s/iter; left time: 8795.1968s
	iters: 300, epoch: 10 | loss: 0.6650863
	speed: 0.2812s/iter; left time: 9357.4435s
Epoch: 10 cost time: 101.30047345161438
Epoch: 10, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.5780253
	speed: 0.8444s/iter; left time: 27957.5849s
	iters: 200, epoch: 11 | loss: 0.7041020
	speed: 0.2709s/iter; left time: 8943.2347s
	iters: 300, epoch: 11 | loss: 0.6614877
	speed: 0.2732s/iter; left time: 8990.0937s
Epoch: 11 cost time: 99.18623638153076
Epoch: 11, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5502270147559591
model parameter : 11003454
model size : 47.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2249835
	speed: 0.2975s/iter; left time: 10948.1148s
	iters: 200, epoch: 1 | loss: 0.7255231
	speed: 0.2314s/iter; left time: 8491.8451s
	iters: 300, epoch: 1 | loss: 1.0122818
	speed: 0.2534s/iter; left time: 9275.4287s
Epoch: 1 cost time: 93.27153086662292
Epoch: 1, Steps: 369 | Train Loss: 0.852 Vali Loss: 0.906 Vali Acc: 0.520 Test Loss: 0.906 Test Acc: 0.520
Validation loss decreased (inf --> -0.519855).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6181595
	speed: 0.8749s/iter; left time: 31874.9256s
	iters: 200, epoch: 2 | loss: 1.0651311
	speed: 0.2751s/iter; left time: 9996.2687s
	iters: 300, epoch: 2 | loss: 1.9311054
	speed: 0.2633s/iter; left time: 9541.3492s
Epoch: 2 cost time: 99.25123262405396
Epoch: 2, Steps: 369 | Train Loss: 0.786 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7718892
	speed: 0.8348s/iter; left time: 30105.4415s
	iters: 200, epoch: 3 | loss: 0.8232909
	speed: 0.2807s/iter; left time: 10093.2948s
	iters: 300, epoch: 3 | loss: 0.7224395
	speed: 0.2940s/iter; left time: 10542.6691s
Epoch: 3 cost time: 103.1586856842041
Epoch: 3, Steps: 369 | Train Loss: 0.907 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9014847
	speed: 0.8842s/iter; left time: 31558.9072s
	iters: 200, epoch: 4 | loss: 1.0719166
	speed: 0.1888s/iter; left time: 6720.4191s
	iters: 300, epoch: 4 | loss: 0.6177009
	speed: 0.2536s/iter; left time: 9000.9982s
Epoch: 4 cost time: 88.32838797569275
Epoch: 4, Steps: 369 | Train Loss: 0.853 Vali Loss: 0.810 Vali Acc: 0.500 Test Loss: 0.810 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.4271796
	speed: 0.8837s/iter; left time: 31218.3318s
	iters: 200, epoch: 5 | loss: 0.6423947
	speed: 0.2553s/iter; left time: 8993.1839s
	iters: 300, epoch: 5 | loss: 0.9594475
	speed: 0.2597s/iter; left time: 9120.2079s
Epoch: 5 cost time: 93.9076178073883
Epoch: 5, Steps: 369 | Train Loss: 0.859 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7136595
	speed: 0.8525s/iter; left time: 29800.5953s
	iters: 200, epoch: 6 | loss: 0.7643410
	speed: 0.2519s/iter; left time: 8780.9177s
	iters: 300, epoch: 6 | loss: 1.4736650
	speed: 0.2453s/iter; left time: 8526.1854s
Epoch: 6 cost time: 94.95258402824402
Epoch: 6, Steps: 369 | Train Loss: 0.827 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.8161107
	speed: 0.8640s/iter; left time: 29882.7880s
	iters: 200, epoch: 7 | loss: 0.6192029
	speed: 0.2868s/iter; left time: 9891.5870s
	iters: 300, epoch: 7 | loss: 0.6965352
	speed: 0.2397s/iter; left time: 8243.0400s
Epoch: 7 cost time: 99.77547216415405
Epoch: 7, Steps: 369 | Train Loss: 0.816 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7400700
	speed: 0.7914s/iter; left time: 27081.5033s
	iters: 200, epoch: 8 | loss: 0.7123429
	speed: 0.2429s/iter; left time: 8287.8429s
	iters: 300, epoch: 8 | loss: 0.7686935
	speed: 0.2749s/iter; left time: 9350.6810s
Epoch: 8 cost time: 90.69816422462463
Epoch: 8, Steps: 369 | Train Loss: 0.745 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6813074
	speed: 0.7677s/iter; left time: 25987.3464s
	iters: 200, epoch: 9 | loss: 0.8149087
	speed: 0.2143s/iter; left time: 7231.2396s
	iters: 300, epoch: 9 | loss: 0.7219931
	speed: 0.2362s/iter; left time: 7947.3671s
Epoch: 9 cost time: 82.88188886642456
Epoch: 9, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7728665
	speed: 0.8249s/iter; left time: 27616.7777s
	iters: 200, epoch: 10 | loss: 0.7293898
	speed: 0.2180s/iter; left time: 7275.9052s
	iters: 300, epoch: 10 | loss: 0.6938365
	speed: 0.2020s/iter; left time: 6722.6490s
Epoch: 10 cost time: 83.69228672981262
Epoch: 10, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6737253
	speed: 0.8057s/iter; left time: 26676.5341s
	iters: 200, epoch: 11 | loss: 0.7315636
	speed: 0.2307s/iter; left time: 7615.9139s
	iters: 300, epoch: 11 | loss: 0.6748815
	speed: 0.2643s/iter; left time: 8697.8846s
Epoch: 11 cost time: 90.8325572013855
Epoch: 11, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5198637911464246
model parameter : 10421694
model size : 44.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3792742
	speed: 0.2711s/iter; left time: 9975.8530s
	iters: 200, epoch: 1 | loss: 1.6682698
	speed: 0.2502s/iter; left time: 9182.7913s
	iters: 300, epoch: 1 | loss: 1.0473894
	speed: 0.2508s/iter; left time: 9180.7854s
Epoch: 1 cost time: 93.83624792098999
Epoch: 1, Steps: 369 | Train Loss: 0.974 Vali Loss: 0.738 Vali Acc: 0.651 Test Loss: 0.738 Test Acc: 0.651
Validation loss decreased (inf --> -0.650674).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0644640
	speed: 0.8564s/iter; left time: 31201.5257s
	iters: 200, epoch: 2 | loss: 0.7205881
	speed: 0.2539s/iter; left time: 9224.3624s
	iters: 300, epoch: 2 | loss: 0.6986488
	speed: 0.2372s/iter; left time: 8593.9730s
Epoch: 2 cost time: 87.38936686515808
Epoch: 2, Steps: 369 | Train Loss: 0.790 Vali Loss: 0.683 Vali Acc: 0.592 Test Loss: 0.683 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2738171
	speed: 0.8559s/iter; left time: 30866.5636s
	iters: 200, epoch: 3 | loss: 0.6599181
	speed: 0.2639s/iter; left time: 9491.8663s
	iters: 300, epoch: 3 | loss: 0.7973992
	speed: 0.2529s/iter; left time: 9068.6917s
Epoch: 3 cost time: 95.05427956581116
Epoch: 3, Steps: 369 | Train Loss: 0.845 Vali Loss: 1.462 Vali Acc: 0.500 Test Loss: 1.462 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9761727
	speed: 0.8922s/iter; left time: 31847.4301s
	iters: 200, epoch: 4 | loss: 0.9371594
	speed: 0.3012s/iter; left time: 10719.7329s
	iters: 300, epoch: 4 | loss: 1.0666764
	speed: 0.2680s/iter; left time: 9513.4426s
Epoch: 4 cost time: 103.37861752510071
Epoch: 4, Steps: 369 | Train Loss: 0.830 Vali Loss: 1.068 Vali Acc: 0.500 Test Loss: 1.068 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.2566985
	speed: 0.8446s/iter; left time: 29835.4252s
	iters: 200, epoch: 5 | loss: 0.6649592
	speed: 0.2096s/iter; left time: 7384.6286s
	iters: 300, epoch: 5 | loss: 0.6530190
	speed: 0.2475s/iter; left time: 8693.3651s
Epoch: 5 cost time: 85.75253129005432
Epoch: 5, Steps: 369 | Train Loss: 0.794 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7169396
	speed: 0.8595s/iter; left time: 30044.6783s
	iters: 200, epoch: 6 | loss: 0.7256250
	speed: 0.2591s/iter; left time: 9029.6341s
	iters: 300, epoch: 6 | loss: 0.6668276
	speed: 0.2315s/iter; left time: 8045.8855s
Epoch: 6 cost time: 92.98682379722595
Epoch: 6, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7411316
	speed: 0.8739s/iter; left time: 30224.6947s
	iters: 200, epoch: 7 | loss: 0.5994910
	speed: 0.2534s/iter; left time: 8738.8087s
	iters: 300, epoch: 7 | loss: 0.6846618
	speed: 0.2615s/iter; left time: 8993.8777s
Epoch: 7 cost time: 94.74860644340515
Epoch: 7, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6858569
	speed: 0.8763s/iter; left time: 29985.1794s
	iters: 200, epoch: 8 | loss: 0.7008236
	speed: 0.2879s/iter; left time: 9824.2517s
	iters: 300, epoch: 8 | loss: 0.6877793
	speed: 0.2585s/iter; left time: 8793.8665s
Epoch: 8 cost time: 97.65962886810303
Epoch: 8, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6716392
	speed: 0.8399s/iter; left time: 28429.6581s
	iters: 200, epoch: 9 | loss: 0.9749582
	speed: 0.2234s/iter; left time: 7539.2876s
	iters: 300, epoch: 9 | loss: 0.6943381
	speed: 0.2529s/iter; left time: 8510.8701s
Epoch: 9 cost time: 90.72663593292236
Epoch: 9, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6936284
	speed: 0.9164s/iter; left time: 30680.7653s
	iters: 200, epoch: 10 | loss: 0.6637627
	speed: 0.1744s/iter; left time: 5822.6632s
	iters: 300, epoch: 10 | loss: 0.6978135
	speed: 0.2200s/iter; left time: 7322.8842s
Epoch: 10 cost time: 79.95085883140564
Epoch: 10, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6841186
	speed: 0.8701s/iter; left time: 28810.9193s
	iters: 200, epoch: 11 | loss: 0.7097722
	speed: 0.2044s/iter; left time: 6748.6772s
	iters: 300, epoch: 11 | loss: 0.7095993
	speed: 0.2743s/iter; left time: 9028.9327s
Epoch: 11 cost time: 97.56432867050171
Epoch: 11, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6506810442678774
model parameter : 10418622
model size : 44.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3557702
	speed: 0.3165s/iter; left time: 11648.9629s
	iters: 200, epoch: 1 | loss: 0.3711435
	speed: 0.2761s/iter; left time: 10132.7745s
	iters: 300, epoch: 1 | loss: 0.7163869
	speed: 0.2919s/iter; left time: 10682.6055s
Epoch: 1 cost time: 110.8620388507843
Epoch: 1, Steps: 369 | Train Loss: 0.899 Vali Loss: 0.651 Vali Acc: 0.627 Test Loss: 0.651 Test Acc: 0.627
Validation loss decreased (inf --> -0.627122).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6802800
	speed: 0.9158s/iter; left time: 33365.8178s
	iters: 200, epoch: 2 | loss: 0.6680511
	speed: 0.3009s/iter; left time: 10932.2475s
	iters: 300, epoch: 2 | loss: 0.8368818
	speed: 0.3027s/iter; left time: 10968.6218s
Epoch: 2 cost time: 103.9193971157074
Epoch: 2, Steps: 369 | Train Loss: 0.831 Vali Loss: 0.879 Vali Acc: 0.500 Test Loss: 0.879 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8765643
	speed: 0.9886s/iter; left time: 35652.7607s
	iters: 200, epoch: 3 | loss: 0.6767401
	speed: 0.3019s/iter; left time: 10855.4546s
	iters: 300, epoch: 3 | loss: 0.6380932
	speed: 0.3401s/iter; left time: 12195.8835s
Epoch: 3 cost time: 117.46106147766113
Epoch: 3, Steps: 369 | Train Loss: 0.866 Vali Loss: 0.885 Vali Acc: 0.500 Test Loss: 0.885 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6865107
	speed: 1.0460s/iter; left time: 37336.5030s
	iters: 200, epoch: 4 | loss: 0.7126775
	speed: 0.2257s/iter; left time: 8033.0067s
	iters: 300, epoch: 4 | loss: 0.6356825
	speed: 0.2561s/iter; left time: 9090.7380s
Epoch: 4 cost time: 100.73863816261292
Epoch: 4, Steps: 369 | Train Loss: 0.851 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.7219078
	speed: 1.0064s/iter; left time: 35552.7190s
	iters: 200, epoch: 5 | loss: 0.9503045
	speed: 0.3101s/iter; left time: 10923.7256s
	iters: 300, epoch: 5 | loss: 0.7969731
	speed: 0.2889s/iter; left time: 10146.7282s
Epoch: 5 cost time: 113.32388710975647
Epoch: 5, Steps: 369 | Train Loss: 0.771 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7121107
	speed: 0.9954s/iter; left time: 34795.6999s
	iters: 200, epoch: 6 | loss: 0.7462106
	speed: 0.1961s/iter; left time: 6836.1248s
	iters: 300, epoch: 6 | loss: 0.7373372
	speed: 0.2972s/iter; left time: 10328.0070s
Epoch: 6 cost time: 101.15833640098572
Epoch: 6, Steps: 369 | Train Loss: 0.736 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7091268
	speed: 0.9763s/iter; left time: 33766.2764s
	iters: 200, epoch: 7 | loss: 0.6132987
	speed: 0.2220s/iter; left time: 7655.5792s
	iters: 300, epoch: 7 | loss: 0.6975098
	speed: 0.2700s/iter; left time: 9284.4600s
Epoch: 7 cost time: 98.51451015472412
Epoch: 7, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7473190
	speed: 1.0042s/iter; left time: 34360.6851s
	iters: 200, epoch: 8 | loss: 0.6715972
	speed: 0.2812s/iter; left time: 9595.5613s
	iters: 300, epoch: 8 | loss: 0.7467176
	speed: 0.3130s/iter; left time: 10647.9617s
Epoch: 8 cost time: 110.25310134887695
Epoch: 8, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7945995
	speed: 0.9675s/iter; left time: 32748.8398s
	iters: 200, epoch: 9 | loss: 0.6961908
	speed: 0.2016s/iter; left time: 6805.0394s
	iters: 300, epoch: 9 | loss: 0.7059642
	speed: 0.2830s/iter; left time: 9521.4770s
Epoch: 9 cost time: 99.02887845039368
Epoch: 9, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6879670
	speed: 1.0088s/iter; left time: 33773.0257s
	iters: 200, epoch: 10 | loss: 0.6672716
	speed: 0.2925s/iter; left time: 9762.2396s
	iters: 300, epoch: 10 | loss: 0.6817213
	speed: 0.2719s/iter; left time: 9049.4750s
Epoch: 10 cost time: 105.06725764274597
Epoch: 10, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6996182
	speed: 0.9390s/iter; left time: 31092.1839s
	iters: 200, epoch: 11 | loss: 0.6962513
	speed: 0.3245s/iter; left time: 10713.6895s
	iters: 300, epoch: 11 | loss: 0.6800238
	speed: 0.2991s/iter; left time: 9842.0518s
Epoch: 11 cost time: 115.88934254646301
Epoch: 11, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6271282633371169
model parameter : 10415550
model size : 44.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6624827
	speed: 0.2428s/iter; left time: 8934.8523s
	iters: 200, epoch: 1 | loss: 1.0172896
	speed: 0.2467s/iter; left time: 9053.2507s
	iters: 300, epoch: 1 | loss: 0.6444715
	speed: 0.2519s/iter; left time: 9220.5521s
Epoch: 1 cost time: 92.7659924030304
Epoch: 1, Steps: 369 | Train Loss: 0.850 Vali Loss: 1.152 Vali Acc: 0.576 Test Loss: 1.152 Test Acc: 0.576
Validation loss decreased (inf --> -0.576322).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6365250
	speed: 0.9540s/iter; left time: 34754.8358s
	iters: 200, epoch: 2 | loss: 0.7013124
	speed: 0.1914s/iter; left time: 6955.1914s
	iters: 300, epoch: 2 | loss: 1.0264788
	speed: 0.2419s/iter; left time: 8764.7484s
Epoch: 2 cost time: 93.60041546821594
Epoch: 2, Steps: 369 | Train Loss: 0.792 Vali Loss: 1.241 Vali Acc: 0.504 Test Loss: 1.241 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7725638
	speed: 0.9100s/iter; left time: 32818.0997s
	iters: 200, epoch: 3 | loss: 0.8747702
	speed: 0.2872s/iter; left time: 10328.6217s
	iters: 300, epoch: 3 | loss: 0.6089967
	speed: 0.2286s/iter; left time: 8198.4999s
Epoch: 3 cost time: 93.30700302124023
Epoch: 3, Steps: 369 | Train Loss: 0.858 Vali Loss: 0.951 Vali Acc: 0.500 Test Loss: 0.951 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7667671
	speed: 0.8733s/iter; left time: 31172.2337s
	iters: 200, epoch: 4 | loss: 0.8390025
	speed: 0.2690s/iter; left time: 9573.7488s
	iters: 300, epoch: 4 | loss: 1.3678297
	speed: 0.2735s/iter; left time: 9705.8829s
Epoch: 4 cost time: 101.46967554092407
Epoch: 4, Steps: 369 | Train Loss: 0.833 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6959759
	speed: 0.9429s/iter; left time: 33309.1849s
	iters: 200, epoch: 5 | loss: 0.8601928
	speed: 0.2306s/iter; left time: 8121.9919s
	iters: 300, epoch: 5 | loss: 1.1502882
	speed: 0.2147s/iter; left time: 7540.4579s
Epoch: 5 cost time: 92.17057490348816
Epoch: 5, Steps: 369 | Train Loss: 0.777 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7211520
	speed: 0.9077s/iter; left time: 31731.1858s
	iters: 200, epoch: 6 | loss: 0.7016642
	speed: 0.2240s/iter; left time: 7807.3333s
	iters: 300, epoch: 6 | loss: 0.6650983
	speed: 0.2593s/iter; left time: 9012.7647s
Epoch: 6 cost time: 89.21997332572937
Epoch: 6, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.772 Vali Acc: 0.500 Test Loss: 0.772 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7314118
	speed: 0.8775s/iter; left time: 30349.6661s
	iters: 200, epoch: 7 | loss: 0.7588338
	speed: 0.2198s/iter; left time: 7578.8386s
	iters: 300, epoch: 7 | loss: 0.7422993
	speed: 0.1929s/iter; left time: 6634.3037s
Epoch: 7 cost time: 90.85231232643127
Epoch: 7, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6773077
	speed: 0.9249s/iter; left time: 31647.4402s
	iters: 200, epoch: 8 | loss: 0.7368448
	speed: 0.2587s/iter; left time: 8824.7885s
	iters: 300, epoch: 8 | loss: 0.7003837
	speed: 0.2728s/iter; left time: 9278.5955s
Epoch: 8 cost time: 98.6675226688385
Epoch: 8, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7162634
	speed: 0.8470s/iter; left time: 28671.1755s
	iters: 200, epoch: 9 | loss: 0.6788418
	speed: 0.2514s/iter; left time: 8484.6778s
	iters: 300, epoch: 9 | loss: 0.6815497
	speed: 0.2693s/iter; left time: 9060.0711s
Epoch: 9 cost time: 96.55091667175293
Epoch: 9, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7063593
	speed: 0.7930s/iter; left time: 26550.1664s
	iters: 200, epoch: 10 | loss: 0.7113690
	speed: 0.2646s/iter; left time: 8833.2929s
	iters: 300, epoch: 10 | loss: 0.7014156
	speed: 0.2735s/iter; left time: 9101.1849s
Epoch: 10 cost time: 91.34032535552979
Epoch: 10, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.7110655
	speed: 0.9086s/iter; left time: 30083.5489s
	iters: 200, epoch: 11 | loss: 0.7055099
	speed: 0.2800s/iter; left time: 9243.9670s
	iters: 300, epoch: 11 | loss: 0.6768529
	speed: 0.2785s/iter; left time: 9164.2429s
Epoch: 11 cost time: 97.93716549873352
Epoch: 11, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5763337116912599
model parameter : 10412478
model size : 44.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4245470
	speed: 0.2714s/iter; left time: 9987.0602s
	iters: 200, epoch: 1 | loss: 0.6758409
	speed: 0.2094s/iter; left time: 7683.8212s
	iters: 300, epoch: 1 | loss: 2.1224051
	speed: 0.2344s/iter; left time: 8578.8768s
Epoch: 1 cost time: 88.56034064292908
Epoch: 1, Steps: 369 | Train Loss: 0.812 Vali Loss: 1.372 Vali Acc: 0.501 Test Loss: 1.372 Test Acc: 0.501
Validation loss decreased (inf --> -0.500838).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4182750
	speed: 0.7050s/iter; left time: 25684.0204s
	iters: 200, epoch: 2 | loss: 0.6855854
	speed: 0.2204s/iter; left time: 8007.5287s
	iters: 300, epoch: 2 | loss: 2.0392745
	speed: 0.2360s/iter; left time: 8550.3321s
Epoch: 2 cost time: 80.21310663223267
Epoch: 2, Steps: 369 | Train Loss: 0.731 Vali Loss: 1.095 Vali Acc: 0.505 Test Loss: 1.095 Test Acc: 0.505
Validation loss decreased (-0.500838 --> -0.504529).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8595170
	speed: 0.8090s/iter; left time: 29176.2966s
	iters: 200, epoch: 3 | loss: 0.7314699
	speed: 0.2137s/iter; left time: 7686.4047s
	iters: 300, epoch: 3 | loss: 0.7357572
	speed: 0.2177s/iter; left time: 7808.3047s
Epoch: 3 cost time: 81.31411337852478
Epoch: 3, Steps: 369 | Train Loss: 0.728 Vali Loss: 0.731 Vali Acc: 0.639 Test Loss: 0.731 Test Acc: 0.639
Validation loss decreased (-0.504529 --> -0.639323).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6895772
	speed: 0.7676s/iter; left time: 27398.3968s
	iters: 200, epoch: 4 | loss: 0.5596318
	speed: 0.2092s/iter; left time: 7447.3579s
	iters: 300, epoch: 4 | loss: 0.7683518
	speed: 0.2317s/iter; left time: 8223.9698s
Epoch: 4 cost time: 84.20663690567017
Epoch: 4, Steps: 369 | Train Loss: 0.745 Vali Loss: 0.650 Vali Acc: 0.628 Test Loss: 0.650 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5683705
	speed: 0.7479s/iter; left time: 26418.9352s
	iters: 200, epoch: 5 | loss: 0.9579974
	speed: 0.2525s/iter; left time: 8893.4285s
	iters: 300, epoch: 5 | loss: 0.6695842
	speed: 0.2720s/iter; left time: 9553.5547s
Epoch: 5 cost time: 91.63603138923645
Epoch: 5, Steps: 369 | Train Loss: 0.785 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6975827
	speed: 0.8411s/iter; left time: 29400.6427s
	iters: 200, epoch: 6 | loss: 0.6797411
	speed: 0.2166s/iter; left time: 7551.0934s
	iters: 300, epoch: 6 | loss: 0.6558604
	speed: 0.1915s/iter; left time: 6654.2093s
Epoch: 6 cost time: 84.8945939540863
Epoch: 6, Steps: 369 | Train Loss: 0.738 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7673162
	speed: 0.8224s/iter; left time: 28442.9380s
	iters: 200, epoch: 7 | loss: 0.7355087
	speed: 0.2401s/iter; left time: 8281.8378s
	iters: 300, epoch: 7 | loss: 0.7334890
	speed: 0.2090s/iter; left time: 7185.2039s
Epoch: 7 cost time: 79.57907700538635
Epoch: 7, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6946226
	speed: 0.7863s/iter; left time: 26906.5440s
	iters: 200, epoch: 8 | loss: 0.7272760
	speed: 0.2535s/iter; left time: 8650.2090s
	iters: 300, epoch: 8 | loss: 0.6920896
	speed: 0.2943s/iter; left time: 10010.5742s
Epoch: 8 cost time: 95.39715576171875
Epoch: 8, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6579410
	speed: 0.7902s/iter; left time: 26747.2395s
	iters: 200, epoch: 9 | loss: 0.6920161
	speed: 0.2535s/iter; left time: 8557.0339s
	iters: 300, epoch: 9 | loss: 0.6752580
	speed: 0.2489s/iter; left time: 8376.4162s
Epoch: 9 cost time: 89.90329575538635
Epoch: 9, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.6842294
	speed: 0.8349s/iter; left time: 27953.9084s
	iters: 200, epoch: 10 | loss: 0.7512418
	speed: 0.2128s/iter; left time: 7102.6109s
	iters: 300, epoch: 10 | loss: 0.7258658
	speed: 0.2256s/iter; left time: 7507.9941s
Epoch: 10 cost time: 82.06699752807617
Epoch: 10, Steps: 369 | Train Loss: 0.773 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6857713
	speed: 0.7816s/iter; left time: 25878.9425s
	iters: 200, epoch: 11 | loss: 0.6599234
	speed: 0.2520s/iter; left time: 8318.4222s
	iters: 300, epoch: 11 | loss: 0.7667135
	speed: 0.2417s/iter; left time: 7953.9769s
Epoch: 11 cost time: 92.9199743270874
Epoch: 11, Steps: 369 | Train Loss: 0.719 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.7377147
	speed: 0.7938s/iter; left time: 25990.9467s
	iters: 200, epoch: 12 | loss: 0.6966068
	speed: 0.1639s/iter; left time: 5349.2800s
	iters: 300, epoch: 12 | loss: 0.7628989
	speed: 0.2241s/iter; left time: 7293.7923s
Epoch: 12 cost time: 75.84422969818115
Epoch: 12, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.7001491
	speed: 0.8102s/iter; left time: 26230.0510s
	iters: 200, epoch: 13 | loss: 0.7693022
	speed: 0.2081s/iter; left time: 6715.6583s
	iters: 300, epoch: 13 | loss: 0.6654835
	speed: 0.1875s/iter; left time: 6030.8814s
Epoch: 13 cost time: 79.36265683174133
Epoch: 13, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6393303064699205
model parameter : 4924606
model size : 21.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1244022
	speed: 0.2889s/iter; left time: 10630.7347s
	iters: 200, epoch: 1 | loss: 0.6407380
	speed: 0.2198s/iter; left time: 8065.5217s
	iters: 300, epoch: 1 | loss: 0.5982321
	speed: 0.1724s/iter; left time: 6308.5495s
Epoch: 1 cost time: 81.87067151069641
Epoch: 1, Steps: 369 | Train Loss: 0.819 Vali Loss: 0.856 Vali Acc: 0.581 Test Loss: 0.856 Test Acc: 0.581
Validation loss decreased (inf --> -0.580865).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6844989
	speed: 0.7494s/iter; left time: 27302.0454s
	iters: 200, epoch: 2 | loss: 0.9645278
	speed: 0.2634s/iter; left time: 9571.0632s
	iters: 300, epoch: 2 | loss: 0.7957960
	speed: 0.2082s/iter; left time: 7544.4104s
Epoch: 2 cost time: 83.64505887031555
Epoch: 2, Steps: 369 | Train Loss: 0.743 Vali Loss: 0.866 Vali Acc: 0.512 Test Loss: 0.866 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0752863
	speed: 0.7724s/iter; left time: 27853.5896s
	iters: 200, epoch: 3 | loss: 0.6812094
	speed: 0.2235s/iter; left time: 8036.6547s
	iters: 300, epoch: 3 | loss: 0.6854776
	speed: 0.2185s/iter; left time: 7837.1842s
Epoch: 3 cost time: 83.99403262138367
Epoch: 3, Steps: 369 | Train Loss: 0.755 Vali Loss: 0.655 Vali Acc: 0.621 Test Loss: 0.655 Test Acc: 0.621
Validation loss decreased (-0.580865 --> -0.621446).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9273032
	speed: 0.7762s/iter; left time: 27706.9297s
	iters: 200, epoch: 4 | loss: 0.8079599
	speed: 0.2072s/iter; left time: 7376.3307s
	iters: 300, epoch: 4 | loss: 0.9722264
	speed: 0.2300s/iter; left time: 8164.2399s
Epoch: 4 cost time: 84.3881368637085
Epoch: 4, Steps: 369 | Train Loss: 0.847 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7157404
	speed: 0.8140s/iter; left time: 28753.7485s
	iters: 200, epoch: 5 | loss: 1.0249137
	speed: 0.2342s/iter; left time: 8250.9050s
	iters: 300, epoch: 5 | loss: 0.7036365
	speed: 0.2439s/iter; left time: 8566.1824s
Epoch: 5 cost time: 89.02148723602295
Epoch: 5, Steps: 369 | Train Loss: 0.822 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7680184
	speed: 0.7510s/iter; left time: 26251.2923s
	iters: 200, epoch: 6 | loss: 0.7760047
	speed: 0.2025s/iter; left time: 7056.6683s
	iters: 300, epoch: 6 | loss: 0.9117579
	speed: 0.2075s/iter; left time: 7212.1594s
Epoch: 6 cost time: 77.82995390892029
Epoch: 6, Steps: 369 | Train Loss: 0.778 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6993424
	speed: 0.7483s/iter; left time: 25879.7877s
	iters: 200, epoch: 7 | loss: 0.6445528
	speed: 0.2040s/iter; left time: 7034.5505s
	iters: 300, epoch: 7 | loss: 0.7209792
	speed: 0.2215s/iter; left time: 7616.6178s
Epoch: 7 cost time: 77.42078614234924
Epoch: 7, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6923793
	speed: 0.7202s/iter; left time: 24644.3427s
	iters: 200, epoch: 8 | loss: 0.6625050
	speed: 0.1806s/iter; left time: 6160.1879s
	iters: 300, epoch: 8 | loss: 0.6711022
	speed: 0.2451s/iter; left time: 8336.7153s
Epoch: 8 cost time: 76.277010679245
Epoch: 8, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.7116359
	speed: 0.7895s/iter; left time: 26722.4505s
	iters: 200, epoch: 9 | loss: 0.7175657
	speed: 0.2196s/iter; left time: 7412.0277s
	iters: 300, epoch: 9 | loss: 0.7405257
	speed: 0.1927s/iter; left time: 6482.9955s
Epoch: 9 cost time: 75.27208852767944
Epoch: 9, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.6924961
	speed: 0.7345s/iter; left time: 24592.4777s
	iters: 200, epoch: 10 | loss: 0.7111450
	speed: 0.2335s/iter; left time: 7794.3225s
	iters: 300, epoch: 10 | loss: 0.6820303
	speed: 0.1964s/iter; left time: 6537.1606s
Epoch: 10 cost time: 78.85835838317871
Epoch: 10, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.7130235
	speed: 0.7010s/iter; left time: 23209.3195s
	iters: 200, epoch: 11 | loss: 0.7729123
	speed: 0.2260s/iter; left time: 7458.8503s
	iters: 300, epoch: 11 | loss: 0.7008195
	speed: 0.2371s/iter; left time: 7802.8896s
Epoch: 11 cost time: 82.91559076309204
Epoch: 11, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.6485128
	speed: 0.7628s/iter; left time: 24976.5864s
	iters: 200, epoch: 12 | loss: 0.7112916
	speed: 0.2249s/iter; left time: 7342.6803s
	iters: 300, epoch: 12 | loss: 0.6736621
	speed: 0.2148s/iter; left time: 6990.0280s
Epoch: 12 cost time: 80.70958662033081
Epoch: 12, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6954584
	speed: 0.7379s/iter; left time: 23889.4163s
	iters: 200, epoch: 13 | loss: 0.7283353
	speed: 0.2322s/iter; left time: 7493.3904s
	iters: 300, epoch: 13 | loss: 0.7073579
	speed: 0.2242s/iter; left time: 7212.0679s
Epoch: 13 cost time: 83.77921676635742
Epoch: 13, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6214528944381384
model parameter : 4923070
model size : 21.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6224778
	speed: 0.2537s/iter; left time: 9336.7301s
	iters: 200, epoch: 1 | loss: 1.1221108
	speed: 0.2197s/iter; left time: 8064.8198s
	iters: 300, epoch: 1 | loss: 0.6619380
	speed: 0.2081s/iter; left time: 7615.0427s
Epoch: 1 cost time: 82.81954169273376
Epoch: 1, Steps: 369 | Train Loss: 0.821 Vali Loss: 0.703 Vali Acc: 0.642 Test Loss: 0.703 Test Acc: 0.642
Validation loss decreased (inf --> -0.642161).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5045996
	speed: 0.6960s/iter; left time: 25356.9326s
	iters: 200, epoch: 2 | loss: 0.5830334
	speed: 0.2059s/iter; left time: 7480.2695s
	iters: 300, epoch: 2 | loss: 1.3265446
	speed: 0.2263s/iter; left time: 8200.8663s
Epoch: 2 cost time: 81.5468077659607
Epoch: 2, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.642 Vali Acc: 0.650 Test Loss: 0.642 Test Acc: 0.650
Validation loss decreased (-0.642161 --> -0.650107).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6212109
	speed: 0.7341s/iter; left time: 26472.6433s
	iters: 200, epoch: 3 | loss: 0.5845853
	speed: 0.1942s/iter; left time: 6984.0543s
	iters: 300, epoch: 3 | loss: 0.8377202
	speed: 0.1639s/iter; left time: 5878.7160s
Epoch: 3 cost time: 72.6902403831482
Epoch: 3, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.670 Vali Acc: 0.634 Test Loss: 0.670 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5531939
	speed: 0.7922s/iter; left time: 28275.8181s
	iters: 200, epoch: 4 | loss: 1.1133001
	speed: 0.2320s/iter; left time: 8258.2369s
	iters: 300, epoch: 4 | loss: 0.6199183
	speed: 0.1843s/iter; left time: 6541.0173s
Epoch: 4 cost time: 78.29639172554016
Epoch: 4, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.690 Vali Acc: 0.590 Test Loss: 0.690 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5568139
	speed: 0.7182s/iter; left time: 25369.6600s
	iters: 200, epoch: 5 | loss: 0.7676529
	speed: 0.2122s/iter; left time: 7474.0781s
	iters: 300, epoch: 5 | loss: 0.7115421
	speed: 0.1614s/iter; left time: 5670.9039s
Epoch: 5 cost time: 71.53243589401245
Epoch: 5, Steps: 369 | Train Loss: 0.745 Vali Loss: 0.693 Vali Acc: 0.507 Test Loss: 0.693 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7059609
	speed: 0.6949s/iter; left time: 24290.7388s
	iters: 200, epoch: 6 | loss: 0.7203242
	speed: 0.2121s/iter; left time: 7393.0601s
	iters: 300, epoch: 6 | loss: 0.7012084
	speed: 0.2068s/iter; left time: 7188.1458s
Epoch: 6 cost time: 77.76257514953613
Epoch: 6, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7543570
	speed: 0.7050s/iter; left time: 24383.0231s
	iters: 200, epoch: 7 | loss: 0.7624633
	speed: 0.2332s/iter; left time: 8042.7407s
	iters: 300, epoch: 7 | loss: 0.8459294
	speed: 0.2258s/iter; left time: 7765.4412s
Epoch: 7 cost time: 81.24285435676575
Epoch: 7, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7231866
	speed: 0.6633s/iter; left time: 22696.1482s
	iters: 200, epoch: 8 | loss: 0.6889455
	speed: 0.2092s/iter; left time: 7138.7822s
	iters: 300, epoch: 8 | loss: 0.7130305
	speed: 0.1876s/iter; left time: 6380.5841s
Epoch: 8 cost time: 74.14311623573303
Epoch: 8, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6770531
	speed: 0.7438s/iter; left time: 25176.2036s
	iters: 200, epoch: 9 | loss: 0.7201459
	speed: 0.1579s/iter; left time: 5327.3296s
	iters: 300, epoch: 9 | loss: 0.7965214
	speed: 0.1468s/iter; left time: 4939.5330s
Epoch: 9 cost time: 67.22833633422852
Epoch: 9, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.7427020
	speed: 0.7015s/iter; left time: 23486.6677s
	iters: 200, epoch: 10 | loss: 0.7011883
	speed: 0.2134s/iter; left time: 7121.9393s
	iters: 300, epoch: 10 | loss: 0.6446714
	speed: 0.2232s/iter; left time: 7428.0101s
Epoch: 10 cost time: 80.23358535766602
Epoch: 10, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6827978
	speed: 0.7297s/iter; left time: 24161.2427s
	iters: 200, epoch: 11 | loss: 0.7117474
	speed: 0.1819s/iter; left time: 6004.6290s
	iters: 300, epoch: 11 | loss: 0.7135497
	speed: 0.1841s/iter; left time: 6058.7570s
Epoch: 11 cost time: 71.18516230583191
Epoch: 11, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.6847730
	speed: 0.7503s/iter; left time: 24565.3008s
	iters: 200, epoch: 12 | loss: 0.7242813
	speed: 0.2085s/iter; left time: 6805.8908s
	iters: 300, epoch: 12 | loss: 0.7156785
	speed: 0.1931s/iter; left time: 6284.5339s
Epoch: 12 cost time: 76.42699694633484
Epoch: 12, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6501135073779796
model parameter : 4921534
model size : 21.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5063626
	speed: 0.2732s/iter; left time: 10054.2880s
	iters: 200, epoch: 1 | loss: 0.8470105
	speed: 0.2030s/iter; left time: 7451.5347s
	iters: 300, epoch: 1 | loss: 0.5539653
	speed: 0.1762s/iter; left time: 6447.7618s
Epoch: 1 cost time: 75.69664883613586
Epoch: 1, Steps: 369 | Train Loss: 0.754 Vali Loss: 1.135 Vali Acc: 0.501 Test Loss: 1.135 Test Acc: 0.501
Validation loss decreased (inf --> -0.501124).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0179416
	speed: 0.6552s/iter; left time: 23868.4279s
	iters: 200, epoch: 2 | loss: 0.6312531
	speed: 0.2021s/iter; left time: 7340.9948s
	iters: 300, epoch: 2 | loss: 0.6588640
	speed: 0.1945s/iter; left time: 7047.3518s
Epoch: 2 cost time: 74.1159918308258
Epoch: 2, Steps: 369 | Train Loss: 0.772 Vali Loss: 0.739 Vali Acc: 0.610 Test Loss: 0.739 Test Acc: 0.610
Validation loss decreased (-0.501124 --> -0.609811).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0771149
	speed: 0.7152s/iter; left time: 25792.2554s
	iters: 200, epoch: 3 | loss: 0.5335513
	speed: 0.1911s/iter; left time: 6871.2910s
	iters: 300, epoch: 3 | loss: 0.5424302
	speed: 0.1934s/iter; left time: 6936.6504s
Epoch: 3 cost time: 77.42226195335388
Epoch: 3, Steps: 369 | Train Loss: 0.736 Vali Loss: 0.822 Vali Acc: 0.524 Test Loss: 0.822 Test Acc: 0.524
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7397523
	speed: 0.7030s/iter; left time: 25092.4952s
	iters: 200, epoch: 4 | loss: 0.8216654
	speed: 0.2102s/iter; left time: 7482.2705s
	iters: 300, epoch: 4 | loss: 0.7796015
	speed: 0.1775s/iter; left time: 6300.3910s
Epoch: 4 cost time: 70.98156476020813
Epoch: 4, Steps: 369 | Train Loss: 0.802 Vali Loss: 0.837 Vali Acc: 0.500 Test Loss: 0.837 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7477843
	speed: 0.6524s/iter; left time: 23045.4382s
	iters: 200, epoch: 5 | loss: 1.0188618
	speed: 0.2262s/iter; left time: 7968.0418s
	iters: 300, epoch: 5 | loss: 1.0145347
	speed: 0.1990s/iter; left time: 6990.9514s
Epoch: 5 cost time: 74.83184623718262
Epoch: 5, Steps: 369 | Train Loss: 0.757 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6847557
	speed: 0.7546s/iter; left time: 26376.6404s
	iters: 200, epoch: 6 | loss: 0.6750181
	speed: 0.2528s/iter; left time: 8810.6904s
	iters: 300, epoch: 6 | loss: 0.6619133
	speed: 0.2482s/iter; left time: 8626.2434s
Epoch: 6 cost time: 86.01498436927795
Epoch: 6, Steps: 369 | Train Loss: 0.728 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6998483
	speed: 0.7333s/iter; left time: 25361.2252s
	iters: 200, epoch: 7 | loss: 0.6732746
	speed: 0.1742s/iter; left time: 6007.0693s
	iters: 300, epoch: 7 | loss: 0.7306638
	speed: 0.2056s/iter; left time: 7070.4334s
Epoch: 7 cost time: 77.2639570236206
Epoch: 7, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6253237
	speed: 0.7143s/iter; left time: 24440.7122s
	iters: 200, epoch: 8 | loss: 0.7309050
	speed: 0.2093s/iter; left time: 7141.4382s
	iters: 300, epoch: 8 | loss: 0.7153658
	speed: 0.2145s/iter; left time: 7297.5712s
Epoch: 8 cost time: 77.47505164146423
Epoch: 8, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6395945
	speed: 0.7617s/iter; left time: 25781.5459s
	iters: 200, epoch: 9 | loss: 0.7453043
	speed: 0.1972s/iter; left time: 6655.9600s
	iters: 300, epoch: 9 | loss: 0.7205667
	speed: 0.2052s/iter; left time: 6905.9779s
Epoch: 9 cost time: 79.81765484809875
Epoch: 9, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6781515
	speed: 0.7476s/iter; left time: 25030.5818s
	iters: 200, epoch: 10 | loss: 0.6871720
	speed: 0.2082s/iter; left time: 6948.7743s
	iters: 300, epoch: 10 | loss: 0.6750111
	speed: 0.1833s/iter; left time: 6101.5268s
Epoch: 10 cost time: 76.16787242889404
Epoch: 10, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7682244
	speed: 0.7579s/iter; left time: 25095.6007s
	iters: 200, epoch: 11 | loss: 0.6671009
	speed: 0.2198s/iter; left time: 7256.0624s
	iters: 300, epoch: 11 | loss: 0.7009709
	speed: 0.2161s/iter; left time: 7111.5830s
Epoch: 11 cost time: 81.14778995513916
Epoch: 11, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7216400
	speed: 0.7365s/iter; left time: 24113.3223s
	iters: 200, epoch: 12 | loss: 0.7154891
	speed: 0.1819s/iter; left time: 5938.6806s
	iters: 300, epoch: 12 | loss: 0.6957055
	speed: 0.1870s/iter; left time: 6085.4182s
Epoch: 12 cost time: 74.40004086494446
Epoch: 12, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6098183881952327
model parameter : 4919998
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.5737802
	speed: 0.2188s/iter; left time: 8053.2095s
	iters: 200, epoch: 1 | loss: 0.5962526
	speed: 0.2093s/iter; left time: 7682.3373s
	iters: 300, epoch: 1 | loss: 0.3972804
	speed: 0.2317s/iter; left time: 8481.7177s
Epoch: 1 cost time: 82.56502556800842
Epoch: 1, Steps: 369 | Train Loss: 0.836 Vali Loss: 0.815 Vali Acc: 0.563 Test Loss: 0.815 Test Acc: 0.563
Validation loss decreased (inf --> -0.562988).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6101792
	speed: 0.7285s/iter; left time: 26539.5630s
	iters: 200, epoch: 2 | loss: 0.7301672
	speed: 0.1702s/iter; left time: 6183.6806s
	iters: 300, epoch: 2 | loss: 0.7626495
	speed: 0.1748s/iter; left time: 6331.9762s
Epoch: 2 cost time: 69.88878512382507
Epoch: 2, Steps: 369 | Train Loss: 0.739 Vali Loss: 0.683 Vali Acc: 0.645 Test Loss: 0.683 Test Acc: 0.645
Validation loss decreased (-0.562988 --> -0.644715).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8548489
	speed: 0.7604s/iter; left time: 27423.1970s
	iters: 200, epoch: 3 | loss: 0.5344299
	speed: 0.2278s/iter; left time: 8192.2207s
	iters: 300, epoch: 3 | loss: 0.6107109
	speed: 0.1694s/iter; left time: 6073.5074s
Epoch: 3 cost time: 75.81957674026489
Epoch: 3, Steps: 369 | Train Loss: 0.686 Vali Loss: 0.633 Vali Acc: 0.642 Test Loss: 0.633 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5692213
	speed: 0.6932s/iter; left time: 24744.1995s
	iters: 200, epoch: 4 | loss: 0.6458891
	speed: 0.2019s/iter; left time: 7185.3706s
	iters: 300, epoch: 4 | loss: 0.5262434
	speed: 0.1911s/iter; left time: 6783.2974s
Epoch: 4 cost time: 74.89496636390686
Epoch: 4, Steps: 369 | Train Loss: 0.676 Vali Loss: 0.659 Vali Acc: 0.658 Test Loss: 0.659 Test Acc: 0.658
Validation loss decreased (-0.644715 --> -0.657769).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7204202
	speed: 0.7173s/iter; left time: 25340.1606s
	iters: 200, epoch: 5 | loss: 1.3318882
	speed: 0.2018s/iter; left time: 7109.9412s
	iters: 300, epoch: 5 | loss: 0.7112165
	speed: 0.2057s/iter; left time: 7226.0463s
Epoch: 5 cost time: 77.20406413078308
Epoch: 5, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6273000
	speed: 0.6878s/iter; left time: 24041.3270s
	iters: 200, epoch: 6 | loss: 0.8105032
	speed: 0.2332s/iter; left time: 8128.2337s
	iters: 300, epoch: 6 | loss: 0.7015169
	speed: 0.2123s/iter; left time: 7377.2334s
Epoch: 6 cost time: 80.78478860855103
Epoch: 6, Steps: 369 | Train Loss: 0.730 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6862895
	speed: 0.7247s/iter; left time: 25064.9571s
	iters: 200, epoch: 7 | loss: 0.7810443
	speed: 0.1725s/iter; left time: 5948.1394s
	iters: 300, epoch: 7 | loss: 0.7732944
	speed: 0.1849s/iter; left time: 6358.3627s
Epoch: 7 cost time: 69.28219962120056
Epoch: 7, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.7668857
	speed: 0.7308s/iter; left time: 25006.0126s
	iters: 200, epoch: 8 | loss: 0.6756085
	speed: 0.1718s/iter; left time: 5860.4313s
	iters: 300, epoch: 8 | loss: 0.6989011
	speed: 0.1755s/iter; left time: 5971.3205s
Epoch: 8 cost time: 70.56328821182251
Epoch: 8, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6337385
	speed: 0.6998s/iter; left time: 23687.4363s
	iters: 200, epoch: 9 | loss: 0.7646998
	speed: 0.2500s/iter; left time: 8437.8243s
	iters: 300, epoch: 9 | loss: 0.7217374
	speed: 0.2396s/iter; left time: 8063.2671s
Epoch: 9 cost time: 87.24499654769897
Epoch: 9, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.7006413
	speed: 0.6823s/iter; left time: 22843.4488s
	iters: 200, epoch: 10 | loss: 0.6669648
	speed: 0.1640s/iter; left time: 5475.1330s
	iters: 300, epoch: 10 | loss: 0.7021990
	speed: 0.1940s/iter; left time: 6455.4966s
Epoch: 10 cost time: 65.80201005935669
Epoch: 10, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.7041183
	speed: 0.7335s/iter; left time: 24285.2775s
	iters: 200, epoch: 11 | loss: 0.7471975
	speed: 0.2303s/iter; left time: 7602.7306s
	iters: 300, epoch: 11 | loss: 0.7020231
	speed: 0.2140s/iter; left time: 7043.3258s
Epoch: 11 cost time: 81.69387078285217
Epoch: 11, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.6319615
	speed: 0.6627s/iter; left time: 21696.6845s
	iters: 200, epoch: 12 | loss: 0.6202391
	speed: 0.2219s/iter; left time: 7242.6898s
	iters: 300, epoch: 12 | loss: 0.6601216
	speed: 0.2504s/iter; left time: 8148.2822s
Epoch: 12 cost time: 85.19120359420776
Epoch: 12, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.6688949
	speed: 0.8565s/iter; left time: 27729.0422s
	iters: 200, epoch: 13 | loss: 0.7459485
	speed: 0.2303s/iter; left time: 7433.1488s
	iters: 300, epoch: 13 | loss: 0.7416781
	speed: 0.2354s/iter; left time: 7573.8636s
Epoch: 13 cost time: 86.6580822467804
Epoch: 13, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.6516666
	speed: 0.7716s/iter; left time: 24694.5842s
	iters: 200, epoch: 14 | loss: 0.6744732
	speed: 0.2016s/iter; left time: 6432.9586s
	iters: 300, epoch: 14 | loss: 0.7303089
	speed: 0.2343s/iter; left time: 7452.8996s
Epoch: 14 cost time: 84.48758697509766
Epoch: 14, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6577752553916004
model parameter : 3740350
model size : 16.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7732871
	speed: 0.2321s/iter; left time: 8541.6191s
	iters: 200, epoch: 1 | loss: 0.6705700
	speed: 0.2076s/iter; left time: 7619.4586s
	iters: 300, epoch: 1 | loss: 0.8207117
	speed: 0.2155s/iter; left time: 7886.9962s
Epoch: 1 cost time: 83.03498125076294
Epoch: 1, Steps: 369 | Train Loss: 0.761 Vali Loss: 0.827 Vali Acc: 0.576 Test Loss: 0.827 Test Acc: 0.576
Validation loss decreased (inf --> -0.576325).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9182768
	speed: 0.8071s/iter; left time: 29403.1495s
	iters: 200, epoch: 2 | loss: 0.6961514
	speed: 0.2316s/iter; left time: 8414.2268s
	iters: 300, epoch: 2 | loss: 0.8185081
	speed: 0.2138s/iter; left time: 7747.2421s
Epoch: 2 cost time: 86.79060459136963
Epoch: 2, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.895 Vali Acc: 0.515 Test Loss: 0.895 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8166127
	speed: 0.7510s/iter; left time: 27083.2219s
	iters: 200, epoch: 3 | loss: 0.3215980
	speed: 0.2053s/iter; left time: 7383.1651s
	iters: 300, epoch: 3 | loss: 0.5273919
	speed: 0.1629s/iter; left time: 5841.1231s
Epoch: 3 cost time: 75.08854532241821
Epoch: 3, Steps: 369 | Train Loss: 0.670 Vali Loss: 1.082 Vali Acc: 0.563 Test Loss: 1.082 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4494975
	speed: 0.8171s/iter; left time: 29167.2061s
	iters: 200, epoch: 4 | loss: 0.7132609
	speed: 0.2478s/iter; left time: 8818.7475s
	iters: 300, epoch: 4 | loss: 0.7854523
	speed: 0.2530s/iter; left time: 8981.0489s
Epoch: 4 cost time: 90.3340060710907
Epoch: 4, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.0049480
	speed: 0.7372s/iter; left time: 26042.5061s
	iters: 200, epoch: 5 | loss: 0.6951228
	speed: 0.2018s/iter; left time: 7107.7325s
	iters: 300, epoch: 5 | loss: 0.6779416
	speed: 0.2088s/iter; left time: 7334.5425s
Epoch: 5 cost time: 76.49361801147461
Epoch: 5, Steps: 369 | Train Loss: 0.766 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.9946203
	speed: 0.7404s/iter; left time: 25881.2330s
	iters: 200, epoch: 6 | loss: 0.6824074
	speed: 0.2302s/iter; left time: 8025.1989s
	iters: 300, epoch: 6 | loss: 0.7785811
	speed: 0.1929s/iter; left time: 6703.8726s
Epoch: 6 cost time: 76.80678105354309
Epoch: 6, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7364733
	speed: 0.7363s/iter; left time: 25465.0780s
	iters: 200, epoch: 7 | loss: 0.7441225
	speed: 0.2528s/iter; left time: 8717.9417s
	iters: 300, epoch: 7 | loss: 0.7512770
	speed: 0.2389s/iter; left time: 8215.3921s
Epoch: 7 cost time: 88.70419526100159
Epoch: 7, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7405613
	speed: 0.7477s/iter; left time: 25586.2919s
	iters: 200, epoch: 8 | loss: 0.6772693
	speed: 0.2368s/iter; left time: 8079.0168s
	iters: 300, epoch: 8 | loss: 0.7140709
	speed: 0.2271s/iter; left time: 7725.0877s
Epoch: 8 cost time: 82.38568210601807
Epoch: 8, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6659155
	speed: 0.7148s/iter; left time: 24196.2305s
	iters: 200, epoch: 9 | loss: 0.6851547
	speed: 0.2265s/iter; left time: 7644.2284s
	iters: 300, epoch: 9 | loss: 0.7604982
	speed: 0.2339s/iter; left time: 7870.9964s
Epoch: 9 cost time: 85.01944231987
Epoch: 9, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7714815
	speed: 0.7915s/iter; left time: 26498.9559s
	iters: 200, epoch: 10 | loss: 0.7278732
	speed: 0.2242s/iter; left time: 7482.7169s
	iters: 300, epoch: 10 | loss: 0.7988027
	speed: 0.2530s/iter; left time: 8421.3005s
Epoch: 10 cost time: 86.61377239227295
Epoch: 10, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6843585
	speed: 0.7328s/iter; left time: 24262.1881s
	iters: 200, epoch: 11 | loss: 0.6515504
	speed: 0.1964s/iter; left time: 6482.4635s
	iters: 300, epoch: 11 | loss: 0.6895478
	speed: 0.2027s/iter; left time: 6669.5008s
Epoch: 11 cost time: 74.36769938468933
Epoch: 11, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5763337116912599
model parameter : 3738814
model size : 16.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1339573
	speed: 0.2556s/iter; left time: 9405.1240s
	iters: 200, epoch: 1 | loss: 0.7945925
	speed: 0.2068s/iter; left time: 7588.1564s
	iters: 300, epoch: 1 | loss: 0.5875793
	speed: 0.2354s/iter; left time: 8615.6803s
Epoch: 1 cost time: 85.783766746521
Epoch: 1, Steps: 369 | Train Loss: 0.781 Vali Loss: 1.382 Vali Acc: 0.500 Test Loss: 1.382 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1997105
	speed: 0.7619s/iter; left time: 27756.5029s
	iters: 200, epoch: 2 | loss: 1.5787929
	speed: 0.2321s/iter; left time: 8434.3094s
	iters: 300, epoch: 2 | loss: 0.6516057
	speed: 0.2171s/iter; left time: 7866.4533s
Epoch: 2 cost time: 86.95713591575623
Epoch: 2, Steps: 369 | Train Loss: 0.686 Vali Loss: 1.327 Vali Acc: 0.500 Test Loss: 1.327 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6001739
	speed: 0.7427s/iter; left time: 26785.7202s
	iters: 200, epoch: 3 | loss: 0.6416367
	speed: 0.1514s/iter; left time: 5444.9924s
	iters: 300, epoch: 3 | loss: 0.7298401
	speed: 0.1918s/iter; left time: 6879.7211s
Epoch: 3 cost time: 75.44792366027832
Epoch: 3, Steps: 369 | Train Loss: 0.691 Vali Loss: 0.787 Vali Acc: 0.639 Test Loss: 0.787 Test Acc: 0.639
Validation loss decreased (-0.499987 --> -0.639322).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7215843
	speed: 0.7410s/iter; left time: 26448.1970s
	iters: 200, epoch: 4 | loss: 0.5126177
	speed: 0.1561s/iter; left time: 5555.7081s
	iters: 300, epoch: 4 | loss: 0.5354402
	speed: 0.2311s/iter; left time: 8202.9853s
Epoch: 4 cost time: 72.90985894203186
Epoch: 4, Steps: 369 | Train Loss: 0.676 Vali Loss: 0.636 Vali Acc: 0.644 Test Loss: 0.636 Test Acc: 0.644
Validation loss decreased (-0.639322 --> -0.644148).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8248073
	speed: 0.7519s/iter; left time: 26559.1134s
	iters: 200, epoch: 5 | loss: 0.3902453
	speed: 0.1841s/iter; left time: 6484.7384s
	iters: 300, epoch: 5 | loss: 0.7058294
	speed: 0.1727s/iter; left time: 6066.9242s
Epoch: 5 cost time: 74.89475059509277
Epoch: 5, Steps: 369 | Train Loss: 0.680 Vali Loss: 0.678 Vali Acc: 0.590 Test Loss: 0.678 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6657234
	speed: 0.7425s/iter; left time: 25956.1333s
	iters: 200, epoch: 6 | loss: 0.5909030
	speed: 0.2140s/iter; left time: 7459.3344s
	iters: 300, epoch: 6 | loss: 0.8131996
	speed: 0.1587s/iter; left time: 5514.3082s
Epoch: 6 cost time: 74.53744435310364
Epoch: 6, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.7143545
	speed: 0.7077s/iter; left time: 24478.6371s
	iters: 200, epoch: 7 | loss: 0.6913552
	speed: 0.2392s/iter; left time: 8250.9323s
	iters: 300, epoch: 7 | loss: 0.6976082
	speed: 0.2439s/iter; left time: 8387.2071s
Epoch: 7 cost time: 87.08936905860901
Epoch: 7, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6489162
	speed: 0.7437s/iter; left time: 25449.2245s
	iters: 200, epoch: 8 | loss: 0.7168422
	speed: 0.1895s/iter; left time: 6466.9625s
	iters: 300, epoch: 8 | loss: 0.6949788
	speed: 0.1416s/iter; left time: 4817.3910s
Epoch: 8 cost time: 68.59150290489197
Epoch: 8, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6878965
	speed: 0.7594s/iter; left time: 25706.4880s
	iters: 200, epoch: 9 | loss: 0.6900521
	speed: 0.2246s/iter; left time: 7578.9133s
	iters: 300, epoch: 9 | loss: 0.7190492
	speed: 0.2278s/iter; left time: 7666.4634s
Epoch: 9 cost time: 88.92354607582092
Epoch: 9, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.7325460
	speed: 0.6864s/iter; left time: 22980.6359s
	iters: 200, epoch: 10 | loss: 0.7617295
	speed: 0.2267s/iter; left time: 7567.1324s
	iters: 300, epoch: 10 | loss: 0.6951626
	speed: 0.2273s/iter; left time: 7564.4785s
Epoch: 10 cost time: 84.53106093406677
Epoch: 10, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.7161322
	speed: 0.7178s/iter; left time: 23767.8761s
	iters: 200, epoch: 11 | loss: 0.7176646
	speed: 0.2113s/iter; left time: 6975.6415s
	iters: 300, epoch: 11 | loss: 0.7068474
	speed: 0.2173s/iter; left time: 7150.0007s
Epoch: 11 cost time: 81.94392514228821
Epoch: 11, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.7135896
	speed: 0.7439s/iter; left time: 24355.8713s
	iters: 200, epoch: 12 | loss: 0.6928493
	speed: 0.2298s/iter; left time: 7501.7137s
	iters: 300, epoch: 12 | loss: 0.7060738
	speed: 0.2054s/iter; left time: 6683.9408s
Epoch: 12 cost time: 80.34398865699768
Epoch: 12, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.6960477
	speed: 0.6164s/iter; left time: 19953.9680s
	iters: 200, epoch: 13 | loss: 0.6556639
	speed: 0.1925s/iter; left time: 6213.2123s
	iters: 300, epoch: 13 | loss: 0.7110637
	speed: 0.1901s/iter; left time: 6114.8652s
Epoch: 13 cost time: 70.8650393486023
Epoch: 13, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.7076442
	speed: 0.7206s/iter; left time: 23060.9097s
	iters: 200, epoch: 14 | loss: 0.7142567
	speed: 0.2127s/iter; left time: 6784.9081s
	iters: 300, epoch: 14 | loss: 0.7543796
	speed: 0.2054s/iter; left time: 6532.5375s
Epoch: 14 cost time: 75.74838519096375
Epoch: 14, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6441543700340522
model parameter : 3737278
model size : 16.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7248893
	speed: 0.2423s/iter; left time: 8917.2003s
	iters: 200, epoch: 1 | loss: 0.6977765
	speed: 0.2006s/iter; left time: 7362.6422s
	iters: 300, epoch: 1 | loss: 0.7821329
	speed: 0.1668s/iter; left time: 6103.9214s
Epoch: 1 cost time: 73.2492401599884
Epoch: 1, Steps: 369 | Train Loss: 0.814 Vali Loss: 0.993 Vali Acc: 0.500 Test Loss: 0.993 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1841915
	speed: 0.6779s/iter; left time: 24698.2297s
	iters: 200, epoch: 2 | loss: 1.3904476
	speed: 0.2227s/iter; left time: 8089.9582s
	iters: 300, epoch: 2 | loss: 0.8491520
	speed: 0.2417s/iter; left time: 8757.1533s
Epoch: 2 cost time: 85.61688685417175
Epoch: 2, Steps: 369 | Train Loss: 0.688 Vali Loss: 0.714 Vali Acc: 0.589 Test Loss: 0.714 Test Acc: 0.589
Validation loss decreased (-0.499990 --> -0.589096).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6745538
	speed: 0.7340s/iter; left time: 26471.1871s
	iters: 200, epoch: 3 | loss: 0.5480378
	speed: 0.2268s/iter; left time: 8157.0920s
	iters: 300, epoch: 3 | loss: 0.7176101
	speed: 0.2023s/iter; left time: 7253.6394s
Epoch: 3 cost time: 77.90838837623596
Epoch: 3, Steps: 369 | Train Loss: 0.691 Vali Loss: 1.027 Vali Acc: 0.522 Test Loss: 1.027 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7411669
	speed: 0.7134s/iter; left time: 25465.2695s
	iters: 200, epoch: 4 | loss: 0.5304324
	speed: 0.2331s/iter; left time: 8296.5977s
	iters: 300, epoch: 4 | loss: 0.9783095
	speed: 0.2245s/iter; left time: 7968.2378s
Epoch: 4 cost time: 84.76380825042725
Epoch: 4, Steps: 369 | Train Loss: 0.676 Vali Loss: 0.709 Vali Acc: 0.601 Test Loss: 0.709 Test Acc: 0.601
Validation loss decreased (-0.589096 --> -0.600731).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8124823
	speed: 0.6819s/iter; left time: 24088.7369s
	iters: 200, epoch: 5 | loss: 0.7202593
	speed: 0.2183s/iter; left time: 7689.3105s
	iters: 300, epoch: 5 | loss: 0.7597935
	speed: 0.2733s/iter; left time: 9600.0644s
Epoch: 5 cost time: 83.94229030609131
Epoch: 5, Steps: 369 | Train Loss: 0.749 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6730294
	speed: 0.6670s/iter; left time: 23315.4663s
	iters: 200, epoch: 6 | loss: 0.7027524
	speed: 0.2218s/iter; left time: 7732.6487s
	iters: 300, epoch: 6 | loss: 0.7005659
	speed: 0.2045s/iter; left time: 7106.5800s
Epoch: 6 cost time: 79.25954079627991
Epoch: 6, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6927009
	speed: 0.7152s/iter; left time: 24735.9673s
	iters: 200, epoch: 7 | loss: 0.6666240
	speed: 0.2359s/iter; left time: 8133.8603s
	iters: 300, epoch: 7 | loss: 0.7677767
	speed: 0.2091s/iter; left time: 7191.8071s
Epoch: 7 cost time: 84.11427140235901
Epoch: 7, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6553760
	speed: 0.7036s/iter; left time: 24075.1531s
	iters: 200, epoch: 8 | loss: 0.7083430
	speed: 0.2082s/iter; left time: 7101.8588s
	iters: 300, epoch: 8 | loss: 0.9166225
	speed: 0.2092s/iter; left time: 7115.6645s
Epoch: 8 cost time: 75.79124617576599
Epoch: 8, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.7410530
	speed: 0.7411s/iter; left time: 25085.5414s
	iters: 200, epoch: 9 | loss: 0.7612888
	speed: 0.2115s/iter; left time: 7137.8205s
	iters: 300, epoch: 9 | loss: 0.7443321
	speed: 0.2190s/iter; left time: 7370.4778s
Epoch: 9 cost time: 81.35611701011658
Epoch: 9, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6824819
	speed: 0.7299s/iter; left time: 24437.2075s
	iters: 200, epoch: 10 | loss: 0.6698731
	speed: 0.2198s/iter; left time: 7335.9663s
	iters: 300, epoch: 10 | loss: 0.6931545
	speed: 0.2239s/iter; left time: 7450.1620s
Epoch: 10 cost time: 78.73838353157043
Epoch: 10, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.7257943
	speed: 0.7399s/iter; left time: 24497.3607s
	iters: 200, epoch: 11 | loss: 0.7902330
	speed: 0.1948s/iter; left time: 6429.9558s
	iters: 300, epoch: 11 | loss: 0.7304430
	speed: 0.1950s/iter; left time: 6419.2010s
Epoch: 11 cost time: 74.12152934074402
Epoch: 11, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.6804217
	speed: 0.7483s/iter; left time: 24499.4875s
	iters: 200, epoch: 12 | loss: 0.6892236
	speed: 0.2070s/iter; left time: 6757.0943s
	iters: 300, epoch: 12 | loss: 0.7039264
	speed: 0.2208s/iter; left time: 7183.7711s
Epoch: 12 cost time: 82.24075961112976
Epoch: 12, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.6936883
	speed: 0.7710s/iter; left time: 24961.0598s
	iters: 200, epoch: 13 | loss: 0.7154631
	speed: 0.1875s/iter; left time: 6050.5006s
	iters: 300, epoch: 13 | loss: 0.7283601
	speed: 0.2263s/iter; left time: 7281.8742s
Epoch: 13 cost time: 80.58137631416321
Epoch: 13, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.7326299
	speed: 0.7032s/iter; left time: 22506.4358s
	iters: 200, epoch: 14 | loss: 0.6824204
	speed: 0.2158s/iter; left time: 6883.4098s
	iters: 300, epoch: 14 | loss: 0.7063471
	speed: 0.2213s/iter; left time: 7038.6320s
Epoch: 14 cost time: 80.53144955635071
Epoch: 14, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6007377979568672
model parameter : 3735742
model size : 16.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5841846
	speed: 0.2402s/iter; left time: 8838.2494s
	iters: 200, epoch: 1 | loss: 0.8561587
	speed: 0.2131s/iter; left time: 7819.6214s
	iters: 300, epoch: 1 | loss: 0.6048620
	speed: 0.1856s/iter; left time: 6794.2602s
Epoch: 1 cost time: 75.45634746551514
Epoch: 1, Steps: 369 | Train Loss: 0.764 Vali Loss: 1.862 Vali Acc: 0.519 Test Loss: 1.862 Test Acc: 0.519
Validation loss decreased (inf --> -0.519278).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0392135
	speed: 0.6885s/iter; left time: 25083.5991s
	iters: 200, epoch: 2 | loss: 0.5003865
	speed: 0.2164s/iter; left time: 7860.4919s
	iters: 300, epoch: 2 | loss: 0.6054916
	speed: 0.2259s/iter; left time: 8184.0021s
Epoch: 2 cost time: 83.46324610710144
Epoch: 2, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.852 Vali Acc: 0.564 Test Loss: 0.852 Test Acc: 0.564
Validation loss decreased (-0.519278 --> -0.564407).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8351530
	speed: 0.7328s/iter; left time: 26425.6467s
	iters: 200, epoch: 3 | loss: 0.8449066
	speed: 0.1942s/iter; left time: 6984.6813s
	iters: 300, epoch: 3 | loss: 0.9297456
	speed: 0.2054s/iter; left time: 7364.7338s
Epoch: 3 cost time: 79.75985908508301
Epoch: 3, Steps: 369 | Train Loss: 0.658 Vali Loss: 0.717 Vali Acc: 0.604 Test Loss: 0.717 Test Acc: 0.604
Validation loss decreased (-0.564407 --> -0.604420).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4975775
	speed: 0.7924s/iter; left time: 28282.3305s
	iters: 200, epoch: 4 | loss: 0.9510782
	speed: 0.2242s/iter; left time: 7979.6402s
	iters: 300, epoch: 4 | loss: 0.3375613
	speed: 0.2193s/iter; left time: 7784.7726s
Epoch: 4 cost time: 81.03024697303772
Epoch: 4, Steps: 369 | Train Loss: 0.653 Vali Loss: 0.745 Vali Acc: 0.620 Test Loss: 0.745 Test Acc: 0.620
Validation loss decreased (-0.604420 --> -0.620027).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5840656
	speed: 0.7213s/iter; left time: 25481.3267s
	iters: 200, epoch: 5 | loss: 0.7521743
	speed: 0.2159s/iter; left time: 7603.9404s
	iters: 300, epoch: 5 | loss: 0.4939359
	speed: 0.1888s/iter; left time: 6630.9601s
Epoch: 5 cost time: 81.6771399974823
Epoch: 5, Steps: 369 | Train Loss: 0.620 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6817911
	speed: 0.6902s/iter; left time: 24127.4901s
	iters: 200, epoch: 6 | loss: 0.6972582
	speed: 0.1811s/iter; left time: 6311.5920s
	iters: 300, epoch: 6 | loss: 0.8001850
	speed: 0.2378s/iter; left time: 8264.0290s
Epoch: 6 cost time: 75.07839131355286
Epoch: 6, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6735478
	speed: 0.7892s/iter; left time: 27295.6543s
	iters: 200, epoch: 7 | loss: 0.6361576
	speed: 0.1984s/iter; left time: 6841.1422s
	iters: 300, epoch: 7 | loss: 0.7159314
	speed: 0.2034s/iter; left time: 6994.9207s
Epoch: 7 cost time: 76.46124505996704
Epoch: 7, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6918525
	speed: 0.7325s/iter; left time: 25065.1676s
	iters: 200, epoch: 8 | loss: 0.7235602
	speed: 0.1835s/iter; left time: 6262.2100s
	iters: 300, epoch: 8 | loss: 0.6830053
	speed: 0.2141s/iter; left time: 7283.4852s
Epoch: 8 cost time: 77.70676946640015
Epoch: 8, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6749809
	speed: 0.7705s/iter; left time: 26081.1787s
	iters: 200, epoch: 9 | loss: 0.6590604
	speed: 0.2572s/iter; left time: 8681.1666s
	iters: 300, epoch: 9 | loss: 0.7133322
	speed: 0.1884s/iter; left time: 6338.5713s
Epoch: 9 cost time: 81.20338249206543
Epoch: 9, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6991913
	speed: 0.6176s/iter; left time: 20678.3240s
	iters: 200, epoch: 10 | loss: 0.7039692
	speed: 0.1800s/iter; left time: 6007.9653s
	iters: 300, epoch: 10 | loss: 0.7101412
	speed: 0.1883s/iter; left time: 6266.1952s
Epoch: 10 cost time: 72.80562162399292
Epoch: 10, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.6473734
	speed: 0.7275s/iter; left time: 24087.4337s
	iters: 200, epoch: 11 | loss: 0.6717911
	speed: 0.1686s/iter; left time: 5564.7650s
	iters: 300, epoch: 11 | loss: 0.7388096
	speed: 0.2134s/iter; left time: 7024.7367s
Epoch: 11 cost time: 76.88894081115723
Epoch: 11, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.6954875
	speed: 0.7270s/iter; left time: 23802.4795s
	iters: 200, epoch: 12 | loss: 0.6887522
	speed: 0.2078s/iter; left time: 6784.6051s
	iters: 300, epoch: 12 | loss: 0.6876815
	speed: 0.2081s/iter; left time: 6771.6966s
Epoch: 12 cost time: 81.25854992866516
Epoch: 12, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.7367761
	speed: 0.7544s/iter; left time: 24423.1664s
	iters: 200, epoch: 13 | loss: 0.6623262
	speed: 0.1819s/iter; left time: 5870.6183s
	iters: 300, epoch: 13 | loss: 0.6877002
	speed: 0.1711s/iter; left time: 5505.5721s
Epoch: 13 cost time: 70.52955365180969
Epoch: 13, Steps: 369 | Train Loss: 0.699 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.7588225
	speed: 0.7331s/iter; left time: 23463.2166s
	iters: 200, epoch: 14 | loss: 0.6690834
	speed: 0.2335s/iter; left time: 7449.3949s
	iters: 300, epoch: 14 | loss: 0.7158946
	speed: 0.2384s/iter; left time: 7581.4858s
Epoch: 14 cost time: 85.48637247085571
Epoch: 14, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6200340522133939
model parameter : 3148222
model size : 14.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8042095
	speed: 0.2348s/iter; left time: 8639.2371s
	iters: 200, epoch: 1 | loss: 0.7882028
	speed: 0.2045s/iter; left time: 7507.1357s
	iters: 300, epoch: 1 | loss: 0.5736501
	speed: 0.2027s/iter; left time: 7419.0610s
Epoch: 1 cost time: 74.80267786979675
Epoch: 1, Steps: 369 | Train Loss: 0.794 Vali Loss: 1.107 Vali Acc: 0.541 Test Loss: 1.107 Test Acc: 0.541
Validation loss decreased (inf --> -0.540852).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4839472
	speed: 0.5859s/iter; left time: 21345.6153s
	iters: 200, epoch: 2 | loss: 1.3086647
	speed: 0.2092s/iter; left time: 7601.4786s
	iters: 300, epoch: 2 | loss: 0.7270828
	speed: 0.2008s/iter; left time: 7275.1687s
Epoch: 2 cost time: 75.00579953193665
Epoch: 2, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.970 Vali Acc: 0.511 Test Loss: 0.970 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8481452
	speed: 0.6411s/iter; left time: 23119.2255s
	iters: 200, epoch: 3 | loss: 0.6699899
	speed: 0.2110s/iter; left time: 7589.2187s
	iters: 300, epoch: 3 | loss: 0.5279606
	speed: 0.2208s/iter; left time: 7919.1996s
Epoch: 3 cost time: 73.96030235290527
Epoch: 3, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.886 Vali Acc: 0.541 Test Loss: 0.886 Test Acc: 0.541
Validation loss decreased (-0.540852 --> -0.541138).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4134356
	speed: 0.6028s/iter; left time: 21517.2381s
	iters: 200, epoch: 4 | loss: 0.5314489
	speed: 0.1630s/iter; left time: 5803.1567s
	iters: 300, epoch: 4 | loss: 0.7613836
	speed: 0.1757s/iter; left time: 6235.6338s
Epoch: 4 cost time: 61.414119720458984
Epoch: 4, Steps: 369 | Train Loss: 0.644 Vali Loss: 0.699 Vali Acc: 0.501 Test Loss: 0.699 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6056156
	speed: 0.6813s/iter; left time: 24066.5395s
	iters: 200, epoch: 5 | loss: 0.9681529
	speed: 0.1900s/iter; left time: 6693.9124s
	iters: 300, epoch: 5 | loss: 0.4925728
	speed: 0.2070s/iter; left time: 7272.6095s
Epoch: 5 cost time: 74.6938374042511
Epoch: 5, Steps: 369 | Train Loss: 0.696 Vali Loss: 0.664 Vali Acc: 0.616 Test Loss: 0.664 Test Acc: 0.616
Validation loss decreased (-0.541138 --> -0.616338).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7154476
	speed: 0.6166s/iter; left time: 21552.4099s
	iters: 200, epoch: 6 | loss: 0.9667183
	speed: 0.1918s/iter; left time: 6686.3692s
	iters: 300, epoch: 6 | loss: 0.6875906
	speed: 0.2155s/iter; left time: 7491.4307s
Epoch: 6 cost time: 74.68428707122803
Epoch: 6, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.848 Vali Acc: 0.500 Test Loss: 0.848 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6323911
	speed: 0.6788s/iter; left time: 23477.0841s
	iters: 200, epoch: 7 | loss: 0.7381175
	speed: 0.2055s/iter; left time: 7088.3135s
	iters: 300, epoch: 7 | loss: 0.6801686
	speed: 0.1684s/iter; left time: 5790.6730s
Epoch: 7 cost time: 67.21378540992737
Epoch: 7, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6889547
	speed: 0.6245s/iter; left time: 21369.9584s
	iters: 200, epoch: 8 | loss: 0.7017409
	speed: 0.2023s/iter; left time: 6903.5911s
	iters: 300, epoch: 8 | loss: 0.7425603
	speed: 0.1675s/iter; left time: 5699.3737s
Epoch: 8 cost time: 69.18574166297913
Epoch: 8, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.7144954
	speed: 0.6379s/iter; left time: 21592.4152s
	iters: 200, epoch: 9 | loss: 0.6598578
	speed: 0.1854s/iter; left time: 6256.8983s
	iters: 300, epoch: 9 | loss: 0.6907465
	speed: 0.1850s/iter; left time: 6225.4644s
Epoch: 9 cost time: 70.61762261390686
Epoch: 9, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.7323206
	speed: 0.6466s/iter; left time: 21647.0146s
	iters: 200, epoch: 10 | loss: 0.6633846
	speed: 0.1870s/iter; left time: 6243.4206s
	iters: 300, epoch: 10 | loss: 0.6987442
	speed: 0.1855s/iter; left time: 6174.8120s
Epoch: 10 cost time: 70.64731073379517
Epoch: 10, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.7195868
	speed: 0.6248s/iter; left time: 20686.2096s
	iters: 200, epoch: 11 | loss: 0.6876996
	speed: 0.2050s/iter; left time: 6767.8095s
	iters: 300, epoch: 11 | loss: 0.6965693
	speed: 0.2098s/iter; left time: 6903.7562s
Epoch: 11 cost time: 73.34854221343994
Epoch: 11, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.6604508
	speed: 0.6279s/iter; left time: 20558.1603s
	iters: 200, epoch: 12 | loss: 0.7004038
	speed: 0.1982s/iter; left time: 6468.4922s
	iters: 300, epoch: 12 | loss: 0.6874346
	speed: 0.1835s/iter; left time: 5970.7739s
Epoch: 12 cost time: 71.58192944526672
Epoch: 12, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.7144986
	speed: 0.6122s/iter; left time: 19818.2064s
	iters: 200, epoch: 13 | loss: 0.6858485
	speed: 0.1813s/iter; left time: 5850.3249s
	iters: 300, epoch: 13 | loss: 0.6889235
	speed: 0.1956s/iter; left time: 6292.9142s
Epoch: 13 cost time: 69.70043587684631
Epoch: 13, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.6990442
	speed: 0.6689s/iter; left time: 21406.6342s
	iters: 200, epoch: 14 | loss: 0.6731712
	speed: 0.2023s/iter; left time: 6453.4561s
	iters: 300, epoch: 14 | loss: 0.7109670
	speed: 0.1920s/iter; left time: 6107.8569s
Epoch: 14 cost time: 72.64879965782166
Epoch: 14, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.6851857
	speed: 0.6452s/iter; left time: 20411.9472s
	iters: 200, epoch: 15 | loss: 0.6913480
	speed: 0.1686s/iter; left time: 5317.4655s
	iters: 300, epoch: 15 | loss: 0.7325980
	speed: 0.1868s/iter; left time: 5871.4010s
Epoch: 15 cost time: 65.7202775478363
Epoch: 15, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6163450624290578
model parameter : 3146686
model size : 14.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7030196
	speed: 0.2356s/iter; left time: 8669.4436s
	iters: 200, epoch: 1 | loss: 0.5771058
	speed: 0.1835s/iter; left time: 6735.7333s
	iters: 300, epoch: 1 | loss: 1.1289165
	speed: 0.1562s/iter; left time: 5718.8644s
Epoch: 1 cost time: 70.1239025592804
Epoch: 1, Steps: 369 | Train Loss: 0.787 Vali Loss: 0.851 Vali Acc: 0.619 Test Loss: 0.851 Test Acc: 0.619
Validation loss decreased (inf --> -0.618890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6943418
	speed: 0.6779s/iter; left time: 24696.8892s
	iters: 200, epoch: 2 | loss: 0.5698285
	speed: 0.1868s/iter; left time: 6786.8052s
	iters: 300, epoch: 2 | loss: 0.6008419
	speed: 0.1612s/iter; left time: 5841.3090s
Epoch: 2 cost time: 69.39492797851562
Epoch: 2, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.746 Vali Acc: 0.594 Test Loss: 0.746 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3675682
	speed: 0.6030s/iter; left time: 21745.6421s
	iters: 200, epoch: 3 | loss: 1.2390909
	speed: 0.1594s/iter; left time: 5733.8533s
	iters: 300, epoch: 3 | loss: 0.3873864
	speed: 0.1874s/iter; left time: 6719.3850s
Epoch: 3 cost time: 68.52750015258789
Epoch: 3, Steps: 369 | Train Loss: 0.651 Vali Loss: 0.730 Vali Acc: 0.607 Test Loss: 0.730 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6179219
	speed: 0.6742s/iter; left time: 24065.6450s
	iters: 200, epoch: 4 | loss: 0.4449292
	speed: 0.1784s/iter; left time: 6349.9899s
	iters: 300, epoch: 4 | loss: 1.1661263
	speed: 0.1754s/iter; left time: 6227.0933s
Epoch: 4 cost time: 68.06262159347534
Epoch: 4, Steps: 369 | Train Loss: 0.665 Vali Loss: 0.729 Vali Acc: 0.593 Test Loss: 0.729 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6293556
	speed: 0.6220s/iter; left time: 21970.8493s
	iters: 200, epoch: 5 | loss: 0.4717368
	speed: 0.2028s/iter; left time: 7142.3857s
	iters: 300, epoch: 5 | loss: 0.9120256
	speed: 0.1707s/iter; left time: 5997.4238s
Epoch: 5 cost time: 68.69884777069092
Epoch: 5, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.672 Vali Acc: 0.581 Test Loss: 0.672 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6773651
	speed: 0.5791s/iter; left time: 20244.5769s
	iters: 200, epoch: 6 | loss: 0.7307186
	speed: 0.1730s/iter; left time: 6031.5440s
	iters: 300, epoch: 6 | loss: 0.7370903
	speed: 0.1683s/iter; left time: 5848.9760s
Epoch: 6 cost time: 66.45014214515686
Epoch: 6, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6844876
	speed: 0.6468s/iter; left time: 22372.0768s
	iters: 200, epoch: 7 | loss: 0.6811093
	speed: 0.1682s/iter; left time: 5800.2371s
	iters: 300, epoch: 7 | loss: 0.6863598
	speed: 0.1707s/iter; left time: 5870.4147s
Epoch: 7 cost time: 65.64730191230774
Epoch: 7, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7116275
	speed: 0.6350s/iter; left time: 21728.3416s
	iters: 200, epoch: 8 | loss: 0.6943073
	speed: 0.2126s/iter; left time: 7254.3038s
	iters: 300, epoch: 8 | loss: 0.6693978
	speed: 0.1883s/iter; left time: 6406.6111s
Epoch: 8 cost time: 70.92023992538452
Epoch: 8, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7069016
	speed: 0.6682s/iter; left time: 22618.5447s
	iters: 200, epoch: 9 | loss: 0.6654031
	speed: 0.1553s/iter; left time: 5242.2198s
	iters: 300, epoch: 9 | loss: 0.6993344
	speed: 0.1560s/iter; left time: 5249.5121s
Epoch: 9 cost time: 65.20253014564514
Epoch: 9, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6728233
	speed: 0.6497s/iter; left time: 21751.5498s
	iters: 200, epoch: 10 | loss: 0.6638939
	speed: 0.1834s/iter; left time: 6122.8042s
	iters: 300, epoch: 10 | loss: 0.7003812
	speed: 0.1578s/iter; left time: 5252.9652s
Epoch: 10 cost time: 64.47798919677734
Epoch: 10, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6881980
	speed: 0.6079s/iter; left time: 20126.8091s
	iters: 200, epoch: 11 | loss: 0.6883840
	speed: 0.1819s/iter; left time: 6003.5077s
	iters: 300, epoch: 11 | loss: 0.7482973
	speed: 0.2088s/iter; left time: 6872.1822s
Epoch: 11 cost time: 70.03718900680542
Epoch: 11, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6188989784335982
model parameter : 3145150
model size : 14.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6157621
	speed: 0.1783s/iter; left time: 6561.3282s
	iters: 200, epoch: 1 | loss: 0.7616290
	speed: 0.1787s/iter; left time: 6559.3387s
	iters: 300, epoch: 1 | loss: 0.8495675
	speed: 0.1839s/iter; left time: 6730.6690s
Epoch: 1 cost time: 66.23307466506958
Epoch: 1, Steps: 369 | Train Loss: 0.793 Vali Loss: 0.657 Vali Acc: 0.667 Test Loss: 0.657 Test Acc: 0.667
Validation loss decreased (inf --> -0.666566).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4567369
	speed: 0.5921s/iter; left time: 21572.2258s
	iters: 200, epoch: 2 | loss: 0.6285478
	speed: 0.1574s/iter; left time: 5720.2971s
	iters: 300, epoch: 2 | loss: 0.5828987
	speed: 0.1732s/iter; left time: 6273.6891s
Epoch: 2 cost time: 61.19720411300659
Epoch: 2, Steps: 369 | Train Loss: 0.677 Vali Loss: 0.887 Vali Acc: 0.592 Test Loss: 0.887 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7633224
	speed: 0.6076s/iter; left time: 21912.9024s
	iters: 200, epoch: 3 | loss: 0.6306440
	speed: 0.1811s/iter; left time: 6514.5593s
	iters: 300, epoch: 3 | loss: 0.7352373
	speed: 0.1865s/iter; left time: 6689.3934s
Epoch: 3 cost time: 66.45164203643799
Epoch: 3, Steps: 369 | Train Loss: 0.670 Vali Loss: 0.646 Vali Acc: 0.686 Test Loss: 0.646 Test Acc: 0.686
Validation loss decreased (-0.666566 --> -0.686429).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6282918
	speed: 0.6224s/iter; left time: 22215.7865s
	iters: 200, epoch: 4 | loss: 0.9164599
	speed: 0.1799s/iter; left time: 6401.9978s
	iters: 300, epoch: 4 | loss: 0.8076330
	speed: 0.1874s/iter; left time: 6652.8296s
Epoch: 4 cost time: 70.51736688613892
Epoch: 4, Steps: 369 | Train Loss: 0.667 Vali Loss: 0.625 Vali Acc: 0.647 Test Loss: 0.625 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6621972
	speed: 0.6480s/iter; left time: 22889.9650s
	iters: 200, epoch: 5 | loss: 0.5948962
	speed: 0.1777s/iter; left time: 6258.9714s
	iters: 300, epoch: 5 | loss: 0.6924729
	speed: 0.1747s/iter; left time: 6135.5972s
Epoch: 5 cost time: 66.66611814498901
Epoch: 5, Steps: 369 | Train Loss: 0.684 Vali Loss: 0.679 Vali Acc: 0.531 Test Loss: 0.679 Test Acc: 0.531
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8154448
	speed: 0.6367s/iter; left time: 22254.8541s
	iters: 200, epoch: 6 | loss: 0.7248731
	speed: 0.1999s/iter; left time: 6968.4052s
	iters: 300, epoch: 6 | loss: 0.7083020
	speed: 0.1788s/iter; left time: 6213.1773s
Epoch: 6 cost time: 69.19795227050781
Epoch: 6, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.692 Vali Acc: 0.500 Test Loss: 0.692 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7032834
	speed: 0.6210s/iter; left time: 21477.5507s
	iters: 200, epoch: 7 | loss: 0.5410559
	speed: 0.1685s/iter; left time: 5811.6788s
	iters: 300, epoch: 7 | loss: 0.6864113
	speed: 0.1694s/iter; left time: 5825.5055s
Epoch: 7 cost time: 63.159464836120605
Epoch: 7, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.0166667
	speed: 0.5993s/iter; left time: 20507.9066s
	iters: 200, epoch: 8 | loss: 0.8928911
	speed: 0.1618s/iter; left time: 5519.5129s
	iters: 300, epoch: 8 | loss: 0.7113281
	speed: 0.1608s/iter; left time: 5470.3230s
Epoch: 8 cost time: 63.5686674118042
Epoch: 8, Steps: 369 | Train Loss: 0.825 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6841561
	speed: 0.6081s/iter; left time: 20584.8643s
	iters: 200, epoch: 9 | loss: 0.7527437
	speed: 0.1574s/iter; left time: 5311.5904s
	iters: 300, epoch: 9 | loss: 0.6658891
	speed: 0.1588s/iter; left time: 5341.9249s
Epoch: 9 cost time: 60.94674110412598
Epoch: 9, Steps: 369 | Train Loss: 0.733 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7707596
	speed: 0.5647s/iter; left time: 18907.4609s
	iters: 200, epoch: 10 | loss: 0.6968377
	speed: 0.1417s/iter; left time: 4731.0328s
	iters: 300, epoch: 10 | loss: 0.7034149
	speed: 0.1328s/iter; left time: 4420.7592s
Epoch: 10 cost time: 54.14947319030762
Epoch: 10, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.696 Vali Acc: 0.501 Test Loss: 0.696 Test Acc: 0.501
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6831235
	speed: 0.5767s/iter; left time: 19093.5898s
	iters: 200, epoch: 11 | loss: 0.7396384
	speed: 0.1443s/iter; left time: 4764.2731s
	iters: 300, epoch: 11 | loss: 0.6738318
	speed: 0.1441s/iter; left time: 4744.0154s
Epoch: 11 cost time: 55.243953466415405
Epoch: 11, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.705 Vali Acc: 0.502 Test Loss: 0.705 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.7203056
	speed: 0.5706s/iter; left time: 18681.0405s
	iters: 200, epoch: 12 | loss: 0.6741129
	speed: 0.1428s/iter; left time: 4662.8154s
	iters: 300, epoch: 12 | loss: 0.7327282
	speed: 0.1314s/iter; left time: 4275.9064s
Epoch: 12 cost time: 53.53772044181824
Epoch: 12, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.714 Vali Acc: 0.501 Test Loss: 0.714 Test Acc: 0.501
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6990675
	speed: 0.5461s/iter; left time: 17679.9728s
	iters: 200, epoch: 13 | loss: 0.6909263
	speed: 0.1448s/iter; left time: 4671.9748s
	iters: 300, epoch: 13 | loss: 0.6936996
	speed: 0.1448s/iter; left time: 4660.0367s
Epoch: 13 cost time: 56.271538734436035
Epoch: 13, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.694 Vali Acc: 0.499 Test Loss: 0.694 Test Acc: 0.499
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6864358683314415
model parameter : 3143614
model size : 14.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6122450
	speed: 0.1748s/iter; left time: 6432.7020s
	iters: 200, epoch: 1 | loss: 0.7003392
	speed: 0.1438s/iter; left time: 5277.4743s
	iters: 300, epoch: 1 | loss: 0.6371523
	speed: 0.1573s/iter; left time: 5756.8086s
Epoch: 1 cost time: 58.848666191101074
Epoch: 1, Steps: 369 | Train Loss: 0.843 Vali Loss: 0.650 Vali Acc: 0.659 Test Loss: 0.650 Test Acc: 0.659
Validation loss decreased (inf --> -0.659188).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4238326
	speed: 0.5785s/iter; left time: 21076.6485s
	iters: 200, epoch: 2 | loss: 0.7113836
	speed: 0.1494s/iter; left time: 5428.9967s
	iters: 300, epoch: 2 | loss: 0.5765815
	speed: 0.1391s/iter; left time: 5041.6296s
Epoch: 2 cost time: 54.11470007896423
Epoch: 2, Steps: 369 | Train Loss: 0.677 Vali Loss: 0.644 Vali Acc: 0.679 Test Loss: 0.644 Test Acc: 0.679
Validation loss decreased (-0.659188 --> -0.679051).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6255583
	speed: 0.5664s/iter; left time: 20427.1133s
	iters: 200, epoch: 3 | loss: 0.7537726
	speed: 0.1462s/iter; left time: 5257.1778s
	iters: 300, epoch: 3 | loss: 1.0798256
	speed: 0.1351s/iter; left time: 4845.9597s
Epoch: 3 cost time: 54.6467969417572
Epoch: 3, Steps: 369 | Train Loss: 0.655 Vali Loss: 1.238 Vali Acc: 0.501 Test Loss: 1.238 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5513425
	speed: 0.5500s/iter; left time: 19631.6645s
	iters: 200, epoch: 4 | loss: 0.2976479
	speed: 0.1364s/iter; left time: 4855.7073s
	iters: 300, epoch: 4 | loss: 0.8637108
	speed: 0.1425s/iter; left time: 5058.9213s
Epoch: 4 cost time: 54.23875164985657
Epoch: 4, Steps: 369 | Train Loss: 0.617 Vali Loss: 0.785 Vali Acc: 0.634 Test Loss: 0.785 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.9505959
	speed: 0.5440s/iter; left time: 19216.4688s
	iters: 200, epoch: 5 | loss: 0.4655037
	speed: 0.1588s/iter; left time: 5594.8987s
	iters: 300, epoch: 5 | loss: 0.4977730
	speed: 0.1663s/iter; left time: 5839.5874s
Epoch: 5 cost time: 59.75017595291138
Epoch: 5, Steps: 369 | Train Loss: 0.593 Vali Loss: 0.745 Vali Acc: 0.643 Test Loss: 0.745 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3539193
	speed: 0.5522s/iter; left time: 19303.2279s
	iters: 200, epoch: 6 | loss: 0.3250876
	speed: 0.1526s/iter; left time: 5317.9866s
	iters: 300, epoch: 6 | loss: 0.6740822
	speed: 0.1479s/iter; left time: 5139.9319s
Epoch: 6 cost time: 55.54833698272705
Epoch: 6, Steps: 369 | Train Loss: 0.602 Vali Loss: 0.656 Vali Acc: 0.610 Test Loss: 0.656 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6499717
	speed: 0.5636s/iter; left time: 19494.4491s
	iters: 200, epoch: 7 | loss: 0.7756786
	speed: 0.1581s/iter; left time: 5451.9790s
	iters: 300, epoch: 7 | loss: 0.7306771
	speed: 0.1390s/iter; left time: 4778.1460s
Epoch: 7 cost time: 55.31419038772583
Epoch: 7, Steps: 369 | Train Loss: 0.628 Vali Loss: 0.657 Vali Acc: 0.619 Test Loss: 0.657 Test Acc: 0.619
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6514254
	speed: 0.5426s/iter; left time: 18566.4421s
	iters: 200, epoch: 8 | loss: 0.6789740
	speed: 0.1344s/iter; left time: 4586.6253s
	iters: 300, epoch: 8 | loss: 0.6893627
	speed: 0.1313s/iter; left time: 4466.4878s
Epoch: 8 cost time: 51.20652389526367
Epoch: 8, Steps: 369 | Train Loss: 0.696 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6764987
	speed: 0.5531s/iter; left time: 18720.8631s
	iters: 200, epoch: 9 | loss: 0.7226346
	speed: 0.1478s/iter; left time: 4986.9172s
	iters: 300, epoch: 9 | loss: 0.7903315
	speed: 0.1446s/iter; left time: 4864.5164s
Epoch: 9 cost time: 55.78162217140198
Epoch: 9, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.880 Vali Acc: 0.500 Test Loss: 0.880 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.7024291
	speed: 0.5447s/iter; left time: 18234.8853s
	iters: 200, epoch: 10 | loss: 0.6389907
	speed: 0.1460s/iter; left time: 4872.8532s
	iters: 300, epoch: 10 | loss: 0.6922918
	speed: 0.1595s/iter; left time: 5308.9436s
Epoch: 10 cost time: 59.277344942092896
Epoch: 10, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6851766
	speed: 0.5359s/iter; left time: 17742.6301s
	iters: 200, epoch: 11 | loss: 0.7151699
	speed: 0.1533s/iter; left time: 5061.8577s
	iters: 300, epoch: 11 | loss: 0.7201687
	speed: 0.1483s/iter; left time: 4881.3147s
Epoch: 11 cost time: 54.698119163513184
Epoch: 11, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.8322873
	speed: 0.5449s/iter; left time: 17842.1512s
	iters: 200, epoch: 12 | loss: 0.6952528
	speed: 0.1487s/iter; left time: 4853.3990s
	iters: 300, epoch: 12 | loss: 0.6872935
	speed: 0.1494s/iter; left time: 4860.7004s
Epoch: 12 cost time: 56.304492473602295
Epoch: 12, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6790578887627696
model parameter : 2852158
model size : 13.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6873609
	speed: 0.2037s/iter; left time: 7497.1844s
	iters: 200, epoch: 1 | loss: 0.9883262
	speed: 0.1585s/iter; left time: 5818.1910s
	iters: 300, epoch: 1 | loss: 0.5721086
	speed: 0.1775s/iter; left time: 6496.0111s
Epoch: 1 cost time: 66.12212920188904
Epoch: 1, Steps: 369 | Train Loss: 0.801 Vali Loss: 0.782 Vali Acc: 0.625 Test Loss: 0.782 Test Acc: 0.625
Validation loss decreased (inf --> -0.625134).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7661564
	speed: 0.6058s/iter; left time: 22071.9020s
	iters: 200, epoch: 2 | loss: 0.6921202
	speed: 0.1266s/iter; left time: 4599.1339s
	iters: 300, epoch: 2 | loss: 0.5286581
	speed: 0.1489s/iter; left time: 5393.3619s
Epoch: 2 cost time: 56.172606229782104
Epoch: 2, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.790 Vali Acc: 0.631 Test Loss: 0.790 Test Acc: 0.631
Validation loss decreased (-0.625134 --> -0.631093).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5140299
	speed: 0.5748s/iter; left time: 20729.5179s
	iters: 200, epoch: 3 | loss: 0.4578868
	speed: 0.1712s/iter; left time: 6157.0099s
	iters: 300, epoch: 3 | loss: 0.6291887
	speed: 0.1307s/iter; left time: 4689.0528s
Epoch: 3 cost time: 57.40457487106323
Epoch: 3, Steps: 369 | Train Loss: 0.655 Vali Loss: 0.803 Vali Acc: 0.601 Test Loss: 0.803 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4336385
	speed: 0.5888s/iter; left time: 21017.9661s
	iters: 200, epoch: 4 | loss: 0.4383563
	speed: 0.1548s/iter; left time: 5511.3995s
	iters: 300, epoch: 4 | loss: 0.6902599
	speed: 0.1603s/iter; left time: 5688.9285s
Epoch: 4 cost time: 59.6282684803009
Epoch: 4, Steps: 369 | Train Loss: 0.654 Vali Loss: 0.611 Vali Acc: 0.676 Test Loss: 0.611 Test Acc: 0.676
Validation loss decreased (-0.631093 --> -0.675647).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6176705
	speed: 0.5988s/iter; left time: 21151.4314s
	iters: 200, epoch: 5 | loss: 0.4667255
	speed: 0.1600s/iter; left time: 5635.1271s
	iters: 300, epoch: 5 | loss: 0.5877113
	speed: 0.1863s/iter; left time: 6544.3048s
Epoch: 5 cost time: 65.70247292518616
Epoch: 5, Steps: 369 | Train Loss: 0.593 Vali Loss: 0.642 Vali Acc: 0.642 Test Loss: 0.642 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7242212
	speed: 0.6069s/iter; left time: 21216.2586s
	iters: 200, epoch: 6 | loss: 0.7461843
	speed: 0.1227s/iter; left time: 4275.1278s
	iters: 300, epoch: 6 | loss: 0.7001413
	speed: 0.1261s/iter; left time: 4383.1518s
Epoch: 6 cost time: 52.84740877151489
Epoch: 6, Steps: 369 | Train Loss: 0.640 Vali Loss: 0.666 Vali Acc: 0.620 Test Loss: 0.666 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6694425
	speed: 0.5700s/iter; left time: 19714.1765s
	iters: 200, epoch: 7 | loss: 0.8103717
	speed: 0.1637s/iter; left time: 5644.9353s
	iters: 300, epoch: 7 | loss: 0.6890236
	speed: 0.1544s/iter; left time: 5309.0673s
Epoch: 7 cost time: 58.56023693084717
Epoch: 7, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.7314259
	speed: 0.5525s/iter; left time: 18905.3049s
	iters: 200, epoch: 8 | loss: 0.7451867
	speed: 0.1772s/iter; left time: 6046.0500s
	iters: 300, epoch: 8 | loss: 0.7467864
	speed: 0.1822s/iter; left time: 6196.9664s
Epoch: 8 cost time: 63.33843755722046
Epoch: 8, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.7502552
	speed: 0.5620s/iter; left time: 19023.2796s
	iters: 200, epoch: 9 | loss: 0.7510242
	speed: 0.1331s/iter; left time: 4492.3490s
	iters: 300, epoch: 9 | loss: 0.6922482
	speed: 0.1484s/iter; left time: 4994.4739s
Epoch: 9 cost time: 55.97190737724304
Epoch: 9, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6907081
	speed: 0.5813s/iter; left time: 19460.6544s
	iters: 200, epoch: 10 | loss: 0.7265648
	speed: 0.1357s/iter; left time: 4530.2500s
	iters: 300, epoch: 10 | loss: 0.7283936
	speed: 0.1556s/iter; left time: 5177.1077s
Epoch: 10 cost time: 55.90803050994873
Epoch: 10, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.7634524
	speed: 0.5920s/iter; left time: 19601.3171s
	iters: 200, epoch: 11 | loss: 0.6992195
	speed: 0.1487s/iter; left time: 4909.4350s
	iters: 300, epoch: 11 | loss: 0.6410608
	speed: 0.1503s/iter; left time: 4945.4073s
Epoch: 11 cost time: 56.39817523956299
Epoch: 11, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.6937603
	speed: 0.5264s/iter; left time: 17233.7831s
	iters: 200, epoch: 12 | loss: 0.7794928
	speed: 0.1405s/iter; left time: 4587.4763s
	iters: 300, epoch: 12 | loss: 0.6890412
	speed: 0.1518s/iter; left time: 4938.3415s
Epoch: 12 cost time: 56.631338596343994
Epoch: 12, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.6916618
	speed: 0.5589s/iter; left time: 18091.8861s
	iters: 200, epoch: 13 | loss: 0.6939334
	speed: 0.1439s/iter; left time: 4643.1178s
	iters: 300, epoch: 13 | loss: 0.7466591
	speed: 0.1562s/iter; left time: 5026.9132s
Epoch: 13 cost time: 56.821115493774414
Epoch: 13, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.7295414
	speed: 0.5268s/iter; left time: 16860.8100s
	iters: 200, epoch: 14 | loss: 0.7160494
	speed: 0.1358s/iter; left time: 4331.5855s
	iters: 300, epoch: 14 | loss: 0.7152691
	speed: 0.1500s/iter; left time: 4770.1234s
Epoch: 14 cost time: 53.336713552474976
Epoch: 14, Steps: 369 | Train Loss: 0.699 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6756526674233825
model parameter : 2850622
model size : 13.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9879813
	speed: 0.1537s/iter; left time: 5654.9355s
	iters: 200, epoch: 1 | loss: 0.5732564
	speed: 0.1347s/iter; left time: 4942.5009s
	iters: 300, epoch: 1 | loss: 0.4712735
	speed: 0.1407s/iter; left time: 5151.1270s
Epoch: 1 cost time: 52.27013659477234
Epoch: 1, Steps: 369 | Train Loss: 0.803 Vali Loss: 0.660 Vali Acc: 0.635 Test Loss: 0.660 Test Acc: 0.635
Validation loss decreased (inf --> -0.635351).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6342486
	speed: 0.4760s/iter; left time: 17342.4899s
	iters: 200, epoch: 2 | loss: 0.4698299
	speed: 0.1531s/iter; left time: 5562.2347s
	iters: 300, epoch: 2 | loss: 0.5856736
	speed: 0.1686s/iter; left time: 6109.3780s
Epoch: 2 cost time: 57.70835471153259
Epoch: 2, Steps: 369 | Train Loss: 0.697 Vali Loss: 0.774 Vali Acc: 0.615 Test Loss: 0.774 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7692090
	speed: 0.5483s/iter; left time: 19771.9305s
	iters: 200, epoch: 3 | loss: 0.6410852
	speed: 0.1435s/iter; left time: 5161.0075s
	iters: 300, epoch: 3 | loss: 1.2150955
	speed: 0.1501s/iter; left time: 5384.7744s
Epoch: 3 cost time: 54.65479874610901
Epoch: 3, Steps: 369 | Train Loss: 0.686 Vali Loss: 0.630 Vali Acc: 0.659 Test Loss: 0.630 Test Acc: 0.659
Validation loss decreased (-0.635351 --> -0.658620).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5584647
	speed: 0.5218s/iter; left time: 18624.5020s
	iters: 200, epoch: 4 | loss: 0.6255298
	speed: 0.1619s/iter; left time: 5761.8918s
	iters: 300, epoch: 4 | loss: 0.4967010
	speed: 0.1487s/iter; left time: 5277.8554s
Epoch: 4 cost time: 58.421364545822144
Epoch: 4, Steps: 369 | Train Loss: 0.647 Vali Loss: 0.683 Vali Acc: 0.654 Test Loss: 0.683 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4740503
	speed: 0.5047s/iter; left time: 17827.4256s
	iters: 200, epoch: 5 | loss: 0.5360139
	speed: 0.1370s/iter; left time: 4827.2354s
	iters: 300, epoch: 5 | loss: 0.5345952
	speed: 0.1456s/iter; left time: 5112.4604s
Epoch: 5 cost time: 51.599114418029785
Epoch: 5, Steps: 369 | Train Loss: 0.614 Vali Loss: 0.694 Vali Acc: 0.615 Test Loss: 0.694 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6433344
	speed: 0.5081s/iter; left time: 17762.7707s
	iters: 200, epoch: 6 | loss: 0.7073737
	speed: 0.1465s/iter; left time: 5104.7624s
	iters: 300, epoch: 6 | loss: 0.7920102
	speed: 0.1243s/iter; left time: 4321.0378s
Epoch: 6 cost time: 50.82276940345764
Epoch: 6, Steps: 369 | Train Loss: 0.691 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6747974
	speed: 0.4731s/iter; left time: 16362.8500s
	iters: 200, epoch: 7 | loss: 0.7243304
	speed: 0.1543s/iter; left time: 5321.9034s
	iters: 300, epoch: 7 | loss: 0.7237898
	speed: 0.1473s/iter; left time: 5065.3958s
Epoch: 7 cost time: 55.44118571281433
Epoch: 7, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7055252
	speed: 0.5244s/iter; left time: 17943.0070s
	iters: 200, epoch: 8 | loss: 0.7176384
	speed: 0.1497s/iter; left time: 5108.2907s
	iters: 300, epoch: 8 | loss: 0.6965982
	speed: 0.1424s/iter; left time: 4845.7855s
Epoch: 8 cost time: 55.961772441864014
Epoch: 8, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6779332
	speed: 0.4927s/iter; left time: 16678.9841s
	iters: 200, epoch: 9 | loss: 0.7169465
	speed: 0.1479s/iter; left time: 4992.3173s
	iters: 300, epoch: 9 | loss: 0.7968695
	speed: 0.1475s/iter; left time: 4963.5537s
Epoch: 9 cost time: 55.77873206138611
Epoch: 9, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.6748653
	speed: 0.5225s/iter; left time: 17494.1495s
	iters: 200, epoch: 10 | loss: 0.6789940
	speed: 0.1461s/iter; left time: 4875.4585s
	iters: 300, epoch: 10 | loss: 1.4680653
	speed: 0.1355s/iter; left time: 4511.0257s
Epoch: 10 cost time: 51.59025764465332
Epoch: 10, Steps: 369 | Train Loss: 0.818 Vali Loss: 1.351 Vali Acc: 0.500 Test Loss: 1.351 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.2690029
	speed: 0.4750s/iter; left time: 15727.2561s
	iters: 200, epoch: 11 | loss: 1.4769908
	speed: 0.1403s/iter; left time: 4631.2106s
	iters: 300, epoch: 11 | loss: 0.6840445
	speed: 0.1475s/iter; left time: 4855.7564s
Epoch: 11 cost time: 53.490501165390015
Epoch: 11, Steps: 369 | Train Loss: 0.918 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.6558230
	speed: 0.5341s/iter; left time: 17487.5975s
	iters: 200, epoch: 12 | loss: 0.7017752
	speed: 0.1237s/iter; left time: 4037.9363s
	iters: 300, epoch: 12 | loss: 0.8454887
	speed: 0.1464s/iter; left time: 4764.8823s
Epoch: 12 cost time: 51.206493854522705
Epoch: 12, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.7002640
	speed: 0.4910s/iter; left time: 15894.2233s
	iters: 200, epoch: 13 | loss: 0.6806634
	speed: 0.1635s/iter; left time: 5275.5817s
	iters: 300, epoch: 13 | loss: 0.6998866
	speed: 0.1551s/iter; left time: 4990.1059s
Epoch: 13 cost time: 56.90716886520386
Epoch: 13, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6586265607264472
model parameter : 2849086
model size : 13.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9891635
	speed: 0.1652s/iter; left time: 6081.1331s
	iters: 200, epoch: 1 | loss: 0.7582884
	speed: 0.1235s/iter; left time: 4533.0633s
	iters: 300, epoch: 1 | loss: 1.9505867
	speed: 0.1273s/iter; left time: 4660.9185s
Epoch: 1 cost time: 52.13679575920105
Epoch: 1, Steps: 369 | Train Loss: 0.792 Vali Loss: 0.644 Vali Acc: 0.642 Test Loss: 0.644 Test Acc: 0.642
Validation loss decreased (inf --> -0.642445).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6069645
	speed: 0.5176s/iter; left time: 18858.1973s
	iters: 200, epoch: 2 | loss: 1.2033981
	speed: 0.1281s/iter; left time: 4652.8693s
	iters: 300, epoch: 2 | loss: 0.3403722
	speed: 0.1269s/iter; left time: 4599.1603s
Epoch: 2 cost time: 48.874048948287964
Epoch: 2, Steps: 369 | Train Loss: 0.698 Vali Loss: 0.865 Vali Acc: 0.570 Test Loss: 0.865 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5796763
	speed: 0.4993s/iter; left time: 18006.9216s
	iters: 200, epoch: 3 | loss: 1.0324302
	speed: 0.1425s/iter; left time: 5125.3855s
	iters: 300, epoch: 3 | loss: 0.4304165
	speed: 0.1317s/iter; left time: 4721.8748s
Epoch: 3 cost time: 50.4025993347168
Epoch: 3, Steps: 369 | Train Loss: 0.651 Vali Loss: 0.899 Vali Acc: 0.567 Test Loss: 0.899 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6579853
	speed: 0.4699s/iter; left time: 16773.5168s
	iters: 200, epoch: 4 | loss: 1.0388944
	speed: 0.1332s/iter; left time: 4741.4399s
	iters: 300, epoch: 4 | loss: 0.6191675
	speed: 0.1304s/iter; left time: 4630.1552s
Epoch: 4 cost time: 49.26104235649109
Epoch: 4, Steps: 369 | Train Loss: 0.654 Vali Loss: 0.705 Vali Acc: 0.573 Test Loss: 0.705 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.4414271
	speed: 0.4716s/iter; left time: 16658.9697s
	iters: 200, epoch: 5 | loss: 0.4692666
	speed: 0.1482s/iter; left time: 5221.7909s
	iters: 300, epoch: 5 | loss: 0.8688819
	speed: 0.1408s/iter; left time: 4946.1675s
Epoch: 5 cost time: 52.50490641593933
Epoch: 5, Steps: 369 | Train Loss: 0.624 Vali Loss: 0.673 Vali Acc: 0.589 Test Loss: 0.673 Test Acc: 0.589
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.0361621
	speed: 0.4957s/iter; left time: 17328.0555s
	iters: 200, epoch: 6 | loss: 0.7418036
	speed: 0.1239s/iter; left time: 4319.9730s
	iters: 300, epoch: 6 | loss: 0.6834158
	speed: 0.1309s/iter; left time: 4549.1630s
Epoch: 6 cost time: 50.09646964073181
Epoch: 6, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6963216
	speed: 0.5212s/iter; left time: 18025.7930s
	iters: 200, epoch: 7 | loss: 0.7811087
	speed: 0.1332s/iter; left time: 4593.5127s
	iters: 300, epoch: 7 | loss: 0.6378651
	speed: 0.1139s/iter; left time: 3915.2029s
Epoch: 7 cost time: 48.693862438201904
Epoch: 7, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7297791
	speed: 0.5124s/iter; left time: 17533.5945s
	iters: 200, epoch: 8 | loss: 0.6801236
	speed: 0.1452s/iter; left time: 4952.6597s
	iters: 300, epoch: 8 | loss: 0.7182100
	speed: 0.1264s/iter; left time: 4298.2437s
Epoch: 8 cost time: 52.70760703086853
Epoch: 8, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.692 Vali Acc: 0.500 Test Loss: 0.692 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6661135
	speed: 0.4864s/iter; left time: 16462.9106s
	iters: 200, epoch: 9 | loss: 0.6722757
	speed: 0.1458s/iter; left time: 4921.9449s
	iters: 300, epoch: 9 | loss: 0.6948192
	speed: 0.1312s/iter; left time: 4416.1522s
Epoch: 9 cost time: 52.713395833969116
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.5929983
	speed: 0.5279s/iter; left time: 17674.6951s
	iters: 200, epoch: 10 | loss: 0.7195369
	speed: 0.1352s/iter; left time: 4511.5867s
	iters: 300, epoch: 10 | loss: 0.6924214
	speed: 0.1263s/iter; left time: 4204.4608s
Epoch: 10 cost time: 50.65619611740112
Epoch: 10, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.7045594
	speed: 0.5063s/iter; left time: 16763.2317s
	iters: 200, epoch: 11 | loss: 0.6985991
	speed: 0.1516s/iter; left time: 5003.7498s
	iters: 300, epoch: 11 | loss: 0.7197433
	speed: 0.1361s/iter; left time: 4478.1682s
Epoch: 11 cost time: 54.299095153808594
Epoch: 11, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6424517593643587
model parameter : 2847550
model size : 13.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6411481
	speed: 0.1408s/iter; left time: 5181.2949s
	iters: 200, epoch: 1 | loss: 0.8223650
	speed: 0.1312s/iter; left time: 4813.6140s
	iters: 300, epoch: 1 | loss: 0.4567275
	speed: 0.1336s/iter; left time: 4890.1994s
Epoch: 1 cost time: 48.976696491241455
Epoch: 1, Steps: 369 | Train Loss: 0.744 Vali Loss: 0.684 Vali Acc: 0.643 Test Loss: 0.684 Test Acc: 0.643
Validation loss decreased (inf --> -0.642729).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9127643
	speed: 0.4684s/iter; left time: 17066.3151s
	iters: 200, epoch: 2 | loss: 0.5655012
	speed: 0.1165s/iter; left time: 4234.0425s
	iters: 300, epoch: 2 | loss: 0.4237532
	speed: 0.1231s/iter; left time: 4459.1747s
Epoch: 2 cost time: 45.58081889152527
Epoch: 2, Steps: 369 | Train Loss: 0.664 Vali Loss: 0.648 Vali Acc: 0.645 Test Loss: 0.648 Test Acc: 0.645
Validation loss decreased (-0.642729 --> -0.644999).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8168142
	speed: 0.4992s/iter; left time: 18004.1844s
	iters: 200, epoch: 3 | loss: 1.0342808
	speed: 0.1329s/iter; left time: 4779.2423s
	iters: 300, epoch: 3 | loss: 0.8003671
	speed: 0.1360s/iter; left time: 4878.0699s
Epoch: 3 cost time: 51.42964196205139
Epoch: 3, Steps: 369 | Train Loss: 0.639 Vali Loss: 0.674 Vali Acc: 0.610 Test Loss: 0.674 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4882270
	speed: 0.4973s/iter; left time: 17751.2317s
	iters: 200, epoch: 4 | loss: 0.9869072
	speed: 0.1339s/iter; left time: 4767.7968s
	iters: 300, epoch: 4 | loss: 0.8712255
	speed: 0.1192s/iter; left time: 4231.0697s
Epoch: 4 cost time: 49.39677810668945
Epoch: 4, Steps: 369 | Train Loss: 0.626 Vali Loss: 0.661 Vali Acc: 0.649 Test Loss: 0.661 Test Acc: 0.649
Validation loss decreased (-0.644999 --> -0.648972).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5031983
	speed: 0.5212s/iter; left time: 18409.9850s
	iters: 200, epoch: 5 | loss: 0.6974222
	speed: 0.1323s/iter; left time: 4661.9687s
	iters: 300, epoch: 5 | loss: 0.7449669
	speed: 0.1396s/iter; left time: 4904.0327s
Epoch: 5 cost time: 50.772883892059326
Epoch: 5, Steps: 369 | Train Loss: 0.613 Vali Loss: 0.725 Vali Acc: 0.624 Test Loss: 0.725 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6631504
	speed: 0.5158s/iter; left time: 18030.3449s
	iters: 200, epoch: 6 | loss: 0.8413455
	speed: 0.1431s/iter; left time: 4987.5329s
	iters: 300, epoch: 6 | loss: 0.7014142
	speed: 0.1461s/iter; left time: 5079.5431s
Epoch: 6 cost time: 55.08453392982483
Epoch: 6, Steps: 369 | Train Loss: 0.586 Vali Loss: 0.632 Vali Acc: 0.659 Test Loss: 0.632 Test Acc: 0.659
Validation loss decreased (-0.648972 --> -0.659472).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4913285
	speed: 0.5032s/iter; left time: 17404.3586s
	iters: 200, epoch: 7 | loss: 0.4973431
	speed: 0.1324s/iter; left time: 4567.3535s
	iters: 300, epoch: 7 | loss: 0.5162928
	speed: 0.1395s/iter; left time: 4796.5588s
Epoch: 7 cost time: 49.990143060684204
Epoch: 7, Steps: 369 | Train Loss: 0.545 Vali Loss: 0.646 Vali Acc: 0.663 Test Loss: 0.646 Test Acc: 0.663
Validation loss decreased (-0.659472 --> -0.662877).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2526367
	speed: 0.5229s/iter; left time: 17891.4336s
	iters: 200, epoch: 8 | loss: 0.6663104
	speed: 0.1415s/iter; left time: 4826.1258s
	iters: 300, epoch: 8 | loss: 0.7337133
	speed: 0.1249s/iter; left time: 4249.8696s
Epoch: 8 cost time: 53.11954092979431
Epoch: 8, Steps: 369 | Train Loss: 0.511 Vali Loss: 0.660 Vali Acc: 0.668 Test Loss: 0.660 Test Acc: 0.668
Validation loss decreased (-0.662877 --> -0.667701).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5824231
	speed: 0.5071s/iter; left time: 17166.1592s
	iters: 200, epoch: 9 | loss: 0.5158606
	speed: 0.1397s/iter; left time: 4716.1582s
	iters: 300, epoch: 9 | loss: 0.5039952
	speed: 0.1336s/iter; left time: 4495.5779s
Epoch: 9 cost time: 49.86770009994507
Epoch: 9, Steps: 369 | Train Loss: 0.482 Vali Loss: 0.632 Vali Acc: 0.674 Test Loss: 0.632 Test Acc: 0.674
Validation loss decreased (-0.667701 --> -0.674228).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2127830
	speed: 0.5058s/iter; left time: 16933.7610s
	iters: 200, epoch: 10 | loss: 0.6611862
	speed: 0.1283s/iter; left time: 4282.0319s
	iters: 300, epoch: 10 | loss: 0.7188816
	speed: 0.1300s/iter; left time: 4325.3463s
Epoch: 10 cost time: 49.142807483673096
Epoch: 10, Steps: 369 | Train Loss: 0.461 Vali Loss: 0.659 Vali Acc: 0.648 Test Loss: 0.659 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.3949157
	speed: 0.5152s/iter; left time: 17058.9576s
	iters: 200, epoch: 11 | loss: 0.2386575
	speed: 0.1373s/iter; left time: 4532.5804s
	iters: 300, epoch: 11 | loss: 0.3911021
	speed: 0.1520s/iter; left time: 5003.5264s
Epoch: 11 cost time: 54.46461486816406
Epoch: 11, Steps: 369 | Train Loss: 0.428 Vali Loss: 0.725 Vali Acc: 0.654 Test Loss: 0.725 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.2710007
	speed: 0.5165s/iter; left time: 16910.3855s
	iters: 200, epoch: 12 | loss: 0.2920454
	speed: 0.1357s/iter; left time: 4428.6877s
	iters: 300, epoch: 12 | loss: 0.4013880
	speed: 0.1314s/iter; left time: 4275.5676s
Epoch: 12 cost time: 50.651287317276
Epoch: 12, Steps: 369 | Train Loss: 0.400 Vali Loss: 0.743 Vali Acc: 0.661 Test Loss: 0.743 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1848753
	speed: 0.4979s/iter; left time: 16120.0710s
	iters: 200, epoch: 13 | loss: 0.2085279
	speed: 0.1330s/iter; left time: 4292.8795s
	iters: 300, epoch: 13 | loss: 0.2607079
	speed: 0.1432s/iter; left time: 4608.7636s
Epoch: 13 cost time: 52.62901043891907
Epoch: 13, Steps: 369 | Train Loss: 0.355 Vali Loss: 0.740 Vali Acc: 0.664 Test Loss: 0.740 Test Acc: 0.664
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.6358209
	speed: 0.5222s/iter; left time: 16711.1556s
	iters: 200, epoch: 14 | loss: 0.5191849
	speed: 0.1481s/iter; left time: 4725.2169s
	iters: 300, epoch: 14 | loss: 0.3271205
	speed: 0.1429s/iter; left time: 4543.5018s
Epoch: 14 cost time: 52.78480625152588
Epoch: 14, Steps: 369 | Train Loss: 0.407 Vali Loss: 0.855 Vali Acc: 0.654 Test Loss: 0.855 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1274175
	speed: 0.4924s/iter; left time: 15577.3029s
	iters: 200, epoch: 15 | loss: 0.4973723
	speed: 0.1362s/iter; left time: 4296.3053s
	iters: 300, epoch: 15 | loss: 0.2079509
	speed: 0.1363s/iter; left time: 4284.6958s
Epoch: 15 cost time: 52.71332335472107
Epoch: 15, Steps: 369 | Train Loss: 0.353 Vali Loss: 0.739 Vali Acc: 0.670 Test Loss: 0.739 Test Acc: 0.670
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.2744126
	speed: 0.5313s/iter; left time: 16611.1734s
	iters: 200, epoch: 16 | loss: 0.1824372
	speed: 0.1329s/iter; left time: 4141.5539s
	iters: 300, epoch: 16 | loss: 0.2562608
	speed: 0.1397s/iter; left time: 4340.2607s
Epoch: 16 cost time: 50.82079720497131
Epoch: 16, Steps: 369 | Train Loss: 0.304 Vali Loss: 0.934 Vali Acc: 0.648 Test Loss: 0.934 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.4002602
	speed: 0.5083s/iter; left time: 15704.2589s
	iters: 200, epoch: 17 | loss: 0.5330449
	speed: 0.1346s/iter; left time: 4145.3059s
	iters: 300, epoch: 17 | loss: 0.3400828
	speed: 0.1402s/iter; left time: 4302.6496s
Epoch: 17 cost time: 51.68943953514099
Epoch: 17, Steps: 369 | Train Loss: 0.263 Vali Loss: 1.006 Vali Acc: 0.637 Test Loss: 1.006 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.3149900
	speed: 0.5256s/iter; left time: 16046.5066s
	iters: 200, epoch: 18 | loss: 0.1027735
	speed: 0.1400s/iter; left time: 4260.9516s
	iters: 300, epoch: 18 | loss: 0.3192329
	speed: 0.1432s/iter; left time: 4342.9618s
Epoch: 18 cost time: 52.34637451171875
Epoch: 18, Steps: 369 | Train Loss: 0.236 Vali Loss: 0.943 Vali Acc: 0.665 Test Loss: 0.943 Test Acc: 0.665
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0289198
	speed: 0.5144s/iter; left time: 15514.1768s
	iters: 200, epoch: 19 | loss: 0.4402169
	speed: 0.1285s/iter; left time: 3861.7934s
	iters: 300, epoch: 19 | loss: 0.1048270
	speed: 0.1492s/iter; left time: 4470.3577s
Epoch: 19 cost time: 52.85731363296509
Epoch: 19, Steps: 369 | Train Loss: 0.211 Vali Loss: 0.883 Vali Acc: 0.648 Test Loss: 0.883 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.674233825198638
model parameter : 1877118
model size : 8.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7055948
	speed: 0.1548s/iter; left time: 5695.6091s
	iters: 200, epoch: 1 | loss: 0.3679106
	speed: 0.1329s/iter; left time: 4876.2181s
	iters: 300, epoch: 1 | loss: 0.5843225
	speed: 0.1297s/iter; left time: 4747.5451s
Epoch: 1 cost time: 51.657140254974365
Epoch: 1, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.715 Vali Acc: 0.638 Test Loss: 0.715 Test Acc: 0.638
Validation loss decreased (inf --> -0.638188).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5591528
	speed: 0.5231s/iter; left time: 19058.0852s
	iters: 200, epoch: 2 | loss: 0.5027426
	speed: 0.1355s/iter; left time: 4921.3264s
	iters: 300, epoch: 2 | loss: 0.6087548
	speed: 0.1261s/iter; left time: 4569.3234s
Epoch: 2 cost time: 51.424803018569946
Epoch: 2, Steps: 369 | Train Loss: 0.660 Vali Loss: 0.728 Vali Acc: 0.618 Test Loss: 0.728 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9933351
	speed: 0.5056s/iter; left time: 18235.1509s
	iters: 200, epoch: 3 | loss: 0.7961850
	speed: 0.1336s/iter; left time: 4805.0203s
	iters: 300, epoch: 3 | loss: 0.7939603
	speed: 0.1307s/iter; left time: 4686.4535s
Epoch: 3 cost time: 49.85065221786499
Epoch: 3, Steps: 369 | Train Loss: 0.648 Vali Loss: 0.681 Vali Acc: 0.661 Test Loss: 0.681 Test Acc: 0.661
Validation loss decreased (-0.638188 --> -0.661457).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5807366
	speed: 0.5061s/iter; left time: 18063.3557s
	iters: 200, epoch: 4 | loss: 0.7635747
	speed: 0.1179s/iter; left time: 4196.5120s
	iters: 300, epoch: 4 | loss: 0.5869473
	speed: 0.1220s/iter; left time: 4329.9677s
Epoch: 4 cost time: 48.5206823348999
Epoch: 4, Steps: 369 | Train Loss: 0.624 Vali Loss: 0.799 Vali Acc: 0.629 Test Loss: 0.799 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5492294
	speed: 0.5323s/iter; left time: 18803.8571s
	iters: 200, epoch: 5 | loss: 0.6815385
	speed: 0.1296s/iter; left time: 4564.9458s
	iters: 300, epoch: 5 | loss: 0.5227560
	speed: 0.1391s/iter; left time: 4884.8636s
Epoch: 5 cost time: 50.61396098136902
Epoch: 5, Steps: 369 | Train Loss: 0.593 Vali Loss: 0.651 Vali Acc: 0.652 Test Loss: 0.651 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5811512
	speed: 0.5079s/iter; left time: 17753.4615s
	iters: 200, epoch: 6 | loss: 0.4772689
	speed: 0.1291s/iter; left time: 4498.6208s
	iters: 300, epoch: 6 | loss: 0.2667738
	speed: 0.1313s/iter; left time: 4563.7832s
Epoch: 6 cost time: 48.97309756278992
Epoch: 6, Steps: 369 | Train Loss: 0.545 Vali Loss: 0.653 Vali Acc: 0.656 Test Loss: 0.653 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6798040
	speed: 0.4851s/iter; left time: 16779.0784s
	iters: 200, epoch: 7 | loss: 0.7112145
	speed: 0.1448s/iter; left time: 4993.9639s
	iters: 300, epoch: 7 | loss: 0.6040956
	speed: 0.1490s/iter; left time: 5125.2924s
Epoch: 7 cost time: 52.27353048324585
Epoch: 7, Steps: 369 | Train Loss: 0.522 Vali Loss: 0.639 Vali Acc: 0.647 Test Loss: 0.639 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6677770
	speed: 0.5057s/iter; left time: 17303.9636s
	iters: 200, epoch: 8 | loss: 0.4022500
	speed: 0.1295s/iter; left time: 4417.4643s
	iters: 300, epoch: 8 | loss: 0.5478365
	speed: 0.1328s/iter; left time: 4519.1935s
Epoch: 8 cost time: 49.38994860649109
Epoch: 8, Steps: 369 | Train Loss: 0.487 Vali Loss: 0.627 Vali Acc: 0.659 Test Loss: 0.627 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.4442725
	speed: 0.4949s/iter; left time: 16750.4984s
	iters: 200, epoch: 9 | loss: 0.5201626
	speed: 0.1359s/iter; left time: 4587.1815s
	iters: 300, epoch: 9 | loss: 0.4948231
	speed: 0.1302s/iter; left time: 4382.2439s
Epoch: 9 cost time: 50.085426330566406
Epoch: 9, Steps: 369 | Train Loss: 0.463 Vali Loss: 0.731 Vali Acc: 0.647 Test Loss: 0.731 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.4200181
	speed: 0.5154s/iter; left time: 17255.0719s
	iters: 200, epoch: 10 | loss: 0.5881495
	speed: 0.1245s/iter; left time: 4155.1752s
	iters: 300, epoch: 10 | loss: 0.3118821
	speed: 0.1243s/iter; left time: 4137.5973s
Epoch: 10 cost time: 49.20289921760559
Epoch: 10, Steps: 369 | Train Loss: 0.439 Vali Loss: 0.665 Vali Acc: 0.668 Test Loss: 0.665 Test Acc: 0.668
Validation loss decreased (-0.661457 --> -0.667984).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.5045594
	speed: 0.5210s/iter; left time: 17251.5688s
	iters: 200, epoch: 11 | loss: 0.4259640
	speed: 0.1357s/iter; left time: 4478.1593s
	iters: 300, epoch: 11 | loss: 0.3824498
	speed: 0.1315s/iter; left time: 4328.8207s
Epoch: 11 cost time: 49.69372749328613
Epoch: 11, Steps: 369 | Train Loss: 0.426 Vali Loss: 0.664 Vali Acc: 0.658 Test Loss: 0.664 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5655843
	speed: 0.4877s/iter; left time: 15969.3119s
	iters: 200, epoch: 12 | loss: 0.5183186
	speed: 0.1338s/iter; left time: 4367.5942s
	iters: 300, epoch: 12 | loss: 0.3952938
	speed: 0.1380s/iter; left time: 4489.7410s
Epoch: 12 cost time: 50.50154161453247
Epoch: 12, Steps: 369 | Train Loss: 0.389 Vali Loss: 0.679 Vali Acc: 0.667 Test Loss: 0.679 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.3109857
	speed: 0.4958s/iter; left time: 16051.8217s
	iters: 200, epoch: 13 | loss: 0.1924163
	speed: 0.1365s/iter; left time: 4404.0219s
	iters: 300, epoch: 13 | loss: 0.4033709
	speed: 0.1357s/iter; left time: 4364.7941s
Epoch: 13 cost time: 50.724287271499634
Epoch: 13, Steps: 369 | Train Loss: 0.355 Vali Loss: 0.771 Vali Acc: 0.661 Test Loss: 0.771 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.5338825
	speed: 0.4763s/iter; left time: 15242.0527s
	iters: 200, epoch: 14 | loss: 0.3552229
	speed: 0.1440s/iter; left time: 4592.7780s
	iters: 300, epoch: 14 | loss: 0.6444476
	speed: 0.1316s/iter; left time: 4184.0309s
Epoch: 14 cost time: 50.3995521068573
Epoch: 14, Steps: 369 | Train Loss: 0.325 Vali Loss: 0.752 Vali Acc: 0.659 Test Loss: 0.752 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1856148
	speed: 0.4917s/iter; left time: 15556.0218s
	iters: 200, epoch: 15 | loss: 0.2045940
	speed: 0.1243s/iter; left time: 3918.5395s
	iters: 300, epoch: 15 | loss: 0.2242977
	speed: 0.1333s/iter; left time: 4191.1342s
Epoch: 15 cost time: 48.754355669021606
Epoch: 15, Steps: 369 | Train Loss: 0.291 Vali Loss: 1.035 Vali Acc: 0.649 Test Loss: 1.035 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.2177712
	speed: 0.5038s/iter; left time: 15750.6503s
	iters: 200, epoch: 16 | loss: 0.3362991
	speed: 0.1362s/iter; left time: 4245.0735s
	iters: 300, epoch: 16 | loss: 0.1345959
	speed: 0.1290s/iter; left time: 4006.3117s
Epoch: 16 cost time: 50.22824788093567
Epoch: 16, Steps: 369 | Train Loss: 0.276 Vali Loss: 0.955 Vali Acc: 0.650 Test Loss: 0.955 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.1001941
	speed: 0.4722s/iter; left time: 14589.2226s
	iters: 200, epoch: 17 | loss: 0.2333238
	speed: 0.1327s/iter; left time: 4088.2724s
	iters: 300, epoch: 17 | loss: 0.2010107
	speed: 0.1340s/iter; left time: 4114.6556s
Epoch: 17 cost time: 49.98138999938965
Epoch: 17, Steps: 369 | Train Loss: 0.250 Vali Loss: 1.100 Vali Acc: 0.643 Test Loss: 1.100 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0744433
	speed: 0.5024s/iter; left time: 15337.5815s
	iters: 200, epoch: 18 | loss: 0.2912945
	speed: 0.1300s/iter; left time: 3956.0590s
	iters: 300, epoch: 18 | loss: 0.2881939
	speed: 0.1352s/iter; left time: 4099.2509s
Epoch: 18 cost time: 49.05859994888306
Epoch: 18, Steps: 369 | Train Loss: 0.217 Vali Loss: 1.045 Vali Acc: 0.647 Test Loss: 1.045 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1187274
	speed: 0.4969s/iter; left time: 14986.7003s
	iters: 200, epoch: 19 | loss: 0.2255592
	speed: 0.1438s/iter; left time: 4323.0856s
	iters: 300, epoch: 19 | loss: 0.1087813
	speed: 0.1295s/iter; left time: 3878.5822s
Epoch: 19 cost time: 50.80807113647461
Epoch: 19, Steps: 369 | Train Loss: 0.186 Vali Loss: 1.475 Vali Acc: 0.656 Test Loss: 1.475 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0850831
	speed: 0.5211s/iter; left time: 15524.2882s
	iters: 200, epoch: 20 | loss: 0.4184841
	speed: 0.1273s/iter; left time: 3779.6588s
	iters: 300, epoch: 20 | loss: 0.3620707
	speed: 0.1253s/iter; left time: 3707.0090s
Epoch: 20 cost time: 48.46477270126343
Epoch: 20, Steps: 369 | Train Loss: 0.199 Vali Loss: 1.125 Vali Acc: 0.646 Test Loss: 1.125 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6679909194097616
model parameter : 1876350
model size : 8.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8311146
	speed: 0.1641s/iter; left time: 6038.1590s
	iters: 200, epoch: 1 | loss: 0.5391187
	speed: 0.1304s/iter; left time: 4784.9270s
	iters: 300, epoch: 1 | loss: 0.3216593
	speed: 0.1341s/iter; left time: 4907.2893s
Epoch: 1 cost time: 52.475141763687134
Epoch: 1, Steps: 369 | Train Loss: 0.744 Vali Loss: 0.670 Vali Acc: 0.643 Test Loss: 0.670 Test Acc: 0.643
Validation loss decreased (inf --> -0.643296).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0307006
	speed: 0.4905s/iter; left time: 17869.9401s
	iters: 200, epoch: 2 | loss: 0.5514579
	speed: 0.1245s/iter; left time: 4524.0024s
	iters: 300, epoch: 2 | loss: 0.5939733
	speed: 0.1254s/iter; left time: 4544.1173s
Epoch: 2 cost time: 47.914443254470825
Epoch: 2, Steps: 369 | Train Loss: 0.646 Vali Loss: 0.661 Vali Acc: 0.593 Test Loss: 0.661 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4331442
	speed: 0.4722s/iter; left time: 17028.6876s
	iters: 200, epoch: 3 | loss: 0.7924840
	speed: 0.1239s/iter; left time: 4454.6604s
	iters: 300, epoch: 3 | loss: 0.5500907
	speed: 0.1289s/iter; left time: 4622.0844s
Epoch: 3 cost time: 47.59036898612976
Epoch: 3, Steps: 369 | Train Loss: 0.635 Vali Loss: 0.670 Vali Acc: 0.629 Test Loss: 0.670 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7612689
	speed: 0.4957s/iter; left time: 17694.4947s
	iters: 200, epoch: 4 | loss: 0.8445722
	speed: 0.1334s/iter; left time: 4748.8515s
	iters: 300, epoch: 4 | loss: 0.7842296
	speed: 0.1301s/iter; left time: 4618.1690s
Epoch: 4 cost time: 49.633684158325195
Epoch: 4, Steps: 369 | Train Loss: 0.628 Vali Loss: 0.732 Vali Acc: 0.619 Test Loss: 0.732 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3149976
	speed: 0.5000s/iter; left time: 17662.3465s
	iters: 200, epoch: 5 | loss: 0.4584208
	speed: 0.1207s/iter; left time: 4252.2339s
	iters: 300, epoch: 5 | loss: 0.4259814
	speed: 0.1273s/iter; left time: 4473.1342s
Epoch: 5 cost time: 49.64173245429993
Epoch: 5, Steps: 369 | Train Loss: 0.616 Vali Loss: 0.712 Vali Acc: 0.639 Test Loss: 0.712 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.4327165
	speed: 0.5372s/iter; left time: 18777.1916s
	iters: 200, epoch: 6 | loss: 0.5476348
	speed: 0.1071s/iter; left time: 3734.7246s
	iters: 300, epoch: 6 | loss: 0.2209269
	speed: 0.1055s/iter; left time: 3666.1900s
Epoch: 6 cost time: 45.74289393424988
Epoch: 6, Steps: 369 | Train Loss: 0.578 Vali Loss: 0.647 Vali Acc: 0.647 Test Loss: 0.647 Test Acc: 0.647
Validation loss decreased (-0.643296 --> -0.646702).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5718592
	speed: 0.4865s/iter; left time: 16825.2991s
	iters: 200, epoch: 7 | loss: 0.7482284
	speed: 0.1287s/iter; left time: 4437.5177s
	iters: 300, epoch: 7 | loss: 0.5945221
	speed: 0.1348s/iter; left time: 4634.5668s
Epoch: 7 cost time: 50.116534948349
Epoch: 7, Steps: 369 | Train Loss: 0.532 Vali Loss: 0.656 Vali Acc: 0.650 Test Loss: 0.656 Test Acc: 0.650
Validation loss decreased (-0.646702 --> -0.650391).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6041052
	speed: 0.4947s/iter; left time: 16926.6445s
	iters: 200, epoch: 8 | loss: 0.3553451
	speed: 0.1364s/iter; left time: 4654.7542s
	iters: 300, epoch: 8 | loss: 0.7150559
	speed: 0.1410s/iter; left time: 4797.6677s
Epoch: 8 cost time: 50.49396729469299
Epoch: 8, Steps: 369 | Train Loss: 0.498 Vali Loss: 0.640 Vali Acc: 0.661 Test Loss: 0.640 Test Acc: 0.661
Validation loss decreased (-0.650391 --> -0.661174).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6337514
	speed: 0.4947s/iter; left time: 16745.0663s
	iters: 200, epoch: 9 | loss: 0.3302241
	speed: 0.1314s/iter; left time: 4435.6517s
	iters: 300, epoch: 9 | loss: 0.3606807
	speed: 0.1276s/iter; left time: 4292.7939s
Epoch: 9 cost time: 49.14214110374451
Epoch: 9, Steps: 369 | Train Loss: 0.476 Vali Loss: 0.645 Vali Acc: 0.658 Test Loss: 0.645 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2112990
	speed: 0.4784s/iter; left time: 16017.0738s
	iters: 200, epoch: 10 | loss: 0.8300697
	speed: 0.1351s/iter; left time: 4508.6498s
	iters: 300, epoch: 10 | loss: 0.6559474
	speed: 0.1233s/iter; left time: 4104.4815s
Epoch: 10 cost time: 48.50207304954529
Epoch: 10, Steps: 369 | Train Loss: 0.448 Vali Loss: 0.684 Vali Acc: 0.642 Test Loss: 0.684 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.6605985
	speed: 0.5036s/iter; left time: 16673.5172s
	iters: 200, epoch: 11 | loss: 0.2428734
	speed: 0.1265s/iter; left time: 4175.7498s
	iters: 300, epoch: 11 | loss: 0.8066772
	speed: 0.1318s/iter; left time: 4338.2917s
Epoch: 11 cost time: 49.14202809333801
Epoch: 11, Steps: 369 | Train Loss: 0.433 Vali Loss: 0.707 Vali Acc: 0.669 Test Loss: 0.707 Test Acc: 0.669
Validation loss decreased (-0.661174 --> -0.669403).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7372977
	speed: 0.4789s/iter; left time: 15678.7728s
	iters: 200, epoch: 12 | loss: 0.3269719
	speed: 0.1279s/iter; left time: 4176.4582s
	iters: 300, epoch: 12 | loss: 0.3930538
	speed: 0.1255s/iter; left time: 4083.6543s
Epoch: 12 cost time: 48.7505202293396
Epoch: 12, Steps: 369 | Train Loss: 0.407 Vali Loss: 0.803 Vali Acc: 0.661 Test Loss: 0.803 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.4277800
	speed: 0.4645s/iter; left time: 15036.3677s
	iters: 200, epoch: 13 | loss: 0.4572195
	speed: 0.1215s/iter; left time: 3921.6845s
	iters: 300, epoch: 13 | loss: 0.7779562
	speed: 0.1408s/iter; left time: 4530.8891s
Epoch: 13 cost time: 47.75652742385864
Epoch: 13, Steps: 369 | Train Loss: 0.367 Vali Loss: 0.797 Vali Acc: 0.641 Test Loss: 0.797 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.8040030
	speed: 0.4819s/iter; left time: 15423.8736s
	iters: 200, epoch: 14 | loss: 0.0600717
	speed: 0.1245s/iter; left time: 3970.4829s
	iters: 300, epoch: 14 | loss: 0.2038571
	speed: 0.1258s/iter; left time: 3999.5541s
Epoch: 14 cost time: 47.58746576309204
Epoch: 14, Steps: 369 | Train Loss: 0.343 Vali Loss: 0.819 Vali Acc: 0.650 Test Loss: 0.819 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0659350
	speed: 0.4864s/iter; left time: 15388.7298s
	iters: 200, epoch: 15 | loss: 0.4636230
	speed: 0.1338s/iter; left time: 4219.5765s
	iters: 300, epoch: 15 | loss: 0.2817309
	speed: 0.1394s/iter; left time: 4383.1051s
Epoch: 15 cost time: 50.69797205924988
Epoch: 15, Steps: 369 | Train Loss: 0.314 Vali Loss: 0.913 Vali Acc: 0.658 Test Loss: 0.913 Test Acc: 0.658
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.3700838
	speed: 0.5002s/iter; left time: 15639.0964s
	iters: 200, epoch: 16 | loss: 0.3956856
	speed: 0.1214s/iter; left time: 3784.4596s
	iters: 300, epoch: 16 | loss: 0.2400139
	speed: 0.1225s/iter; left time: 3804.3266s
Epoch: 16 cost time: 46.82110404968262
Epoch: 16, Steps: 369 | Train Loss: 0.282 Vali Loss: 1.031 Vali Acc: 0.646 Test Loss: 1.031 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.3706764
	speed: 0.5009s/iter; left time: 15477.5222s
	iters: 200, epoch: 17 | loss: 0.2960616
	speed: 0.1412s/iter; left time: 4349.0490s
	iters: 300, epoch: 17 | loss: 0.3034552
	speed: 0.1313s/iter; left time: 4030.4035s
Epoch: 17 cost time: 51.337300539016724
Epoch: 17, Steps: 369 | Train Loss: 0.269 Vali Loss: 0.884 Vali Acc: 0.646 Test Loss: 0.884 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0669863
	speed: 0.4842s/iter; left time: 14781.3215s
	iters: 200, epoch: 18 | loss: 0.1889891
	speed: 0.1260s/iter; left time: 3835.2382s
	iters: 300, epoch: 18 | loss: 0.4860632
	speed: 0.1290s/iter; left time: 3912.4082s
Epoch: 18 cost time: 49.39913272857666
Epoch: 18, Steps: 369 | Train Loss: 0.215 Vali Loss: 1.005 Vali Acc: 0.652 Test Loss: 1.005 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2363010
	speed: 0.4845s/iter; left time: 14612.3220s
	iters: 200, epoch: 19 | loss: 0.0637600
	speed: 0.1289s/iter; left time: 3875.3490s
	iters: 300, epoch: 19 | loss: 0.3749833
	speed: 0.1340s/iter; left time: 4013.4528s
Epoch: 19 cost time: 49.427027463912964
Epoch: 19, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.371 Vali Acc: 0.634 Test Loss: 1.371 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.1468953
	speed: 0.5372s/iter; left time: 16004.6714s
	iters: 200, epoch: 20 | loss: 0.1549108
	speed: 0.1326s/iter; left time: 3936.4677s
	iters: 300, epoch: 20 | loss: 0.2081032
	speed: 0.1257s/iter; left time: 3720.3980s
Epoch: 20 cost time: 51.042601108551025
Epoch: 20, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.225 Vali Acc: 0.654 Test Loss: 1.225 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0331113
	speed: 0.5100s/iter; left time: 15004.8257s
	iters: 200, epoch: 21 | loss: 0.0607988
	speed: 0.1353s/iter; left time: 3967.7402s
	iters: 300, epoch: 21 | loss: 0.0962166
	speed: 0.1226s/iter; left time: 3582.4338s
Epoch: 21 cost time: 48.101261138916016
Epoch: 21, Steps: 369 | Train Loss: 0.163 Vali Loss: 1.225 Vali Acc: 0.654 Test Loss: 1.225 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6694097616345063
model parameter : 1875582
model size : 8.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9981789
	speed: 0.1558s/iter; left time: 5732.2780s
	iters: 200, epoch: 1 | loss: 1.4576203
	speed: 0.1205s/iter; left time: 4422.7045s
	iters: 300, epoch: 1 | loss: 0.7341971
	speed: 0.1338s/iter; left time: 4896.6899s
Epoch: 1 cost time: 49.910839319229126
Epoch: 1, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.676 Vali Acc: 0.665 Test Loss: 0.676 Test Acc: 0.665
Validation loss decreased (inf --> -0.665430).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4956035
	speed: 0.4837s/iter; left time: 17620.6199s
	iters: 200, epoch: 2 | loss: 0.6767318
	speed: 0.1300s/iter; left time: 4723.5872s
	iters: 300, epoch: 2 | loss: 0.6135523
	speed: 0.1354s/iter; left time: 4904.0171s
Epoch: 2 cost time: 49.11044764518738
Epoch: 2, Steps: 369 | Train Loss: 0.663 Vali Loss: 0.739 Vali Acc: 0.526 Test Loss: 0.739 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5747679
	speed: 0.5019s/iter; left time: 18099.9527s
	iters: 200, epoch: 3 | loss: 0.5896099
	speed: 0.1147s/iter; left time: 4123.6797s
	iters: 300, epoch: 3 | loss: 0.8362596
	speed: 0.1225s/iter; left time: 4392.5460s
Epoch: 3 cost time: 46.13659119606018
Epoch: 3, Steps: 369 | Train Loss: 0.648 Vali Loss: 0.680 Vali Acc: 0.627 Test Loss: 0.680 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.3535262
	speed: 0.5108s/iter; left time: 18231.6031s
	iters: 200, epoch: 4 | loss: 0.5774817
	speed: 0.1233s/iter; left time: 4388.9160s
	iters: 300, epoch: 4 | loss: 0.5373406
	speed: 0.1325s/iter; left time: 4702.7149s
Epoch: 4 cost time: 49.17937469482422
Epoch: 4, Steps: 369 | Train Loss: 0.630 Vali Loss: 0.685 Vali Acc: 0.643 Test Loss: 0.685 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6674515
	speed: 0.4841s/iter; left time: 17100.7907s
	iters: 200, epoch: 5 | loss: 0.5306522
	speed: 0.1263s/iter; left time: 4448.9709s
	iters: 300, epoch: 5 | loss: 0.7154879
	speed: 0.1314s/iter; left time: 4613.9706s
Epoch: 5 cost time: 48.10900115966797
Epoch: 5, Steps: 369 | Train Loss: 0.600 Vali Loss: 0.640 Vali Acc: 0.648 Test Loss: 0.640 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.5047161
	speed: 0.4868s/iter; left time: 17017.4348s
	iters: 200, epoch: 6 | loss: 0.5549995
	speed: 0.1372s/iter; left time: 4781.0341s
	iters: 300, epoch: 6 | loss: 0.9521734
	speed: 0.1232s/iter; left time: 4282.7326s
Epoch: 6 cost time: 49.98670268058777
Epoch: 6, Steps: 369 | Train Loss: 0.570 Vali Loss: 0.739 Vali Acc: 0.596 Test Loss: 0.739 Test Acc: 0.596
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.5123278
	speed: 0.4966s/iter; left time: 17174.6566s
	iters: 200, epoch: 7 | loss: 0.3234667
	speed: 0.1322s/iter; left time: 4559.6136s
	iters: 300, epoch: 7 | loss: 0.5020348
	speed: 0.1255s/iter; left time: 4316.2231s
Epoch: 7 cost time: 48.93498158454895
Epoch: 7, Steps: 369 | Train Loss: 0.527 Vali Loss: 0.653 Vali Acc: 0.645 Test Loss: 0.653 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.4198252
	speed: 0.5016s/iter; left time: 17163.9023s
	iters: 200, epoch: 8 | loss: 0.5398617
	speed: 0.1306s/iter; left time: 4455.6805s
	iters: 300, epoch: 8 | loss: 0.6167163
	speed: 0.1269s/iter; left time: 4318.0954s
Epoch: 8 cost time: 48.47945690155029
Epoch: 8, Steps: 369 | Train Loss: 0.508 Vali Loss: 0.626 Vali Acc: 0.665 Test Loss: 0.626 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.4642176
	speed: 0.5037s/iter; left time: 17050.5939s
	iters: 200, epoch: 9 | loss: 0.5135779
	speed: 0.1203s/iter; left time: 4059.7948s
	iters: 300, epoch: 9 | loss: 0.5184203
	speed: 0.1334s/iter; left time: 4488.3282s
Epoch: 9 cost time: 48.52535939216614
Epoch: 9, Steps: 369 | Train Loss: 0.474 Vali Loss: 0.646 Vali Acc: 0.659 Test Loss: 0.646 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.3400200
	speed: 0.4799s/iter; left time: 16068.3292s
	iters: 200, epoch: 10 | loss: 0.7277107
	speed: 0.1371s/iter; left time: 4575.8796s
	iters: 300, epoch: 10 | loss: 0.4990278
	speed: 0.1255s/iter; left time: 4177.1593s
Epoch: 10 cost time: 48.17783164978027
Epoch: 10, Steps: 369 | Train Loss: 0.475 Vali Loss: 0.647 Vali Acc: 0.665 Test Loss: 0.647 Test Acc: 0.665
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.3412970
	speed: 0.4988s/iter; left time: 16516.7715s
	iters: 200, epoch: 11 | loss: 0.3992009
	speed: 0.1257s/iter; left time: 4148.4130s
	iters: 300, epoch: 11 | loss: 0.4546576
	speed: 0.1267s/iter; left time: 4169.6906s
Epoch: 11 cost time: 48.14761471748352
Epoch: 11, Steps: 369 | Train Loss: 0.446 Vali Loss: 0.682 Vali Acc: 0.651 Test Loss: 0.682 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6654370034052214
model parameter : 1874814
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0709627
	speed: 0.1571s/iter; left time: 5782.9595s
	iters: 200, epoch: 1 | loss: 0.9636840
	speed: 0.1192s/iter; left time: 4372.9744s
	iters: 300, epoch: 1 | loss: 0.8509791
	speed: 0.1282s/iter; left time: 4690.6390s
Epoch: 1 cost time: 48.44272446632385
Epoch: 1, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.673 Vali Acc: 0.641 Test Loss: 0.673 Test Acc: 0.641
Validation loss decreased (inf --> -0.640742).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4779131
	speed: 0.4462s/iter; left time: 16255.7193s
	iters: 200, epoch: 2 | loss: 0.4642143
	speed: 0.1033s/iter; left time: 3754.6231s
	iters: 300, epoch: 2 | loss: 0.5350112
	speed: 0.1027s/iter; left time: 3720.9922s
Epoch: 2 cost time: 38.6157751083374
Epoch: 2, Steps: 369 | Train Loss: 0.670 Vali Loss: 0.924 Vali Acc: 0.533 Test Loss: 0.924 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6073055
	speed: 0.4072s/iter; left time: 14686.5528s
	iters: 200, epoch: 3 | loss: 0.3912421
	speed: 0.1111s/iter; left time: 3995.1098s
	iters: 300, epoch: 3 | loss: 0.2779825
	speed: 0.1206s/iter; left time: 4323.5666s
Epoch: 3 cost time: 42.98280668258667
Epoch: 3, Steps: 369 | Train Loss: 0.636 Vali Loss: 0.629 Vali Acc: 0.656 Test Loss: 0.629 Test Acc: 0.656
Validation loss decreased (-0.640742 --> -0.656350).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6734794
	speed: 0.4099s/iter; left time: 14631.9490s
	iters: 200, epoch: 4 | loss: 0.7606329
	speed: 0.1016s/iter; left time: 3617.0420s
	iters: 300, epoch: 4 | loss: 0.8426423
	speed: 0.1033s/iter; left time: 3664.8091s
Epoch: 4 cost time: 39.194061040878296
Epoch: 4, Steps: 369 | Train Loss: 0.605 Vali Loss: 0.717 Vali Acc: 0.635 Test Loss: 0.717 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3499179
	speed: 0.4098s/iter; left time: 14476.3377s
	iters: 200, epoch: 5 | loss: 0.5418490
	speed: 0.1181s/iter; left time: 4158.8704s
	iters: 300, epoch: 5 | loss: 0.3320594
	speed: 0.1143s/iter; left time: 4015.5941s
Epoch: 5 cost time: 43.119139671325684
Epoch: 5, Steps: 369 | Train Loss: 0.569 Vali Loss: 0.716 Vali Acc: 0.616 Test Loss: 0.716 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2165404
	speed: 0.4083s/iter; left time: 14271.3003s
	iters: 200, epoch: 6 | loss: 0.4655057
	speed: 0.0999s/iter; left time: 3480.9374s
	iters: 300, epoch: 6 | loss: 1.0385832
	speed: 0.1077s/iter; left time: 3742.6258s
Epoch: 6 cost time: 38.962284564971924
Epoch: 6, Steps: 369 | Train Loss: 0.524 Vali Loss: 0.702 Vali Acc: 0.625 Test Loss: 0.702 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4608944
	speed: 0.4023s/iter; left time: 13913.8137s
	iters: 200, epoch: 7 | loss: 0.5039709
	speed: 0.1155s/iter; left time: 3981.6304s
	iters: 300, epoch: 7 | loss: 0.5040647
	speed: 0.1107s/iter; left time: 3805.8914s
Epoch: 7 cost time: 42.58481025695801
Epoch: 7, Steps: 369 | Train Loss: 0.489 Vali Loss: 0.742 Vali Acc: 0.651 Test Loss: 0.742 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.3159027
	speed: 0.4139s/iter; left time: 14161.9916s
	iters: 200, epoch: 8 | loss: 0.3348767
	speed: 0.1109s/iter; left time: 3783.0451s
	iters: 300, epoch: 8 | loss: 0.4579861
	speed: 0.1096s/iter; left time: 3729.0365s
Epoch: 8 cost time: 41.827826738357544
Epoch: 8, Steps: 369 | Train Loss: 0.446 Vali Loss: 0.622 Vali Acc: 0.674 Test Loss: 0.622 Test Acc: 0.674
Validation loss decreased (-0.656350 --> -0.673944).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3939841
	speed: 0.4244s/iter; left time: 14366.6933s
	iters: 200, epoch: 9 | loss: 0.3600126
	speed: 0.1195s/iter; left time: 4031.7286s
	iters: 300, epoch: 9 | loss: 0.2242805
	speed: 0.1085s/iter; left time: 3651.9642s
Epoch: 9 cost time: 43.2089467048645
Epoch: 9, Steps: 369 | Train Loss: 0.409 Vali Loss: 0.672 Vali Acc: 0.667 Test Loss: 0.672 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3723251
	speed: 0.3987s/iter; left time: 13347.4285s
	iters: 200, epoch: 10 | loss: 0.3195813
	speed: 0.1110s/iter; left time: 3703.6161s
	iters: 300, epoch: 10 | loss: 0.3825002
	speed: 0.1098s/iter; left time: 3654.1888s
Epoch: 10 cost time: 40.76836681365967
Epoch: 10, Steps: 369 | Train Loss: 0.378 Vali Loss: 0.677 Vali Acc: 0.681 Test Loss: 0.677 Test Acc: 0.681
Validation loss decreased (-0.673944 --> -0.681321).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3450472
	speed: 0.4150s/iter; left time: 13742.3737s
	iters: 200, epoch: 11 | loss: 0.2625371
	speed: 0.0995s/iter; left time: 3284.4075s
	iters: 300, epoch: 11 | loss: 0.2333400
	speed: 0.1023s/iter; left time: 3368.2001s
Epoch: 11 cost time: 39.71557354927063
Epoch: 11, Steps: 369 | Train Loss: 0.341 Vali Loss: 0.850 Vali Acc: 0.663 Test Loss: 0.850 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1631669
	speed: 0.4039s/iter; left time: 13225.5832s
	iters: 200, epoch: 12 | loss: 0.6553530
	speed: 0.1046s/iter; left time: 3415.4884s
	iters: 300, epoch: 12 | loss: 0.2518926
	speed: 0.1007s/iter; left time: 3275.8509s
Epoch: 12 cost time: 39.00491809844971
Epoch: 12, Steps: 369 | Train Loss: 0.316 Vali Loss: 0.879 Vali Acc: 0.646 Test Loss: 0.879 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.3906578
	speed: 0.4105s/iter; left time: 13290.2210s
	iters: 200, epoch: 13 | loss: 0.2309286
	speed: 0.1031s/iter; left time: 3326.1213s
	iters: 300, epoch: 13 | loss: 0.1414956
	speed: 0.1089s/iter; left time: 3503.6861s
Epoch: 13 cost time: 41.743725538253784
Epoch: 13, Steps: 369 | Train Loss: 0.275 Vali Loss: 0.883 Vali Acc: 0.660 Test Loss: 0.883 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.2383159
	speed: 0.3971s/iter; left time: 12708.9817s
	iters: 200, epoch: 14 | loss: 0.2701183
	speed: 0.1079s/iter; left time: 3443.7035s
	iters: 300, epoch: 14 | loss: 0.3920354
	speed: 0.1044s/iter; left time: 3319.2344s
Epoch: 14 cost time: 39.472936391830444
Epoch: 14, Steps: 369 | Train Loss: 0.240 Vali Loss: 1.208 Vali Acc: 0.640 Test Loss: 1.208 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1043010
	speed: 0.3964s/iter; left time: 12540.5206s
	iters: 200, epoch: 15 | loss: 0.1469160
	speed: 0.1181s/iter; left time: 3723.2249s
	iters: 300, epoch: 15 | loss: 0.1960961
	speed: 0.1275s/iter; left time: 4007.5010s
Epoch: 15 cost time: 45.17352867126465
Epoch: 15, Steps: 369 | Train Loss: 0.233 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0225725
	speed: 0.4369s/iter; left time: 13659.2658s
	iters: 200, epoch: 16 | loss: 0.0678068
	speed: 0.1084s/iter; left time: 3378.1616s
	iters: 300, epoch: 16 | loss: 0.4357824
	speed: 0.1090s/iter; left time: 3386.0969s
Epoch: 16 cost time: 42.40943121910095
Epoch: 16, Steps: 369 | Train Loss: 0.195 Vali Loss: 1.120 Vali Acc: 0.658 Test Loss: 1.120 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0813805
	speed: 0.4581s/iter; left time: 14152.6120s
	iters: 200, epoch: 17 | loss: 0.1521552
	speed: 0.1155s/iter; left time: 3557.6604s
	iters: 300, epoch: 17 | loss: 0.1739819
	speed: 0.1082s/iter; left time: 3320.3971s
Epoch: 17 cost time: 42.37573528289795
Epoch: 17, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.472 Vali Acc: 0.622 Test Loss: 1.472 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0773517
	speed: 0.4210s/iter; left time: 12850.8390s
	iters: 200, epoch: 18 | loss: 0.0527513
	speed: 0.1109s/iter; left time: 3373.5795s
	iters: 300, epoch: 18 | loss: 0.0676318
	speed: 0.1099s/iter; left time: 3332.1393s
Epoch: 18 cost time: 41.582619428634644
Epoch: 18, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.241 Vali Acc: 0.655 Test Loss: 1.241 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1661894
	speed: 0.4169s/iter; left time: 12573.2224s
	iters: 200, epoch: 19 | loss: 0.0281049
	speed: 0.1053s/iter; left time: 3166.6779s
	iters: 300, epoch: 19 | loss: 0.3326585
	speed: 0.1105s/iter; left time: 3309.7762s
Epoch: 19 cost time: 42.27577042579651
Epoch: 19, Steps: 369 | Train Loss: 0.129 Vali Loss: 1.659 Vali Acc: 0.648 Test Loss: 1.659 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.2929669
	speed: 0.4240s/iter; left time: 12629.8460s
	iters: 200, epoch: 20 | loss: 0.1732141
	speed: 0.1196s/iter; left time: 3550.2555s
	iters: 300, epoch: 20 | loss: 0.0115523
	speed: 0.1243s/iter; left time: 3679.0934s
Epoch: 20 cost time: 44.50520706176758
Epoch: 20, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.260 Vali Acc: 0.650 Test Loss: 1.260 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6813280363223609
model parameter : 1282686
model size : 6.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7560016
	speed: 0.1353s/iter; left time: 4978.2788s
	iters: 200, epoch: 1 | loss: 1.3360432
	speed: 0.1122s/iter; left time: 4116.0469s
	iters: 300, epoch: 1 | loss: 0.7436837
	speed: 0.1176s/iter; left time: 4305.7712s
Epoch: 1 cost time: 45.21205234527588
Epoch: 1, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.909 Vali Acc: 0.607 Test Loss: 0.909 Test Acc: 0.607
Validation loss decreased (inf --> -0.606688).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3627632
	speed: 0.4463s/iter; left time: 16259.1286s
	iters: 200, epoch: 2 | loss: 0.5878297
	speed: 0.1113s/iter; left time: 4044.0150s
	iters: 300, epoch: 2 | loss: 0.6026593
	speed: 0.1131s/iter; left time: 4098.0070s
Epoch: 2 cost time: 41.8444037437439
Epoch: 2, Steps: 369 | Train Loss: 0.638 Vali Loss: 0.666 Vali Acc: 0.634 Test Loss: 0.666 Test Acc: 0.634
Validation loss decreased (-0.606688 --> -0.633932).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6789403
	speed: 0.4173s/iter; left time: 15049.7810s
	iters: 200, epoch: 3 | loss: 0.5786728
	speed: 0.1216s/iter; left time: 4372.0045s
	iters: 300, epoch: 3 | loss: 0.5827066
	speed: 0.1163s/iter; left time: 4171.8614s
Epoch: 3 cost time: 44.993430614471436
Epoch: 3, Steps: 369 | Train Loss: 0.637 Vali Loss: 0.809 Vali Acc: 0.620 Test Loss: 0.809 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2896705
	speed: 0.4298s/iter; left time: 15341.7421s
	iters: 200, epoch: 4 | loss: 0.7508561
	speed: 0.1178s/iter; left time: 4191.2349s
	iters: 300, epoch: 4 | loss: 0.4971561
	speed: 0.1214s/iter; left time: 4308.8682s
Epoch: 4 cost time: 45.20892333984375
Epoch: 4, Steps: 369 | Train Loss: 0.592 Vali Loss: 0.629 Vali Acc: 0.650 Test Loss: 0.629 Test Acc: 0.650
Validation loss decreased (-0.633932 --> -0.649823).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3752191
	speed: 0.4452s/iter; left time: 15725.8975s
	iters: 200, epoch: 5 | loss: 0.6077800
	speed: 0.1154s/iter; left time: 4063.4886s
	iters: 300, epoch: 5 | loss: 0.6977386
	speed: 0.1072s/iter; left time: 3766.7530s
Epoch: 5 cost time: 42.66600203514099
Epoch: 5, Steps: 369 | Train Loss: 0.568 Vali Loss: 0.664 Vali Acc: 0.641 Test Loss: 0.664 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4632022
	speed: 0.4272s/iter; left time: 14932.0314s
	iters: 200, epoch: 6 | loss: 0.5226539
	speed: 0.1207s/iter; left time: 4207.6600s
	iters: 300, epoch: 6 | loss: 0.5154634
	speed: 0.1210s/iter; left time: 4205.1439s
Epoch: 6 cost time: 44.800294160842896
Epoch: 6, Steps: 369 | Train Loss: 0.527 Vali Loss: 0.652 Vali Acc: 0.657 Test Loss: 0.652 Test Acc: 0.657
Validation loss decreased (-0.649823 --> -0.656634).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7654385
	speed: 0.4164s/iter; left time: 14401.9626s
	iters: 200, epoch: 7 | loss: 0.2331110
	speed: 0.1090s/iter; left time: 3759.1577s
	iters: 300, epoch: 7 | loss: 0.2978106
	speed: 0.1124s/iter; left time: 3865.0806s
Epoch: 7 cost time: 42.049322843551636
Epoch: 7, Steps: 369 | Train Loss: 0.475 Vali Loss: 0.647 Vali Acc: 0.661 Test Loss: 0.647 Test Acc: 0.661
Validation loss decreased (-0.656634 --> -0.660890).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3037380
	speed: 0.4220s/iter; left time: 14438.3698s
	iters: 200, epoch: 8 | loss: 0.4043443
	speed: 0.1121s/iter; left time: 3826.2837s
	iters: 300, epoch: 8 | loss: 0.3682396
	speed: 0.1103s/iter; left time: 3753.2387s
Epoch: 8 cost time: 42.448641777038574
Epoch: 8, Steps: 369 | Train Loss: 0.435 Vali Loss: 0.660 Vali Acc: 0.665 Test Loss: 0.660 Test Acc: 0.665
Validation loss decreased (-0.660890 --> -0.665430).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6620895
	speed: 0.4160s/iter; left time: 14081.2601s
	iters: 200, epoch: 9 | loss: 0.2911541
	speed: 0.1088s/iter; left time: 3670.3631s
	iters: 300, epoch: 9 | loss: 0.3695657
	speed: 0.1147s/iter; left time: 3858.2388s
Epoch: 9 cost time: 43.01947546005249
Epoch: 9, Steps: 369 | Train Loss: 0.398 Vali Loss: 0.725 Vali Acc: 0.654 Test Loss: 0.725 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3949775
	speed: 0.4422s/iter; left time: 14805.5197s
	iters: 200, epoch: 10 | loss: 0.5337383
	speed: 0.1104s/iter; left time: 3686.7498s
	iters: 300, epoch: 10 | loss: 0.1955397
	speed: 0.1138s/iter; left time: 3786.1930s
Epoch: 10 cost time: 41.599552154541016
Epoch: 10, Steps: 369 | Train Loss: 0.363 Vali Loss: 0.899 Vali Acc: 0.644 Test Loss: 0.899 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1836074
	speed: 0.4269s/iter; left time: 14134.1865s
	iters: 200, epoch: 11 | loss: 0.2221057
	speed: 0.1122s/iter; left time: 3705.3119s
	iters: 300, epoch: 11 | loss: 0.2865222
	speed: 0.1198s/iter; left time: 3941.1635s
Epoch: 11 cost time: 43.39751887321472
Epoch: 11, Steps: 369 | Train Loss: 0.347 Vali Loss: 0.840 Vali Acc: 0.657 Test Loss: 0.840 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2857876
	speed: 0.4131s/iter; left time: 13526.7615s
	iters: 200, epoch: 12 | loss: 0.2586280
	speed: 0.1107s/iter; left time: 3612.7556s
	iters: 300, epoch: 12 | loss: 0.1680502
	speed: 0.1079s/iter; left time: 3512.5973s
Epoch: 12 cost time: 42.06544327735901
Epoch: 12, Steps: 369 | Train Loss: 0.298 Vali Loss: 0.820 Vali Acc: 0.654 Test Loss: 0.820 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2798980
	speed: 0.4272s/iter; left time: 13829.1887s
	iters: 200, epoch: 13 | loss: 0.1668584
	speed: 0.1206s/iter; left time: 3893.1355s
	iters: 300, epoch: 13 | loss: 0.2598011
	speed: 0.1096s/iter; left time: 3524.5824s
Epoch: 13 cost time: 43.238588094711304
Epoch: 13, Steps: 369 | Train Loss: 0.256 Vali Loss: 0.911 Vali Acc: 0.646 Test Loss: 0.911 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0961841
	speed: 0.4029s/iter; left time: 12893.2718s
	iters: 200, epoch: 14 | loss: 0.4117423
	speed: 0.1106s/iter; left time: 3528.4315s
	iters: 300, epoch: 14 | loss: 0.5366142
	speed: 0.1095s/iter; left time: 3482.4028s
Epoch: 14 cost time: 41.61549472808838
Epoch: 14, Steps: 369 | Train Loss: 0.234 Vali Loss: 1.101 Vali Acc: 0.637 Test Loss: 1.101 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0720330
	speed: 0.4260s/iter; left time: 13477.4315s
	iters: 200, epoch: 15 | loss: 0.0930462
	speed: 0.1115s/iter; left time: 3515.9289s
	iters: 300, epoch: 15 | loss: 0.1915402
	speed: 0.1126s/iter; left time: 3538.4068s
Epoch: 15 cost time: 42.40988039970398
Epoch: 15, Steps: 369 | Train Loss: 0.216 Vali Loss: 1.161 Vali Acc: 0.616 Test Loss: 1.161 Test Acc: 0.616
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0795637
	speed: 0.4212s/iter; left time: 13170.6278s
	iters: 200, epoch: 16 | loss: 0.2325161
	speed: 0.1157s/iter; left time: 3605.6096s
	iters: 300, epoch: 16 | loss: 0.3153784
	speed: 0.1118s/iter; left time: 3472.2816s
Epoch: 16 cost time: 43.54904580116272
Epoch: 16, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.002 Vali Acc: 0.653 Test Loss: 1.002 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0606856
	speed: 0.4173s/iter; left time: 12894.8434s
	iters: 200, epoch: 17 | loss: 0.1412793
	speed: 0.1135s/iter; left time: 3496.7720s
	iters: 300, epoch: 17 | loss: 0.0721821
	speed: 0.1119s/iter; left time: 3436.0307s
Epoch: 17 cost time: 41.772499084472656
Epoch: 17, Steps: 369 | Train Loss: 0.171 Vali Loss: 1.370 Vali Acc: 0.647 Test Loss: 1.370 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.2883502
	speed: 0.4293s/iter; left time: 13106.9190s
	iters: 200, epoch: 18 | loss: 0.0598486
	speed: 0.1165s/iter; left time: 3545.7547s
	iters: 300, epoch: 18 | loss: 0.3197470
	speed: 0.1211s/iter; left time: 3674.0974s
Epoch: 18 cost time: 44.54970908164978
Epoch: 18, Steps: 369 | Train Loss: 0.158 Vali Loss: 1.492 Vali Acc: 0.641 Test Loss: 1.492 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6654370034052214
model parameter : 1281918
model size : 6.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7935033
	speed: 0.1267s/iter; left time: 4662.5721s
	iters: 200, epoch: 1 | loss: 0.8403259
	speed: 0.1153s/iter; left time: 4233.3679s
	iters: 300, epoch: 1 | loss: 1.0916512
	speed: 0.1094s/iter; left time: 4005.5986s
Epoch: 1 cost time: 42.68805265426636
Epoch: 1, Steps: 369 | Train Loss: 0.744 Vali Loss: 0.754 Vali Acc: 0.631 Test Loss: 0.754 Test Acc: 0.631
Validation loss decreased (inf --> -0.631377).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5822041
	speed: 0.3841s/iter; left time: 13993.9834s
	iters: 200, epoch: 2 | loss: 0.8262318
	speed: 0.0981s/iter; left time: 3563.7771s
	iters: 300, epoch: 2 | loss: 0.7586567
	speed: 0.1000s/iter; left time: 3623.8515s
Epoch: 2 cost time: 37.90016984939575
Epoch: 2, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.734 Vali Acc: 0.644 Test Loss: 0.734 Test Acc: 0.644
Validation loss decreased (-0.631377 --> -0.644431).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4223558
	speed: 0.3896s/iter; left time: 14050.1895s
	iters: 200, epoch: 3 | loss: 0.4935559
	speed: 0.1238s/iter; left time: 4451.1664s
	iters: 300, epoch: 3 | loss: 0.5108666
	speed: 0.1146s/iter; left time: 4111.6512s
Epoch: 3 cost time: 42.97758507728577
Epoch: 3, Steps: 369 | Train Loss: 0.637 Vali Loss: 0.680 Vali Acc: 0.629 Test Loss: 0.680 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5803791
	speed: 0.3796s/iter; left time: 13549.8915s
	iters: 200, epoch: 4 | loss: 0.5054263
	speed: 0.1070s/iter; left time: 3808.6480s
	iters: 300, epoch: 4 | loss: 0.5366601
	speed: 0.1050s/iter; left time: 3727.8898s
Epoch: 4 cost time: 39.8224458694458
Epoch: 4, Steps: 369 | Train Loss: 0.608 Vali Loss: 0.651 Vali Acc: 0.663 Test Loss: 0.651 Test Acc: 0.663
Validation loss decreased (-0.644431 --> -0.663444).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5862765
	speed: 0.3905s/iter; left time: 13795.4862s
	iters: 200, epoch: 5 | loss: 0.4930664
	speed: 0.1084s/iter; left time: 3818.4812s
	iters: 300, epoch: 5 | loss: 0.3977041
	speed: 0.1101s/iter; left time: 3866.6900s
Epoch: 5 cost time: 41.000619888305664
Epoch: 5, Steps: 369 | Train Loss: 0.568 Vali Loss: 0.660 Vali Acc: 0.651 Test Loss: 0.660 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3020934
	speed: 0.3706s/iter; left time: 12956.4066s
	iters: 200, epoch: 6 | loss: 0.6059849
	speed: 0.1080s/iter; left time: 3763.8828s
	iters: 300, epoch: 6 | loss: 0.5883579
	speed: 0.1017s/iter; left time: 3534.3029s
Epoch: 6 cost time: 39.14542603492737
Epoch: 6, Steps: 369 | Train Loss: 0.520 Vali Loss: 0.631 Vali Acc: 0.664 Test Loss: 0.631 Test Acc: 0.664
Validation loss decreased (-0.663444 --> -0.664296).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2402902
	speed: 0.4073s/iter; left time: 14086.7284s
	iters: 200, epoch: 7 | loss: 0.3146998
	speed: 0.1027s/iter; left time: 3542.2997s
	iters: 300, epoch: 7 | loss: 0.3815539
	speed: 0.1079s/iter; left time: 3709.4914s
Epoch: 7 cost time: 40.203601598739624
Epoch: 7, Steps: 369 | Train Loss: 0.476 Vali Loss: 0.680 Vali Acc: 0.648 Test Loss: 0.680 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3546790
	speed: 0.3720s/iter; left time: 12729.8305s
	iters: 200, epoch: 8 | loss: 0.5055140
	speed: 0.1019s/iter; left time: 3476.8599s
	iters: 300, epoch: 8 | loss: 0.7865416
	speed: 0.1155s/iter; left time: 3927.8326s
Epoch: 8 cost time: 42.039766788482666
Epoch: 8, Steps: 369 | Train Loss: 0.450 Vali Loss: 0.674 Vali Acc: 0.652 Test Loss: 0.674 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4792380
	speed: 0.3907s/iter; left time: 13225.3570s
	iters: 200, epoch: 9 | loss: 0.4220636
	speed: 0.1051s/iter; left time: 3546.4151s
	iters: 300, epoch: 9 | loss: 0.4482410
	speed: 0.1012s/iter; left time: 3404.7863s
Epoch: 9 cost time: 39.53790616989136
Epoch: 9, Steps: 369 | Train Loss: 0.418 Vali Loss: 0.695 Vali Acc: 0.653 Test Loss: 0.695 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4795116
	speed: 0.3872s/iter; left time: 12963.6944s
	iters: 200, epoch: 10 | loss: 0.2872011
	speed: 0.1201s/iter; left time: 4008.2322s
	iters: 300, epoch: 10 | loss: 0.4146904
	speed: 0.1182s/iter; left time: 3933.3588s
Epoch: 10 cost time: 43.26964473724365
Epoch: 10, Steps: 369 | Train Loss: 0.373 Vali Loss: 0.773 Vali Acc: 0.649 Test Loss: 0.773 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2341419
	speed: 0.3795s/iter; left time: 12565.0053s
	iters: 200, epoch: 11 | loss: 0.3570416
	speed: 0.0968s/iter; left time: 3196.4573s
	iters: 300, epoch: 11 | loss: 0.1783393
	speed: 0.1035s/iter; left time: 3406.4328s
Epoch: 11 cost time: 38.00732445716858
Epoch: 11, Steps: 369 | Train Loss: 0.347 Vali Loss: 0.756 Vali Acc: 0.661 Test Loss: 0.756 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2717072
	speed: 0.3906s/iter; left time: 12788.2230s
	iters: 200, epoch: 12 | loss: 0.0856898
	speed: 0.1233s/iter; left time: 4024.1922s
	iters: 300, epoch: 12 | loss: 0.3549229
	speed: 0.0972s/iter; left time: 3163.7848s
Epoch: 12 cost time: 40.690638065338135
Epoch: 12, Steps: 369 | Train Loss: 0.312 Vali Loss: 0.884 Vali Acc: 0.640 Test Loss: 0.884 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2733058
	speed: 0.3867s/iter; left time: 12519.5889s
	iters: 200, epoch: 13 | loss: 0.2896425
	speed: 0.1042s/iter; left time: 3362.0904s
	iters: 300, epoch: 13 | loss: 0.4418430
	speed: 0.1099s/iter; left time: 3534.9303s
Epoch: 13 cost time: 40.6164813041687
Epoch: 13, Steps: 369 | Train Loss: 0.277 Vali Loss: 0.879 Vali Acc: 0.651 Test Loss: 0.879 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1089651
	speed: 0.3838s/iter; left time: 12282.8982s
	iters: 200, epoch: 14 | loss: 0.2080313
	speed: 0.1051s/iter; left time: 3353.4881s
	iters: 300, epoch: 14 | loss: 0.1266682
	speed: 0.0991s/iter; left time: 3152.0069s
Epoch: 14 cost time: 40.203420877456665
Epoch: 14, Steps: 369 | Train Loss: 0.255 Vali Loss: 0.995 Vali Acc: 0.662 Test Loss: 0.995 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2377915
	speed: 0.3859s/iter; left time: 12208.4964s
	iters: 200, epoch: 15 | loss: 0.2487852
	speed: 0.1083s/iter; left time: 3414.5395s
	iters: 300, epoch: 15 | loss: 0.2815807
	speed: 0.1221s/iter; left time: 3836.7501s
Epoch: 15 cost time: 42.82064175605774
Epoch: 15, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.137 Vali Acc: 0.638 Test Loss: 1.137 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.1651073
	speed: 0.3801s/iter; left time: 11885.7298s
	iters: 200, epoch: 16 | loss: 0.4023368
	speed: 0.0974s/iter; left time: 3037.0613s
	iters: 300, epoch: 16 | loss: 0.6878939
	speed: 0.1025s/iter; left time: 3184.4508s
Epoch: 16 cost time: 37.529762506484985
Epoch: 16, Steps: 369 | Train Loss: 0.206 Vali Loss: 1.163 Vali Acc: 0.663 Test Loss: 1.163 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6643019296254257
model parameter : 1281150
model size : 6.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7636628
	speed: 0.1423s/iter; left time: 5237.4461s
	iters: 200, epoch: 1 | loss: 0.7095356
	speed: 0.1070s/iter; left time: 3926.1757s
	iters: 300, epoch: 1 | loss: 0.4815716
	speed: 0.1102s/iter; left time: 4033.7178s
Epoch: 1 cost time: 43.40162420272827
Epoch: 1, Steps: 369 | Train Loss: 0.738 Vali Loss: 0.680 Vali Acc: 0.627 Test Loss: 0.680 Test Acc: 0.627
Validation loss decreased (inf --> -0.627121).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4631529
	speed: 0.3921s/iter; left time: 14285.6897s
	iters: 200, epoch: 2 | loss: 0.5519056
	speed: 0.1062s/iter; left time: 3857.5356s
	iters: 300, epoch: 2 | loss: 0.6727962
	speed: 0.1163s/iter; left time: 4213.9410s
Epoch: 2 cost time: 42.36423110961914
Epoch: 2, Steps: 369 | Train Loss: 0.658 Vali Loss: 0.615 Vali Acc: 0.671 Test Loss: 0.615 Test Acc: 0.671
Validation loss decreased (-0.627121 --> -0.671390).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7304357
	speed: 0.3872s/iter; left time: 13962.3675s
	iters: 200, epoch: 3 | loss: 0.5833989
	speed: 0.1126s/iter; left time: 4050.8147s
	iters: 300, epoch: 3 | loss: 0.4243328
	speed: 0.1070s/iter; left time: 3836.4558s
Epoch: 3 cost time: 40.46066403388977
Epoch: 3, Steps: 369 | Train Loss: 0.643 Vali Loss: 0.711 Vali Acc: 0.659 Test Loss: 0.711 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4467975
	speed: 0.3966s/iter; left time: 14155.4144s
	iters: 200, epoch: 4 | loss: 0.8433454
	speed: 0.1150s/iter; left time: 4092.3207s
	iters: 300, epoch: 4 | loss: 0.5116401
	speed: 0.1222s/iter; left time: 4338.6087s
Epoch: 4 cost time: 43.78334283828735
Epoch: 4, Steps: 369 | Train Loss: 0.608 Vali Loss: 0.819 Vali Acc: 0.623 Test Loss: 0.819 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4961727
	speed: 0.4122s/iter; left time: 14559.9169s
	iters: 200, epoch: 5 | loss: 0.6093737
	speed: 0.1075s/iter; left time: 3788.0753s
	iters: 300, epoch: 5 | loss: 0.5862620
	speed: 0.1046s/iter; left time: 3675.5618s
Epoch: 5 cost time: 40.53220582008362
Epoch: 5, Steps: 369 | Train Loss: 0.564 Vali Loss: 0.672 Vali Acc: 0.644 Test Loss: 0.672 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3003021
	speed: 0.3893s/iter; left time: 13608.6054s
	iters: 200, epoch: 6 | loss: 0.4650760
	speed: 0.1049s/iter; left time: 3654.7984s
	iters: 300, epoch: 6 | loss: 0.5051043
	speed: 0.1044s/iter; left time: 3627.2792s
Epoch: 6 cost time: 39.267224073410034
Epoch: 6, Steps: 369 | Train Loss: 0.533 Vali Loss: 0.616 Vali Acc: 0.675 Test Loss: 0.616 Test Acc: 0.675
Validation loss decreased (-0.671390 --> -0.674511).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5365473
	speed: 0.3868s/iter; left time: 13378.5082s
	iters: 200, epoch: 7 | loss: 0.3813184
	speed: 0.1102s/iter; left time: 3798.7860s
	iters: 300, epoch: 7 | loss: 0.5591698
	speed: 0.1090s/iter; left time: 3749.3844s
Epoch: 7 cost time: 40.615336179733276
Epoch: 7, Steps: 369 | Train Loss: 0.490 Vali Loss: 0.657 Vali Acc: 0.668 Test Loss: 0.657 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6582050
	speed: 0.3923s/iter; left time: 13424.6238s
	iters: 200, epoch: 8 | loss: 0.6062790
	speed: 0.1184s/iter; left time: 4039.8590s
	iters: 300, epoch: 8 | loss: 0.3584446
	speed: 0.1150s/iter; left time: 3912.3240s
Epoch: 8 cost time: 42.67409014701843
Epoch: 8, Steps: 369 | Train Loss: 0.447 Vali Loss: 0.807 Vali Acc: 0.667 Test Loss: 0.807 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2916614
	speed: 0.3971s/iter; left time: 13441.7945s
	iters: 200, epoch: 9 | loss: 0.3213481
	speed: 0.1032s/iter; left time: 3483.2495s
	iters: 300, epoch: 9 | loss: 0.2728101
	speed: 0.1041s/iter; left time: 3503.4174s
Epoch: 9 cost time: 39.60708570480347
Epoch: 9, Steps: 369 | Train Loss: 0.421 Vali Loss: 0.660 Vali Acc: 0.668 Test Loss: 0.660 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4000564
	speed: 0.4013s/iter; left time: 13435.5446s
	iters: 200, epoch: 10 | loss: 0.4768637
	speed: 0.1227s/iter; left time: 4094.2961s
	iters: 300, epoch: 10 | loss: 0.5065454
	speed: 0.1119s/iter; left time: 3723.1869s
Epoch: 10 cost time: 43.6150438785553
Epoch: 10, Steps: 369 | Train Loss: 0.384 Vali Loss: 0.727 Vali Acc: 0.673 Test Loss: 0.727 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2681642
	speed: 0.4001s/iter; left time: 13248.2704s
	iters: 200, epoch: 11 | loss: 0.3341671
	speed: 0.1091s/iter; left time: 3602.8767s
	iters: 300, epoch: 11 | loss: 0.3434830
	speed: 0.1051s/iter; left time: 3459.5309s
Epoch: 11 cost time: 41.61461687088013
Epoch: 11, Steps: 369 | Train Loss: 0.349 Vali Loss: 0.830 Vali Acc: 0.669 Test Loss: 0.830 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.8226958
	speed: 0.3969s/iter; left time: 12995.4459s
	iters: 200, epoch: 12 | loss: 0.3536749
	speed: 0.1054s/iter; left time: 3438.8639s
	iters: 300, epoch: 12 | loss: 0.2401723
	speed: 0.1086s/iter; left time: 3533.0366s
Epoch: 12 cost time: 39.885749101638794
Epoch: 12, Steps: 369 | Train Loss: 0.329 Vali Loss: 0.765 Vali Acc: 0.673 Test Loss: 0.765 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2802241
	speed: 0.3816s/iter; left time: 12352.6109s
	iters: 200, epoch: 13 | loss: 0.3284645
	speed: 0.1198s/iter; left time: 3867.1109s
	iters: 300, epoch: 13 | loss: 0.3701712
	speed: 0.1227s/iter; left time: 3947.6054s
Epoch: 13 cost time: 43.461121797561646
Epoch: 13, Steps: 369 | Train Loss: 0.294 Vali Loss: 0.807 Vali Acc: 0.669 Test Loss: 0.807 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1711796
	speed: 0.3986s/iter; left time: 12757.0230s
	iters: 200, epoch: 14 | loss: 0.2704369
	speed: 0.1067s/iter; left time: 3402.8055s
	iters: 300, epoch: 14 | loss: 0.1984104
	speed: 0.1028s/iter; left time: 3268.6251s
Epoch: 14 cost time: 39.3883171081543
Epoch: 14, Steps: 369 | Train Loss: 0.262 Vali Loss: 1.030 Vali Acc: 0.648 Test Loss: 1.030 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2280804
	speed: 0.3975s/iter; left time: 12576.3621s
	iters: 200, epoch: 15 | loss: 0.1321681
	speed: 0.1135s/iter; left time: 3579.5652s
	iters: 300, epoch: 15 | loss: 0.2460677
	speed: 0.1034s/iter; left time: 3248.9164s
Epoch: 15 cost time: 41.09345459938049
Epoch: 15, Steps: 369 | Train Loss: 0.245 Vali Loss: 1.109 Vali Acc: 0.666 Test Loss: 1.109 Test Acc: 0.666
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2089587
	speed: 0.3812s/iter; left time: 11919.6736s
	iters: 200, epoch: 16 | loss: 0.1919603
	speed: 0.1061s/iter; left time: 3307.6758s
	iters: 300, epoch: 16 | loss: 0.1107769
	speed: 0.1101s/iter; left time: 3420.0357s
Epoch: 16 cost time: 41.516382455825806
Epoch: 16, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.142 Vali Acc: 0.642 Test Loss: 1.142 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6745175936435869
model parameter : 1280382
model size : 6.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7459656
	speed: 0.1293s/iter; left time: 4759.8309s
	iters: 200, epoch: 1 | loss: 0.8031329
	speed: 0.1085s/iter; left time: 3980.4067s
	iters: 300, epoch: 1 | loss: 0.5169351
	speed: 0.1086s/iter; left time: 3975.5889s
Epoch: 1 cost time: 43.530529499053955
Epoch: 1, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.790 Vali Acc: 0.577 Test Loss: 0.790 Test Acc: 0.577
Validation loss decreased (inf --> -0.576893).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7605391
	speed: 0.3896s/iter; left time: 14194.4837s
	iters: 200, epoch: 2 | loss: 0.4880333
	speed: 0.1089s/iter; left time: 3956.2390s
	iters: 300, epoch: 2 | loss: 0.4119119
	speed: 0.1042s/iter; left time: 3776.3022s
Epoch: 2 cost time: 38.95018196105957
Epoch: 2, Steps: 369 | Train Loss: 0.639 Vali Loss: 0.626 Vali Acc: 0.657 Test Loss: 0.626 Test Acc: 0.657
Validation loss decreased (-0.576893 --> -0.657201).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4428417
	speed: 0.3943s/iter; left time: 14218.6911s
	iters: 200, epoch: 3 | loss: 0.7740737
	speed: 0.1137s/iter; left time: 4087.6351s
	iters: 300, epoch: 3 | loss: 1.2246782
	speed: 0.1227s/iter; left time: 4400.7439s
Epoch: 3 cost time: 42.32612586021423
Epoch: 3, Steps: 369 | Train Loss: 0.609 Vali Loss: 0.681 Vali Acc: 0.658 Test Loss: 0.681 Test Acc: 0.658
Validation loss decreased (-0.657201 --> -0.657768).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7341277
	speed: 0.3887s/iter; left time: 13874.3186s
	iters: 200, epoch: 4 | loss: 0.5329974
	speed: 0.1106s/iter; left time: 3936.1090s
	iters: 300, epoch: 4 | loss: 0.6153114
	speed: 0.1048s/iter; left time: 3720.7355s
Epoch: 4 cost time: 40.09285068511963
Epoch: 4, Steps: 369 | Train Loss: 0.574 Vali Loss: 0.622 Vali Acc: 0.669 Test Loss: 0.622 Test Acc: 0.669
Validation loss decreased (-0.657768 --> -0.668552).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4773204
	speed: 0.3935s/iter; left time: 13899.5570s
	iters: 200, epoch: 5 | loss: 0.7319254
	speed: 0.1145s/iter; left time: 4032.7956s
	iters: 300, epoch: 5 | loss: 0.5852450
	speed: 0.1042s/iter; left time: 3661.0128s
Epoch: 5 cost time: 42.020158767700195
Epoch: 5, Steps: 369 | Train Loss: 0.528 Vali Loss: 0.589 Vali Acc: 0.698 Test Loss: 0.589 Test Acc: 0.698
Validation loss decreased (-0.668552 --> -0.697781).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5339813
	speed: 0.3830s/iter; left time: 13388.0992s
	iters: 200, epoch: 6 | loss: 0.4592579
	speed: 0.1081s/iter; left time: 3767.5084s
	iters: 300, epoch: 6 | loss: 0.4433983
	speed: 0.1153s/iter; left time: 4006.6832s
Epoch: 6 cost time: 41.24329924583435
Epoch: 6, Steps: 369 | Train Loss: 0.486 Vali Loss: 0.663 Vali Acc: 0.677 Test Loss: 0.663 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4408789
	speed: 0.4024s/iter; left time: 13916.5222s
	iters: 200, epoch: 7 | loss: 0.1799890
	speed: 0.1062s/iter; left time: 3661.6446s
	iters: 300, epoch: 7 | loss: 0.5012916
	speed: 0.1053s/iter; left time: 3621.0723s
Epoch: 7 cost time: 40.17349576950073
Epoch: 7, Steps: 369 | Train Loss: 0.452 Vali Loss: 0.651 Vali Acc: 0.668 Test Loss: 0.651 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3942670
	speed: 0.3967s/iter; left time: 13574.4970s
	iters: 200, epoch: 8 | loss: 0.4347144
	speed: 0.1099s/iter; left time: 3749.1654s
	iters: 300, epoch: 8 | loss: 0.2589234
	speed: 0.1124s/iter; left time: 3825.1152s
Epoch: 8 cost time: 41.38248538970947
Epoch: 8, Steps: 369 | Train Loss: 0.417 Vali Loss: 0.785 Vali Acc: 0.651 Test Loss: 0.785 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2415934
	speed: 0.3986s/iter; left time: 13490.9525s
	iters: 200, epoch: 9 | loss: 0.3585386
	speed: 0.1031s/iter; left time: 3480.3282s
	iters: 300, epoch: 9 | loss: 0.4012353
	speed: 0.1040s/iter; left time: 3498.4389s
Epoch: 9 cost time: 40.075605392456055
Epoch: 9, Steps: 369 | Train Loss: 0.374 Vali Loss: 0.863 Vali Acc: 0.657 Test Loss: 0.863 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5669608
	speed: 0.3782s/iter; left time: 12660.6689s
	iters: 200, epoch: 10 | loss: 0.4017641
	speed: 0.1104s/iter; left time: 3683.7090s
	iters: 300, epoch: 10 | loss: 0.2412866
	speed: 0.1030s/iter; left time: 3429.3681s
Epoch: 10 cost time: 41.22263956069946
Epoch: 10, Steps: 369 | Train Loss: 0.335 Vali Loss: 0.780 Vali Acc: 0.667 Test Loss: 0.780 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2243127
	speed: 0.3627s/iter; left time: 12010.8955s
	iters: 200, epoch: 11 | loss: 0.0984735
	speed: 0.1041s/iter; left time: 3435.9243s
	iters: 300, epoch: 11 | loss: 0.4819545
	speed: 0.1107s/iter; left time: 3644.4627s
Epoch: 11 cost time: 40.99012875556946
Epoch: 11, Steps: 369 | Train Loss: 0.300 Vali Loss: 0.965 Vali Acc: 0.657 Test Loss: 0.965 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3294112
	speed: 0.3957s/iter; left time: 12955.2214s
	iters: 200, epoch: 12 | loss: 0.3508052
	speed: 0.1039s/iter; left time: 3391.3137s
	iters: 300, epoch: 12 | loss: 0.1501237
	speed: 0.1070s/iter; left time: 3483.5130s
Epoch: 12 cost time: 38.945534229278564
Epoch: 12, Steps: 369 | Train Loss: 0.265 Vali Loss: 0.977 Vali Acc: 0.660 Test Loss: 0.977 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1060281
	speed: 0.3820s/iter; left time: 12366.9929s
	iters: 200, epoch: 13 | loss: 0.6476228
	speed: 0.1210s/iter; left time: 3904.9096s
	iters: 300, epoch: 13 | loss: 0.2354458
	speed: 0.1366s/iter; left time: 4394.1330s
Epoch: 13 cost time: 47.0173819065094
Epoch: 13, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.063 Vali Acc: 0.658 Test Loss: 1.063 Test Acc: 0.658
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0369601
	speed: 0.4043s/iter; left time: 12939.6708s
	iters: 200, epoch: 14 | loss: 0.1296327
	speed: 0.0835s/iter; left time: 2664.2517s
	iters: 300, epoch: 14 | loss: 0.3080702
	speed: 0.0891s/iter; left time: 2833.3423s
Epoch: 14 cost time: 34.56924867630005
Epoch: 14, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.098 Vali Acc: 0.661 Test Loss: 1.098 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1032655
	speed: 0.3654s/iter; left time: 11560.0380s
	iters: 200, epoch: 15 | loss: 0.0860366
	speed: 0.1004s/iter; left time: 3166.4457s
	iters: 300, epoch: 15 | loss: 0.5172630
	speed: 0.1033s/iter; left time: 3247.3671s
Epoch: 15 cost time: 39.219921827316284
Epoch: 15, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.107 Vali Acc: 0.658 Test Loss: 1.107 Test Acc: 0.658
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6977866061293984
model parameter : 985470
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7456327
	speed: 0.1311s/iter; left time: 4825.0249s
	iters: 200, epoch: 1 | loss: 0.6892630
	speed: 0.1096s/iter; left time: 4020.7665s
	iters: 300, epoch: 1 | loss: 0.6436033
	speed: 0.1010s/iter; left time: 3695.6220s
Epoch: 1 cost time: 41.29646110534668
Epoch: 1, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.645 Vali Acc: 0.670 Test Loss: 0.645 Test Acc: 0.670
Validation loss decreased (inf --> -0.669687).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5361682
	speed: 0.3805s/iter; left time: 13860.7916s
	iters: 200, epoch: 2 | loss: 0.4822920
	speed: 0.1128s/iter; left time: 4098.8615s
	iters: 300, epoch: 2 | loss: 0.5815204
	speed: 0.1186s/iter; left time: 4298.7431s
Epoch: 2 cost time: 41.72030258178711
Epoch: 2, Steps: 369 | Train Loss: 0.628 Vali Loss: 0.707 Vali Acc: 0.643 Test Loss: 0.707 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2430165
	speed: 0.3924s/iter; left time: 14151.1161s
	iters: 200, epoch: 3 | loss: 0.7794376
	speed: 0.1054s/iter; left time: 3789.0307s
	iters: 300, epoch: 3 | loss: 0.7245623
	speed: 0.1015s/iter; left time: 3641.1329s
Epoch: 3 cost time: 39.31083345413208
Epoch: 3, Steps: 369 | Train Loss: 0.621 Vali Loss: 0.644 Vali Acc: 0.680 Test Loss: 0.644 Test Acc: 0.680
Validation loss decreased (-0.669687 --> -0.679619).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4293303
	speed: 0.3749s/iter; left time: 13381.4064s
	iters: 200, epoch: 4 | loss: 0.9544362
	speed: 0.1135s/iter; left time: 4039.9471s
	iters: 300, epoch: 4 | loss: 0.8616573
	speed: 0.1018s/iter; left time: 3611.5328s
Epoch: 4 cost time: 40.01989388465881
Epoch: 4, Steps: 369 | Train Loss: 0.574 Vali Loss: 0.626 Vali Acc: 0.671 Test Loss: 0.626 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8212761
	speed: 0.3663s/iter; left time: 12939.8700s
	iters: 200, epoch: 5 | loss: 0.6159161
	speed: 0.1021s/iter; left time: 3596.6769s
	iters: 300, epoch: 5 | loss: 0.4895282
	speed: 0.1157s/iter; left time: 4064.1522s
Epoch: 5 cost time: 41.340261459350586
Epoch: 5, Steps: 369 | Train Loss: 0.559 Vali Loss: 0.644 Vali Acc: 0.679 Test Loss: 0.644 Test Acc: 0.679
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3481213
	speed: 0.3820s/iter; left time: 13354.4551s
	iters: 200, epoch: 6 | loss: 0.8392241
	speed: 0.1015s/iter; left time: 3539.2394s
	iters: 300, epoch: 6 | loss: 0.9343880
	speed: 0.1057s/iter; left time: 3675.0133s
Epoch: 6 cost time: 38.731091022491455
Epoch: 6, Steps: 369 | Train Loss: 0.504 Vali Loss: 0.630 Vali Acc: 0.687 Test Loss: 0.630 Test Acc: 0.687
Validation loss decreased (-0.679619 --> -0.687281).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3817700
	speed: 0.3887s/iter; left time: 13442.3175s
	iters: 200, epoch: 7 | loss: 0.5800145
	speed: 0.1142s/iter; left time: 3937.7058s
	iters: 300, epoch: 7 | loss: 0.4771320
	speed: 0.1049s/iter; left time: 3608.1541s
Epoch: 7 cost time: 41.56903004646301
Epoch: 7, Steps: 369 | Train Loss: 0.469 Vali Loss: 0.679 Vali Acc: 0.663 Test Loss: 0.679 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2903656
	speed: 0.3679s/iter; left time: 12589.1562s
	iters: 200, epoch: 8 | loss: 0.4515800
	speed: 0.1003s/iter; left time: 3420.7378s
	iters: 300, epoch: 8 | loss: 0.3427370
	speed: 0.1014s/iter; left time: 3450.4838s
Epoch: 8 cost time: 38.31365919113159
Epoch: 8, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.680 Vali Acc: 0.677 Test Loss: 0.680 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2241308
	speed: 0.3789s/iter; left time: 12826.0750s
	iters: 200, epoch: 9 | loss: 0.3857036
	speed: 0.1021s/iter; left time: 3446.1551s
	iters: 300, epoch: 9 | loss: 0.3226365
	speed: 0.1049s/iter; left time: 3528.9684s
Epoch: 9 cost time: 39.740572690963745
Epoch: 9, Steps: 369 | Train Loss: 0.381 Vali Loss: 0.757 Vali Acc: 0.661 Test Loss: 0.757 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6363720
	speed: 0.3730s/iter; left time: 12489.4319s
	iters: 200, epoch: 10 | loss: 0.5941110
	speed: 0.1149s/iter; left time: 3836.9625s
	iters: 300, epoch: 10 | loss: 0.5957885
	speed: 0.1210s/iter; left time: 4027.5815s
Epoch: 10 cost time: 42.08556890487671
Epoch: 10, Steps: 369 | Train Loss: 0.352 Vali Loss: 0.885 Vali Acc: 0.654 Test Loss: 0.885 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3180738
	speed: 0.3739s/iter; left time: 12381.5427s
	iters: 200, epoch: 11 | loss: 0.3284710
	speed: 0.0963s/iter; left time: 3180.5481s
	iters: 300, epoch: 11 | loss: 0.1548657
	speed: 0.0976s/iter; left time: 3211.5438s
Epoch: 11 cost time: 37.420565366744995
Epoch: 11, Steps: 369 | Train Loss: 0.309 Vali Loss: 0.798 Vali Acc: 0.653 Test Loss: 0.798 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1641152
	speed: 0.3714s/iter; left time: 12158.8594s
	iters: 200, epoch: 12 | loss: 0.5544474
	speed: 0.0995s/iter; left time: 3249.5105s
	iters: 300, epoch: 12 | loss: 0.4013905
	speed: 0.0976s/iter; left time: 3175.3353s
Epoch: 12 cost time: 37.32763171195984
Epoch: 12, Steps: 369 | Train Loss: 0.284 Vali Loss: 0.806 Vali Acc: 0.661 Test Loss: 0.806 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2282073
	speed: 0.3674s/iter; left time: 11894.2673s
	iters: 200, epoch: 13 | loss: 0.1891155
	speed: 0.0996s/iter; left time: 3215.7778s
	iters: 300, epoch: 13 | loss: 0.1496991
	speed: 0.1016s/iter; left time: 3269.2291s
Epoch: 13 cost time: 38.991440534591675
Epoch: 13, Steps: 369 | Train Loss: 0.253 Vali Loss: 0.935 Vali Acc: 0.654 Test Loss: 0.935 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1775015
	speed: 0.3746s/iter; left time: 11989.2325s
	iters: 200, epoch: 14 | loss: 0.1391489
	speed: 0.1010s/iter; left time: 3222.7734s
	iters: 300, epoch: 14 | loss: 0.0973594
	speed: 0.1004s/iter; left time: 3192.7613s
Epoch: 14 cost time: 37.53618049621582
Epoch: 14, Steps: 369 | Train Loss: 0.222 Vali Loss: 1.063 Vali Acc: 0.651 Test Loss: 1.063 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1000734
	speed: 0.3734s/iter; left time: 11812.2699s
	iters: 200, epoch: 15 | loss: 0.2105635
	speed: 0.1141s/iter; left time: 3597.9139s
	iters: 300, epoch: 15 | loss: 0.0224419
	speed: 0.1128s/iter; left time: 3546.1093s
Epoch: 15 cost time: 41.524370193481445
Epoch: 15, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.143 Vali Acc: 0.660 Test Loss: 1.143 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0724771
	speed: 0.3658s/iter; left time: 11437.5626s
	iters: 200, epoch: 16 | loss: 0.4504780
	speed: 0.0944s/iter; left time: 2942.5839s
	iters: 300, epoch: 16 | loss: 0.1695075
	speed: 0.0901s/iter; left time: 2800.5610s
Epoch: 16 cost time: 35.9837543964386
Epoch: 16, Steps: 369 | Train Loss: 0.177 Vali Loss: 0.874 Vali Acc: 0.651 Test Loss: 0.874 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6872871736662883
model parameter : 984702
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6835914
	speed: 0.1235s/iter; left time: 4545.9785s
	iters: 200, epoch: 1 | loss: 0.4132160
	speed: 0.0972s/iter; left time: 3568.9391s
	iters: 300, epoch: 1 | loss: 0.7093685
	speed: 0.0942s/iter; left time: 3448.3024s
Epoch: 1 cost time: 38.432366132736206
Epoch: 1, Steps: 369 | Train Loss: 0.743 Vali Loss: 0.722 Vali Acc: 0.636 Test Loss: 0.722 Test Acc: 0.636
Validation loss decreased (inf --> -0.636202).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9573972
	speed: 0.3470s/iter; left time: 12641.2693s
	iters: 200, epoch: 2 | loss: 0.6601811
	speed: 0.0973s/iter; left time: 3535.5781s
	iters: 300, epoch: 2 | loss: 0.5597252
	speed: 0.1111s/iter; left time: 4026.5734s
Epoch: 2 cost time: 39.842066287994385
Epoch: 2, Steps: 369 | Train Loss: 0.653 Vali Loss: 0.768 Vali Acc: 0.646 Test Loss: 0.768 Test Acc: 0.646
Validation loss decreased (-0.636202 --> -0.646417).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3157830
	speed: 0.3681s/iter; left time: 13275.2750s
	iters: 200, epoch: 3 | loss: 0.6090189
	speed: 0.1024s/iter; left time: 3681.0349s
	iters: 300, epoch: 3 | loss: 0.8165112
	speed: 0.1024s/iter; left time: 3672.1916s
Epoch: 3 cost time: 38.60108757019043
Epoch: 3, Steps: 369 | Train Loss: 0.609 Vali Loss: 0.653 Vali Acc: 0.649 Test Loss: 0.653 Test Acc: 0.649
Validation loss decreased (-0.646417 --> -0.649256).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6057218
	speed: 0.3760s/iter; left time: 13422.1840s
	iters: 200, epoch: 4 | loss: 0.7413678
	speed: 0.1144s/iter; left time: 4070.9020s
	iters: 300, epoch: 4 | loss: 0.6185198
	speed: 0.1039s/iter; left time: 3689.1643s
Epoch: 4 cost time: 40.97726893424988
Epoch: 4, Steps: 369 | Train Loss: 0.621 Vali Loss: 1.016 Vali Acc: 0.576 Test Loss: 1.016 Test Acc: 0.576
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3956435
	speed: 0.3779s/iter; left time: 13349.0746s
	iters: 200, epoch: 5 | loss: 0.5044841
	speed: 0.1008s/iter; left time: 3548.9729s
	iters: 300, epoch: 5 | loss: 0.6636080
	speed: 0.1012s/iter; left time: 3553.7153s
Epoch: 5 cost time: 37.7047073841095
Epoch: 5, Steps: 369 | Train Loss: 0.542 Vali Loss: 0.635 Vali Acc: 0.682 Test Loss: 0.635 Test Acc: 0.682
Validation loss decreased (-0.649256 --> -0.681605).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5381106
	speed: 0.3785s/iter; left time: 13230.9936s
	iters: 200, epoch: 6 | loss: 0.4309047
	speed: 0.0959s/iter; left time: 3343.9915s
	iters: 300, epoch: 6 | loss: 0.5560920
	speed: 0.1000s/iter; left time: 3476.0084s
Epoch: 6 cost time: 38.37270927429199
Epoch: 6, Steps: 369 | Train Loss: 0.487 Vali Loss: 0.784 Vali Acc: 0.626 Test Loss: 0.784 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3781215
	speed: 0.3490s/iter; left time: 12069.1507s
	iters: 200, epoch: 7 | loss: 0.2839703
	speed: 0.1065s/iter; left time: 3671.4820s
	iters: 300, epoch: 7 | loss: 0.3572225
	speed: 0.1139s/iter; left time: 3917.1599s
Epoch: 7 cost time: 41.02792406082153
Epoch: 7, Steps: 369 | Train Loss: 0.450 Vali Loss: 0.650 Vali Acc: 0.676 Test Loss: 0.650 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2910241
	speed: 0.3614s/iter; left time: 12367.6729s
	iters: 200, epoch: 8 | loss: 0.4513636
	speed: 0.1001s/iter; left time: 3413.8966s
	iters: 300, epoch: 8 | loss: 0.2575392
	speed: 0.1001s/iter; left time: 3406.5114s
Epoch: 8 cost time: 36.80658197402954
Epoch: 8, Steps: 369 | Train Loss: 0.414 Vali Loss: 0.674 Vali Acc: 0.661 Test Loss: 0.674 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.5572008
	speed: 0.3680s/iter; left time: 12456.6469s
	iters: 200, epoch: 9 | loss: 0.9024620
	speed: 0.1047s/iter; left time: 3533.2500s
	iters: 300, epoch: 9 | loss: 0.1982635
	speed: 0.0992s/iter; left time: 3337.3044s
Epoch: 9 cost time: 39.622278928756714
Epoch: 9, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.747 Vali Acc: 0.656 Test Loss: 0.747 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5125498
	speed: 0.3747s/iter; left time: 12546.3330s
	iters: 200, epoch: 10 | loss: 0.3713324
	speed: 0.0996s/iter; left time: 3325.7398s
	iters: 300, epoch: 10 | loss: 0.1962369
	speed: 0.0971s/iter; left time: 3230.2624s
Epoch: 10 cost time: 37.15916728973389
Epoch: 10, Steps: 369 | Train Loss: 0.342 Vali Loss: 1.012 Vali Acc: 0.645 Test Loss: 1.012 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.3768013
	speed: 0.3853s/iter; left time: 12757.4439s
	iters: 200, epoch: 11 | loss: 0.1366357
	speed: 0.0970s/iter; left time: 3201.5990s
	iters: 300, epoch: 11 | loss: 0.4068840
	speed: 0.1028s/iter; left time: 3381.8031s
Epoch: 11 cost time: 38.95176839828491
Epoch: 11, Steps: 369 | Train Loss: 0.307 Vali Loss: 0.876 Vali Acc: 0.653 Test Loss: 0.876 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.4149624
	speed: 0.3479s/iter; left time: 11391.1682s
	iters: 200, epoch: 12 | loss: 0.1039563
	speed: 0.1069s/iter; left time: 3488.1567s
	iters: 300, epoch: 12 | loss: 0.2019808
	speed: 0.1100s/iter; left time: 3579.1731s
Epoch: 12 cost time: 39.98155856132507
Epoch: 12, Steps: 369 | Train Loss: 0.275 Vali Loss: 0.875 Vali Acc: 0.656 Test Loss: 0.875 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2254512
	speed: 0.3704s/iter; left time: 11992.0398s
	iters: 200, epoch: 13 | loss: 0.3274387
	speed: 0.1023s/iter; left time: 3300.2461s
	iters: 300, epoch: 13 | loss: 0.2101675
	speed: 0.1017s/iter; left time: 3272.7905s
Epoch: 13 cost time: 38.24154782295227
Epoch: 13, Steps: 369 | Train Loss: 0.252 Vali Loss: 1.050 Vali Acc: 0.655 Test Loss: 1.050 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1223791
	speed: 0.3691s/iter; left time: 11811.0917s
	iters: 200, epoch: 14 | loss: 0.5945151
	speed: 0.1091s/iter; left time: 3480.1775s
	iters: 300, epoch: 14 | loss: 0.1805638
	speed: 0.0994s/iter; left time: 3161.4857s
Epoch: 14 cost time: 39.5467529296875
Epoch: 14, Steps: 369 | Train Loss: 0.229 Vali Loss: 0.952 Vali Acc: 0.659 Test Loss: 0.952 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0717734
	speed: 0.3697s/iter; left time: 11696.8441s
	iters: 200, epoch: 15 | loss: 0.3242392
	speed: 0.0960s/iter; left time: 3027.1444s
	iters: 300, epoch: 15 | loss: 0.2347329
	speed: 0.0984s/iter; left time: 3093.7799s
Epoch: 15 cost time: 37.732262134552
Epoch: 15, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.097 Vali Acc: 0.653 Test Loss: 1.097 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6816118047673099
model parameter : 983934
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9894913
	speed: 0.1237s/iter; left time: 4551.9825s
	iters: 200, epoch: 1 | loss: 1.1103181
	speed: 0.1008s/iter; left time: 3698.1333s
	iters: 300, epoch: 1 | loss: 0.7203367
	speed: 0.1092s/iter; left time: 3996.5938s
Epoch: 1 cost time: 40.98612022399902
Epoch: 1, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.883 Vali Acc: 0.585 Test Loss: 0.883 Test Acc: 0.585
Validation loss decreased (inf --> -0.585405).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6458005
	speed: 0.3469s/iter; left time: 12637.7163s
	iters: 200, epoch: 2 | loss: 0.7823045
	speed: 0.0975s/iter; left time: 3541.7497s
	iters: 300, epoch: 2 | loss: 0.6815768
	speed: 0.0970s/iter; left time: 3514.1152s
Epoch: 2 cost time: 36.36572241783142
Epoch: 2, Steps: 369 | Train Loss: 0.652 Vali Loss: 0.707 Vali Acc: 0.638 Test Loss: 0.707 Test Acc: 0.638
Validation loss decreased (-0.585405 --> -0.638472).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4486555
	speed: 0.3526s/iter; left time: 12717.5686s
	iters: 200, epoch: 3 | loss: 1.0784431
	speed: 0.1012s/iter; left time: 3640.8441s
	iters: 300, epoch: 3 | loss: 0.5340043
	speed: 0.1046s/iter; left time: 3750.3146s
Epoch: 3 cost time: 38.46398854255676
Epoch: 3, Steps: 369 | Train Loss: 0.618 Vali Loss: 0.653 Vali Acc: 0.655 Test Loss: 0.653 Test Acc: 0.655
Validation loss decreased (-0.638472 --> -0.654931).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2868033
	speed: 0.3512s/iter; left time: 12537.3457s
	iters: 200, epoch: 4 | loss: 0.5558387
	speed: 0.0976s/iter; left time: 3474.4107s
	iters: 300, epoch: 4 | loss: 0.7675343
	speed: 0.0935s/iter; left time: 3319.4499s
Epoch: 4 cost time: 35.92282557487488
Epoch: 4, Steps: 369 | Train Loss: 0.589 Vali Loss: 0.658 Vali Acc: 0.654 Test Loss: 0.658 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3467646
	speed: 0.3701s/iter; left time: 13073.2167s
	iters: 200, epoch: 5 | loss: 0.5708310
	speed: 0.0953s/iter; left time: 3355.9354s
	iters: 300, epoch: 5 | loss: 0.4626697
	speed: 0.0975s/iter; left time: 3426.3268s
Epoch: 5 cost time: 37.44895839691162
Epoch: 5, Steps: 369 | Train Loss: 0.547 Vali Loss: 0.640 Vali Acc: 0.679 Test Loss: 0.640 Test Acc: 0.679
Validation loss decreased (-0.654931 --> -0.679335).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7263752
	speed: 0.3473s/iter; left time: 12138.4796s
	iters: 200, epoch: 6 | loss: 0.3712599
	speed: 0.0991s/iter; left time: 3454.5158s
	iters: 300, epoch: 6 | loss: 0.4600109
	speed: 0.0949s/iter; left time: 3297.1576s
Epoch: 6 cost time: 37.802377223968506
Epoch: 6, Steps: 369 | Train Loss: 0.497 Vali Loss: 0.633 Vali Acc: 0.676 Test Loss: 0.633 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3634897
	speed: 0.3685s/iter; left time: 12745.8888s
	iters: 200, epoch: 7 | loss: 0.2845782
	speed: 0.1041s/iter; left time: 3588.4190s
	iters: 300, epoch: 7 | loss: 0.5183308
	speed: 0.0970s/iter; left time: 3335.8483s
Epoch: 7 cost time: 38.36056971549988
Epoch: 7, Steps: 369 | Train Loss: 0.465 Vali Loss: 0.630 Vali Acc: 0.687 Test Loss: 0.630 Test Acc: 0.687
Validation loss decreased (-0.679335 --> -0.687281).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4710198
	speed: 0.3508s/iter; left time: 12004.1500s
	iters: 200, epoch: 8 | loss: 0.5222200
	speed: 0.1047s/iter; left time: 3573.8102s
	iters: 300, epoch: 8 | loss: 0.4086814
	speed: 0.1057s/iter; left time: 3596.5526s
Epoch: 8 cost time: 39.068528175354004
Epoch: 8, Steps: 369 | Train Loss: 0.417 Vali Loss: 0.662 Vali Acc: 0.682 Test Loss: 0.662 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.5433961
	speed: 0.3550s/iter; left time: 12016.3827s
	iters: 200, epoch: 9 | loss: 0.3013852
	speed: 0.0888s/iter; left time: 2995.4048s
	iters: 300, epoch: 9 | loss: 0.2927424
	speed: 0.0907s/iter; left time: 3053.0767s
Epoch: 9 cost time: 34.06019592285156
Epoch: 9, Steps: 369 | Train Loss: 0.374 Vali Loss: 0.759 Vali Acc: 0.668 Test Loss: 0.759 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.5022380
	speed: 0.3660s/iter; left time: 12253.3996s
	iters: 200, epoch: 10 | loss: 0.4285567
	speed: 0.1013s/iter; left time: 3381.8494s
	iters: 300, epoch: 10 | loss: 0.3970502
	speed: 0.0999s/iter; left time: 3324.9021s
Epoch: 10 cost time: 38.72970414161682
Epoch: 10, Steps: 369 | Train Loss: 0.337 Vali Loss: 0.795 Vali Acc: 0.657 Test Loss: 0.795 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.4362956
	speed: 0.3516s/iter; left time: 11642.3952s
	iters: 200, epoch: 11 | loss: 0.3520319
	speed: 0.1003s/iter; left time: 3309.8692s
	iters: 300, epoch: 11 | loss: 0.1082823
	speed: 0.0984s/iter; left time: 3239.7167s
Epoch: 11 cost time: 37.740171909332275
Epoch: 11, Steps: 369 | Train Loss: 0.287 Vali Loss: 0.879 Vali Acc: 0.667 Test Loss: 0.879 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2644709
	speed: 0.3571s/iter; left time: 11692.8331s
	iters: 200, epoch: 12 | loss: 0.2130057
	speed: 0.0982s/iter; left time: 3206.9802s
	iters: 300, epoch: 12 | loss: 0.2756387
	speed: 0.1025s/iter; left time: 3334.3670s
Epoch: 12 cost time: 37.99862194061279
Epoch: 12, Steps: 369 | Train Loss: 0.265 Vali Loss: 0.870 Vali Acc: 0.652 Test Loss: 0.870 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1400536
	speed: 0.3548s/iter; left time: 11486.4282s
	iters: 200, epoch: 13 | loss: 0.1197347
	speed: 0.0973s/iter; left time: 3140.5988s
	iters: 300, epoch: 13 | loss: 0.3692495
	speed: 0.1062s/iter; left time: 3415.7581s
Epoch: 13 cost time: 38.552714586257935
Epoch: 13, Steps: 369 | Train Loss: 0.231 Vali Loss: 1.032 Vali Acc: 0.661 Test Loss: 1.032 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0366030
	speed: 0.3543s/iter; left time: 11339.1425s
	iters: 200, epoch: 14 | loss: 0.2830627
	speed: 0.0965s/iter; left time: 3078.8806s
	iters: 300, epoch: 14 | loss: 0.0436739
	speed: 0.0982s/iter; left time: 3124.4421s
Epoch: 14 cost time: 36.1630973815918
Epoch: 14, Steps: 369 | Train Loss: 0.205 Vali Loss: 1.200 Vali Acc: 0.638 Test Loss: 1.200 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0440930
	speed: 0.3659s/iter; left time: 11574.8096s
	iters: 200, epoch: 15 | loss: 0.1009839
	speed: 0.1090s/iter; left time: 3435.9244s
	iters: 300, epoch: 15 | loss: 0.2923681
	speed: 0.1043s/iter; left time: 3278.3292s
Epoch: 15 cost time: 39.457927227020264
Epoch: 15, Steps: 369 | Train Loss: 0.186 Vali Loss: 1.090 Vali Acc: 0.651 Test Loss: 1.090 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.4586056
	speed: 0.3532s/iter; left time: 11044.2157s
	iters: 200, epoch: 16 | loss: 0.0535234
	speed: 0.0960s/iter; left time: 2992.2307s
	iters: 300, epoch: 16 | loss: 0.0888382
	speed: 0.0972s/iter; left time: 3019.4392s
Epoch: 16 cost time: 36.779752254486084
Epoch: 16, Steps: 369 | Train Loss: 0.183 Vali Loss: 1.326 Vali Acc: 0.654 Test Loss: 1.326 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.2631884
	speed: 0.3700s/iter; left time: 11432.3017s
	iters: 200, epoch: 17 | loss: 0.2368379
	speed: 0.1051s/iter; left time: 3235.2789s
	iters: 300, epoch: 17 | loss: 0.2269629
	speed: 0.1033s/iter; left time: 3170.7461s
Epoch: 17 cost time: 40.47583079338074
Epoch: 17, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.283 Vali Acc: 0.667 Test Loss: 1.283 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6872871736662883
model parameter : 983166
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5953802
	speed: 0.1389s/iter; left time: 5110.3651s
	iters: 200, epoch: 1 | loss: 1.0023466
	speed: 0.1083s/iter; left time: 3975.7786s
	iters: 300, epoch: 1 | loss: 0.7011915
	speed: 0.1004s/iter; left time: 3675.7451s
Epoch: 1 cost time: 41.61699819564819
Epoch: 1, Steps: 369 | Train Loss: 0.760 Vali Loss: 0.861 Vali Acc: 0.592 Test Loss: 0.861 Test Acc: 0.592
Validation loss decreased (inf --> -0.592216).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7271357
	speed: 0.3657s/iter; left time: 13324.9099s
	iters: 200, epoch: 2 | loss: 0.9046315
	speed: 0.0993s/iter; left time: 3608.6306s
	iters: 300, epoch: 2 | loss: 0.4099694
	speed: 0.1002s/iter; left time: 3630.8647s
Epoch: 2 cost time: 38.220409631729126
Epoch: 2, Steps: 369 | Train Loss: 0.628 Vali Loss: 0.684 Vali Acc: 0.666 Test Loss: 0.684 Test Acc: 0.666
Validation loss decreased (-0.592216 --> -0.666281).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5753812
	speed: 0.3599s/iter; left time: 12978.4668s
	iters: 200, epoch: 3 | loss: 0.7133102
	speed: 0.1007s/iter; left time: 3620.1105s
	iters: 300, epoch: 3 | loss: 0.7198670
	speed: 0.0980s/iter; left time: 3514.9495s
Epoch: 3 cost time: 37.19751024246216
Epoch: 3, Steps: 369 | Train Loss: 0.600 Vali Loss: 0.672 Vali Acc: 0.638 Test Loss: 0.672 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5582543
	speed: 0.3542s/iter; left time: 12643.2310s
	iters: 200, epoch: 4 | loss: 0.8499588
	speed: 0.1083s/iter; left time: 3856.4376s
	iters: 300, epoch: 4 | loss: 0.4342397
	speed: 0.1119s/iter; left time: 3973.0171s
Epoch: 4 cost time: 40.156782388687134
Epoch: 4, Steps: 369 | Train Loss: 0.567 Vali Loss: 0.835 Vali Acc: 0.593 Test Loss: 0.835 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3450922
	speed: 0.3621s/iter; left time: 12790.5572s
	iters: 200, epoch: 5 | loss: 0.4457185
	speed: 0.1062s/iter; left time: 3739.9025s
	iters: 300, epoch: 5 | loss: 0.3309751
	speed: 0.0982s/iter; left time: 3450.1082s
Epoch: 5 cost time: 38.61069893836975
Epoch: 5, Steps: 369 | Train Loss: 0.527 Vali Loss: 0.633 Vali Acc: 0.667 Test Loss: 0.633 Test Acc: 0.667
Validation loss decreased (-0.666281 --> -0.667133).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6211826
	speed: 0.3822s/iter; left time: 13359.3240s
	iters: 200, epoch: 6 | loss: 0.6012974
	speed: 0.1011s/iter; left time: 3525.5388s
	iters: 300, epoch: 6 | loss: 0.4340858
	speed: 0.0989s/iter; left time: 3435.7548s
Epoch: 6 cost time: 38.97765016555786
Epoch: 6, Steps: 369 | Train Loss: 0.480 Vali Loss: 0.659 Vali Acc: 0.657 Test Loss: 0.659 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3861175
	speed: 0.3758s/iter; left time: 12996.8256s
	iters: 200, epoch: 7 | loss: 1.0195992
	speed: 0.1009s/iter; left time: 3480.9604s
	iters: 300, epoch: 7 | loss: 0.6664512
	speed: 0.1111s/iter; left time: 3819.1783s
Epoch: 7 cost time: 40.25092077255249
Epoch: 7, Steps: 369 | Train Loss: 0.439 Vali Loss: 0.629 Vali Acc: 0.681 Test Loss: 0.629 Test Acc: 0.681
Validation loss decreased (-0.667133 --> -0.681322).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3769856
	speed: 0.3645s/iter; left time: 12473.2478s
	iters: 200, epoch: 8 | loss: 0.3231544
	speed: 0.0983s/iter; left time: 3354.5232s
	iters: 300, epoch: 8 | loss: 0.4240618
	speed: 0.1033s/iter; left time: 3514.2244s
Epoch: 8 cost time: 38.18201661109924
Epoch: 8, Steps: 369 | Train Loss: 0.406 Vali Loss: 0.705 Vali Acc: 0.664 Test Loss: 0.705 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1774056
	speed: 0.3582s/iter; left time: 12126.3757s
	iters: 200, epoch: 9 | loss: 0.6194696
	speed: 0.1174s/iter; left time: 3961.2938s
	iters: 300, epoch: 9 | loss: 0.4165406
	speed: 0.1055s/iter; left time: 3550.3679s
Epoch: 9 cost time: 42.29178547859192
Epoch: 9, Steps: 369 | Train Loss: 0.362 Vali Loss: 0.796 Vali Acc: 0.668 Test Loss: 0.796 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2870317
	speed: 0.3539s/iter; left time: 11849.6877s
	iters: 200, epoch: 10 | loss: 0.3814230
	speed: 0.1043s/iter; left time: 3481.4333s
	iters: 300, epoch: 10 | loss: 0.3364260
	speed: 0.1202s/iter; left time: 4001.0810s
Epoch: 10 cost time: 41.02885031700134
Epoch: 10, Steps: 369 | Train Loss: 0.321 Vali Loss: 0.825 Vali Acc: 0.661 Test Loss: 0.825 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.4817455
	speed: 0.3907s/iter; left time: 12935.7813s
	iters: 200, epoch: 11 | loss: 0.6748865
	speed: 0.0933s/iter; left time: 3080.8189s
	iters: 300, epoch: 11 | loss: 0.1953783
	speed: 0.1010s/iter; left time: 3325.2715s
Epoch: 11 cost time: 37.35576105117798
Epoch: 11, Steps: 369 | Train Loss: 0.278 Vali Loss: 1.039 Vali Acc: 0.654 Test Loss: 1.039 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3468725
	speed: 0.3595s/iter; left time: 11769.9219s
	iters: 200, epoch: 12 | loss: 0.3186646
	speed: 0.1098s/iter; left time: 3584.4691s
	iters: 300, epoch: 12 | loss: 0.2638571
	speed: 0.0970s/iter; left time: 3156.3493s
Epoch: 12 cost time: 38.27306365966797
Epoch: 12, Steps: 369 | Train Loss: 0.248 Vali Loss: 0.951 Vali Acc: 0.676 Test Loss: 0.951 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1987361
	speed: 0.3513s/iter; left time: 11373.5635s
	iters: 200, epoch: 13 | loss: 0.0967413
	speed: 0.1042s/iter; left time: 3361.9047s
	iters: 300, epoch: 13 | loss: 0.2009046
	speed: 0.1010s/iter; left time: 3248.8869s
Epoch: 13 cost time: 39.338724851608276
Epoch: 13, Steps: 369 | Train Loss: 0.223 Vali Loss: 0.958 Vali Acc: 0.655 Test Loss: 0.958 Test Acc: 0.655
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0959219
	speed: 0.3366s/iter; left time: 10772.6029s
	iters: 200, epoch: 14 | loss: 0.4012156
	speed: 0.1159s/iter; left time: 3698.5910s
	iters: 300, epoch: 14 | loss: 0.1656443
	speed: 0.1231s/iter; left time: 3914.0028s
Epoch: 14 cost time: 41.93293333053589
Epoch: 14, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.238 Vali Acc: 0.631 Test Loss: 1.238 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0347287
	speed: 0.3465s/iter; left time: 10962.2373s
	iters: 200, epoch: 15 | loss: 0.1501469
	speed: 0.0994s/iter; left time: 3135.5130s
	iters: 300, epoch: 15 | loss: 0.2031654
	speed: 0.1029s/iter; left time: 3235.1729s
Epoch: 15 cost time: 38.34689021110535
Epoch: 15, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.502 Vali Acc: 0.642 Test Loss: 1.502 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0858029
	speed: 0.3682s/iter; left time: 11512.3487s
	iters: 200, epoch: 16 | loss: 0.0197462
	speed: 0.1041s/iter; left time: 3244.5489s
	iters: 300, epoch: 16 | loss: 0.2500818
	speed: 0.0976s/iter; left time: 3030.5993s
Epoch: 16 cost time: 38.8515522480011
Epoch: 16, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.413 Vali Acc: 0.631 Test Loss: 1.413 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.7742087
	speed: 0.3563s/iter; left time: 11010.1251s
	iters: 200, epoch: 17 | loss: 0.0482570
	speed: 0.1026s/iter; left time: 3158.9160s
	iters: 300, epoch: 17 | loss: 0.2268618
	speed: 0.1204s/iter; left time: 3695.4587s
Epoch: 17 cost time: 41.21180200576782
Epoch: 17, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.354 Vali Acc: 0.656 Test Loss: 1.354 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6813280363223609
model parameter : 836862
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6215048
	speed: 0.1173s/iter; left time: 4315.4301s
	iters: 200, epoch: 1 | loss: 1.4343942
	speed: 0.1155s/iter; left time: 4238.2442s
	iters: 300, epoch: 1 | loss: 0.5161119
	speed: 0.1166s/iter; left time: 4266.3025s
Epoch: 1 cost time: 42.97180151939392
Epoch: 1, Steps: 369 | Train Loss: 0.731 Vali Loss: 0.784 Vali Acc: 0.639 Test Loss: 0.784 Test Acc: 0.639
Validation loss decreased (inf --> -0.639322).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5639908
	speed: 0.3620s/iter; left time: 13186.8585s
	iters: 200, epoch: 2 | loss: 0.3766017
	speed: 0.0966s/iter; left time: 3510.3873s
	iters: 300, epoch: 2 | loss: 0.8950794
	speed: 0.0948s/iter; left time: 3434.9014s
Epoch: 2 cost time: 36.61429977416992
Epoch: 2, Steps: 369 | Train Loss: 0.638 Vali Loss: 0.741 Vali Acc: 0.644 Test Loss: 0.741 Test Acc: 0.644
Validation loss decreased (-0.639322 --> -0.643579).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8792173
	speed: 0.3848s/iter; left time: 13876.5795s
	iters: 200, epoch: 3 | loss: 0.3789234
	speed: 0.1019s/iter; left time: 3666.4248s
	iters: 300, epoch: 3 | loss: 0.6221525
	speed: 0.1009s/iter; left time: 3620.1222s
Epoch: 3 cost time: 39.5477180480957
Epoch: 3, Steps: 369 | Train Loss: 0.586 Vali Loss: 0.690 Vali Acc: 0.650 Test Loss: 0.690 Test Acc: 0.650
Validation loss decreased (-0.643579 --> -0.649823).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5460652
	speed: 0.3438s/iter; left time: 12270.4091s
	iters: 200, epoch: 4 | loss: 0.5302773
	speed: 0.1010s/iter; left time: 3596.2235s
	iters: 300, epoch: 4 | loss: 0.4685341
	speed: 0.0882s/iter; left time: 3129.4277s
Epoch: 4 cost time: 42.59155488014221
Epoch: 4, Steps: 369 | Train Loss: 0.560 Vali Loss: 0.660 Vali Acc: 0.659 Test Loss: 0.660 Test Acc: 0.659
Validation loss decreased (-0.649823 --> -0.659188).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4880035
	speed: 0.4631s/iter; left time: 16359.4133s
	iters: 200, epoch: 5 | loss: 0.6094331
	speed: 0.0779s/iter; left time: 2744.6607s
	iters: 300, epoch: 5 | loss: 0.6222469
	speed: 0.0781s/iter; left time: 2743.0457s
Epoch: 5 cost time: 34.04900646209717
Epoch: 5, Steps: 369 | Train Loss: 0.531 Vali Loss: 0.671 Vali Acc: 0.671 Test Loss: 0.671 Test Acc: 0.671
Validation loss decreased (-0.659188 --> -0.671389).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7020276
	speed: 0.3684s/iter; left time: 12876.3299s
	iters: 200, epoch: 6 | loss: 0.4013448
	speed: 0.1162s/iter; left time: 4051.7020s
	iters: 300, epoch: 6 | loss: 0.7178942
	speed: 0.1039s/iter; left time: 3610.3338s
Epoch: 6 cost time: 42.79128813743591
Epoch: 6, Steps: 369 | Train Loss: 0.491 Vali Loss: 0.647 Vali Acc: 0.675 Test Loss: 0.647 Test Acc: 0.675
Validation loss decreased (-0.671389 --> -0.675362).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3561726
	speed: 0.3744s/iter; left time: 12950.8841s
	iters: 200, epoch: 7 | loss: 0.5754401
	speed: 0.1182s/iter; left time: 4075.3186s
	iters: 300, epoch: 7 | loss: 0.5050895
	speed: 0.1181s/iter; left time: 4059.4726s
Epoch: 7 cost time: 43.40698575973511
Epoch: 7, Steps: 369 | Train Loss: 0.443 Vali Loss: 0.667 Vali Acc: 0.669 Test Loss: 0.667 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4665319
	speed: 0.3850s/iter; left time: 13174.8477s
	iters: 200, epoch: 8 | loss: 0.2738629
	speed: 0.1015s/iter; left time: 3463.2915s
	iters: 300, epoch: 8 | loss: 0.5410259
	speed: 0.0913s/iter; left time: 3107.2156s
Epoch: 8 cost time: 37.818145990371704
Epoch: 8, Steps: 369 | Train Loss: 0.403 Vali Loss: 0.748 Vali Acc: 0.670 Test Loss: 0.748 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1251920
	speed: 0.4035s/iter; left time: 13657.3731s
	iters: 200, epoch: 9 | loss: 0.3788348
	speed: 0.1069s/iter; left time: 3608.6446s
	iters: 300, epoch: 9 | loss: 0.1335709
	speed: 0.1054s/iter; left time: 3548.2613s
Epoch: 9 cost time: 40.89298176765442
Epoch: 9, Steps: 369 | Train Loss: 0.354 Vali Loss: 0.823 Vali Acc: 0.654 Test Loss: 0.823 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1675810
	speed: 0.3749s/iter; left time: 12550.9825s
	iters: 200, epoch: 10 | loss: 0.1445189
	speed: 0.1006s/iter; left time: 3357.4407s
	iters: 300, epoch: 10 | loss: 0.3707808
	speed: 0.1202s/iter; left time: 3998.9677s
Epoch: 10 cost time: 41.16744661331177
Epoch: 10, Steps: 369 | Train Loss: 0.330 Vali Loss: 0.791 Vali Acc: 0.642 Test Loss: 0.791 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1296422
	speed: 0.3833s/iter; left time: 12691.5485s
	iters: 200, epoch: 11 | loss: 0.2272467
	speed: 0.0992s/iter; left time: 3275.6158s
	iters: 300, epoch: 11 | loss: 0.5886090
	speed: 0.1049s/iter; left time: 3453.5785s
Epoch: 11 cost time: 39.06798815727234
Epoch: 11, Steps: 369 | Train Loss: 0.284 Vali Loss: 0.820 Vali Acc: 0.654 Test Loss: 0.820 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.4966347
	speed: 0.3863s/iter; left time: 12647.1684s
	iters: 200, epoch: 12 | loss: 0.3144205
	speed: 0.1022s/iter; left time: 3336.7044s
	iters: 300, epoch: 12 | loss: 0.0782160
	speed: 0.1016s/iter; left time: 3305.5945s
Epoch: 12 cost time: 39.93092608451843
Epoch: 12, Steps: 369 | Train Loss: 0.248 Vali Loss: 1.000 Vali Acc: 0.671 Test Loss: 1.000 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1092982
	speed: 0.3567s/iter; left time: 11548.9347s
	iters: 200, epoch: 13 | loss: 0.1194987
	speed: 0.1100s/iter; left time: 3548.7220s
	iters: 300, epoch: 13 | loss: 0.0461706
	speed: 0.1260s/iter; left time: 4055.0188s
Epoch: 13 cost time: 42.55872678756714
Epoch: 13, Steps: 369 | Train Loss: 0.219 Vali Loss: 1.067 Vali Acc: 0.651 Test Loss: 1.067 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.3284284
	speed: 0.3888s/iter; left time: 12444.6869s
	iters: 200, epoch: 14 | loss: 0.0760967
	speed: 0.1021s/iter; left time: 3256.8250s
	iters: 300, epoch: 14 | loss: 0.0847694
	speed: 0.1030s/iter; left time: 3276.1562s
Epoch: 14 cost time: 38.27939701080322
Epoch: 14, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.286 Vali Acc: 0.648 Test Loss: 1.286 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0074047
	speed: 0.3819s/iter; left time: 12081.8026s
	iters: 200, epoch: 15 | loss: 0.0654268
	speed: 0.1065s/iter; left time: 3358.3949s
	iters: 300, epoch: 15 | loss: 0.0441124
	speed: 0.1037s/iter; left time: 3258.5560s
Epoch: 15 cost time: 40.146023750305176
Epoch: 15, Steps: 369 | Train Loss: 0.177 Vali Loss: 1.264 Vali Acc: 0.657 Test Loss: 1.264 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0429670
	speed: 0.3685s/iter; left time: 11521.8730s
	iters: 200, epoch: 16 | loss: 0.5094202
	speed: 0.1156s/iter; left time: 3601.4799s
	iters: 300, epoch: 16 | loss: 0.3810078
	speed: 0.1150s/iter; left time: 3571.0398s
Epoch: 16 cost time: 41.88426637649536
Epoch: 16, Steps: 369 | Train Loss: 0.165 Vali Loss: 1.230 Vali Acc: 0.632 Test Loss: 1.230 Test Acc: 0.632
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6753688989784336
model parameter : 836094
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7445574
	speed: 0.1319s/iter; left time: 4852.5523s
	iters: 200, epoch: 1 | loss: 0.4989280
	speed: 0.1066s/iter; left time: 3913.7701s
	iters: 300, epoch: 1 | loss: 1.3271620
	speed: 0.1058s/iter; left time: 3872.1796s
Epoch: 1 cost time: 40.69209432601929
Epoch: 1, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.678 Vali Acc: 0.667 Test Loss: 0.678 Test Acc: 0.667
Validation loss decreased (inf --> -0.666565).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8926153
	speed: 0.3477s/iter; left time: 12665.5872s
	iters: 200, epoch: 2 | loss: 0.3972791
	speed: 0.0946s/iter; left time: 3437.4382s
	iters: 300, epoch: 2 | loss: 0.6712568
	speed: 0.0988s/iter; left time: 3578.1341s
Epoch: 2 cost time: 35.8104202747345
Epoch: 2, Steps: 369 | Train Loss: 0.663 Vali Loss: 0.633 Vali Acc: 0.652 Test Loss: 0.633 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5254331
	speed: 0.3755s/iter; left time: 13543.1933s
	iters: 200, epoch: 3 | loss: 0.2346063
	speed: 0.0999s/iter; left time: 3591.5836s
	iters: 300, epoch: 3 | loss: 0.8362544
	speed: 0.1016s/iter; left time: 3643.4923s
Epoch: 3 cost time: 39.42401671409607
Epoch: 3, Steps: 369 | Train Loss: 0.573 Vali Loss: 0.987 Vali Acc: 0.618 Test Loss: 0.987 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4090375
	speed: 0.3572s/iter; left time: 12748.4988s
	iters: 200, epoch: 4 | loss: 0.4441985
	speed: 0.1064s/iter; left time: 3787.7002s
	iters: 300, epoch: 4 | loss: 0.9307392
	speed: 0.1163s/iter; left time: 4126.7320s
Epoch: 4 cost time: 41.06870627403259
Epoch: 4, Steps: 369 | Train Loss: 0.565 Vali Loss: 0.718 Vali Acc: 0.649 Test Loss: 0.718 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.5496382
	speed: 0.3512s/iter; left time: 12406.8202s
	iters: 200, epoch: 5 | loss: 0.6506024
	speed: 0.0993s/iter; left time: 3497.8024s
	iters: 300, epoch: 5 | loss: 0.6724414
	speed: 0.1012s/iter; left time: 3554.7441s
Epoch: 5 cost time: 37.575157165527344
Epoch: 5, Steps: 369 | Train Loss: 0.523 Vali Loss: 0.646 Vali Acc: 0.663 Test Loss: 0.646 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.4663513
	speed: 0.3611s/iter; left time: 12624.2386s
	iters: 200, epoch: 6 | loss: 0.5021096
	speed: 0.0960s/iter; left time: 3347.8711s
	iters: 300, epoch: 6 | loss: 0.6081389
	speed: 0.0955s/iter; left time: 3319.3669s
Epoch: 6 cost time: 38.09780311584473
Epoch: 6, Steps: 369 | Train Loss: 0.479 Vali Loss: 0.669 Vali Acc: 0.676 Test Loss: 0.669 Test Acc: 0.676
Validation loss decreased (-0.666565 --> -0.675646).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4247887
	speed: 0.3523s/iter; left time: 12184.6468s
	iters: 200, epoch: 7 | loss: 0.3736410
	speed: 0.0909s/iter; left time: 3135.6329s
	iters: 300, epoch: 7 | loss: 0.8446646
	speed: 0.1060s/iter; left time: 3644.9171s
Epoch: 7 cost time: 38.464775800704956
Epoch: 7, Steps: 369 | Train Loss: 0.445 Vali Loss: 0.740 Vali Acc: 0.659 Test Loss: 0.740 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2883410
	speed: 0.3540s/iter; left time: 12113.7476s
	iters: 200, epoch: 8 | loss: 0.5181257
	speed: 0.1029s/iter; left time: 3511.2568s
	iters: 300, epoch: 8 | loss: 0.3106095
	speed: 0.1014s/iter; left time: 3448.3309s
Epoch: 8 cost time: 37.09764289855957
Epoch: 8, Steps: 369 | Train Loss: 0.398 Vali Loss: 0.733 Vali Acc: 0.675 Test Loss: 0.733 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5772348
	speed: 0.3707s/iter; left time: 12548.5218s
	iters: 200, epoch: 9 | loss: 0.4182549
	speed: 0.1265s/iter; left time: 4270.8016s
	iters: 300, epoch: 9 | loss: 0.3196920
	speed: 0.1123s/iter; left time: 3780.0950s
Epoch: 9 cost time: 43.732094287872314
Epoch: 9, Steps: 369 | Train Loss: 0.370 Vali Loss: 0.806 Vali Acc: 0.658 Test Loss: 0.806 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2527699
	speed: 0.3634s/iter; left time: 12165.3685s
	iters: 200, epoch: 10 | loss: 0.3722099
	speed: 0.1106s/iter; left time: 3691.9477s
	iters: 300, epoch: 10 | loss: 0.2358841
	speed: 0.1177s/iter; left time: 3917.7459s
Epoch: 10 cost time: 43.15420985221863
Epoch: 10, Steps: 369 | Train Loss: 0.326 Vali Loss: 0.906 Vali Acc: 0.652 Test Loss: 0.906 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3719063
	speed: 0.3853s/iter; left time: 12757.4727s
	iters: 200, epoch: 11 | loss: 0.2651746
	speed: 0.1058s/iter; left time: 3492.7978s
	iters: 300, epoch: 11 | loss: 0.3588919
	speed: 0.1025s/iter; left time: 3373.8088s
Epoch: 11 cost time: 39.64470958709717
Epoch: 11, Steps: 369 | Train Loss: 0.292 Vali Loss: 0.856 Vali Acc: 0.667 Test Loss: 0.856 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2027862
	speed: 0.4002s/iter; left time: 13103.5569s
	iters: 200, epoch: 12 | loss: 0.0888521
	speed: 0.1217s/iter; left time: 3973.6731s
	iters: 300, epoch: 12 | loss: 0.3566934
	speed: 0.1097s/iter; left time: 3568.3279s
Epoch: 12 cost time: 43.68237233161926
Epoch: 12, Steps: 369 | Train Loss: 0.256 Vali Loss: 1.108 Vali Acc: 0.652 Test Loss: 1.108 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2131527
	speed: 0.3729s/iter; left time: 12070.4706s
	iters: 200, epoch: 13 | loss: 0.0651660
	speed: 0.1061s/iter; left time: 3424.3444s
	iters: 300, epoch: 13 | loss: 0.0850744
	speed: 0.1053s/iter; left time: 3386.8138s
Epoch: 13 cost time: 40.36505389213562
Epoch: 13, Steps: 369 | Train Loss: 0.223 Vali Loss: 1.166 Vali Acc: 0.661 Test Loss: 1.166 Test Acc: 0.661
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1176724
	speed: 0.3836s/iter; left time: 12275.9803s
	iters: 200, epoch: 14 | loss: 0.1877900
	speed: 0.1049s/iter; left time: 3346.6124s
	iters: 300, epoch: 14 | loss: 0.3030293
	speed: 0.1074s/iter; left time: 3414.9229s
Epoch: 14 cost time: 41.32635545730591
Epoch: 14, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.274 Vali Acc: 0.649 Test Loss: 1.274 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.4541930
	speed: 0.3514s/iter; left time: 11117.5159s
	iters: 200, epoch: 15 | loss: 0.4236968
	speed: 0.1232s/iter; left time: 3886.5222s
	iters: 300, epoch: 15 | loss: 0.3969882
	speed: 0.1217s/iter; left time: 3827.0368s
Epoch: 15 cost time: 42.97136163711548
Epoch: 15, Steps: 369 | Train Loss: 0.187 Vali Loss: 1.105 Vali Acc: 0.652 Test Loss: 1.105 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0208308
	speed: 0.3710s/iter; left time: 11598.3569s
	iters: 200, epoch: 16 | loss: 0.0245139
	speed: 0.1070s/iter; left time: 3334.0613s
	iters: 300, epoch: 16 | loss: 0.1750761
	speed: 0.1085s/iter; left time: 3370.2835s
Epoch: 16 cost time: 40.16644763946533
Epoch: 16, Steps: 369 | Train Loss: 0.166 Vali Loss: 1.097 Vali Acc: 0.655 Test Loss: 1.097 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6756526674233825
model parameter : 835326
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7691367
	speed: 0.1435s/iter; left time: 5279.6152s
	iters: 200, epoch: 1 | loss: 0.7951723
	speed: 0.1001s/iter; left time: 3675.2451s
	iters: 300, epoch: 1 | loss: 0.5369104
	speed: 0.0921s/iter; left time: 3372.4936s
Epoch: 1 cost time: 40.48422694206238
Epoch: 1, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.696 Vali Acc: 0.620 Test Loss: 0.696 Test Acc: 0.620
Validation loss decreased (inf --> -0.620027).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8431717
	speed: 0.3515s/iter; left time: 12805.2072s
	iters: 200, epoch: 2 | loss: 0.9548378
	speed: 0.1050s/iter; left time: 3813.5217s
	iters: 300, epoch: 2 | loss: 0.7360295
	speed: 0.1092s/iter; left time: 3957.4499s
Epoch: 2 cost time: 40.79540300369263
Epoch: 2, Steps: 369 | Train Loss: 0.648 Vali Loss: 0.657 Vali Acc: 0.654 Test Loss: 0.657 Test Acc: 0.654
Validation loss decreased (-0.620027 --> -0.653796).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5524073
	speed: 0.3645s/iter; left time: 13145.0217s
	iters: 200, epoch: 3 | loss: 0.6024488
	speed: 0.1019s/iter; left time: 3663.6230s
	iters: 300, epoch: 3 | loss: 0.7073067
	speed: 0.1084s/iter; left time: 3886.5602s
Epoch: 3 cost time: 39.044368267059326
Epoch: 3, Steps: 369 | Train Loss: 0.598 Vali Loss: 0.732 Vali Acc: 0.634 Test Loss: 0.732 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5354556
	speed: 0.3746s/iter; left time: 13371.8317s
	iters: 200, epoch: 4 | loss: 0.4120262
	speed: 0.1177s/iter; left time: 4189.9089s
	iters: 300, epoch: 4 | loss: 0.4710448
	speed: 0.0967s/iter; left time: 3433.7882s
Epoch: 4 cost time: 41.49661588668823
Epoch: 4, Steps: 369 | Train Loss: 0.548 Vali Loss: 0.658 Vali Acc: 0.648 Test Loss: 0.658 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8377749
	speed: 0.3483s/iter; left time: 12305.2982s
	iters: 200, epoch: 5 | loss: 0.5187953
	speed: 0.1021s/iter; left time: 3595.8819s
	iters: 300, epoch: 5 | loss: 0.4548656
	speed: 0.0933s/iter; left time: 3275.8150s
Epoch: 5 cost time: 38.48814654350281
Epoch: 5, Steps: 369 | Train Loss: 0.528 Vali Loss: 0.613 Vali Acc: 0.678 Test Loss: 0.613 Test Acc: 0.678
Validation loss decreased (-0.653796 --> -0.678484).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2301406
	speed: 0.3832s/iter; left time: 13395.8777s
	iters: 200, epoch: 6 | loss: 0.4902039
	speed: 0.0970s/iter; left time: 3381.5901s
	iters: 300, epoch: 6 | loss: 0.7076274
	speed: 0.1029s/iter; left time: 3575.7508s
Epoch: 6 cost time: 38.34691834449768
Epoch: 6, Steps: 369 | Train Loss: 0.482 Vali Loss: 0.657 Vali Acc: 0.655 Test Loss: 0.657 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4828041
	speed: 0.3688s/iter; left time: 12756.5193s
	iters: 200, epoch: 7 | loss: 0.4419970
	speed: 0.1093s/iter; left time: 3770.6543s
	iters: 300, epoch: 7 | loss: 0.2482512
	speed: 0.1169s/iter; left time: 4018.7782s
Epoch: 7 cost time: 42.19110441207886
Epoch: 7, Steps: 369 | Train Loss: 0.436 Vali Loss: 0.686 Vali Acc: 0.675 Test Loss: 0.686 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3744428
	speed: 0.3626s/iter; left time: 12406.6810s
	iters: 200, epoch: 8 | loss: 0.7138021
	speed: 0.0969s/iter; left time: 3306.6327s
	iters: 300, epoch: 8 | loss: 0.5848112
	speed: 0.1040s/iter; left time: 3536.7949s
Epoch: 8 cost time: 37.24642276763916
Epoch: 8, Steps: 369 | Train Loss: 0.402 Vali Loss: 0.666 Vali Acc: 0.693 Test Loss: 0.666 Test Acc: 0.693
Validation loss decreased (-0.678484 --> -0.693240).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3727483
	speed: 0.3696s/iter; left time: 12510.1399s
	iters: 200, epoch: 9 | loss: 0.4966080
	speed: 0.1099s/iter; left time: 3710.2015s
	iters: 300, epoch: 9 | loss: 0.3970761
	speed: 0.1018s/iter; left time: 3424.6700s
Epoch: 9 cost time: 40.92511200904846
Epoch: 9, Steps: 369 | Train Loss: 0.366 Vali Loss: 0.750 Vali Acc: 0.672 Test Loss: 0.750 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2105039
	speed: 0.3457s/iter; left time: 11575.4465s
	iters: 200, epoch: 10 | loss: 0.3714775
	speed: 0.0997s/iter; left time: 3327.0257s
	iters: 300, epoch: 10 | loss: 0.0346490
	speed: 0.1002s/iter; left time: 3335.6331s
Epoch: 10 cost time: 37.53796720504761
Epoch: 10, Steps: 369 | Train Loss: 0.324 Vali Loss: 0.762 Vali Acc: 0.663 Test Loss: 0.762 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0508207
	speed: 0.3700s/iter; left time: 12249.8861s
	iters: 200, epoch: 11 | loss: 0.1840668
	speed: 0.0960s/iter; left time: 3169.2778s
	iters: 300, epoch: 11 | loss: 0.2423485
	speed: 0.1025s/iter; left time: 3373.7197s
Epoch: 11 cost time: 36.64779806137085
Epoch: 11, Steps: 369 | Train Loss: 0.290 Vali Loss: 0.805 Vali Acc: 0.665 Test Loss: 0.805 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2364880
	speed: 0.3495s/iter; left time: 11443.1438s
	iters: 200, epoch: 12 | loss: 0.1295186
	speed: 0.1030s/iter; left time: 3362.6824s
	iters: 300, epoch: 12 | loss: 0.3463353
	speed: 0.1197s/iter; left time: 3896.6091s
Epoch: 12 cost time: 40.367242097854614
Epoch: 12, Steps: 369 | Train Loss: 0.261 Vali Loss: 1.072 Vali Acc: 0.651 Test Loss: 1.072 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1158812
	speed: 0.3692s/iter; left time: 11952.7962s
	iters: 200, epoch: 13 | loss: 0.2775758
	speed: 0.1088s/iter; left time: 3510.2656s
	iters: 300, epoch: 13 | loss: 0.2113174
	speed: 0.1068s/iter; left time: 3436.5526s
Epoch: 13 cost time: 40.13651657104492
Epoch: 13, Steps: 369 | Train Loss: 0.239 Vali Loss: 0.867 Vali Acc: 0.657 Test Loss: 0.867 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.3968743
	speed: 0.3771s/iter; left time: 12069.7699s
	iters: 200, epoch: 14 | loss: 0.2912215
	speed: 0.1051s/iter; left time: 3354.4164s
	iters: 300, epoch: 14 | loss: 0.1373644
	speed: 0.1000s/iter; left time: 3180.6662s
Epoch: 14 cost time: 40.60979080200195
Epoch: 14, Steps: 369 | Train Loss: 0.193 Vali Loss: 1.145 Vali Acc: 0.662 Test Loss: 1.145 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.5502126
	speed: 0.3724s/iter; left time: 11779.4009s
	iters: 200, epoch: 15 | loss: 0.0956285
	speed: 0.1107s/iter; left time: 3491.5065s
	iters: 300, epoch: 15 | loss: 0.2317055
	speed: 0.1160s/iter; left time: 3646.5601s
Epoch: 15 cost time: 41.36649680137634
Epoch: 15, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.217 Vali Acc: 0.649 Test Loss: 1.217 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1588303
	speed: 0.3715s/iter; left time: 11616.3991s
	iters: 200, epoch: 16 | loss: 0.1772139
	speed: 0.0981s/iter; left time: 3057.8673s
	iters: 300, epoch: 16 | loss: 0.0231541
	speed: 0.1082s/iter; left time: 3361.0591s
Epoch: 16 cost time: 38.671207904815674
Epoch: 16, Steps: 369 | Train Loss: 0.165 Vali Loss: 1.241 Vali Acc: 0.653 Test Loss: 1.241 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1523554
	speed: 0.3927s/iter; left time: 12134.1423s
	iters: 200, epoch: 17 | loss: 0.1568573
	speed: 0.1185s/iter; left time: 3650.2693s
	iters: 300, epoch: 17 | loss: 0.1593053
	speed: 0.1016s/iter; left time: 3119.0453s
Epoch: 17 cost time: 41.535279750823975
Epoch: 17, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.340 Vali Acc: 0.657 Test Loss: 1.340 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.2037689
	speed: 0.3789s/iter; left time: 11567.6296s
	iters: 200, epoch: 18 | loss: 0.1278827
	speed: 0.1044s/iter; left time: 3177.9988s
	iters: 300, epoch: 18 | loss: 0.0349022
	speed: 0.1074s/iter; left time: 3255.9879s
Epoch: 18 cost time: 40.859588861465454
Epoch: 18, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.633 Vali Acc: 0.642 Test Loss: 1.633 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6932463110102156
model parameter : 834558
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8461555
	speed: 0.1162s/iter; left time: 4277.5068s
	iters: 200, epoch: 1 | loss: 0.5660512
	speed: 0.1016s/iter; left time: 3728.2526s
	iters: 300, epoch: 1 | loss: 0.8180910
	speed: 0.1111s/iter; left time: 4066.6206s
Epoch: 1 cost time: 41.45600414276123
Epoch: 1, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.657 Vali Acc: 0.642 Test Loss: 0.657 Test Acc: 0.642
Validation loss decreased (inf --> -0.641594).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6155223
	speed: 0.3694s/iter; left time: 13457.6940s
	iters: 200, epoch: 2 | loss: 0.7949284
	speed: 0.1007s/iter; left time: 3659.2994s
	iters: 300, epoch: 2 | loss: 0.5461337
	speed: 0.1044s/iter; left time: 3782.2137s
Epoch: 2 cost time: 37.916773319244385
Epoch: 2, Steps: 369 | Train Loss: 0.635 Vali Loss: 0.910 Vali Acc: 0.577 Test Loss: 0.910 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4820873
	speed: 0.3601s/iter; left time: 12984.6912s
	iters: 200, epoch: 3 | loss: 1.2493731
	speed: 0.1139s/iter; left time: 4096.3130s
	iters: 300, epoch: 3 | loss: 0.6001002
	speed: 0.1134s/iter; left time: 4068.1328s
Epoch: 3 cost time: 41.52337288856506
Epoch: 3, Steps: 369 | Train Loss: 0.629 Vali Loss: 0.702 Vali Acc: 0.585 Test Loss: 0.702 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7714120
	speed: 0.3474s/iter; left time: 12398.7139s
	iters: 200, epoch: 4 | loss: 0.5064176
	speed: 0.1022s/iter; left time: 3636.3701s
	iters: 300, epoch: 4 | loss: 0.8966275
	speed: 0.1022s/iter; left time: 3628.2254s
Epoch: 4 cost time: 38.074750661849976
Epoch: 4, Steps: 369 | Train Loss: 0.591 Vali Loss: 0.636 Vali Acc: 0.659 Test Loss: 0.636 Test Acc: 0.659
Validation loss decreased (-0.641594 --> -0.659472).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5802763
	speed: 0.3507s/iter; left time: 12388.4079s
	iters: 200, epoch: 5 | loss: 0.4775966
	speed: 0.0992s/iter; left time: 3493.1456s
	iters: 300, epoch: 5 | loss: 0.3820668
	speed: 0.0999s/iter; left time: 3508.8211s
Epoch: 5 cost time: 38.06444191932678
Epoch: 5, Steps: 369 | Train Loss: 0.575 Vali Loss: 0.650 Vali Acc: 0.660 Test Loss: 0.650 Test Acc: 0.660
Validation loss decreased (-0.659472 --> -0.660323).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6233313
	speed: 0.3420s/iter; left time: 11954.2591s
	iters: 200, epoch: 6 | loss: 0.9336300
	speed: 0.1025s/iter; left time: 3571.7419s
	iters: 300, epoch: 6 | loss: 0.6127146
	speed: 0.1111s/iter; left time: 3861.2866s
Epoch: 6 cost time: 40.064486026763916
Epoch: 6, Steps: 369 | Train Loss: 0.556 Vali Loss: 0.652 Vali Acc: 0.664 Test Loss: 0.652 Test Acc: 0.664
Validation loss decreased (-0.660323 --> -0.664295).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7126719
	speed: 0.3718s/iter; left time: 12859.9243s
	iters: 200, epoch: 7 | loss: 0.4470794
	speed: 0.1014s/iter; left time: 3497.9232s
	iters: 300, epoch: 7 | loss: 0.4338994
	speed: 0.1049s/iter; left time: 3608.1667s
Epoch: 7 cost time: 38.705023765563965
Epoch: 7, Steps: 369 | Train Loss: 0.525 Vali Loss: 0.640 Vali Acc: 0.669 Test Loss: 0.640 Test Acc: 0.669
Validation loss decreased (-0.664295 --> -0.668552).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4596453
	speed: 0.3860s/iter; left time: 13208.8070s
	iters: 200, epoch: 8 | loss: 0.3711003
	speed: 0.1030s/iter; left time: 3514.7861s
	iters: 300, epoch: 8 | loss: 0.3727076
	speed: 0.1032s/iter; left time: 3511.0526s
Epoch: 8 cost time: 39.647950172424316
Epoch: 8, Steps: 369 | Train Loss: 0.510 Vali Loss: 0.634 Vali Acc: 0.653 Test Loss: 0.634 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6197373
	speed: 0.3568s/iter; left time: 12077.0807s
	iters: 200, epoch: 9 | loss: 0.3932697
	speed: 0.1005s/iter; left time: 3390.4466s
	iters: 300, epoch: 9 | loss: 0.4470582
	speed: 0.0999s/iter; left time: 3362.3816s
Epoch: 9 cost time: 38.51339149475098
Epoch: 9, Steps: 369 | Train Loss: 0.482 Vali Loss: 0.705 Vali Acc: 0.648 Test Loss: 0.705 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3985954
	speed: 0.3673s/iter; left time: 12296.5934s
	iters: 200, epoch: 10 | loss: 0.4533139
	speed: 0.1095s/iter; left time: 3656.7528s
	iters: 300, epoch: 10 | loss: 0.6874145
	speed: 0.0987s/iter; left time: 3286.2839s
Epoch: 10 cost time: 39.99310612678528
Epoch: 10, Steps: 369 | Train Loss: 0.473 Vali Loss: 0.673 Vali Acc: 0.658 Test Loss: 0.673 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.4150568
	speed: 0.3596s/iter; left time: 11907.9852s
	iters: 200, epoch: 11 | loss: 0.4536074
	speed: 0.1089s/iter; left time: 3593.6016s
	iters: 300, epoch: 11 | loss: 0.5796936
	speed: 0.1134s/iter; left time: 3733.5264s
Epoch: 11 cost time: 40.97243070602417
Epoch: 11, Steps: 369 | Train Loss: 0.445 Vali Loss: 0.636 Vali Acc: 0.682 Test Loss: 0.636 Test Acc: 0.682
Validation loss decreased (-0.668552 --> -0.681889).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4692014
	speed: 0.3608s/iter; left time: 11813.2811s
	iters: 200, epoch: 12 | loss: 0.3122338
	speed: 0.0954s/iter; left time: 3113.7177s
	iters: 300, epoch: 12 | loss: 0.3073823
	speed: 0.0964s/iter; left time: 3136.0389s
Epoch: 12 cost time: 35.903908014297485
Epoch: 12, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.722 Vali Acc: 0.633 Test Loss: 0.722 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.4600319
	speed: 0.3643s/iter; left time: 11794.9371s
	iters: 200, epoch: 13 | loss: 0.2606463
	speed: 0.1088s/iter; left time: 3509.7828s
	iters: 300, epoch: 13 | loss: 0.5046628
	speed: 0.1046s/iter; left time: 3363.8134s
Epoch: 13 cost time: 40.041646003723145
Epoch: 13, Steps: 369 | Train Loss: 0.415 Vali Loss: 0.773 Vali Acc: 0.659 Test Loss: 0.773 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7422746
	speed: 0.3645s/iter; left time: 11666.0167s
	iters: 200, epoch: 14 | loss: 0.5005110
	speed: 0.1018s/iter; left time: 3247.0050s
	iters: 300, epoch: 14 | loss: 0.3650337
	speed: 0.1051s/iter; left time: 3342.2084s
Epoch: 14 cost time: 40.107582330703735
Epoch: 14, Steps: 369 | Train Loss: 0.398 Vali Loss: 0.755 Vali Acc: 0.651 Test Loss: 0.755 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.5684639
	speed: 0.3600s/iter; left time: 11389.3505s
	iters: 200, epoch: 15 | loss: 0.3612676
	speed: 0.1053s/iter; left time: 3319.4358s
	iters: 300, epoch: 15 | loss: 0.4755271
	speed: 0.1049s/iter; left time: 3295.9616s
Epoch: 15 cost time: 38.89159536361694
Epoch: 15, Steps: 369 | Train Loss: 0.376 Vali Loss: 0.710 Vali Acc: 0.665 Test Loss: 0.710 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.4393116
	speed: 0.3681s/iter; left time: 11510.3869s
	iters: 200, epoch: 16 | loss: 0.2747594
	speed: 0.1176s/iter; left time: 3664.8268s
	iters: 300, epoch: 16 | loss: 0.3281749
	speed: 0.1159s/iter; left time: 3600.9519s
Epoch: 16 cost time: 42.25805401802063
Epoch: 16, Steps: 369 | Train Loss: 0.360 Vali Loss: 0.814 Vali Acc: 0.655 Test Loss: 0.814 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2625108
	speed: 0.3869s/iter; left time: 11953.9986s
	iters: 200, epoch: 17 | loss: 0.1490480
	speed: 0.1029s/iter; left time: 3168.6745s
	iters: 300, epoch: 17 | loss: 0.3268447
	speed: 0.1017s/iter; left time: 3123.1929s
Epoch: 17 cost time: 38.75915765762329
Epoch: 17, Steps: 369 | Train Loss: 0.356 Vali Loss: 0.804 Vali Acc: 0.642 Test Loss: 0.804 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.2844594
	speed: 0.3919s/iter; left time: 11965.4192s
	iters: 200, epoch: 18 | loss: 0.3034352
	speed: 0.1334s/iter; left time: 4060.4543s
	iters: 300, epoch: 18 | loss: 0.4790397
	speed: 0.1345s/iter; left time: 4080.0792s
Epoch: 18 cost time: 49.11233997344971
Epoch: 18, Steps: 369 | Train Loss: 0.329 Vali Loss: 0.927 Vali Acc: 0.643 Test Loss: 0.927 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.3941538
	speed: 0.3723s/iter; left time: 11226.9636s
	iters: 200, epoch: 19 | loss: 0.4548990
	speed: 0.0994s/iter; left time: 2988.5561s
	iters: 300, epoch: 19 | loss: 0.4068108
	speed: 0.1139s/iter; left time: 3411.1926s
Epoch: 19 cost time: 38.69474220275879
Epoch: 19, Steps: 369 | Train Loss: 0.314 Vali Loss: 0.865 Vali Acc: 0.655 Test Loss: 0.865 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.2332527
	speed: 0.3788s/iter; left time: 11284.7682s
	iters: 200, epoch: 20 | loss: 0.3270177
	speed: 0.1040s/iter; left time: 3088.5664s
	iters: 300, epoch: 20 | loss: 0.4206825
	speed: 0.1072s/iter; left time: 3172.1916s
Epoch: 20 cost time: 39.8168044090271
Epoch: 20, Steps: 369 | Train Loss: 0.290 Vali Loss: 0.896 Vali Acc: 0.656 Test Loss: 0.896 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.1456268
	speed: 0.3715s/iter; left time: 10930.6317s
	iters: 200, epoch: 21 | loss: 0.1501855
	speed: 0.1048s/iter; left time: 3073.2269s
	iters: 300, epoch: 21 | loss: 0.0957223
	speed: 0.1017s/iter; left time: 2971.5890s
Epoch: 21 cost time: 40.514137268066406
Epoch: 21, Steps: 369 | Train Loss: 0.287 Vali Loss: 0.847 Vali Acc: 0.657 Test Loss: 0.847 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6818955732122588
model parameter : 795742
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6828316
	speed: 0.1301s/iter; left time: 4786.1831s
	iters: 200, epoch: 1 | loss: 0.5373042
	speed: 0.1006s/iter; left time: 3691.0405s
	iters: 300, epoch: 1 | loss: 0.9590760
	speed: 0.0958s/iter; left time: 3507.5177s
Epoch: 1 cost time: 39.349916219711304
Epoch: 1, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.833 Vali Acc: 0.582 Test Loss: 0.833 Test Acc: 0.582
Validation loss decreased (inf --> -0.582285).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8324140
	speed: 0.3560s/iter; left time: 12969.9246s
	iters: 200, epoch: 2 | loss: 0.8358398
	speed: 0.1017s/iter; left time: 3694.6665s
	iters: 300, epoch: 2 | loss: 0.5770061
	speed: 0.1033s/iter; left time: 3741.5965s
Epoch: 2 cost time: 38.213993549346924
Epoch: 2, Steps: 369 | Train Loss: 0.632 Vali Loss: 0.694 Vali Acc: 0.626 Test Loss: 0.694 Test Acc: 0.626
Validation loss decreased (-0.582285 --> -0.626270).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6569578
	speed: 0.3339s/iter; left time: 12042.9461s
	iters: 200, epoch: 3 | loss: 0.5850110
	speed: 0.1125s/iter; left time: 4045.0246s
	iters: 300, epoch: 3 | loss: 0.5928075
	speed: 0.1058s/iter; left time: 3796.0225s
Epoch: 3 cost time: 40.89386248588562
Epoch: 3, Steps: 369 | Train Loss: 0.609 Vali Loss: 0.732 Vali Acc: 0.618 Test Loss: 0.732 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4572733
	speed: 0.3461s/iter; left time: 12355.0563s
	iters: 200, epoch: 4 | loss: 0.4728691
	speed: 0.1001s/iter; left time: 3563.6132s
	iters: 300, epoch: 4 | loss: 0.5342945
	speed: 0.1031s/iter; left time: 3660.2191s
Epoch: 4 cost time: 37.77166509628296
Epoch: 4, Steps: 369 | Train Loss: 0.616 Vali Loss: 0.888 Vali Acc: 0.598 Test Loss: 0.888 Test Acc: 0.598
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4378146
	speed: 0.3482s/iter; left time: 12299.4750s
	iters: 200, epoch: 5 | loss: 0.4297361
	speed: 0.1063s/iter; left time: 3745.3183s
	iters: 300, epoch: 5 | loss: 0.5478692
	speed: 0.1080s/iter; left time: 3794.9327s
Epoch: 5 cost time: 40.79236340522766
Epoch: 5, Steps: 369 | Train Loss: 0.578 Vali Loss: 0.915 Vali Acc: 0.587 Test Loss: 0.915 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5494120
	speed: 0.3728s/iter; left time: 13031.2231s
	iters: 200, epoch: 6 | loss: 0.5108081
	speed: 0.1045s/iter; left time: 3641.4270s
	iters: 300, epoch: 6 | loss: 0.6182655
	speed: 0.1161s/iter; left time: 4035.0880s
Epoch: 6 cost time: 40.855268478393555
Epoch: 6, Steps: 369 | Train Loss: 0.551 Vali Loss: 0.691 Vali Acc: 0.631 Test Loss: 0.691 Test Acc: 0.631
Validation loss decreased (-0.626270 --> -0.630527).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6289338
	speed: 0.3704s/iter; left time: 12809.8620s
	iters: 200, epoch: 7 | loss: 0.4284989
	speed: 0.0943s/iter; left time: 3252.9077s
	iters: 300, epoch: 7 | loss: 0.5327183
	speed: 0.1008s/iter; left time: 3466.0773s
Epoch: 7 cost time: 36.82952284812927
Epoch: 7, Steps: 369 | Train Loss: 0.527 Vali Loss: 0.681 Vali Acc: 0.647 Test Loss: 0.681 Test Acc: 0.647
Validation loss decreased (-0.630527 --> -0.646985).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5776361
	speed: 0.3584s/iter; left time: 12263.0624s
	iters: 200, epoch: 8 | loss: 0.4856196
	speed: 0.1058s/iter; left time: 3609.2786s
	iters: 300, epoch: 8 | loss: 0.5014284
	speed: 0.0992s/iter; left time: 3373.6894s
Epoch: 8 cost time: 38.98620271682739
Epoch: 8, Steps: 369 | Train Loss: 0.502 Vali Loss: 0.702 Vali Acc: 0.642 Test Loss: 0.702 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.4561534
	speed: 0.3499s/iter; left time: 11845.0467s
	iters: 200, epoch: 9 | loss: 0.2710152
	speed: 0.0982s/iter; left time: 3313.2591s
	iters: 300, epoch: 9 | loss: 0.5180766
	speed: 0.1096s/iter; left time: 3689.5987s
Epoch: 9 cost time: 39.22856378555298
Epoch: 9, Steps: 369 | Train Loss: 0.484 Vali Loss: 0.650 Vali Acc: 0.653 Test Loss: 0.650 Test Acc: 0.653
Validation loss decreased (-0.646985 --> -0.653228).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4218810
	speed: 0.3454s/iter; left time: 11565.1619s
	iters: 200, epoch: 10 | loss: 0.3382622
	speed: 0.0982s/iter; left time: 3277.0139s
	iters: 300, epoch: 10 | loss: 0.5196958
	speed: 0.0936s/iter; left time: 3115.2615s
Epoch: 10 cost time: 36.521647930145264
Epoch: 10, Steps: 369 | Train Loss: 0.462 Vali Loss: 0.663 Vali Acc: 0.655 Test Loss: 0.663 Test Acc: 0.655
Validation loss decreased (-0.653228 --> -0.654931).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2997614
	speed: 0.3730s/iter; left time: 12350.0171s
	iters: 200, epoch: 11 | loss: 0.4291750
	speed: 0.1066s/iter; left time: 3517.4012s
	iters: 300, epoch: 11 | loss: 0.3683219
	speed: 0.1116s/iter; left time: 3672.2649s
Epoch: 11 cost time: 39.8882782459259
Epoch: 11, Steps: 369 | Train Loss: 0.443 Vali Loss: 0.679 Vali Acc: 0.655 Test Loss: 0.679 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.2162890
	speed: 0.3670s/iter; left time: 12017.9056s
	iters: 200, epoch: 12 | loss: 0.5062643
	speed: 0.0912s/iter; left time: 2977.7836s
	iters: 300, epoch: 12 | loss: 0.5683581
	speed: 0.0974s/iter; left time: 3170.9853s
Epoch: 12 cost time: 36.54414248466492
Epoch: 12, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.731 Vali Acc: 0.657 Test Loss: 0.731 Test Acc: 0.657
Validation loss decreased (-0.654931 --> -0.657484).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4127104
	speed: 0.3691s/iter; left time: 11947.4886s
	iters: 200, epoch: 13 | loss: 0.6866677
	speed: 0.1014s/iter; left time: 3271.7714s
	iters: 300, epoch: 13 | loss: 0.3215401
	speed: 0.1013s/iter; left time: 3259.4829s
Epoch: 13 cost time: 39.624920129776
Epoch: 13, Steps: 369 | Train Loss: 0.412 Vali Loss: 0.718 Vali Acc: 0.655 Test Loss: 0.718 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2496432
	speed: 0.3661s/iter; left time: 11716.0192s
	iters: 200, epoch: 14 | loss: 0.5824718
	speed: 0.1024s/iter; left time: 3266.4159s
	iters: 300, epoch: 14 | loss: 0.3476076
	speed: 0.1086s/iter; left time: 3454.6598s
Epoch: 14 cost time: 40.33382558822632
Epoch: 14, Steps: 369 | Train Loss: 0.395 Vali Loss: 0.732 Vali Acc: 0.647 Test Loss: 0.732 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.3778517
	speed: 0.3665s/iter; left time: 11592.7010s
	iters: 200, epoch: 15 | loss: 0.3120776
	speed: 0.0997s/iter; left time: 3143.4277s
	iters: 300, epoch: 15 | loss: 0.2528804
	speed: 0.0977s/iter; left time: 3070.2058s
Epoch: 15 cost time: 37.5170373916626
Epoch: 15, Steps: 369 | Train Loss: 0.382 Vali Loss: 0.805 Vali Acc: 0.668 Test Loss: 0.805 Test Acc: 0.668
Validation loss decreased (-0.657484 --> -0.668267).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2864857
	speed: 0.3817s/iter; left time: 11935.6647s
	iters: 200, epoch: 16 | loss: 0.4233947
	speed: 0.1110s/iter; left time: 3458.1799s
	iters: 300, epoch: 16 | loss: 0.0880156
	speed: 0.1088s/iter; left time: 3380.6171s
Epoch: 16 cost time: 41.417359352111816
Epoch: 16, Steps: 369 | Train Loss: 0.363 Vali Loss: 0.835 Vali Acc: 0.648 Test Loss: 0.835 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.2357825
	speed: 0.3694s/iter; left time: 11414.6146s
	iters: 200, epoch: 17 | loss: 0.1738069
	speed: 0.0994s/iter; left time: 3060.8427s
	iters: 300, epoch: 17 | loss: 0.3403325
	speed: 0.1011s/iter; left time: 3102.0637s
Epoch: 17 cost time: 38.375685930252075
Epoch: 17, Steps: 369 | Train Loss: 0.349 Vali Loss: 0.826 Vali Acc: 0.662 Test Loss: 0.826 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.3096327
	speed: 0.3480s/iter; left time: 10622.4952s
	iters: 200, epoch: 18 | loss: 0.3113490
	speed: 0.1019s/iter; left time: 3100.0709s
	iters: 300, epoch: 18 | loss: 0.6147250
	speed: 0.0997s/iter; left time: 3023.3931s
Epoch: 18 cost time: 37.80017137527466
Epoch: 18, Steps: 369 | Train Loss: 0.341 Vali Loss: 0.830 Vali Acc: 0.650 Test Loss: 0.830 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.4460791
	speed: 0.3539s/iter; left time: 10672.9000s
	iters: 200, epoch: 19 | loss: 0.4394352
	speed: 0.1120s/iter; left time: 3367.0741s
	iters: 300, epoch: 19 | loss: 0.4819022
	speed: 0.1083s/iter; left time: 3244.9649s
Epoch: 19 cost time: 40.01428413391113
Epoch: 19, Steps: 369 | Train Loss: 0.317 Vali Loss: 0.745 Vali Acc: 0.661 Test Loss: 0.745 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.2848105
	speed: 0.3552s/iter; left time: 10580.8453s
	iters: 200, epoch: 20 | loss: 0.2832302
	speed: 0.0970s/iter; left time: 2879.7269s
	iters: 300, epoch: 20 | loss: 0.5794214
	speed: 0.0989s/iter; left time: 2925.2242s
Epoch: 20 cost time: 37.44090819358826
Epoch: 20, Steps: 369 | Train Loss: 0.301 Vali Loss: 0.835 Vali Acc: 0.651 Test Loss: 0.835 Test Acc: 0.651
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.4229867
	speed: 0.3626s/iter; left time: 10668.7867s
	iters: 200, epoch: 21 | loss: 0.4325465
	speed: 0.1049s/iter; left time: 3076.7668s
	iters: 300, epoch: 21 | loss: 0.2045538
	speed: 0.1021s/iter; left time: 2982.1905s
Epoch: 21 cost time: 38.842414140701294
Epoch: 21, Steps: 369 | Train Loss: 0.281 Vali Loss: 0.881 Vali Acc: 0.649 Test Loss: 0.881 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.4742559
	speed: 0.3809s/iter; left time: 11066.0919s
	iters: 200, epoch: 22 | loss: 0.3137447
	speed: 0.1033s/iter; left time: 2991.6566s
	iters: 300, epoch: 22 | loss: 0.1191016
	speed: 0.1115s/iter; left time: 3217.0828s
Epoch: 22 cost time: 40.90303087234497
Epoch: 22, Steps: 369 | Train Loss: 0.271 Vali Loss: 1.107 Vali Acc: 0.646 Test Loss: 1.107 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3815367
	speed: 0.3550s/iter; left time: 10182.9631s
	iters: 200, epoch: 23 | loss: 0.3459821
	speed: 0.1010s/iter; left time: 2887.9688s
	iters: 300, epoch: 23 | loss: 0.3286867
	speed: 0.0971s/iter; left time: 2764.5686s
Epoch: 23 cost time: 37.769566774368286
Epoch: 23, Steps: 369 | Train Loss: 0.261 Vali Loss: 0.968 Vali Acc: 0.645 Test Loss: 0.968 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0373265
	speed: 0.3540s/iter; left time: 10023.5726s
	iters: 200, epoch: 24 | loss: 0.1785260
	speed: 0.1040s/iter; left time: 2935.5956s
	iters: 300, epoch: 24 | loss: 0.3967724
	speed: 0.0978s/iter; left time: 2748.9847s
Epoch: 24 cost time: 39.63747572898865
Epoch: 24, Steps: 369 | Train Loss: 0.245 Vali Loss: 1.118 Vali Acc: 0.636 Test Loss: 1.118 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0579553
	speed: 0.3587s/iter; left time: 10023.8145s
	iters: 200, epoch: 25 | loss: 0.6166669
	speed: 0.1012s/iter; left time: 2816.6818s
	iters: 300, epoch: 25 | loss: 0.1205228
	speed: 0.1132s/iter; left time: 3141.8549s
Epoch: 25 cost time: 40.05946660041809
Epoch: 25, Steps: 369 | Train Loss: 0.215 Vali Loss: 1.233 Vali Acc: 0.647 Test Loss: 1.233 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6682746878547106
model parameter : 795358
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7381774
	speed: 0.1229s/iter; left time: 4522.8010s
	iters: 200, epoch: 1 | loss: 0.6736940
	speed: 0.0939s/iter; left time: 3445.0035s
	iters: 300, epoch: 1 | loss: 0.6401749
	speed: 0.1091s/iter; left time: 3991.3653s
Epoch: 1 cost time: 40.53367519378662
Epoch: 1, Steps: 369 | Train Loss: 0.695 Vali Loss: 0.675 Vali Acc: 0.640 Test Loss: 0.675 Test Acc: 0.640
Validation loss decreased (inf --> -0.639891).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6242424
	speed: 0.3357s/iter; left time: 12231.8190s
	iters: 200, epoch: 2 | loss: 0.6003508
	speed: 0.1011s/iter; left time: 3671.8213s
	iters: 300, epoch: 2 | loss: 0.4206662
	speed: 0.0953s/iter; left time: 3452.1536s
Epoch: 2 cost time: 36.3227059841156
Epoch: 2, Steps: 369 | Train Loss: 0.653 Vali Loss: 0.849 Vali Acc: 0.583 Test Loss: 0.849 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4667856
	speed: 0.3522s/iter; left time: 12700.1115s
	iters: 200, epoch: 3 | loss: 0.6428141
	speed: 0.1013s/iter; left time: 3643.8422s
	iters: 300, epoch: 3 | loss: 0.7730403
	speed: 0.0990s/iter; left time: 3551.2943s
Epoch: 3 cost time: 37.93159341812134
Epoch: 3, Steps: 369 | Train Loss: 0.606 Vali Loss: 0.829 Vali Acc: 0.602 Test Loss: 0.829 Test Acc: 0.602
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5770258
	speed: 0.3408s/iter; left time: 12166.1530s
	iters: 200, epoch: 4 | loss: 0.5732886
	speed: 0.0993s/iter; left time: 3534.4843s
	iters: 300, epoch: 4 | loss: 0.4969932
	speed: 0.1092s/iter; left time: 3875.0982s
Epoch: 4 cost time: 39.925671100616455
Epoch: 4, Steps: 369 | Train Loss: 0.627 Vali Loss: 0.675 Vali Acc: 0.612 Test Loss: 0.675 Test Acc: 0.612
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.4433742
	speed: 0.3861s/iter; left time: 13638.2629s
	iters: 200, epoch: 5 | loss: 0.5574070
	speed: 0.0942s/iter; left time: 3319.6097s
	iters: 300, epoch: 5 | loss: 0.6850883
	speed: 0.0976s/iter; left time: 3429.1476s
Epoch: 5 cost time: 37.79023504257202
Epoch: 5, Steps: 369 | Train Loss: 0.577 Vali Loss: 0.624 Vali Acc: 0.661 Test Loss: 0.624 Test Acc: 0.661
Validation loss decreased (-0.639891 --> -0.660607).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5087801
	speed: 0.3621s/iter; left time: 12658.8077s
	iters: 200, epoch: 6 | loss: 0.6992590
	speed: 0.1003s/iter; left time: 3497.6446s
	iters: 300, epoch: 6 | loss: 0.4469922
	speed: 0.1070s/iter; left time: 3717.3949s
Epoch: 6 cost time: 38.06678652763367
Epoch: 6, Steps: 369 | Train Loss: 0.557 Vali Loss: 0.615 Vali Acc: 0.678 Test Loss: 0.615 Test Acc: 0.678
Validation loss decreased (-0.660607 --> -0.678484).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8377372
	speed: 0.3389s/iter; left time: 11720.4768s
	iters: 200, epoch: 7 | loss: 0.5805071
	speed: 0.0945s/iter; left time: 3260.1594s
	iters: 300, epoch: 7 | loss: 0.5118749
	speed: 0.0978s/iter; left time: 3362.7750s
Epoch: 7 cost time: 36.33983778953552
Epoch: 7, Steps: 369 | Train Loss: 0.521 Vali Loss: 0.647 Vali Acc: 0.661 Test Loss: 0.647 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6191854
	speed: 0.3449s/iter; left time: 11801.4588s
	iters: 200, epoch: 8 | loss: 0.4519384
	speed: 0.0974s/iter; left time: 3321.4867s
	iters: 300, epoch: 8 | loss: 0.2344784
	speed: 0.0952s/iter; left time: 3237.4195s
Epoch: 8 cost time: 37.362011671066284
Epoch: 8, Steps: 369 | Train Loss: 0.503 Vali Loss: 0.710 Vali Acc: 0.660 Test Loss: 0.710 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2619723
	speed: 0.3435s/iter; left time: 11628.5315s
	iters: 200, epoch: 9 | loss: 0.5242603
	speed: 0.0892s/iter; left time: 3010.1467s
	iters: 300, epoch: 9 | loss: 0.4018893
	speed: 0.1080s/iter; left time: 3634.6081s
Epoch: 9 cost time: 37.697617530822754
Epoch: 9, Steps: 369 | Train Loss: 0.486 Vali Loss: 0.725 Vali Acc: 0.649 Test Loss: 0.725 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.7961487
	speed: 0.3425s/iter; left time: 11468.1161s
	iters: 200, epoch: 10 | loss: 0.3233667
	speed: 0.0939s/iter; left time: 3133.2339s
	iters: 300, epoch: 10 | loss: 0.3535792
	speed: 0.0973s/iter; left time: 3238.5751s
Epoch: 10 cost time: 35.712836265563965
Epoch: 10, Steps: 369 | Train Loss: 0.464 Vali Loss: 0.747 Vali Acc: 0.653 Test Loss: 0.747 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4006585
	speed: 0.3570s/iter; left time: 11819.1472s
	iters: 200, epoch: 11 | loss: 0.5539606
	speed: 0.1083s/iter; left time: 3575.8312s
	iters: 300, epoch: 11 | loss: 0.3918634
	speed: 0.1075s/iter; left time: 3536.7164s
Epoch: 11 cost time: 40.12601089477539
Epoch: 11, Steps: 369 | Train Loss: 0.451 Vali Loss: 0.680 Vali Acc: 0.664 Test Loss: 0.680 Test Acc: 0.664
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.4264355
	speed: 0.3523s/iter; left time: 11534.0181s
	iters: 200, epoch: 12 | loss: 0.3785044
	speed: 0.0975s/iter; left time: 3184.0667s
	iters: 300, epoch: 12 | loss: 0.5970157
	speed: 0.1015s/iter; left time: 3304.3941s
Epoch: 12 cost time: 38.87159490585327
Epoch: 12, Steps: 369 | Train Loss: 0.430 Vali Loss: 0.713 Vali Acc: 0.636 Test Loss: 0.713 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.5989307
	speed: 0.3567s/iter; left time: 11547.3912s
	iters: 200, epoch: 13 | loss: 0.2244954
	speed: 0.0993s/iter; left time: 3204.1091s
	iters: 300, epoch: 13 | loss: 0.3156429
	speed: 0.1001s/iter; left time: 3221.5886s
Epoch: 13 cost time: 38.18393540382385
Epoch: 13, Steps: 369 | Train Loss: 0.411 Vali Loss: 0.748 Vali Acc: 0.641 Test Loss: 0.748 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.3137998
	speed: 0.3680s/iter; left time: 11776.4804s
	iters: 200, epoch: 14 | loss: 0.2411451
	speed: 0.1171s/iter; left time: 3735.3430s
	iters: 300, epoch: 14 | loss: 0.2998640
	speed: 0.1070s/iter; left time: 3402.8110s
Epoch: 14 cost time: 40.92868995666504
Epoch: 14, Steps: 369 | Train Loss: 0.402 Vali Loss: 0.707 Vali Acc: 0.664 Test Loss: 0.707 Test Acc: 0.664
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2568098
	speed: 0.3591s/iter; left time: 11361.6200s
	iters: 200, epoch: 15 | loss: 0.3700907
	speed: 0.1016s/iter; left time: 3203.1992s
	iters: 300, epoch: 15 | loss: 0.2111962
	speed: 0.0980s/iter; left time: 3079.0751s
Epoch: 15 cost time: 37.01546597480774
Epoch: 15, Steps: 369 | Train Loss: 0.378 Vali Loss: 0.773 Vali Acc: 0.659 Test Loss: 0.773 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.6606683
	speed: 0.3531s/iter; left time: 11038.5073s
	iters: 200, epoch: 16 | loss: 0.8103315
	speed: 0.0903s/iter; left time: 2815.8073s
	iters: 300, epoch: 16 | loss: 0.2911124
	speed: 0.0931s/iter; left time: 2891.3201s
Epoch: 16 cost time: 36.3249876499176
Epoch: 16, Steps: 369 | Train Loss: 0.364 Vali Loss: 0.777 Vali Acc: 0.646 Test Loss: 0.777 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6784903518728718
model parameter : 794974
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7013881
	speed: 0.1096s/iter; left time: 4032.3628s
	iters: 200, epoch: 1 | loss: 0.6374915
	speed: 0.0921s/iter; left time: 3379.5055s
	iters: 300, epoch: 1 | loss: 0.5911016
	speed: 0.1072s/iter; left time: 3924.7507s
Epoch: 1 cost time: 38.307331562042236
Epoch: 1, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.636 Vali Acc: 0.652 Test Loss: 0.636 Test Acc: 0.652
Validation loss decreased (inf --> -0.652377).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1517674
	speed: 0.3325s/iter; left time: 12112.2209s
	iters: 200, epoch: 2 | loss: 0.6527535
	speed: 0.0977s/iter; left time: 3550.4894s
	iters: 300, epoch: 2 | loss: 0.5034961
	speed: 0.0936s/iter; left time: 3391.7301s
Epoch: 2 cost time: 35.70073318481445
Epoch: 2, Steps: 369 | Train Loss: 0.652 Vali Loss: 0.629 Vali Acc: 0.653 Test Loss: 0.629 Test Acc: 0.653
Validation loss decreased (-0.652377 --> -0.652945).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5607125
	speed: 0.3597s/iter; left time: 12971.2493s
	iters: 200, epoch: 3 | loss: 0.9845628
	speed: 0.1016s/iter; left time: 3652.6788s
	iters: 300, epoch: 3 | loss: 0.4149084
	speed: 0.1033s/iter; left time: 3706.0430s
Epoch: 3 cost time: 38.34051823616028
Epoch: 3, Steps: 369 | Train Loss: 0.631 Vali Loss: 0.783 Vali Acc: 0.619 Test Loss: 0.783 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2893482
	speed: 0.3376s/iter; left time: 12049.7543s
	iters: 200, epoch: 4 | loss: 0.5543718
	speed: 0.0912s/iter; left time: 3246.8181s
	iters: 300, epoch: 4 | loss: 0.4786506
	speed: 0.0948s/iter; left time: 3363.7822s
Epoch: 4 cost time: 35.16811275482178
Epoch: 4, Steps: 369 | Train Loss: 0.600 Vali Loss: 0.718 Vali Acc: 0.618 Test Loss: 0.718 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4353784
	speed: 0.3436s/iter; left time: 12136.6295s
	iters: 200, epoch: 5 | loss: 0.6922281
	speed: 0.0942s/iter; left time: 3316.7040s
	iters: 300, epoch: 5 | loss: 0.4192473
	speed: 0.0933s/iter; left time: 3276.5253s
Epoch: 5 cost time: 36.48248028755188
Epoch: 5, Steps: 369 | Train Loss: 0.578 Vali Loss: 0.638 Vali Acc: 0.661 Test Loss: 0.638 Test Acc: 0.661
Validation loss decreased (-0.652945 --> -0.660607).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3825547
	speed: 0.3275s/iter; left time: 11447.1149s
	iters: 200, epoch: 6 | loss: 0.2959977
	speed: 0.0967s/iter; left time: 3372.0893s
	iters: 300, epoch: 6 | loss: 0.5318091
	speed: 0.0962s/iter; left time: 3343.5291s
Epoch: 6 cost time: 36.9068706035614
Epoch: 6, Steps: 369 | Train Loss: 0.559 Vali Loss: 0.653 Vali Acc: 0.618 Test Loss: 0.653 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6271077
	speed: 0.3206s/iter; left time: 11089.7888s
	iters: 200, epoch: 7 | loss: 0.5286806
	speed: 0.0930s/iter; left time: 3208.2921s
	iters: 300, epoch: 7 | loss: 0.5079517
	speed: 0.0974s/iter; left time: 3349.9053s
Epoch: 7 cost time: 34.744505882263184
Epoch: 7, Steps: 369 | Train Loss: 0.523 Vali Loss: 0.647 Vali Acc: 0.644 Test Loss: 0.647 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3017161
	speed: 0.3346s/iter; left time: 11449.7612s
	iters: 200, epoch: 8 | loss: 0.6649103
	speed: 0.1001s/iter; left time: 3415.3132s
	iters: 300, epoch: 8 | loss: 0.3788611
	speed: 0.1113s/iter; left time: 3786.0484s
Epoch: 8 cost time: 37.97233247756958
Epoch: 8, Steps: 369 | Train Loss: 0.499 Vali Loss: 0.644 Vali Acc: 0.657 Test Loss: 0.644 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3365577
	speed: 0.3466s/iter; left time: 11730.9497s
	iters: 200, epoch: 9 | loss: 0.5799642
	speed: 0.0986s/iter; left time: 3327.9291s
	iters: 300, epoch: 9 | loss: 0.4202683
	speed: 0.0919s/iter; left time: 3091.2993s
Epoch: 9 cost time: 36.35549306869507
Epoch: 9, Steps: 369 | Train Loss: 0.492 Vali Loss: 0.639 Vali Acc: 0.675 Test Loss: 0.639 Test Acc: 0.675
Validation loss decreased (-0.660607 --> -0.675363).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5870235
	speed: 0.3390s/iter; left time: 11350.6032s
	iters: 200, epoch: 10 | loss: 0.3821429
	speed: 0.1052s/iter; left time: 3510.3052s
	iters: 300, epoch: 10 | loss: 0.4871379
	speed: 0.0977s/iter; left time: 3250.1969s
Epoch: 10 cost time: 38.23140549659729
Epoch: 10, Steps: 369 | Train Loss: 0.462 Vali Loss: 0.670 Vali Acc: 0.661 Test Loss: 0.670 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.4010786
	speed: 0.3345s/iter; left time: 11075.4417s
	iters: 200, epoch: 11 | loss: 0.6261479
	speed: 0.0966s/iter; left time: 3187.6727s
	iters: 300, epoch: 11 | loss: 0.3591075
	speed: 0.0927s/iter; left time: 3050.8525s
Epoch: 11 cost time: 36.22858691215515
Epoch: 11, Steps: 369 | Train Loss: 0.451 Vali Loss: 0.684 Vali Acc: 0.666 Test Loss: 0.684 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.3563963
	speed: 0.3197s/iter; left time: 10466.4195s
	iters: 200, epoch: 12 | loss: 0.5344666
	speed: 0.0980s/iter; left time: 3198.7841s
	iters: 300, epoch: 12 | loss: 0.6418052
	speed: 0.0973s/iter; left time: 3167.9395s
Epoch: 12 cost time: 36.93707585334778
Epoch: 12, Steps: 369 | Train Loss: 0.431 Vali Loss: 0.648 Vali Acc: 0.670 Test Loss: 0.648 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2920602
	speed: 0.3552s/iter; left time: 11500.4370s
	iters: 200, epoch: 13 | loss: 0.4013925
	speed: 0.1079s/iter; left time: 3482.7879s
	iters: 300, epoch: 13 | loss: 0.3048694
	speed: 0.1042s/iter; left time: 3353.5534s
Epoch: 13 cost time: 38.52406454086304
Epoch: 13, Steps: 369 | Train Loss: 0.419 Vali Loss: 0.686 Vali Acc: 0.656 Test Loss: 0.686 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.2042724
	speed: 0.3561s/iter; left time: 11395.1306s
	iters: 200, epoch: 14 | loss: 0.3622743
	speed: 0.1020s/iter; left time: 3255.0609s
	iters: 300, epoch: 14 | loss: 0.2570013
	speed: 0.0956s/iter; left time: 3040.3624s
Epoch: 14 cost time: 37.083760499954224
Epoch: 14, Steps: 369 | Train Loss: 0.399 Vali Loss: 0.807 Vali Acc: 0.644 Test Loss: 0.807 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.2791656
	speed: 0.3810s/iter; left time: 12052.2767s
	iters: 200, epoch: 15 | loss: 0.4521638
	speed: 0.2096s/iter; left time: 6608.4834s
	iters: 300, epoch: 15 | loss: 0.1555184
	speed: 0.1829s/iter; left time: 5749.3306s
Epoch: 15 cost time: 65.27631139755249
Epoch: 15, Steps: 369 | Train Loss: 0.377 Vali Loss: 0.782 Vali Acc: 0.660 Test Loss: 0.782 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.4052846
	speed: 0.6041s/iter; left time: 18889.1583s
	iters: 200, epoch: 16 | loss: 0.3038888
	speed: 0.1600s/iter; left time: 4985.9901s
	iters: 300, epoch: 16 | loss: 0.3136558
	speed: 0.1466s/iter; left time: 4555.4757s
Epoch: 16 cost time: 62.97737121582031
Epoch: 16, Steps: 369 | Train Loss: 0.362 Vali Loss: 0.839 Vali Acc: 0.638 Test Loss: 0.839 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.3546834
	speed: 0.6008s/iter; left time: 18561.4905s
	iters: 200, epoch: 17 | loss: 0.2696431
	speed: 0.1741s/iter; left time: 5362.8047s
	iters: 300, epoch: 17 | loss: 0.1599846
	speed: 0.1626s/iter; left time: 4990.4154s
Epoch: 17 cost time: 64.48848009109497
Epoch: 17, Steps: 369 | Train Loss: 0.348 Vali Loss: 0.852 Vali Acc: 0.643 Test Loss: 0.852 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.1562455
	speed: 0.6264s/iter; left time: 19122.3294s
	iters: 200, epoch: 18 | loss: 0.2360736
	speed: 0.3355s/iter; left time: 10209.4800s
	iters: 300, epoch: 18 | loss: 0.2120622
	speed: 0.3009s/iter; left time: 9126.0155s
Epoch: 18 cost time: 103.95116353034973
Epoch: 18, Steps: 369 | Train Loss: 0.330 Vali Loss: 0.816 Vali Acc: 0.654 Test Loss: 0.816 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.1372462
	speed: 0.8772s/iter; left time: 26454.6154s
	iters: 200, epoch: 19 | loss: 0.2177512
	speed: 0.2475s/iter; left time: 7438.8191s
	iters: 300, epoch: 19 | loss: 0.1545402
	speed: 0.2544s/iter; left time: 7622.5842s
Epoch: 19 cost time: 96.40400815010071
Epoch: 19, Steps: 369 | Train Loss: 0.315 Vali Loss: 0.889 Vali Acc: 0.641 Test Loss: 0.889 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6753688989784336
model parameter : 794590
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6242956
	speed: 0.2589s/iter; left time: 9529.2473s
	iters: 200, epoch: 1 | loss: 0.6301590
	speed: 0.2357s/iter; left time: 8649.5635s
	iters: 300, epoch: 1 | loss: 0.5496166
	speed: 0.2453s/iter; left time: 8979.7170s
Epoch: 1 cost time: 87.9454836845398
Epoch: 1, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.635 Vali Acc: 0.649 Test Loss: 0.635 Test Acc: 0.649
Validation loss decreased (inf --> -0.648972).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6911553
	speed: 0.8016s/iter; left time: 29203.2733s
	iters: 200, epoch: 2 | loss: 0.4323810
	speed: 0.2634s/iter; left time: 9570.8438s
	iters: 300, epoch: 2 | loss: 0.9523457
	speed: 0.2758s/iter; left time: 9991.1156s
Epoch: 2 cost time: 98.25342917442322
Epoch: 2, Steps: 369 | Train Loss: 0.608 Vali Loss: 0.673 Vali Acc: 0.645 Test Loss: 0.673 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5930865
	speed: 0.7588s/iter; left time: 27365.1785s
	iters: 200, epoch: 3 | loss: 0.6200284
	speed: 0.2709s/iter; left time: 9741.6936s
	iters: 300, epoch: 3 | loss: 0.5173172
	speed: 0.2737s/iter; left time: 9815.8553s
Epoch: 3 cost time: 100.21774172782898
Epoch: 3, Steps: 369 | Train Loss: 0.592 Vali Loss: 0.708 Vali Acc: 0.607 Test Loss: 0.708 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6071762
	speed: 0.8446s/iter; left time: 30146.5679s
	iters: 200, epoch: 4 | loss: 0.6249048
	speed: 0.2346s/iter; left time: 8349.4098s
	iters: 300, epoch: 4 | loss: 0.4373840
	speed: 0.1954s/iter; left time: 6935.7319s
Epoch: 4 cost time: 83.60098528862
Epoch: 4, Steps: 369 | Train Loss: 0.570 Vali Loss: 0.652 Vali Acc: 0.630 Test Loss: 0.652 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3326591
	speed: 0.7192s/iter; left time: 25404.7151s
	iters: 200, epoch: 5 | loss: 0.4553371
	speed: 0.2148s/iter; left time: 7567.9999s
	iters: 300, epoch: 5 | loss: 0.5511641
	speed: 0.2331s/iter; left time: 8187.5677s
Epoch: 5 cost time: 83.50547456741333
Epoch: 5, Steps: 369 | Train Loss: 0.533 Vali Loss: 0.706 Vali Acc: 0.635 Test Loss: 0.706 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6158912
	speed: 0.8037s/iter; left time: 28094.9547s
	iters: 200, epoch: 6 | loss: 0.5571198
	speed: 0.2470s/iter; left time: 8609.2933s
	iters: 300, epoch: 6 | loss: 0.6843814
	speed: 0.2141s/iter; left time: 7441.5560s
Epoch: 6 cost time: 90.81119728088379
Epoch: 6, Steps: 369 | Train Loss: 0.506 Vali Loss: 0.665 Vali Acc: 0.647 Test Loss: 0.665 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.3453867
	speed: 0.7801s/iter; left time: 26981.6021s
	iters: 200, epoch: 7 | loss: 0.6596271
	speed: 0.2638s/iter; left time: 9097.2502s
	iters: 300, epoch: 7 | loss: 0.1989323
	speed: 0.2574s/iter; left time: 8852.6262s
Epoch: 7 cost time: 96.49197387695312
Epoch: 7, Steps: 369 | Train Loss: 0.477 Vali Loss: 0.723 Vali Acc: 0.639 Test Loss: 0.723 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6383098
	speed: 0.7626s/iter; left time: 26093.8315s
	iters: 200, epoch: 8 | loss: 0.5439742
	speed: 0.2870s/iter; left time: 9791.6227s
	iters: 300, epoch: 8 | loss: 0.2708060
	speed: 0.2528s/iter; left time: 8600.9306s
Epoch: 8 cost time: 94.02697014808655
Epoch: 8, Steps: 369 | Train Loss: 0.455 Vali Loss: 0.761 Vali Acc: 0.648 Test Loss: 0.761 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.3794823
	speed: 0.7420s/iter; left time: 25114.5509s
	iters: 200, epoch: 9 | loss: 0.3237161
	speed: 0.2551s/iter; left time: 8608.2696s
	iters: 300, epoch: 9 | loss: 0.5121483
	speed: 0.2511s/iter; left time: 8449.9833s
Epoch: 9 cost time: 89.47469878196716
Epoch: 9, Steps: 369 | Train Loss: 0.428 Vali Loss: 0.712 Vali Acc: 0.656 Test Loss: 0.712 Test Acc: 0.656
Validation loss decreased (-0.648972 --> -0.655782).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2742300
	speed: 0.7503s/iter; left time: 25120.6285s
	iters: 200, epoch: 10 | loss: 0.2582215
	speed: 0.2528s/iter; left time: 8437.0613s
	iters: 300, epoch: 10 | loss: 0.5207303
	speed: 0.2560s/iter; left time: 8519.1594s
Epoch: 10 cost time: 91.7996416091919
Epoch: 10, Steps: 369 | Train Loss: 0.404 Vali Loss: 0.664 Vali Acc: 0.667 Test Loss: 0.664 Test Acc: 0.667
Validation loss decreased (-0.655782 --> -0.667133).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2471977
	speed: 0.7976s/iter; left time: 26408.1226s
	iters: 200, epoch: 11 | loss: 0.3274739
	speed: 0.2521s/iter; left time: 8320.6845s
	iters: 300, epoch: 11 | loss: 0.2094971
	speed: 0.2727s/iter; left time: 8973.4147s
Epoch: 11 cost time: 94.88975858688354
Epoch: 11, Steps: 369 | Train Loss: 0.374 Vali Loss: 0.763 Vali Acc: 0.657 Test Loss: 0.763 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.2219651
	speed: 0.7368s/iter; left time: 24123.0955s
	iters: 200, epoch: 12 | loss: 0.4935142
	speed: 0.2301s/iter; left time: 7512.2431s
	iters: 300, epoch: 12 | loss: 0.2074488
	speed: 0.2401s/iter; left time: 7812.1245s
Epoch: 12 cost time: 86.77229189872742
Epoch: 12, Steps: 369 | Train Loss: 0.358 Vali Loss: 0.769 Vali Acc: 0.665 Test Loss: 0.769 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.9233594
	speed: 0.7874s/iter; left time: 25490.9320s
	iters: 200, epoch: 13 | loss: 0.4526504
	speed: 0.2551s/iter; left time: 8233.8204s
	iters: 300, epoch: 13 | loss: 0.0832498
	speed: 0.2236s/iter; left time: 7195.0605s
Epoch: 13 cost time: 95.77526545524597
Epoch: 13, Steps: 369 | Train Loss: 0.339 Vali Loss: 0.815 Vali Acc: 0.657 Test Loss: 0.815 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.2430074
	speed: 0.7347s/iter; left time: 23512.0687s
	iters: 200, epoch: 14 | loss: 0.4624991
	speed: 0.2797s/iter; left time: 8922.2004s
	iters: 300, epoch: 14 | loss: 0.1439193
	speed: 0.2421s/iter; left time: 7699.5177s
Epoch: 14 cost time: 94.85160374641418
Epoch: 14, Steps: 369 | Train Loss: 0.320 Vali Loss: 0.870 Vali Acc: 0.675 Test Loss: 0.870 Test Acc: 0.675
Validation loss decreased (-0.667133 --> -0.675076).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5513691
	speed: 0.8197s/iter; left time: 25930.5087s
	iters: 200, epoch: 15 | loss: 0.1824540
	speed: 0.2579s/iter; left time: 8133.1244s
	iters: 300, epoch: 15 | loss: 0.3761750
	speed: 0.2358s/iter; left time: 7413.8859s
Epoch: 15 cost time: 85.12487626075745
Epoch: 15, Steps: 369 | Train Loss: 0.287 Vali Loss: 0.897 Vali Acc: 0.662 Test Loss: 0.897 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.1162416
	speed: 0.7442s/iter; left time: 23268.4711s
	iters: 200, epoch: 16 | loss: 0.6209908
	speed: 0.2671s/iter; left time: 8323.6823s
	iters: 300, epoch: 16 | loss: 0.2197701
	speed: 0.2355s/iter; left time: 7314.8152s
Epoch: 16 cost time: 97.68627309799194
Epoch: 16, Steps: 369 | Train Loss: 0.277 Vali Loss: 0.887 Vali Acc: 0.663 Test Loss: 0.887 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5947928
	speed: 0.7758s/iter; left time: 23970.5606s
	iters: 200, epoch: 17 | loss: 0.1939320
	speed: 0.2278s/iter; left time: 7014.8044s
	iters: 300, epoch: 17 | loss: 0.2783960
	speed: 0.2331s/iter; left time: 7155.1796s
Epoch: 17 cost time: 88.51174402236938
Epoch: 17, Steps: 369 | Train Loss: 0.243 Vali Loss: 0.937 Vali Acc: 0.659 Test Loss: 0.937 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3970603
	speed: 0.8002s/iter; left time: 24428.7218s
	iters: 200, epoch: 18 | loss: 0.2800355
	speed: 0.2675s/iter; left time: 8140.0070s
	iters: 300, epoch: 18 | loss: 0.4842218
	speed: 0.2555s/iter; left time: 7748.3458s
Epoch: 18 cost time: 98.73689389228821
Epoch: 18, Steps: 369 | Train Loss: 0.227 Vali Loss: 1.094 Vali Acc: 0.651 Test Loss: 1.094 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.1111937
	speed: 0.7319s/iter; left time: 22072.6827s
	iters: 200, epoch: 19 | loss: 0.0678091
	speed: 0.2722s/iter; left time: 8180.7473s
	iters: 300, epoch: 19 | loss: 0.2860531
	speed: 0.2477s/iter; left time: 7422.0806s
Epoch: 19 cost time: 93.32387208938599
Epoch: 19, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.078 Vali Acc: 0.662 Test Loss: 1.078 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1108049
	speed: 0.7932s/iter; left time: 23630.4012s
	iters: 200, epoch: 20 | loss: 0.0887118
	speed: 0.2619s/iter; left time: 7776.9018s
	iters: 300, epoch: 20 | loss: 0.1673927
	speed: 0.2350s/iter; left time: 6953.1090s
Epoch: 20 cost time: 88.4910717010498
Epoch: 20, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.066 Vali Acc: 0.671 Test Loss: 1.066 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2221767
	speed: 0.7092s/iter; left time: 20865.6505s
	iters: 200, epoch: 21 | loss: 0.3056801
	speed: 0.2415s/iter; left time: 7080.5824s
	iters: 300, epoch: 21 | loss: 0.1216636
	speed: 0.2496s/iter; left time: 7292.1927s
Epoch: 21 cost time: 92.31117272377014
Epoch: 21, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.141 Vali Acc: 0.648 Test Loss: 1.141 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.1238252
	speed: 0.7367s/iter; left time: 21401.7305s
	iters: 200, epoch: 22 | loss: 0.3287897
	speed: 0.1846s/iter; left time: 5344.3623s
	iters: 300, epoch: 22 | loss: 0.2807197
	speed: 0.2252s/iter; left time: 6497.4101s
Epoch: 22 cost time: 80.0563313961029
Epoch: 22, Steps: 369 | Train Loss: 0.160 Vali Loss: 1.259 Vali Acc: 0.664 Test Loss: 1.259 Test Acc: 0.664
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0327986
	speed: 0.7551s/iter; left time: 21658.4524s
	iters: 200, epoch: 23 | loss: 0.3511531
	speed: 0.1977s/iter; left time: 5650.0048s
	iters: 300, epoch: 23 | loss: 0.3836354
	speed: 0.1874s/iter; left time: 5336.3889s
Epoch: 23 cost time: 78.63016247749329
Epoch: 23, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.160 Vali Acc: 0.661 Test Loss: 1.160 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2067082
	speed: 0.7354s/iter; left time: 20823.1135s
	iters: 200, epoch: 24 | loss: 0.1066129
	speed: 0.1956s/iter; left time: 5517.2623s
	iters: 300, epoch: 24 | loss: 0.0871435
	speed: 0.2225s/iter; left time: 6255.1463s
Epoch: 24 cost time: 80.10552287101746
Epoch: 24, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.274 Vali Acc: 0.659 Test Loss: 1.274 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6750851305334846
model parameter : 496222
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7942263
	speed: 0.2626s/iter; left time: 9663.4829s
	iters: 200, epoch: 1 | loss: 0.5576149
	speed: 0.1944s/iter; left time: 7135.6617s
	iters: 300, epoch: 1 | loss: 0.7226342
	speed: 0.2102s/iter; left time: 7694.5885s
Epoch: 1 cost time: 84.19789409637451
Epoch: 1, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.766 Vali Acc: 0.611 Test Loss: 0.766 Test Acc: 0.611
Validation loss decreased (inf --> -0.611230).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6100477
	speed: 0.6964s/iter; left time: 25370.6985s
	iters: 200, epoch: 2 | loss: 0.3386677
	speed: 0.1857s/iter; left time: 6747.5442s
	iters: 300, epoch: 2 | loss: 0.3848033
	speed: 0.1756s/iter; left time: 6361.0103s
Epoch: 2 cost time: 70.45628142356873
Epoch: 2, Steps: 369 | Train Loss: 0.656 Vali Loss: 0.653 Vali Acc: 0.669 Test Loss: 0.653 Test Acc: 0.669
Validation loss decreased (-0.611230 --> -0.668552).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8040961
	speed: 0.6772s/iter; left time: 24422.8392s
	iters: 200, epoch: 3 | loss: 0.7566956
	speed: 0.2262s/iter; left time: 8134.1010s
	iters: 300, epoch: 3 | loss: 0.4436970
	speed: 0.2097s/iter; left time: 7520.3789s
Epoch: 3 cost time: 78.86037421226501
Epoch: 3, Steps: 369 | Train Loss: 0.614 Vali Loss: 0.691 Vali Acc: 0.649 Test Loss: 0.691 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4502603
	speed: 0.6942s/iter; left time: 24777.0461s
	iters: 200, epoch: 4 | loss: 0.7461749
	speed: 0.1699s/iter; left time: 6048.9029s
	iters: 300, epoch: 4 | loss: 0.7314242
	speed: 0.2092s/iter; left time: 7424.5593s
Epoch: 4 cost time: 72.8493447303772
Epoch: 4, Steps: 369 | Train Loss: 0.573 Vali Loss: 0.704 Vali Acc: 0.636 Test Loss: 0.704 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5448887
	speed: 0.6932s/iter; left time: 24487.9795s
	iters: 200, epoch: 5 | loss: 0.5305060
	speed: 0.2199s/iter; left time: 7747.7080s
	iters: 300, epoch: 5 | loss: 0.5431514
	speed: 0.1837s/iter; left time: 6453.2379s
Epoch: 5 cost time: 74.12073016166687
Epoch: 5, Steps: 369 | Train Loss: 0.554 Vali Loss: 0.695 Vali Acc: 0.630 Test Loss: 0.695 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2220692
	speed: 0.7056s/iter; left time: 24663.7494s
	iters: 200, epoch: 6 | loss: 0.3972329
	speed: 0.2368s/iter; left time: 8252.4306s
	iters: 300, epoch: 6 | loss: 0.5191649
	speed: 0.1926s/iter; left time: 6693.0430s
Epoch: 6 cost time: 76.09738230705261
Epoch: 6, Steps: 369 | Train Loss: 0.519 Vali Loss: 0.638 Vali Acc: 0.671 Test Loss: 0.638 Test Acc: 0.671
Validation loss decreased (-0.668552 --> -0.671390).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4749603
	speed: 0.6582s/iter; left time: 22763.4799s
	iters: 200, epoch: 7 | loss: 0.5891804
	speed: 0.1999s/iter; left time: 6893.7697s
	iters: 300, epoch: 7 | loss: 0.4019245
	speed: 0.2129s/iter; left time: 7322.0979s
Epoch: 7 cost time: 79.28432536125183
Epoch: 7, Steps: 369 | Train Loss: 0.491 Vali Loss: 0.646 Vali Acc: 0.663 Test Loss: 0.646 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2699160
	speed: 0.7166s/iter; left time: 24521.4440s
	iters: 200, epoch: 8 | loss: 0.3190693
	speed: 0.2057s/iter; left time: 7019.3406s
	iters: 300, epoch: 8 | loss: 0.5446284
	speed: 0.2011s/iter; left time: 6839.8351s
Epoch: 8 cost time: 74.98870491981506
Epoch: 8, Steps: 369 | Train Loss: 0.470 Vali Loss: 0.684 Vali Acc: 0.634 Test Loss: 0.684 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4323859
	speed: 0.6679s/iter; left time: 22608.7192s
	iters: 200, epoch: 9 | loss: 0.4965236
	speed: 0.2004s/iter; left time: 6762.7931s
	iters: 300, epoch: 9 | loss: 0.4450051
	speed: 0.2117s/iter; left time: 7122.4100s
Epoch: 9 cost time: 75.35179686546326
Epoch: 9, Steps: 369 | Train Loss: 0.442 Vali Loss: 0.666 Vali Acc: 0.657 Test Loss: 0.666 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4764396
	speed: 0.6395s/iter; left time: 21409.3213s
	iters: 200, epoch: 10 | loss: 0.3835119
	speed: 0.1844s/iter; left time: 6154.7985s
	iters: 300, epoch: 10 | loss: 0.5113090
	speed: 0.2030s/iter; left time: 6755.2715s
Epoch: 10 cost time: 75.31915712356567
Epoch: 10, Steps: 369 | Train Loss: 0.416 Vali Loss: 0.743 Vali Acc: 0.661 Test Loss: 0.743 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4241076
	speed: 0.6753s/iter; left time: 22361.0316s
	iters: 200, epoch: 11 | loss: 0.3273461
	speed: 0.1972s/iter; left time: 6510.7167s
	iters: 300, epoch: 11 | loss: 0.1812094
	speed: 0.2194s/iter; left time: 7221.8750s
Epoch: 11 cost time: 73.90123724937439
Epoch: 11, Steps: 369 | Train Loss: 0.391 Vali Loss: 0.726 Vali Acc: 0.661 Test Loss: 0.726 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.4642894
	speed: 0.6922s/iter; left time: 22663.8642s
	iters: 200, epoch: 12 | loss: 0.3910088
	speed: 0.1989s/iter; left time: 6492.4197s
	iters: 300, epoch: 12 | loss: 0.3859633
	speed: 0.1890s/iter; left time: 6151.6966s
Epoch: 12 cost time: 72.58451652526855
Epoch: 12, Steps: 369 | Train Loss: 0.367 Vali Loss: 0.775 Vali Acc: 0.648 Test Loss: 0.775 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1337774
	speed: 0.6689s/iter; left time: 21654.3978s
	iters: 200, epoch: 13 | loss: 0.2304178
	speed: 0.1750s/iter; left time: 5647.5663s
	iters: 300, epoch: 13 | loss: 0.3856961
	speed: 0.1888s/iter; left time: 6073.9349s
Epoch: 13 cost time: 71.31504487991333
Epoch: 13, Steps: 369 | Train Loss: 0.344 Vali Loss: 0.775 Vali Acc: 0.668 Test Loss: 0.775 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1805850
	speed: 0.7057s/iter; left time: 22585.9948s
	iters: 200, epoch: 14 | loss: 0.6521761
	speed: 0.1859s/iter; left time: 5932.2328s
	iters: 300, epoch: 14 | loss: 0.1614734
	speed: 0.1769s/iter; left time: 5626.6764s
Epoch: 14 cost time: 72.03131365776062
Epoch: 14, Steps: 369 | Train Loss: 0.321 Vali Loss: 0.838 Vali Acc: 0.659 Test Loss: 0.838 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.3197430
	speed: 0.6509s/iter; left time: 20591.1561s
	iters: 200, epoch: 15 | loss: 0.4580616
	speed: 0.2165s/iter; left time: 6828.7912s
	iters: 300, epoch: 15 | loss: 0.3990462
	speed: 0.2059s/iter; left time: 6472.7720s
Epoch: 15 cost time: 74.53923392295837
Epoch: 15, Steps: 369 | Train Loss: 0.295 Vali Loss: 0.900 Vali Acc: 0.656 Test Loss: 0.900 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.1803307
	speed: 0.6595s/iter; left time: 20620.8362s
	iters: 200, epoch: 16 | loss: 0.1284662
	speed: 0.1934s/iter; left time: 6026.6720s
	iters: 300, epoch: 16 | loss: 0.3716368
	speed: 0.2057s/iter; left time: 6390.2797s
Epoch: 16 cost time: 72.00400519371033
Epoch: 16, Steps: 369 | Train Loss: 0.260 Vali Loss: 1.007 Vali Acc: 0.658 Test Loss: 1.007 Test Acc: 0.658
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6713961407491487
model parameter : 495838
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7690138
	speed: 0.2148s/iter; left time: 7904.1662s
	iters: 200, epoch: 1 | loss: 0.6113097
	speed: 0.1785s/iter; left time: 6549.6154s
	iters: 300, epoch: 1 | loss: 0.8410977
	speed: 0.2271s/iter; left time: 8313.6330s
Epoch: 1 cost time: 77.09068775177002
Epoch: 1, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.623 Vali Acc: 0.662 Test Loss: 0.623 Test Acc: 0.662
Validation loss decreased (inf --> -0.662309).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7893567
	speed: 0.6724s/iter; left time: 24495.2906s
	iters: 200, epoch: 2 | loss: 0.7435856
	speed: 0.1777s/iter; left time: 6456.5777s
	iters: 300, epoch: 2 | loss: 0.3529290
	speed: 0.1899s/iter; left time: 6878.9445s
Epoch: 2 cost time: 70.3742446899414
Epoch: 2, Steps: 369 | Train Loss: 0.631 Vali Loss: 0.659 Vali Acc: 0.667 Test Loss: 0.659 Test Acc: 0.667
Validation loss decreased (-0.662309 --> -0.667133).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6779374
	speed: 0.6664s/iter; left time: 24031.1354s
	iters: 200, epoch: 3 | loss: 0.6954561
	speed: 0.2285s/iter; left time: 8218.1117s
	iters: 300, epoch: 3 | loss: 0.6211003
	speed: 0.1701s/iter; left time: 6100.0219s
Epoch: 3 cost time: 71.74762320518494
Epoch: 3, Steps: 369 | Train Loss: 0.600 Vali Loss: 0.693 Vali Acc: 0.664 Test Loss: 0.693 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7704902
	speed: 0.6507s/iter; left time: 23226.1572s
	iters: 200, epoch: 4 | loss: 0.5793606
	speed: 0.1788s/iter; left time: 6363.0386s
	iters: 300, epoch: 4 | loss: 0.4866850
	speed: 0.1882s/iter; left time: 6681.2789s
Epoch: 4 cost time: 67.36718821525574
Epoch: 4, Steps: 369 | Train Loss: 0.561 Vali Loss: 0.615 Vali Acc: 0.682 Test Loss: 0.615 Test Acc: 0.682
Validation loss decreased (-0.667133 --> -0.681889).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4933055
	speed: 0.6372s/iter; left time: 22508.2369s
	iters: 200, epoch: 5 | loss: 0.2474674
	speed: 0.2091s/iter; left time: 7365.0079s
	iters: 300, epoch: 5 | loss: 0.4446706
	speed: 0.2085s/iter; left time: 7322.5572s
Epoch: 5 cost time: 76.63734245300293
Epoch: 5, Steps: 369 | Train Loss: 0.543 Vali Loss: 0.636 Vali Acc: 0.668 Test Loss: 0.636 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5109605
	speed: 0.6645s/iter; left time: 23229.8135s
	iters: 200, epoch: 6 | loss: 0.3408652
	speed: 0.1906s/iter; left time: 6643.1674s
	iters: 300, epoch: 6 | loss: 0.3611299
	speed: 0.1906s/iter; left time: 6625.1151s
Epoch: 6 cost time: 73.67871522903442
Epoch: 6, Steps: 369 | Train Loss: 0.507 Vali Loss: 0.647 Vali Acc: 0.669 Test Loss: 0.647 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4379257
	speed: 0.6679s/iter; left time: 23101.7870s
	iters: 200, epoch: 7 | loss: 0.5216449
	speed: 0.1881s/iter; left time: 6485.7049s
	iters: 300, epoch: 7 | loss: 0.7996138
	speed: 0.2001s/iter; left time: 6882.0981s
Epoch: 7 cost time: 71.64549160003662
Epoch: 7, Steps: 369 | Train Loss: 0.485 Vali Loss: 0.663 Vali Acc: 0.684 Test Loss: 0.663 Test Acc: 0.684
Validation loss decreased (-0.681889 --> -0.683592).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4773595
	speed: 0.6516s/iter; left time: 22295.6789s
	iters: 200, epoch: 8 | loss: 0.5948902
	speed: 0.1578s/iter; left time: 5384.0359s
	iters: 300, epoch: 8 | loss: 0.6135138
	speed: 0.1642s/iter; left time: 5584.5134s
Epoch: 8 cost time: 64.17254447937012
Epoch: 8, Steps: 369 | Train Loss: 0.462 Vali Loss: 0.668 Vali Acc: 0.670 Test Loss: 0.668 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2808929
	speed: 0.7345s/iter; left time: 24860.4515s
	iters: 200, epoch: 9 | loss: 0.4394181
	speed: 0.1638s/iter; left time: 5529.0733s
	iters: 300, epoch: 9 | loss: 0.3381826
	speed: 0.1844s/iter; left time: 6205.3021s
Epoch: 9 cost time: 66.6099317073822
Epoch: 9, Steps: 369 | Train Loss: 0.432 Vali Loss: 0.667 Vali Acc: 0.684 Test Loss: 0.667 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2732728
	speed: 0.6834s/iter; left time: 22880.9469s
	iters: 200, epoch: 10 | loss: 0.3953502
	speed: 0.1824s/iter; left time: 6089.2178s
	iters: 300, epoch: 10 | loss: 0.5613159
	speed: 0.1930s/iter; left time: 6422.4827s
Epoch: 10 cost time: 69.16820454597473
Epoch: 10, Steps: 369 | Train Loss: 0.419 Vali Loss: 0.693 Vali Acc: 0.667 Test Loss: 0.693 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2760617
	speed: 0.6739s/iter; left time: 22312.1592s
	iters: 200, epoch: 11 | loss: 0.4032429
	speed: 0.2086s/iter; left time: 6887.2728s
	iters: 300, epoch: 11 | loss: 0.3802029
	speed: 0.1866s/iter; left time: 6141.5284s
Epoch: 11 cost time: 69.80179190635681
Epoch: 11, Steps: 369 | Train Loss: 0.388 Vali Loss: 0.705 Vali Acc: 0.665 Test Loss: 0.705 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.6009749
	speed: 0.6245s/iter; left time: 20447.3778s
	iters: 200, epoch: 12 | loss: 0.2910404
	speed: 0.1669s/iter; left time: 5448.3961s
	iters: 300, epoch: 12 | loss: 0.3340539
	speed: 0.1556s/iter; left time: 5064.8323s
Epoch: 12 cost time: 62.962997913360596
Epoch: 12, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.723 Vali Acc: 0.678 Test Loss: 0.723 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2430648
	speed: 0.6247s/iter; left time: 20224.7593s
	iters: 200, epoch: 13 | loss: 0.2587300
	speed: 0.1955s/iter; left time: 6307.8600s
	iters: 300, epoch: 13 | loss: 0.1920492
	speed: 0.2071s/iter; left time: 6663.1811s
Epoch: 13 cost time: 71.73558330535889
Epoch: 13, Steps: 369 | Train Loss: 0.338 Vali Loss: 0.920 Vali Acc: 0.655 Test Loss: 0.920 Test Acc: 0.655
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.3866994
	speed: 0.6586s/iter; left time: 21078.2224s
	iters: 200, epoch: 14 | loss: 0.0859153
	speed: 0.1956s/iter; left time: 6240.7370s
	iters: 300, epoch: 14 | loss: 0.3918794
	speed: 0.1844s/iter; left time: 5864.2958s
Epoch: 14 cost time: 70.4526526927948
Epoch: 14, Steps: 369 | Train Loss: 0.326 Vali Loss: 0.794 Vali Acc: 0.655 Test Loss: 0.794 Test Acc: 0.655
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1608317
	speed: 0.6562s/iter; left time: 20759.2912s
	iters: 200, epoch: 15 | loss: 0.1660308
	speed: 0.2056s/iter; left time: 6484.5829s
	iters: 300, epoch: 15 | loss: 0.3131248
	speed: 0.2004s/iter; left time: 6300.4601s
Epoch: 15 cost time: 71.37453579902649
Epoch: 15, Steps: 369 | Train Loss: 0.296 Vali Loss: 0.807 Vali Acc: 0.675 Test Loss: 0.807 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1240501
	speed: 0.6352s/iter; left time: 19858.7593s
	iters: 200, epoch: 16 | loss: 0.1709637
	speed: 0.1974s/iter; left time: 6152.1639s
	iters: 300, epoch: 16 | loss: 0.4123436
	speed: 0.1883s/iter; left time: 5849.3254s
Epoch: 16 cost time: 73.78518342971802
Epoch: 16, Steps: 369 | Train Loss: 0.275 Vali Loss: 0.864 Vali Acc: 0.672 Test Loss: 0.864 Test Acc: 0.672
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.4350080
	speed: 0.6720s/iter; left time: 20762.7260s
	iters: 200, epoch: 17 | loss: 0.2082245
	speed: 0.1869s/iter; left time: 5756.5025s
	iters: 300, epoch: 17 | loss: 0.2097106
	speed: 0.1902s/iter; left time: 5839.1588s
Epoch: 17 cost time: 69.67739653587341
Epoch: 17, Steps: 369 | Train Loss: 0.248 Vali Loss: 0.906 Vali Acc: 0.676 Test Loss: 0.906 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6835981838819524
model parameter : 495454
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6183228
	speed: 0.2002s/iter; left time: 7369.1994s
	iters: 200, epoch: 1 | loss: 1.0709519
	speed: 0.1869s/iter; left time: 6861.0273s
	iters: 300, epoch: 1 | loss: 0.5400053
	speed: 0.2195s/iter; left time: 8032.3572s
Epoch: 1 cost time: 74.14329504966736
Epoch: 1, Steps: 369 | Train Loss: 0.687 Vali Loss: 0.784 Vali Acc: 0.597 Test Loss: 0.784 Test Acc: 0.597
Validation loss decreased (inf --> -0.597041).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7666752
	speed: 0.6468s/iter; left time: 23564.4738s
	iters: 200, epoch: 2 | loss: 0.4368274
	speed: 0.1644s/iter; left time: 5973.6735s
	iters: 300, epoch: 2 | loss: 0.3911340
	speed: 0.1705s/iter; left time: 6177.4115s
Epoch: 2 cost time: 62.75157856941223
Epoch: 2, Steps: 369 | Train Loss: 0.624 Vali Loss: 0.853 Vali Acc: 0.593 Test Loss: 0.853 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4500990
	speed: 0.6574s/iter; left time: 23706.3587s
	iters: 200, epoch: 3 | loss: 0.8738783
	speed: 0.1866s/iter; left time: 6712.4323s
	iters: 300, epoch: 3 | loss: 0.6967313
	speed: 0.1748s/iter; left time: 6268.7365s
Epoch: 3 cost time: 66.5991382598877
Epoch: 3, Steps: 369 | Train Loss: 0.597 Vali Loss: 0.656 Vali Acc: 0.678 Test Loss: 0.656 Test Acc: 0.678
Validation loss decreased (-0.597041 --> -0.677916).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6565496
	speed: 0.6211s/iter; left time: 22168.9831s
	iters: 200, epoch: 4 | loss: 0.3834395
	speed: 0.1518s/iter; left time: 5404.6059s
	iters: 300, epoch: 4 | loss: 0.3678275
	speed: 0.1919s/iter; left time: 6812.7572s
Epoch: 4 cost time: 64.140634059906
Epoch: 4, Steps: 369 | Train Loss: 0.572 Vali Loss: 0.666 Vali Acc: 0.661 Test Loss: 0.666 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5522089
	speed: 0.6522s/iter; left time: 23037.3410s
	iters: 200, epoch: 5 | loss: 0.3085939
	speed: 0.2037s/iter; left time: 7175.7415s
	iters: 300, epoch: 5 | loss: 0.6562198
	speed: 0.1798s/iter; left time: 6317.0772s
Epoch: 5 cost time: 73.49863767623901
Epoch: 5, Steps: 369 | Train Loss: 0.545 Vali Loss: 0.663 Vali Acc: 0.662 Test Loss: 0.663 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6734353
	speed: 0.6589s/iter; left time: 23030.8894s
	iters: 200, epoch: 6 | loss: 0.8873315
	speed: 0.1626s/iter; left time: 5668.1570s
	iters: 300, epoch: 6 | loss: 0.4707277
	speed: 0.1638s/iter; left time: 5692.2224s
Epoch: 6 cost time: 63.241799116134644
Epoch: 6, Steps: 369 | Train Loss: 0.513 Vali Loss: 0.648 Vali Acc: 0.673 Test Loss: 0.648 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.5369419
	speed: 0.6395s/iter; left time: 22118.2221s
	iters: 200, epoch: 7 | loss: 0.5610572
	speed: 0.1647s/iter; left time: 5679.7417s
	iters: 300, epoch: 7 | loss: 0.3246304
	speed: 0.1600s/iter; left time: 5503.1799s
Epoch: 7 cost time: 63.958463191986084
Epoch: 7, Steps: 369 | Train Loss: 0.483 Vali Loss: 0.669 Vali Acc: 0.647 Test Loss: 0.669 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.4732772
	speed: 0.6031s/iter; left time: 20637.1531s
	iters: 200, epoch: 8 | loss: 0.2242778
	speed: 0.1665s/iter; left time: 5680.0536s
	iters: 300, epoch: 8 | loss: 0.3661158
	speed: 0.1546s/iter; left time: 5258.3117s
Epoch: 8 cost time: 60.19687032699585
Epoch: 8, Steps: 369 | Train Loss: 0.460 Vali Loss: 0.696 Vali Acc: 0.661 Test Loss: 0.696 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.3674615
	speed: 0.6618s/iter; left time: 22401.5702s
	iters: 200, epoch: 9 | loss: 0.3921073
	speed: 0.1914s/iter; left time: 6459.1438s
	iters: 300, epoch: 9 | loss: 0.5307418
	speed: 0.1470s/iter; left time: 4945.8762s
Epoch: 9 cost time: 65.55074906349182
Epoch: 9, Steps: 369 | Train Loss: 0.439 Vali Loss: 0.709 Vali Acc: 0.628 Test Loss: 0.709 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.3385643
	speed: 0.5515s/iter; left time: 18462.8012s
	iters: 200, epoch: 10 | loss: 0.2461467
	speed: 0.1375s/iter; left time: 4589.5079s
	iters: 300, epoch: 10 | loss: 0.4926274
	speed: 0.1670s/iter; left time: 5558.8249s
Epoch: 10 cost time: 60.801613092422485
Epoch: 10, Steps: 369 | Train Loss: 0.419 Vali Loss: 0.696 Vali Acc: 0.664 Test Loss: 0.696 Test Acc: 0.664
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.3178041
	speed: 0.6341s/iter; left time: 20994.5011s
	iters: 200, epoch: 11 | loss: 0.3460752
	speed: 0.1855s/iter; left time: 6121.9595s
	iters: 300, epoch: 11 | loss: 0.4690068
	speed: 0.1751s/iter; left time: 5763.6830s
Epoch: 11 cost time: 65.93879652023315
Epoch: 11, Steps: 369 | Train Loss: 0.385 Vali Loss: 0.788 Vali Acc: 0.671 Test Loss: 0.788 Test Acc: 0.671
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.4412625
	speed: 0.6190s/iter; left time: 20265.7674s
	iters: 200, epoch: 12 | loss: 0.6155764
	speed: 0.1800s/iter; left time: 5874.7005s
	iters: 300, epoch: 12 | loss: 0.2699881
	speed: 0.1991s/iter; left time: 6479.9543s
Epoch: 12 cost time: 67.72500658035278
Epoch: 12, Steps: 369 | Train Loss: 0.369 Vali Loss: 0.804 Vali Acc: 0.657 Test Loss: 0.804 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.5002730
	speed: 0.6306s/iter; left time: 20414.9595s
	iters: 200, epoch: 13 | loss: 0.3881705
	speed: 0.1570s/iter; left time: 5066.8599s
	iters: 300, epoch: 13 | loss: 0.5141658
	speed: 0.1516s/iter; left time: 4877.1595s
Epoch: 13 cost time: 61.150341510772705
Epoch: 13, Steps: 369 | Train Loss: 0.347 Vali Loss: 0.840 Vali Acc: 0.654 Test Loss: 0.840 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6779228149829739
model parameter : 495070
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7631463
	speed: 0.2123s/iter; left time: 7813.9096s
	iters: 200, epoch: 1 | loss: 0.6506168
	speed: 0.1520s/iter; left time: 5576.8877s
	iters: 300, epoch: 1 | loss: 0.6823298
	speed: 0.1689s/iter; left time: 6183.3326s
Epoch: 1 cost time: 65.75054979324341
Epoch: 1, Steps: 369 | Train Loss: 0.690 Vali Loss: 0.849 Vali Acc: 0.594 Test Loss: 0.849 Test Acc: 0.594
Validation loss decreased (inf --> -0.593919).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6768929
	speed: 0.6430s/iter; left time: 23424.4493s
	iters: 200, epoch: 2 | loss: 0.6390663
	speed: 0.1930s/iter; left time: 7013.5271s
	iters: 300, epoch: 2 | loss: 0.5814074
	speed: 0.1952s/iter; left time: 7071.3193s
Epoch: 2 cost time: 70.6362874507904
Epoch: 2, Steps: 369 | Train Loss: 0.632 Vali Loss: 0.643 Vali Acc: 0.648 Test Loss: 0.643 Test Acc: 0.648
Validation loss decreased (-0.593919 --> -0.648121).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3920535
	speed: 0.6596s/iter; left time: 23788.7894s
	iters: 200, epoch: 3 | loss: 0.3240576
	speed: 0.1694s/iter; left time: 6092.7951s
	iters: 300, epoch: 3 | loss: 0.4956798
	speed: 0.1848s/iter; left time: 6626.3250s
Epoch: 3 cost time: 63.04066300392151
Epoch: 3, Steps: 369 | Train Loss: 0.598 Vali Loss: 0.657 Vali Acc: 0.654 Test Loss: 0.657 Test Acc: 0.654
Validation loss decreased (-0.648121 --> -0.653796).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6323874
	speed: 0.6678s/iter; left time: 23835.6067s
	iters: 200, epoch: 4 | loss: 0.4167463
	speed: 0.1718s/iter; left time: 6116.7894s
	iters: 300, epoch: 4 | loss: 0.6763059
	speed: 0.1762s/iter; left time: 6255.2642s
Epoch: 4 cost time: 67.40144467353821
Epoch: 4, Steps: 369 | Train Loss: 0.559 Vali Loss: 0.713 Vali Acc: 0.621 Test Loss: 0.713 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3281789
	speed: 0.6747s/iter; left time: 23834.7045s
	iters: 200, epoch: 5 | loss: 0.6132627
	speed: 0.1700s/iter; left time: 5988.7964s
	iters: 300, epoch: 5 | loss: 0.8478932
	speed: 0.1609s/iter; left time: 5651.1374s
Epoch: 5 cost time: 63.02424430847168
Epoch: 5, Steps: 369 | Train Loss: 0.522 Vali Loss: 0.705 Vali Acc: 0.626 Test Loss: 0.705 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.4571901
	speed: 0.5980s/iter; left time: 20903.2349s
	iters: 200, epoch: 6 | loss: 0.3352150
	speed: 0.1936s/iter; left time: 6746.4064s
	iters: 300, epoch: 6 | loss: 0.6798722
	speed: 0.1831s/iter; left time: 6364.6948s
Epoch: 6 cost time: 65.48336362838745
Epoch: 6, Steps: 369 | Train Loss: 0.491 Vali Loss: 0.651 Vali Acc: 0.673 Test Loss: 0.651 Test Acc: 0.673
Validation loss decreased (-0.653796 --> -0.673092).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3887954
	speed: 0.6837s/iter; left time: 23646.5696s
	iters: 200, epoch: 7 | loss: 0.3141877
	speed: 0.1752s/iter; left time: 6041.7670s
	iters: 300, epoch: 7 | loss: 0.3482330
	speed: 0.1617s/iter; left time: 5559.6384s
Epoch: 7 cost time: 64.21220779418945
Epoch: 7, Steps: 369 | Train Loss: 0.459 Vali Loss: 0.656 Vali Acc: 0.667 Test Loss: 0.656 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5965711
	speed: 0.6444s/iter; left time: 22049.6527s
	iters: 200, epoch: 8 | loss: 0.2019920
	speed: 0.1631s/iter; left time: 5563.8976s
	iters: 300, epoch: 8 | loss: 0.3052591
	speed: 0.1682s/iter; left time: 5721.9642s
Epoch: 8 cost time: 66.05334877967834
Epoch: 8, Steps: 369 | Train Loss: 0.431 Vali Loss: 0.652 Vali Acc: 0.672 Test Loss: 0.652 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4961986
	speed: 0.6736s/iter; left time: 22799.8031s
	iters: 200, epoch: 9 | loss: 0.2868970
	speed: 0.1668s/iter; left time: 5629.3109s
	iters: 300, epoch: 9 | loss: 0.5257102
	speed: 0.1558s/iter; left time: 5243.5025s
Epoch: 9 cost time: 62.64337778091431
Epoch: 9, Steps: 369 | Train Loss: 0.403 Vali Loss: 0.684 Vali Acc: 0.671 Test Loss: 0.684 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.5295054
	speed: 0.6379s/iter; left time: 21356.8160s
	iters: 200, epoch: 10 | loss: 0.2570633
	speed: 0.1653s/iter; left time: 5516.2988s
	iters: 300, epoch: 10 | loss: 0.3666231
	speed: 0.1748s/iter; left time: 5816.8310s
Epoch: 10 cost time: 65.53060126304626
Epoch: 10, Steps: 369 | Train Loss: 0.385 Vali Loss: 0.698 Vali Acc: 0.663 Test Loss: 0.698 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4417036
	speed: 0.6462s/iter; left time: 21397.3743s
	iters: 200, epoch: 11 | loss: 0.1595068
	speed: 0.1874s/iter; left time: 6186.1267s
	iters: 300, epoch: 11 | loss: 0.4789754
	speed: 0.1776s/iter; left time: 5843.7493s
Epoch: 11 cost time: 64.85072708129883
Epoch: 11, Steps: 369 | Train Loss: 0.356 Vali Loss: 0.792 Vali Acc: 0.650 Test Loss: 0.792 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.5175490
	speed: 0.6662s/iter; left time: 21812.8462s
	iters: 200, epoch: 12 | loss: 0.2003759
	speed: 0.1764s/iter; left time: 5758.8450s
	iters: 300, epoch: 12 | loss: 0.3562238
	speed: 0.1777s/iter; left time: 5782.0677s
Epoch: 12 cost time: 67.83074402809143
Epoch: 12, Steps: 369 | Train Loss: 0.328 Vali Loss: 0.775 Vali Acc: 0.672 Test Loss: 0.775 Test Acc: 0.672
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1697708
	speed: 0.6403s/iter; left time: 20729.6610s
	iters: 200, epoch: 13 | loss: 0.2067558
	speed: 0.1643s/iter; left time: 5302.1608s
	iters: 300, epoch: 13 | loss: 0.2486331
	speed: 0.1526s/iter; left time: 4908.2280s
Epoch: 13 cost time: 60.34707450866699
Epoch: 13, Steps: 369 | Train Loss: 0.305 Vali Loss: 0.819 Vali Acc: 0.673 Test Loss: 0.819 Test Acc: 0.673
Validation loss decreased (-0.673092 --> -0.673374).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2961015
	speed: 0.6529s/iter; left time: 20894.5861s
	iters: 200, epoch: 14 | loss: 0.3190072
	speed: 0.2195s/iter; left time: 7003.6818s
	iters: 300, epoch: 14 | loss: 0.3860517
	speed: 0.2007s/iter; left time: 6383.4858s
Epoch: 14 cost time: 75.52278208732605
Epoch: 14, Steps: 369 | Train Loss: 0.290 Vali Loss: 0.924 Vali Acc: 0.665 Test Loss: 0.924 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.3978150
	speed: 0.6965s/iter; left time: 22034.4514s
	iters: 200, epoch: 15 | loss: 0.2001851
	speed: 0.1861s/iter; left time: 5867.5931s
	iters: 300, epoch: 15 | loss: 0.2576139
	speed: 0.1978s/iter; left time: 6217.2508s
Epoch: 15 cost time: 72.43081068992615
Epoch: 15, Steps: 369 | Train Loss: 0.254 Vali Loss: 0.900 Vali Acc: 0.669 Test Loss: 0.900 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1009643
	speed: 0.6678s/iter; left time: 20878.8878s
	iters: 200, epoch: 16 | loss: 0.3246179
	speed: 0.1948s/iter; left time: 6072.5791s
	iters: 300, epoch: 16 | loss: 0.2065477
	speed: 0.1751s/iter; left time: 5438.1895s
Epoch: 16 cost time: 70.33315706253052
Epoch: 16, Steps: 369 | Train Loss: 0.234 Vali Loss: 0.902 Vali Acc: 0.668 Test Loss: 0.902 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4397069
	speed: 0.6737s/iter; left time: 20816.0219s
	iters: 200, epoch: 17 | loss: 0.2284357
	speed: 0.1712s/iter; left time: 5273.6525s
	iters: 300, epoch: 17 | loss: 0.0968682
	speed: 0.1603s/iter; left time: 4920.8392s
Epoch: 17 cost time: 67.6084508895874
Epoch: 17, Steps: 369 | Train Loss: 0.212 Vali Loss: 1.179 Vali Acc: 0.656 Test Loss: 1.179 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.3638064
	speed: 0.6941s/iter; left time: 21188.3134s
	iters: 200, epoch: 18 | loss: 0.2926192
	speed: 0.1873s/iter; left time: 5699.3064s
	iters: 300, epoch: 18 | loss: 0.0759247
	speed: 0.1796s/iter; left time: 5447.2111s
Epoch: 18 cost time: 72.86620235443115
Epoch: 18, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.182 Vali Acc: 0.657 Test Loss: 1.182 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0133204
	speed: 0.7153s/iter; left time: 21571.2891s
	iters: 200, epoch: 19 | loss: 0.0208277
	speed: 0.1690s/iter; left time: 5080.6312s
	iters: 300, epoch: 19 | loss: 0.1940291
	speed: 0.1547s/iter; left time: 4635.7094s
Epoch: 19 cost time: 66.92054605484009
Epoch: 19, Steps: 369 | Train Loss: 0.179 Vali Loss: 1.147 Vali Acc: 0.656 Test Loss: 1.147 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0590418
	speed: 0.6230s/iter; left time: 18557.7993s
	iters: 200, epoch: 20 | loss: 0.0532951
	speed: 0.1826s/iter; left time: 5422.2662s
	iters: 300, epoch: 20 | loss: 0.4530984
	speed: 0.1799s/iter; left time: 5324.5113s
Epoch: 20 cost time: 63.29028582572937
Epoch: 20, Steps: 369 | Train Loss: 0.172 Vali Loss: 1.188 Vali Acc: 0.649 Test Loss: 1.188 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0631824
	speed: 0.6507s/iter; left time: 19142.8808s
	iters: 200, epoch: 21 | loss: 0.1440258
	speed: 0.1874s/iter; left time: 5493.5589s
	iters: 300, epoch: 21 | loss: 0.1992029
	speed: 0.1794s/iter; left time: 5242.7304s
Epoch: 21 cost time: 70.60531759262085
Epoch: 21, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.085 Vali Acc: 0.667 Test Loss: 1.085 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.1055053
	speed: 0.6645s/iter; left time: 19304.2195s
	iters: 200, epoch: 22 | loss: 0.0974760
	speed: 0.2033s/iter; left time: 5886.2319s
	iters: 300, epoch: 22 | loss: 0.0257080
	speed: 0.2083s/iter; left time: 6008.6001s
Epoch: 22 cost time: 72.95368981361389
Epoch: 22, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.408 Vali Acc: 0.656 Test Loss: 1.408 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0304439
	speed: 0.5978s/iter; left time: 17146.3551s
	iters: 200, epoch: 23 | loss: 0.6673470
	speed: 0.1781s/iter; left time: 5089.7706s
	iters: 300, epoch: 23 | loss: 0.0572620
	speed: 0.1728s/iter; left time: 4921.8028s
Epoch: 23 cost time: 64.38559341430664
Epoch: 23, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.325 Vali Acc: 0.658 Test Loss: 1.325 Test Acc: 0.658
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6733825198637912
model parameter : 346462
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9967539
	speed: 0.2367s/iter; left time: 8710.8470s
	iters: 200, epoch: 1 | loss: 0.6575649
	speed: 0.2013s/iter; left time: 7387.7133s
	iters: 300, epoch: 1 | loss: 0.4705492
	speed: 0.1853s/iter; left time: 6783.6467s
Epoch: 1 cost time: 75.62131333351135
Epoch: 1, Steps: 369 | Train Loss: 0.698 Vali Loss: 0.702 Vali Acc: 0.609 Test Loss: 0.702 Test Acc: 0.609
Validation loss decreased (inf --> -0.608676).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5408822
	speed: 0.6650s/iter; left time: 24227.4754s
	iters: 200, epoch: 2 | loss: 0.6415904
	speed: 0.1811s/iter; left time: 6579.1052s
	iters: 300, epoch: 2 | loss: 0.5548331
	speed: 0.1878s/iter; left time: 6803.8600s
Epoch: 2 cost time: 67.47922229766846
Epoch: 2, Steps: 369 | Train Loss: 0.601 Vali Loss: 0.646 Vali Acc: 0.666 Test Loss: 0.646 Test Acc: 0.666
Validation loss decreased (-0.608676 --> -0.666282).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3130067
	speed: 0.6649s/iter; left time: 23977.8987s
	iters: 200, epoch: 3 | loss: 0.4682041
	speed: 0.1857s/iter; left time: 6678.3186s
	iters: 300, epoch: 3 | loss: 0.5047170
	speed: 0.1899s/iter; left time: 6809.1861s
Epoch: 3 cost time: 69.23573303222656
Epoch: 3, Steps: 369 | Train Loss: 0.587 Vali Loss: 0.620 Vali Acc: 0.685 Test Loss: 0.620 Test Acc: 0.685
Validation loss decreased (-0.666282 --> -0.685295).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2719799
	speed: 0.6558s/iter; left time: 23409.3659s
	iters: 200, epoch: 4 | loss: 0.8527527
	speed: 0.1624s/iter; left time: 5780.4530s
	iters: 300, epoch: 4 | loss: 0.6507374
	speed: 0.1752s/iter; left time: 6217.7129s
Epoch: 4 cost time: 63.20844101905823
Epoch: 4, Steps: 369 | Train Loss: 0.547 Vali Loss: 0.676 Vali Acc: 0.641 Test Loss: 0.676 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5757539
	speed: 0.6923s/iter; left time: 24455.7687s
	iters: 200, epoch: 5 | loss: 0.4957581
	speed: 0.2392s/iter; left time: 8426.3722s
	iters: 300, epoch: 5 | loss: 0.5514735
	speed: 0.2071s/iter; left time: 7275.1306s
Epoch: 5 cost time: 80.62355041503906
Epoch: 5, Steps: 369 | Train Loss: 0.516 Vali Loss: 0.648 Vali Acc: 0.684 Test Loss: 0.648 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.4069086
	speed: 0.6954s/iter; left time: 24309.1840s
	iters: 200, epoch: 6 | loss: 0.3803547
	speed: 0.1959s/iter; left time: 6826.6996s
	iters: 300, epoch: 6 | loss: 0.5477703
	speed: 0.2070s/iter; left time: 7193.4652s
Epoch: 6 cost time: 70.89400625228882
Epoch: 6, Steps: 369 | Train Loss: 0.488 Vali Loss: 0.648 Vali Acc: 0.684 Test Loss: 0.648 Test Acc: 0.684
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4288627
	speed: 0.7185s/iter; left time: 24850.3280s
	iters: 200, epoch: 7 | loss: 0.3555224
	speed: 0.2068s/iter; left time: 7132.5035s
	iters: 300, epoch: 7 | loss: 0.4864596
	speed: 0.1762s/iter; left time: 6058.1479s
Epoch: 7 cost time: 74.99574875831604
Epoch: 7, Steps: 369 | Train Loss: 0.461 Vali Loss: 0.632 Vali Acc: 0.678 Test Loss: 0.632 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.4218270
	speed: 0.7090s/iter; left time: 24259.7204s
	iters: 200, epoch: 8 | loss: 0.3857595
	speed: 0.1675s/iter; left time: 5715.5576s
	iters: 300, epoch: 8 | loss: 0.2641723
	speed: 0.1545s/iter; left time: 5255.5434s
Epoch: 8 cost time: 64.80444502830505
Epoch: 8, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.682 Vali Acc: 0.671 Test Loss: 0.682 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.4634684
	speed: 0.6535s/iter; left time: 22119.8599s
	iters: 200, epoch: 9 | loss: 0.2175785
	speed: 0.1667s/iter; left time: 5627.1312s
	iters: 300, epoch: 9 | loss: 0.4955727
	speed: 0.1729s/iter; left time: 5818.7111s
Epoch: 9 cost time: 65.5634331703186
Epoch: 9, Steps: 369 | Train Loss: 0.407 Vali Loss: 0.658 Vali Acc: 0.676 Test Loss: 0.658 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.3647728
	speed: 0.7343s/iter; left time: 24583.3709s
	iters: 200, epoch: 10 | loss: 0.5142522
	speed: 0.2524s/iter; left time: 8426.4710s
	iters: 300, epoch: 10 | loss: 0.4282165
	speed: 0.2151s/iter; left time: 7157.6144s
Epoch: 10 cost time: 85.66284656524658
Epoch: 10, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.744 Vali Acc: 0.665 Test Loss: 0.744 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2117835
	speed: 0.7607s/iter; left time: 25186.6523s
	iters: 200, epoch: 11 | loss: 0.3046210
	speed: 0.1982s/iter; left time: 6543.5556s
	iters: 300, epoch: 11 | loss: 0.2840107
	speed: 0.2194s/iter; left time: 7221.5664s
Epoch: 11 cost time: 76.42863821983337
Epoch: 11, Steps: 369 | Train Loss: 0.352 Vali Loss: 0.772 Vali Acc: 0.671 Test Loss: 0.772 Test Acc: 0.671
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.4087381
	speed: 0.7752s/iter; left time: 25380.4249s
	iters: 200, epoch: 12 | loss: 0.6808108
	speed: 0.1907s/iter; left time: 6223.6830s
	iters: 300, epoch: 12 | loss: 0.5285417
	speed: 0.1636s/iter; left time: 5323.3602s
Epoch: 12 cost time: 68.93055391311646
Epoch: 12, Steps: 369 | Train Loss: 0.331 Vali Loss: 0.798 Vali Acc: 0.669 Test Loss: 0.798 Test Acc: 0.669
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.2232441
	speed: 0.7173s/iter; left time: 23221.4603s
	iters: 200, epoch: 13 | loss: 0.3658824
	speed: 0.1802s/iter; left time: 5817.1105s
	iters: 300, epoch: 13 | loss: 0.5039975
	speed: 0.2142s/iter; left time: 6892.3424s
Epoch: 13 cost time: 77.48985767364502
Epoch: 13, Steps: 369 | Train Loss: 0.301 Vali Loss: 0.795 Vali Acc: 0.668 Test Loss: 0.795 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6853007945516458
model parameter : 346078
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6576408
	speed: 0.2037s/iter; left time: 7495.6994s
	iters: 200, epoch: 1 | loss: 0.6601791
	speed: 0.2062s/iter; left time: 7569.5501s
	iters: 300, epoch: 1 | loss: 0.8321808
	speed: 0.1960s/iter; left time: 7171.9860s
Epoch: 1 cost time: 72.29401159286499
Epoch: 1, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.690 Vali Acc: 0.626 Test Loss: 0.690 Test Acc: 0.626
Validation loss decreased (inf --> -0.626270).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6328275
	speed: 0.6207s/iter; left time: 22612.2319s
	iters: 200, epoch: 2 | loss: 0.8302034
	speed: 0.1511s/iter; left time: 5488.4289s
	iters: 300, epoch: 2 | loss: 0.5216517
	speed: 0.1591s/iter; left time: 5766.2622s
Epoch: 2 cost time: 60.868232011795044
Epoch: 2, Steps: 369 | Train Loss: 0.627 Vali Loss: 0.703 Vali Acc: 0.672 Test Loss: 0.703 Test Acc: 0.672
Validation loss decreased (-0.626270 --> -0.671957).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5931310
	speed: 0.6339s/iter; left time: 22861.3829s
	iters: 200, epoch: 3 | loss: 0.2504739
	speed: 0.1747s/iter; left time: 6281.4348s
	iters: 300, epoch: 3 | loss: 0.3560544
	speed: 0.1570s/iter; left time: 5629.9861s
Epoch: 3 cost time: 64.24432706832886
Epoch: 3, Steps: 369 | Train Loss: 0.585 Vali Loss: 0.643 Vali Acc: 0.677 Test Loss: 0.643 Test Acc: 0.677
Validation loss decreased (-0.671957 --> -0.676498).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2747001
	speed: 0.6954s/iter; left time: 24821.5117s
	iters: 200, epoch: 4 | loss: 0.3387995
	speed: 0.1986s/iter; left time: 7068.8200s
	iters: 300, epoch: 4 | loss: 0.3017101
	speed: 0.1842s/iter; left time: 6538.7725s
Epoch: 4 cost time: 72.38868689537048
Epoch: 4, Steps: 369 | Train Loss: 0.567 Vali Loss: 0.715 Vali Acc: 0.676 Test Loss: 0.715 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4269903
	speed: 0.7274s/iter; left time: 25695.3360s
	iters: 200, epoch: 5 | loss: 0.4988924
	speed: 0.1929s/iter; left time: 6795.5011s
	iters: 300, epoch: 5 | loss: 0.2862596
	speed: 0.2145s/iter; left time: 7535.4452s
Epoch: 5 cost time: 74.17938780784607
Epoch: 5, Steps: 369 | Train Loss: 0.534 Vali Loss: 0.641 Vali Acc: 0.674 Test Loss: 0.641 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7018870
	speed: 0.7105s/iter; left time: 24835.0532s
	iters: 200, epoch: 6 | loss: 0.3804446
	speed: 0.1942s/iter; left time: 6767.3351s
	iters: 300, epoch: 6 | loss: 0.5654147
	speed: 0.1987s/iter; left time: 6904.5805s
Epoch: 6 cost time: 73.68137001991272
Epoch: 6, Steps: 369 | Train Loss: 0.500 Vali Loss: 0.684 Vali Acc: 0.663 Test Loss: 0.684 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.5287974
	speed: 0.7218s/iter; left time: 24964.9863s
	iters: 200, epoch: 7 | loss: 1.0638746
	speed: 0.1625s/iter; left time: 5605.4944s
	iters: 300, epoch: 7 | loss: 0.2365911
	speed: 0.1708s/iter; left time: 5872.1416s
Epoch: 7 cost time: 66.05366945266724
Epoch: 7, Steps: 369 | Train Loss: 0.469 Vali Loss: 0.633 Vali Acc: 0.678 Test Loss: 0.633 Test Acc: 0.678
Validation loss decreased (-0.676498 --> -0.677633).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5274162
	speed: 0.7105s/iter; left time: 24313.3941s
	iters: 200, epoch: 8 | loss: 0.3264960
	speed: 0.1876s/iter; left time: 6401.4442s
	iters: 300, epoch: 8 | loss: 0.5317075
	speed: 0.1939s/iter; left time: 6596.2445s
Epoch: 8 cost time: 72.59544539451599
Epoch: 8, Steps: 369 | Train Loss: 0.445 Vali Loss: 0.694 Vali Acc: 0.663 Test Loss: 0.694 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3175006
	speed: 0.6761s/iter; left time: 22884.4198s
	iters: 200, epoch: 9 | loss: 0.4579405
	speed: 0.1908s/iter; left time: 6438.8328s
	iters: 300, epoch: 9 | loss: 0.6693537
	speed: 0.1825s/iter; left time: 6141.7913s
Epoch: 9 cost time: 67.7999222278595
Epoch: 9, Steps: 369 | Train Loss: 0.412 Vali Loss: 0.693 Vali Acc: 0.652 Test Loss: 0.693 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.4060436
	speed: 0.7080s/iter; left time: 23702.8093s
	iters: 200, epoch: 10 | loss: 0.3104106
	speed: 0.1652s/iter; left time: 5515.7431s
	iters: 300, epoch: 10 | loss: 0.2650893
	speed: 0.1643s/iter; left time: 5466.7197s
Epoch: 10 cost time: 65.85374093055725
Epoch: 10, Steps: 369 | Train Loss: 0.399 Vali Loss: 0.702 Vali Acc: 0.672 Test Loss: 0.702 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.5116063
	speed: 0.6895s/iter; left time: 22829.8467s
	iters: 200, epoch: 11 | loss: 0.1642866
	speed: 0.1989s/iter; left time: 6566.8680s
	iters: 300, epoch: 11 | loss: 0.4706149
	speed: 0.1994s/iter; left time: 6563.4823s
Epoch: 11 cost time: 75.3668007850647
Epoch: 11, Steps: 369 | Train Loss: 0.379 Vali Loss: 0.781 Vali Acc: 0.648 Test Loss: 0.781 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.4076013
	speed: 0.7353s/iter; left time: 24076.2808s
	iters: 200, epoch: 12 | loss: 0.3245248
	speed: 0.1893s/iter; left time: 6179.4981s
	iters: 300, epoch: 12 | loss: 0.3669356
	speed: 0.1890s/iter; left time: 6151.9149s
Epoch: 12 cost time: 69.69753694534302
Epoch: 12, Steps: 369 | Train Loss: 0.345 Vali Loss: 0.763 Vali Acc: 0.670 Test Loss: 0.763 Test Acc: 0.670
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1814960
	speed: 0.7384s/iter; left time: 23904.0329s
	iters: 200, epoch: 13 | loss: 0.3861049
	speed: 0.1683s/iter; left time: 5430.5811s
	iters: 300, epoch: 13 | loss: 0.5022966
	speed: 0.1663s/iter; left time: 5349.7882s
Epoch: 13 cost time: 68.4872236251831
Epoch: 13, Steps: 369 | Train Loss: 0.318 Vali Loss: 0.844 Vali Acc: 0.660 Test Loss: 0.844 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1968473
	speed: 0.7293s/iter; left time: 23341.0548s
	iters: 200, epoch: 14 | loss: 0.3659236
	speed: 0.1959s/iter; left time: 6250.2463s
	iters: 300, epoch: 14 | loss: 0.4836257
	speed: 0.1834s/iter; left time: 5834.3897s
Epoch: 14 cost time: 71.16615557670593
Epoch: 14, Steps: 369 | Train Loss: 0.297 Vali Loss: 0.840 Vali Acc: 0.654 Test Loss: 0.840 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0613666
	speed: 0.6555s/iter; left time: 20735.9872s
	iters: 200, epoch: 15 | loss: 0.2264245
	speed: 0.1970s/iter; left time: 6213.1524s
	iters: 300, epoch: 15 | loss: 0.2577732
	speed: 0.1963s/iter; left time: 6170.3798s
Epoch: 15 cost time: 73.74001407623291
Epoch: 15, Steps: 369 | Train Loss: 0.260 Vali Loss: 0.923 Vali Acc: 0.664 Test Loss: 0.923 Test Acc: 0.664
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2140373
	speed: 0.7103s/iter; left time: 22208.0764s
	iters: 200, epoch: 16 | loss: 0.4553148
	speed: 0.1812s/iter; left time: 5646.2975s
	iters: 300, epoch: 16 | loss: 0.2190620
	speed: 0.1856s/iter; left time: 5766.5389s
Epoch: 16 cost time: 71.11561560630798
Epoch: 16, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.005 Vali Acc: 0.649 Test Loss: 1.005 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.1980303
	speed: 0.7172s/iter; left time: 22159.1265s
	iters: 200, epoch: 17 | loss: 0.3235645
	speed: 0.1864s/iter; left time: 5740.3698s
	iters: 300, epoch: 17 | loss: 0.1068706
	speed: 0.1851s/iter; left time: 5682.7062s
Epoch: 17 cost time: 73.34008836746216
Epoch: 17, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.212 Vali Acc: 0.662 Test Loss: 1.212 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.677639046538025
model parameter : 345694
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6785416
	speed: 0.2209s/iter; left time: 8128.0685s
	iters: 200, epoch: 1 | loss: 0.8729325
	speed: 0.1683s/iter; left time: 6176.0807s
	iters: 300, epoch: 1 | loss: 0.4672669
	speed: 0.1644s/iter; left time: 6015.8304s
Epoch: 1 cost time: 67.07802844047546
Epoch: 1, Steps: 369 | Train Loss: 0.695 Vali Loss: 0.666 Vali Acc: 0.646 Test Loss: 0.666 Test Acc: 0.646
Validation loss decreased (inf --> -0.645567).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7467460
	speed: 0.6726s/iter; left time: 24503.5695s
	iters: 200, epoch: 2 | loss: 0.6057811
	speed: 0.1735s/iter; left time: 6303.3421s
	iters: 300, epoch: 2 | loss: 0.5324283
	speed: 0.1704s/iter; left time: 6172.5064s
Epoch: 2 cost time: 66.212575674057
Epoch: 2, Steps: 369 | Train Loss: 0.611 Vali Loss: 0.682 Vali Acc: 0.667 Test Loss: 0.682 Test Acc: 0.667
Validation loss decreased (-0.645567 --> -0.666849).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7092611
	speed: 0.6673s/iter; left time: 24065.4630s
	iters: 200, epoch: 3 | loss: 1.1998718
	speed: 0.1856s/iter; left time: 6674.5969s
	iters: 300, epoch: 3 | loss: 0.4899918
	speed: 0.1679s/iter; left time: 6022.9281s
Epoch: 3 cost time: 67.13869023323059
Epoch: 3, Steps: 369 | Train Loss: 0.620 Vali Loss: 0.774 Vali Acc: 0.594 Test Loss: 0.774 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5630411
	speed: 0.6931s/iter; left time: 24738.6776s
	iters: 200, epoch: 4 | loss: 0.5854636
	speed: 0.1670s/iter; left time: 5943.6718s
	iters: 300, epoch: 4 | loss: 0.6755357
	speed: 0.1930s/iter; left time: 6850.2866s
Epoch: 4 cost time: 66.99646973609924
Epoch: 4, Steps: 369 | Train Loss: 0.582 Vali Loss: 0.867 Vali Acc: 0.606 Test Loss: 0.867 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6054258
	speed: 0.6653s/iter; left time: 23503.0148s
	iters: 200, epoch: 5 | loss: 0.4897178
	speed: 0.1674s/iter; left time: 5896.2536s
	iters: 300, epoch: 5 | loss: 0.6680357
	speed: 0.1629s/iter; left time: 5721.6056s
Epoch: 5 cost time: 63.77607035636902
Epoch: 5, Steps: 369 | Train Loss: 0.529 Vali Loss: 0.699 Vali Acc: 0.656 Test Loss: 0.699 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.4767934
	speed: 0.6974s/iter; left time: 24377.2221s
	iters: 200, epoch: 6 | loss: 0.5353953
	speed: 0.1749s/iter; left time: 6096.3021s
	iters: 300, epoch: 6 | loss: 0.3758772
	speed: 0.1599s/iter; left time: 5557.6593s
Epoch: 6 cost time: 64.61918592453003
Epoch: 6, Steps: 369 | Train Loss: 0.497 Vali Loss: 0.647 Vali Acc: 0.674 Test Loss: 0.647 Test Acc: 0.674
Validation loss decreased (-0.666849 --> -0.674227).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6289040
	speed: 0.6264s/iter; left time: 21666.1216s
	iters: 200, epoch: 7 | loss: 0.4192885
	speed: 0.1551s/iter; left time: 5349.9891s
	iters: 300, epoch: 7 | loss: 0.8513821
	speed: 0.1822s/iter; left time: 6266.8862s
Epoch: 7 cost time: 61.574068784713745
Epoch: 7, Steps: 369 | Train Loss: 0.470 Vali Loss: 0.663 Vali Acc: 0.665 Test Loss: 0.663 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4446871
	speed: 0.6374s/iter; left time: 21810.1372s
	iters: 200, epoch: 8 | loss: 0.5236444
	speed: 0.1726s/iter; left time: 5890.2468s
	iters: 300, epoch: 8 | loss: 0.4752356
	speed: 0.1808s/iter; left time: 6151.3430s
Epoch: 8 cost time: 64.63527321815491
Epoch: 8, Steps: 369 | Train Loss: 0.436 Vali Loss: 0.712 Vali Acc: 0.662 Test Loss: 0.712 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2811558
	speed: 0.6622s/iter; left time: 22414.3455s
	iters: 200, epoch: 9 | loss: 0.3895022
	speed: 0.1834s/iter; left time: 6191.2424s
	iters: 300, epoch: 9 | loss: 0.7151381
	speed: 0.1644s/iter; left time: 5531.3872s
Epoch: 9 cost time: 65.02419686317444
Epoch: 9, Steps: 369 | Train Loss: 0.411 Vali Loss: 0.768 Vali Acc: 0.662 Test Loss: 0.768 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2852326
	speed: 0.6736s/iter; left time: 22551.2755s
	iters: 200, epoch: 10 | loss: 0.5348420
	speed: 0.1701s/iter; left time: 5676.7646s
	iters: 300, epoch: 10 | loss: 0.3671874
	speed: 0.1881s/iter; left time: 6261.0657s
Epoch: 10 cost time: 66.535635471344
Epoch: 10, Steps: 369 | Train Loss: 0.391 Vali Loss: 0.696 Vali Acc: 0.677 Test Loss: 0.696 Test Acc: 0.677
Validation loss decreased (-0.674227 --> -0.676497).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2918164
	speed: 0.6548s/iter; left time: 21680.8749s
	iters: 200, epoch: 11 | loss: 0.2614220
	speed: 0.1604s/iter; left time: 5294.2313s
	iters: 300, epoch: 11 | loss: 0.3343999
	speed: 0.1754s/iter; left time: 5773.8239s
Epoch: 11 cost time: 63.910035848617554
Epoch: 11, Steps: 369 | Train Loss: 0.368 Vali Loss: 0.787 Vali Acc: 0.663 Test Loss: 0.787 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0951003
	speed: 0.6916s/iter; left time: 22645.4580s
	iters: 200, epoch: 12 | loss: 0.4109318
	speed: 0.1912s/iter; left time: 6240.5422s
	iters: 300, epoch: 12 | loss: 0.1336403
	speed: 0.1895s/iter; left time: 6165.8403s
Epoch: 12 cost time: 67.56317567825317
Epoch: 12, Steps: 369 | Train Loss: 0.333 Vali Loss: 0.956 Vali Acc: 0.627 Test Loss: 0.956 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.3402071
	speed: 0.6945s/iter; left time: 22484.1385s
	iters: 200, epoch: 13 | loss: 0.2075201
	speed: 0.1599s/iter; left time: 5158.8607s
	iters: 300, epoch: 13 | loss: 0.2700644
	speed: 0.1752s/iter; left time: 5637.5789s
Epoch: 13 cost time: 64.78774118423462
Epoch: 13, Steps: 369 | Train Loss: 0.313 Vali Loss: 0.811 Vali Acc: 0.650 Test Loss: 0.811 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.3847005
	speed: 0.6687s/iter; left time: 21400.2671s
	iters: 200, epoch: 14 | loss: 0.2379074
	speed: 0.1824s/iter; left time: 5819.5825s
	iters: 300, epoch: 14 | loss: 0.2278617
	speed: 0.1713s/iter; left time: 5446.8160s
Epoch: 14 cost time: 65.13904595375061
Epoch: 14, Steps: 369 | Train Loss: 0.290 Vali Loss: 0.776 Vali Acc: 0.664 Test Loss: 0.776 Test Acc: 0.664
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.2834987
	speed: 0.6804s/iter; left time: 21524.5718s
	iters: 200, epoch: 15 | loss: 0.1243660
	speed: 0.1637s/iter; left time: 5163.6686s
	iters: 300, epoch: 15 | loss: 0.1052164
	speed: 0.1642s/iter; left time: 5161.6978s
Epoch: 15 cost time: 62.16453313827515
Epoch: 15, Steps: 369 | Train Loss: 0.260 Vali Loss: 0.901 Vali Acc: 0.643 Test Loss: 0.901 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1463966
	speed: 0.6446s/iter; left time: 20153.7522s
	iters: 200, epoch: 16 | loss: 0.5557194
	speed: 0.1738s/iter; left time: 5415.2815s
	iters: 300, epoch: 16 | loss: 0.1545950
	speed: 0.1892s/iter; left time: 5878.0014s
Epoch: 16 cost time: 69.04817795753479
Epoch: 16, Steps: 369 | Train Loss: 0.238 Vali Loss: 1.046 Vali Acc: 0.652 Test Loss: 1.046 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.1744493
	speed: 0.6914s/iter; left time: 21362.1631s
	iters: 200, epoch: 17 | loss: 0.2690475
	speed: 0.1862s/iter; left time: 5734.7966s
	iters: 300, epoch: 17 | loss: 0.3584909
	speed: 0.1826s/iter; left time: 5604.1401s
Epoch: 17 cost time: 69.04095506668091
Epoch: 17, Steps: 369 | Train Loss: 0.221 Vali Loss: 1.030 Vali Acc: 0.656 Test Loss: 1.030 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0477982
	speed: 0.6920s/iter; left time: 21124.5127s
	iters: 200, epoch: 18 | loss: 0.4120454
	speed: 0.1902s/iter; left time: 5788.3039s
	iters: 300, epoch: 18 | loss: 0.3004746
	speed: 0.1818s/iter; left time: 5513.2224s
Epoch: 18 cost time: 67.91889357566833
Epoch: 18, Steps: 369 | Train Loss: 0.195 Vali Loss: 1.182 Vali Acc: 0.647 Test Loss: 1.182 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.3777749
	speed: 0.6990s/iter; left time: 21080.8978s
	iters: 200, epoch: 19 | loss: 0.1064171
	speed: 0.1624s/iter; left time: 4882.7129s
	iters: 300, epoch: 19 | loss: 0.1493043
	speed: 0.1529s/iter; left time: 4580.8730s
Epoch: 19 cost time: 62.17834782600403
Epoch: 19, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.274 Vali Acc: 0.653 Test Loss: 1.274 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0458556
	speed: 0.6570s/iter; left time: 19573.2859s
	iters: 200, epoch: 20 | loss: 0.0533113
	speed: 0.1462s/iter; left time: 4339.7091s
	iters: 300, epoch: 20 | loss: 0.1628085
	speed: 0.1311s/iter; left time: 3878.9894s
Epoch: 20 cost time: 57.79497194290161
Epoch: 20, Steps: 369 | Train Loss: 0.165 Vali Loss: 1.336 Vali Acc: 0.648 Test Loss: 1.336 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6765039727582293
model parameter : 345310
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5653990
	speed: 0.2413s/iter; left time: 8881.1223s
	iters: 200, epoch: 1 | loss: 0.5537558
	speed: 0.1791s/iter; left time: 6571.4162s
	iters: 300, epoch: 1 | loss: 0.7919376
	speed: 0.1716s/iter; left time: 6280.0818s
Epoch: 1 cost time: 69.6042230129242
Epoch: 1, Steps: 369 | Train Loss: 0.695 Vali Loss: 0.675 Vali Acc: 0.648 Test Loss: 0.675 Test Acc: 0.648
Validation loss decreased (inf --> -0.648120).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7132705
	speed: 0.6680s/iter; left time: 24335.2327s
	iters: 200, epoch: 2 | loss: 0.8253304
	speed: 0.1723s/iter; left time: 6259.2251s
	iters: 300, epoch: 2 | loss: 0.7907515
	speed: 0.1569s/iter; left time: 5684.7256s
Epoch: 2 cost time: 64.17001938819885
Epoch: 2, Steps: 369 | Train Loss: 0.630 Vali Loss: 0.773 Vali Acc: 0.632 Test Loss: 0.773 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6932408
	speed: 0.6314s/iter; left time: 22771.9059s
	iters: 200, epoch: 3 | loss: 0.6999365
	speed: 0.1762s/iter; left time: 6337.0450s
	iters: 300, epoch: 3 | loss: 0.2561160
	speed: 0.1757s/iter; left time: 6300.9618s
Epoch: 3 cost time: 65.1127815246582
Epoch: 3, Steps: 369 | Train Loss: 0.583 Vali Loss: 0.656 Vali Acc: 0.668 Test Loss: 0.656 Test Acc: 0.668
Validation loss decreased (-0.648120 --> -0.667984).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6153005
	speed: 0.6949s/iter; left time: 24802.0156s
	iters: 200, epoch: 4 | loss: 0.5274161
	speed: 0.1720s/iter; left time: 6121.3218s
	iters: 300, epoch: 4 | loss: 0.9284543
	speed: 0.1512s/iter; left time: 5366.7903s
Epoch: 4 cost time: 63.09948754310608
Epoch: 4, Steps: 369 | Train Loss: 0.564 Vali Loss: 0.696 Vali Acc: 0.655 Test Loss: 0.696 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7668628
	speed: 0.6754s/iter; left time: 23858.0873s
	iters: 200, epoch: 5 | loss: 0.5315242
	speed: 0.1737s/iter; left time: 6118.7418s
	iters: 300, epoch: 5 | loss: 0.4228660
	speed: 0.1572s/iter; left time: 5521.4956s
Epoch: 5 cost time: 65.46886396408081
Epoch: 5, Steps: 369 | Train Loss: 0.532 Vali Loss: 0.656 Vali Acc: 0.672 Test Loss: 0.656 Test Acc: 0.672
Validation loss decreased (-0.667984 --> -0.671673).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6958917
	speed: 0.7234s/iter; left time: 25288.3147s
	iters: 200, epoch: 6 | loss: 0.6771793
	speed: 0.2007s/iter; left time: 6994.7617s
	iters: 300, epoch: 6 | loss: 0.3829665
	speed: 0.1779s/iter; left time: 6182.3504s
Epoch: 6 cost time: 72.92834496498108
Epoch: 6, Steps: 369 | Train Loss: 0.497 Vali Loss: 0.634 Vali Acc: 0.674 Test Loss: 0.634 Test Acc: 0.674
Validation loss decreased (-0.671673 --> -0.673944).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4972885
	speed: 0.7756s/iter; left time: 26824.4524s
	iters: 200, epoch: 7 | loss: 0.3614777
	speed: 0.1908s/iter; left time: 6581.4268s
	iters: 300, epoch: 7 | loss: 0.5113894
	speed: 0.1745s/iter; left time: 6002.1649s
Epoch: 7 cost time: 70.27049350738525
Epoch: 7, Steps: 369 | Train Loss: 0.471 Vali Loss: 0.660 Vali Acc: 0.673 Test Loss: 0.660 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2850621
	speed: 0.7030s/iter; left time: 24053.7702s
	iters: 200, epoch: 8 | loss: 0.5798778
	speed: 0.1647s/iter; left time: 5618.7538s
	iters: 300, epoch: 8 | loss: 0.5109143
	speed: 0.1863s/iter; left time: 6337.0237s
Epoch: 8 cost time: 67.4112958908081
Epoch: 8, Steps: 369 | Train Loss: 0.434 Vali Loss: 0.690 Vali Acc: 0.677 Test Loss: 0.690 Test Acc: 0.677
Validation loss decreased (-0.673944 --> -0.676497).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4617188
	speed: 0.7292s/iter; left time: 24683.6936s
	iters: 200, epoch: 9 | loss: 0.2816197
	speed: 0.1984s/iter; left time: 6695.8276s
	iters: 300, epoch: 9 | loss: 0.9667628
	speed: 0.1694s/iter; left time: 5700.0149s
Epoch: 9 cost time: 68.23182559013367
Epoch: 9, Steps: 369 | Train Loss: 0.409 Vali Loss: 0.666 Vali Acc: 0.669 Test Loss: 0.666 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.4899386
	speed: 0.6843s/iter; left time: 22910.8367s
	iters: 200, epoch: 10 | loss: 0.2873731
	speed: 0.1586s/iter; left time: 5295.5446s
	iters: 300, epoch: 10 | loss: 0.3187880
	speed: 0.1796s/iter; left time: 5977.5182s
Epoch: 10 cost time: 66.10566568374634
Epoch: 10, Steps: 369 | Train Loss: 0.379 Vali Loss: 0.757 Vali Acc: 0.652 Test Loss: 0.757 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2670902
	speed: 0.7293s/iter; left time: 24146.5592s
	iters: 200, epoch: 11 | loss: 0.2034151
	speed: 0.2061s/iter; left time: 6803.7460s
	iters: 300, epoch: 11 | loss: 0.3987169
	speed: 0.1934s/iter; left time: 6364.6191s
Epoch: 11 cost time: 72.63632392883301
Epoch: 11, Steps: 369 | Train Loss: 0.362 Vali Loss: 0.836 Vali Acc: 0.670 Test Loss: 0.836 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2469070
	speed: 0.6395s/iter; left time: 20937.8090s
	iters: 200, epoch: 12 | loss: 0.3336576
	speed: 0.1612s/iter; left time: 5260.7519s
	iters: 300, epoch: 12 | loss: 0.2491527
	speed: 0.1771s/iter; left time: 5762.1075s
Epoch: 12 cost time: 63.845202684402466
Epoch: 12, Steps: 369 | Train Loss: 0.329 Vali Loss: 0.890 Vali Acc: 0.649 Test Loss: 0.890 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2447085
	speed: 0.6760s/iter; left time: 21883.1045s
	iters: 200, epoch: 13 | loss: 0.3086951
	speed: 0.1780s/iter; left time: 5743.8580s
	iters: 300, epoch: 13 | loss: 0.0746367
	speed: 0.1719s/iter; left time: 5529.2217s
Epoch: 13 cost time: 65.200186252594
Epoch: 13, Steps: 369 | Train Loss: 0.300 Vali Loss: 0.737 Vali Acc: 0.678 Test Loss: 0.737 Test Acc: 0.678
Validation loss decreased (-0.676497 --> -0.677632).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.3216575
	speed: 0.6216s/iter; left time: 19893.8451s
	iters: 200, epoch: 14 | loss: 0.3655030
	speed: 0.1545s/iter; left time: 4928.3637s
	iters: 300, epoch: 14 | loss: 0.1016206
	speed: 0.1584s/iter; left time: 5036.7800s
Epoch: 14 cost time: 59.84804129600525
Epoch: 14, Steps: 369 | Train Loss: 0.277 Vali Loss: 1.058 Vali Acc: 0.640 Test Loss: 1.058 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0765309
	speed: 0.6875s/iter; left time: 21748.4011s
	iters: 200, epoch: 15 | loss: 0.2366954
	speed: 0.1743s/iter; left time: 5497.0115s
	iters: 300, epoch: 15 | loss: 0.3282094
	speed: 0.1901s/iter; left time: 5974.4837s
Epoch: 15 cost time: 65.78376054763794
Epoch: 15, Steps: 369 | Train Loss: 0.244 Vali Loss: 1.004 Vali Acc: 0.661 Test Loss: 1.004 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4967598
	speed: 0.7054s/iter; left time: 22055.3289s
	iters: 200, epoch: 16 | loss: 0.2890316
	speed: 0.1887s/iter; left time: 5880.2182s
	iters: 300, epoch: 16 | loss: 0.2077136
	speed: 0.1785s/iter; left time: 5544.4373s
Epoch: 16 cost time: 71.3002200126648
Epoch: 16, Steps: 369 | Train Loss: 0.234 Vali Loss: 1.001 Vali Acc: 0.666 Test Loss: 1.001 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0419670
	speed: 0.7123s/iter; left time: 22009.2528s
	iters: 200, epoch: 17 | loss: 0.5876216
	speed: 0.1701s/iter; left time: 5237.3872s
	iters: 300, epoch: 17 | loss: 0.0736006
	speed: 0.1679s/iter; left time: 5154.9987s
Epoch: 17 cost time: 64.70160055160522
Epoch: 17, Steps: 369 | Train Loss: 0.216 Vali Loss: 1.024 Vali Acc: 0.653 Test Loss: 1.024 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0489272
	speed: 0.6235s/iter; left time: 19032.7320s
	iters: 200, epoch: 18 | loss: 0.1014716
	speed: 0.1500s/iter; left time: 4564.2128s
	iters: 300, epoch: 18 | loss: 0.1725861
	speed: 0.1616s/iter; left time: 4901.1950s
Epoch: 18 cost time: 57.596612215042114
Epoch: 18, Steps: 369 | Train Loss: 0.175 Vali Loss: 1.133 Vali Acc: 0.660 Test Loss: 1.133 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0990999
	speed: 0.6805s/iter; left time: 20522.2217s
	iters: 200, epoch: 19 | loss: 0.1350851
	speed: 0.1648s/iter; left time: 4953.1991s
	iters: 300, epoch: 19 | loss: 0.2376411
	speed: 0.1796s/iter; left time: 5381.8604s
Epoch: 19 cost time: 65.26224565505981
Epoch: 19, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.117 Vali Acc: 0.645 Test Loss: 1.117 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0299148
	speed: 0.6604s/iter; left time: 19673.1551s
	iters: 200, epoch: 20 | loss: 0.1998115
	speed: 0.1709s/iter; left time: 5074.0155s
	iters: 300, epoch: 20 | loss: 0.0524932
	speed: 0.1888s/iter; left time: 5586.0813s
Epoch: 20 cost time: 67.8931074142456
Epoch: 20, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.258 Vali Acc: 0.656 Test Loss: 1.258 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0802996
	speed: 0.7163s/iter; left time: 21073.1014s
	iters: 200, epoch: 21 | loss: 0.2081335
	speed: 0.2046s/iter; left time: 5999.3251s
	iters: 300, epoch: 21 | loss: 0.3546994
	speed: 0.1663s/iter; left time: 4858.8827s
Epoch: 21 cost time: 69.87016296386719
Epoch: 21, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.253 Vali Acc: 0.659 Test Loss: 1.253 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0693495
	speed: 0.6959s/iter; left time: 20216.4681s
	iters: 200, epoch: 22 | loss: 0.3005717
	speed: 0.1878s/iter; left time: 5438.2059s
	iters: 300, epoch: 22 | loss: 0.1490672
	speed: 0.1860s/iter; left time: 5365.3701s
Epoch: 22 cost time: 70.69689106941223
Epoch: 22, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.544 Vali Acc: 0.653 Test Loss: 1.544 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0650779
	speed: 0.7087s/iter; left time: 20327.9196s
	iters: 200, epoch: 23 | loss: 0.0235776
	speed: 0.1821s/iter; left time: 5204.7546s
	iters: 300, epoch: 23 | loss: 0.6274964
	speed: 0.1773s/iter; left time: 5049.5404s
Epoch: 23 cost time: 66.6778404712677
Epoch: 23, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.472 Vali Acc: 0.654 Test Loss: 1.472 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.677639046538025
model parameter : 271582
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7669179
	speed: 0.1998s/iter; left time: 7353.6813s
	iters: 200, epoch: 1 | loss: 0.9420941
	speed: 0.1551s/iter; left time: 5691.0918s
	iters: 300, epoch: 1 | loss: 0.5751114
	speed: 0.1924s/iter; left time: 7040.3256s
Epoch: 1 cost time: 67.83834981918335
Epoch: 1, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.672 Vali Acc: 0.637 Test Loss: 0.672 Test Acc: 0.637
Validation loss decreased (inf --> -0.636770).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6520723
	speed: 0.7023s/iter; left time: 25585.0987s
	iters: 200, epoch: 2 | loss: 0.5468436
	speed: 0.1616s/iter; left time: 5872.1045s
	iters: 300, epoch: 2 | loss: 0.7984880
	speed: 0.1895s/iter; left time: 6867.0951s
Epoch: 2 cost time: 67.61288237571716
Epoch: 2, Steps: 369 | Train Loss: 0.631 Vali Loss: 0.743 Vali Acc: 0.670 Test Loss: 0.743 Test Acc: 0.670
Validation loss decreased (-0.636770 --> -0.669686).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7376965
	speed: 0.6776s/iter; left time: 24437.8669s
	iters: 200, epoch: 3 | loss: 0.3952609
	speed: 0.1703s/iter; left time: 6124.9869s
	iters: 300, epoch: 3 | loss: 0.3538707
	speed: 0.1580s/iter; left time: 5667.1555s
Epoch: 3 cost time: 63.52458620071411
Epoch: 3, Steps: 369 | Train Loss: 0.587 Vali Loss: 0.707 Vali Acc: 0.654 Test Loss: 0.707 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5112596
	speed: 0.6795s/iter; left time: 24252.3516s
	iters: 200, epoch: 4 | loss: 0.5748395
	speed: 0.1824s/iter; left time: 6492.0395s
	iters: 300, epoch: 4 | loss: 0.7030968
	speed: 0.1638s/iter; left time: 5813.9105s
Epoch: 4 cost time: 65.80665016174316
Epoch: 4, Steps: 369 | Train Loss: 0.565 Vali Loss: 0.669 Vali Acc: 0.684 Test Loss: 0.669 Test Acc: 0.684
Validation loss decreased (-0.669686 --> -0.683591).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6444324
	speed: 0.6879s/iter; left time: 24299.9189s
	iters: 200, epoch: 5 | loss: 0.5085933
	speed: 0.1651s/iter; left time: 5815.1365s
	iters: 300, epoch: 5 | loss: 0.4747937
	speed: 0.1720s/iter; left time: 6041.3006s
Epoch: 5 cost time: 65.32795429229736
Epoch: 5, Steps: 369 | Train Loss: 0.532 Vali Loss: 0.675 Vali Acc: 0.662 Test Loss: 0.675 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2344293
	speed: 0.6719s/iter; left time: 23487.7663s
	iters: 200, epoch: 6 | loss: 0.3992699
	speed: 0.1729s/iter; left time: 6027.1198s
	iters: 300, epoch: 6 | loss: 0.4075390
	speed: 0.1752s/iter; left time: 6090.7146s
Epoch: 6 cost time: 66.6598174571991
Epoch: 6, Steps: 369 | Train Loss: 0.507 Vali Loss: 0.620 Vali Acc: 0.686 Test Loss: 0.620 Test Acc: 0.686
Validation loss decreased (-0.683591 --> -0.685578).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2749826
	speed: 0.6874s/iter; left time: 23775.7823s
	iters: 200, epoch: 7 | loss: 0.4560676
	speed: 0.1922s/iter; left time: 6627.1467s
	iters: 300, epoch: 7 | loss: 0.3354560
	speed: 0.2027s/iter; left time: 6970.7198s
Epoch: 7 cost time: 71.79042339324951
Epoch: 7, Steps: 369 | Train Loss: 0.464 Vali Loss: 0.823 Vali Acc: 0.631 Test Loss: 0.823 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3197786
	speed: 0.6631s/iter; left time: 22688.6231s
	iters: 200, epoch: 8 | loss: 0.7395515
	speed: 0.1865s/iter; left time: 6363.8315s
	iters: 300, epoch: 8 | loss: 0.4558962
	speed: 0.1846s/iter; left time: 6278.4787s
Epoch: 8 cost time: 67.51150941848755
Epoch: 8, Steps: 369 | Train Loss: 0.436 Vali Loss: 0.694 Vali Acc: 0.683 Test Loss: 0.694 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5791796
	speed: 0.6943s/iter; left time: 23500.4142s
	iters: 200, epoch: 9 | loss: 0.3604221
	speed: 0.1721s/iter; left time: 5809.6917s
	iters: 300, epoch: 9 | loss: 0.5884697
	speed: 0.1520s/iter; left time: 5113.6296s
Epoch: 9 cost time: 65.47312998771667
Epoch: 9, Steps: 369 | Train Loss: 0.407 Vali Loss: 0.647 Vali Acc: 0.666 Test Loss: 0.647 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4732209
	speed: 0.6982s/iter; left time: 23376.0832s
	iters: 200, epoch: 10 | loss: 0.3636430
	speed: 0.1825s/iter; left time: 6091.4292s
	iters: 300, epoch: 10 | loss: 0.4185711
	speed: 0.1736s/iter; left time: 5776.4305s
Epoch: 10 cost time: 68.9054343700409
Epoch: 10, Steps: 369 | Train Loss: 0.365 Vali Loss: 0.762 Vali Acc: 0.668 Test Loss: 0.762 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5270504
	speed: 0.6991s/iter; left time: 23148.9880s
	iters: 200, epoch: 11 | loss: 0.4430016
	speed: 0.1683s/iter; left time: 5556.9931s
	iters: 300, epoch: 11 | loss: 0.2214516
	speed: 0.1815s/iter; left time: 5973.1349s
Epoch: 11 cost time: 67.59971189498901
Epoch: 11, Steps: 369 | Train Loss: 0.336 Vali Loss: 0.871 Vali Acc: 0.642 Test Loss: 0.871 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.3417857
	speed: 0.6644s/iter; left time: 21755.1135s
	iters: 200, epoch: 12 | loss: 0.3273527
	speed: 0.1516s/iter; left time: 4949.9230s
	iters: 300, epoch: 12 | loss: 0.1893562
	speed: 0.1832s/iter; left time: 5961.8649s
Epoch: 12 cost time: 64.18932843208313
Epoch: 12, Steps: 369 | Train Loss: 0.324 Vali Loss: 0.831 Vali Acc: 0.654 Test Loss: 0.831 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1930096
	speed: 0.6986s/iter; left time: 22615.1371s
	iters: 200, epoch: 13 | loss: 0.2478508
	speed: 0.1790s/iter; left time: 5776.4242s
	iters: 300, epoch: 13 | loss: 0.3228724
	speed: 0.1901s/iter; left time: 6117.5387s
Epoch: 13 cost time: 69.18491530418396
Epoch: 13, Steps: 369 | Train Loss: 0.294 Vali Loss: 0.775 Vali Acc: 0.657 Test Loss: 0.775 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2526639
	speed: 0.7456s/iter; left time: 23862.5296s
	iters: 200, epoch: 14 | loss: 0.2457046
	speed: 0.1776s/iter; left time: 5667.0912s
	iters: 300, epoch: 14 | loss: 0.3152097
	speed: 0.1666s/iter; left time: 5297.6243s
Epoch: 14 cost time: 67.39668798446655
Epoch: 14, Steps: 369 | Train Loss: 0.267 Vali Loss: 1.010 Vali Acc: 0.655 Test Loss: 1.010 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0938653
	speed: 0.7050s/iter; left time: 22302.4608s
	iters: 200, epoch: 15 | loss: 0.1559426
	speed: 0.1888s/iter; left time: 5952.8079s
	iters: 300, epoch: 15 | loss: 0.1664324
	speed: 0.1927s/iter; left time: 6057.5296s
Epoch: 15 cost time: 71.19911670684814
Epoch: 15, Steps: 369 | Train Loss: 0.241 Vali Loss: 1.057 Vali Acc: 0.643 Test Loss: 1.057 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.1491874
	speed: 0.6878s/iter; left time: 21504.2275s
	iters: 200, epoch: 16 | loss: 0.2465895
	speed: 0.1873s/iter; left time: 5836.6223s
	iters: 300, epoch: 16 | loss: 0.0310598
	speed: 0.1754s/iter; left time: 5448.5249s
Epoch: 16 cost time: 67.5532956123352
Epoch: 16, Steps: 369 | Train Loss: 0.224 Vali Loss: 1.042 Vali Acc: 0.643 Test Loss: 1.042 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6855845629965948
model parameter : 271198
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7096527
	speed: 0.2019s/iter; left time: 7429.8866s
	iters: 200, epoch: 1 | loss: 0.6859390
	speed: 0.1864s/iter; left time: 6841.9999s
	iters: 300, epoch: 1 | loss: 0.5532413
	speed: 0.1763s/iter; left time: 6453.5875s
Epoch: 1 cost time: 70.41162276268005
Epoch: 1, Steps: 369 | Train Loss: 0.687 Vali Loss: 0.687 Vali Acc: 0.650 Test Loss: 0.687 Test Acc: 0.650
Validation loss decreased (inf --> -0.650390).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5571216
	speed: 0.7109s/iter; left time: 25899.3054s
	iters: 200, epoch: 2 | loss: 0.6940222
	speed: 0.1527s/iter; left time: 5546.6098s
	iters: 300, epoch: 2 | loss: 0.5927828
	speed: 0.1576s/iter; left time: 5711.3559s
Epoch: 2 cost time: 59.036234855651855
Epoch: 2, Steps: 369 | Train Loss: 0.649 Vali Loss: 0.735 Vali Acc: 0.627 Test Loss: 0.735 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5081484
	speed: 0.5767s/iter; left time: 20797.8847s
	iters: 200, epoch: 3 | loss: 0.5197352
	speed: 0.1620s/iter; left time: 5827.4700s
	iters: 300, epoch: 3 | loss: 1.4110787
	speed: 0.1647s/iter; left time: 5906.0601s
Epoch: 3 cost time: 59.62730693817139
Epoch: 3, Steps: 369 | Train Loss: 0.589 Vali Loss: 0.677 Vali Acc: 0.663 Test Loss: 0.677 Test Acc: 0.663
Validation loss decreased (-0.650390 --> -0.663160).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4490139
	speed: 0.6172s/iter; left time: 22031.6703s
	iters: 200, epoch: 4 | loss: 0.6314492
	speed: 0.1507s/iter; left time: 5362.6272s
	iters: 300, epoch: 4 | loss: 0.4061323
	speed: 0.1409s/iter; left time: 5002.6562s
Epoch: 4 cost time: 55.629698753356934
Epoch: 4, Steps: 369 | Train Loss: 0.545 Vali Loss: 0.642 Vali Acc: 0.678 Test Loss: 0.642 Test Acc: 0.678
Validation loss decreased (-0.663160 --> -0.677916).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8275287
	speed: 0.5571s/iter; left time: 19681.1645s
	iters: 200, epoch: 5 | loss: 0.3455928
	speed: 0.1382s/iter; left time: 4867.3507s
	iters: 300, epoch: 5 | loss: 0.4951875
	speed: 0.1391s/iter; left time: 4886.6059s
Epoch: 5 cost time: 54.81994700431824
Epoch: 5, Steps: 369 | Train Loss: 0.519 Vali Loss: 0.620 Vali Acc: 0.684 Test Loss: 0.620 Test Acc: 0.684
Validation loss decreased (-0.677916 --> -0.684443).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2646150
	speed: 0.6093s/iter; left time: 21300.1299s
	iters: 200, epoch: 6 | loss: 0.3906822
	speed: 0.1454s/iter; left time: 5069.6374s
	iters: 300, epoch: 6 | loss: 0.6905888
	speed: 0.1458s/iter; left time: 5066.4969s
Epoch: 6 cost time: 57.21176767349243
Epoch: 6, Steps: 369 | Train Loss: 0.479 Vali Loss: 0.683 Vali Acc: 0.680 Test Loss: 0.683 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2906885
	speed: 0.6306s/iter; left time: 21809.7848s
	iters: 200, epoch: 7 | loss: 0.4793128
	speed: 0.1740s/iter; left time: 5999.2249s
	iters: 300, epoch: 7 | loss: 0.4059837
	speed: 0.1813s/iter; left time: 6235.1855s
Epoch: 7 cost time: 65.8735613822937
Epoch: 7, Steps: 369 | Train Loss: 0.446 Vali Loss: 0.678 Vali Acc: 0.669 Test Loss: 0.678 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.5030442
	speed: 0.6413s/iter; left time: 21943.6125s
	iters: 200, epoch: 8 | loss: 0.1165788
	speed: 0.1647s/iter; left time: 5619.8640s
	iters: 300, epoch: 8 | loss: 0.3538480
	speed: 0.1721s/iter; left time: 5854.7597s
Epoch: 8 cost time: 63.645243406295776
Epoch: 8, Steps: 369 | Train Loss: 0.420 Vali Loss: 0.647 Vali Acc: 0.670 Test Loss: 0.647 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3652204
	speed: 0.6609s/iter; left time: 22370.1243s
	iters: 200, epoch: 9 | loss: 0.3683338
	speed: 0.1630s/iter; left time: 5502.2906s
	iters: 300, epoch: 9 | loss: 0.4468622
	speed: 0.1786s/iter; left time: 6009.5995s
Epoch: 9 cost time: 64.07957315444946
Epoch: 9, Steps: 369 | Train Loss: 0.391 Vali Loss: 0.666 Vali Acc: 0.669 Test Loss: 0.666 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4263381
	speed: 0.7055s/iter; left time: 23618.9843s
	iters: 200, epoch: 10 | loss: 0.4522518
	speed: 0.1833s/iter; left time: 6118.6187s
	iters: 300, epoch: 10 | loss: 0.1425066
	speed: 0.1866s/iter; left time: 6209.9283s
Epoch: 10 cost time: 71.12139058113098
Epoch: 10, Steps: 369 | Train Loss: 0.363 Vali Loss: 0.724 Vali Acc: 0.665 Test Loss: 0.724 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1737070
	speed: 0.6892s/iter; left time: 22818.7401s
	iters: 200, epoch: 11 | loss: 0.3283992
	speed: 0.1810s/iter; left time: 5976.5182s
	iters: 300, epoch: 11 | loss: 0.2536192
	speed: 0.1630s/iter; left time: 5365.3386s
Epoch: 11 cost time: 65.13102746009827
Epoch: 11, Steps: 369 | Train Loss: 0.336 Vali Loss: 0.802 Vali Acc: 0.655 Test Loss: 0.802 Test Acc: 0.655
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1476951
	speed: 0.7082s/iter; left time: 23187.9371s
	iters: 200, epoch: 12 | loss: 0.1283092
	speed: 0.2006s/iter; left time: 6547.8291s
	iters: 300, epoch: 12 | loss: 0.2017110
	speed: 0.1708s/iter; left time: 5557.4651s
Epoch: 12 cost time: 69.23778676986694
Epoch: 12, Steps: 369 | Train Loss: 0.296 Vali Loss: 0.905 Vali Acc: 0.672 Test Loss: 0.905 Test Acc: 0.672
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.5207567
	speed: 0.6709s/iter; left time: 21718.6654s
	iters: 200, epoch: 13 | loss: 0.2072092
	speed: 0.1512s/iter; left time: 4879.7337s
	iters: 300, epoch: 13 | loss: 0.2037904
	speed: 0.1709s/iter; left time: 5499.7463s
Epoch: 13 cost time: 64.44992256164551
Epoch: 13, Steps: 369 | Train Loss: 0.276 Vali Loss: 0.919 Vali Acc: 0.666 Test Loss: 0.919 Test Acc: 0.666
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.2094018
	speed: 0.7137s/iter; left time: 22840.5348s
	iters: 200, epoch: 14 | loss: 0.2922211
	speed: 0.1831s/iter; left time: 5840.8436s
	iters: 300, epoch: 14 | loss: 0.3798461
	speed: 0.1775s/iter; left time: 5644.2908s
Epoch: 14 cost time: 70.20202851295471
Epoch: 14, Steps: 369 | Train Loss: 0.240 Vali Loss: 0.970 Vali Acc: 0.654 Test Loss: 0.970 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.2158032
	speed: 0.7075s/iter; left time: 22382.1202s
	iters: 200, epoch: 15 | loss: 0.3269230
	speed: 0.1946s/iter; left time: 6137.3072s
	iters: 300, epoch: 15 | loss: 0.1581480
	speed: 0.1807s/iter; left time: 5680.4784s
Epoch: 15 cost time: 69.24879860877991
Epoch: 15, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.075 Vali Acc: 0.664 Test Loss: 1.075 Test Acc: 0.664
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.684449489216799
model parameter : 270814
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7869856
	speed: 0.2152s/iter; left time: 7919.6457s
	iters: 200, epoch: 1 | loss: 0.8789647
	speed: 0.1768s/iter; left time: 6488.7060s
	iters: 300, epoch: 1 | loss: 0.7330694
	speed: 0.1603s/iter; left time: 5866.5538s
Epoch: 1 cost time: 66.19988942146301
Epoch: 1, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.649 Vali Acc: 0.646 Test Loss: 0.649 Test Acc: 0.646
Validation loss decreased (inf --> -0.646134).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6228605
	speed: 0.5669s/iter; left time: 20652.8013s
	iters: 200, epoch: 2 | loss: 0.9035157
	speed: 0.1352s/iter; left time: 4912.5241s
	iters: 300, epoch: 2 | loss: 0.5787283
	speed: 0.1662s/iter; left time: 6022.4514s
Epoch: 2 cost time: 57.14955472946167
Epoch: 2, Steps: 369 | Train Loss: 0.611 Vali Loss: 0.657 Vali Acc: 0.658 Test Loss: 0.657 Test Acc: 0.658
Validation loss decreased (-0.646134 --> -0.657769).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4610492
	speed: 0.5993s/iter; left time: 21613.9087s
	iters: 200, epoch: 3 | loss: 0.6167603
	speed: 0.1581s/iter; left time: 5686.3217s
	iters: 300, epoch: 3 | loss: 0.5715973
	speed: 0.1474s/iter; left time: 5284.4314s
Epoch: 3 cost time: 59.141886472702026
Epoch: 3, Steps: 369 | Train Loss: 0.585 Vali Loss: 0.884 Vali Acc: 0.591 Test Loss: 0.884 Test Acc: 0.591
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5471116
	speed: 0.6555s/iter; left time: 23395.7097s
	iters: 200, epoch: 4 | loss: 0.3467339
	speed: 0.1763s/iter; left time: 6273.5414s
	iters: 300, epoch: 4 | loss: 0.4395025
	speed: 0.1805s/iter; left time: 6407.1774s
Epoch: 4 cost time: 69.30931949615479
Epoch: 4, Steps: 369 | Train Loss: 0.571 Vali Loss: 0.853 Vali Acc: 0.633 Test Loss: 0.853 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6353106
	speed: 0.6906s/iter; left time: 24393.7638s
	iters: 200, epoch: 5 | loss: 0.7381359
	speed: 0.1954s/iter; left time: 6883.4506s
	iters: 300, epoch: 5 | loss: 0.3965048
	speed: 0.1677s/iter; left time: 5890.9340s
Epoch: 5 cost time: 67.69005417823792
Epoch: 5, Steps: 369 | Train Loss: 0.529 Vali Loss: 0.791 Vali Acc: 0.622 Test Loss: 0.791 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6573610
	speed: 0.7160s/iter; left time: 25028.3332s
	iters: 200, epoch: 6 | loss: 0.7037275
	speed: 0.1929s/iter; left time: 6725.1067s
	iters: 300, epoch: 6 | loss: 0.6167040
	speed: 0.1934s/iter; left time: 6722.0912s
Epoch: 6 cost time: 72.32482504844666
Epoch: 6, Steps: 369 | Train Loss: 0.491 Vali Loss: 0.670 Vali Acc: 0.664 Test Loss: 0.670 Test Acc: 0.664
Validation loss decreased (-0.657769 --> -0.664295).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2886208
	speed: 0.6999s/iter; left time: 24207.1415s
	iters: 200, epoch: 7 | loss: 0.4870138
	speed: 0.1703s/iter; left time: 5873.8019s
	iters: 300, epoch: 7 | loss: 0.2929589
	speed: 0.1715s/iter; left time: 5897.7632s
Epoch: 7 cost time: 64.7205548286438
Epoch: 7, Steps: 369 | Train Loss: 0.456 Vali Loss: 0.623 Vali Acc: 0.681 Test Loss: 0.623 Test Acc: 0.681
Validation loss decreased (-0.664295 --> -0.681322).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2789739
	speed: 0.6956s/iter; left time: 23802.9189s
	iters: 200, epoch: 8 | loss: 0.4857371
	speed: 0.1909s/iter; left time: 6511.5147s
	iters: 300, epoch: 8 | loss: 0.4935166
	speed: 0.1822s/iter; left time: 6197.5994s
Epoch: 8 cost time: 68.4813756942749
Epoch: 8, Steps: 369 | Train Loss: 0.430 Vali Loss: 0.670 Vali Acc: 0.673 Test Loss: 0.670 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2280033
	speed: 0.6962s/iter; left time: 23565.7076s
	iters: 200, epoch: 9 | loss: 0.3194595
	speed: 0.1591s/iter; left time: 5370.9417s
	iters: 300, epoch: 9 | loss: 0.1631699
	speed: 0.1396s/iter; left time: 4697.4786s
Epoch: 9 cost time: 58.84723353385925
Epoch: 9, Steps: 369 | Train Loss: 0.408 Vali Loss: 0.756 Vali Acc: 0.653 Test Loss: 0.756 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.4903760
	speed: 0.5612s/iter; left time: 18787.4280s
	iters: 200, epoch: 10 | loss: 0.6256899
	speed: 0.1580s/iter; left time: 5275.0109s
	iters: 300, epoch: 10 | loss: 0.5244823
	speed: 0.1562s/iter; left time: 5199.3005s
Epoch: 10 cost time: 59.94557476043701
Epoch: 10, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.790 Vali Acc: 0.660 Test Loss: 0.790 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2826594
	speed: 0.5730s/iter; left time: 18973.2412s
	iters: 200, epoch: 11 | loss: 0.2993564
	speed: 0.1478s/iter; left time: 4879.6232s
	iters: 300, epoch: 11 | loss: 0.3588490
	speed: 0.1463s/iter; left time: 4813.4004s
Epoch: 11 cost time: 54.0127956867218
Epoch: 11, Steps: 369 | Train Loss: 0.347 Vali Loss: 0.719 Vali Acc: 0.650 Test Loss: 0.719 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2756276
	speed: 0.5690s/iter; left time: 18629.7030s
	iters: 200, epoch: 12 | loss: 0.2919259
	speed: 0.1536s/iter; left time: 5014.7599s
	iters: 300, epoch: 12 | loss: 0.1630246
	speed: 0.1509s/iter; left time: 4910.3291s
Epoch: 12 cost time: 57.64022779464722
Epoch: 12, Steps: 369 | Train Loss: 0.324 Vali Loss: 0.853 Vali Acc: 0.651 Test Loss: 0.853 Test Acc: 0.651
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2637204
	speed: 0.6078s/iter; left time: 19675.2029s
	iters: 200, epoch: 13 | loss: 0.5604717
	speed: 0.1629s/iter; left time: 5258.2721s
	iters: 300, epoch: 13 | loss: 0.1483320
	speed: 0.1654s/iter; left time: 5322.3457s
Epoch: 13 cost time: 61.98820638656616
Epoch: 13, Steps: 369 | Train Loss: 0.293 Vali Loss: 0.855 Vali Acc: 0.661 Test Loss: 0.855 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1435366
	speed: 0.6098s/iter; left time: 19516.9529s
	iters: 200, epoch: 14 | loss: 0.1882858
	speed: 0.1422s/iter; left time: 4535.1836s
	iters: 300, epoch: 14 | loss: 0.2503355
	speed: 0.1577s/iter; left time: 5016.4986s
Epoch: 14 cost time: 57.08425498008728
Epoch: 14, Steps: 369 | Train Loss: 0.270 Vali Loss: 0.956 Vali Acc: 0.659 Test Loss: 0.956 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1952171
	speed: 0.5820s/iter; left time: 18411.5076s
	iters: 200, epoch: 15 | loss: 0.3560501
	speed: 0.1518s/iter; left time: 4786.3817s
	iters: 300, epoch: 15 | loss: 0.2449218
	speed: 0.1421s/iter; left time: 4466.3076s
Epoch: 15 cost time: 54.85089993476868
Epoch: 15, Steps: 369 | Train Loss: 0.242 Vali Loss: 1.030 Vali Acc: 0.644 Test Loss: 1.030 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1896410
	speed: 0.5520s/iter; left time: 17259.1033s
	iters: 200, epoch: 16 | loss: 0.4683853
	speed: 0.1404s/iter; left time: 4375.6423s
	iters: 300, epoch: 16 | loss: 0.2762458
	speed: 0.1353s/iter; left time: 4202.8284s
Epoch: 16 cost time: 52.54386234283447
Epoch: 16, Steps: 369 | Train Loss: 0.219 Vali Loss: 1.090 Vali Acc: 0.659 Test Loss: 1.090 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.1542529
	speed: 0.6012s/iter; left time: 18575.8429s
	iters: 200, epoch: 17 | loss: 0.0804806
	speed: 0.1651s/iter; left time: 5085.5089s
	iters: 300, epoch: 17 | loss: 0.0973409
	speed: 0.1646s/iter; left time: 5053.6245s
Epoch: 17 cost time: 61.311434745788574
Epoch: 17, Steps: 369 | Train Loss: 0.212 Vali Loss: 0.944 Vali Acc: 0.657 Test Loss: 0.944 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6813280363223609
model parameter : 270430
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4252861
	speed: 0.2807s/iter; left time: 10329.5256s
	iters: 200, epoch: 1 | loss: 0.6140440
	speed: 0.1840s/iter; left time: 6754.0215s
	iters: 300, epoch: 1 | loss: 0.8687097
	speed: 0.2191s/iter; left time: 8020.2349s
Epoch: 1 cost time: 83.07798528671265
Epoch: 1, Steps: 369 | Train Loss: 1.112 Vali Loss: 1.858 Vali Acc: 0.500 Test Loss: 1.858 Test Acc: 0.500
Validation loss decreased (inf --> -0.499981).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5581910
	speed: 0.7985s/iter; left time: 29089.3858s
	iters: 200, epoch: 2 | loss: 2.1990433
	speed: 0.2149s/iter; left time: 7807.6175s
	iters: 300, epoch: 2 | loss: 0.9853253
	speed: 0.2242s/iter; left time: 8124.6948s
Epoch: 2 cost time: 78.50173711776733
Epoch: 2, Steps: 369 | Train Loss: 0.987 Vali Loss: 0.951 Vali Acc: 0.500 Test Loss: 0.951 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499990).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8607489
	speed: 0.7825s/iter; left time: 28219.7386s
	iters: 200, epoch: 3 | loss: 2.8092644
	speed: 0.1873s/iter; left time: 6735.5058s
	iters: 300, epoch: 3 | loss: 0.8485667
	speed: 0.1979s/iter; left time: 7096.4795s
Epoch: 3 cost time: 73.51649689674377
Epoch: 3, Steps: 369 | Train Loss: 1.129 Vali Loss: 1.870 Vali Acc: 0.500 Test Loss: 1.870 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7473609
	speed: 0.8047s/iter; left time: 28721.3171s
	iters: 200, epoch: 4 | loss: 0.9601411
	speed: 0.2223s/iter; left time: 7911.0026s
	iters: 300, epoch: 4 | loss: 1.1338067
	speed: 0.2049s/iter; left time: 7271.1953s
Epoch: 4 cost time: 78.12329888343811
Epoch: 4, Steps: 369 | Train Loss: 1.039 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499993).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8501096
	speed: 0.7959s/iter; left time: 28113.6613s
	iters: 200, epoch: 5 | loss: 0.8636931
	speed: 0.1852s/iter; left time: 6524.9596s
	iters: 300, epoch: 5 | loss: 0.7749497
	speed: 0.1745s/iter; left time: 6128.1772s
Epoch: 5 cost time: 73.64037728309631
Epoch: 5, Steps: 369 | Train Loss: 1.081 Vali Loss: 2.649 Vali Acc: 0.500 Test Loss: 2.649 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7468654
	speed: 0.7747s/iter; left time: 27080.7838s
	iters: 200, epoch: 6 | loss: 0.7400880
	speed: 0.1870s/iter; left time: 6516.6480s
	iters: 300, epoch: 6 | loss: 0.7046561
	speed: 0.1791s/iter; left time: 6224.0851s
Epoch: 6 cost time: 71.38601779937744
Epoch: 6, Steps: 369 | Train Loss: 0.838 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.5747362
	speed: 0.7626s/iter; left time: 26376.3379s
	iters: 200, epoch: 7 | loss: 0.6808243
	speed: 0.1730s/iter; left time: 5966.8161s
	iters: 300, epoch: 7 | loss: 0.7212386
	speed: 0.1989s/iter; left time: 6839.4566s
Epoch: 7 cost time: 72.39559316635132
Epoch: 7, Steps: 369 | Train Loss: 0.754 Vali Loss: 0.810 Vali Acc: 0.500 Test Loss: 0.810 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.7103161
	speed: 0.8012s/iter; left time: 27415.2484s
	iters: 200, epoch: 8 | loss: 0.6839436
	speed: 0.1848s/iter; left time: 6304.7258s
	iters: 300, epoch: 8 | loss: 0.7088038
	speed: 0.2024s/iter; left time: 6884.5193s
Epoch: 8 cost time: 71.52887463569641
Epoch: 8, Steps: 369 | Train Loss: 0.730 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6549965
	speed: 0.7930s/iter; left time: 26841.0856s
	iters: 200, epoch: 9 | loss: 0.7386339
	speed: 0.2105s/iter; left time: 7102.5044s
	iters: 300, epoch: 9 | loss: 0.6701317
	speed: 0.1885s/iter; left time: 6342.7166s
Epoch: 9 cost time: 76.42134761810303
Epoch: 9, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6575385
	speed: 0.7536s/iter; left time: 25228.9882s
	iters: 200, epoch: 10 | loss: 0.7212692
	speed: 0.1747s/iter; left time: 5831.5972s
	iters: 300, epoch: 10 | loss: 0.7128752
	speed: 0.2169s/iter; left time: 7219.8232s
Epoch: 10 cost time: 71.63665628433228
Epoch: 10, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.7581395
	speed: 0.7989s/iter; left time: 26450.7633s
	iters: 200, epoch: 11 | loss: 0.6663249
	speed: 0.1931s/iter; left time: 6374.3318s
	iters: 300, epoch: 11 | loss: 0.6946672
	speed: 0.1810s/iter; left time: 5956.1662s
Epoch: 11 cost time: 72.5125424861908
Epoch: 11, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.7549720
	speed: 0.8395s/iter; left time: 27487.3202s
	iters: 200, epoch: 12 | loss: 0.6922783
	speed: 0.2140s/iter; left time: 6985.0966s
	iters: 300, epoch: 12 | loss: 0.7312664
	speed: 0.1914s/iter; left time: 6227.9510s
Epoch: 12 cost time: 78.53183269500732
Epoch: 12, Steps: 369 | Train Loss: 0.719 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.7687095
	speed: 0.7704s/iter; left time: 24941.3626s
	iters: 200, epoch: 13 | loss: 0.7460394
	speed: 0.1926s/iter; left time: 6216.4926s
	iters: 300, epoch: 13 | loss: 0.7640419
	speed: 0.2060s/iter; left time: 6627.7893s
Epoch: 13 cost time: 74.63187074661255
Epoch: 13, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.7237583
	speed: 0.8021s/iter; left time: 25670.3391s
	iters: 200, epoch: 14 | loss: 0.6795344
	speed: 0.1770s/iter; left time: 5647.7837s
	iters: 300, epoch: 14 | loss: 0.6648915
	speed: 0.1746s/iter; left time: 5551.5705s
Epoch: 14 cost time: 68.92541408538818
Epoch: 14, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 11465266
model size : 48.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6653344
	speed: 0.2497s/iter; left time: 9188.4988s
	iters: 200, epoch: 1 | loss: 0.9798959
	speed: 0.1968s/iter; left time: 7221.2353s
	iters: 300, epoch: 1 | loss: 0.4670042
	speed: 0.2135s/iter; left time: 7814.4356s
Epoch: 1 cost time: 79.75175452232361
Epoch: 1, Steps: 369 | Train Loss: 1.073 Vali Loss: 0.827 Vali Acc: 0.537 Test Loss: 0.827 Test Acc: 0.537
Validation loss decreased (inf --> -0.537165).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2657144
	speed: 0.7671s/iter; left time: 27946.1340s
	iters: 200, epoch: 2 | loss: 1.5807569
	speed: 0.2372s/iter; left time: 8619.0296s
	iters: 300, epoch: 2 | loss: 1.2464112
	speed: 0.2140s/iter; left time: 7752.0257s
Epoch: 2 cost time: 79.35453081130981
Epoch: 2, Steps: 369 | Train Loss: 0.953 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.4466037
	speed: 0.7319s/iter; left time: 26394.0224s
	iters: 200, epoch: 3 | loss: 1.1184716
	speed: 0.1892s/iter; left time: 6804.7433s
	iters: 300, epoch: 3 | loss: 1.3810565
	speed: 0.1875s/iter; left time: 6725.0758s
Epoch: 3 cost time: 66.9170446395874
Epoch: 3, Steps: 369 | Train Loss: 0.980 Vali Loss: 0.931 Vali Acc: 0.500 Test Loss: 0.931 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7160292
	speed: 0.7938s/iter; left time: 28332.4506s
	iters: 200, epoch: 4 | loss: 0.7411349
	speed: 0.1911s/iter; left time: 6800.2561s
	iters: 300, epoch: 4 | loss: 0.9321470
	speed: 0.1839s/iter; left time: 6525.9084s
Epoch: 4 cost time: 74.1838755607605
Epoch: 4, Steps: 369 | Train Loss: 0.952 Vali Loss: 0.872 Vali Acc: 0.500 Test Loss: 0.872 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8017402
	speed: 0.7952s/iter; left time: 28090.3829s
	iters: 200, epoch: 5 | loss: 2.6820900
	speed: 0.2407s/iter; left time: 8478.0672s
	iters: 300, epoch: 5 | loss: 0.7365597
	speed: 0.2530s/iter; left time: 8888.2981s
Epoch: 5 cost time: 86.58916306495667
Epoch: 5, Steps: 369 | Train Loss: 0.924 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7120793
	speed: 0.7888s/iter; left time: 27572.2705s
	iters: 200, epoch: 6 | loss: 0.7592626
	speed: 0.2326s/iter; left time: 8107.2579s
	iters: 300, epoch: 6 | loss: 0.8338734
	speed: 0.2185s/iter; left time: 7594.9500s
Epoch: 6 cost time: 83.13458514213562
Epoch: 6, Steps: 369 | Train Loss: 0.761 Vali Loss: 0.922 Vali Acc: 0.500 Test Loss: 0.922 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7778167
	speed: 0.8547s/iter; left time: 29562.8283s
	iters: 200, epoch: 7 | loss: 0.7264307
	speed: 0.2211s/iter; left time: 7625.2297s
	iters: 300, epoch: 7 | loss: 0.6915189
	speed: 0.1891s/iter; left time: 6502.1483s
Epoch: 7 cost time: 81.85363936424255
Epoch: 7, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7381887
	speed: 0.8286s/iter; left time: 28354.2653s
	iters: 200, epoch: 8 | loss: 0.8110687
	speed: 0.1990s/iter; left time: 6790.5554s
	iters: 300, epoch: 8 | loss: 0.6999990
	speed: 0.2269s/iter; left time: 7717.5533s
Epoch: 8 cost time: 79.52327942848206
Epoch: 8, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.782 Vali Acc: 0.500 Test Loss: 0.782 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6739321
	speed: 0.8354s/iter; left time: 28278.1879s
	iters: 200, epoch: 9 | loss: 0.7404114
	speed: 0.2187s/iter; left time: 7379.5549s
	iters: 300, epoch: 9 | loss: 0.7281902
	speed: 0.2071s/iter; left time: 6970.1119s
Epoch: 9 cost time: 76.10296893119812
Epoch: 9, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6899394
	speed: 0.8181s/iter; left time: 27391.0599s
	iters: 200, epoch: 10 | loss: 0.5989667
	speed: 0.2242s/iter; left time: 7483.2284s
	iters: 300, epoch: 10 | loss: 0.6016850
	speed: 0.2188s/iter; left time: 7281.4393s
Epoch: 10 cost time: 84.23041248321533
Epoch: 10, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6665344
	speed: 0.8018s/iter; left time: 26548.5928s
	iters: 200, epoch: 11 | loss: 0.6884300
	speed: 0.2044s/iter; left time: 6748.2667s
	iters: 300, epoch: 11 | loss: 0.7012416
	speed: 0.2364s/iter; left time: 7779.2131s
Epoch: 11 cost time: 84.76230001449585
Epoch: 11, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5371736662883088
model parameter : 11462450
model size : 48.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6815495
	speed: 0.2444s/iter; left time: 8995.4202s
	iters: 200, epoch: 1 | loss: 0.7816645
	speed: 0.2430s/iter; left time: 8917.9545s
	iters: 300, epoch: 1 | loss: 0.3504289
	speed: 0.2200s/iter; left time: 8050.8769s
Epoch: 1 cost time: 87.81175923347473
Epoch: 1, Steps: 369 | Train Loss: 1.262 Vali Loss: 1.031 Vali Acc: 0.526 Test Loss: 1.031 Test Acc: 0.526
Validation loss decreased (inf --> -0.526380).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4834850
	speed: 0.8604s/iter; left time: 31345.4635s
	iters: 200, epoch: 2 | loss: 1.4099340
	speed: 0.2108s/iter; left time: 7659.0305s
	iters: 300, epoch: 2 | loss: 0.7015912
	speed: 0.2100s/iter; left time: 7610.2358s
Epoch: 2 cost time: 80.98204255104065
Epoch: 2, Steps: 369 | Train Loss: 0.837 Vali Loss: 0.669 Vali Acc: 0.616 Test Loss: 0.669 Test Acc: 0.616
Validation loss decreased (-0.526380 --> -0.615771).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0272154
	speed: 0.8797s/iter; left time: 31722.9863s
	iters: 200, epoch: 3 | loss: 0.8300432
	speed: 0.2064s/iter; left time: 7421.4227s
	iters: 300, epoch: 3 | loss: 0.7237526
	speed: 0.2015s/iter; left time: 7227.7541s
Epoch: 3 cost time: 76.96119451522827
Epoch: 3, Steps: 369 | Train Loss: 1.014 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1584773
	speed: 0.8559s/iter; left time: 30548.8753s
	iters: 200, epoch: 4 | loss: 0.7113822
	speed: 0.2122s/iter; left time: 7552.2109s
	iters: 300, epoch: 4 | loss: 0.8333685
	speed: 0.1963s/iter; left time: 6966.4303s
Epoch: 4 cost time: 78.25567293167114
Epoch: 4, Steps: 369 | Train Loss: 1.001 Vali Loss: 1.217 Vali Acc: 0.499 Test Loss: 1.217 Test Acc: 0.499
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.4114864
	speed: 0.7801s/iter; left time: 27555.9305s
	iters: 200, epoch: 5 | loss: 0.6961547
	speed: 0.2154s/iter; left time: 7585.7301s
	iters: 300, epoch: 5 | loss: 0.6974610
	speed: 0.2187s/iter; left time: 7680.7090s
Epoch: 5 cost time: 81.86562371253967
Epoch: 5, Steps: 369 | Train Loss: 0.904 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7218328
	speed: 0.7944s/iter; left time: 27769.6476s
	iters: 200, epoch: 6 | loss: 0.7148588
	speed: 0.2175s/iter; left time: 7579.5213s
	iters: 300, epoch: 6 | loss: 1.3496345
	speed: 0.2124s/iter; left time: 7382.9685s
Epoch: 6 cost time: 77.1414704322815
Epoch: 6, Steps: 369 | Train Loss: 0.749 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7417762
	speed: 0.8452s/iter; left time: 29233.4630s
	iters: 200, epoch: 7 | loss: 0.6829747
	speed: 0.2266s/iter; left time: 7814.7739s
	iters: 300, epoch: 7 | loss: 0.7093306
	speed: 0.1942s/iter; left time: 6677.9937s
Epoch: 7 cost time: 79.87909388542175
Epoch: 7, Steps: 369 | Train Loss: 0.728 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.8218529
	speed: 0.8051s/iter; left time: 27548.2053s
	iters: 200, epoch: 8 | loss: 0.6552868
	speed: 0.2189s/iter; left time: 7468.6985s
	iters: 300, epoch: 8 | loss: 0.6839957
	speed: 0.2017s/iter; left time: 6861.5520s
Epoch: 8 cost time: 79.90156722068787
Epoch: 8, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6638709
	speed: 0.7581s/iter; left time: 25659.5460s
	iters: 200, epoch: 9 | loss: 0.7227639
	speed: 0.1889s/iter; left time: 6374.4095s
	iters: 300, epoch: 9 | loss: 0.7034082
	speed: 0.1973s/iter; left time: 6638.2207s
Epoch: 9 cost time: 72.73616313934326
Epoch: 9, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6942651
	speed: 0.7905s/iter; left time: 26466.5897s
	iters: 200, epoch: 10 | loss: 0.7558607
	speed: 0.2162s/iter; left time: 7217.8973s
	iters: 300, epoch: 10 | loss: 0.7820356
	speed: 0.2128s/iter; left time: 7083.5012s
Epoch: 10 cost time: 81.00293159484863
Epoch: 10, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.8380041
	speed: 0.8105s/iter; left time: 26836.6420s
	iters: 200, epoch: 11 | loss: 0.7427993
	speed: 0.2154s/iter; left time: 7109.2610s
	iters: 300, epoch: 11 | loss: 0.7127073
	speed: 0.2202s/iter; left time: 7248.0314s
Epoch: 11 cost time: 81.64919543266296
Epoch: 11, Steps: 369 | Train Loss: 0.728 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7426057
	speed: 0.8485s/iter; left time: 27782.4033s
	iters: 200, epoch: 12 | loss: 0.7048432
	speed: 0.2068s/iter; left time: 6751.3306s
	iters: 300, epoch: 12 | loss: 0.7364753
	speed: 0.1964s/iter; left time: 6392.6555s
Epoch: 12 cost time: 77.34828162193298
Epoch: 12, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6157775255391601
model parameter : 11459634
model size : 48.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.0142617
	speed: 0.2404s/iter; left time: 8848.4980s
	iters: 200, epoch: 1 | loss: 1.3389921
	speed: 0.2167s/iter; left time: 7952.7156s
	iters: 300, epoch: 1 | loss: 1.0307089
	speed: 0.2200s/iter; left time: 8053.9636s
Epoch: 1 cost time: 82.53882193565369
Epoch: 1, Steps: 369 | Train Loss: 1.077 Vali Loss: 1.002 Vali Acc: 0.537 Test Loss: 1.002 Test Acc: 0.537
Validation loss decreased (inf --> -0.537164).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5634530
	speed: 0.8113s/iter; left time: 29558.2764s
	iters: 200, epoch: 2 | loss: 0.5957299
	speed: 0.1872s/iter; left time: 6802.5069s
	iters: 300, epoch: 2 | loss: 0.6569266
	speed: 0.2104s/iter; left time: 7622.0049s
Epoch: 2 cost time: 73.70862460136414
Epoch: 2, Steps: 369 | Train Loss: 0.941 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1892289
	speed: 0.7901s/iter; left time: 28492.0193s
	iters: 200, epoch: 3 | loss: 0.8214655
	speed: 0.2144s/iter; left time: 7708.8415s
	iters: 300, epoch: 3 | loss: 0.7869391
	speed: 0.1694s/iter; left time: 6076.4166s
Epoch: 3 cost time: 73.899165391922
Epoch: 3, Steps: 369 | Train Loss: 0.956 Vali Loss: 1.883 Vali Acc: 0.500 Test Loss: 1.883 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.2061512
	speed: 0.8042s/iter; left time: 28706.4581s
	iters: 200, epoch: 4 | loss: 1.1301914
	speed: 0.1823s/iter; left time: 6490.2992s
	iters: 300, epoch: 4 | loss: 0.6933020
	speed: 0.1983s/iter; left time: 7038.9212s
Epoch: 4 cost time: 72.82790303230286
Epoch: 4, Steps: 369 | Train Loss: 1.015 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.2339973
	speed: 0.8644s/iter; left time: 30535.6277s
	iters: 200, epoch: 5 | loss: 1.3205301
	speed: 0.2079s/iter; left time: 7323.1864s
	iters: 300, epoch: 5 | loss: 0.6878856
	speed: 0.1420s/iter; left time: 4987.4490s
Epoch: 5 cost time: 71.88045477867126
Epoch: 5, Steps: 369 | Train Loss: 1.352 Vali Loss: 0.859 Vali Acc: 0.500 Test Loss: 0.859 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.1899599
	speed: 0.6646s/iter; left time: 23232.8304s
	iters: 200, epoch: 6 | loss: 1.1128262
	speed: 0.1798s/iter; left time: 6267.3341s
	iters: 300, epoch: 6 | loss: 0.5340787
	speed: 0.1808s/iter; left time: 6283.5952s
Epoch: 6 cost time: 67.36145997047424
Epoch: 6, Steps: 369 | Train Loss: 0.979 Vali Loss: 0.803 Vali Acc: 0.500 Test Loss: 0.803 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7549327
	speed: 0.8166s/iter; left time: 28242.6936s
	iters: 200, epoch: 7 | loss: 1.2660195
	speed: 0.2042s/iter; left time: 7043.3197s
	iters: 300, epoch: 7 | loss: 1.1544976
	speed: 0.1958s/iter; left time: 6731.8373s
Epoch: 7 cost time: 75.46519494056702
Epoch: 7, Steps: 369 | Train Loss: 0.812 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7964187
	speed: 0.7764s/iter; left time: 26567.1099s
	iters: 200, epoch: 8 | loss: 0.6511248
	speed: 0.2126s/iter; left time: 7252.6878s
	iters: 300, epoch: 8 | loss: 0.5507163
	speed: 0.2214s/iter; left time: 7530.6619s
Epoch: 8 cost time: 77.58538341522217
Epoch: 8, Steps: 369 | Train Loss: 0.757 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6648322
	speed: 0.7614s/iter; left time: 25771.1448s
	iters: 200, epoch: 9 | loss: 0.6525611
	speed: 0.1826s/iter; left time: 6161.1258s
	iters: 300, epoch: 9 | loss: 0.7439988
	speed: 0.1808s/iter; left time: 6082.7817s
Epoch: 9 cost time: 69.57292437553406
Epoch: 9, Steps: 369 | Train Loss: 0.741 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.8148805
	speed: 0.7582s/iter; left time: 25383.5018s
	iters: 200, epoch: 10 | loss: 0.6372012
	speed: 0.1909s/iter; left time: 6372.6811s
	iters: 300, epoch: 10 | loss: 0.7534733
	speed: 0.1768s/iter; left time: 5884.4128s
Epoch: 10 cost time: 69.28535175323486
Epoch: 10, Steps: 369 | Train Loss: 0.734 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.7481602
	speed: 0.7344s/iter; left time: 24316.2013s
	iters: 200, epoch: 11 | loss: 0.6404362
	speed: 0.1977s/iter; left time: 6527.6540s
	iters: 300, epoch: 11 | loss: 0.6334897
	speed: 0.1798s/iter; left time: 5916.8977s
Epoch: 11 cost time: 67.92249345779419
Epoch: 11, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5371736662883088
model parameter : 11456818
model size : 48.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5931945
	speed: 0.2244s/iter; left time: 8259.9664s
	iters: 200, epoch: 1 | loss: 0.6967553
	speed: 0.1951s/iter; left time: 7161.5875s
	iters: 300, epoch: 1 | loss: 1.4912013
	speed: 0.2125s/iter; left time: 7776.2055s
Epoch: 1 cost time: 76.0752625465393
Epoch: 1, Steps: 369 | Train Loss: 1.137 Vali Loss: 2.189 Vali Acc: 0.507 Test Loss: 2.189 Test Acc: 0.507
Validation loss decreased (inf --> -0.506789).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7584239
	speed: 0.7609s/iter; left time: 27720.2720s
	iters: 200, epoch: 2 | loss: 0.6397411
	speed: 0.1711s/iter; left time: 6217.7609s
	iters: 300, epoch: 2 | loss: 1.4468639
	speed: 0.1853s/iter; left time: 6715.1880s
Epoch: 2 cost time: 66.89299416542053
Epoch: 2, Steps: 369 | Train Loss: 0.907 Vali Loss: 1.144 Vali Acc: 0.513 Test Loss: 1.144 Test Acc: 0.513
Validation loss decreased (-0.506789 --> -0.513042).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3108014
	speed: 0.7447s/iter; left time: 26855.3069s
	iters: 200, epoch: 3 | loss: 0.6122142
	speed: 0.1869s/iter; left time: 6720.5983s
	iters: 300, epoch: 3 | loss: 0.9818149
	speed: 0.1503s/iter; left time: 5388.4228s
Epoch: 3 cost time: 69.11776971817017
Epoch: 3, Steps: 369 | Train Loss: 0.993 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9576972
	speed: 0.7673s/iter; left time: 27388.1407s
	iters: 200, epoch: 4 | loss: 0.8151734
	speed: 0.1667s/iter; left time: 5932.1424s
	iters: 300, epoch: 4 | loss: 0.8847201
	speed: 0.1907s/iter; left time: 6769.2907s
Epoch: 4 cost time: 68.95225548744202
Epoch: 4, Steps: 369 | Train Loss: 0.962 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7843089
	speed: 0.7707s/iter; left time: 27224.6351s
	iters: 200, epoch: 5 | loss: 0.6529098
	speed: 0.1745s/iter; left time: 6146.2995s
	iters: 300, epoch: 5 | loss: 1.2460915
	speed: 0.1873s/iter; left time: 6580.6088s
Epoch: 5 cost time: 68.91559791564941
Epoch: 5, Steps: 369 | Train Loss: 0.863 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.5869417
	speed: 0.7419s/iter; left time: 25934.2183s
	iters: 200, epoch: 6 | loss: 1.4458961
	speed: 0.1930s/iter; left time: 6726.6207s
	iters: 300, epoch: 6 | loss: 0.8266457
	speed: 0.1867s/iter; left time: 6490.2746s
Epoch: 6 cost time: 69.94294118881226
Epoch: 6, Steps: 369 | Train Loss: 1.092 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.0138880
	speed: 0.7128s/iter; left time: 24652.3006s
	iters: 200, epoch: 7 | loss: 0.6374160
	speed: 0.1554s/iter; left time: 5358.8778s
	iters: 300, epoch: 7 | loss: 0.9647578
	speed: 0.1582s/iter; left time: 5440.2900s
Epoch: 7 cost time: 60.252471923828125
Epoch: 7, Steps: 369 | Train Loss: 0.863 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.8722410
	speed: 0.7265s/iter; left time: 24858.5549s
	iters: 200, epoch: 8 | loss: 0.8063012
	speed: 0.1863s/iter; left time: 6355.6510s
	iters: 300, epoch: 8 | loss: 0.8390636
	speed: 0.1627s/iter; left time: 5533.7906s
Epoch: 8 cost time: 65.71649360656738
Epoch: 8, Steps: 369 | Train Loss: 0.752 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7036175
	speed: 0.6799s/iter; left time: 23013.3338s
	iters: 200, epoch: 9 | loss: 0.7938329
	speed: 0.1670s/iter; left time: 5634.4848s
	iters: 300, epoch: 9 | loss: 0.7501615
	speed: 0.1687s/iter; left time: 5675.4022s
Epoch: 9 cost time: 64.4451961517334
Epoch: 9, Steps: 369 | Train Loss: 0.737 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.7362759
	speed: 0.7352s/iter; left time: 24615.9763s
	iters: 200, epoch: 10 | loss: 0.6187206
	speed: 0.1582s/iter; left time: 5279.1327s
	iters: 300, epoch: 10 | loss: 0.8010678
	speed: 0.1526s/iter; left time: 5080.0511s
Epoch: 10 cost time: 61.744462728500366
Epoch: 10, Steps: 369 | Train Loss: 0.728 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6667517
	speed: 0.7188s/iter; left time: 23799.3943s
	iters: 200, epoch: 11 | loss: 0.6393431
	speed: 0.1797s/iter; left time: 5931.9655s
	iters: 300, epoch: 11 | loss: 0.7159445
	speed: 0.1584s/iter; left time: 5214.3849s
Epoch: 11 cost time: 66.53074550628662
Epoch: 11, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7575139
	speed: 0.7234s/iter; left time: 23685.2458s
	iters: 200, epoch: 12 | loss: 0.7614277
	speed: 0.1747s/iter; left time: 5702.7437s
	iters: 300, epoch: 12 | loss: 0.7384202
	speed: 0.1608s/iter; left time: 5233.2600s
Epoch: 12 cost time: 63.89301419258118
Epoch: 12, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5130533484676504
model parameter : 9626674
model size : 41.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.4391651
	speed: 0.1904s/iter; left time: 7005.3748s
	iters: 200, epoch: 1 | loss: 1.3585625
	speed: 0.1689s/iter; left time: 6199.8907s
	iters: 300, epoch: 1 | loss: 1.1986934
	speed: 0.1862s/iter; left time: 6815.6296s
Epoch: 1 cost time: 69.4267327785492
Epoch: 1, Steps: 369 | Train Loss: 0.956 Vali Loss: 0.711 Vali Acc: 0.639 Test Loss: 0.711 Test Acc: 0.639
Validation loss decreased (inf --> -0.639039).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0074431
	speed: 0.7508s/iter; left time: 27354.5861s
	iters: 200, epoch: 2 | loss: 0.8032708
	speed: 0.1808s/iter; left time: 6570.5653s
	iters: 300, epoch: 2 | loss: 0.9110083
	speed: 0.1635s/iter; left time: 5922.9194s
Epoch: 2 cost time: 67.56837606430054
Epoch: 2, Steps: 369 | Train Loss: 0.879 Vali Loss: 0.969 Vali Acc: 0.542 Test Loss: 0.969 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6396322
	speed: 0.7337s/iter; left time: 26458.7141s
	iters: 200, epoch: 3 | loss: 0.7180266
	speed: 0.1770s/iter; left time: 6366.0388s
	iters: 300, epoch: 3 | loss: 1.3828064
	speed: 0.1866s/iter; left time: 6692.0051s
Epoch: 3 cost time: 68.07050800323486
Epoch: 3, Steps: 369 | Train Loss: 1.041 Vali Loss: 1.001 Vali Acc: 0.500 Test Loss: 1.001 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.0063201
	speed: 0.7573s/iter; left time: 27030.3422s
	iters: 200, epoch: 4 | loss: 1.7065537
	speed: 0.1984s/iter; left time: 7061.5529s
	iters: 300, epoch: 4 | loss: 0.9729942
	speed: 0.1746s/iter; left time: 6197.5004s
Epoch: 4 cost time: 69.14960527420044
Epoch: 4, Steps: 369 | Train Loss: 0.958 Vali Loss: 0.693 Vali Acc: 0.501 Test Loss: 0.693 Test Acc: 0.501
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6810411
	speed: 0.7202s/iter; left time: 25441.1864s
	iters: 200, epoch: 5 | loss: 0.7879173
	speed: 0.1859s/iter; left time: 6548.9347s
	iters: 300, epoch: 5 | loss: 0.7694085
	speed: 0.1845s/iter; left time: 6481.6011s
Epoch: 5 cost time: 69.23378491401672
Epoch: 5, Steps: 369 | Train Loss: 0.871 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6938766
	speed: 0.7342s/iter; left time: 25666.4245s
	iters: 200, epoch: 6 | loss: 0.5707327
	speed: 0.1950s/iter; left time: 6797.6133s
	iters: 300, epoch: 6 | loss: 0.6810940
	speed: 0.2046s/iter; left time: 7111.6504s
Epoch: 6 cost time: 73.64569163322449
Epoch: 6, Steps: 369 | Train Loss: 0.746 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6491573
	speed: 0.7323s/iter; left time: 25328.7298s
	iters: 200, epoch: 7 | loss: 0.7990595
	speed: 0.1910s/iter; left time: 6588.6100s
	iters: 300, epoch: 7 | loss: 0.8583591
	speed: 0.1959s/iter; left time: 6736.5517s
Epoch: 7 cost time: 68.8218936920166
Epoch: 7, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6538417
	speed: 0.7423s/iter; left time: 25401.6260s
	iters: 200, epoch: 8 | loss: 0.6859076
	speed: 0.1960s/iter; left time: 6686.5203s
	iters: 300, epoch: 8 | loss: 0.8475517
	speed: 0.1715s/iter; left time: 5833.9434s
Epoch: 8 cost time: 69.98024988174438
Epoch: 8, Steps: 369 | Train Loss: 0.738 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7147046
	speed: 0.7252s/iter; left time: 24548.7557s
	iters: 200, epoch: 9 | loss: 0.7640021
	speed: 0.1802s/iter; left time: 6080.1465s
	iters: 300, epoch: 9 | loss: 0.6976618
	speed: 0.1910s/iter; left time: 6427.4541s
Epoch: 9 cost time: 70.38658142089844
Epoch: 9, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7088032
	speed: 0.7283s/iter; left time: 24383.3666s
	iters: 200, epoch: 10 | loss: 0.7611802
	speed: 0.1771s/iter; left time: 5912.4310s
	iters: 300, epoch: 10 | loss: 1.2371480
	speed: 0.1641s/iter; left time: 5461.8886s
Epoch: 10 cost time: 63.46503782272339
Epoch: 10, Steps: 369 | Train Loss: 1.155 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.9887933
	speed: 0.7217s/iter; left time: 23896.5619s
	iters: 200, epoch: 11 | loss: 0.8964496
	speed: 0.1826s/iter; left time: 6027.4008s
	iters: 300, epoch: 11 | loss: 0.7135320
	speed: 0.1924s/iter; left time: 6332.0933s
Epoch: 11 cost time: 68.30432915687561
Epoch: 11, Steps: 369 | Train Loss: 0.877 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6390465380249716
model parameter : 9623858
model size : 41.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.4092104
	speed: 0.2163s/iter; left time: 7958.5923s
	iters: 200, epoch: 1 | loss: 1.1414986
	speed: 0.1350s/iter; left time: 4955.4500s
	iters: 300, epoch: 1 | loss: 1.3398255
	speed: 0.1313s/iter; left time: 4804.9290s
Epoch: 1 cost time: 58.06082558631897
Epoch: 1, Steps: 369 | Train Loss: 1.081 Vali Loss: 0.964 Vali Acc: 0.579 Test Loss: 0.964 Test Acc: 0.579
Validation loss decreased (inf --> -0.579446).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5360218
	speed: 0.6748s/iter; left time: 24584.6845s
	iters: 200, epoch: 2 | loss: 1.6455858
	speed: 0.1945s/iter; left time: 7065.4651s
	iters: 300, epoch: 2 | loss: 1.6656528
	speed: 0.1694s/iter; left time: 6139.2461s
Epoch: 2 cost time: 67.10989689826965
Epoch: 2, Steps: 369 | Train Loss: 0.879 Vali Loss: 0.975 Vali Acc: 0.515 Test Loss: 0.975 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5446222
	speed: 0.6651s/iter; left time: 23983.9208s
	iters: 200, epoch: 3 | loss: 0.9214454
	speed: 0.1540s/iter; left time: 5540.0636s
	iters: 300, epoch: 3 | loss: 1.1634178
	speed: 0.1359s/iter; left time: 4872.0877s
Epoch: 3 cost time: 61.04600787162781
Epoch: 3, Steps: 369 | Train Loss: 0.998 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6836816
	speed: 0.6655s/iter; left time: 23755.4830s
	iters: 200, epoch: 4 | loss: 0.9230586
	speed: 0.1666s/iter; left time: 5929.9383s
	iters: 300, epoch: 4 | loss: 0.6284826
	speed: 0.1580s/iter; left time: 5609.4397s
Epoch: 4 cost time: 61.20872783660889
Epoch: 4, Steps: 369 | Train Loss: 0.962 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8782325
	speed: 0.6201s/iter; left time: 21906.0968s
	iters: 200, epoch: 5 | loss: 1.2787292
	speed: 0.1671s/iter; left time: 5886.4842s
	iters: 300, epoch: 5 | loss: 0.8306718
	speed: 0.1774s/iter; left time: 6231.9520s
Epoch: 5 cost time: 64.98624420166016
Epoch: 5, Steps: 369 | Train Loss: 1.184 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7416478
	speed: 0.6634s/iter; left time: 23189.9784s
	iters: 200, epoch: 6 | loss: 0.8225330
	speed: 0.1530s/iter; left time: 5334.1570s
	iters: 300, epoch: 6 | loss: 0.8857575
	speed: 0.1542s/iter; left time: 5358.1845s
Epoch: 6 cost time: 59.866116762161255
Epoch: 6, Steps: 369 | Train Loss: 0.893 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6141024
	speed: 0.6787s/iter; left time: 23474.9947s
	iters: 200, epoch: 7 | loss: 0.7831208
	speed: 0.1663s/iter; left time: 5735.5163s
	iters: 300, epoch: 7 | loss: 0.6994485
	speed: 0.1416s/iter; left time: 4870.0539s
Epoch: 7 cost time: 60.547152280807495
Epoch: 7, Steps: 369 | Train Loss: 0.789 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.9220757
	speed: 0.6455s/iter; left time: 22089.3024s
	iters: 200, epoch: 8 | loss: 0.8105082
	speed: 0.1568s/iter; left time: 5347.9967s
	iters: 300, epoch: 8 | loss: 0.7319347
	speed: 0.1445s/iter; left time: 4914.8458s
Epoch: 8 cost time: 59.13311147689819
Epoch: 8, Steps: 369 | Train Loss: 0.733 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7083638
	speed: 0.6143s/iter; left time: 20794.2425s
	iters: 200, epoch: 9 | loss: 0.6131423
	speed: 0.1503s/iter; left time: 5071.7986s
	iters: 300, epoch: 9 | loss: 0.7087949
	speed: 0.1648s/iter; left time: 5546.1495s
Epoch: 9 cost time: 60.29725098609924
Epoch: 9, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6979365
	speed: 0.6285s/iter; left time: 21040.8900s
	iters: 200, epoch: 10 | loss: 0.7479725
	speed: 0.1573s/iter; left time: 5251.9589s
	iters: 300, epoch: 10 | loss: 0.7234750
	speed: 0.1681s/iter; left time: 5593.9603s
Epoch: 10 cost time: 60.669907093048096
Epoch: 10, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6411504
	speed: 0.6134s/iter; left time: 20311.6481s
	iters: 200, epoch: 11 | loss: 0.6709185
	speed: 0.1622s/iter; left time: 5353.7895s
	iters: 300, epoch: 11 | loss: 0.6465500
	speed: 0.1639s/iter; left time: 5393.6166s
Epoch: 11 cost time: 59.63689565658569
Epoch: 11, Steps: 369 | Train Loss: 0.728 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5794551645856981
model parameter : 9621042
model size : 41.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.0631223
	speed: 0.2050s/iter; left time: 7544.1201s
	iters: 200, epoch: 1 | loss: 0.5489475
	speed: 0.1483s/iter; left time: 5443.0613s
	iters: 300, epoch: 1 | loss: 0.6976271
	speed: 0.1630s/iter; left time: 5965.3857s
Epoch: 1 cost time: 62.571855306625366
Epoch: 1, Steps: 369 | Train Loss: 0.988 Vali Loss: 0.774 Vali Acc: 0.575 Test Loss: 0.774 Test Acc: 0.575
Validation loss decreased (inf --> -0.574623).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1746982
	speed: 0.6664s/iter; left time: 24279.8655s
	iters: 200, epoch: 2 | loss: 0.5327020
	speed: 0.1797s/iter; left time: 6528.8470s
	iters: 300, epoch: 2 | loss: 0.6603080
	speed: 0.1589s/iter; left time: 5758.1715s
Epoch: 2 cost time: 62.16059970855713
Epoch: 2, Steps: 369 | Train Loss: 0.860 Vali Loss: 0.991 Vali Acc: 0.566 Test Loss: 0.991 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7846745
	speed: 0.6427s/iter; left time: 23178.4894s
	iters: 200, epoch: 3 | loss: 0.5300034
	speed: 0.1604s/iter; left time: 5767.8302s
	iters: 300, epoch: 3 | loss: 0.8738217
	speed: 0.1443s/iter; left time: 5174.5771s
Epoch: 3 cost time: 57.14555788040161
Epoch: 3, Steps: 369 | Train Loss: 0.945 Vali Loss: 1.442 Vali Acc: 0.500 Test Loss: 1.442 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8195244
	speed: 0.6786s/iter; left time: 24220.3375s
	iters: 200, epoch: 4 | loss: 1.3290281
	speed: 0.1565s/iter; left time: 5570.0055s
	iters: 300, epoch: 4 | loss: 0.7452710
	speed: 0.1602s/iter; left time: 5685.3379s
Epoch: 4 cost time: 63.77170157432556
Epoch: 4, Steps: 369 | Train Loss: 0.986 Vali Loss: 1.001 Vali Acc: 0.500 Test Loss: 1.001 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.7370046
	speed: 0.6689s/iter; left time: 23628.7887s
	iters: 200, epoch: 5 | loss: 1.0347995
	speed: 0.1637s/iter; left time: 5765.9126s
	iters: 300, epoch: 5 | loss: 1.5837474
	speed: 0.1635s/iter; left time: 5744.6825s
Epoch: 5 cost time: 60.84871554374695
Epoch: 5, Steps: 369 | Train Loss: 1.174 Vali Loss: 1.710 Vali Acc: 0.500 Test Loss: 1.710 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.9528154
	speed: 0.6680s/iter; left time: 23349.3149s
	iters: 200, epoch: 6 | loss: 0.9084782
	speed: 0.1644s/iter; left time: 5731.3117s
	iters: 300, epoch: 6 | loss: 0.7086693
	speed: 0.1644s/iter; left time: 5713.0788s
Epoch: 6 cost time: 62.79463481903076
Epoch: 6, Steps: 369 | Train Loss: 0.963 Vali Loss: 0.957 Vali Acc: 0.500 Test Loss: 0.957 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.1683451
	speed: 0.6600s/iter; left time: 22828.4741s
	iters: 200, epoch: 7 | loss: 1.1063007
	speed: 0.1545s/iter; left time: 5327.5084s
	iters: 300, epoch: 7 | loss: 1.1064583
	speed: 0.1555s/iter; left time: 5348.7797s
Epoch: 7 cost time: 57.69096779823303
Epoch: 7, Steps: 369 | Train Loss: 0.799 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7662407
	speed: 0.6696s/iter; left time: 22914.0143s
	iters: 200, epoch: 8 | loss: 0.6729020
	speed: 0.1511s/iter; left time: 5155.3334s
	iters: 300, epoch: 8 | loss: 0.6719929
	speed: 0.1576s/iter; left time: 5362.2027s
Epoch: 8 cost time: 59.047714710235596
Epoch: 8, Steps: 369 | Train Loss: 0.750 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7392007
	speed: 0.6375s/iter; left time: 21578.0534s
	iters: 200, epoch: 9 | loss: 0.7639159
	speed: 0.1678s/iter; left time: 5662.0288s
	iters: 300, epoch: 9 | loss: 0.7571920
	speed: 0.1750s/iter; left time: 5890.0197s
Epoch: 9 cost time: 62.95128345489502
Epoch: 9, Steps: 369 | Train Loss: 0.738 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7976942
	speed: 0.6618s/iter; left time: 22155.7851s
	iters: 200, epoch: 10 | loss: 0.7144071
	speed: 0.1617s/iter; left time: 5396.0147s
	iters: 300, epoch: 10 | loss: 0.7830993
	speed: 0.1700s/iter; left time: 5658.6586s
Epoch: 10 cost time: 61.93311834335327
Epoch: 10, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6425942
	speed: 0.6680s/iter; left time: 22118.8900s
	iters: 200, epoch: 11 | loss: 0.7428550
	speed: 0.1695s/iter; left time: 5595.1094s
	iters: 300, epoch: 11 | loss: 0.8011677
	speed: 0.1775s/iter; left time: 5840.5662s
Epoch: 11 cost time: 63.97579383850098
Epoch: 11, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5746311010215664
model parameter : 9618226
model size : 41.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.9117765
	speed: 0.1827s/iter; left time: 6723.9989s
	iters: 200, epoch: 1 | loss: 0.5979204
	speed: 0.1660s/iter; left time: 6094.0514s
	iters: 300, epoch: 1 | loss: 1.1475296
	speed: 0.1629s/iter; left time: 5963.5501s
Epoch: 1 cost time: 61.62789559364319
Epoch: 1, Steps: 369 | Train Loss: 1.107 Vali Loss: 2.524 Vali Acc: 0.500 Test Loss: 2.524 Test Acc: 0.500
Validation loss decreased (inf --> -0.499975).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4586909
	speed: 0.6577s/iter; left time: 23962.1119s
	iters: 200, epoch: 2 | loss: 0.8983377
	speed: 0.1599s/iter; left time: 5809.0219s
	iters: 300, epoch: 2 | loss: 0.6709874
	speed: 0.1601s/iter; left time: 5801.7015s
Epoch: 2 cost time: 60.295631885528564
Epoch: 2, Steps: 369 | Train Loss: 0.824 Vali Loss: 1.585 Vali Acc: 0.514 Test Loss: 1.585 Test Acc: 0.514
Validation loss decreased (-0.499975 --> -0.513889).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6757733
	speed: 0.6545s/iter; left time: 23601.5475s
	iters: 200, epoch: 3 | loss: 1.2455217
	speed: 0.1672s/iter; left time: 6014.0575s
	iters: 300, epoch: 3 | loss: 1.4606152
	speed: 0.1577s/iter; left time: 5654.6566s
Epoch: 3 cost time: 62.643840312957764
Epoch: 3, Steps: 369 | Train Loss: 0.915 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8464613
	speed: 0.6631s/iter; left time: 23667.8547s
	iters: 200, epoch: 4 | loss: 0.6283769
	speed: 0.1594s/iter; left time: 5675.1894s
	iters: 300, epoch: 4 | loss: 0.6907083
	speed: 0.1448s/iter; left time: 5140.9279s
Epoch: 4 cost time: 57.457282304763794
Epoch: 4, Steps: 369 | Train Loss: 0.973 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7294913
	speed: 0.6087s/iter; left time: 21501.4767s
	iters: 200, epoch: 5 | loss: 0.7169316
	speed: 0.1404s/iter; left time: 4945.4256s
	iters: 300, epoch: 5 | loss: 0.6479492
	speed: 0.1522s/iter; left time: 5346.5793s
Epoch: 5 cost time: 57.87075066566467
Epoch: 5, Steps: 369 | Train Loss: 0.806 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7074979
	speed: 0.5841s/iter; left time: 20419.2464s
	iters: 200, epoch: 6 | loss: 0.6926603
	speed: 0.1556s/iter; left time: 5425.2952s
	iters: 300, epoch: 6 | loss: 0.8634154
	speed: 0.1489s/iter; left time: 5174.3171s
Epoch: 6 cost time: 55.60678029060364
Epoch: 6, Steps: 369 | Train Loss: 0.849 Vali Loss: 0.864 Vali Acc: 0.500 Test Loss: 0.864 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6683895
	speed: 0.5996s/iter; left time: 20737.6468s
	iters: 200, epoch: 7 | loss: 0.7715815
	speed: 0.1738s/iter; left time: 5992.5209s
	iters: 300, epoch: 7 | loss: 0.7835807
	speed: 0.1555s/iter; left time: 5347.1066s
Epoch: 7 cost time: 60.20593547821045
Epoch: 7, Steps: 369 | Train Loss: 0.796 Vali Loss: 0.931 Vali Acc: 0.500 Test Loss: 0.931 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6886837
	speed: 0.6431s/iter; left time: 22005.8293s
	iters: 200, epoch: 8 | loss: 0.8896893
	speed: 0.1646s/iter; left time: 5615.4802s
	iters: 300, epoch: 8 | loss: 0.9958147
	speed: 0.1622s/iter; left time: 5516.1497s
Epoch: 8 cost time: 60.12092733383179
Epoch: 8, Steps: 369 | Train Loss: 0.908 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7803134
	speed: 0.6502s/iter; left time: 22010.3058s
	iters: 200, epoch: 9 | loss: 0.7463642
	speed: 0.1685s/iter; left time: 5687.5462s
	iters: 300, epoch: 9 | loss: 0.7609304
	speed: 0.1637s/iter; left time: 5509.0482s
Epoch: 9 cost time: 63.16268277168274
Epoch: 9, Steps: 369 | Train Loss: 0.765 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.8935319
	speed: 0.6256s/iter; left time: 20944.4612s
	iters: 200, epoch: 10 | loss: 0.8596176
	speed: 0.1564s/iter; left time: 5219.5027s
	iters: 300, epoch: 10 | loss: 0.7022853
	speed: 0.1586s/iter; left time: 5276.8253s
Epoch: 10 cost time: 57.112303733825684
Epoch: 10, Steps: 369 | Train Loss: 0.748 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.8722540
	speed: 0.6232s/iter; left time: 20635.2190s
	iters: 200, epoch: 11 | loss: 0.7252148
	speed: 0.1520s/iter; left time: 5016.1399s
	iters: 300, epoch: 11 | loss: 0.7816766
	speed: 0.1520s/iter; left time: 5001.4145s
Epoch: 11 cost time: 57.220823764801025
Epoch: 11, Steps: 369 | Train Loss: 0.735 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.8242040
	speed: 0.6323s/iter; left time: 20704.3723s
	iters: 200, epoch: 12 | loss: 0.7524163
	speed: 0.1492s/iter; left time: 4870.4552s
	iters: 300, epoch: 12 | loss: 0.6298675
	speed: 0.1541s/iter; left time: 5013.4716s
Epoch: 12 cost time: 57.92504692077637
Epoch: 12, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5139046538024972
model parameter : 8707378
model size : 38.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7065303
	speed: 0.1932s/iter; left time: 7108.4288s
	iters: 200, epoch: 1 | loss: 0.6081668
	speed: 0.1526s/iter; left time: 5600.8667s
	iters: 300, epoch: 1 | loss: 0.5027526
	speed: 0.1398s/iter; left time: 5115.6309s
Epoch: 1 cost time: 59.91212844848633
Epoch: 1, Steps: 369 | Train Loss: 1.171 Vali Loss: 1.336 Vali Acc: 0.500 Test Loss: 1.336 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9565343
	speed: 0.6680s/iter; left time: 24335.2438s
	iters: 200, epoch: 2 | loss: 1.1563646
	speed: 0.1700s/iter; left time: 6177.4226s
	iters: 300, epoch: 2 | loss: 0.5209820
	speed: 0.1640s/iter; left time: 5942.4483s
Epoch: 2 cost time: 62.86648964881897
Epoch: 2, Steps: 369 | Train Loss: 0.851 Vali Loss: 1.321 Vali Acc: 0.653 Test Loss: 1.321 Test Acc: 0.653
Validation loss decreased (-0.499987 --> -0.652654).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0620985
	speed: 0.6455s/iter; left time: 23276.9255s
	iters: 200, epoch: 3 | loss: 0.8313751
	speed: 0.1540s/iter; left time: 5538.1145s
	iters: 300, epoch: 3 | loss: 0.8747597
	speed: 0.1543s/iter; left time: 5534.6567s
Epoch: 3 cost time: 58.16115927696228
Epoch: 3, Steps: 369 | Train Loss: 1.146 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6727433
	speed: 0.6547s/iter; left time: 23368.6720s
	iters: 200, epoch: 4 | loss: 1.4608803
	speed: 0.1651s/iter; left time: 5875.2003s
	iters: 300, epoch: 4 | loss: 1.3418276
	speed: 0.1481s/iter; left time: 5255.3967s
Epoch: 4 cost time: 60.09613633155823
Epoch: 4, Steps: 369 | Train Loss: 0.962 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7876725
	speed: 0.6317s/iter; left time: 22314.1436s
	iters: 200, epoch: 5 | loss: 1.0358671
	speed: 0.1676s/iter; left time: 5903.1665s
	iters: 300, epoch: 5 | loss: 0.8728936
	speed: 0.1614s/iter; left time: 5669.7423s
Epoch: 5 cost time: 60.13688635826111
Epoch: 5, Steps: 369 | Train Loss: 1.190 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.0100834
	speed: 0.6414s/iter; left time: 22421.6679s
	iters: 200, epoch: 6 | loss: 0.9585302
	speed: 0.1561s/iter; left time: 5441.7316s
	iters: 300, epoch: 6 | loss: 0.6204042
	speed: 0.1563s/iter; left time: 5432.9672s
Epoch: 6 cost time: 60.012568950653076
Epoch: 6, Steps: 369 | Train Loss: 0.904 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7706050
	speed: 0.6410s/iter; left time: 22169.4574s
	iters: 200, epoch: 7 | loss: 0.7925967
	speed: 0.1561s/iter; left time: 5383.4479s
	iters: 300, epoch: 7 | loss: 0.7101104
	speed: 0.1553s/iter; left time: 5340.1345s
Epoch: 7 cost time: 58.676140546798706
Epoch: 7, Steps: 369 | Train Loss: 0.764 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6879242
	speed: 0.6446s/iter; left time: 22058.2802s
	iters: 200, epoch: 8 | loss: 0.6418446
	speed: 0.1605s/iter; left time: 5474.6319s
	iters: 300, epoch: 8 | loss: 0.7399113
	speed: 0.1754s/iter; left time: 5965.7484s
Epoch: 8 cost time: 61.60163617134094
Epoch: 8, Steps: 369 | Train Loss: 0.738 Vali Loss: 0.809 Vali Acc: 0.500 Test Loss: 0.809 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.5258302
	speed: 0.6415s/iter; left time: 21714.5533s
	iters: 200, epoch: 9 | loss: 0.7442224
	speed: 0.1395s/iter; left time: 4707.4091s
	iters: 300, epoch: 9 | loss: 0.7234476
	speed: 0.1492s/iter; left time: 5020.6415s
Epoch: 9 cost time: 56.023107290267944
Epoch: 9, Steps: 369 | Train Loss: 0.729 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6969216
	speed: 0.6576s/iter; left time: 22018.0947s
	iters: 200, epoch: 10 | loss: 0.7625927
	speed: 0.1534s/iter; left time: 5121.1157s
	iters: 300, epoch: 10 | loss: 0.7130606
	speed: 0.1605s/iter; left time: 5340.1562s
Epoch: 10 cost time: 60.26248550415039
Epoch: 10, Steps: 369 | Train Loss: 0.722 Vali Loss: 0.813 Vali Acc: 0.500 Test Loss: 0.813 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7511117
	speed: 0.6531s/iter; left time: 21623.9337s
	iters: 200, epoch: 11 | loss: 0.6561291
	speed: 0.1519s/iter; left time: 5012.9380s
	iters: 300, epoch: 11 | loss: 0.7998077
	speed: 0.1510s/iter; left time: 4970.4360s
Epoch: 11 cost time: 59.26278042793274
Epoch: 11, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.862 Vali Acc: 0.500 Test Loss: 0.862 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7275711
	speed: 0.6533s/iter; left time: 21391.4586s
	iters: 200, epoch: 12 | loss: 0.7953049
	speed: 0.1709s/iter; left time: 5577.6973s
	iters: 300, epoch: 12 | loss: 0.7131046
	speed: 0.1632s/iter; left time: 5312.2733s
Epoch: 12 cost time: 60.98173451423645
Epoch: 12, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6526674233825198
model parameter : 8704562
model size : 38.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.4354585
	speed: 0.1844s/iter; left time: 6786.1779s
	iters: 200, epoch: 1 | loss: 0.8888422
	speed: 0.1660s/iter; left time: 6092.8094s
	iters: 300, epoch: 1 | loss: 0.6677818
	speed: 0.1599s/iter; left time: 5852.1722s
Epoch: 1 cost time: 63.45457625389099
Epoch: 1, Steps: 369 | Train Loss: 1.119 Vali Loss: 0.658 Vali Acc: 0.667 Test Loss: 0.658 Test Acc: 0.667
Validation loss decreased (inf --> -0.666849).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2737511
	speed: 0.6612s/iter; left time: 24087.8829s
	iters: 200, epoch: 2 | loss: 0.5778019
	speed: 0.1563s/iter; left time: 5679.5074s
	iters: 300, epoch: 2 | loss: 0.3430669
	speed: 0.1496s/iter; left time: 5421.3640s
Epoch: 2 cost time: 56.59043312072754
Epoch: 2, Steps: 369 | Train Loss: 0.805 Vali Loss: 0.653 Vali Acc: 0.644 Test Loss: 0.653 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6277266
	speed: 0.6223s/iter; left time: 22443.3900s
	iters: 200, epoch: 3 | loss: 0.6380807
	speed: 0.1599s/iter; left time: 5748.7137s
	iters: 300, epoch: 3 | loss: 1.2895787
	speed: 0.1737s/iter; left time: 6228.7860s
Epoch: 3 cost time: 60.219337463378906
Epoch: 3, Steps: 369 | Train Loss: 0.890 Vali Loss: 2.144 Vali Acc: 0.500 Test Loss: 2.144 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9766836
	speed: 0.6302s/iter; left time: 22495.1157s
	iters: 200, epoch: 4 | loss: 0.7278177
	speed: 0.1512s/iter; left time: 5380.1426s
	iters: 300, epoch: 4 | loss: 0.6990976
	speed: 0.1431s/iter; left time: 5080.0329s
Epoch: 4 cost time: 55.690723180770874
Epoch: 4, Steps: 369 | Train Loss: 0.949 Vali Loss: 1.948 Vali Acc: 0.500 Test Loss: 1.948 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.9233539
	speed: 0.6348s/iter; left time: 22424.3120s
	iters: 200, epoch: 5 | loss: 0.6294304
	speed: 0.1562s/iter; left time: 5501.2115s
	iters: 300, epoch: 5 | loss: 0.9675160
	speed: 0.1496s/iter; left time: 5253.1614s
Epoch: 5 cost time: 58.295483350753784
Epoch: 5, Steps: 369 | Train Loss: 0.837 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7327345
	speed: 0.6043s/iter; left time: 21123.6637s
	iters: 200, epoch: 6 | loss: 0.7858892
	speed: 0.1407s/iter; left time: 4905.1104s
	iters: 300, epoch: 6 | loss: 3.0914664
	speed: 0.1450s/iter; left time: 5041.2688s
Epoch: 6 cost time: 53.68513250350952
Epoch: 6, Steps: 369 | Train Loss: 1.036 Vali Loss: 0.924 Vali Acc: 0.500 Test Loss: 0.924 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.0880822
	speed: 0.6467s/iter; left time: 22366.3593s
	iters: 200, epoch: 7 | loss: 1.0110904
	speed: 0.1434s/iter; left time: 4947.0076s
	iters: 300, epoch: 7 | loss: 0.9074553
	speed: 0.1575s/iter; left time: 5415.9993s
Epoch: 7 cost time: 57.61057901382446
Epoch: 7, Steps: 369 | Train Loss: 1.049 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.9301801
	speed: 0.6296s/iter; left time: 21543.8526s
	iters: 200, epoch: 8 | loss: 0.6437491
	speed: 0.1388s/iter; left time: 4734.4426s
	iters: 300, epoch: 8 | loss: 0.8419406
	speed: 0.1361s/iter; left time: 4629.9789s
Epoch: 8 cost time: 52.97175192832947
Epoch: 8, Steps: 369 | Train Loss: 0.800 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.8949731
	speed: 0.6080s/iter; left time: 20579.0911s
	iters: 200, epoch: 9 | loss: 0.7289783
	speed: 0.1607s/iter; left time: 5422.6476s
	iters: 300, epoch: 9 | loss: 0.6396705
	speed: 0.1454s/iter; left time: 4893.4486s
Epoch: 9 cost time: 57.366320848464966
Epoch: 9, Steps: 369 | Train Loss: 0.748 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6859362
	speed: 0.6333s/iter; left time: 21203.9244s
	iters: 200, epoch: 10 | loss: 0.7381990
	speed: 0.1511s/iter; left time: 5044.8128s
	iters: 300, epoch: 10 | loss: 0.7933061
	speed: 0.1388s/iter; left time: 4620.7039s
Epoch: 10 cost time: 55.44619655609131
Epoch: 10, Steps: 369 | Train Loss: 0.738 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6968445
	speed: 0.6239s/iter; left time: 20658.4323s
	iters: 200, epoch: 11 | loss: 0.7793376
	speed: 0.1382s/iter; left time: 4563.4514s
	iters: 300, epoch: 11 | loss: 0.5119928
	speed: 0.1400s/iter; left time: 4608.7257s
Epoch: 11 cost time: 55.5892276763916
Epoch: 11, Steps: 369 | Train Loss: 0.736 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6668558456299659
model parameter : 8701746
model size : 38.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.3788873
	speed: 0.1955s/iter; left time: 7193.2298s
	iters: 200, epoch: 1 | loss: 0.1930132
	speed: 0.1497s/iter; left time: 5493.6153s
	iters: 300, epoch: 1 | loss: 0.7473264
	speed: 0.1443s/iter; left time: 5280.6410s
Epoch: 1 cost time: 59.67343592643738
Epoch: 1, Steps: 369 | Train Loss: 1.094 Vali Loss: 0.938 Vali Acc: 0.612 Test Loss: 0.938 Test Acc: 0.612
Validation loss decreased (inf --> -0.612363).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7418736
	speed: 0.6445s/iter; left time: 23480.3009s
	iters: 200, epoch: 2 | loss: 1.1687168
	speed: 0.1412s/iter; left time: 5131.8934s
	iters: 300, epoch: 2 | loss: 1.1931350
	speed: 0.1463s/iter; left time: 5302.3266s
Epoch: 2 cost time: 56.38865661621094
Epoch: 2, Steps: 369 | Train Loss: 0.813 Vali Loss: 0.745 Vali Acc: 0.575 Test Loss: 0.745 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5234892
	speed: 0.6115s/iter; left time: 22052.0651s
	iters: 200, epoch: 3 | loss: 0.9761327
	speed: 0.1495s/iter; left time: 5376.2789s
	iters: 300, epoch: 3 | loss: 0.8618473
	speed: 0.1630s/iter; left time: 5844.1591s
Epoch: 3 cost time: 58.0655083656311
Epoch: 3, Steps: 369 | Train Loss: 0.910 Vali Loss: 1.556 Vali Acc: 0.500 Test Loss: 1.556 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7706455
	speed: 0.6172s/iter; left time: 22029.1810s
	iters: 200, epoch: 4 | loss: 0.7318519
	speed: 0.1335s/iter; left time: 4753.5494s
	iters: 300, epoch: 4 | loss: 0.7719627
	speed: 0.1316s/iter; left time: 4671.7641s
Epoch: 4 cost time: 51.68190932273865
Epoch: 4, Steps: 369 | Train Loss: 0.931 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.6622195
	speed: 0.6164s/iter; left time: 21774.2596s
	iters: 200, epoch: 5 | loss: 1.0906461
	speed: 0.1581s/iter; left time: 5570.2624s
	iters: 300, epoch: 5 | loss: 0.7080155
	speed: 0.1629s/iter; left time: 5723.3783s
Epoch: 5 cost time: 58.304935693740845
Epoch: 5, Steps: 369 | Train Loss: 0.855 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6699043
	speed: 0.5967s/iter; left time: 20858.8906s
	iters: 200, epoch: 6 | loss: 0.8168365
	speed: 0.1508s/iter; left time: 5255.5323s
	iters: 300, epoch: 6 | loss: 1.0143958
	speed: 0.1509s/iter; left time: 5244.3350s
Epoch: 6 cost time: 57.517067193984985
Epoch: 6, Steps: 369 | Train Loss: 0.769 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.8690534
	speed: 0.6009s/iter; left time: 20782.5479s
	iters: 200, epoch: 7 | loss: 0.6411532
	speed: 0.1538s/iter; left time: 5303.2741s
	iters: 300, epoch: 7 | loss: 0.6861461
	speed: 0.1518s/iter; left time: 5219.8768s
Epoch: 7 cost time: 56.807615518569946
Epoch: 7, Steps: 369 | Train Loss: 1.011 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6963652
	speed: 0.5968s/iter; left time: 20420.6024s
	iters: 200, epoch: 8 | loss: 0.8023381
	speed: 0.1425s/iter; left time: 4863.4344s
	iters: 300, epoch: 8 | loss: 0.6199100
	speed: 0.1460s/iter; left time: 4967.7778s
Epoch: 8 cost time: 53.81589126586914
Epoch: 8, Steps: 369 | Train Loss: 0.768 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7242195
	speed: 0.6046s/iter; left time: 20465.3334s
	iters: 200, epoch: 9 | loss: 0.6899531
	speed: 0.1482s/iter; left time: 5000.7142s
	iters: 300, epoch: 9 | loss: 0.6845809
	speed: 0.1596s/iter; left time: 5371.6571s
Epoch: 9 cost time: 56.72950315475464
Epoch: 9, Steps: 369 | Train Loss: 0.740 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7896916
	speed: 0.6153s/iter; left time: 20599.7411s
	iters: 200, epoch: 10 | loss: 0.6784046
	speed: 0.1457s/iter; left time: 4864.8865s
	iters: 300, epoch: 10 | loss: 0.6940721
	speed: 0.1372s/iter; left time: 4567.1317s
Epoch: 10 cost time: 54.05976319313049
Epoch: 10, Steps: 369 | Train Loss: 0.729 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.7098600
	speed: 0.6249s/iter; left time: 20692.2335s
	iters: 200, epoch: 11 | loss: 0.6745797
	speed: 0.1423s/iter; left time: 4697.2252s
	iters: 300, epoch: 11 | loss: 0.6926033
	speed: 0.1337s/iter; left time: 4400.3889s
Epoch: 11 cost time: 55.03834581375122
Epoch: 11, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.612372304199773
model parameter : 8698930
model size : 38.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9477934
	speed: 0.1998s/iter; left time: 7351.2363s
	iters: 200, epoch: 1 | loss: 0.9813732
	speed: 0.1879s/iter; left time: 6897.9527s
	iters: 300, epoch: 1 | loss: 0.6586158
	speed: 0.1734s/iter; left time: 6344.8995s
Epoch: 1 cost time: 65.08437895774841
Epoch: 1, Steps: 369 | Train Loss: 1.179 Vali Loss: 1.185 Vali Acc: 0.509 Test Loss: 1.185 Test Acc: 0.509
Validation loss decreased (inf --> -0.508785).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9307432
	speed: 0.5162s/iter; left time: 18806.3880s
	iters: 200, epoch: 2 | loss: 0.8624354
	speed: 0.1183s/iter; left time: 4297.8388s
	iters: 300, epoch: 2 | loss: 0.6598212
	speed: 0.1181s/iter; left time: 4279.1794s
Epoch: 2 cost time: 44.396403551101685
Epoch: 2, Steps: 369 | Train Loss: 0.815 Vali Loss: 1.039 Vali Acc: 0.547 Test Loss: 1.039 Test Acc: 0.547
Validation loss decreased (-0.508785 --> -0.547379).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6527998
	speed: 0.5117s/iter; left time: 18452.8402s
	iters: 200, epoch: 3 | loss: 0.5038280
	speed: 0.1048s/iter; left time: 3769.7433s
	iters: 300, epoch: 3 | loss: 0.9630122
	speed: 0.1203s/iter; left time: 4315.2741s
Epoch: 3 cost time: 43.477850914001465
Epoch: 3, Steps: 369 | Train Loss: 0.894 Vali Loss: 0.797 Vali Acc: 0.500 Test Loss: 0.797 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7723984
	speed: 0.4747s/iter; left time: 16942.2147s
	iters: 200, epoch: 4 | loss: 0.7614413
	speed: 0.1053s/iter; left time: 3747.4996s
	iters: 300, epoch: 4 | loss: 0.7503054
	speed: 0.1210s/iter; left time: 4293.6673s
Epoch: 4 cost time: 44.972003698349
Epoch: 4, Steps: 369 | Train Loss: 0.858 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7321004
	speed: 0.5879s/iter; left time: 20766.3377s
	iters: 200, epoch: 5 | loss: 0.6188046
	speed: 0.1392s/iter; left time: 4903.4971s
	iters: 300, epoch: 5 | loss: 1.4246606
	speed: 0.1397s/iter; left time: 4906.6202s
Epoch: 5 cost time: 54.75884461402893
Epoch: 5, Steps: 369 | Train Loss: 0.799 Vali Loss: 0.893 Vali Acc: 0.500 Test Loss: 0.893 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7539419
	speed: 0.5998s/iter; left time: 20966.3972s
	iters: 200, epoch: 6 | loss: 0.7404405
	speed: 0.1516s/iter; left time: 5284.6331s
	iters: 300, epoch: 6 | loss: 0.7371409
	speed: 0.1439s/iter; left time: 5003.1042s
Epoch: 6 cost time: 55.40523076057434
Epoch: 6, Steps: 369 | Train Loss: 0.782 Vali Loss: 0.923 Vali Acc: 0.500 Test Loss: 0.923 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7092796
	speed: 0.5710s/iter; left time: 19749.0965s
	iters: 200, epoch: 7 | loss: 0.6788157
	speed: 0.1504s/iter; left time: 5186.0544s
	iters: 300, epoch: 7 | loss: 0.7236174
	speed: 0.1624s/iter; left time: 5585.2922s
Epoch: 7 cost time: 56.03792357444763
Epoch: 7, Steps: 369 | Train Loss: 0.722 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7283612
	speed: 0.5935s/iter; left time: 20307.1022s
	iters: 200, epoch: 8 | loss: 0.7092276
	speed: 0.1372s/iter; left time: 4682.1872s
	iters: 300, epoch: 8 | loss: 0.7130541
	speed: 0.1414s/iter; left time: 4809.9642s
Epoch: 8 cost time: 52.566070795059204
Epoch: 8, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6402003
	speed: 0.5612s/iter; left time: 18995.1912s
	iters: 200, epoch: 9 | loss: 0.7618596
	speed: 0.1412s/iter; left time: 4766.9598s
	iters: 300, epoch: 9 | loss: 0.6573301
	speed: 0.1535s/iter; left time: 5164.6214s
Epoch: 9 cost time: 53.614624977111816
Epoch: 9, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6977808
	speed: 0.5989s/iter; left time: 20052.1780s
	iters: 200, epoch: 10 | loss: 0.7015072
	speed: 0.1447s/iter; left time: 4829.6464s
	iters: 300, epoch: 10 | loss: 0.6755291
	speed: 0.1354s/iter; left time: 4506.4725s
Epoch: 10 cost time: 54.13827633857727
Epoch: 10, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7255931
	speed: 0.6323s/iter; left time: 20937.5240s
	iters: 200, epoch: 11 | loss: 0.7735063
	speed: 0.1528s/iter; left time: 5042.8839s
	iters: 300, epoch: 11 | loss: 0.7469487
	speed: 0.1429s/iter; left time: 4703.7800s
Epoch: 11 cost time: 56.15473747253418
Epoch: 11, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.6581231
	speed: 0.6215s/iter; left time: 20350.4465s
	iters: 200, epoch: 12 | loss: 0.6613010
	speed: 0.1372s/iter; left time: 4478.8543s
	iters: 300, epoch: 12 | loss: 0.7125310
	speed: 0.1351s/iter; left time: 4394.9119s
Epoch: 12 cost time: 52.654239654541016
Epoch: 12, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.54738933030647
model parameter : 8247730
model size : 36.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4102381
	speed: 0.1788s/iter; left time: 6579.4615s
	iters: 200, epoch: 1 | loss: 4.4605947
	speed: 0.1354s/iter; left time: 4969.2942s
	iters: 300, epoch: 1 | loss: 0.6615357
	speed: 0.1319s/iter; left time: 4829.1324s
Epoch: 1 cost time: 55.15555191040039
Epoch: 1, Steps: 369 | Train Loss: 1.063 Vali Loss: 0.675 Vali Acc: 0.675 Test Loss: 0.675 Test Acc: 0.675
Validation loss decreased (inf --> -0.674511).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2471790
	speed: 0.5918s/iter; left time: 21561.1278s
	iters: 200, epoch: 2 | loss: 0.2024521
	speed: 0.1281s/iter; left time: 4654.0042s
	iters: 300, epoch: 2 | loss: 1.0839380
	speed: 0.1358s/iter; left time: 4918.8940s
Epoch: 2 cost time: 49.89569926261902
Epoch: 2, Steps: 369 | Train Loss: 0.847 Vali Loss: 0.980 Vali Acc: 0.501 Test Loss: 0.980 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4860392
	speed: 0.5333s/iter; left time: 19231.7939s
	iters: 200, epoch: 3 | loss: 0.5473128
	speed: 0.1287s/iter; left time: 4628.5910s
	iters: 300, epoch: 3 | loss: 0.9407901
	speed: 0.1211s/iter; left time: 4341.6142s
Epoch: 3 cost time: 48.713831186294556
Epoch: 3, Steps: 369 | Train Loss: 0.893 Vali Loss: 2.093 Vali Acc: 0.500 Test Loss: 2.093 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8487619
	speed: 0.5470s/iter; left time: 19525.8446s
	iters: 200, epoch: 4 | loss: 0.8115962
	speed: 0.1483s/iter; left time: 5279.3020s
	iters: 300, epoch: 4 | loss: 1.5771759
	speed: 0.1258s/iter; left time: 4463.4766s
Epoch: 4 cost time: 50.64555740356445
Epoch: 4, Steps: 369 | Train Loss: 0.894 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.7638186
	speed: 0.5820s/iter; left time: 20560.4518s
	iters: 200, epoch: 5 | loss: 0.7695927
	speed: 0.1368s/iter; left time: 4819.4481s
	iters: 300, epoch: 5 | loss: 0.6735725
	speed: 0.1339s/iter; left time: 4703.8933s
Epoch: 5 cost time: 52.76165509223938
Epoch: 5, Steps: 369 | Train Loss: 0.952 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.1044551
	speed: 0.5954s/iter; left time: 20814.0009s
	iters: 200, epoch: 6 | loss: 0.6664932
	speed: 0.1438s/iter; left time: 5013.9972s
	iters: 300, epoch: 6 | loss: 0.6708260
	speed: 0.1410s/iter; left time: 4899.4693s
Epoch: 6 cost time: 54.393590688705444
Epoch: 6, Steps: 369 | Train Loss: 0.890 Vali Loss: 0.895 Vali Acc: 0.500 Test Loss: 0.895 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7348132
	speed: 0.5977s/iter; left time: 20671.0223s
	iters: 200, epoch: 7 | loss: 0.8201602
	speed: 0.1438s/iter; left time: 4958.5682s
	iters: 300, epoch: 7 | loss: 0.7436963
	speed: 0.1397s/iter; left time: 4803.6696s
Epoch: 7 cost time: 54.123183488845825
Epoch: 7, Steps: 369 | Train Loss: 0.730 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.8245230
	speed: 0.6042s/iter; left time: 20673.7795s
	iters: 200, epoch: 8 | loss: 0.6989514
	speed: 0.1348s/iter; left time: 4600.2241s
	iters: 300, epoch: 8 | loss: 0.7232996
	speed: 0.1443s/iter; left time: 4910.1049s
Epoch: 8 cost time: 52.845200538635254
Epoch: 8, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6892534
	speed: 0.5865s/iter; left time: 19850.8179s
	iters: 200, epoch: 9 | loss: 0.7292398
	speed: 0.1344s/iter; left time: 4537.2425s
	iters: 300, epoch: 9 | loss: 0.6518226
	speed: 0.1486s/iter; left time: 4999.3099s
Epoch: 9 cost time: 52.87611722946167
Epoch: 9, Steps: 369 | Train Loss: 0.791 Vali Loss: 1.085 Vali Acc: 0.500 Test Loss: 1.085 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.0184520
	speed: 0.5721s/iter; left time: 19153.3418s
	iters: 200, epoch: 10 | loss: 0.7545769
	speed: 0.1251s/iter; left time: 4176.7028s
	iters: 300, epoch: 10 | loss: 0.6727053
	speed: 0.1479s/iter; left time: 4922.3230s
Epoch: 10 cost time: 53.139952421188354
Epoch: 10, Steps: 369 | Train Loss: 0.817 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.7077190
	speed: 0.6130s/iter; left time: 20295.8434s
	iters: 200, epoch: 11 | loss: 0.7336847
	speed: 0.1436s/iter; left time: 4740.9355s
	iters: 300, epoch: 11 | loss: 0.7944536
	speed: 0.1391s/iter; left time: 4578.7945s
Epoch: 11 cost time: 53.52482891082764
Epoch: 11, Steps: 369 | Train Loss: 0.783 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6745175936435869
model parameter : 8244914
model size : 36.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.4070091
	speed: 0.1706s/iter; left time: 6279.8197s
	iters: 200, epoch: 1 | loss: 0.5923364
	speed: 0.1350s/iter; left time: 4955.2317s
	iters: 300, epoch: 1 | loss: 0.5684583
	speed: 0.1377s/iter; left time: 5041.0330s
Epoch: 1 cost time: 53.261494159698486
Epoch: 1, Steps: 369 | Train Loss: 1.091 Vali Loss: 1.762 Vali Acc: 0.500 Test Loss: 1.762 Test Acc: 0.500
Validation loss decreased (inf --> -0.499982).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5741982
	speed: 0.5805s/iter; left time: 21150.4561s
	iters: 200, epoch: 2 | loss: 0.5656560
	speed: 0.1344s/iter; left time: 4884.8016s
	iters: 300, epoch: 2 | loss: 0.3011560
	speed: 0.1387s/iter; left time: 5026.3693s
Epoch: 2 cost time: 52.9601788520813
Epoch: 2, Steps: 369 | Train Loss: 0.928 Vali Loss: 0.691 Vali Acc: 0.619 Test Loss: 0.691 Test Acc: 0.619
Validation loss decreased (-0.499982 --> -0.618608).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6987483
	speed: 0.5631s/iter; left time: 20308.4100s
	iters: 200, epoch: 3 | loss: 0.6927018
	speed: 0.1318s/iter; left time: 4739.8313s
	iters: 300, epoch: 3 | loss: 0.9027182
	speed: 0.1338s/iter; left time: 4800.2407s
Epoch: 3 cost time: 52.239076137542725
Epoch: 3, Steps: 369 | Train Loss: 0.895 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0119599
	speed: 0.5778s/iter; left time: 20624.5075s
	iters: 200, epoch: 4 | loss: 0.8588009
	speed: 0.1372s/iter; left time: 4884.6198s
	iters: 300, epoch: 4 | loss: 0.8515780
	speed: 0.1306s/iter; left time: 4634.4151s
Epoch: 4 cost time: 51.580150842666626
Epoch: 4, Steps: 369 | Train Loss: 0.892 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.9829924
	speed: 0.5510s/iter; left time: 19462.6823s
	iters: 200, epoch: 5 | loss: 0.8740117
	speed: 0.1369s/iter; left time: 4823.7735s
	iters: 300, epoch: 5 | loss: 0.7328714
	speed: 0.1348s/iter; left time: 4734.2079s
Epoch: 5 cost time: 50.7576584815979
Epoch: 5, Steps: 369 | Train Loss: 0.766 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6887326
	speed: 0.5602s/iter; left time: 19582.2535s
	iters: 200, epoch: 6 | loss: 1.4183118
	speed: 0.1301s/iter; left time: 4536.3288s
	iters: 300, epoch: 6 | loss: 0.7171962
	speed: 0.1450s/iter; left time: 5040.1318s
Epoch: 6 cost time: 52.41954565048218
Epoch: 6, Steps: 369 | Train Loss: 0.731 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7318512
	speed: 0.5678s/iter; left time: 19637.9718s
	iters: 200, epoch: 7 | loss: 0.8149278
	speed: 0.1363s/iter; left time: 4700.6777s
	iters: 300, epoch: 7 | loss: 0.6791469
	speed: 0.1472s/iter; left time: 5060.8950s
Epoch: 7 cost time: 52.86619544029236
Epoch: 7, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.9619148
	speed: 0.5800s/iter; left time: 19846.8597s
	iters: 200, epoch: 8 | loss: 0.6848469
	speed: 0.1363s/iter; left time: 4648.6073s
	iters: 300, epoch: 8 | loss: 0.6746944
	speed: 0.1321s/iter; left time: 4494.1451s
Epoch: 8 cost time: 52.2247633934021
Epoch: 8, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7768569
	speed: 0.5794s/iter; left time: 19611.1070s
	iters: 200, epoch: 9 | loss: 0.6216660
	speed: 0.1369s/iter; left time: 4620.1186s
	iters: 300, epoch: 9 | loss: 0.7209430
	speed: 0.1169s/iter; left time: 3933.9921s
Epoch: 9 cost time: 50.43006229400635
Epoch: 9, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.7861513
	speed: 0.5729s/iter; left time: 19181.4769s
	iters: 200, epoch: 10 | loss: 0.7042059
	speed: 0.1286s/iter; left time: 4292.5760s
	iters: 300, epoch: 10 | loss: 0.6912782
	speed: 0.1329s/iter; left time: 4421.8877s
Epoch: 10 cost time: 49.58396577835083
Epoch: 10, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7868367
	speed: 0.5393s/iter; left time: 17858.2868s
	iters: 200, epoch: 11 | loss: 0.7293015
	speed: 0.1307s/iter; left time: 4313.7505s
	iters: 300, epoch: 11 | loss: 0.6802088
	speed: 0.1339s/iter; left time: 4407.1363s
Epoch: 11 cost time: 51.53367280960083
Epoch: 11, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7264495
	speed: 0.5669s/iter; left time: 18561.4454s
	iters: 200, epoch: 12 | loss: 0.7065508
	speed: 0.1390s/iter; left time: 4537.2324s
	iters: 300, epoch: 12 | loss: 0.8089919
	speed: 0.1415s/iter; left time: 4603.6625s
Epoch: 12 cost time: 52.18481111526489
Epoch: 12, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6186152099886493
model parameter : 8242098
model size : 36.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1617466
	speed: 0.1812s/iter; left time: 6668.9423s
	iters: 200, epoch: 1 | loss: 0.6874446
	speed: 0.1312s/iter; left time: 4813.7611s
	iters: 300, epoch: 1 | loss: 1.3963674
	speed: 0.1279s/iter; left time: 4681.6983s
Epoch: 1 cost time: 53.03036427497864
Epoch: 1, Steps: 369 | Train Loss: 1.195 Vali Loss: 0.993 Vali Acc: 0.502 Test Loss: 0.993 Test Acc: 0.502
Validation loss decreased (inf --> -0.501693).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1021075
	speed: 0.5737s/iter; left time: 20902.0375s
	iters: 200, epoch: 2 | loss: 0.6941943
	speed: 0.1533s/iter; left time: 5568.8091s
	iters: 300, epoch: 2 | loss: 0.7237297
	speed: 0.1281s/iter; left time: 4639.6935s
Epoch: 2 cost time: 52.39584493637085
Epoch: 2, Steps: 369 | Train Loss: 0.853 Vali Loss: 0.734 Vali Acc: 0.651 Test Loss: 0.734 Test Acc: 0.651
Validation loss decreased (-0.501693 --> -0.651241).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6462063
	speed: 0.5991s/iter; left time: 21603.8626s
	iters: 200, epoch: 3 | loss: 0.8876510
	speed: 0.1261s/iter; left time: 4533.4659s
	iters: 300, epoch: 3 | loss: 0.7473516
	speed: 0.1298s/iter; left time: 4655.0624s
Epoch: 3 cost time: 49.22256088256836
Epoch: 3, Steps: 369 | Train Loss: 0.958 Vali Loss: 0.841 Vali Acc: 0.500 Test Loss: 0.841 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3236911
	speed: 0.5793s/iter; left time: 20677.5890s
	iters: 200, epoch: 4 | loss: 0.7567569
	speed: 0.1373s/iter; left time: 4887.8260s
	iters: 300, epoch: 4 | loss: 1.2383821
	speed: 0.1461s/iter; left time: 5186.5823s
Epoch: 4 cost time: 54.207656145095825
Epoch: 4, Steps: 369 | Train Loss: 0.910 Vali Loss: 1.330 Vali Acc: 0.500 Test Loss: 1.330 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6336568
	speed: 0.6052s/iter; left time: 21376.9363s
	iters: 200, epoch: 5 | loss: 1.0368981
	speed: 0.1379s/iter; left time: 4856.9786s
	iters: 300, epoch: 5 | loss: 0.6775521
	speed: 0.1356s/iter; left time: 4762.1868s
Epoch: 5 cost time: 52.97615146636963
Epoch: 5, Steps: 369 | Train Loss: 0.789 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6074200
	speed: 0.5718s/iter; left time: 19987.4363s
	iters: 200, epoch: 6 | loss: 0.8166276
	speed: 0.1545s/iter; left time: 5386.5633s
	iters: 300, epoch: 6 | loss: 0.9403114
	speed: 0.1417s/iter; left time: 4924.5561s
Epoch: 6 cost time: 53.72550868988037
Epoch: 6, Steps: 369 | Train Loss: 0.733 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.1761000
	speed: 0.5707s/iter; left time: 19738.0521s
	iters: 200, epoch: 7 | loss: 0.9451777
	speed: 0.1358s/iter; left time: 4684.9485s
	iters: 300, epoch: 7 | loss: 0.8179271
	speed: 0.1334s/iter; left time: 4586.6042s
Epoch: 7 cost time: 51.54802680015564
Epoch: 7, Steps: 369 | Train Loss: 1.131 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6839213
	speed: 0.5907s/iter; left time: 20213.1239s
	iters: 200, epoch: 8 | loss: 0.5366629
	speed: 0.1440s/iter; left time: 4914.5363s
	iters: 300, epoch: 8 | loss: 0.9255599
	speed: 0.1510s/iter; left time: 5135.8960s
Epoch: 8 cost time: 54.54608392715454
Epoch: 8, Steps: 369 | Train Loss: 0.941 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7807314
	speed: 0.5657s/iter; left time: 19147.2234s
	iters: 200, epoch: 9 | loss: 0.7566146
	speed: 0.1404s/iter; left time: 4737.2301s
	iters: 300, epoch: 9 | loss: 0.7077080
	speed: 0.1360s/iter; left time: 4577.3650s
Epoch: 9 cost time: 52.98771142959595
Epoch: 9, Steps: 369 | Train Loss: 0.759 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.7780699
	speed: 0.5991s/iter; left time: 20056.9494s
	iters: 200, epoch: 10 | loss: 0.7089876
	speed: 0.1483s/iter; left time: 4949.4391s
	iters: 300, epoch: 10 | loss: 0.7308698
	speed: 0.1294s/iter; left time: 4306.2188s
Epoch: 10 cost time: 53.33921432495117
Epoch: 10, Steps: 369 | Train Loss: 0.736 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6708997
	speed: 0.5817s/iter; left time: 19259.6823s
	iters: 200, epoch: 11 | loss: 0.7250460
	speed: 0.1381s/iter; left time: 4559.2261s
	iters: 300, epoch: 11 | loss: 0.6851043
	speed: 0.1405s/iter; left time: 4624.4497s
Epoch: 11 cost time: 52.71316933631897
Epoch: 11, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7438562
	speed: 0.6002s/iter; left time: 19651.1944s
	iters: 200, epoch: 12 | loss: 0.7424942
	speed: 0.1404s/iter; left time: 4581.7439s
	iters: 300, epoch: 12 | loss: 0.7527434
	speed: 0.1396s/iter; left time: 4544.0068s
Epoch: 12 cost time: 53.96686887741089
Epoch: 12, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6512485811577753
model parameter : 8239282
model size : 36.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.7651075
	speed: 0.1554s/iter; left time: 5717.7932s
	iters: 200, epoch: 1 | loss: 1.9528778
	speed: 0.1220s/iter; left time: 4479.1590s
	iters: 300, epoch: 1 | loss: 0.5328494
	speed: 0.1079s/iter; left time: 3950.9275s
Epoch: 1 cost time: 46.77270698547363
Epoch: 1, Steps: 369 | Train Loss: 0.981 Vali Loss: 1.495 Vali Acc: 0.501 Test Loss: 1.495 Test Acc: 0.501
Validation loss decreased (inf --> -0.501120).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7662949
	speed: 0.4671s/iter; left time: 17016.1307s
	iters: 200, epoch: 2 | loss: 1.0724081
	speed: 0.1191s/iter; left time: 4327.4027s
	iters: 300, epoch: 2 | loss: 1.6308154
	speed: 0.1169s/iter; left time: 4236.1728s
Epoch: 2 cost time: 44.82357931137085
Epoch: 2, Steps: 369 | Train Loss: 0.787 Vali Loss: 0.709 Vali Acc: 0.678 Test Loss: 0.709 Test Acc: 0.678
Validation loss decreased (-0.501120 --> -0.678199).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7666231
	speed: 0.4815s/iter; left time: 17364.1265s
	iters: 200, epoch: 3 | loss: 0.8875953
	speed: 0.1129s/iter; left time: 4058.7450s
	iters: 300, epoch: 3 | loss: 0.6911436
	speed: 0.1220s/iter; left time: 4376.9561s
Epoch: 3 cost time: 44.89646911621094
Epoch: 3, Steps: 369 | Train Loss: 0.755 Vali Loss: 0.679 Vali Acc: 0.646 Test Loss: 0.679 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6876593
	speed: 0.4944s/iter; left time: 17647.6947s
	iters: 200, epoch: 4 | loss: 0.3901765
	speed: 0.1198s/iter; left time: 4264.1215s
	iters: 300, epoch: 4 | loss: 0.5320560
	speed: 0.1175s/iter; left time: 4171.2441s
Epoch: 4 cost time: 43.87084770202637
Epoch: 4, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.611 Vali Acc: 0.673 Test Loss: 0.611 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7396245
	speed: 0.4826s/iter; left time: 17046.1568s
	iters: 200, epoch: 5 | loss: 0.7219872
	speed: 0.1225s/iter; left time: 4314.9609s
	iters: 300, epoch: 5 | loss: 0.8012491
	speed: 0.1261s/iter; left time: 4428.2405s
Epoch: 5 cost time: 46.18737530708313
Epoch: 5, Steps: 369 | Train Loss: 0.767 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7878875
	speed: 0.5072s/iter; left time: 17728.5066s
	iters: 200, epoch: 6 | loss: 0.7630512
	speed: 0.1318s/iter; left time: 4595.4544s
	iters: 300, epoch: 6 | loss: 0.6955263
	speed: 0.1329s/iter; left time: 4617.6324s
Epoch: 6 cost time: 50.19903612136841
Epoch: 6, Steps: 369 | Train Loss: 0.742 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.9711530
	speed: 0.5328s/iter; left time: 18428.5242s
	iters: 200, epoch: 7 | loss: 0.7543542
	speed: 0.1231s/iter; left time: 4245.0253s
	iters: 300, epoch: 7 | loss: 0.7148217
	speed: 0.1360s/iter; left time: 4674.9781s
Epoch: 7 cost time: 48.7769193649292
Epoch: 7, Steps: 369 | Train Loss: 0.824 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6107415
	speed: 0.5124s/iter; left time: 17533.4314s
	iters: 200, epoch: 8 | loss: 0.7846499
	speed: 0.1286s/iter; left time: 4387.5004s
	iters: 300, epoch: 8 | loss: 0.6274288
	speed: 0.1092s/iter; left time: 3715.4089s
Epoch: 8 cost time: 44.193196058273315
Epoch: 8, Steps: 369 | Train Loss: 0.779 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7542784
	speed: 0.5173s/iter; left time: 17510.6442s
	iters: 200, epoch: 9 | loss: 0.5992149
	speed: 0.1212s/iter; left time: 4090.4968s
	iters: 300, epoch: 9 | loss: 0.7135057
	speed: 0.1252s/iter; left time: 4213.7764s
Epoch: 9 cost time: 47.54162907600403
Epoch: 9, Steps: 369 | Train Loss: 0.731 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.5710549
	speed: 0.5158s/iter; left time: 17268.6419s
	iters: 200, epoch: 10 | loss: 0.7612072
	speed: 0.1183s/iter; left time: 3948.7817s
	iters: 300, epoch: 10 | loss: 0.7026621
	speed: 0.1356s/iter; left time: 4512.1864s
Epoch: 10 cost time: 46.76173663139343
Epoch: 10, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7224327
	speed: 0.5261s/iter; left time: 17419.2650s
	iters: 200, epoch: 11 | loss: 0.7395421
	speed: 0.1271s/iter; left time: 4197.1353s
	iters: 300, epoch: 11 | loss: 0.6490290
	speed: 0.1395s/iter; left time: 4591.1433s
Epoch: 11 cost time: 49.071271896362305
Epoch: 11, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7167000
	speed: 0.5177s/iter; left time: 16948.9903s
	iters: 200, epoch: 12 | loss: 0.6399123
	speed: 0.1296s/iter; left time: 4229.6453s
	iters: 300, epoch: 12 | loss: 0.7225245
	speed: 0.1186s/iter; left time: 3859.2993s
Epoch: 12 cost time: 47.99502491950989
Epoch: 12, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6782065834279228
model parameter : 3901234
model size : 17.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8889126
	speed: 0.1615s/iter; left time: 5944.6552s
	iters: 200, epoch: 1 | loss: 0.9549109
	speed: 0.1292s/iter; left time: 4743.5461s
	iters: 300, epoch: 1 | loss: 0.5829663
	speed: 0.1282s/iter; left time: 4693.5853s
Epoch: 1 cost time: 51.45693302154541
Epoch: 1, Steps: 369 | Train Loss: 0.885 Vali Loss: 1.126 Vali Acc: 0.514 Test Loss: 1.126 Test Acc: 0.514
Validation loss decreased (inf --> -0.514461).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6105629
	speed: 0.5615s/iter; left time: 20456.9266s
	iters: 200, epoch: 2 | loss: 0.7647420
	speed: 0.1389s/iter; left time: 5047.8798s
	iters: 300, epoch: 2 | loss: 0.6073802
	speed: 0.1318s/iter; left time: 4774.7551s
Epoch: 2 cost time: 52.01814389228821
Epoch: 2, Steps: 369 | Train Loss: 0.752 Vali Loss: 1.416 Vali Acc: 0.509 Test Loss: 1.416 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6709278
	speed: 0.5380s/iter; left time: 19400.6185s
	iters: 200, epoch: 3 | loss: 0.6097925
	speed: 0.1264s/iter; left time: 4544.0602s
	iters: 300, epoch: 3 | loss: 0.8175809
	speed: 0.1225s/iter; left time: 4393.1993s
Epoch: 3 cost time: 48.38515281677246
Epoch: 3, Steps: 369 | Train Loss: 0.750 Vali Loss: 1.315 Vali Acc: 0.500 Test Loss: 1.315 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7068336
	speed: 0.5290s/iter; left time: 18882.7957s
	iters: 200, epoch: 4 | loss: 0.5584677
	speed: 0.1135s/iter; left time: 4039.4878s
	iters: 300, epoch: 4 | loss: 0.9733233
	speed: 0.1158s/iter; left time: 4109.8789s
Epoch: 4 cost time: 45.72876524925232
Epoch: 4, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.665 Vali Acc: 0.643 Test Loss: 0.665 Test Acc: 0.643
Validation loss decreased (-0.514461 --> -0.642729).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6727863
	speed: 0.5285s/iter; left time: 18667.6138s
	iters: 200, epoch: 5 | loss: 0.7764115
	speed: 0.1239s/iter; left time: 4365.5682s
	iters: 300, epoch: 5 | loss: 0.7848377
	speed: 0.1176s/iter; left time: 4132.3875s
Epoch: 5 cost time: 46.22646355628967
Epoch: 5, Steps: 369 | Train Loss: 0.762 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6817861
	speed: 0.5320s/iter; left time: 18597.0288s
	iters: 200, epoch: 6 | loss: 0.7463595
	speed: 0.1257s/iter; left time: 4380.1098s
	iters: 300, epoch: 6 | loss: 0.7161417
	speed: 0.1256s/iter; left time: 4366.8688s
Epoch: 6 cost time: 47.25601887702942
Epoch: 6, Steps: 369 | Train Loss: 0.734 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6672613
	speed: 0.5027s/iter; left time: 17387.2246s
	iters: 200, epoch: 7 | loss: 0.7968914
	speed: 0.1267s/iter; left time: 4369.0361s
	iters: 300, epoch: 7 | loss: 0.7558360
	speed: 0.1254s/iter; left time: 4310.8206s
Epoch: 7 cost time: 48.16456341743469
Epoch: 7, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.7069546
	speed: 0.5371s/iter; left time: 18379.7650s
	iters: 200, epoch: 8 | loss: 0.6819732
	speed: 0.1202s/iter; left time: 4100.0266s
	iters: 300, epoch: 8 | loss: 0.6845982
	speed: 0.1247s/iter; left time: 4242.0451s
Epoch: 8 cost time: 46.211267948150635
Epoch: 8, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6688523
	speed: 0.5206s/iter; left time: 17622.4553s
	iters: 200, epoch: 9 | loss: 0.7624921
	speed: 0.1125s/iter; left time: 3795.1222s
	iters: 300, epoch: 9 | loss: 0.7202421
	speed: 0.1153s/iter; left time: 3879.8438s
Epoch: 9 cost time: 44.34921598434448
Epoch: 9, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.7078126
	speed: 0.5018s/iter; left time: 16799.0775s
	iters: 200, epoch: 10 | loss: 0.7235519
	speed: 0.1208s/iter; left time: 4031.8024s
	iters: 300, epoch: 10 | loss: 0.6775231
	speed: 0.1155s/iter; left time: 3842.6001s
Epoch: 10 cost time: 45.29373240470886
Epoch: 10, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.7221120
	speed: 0.5264s/iter; left time: 17430.4735s
	iters: 200, epoch: 11 | loss: 0.6967481
	speed: 0.1312s/iter; left time: 4331.0475s
	iters: 300, epoch: 11 | loss: 0.5720366
	speed: 0.1182s/iter; left time: 3889.5439s
Epoch: 11 cost time: 46.93680739402771
Epoch: 11, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.7579702
	speed: 0.4972s/iter; left time: 16280.2539s
	iters: 200, epoch: 12 | loss: 0.7019995
	speed: 0.1212s/iter; left time: 3956.4835s
	iters: 300, epoch: 12 | loss: 0.7122598
	speed: 0.1163s/iter; left time: 3784.6550s
Epoch: 12 cost time: 45.631800413131714
Epoch: 12, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.7158043
	speed: 0.5053s/iter; left time: 16359.1407s
	iters: 200, epoch: 13 | loss: 0.7205376
	speed: 0.1255s/iter; left time: 4049.0285s
	iters: 300, epoch: 13 | loss: 0.6938005
	speed: 0.1318s/iter; left time: 4240.1669s
Epoch: 13 cost time: 47.99210071563721
Epoch: 13, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.6820107
	speed: 0.5094s/iter; left time: 16302.7576s
	iters: 200, epoch: 14 | loss: 0.6587307
	speed: 0.1142s/iter; left time: 3644.3846s
	iters: 300, epoch: 14 | loss: 0.7166879
	speed: 0.1183s/iter; left time: 3763.5865s
Epoch: 14 cost time: 45.96773171424866
Epoch: 14, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6427355278093076
model parameter : 3899826
model size : 17.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9654989
	speed: 0.1501s/iter; left time: 5524.2313s
	iters: 200, epoch: 1 | loss: 0.6059470
	speed: 0.1216s/iter; left time: 4464.0498s
	iters: 300, epoch: 1 | loss: 1.0989245
	speed: 0.1164s/iter; left time: 4260.2277s
Epoch: 1 cost time: 46.34517025947571
Epoch: 1, Steps: 369 | Train Loss: 0.956 Vali Loss: 0.727 Vali Acc: 0.604 Test Loss: 0.727 Test Acc: 0.604
Validation loss decreased (inf --> -0.603852).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5858651
	speed: 0.4570s/iter; left time: 16650.8107s
	iters: 200, epoch: 2 | loss: 0.4682777
	speed: 0.1143s/iter; left time: 4154.0664s
	iters: 300, epoch: 2 | loss: 0.7925156
	speed: 0.1235s/iter; left time: 4473.5850s
Epoch: 2 cost time: 44.888365030288696
Epoch: 2, Steps: 369 | Train Loss: 0.751 Vali Loss: 0.671 Vali Acc: 0.603 Test Loss: 0.671 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7408157
	speed: 0.4726s/iter; left time: 17044.9327s
	iters: 200, epoch: 3 | loss: 0.3117577
	speed: 0.1130s/iter; left time: 4062.5623s
	iters: 300, epoch: 3 | loss: 1.4599526
	speed: 0.1092s/iter; left time: 3914.7362s
Epoch: 3 cost time: 42.58482503890991
Epoch: 3, Steps: 369 | Train Loss: 0.736 Vali Loss: 0.882 Vali Acc: 0.628 Test Loss: 0.882 Test Acc: 0.628
Validation loss decreased (-0.603852 --> -0.627971).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6636573
	speed: 0.4649s/iter; left time: 16592.8844s
	iters: 200, epoch: 4 | loss: 0.6635053
	speed: 0.1035s/iter; left time: 3683.6370s
	iters: 300, epoch: 4 | loss: 0.6942336
	speed: 0.1115s/iter; left time: 3956.6600s
Epoch: 4 cost time: 41.60444211959839
Epoch: 4, Steps: 369 | Train Loss: 0.972 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8259327
	speed: 0.4531s/iter; left time: 16005.9970s
	iters: 200, epoch: 5 | loss: 0.7278669
	speed: 0.1078s/iter; left time: 3795.6339s
	iters: 300, epoch: 5 | loss: 0.7238355
	speed: 0.1081s/iter; left time: 3797.6960s
Epoch: 5 cost time: 41.82972526550293
Epoch: 5, Steps: 369 | Train Loss: 0.864 Vali Loss: 0.772 Vali Acc: 0.500 Test Loss: 0.772 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7280710
	speed: 0.4971s/iter; left time: 17376.7212s
	iters: 200, epoch: 6 | loss: 0.7073439
	speed: 0.1261s/iter; left time: 4394.4353s
	iters: 300, epoch: 6 | loss: 0.8502436
	speed: 0.1282s/iter; left time: 4454.9640s
Epoch: 6 cost time: 47.92432999610901
Epoch: 6, Steps: 369 | Train Loss: 0.744 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6913172
	speed: 0.5015s/iter; left time: 17344.7843s
	iters: 200, epoch: 7 | loss: 0.6533957
	speed: 0.1201s/iter; left time: 4142.3961s
	iters: 300, epoch: 7 | loss: 0.7766917
	speed: 0.1173s/iter; left time: 4034.0080s
Epoch: 7 cost time: 45.362226724624634
Epoch: 7, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6900541
	speed: 0.5006s/iter; left time: 17130.3906s
	iters: 200, epoch: 8 | loss: 0.6555837
	speed: 0.1162s/iter; left time: 3965.2062s
	iters: 300, epoch: 8 | loss: 0.6966268
	speed: 0.1252s/iter; left time: 4257.6501s
Epoch: 8 cost time: 45.109302282333374
Epoch: 8, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.8169762
	speed: 0.5062s/iter; left time: 17134.8571s
	iters: 200, epoch: 9 | loss: 0.6491315
	speed: 0.1179s/iter; left time: 3978.2321s
	iters: 300, epoch: 9 | loss: 0.6936944
	speed: 0.1109s/iter; left time: 3733.1862s
Epoch: 9 cost time: 44.296961069107056
Epoch: 9, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.6959282
	speed: 0.4928s/iter; left time: 16500.3385s
	iters: 200, epoch: 10 | loss: 0.6909633
	speed: 0.1163s/iter; left time: 3881.0483s
	iters: 300, epoch: 10 | loss: 0.6686538
	speed: 0.1171s/iter; left time: 3898.1687s
Epoch: 10 cost time: 44.9733943939209
Epoch: 10, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.7888440
	speed: 0.4988s/iter; left time: 16516.0341s
	iters: 200, epoch: 11 | loss: 0.7070916
	speed: 0.1098s/iter; left time: 3625.1869s
	iters: 300, epoch: 11 | loss: 0.6434810
	speed: 0.1085s/iter; left time: 3570.7353s
Epoch: 11 cost time: 42.14860987663269
Epoch: 11, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.6775677
	speed: 0.4907s/iter; left time: 16066.0863s
	iters: 200, epoch: 12 | loss: 0.6853197
	speed: 0.1125s/iter; left time: 3673.0832s
	iters: 300, epoch: 12 | loss: 0.7002555
	speed: 0.1141s/iter; left time: 3711.5677s
Epoch: 12 cost time: 44.8618950843811
Epoch: 12, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.7197352
	speed: 0.4695s/iter; left time: 15198.6214s
	iters: 200, epoch: 13 | loss: 0.6956948
	speed: 0.1171s/iter; left time: 3779.6919s
	iters: 300, epoch: 13 | loss: 0.7003207
	speed: 0.1097s/iter; left time: 3527.8581s
Epoch: 13 cost time: 43.354126930236816
Epoch: 13, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6279795686719637
model parameter : 3898418
model size : 17.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9949390
	speed: 0.1510s/iter; left time: 5555.1588s
	iters: 200, epoch: 1 | loss: 1.6699044
	speed: 0.1162s/iter; left time: 4262.9969s
	iters: 300, epoch: 1 | loss: 0.6770041
	speed: 0.1146s/iter; left time: 4194.4538s
Epoch: 1 cost time: 46.65381360054016
Epoch: 1, Steps: 369 | Train Loss: 0.906 Vali Loss: 0.769 Vali Acc: 0.663 Test Loss: 0.769 Test Acc: 0.663
Validation loss decreased (inf --> -0.662875).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6151114
	speed: 0.4988s/iter; left time: 18170.9747s
	iters: 200, epoch: 2 | loss: 0.5021709
	speed: 0.1213s/iter; left time: 4407.1278s
	iters: 300, epoch: 2 | loss: 0.8876934
	speed: 0.1210s/iter; left time: 4383.6253s
Epoch: 2 cost time: 45.92038321495056
Epoch: 2, Steps: 369 | Train Loss: 0.751 Vali Loss: 0.705 Vali Acc: 0.655 Test Loss: 0.705 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7967475
	speed: 0.4956s/iter; left time: 17873.9936s
	iters: 200, epoch: 3 | loss: 0.8480800
	speed: 0.1242s/iter; left time: 4465.6754s
	iters: 300, epoch: 3 | loss: 0.3858409
	speed: 0.1173s/iter; left time: 4206.0505s
Epoch: 3 cost time: 45.53723359107971
Epoch: 3, Steps: 369 | Train Loss: 0.776 Vali Loss: 1.579 Vali Acc: 0.503 Test Loss: 1.579 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9971230
	speed: 0.5014s/iter; left time: 17895.2426s
	iters: 200, epoch: 4 | loss: 0.8563264
	speed: 0.1292s/iter; left time: 4599.4967s
	iters: 300, epoch: 4 | loss: 1.1496464
	speed: 0.1221s/iter; left time: 4334.9548s
Epoch: 4 cost time: 47.156471729278564
Epoch: 4, Steps: 369 | Train Loss: 0.776 Vali Loss: 1.124 Vali Acc: 0.503 Test Loss: 1.124 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6262682
	speed: 0.4894s/iter; left time: 17287.1244s
	iters: 200, epoch: 5 | loss: 0.7498659
	speed: 0.1172s/iter; left time: 4127.0345s
	iters: 300, epoch: 5 | loss: 0.8181681
	speed: 0.1221s/iter; left time: 4288.5861s
Epoch: 5 cost time: 45.3687801361084
Epoch: 5, Steps: 369 | Train Loss: 0.764 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.8657398
	speed: 0.5136s/iter; left time: 17954.9246s
	iters: 200, epoch: 6 | loss: 0.7413771
	speed: 0.1262s/iter; left time: 4398.0970s
	iters: 300, epoch: 6 | loss: 0.7844539
	speed: 0.1110s/iter; left time: 3858.7872s
Epoch: 6 cost time: 44.13795757293701
Epoch: 6, Steps: 369 | Train Loss: 0.748 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7592204
	speed: 0.4944s/iter; left time: 17098.7179s
	iters: 200, epoch: 7 | loss: 0.6406476
	speed: 0.1156s/iter; left time: 3987.6344s
	iters: 300, epoch: 7 | loss: 0.7184184
	speed: 0.1203s/iter; left time: 4137.2915s
Epoch: 7 cost time: 44.93228530883789
Epoch: 7, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7659193
	speed: 0.4827s/iter; left time: 16516.6114s
	iters: 200, epoch: 8 | loss: 0.6663200
	speed: 0.1186s/iter; left time: 4044.8321s
	iters: 300, epoch: 8 | loss: 0.6637426
	speed: 0.1144s/iter; left time: 3889.9933s
Epoch: 8 cost time: 44.27891516685486
Epoch: 8, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7080756
	speed: 0.4761s/iter; left time: 16114.2033s
	iters: 200, epoch: 9 | loss: 0.7601191
	speed: 0.1152s/iter; left time: 3886.9814s
	iters: 300, epoch: 9 | loss: 0.8706769
	speed: 0.1182s/iter; left time: 3977.9783s
Epoch: 9 cost time: 44.23533487319946
Epoch: 9, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6906284
	speed: 0.4713s/iter; left time: 15778.8676s
	iters: 200, epoch: 10 | loss: 0.6463978
	speed: 0.1072s/iter; left time: 3579.0983s
	iters: 300, epoch: 10 | loss: 0.7058783
	speed: 0.1184s/iter; left time: 3938.8861s
Epoch: 10 cost time: 43.19692611694336
Epoch: 10, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.5707279
	speed: 0.4804s/iter; left time: 15908.1163s
	iters: 200, epoch: 11 | loss: 0.7211273
	speed: 0.1122s/iter; left time: 3704.3830s
	iters: 300, epoch: 11 | loss: 0.7084622
	speed: 0.1086s/iter; left time: 3572.9920s
Epoch: 11 cost time: 43.24583649635315
Epoch: 11, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.662883087400681
model parameter : 3897010
model size : 17.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7400401
	speed: 0.1157s/iter; left time: 4256.5455s
	iters: 200, epoch: 1 | loss: 1.8307170
	speed: 0.0919s/iter; left time: 3374.4098s
	iters: 300, epoch: 1 | loss: 1.0372963
	speed: 0.0950s/iter; left time: 3477.9227s
Epoch: 1 cost time: 36.44159483909607
Epoch: 1, Steps: 369 | Train Loss: 0.899 Vali Loss: 0.736 Vali Acc: 0.641 Test Loss: 0.736 Test Acc: 0.641
Validation loss decreased (inf --> -0.641026).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2885183
	speed: 0.3913s/iter; left time: 14257.4932s
	iters: 200, epoch: 2 | loss: 0.6244326
	speed: 0.0918s/iter; left time: 3336.4314s
	iters: 300, epoch: 2 | loss: 0.6431558
	speed: 0.0997s/iter; left time: 3611.5210s
Epoch: 2 cost time: 35.7124183177948
Epoch: 2, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.660 Vali Acc: 0.642 Test Loss: 0.660 Test Acc: 0.642
Validation loss decreased (-0.641026 --> -0.642445).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7611948
	speed: 0.3922s/iter; left time: 14142.6366s
	iters: 200, epoch: 3 | loss: 0.6109539
	speed: 0.0972s/iter; left time: 3494.4956s
	iters: 300, epoch: 3 | loss: 0.8816175
	speed: 0.0904s/iter; left time: 3240.8534s
Epoch: 3 cost time: 35.20581364631653
Epoch: 3, Steps: 369 | Train Loss: 0.688 Vali Loss: 0.629 Vali Acc: 0.666 Test Loss: 0.629 Test Acc: 0.666
Validation loss decreased (-0.642445 --> -0.666282).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7626166
	speed: 0.4194s/iter; left time: 14970.0556s
	iters: 200, epoch: 4 | loss: 0.3787211
	speed: 0.1068s/iter; left time: 3801.9723s
	iters: 300, epoch: 4 | loss: 0.4082848
	speed: 0.1072s/iter; left time: 3806.1806s
Epoch: 4 cost time: 40.880088329315186
Epoch: 4, Steps: 369 | Train Loss: 0.677 Vali Loss: 0.685 Vali Acc: 0.644 Test Loss: 0.685 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5181135
	speed: 0.4419s/iter; left time: 15610.1577s
	iters: 200, epoch: 5 | loss: 0.1956712
	speed: 0.1103s/iter; left time: 3886.1226s
	iters: 300, epoch: 5 | loss: 0.5362992
	speed: 0.1108s/iter; left time: 3893.1466s
Epoch: 5 cost time: 41.35671615600586
Epoch: 5, Steps: 369 | Train Loss: 0.638 Vali Loss: 0.679 Vali Acc: 0.616 Test Loss: 0.679 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5015982
	speed: 0.4374s/iter; left time: 15290.2244s
	iters: 200, epoch: 6 | loss: 0.7099634
	speed: 0.1078s/iter; left time: 3758.1813s
	iters: 300, epoch: 6 | loss: 0.4854446
	speed: 0.1088s/iter; left time: 3780.6229s
Epoch: 6 cost time: 40.111226081848145
Epoch: 6, Steps: 369 | Train Loss: 0.655 Vali Loss: 0.642 Vali Acc: 0.630 Test Loss: 0.642 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7188671
	speed: 0.4495s/iter; left time: 15546.6373s
	iters: 200, epoch: 7 | loss: 0.7758758
	speed: 0.1122s/iter; left time: 3870.4354s
	iters: 300, epoch: 7 | loss: 0.6731244
	speed: 0.1082s/iter; left time: 3719.9185s
Epoch: 7 cost time: 41.174832344055176
Epoch: 7, Steps: 369 | Train Loss: 0.653 Vali Loss: 0.655 Vali Acc: 0.638 Test Loss: 0.655 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.5691819
	speed: 0.4352s/iter; left time: 14892.6241s
	iters: 200, epoch: 8 | loss: 0.5617859
	speed: 0.0978s/iter; left time: 3336.4265s
	iters: 300, epoch: 8 | loss: 0.8300440
	speed: 0.1046s/iter; left time: 3557.6422s
Epoch: 8 cost time: 38.916146993637085
Epoch: 8, Steps: 369 | Train Loss: 0.606 Vali Loss: 0.692 Vali Acc: 0.627 Test Loss: 0.692 Test Acc: 0.627
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6656370
	speed: 0.4503s/iter; left time: 15243.4008s
	iters: 200, epoch: 9 | loss: 0.6959077
	speed: 0.1112s/iter; left time: 3752.0293s
	iters: 300, epoch: 9 | loss: 0.6804531
	speed: 0.1109s/iter; left time: 3731.1094s
Epoch: 9 cost time: 41.590585708618164
Epoch: 9, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7218305
	speed: 0.4303s/iter; left time: 14406.0366s
	iters: 200, epoch: 10 | loss: 0.7284617
	speed: 0.1026s/iter; left time: 3424.1664s
	iters: 300, epoch: 10 | loss: 0.7169975
	speed: 0.1119s/iter; left time: 3722.6836s
Epoch: 10 cost time: 40.804912090301514
Epoch: 10, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.8062243
	speed: 0.4435s/iter; left time: 14683.1080s
	iters: 200, epoch: 11 | loss: 0.6747975
	speed: 0.1189s/iter; left time: 3925.1137s
	iters: 300, epoch: 11 | loss: 0.5978565
	speed: 0.1069s/iter; left time: 3519.3674s
Epoch: 11 cost time: 42.390018463134766
Epoch: 11, Steps: 369 | Train Loss: 0.749 Vali Loss: 1.998 Vali Acc: 0.500 Test Loss: 1.998 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.5700235
	speed: 0.4344s/iter; left time: 14222.9107s
	iters: 200, epoch: 12 | loss: 0.7926757
	speed: 0.0986s/iter; left time: 3218.8133s
	iters: 300, epoch: 12 | loss: 0.7354543
	speed: 0.1021s/iter; left time: 3322.8177s
Epoch: 12 cost time: 39.7053656578064
Epoch: 12, Steps: 369 | Train Loss: 1.200 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.0015162
	speed: 0.4457s/iter; left time: 14428.6588s
	iters: 200, epoch: 13 | loss: 0.6822704
	speed: 0.1007s/iter; left time: 3249.7205s
	iters: 300, epoch: 13 | loss: 0.6745498
	speed: 0.1015s/iter; left time: 3266.6758s
Epoch: 13 cost time: 39.678340911865234
Epoch: 13, Steps: 369 | Train Loss: 0.863 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6662883087400681
model parameter : 2980146
model size : 13.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6226311
	speed: 0.1406s/iter; left time: 5173.0969s
	iters: 200, epoch: 1 | loss: 2.7314339
	speed: 0.0976s/iter; left time: 3583.1903s
	iters: 300, epoch: 1 | loss: 0.7130911
	speed: 0.1033s/iter; left time: 3782.5117s
Epoch: 1 cost time: 41.12528920173645
Epoch: 1, Steps: 369 | Train Loss: 1.021 Vali Loss: 2.061 Vali Acc: 0.501 Test Loss: 2.061 Test Acc: 0.501
Validation loss decreased (inf --> -0.500831).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4700017
	speed: 0.4012s/iter; left time: 14617.7884s
	iters: 200, epoch: 2 | loss: 0.4934861
	speed: 0.1011s/iter; left time: 3671.7082s
	iters: 300, epoch: 2 | loss: 1.4531130
	speed: 0.1005s/iter; left time: 3640.2760s
Epoch: 2 cost time: 38.65318822860718
Epoch: 2, Steps: 369 | Train Loss: 0.829 Vali Loss: 1.477 Vali Acc: 0.527 Test Loss: 1.477 Test Acc: 0.527
Validation loss decreased (-0.500831 --> -0.526943).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7680269
	speed: 0.4153s/iter; left time: 14977.5340s
	iters: 200, epoch: 3 | loss: 0.5881983
	speed: 0.0989s/iter; left time: 3558.0985s
	iters: 300, epoch: 3 | loss: 0.8324534
	speed: 0.1007s/iter; left time: 3613.1138s
Epoch: 3 cost time: 39.446227073669434
Epoch: 3, Steps: 369 | Train Loss: 0.769 Vali Loss: 0.654 Vali Acc: 0.636 Test Loss: 0.654 Test Acc: 0.636
Validation loss decreased (-0.526943 --> -0.635919).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6226131
	speed: 0.4037s/iter; left time: 14410.8747s
	iters: 200, epoch: 4 | loss: 0.4554323
	speed: 0.1042s/iter; left time: 3708.9973s
	iters: 300, epoch: 4 | loss: 0.4181283
	speed: 0.1129s/iter; left time: 4008.3303s
Epoch: 4 cost time: 41.596145153045654
Epoch: 4, Steps: 369 | Train Loss: 0.677 Vali Loss: 1.337 Vali Acc: 0.535 Test Loss: 1.337 Test Acc: 0.535
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5572376
	speed: 0.4277s/iter; left time: 15107.2909s
	iters: 200, epoch: 5 | loss: 0.8241099
	speed: 0.1015s/iter; left time: 3575.0934s
	iters: 300, epoch: 5 | loss: 0.8412515
	speed: 0.0990s/iter; left time: 3478.4099s
Epoch: 5 cost time: 38.0593376159668
Epoch: 5, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5830956
	speed: 0.4094s/iter; left time: 14312.3141s
	iters: 200, epoch: 6 | loss: 0.7162676
	speed: 0.1070s/iter; left time: 3728.0613s
	iters: 300, epoch: 6 | loss: 0.5778977
	speed: 0.1030s/iter; left time: 3581.2153s
Epoch: 6 cost time: 40.78245759010315
Epoch: 6, Steps: 369 | Train Loss: 0.741 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7140891
	speed: 0.4162s/iter; left time: 14396.6197s
	iters: 200, epoch: 7 | loss: 0.7040901
	speed: 0.1050s/iter; left time: 3621.0159s
	iters: 300, epoch: 7 | loss: 0.6831053
	speed: 0.0970s/iter; left time: 3335.9286s
Epoch: 7 cost time: 38.05082583427429
Epoch: 7, Steps: 369 | Train Loss: 0.729 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6770190
	speed: 0.4182s/iter; left time: 14310.7123s
	iters: 200, epoch: 8 | loss: 0.7195076
	speed: 0.1108s/iter; left time: 3780.5309s
	iters: 300, epoch: 8 | loss: 0.7157723
	speed: 0.1042s/iter; left time: 3546.3434s
Epoch: 8 cost time: 41.45522117614746
Epoch: 8, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.7325077
	speed: 0.4014s/iter; left time: 13588.6551s
	iters: 200, epoch: 9 | loss: 0.7047434
	speed: 0.1093s/iter; left time: 3690.0185s
	iters: 300, epoch: 9 | loss: 0.7534847
	speed: 0.1016s/iter; left time: 3417.3639s
Epoch: 9 cost time: 38.66112732887268
Epoch: 9, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7437052
	speed: 0.4174s/iter; left time: 13973.9730s
	iters: 200, epoch: 10 | loss: 0.7388765
	speed: 0.1000s/iter; left time: 3336.5886s
	iters: 300, epoch: 10 | loss: 0.7056329
	speed: 0.0966s/iter; left time: 3215.6493s
Epoch: 10 cost time: 39.034738063812256
Epoch: 10, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.7415544
	speed: 0.3978s/iter; left time: 13169.9555s
	iters: 200, epoch: 11 | loss: 0.7048401
	speed: 0.0967s/iter; left time: 3191.5461s
	iters: 300, epoch: 11 | loss: 0.6098423
	speed: 0.0992s/iter; left time: 3266.1634s
Epoch: 11 cost time: 37.15350079536438
Epoch: 11, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.7672010
	speed: 0.4254s/iter; left time: 13927.0083s
	iters: 200, epoch: 12 | loss: 0.7829630
	speed: 0.1016s/iter; left time: 3317.9521s
	iters: 300, epoch: 12 | loss: 0.6783856
	speed: 0.0989s/iter; left time: 3219.8292s
Epoch: 12 cost time: 39.535526514053345
Epoch: 12, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6859422
	speed: 0.4046s/iter; left time: 13098.2861s
	iters: 200, epoch: 13 | loss: 0.8168759
	speed: 0.0961s/iter; left time: 3101.8536s
	iters: 300, epoch: 13 | loss: 0.8245658
	speed: 0.1059s/iter; left time: 3406.9963s
Epoch: 13 cost time: 39.63547420501709
Epoch: 13, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6359250851305335
model parameter : 2978738
model size : 13.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9552425
	speed: 0.1347s/iter; left time: 4958.3347s
	iters: 200, epoch: 1 | loss: 0.8836701
	speed: 0.1227s/iter; left time: 4501.6623s
	iters: 300, epoch: 1 | loss: 0.8172402
	speed: 0.1137s/iter; left time: 4163.1867s
Epoch: 1 cost time: 43.831693172454834
Epoch: 1, Steps: 369 | Train Loss: 0.976 Vali Loss: 0.656 Vali Acc: 0.615 Test Loss: 0.656 Test Acc: 0.615
Validation loss decreased (inf --> -0.614920).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8375667
	speed: 0.3839s/iter; left time: 13987.7617s
	iters: 200, epoch: 2 | loss: 0.9306674
	speed: 0.0985s/iter; left time: 3577.1165s
	iters: 300, epoch: 2 | loss: 0.5939844
	speed: 0.0987s/iter; left time: 3577.2462s
Epoch: 2 cost time: 37.7195348739624
Epoch: 2, Steps: 369 | Train Loss: 0.766 Vali Loss: 0.692 Vali Acc: 0.594 Test Loss: 0.692 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1697154
	speed: 0.4126s/iter; left time: 14880.8257s
	iters: 200, epoch: 3 | loss: 0.5533707
	speed: 0.1182s/iter; left time: 4250.8646s
	iters: 300, epoch: 3 | loss: 0.3542332
	speed: 0.1115s/iter; left time: 3999.1810s
Epoch: 3 cost time: 41.256104707717896
Epoch: 3, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.720 Vali Acc: 0.642 Test Loss: 0.720 Test Acc: 0.642
Validation loss decreased (-0.614920 --> -0.642445).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8116613
	speed: 0.4095s/iter; left time: 14618.3584s
	iters: 200, epoch: 4 | loss: 1.0016706
	speed: 0.1046s/iter; left time: 3721.9461s
	iters: 300, epoch: 4 | loss: 1.6024848
	speed: 0.1026s/iter; left time: 3641.4176s
Epoch: 4 cost time: 40.109689474105835
Epoch: 4, Steps: 369 | Train Loss: 0.696 Vali Loss: 0.689 Vali Acc: 0.638 Test Loss: 0.689 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1148762
	speed: 0.4156s/iter; left time: 14680.7547s
	iters: 200, epoch: 5 | loss: 0.9609904
	speed: 0.1115s/iter; left time: 3926.6426s
	iters: 300, epoch: 5 | loss: 0.5935130
	speed: 0.1039s/iter; left time: 3649.4789s
Epoch: 5 cost time: 41.105064153671265
Epoch: 5, Steps: 369 | Train Loss: 0.678 Vali Loss: 0.654 Vali Acc: 0.620 Test Loss: 0.654 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6161057
	speed: 0.4106s/iter; left time: 14353.5936s
	iters: 200, epoch: 6 | loss: 0.6825317
	speed: 0.0934s/iter; left time: 3254.1208s
	iters: 300, epoch: 6 | loss: 0.7202739
	speed: 0.0933s/iter; left time: 3242.1177s
Epoch: 6 cost time: 39.014564990997314
Epoch: 6, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.8099035
	speed: 0.4052s/iter; left time: 14014.7685s
	iters: 200, epoch: 7 | loss: 0.7594594
	speed: 0.0959s/iter; left time: 3307.0425s
	iters: 300, epoch: 7 | loss: 0.6538390
	speed: 0.0975s/iter; left time: 3354.3357s
Epoch: 7 cost time: 36.28004789352417
Epoch: 7, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7087175
	speed: 0.3968s/iter; left time: 13578.1353s
	iters: 200, epoch: 8 | loss: 0.7615346
	speed: 0.1016s/iter; left time: 3465.8241s
	iters: 300, epoch: 8 | loss: 0.7428382
	speed: 0.1122s/iter; left time: 3815.4750s
Epoch: 8 cost time: 39.48110103607178
Epoch: 8, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6763743
	speed: 0.3975s/iter; left time: 13454.1023s
	iters: 200, epoch: 9 | loss: 0.7437418
	speed: 0.0994s/iter; left time: 3355.0273s
	iters: 300, epoch: 9 | loss: 0.7067981
	speed: 0.1019s/iter; left time: 3427.9648s
Epoch: 9 cost time: 38.805837869644165
Epoch: 9, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7193710
	speed: 0.4048s/iter; left time: 13554.0565s
	iters: 200, epoch: 10 | loss: 0.6539586
	speed: 0.1153s/iter; left time: 3849.8180s
	iters: 300, epoch: 10 | loss: 0.6941211
	speed: 0.1197s/iter; left time: 3984.2535s
Epoch: 10 cost time: 42.702568769454956
Epoch: 10, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.7144848
	speed: 0.4046s/iter; left time: 13397.4398s
	iters: 200, epoch: 11 | loss: 0.7333733
	speed: 0.0989s/iter; left time: 3265.8957s
	iters: 300, epoch: 11 | loss: 0.6983249
	speed: 0.1067s/iter; left time: 3511.9206s
Epoch: 11 cost time: 39.70972156524658
Epoch: 11, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.5798963
	speed: 0.3931s/iter; left time: 12870.2781s
	iters: 200, epoch: 12 | loss: 0.7069440
	speed: 0.1028s/iter; left time: 3356.2190s
	iters: 300, epoch: 12 | loss: 0.6798128
	speed: 0.1078s/iter; left time: 3506.6178s
Epoch: 12 cost time: 38.62907123565674
Epoch: 12, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6747506
	speed: 0.3986s/iter; left time: 12903.9982s
	iters: 200, epoch: 13 | loss: 0.6649868
	speed: 0.1011s/iter; left time: 3261.4855s
	iters: 300, epoch: 13 | loss: 0.6925562
	speed: 0.0945s/iter; left time: 3040.7944s
Epoch: 13 cost time: 38.198429346084595
Epoch: 13, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6424517593643587
model parameter : 2977330
model size : 13.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9740167
	speed: 0.1373s/iter; left time: 5051.7627s
	iters: 200, epoch: 1 | loss: 1.0965409
	speed: 0.1112s/iter; left time: 4079.7906s
	iters: 300, epoch: 1 | loss: 1.0901593
	speed: 0.1003s/iter; left time: 3670.6449s
Epoch: 1 cost time: 41.92117881774902
Epoch: 1, Steps: 369 | Train Loss: 1.057 Vali Loss: 1.092 Vali Acc: 0.551 Test Loss: 1.092 Test Acc: 0.551
Validation loss decreased (inf --> -0.551351).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3925333
	speed: 0.4010s/iter; left time: 14609.2663s
	iters: 200, epoch: 2 | loss: 0.5341744
	speed: 0.0968s/iter; left time: 3516.2514s
	iters: 300, epoch: 2 | loss: 0.7597670
	speed: 0.1038s/iter; left time: 3761.3140s
Epoch: 2 cost time: 38.65875768661499
Epoch: 2, Steps: 369 | Train Loss: 0.752 Vali Loss: 1.078 Vali Acc: 0.540 Test Loss: 1.078 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0782274
	speed: 0.3976s/iter; left time: 14338.8551s
	iters: 200, epoch: 3 | loss: 0.7154320
	speed: 0.1047s/iter; left time: 3765.7154s
	iters: 300, epoch: 3 | loss: 0.4245173
	speed: 0.1115s/iter; left time: 4000.5057s
Epoch: 3 cost time: 39.85669159889221
Epoch: 3, Steps: 369 | Train Loss: 0.735 Vali Loss: 0.749 Vali Acc: 0.651 Test Loss: 0.749 Test Acc: 0.651
Validation loss decreased (-0.551351 --> -0.650674).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7752291
	speed: 0.4141s/iter; left time: 14780.8461s
	iters: 200, epoch: 4 | loss: 1.0167917
	speed: 0.0919s/iter; left time: 3269.6470s
	iters: 300, epoch: 4 | loss: 0.6921579
	speed: 0.1060s/iter; left time: 3762.2746s
Epoch: 4 cost time: 38.991061210632324
Epoch: 4, Steps: 369 | Train Loss: 0.686 Vali Loss: 0.750 Vali Acc: 0.602 Test Loss: 0.750 Test Acc: 0.602
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4626286
	speed: 0.3981s/iter; left time: 14064.1677s
	iters: 200, epoch: 5 | loss: 0.6282400
	speed: 0.0961s/iter; left time: 3383.5973s
	iters: 300, epoch: 5 | loss: 0.6712261
	speed: 0.1004s/iter; left time: 3526.5386s
Epoch: 5 cost time: 36.13859224319458
Epoch: 5, Steps: 369 | Train Loss: 0.671 Vali Loss: 0.881 Vali Acc: 0.589 Test Loss: 0.881 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5738685
	speed: 0.4083s/iter; left time: 14272.8966s
	iters: 200, epoch: 6 | loss: 0.6010628
	speed: 0.1162s/iter; left time: 4050.1328s
	iters: 300, epoch: 6 | loss: 0.8085113
	speed: 0.1182s/iter; left time: 4107.5048s
Epoch: 6 cost time: 42.74851870536804
Epoch: 6, Steps: 369 | Train Loss: 0.689 Vali Loss: 0.760 Vali Acc: 0.549 Test Loss: 0.760 Test Acc: 0.549
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7330663
	speed: 0.4255s/iter; left time: 14717.2797s
	iters: 200, epoch: 7 | loss: 0.5890600
	speed: 0.1053s/iter; left time: 3631.4060s
	iters: 300, epoch: 7 | loss: 0.9128392
	speed: 0.1001s/iter; left time: 3442.3933s
Epoch: 7 cost time: 39.56413817405701
Epoch: 7, Steps: 369 | Train Loss: 0.682 Vali Loss: 0.688 Vali Acc: 0.589 Test Loss: 0.688 Test Acc: 0.589
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7066708
	speed: 0.4088s/iter; left time: 13989.2080s
	iters: 200, epoch: 8 | loss: 0.7942816
	speed: 0.1074s/iter; left time: 3662.8004s
	iters: 300, epoch: 8 | loss: 0.6555401
	speed: 0.1204s/iter; left time: 4094.5539s
Epoch: 8 cost time: 42.555147647857666
Epoch: 8, Steps: 369 | Train Loss: 0.789 Vali Loss: 0.906 Vali Acc: 0.500 Test Loss: 0.906 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 3.4668787
	speed: 0.4127s/iter; left time: 13970.4974s
	iters: 200, epoch: 9 | loss: 0.7509551
	speed: 0.1082s/iter; left time: 3650.2962s
	iters: 300, epoch: 9 | loss: 0.6981813
	speed: 0.1063s/iter; left time: 3575.4586s
Epoch: 9 cost time: 39.340076208114624
Epoch: 9, Steps: 369 | Train Loss: 1.008 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.6817954
	speed: 0.4016s/iter; left time: 13445.3575s
	iters: 200, epoch: 10 | loss: 0.6819484
	speed: 0.0975s/iter; left time: 3254.8212s
	iters: 300, epoch: 10 | loss: 0.7477893
	speed: 0.1050s/iter; left time: 3494.0364s
Epoch: 10 cost time: 39.54463267326355
Epoch: 10, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6856250
	speed: 0.4188s/iter; left time: 13867.9088s
	iters: 200, epoch: 11 | loss: 0.6994923
	speed: 0.1077s/iter; left time: 3554.3929s
	iters: 300, epoch: 11 | loss: 0.6709003
	speed: 0.0941s/iter; left time: 3095.3675s
Epoch: 11 cost time: 38.56073784828186
Epoch: 11, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.6860034
	speed: 0.4082s/iter; left time: 13366.8130s
	iters: 200, epoch: 12 | loss: 0.6777647
	speed: 0.1029s/iter; left time: 3359.5298s
	iters: 300, epoch: 12 | loss: 0.7638808
	speed: 0.1027s/iter; left time: 3341.0739s
Epoch: 12 cost time: 40.06795573234558
Epoch: 12, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6936855
	speed: 0.4075s/iter; left time: 13193.2029s
	iters: 200, epoch: 13 | loss: 0.6756825
	speed: 0.1046s/iter; left time: 3375.4089s
	iters: 300, epoch: 13 | loss: 0.6915475
	speed: 0.1088s/iter; left time: 3500.7436s
Epoch: 13 cost time: 41.267276763916016
Epoch: 13, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6506810442678774
model parameter : 2975922
model size : 13.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.6616931
	speed: 0.1243s/iter; left time: 4574.9749s
	iters: 200, epoch: 1 | loss: 0.5799606
	speed: 0.0928s/iter; left time: 3404.8934s
	iters: 300, epoch: 1 | loss: 0.6963472
	speed: 0.0929s/iter; left time: 3400.6822s
Epoch: 1 cost time: 38.47483777999878
Epoch: 1, Steps: 369 | Train Loss: 0.876 Vali Loss: 0.656 Vali Acc: 0.614 Test Loss: 0.656 Test Acc: 0.614
Validation loss decreased (inf --> -0.614352).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3497040
	speed: 0.4214s/iter; left time: 15353.4866s
	iters: 200, epoch: 2 | loss: 0.9702733
	speed: 0.1000s/iter; left time: 3633.8375s
	iters: 300, epoch: 2 | loss: 0.4600104
	speed: 0.0941s/iter; left time: 3409.1685s
Epoch: 2 cost time: 37.87895846366882
Epoch: 2, Steps: 369 | Train Loss: 0.732 Vali Loss: 0.719 Vali Acc: 0.655 Test Loss: 0.719 Test Acc: 0.655
Validation loss decreased (-0.614352 --> -0.654930).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6816040
	speed: 0.3898s/iter; left time: 14056.1072s
	iters: 200, epoch: 3 | loss: 0.6294483
	speed: 0.0970s/iter; left time: 3486.6657s
	iters: 300, epoch: 3 | loss: 0.5991657
	speed: 0.1039s/iter; left time: 3726.7844s
Epoch: 3 cost time: 38.84605383872986
Epoch: 3, Steps: 369 | Train Loss: 0.684 Vali Loss: 0.991 Vali Acc: 0.514 Test Loss: 0.991 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0244300
	speed: 0.3950s/iter; left time: 14098.2569s
	iters: 200, epoch: 4 | loss: 0.5773488
	speed: 0.0993s/iter; left time: 3535.4317s
	iters: 300, epoch: 4 | loss: 0.4872993
	speed: 0.0992s/iter; left time: 3520.3328s
Epoch: 4 cost time: 37.96713948249817
Epoch: 4, Steps: 369 | Train Loss: 0.641 Vali Loss: 0.941 Vali Acc: 0.563 Test Loss: 0.941 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7250416
	speed: 0.3791s/iter; left time: 13392.6215s
	iters: 200, epoch: 5 | loss: 0.6125746
	speed: 0.1147s/iter; left time: 4038.6548s
	iters: 300, epoch: 5 | loss: 0.8073995
	speed: 0.1146s/iter; left time: 4024.5206s
Epoch: 5 cost time: 41.00648474693298
Epoch: 5, Steps: 369 | Train Loss: 0.619 Vali Loss: 0.630 Vali Acc: 0.663 Test Loss: 0.630 Test Acc: 0.663
Validation loss decreased (-0.654930 --> -0.663161).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8209226
	speed: 0.3912s/iter; left time: 13673.9782s
	iters: 200, epoch: 6 | loss: 0.4086318
	speed: 0.0898s/iter; left time: 3130.1829s
	iters: 300, epoch: 6 | loss: 0.6258160
	speed: 0.0952s/iter; left time: 3307.4344s
Epoch: 6 cost time: 35.95671463012695
Epoch: 6, Steps: 369 | Train Loss: 0.603 Vali Loss: 0.623 Vali Acc: 0.667 Test Loss: 0.623 Test Acc: 0.667
Validation loss decreased (-0.663161 --> -0.667133).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5580678
	speed: 0.4031s/iter; left time: 13941.9534s
	iters: 200, epoch: 7 | loss: 0.7249143
	speed: 0.1011s/iter; left time: 3486.0849s
	iters: 300, epoch: 7 | loss: 0.4637024
	speed: 0.0995s/iter; left time: 3421.0190s
Epoch: 7 cost time: 39.79820466041565
Epoch: 7, Steps: 369 | Train Loss: 0.600 Vali Loss: 0.654 Vali Acc: 0.632 Test Loss: 0.654 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6026883
	speed: 0.3734s/iter; left time: 12777.2107s
	iters: 200, epoch: 8 | loss: 0.7931563
	speed: 0.0961s/iter; left time: 3277.6212s
	iters: 300, epoch: 8 | loss: 0.3562706
	speed: 0.0927s/iter; left time: 3153.9782s
Epoch: 8 cost time: 36.83637619018555
Epoch: 8, Steps: 369 | Train Loss: 0.618 Vali Loss: 0.667 Vali Acc: 0.627 Test Loss: 0.667 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6459876
	speed: 0.3965s/iter; left time: 13422.2615s
	iters: 200, epoch: 9 | loss: 0.6192812
	speed: 0.0995s/iter; left time: 3358.7174s
	iters: 300, epoch: 9 | loss: 0.7120620
	speed: 0.1000s/iter; left time: 3363.3723s
Epoch: 9 cost time: 39.436970472335815
Epoch: 9, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.694 Vali Acc: 0.618 Test Loss: 0.694 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.7876798
	speed: 0.3731s/iter; left time: 12492.6484s
	iters: 200, epoch: 10 | loss: 0.6925991
	speed: 0.1033s/iter; left time: 3448.7672s
	iters: 300, epoch: 10 | loss: 0.6270168
	speed: 0.1035s/iter; left time: 3444.4803s
Epoch: 10 cost time: 38.46202802658081
Epoch: 10, Steps: 369 | Train Loss: 0.611 Vali Loss: 0.663 Vali Acc: 0.622 Test Loss: 0.663 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.7249178
	speed: 0.3852s/iter; left time: 12753.7669s
	iters: 200, epoch: 11 | loss: 0.7044823
	speed: 0.0990s/iter; left time: 3267.1255s
	iters: 300, epoch: 11 | loss: 0.7120649
	speed: 0.1026s/iter; left time: 3378.1425s
Epoch: 11 cost time: 38.55336904525757
Epoch: 11, Steps: 369 | Train Loss: 0.601 Vali Loss: 0.813 Vali Acc: 0.591 Test Loss: 0.813 Test Acc: 0.591
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.7372630
	speed: 0.3899s/iter; left time: 12766.8904s
	iters: 200, epoch: 12 | loss: 0.8091363
	speed: 0.1006s/iter; left time: 3283.0525s
	iters: 300, epoch: 12 | loss: 0.7238938
	speed: 0.1104s/iter; left time: 3592.4194s
Epoch: 12 cost time: 38.64319062232971
Epoch: 12, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6514900
	speed: 0.3791s/iter; left time: 12271.4599s
	iters: 200, epoch: 13 | loss: 0.7199520
	speed: 0.0878s/iter; left time: 2832.3065s
	iters: 300, epoch: 13 | loss: 0.7104427
	speed: 0.0992s/iter; left time: 3190.1419s
Epoch: 13 cost time: 36.686973333358765
Epoch: 13, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.7623211
	speed: 0.3881s/iter; left time: 12420.2444s
	iters: 200, epoch: 14 | loss: 0.6881067
	speed: 0.1058s/iter; left time: 3374.9122s
	iters: 300, epoch: 14 | loss: 0.7622469
	speed: 0.1136s/iter; left time: 3613.1091s
Epoch: 14 cost time: 40.61151456832886
Epoch: 14, Steps: 369 | Train Loss: 0.696 Vali Loss: 0.695 Vali Acc: 0.499 Test Loss: 0.695 Test Acc: 0.499
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.7360492
	speed: 0.3906s/iter; left time: 12356.6971s
	iters: 200, epoch: 15 | loss: 0.6812383
	speed: 0.0894s/iter; left time: 2817.8025s
	iters: 300, epoch: 15 | loss: 0.6772208
	speed: 0.1074s/iter; left time: 3377.5850s
Epoch: 15 cost time: 37.026329040527344
Epoch: 15, Steps: 369 | Train Loss: 0.696 Vali Loss: 0.720 Vali Acc: 0.548 Test Loss: 0.720 Test Acc: 0.548
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.5891030
	speed: 0.4002s/iter; left time: 12511.2220s
	iters: 200, epoch: 16 | loss: 0.6240341
	speed: 0.1077s/iter; left time: 3357.6916s
	iters: 300, epoch: 16 | loss: 0.7061473
	speed: 0.1037s/iter; left time: 3221.0675s
Epoch: 16 cost time: 40.95557355880737
Epoch: 16, Steps: 369 | Train Loss: 0.673 Vali Loss: 0.738 Vali Acc: 0.520 Test Loss: 0.738 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6671396140749148
model parameter : 2519602
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6938182
	speed: 0.1398s/iter; left time: 5145.9305s
	iters: 200, epoch: 1 | loss: 1.1638869
	speed: 0.1142s/iter; left time: 4189.6694s
	iters: 300, epoch: 1 | loss: 1.6799630
	speed: 0.0895s/iter; left time: 3275.4813s
Epoch: 1 cost time: 40.74262762069702
Epoch: 1, Steps: 369 | Train Loss: 0.890 Vali Loss: 0.794 Vali Acc: 0.622 Test Loss: 0.794 Test Acc: 0.622
Validation loss decreased (inf --> -0.622296).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8478856
	speed: 0.3780s/iter; left time: 13770.7828s
	iters: 200, epoch: 2 | loss: 0.8335526
	speed: 0.0964s/iter; left time: 3501.0133s
	iters: 300, epoch: 2 | loss: 1.3435832
	speed: 0.0988s/iter; left time: 3580.4207s
Epoch: 2 cost time: 36.33955144882202
Epoch: 2, Steps: 369 | Train Loss: 0.722 Vali Loss: 0.722 Vali Acc: 0.608 Test Loss: 0.722 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7719188
	speed: 0.3861s/iter; left time: 13923.3868s
	iters: 200, epoch: 3 | loss: 0.7608048
	speed: 0.1112s/iter; left time: 4000.1406s
	iters: 300, epoch: 3 | loss: 0.6225824
	speed: 0.0907s/iter; left time: 3253.0143s
Epoch: 3 cost time: 39.061813831329346
Epoch: 3, Steps: 369 | Train Loss: 0.679 Vali Loss: 0.810 Vali Acc: 0.614 Test Loss: 0.810 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5723979
	speed: 0.3633s/iter; left time: 12966.7284s
	iters: 200, epoch: 4 | loss: 0.5799751
	speed: 0.0998s/iter; left time: 3552.5651s
	iters: 300, epoch: 4 | loss: 1.0262847
	speed: 0.1033s/iter; left time: 3665.1992s
Epoch: 4 cost time: 37.980080366134644
Epoch: 4, Steps: 369 | Train Loss: 0.641 Vali Loss: 1.213 Vali Acc: 0.597 Test Loss: 1.213 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6146523
	speed: 0.3984s/iter; left time: 14075.1027s
	iters: 200, epoch: 5 | loss: 0.4681931
	speed: 0.1020s/iter; left time: 3593.5308s
	iters: 300, epoch: 5 | loss: 0.7506119
	speed: 0.0979s/iter; left time: 3437.6728s
Epoch: 5 cost time: 39.331977128982544
Epoch: 5, Steps: 369 | Train Loss: 0.605 Vali Loss: 0.617 Vali Acc: 0.671 Test Loss: 0.617 Test Acc: 0.671
Validation loss decreased (-0.622296 --> -0.670822).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5987061
	speed: 0.3770s/iter; left time: 13178.7856s
	iters: 200, epoch: 6 | loss: 0.6742728
	speed: 0.0929s/iter; left time: 3237.4808s
	iters: 300, epoch: 6 | loss: 0.7920273
	speed: 0.0896s/iter; left time: 3114.3042s
Epoch: 6 cost time: 34.733670473098755
Epoch: 6, Steps: 369 | Train Loss: 0.683 Vali Loss: 0.805 Vali Acc: 0.500 Test Loss: 0.805 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6441627
	speed: 0.3869s/iter; left time: 13381.2579s
	iters: 200, epoch: 7 | loss: 0.6937360
	speed: 0.1001s/iter; left time: 3451.0851s
	iters: 300, epoch: 7 | loss: 0.8803505
	speed: 0.1018s/iter; left time: 3502.0724s
Epoch: 7 cost time: 39.128901720047
Epoch: 7, Steps: 369 | Train Loss: 0.763 Vali Loss: 1.811 Vali Acc: 0.500 Test Loss: 1.811 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7587881
	speed: 0.3895s/iter; left time: 13327.7228s
	iters: 200, epoch: 8 | loss: 1.1143262
	speed: 0.1020s/iter; left time: 3479.0070s
	iters: 300, epoch: 8 | loss: 0.6958447
	speed: 0.1104s/iter; left time: 3754.3861s
Epoch: 8 cost time: 38.832595348358154
Epoch: 8, Steps: 369 | Train Loss: 0.962 Vali Loss: 0.693 Vali Acc: 0.501 Test Loss: 0.693 Test Acc: 0.501
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.7737823
	speed: 0.3826s/iter; left time: 12951.2088s
	iters: 200, epoch: 9 | loss: 0.7621623
	speed: 0.0993s/iter; left time: 3351.6706s
	iters: 300, epoch: 9 | loss: 0.6885465
	speed: 0.1030s/iter; left time: 3467.3269s
Epoch: 9 cost time: 37.47417664527893
Epoch: 9, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.7136070
	speed: 0.3796s/iter; left time: 12710.4173s
	iters: 200, epoch: 10 | loss: 0.6886773
	speed: 0.1016s/iter; left time: 3390.9994s
	iters: 300, epoch: 10 | loss: 0.6885751
	speed: 0.1131s/iter; left time: 3765.5005s
Epoch: 10 cost time: 39.99420523643494
Epoch: 10, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.7398310
	speed: 0.3753s/iter; left time: 12425.7695s
	iters: 200, epoch: 11 | loss: 0.6728778
	speed: 0.0951s/iter; left time: 3140.7438s
	iters: 300, epoch: 11 | loss: 0.7620874
	speed: 0.0952s/iter; left time: 3131.7707s
Epoch: 11 cost time: 36.24796748161316
Epoch: 11, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.7227361
	speed: 0.3793s/iter; left time: 12419.6526s
	iters: 200, epoch: 12 | loss: 0.7065007
	speed: 0.0957s/iter; left time: 3123.0768s
	iters: 300, epoch: 12 | loss: 0.6914765
	speed: 0.1058s/iter; left time: 3443.8324s
Epoch: 12 cost time: 38.934624433517456
Epoch: 12, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6974858
	speed: 0.3787s/iter; left time: 12259.8750s
	iters: 200, epoch: 13 | loss: 0.6921690
	speed: 0.0966s/iter; left time: 3118.2603s
	iters: 300, epoch: 13 | loss: 0.7027653
	speed: 0.0947s/iter; left time: 3045.9044s
Epoch: 13 cost time: 35.63292694091797
Epoch: 13, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.7018607
	speed: 0.3677s/iter; left time: 11767.9807s
	iters: 200, epoch: 14 | loss: 0.6562168
	speed: 0.1058s/iter; left time: 3376.6191s
	iters: 300, epoch: 14 | loss: 0.7554397
	speed: 0.1010s/iter; left time: 3212.9301s
Epoch: 14 cost time: 39.01200246810913
Epoch: 14, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.6775891
	speed: 0.3751s/iter; left time: 11864.8516s
	iters: 200, epoch: 15 | loss: 0.6943502
	speed: 0.0967s/iter; left time: 3048.6782s
	iters: 300, epoch: 15 | loss: 0.6841134
	speed: 0.0959s/iter; left time: 3015.9424s
Epoch: 15 cost time: 37.09662055969238
Epoch: 15, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6708286038592508
model parameter : 2518194
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8321289
	speed: 0.1232s/iter; left time: 4534.9479s
	iters: 200, epoch: 1 | loss: 1.0191005
	speed: 0.1005s/iter; left time: 3687.2444s
	iters: 300, epoch: 1 | loss: 0.5316437
	speed: 0.0923s/iter; left time: 3379.4166s
Epoch: 1 cost time: 38.48411440849304
Epoch: 1, Steps: 369 | Train Loss: 0.991 Vali Loss: 0.630 Vali Acc: 0.646 Test Loss: 0.630 Test Acc: 0.646
Validation loss decreased (inf --> -0.646418).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7960849
	speed: 0.3848s/iter; left time: 14019.4194s
	iters: 200, epoch: 2 | loss: 1.9308240
	speed: 0.0966s/iter; left time: 3511.4609s
	iters: 300, epoch: 2 | loss: 0.6236730
	speed: 0.1048s/iter; left time: 3798.2912s
Epoch: 2 cost time: 38.63917946815491
Epoch: 2, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.894 Vali Acc: 0.639 Test Loss: 0.894 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1942325
	speed: 0.3913s/iter; left time: 14113.0701s
	iters: 200, epoch: 3 | loss: 0.4596337
	speed: 0.1034s/iter; left time: 3719.4363s
	iters: 300, epoch: 3 | loss: 1.0322262
	speed: 0.0945s/iter; left time: 3390.6822s
Epoch: 3 cost time: 36.60482978820801
Epoch: 3, Steps: 369 | Train Loss: 0.703 Vali Loss: 1.057 Vali Acc: 0.624 Test Loss: 1.057 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8623838
	speed: 0.3772s/iter; left time: 13464.6303s
	iters: 200, epoch: 4 | loss: 0.4631459
	speed: 0.1048s/iter; left time: 3728.9407s
	iters: 300, epoch: 4 | loss: 0.7357592
	speed: 0.1108s/iter; left time: 3931.9463s
Epoch: 4 cost time: 40.178802728652954
Epoch: 4, Steps: 369 | Train Loss: 0.658 Vali Loss: 0.686 Vali Acc: 0.649 Test Loss: 0.686 Test Acc: 0.649
Validation loss decreased (-0.646418 --> -0.649255).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9202312
	speed: 0.3964s/iter; left time: 14001.1091s
	iters: 200, epoch: 5 | loss: 0.6158459
	speed: 0.0953s/iter; left time: 3356.4485s
	iters: 300, epoch: 5 | loss: 0.6453258
	speed: 0.0927s/iter; left time: 3255.5201s
Epoch: 5 cost time: 36.254759311676025
Epoch: 5, Steps: 369 | Train Loss: 0.601 Vali Loss: 0.705 Vali Acc: 0.652 Test Loss: 0.705 Test Acc: 0.652
Validation loss decreased (-0.649255 --> -0.651809).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5290079
	speed: 0.3870s/iter; left time: 13528.4281s
	iters: 200, epoch: 6 | loss: 0.6158495
	speed: 0.1024s/iter; left time: 3567.7396s
	iters: 300, epoch: 6 | loss: 0.7232394
	speed: 0.1053s/iter; left time: 3660.2398s
Epoch: 6 cost time: 38.22685194015503
Epoch: 6, Steps: 369 | Train Loss: 0.611 Vali Loss: 0.680 Vali Acc: 0.646 Test Loss: 0.680 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5246199
	speed: 0.3845s/iter; left time: 13297.2946s
	iters: 200, epoch: 7 | loss: 0.4179424
	speed: 0.0906s/iter; left time: 3124.5327s
	iters: 300, epoch: 7 | loss: 0.4664366
	speed: 0.0908s/iter; left time: 3124.0581s
Epoch: 7 cost time: 34.88792014122009
Epoch: 7, Steps: 369 | Train Loss: 0.608 Vali Loss: 0.690 Vali Acc: 0.602 Test Loss: 0.690 Test Acc: 0.602
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6635300
	speed: 0.3860s/iter; left time: 13209.5867s
	iters: 200, epoch: 8 | loss: 0.8031092
	speed: 0.0941s/iter; left time: 3210.1192s
	iters: 300, epoch: 8 | loss: 0.7477982
	speed: 0.1006s/iter; left time: 3423.6978s
Epoch: 8 cost time: 37.87877821922302
Epoch: 8, Steps: 369 | Train Loss: 0.598 Vali Loss: 0.708 Vali Acc: 0.589 Test Loss: 0.708 Test Acc: 0.589
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.8524724
	speed: 0.3751s/iter; left time: 12696.2465s
	iters: 200, epoch: 9 | loss: 0.4911170
	speed: 0.0877s/iter; left time: 2961.3974s
	iters: 300, epoch: 9 | loss: 0.4509684
	speed: 0.0994s/iter; left time: 3345.0621s
Epoch: 9 cost time: 36.867305517196655
Epoch: 9, Steps: 369 | Train Loss: 0.622 Vali Loss: 0.683 Vali Acc: 0.596 Test Loss: 0.683 Test Acc: 0.596
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4441856
	speed: 0.4073s/iter; left time: 13637.8151s
	iters: 200, epoch: 10 | loss: 0.6525791
	speed: 0.0951s/iter; left time: 3175.2132s
	iters: 300, epoch: 10 | loss: 0.6698740
	speed: 0.0932s/iter; left time: 3102.2013s
Epoch: 10 cost time: 37.61280608177185
Epoch: 10, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.697 Vali Acc: 0.502 Test Loss: 0.697 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.6981133
	speed: 0.3901s/iter; left time: 12916.8630s
	iters: 200, epoch: 11 | loss: 1.4712826
	speed: 0.1086s/iter; left time: 3585.3876s
	iters: 300, epoch: 11 | loss: 0.7392554
	speed: 0.1026s/iter; left time: 3376.0913s
Epoch: 11 cost time: 38.71446871757507
Epoch: 11, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.6741458
	speed: 0.3924s/iter; left time: 12848.1571s
	iters: 200, epoch: 12 | loss: 0.6843846
	speed: 0.0909s/iter; left time: 2967.8117s
	iters: 300, epoch: 12 | loss: 0.6981204
	speed: 0.0848s/iter; left time: 2758.1544s
Epoch: 12 cost time: 34.156216859817505
Epoch: 12, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6984015
	speed: 0.3746s/iter; left time: 12125.3177s
	iters: 200, epoch: 13 | loss: 0.6413847
	speed: 0.1039s/iter; left time: 3354.3955s
	iters: 300, epoch: 13 | loss: 0.7071365
	speed: 0.1095s/iter; left time: 3522.3684s
Epoch: 13 cost time: 38.094128370285034
Epoch: 13, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.6844395
	speed: 0.3844s/iter; left time: 12302.6049s
	iters: 200, epoch: 14 | loss: 0.7139654
	speed: 0.0888s/iter; left time: 2834.3899s
	iters: 300, epoch: 14 | loss: 0.6591470
	speed: 0.0933s/iter; left time: 2967.2291s
Epoch: 14 cost time: 36.78927755355835
Epoch: 14, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.6937795
	speed: 0.3878s/iter; left time: 12268.4082s
	iters: 200, epoch: 15 | loss: 0.7120267
	speed: 0.1121s/iter; left time: 3534.3552s
	iters: 300, epoch: 15 | loss: 0.8045868
	speed: 0.1093s/iter; left time: 3435.3485s
Epoch: 15 cost time: 39.72909760475159
Epoch: 15, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6518161180476731
model parameter : 2516786
model size : 12.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.6531489
	speed: 0.1317s/iter; left time: 4845.8183s
	iters: 200, epoch: 1 | loss: 0.7883505
	speed: 0.1065s/iter; left time: 3907.2074s
	iters: 300, epoch: 1 | loss: 0.7502108
	speed: 0.1010s/iter; left time: 3696.4932s
Epoch: 1 cost time: 40.29622197151184
Epoch: 1, Steps: 369 | Train Loss: 1.016 Vali Loss: 0.993 Vali Acc: 0.554 Test Loss: 0.993 Test Acc: 0.554
Validation loss decreased (inf --> -0.553906).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4637274
	speed: 0.3945s/iter; left time: 14371.3375s
	iters: 200, epoch: 2 | loss: 0.7538883
	speed: 0.0883s/iter; left time: 3208.0761s
	iters: 300, epoch: 2 | loss: 0.6759354
	speed: 0.0787s/iter; left time: 2853.2668s
Epoch: 2 cost time: 33.362038373947144
Epoch: 2, Steps: 369 | Train Loss: 0.732 Vali Loss: 0.807 Vali Acc: 0.510 Test Loss: 0.807 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5098808
	speed: 0.3724s/iter; left time: 13429.2471s
	iters: 200, epoch: 3 | loss: 0.3619737
	speed: 0.1063s/iter; left time: 3823.4156s
	iters: 300, epoch: 3 | loss: 0.7804234
	speed: 0.0977s/iter; left time: 3504.7763s
Epoch: 3 cost time: 37.21475863456726
Epoch: 3, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.755 Vali Acc: 0.659 Test Loss: 0.755 Test Acc: 0.659
Validation loss decreased (-0.553906 --> -0.659187).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8627142
	speed: 0.3635s/iter; left time: 12976.5298s
	iters: 200, epoch: 4 | loss: 0.4245815
	speed: 0.0977s/iter; left time: 3476.5353s
	iters: 300, epoch: 4 | loss: 0.5990982
	speed: 0.0890s/iter; left time: 3158.5966s
Epoch: 4 cost time: 36.20523500442505
Epoch: 4, Steps: 369 | Train Loss: 0.648 Vali Loss: 0.660 Vali Acc: 0.657 Test Loss: 0.660 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7555670
	speed: 0.3846s/iter; left time: 13586.3339s
	iters: 200, epoch: 5 | loss: 0.3948447
	speed: 0.1009s/iter; left time: 3555.2044s
	iters: 300, epoch: 5 | loss: 0.4347233
	speed: 0.0971s/iter; left time: 3409.8466s
Epoch: 5 cost time: 38.19839525222778
Epoch: 5, Steps: 369 | Train Loss: 0.602 Vali Loss: 0.617 Vali Acc: 0.677 Test Loss: 0.617 Test Acc: 0.677
Validation loss decreased (-0.659187 --> -0.676498).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7468723
	speed: 0.3964s/iter; left time: 13856.5503s
	iters: 200, epoch: 6 | loss: 0.6405256
	speed: 0.1041s/iter; left time: 3629.8906s
	iters: 300, epoch: 6 | loss: 0.5694112
	speed: 0.0948s/iter; left time: 3293.6912s
Epoch: 6 cost time: 37.72413945198059
Epoch: 6, Steps: 369 | Train Loss: 0.623 Vali Loss: 0.643 Vali Acc: 0.631 Test Loss: 0.643 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4060095
	speed: 0.3820s/iter; left time: 13211.6671s
	iters: 200, epoch: 7 | loss: 0.5495859
	speed: 0.0887s/iter; left time: 3058.2645s
	iters: 300, epoch: 7 | loss: 0.6899557
	speed: 0.0974s/iter; left time: 3347.9215s
Epoch: 7 cost time: 34.89873957633972
Epoch: 7, Steps: 369 | Train Loss: 0.616 Vali Loss: 0.715 Vali Acc: 0.542 Test Loss: 0.715 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7176239
	speed: 0.3797s/iter; left time: 12993.3655s
	iters: 200, epoch: 8 | loss: 0.4425945
	speed: 0.1058s/iter; left time: 3609.5491s
	iters: 300, epoch: 8 | loss: 0.5782680
	speed: 0.0986s/iter; left time: 3354.8334s
Epoch: 8 cost time: 37.11082196235657
Epoch: 8, Steps: 369 | Train Loss: 0.627 Vali Loss: 0.640 Vali Acc: 0.656 Test Loss: 0.640 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.7757307
	speed: 0.3793s/iter; left time: 12837.3159s
	iters: 200, epoch: 9 | loss: 0.6468084
	speed: 0.0929s/iter; left time: 3135.2579s
	iters: 300, epoch: 9 | loss: 0.5400321
	speed: 0.0927s/iter; left time: 3119.0884s
Epoch: 9 cost time: 37.104557514190674
Epoch: 9, Steps: 369 | Train Loss: 0.625 Vali Loss: 0.654 Vali Acc: 0.625 Test Loss: 0.654 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4906723
	speed: 0.3879s/iter; left time: 12985.3960s
	iters: 200, epoch: 10 | loss: 0.4569253
	speed: 0.1120s/iter; left time: 3738.1200s
	iters: 300, epoch: 10 | loss: 0.7061227
	speed: 0.1140s/iter; left time: 3794.3339s
Epoch: 10 cost time: 40.380350828170776
Epoch: 10, Steps: 369 | Train Loss: 0.659 Vali Loss: 0.806 Vali Acc: 0.500 Test Loss: 0.806 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.7321374
	speed: 0.3818s/iter; left time: 12643.2096s
	iters: 200, epoch: 11 | loss: 0.8395815
	speed: 0.1010s/iter; left time: 3333.1481s
	iters: 300, epoch: 11 | loss: 0.7587663
	speed: 0.0943s/iter; left time: 3103.2525s
Epoch: 11 cost time: 37.39981961250305
Epoch: 11, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.6940019
	speed: 0.3920s/iter; left time: 12834.1082s
	iters: 200, epoch: 12 | loss: 0.7219809
	speed: 0.1134s/iter; left time: 3703.0609s
	iters: 300, epoch: 12 | loss: 0.6789668
	speed: 0.1007s/iter; left time: 3276.2093s
Epoch: 12 cost time: 39.18488883972168
Epoch: 12, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6558971
	speed: 0.3751s/iter; left time: 12142.2616s
	iters: 200, epoch: 13 | loss: 0.6162670
	speed: 0.0997s/iter; left time: 3218.9297s
	iters: 300, epoch: 13 | loss: 0.6800338
	speed: 0.0930s/iter; left time: 2993.4031s
Epoch: 13 cost time: 36.333207845687866
Epoch: 13, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.6868002
	speed: 0.3851s/iter; left time: 12325.3033s
	iters: 200, epoch: 14 | loss: 0.6959324
	speed: 0.1000s/iter; left time: 3191.6832s
	iters: 300, epoch: 14 | loss: 0.8079830
	speed: 0.0965s/iter; left time: 3069.6268s
Epoch: 14 cost time: 37.791141748428345
Epoch: 14, Steps: 369 | Train Loss: 0.978 Vali Loss: 0.818 Vali Acc: 0.500 Test Loss: 0.818 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.4021997
	speed: 0.3898s/iter; left time: 12330.5489s
	iters: 200, epoch: 15 | loss: 0.8797125
	speed: 0.1001s/iter; left time: 3156.1628s
	iters: 300, epoch: 15 | loss: 0.7355288
	speed: 0.1034s/iter; left time: 3251.4180s
Epoch: 15 cost time: 38.7456374168396
Epoch: 15, Steps: 369 | Train Loss: 0.769 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6765039727582293
model parameter : 2515378
model size : 12.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8508555
	speed: 0.1158s/iter; left time: 4260.6123s
	iters: 200, epoch: 1 | loss: 0.4435667
	speed: 0.1006s/iter; left time: 3690.5749s
	iters: 300, epoch: 1 | loss: 0.5346650
	speed: 0.0907s/iter; left time: 3319.6734s
Epoch: 1 cost time: 37.5036826133728
Epoch: 1, Steps: 369 | Train Loss: 0.922 Vali Loss: 0.891 Vali Acc: 0.626 Test Loss: 0.891 Test Acc: 0.626
Validation loss decreased (inf --> -0.626268).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3751238
	speed: 0.3745s/iter; left time: 13643.9058s
	iters: 200, epoch: 2 | loss: 0.4747967
	speed: 0.0918s/iter; left time: 3335.1563s
	iters: 300, epoch: 2 | loss: 0.4189296
	speed: 0.0923s/iter; left time: 3345.3857s
Epoch: 2 cost time: 35.63026142120361
Epoch: 2, Steps: 369 | Train Loss: 0.768 Vali Loss: 1.222 Vali Acc: 0.533 Test Loss: 1.222 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6995206
	speed: 0.3736s/iter; left time: 13473.9367s
	iters: 200, epoch: 3 | loss: 0.6923461
	speed: 0.0988s/iter; left time: 3554.4848s
	iters: 300, epoch: 3 | loss: 0.6978426
	speed: 0.0955s/iter; left time: 3423.5631s
Epoch: 3 cost time: 36.24518370628357
Epoch: 3, Steps: 369 | Train Loss: 0.735 Vali Loss: 1.072 Vali Acc: 0.599 Test Loss: 1.072 Test Acc: 0.599
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6935018
	speed: 0.3833s/iter; left time: 13682.8595s
	iters: 200, epoch: 4 | loss: 1.0144353
	speed: 0.0927s/iter; left time: 3300.9147s
	iters: 300, epoch: 4 | loss: 0.4449779
	speed: 0.0966s/iter; left time: 3428.6746s
Epoch: 4 cost time: 37.13441491127014
Epoch: 4, Steps: 369 | Train Loss: 0.623 Vali Loss: 0.677 Vali Acc: 0.657 Test Loss: 0.677 Test Acc: 0.657
Validation loss decreased (-0.626268 --> -0.657485).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0313355
	speed: 0.3825s/iter; left time: 13512.9515s
	iters: 200, epoch: 5 | loss: 0.3907644
	speed: 0.1022s/iter; left time: 3599.4952s
	iters: 300, epoch: 5 | loss: 0.3718688
	speed: 0.0964s/iter; left time: 3387.6841s
Epoch: 5 cost time: 37.02815794944763
Epoch: 5, Steps: 369 | Train Loss: 0.574 Vali Loss: 0.792 Vali Acc: 0.631 Test Loss: 0.792 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5420316
	speed: 0.3823s/iter; left time: 13363.2912s
	iters: 200, epoch: 6 | loss: 0.3610537
	speed: 0.0938s/iter; left time: 3269.7225s
	iters: 300, epoch: 6 | loss: 0.5702521
	speed: 0.0853s/iter; left time: 2964.1712s
Epoch: 6 cost time: 36.640876054763794
Epoch: 6, Steps: 369 | Train Loss: 0.573 Vali Loss: 0.658 Vali Acc: 0.603 Test Loss: 0.658 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4536855
	speed: 0.3899s/iter; left time: 13486.4464s
	iters: 200, epoch: 7 | loss: 0.5852561
	speed: 0.0960s/iter; left time: 3311.4757s
	iters: 300, epoch: 7 | loss: 0.6212552
	speed: 0.0993s/iter; left time: 3415.2689s
Epoch: 7 cost time: 36.36903142929077
Epoch: 7, Steps: 369 | Train Loss: 0.591 Vali Loss: 0.764 Vali Acc: 0.614 Test Loss: 0.764 Test Acc: 0.614
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5947052
	speed: 0.3814s/iter; left time: 13051.5962s
	iters: 200, epoch: 8 | loss: 0.4126230
	speed: 0.0926s/iter; left time: 3158.1245s
	iters: 300, epoch: 8 | loss: 0.4943093
	speed: 0.0914s/iter; left time: 3109.4281s
Epoch: 8 cost time: 35.98322653770447
Epoch: 8, Steps: 369 | Train Loss: 0.585 Vali Loss: 0.647 Vali Acc: 0.640 Test Loss: 0.647 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5625038
	speed: 0.3680s/iter; left time: 12455.6429s
	iters: 200, epoch: 9 | loss: 0.5257291
	speed: 0.0962s/iter; left time: 3245.1070s
	iters: 300, epoch: 9 | loss: 0.4336900
	speed: 0.1047s/iter; left time: 3521.9925s
Epoch: 9 cost time: 36.90928316116333
Epoch: 9, Steps: 369 | Train Loss: 0.586 Vali Loss: 0.691 Vali Acc: 0.623 Test Loss: 0.691 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6896771
	speed: 0.3728s/iter; left time: 12481.0898s
	iters: 200, epoch: 10 | loss: 0.5407336
	speed: 0.0961s/iter; left time: 3207.2273s
	iters: 300, epoch: 10 | loss: 0.8299795
	speed: 0.0918s/iter; left time: 3055.4568s
Epoch: 10 cost time: 37.2445068359375
Epoch: 10, Steps: 369 | Train Loss: 0.570 Vali Loss: 0.700 Vali Acc: 0.625 Test Loss: 0.700 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.5347515
	speed: 0.3868s/iter; left time: 12806.6889s
	iters: 200, epoch: 11 | loss: 0.6982802
	speed: 0.0999s/iter; left time: 3296.3614s
	iters: 300, epoch: 11 | loss: 0.6683770
	speed: 0.1026s/iter; left time: 3375.9243s
Epoch: 11 cost time: 37.823232650756836
Epoch: 11, Steps: 369 | Train Loss: 0.607 Vali Loss: 0.667 Vali Acc: 0.635 Test Loss: 0.667 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.3550738
	speed: 0.3671s/iter; left time: 12018.5115s
	iters: 200, epoch: 12 | loss: 0.6310486
	speed: 0.0979s/iter; left time: 3194.6506s
	iters: 300, epoch: 12 | loss: 0.5727666
	speed: 0.0926s/iter; left time: 3012.6530s
Epoch: 12 cost time: 36.30864858627319
Epoch: 12, Steps: 369 | Train Loss: 0.595 Vali Loss: 0.645 Vali Acc: 0.650 Test Loss: 0.645 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.5810376
	speed: 0.3777s/iter; left time: 12226.9281s
	iters: 200, epoch: 13 | loss: 0.6543332
	speed: 0.1012s/iter; left time: 3265.2278s
	iters: 300, epoch: 13 | loss: 0.5667109
	speed: 0.1140s/iter; left time: 3668.9072s
Epoch: 13 cost time: 37.91292977333069
Epoch: 13, Steps: 369 | Train Loss: 0.606 Vali Loss: 0.657 Vali Acc: 0.635 Test Loss: 0.657 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.6266213
	speed: 0.3807s/iter; left time: 12184.2706s
	iters: 200, epoch: 14 | loss: 0.5470109
	speed: 0.0959s/iter; left time: 3060.0011s
	iters: 300, epoch: 14 | loss: 0.6292105
	speed: 0.0953s/iter; left time: 3029.4371s
Epoch: 14 cost time: 36.413763761520386
Epoch: 14, Steps: 369 | Train Loss: 0.621 Vali Loss: 0.706 Vali Acc: 0.643 Test Loss: 0.706 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6574914869466515
model parameter : 2289330
model size : 11.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.0521114
	speed: 0.1221s/iter; left time: 4492.8521s
	iters: 200, epoch: 1 | loss: 0.5923649
	speed: 0.0961s/iter; left time: 3525.1366s
	iters: 300, epoch: 1 | loss: 0.9606670
	speed: 0.0929s/iter; left time: 3399.6640s
Epoch: 1 cost time: 37.5737030506134
Epoch: 1, Steps: 369 | Train Loss: 0.929 Vali Loss: 1.479 Vali Acc: 0.540 Test Loss: 1.479 Test Acc: 0.540
Validation loss decreased (inf --> -0.539997).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3272807
	speed: 0.3729s/iter; left time: 13586.8205s
	iters: 200, epoch: 2 | loss: 1.2759807
	speed: 0.0956s/iter; left time: 3472.8909s
	iters: 300, epoch: 2 | loss: 0.5116958
	speed: 0.0904s/iter; left time: 3277.0777s
Epoch: 2 cost time: 36.54900932312012
Epoch: 2, Steps: 369 | Train Loss: 0.750 Vali Loss: 0.671 Vali Acc: 0.621 Test Loss: 0.671 Test Acc: 0.621
Validation loss decreased (-0.539997 --> -0.620595).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5459937
	speed: 0.3820s/iter; left time: 13777.2101s
	iters: 200, epoch: 3 | loss: 0.7260979
	speed: 0.0906s/iter; left time: 3256.8932s
	iters: 300, epoch: 3 | loss: 0.4972968
	speed: 0.0830s/iter; left time: 2975.7966s
Epoch: 3 cost time: 33.55585765838623
Epoch: 3, Steps: 369 | Train Loss: 0.668 Vali Loss: 0.807 Vali Acc: 0.618 Test Loss: 0.807 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4126725
	speed: 0.3668s/iter; left time: 13090.7746s
	iters: 200, epoch: 4 | loss: 0.6493276
	speed: 0.0867s/iter; left time: 3087.6416s
	iters: 300, epoch: 4 | loss: 0.5393217
	speed: 0.1031s/iter; left time: 3660.4190s
Epoch: 4 cost time: 37.15841817855835
Epoch: 4, Steps: 369 | Train Loss: 0.657 Vali Loss: 0.652 Vali Acc: 0.655 Test Loss: 0.652 Test Acc: 0.655
Validation loss decreased (-0.620595 --> -0.654931).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6623663
	speed: 0.3805s/iter; left time: 13439.7919s
	iters: 200, epoch: 5 | loss: 0.8425195
	speed: 0.0981s/iter; left time: 3455.7599s
	iters: 300, epoch: 5 | loss: 0.4695385
	speed: 0.0977s/iter; left time: 3432.9684s
Epoch: 5 cost time: 36.427379846572876
Epoch: 5, Steps: 369 | Train Loss: 0.561 Vali Loss: 0.782 Vali Acc: 0.572 Test Loss: 0.782 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5368162
	speed: 0.3618s/iter; left time: 12646.5438s
	iters: 200, epoch: 6 | loss: 0.4246907
	speed: 0.0952s/iter; left time: 3318.8582s
	iters: 300, epoch: 6 | loss: 0.4656024
	speed: 0.1044s/iter; left time: 3630.0859s
Epoch: 6 cost time: 37.364612340927124
Epoch: 6, Steps: 369 | Train Loss: 0.508 Vali Loss: 0.681 Vali Acc: 0.679 Test Loss: 0.681 Test Acc: 0.679
Validation loss decreased (-0.654931 --> -0.678767).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5100514
	speed: 0.3775s/iter; left time: 13057.4329s
	iters: 200, epoch: 7 | loss: 0.7619492
	speed: 0.1102s/iter; left time: 3799.8309s
	iters: 300, epoch: 7 | loss: 0.3444336
	speed: 0.1074s/iter; left time: 3692.9360s
Epoch: 7 cost time: 39.897135734558105
Epoch: 7, Steps: 369 | Train Loss: 0.479 Vali Loss: 0.660 Vali Acc: 0.650 Test Loss: 0.660 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3160053
	speed: 0.3560s/iter; left time: 12182.4852s
	iters: 200, epoch: 8 | loss: 0.4759012
	speed: 0.0831s/iter; left time: 2835.2312s
	iters: 300, epoch: 8 | loss: 0.6012696
	speed: 0.1025s/iter; left time: 3487.0033s
Epoch: 8 cost time: 34.40581130981445
Epoch: 8, Steps: 369 | Train Loss: 0.468 Vali Loss: 0.801 Vali Acc: 0.669 Test Loss: 0.801 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4565965
	speed: 0.3923s/iter; left time: 13280.4149s
	iters: 200, epoch: 9 | loss: 0.5510047
	speed: 0.1031s/iter; left time: 3479.3494s
	iters: 300, epoch: 9 | loss: 0.4803221
	speed: 0.0970s/iter; left time: 3263.3790s
Epoch: 9 cost time: 37.751686811447144
Epoch: 9, Steps: 369 | Train Loss: 0.499 Vali Loss: 0.806 Vali Acc: 0.667 Test Loss: 0.806 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.5826635
	speed: 0.3711s/iter; left time: 12425.3795s
	iters: 200, epoch: 10 | loss: 0.4925067
	speed: 0.0927s/iter; left time: 3095.9414s
	iters: 300, epoch: 10 | loss: 0.6599841
	speed: 0.0912s/iter; left time: 3036.0057s
Epoch: 10 cost time: 34.995973348617554
Epoch: 10, Steps: 369 | Train Loss: 0.535 Vali Loss: 0.719 Vali Acc: 0.643 Test Loss: 0.719 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5027305
	speed: 0.3693s/iter; left time: 12226.6901s
	iters: 200, epoch: 11 | loss: 0.7678742
	speed: 0.1098s/iter; left time: 3625.5689s
	iters: 300, epoch: 11 | loss: 0.6620426
	speed: 0.1007s/iter; left time: 3315.3531s
Epoch: 11 cost time: 38.866804122924805
Epoch: 11, Steps: 369 | Train Loss: 0.588 Vali Loss: 0.663 Vali Acc: 0.621 Test Loss: 0.663 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.5075262
	speed: 0.3653s/iter; left time: 11959.5235s
	iters: 200, epoch: 12 | loss: 0.4997927
	speed: 0.0898s/iter; left time: 2931.7035s
	iters: 300, epoch: 12 | loss: 0.5192332
	speed: 0.1043s/iter; left time: 3393.7453s
Epoch: 12 cost time: 36.924315214157104
Epoch: 12, Steps: 369 | Train Loss: 0.604 Vali Loss: 0.656 Vali Acc: 0.636 Test Loss: 0.656 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6247821
	speed: 0.3873s/iter; left time: 12538.9971s
	iters: 200, epoch: 13 | loss: 0.4461728
	speed: 0.1049s/iter; left time: 3386.0123s
	iters: 300, epoch: 13 | loss: 0.7559629
	speed: 0.1003s/iter; left time: 3228.5263s
Epoch: 13 cost time: 38.704827308654785
Epoch: 13, Steps: 369 | Train Loss: 0.613 Vali Loss: 0.651 Vali Acc: 0.626 Test Loss: 0.651 Test Acc: 0.626
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.5759538
	speed: 0.3624s/iter; left time: 11599.5228s
	iters: 200, epoch: 14 | loss: 0.2927638
	speed: 0.0919s/iter; left time: 2930.4336s
	iters: 300, epoch: 14 | loss: 0.6345119
	speed: 0.0956s/iter; left time: 3040.1789s
Epoch: 14 cost time: 34.829941272735596
Epoch: 14, Steps: 369 | Train Loss: 0.628 Vali Loss: 0.711 Vali Acc: 0.618 Test Loss: 0.711 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.6340016
	speed: 0.3840s/iter; left time: 12149.2118s
	iters: 200, epoch: 15 | loss: 0.7072885
	speed: 0.1106s/iter; left time: 3487.9077s
	iters: 300, epoch: 15 | loss: 0.8178662
	speed: 0.0940s/iter; left time: 2953.5474s
Epoch: 15 cost time: 38.190667152404785
Epoch: 15, Steps: 369 | Train Loss: 0.666 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.6365913
	speed: 0.3597s/iter; left time: 11246.3516s
	iters: 200, epoch: 16 | loss: 0.6923006
	speed: 0.1071s/iter; left time: 3336.8926s
	iters: 300, epoch: 16 | loss: 0.7420936
	speed: 0.1168s/iter; left time: 3627.6919s
Epoch: 16 cost time: 39.944793939590454
Epoch: 16, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6787741203178207
model parameter : 2287922
model size : 11.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5397756
	speed: 0.1136s/iter; left time: 4180.3315s
	iters: 200, epoch: 1 | loss: 0.6419026
	speed: 0.0964s/iter; left time: 3537.0072s
	iters: 300, epoch: 1 | loss: 1.4362254
	speed: 0.0920s/iter; left time: 3366.6093s
Epoch: 1 cost time: 36.40512704849243
Epoch: 1, Steps: 369 | Train Loss: 0.877 Vali Loss: 0.894 Vali Acc: 0.584 Test Loss: 0.894 Test Acc: 0.584
Validation loss decreased (inf --> -0.584270).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2689725
	speed: 0.3602s/iter; left time: 13122.6656s
	iters: 200, epoch: 2 | loss: 0.6232872
	speed: 0.0987s/iter; left time: 3587.2051s
	iters: 300, epoch: 2 | loss: 1.4795196
	speed: 0.0964s/iter; left time: 3492.5294s
Epoch: 2 cost time: 37.292513370513916
Epoch: 2, Steps: 369 | Train Loss: 0.800 Vali Loss: 1.544 Vali Acc: 0.504 Test Loss: 1.544 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3690758
	speed: 0.3910s/iter; left time: 14100.1712s
	iters: 200, epoch: 3 | loss: 0.4271716
	speed: 0.0982s/iter; left time: 3532.3067s
	iters: 300, epoch: 3 | loss: 0.8615278
	speed: 0.1037s/iter; left time: 3717.6152s
Epoch: 3 cost time: 38.12936520576477
Epoch: 3, Steps: 369 | Train Loss: 0.697 Vali Loss: 0.938 Vali Acc: 0.585 Test Loss: 0.938 Test Acc: 0.585
Validation loss decreased (-0.584270 --> -0.584837).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6904137
	speed: 0.4007s/iter; left time: 14304.1184s
	iters: 200, epoch: 4 | loss: 0.1943616
	speed: 0.0988s/iter; left time: 3516.1719s
	iters: 300, epoch: 4 | loss: 0.6950979
	speed: 0.1087s/iter; left time: 3856.5120s
Epoch: 4 cost time: 39.09477972984314
Epoch: 4, Steps: 369 | Train Loss: 0.650 Vali Loss: 0.643 Vali Acc: 0.673 Test Loss: 0.643 Test Acc: 0.673
Validation loss decreased (-0.584837 --> -0.672525).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8493677
	speed: 0.3783s/iter; left time: 13362.3200s
	iters: 200, epoch: 5 | loss: 0.5552094
	speed: 0.0813s/iter; left time: 2864.8402s
	iters: 300, epoch: 5 | loss: 0.5317577
	speed: 0.0897s/iter; left time: 3151.5654s
Epoch: 5 cost time: 33.025561571121216
Epoch: 5, Steps: 369 | Train Loss: 0.612 Vali Loss: 0.653 Vali Acc: 0.632 Test Loss: 0.653 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5939181
	speed: 0.3883s/iter; left time: 13572.9644s
	iters: 200, epoch: 6 | loss: 0.6192638
	speed: 0.0949s/iter; left time: 3306.1615s
	iters: 300, epoch: 6 | loss: 0.6856909
	speed: 0.1074s/iter; left time: 3733.8547s
Epoch: 6 cost time: 38.447054624557495
Epoch: 6, Steps: 369 | Train Loss: 0.628 Vali Loss: 0.688 Vali Acc: 0.583 Test Loss: 0.688 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6569553
	speed: 0.3778s/iter; left time: 13067.4564s
	iters: 200, epoch: 7 | loss: 0.7040953
	speed: 0.0908s/iter; left time: 3132.9014s
	iters: 300, epoch: 7 | loss: 0.7218475
	speed: 0.0944s/iter; left time: 3245.1840s
Epoch: 7 cost time: 35.925740242004395
Epoch: 7, Steps: 369 | Train Loss: 0.684 Vali Loss: 0.674 Vali Acc: 0.614 Test Loss: 0.674 Test Acc: 0.614
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5289433
	speed: 0.3795s/iter; left time: 12984.0554s
	iters: 200, epoch: 8 | loss: 0.8715249
	speed: 0.0977s/iter; left time: 3332.9124s
	iters: 300, epoch: 8 | loss: 0.6516098
	speed: 0.0990s/iter; left time: 3366.1840s
Epoch: 8 cost time: 37.73862266540527
Epoch: 8, Steps: 369 | Train Loss: 0.680 Vali Loss: 0.701 Vali Acc: 0.539 Test Loss: 0.701 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.7068111
	speed: 0.3751s/iter; left time: 12697.8437s
	iters: 200, epoch: 9 | loss: 0.8469784
	speed: 0.0882s/iter; left time: 2975.5297s
	iters: 300, epoch: 9 | loss: 0.6614613
	speed: 0.0899s/iter; left time: 3025.2167s
Epoch: 9 cost time: 35.0340371131897
Epoch: 9, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.7777589
	speed: 0.3861s/iter; left time: 12928.2071s
	iters: 200, epoch: 10 | loss: 0.7168684
	speed: 0.0952s/iter; left time: 3178.9847s
	iters: 300, epoch: 10 | loss: 0.7981908
	speed: 0.0868s/iter; left time: 2890.2578s
Epoch: 10 cost time: 35.62486743927002
Epoch: 10, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.714 Vali Acc: 0.503 Test Loss: 0.714 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.7214304
	speed: 0.3833s/iter; left time: 12690.9867s
	iters: 200, epoch: 11 | loss: 0.7472514
	speed: 0.0909s/iter; left time: 3000.2871s
	iters: 300, epoch: 11 | loss: 0.7790990
	speed: 0.0854s/iter; left time: 2811.0627s
Epoch: 11 cost time: 35.42564558982849
Epoch: 11, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.7250883
	speed: 0.3825s/iter; left time: 12522.5499s
	iters: 200, epoch: 12 | loss: 0.7419873
	speed: 0.0938s/iter; left time: 3060.3600s
	iters: 300, epoch: 12 | loss: 0.7490435
	speed: 0.0881s/iter; left time: 2866.2758s
Epoch: 12 cost time: 35.72986078262329
Epoch: 12, Steps: 369 | Train Loss: 0.722 Vali Loss: 0.697 Vali Acc: 0.501 Test Loss: 0.697 Test Acc: 0.501
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.7190828
	speed: 0.3691s/iter; left time: 11948.4723s
	iters: 200, epoch: 13 | loss: 0.7073040
	speed: 0.0922s/iter; left time: 2976.1508s
	iters: 300, epoch: 13 | loss: 0.7473315
	speed: 0.1098s/iter; left time: 3532.3159s
Epoch: 13 cost time: 37.60405731201172
Epoch: 13, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.7005627
	speed: 0.3782s/iter; left time: 12102.9844s
	iters: 200, epoch: 14 | loss: 0.8104827
	speed: 0.0917s/iter; left time: 2925.2702s
	iters: 300, epoch: 14 | loss: 0.6942987
	speed: 0.0915s/iter; left time: 2909.5931s
Epoch: 14 cost time: 35.5605947971344
Epoch: 14, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6725312145289444
model parameter : 2286514
model size : 11.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7342889
	speed: 0.1074s/iter; left time: 3951.8545s
	iters: 200, epoch: 1 | loss: 1.4887227
	speed: 0.0931s/iter; left time: 3416.2796s
	iters: 300, epoch: 1 | loss: 0.6723639
	speed: 0.0952s/iter; left time: 3485.7598s
Epoch: 1 cost time: 36.09896206855774
Epoch: 1, Steps: 369 | Train Loss: 0.905 Vali Loss: 1.437 Vali Acc: 0.544 Test Loss: 1.437 Test Acc: 0.544
Validation loss decreased (inf --> -0.543970).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2145402
	speed: 0.3607s/iter; left time: 13142.6472s
	iters: 200, epoch: 2 | loss: 0.5467359
	speed: 0.0901s/iter; left time: 3272.1689s
	iters: 300, epoch: 2 | loss: 0.4061421
	speed: 0.0980s/iter; left time: 3551.6336s
Epoch: 2 cost time: 36.264790773391724
Epoch: 2, Steps: 369 | Train Loss: 0.768 Vali Loss: 0.995 Vali Acc: 0.511 Test Loss: 0.995 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3431896
	speed: 0.3607s/iter; left time: 13006.1757s
	iters: 200, epoch: 3 | loss: 0.9310191
	speed: 0.0829s/iter; left time: 2981.6444s
	iters: 300, epoch: 3 | loss: 1.4825976
	speed: 0.0944s/iter; left time: 3387.2091s
Epoch: 3 cost time: 33.73177480697632
Epoch: 3, Steps: 369 | Train Loss: 0.673 Vali Loss: 0.681 Vali Acc: 0.664 Test Loss: 0.681 Test Acc: 0.664
Validation loss decreased (-0.543970 --> -0.664295).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6762435
	speed: 0.3635s/iter; left time: 12975.7195s
	iters: 200, epoch: 4 | loss: 0.7881487
	speed: 0.0959s/iter; left time: 3414.6252s
	iters: 300, epoch: 4 | loss: 0.4403611
	speed: 0.1062s/iter; left time: 3770.7116s
Epoch: 4 cost time: 38.45669388771057
Epoch: 4, Steps: 369 | Train Loss: 0.651 Vali Loss: 0.770 Vali Acc: 0.577 Test Loss: 0.770 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6574473
	speed: 0.3632s/iter; left time: 12830.2301s
	iters: 200, epoch: 5 | loss: 1.0974764
	speed: 0.0938s/iter; left time: 3302.7727s
	iters: 300, epoch: 5 | loss: 0.5541079
	speed: 0.0817s/iter; left time: 2868.0123s
Epoch: 5 cost time: 34.17936635017395
Epoch: 5, Steps: 369 | Train Loss: 0.628 Vali Loss: 0.642 Vali Acc: 0.669 Test Loss: 0.642 Test Acc: 0.669
Validation loss decreased (-0.664295 --> -0.669403).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4499279
	speed: 0.3389s/iter; left time: 11845.1437s
	iters: 200, epoch: 6 | loss: 0.6114773
	speed: 0.0977s/iter; left time: 3403.7843s
	iters: 300, epoch: 6 | loss: 0.4172136
	speed: 0.0997s/iter; left time: 3465.1330s
Epoch: 6 cost time: 36.363059520721436
Epoch: 6, Steps: 369 | Train Loss: 0.602 Vali Loss: 0.740 Vali Acc: 0.513 Test Loss: 0.740 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6116733
	speed: 0.3608s/iter; left time: 12479.7208s
	iters: 200, epoch: 7 | loss: 0.6252829
	speed: 0.0909s/iter; left time: 3136.0548s
	iters: 300, epoch: 7 | loss: 0.6611703
	speed: 0.0860s/iter; left time: 2957.1954s
Epoch: 7 cost time: 33.61881160736084
Epoch: 7, Steps: 369 | Train Loss: 0.587 Vali Loss: 0.639 Vali Acc: 0.654 Test Loss: 0.639 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8003377
	speed: 0.3400s/iter; left time: 11634.4502s
	iters: 200, epoch: 8 | loss: 0.5084744
	speed: 0.0927s/iter; left time: 3163.8889s
	iters: 300, epoch: 8 | loss: 0.7501165
	speed: 0.1012s/iter; left time: 3441.0067s
Epoch: 8 cost time: 37.00041675567627
Epoch: 8, Steps: 369 | Train Loss: 0.642 Vali Loss: 0.672 Vali Acc: 0.585 Test Loss: 0.672 Test Acc: 0.585
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.5783979
	speed: 0.3622s/iter; left time: 12258.8707s
	iters: 200, epoch: 9 | loss: 0.8774956
	speed: 0.0994s/iter; left time: 3355.9698s
	iters: 300, epoch: 9 | loss: 0.5997478
	speed: 0.0925s/iter; left time: 3112.8639s
Epoch: 9 cost time: 35.894144773483276
Epoch: 9, Steps: 369 | Train Loss: 0.622 Vali Loss: 0.788 Vali Acc: 0.590 Test Loss: 0.788 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6047105
	speed: 0.3546s/iter; left time: 11871.5252s
	iters: 200, epoch: 10 | loss: 0.5939278
	speed: 0.0952s/iter; left time: 3178.2866s
	iters: 300, epoch: 10 | loss: 0.5580642
	speed: 0.1115s/iter; left time: 3709.5096s
Epoch: 10 cost time: 37.34788513183594
Epoch: 10, Steps: 369 | Train Loss: 0.609 Vali Loss: 0.655 Vali Acc: 0.647 Test Loss: 0.655 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.5398441
	speed: 0.3572s/iter; left time: 11826.3112s
	iters: 200, epoch: 11 | loss: 0.5895519
	speed: 0.0898s/iter; left time: 2965.4975s
	iters: 300, epoch: 11 | loss: 0.4691230
	speed: 0.0843s/iter; left time: 2773.3964s
Epoch: 11 cost time: 33.957743644714355
Epoch: 11, Steps: 369 | Train Loss: 0.615 Vali Loss: 0.706 Vali Acc: 0.552 Test Loss: 0.706 Test Acc: 0.552
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.5501627
	speed: 0.3734s/iter; left time: 12226.5832s
	iters: 200, epoch: 12 | loss: 0.4686802
	speed: 0.1041s/iter; left time: 3397.6465s
	iters: 300, epoch: 12 | loss: 0.4726830
	speed: 0.1002s/iter; left time: 3260.9826s
Epoch: 12 cost time: 38.3922176361084
Epoch: 12, Steps: 369 | Train Loss: 0.635 Vali Loss: 0.702 Vali Acc: 0.583 Test Loss: 0.702 Test Acc: 0.583
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6561069
	speed: 0.3596s/iter; left time: 11639.9539s
	iters: 200, epoch: 13 | loss: 0.9816101
	speed: 0.0826s/iter; left time: 2665.2660s
	iters: 300, epoch: 13 | loss: 0.5201526
	speed: 0.0792s/iter; left time: 2548.4037s
Epoch: 13 cost time: 33.01050114631653
Epoch: 13, Steps: 369 | Train Loss: 0.615 Vali Loss: 0.704 Vali Acc: 0.616 Test Loss: 0.704 Test Acc: 0.616
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.6112829
	speed: 0.3546s/iter; left time: 11347.8939s
	iters: 200, epoch: 14 | loss: 0.6248437
	speed: 0.1032s/iter; left time: 3292.0718s
	iters: 300, epoch: 14 | loss: 0.7285098
	speed: 0.1020s/iter; left time: 3243.7968s
Epoch: 14 cost time: 37.32293677330017
Epoch: 14, Steps: 369 | Train Loss: 0.670 Vali Loss: 0.744 Vali Acc: 0.501 Test Loss: 0.744 Test Acc: 0.501
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.5579324
	speed: 0.3503s/iter; left time: 11082.7706s
	iters: 200, epoch: 15 | loss: 0.4846213
	speed: 0.0927s/iter; left time: 2924.3081s
	iters: 300, epoch: 15 | loss: 0.7175544
	speed: 0.0927s/iter; left time: 2913.3915s
Epoch: 15 cost time: 34.88879466056824
Epoch: 15, Steps: 369 | Train Loss: 0.692 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6694097616345063
model parameter : 2285106
model size : 11.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7024680
	speed: 0.1147s/iter; left time: 4220.6880s
	iters: 200, epoch: 1 | loss: 0.6984782
	speed: 0.0831s/iter; left time: 3048.9693s
	iters: 300, epoch: 1 | loss: 0.8631324
	speed: 0.0857s/iter; left time: 3136.7481s
Epoch: 1 cost time: 34.415730476379395
Epoch: 1, Steps: 369 | Train Loss: 0.780 Vali Loss: 0.994 Vali Acc: 0.535 Test Loss: 0.994 Test Acc: 0.535
Validation loss decreased (inf --> -0.534894).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3780652
	speed: 0.3458s/iter; left time: 12598.4487s
	iters: 200, epoch: 2 | loss: 0.6183408
	speed: 0.0821s/iter; left time: 2984.2427s
	iters: 300, epoch: 2 | loss: 0.5166919
	speed: 0.0860s/iter; left time: 3114.2827s
Epoch: 2 cost time: 32.74165368080139
Epoch: 2, Steps: 369 | Train Loss: 0.719 Vali Loss: 0.631 Vali Acc: 0.662 Test Loss: 0.631 Test Acc: 0.662
Validation loss decreased (-0.534894 --> -0.662309).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6812916
	speed: 0.3589s/iter; left time: 12941.9877s
	iters: 200, epoch: 3 | loss: 1.3665879
	speed: 0.0777s/iter; left time: 2795.5643s
	iters: 300, epoch: 3 | loss: 0.5956384
	speed: 0.0844s/iter; left time: 3026.7492s
Epoch: 3 cost time: 31.54017949104309
Epoch: 3, Steps: 369 | Train Loss: 0.665 Vali Loss: 0.758 Vali Acc: 0.671 Test Loss: 0.758 Test Acc: 0.671
Validation loss decreased (-0.662309 --> -0.670537).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6751535
	speed: 0.3579s/iter; left time: 12774.5420s
	iters: 200, epoch: 4 | loss: 0.7544240
	speed: 0.0919s/iter; left time: 3272.2294s
	iters: 300, epoch: 4 | loss: 0.6355823
	speed: 0.0875s/iter; left time: 3105.0640s
Epoch: 4 cost time: 34.28226613998413
Epoch: 4, Steps: 369 | Train Loss: 0.619 Vali Loss: 0.635 Vali Acc: 0.666 Test Loss: 0.635 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5613322
	speed: 0.3502s/iter; left time: 12369.6015s
	iters: 200, epoch: 5 | loss: 0.7180361
	speed: 0.0837s/iter; left time: 2948.7151s
	iters: 300, epoch: 5 | loss: 0.4622850
	speed: 0.0953s/iter; left time: 3345.6571s
Epoch: 5 cost time: 34.28838300704956
Epoch: 5, Steps: 369 | Train Loss: 0.565 Vali Loss: 0.646 Vali Acc: 0.660 Test Loss: 0.646 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5632151
	speed: 0.3545s/iter; left time: 12390.7548s
	iters: 200, epoch: 6 | loss: 0.5375444
	speed: 0.0941s/iter; left time: 3281.4806s
	iters: 300, epoch: 6 | loss: 0.4374136
	speed: 0.0857s/iter; left time: 2978.6212s
Epoch: 6 cost time: 34.17513585090637
Epoch: 6, Steps: 369 | Train Loss: 0.506 Vali Loss: 0.627 Vali Acc: 0.661 Test Loss: 0.627 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.5202538
	speed: 0.3580s/iter; left time: 12383.6856s
	iters: 200, epoch: 7 | loss: 0.4188977
	speed: 0.0848s/iter; left time: 2924.6144s
	iters: 300, epoch: 7 | loss: 0.4840586
	speed: 0.0839s/iter; left time: 2885.5233s
Epoch: 7 cost time: 33.69183588027954
Epoch: 7, Steps: 369 | Train Loss: 0.474 Vali Loss: 0.686 Vali Acc: 0.672 Test Loss: 0.686 Test Acc: 0.672
Validation loss decreased (-0.670537 --> -0.672241).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4290041
	speed: 0.3537s/iter; left time: 12104.2022s
	iters: 200, epoch: 8 | loss: 0.3105713
	speed: 0.0960s/iter; left time: 3275.1687s
	iters: 300, epoch: 8 | loss: 0.3243951
	speed: 0.0793s/iter; left time: 2697.8990s
Epoch: 8 cost time: 32.55679941177368
Epoch: 8, Steps: 369 | Train Loss: 0.443 Vali Loss: 0.721 Vali Acc: 0.665 Test Loss: 0.721 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6047872
	speed: 0.3524s/iter; left time: 11929.4434s
	iters: 200, epoch: 9 | loss: 0.3300422
	speed: 0.0838s/iter; left time: 2827.9211s
	iters: 300, epoch: 9 | loss: 0.3162607
	speed: 0.0859s/iter; left time: 2891.2490s
Epoch: 9 cost time: 34.05852270126343
Epoch: 9, Steps: 369 | Train Loss: 0.407 Vali Loss: 0.708 Vali Acc: 0.672 Test Loss: 0.708 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3688340
	speed: 0.3591s/iter; left time: 12024.2349s
	iters: 200, epoch: 10 | loss: 0.1900723
	speed: 0.0887s/iter; left time: 2960.6364s
	iters: 300, epoch: 10 | loss: 0.2346467
	speed: 0.0869s/iter; left time: 2893.6119s
Epoch: 10 cost time: 33.128682374954224
Epoch: 10, Steps: 369 | Train Loss: 0.378 Vali Loss: 0.785 Vali Acc: 0.648 Test Loss: 0.785 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.4945566
	speed: 0.3514s/iter; left time: 11636.4843s
	iters: 200, epoch: 11 | loss: 0.2416331
	speed: 0.0854s/iter; left time: 2820.0697s
	iters: 300, epoch: 11 | loss: 0.5377211
	speed: 0.0904s/iter; left time: 2975.6162s
Epoch: 11 cost time: 34.93390202522278
Epoch: 11, Steps: 369 | Train Loss: 0.324 Vali Loss: 0.859 Vali Acc: 0.657 Test Loss: 0.859 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2752656
	speed: 0.3645s/iter; left time: 11934.3177s
	iters: 200, epoch: 12 | loss: 0.1465388
	speed: 0.0870s/iter; left time: 2840.8215s
	iters: 300, epoch: 12 | loss: 0.2478027
	speed: 0.0906s/iter; left time: 2947.2189s
Epoch: 12 cost time: 33.281983613967896
Epoch: 12, Steps: 369 | Train Loss: 0.305 Vali Loss: 0.800 Vali Acc: 0.667 Test Loss: 0.800 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.3526748
	speed: 0.3524s/iter; left time: 11407.6366s
	iters: 200, epoch: 13 | loss: 0.4629415
	speed: 0.0844s/iter; left time: 2724.3007s
	iters: 300, epoch: 13 | loss: 0.1591995
	speed: 0.0831s/iter; left time: 2674.3609s
Epoch: 13 cost time: 33.855809926986694
Epoch: 13, Steps: 369 | Train Loss: 0.269 Vali Loss: 1.023 Vali Acc: 0.638 Test Loss: 1.023 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.2066741
	speed: 0.3672s/iter; left time: 11751.6212s
	iters: 200, epoch: 14 | loss: 0.0425548
	speed: 0.0790s/iter; left time: 2519.3016s
	iters: 300, epoch: 14 | loss: 0.3256773
	speed: 0.0830s/iter; left time: 2638.7353s
Epoch: 14 cost time: 30.950289726257324
Epoch: 14, Steps: 369 | Train Loss: 0.242 Vali Loss: 1.132 Vali Acc: 0.648 Test Loss: 1.132 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.4845381
	speed: 0.3461s/iter; left time: 10947.8942s
	iters: 200, epoch: 15 | loss: 0.1751580
	speed: 0.0859s/iter; left time: 2707.7400s
	iters: 300, epoch: 15 | loss: 0.1105975
	speed: 0.0911s/iter; left time: 2864.9669s
Epoch: 15 cost time: 34.62932825088501
Epoch: 15, Steps: 369 | Train Loss: 0.210 Vali Loss: 1.085 Vali Acc: 0.654 Test Loss: 1.085 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1141893
	speed: 0.3645s/iter; left time: 11395.2498s
	iters: 200, epoch: 16 | loss: 0.1660787
	speed: 0.0883s/iter; left time: 2751.2961s
	iters: 300, epoch: 16 | loss: 0.1140859
	speed: 0.0925s/iter; left time: 2874.5051s
Epoch: 16 cost time: 33.90722131729126
Epoch: 16, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.214 Vali Acc: 0.637 Test Loss: 1.214 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0840751
	speed: 0.3599s/iter; left time: 11119.9614s
	iters: 200, epoch: 17 | loss: 0.0980896
	speed: 0.0854s/iter; left time: 2628.8570s
	iters: 300, epoch: 17 | loss: 0.2342950
	speed: 0.0864s/iter; left time: 2653.0713s
Epoch: 17 cost time: 34.528077363967896
Epoch: 17, Steps: 369 | Train Loss: 0.177 Vali Loss: 1.182 Vali Acc: 0.664 Test Loss: 1.182 Test Acc: 0.664
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6722474460839954
model parameter : 1495474
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8283194
	speed: 0.1098s/iter; left time: 4042.5785s
	iters: 200, epoch: 1 | loss: 0.6389633
	speed: 0.0909s/iter; left time: 3334.5207s
	iters: 300, epoch: 1 | loss: 1.0798206
	speed: 0.0883s/iter; left time: 3230.0569s
Epoch: 1 cost time: 35.179051637649536
Epoch: 1, Steps: 369 | Train Loss: 0.818 Vali Loss: 1.769 Vali Acc: 0.532 Test Loss: 1.769 Test Acc: 0.532
Validation loss decreased (inf --> -0.532332).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7709782
	speed: 0.3739s/iter; left time: 13622.6155s
	iters: 200, epoch: 2 | loss: 0.4523531
	speed: 0.0853s/iter; left time: 3098.5485s
	iters: 300, epoch: 2 | loss: 0.7276568
	speed: 0.0850s/iter; left time: 3080.1552s
Epoch: 2 cost time: 34.103349924087524
Epoch: 2, Steps: 369 | Train Loss: 0.670 Vali Loss: 1.124 Vali Acc: 0.555 Test Loss: 1.124 Test Acc: 0.555
Validation loss decreased (-0.532332 --> -0.555324).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1304383
	speed: 0.3527s/iter; left time: 12718.0716s
	iters: 200, epoch: 3 | loss: 0.4372393
	speed: 0.0918s/iter; left time: 3300.5430s
	iters: 300, epoch: 3 | loss: 0.4925042
	speed: 0.0924s/iter; left time: 3314.8347s
Epoch: 3 cost time: 33.828630447387695
Epoch: 3, Steps: 369 | Train Loss: 0.672 Vali Loss: 0.670 Vali Acc: 0.669 Test Loss: 0.670 Test Acc: 0.669
Validation loss decreased (-0.555324 --> -0.668836).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3760143
	speed: 0.3746s/iter; left time: 13370.0570s
	iters: 200, epoch: 4 | loss: 0.5509157
	speed: 0.0954s/iter; left time: 3395.5524s
	iters: 300, epoch: 4 | loss: 0.9249166
	speed: 0.0882s/iter; left time: 3131.0500s
Epoch: 4 cost time: 36.37025451660156
Epoch: 4, Steps: 369 | Train Loss: 0.635 Vali Loss: 0.910 Vali Acc: 0.585 Test Loss: 0.910 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7026056
	speed: 0.3629s/iter; left time: 12818.3089s
	iters: 200, epoch: 5 | loss: 0.4503966
	speed: 0.1011s/iter; left time: 3562.3277s
	iters: 300, epoch: 5 | loss: 0.6577231
	speed: 0.0918s/iter; left time: 3223.4080s
Epoch: 5 cost time: 35.67971992492676
Epoch: 5, Steps: 369 | Train Loss: 0.598 Vali Loss: 0.606 Vali Acc: 0.677 Test Loss: 0.606 Test Acc: 0.677
Validation loss decreased (-0.668836 --> -0.676498).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8280649
	speed: 0.3618s/iter; left time: 12647.0168s
	iters: 200, epoch: 6 | loss: 0.4586064
	speed: 0.0867s/iter; left time: 3021.6262s
	iters: 300, epoch: 6 | loss: 0.5700426
	speed: 0.0871s/iter; left time: 3026.5068s
Epoch: 6 cost time: 33.395068645477295
Epoch: 6, Steps: 369 | Train Loss: 0.534 Vali Loss: 0.617 Vali Acc: 0.674 Test Loss: 0.617 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5304659
	speed: 0.3805s/iter; left time: 13161.8944s
	iters: 200, epoch: 7 | loss: 0.2922210
	speed: 0.0945s/iter; left time: 3259.9947s
	iters: 300, epoch: 7 | loss: 0.3865897
	speed: 0.0917s/iter; left time: 3151.9826s
Epoch: 7 cost time: 35.095404386520386
Epoch: 7, Steps: 369 | Train Loss: 0.475 Vali Loss: 0.711 Vali Acc: 0.674 Test Loss: 0.711 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3581400
	speed: 0.3791s/iter; left time: 12971.4431s
	iters: 200, epoch: 8 | loss: 0.3884515
	speed: 0.0869s/iter; left time: 2964.0832s
	iters: 300, epoch: 8 | loss: 0.3037518
	speed: 0.0983s/iter; left time: 3345.6126s
Epoch: 8 cost time: 35.582587003707886
Epoch: 8, Steps: 369 | Train Loss: 0.432 Vali Loss: 0.646 Vali Acc: 0.671 Test Loss: 0.646 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4149518
	speed: 0.3896s/iter; left time: 13185.9188s
	iters: 200, epoch: 9 | loss: 0.2933494
	speed: 0.0957s/iter; left time: 3228.3241s
	iters: 300, epoch: 9 | loss: 0.5809192
	speed: 0.1014s/iter; left time: 3411.9163s
Epoch: 9 cost time: 38.58918023109436
Epoch: 9, Steps: 369 | Train Loss: 0.393 Vali Loss: 0.703 Vali Acc: 0.667 Test Loss: 0.703 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2587303
	speed: 0.3909s/iter; left time: 13085.8031s
	iters: 200, epoch: 10 | loss: 0.4395653
	speed: 0.1005s/iter; left time: 3354.9231s
	iters: 300, epoch: 10 | loss: 0.1829148
	speed: 0.0932s/iter; left time: 3100.7622s
Epoch: 10 cost time: 36.63629412651062
Epoch: 10, Steps: 369 | Train Loss: 0.367 Vali Loss: 0.748 Vali Acc: 0.660 Test Loss: 0.748 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.6367778
	speed: 0.3831s/iter; left time: 12686.3248s
	iters: 200, epoch: 11 | loss: 0.3174240
	speed: 0.1082s/iter; left time: 3571.4663s
	iters: 300, epoch: 11 | loss: 0.4021295
	speed: 0.1013s/iter; left time: 3333.0279s
Epoch: 11 cost time: 38.65982174873352
Epoch: 11, Steps: 369 | Train Loss: 0.320 Vali Loss: 0.900 Vali Acc: 0.660 Test Loss: 0.900 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2378365
	speed: 0.3898s/iter; left time: 12764.3092s
	iters: 200, epoch: 12 | loss: 0.0835907
	speed: 0.0852s/iter; left time: 2780.5818s
	iters: 300, epoch: 12 | loss: 0.1778346
	speed: 0.0891s/iter; left time: 2898.0753s
Epoch: 12 cost time: 35.529282569885254
Epoch: 12, Steps: 369 | Train Loss: 0.295 Vali Loss: 0.920 Vali Acc: 0.651 Test Loss: 0.920 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1946901
	speed: 0.3901s/iter; left time: 12627.7951s
	iters: 200, epoch: 13 | loss: 0.4963326
	speed: 0.1092s/iter; left time: 3524.9920s
	iters: 300, epoch: 13 | loss: 0.1991799
	speed: 0.0941s/iter; left time: 3026.1445s
Epoch: 13 cost time: 37.17357635498047
Epoch: 13, Steps: 369 | Train Loss: 0.254 Vali Loss: 1.059 Vali Acc: 0.640 Test Loss: 1.059 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0898426
	speed: 0.3790s/iter; left time: 12129.8213s
	iters: 200, epoch: 14 | loss: 0.2815759
	speed: 0.0907s/iter; left time: 2895.2728s
	iters: 300, epoch: 14 | loss: 0.0757312
	speed: 0.0977s/iter; left time: 3108.7154s
Epoch: 14 cost time: 35.90426969528198
Epoch: 14, Steps: 369 | Train Loss: 0.245 Vali Loss: 1.089 Vali Acc: 0.635 Test Loss: 1.089 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1423364
	speed: 0.3846s/iter; left time: 12167.5880s
	iters: 200, epoch: 15 | loss: 0.0852384
	speed: 0.0968s/iter; left time: 3053.8777s
	iters: 300, epoch: 15 | loss: 0.1231439
	speed: 0.0885s/iter; left time: 2780.5066s
Epoch: 15 cost time: 36.45606327056885
Epoch: 15, Steps: 369 | Train Loss: 0.209 Vali Loss: 1.220 Vali Acc: 0.639 Test Loss: 1.220 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6765039727582293
model parameter : 1494770
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5019782
	speed: 0.1175s/iter; left time: 4322.3350s
	iters: 200, epoch: 1 | loss: 0.6518188
	speed: 0.1023s/iter; left time: 3755.0188s
	iters: 300, epoch: 1 | loss: 0.5210682
	speed: 0.0900s/iter; left time: 3292.4290s
Epoch: 1 cost time: 37.350194454193115
Epoch: 1, Steps: 369 | Train Loss: 0.895 Vali Loss: 0.739 Vali Acc: 0.568 Test Loss: 0.739 Test Acc: 0.568
Validation loss decreased (inf --> -0.568381).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2850877
	speed: 0.3756s/iter; left time: 13685.2365s
	iters: 200, epoch: 2 | loss: 0.6396663
	speed: 0.0906s/iter; left time: 3293.0519s
	iters: 300, epoch: 2 | loss: 0.5949947
	speed: 0.0950s/iter; left time: 3442.1428s
Epoch: 2 cost time: 36.234591484069824
Epoch: 2, Steps: 369 | Train Loss: 0.695 Vali Loss: 0.719 Vali Acc: 0.647 Test Loss: 0.719 Test Acc: 0.647
Validation loss decreased (-0.568381 --> -0.646701).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4815604
	speed: 0.3883s/iter; left time: 14004.5814s
	iters: 200, epoch: 3 | loss: 0.7007163
	speed: 0.0940s/iter; left time: 3380.4443s
	iters: 300, epoch: 3 | loss: 1.0027857
	speed: 0.0924s/iter; left time: 3314.2732s
Epoch: 3 cost time: 34.800761461257935
Epoch: 3, Steps: 369 | Train Loss: 0.672 Vali Loss: 0.691 Vali Acc: 0.652 Test Loss: 0.691 Test Acc: 0.652
Validation loss decreased (-0.646701 --> -0.652093).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1029128
	speed: 0.3764s/iter; left time: 13435.2069s
	iters: 200, epoch: 4 | loss: 0.4919335
	speed: 0.0972s/iter; left time: 3460.3487s
	iters: 300, epoch: 4 | loss: 0.9278488
	speed: 0.0976s/iter; left time: 3465.3397s
Epoch: 4 cost time: 36.89593839645386
Epoch: 4, Steps: 369 | Train Loss: 0.652 Vali Loss: 0.627 Vali Acc: 0.673 Test Loss: 0.627 Test Acc: 0.673
Validation loss decreased (-0.652093 --> -0.673092).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6133536
	speed: 0.3682s/iter; left time: 13007.0016s
	iters: 200, epoch: 5 | loss: 0.5128088
	speed: 0.0914s/iter; left time: 3218.2661s
	iters: 300, epoch: 5 | loss: 0.6280660
	speed: 0.0903s/iter; left time: 3171.2620s
Epoch: 5 cost time: 34.62388491630554
Epoch: 5, Steps: 369 | Train Loss: 0.576 Vali Loss: 0.652 Vali Acc: 0.667 Test Loss: 0.652 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4256744
	speed: 0.3838s/iter; left time: 13416.0447s
	iters: 200, epoch: 6 | loss: 0.5597354
	speed: 0.0975s/iter; left time: 3397.9553s
	iters: 300, epoch: 6 | loss: 0.6222759
	speed: 0.0819s/iter; left time: 2846.5740s
Epoch: 6 cost time: 36.70259642601013
Epoch: 6, Steps: 369 | Train Loss: 0.512 Vali Loss: 0.621 Vali Acc: 0.665 Test Loss: 0.621 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4072961
	speed: 0.3715s/iter; left time: 12850.4709s
	iters: 200, epoch: 7 | loss: 0.2804669
	speed: 0.0856s/iter; left time: 2952.0488s
	iters: 300, epoch: 7 | loss: 0.4641923
	speed: 0.0908s/iter; left time: 3121.7548s
Epoch: 7 cost time: 33.97655987739563
Epoch: 7, Steps: 369 | Train Loss: 0.465 Vali Loss: 0.615 Vali Acc: 0.665 Test Loss: 0.615 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4021833
	speed: 0.3835s/iter; left time: 13121.7223s
	iters: 200, epoch: 8 | loss: 0.7578070
	speed: 0.0932s/iter; left time: 3178.8854s
	iters: 300, epoch: 8 | loss: 0.4222730
	speed: 0.0902s/iter; left time: 3066.9968s
Epoch: 8 cost time: 35.07634258270264
Epoch: 8, Steps: 369 | Train Loss: 0.441 Vali Loss: 0.616 Vali Acc: 0.677 Test Loss: 0.616 Test Acc: 0.677
Validation loss decreased (-0.673092 --> -0.676782).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4468509
	speed: 0.3698s/iter; left time: 12519.0505s
	iters: 200, epoch: 9 | loss: 0.1752891
	speed: 0.0895s/iter; left time: 3020.9960s
	iters: 300, epoch: 9 | loss: 0.4265823
	speed: 0.0961s/iter; left time: 3233.3866s
Epoch: 9 cost time: 35.659873247146606
Epoch: 9, Steps: 369 | Train Loss: 0.411 Vali Loss: 0.697 Vali Acc: 0.663 Test Loss: 0.697 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3013853
	speed: 0.3711s/iter; left time: 12425.7576s
	iters: 200, epoch: 10 | loss: 0.5155325
	speed: 0.0978s/iter; left time: 3264.3735s
	iters: 300, epoch: 10 | loss: 0.7766647
	speed: 0.0929s/iter; left time: 3091.2129s
Epoch: 10 cost time: 35.040215492248535
Epoch: 10, Steps: 369 | Train Loss: 0.373 Vali Loss: 0.762 Vali Acc: 0.661 Test Loss: 0.762 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2769943
	speed: 0.3675s/iter; left time: 12167.9105s
	iters: 200, epoch: 11 | loss: 0.2322918
	speed: 0.0957s/iter; left time: 3157.8257s
	iters: 300, epoch: 11 | loss: 0.2351920
	speed: 0.1044s/iter; left time: 3435.2668s
Epoch: 11 cost time: 37.32359480857849
Epoch: 11, Steps: 369 | Train Loss: 0.336 Vali Loss: 0.957 Vali Acc: 0.656 Test Loss: 0.957 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.3768196
	speed: 0.3801s/iter; left time: 12444.4152s
	iters: 200, epoch: 12 | loss: 0.1384991
	speed: 0.1002s/iter; left time: 3271.7586s
	iters: 300, epoch: 12 | loss: 0.4874067
	speed: 0.0850s/iter; left time: 2766.3208s
Epoch: 12 cost time: 34.44273018836975
Epoch: 12, Steps: 369 | Train Loss: 0.313 Vali Loss: 0.931 Vali Acc: 0.644 Test Loss: 0.931 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1793462
	speed: 0.3750s/iter; left time: 12140.3688s
	iters: 200, epoch: 13 | loss: 0.1811073
	speed: 0.0936s/iter; left time: 3022.3647s
	iters: 300, epoch: 13 | loss: 0.6804941
	speed: 0.0969s/iter; left time: 3117.7695s
Epoch: 13 cost time: 37.642964601516724
Epoch: 13, Steps: 369 | Train Loss: 0.287 Vali Loss: 1.049 Vali Acc: 0.657 Test Loss: 1.049 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.1963507
	speed: 0.3875s/iter; left time: 12400.7947s
	iters: 200, epoch: 14 | loss: 0.1937563
	speed: 0.0841s/iter; left time: 2683.3107s
	iters: 300, epoch: 14 | loss: 0.5944512
	speed: 0.0960s/iter; left time: 3054.3321s
Epoch: 14 cost time: 34.225268602371216
Epoch: 14, Steps: 369 | Train Loss: 0.257 Vali Loss: 0.868 Vali Acc: 0.653 Test Loss: 0.868 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0117474
	speed: 0.3811s/iter; left time: 12056.3880s
	iters: 200, epoch: 15 | loss: 0.1950393
	speed: 0.0984s/iter; left time: 3101.4741s
	iters: 300, epoch: 15 | loss: 0.2101947
	speed: 0.0926s/iter; left time: 2909.7873s
Epoch: 15 cost time: 37.281341314315796
Epoch: 15, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.040 Vali Acc: 0.657 Test Loss: 1.040 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1319084
	speed: 0.3772s/iter; left time: 11794.4757s
	iters: 200, epoch: 16 | loss: 0.1035385
	speed: 0.0935s/iter; left time: 2912.9756s
	iters: 300, epoch: 16 | loss: 0.1884324
	speed: 0.0939s/iter; left time: 2917.0529s
Epoch: 16 cost time: 35.46833419799805
Epoch: 16, Steps: 369 | Train Loss: 0.216 Vali Loss: 1.143 Vali Acc: 0.645 Test Loss: 1.143 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.2124937
	speed: 0.3847s/iter; left time: 11887.4271s
	iters: 200, epoch: 17 | loss: 0.2612878
	speed: 0.0884s/iter; left time: 2721.0253s
	iters: 300, epoch: 17 | loss: 0.4100009
	speed: 0.0886s/iter; left time: 2721.1084s
Epoch: 17 cost time: 35.427696228027344
Epoch: 17, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.237 Vali Acc: 0.658 Test Loss: 1.237 Test Acc: 0.658
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.1967427
	speed: 0.3646s/iter; left time: 11130.7630s
	iters: 200, epoch: 18 | loss: 0.2048544
	speed: 0.0931s/iter; left time: 2832.5918s
	iters: 300, epoch: 18 | loss: 0.4695275
	speed: 0.0924s/iter; left time: 2802.8653s
Epoch: 18 cost time: 34.194435834884644
Epoch: 18, Steps: 369 | Train Loss: 0.166 Vali Loss: 1.302 Vali Acc: 0.644 Test Loss: 1.302 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6767877412031782
model parameter : 1494066
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5720550
	speed: 0.1501s/iter; left time: 5523.1877s
	iters: 200, epoch: 1 | loss: 0.8737012
	speed: 0.1118s/iter; left time: 4104.9213s
	iters: 300, epoch: 1 | loss: 0.6851895
	speed: 0.0988s/iter; left time: 3615.2668s
Epoch: 1 cost time: 44.27854537963867
Epoch: 1, Steps: 369 | Train Loss: 0.789 Vali Loss: 0.929 Vali Acc: 0.601 Test Loss: 0.929 Test Acc: 0.601
Validation loss decreased (inf --> -0.600729).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3741128
	speed: 0.3474s/iter; left time: 12654.9472s
	iters: 200, epoch: 2 | loss: 0.5650618
	speed: 0.0865s/iter; left time: 3142.5349s
	iters: 300, epoch: 2 | loss: 0.6361851
	speed: 0.1084s/iter; left time: 3927.9145s
Epoch: 2 cost time: 35.54399490356445
Epoch: 2, Steps: 369 | Train Loss: 0.681 Vali Loss: 1.031 Vali Acc: 0.550 Test Loss: 1.031 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6714656
	speed: 0.3650s/iter; left time: 13163.6152s
	iters: 200, epoch: 3 | loss: 0.6666522
	speed: 0.0840s/iter; left time: 3021.3757s
	iters: 300, epoch: 3 | loss: 0.8449649
	speed: 0.0901s/iter; left time: 3231.6493s
Epoch: 3 cost time: 33.3298864364624
Epoch: 3, Steps: 369 | Train Loss: 0.687 Vali Loss: 0.709 Vali Acc: 0.647 Test Loss: 0.709 Test Acc: 0.647
Validation loss decreased (-0.600729 --> -0.646985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6598067
	speed: 0.3481s/iter; left time: 12425.6396s
	iters: 200, epoch: 4 | loss: 0.6988830
	speed: 0.0981s/iter; left time: 3492.7387s
	iters: 300, epoch: 4 | loss: 0.6259698
	speed: 0.1052s/iter; left time: 3734.0491s
Epoch: 4 cost time: 36.49356961250305
Epoch: 4, Steps: 369 | Train Loss: 0.614 Vali Loss: 0.667 Vali Acc: 0.628 Test Loss: 0.667 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1867987
	speed: 0.3657s/iter; left time: 12916.8888s
	iters: 200, epoch: 5 | loss: 0.6532726
	speed: 0.0883s/iter; left time: 3111.7847s
	iters: 300, epoch: 5 | loss: 0.3241874
	speed: 0.0801s/iter; left time: 2811.7645s
Epoch: 5 cost time: 33.135944843292236
Epoch: 5, Steps: 369 | Train Loss: 0.595 Vali Loss: 0.660 Vali Acc: 0.652 Test Loss: 0.660 Test Acc: 0.652
Validation loss decreased (-0.646985 --> -0.651526).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6387539
	speed: 0.3702s/iter; left time: 12941.2485s
	iters: 200, epoch: 6 | loss: 0.3284003
	speed: 0.0867s/iter; left time: 3021.6428s
	iters: 300, epoch: 6 | loss: 0.5392997
	speed: 0.0912s/iter; left time: 3170.1250s
Epoch: 6 cost time: 34.696632862091064
Epoch: 6, Steps: 369 | Train Loss: 0.545 Vali Loss: 0.817 Vali Acc: 0.604 Test Loss: 0.817 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8468478
	speed: 0.3687s/iter; left time: 12753.0309s
	iters: 200, epoch: 7 | loss: 0.4968982
	speed: 0.0909s/iter; left time: 3134.2311s
	iters: 300, epoch: 7 | loss: 0.4880260
	speed: 0.0918s/iter; left time: 3157.7379s
Epoch: 7 cost time: 34.61098098754883
Epoch: 7, Steps: 369 | Train Loss: 0.493 Vali Loss: 0.979 Vali Acc: 0.623 Test Loss: 0.979 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3034747
	speed: 0.3717s/iter; left time: 12719.3183s
	iters: 200, epoch: 8 | loss: 0.3273832
	speed: 0.1014s/iter; left time: 3460.9836s
	iters: 300, epoch: 8 | loss: 0.3617091
	speed: 0.0910s/iter; left time: 3095.6518s
Epoch: 8 cost time: 36.443511724472046
Epoch: 8, Steps: 369 | Train Loss: 0.447 Vali Loss: 0.728 Vali Acc: 0.671 Test Loss: 0.728 Test Acc: 0.671
Validation loss decreased (-0.651526 --> -0.671105).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2373370
	speed: 0.3562s/iter; left time: 12056.2284s
	iters: 200, epoch: 9 | loss: 0.2738018
	speed: 0.0970s/iter; left time: 3274.5833s
	iters: 300, epoch: 9 | loss: 0.7675891
	speed: 0.0944s/iter; left time: 3175.6114s
Epoch: 9 cost time: 35.195250272750854
Epoch: 9, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.723 Vali Acc: 0.661 Test Loss: 0.723 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2839038
	speed: 0.3706s/iter; left time: 12408.0198s
	iters: 200, epoch: 10 | loss: 0.5741879
	speed: 0.0881s/iter; left time: 2942.4071s
	iters: 300, epoch: 10 | loss: 0.2813689
	speed: 0.0919s/iter; left time: 3059.0484s
Epoch: 10 cost time: 35.79809784889221
Epoch: 10, Steps: 369 | Train Loss: 0.399 Vali Loss: 0.771 Vali Acc: 0.650 Test Loss: 0.771 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2365620
	speed: 0.3597s/iter; left time: 11909.4212s
	iters: 200, epoch: 11 | loss: 0.4068494
	speed: 0.0947s/iter; left time: 3125.9943s
	iters: 300, epoch: 11 | loss: 0.6365324
	speed: 0.0939s/iter; left time: 3090.0078s
Epoch: 11 cost time: 34.817426443099976
Epoch: 11, Steps: 369 | Train Loss: 0.366 Vali Loss: 0.818 Vali Acc: 0.633 Test Loss: 0.818 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.4205554
	speed: 0.3459s/iter; left time: 11326.1781s
	iters: 200, epoch: 12 | loss: 0.1946611
	speed: 0.0825s/iter; left time: 2694.1229s
	iters: 300, epoch: 12 | loss: 0.4654278
	speed: 0.0861s/iter; left time: 2801.9066s
Epoch: 12 cost time: 31.88842272758484
Epoch: 12, Steps: 369 | Train Loss: 0.334 Vali Loss: 0.917 Vali Acc: 0.660 Test Loss: 0.917 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.3378321
	speed: 0.3605s/iter; left time: 11669.7403s
	iters: 200, epoch: 13 | loss: 0.2988872
	speed: 0.0805s/iter; left time: 2596.6857s
	iters: 300, epoch: 13 | loss: 0.1806368
	speed: 0.0898s/iter; left time: 2890.1035s
Epoch: 13 cost time: 33.67160487174988
Epoch: 13, Steps: 369 | Train Loss: 0.312 Vali Loss: 0.887 Vali Acc: 0.646 Test Loss: 0.887 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.1204898
	speed: 0.3611s/iter; left time: 11555.2415s
	iters: 200, epoch: 14 | loss: 0.3191985
	speed: 0.0817s/iter; left time: 2607.0156s
	iters: 300, epoch: 14 | loss: 0.2308295
	speed: 0.0854s/iter; left time: 2715.0018s
Epoch: 14 cost time: 33.17755126953125
Epoch: 14, Steps: 369 | Train Loss: 0.281 Vali Loss: 1.025 Vali Acc: 0.645 Test Loss: 1.025 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.4078528
	speed: 0.3496s/iter; left time: 11060.6074s
	iters: 200, epoch: 15 | loss: 0.3037917
	speed: 0.0909s/iter; left time: 2866.0964s
	iters: 300, epoch: 15 | loss: 0.1902280
	speed: 0.1010s/iter; left time: 3174.4471s
Epoch: 15 cost time: 35.05825352668762
Epoch: 15, Steps: 369 | Train Loss: 0.245 Vali Loss: 1.150 Vali Acc: 0.644 Test Loss: 1.150 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.2098093
	speed: 0.3638s/iter; left time: 11376.1065s
	iters: 200, epoch: 16 | loss: 0.4669863
	speed: 0.0971s/iter; left time: 3025.1920s
	iters: 300, epoch: 16 | loss: 0.1694035
	speed: 0.0850s/iter; left time: 2640.9866s
Epoch: 16 cost time: 34.71757698059082
Epoch: 16, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.001 Vali Acc: 0.669 Test Loss: 1.001 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0267787
	speed: 0.3524s/iter; left time: 10888.3822s
	iters: 200, epoch: 17 | loss: 0.0603129
	speed: 0.1009s/iter; left time: 3107.3847s
	iters: 300, epoch: 17 | loss: 0.1689278
	speed: 0.1150s/iter; left time: 3531.3608s
Epoch: 17 cost time: 36.988797187805176
Epoch: 17, Steps: 369 | Train Loss: 0.192 Vali Loss: 1.254 Vali Acc: 0.658 Test Loss: 1.254 Test Acc: 0.658
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.1655369
	speed: 0.3640s/iter; left time: 11112.4460s
	iters: 200, epoch: 18 | loss: 0.0339278
	speed: 0.0877s/iter; left time: 2667.6849s
	iters: 300, epoch: 18 | loss: 0.1767339
	speed: 0.0876s/iter; left time: 2655.6256s
Epoch: 18 cost time: 33.05594229698181
Epoch: 18, Steps: 369 | Train Loss: 0.172 Vali Loss: 1.317 Vali Acc: 0.638 Test Loss: 1.317 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6711123723041997
model parameter : 1493362
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5515882
	speed: 0.1092s/iter; left time: 4016.9812s
	iters: 200, epoch: 1 | loss: 0.8353229
	speed: 0.0877s/iter; left time: 3218.7579s
	iters: 300, epoch: 1 | loss: 0.8411101
	speed: 0.0906s/iter; left time: 3314.4053s
Epoch: 1 cost time: 35.08341336250305
Epoch: 1, Steps: 369 | Train Loss: 0.816 Vali Loss: 0.886 Vali Acc: 0.559 Test Loss: 0.886 Test Acc: 0.559
Validation loss decreased (inf --> -0.558731).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8185702
	speed: 0.3666s/iter; left time: 13355.5797s
	iters: 200, epoch: 2 | loss: 0.5241621
	speed: 0.1022s/iter; left time: 3713.8672s
	iters: 300, epoch: 2 | loss: 0.5999581
	speed: 0.0895s/iter; left time: 3241.8010s
Epoch: 2 cost time: 36.41297769546509
Epoch: 2, Steps: 369 | Train Loss: 0.685 Vali Loss: 0.781 Vali Acc: 0.619 Test Loss: 0.781 Test Acc: 0.619
Validation loss decreased (-0.558731 --> -0.619175).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4776360
	speed: 0.3406s/iter; left time: 12282.1580s
	iters: 200, epoch: 3 | loss: 0.3650274
	speed: 0.0798s/iter; left time: 2868.9064s
	iters: 300, epoch: 3 | loss: 0.5163659
	speed: 0.0878s/iter; left time: 3147.6529s
Epoch: 3 cost time: 32.11608672142029
Epoch: 3, Steps: 369 | Train Loss: 0.666 Vali Loss: 0.637 Vali Acc: 0.633 Test Loss: 0.637 Test Acc: 0.633
Validation loss decreased (-0.619175 --> -0.632797).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4583656
	speed: 0.3735s/iter; left time: 13331.1191s
	iters: 200, epoch: 4 | loss: 0.6036630
	speed: 0.0925s/iter; left time: 3292.0108s
	iters: 300, epoch: 4 | loss: 0.4325705
	speed: 0.0854s/iter; left time: 3030.8362s
Epoch: 4 cost time: 34.78935980796814
Epoch: 4, Steps: 369 | Train Loss: 0.600 Vali Loss: 0.889 Vali Acc: 0.529 Test Loss: 0.889 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7006934
	speed: 0.3674s/iter; left time: 12978.0540s
	iters: 200, epoch: 5 | loss: 0.6824846
	speed: 0.0876s/iter; left time: 3087.0195s
	iters: 300, epoch: 5 | loss: 0.4855145
	speed: 0.0864s/iter; left time: 3036.4364s
Epoch: 5 cost time: 33.861010789871216
Epoch: 5, Steps: 369 | Train Loss: 0.549 Vali Loss: 0.710 Vali Acc: 0.659 Test Loss: 0.710 Test Acc: 0.659
Validation loss decreased (-0.632797 --> -0.659187).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3195016
	speed: 0.3535s/iter; left time: 12355.3207s
	iters: 200, epoch: 6 | loss: 1.1253163
	speed: 0.0911s/iter; left time: 3174.0237s
	iters: 300, epoch: 6 | loss: 0.4529501
	speed: 0.0904s/iter; left time: 3143.3634s
Epoch: 6 cost time: 34.26006555557251
Epoch: 6, Steps: 369 | Train Loss: 0.486 Vali Loss: 0.614 Vali Acc: 0.673 Test Loss: 0.614 Test Acc: 0.673
Validation loss decreased (-0.659187 --> -0.673093).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5771087
	speed: 0.3602s/iter; left time: 12459.8226s
	iters: 200, epoch: 7 | loss: 0.3436908
	speed: 0.0894s/iter; left time: 3084.6093s
	iters: 300, epoch: 7 | loss: 0.3906563
	speed: 0.0985s/iter; left time: 3388.4715s
Epoch: 7 cost time: 35.95745658874512
Epoch: 7, Steps: 369 | Train Loss: 0.440 Vali Loss: 0.829 Vali Acc: 0.652 Test Loss: 0.829 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5137731
	speed: 0.3619s/iter; left time: 12385.0960s
	iters: 200, epoch: 8 | loss: 0.2679091
	speed: 0.0843s/iter; left time: 2877.8278s
	iters: 300, epoch: 8 | loss: 0.5480454
	speed: 0.0929s/iter; left time: 3158.7985s
Epoch: 8 cost time: 34.070345640182495
Epoch: 8, Steps: 369 | Train Loss: 0.394 Vali Loss: 0.720 Vali Acc: 0.682 Test Loss: 0.720 Test Acc: 0.682
Validation loss decreased (-0.673093 --> -0.682456).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2183421
	speed: 0.3524s/iter; left time: 11929.1527s
	iters: 200, epoch: 9 | loss: 0.0656303
	speed: 0.1020s/iter; left time: 3442.5869s
	iters: 300, epoch: 9 | loss: 0.2567875
	speed: 0.0911s/iter; left time: 3064.0672s
Epoch: 9 cost time: 35.35062003135681
Epoch: 9, Steps: 369 | Train Loss: 0.348 Vali Loss: 0.852 Vali Acc: 0.658 Test Loss: 0.852 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3463413
	speed: 0.3598s/iter; left time: 12045.6418s
	iters: 200, epoch: 10 | loss: 0.1318814
	speed: 0.0802s/iter; left time: 2677.4063s
	iters: 300, epoch: 10 | loss: 0.0986562
	speed: 0.0859s/iter; left time: 2857.9175s
Epoch: 10 cost time: 32.16322374343872
Epoch: 10, Steps: 369 | Train Loss: 0.316 Vali Loss: 0.818 Vali Acc: 0.657 Test Loss: 0.818 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2267735
	speed: 0.3541s/iter; left time: 11726.1064s
	iters: 200, epoch: 11 | loss: 0.2599250
	speed: 0.1023s/iter; left time: 3375.4057s
	iters: 300, epoch: 11 | loss: 0.1247095
	speed: 0.0993s/iter; left time: 3269.3454s
Epoch: 11 cost time: 36.967931032180786
Epoch: 11, Steps: 369 | Train Loss: 0.263 Vali Loss: 0.999 Vali Acc: 0.655 Test Loss: 0.999 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.3882059
	speed: 0.3524s/iter; left time: 11538.1767s
	iters: 200, epoch: 12 | loss: 0.1257983
	speed: 0.0934s/iter; left time: 3048.9229s
	iters: 300, epoch: 12 | loss: 0.3723949
	speed: 0.0891s/iter; left time: 2900.0897s
Epoch: 12 cost time: 34.336602210998535
Epoch: 12, Steps: 369 | Train Loss: 0.234 Vali Loss: 1.020 Vali Acc: 0.646 Test Loss: 1.020 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.3383837
	speed: 0.3685s/iter; left time: 11928.3391s
	iters: 200, epoch: 13 | loss: 0.6088385
	speed: 0.0956s/iter; left time: 3084.1734s
	iters: 300, epoch: 13 | loss: 0.2882620
	speed: 0.0823s/iter; left time: 2648.5484s
Epoch: 13 cost time: 35.958361864089966
Epoch: 13, Steps: 369 | Train Loss: 0.209 Vali Loss: 1.044 Vali Acc: 0.643 Test Loss: 1.044 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.5312183
	speed: 0.3488s/iter; left time: 11161.6879s
	iters: 200, epoch: 14 | loss: 0.0747732
	speed: 0.0901s/iter; left time: 2874.4543s
	iters: 300, epoch: 14 | loss: 0.2983325
	speed: 0.0901s/iter; left time: 2866.4597s
Epoch: 14 cost time: 33.72951412200928
Epoch: 14, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.276 Vali Acc: 0.658 Test Loss: 1.276 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0476663
	speed: 0.3583s/iter; left time: 11335.8414s
	iters: 200, epoch: 15 | loss: 0.2383533
	speed: 0.0822s/iter; left time: 2592.9263s
	iters: 300, epoch: 15 | loss: 0.3237399
	speed: 0.0892s/iter; left time: 2803.8302s
Epoch: 15 cost time: 33.8496036529541
Epoch: 15, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.317 Vali Acc: 0.646 Test Loss: 1.317 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1700445
	speed: 0.3453s/iter; left time: 10794.7993s
	iters: 200, epoch: 16 | loss: 0.0866835
	speed: 0.0716s/iter; left time: 2232.3106s
	iters: 300, epoch: 16 | loss: 0.0508833
	speed: 0.0791s/iter; left time: 2455.9494s
Epoch: 16 cost time: 29.897932767868042
Epoch: 16, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.127 Vali Acc: 0.646 Test Loss: 1.127 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1916239
	speed: 0.3466s/iter; left time: 10708.4043s
	iters: 200, epoch: 17 | loss: 0.1047535
	speed: 0.0836s/iter; left time: 2575.4691s
	iters: 300, epoch: 17 | loss: 0.0167443
	speed: 0.0927s/iter; left time: 2844.1233s
Epoch: 17 cost time: 34.02438926696777
Epoch: 17, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.470 Vali Acc: 0.634 Test Loss: 1.470 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0680543
	speed: 0.3405s/iter; left time: 10394.7111s
	iters: 200, epoch: 18 | loss: 0.0100452
	speed: 0.0830s/iter; left time: 2525.3030s
	iters: 300, epoch: 18 | loss: 0.0096154
	speed: 0.0905s/iter; left time: 2744.5037s
Epoch: 18 cost time: 33.31214952468872
Epoch: 18, Steps: 369 | Train Loss: 0.129 Vali Loss: 1.504 Vali Acc: 0.634 Test Loss: 1.504 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6824631101021567
model parameter : 1033138
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7781397
	speed: 0.1206s/iter; left time: 4439.2502s
	iters: 200, epoch: 1 | loss: 0.5523873
	speed: 0.0878s/iter; left time: 3221.7145s
	iters: 300, epoch: 1 | loss: 0.7675976
	speed: 0.0858s/iter; left time: 3140.8352s
Epoch: 1 cost time: 36.15870976448059
Epoch: 1, Steps: 369 | Train Loss: 0.795 Vali Loss: 0.913 Vali Acc: 0.596 Test Loss: 0.913 Test Acc: 0.596
Validation loss decreased (inf --> -0.596188).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4735767
	speed: 0.3676s/iter; left time: 13392.2507s
	iters: 200, epoch: 2 | loss: 0.4733365
	speed: 0.0860s/iter; left time: 3122.8986s
	iters: 300, epoch: 2 | loss: 0.7803999
	speed: 0.0907s/iter; left time: 3285.2997s
Epoch: 2 cost time: 33.50019383430481
Epoch: 2, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.763 Vali Acc: 0.575 Test Loss: 0.763 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4972943
	speed: 0.3884s/iter; left time: 14006.5151s
	iters: 200, epoch: 3 | loss: 0.7375210
	speed: 0.0883s/iter; left time: 3174.1651s
	iters: 300, epoch: 3 | loss: 0.5991437
	speed: 0.0968s/iter; left time: 3471.6737s
Epoch: 3 cost time: 35.683165311813354
Epoch: 3, Steps: 369 | Train Loss: 0.645 Vali Loss: 0.683 Vali Acc: 0.653 Test Loss: 0.683 Test Acc: 0.653
Validation loss decreased (-0.596188 --> -0.652944).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6162712
	speed: 0.3747s/iter; left time: 13375.5261s
	iters: 200, epoch: 4 | loss: 0.5584765
	speed: 0.0857s/iter; left time: 3049.7213s
	iters: 300, epoch: 4 | loss: 0.8962583
	speed: 0.0874s/iter; left time: 3102.2455s
Epoch: 4 cost time: 33.198057413101196
Epoch: 4, Steps: 369 | Train Loss: 0.595 Vali Loss: 0.645 Vali Acc: 0.664 Test Loss: 0.645 Test Acc: 0.664
Validation loss decreased (-0.652944 --> -0.663728).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7930261
	speed: 0.3580s/iter; left time: 12645.1735s
	iters: 200, epoch: 5 | loss: 0.5043527
	speed: 0.0958s/iter; left time: 3374.7908s
	iters: 300, epoch: 5 | loss: 0.7349373
	speed: 0.0975s/iter; left time: 3425.6174s
Epoch: 5 cost time: 34.48325514793396
Epoch: 5, Steps: 369 | Train Loss: 0.539 Vali Loss: 0.726 Vali Acc: 0.638 Test Loss: 0.726 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4454317
	speed: 0.3561s/iter; left time: 12447.1758s
	iters: 200, epoch: 6 | loss: 0.4326968
	speed: 0.0955s/iter; left time: 3329.6704s
	iters: 300, epoch: 6 | loss: 0.3319461
	speed: 0.0945s/iter; left time: 3284.2334s
Epoch: 6 cost time: 36.28544521331787
Epoch: 6, Steps: 369 | Train Loss: 0.478 Vali Loss: 0.698 Vali Acc: 0.668 Test Loss: 0.698 Test Acc: 0.668
Validation loss decreased (-0.663728 --> -0.667700).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4509315
	speed: 0.3531s/iter; left time: 12214.2889s
	iters: 200, epoch: 7 | loss: 0.4531631
	speed: 0.0823s/iter; left time: 2837.9075s
	iters: 300, epoch: 7 | loss: 0.2615372
	speed: 0.0858s/iter; left time: 2949.6920s
Epoch: 7 cost time: 32.02546548843384
Epoch: 7, Steps: 369 | Train Loss: 0.432 Vali Loss: 0.782 Vali Acc: 0.637 Test Loss: 0.782 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4275852
	speed: 0.3908s/iter; left time: 13370.7399s
	iters: 200, epoch: 8 | loss: 0.5210439
	speed: 0.0966s/iter; left time: 3294.7545s
	iters: 300, epoch: 8 | loss: 0.2474235
	speed: 0.0827s/iter; left time: 2812.4641s
Epoch: 8 cost time: 35.28332209587097
Epoch: 8, Steps: 369 | Train Loss: 0.402 Vali Loss: 0.709 Vali Acc: 0.657 Test Loss: 0.709 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1766422
	speed: 0.3754s/iter; left time: 12708.0846s
	iters: 200, epoch: 9 | loss: 0.2150372
	speed: 0.0857s/iter; left time: 2892.1910s
	iters: 300, epoch: 9 | loss: 0.5627531
	speed: 0.0906s/iter; left time: 3049.2886s
Epoch: 9 cost time: 34.28727436065674
Epoch: 9, Steps: 369 | Train Loss: 0.358 Vali Loss: 0.771 Vali Acc: 0.663 Test Loss: 0.771 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1701466
	speed: 0.3515s/iter; left time: 11769.8252s
	iters: 200, epoch: 10 | loss: 0.2894876
	speed: 0.0876s/iter; left time: 2923.8016s
	iters: 300, epoch: 10 | loss: 0.2311730
	speed: 0.0943s/iter; left time: 3138.7250s
Epoch: 10 cost time: 33.53021430969238
Epoch: 10, Steps: 369 | Train Loss: 0.328 Vali Loss: 0.895 Vali Acc: 0.655 Test Loss: 0.895 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4252457
	speed: 0.3560s/iter; left time: 11787.9272s
	iters: 200, epoch: 11 | loss: 0.2101931
	speed: 0.0939s/iter; left time: 3099.4795s
	iters: 300, epoch: 11 | loss: 0.4657246
	speed: 0.0889s/iter; left time: 2926.6445s
Epoch: 11 cost time: 35.047046184539795
Epoch: 11, Steps: 369 | Train Loss: 0.288 Vali Loss: 0.737 Vali Acc: 0.650 Test Loss: 0.737 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.5778278
	speed: 0.3716s/iter; left time: 12166.0532s
	iters: 200, epoch: 12 | loss: 0.3455067
	speed: 0.0893s/iter; left time: 2916.4986s
	iters: 300, epoch: 12 | loss: 0.0681109
	speed: 0.0970s/iter; left time: 3156.7421s
Epoch: 12 cost time: 35.09311580657959
Epoch: 12, Steps: 369 | Train Loss: 0.267 Vali Loss: 0.944 Vali Acc: 0.659 Test Loss: 0.944 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2379236
	speed: 0.3745s/iter; left time: 12124.9838s
	iters: 200, epoch: 13 | loss: 0.2452823
	speed: 0.0805s/iter; left time: 2596.7088s
	iters: 300, epoch: 13 | loss: 0.1498787
	speed: 0.1033s/iter; left time: 3323.8186s
Epoch: 13 cost time: 34.75343680381775
Epoch: 13, Steps: 369 | Train Loss: 0.223 Vali Loss: 1.016 Vali Acc: 0.660 Test Loss: 1.016 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2596356
	speed: 0.3683s/iter; left time: 11788.6695s
	iters: 200, epoch: 14 | loss: 0.1332990
	speed: 0.0932s/iter; left time: 2973.6328s
	iters: 300, epoch: 14 | loss: 0.1592672
	speed: 0.0889s/iter; left time: 2825.9863s
Epoch: 14 cost time: 33.34985160827637
Epoch: 14, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.091 Vali Acc: 0.643 Test Loss: 1.091 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.4167989
	speed: 0.3788s/iter; left time: 11982.2804s
	iters: 200, epoch: 15 | loss: 0.1319006
	speed: 0.0943s/iter; left time: 2973.5561s
	iters: 300, epoch: 15 | loss: 0.0384426
	speed: 0.1029s/iter; left time: 3235.3392s
Epoch: 15 cost time: 36.764955043792725
Epoch: 15, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.211 Vali Acc: 0.659 Test Loss: 1.211 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0415636
	speed: 0.3600s/iter; left time: 11256.8612s
	iters: 200, epoch: 16 | loss: 0.0609818
	speed: 0.0910s/iter; left time: 2835.6190s
	iters: 300, epoch: 16 | loss: 0.2815245
	speed: 0.0857s/iter; left time: 2663.1960s
Epoch: 16 cost time: 34.09024953842163
Epoch: 16, Steps: 369 | Train Loss: 0.163 Vali Loss: 1.177 Vali Acc: 0.652 Test Loss: 1.177 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6677071509648127
model parameter : 1032434
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5141811
	speed: 0.1084s/iter; left time: 3989.3378s
	iters: 200, epoch: 1 | loss: 0.3550627
	speed: 0.0883s/iter; left time: 3239.1325s
	iters: 300, epoch: 1 | loss: 0.6294063
	speed: 0.0914s/iter; left time: 3346.1407s
Epoch: 1 cost time: 35.058231592178345
Epoch: 1, Steps: 369 | Train Loss: 0.771 Vali Loss: 0.801 Vali Acc: 0.597 Test Loss: 0.801 Test Acc: 0.597
Validation loss decreased (inf --> -0.597041).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4438962
	speed: 0.3875s/iter; left time: 14118.4910s
	iters: 200, epoch: 2 | loss: 1.1601558
	speed: 0.1003s/iter; left time: 3645.2130s
	iters: 300, epoch: 2 | loss: 0.6720511
	speed: 0.0916s/iter; left time: 3318.4267s
Epoch: 2 cost time: 37.33818769454956
Epoch: 2, Steps: 369 | Train Loss: 0.685 Vali Loss: 0.805 Vali Acc: 0.624 Test Loss: 0.805 Test Acc: 0.624
Validation loss decreased (-0.597041 --> -0.623999).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4137110
	speed: 0.3589s/iter; left time: 12943.7847s
	iters: 200, epoch: 3 | loss: 0.6273952
	speed: 0.0851s/iter; left time: 3059.0727s
	iters: 300, epoch: 3 | loss: 0.4889956
	speed: 0.0836s/iter; left time: 2996.6607s
Epoch: 3 cost time: 32.28766322135925
Epoch: 3, Steps: 369 | Train Loss: 0.631 Vali Loss: 0.715 Vali Acc: 0.637 Test Loss: 0.715 Test Acc: 0.637
Validation loss decreased (-0.623999 --> -0.636769).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5982039
	speed: 0.3734s/iter; left time: 13329.5543s
	iters: 200, epoch: 4 | loss: 0.3343372
	speed: 0.0975s/iter; left time: 3468.7409s
	iters: 300, epoch: 4 | loss: 0.6481883
	speed: 0.0831s/iter; left time: 2949.9946s
Epoch: 4 cost time: 35.22771430015564
Epoch: 4, Steps: 369 | Train Loss: 0.608 Vali Loss: 0.923 Vali Acc: 0.575 Test Loss: 0.923 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3721318
	speed: 0.3609s/iter; left time: 12747.5035s
	iters: 200, epoch: 5 | loss: 0.4798700
	speed: 0.0900s/iter; left time: 3169.4139s
	iters: 300, epoch: 5 | loss: 0.7972187
	speed: 0.0918s/iter; left time: 3224.8442s
Epoch: 5 cost time: 34.45374822616577
Epoch: 5, Steps: 369 | Train Loss: 0.538 Vali Loss: 0.627 Vali Acc: 0.688 Test Loss: 0.627 Test Acc: 0.688
Validation loss decreased (-0.636769 --> -0.687565).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3785941
	speed: 0.3690s/iter; left time: 12898.8400s
	iters: 200, epoch: 6 | loss: 0.2766732
	speed: 0.0909s/iter; left time: 3167.1168s
	iters: 300, epoch: 6 | loss: 0.4737172
	speed: 0.0855s/iter; left time: 2971.9146s
Epoch: 6 cost time: 34.62443470954895
Epoch: 6, Steps: 369 | Train Loss: 0.477 Vali Loss: 0.634 Vali Acc: 0.679 Test Loss: 0.634 Test Acc: 0.679
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4624348
	speed: 0.3588s/iter; left time: 12410.1790s
	iters: 200, epoch: 7 | loss: 0.4867427
	speed: 0.0835s/iter; left time: 2879.1613s
	iters: 300, epoch: 7 | loss: 0.3131755
	speed: 0.0947s/iter; left time: 3257.8117s
Epoch: 7 cost time: 34.73814558982849
Epoch: 7, Steps: 369 | Train Loss: 0.438 Vali Loss: 0.770 Vali Acc: 0.637 Test Loss: 0.770 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2643380
	speed: 0.3807s/iter; left time: 13025.2458s
	iters: 200, epoch: 8 | loss: 0.4420253
	speed: 0.0878s/iter; left time: 2995.4355s
	iters: 300, epoch: 8 | loss: 0.4073697
	speed: 0.0819s/iter; left time: 2787.4657s
Epoch: 8 cost time: 32.69528770446777
Epoch: 8, Steps: 369 | Train Loss: 0.396 Vali Loss: 0.672 Vali Acc: 0.680 Test Loss: 0.672 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4842888
	speed: 0.3555s/iter; left time: 12032.9200s
	iters: 200, epoch: 9 | loss: 0.2280279
	speed: 0.0846s/iter; left time: 2853.7212s
	iters: 300, epoch: 9 | loss: 0.2565327
	speed: 0.0937s/iter; left time: 3152.8853s
Epoch: 9 cost time: 33.67695331573486
Epoch: 9, Steps: 369 | Train Loss: 0.347 Vali Loss: 0.729 Vali Acc: 0.661 Test Loss: 0.729 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3778066
	speed: 0.3878s/iter; left time: 12985.0953s
	iters: 200, epoch: 10 | loss: 0.2312237
	speed: 0.1063s/iter; left time: 3547.1079s
	iters: 300, epoch: 10 | loss: 0.1814050
	speed: 0.0734s/iter; left time: 2441.0928s
Epoch: 10 cost time: 34.828420639038086
Epoch: 10, Steps: 369 | Train Loss: 0.303 Vali Loss: 0.877 Vali Acc: 0.665 Test Loss: 0.877 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1439323
	speed: 0.3312s/iter; left time: 10966.9148s
	iters: 200, epoch: 11 | loss: 0.1942396
	speed: 0.0801s/iter; left time: 2642.7981s
	iters: 300, epoch: 11 | loss: 0.3325709
	speed: 0.0897s/iter; left time: 2952.3555s
Epoch: 11 cost time: 33.504688024520874
Epoch: 11, Steps: 369 | Train Loss: 0.275 Vali Loss: 0.809 Vali Acc: 0.662 Test Loss: 0.809 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3936684
	speed: 0.3554s/iter; left time: 11634.9295s
	iters: 200, epoch: 12 | loss: 0.0526648
	speed: 0.0862s/iter; left time: 2813.0013s
	iters: 300, epoch: 12 | loss: 0.1080373
	speed: 0.0838s/iter; left time: 2726.5703s
Epoch: 12 cost time: 33.0063636302948
Epoch: 12, Steps: 369 | Train Loss: 0.234 Vali Loss: 1.073 Vali Acc: 0.651 Test Loss: 1.073 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0435381
	speed: 0.3498s/iter; left time: 11323.5275s
	iters: 200, epoch: 13 | loss: 0.1356297
	speed: 0.0866s/iter; left time: 2795.9833s
	iters: 300, epoch: 13 | loss: 0.1842493
	speed: 0.0979s/iter; left time: 3148.2868s
Epoch: 13 cost time: 35.085997581481934
Epoch: 13, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.081 Vali Acc: 0.645 Test Loss: 1.081 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0285908
	speed: 0.3579s/iter; left time: 11455.3679s
	iters: 200, epoch: 14 | loss: 0.1442108
	speed: 0.0928s/iter; left time: 2961.7906s
	iters: 300, epoch: 14 | loss: 0.1696129
	speed: 0.0939s/iter; left time: 2985.3110s
Epoch: 14 cost time: 33.88910388946533
Epoch: 14, Steps: 369 | Train Loss: 0.197 Vali Loss: 1.154 Vali Acc: 0.656 Test Loss: 1.154 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1082987
	speed: 0.3578s/iter; left time: 11319.8498s
	iters: 200, epoch: 15 | loss: 0.4347041
	speed: 0.0885s/iter; left time: 2792.1507s
	iters: 300, epoch: 15 | loss: 0.1080411
	speed: 0.0985s/iter; left time: 3095.0444s
Epoch: 15 cost time: 36.1093864440918
Epoch: 15, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.144 Vali Acc: 0.662 Test Loss: 1.144 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6875709421112373
model parameter : 1031730
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6398060
	speed: 0.1252s/iter; left time: 4606.3566s
	iters: 200, epoch: 1 | loss: 1.4105706
	speed: 0.0914s/iter; left time: 3355.1460s
	iters: 300, epoch: 1 | loss: 1.7711071
	speed: 0.0965s/iter; left time: 3532.6360s
Epoch: 1 cost time: 37.66804599761963
Epoch: 1, Steps: 369 | Train Loss: 0.835 Vali Loss: 0.778 Vali Acc: 0.643 Test Loss: 0.778 Test Acc: 0.643
Validation loss decreased (inf --> -0.642728).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6214412
	speed: 0.3497s/iter; left time: 12741.1528s
	iters: 200, epoch: 2 | loss: 0.5851903
	speed: 0.0857s/iter; left time: 3112.0093s
	iters: 300, epoch: 2 | loss: 0.3301902
	speed: 0.0893s/iter; left time: 3236.9360s
Epoch: 2 cost time: 33.174424171447754
Epoch: 2, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.955 Vali Acc: 0.515 Test Loss: 0.955 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4595095
	speed: 0.3704s/iter; left time: 13357.8058s
	iters: 200, epoch: 3 | loss: 0.6264380
	speed: 0.1004s/iter; left time: 3609.7920s
	iters: 300, epoch: 3 | loss: 0.7358204
	speed: 0.0866s/iter; left time: 3105.1567s
Epoch: 3 cost time: 35.53230690956116
Epoch: 3, Steps: 369 | Train Loss: 0.630 Vali Loss: 0.984 Vali Acc: 0.529 Test Loss: 0.984 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5691972
	speed: 0.3653s/iter; left time: 13038.4782s
	iters: 200, epoch: 4 | loss: 0.5185779
	speed: 0.0883s/iter; left time: 3144.2287s
	iters: 300, epoch: 4 | loss: 0.6242448
	speed: 0.0854s/iter; left time: 3031.2490s
Epoch: 4 cost time: 33.454450607299805
Epoch: 4, Steps: 369 | Train Loss: 0.590 Vali Loss: 0.814 Vali Acc: 0.616 Test Loss: 0.814 Test Acc: 0.616
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.4608374
	speed: 0.3705s/iter; left time: 13089.4115s
	iters: 200, epoch: 5 | loss: 0.4323782
	speed: 0.0852s/iter; left time: 2999.4897s
	iters: 300, epoch: 5 | loss: 0.3790801
	speed: 0.0864s/iter; left time: 3033.7875s
Epoch: 5 cost time: 33.45142197608948
Epoch: 5, Steps: 369 | Train Loss: 0.534 Vali Loss: 0.729 Vali Acc: 0.609 Test Loss: 0.729 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.2834746
	speed: 0.3693s/iter; left time: 12909.9335s
	iters: 200, epoch: 6 | loss: 0.4309192
	speed: 0.0878s/iter; left time: 3061.4778s
	iters: 300, epoch: 6 | loss: 0.5822830
	speed: 0.0855s/iter; left time: 2971.2136s
Epoch: 6 cost time: 33.47158861160278
Epoch: 6, Steps: 369 | Train Loss: 0.477 Vali Loss: 0.760 Vali Acc: 0.636 Test Loss: 0.760 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.2475599
	speed: 0.3561s/iter; left time: 12317.9891s
	iters: 200, epoch: 7 | loss: 0.1470531
	speed: 0.0882s/iter; left time: 3041.4470s
	iters: 300, epoch: 7 | loss: 0.4256290
	speed: 0.0953s/iter; left time: 3275.8229s
Epoch: 7 cost time: 34.594908714294434
Epoch: 7, Steps: 369 | Train Loss: 0.435 Vali Loss: 0.657 Vali Acc: 0.661 Test Loss: 0.657 Test Acc: 0.661
Validation loss decreased (-0.642728 --> -0.661174).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2135932
	speed: 0.3680s/iter; left time: 12593.3716s
	iters: 200, epoch: 8 | loss: 0.6900000
	speed: 0.0971s/iter; left time: 3314.2505s
	iters: 300, epoch: 8 | loss: 0.5842303
	speed: 0.0987s/iter; left time: 3359.2024s
Epoch: 8 cost time: 35.52793478965759
Epoch: 8, Steps: 369 | Train Loss: 0.396 Vali Loss: 0.822 Vali Acc: 0.671 Test Loss: 0.822 Test Acc: 0.671
Validation loss decreased (-0.661174 --> -0.671104).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2816069
	speed: 0.3602s/iter; left time: 12191.5252s
	iters: 200, epoch: 9 | loss: 0.3166346
	speed: 0.0826s/iter; left time: 2788.9554s
	iters: 300, epoch: 9 | loss: 0.4567897
	speed: 0.0857s/iter; left time: 2883.9296s
Epoch: 9 cost time: 32.86237049102783
Epoch: 9, Steps: 369 | Train Loss: 0.358 Vali Loss: 0.753 Vali Acc: 0.665 Test Loss: 0.753 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3346585
	speed: 0.3542s/iter; left time: 11858.0503s
	iters: 200, epoch: 10 | loss: 0.2108879
	speed: 0.0991s/iter; left time: 3307.9848s
	iters: 300, epoch: 10 | loss: 0.4048402
	speed: 0.0964s/iter; left time: 3207.5213s
Epoch: 10 cost time: 35.053394079208374
Epoch: 10, Steps: 369 | Train Loss: 0.324 Vali Loss: 0.837 Vali Acc: 0.652 Test Loss: 0.837 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2837228
	speed: 0.3723s/iter; left time: 12327.9226s
	iters: 200, epoch: 11 | loss: 0.1727647
	speed: 0.0843s/iter; left time: 2781.7030s
	iters: 300, epoch: 11 | loss: 0.4405035
	speed: 0.0788s/iter; left time: 2593.6780s
Epoch: 11 cost time: 31.5526762008667
Epoch: 11, Steps: 369 | Train Loss: 0.304 Vali Loss: 0.828 Vali Acc: 0.665 Test Loss: 0.828 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2052366
	speed: 0.3409s/iter; left time: 11161.2148s
	iters: 200, epoch: 12 | loss: 0.2360094
	speed: 0.0895s/iter; left time: 2920.7288s
	iters: 300, epoch: 12 | loss: 0.1746393
	speed: 0.0957s/iter; left time: 3113.1336s
Epoch: 12 cost time: 34.877065658569336
Epoch: 12, Steps: 369 | Train Loss: 0.248 Vali Loss: 0.965 Vali Acc: 0.650 Test Loss: 0.965 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0139852
	speed: 0.3428s/iter; left time: 11096.0894s
	iters: 200, epoch: 13 | loss: 0.2109454
	speed: 0.0839s/iter; left time: 2707.8612s
	iters: 300, epoch: 13 | loss: 0.6705117
	speed: 0.0892s/iter; left time: 2869.3224s
Epoch: 13 cost time: 32.04758334159851
Epoch: 13, Steps: 369 | Train Loss: 0.228 Vali Loss: 1.085 Vali Acc: 0.658 Test Loss: 1.085 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0869261
	speed: 0.3501s/iter; left time: 11203.3718s
	iters: 200, epoch: 14 | loss: 0.4446558
	speed: 0.0906s/iter; left time: 2891.6932s
	iters: 300, epoch: 14 | loss: 0.1254835
	speed: 0.0903s/iter; left time: 2873.4289s
Epoch: 14 cost time: 34.26783204078674
Epoch: 14, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.098 Vali Acc: 0.661 Test Loss: 1.098 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1885123
	speed: 0.3572s/iter; left time: 11301.3265s
	iters: 200, epoch: 15 | loss: 0.0733422
	speed: 0.0906s/iter; left time: 2856.7276s
	iters: 300, epoch: 15 | loss: 0.1253700
	speed: 0.0837s/iter; left time: 2631.0812s
Epoch: 15 cost time: 32.79319977760315
Epoch: 15, Steps: 369 | Train Loss: 0.172 Vali Loss: 1.321 Vali Acc: 0.653 Test Loss: 1.321 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0862792
	speed: 0.3691s/iter; left time: 11540.1146s
	iters: 200, epoch: 16 | loss: 0.2037485
	speed: 0.0812s/iter; left time: 2530.9587s
	iters: 300, epoch: 16 | loss: 0.3326335
	speed: 0.0796s/iter; left time: 2474.2291s
Epoch: 16 cost time: 33.30576276779175
Epoch: 16, Steps: 369 | Train Loss: 0.175 Vali Loss: 1.051 Vali Acc: 0.651 Test Loss: 1.051 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.2093554
	speed: 0.3613s/iter; left time: 11164.0584s
	iters: 200, epoch: 17 | loss: 0.1641959
	speed: 0.0902s/iter; left time: 2778.3693s
	iters: 300, epoch: 17 | loss: 0.0638800
	speed: 0.0820s/iter; left time: 2517.0297s
Epoch: 17 cost time: 32.031609535217285
Epoch: 17, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.270 Vali Acc: 0.658 Test Loss: 1.270 Test Acc: 0.658
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0157895
	speed: 0.3323s/iter; left time: 10145.4014s
	iters: 200, epoch: 18 | loss: 0.0272146
	speed: 0.0863s/iter; left time: 2626.5724s
	iters: 300, epoch: 18 | loss: 0.0822231
	speed: 0.0895s/iter; left time: 2714.1562s
Epoch: 18 cost time: 33.82216715812683
Epoch: 18, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.545 Vali Acc: 0.662 Test Loss: 1.545 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6711123723041997
model parameter : 1031026
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8647932
	speed: 0.1120s/iter; left time: 4119.9963s
	iters: 200, epoch: 1 | loss: 0.6532865
	speed: 0.0889s/iter; left time: 3261.0530s
	iters: 300, epoch: 1 | loss: 0.4233576
	speed: 0.0950s/iter; left time: 3475.5631s
Epoch: 1 cost time: 36.306846380233765
Epoch: 1, Steps: 369 | Train Loss: 0.838 Vali Loss: 1.137 Vali Acc: 0.587 Test Loss: 1.137 Test Acc: 0.587
Validation loss decreased (inf --> -0.587389).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4047008
	speed: 0.3431s/iter; left time: 12500.4533s
	iters: 200, epoch: 2 | loss: 1.7826264
	speed: 0.0822s/iter; left time: 2986.3317s
	iters: 300, epoch: 2 | loss: 0.5900849
	speed: 0.0830s/iter; left time: 3005.6829s
Epoch: 2 cost time: 31.53324842453003
Epoch: 2, Steps: 369 | Train Loss: 0.764 Vali Loss: 0.627 Vali Acc: 0.668 Test Loss: 0.627 Test Acc: 0.668
Validation loss decreased (-0.587389 --> -0.668268).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3907258
	speed: 0.3364s/iter; left time: 12131.7442s
	iters: 200, epoch: 3 | loss: 0.4684105
	speed: 0.0816s/iter; left time: 2933.5253s
	iters: 300, epoch: 3 | loss: 0.6965714
	speed: 0.0859s/iter; left time: 3079.1950s
Epoch: 3 cost time: 33.16177845001221
Epoch: 3, Steps: 369 | Train Loss: 0.635 Vali Loss: 0.662 Vali Acc: 0.656 Test Loss: 0.662 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5456390
	speed: 0.3655s/iter; left time: 13047.5237s
	iters: 200, epoch: 4 | loss: 0.6611576
	speed: 0.0855s/iter; left time: 3044.7823s
	iters: 300, epoch: 4 | loss: 0.6765383
	speed: 0.0820s/iter; left time: 2911.5068s
Epoch: 4 cost time: 32.00178360939026
Epoch: 4, Steps: 369 | Train Loss: 0.565 Vali Loss: 0.655 Vali Acc: 0.652 Test Loss: 0.655 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4174832
	speed: 0.3296s/iter; left time: 11641.6055s
	iters: 200, epoch: 5 | loss: 0.5933483
	speed: 0.0891s/iter; left time: 3137.2856s
	iters: 300, epoch: 5 | loss: 0.5829630
	speed: 0.0973s/iter; left time: 3416.9137s
Epoch: 5 cost time: 34.62221670150757
Epoch: 5, Steps: 369 | Train Loss: 0.506 Vali Loss: 0.724 Vali Acc: 0.654 Test Loss: 0.724 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5130483
	speed: 0.3373s/iter; left time: 11792.1034s
	iters: 200, epoch: 6 | loss: 0.4934650
	speed: 0.0797s/iter; left time: 2776.9356s
	iters: 300, epoch: 6 | loss: 0.4719062
	speed: 0.0803s/iter; left time: 2791.0912s
Epoch: 6 cost time: 30.619816541671753
Epoch: 6, Steps: 369 | Train Loss: 0.456 Vali Loss: 0.686 Vali Acc: 0.674 Test Loss: 0.686 Test Acc: 0.674
Validation loss decreased (-0.668268 --> -0.673943).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5787119
	speed: 0.3416s/iter; left time: 11815.4411s
	iters: 200, epoch: 7 | loss: 0.8448435
	speed: 0.0903s/iter; left time: 3112.5043s
	iters: 300, epoch: 7 | loss: 0.4896949
	speed: 0.0827s/iter; left time: 2843.7632s
Epoch: 7 cost time: 33.202656745910645
Epoch: 7, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.724 Vali Acc: 0.670 Test Loss: 0.724 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0920768
	speed: 0.3587s/iter; left time: 12275.2525s
	iters: 200, epoch: 8 | loss: 0.5907905
	speed: 0.0779s/iter; left time: 2658.5677s
	iters: 300, epoch: 8 | loss: 0.2342299
	speed: 0.0823s/iter; left time: 2800.9270s
Epoch: 8 cost time: 31.26680636405945
Epoch: 8, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.728 Vali Acc: 0.680 Test Loss: 0.728 Test Acc: 0.680
Validation loss decreased (-0.673943 --> -0.679902).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3678024
	speed: 0.3460s/iter; left time: 11712.3927s
	iters: 200, epoch: 9 | loss: 0.6607091
	speed: 0.0888s/iter; left time: 2997.9065s
	iters: 300, epoch: 9 | loss: 0.3548241
	speed: 0.0846s/iter; left time: 2845.1295s
Epoch: 9 cost time: 33.02265000343323
Epoch: 9, Steps: 369 | Train Loss: 0.338 Vali Loss: 0.829 Vali Acc: 0.668 Test Loss: 0.829 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3791978
	speed: 0.3385s/iter; left time: 11331.7936s
	iters: 200, epoch: 10 | loss: 0.1671460
	speed: 0.0867s/iter; left time: 2895.7112s
	iters: 300, epoch: 10 | loss: 0.3824556
	speed: 0.0878s/iter; left time: 2923.6288s
Epoch: 10 cost time: 32.79106569290161
Epoch: 10, Steps: 369 | Train Loss: 0.294 Vali Loss: 1.046 Vali Acc: 0.624 Test Loss: 1.046 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2253846
	speed: 0.3438s/iter; left time: 11383.0354s
	iters: 200, epoch: 11 | loss: 0.0998446
	speed: 0.0889s/iter; left time: 2934.8593s
	iters: 300, epoch: 11 | loss: 0.2429183
	speed: 0.0811s/iter; left time: 2669.6114s
Epoch: 11 cost time: 34.00301814079285
Epoch: 11, Steps: 369 | Train Loss: 0.265 Vali Loss: 0.837 Vali Acc: 0.656 Test Loss: 0.837 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2445114
	speed: 0.3380s/iter; left time: 11067.0334s
	iters: 200, epoch: 12 | loss: 0.1735820
	speed: 0.0872s/iter; left time: 2845.0118s
	iters: 300, epoch: 12 | loss: 0.1537111
	speed: 0.0910s/iter; left time: 2960.2060s
Epoch: 12 cost time: 32.73443579673767
Epoch: 12, Steps: 369 | Train Loss: 0.233 Vali Loss: 1.117 Vali Acc: 0.641 Test Loss: 1.117 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0495827
	speed: 0.3416s/iter; left time: 11059.6651s
	iters: 200, epoch: 13 | loss: 0.4345824
	speed: 0.0839s/iter; left time: 2709.1668s
	iters: 300, epoch: 13 | loss: 0.1306636
	speed: 0.0829s/iter; left time: 2668.0034s
Epoch: 13 cost time: 32.188883543014526
Epoch: 13, Steps: 369 | Train Loss: 0.197 Vali Loss: 1.383 Vali Acc: 0.642 Test Loss: 1.383 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0220603
	speed: 0.3502s/iter; left time: 11207.7643s
	iters: 200, epoch: 14 | loss: 0.1014758
	speed: 0.0813s/iter; left time: 2592.7741s
	iters: 300, epoch: 14 | loss: 0.1829583
	speed: 0.0969s/iter; left time: 3080.6230s
Epoch: 14 cost time: 34.574283838272095
Epoch: 14, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.268 Vali Acc: 0.640 Test Loss: 1.268 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0518350
	speed: 0.3549s/iter; left time: 11226.6344s
	iters: 200, epoch: 15 | loss: 0.0069647
	speed: 0.0830s/iter; left time: 2616.2014s
	iters: 300, epoch: 15 | loss: 0.1129744
	speed: 0.0774s/iter; left time: 2434.2638s
Epoch: 15 cost time: 31.156830310821533
Epoch: 15, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.408 Vali Acc: 0.656 Test Loss: 1.408 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.2919583
	speed: 0.3307s/iter; left time: 10341.1067s
	iters: 200, epoch: 16 | loss: 0.2576127
	speed: 0.0777s/iter; left time: 2420.3651s
	iters: 300, epoch: 16 | loss: 0.0674009
	speed: 0.0933s/iter; left time: 2897.3808s
Epoch: 16 cost time: 33.04574203491211
Epoch: 16, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.437 Vali Acc: 0.646 Test Loss: 1.437 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0067794
	speed: 0.3371s/iter; left time: 10415.5922s
	iters: 200, epoch: 17 | loss: 0.1115623
	speed: 0.0898s/iter; left time: 2767.0571s
	iters: 300, epoch: 17 | loss: 0.0930641
	speed: 0.0795s/iter; left time: 2441.4266s
Epoch: 17 cost time: 31.92128586769104
Epoch: 17, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.522 Vali Acc: 0.642 Test Loss: 1.522 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.2973007
	speed: 0.3331s/iter; left time: 10169.6912s
	iters: 200, epoch: 18 | loss: 0.1524811
	speed: 0.0904s/iter; left time: 2751.3092s
	iters: 300, epoch: 18 | loss: 0.0765010
	speed: 0.0918s/iter; left time: 2782.7232s
Epoch: 18 cost time: 34.46811842918396
Epoch: 18, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.731 Vali Acc: 0.644 Test Loss: 1.731 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6799091940976163
model parameter : 801970
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8003141
	speed: 0.1094s/iter; left time: 4026.8388s
	iters: 200, epoch: 1 | loss: 0.6386506
	speed: 0.0947s/iter; left time: 3476.7863s
	iters: 300, epoch: 1 | loss: 0.8164273
	speed: 0.0917s/iter; left time: 3356.8692s
Epoch: 1 cost time: 35.56033420562744
Epoch: 1, Steps: 369 | Train Loss: 0.801 Vali Loss: 0.678 Vali Acc: 0.655 Test Loss: 0.678 Test Acc: 0.655
Validation loss decreased (inf --> -0.654931).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6719910
	speed: 0.3301s/iter; left time: 12024.9958s
	iters: 200, epoch: 2 | loss: 0.5460795
	speed: 0.0807s/iter; left time: 2932.2684s
	iters: 300, epoch: 2 | loss: 0.6686770
	speed: 0.0788s/iter; left time: 2855.6488s
Epoch: 2 cost time: 30.83412504196167
Epoch: 2, Steps: 369 | Train Loss: 0.763 Vali Loss: 1.234 Vali Acc: 0.508 Test Loss: 1.234 Test Acc: 0.508
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3624585
	speed: 0.3463s/iter; left time: 12488.8044s
	iters: 200, epoch: 3 | loss: 0.4201118
	speed: 0.0988s/iter; left time: 3554.4557s
	iters: 300, epoch: 3 | loss: 0.4884695
	speed: 0.0933s/iter; left time: 3344.6864s
Epoch: 3 cost time: 36.010979652404785
Epoch: 3, Steps: 369 | Train Loss: 0.645 Vali Loss: 0.727 Vali Acc: 0.657 Test Loss: 0.727 Test Acc: 0.657
Validation loss decreased (-0.654931 --> -0.657484).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9875191
	speed: 0.3517s/iter; left time: 12553.4245s
	iters: 200, epoch: 4 | loss: 0.7889225
	speed: 0.0812s/iter; left time: 2888.9596s
	iters: 300, epoch: 4 | loss: 0.5833774
	speed: 0.0864s/iter; left time: 3065.3811s
Epoch: 4 cost time: 32.592106342315674
Epoch: 4, Steps: 369 | Train Loss: 0.574 Vali Loss: 0.610 Vali Acc: 0.667 Test Loss: 0.610 Test Acc: 0.667
Validation loss decreased (-0.657484 --> -0.667417).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3516813
	speed: 0.3621s/iter; left time: 12791.5775s
	iters: 200, epoch: 5 | loss: 0.4738148
	speed: 0.1004s/iter; left time: 3535.1553s
	iters: 300, epoch: 5 | loss: 0.5238885
	speed: 0.0870s/iter; left time: 3054.4936s
Epoch: 5 cost time: 35.029338121414185
Epoch: 5, Steps: 369 | Train Loss: 0.509 Vali Loss: 0.709 Vali Acc: 0.666 Test Loss: 0.709 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1845567
	speed: 0.3690s/iter; left time: 12898.7104s
	iters: 200, epoch: 6 | loss: 0.3713084
	speed: 0.0846s/iter; left time: 2950.1776s
	iters: 300, epoch: 6 | loss: 0.5142975
	speed: 0.0867s/iter; left time: 3013.3961s
Epoch: 6 cost time: 32.69027924537659
Epoch: 6, Steps: 369 | Train Loss: 0.455 Vali Loss: 0.846 Vali Acc: 0.617 Test Loss: 0.846 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.5239459
	speed: 0.3473s/iter; left time: 12012.4265s
	iters: 200, epoch: 7 | loss: 0.3009835
	speed: 0.0971s/iter; left time: 3349.9267s
	iters: 300, epoch: 7 | loss: 0.5397580
	speed: 0.0852s/iter; left time: 2928.7366s
Epoch: 7 cost time: 33.97282791137695
Epoch: 7, Steps: 369 | Train Loss: 0.415 Vali Loss: 0.684 Vali Acc: 0.660 Test Loss: 0.684 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5598207
	speed: 0.3666s/iter; left time: 12544.6293s
	iters: 200, epoch: 8 | loss: 0.2364252
	speed: 0.0848s/iter; left time: 2892.6877s
	iters: 300, epoch: 8 | loss: 0.1256292
	speed: 0.0833s/iter; left time: 2835.1984s
Epoch: 8 cost time: 33.71907067298889
Epoch: 8, Steps: 369 | Train Loss: 0.377 Vali Loss: 0.750 Vali Acc: 0.677 Test Loss: 0.750 Test Acc: 0.677
Validation loss decreased (-0.667417 --> -0.676496).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3624774
	speed: 0.3598s/iter; left time: 12178.0188s
	iters: 200, epoch: 9 | loss: 0.4739063
	speed: 0.0911s/iter; left time: 3076.1403s
	iters: 300, epoch: 9 | loss: 0.2827599
	speed: 0.0911s/iter; left time: 3064.1719s
Epoch: 9 cost time: 33.57184171676636
Epoch: 9, Steps: 369 | Train Loss: 0.327 Vali Loss: 0.839 Vali Acc: 0.657 Test Loss: 0.839 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1645573
	speed: 0.3554s/iter; left time: 11898.7795s
	iters: 200, epoch: 10 | loss: 0.4377567
	speed: 0.0951s/iter; left time: 3175.7812s
	iters: 300, epoch: 10 | loss: 0.4454596
	speed: 0.0920s/iter; left time: 3063.1992s
Epoch: 10 cost time: 34.88707232475281
Epoch: 10, Steps: 369 | Train Loss: 0.284 Vali Loss: 0.938 Vali Acc: 0.638 Test Loss: 0.938 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2962441
	speed: 0.3540s/iter; left time: 11720.2652s
	iters: 200, epoch: 11 | loss: 0.3671527
	speed: 0.0874s/iter; left time: 2883.6798s
	iters: 300, epoch: 11 | loss: 0.1089356
	speed: 0.0867s/iter; left time: 2852.7233s
Epoch: 11 cost time: 33.01309084892273
Epoch: 11, Steps: 369 | Train Loss: 0.260 Vali Loss: 0.881 Vali Acc: 0.659 Test Loss: 0.881 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1419622
	speed: 0.3763s/iter; left time: 12321.8893s
	iters: 200, epoch: 12 | loss: 0.1549547
	speed: 0.0791s/iter; left time: 2580.5113s
	iters: 300, epoch: 12 | loss: 0.2366052
	speed: 0.0887s/iter; left time: 2887.3018s
Epoch: 12 cost time: 33.40438103675842
Epoch: 12, Steps: 369 | Train Loss: 0.217 Vali Loss: 1.116 Vali Acc: 0.661 Test Loss: 1.116 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.3734076
	speed: 0.3617s/iter; left time: 11707.7342s
	iters: 200, epoch: 13 | loss: 0.0388228
	speed: 0.0891s/iter; left time: 2876.4701s
	iters: 300, epoch: 13 | loss: 0.4182847
	speed: 0.0918s/iter; left time: 2953.7493s
Epoch: 13 cost time: 33.84614539146423
Epoch: 13, Steps: 369 | Train Loss: 0.192 Vali Loss: 1.171 Vali Acc: 0.648 Test Loss: 1.171 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.2171160
	speed: 0.3570s/iter; left time: 11424.1614s
	iters: 200, epoch: 14 | loss: 0.2507796
	speed: 0.0908s/iter; left time: 2895.5814s
	iters: 300, epoch: 14 | loss: 0.0928098
	speed: 0.0894s/iter; left time: 2841.8083s
Epoch: 14 cost time: 34.60590076446533
Epoch: 14, Steps: 369 | Train Loss: 0.168 Vali Loss: 1.359 Vali Acc: 0.657 Test Loss: 1.359 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1298338
	speed: 0.3318s/iter; left time: 10497.9793s
	iters: 200, epoch: 15 | loss: 0.0325118
	speed: 0.0848s/iter; left time: 2672.6009s
	iters: 300, epoch: 15 | loss: 0.0745923
	speed: 0.0882s/iter; left time: 2773.9005s
Epoch: 15 cost time: 32.2738721370697
Epoch: 15, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.419 Vali Acc: 0.663 Test Loss: 1.419 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.2572203
	speed: 0.3576s/iter; left time: 11182.0817s
	iters: 200, epoch: 16 | loss: 0.1139911
	speed: 0.0869s/iter; left time: 2709.7221s
	iters: 300, epoch: 16 | loss: 0.1159847
	speed: 0.0825s/iter; left time: 2563.8082s
Epoch: 16 cost time: 34.49100661277771
Epoch: 16, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.370 Vali Acc: 0.653 Test Loss: 1.370 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0808124
	speed: 0.3326s/iter; left time: 10277.0682s
	iters: 200, epoch: 17 | loss: 0.0624893
	speed: 0.0802s/iter; left time: 2469.7098s
	iters: 300, epoch: 17 | loss: 0.0501581
	speed: 0.0793s/iter; left time: 2435.3457s
Epoch: 17 cost time: 31.193230390548706
Epoch: 17, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.490 Vali Acc: 0.657 Test Loss: 1.490 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0150481
	speed: 0.3612s/iter; left time: 11025.4700s
	iters: 200, epoch: 18 | loss: 0.0044925
	speed: 0.0867s/iter; left time: 2636.6321s
	iters: 300, epoch: 18 | loss: 0.5569873
	speed: 0.0827s/iter; left time: 2508.2085s
Epoch: 18 cost time: 33.30761981010437
Epoch: 18, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.922 Vali Acc: 0.647 Test Loss: 1.922 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6765039727582293
model parameter : 801266
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9144772
	speed: 0.1149s/iter; left time: 4229.1305s
	iters: 200, epoch: 1 | loss: 1.0487593
	speed: 0.0960s/iter; left time: 3523.7602s
	iters: 300, epoch: 1 | loss: 0.9833652
	speed: 0.0907s/iter; left time: 3321.1873s
Epoch: 1 cost time: 36.41033220291138
Epoch: 1, Steps: 369 | Train Loss: 0.803 Vali Loss: 0.879 Vali Acc: 0.641 Test Loss: 0.879 Test Acc: 0.641
Validation loss decreased (inf --> -0.641308).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4990768
	speed: 0.3489s/iter; left time: 12709.5673s
	iters: 200, epoch: 2 | loss: 1.2442701
	speed: 0.0880s/iter; left time: 3195.4971s
	iters: 300, epoch: 2 | loss: 0.3998423
	speed: 0.0816s/iter; left time: 2955.7114s
Epoch: 2 cost time: 32.363850593566895
Epoch: 2, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.619 Vali Acc: 0.660 Test Loss: 0.619 Test Acc: 0.660
Validation loss decreased (-0.641308 --> -0.660039).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3773977
	speed: 0.3280s/iter; left time: 11827.1095s
	iters: 200, epoch: 3 | loss: 0.1808791
	speed: 0.0789s/iter; left time: 2838.1022s
	iters: 300, epoch: 3 | loss: 0.7169729
	speed: 0.0887s/iter; left time: 3180.1094s
Epoch: 3 cost time: 33.07345390319824
Epoch: 3, Steps: 369 | Train Loss: 0.628 Vali Loss: 0.702 Vali Acc: 0.646 Test Loss: 0.702 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4441861
	speed: 0.3583s/iter; left time: 12790.2917s
	iters: 200, epoch: 4 | loss: 0.3988662
	speed: 0.0875s/iter; left time: 3116.2043s
	iters: 300, epoch: 4 | loss: 0.2499185
	speed: 0.0833s/iter; left time: 2957.3124s
Epoch: 4 cost time: 31.721500635147095
Epoch: 4, Steps: 369 | Train Loss: 0.597 Vali Loss: 0.610 Vali Acc: 0.688 Test Loss: 0.610 Test Acc: 0.688
Validation loss decreased (-0.660039 --> -0.687565).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3968638
	speed: 0.3484s/iter; left time: 12306.3358s
	iters: 200, epoch: 5 | loss: 0.6327477
	speed: 0.0845s/iter; left time: 2977.7586s
	iters: 300, epoch: 5 | loss: 0.3761634
	speed: 0.0847s/iter; left time: 2974.5062s
Epoch: 5 cost time: 33.57796669006348
Epoch: 5, Steps: 369 | Train Loss: 0.532 Vali Loss: 0.630 Vali Acc: 0.666 Test Loss: 0.630 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3090887
	speed: 0.3431s/iter; left time: 11993.0398s
	iters: 200, epoch: 6 | loss: 0.4212613
	speed: 0.0865s/iter; left time: 3015.3781s
	iters: 300, epoch: 6 | loss: 0.8922635
	speed: 0.0879s/iter; left time: 3056.6777s
Epoch: 6 cost time: 32.667861223220825
Epoch: 6, Steps: 369 | Train Loss: 0.470 Vali Loss: 0.745 Vali Acc: 0.667 Test Loss: 0.745 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4275765
	speed: 0.3299s/iter; left time: 11411.0298s
	iters: 200, epoch: 7 | loss: 0.4113892
	speed: 0.0820s/iter; left time: 2829.4567s
	iters: 300, epoch: 7 | loss: 0.2490117
	speed: 0.0842s/iter; left time: 2893.7200s
Epoch: 7 cost time: 32.47018122673035
Epoch: 7, Steps: 369 | Train Loss: 0.423 Vali Loss: 0.714 Vali Acc: 0.661 Test Loss: 0.714 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2272346
	speed: 0.3396s/iter; left time: 11621.3981s
	iters: 200, epoch: 8 | loss: 0.4840283
	speed: 0.0882s/iter; left time: 3009.2483s
	iters: 300, epoch: 8 | loss: 0.3717707
	speed: 0.0888s/iter; left time: 3021.3576s
Epoch: 8 cost time: 32.46789526939392
Epoch: 8, Steps: 369 | Train Loss: 0.372 Vali Loss: 0.742 Vali Acc: 0.677 Test Loss: 0.742 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1897657
	speed: 0.3376s/iter; left time: 11427.7937s
	iters: 200, epoch: 9 | loss: 0.4846728
	speed: 0.0829s/iter; left time: 2797.8536s
	iters: 300, epoch: 9 | loss: 0.2653536
	speed: 0.0892s/iter; left time: 3002.4287s
Epoch: 9 cost time: 32.661521673202515
Epoch: 9, Steps: 369 | Train Loss: 0.337 Vali Loss: 0.800 Vali Acc: 0.649 Test Loss: 0.800 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.3039872
	speed: 0.3363s/iter; left time: 11259.4684s
	iters: 200, epoch: 10 | loss: 0.6093035
	speed: 0.0816s/iter; left time: 2724.5499s
	iters: 300, epoch: 10 | loss: 0.5285030
	speed: 0.0870s/iter; left time: 2896.1939s
Epoch: 10 cost time: 31.952979803085327
Epoch: 10, Steps: 369 | Train Loss: 0.293 Vali Loss: 0.882 Vali Acc: 0.661 Test Loss: 0.882 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.2347404
	speed: 0.3477s/iter; left time: 11513.7061s
	iters: 200, epoch: 11 | loss: 0.5035155
	speed: 0.0851s/iter; left time: 2807.5984s
	iters: 300, epoch: 11 | loss: 0.1581187
	speed: 0.0933s/iter; left time: 3071.9180s
Epoch: 11 cost time: 33.19995069503784
Epoch: 11, Steps: 369 | Train Loss: 0.255 Vali Loss: 0.990 Vali Acc: 0.661 Test Loss: 0.990 Test Acc: 0.661
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1762477
	speed: 0.3246s/iter; left time: 10626.7094s
	iters: 200, epoch: 12 | loss: 0.5304055
	speed: 0.0865s/iter; left time: 2822.3787s
	iters: 300, epoch: 12 | loss: 0.1453790
	speed: 0.0857s/iter; left time: 2789.0507s
Epoch: 12 cost time: 31.887116193771362
Epoch: 12, Steps: 369 | Train Loss: 0.212 Vali Loss: 1.312 Vali Acc: 0.642 Test Loss: 1.312 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1600756
	speed: 0.3421s/iter; left time: 11075.0551s
	iters: 200, epoch: 13 | loss: 0.2901377
	speed: 0.0863s/iter; left time: 2783.5922s
	iters: 300, epoch: 13 | loss: 0.6966535
	speed: 0.0939s/iter; left time: 3022.5271s
Epoch: 13 cost time: 34.71534490585327
Epoch: 13, Steps: 369 | Train Loss: 0.198 Vali Loss: 1.206 Vali Acc: 0.659 Test Loss: 1.206 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1579057
	speed: 0.3435s/iter; left time: 10993.3205s
	iters: 200, epoch: 14 | loss: 0.1357364
	speed: 0.0861s/iter; left time: 2746.8677s
	iters: 300, epoch: 14 | loss: 0.2315702
	speed: 0.0829s/iter; left time: 2638.0809s
Epoch: 14 cost time: 31.74069881439209
Epoch: 14, Steps: 369 | Train Loss: 0.177 Vali Loss: 1.126 Vali Acc: 0.647 Test Loss: 1.126 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6875709421112373
model parameter : 800562
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6837267
	speed: 0.1022s/iter; left time: 3762.3885s
	iters: 200, epoch: 1 | loss: 1.0561086
	speed: 0.0920s/iter; left time: 3377.4609s
	iters: 300, epoch: 1 | loss: 1.0473452
	speed: 0.0756s/iter; left time: 2768.7669s
Epoch: 1 cost time: 32.43627667427063
Epoch: 1, Steps: 369 | Train Loss: 0.778 Vali Loss: 0.812 Vali Acc: 0.607 Test Loss: 0.812 Test Acc: 0.607
Validation loss decreased (inf --> -0.607256).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5490167
	speed: 0.3257s/iter; left time: 11865.7991s
	iters: 200, epoch: 2 | loss: 0.8923669
	speed: 0.0783s/iter; left time: 2844.0365s
	iters: 300, epoch: 2 | loss: 0.4343093
	speed: 0.0865s/iter; left time: 3134.3217s
Epoch: 2 cost time: 31.48424506187439
Epoch: 2, Steps: 369 | Train Loss: 0.682 Vali Loss: 0.658 Vali Acc: 0.656 Test Loss: 0.658 Test Acc: 0.656
Validation loss decreased (-0.607256 --> -0.656066).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4686212
	speed: 0.3254s/iter; left time: 11736.0854s
	iters: 200, epoch: 3 | loss: 0.7404200
	speed: 0.0760s/iter; left time: 2732.4138s
	iters: 300, epoch: 3 | loss: 0.5249740
	speed: 0.0863s/iter; left time: 3096.0887s
Epoch: 3 cost time: 31.00840401649475
Epoch: 3, Steps: 369 | Train Loss: 0.647 Vali Loss: 0.644 Vali Acc: 0.675 Test Loss: 0.644 Test Acc: 0.675
Validation loss decreased (-0.656066 --> -0.674511).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6415317
	speed: 0.3187s/iter; left time: 11374.2442s
	iters: 200, epoch: 4 | loss: 0.5069214
	speed: 0.0791s/iter; left time: 2815.1684s
	iters: 300, epoch: 4 | loss: 0.5018192
	speed: 0.0948s/iter; left time: 3364.9861s
Epoch: 4 cost time: 32.121631145477295
Epoch: 4, Steps: 369 | Train Loss: 0.575 Vali Loss: 0.658 Vali Acc: 0.668 Test Loss: 0.658 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5489562
	speed: 0.3296s/iter; left time: 11642.2236s
	iters: 200, epoch: 5 | loss: 0.8252893
	speed: 0.0840s/iter; left time: 2957.3178s
	iters: 300, epoch: 5 | loss: 0.5239640
	speed: 0.0774s/iter; left time: 2719.1532s
Epoch: 5 cost time: 30.384199619293213
Epoch: 5, Steps: 369 | Train Loss: 0.518 Vali Loss: 0.603 Vali Acc: 0.678 Test Loss: 0.603 Test Acc: 0.678
Validation loss decreased (-0.674511 --> -0.677633).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4800531
	speed: 0.3256s/iter; left time: 11382.8461s
	iters: 200, epoch: 6 | loss: 0.3162017
	speed: 0.0776s/iter; left time: 2703.5758s
	iters: 300, epoch: 6 | loss: 0.7235754
	speed: 0.0941s/iter; left time: 3269.0065s
Epoch: 6 cost time: 31.5536687374115
Epoch: 6, Steps: 369 | Train Loss: 0.473 Vali Loss: 0.652 Vali Acc: 0.675 Test Loss: 0.652 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3749374
	speed: 0.3290s/iter; left time: 11377.7217s
	iters: 200, epoch: 7 | loss: 0.4502898
	speed: 0.0762s/iter; left time: 2626.2481s
	iters: 300, epoch: 7 | loss: 0.6499319
	speed: 0.0765s/iter; left time: 2632.3238s
Epoch: 7 cost time: 28.733221292495728
Epoch: 7, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.913 Vali Acc: 0.654 Test Loss: 0.913 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3488910
	speed: 0.3228s/iter; left time: 11046.5916s
	iters: 200, epoch: 8 | loss: 0.1675529
	speed: 0.0779s/iter; left time: 2658.2248s
	iters: 300, epoch: 8 | loss: 0.1701739
	speed: 0.0809s/iter; left time: 2751.8576s
Epoch: 8 cost time: 30.890027046203613
Epoch: 8, Steps: 369 | Train Loss: 0.382 Vali Loss: 0.699 Vali Acc: 0.670 Test Loss: 0.699 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3050518
	speed: 0.3329s/iter; left time: 11268.5606s
	iters: 200, epoch: 9 | loss: 0.3499447
	speed: 0.0757s/iter; left time: 2554.5610s
	iters: 300, epoch: 9 | loss: 0.3945052
	speed: 0.0844s/iter; left time: 2840.9233s
Epoch: 9 cost time: 30.934296369552612
Epoch: 9, Steps: 369 | Train Loss: 0.333 Vali Loss: 0.863 Vali Acc: 0.656 Test Loss: 0.863 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4782229
	speed: 0.3403s/iter; left time: 11394.4176s
	iters: 200, epoch: 10 | loss: 0.1551751
	speed: 0.0782s/iter; left time: 2611.1494s
	iters: 300, epoch: 10 | loss: 0.2042478
	speed: 0.0780s/iter; left time: 2595.2955s
Epoch: 10 cost time: 30.72695517539978
Epoch: 10, Steps: 369 | Train Loss: 0.309 Vali Loss: 0.820 Vali Acc: 0.669 Test Loss: 0.820 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1439825
	speed: 0.3330s/iter; left time: 11024.9102s
	iters: 200, epoch: 11 | loss: 0.1184830
	speed: 0.0832s/iter; left time: 2747.5745s
	iters: 300, epoch: 11 | loss: 0.1054858
	speed: 0.0791s/iter; left time: 2603.2694s
Epoch: 11 cost time: 31.214475393295288
Epoch: 11, Steps: 369 | Train Loss: 0.249 Vali Loss: 1.096 Vali Acc: 0.656 Test Loss: 1.096 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3664771
	speed: 0.3362s/iter; left time: 11007.6021s
	iters: 200, epoch: 12 | loss: 0.6424813
	speed: 0.0813s/iter; left time: 2652.2052s
	iters: 300, epoch: 12 | loss: 0.2864122
	speed: 0.0776s/iter; left time: 2524.0199s
Epoch: 12 cost time: 30.698305130004883
Epoch: 12, Steps: 369 | Train Loss: 0.227 Vali Loss: 1.056 Vali Acc: 0.665 Test Loss: 1.056 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.3195487
	speed: 0.3401s/iter; left time: 11010.3501s
	iters: 200, epoch: 13 | loss: 0.1304083
	speed: 0.0835s/iter; left time: 2694.2383s
	iters: 300, epoch: 13 | loss: 0.2229662
	speed: 0.0740s/iter; left time: 2380.3872s
Epoch: 13 cost time: 30.453174829483032
Epoch: 13, Steps: 369 | Train Loss: 0.202 Vali Loss: 1.104 Vali Acc: 0.651 Test Loss: 1.104 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0163474
	speed: 0.3314s/iter; left time: 10605.5968s
	iters: 200, epoch: 14 | loss: 0.7420263
	speed: 0.0793s/iter; left time: 2529.9105s
	iters: 300, epoch: 14 | loss: 0.3392311
	speed: 0.0794s/iter; left time: 2524.0738s
Epoch: 14 cost time: 31.18787956237793
Epoch: 14, Steps: 369 | Train Loss: 0.183 Vali Loss: 1.434 Vali Acc: 0.644 Test Loss: 1.434 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1941149
	speed: 0.3346s/iter; left time: 10585.8193s
	iters: 200, epoch: 15 | loss: 0.1954046
	speed: 0.0847s/iter; left time: 2669.9843s
	iters: 300, epoch: 15 | loss: 0.0889739
	speed: 0.0835s/iter; left time: 2623.6448s
Epoch: 15 cost time: 32.10595965385437
Epoch: 15, Steps: 369 | Train Loss: 0.160 Vali Loss: 1.349 Vali Acc: 0.655 Test Loss: 1.349 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.677639046538025
model parameter : 799858
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9084818
	speed: 0.1084s/iter; left time: 3989.5362s
	iters: 200, epoch: 1 | loss: 0.6807421
	speed: 0.0815s/iter; left time: 2991.6602s
	iters: 300, epoch: 1 | loss: 0.6626780
	speed: 0.0851s/iter; left time: 3113.8814s
Epoch: 1 cost time: 33.72037863731384
Epoch: 1, Steps: 369 | Train Loss: 0.826 Vali Loss: 0.888 Vali Acc: 0.573 Test Loss: 0.888 Test Acc: 0.573
Validation loss decreased (inf --> -0.573203).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7686859
	speed: 0.3347s/iter; left time: 12195.0656s
	iters: 200, epoch: 2 | loss: 0.3795354
	speed: 0.0798s/iter; left time: 2900.7235s
	iters: 300, epoch: 2 | loss: 0.7553519
	speed: 0.0850s/iter; left time: 3080.0730s
Epoch: 2 cost time: 30.22620177268982
Epoch: 2, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.621 Vali Acc: 0.674 Test Loss: 0.621 Test Acc: 0.674
Validation loss decreased (-0.573203 --> -0.673944).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4161763
	speed: 0.3385s/iter; left time: 12208.8049s
	iters: 200, epoch: 3 | loss: 0.7712468
	speed: 0.0756s/iter; left time: 2717.9158s
	iters: 300, epoch: 3 | loss: 0.6839600
	speed: 0.0782s/iter; left time: 2804.1883s
Epoch: 3 cost time: 31.422834396362305
Epoch: 3, Steps: 369 | Train Loss: 0.687 Vali Loss: 0.717 Vali Acc: 0.625 Test Loss: 0.717 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4535749
	speed: 0.3399s/iter; left time: 12132.3860s
	iters: 200, epoch: 4 | loss: 0.6857775
	speed: 0.0792s/iter; left time: 2818.2082s
	iters: 300, epoch: 4 | loss: 0.6447414
	speed: 0.0823s/iter; left time: 2921.2795s
Epoch: 4 cost time: 31.474984407424927
Epoch: 4, Steps: 369 | Train Loss: 0.564 Vali Loss: 0.624 Vali Acc: 0.668 Test Loss: 0.624 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4588492
	speed: 0.3308s/iter; left time: 11685.2080s
	iters: 200, epoch: 5 | loss: 0.4619051
	speed: 0.0820s/iter; left time: 2888.9626s
	iters: 300, epoch: 5 | loss: 0.2873244
	speed: 0.0745s/iter; left time: 2615.1403s
Epoch: 5 cost time: 30.529038906097412
Epoch: 5, Steps: 369 | Train Loss: 0.493 Vali Loss: 0.621 Vali Acc: 0.681 Test Loss: 0.621 Test Acc: 0.681
Validation loss decreased (-0.673944 --> -0.681038).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6233357
	speed: 0.3272s/iter; left time: 11436.6810s
	iters: 200, epoch: 6 | loss: 0.3713741
	speed: 0.0768s/iter; left time: 2676.7215s
	iters: 300, epoch: 6 | loss: 0.6981499
	speed: 0.0759s/iter; left time: 2636.9359s
Epoch: 6 cost time: 30.40304684638977
Epoch: 6, Steps: 369 | Train Loss: 0.447 Vali Loss: 0.655 Vali Acc: 0.680 Test Loss: 0.655 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4134379
	speed: 0.3369s/iter; left time: 11651.7894s
	iters: 200, epoch: 7 | loss: 0.5111511
	speed: 0.0910s/iter; left time: 3139.3619s
	iters: 300, epoch: 7 | loss: 0.3073121
	speed: 0.0855s/iter; left time: 2938.8182s
Epoch: 7 cost time: 33.97580075263977
Epoch: 7, Steps: 369 | Train Loss: 0.406 Vali Loss: 0.705 Vali Acc: 0.653 Test Loss: 0.705 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0888747
	speed: 0.3365s/iter; left time: 11513.8760s
	iters: 200, epoch: 8 | loss: 0.5599071
	speed: 0.0809s/iter; left time: 2761.5637s
	iters: 300, epoch: 8 | loss: 0.0726892
	speed: 0.0778s/iter; left time: 2648.0244s
Epoch: 8 cost time: 32.0301878452301
Epoch: 8, Steps: 369 | Train Loss: 0.355 Vali Loss: 0.783 Vali Acc: 0.645 Test Loss: 0.783 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2202202
	speed: 0.3477s/iter; left time: 11768.5046s
	iters: 200, epoch: 9 | loss: 0.2150107
	speed: 0.0746s/iter; left time: 2516.2363s
	iters: 300, epoch: 9 | loss: 0.3296451
	speed: 0.0817s/iter; left time: 2749.6747s
Epoch: 9 cost time: 30.190373182296753
Epoch: 9, Steps: 369 | Train Loss: 0.311 Vali Loss: 0.792 Vali Acc: 0.663 Test Loss: 0.792 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1061115
	speed: 0.3216s/iter; left time: 10767.4953s
	iters: 200, epoch: 10 | loss: 0.3262261
	speed: 0.0762s/iter; left time: 2545.0006s
	iters: 300, epoch: 10 | loss: 0.2913666
	speed: 0.0775s/iter; left time: 2578.6900s
Epoch: 10 cost time: 29.668466329574585
Epoch: 10, Steps: 369 | Train Loss: 0.280 Vali Loss: 0.899 Vali Acc: 0.665 Test Loss: 0.899 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1334643
	speed: 0.3312s/iter; left time: 10966.9231s
	iters: 200, epoch: 11 | loss: 0.3079208
	speed: 0.0852s/iter; left time: 2811.6904s
	iters: 300, epoch: 11 | loss: 0.3763995
	speed: 0.0821s/iter; left time: 2701.2121s
Epoch: 11 cost time: 32.089115619659424
Epoch: 11, Steps: 369 | Train Loss: 0.236 Vali Loss: 0.946 Vali Acc: 0.652 Test Loss: 0.946 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1221041
	speed: 0.3440s/iter; left time: 11264.7728s
	iters: 200, epoch: 12 | loss: 0.0762766
	speed: 0.0877s/iter; left time: 2862.8529s
	iters: 300, epoch: 12 | loss: 0.1131381
	speed: 0.0788s/iter; left time: 2563.0434s
Epoch: 12 cost time: 32.0474636554718
Epoch: 12, Steps: 369 | Train Loss: 0.199 Vali Loss: 1.184 Vali Acc: 0.665 Test Loss: 1.184 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2262850
	speed: 0.3349s/iter; left time: 10842.2571s
	iters: 200, epoch: 13 | loss: 0.0813936
	speed: 0.0863s/iter; left time: 2784.1945s
	iters: 300, epoch: 13 | loss: 0.2562998
	speed: 0.0856s/iter; left time: 2753.2453s
Epoch: 13 cost time: 32.297629594802856
Epoch: 13, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.017 Vali Acc: 0.648 Test Loss: 1.017 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0940330
	speed: 0.3516s/iter; left time: 11253.1565s
	iters: 200, epoch: 14 | loss: 0.6090334
	speed: 0.0882s/iter; left time: 2813.4773s
	iters: 300, epoch: 14 | loss: 0.1769334
	speed: 0.0837s/iter; left time: 2662.4556s
Epoch: 14 cost time: 33.52314877510071
Epoch: 14, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.444 Vali Acc: 0.636 Test Loss: 1.444 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0868235
	speed: 0.3554s/iter; left time: 11242.1646s
	iters: 200, epoch: 15 | loss: 0.2026752
	speed: 0.0865s/iter; left time: 2729.0480s
	iters: 300, epoch: 15 | loss: 0.0180995
	speed: 0.0898s/iter; left time: 2823.1611s
Epoch: 15 cost time: 32.712530851364136
Epoch: 15, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.419 Vali Acc: 0.649 Test Loss: 1.419 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.681044267877412
model parameter : 686386
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5272518
	speed: 0.1027s/iter; left time: 3780.6749s
	iters: 200, epoch: 1 | loss: 0.8787195
	speed: 0.0770s/iter; left time: 2826.5881s
	iters: 300, epoch: 1 | loss: 0.5720344
	speed: 0.0876s/iter; left time: 3204.4385s
Epoch: 1 cost time: 33.857484102249146
Epoch: 1, Steps: 369 | Train Loss: 0.753 Vali Loss: 0.973 Vali Acc: 0.569 Test Loss: 0.973 Test Acc: 0.569
Validation loss decreased (inf --> -0.568946).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5407677
	speed: 0.3578s/iter; left time: 13035.6411s
	iters: 200, epoch: 2 | loss: 0.2643376
	speed: 0.0880s/iter; left time: 3197.5454s
	iters: 300, epoch: 2 | loss: 0.6023542
	speed: 0.0849s/iter; left time: 3075.9506s
Epoch: 2 cost time: 32.41030430793762
Epoch: 2, Steps: 369 | Train Loss: 0.756 Vali Loss: 0.730 Vali Acc: 0.662 Test Loss: 0.730 Test Acc: 0.662
Validation loss decreased (-0.568946 --> -0.662024).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2874350
	speed: 0.3452s/iter; left time: 12447.9391s
	iters: 200, epoch: 3 | loss: 0.5734728
	speed: 0.0837s/iter; left time: 3009.5712s
	iters: 300, epoch: 3 | loss: 0.7013856
	speed: 0.0832s/iter; left time: 2984.5546s
Epoch: 3 cost time: 32.96922540664673
Epoch: 3, Steps: 369 | Train Loss: 0.632 Vali Loss: 0.697 Vali Acc: 0.656 Test Loss: 0.697 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5209097
	speed: 0.3700s/iter; left time: 13205.2781s
	iters: 200, epoch: 4 | loss: 0.4994057
	speed: 0.0867s/iter; left time: 3084.6105s
	iters: 300, epoch: 4 | loss: 0.9216226
	speed: 0.0820s/iter; left time: 2912.1276s
Epoch: 4 cost time: 32.021278619766235
Epoch: 4, Steps: 369 | Train Loss: 0.558 Vali Loss: 0.801 Vali Acc: 0.669 Test Loss: 0.801 Test Acc: 0.669
Validation loss decreased (-0.662024 --> -0.669402).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5560776
	speed: 0.3541s/iter; left time: 12509.6394s
	iters: 200, epoch: 5 | loss: 0.2339959
	speed: 0.0858s/iter; left time: 3020.6669s
	iters: 300, epoch: 5 | loss: 0.4358737
	speed: 0.0815s/iter; left time: 2862.7050s
Epoch: 5 cost time: 31.777549982070923
Epoch: 5, Steps: 369 | Train Loss: 0.502 Vali Loss: 0.658 Vali Acc: 0.676 Test Loss: 0.658 Test Acc: 0.676
Validation loss decreased (-0.669402 --> -0.675930).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5609201
	speed: 0.3409s/iter; left time: 11915.2892s
	iters: 200, epoch: 6 | loss: 0.5165633
	speed: 0.0869s/iter; left time: 3029.7422s
	iters: 300, epoch: 6 | loss: 0.4288672
	speed: 0.0877s/iter; left time: 3047.1399s
Epoch: 6 cost time: 33.04027462005615
Epoch: 6, Steps: 369 | Train Loss: 0.448 Vali Loss: 0.629 Vali Acc: 0.673 Test Loss: 0.629 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4911036
	speed: 0.3476s/iter; left time: 12023.3864s
	iters: 200, epoch: 7 | loss: 0.5728776
	speed: 0.0885s/iter; left time: 3053.6467s
	iters: 300, epoch: 7 | loss: 0.3950571
	speed: 0.0939s/iter; left time: 3229.0015s
Epoch: 7 cost time: 33.917415618896484
Epoch: 7, Steps: 369 | Train Loss: 0.405 Vali Loss: 0.719 Vali Acc: 0.679 Test Loss: 0.719 Test Acc: 0.679
Validation loss decreased (-0.675930 --> -0.679051).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1989594
	speed: 0.3429s/iter; left time: 11734.5012s
	iters: 200, epoch: 8 | loss: 0.2606156
	speed: 0.0857s/iter; left time: 2923.4243s
	iters: 300, epoch: 8 | loss: 0.3660036
	speed: 0.0855s/iter; left time: 2908.9102s
Epoch: 8 cost time: 32.79080677032471
Epoch: 8, Steps: 369 | Train Loss: 0.376 Vali Loss: 0.732 Vali Acc: 0.661 Test Loss: 0.732 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7357883
	speed: 0.3494s/iter; left time: 11826.4986s
	iters: 200, epoch: 9 | loss: 0.2058830
	speed: 0.0888s/iter; left time: 2996.3214s
	iters: 300, epoch: 9 | loss: 0.2401798
	speed: 0.0923s/iter; left time: 3106.2648s
Epoch: 9 cost time: 33.65474033355713
Epoch: 9, Steps: 369 | Train Loss: 0.318 Vali Loss: 0.804 Vali Acc: 0.667 Test Loss: 0.804 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1368887
	speed: 0.3559s/iter; left time: 11916.0799s
	iters: 200, epoch: 10 | loss: 0.4884281
	speed: 0.0835s/iter; left time: 2787.6307s
	iters: 300, epoch: 10 | loss: 0.8092885
	speed: 0.0845s/iter; left time: 2812.7222s
Epoch: 10 cost time: 32.91218185424805
Epoch: 10, Steps: 369 | Train Loss: 0.280 Vali Loss: 0.914 Vali Acc: 0.658 Test Loss: 0.914 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2632354
	speed: 0.3522s/iter; left time: 11662.5962s
	iters: 200, epoch: 11 | loss: 0.3378234
	speed: 0.0784s/iter; left time: 2589.2619s
	iters: 300, epoch: 11 | loss: 0.2370855
	speed: 0.0949s/iter; left time: 3122.3001s
Epoch: 11 cost time: 32.795722246170044
Epoch: 11, Steps: 369 | Train Loss: 0.237 Vali Loss: 0.937 Vali Acc: 0.663 Test Loss: 0.937 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0421984
	speed: 0.3576s/iter; left time: 11708.8040s
	iters: 200, epoch: 12 | loss: 0.2800952
	speed: 0.0863s/iter; left time: 2817.4464s
	iters: 300, epoch: 12 | loss: 0.1344737
	speed: 0.0854s/iter; left time: 2780.1310s
Epoch: 12 cost time: 32.62680101394653
Epoch: 12, Steps: 369 | Train Loss: 0.225 Vali Loss: 1.008 Vali Acc: 0.661 Test Loss: 1.008 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0679937
	speed: 0.3429s/iter; left time: 11100.2648s
	iters: 200, epoch: 13 | loss: 0.4298162
	speed: 0.0857s/iter; left time: 2765.5266s
	iters: 300, epoch: 13 | loss: 0.0920841
	speed: 0.0935s/iter; left time: 3006.9680s
Epoch: 13 cost time: 33.01700448989868
Epoch: 13, Steps: 369 | Train Loss: 0.181 Vali Loss: 1.275 Vali Acc: 0.648 Test Loss: 1.275 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1180559
	speed: 0.3429s/iter; left time: 10973.5525s
	iters: 200, epoch: 14 | loss: 0.3211752
	speed: 0.0828s/iter; left time: 2642.9041s
	iters: 300, epoch: 14 | loss: 0.1104994
	speed: 0.0791s/iter; left time: 2514.8217s
Epoch: 14 cost time: 31.856773614883423
Epoch: 14, Steps: 369 | Train Loss: 0.175 Vali Loss: 1.351 Vali Acc: 0.658 Test Loss: 1.351 Test Acc: 0.658
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.3517943
	speed: 0.3520s/iter; left time: 11134.1221s
	iters: 200, epoch: 15 | loss: 0.1246317
	speed: 0.0868s/iter; left time: 2736.3323s
	iters: 300, epoch: 15 | loss: 0.3749631
	speed: 0.0900s/iter; left time: 2830.5319s
Epoch: 15 cost time: 33.32286262512207
Epoch: 15, Steps: 369 | Train Loss: 0.158 Vali Loss: 1.278 Vali Acc: 0.669 Test Loss: 1.278 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0673861
	speed: 0.3529s/iter; left time: 11033.5050s
	iters: 200, epoch: 16 | loss: 0.0200257
	speed: 0.0846s/iter; left time: 2636.4550s
	iters: 300, epoch: 16 | loss: 0.0648688
	speed: 0.0819s/iter; left time: 2545.0796s
Epoch: 16 cost time: 31.326749563217163
Epoch: 16, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.242 Vali Acc: 0.654 Test Loss: 1.242 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.2223562
	speed: 0.3494s/iter; left time: 10795.1480s
	iters: 200, epoch: 17 | loss: 0.2878567
	speed: 0.0910s/iter; left time: 2801.7567s
	iters: 300, epoch: 17 | loss: 0.1713234
	speed: 0.0939s/iter; left time: 2883.0139s
Epoch: 17 cost time: 34.74846529960632
Epoch: 17, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.369 Vali Acc: 0.650 Test Loss: 1.369 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6790578887627696
model parameter : 685682
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6757526
	speed: 0.1071s/iter; left time: 3940.3853s
	iters: 200, epoch: 1 | loss: 0.8048590
	speed: 0.0885s/iter; left time: 3247.4197s
	iters: 300, epoch: 1 | loss: 0.7887174
	speed: 0.0850s/iter; left time: 3111.9387s
Epoch: 1 cost time: 34.11542296409607
Epoch: 1, Steps: 369 | Train Loss: 0.805 Vali Loss: 0.714 Vali Acc: 0.661 Test Loss: 0.714 Test Acc: 0.661
Validation loss decreased (inf --> -0.660606).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7667472
	speed: 0.3176s/iter; left time: 11572.2717s
	iters: 200, epoch: 2 | loss: 1.3837177
	speed: 0.0772s/iter; left time: 2805.9729s
	iters: 300, epoch: 2 | loss: 0.5264042
	speed: 0.0770s/iter; left time: 2790.6499s
Epoch: 2 cost time: 29.771387577056885
Epoch: 2, Steps: 369 | Train Loss: 0.667 Vali Loss: 0.630 Vali Acc: 0.657 Test Loss: 0.630 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3488978
	speed: 0.3255s/iter; left time: 11740.0100s
	iters: 200, epoch: 3 | loss: 0.6372147
	speed: 0.0748s/iter; left time: 2688.7919s
	iters: 300, epoch: 3 | loss: 0.2347213
	speed: 0.0950s/iter; left time: 3405.9591s
Epoch: 3 cost time: 30.979061603546143
Epoch: 3, Steps: 369 | Train Loss: 0.628 Vali Loss: 0.669 Vali Acc: 0.675 Test Loss: 0.669 Test Acc: 0.675
Validation loss decreased (-0.660606 --> -0.674511).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5339214
	speed: 0.3205s/iter; left time: 11439.5613s
	iters: 200, epoch: 4 | loss: 0.8446298
	speed: 0.0782s/iter; left time: 2783.3563s
	iters: 300, epoch: 4 | loss: 0.7916470
	speed: 0.0803s/iter; left time: 2848.7375s
Epoch: 4 cost time: 29.780557870864868
Epoch: 4, Steps: 369 | Train Loss: 0.553 Vali Loss: 0.746 Vali Acc: 0.638 Test Loss: 0.746 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4399398
	speed: 0.3157s/iter; left time: 11150.7388s
	iters: 200, epoch: 5 | loss: 0.4570457
	speed: 0.0769s/iter; left time: 2709.6535s
	iters: 300, epoch: 5 | loss: 0.6550588
	speed: 0.0850s/iter; left time: 2985.5701s
Epoch: 5 cost time: 31.518807411193848
Epoch: 5, Steps: 369 | Train Loss: 0.499 Vali Loss: 0.638 Vali Acc: 0.674 Test Loss: 0.638 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5290798
	speed: 0.3215s/iter; left time: 11237.4952s
	iters: 200, epoch: 6 | loss: 0.4297660
	speed: 0.0818s/iter; left time: 2850.8336s
	iters: 300, epoch: 6 | loss: 0.5092012
	speed: 0.0808s/iter; left time: 2809.9702s
Epoch: 6 cost time: 30.71098494529724
Epoch: 6, Steps: 369 | Train Loss: 0.453 Vali Loss: 0.587 Vali Acc: 0.698 Test Loss: 0.587 Test Acc: 0.698
Validation loss decreased (-0.674511 --> -0.698065).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3081858
	speed: 0.3187s/iter; left time: 11024.3536s
	iters: 200, epoch: 7 | loss: 0.2711104
	speed: 0.0787s/iter; left time: 2712.8108s
	iters: 300, epoch: 7 | loss: 0.6212045
	speed: 0.0862s/iter; left time: 2963.0550s
Epoch: 7 cost time: 31.82305073738098
Epoch: 7, Steps: 369 | Train Loss: 0.397 Vali Loss: 0.856 Vali Acc: 0.641 Test Loss: 0.856 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4785828
	speed: 0.3289s/iter; left time: 11254.1367s
	iters: 200, epoch: 8 | loss: 0.5714133
	speed: 0.0735s/iter; left time: 2508.4286s
	iters: 300, epoch: 8 | loss: 0.3361944
	speed: 0.0812s/iter; left time: 2763.5129s
Epoch: 8 cost time: 30.123223066329956
Epoch: 8, Steps: 369 | Train Loss: 0.365 Vali Loss: 0.697 Vali Acc: 0.669 Test Loss: 0.697 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0702392
	speed: 0.3293s/iter; left time: 11147.0230s
	iters: 200, epoch: 9 | loss: 0.1852200
	speed: 0.0792s/iter; left time: 2673.3488s
	iters: 300, epoch: 9 | loss: 0.2767069
	speed: 0.0829s/iter; left time: 2790.2787s
Epoch: 9 cost time: 30.751458883285522
Epoch: 9, Steps: 369 | Train Loss: 0.321 Vali Loss: 0.734 Vali Acc: 0.667 Test Loss: 0.734 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3806728
	speed: 0.3271s/iter; left time: 10950.9539s
	iters: 200, epoch: 10 | loss: 0.5865933
	speed: 0.0802s/iter; left time: 2676.1328s
	iters: 300, epoch: 10 | loss: 0.2093203
	speed: 0.0771s/iter; left time: 2566.4242s
Epoch: 10 cost time: 30.424432516098022
Epoch: 10, Steps: 369 | Train Loss: 0.283 Vali Loss: 0.957 Vali Acc: 0.663 Test Loss: 0.957 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0702086
	speed: 0.3268s/iter; left time: 10821.6141s
	iters: 200, epoch: 11 | loss: 0.4835598
	speed: 0.0890s/iter; left time: 2936.6913s
	iters: 300, epoch: 11 | loss: 0.2629560
	speed: 0.0938s/iter; left time: 3087.7619s
Epoch: 11 cost time: 34.28257608413696
Epoch: 11, Steps: 369 | Train Loss: 0.242 Vali Loss: 0.885 Vali Acc: 0.662 Test Loss: 0.885 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2391285
	speed: 0.3339s/iter; left time: 10931.7103s
	iters: 200, epoch: 12 | loss: 0.2724282
	speed: 0.0841s/iter; left time: 2746.3760s
	iters: 300, epoch: 12 | loss: 0.1836662
	speed: 0.0846s/iter; left time: 2751.9018s
Epoch: 12 cost time: 32.34903025627136
Epoch: 12, Steps: 369 | Train Loss: 0.212 Vali Loss: 1.130 Vali Acc: 0.658 Test Loss: 1.130 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.4268891
	speed: 0.3548s/iter; left time: 11486.6086s
	iters: 200, epoch: 13 | loss: 0.3139980
	speed: 0.0812s/iter; left time: 2620.6247s
	iters: 300, epoch: 13 | loss: 0.1068581
	speed: 0.0854s/iter; left time: 2748.3953s
Epoch: 13 cost time: 32.04457330703735
Epoch: 13, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.119 Vali Acc: 0.660 Test Loss: 1.119 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1257266
	speed: 0.3584s/iter; left time: 11469.8490s
	iters: 200, epoch: 14 | loss: 0.0883003
	speed: 0.0871s/iter; left time: 2779.0242s
	iters: 300, epoch: 14 | loss: 0.0883455
	speed: 0.1010s/iter; left time: 3213.2619s
Epoch: 14 cost time: 36.06429934501648
Epoch: 14, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.088 Vali Acc: 0.677 Test Loss: 1.088 Test Acc: 0.677
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0854270
	speed: 0.3824s/iter; left time: 12096.5087s
	iters: 200, epoch: 15 | loss: 0.0761022
	speed: 0.0937s/iter; left time: 2954.8545s
	iters: 300, epoch: 15 | loss: 0.1595941
	speed: 0.0902s/iter; left time: 2834.2719s
Epoch: 15 cost time: 35.7535502910614
Epoch: 15, Steps: 369 | Train Loss: 0.158 Vali Loss: 1.183 Vali Acc: 0.655 Test Loss: 1.183 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0354887
	speed: 0.3800s/iter; left time: 11879.5992s
	iters: 200, epoch: 16 | loss: 0.1351812
	speed: 0.0935s/iter; left time: 2912.5343s
	iters: 300, epoch: 16 | loss: 0.2458729
	speed: 0.1029s/iter; left time: 3195.7007s
Epoch: 16 cost time: 36.122002601623535
Epoch: 16, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.472 Vali Acc: 0.658 Test Loss: 1.472 Test Acc: 0.658
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6980703745743473
model parameter : 684978
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1990929
	speed: 0.1183s/iter; left time: 4354.4615s
	iters: 200, epoch: 1 | loss: 0.9230320
	speed: 0.0935s/iter; left time: 3432.9413s
	iters: 300, epoch: 1 | loss: 1.3456794
	speed: 0.0913s/iter; left time: 3342.4154s
Epoch: 1 cost time: 37.39048457145691
Epoch: 1, Steps: 369 | Train Loss: 0.802 Vali Loss: 1.148 Vali Acc: 0.516 Test Loss: 1.148 Test Acc: 0.516
Validation loss decreased (inf --> -0.516163).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4167426
	speed: 0.3740s/iter; left time: 13626.0776s
	iters: 200, epoch: 2 | loss: 0.3357117
	speed: 0.0963s/iter; left time: 3498.1217s
	iters: 300, epoch: 2 | loss: 0.5699067
	speed: 0.1004s/iter; left time: 3636.1303s
Epoch: 2 cost time: 38.480631828308105
Epoch: 2, Steps: 369 | Train Loss: 0.683 Vali Loss: 0.991 Vali Acc: 0.581 Test Loss: 0.991 Test Acc: 0.581
Validation loss decreased (-0.516163 --> -0.581432).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6208140
	speed: 0.3684s/iter; left time: 13287.1278s
	iters: 200, epoch: 3 | loss: 0.5545849
	speed: 0.0936s/iter; left time: 3364.6953s
	iters: 300, epoch: 3 | loss: 0.8020340
	speed: 0.0952s/iter; left time: 3412.5506s
Epoch: 3 cost time: 34.50493788719177
Epoch: 3, Steps: 369 | Train Loss: 0.651 Vali Loss: 0.741 Vali Acc: 0.650 Test Loss: 0.741 Test Acc: 0.650
Validation loss decreased (-0.581432 --> -0.650390).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6260931
	speed: 0.3752s/iter; left time: 13390.7167s
	iters: 200, epoch: 4 | loss: 0.4819222
	speed: 0.0871s/iter; left time: 3099.7605s
	iters: 300, epoch: 4 | loss: 0.6154385
	speed: 0.1093s/iter; left time: 3878.2221s
Epoch: 4 cost time: 37.59615349769592
Epoch: 4, Steps: 369 | Train Loss: 0.596 Vali Loss: 1.482 Vali Acc: 0.506 Test Loss: 1.482 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5548777
	speed: 0.4000s/iter; left time: 14130.0398s
	iters: 200, epoch: 5 | loss: 0.7352632
	speed: 0.0776s/iter; left time: 2734.4706s
	iters: 300, epoch: 5 | loss: 0.5149703
	speed: 0.0767s/iter; left time: 2695.4387s
Epoch: 5 cost time: 31.70263171195984
Epoch: 5, Steps: 369 | Train Loss: 0.527 Vali Loss: 0.639 Vali Acc: 0.658 Test Loss: 0.639 Test Acc: 0.658
Validation loss decreased (-0.650390 --> -0.658336).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4693268
	speed: 0.3558s/iter; left time: 12438.0363s
	iters: 200, epoch: 6 | loss: 0.7038754
	speed: 0.1086s/iter; left time: 3786.5088s
	iters: 300, epoch: 6 | loss: 0.6416085
	speed: 0.1155s/iter; left time: 4014.9928s
Epoch: 6 cost time: 39.46820688247681
Epoch: 6, Steps: 369 | Train Loss: 0.450 Vali Loss: 0.760 Vali Acc: 0.683 Test Loss: 0.760 Test Acc: 0.683
Validation loss decreased (-0.658336 --> -0.683307).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5033514
	speed: 0.3893s/iter; left time: 13465.9119s
	iters: 200, epoch: 7 | loss: 0.4900824
	speed: 0.0940s/iter; left time: 3241.4579s
	iters: 300, epoch: 7 | loss: 0.5324140
	speed: 0.0971s/iter; left time: 3339.5511s
Epoch: 7 cost time: 36.61301398277283
Epoch: 7, Steps: 369 | Train Loss: 0.412 Vali Loss: 0.693 Vali Acc: 0.659 Test Loss: 0.693 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6126963
	speed: 0.3806s/iter; left time: 13022.6335s
	iters: 200, epoch: 8 | loss: 0.4752136
	speed: 0.1156s/iter; left time: 3943.6464s
	iters: 300, epoch: 8 | loss: 0.3119641
	speed: 0.0945s/iter; left time: 3214.5994s
Epoch: 8 cost time: 38.830329179763794
Epoch: 8, Steps: 369 | Train Loss: 0.374 Vali Loss: 0.761 Vali Acc: 0.662 Test Loss: 0.761 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5349978
	speed: 0.3826s/iter; left time: 12951.2486s
	iters: 200, epoch: 9 | loss: 0.1223852
	speed: 0.0920s/iter; left time: 3104.5316s
	iters: 300, epoch: 9 | loss: 0.5411859
	speed: 0.0983s/iter; left time: 3307.0220s
Epoch: 9 cost time: 36.27999806404114
Epoch: 9, Steps: 369 | Train Loss: 0.328 Vali Loss: 0.917 Vali Acc: 0.672 Test Loss: 0.917 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3376184
	speed: 0.3925s/iter; left time: 13141.0165s
	iters: 200, epoch: 10 | loss: 0.2536089
	speed: 0.0958s/iter; left time: 3199.3124s
	iters: 300, epoch: 10 | loss: 0.5448943
	speed: 0.0823s/iter; left time: 2739.5278s
Epoch: 10 cost time: 35.82449150085449
Epoch: 10, Steps: 369 | Train Loss: 0.287 Vali Loss: 0.885 Vali Acc: 0.641 Test Loss: 0.885 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4057571
	speed: 0.3638s/iter; left time: 12045.7966s
	iters: 200, epoch: 11 | loss: 0.4122424
	speed: 0.0884s/iter; left time: 2916.8875s
	iters: 300, epoch: 11 | loss: 0.1909950
	speed: 0.1002s/iter; left time: 3298.5059s
Epoch: 11 cost time: 35.86740803718567
Epoch: 11, Steps: 369 | Train Loss: 0.254 Vali Loss: 1.077 Vali Acc: 0.637 Test Loss: 1.077 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0986139
	speed: 0.3699s/iter; left time: 12112.8817s
	iters: 200, epoch: 12 | loss: 0.4906947
	speed: 0.0967s/iter; left time: 3157.3717s
	iters: 300, epoch: 12 | loss: 0.2030368
	speed: 0.0938s/iter; left time: 3052.2386s
Epoch: 12 cost time: 37.70784831047058
Epoch: 12, Steps: 369 | Train Loss: 0.234 Vali Loss: 1.053 Vali Acc: 0.652 Test Loss: 1.053 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0829788
	speed: 0.3649s/iter; left time: 11814.2119s
	iters: 200, epoch: 13 | loss: 0.1465263
	speed: 0.1074s/iter; left time: 3465.1343s
	iters: 300, epoch: 13 | loss: 0.0810496
	speed: 0.1012s/iter; left time: 3254.6470s
Epoch: 13 cost time: 37.71473145484924
Epoch: 13, Steps: 369 | Train Loss: 0.185 Vali Loss: 1.268 Vali Acc: 0.633 Test Loss: 1.268 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.5672339
	speed: 0.3718s/iter; left time: 11900.4991s
	iters: 200, epoch: 14 | loss: 0.0870942
	speed: 0.0854s/iter; left time: 2723.5616s
	iters: 300, epoch: 14 | loss: 0.2480082
	speed: 0.0967s/iter; left time: 3076.5833s
Epoch: 14 cost time: 34.54019856452942
Epoch: 14, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.385 Vali Acc: 0.648 Test Loss: 1.385 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0722821
	speed: 0.3319s/iter; left time: 10500.0554s
	iters: 200, epoch: 15 | loss: 0.0707446
	speed: 0.0836s/iter; left time: 2636.5632s
	iters: 300, epoch: 15 | loss: 0.0934992
	speed: 0.0942s/iter; left time: 2960.9197s
Epoch: 15 cost time: 34.88598299026489
Epoch: 15, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.302 Vali Acc: 0.654 Test Loss: 1.302 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.6423675
	speed: 0.3731s/iter; left time: 11665.9792s
	iters: 200, epoch: 16 | loss: 0.0969630
	speed: 0.1135s/iter; left time: 3536.7657s
	iters: 300, epoch: 16 | loss: 0.2103797
	speed: 0.1324s/iter; left time: 4112.9089s
Epoch: 16 cost time: 41.86489772796631
Epoch: 16, Steps: 369 | Train Loss: 0.145 Vali Loss: 1.473 Vali Acc: 0.638 Test Loss: 1.473 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6833144154370034
model parameter : 684274
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1697527
	speed: 0.1517s/iter; left time: 5581.5046s
	iters: 200, epoch: 1 | loss: 0.6538178
	speed: 0.1099s/iter; left time: 4032.7954s
	iters: 300, epoch: 1 | loss: 0.9180480
	speed: 0.1252s/iter; left time: 4584.2563s
Epoch: 1 cost time: 47.14621925354004
Epoch: 1, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.652 Vali Acc: 0.648 Test Loss: 0.652 Test Acc: 0.648
Validation loss decreased (inf --> -0.648121).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5028865
	speed: 0.4230s/iter; left time: 15412.5148s
	iters: 200, epoch: 2 | loss: 0.8531288
	speed: 0.1119s/iter; left time: 4067.0328s
	iters: 300, epoch: 2 | loss: 0.4235022
	speed: 0.1125s/iter; left time: 4077.1433s
Epoch: 2 cost time: 42.790958642959595
Epoch: 2, Steps: 369 | Train Loss: 0.651 Vali Loss: 0.812 Vali Acc: 0.623 Test Loss: 0.812 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5947151
	speed: 0.4010s/iter; left time: 14460.7601s
	iters: 200, epoch: 3 | loss: 0.5675794
	speed: 0.1343s/iter; left time: 4828.3978s
	iters: 300, epoch: 3 | loss: 0.6585304
	speed: 0.1276s/iter; left time: 4576.9712s
Epoch: 3 cost time: 44.65272307395935
Epoch: 3, Steps: 369 | Train Loss: 0.594 Vali Loss: 0.740 Vali Acc: 0.663 Test Loss: 0.740 Test Acc: 0.663
Validation loss decreased (-0.648121 --> -0.662876).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8707762
	speed: 0.4012s/iter; left time: 14320.1615s
	iters: 200, epoch: 4 | loss: 0.5792068
	speed: 0.1011s/iter; left time: 3600.0181s
	iters: 300, epoch: 4 | loss: 0.5433484
	speed: 0.0985s/iter; left time: 3496.8685s
Epoch: 4 cost time: 41.000420570373535
Epoch: 4, Steps: 369 | Train Loss: 0.605 Vali Loss: 0.691 Vali Acc: 0.646 Test Loss: 0.691 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4721736
	speed: 0.4292s/iter; left time: 15161.6607s
	iters: 200, epoch: 5 | loss: 0.7741247
	speed: 0.1219s/iter; left time: 4294.9818s
	iters: 300, epoch: 5 | loss: 0.5406469
	speed: 0.1028s/iter; left time: 3611.4854s
Epoch: 5 cost time: 43.469998598098755
Epoch: 5, Steps: 369 | Train Loss: 0.571 Vali Loss: 0.630 Vali Acc: 0.660 Test Loss: 0.630 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3729127
	speed: 0.3943s/iter; left time: 13783.2308s
	iters: 200, epoch: 6 | loss: 0.6943547
	speed: 0.1181s/iter; left time: 4117.8112s
	iters: 300, epoch: 6 | loss: 0.4576675
	speed: 0.1087s/iter; left time: 3778.6522s
Epoch: 6 cost time: 42.61872887611389
Epoch: 6, Steps: 369 | Train Loss: 0.523 Vali Loss: 0.643 Vali Acc: 0.662 Test Loss: 0.643 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6017436
	speed: 0.3701s/iter; left time: 12802.1470s
	iters: 200, epoch: 7 | loss: 0.2617955
	speed: 0.0957s/iter; left time: 3299.5855s
	iters: 300, epoch: 7 | loss: 0.5505599
	speed: 0.1082s/iter; left time: 3720.5659s
Epoch: 7 cost time: 36.768576860427856
Epoch: 7, Steps: 369 | Train Loss: 0.483 Vali Loss: 0.737 Vali Acc: 0.646 Test Loss: 0.737 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2816991
	speed: 0.3988s/iter; left time: 13645.0033s
	iters: 200, epoch: 8 | loss: 0.4193471
	speed: 0.1129s/iter; left time: 3850.6234s
	iters: 300, epoch: 8 | loss: 0.4973210
	speed: 0.1116s/iter; left time: 3794.9719s
Epoch: 8 cost time: 44.80553412437439
Epoch: 8, Steps: 369 | Train Loss: 0.444 Vali Loss: 0.693 Vali Acc: 0.673 Test Loss: 0.693 Test Acc: 0.673
Validation loss decreased (-0.662876 --> -0.673376).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1679913
	speed: 0.4234s/iter; left time: 14331.9406s
	iters: 200, epoch: 9 | loss: 0.2895949
	speed: 0.1218s/iter; left time: 4110.4125s
	iters: 300, epoch: 9 | loss: 0.5879970
	speed: 0.1012s/iter; left time: 3406.3390s
Epoch: 9 cost time: 40.172119140625
Epoch: 9, Steps: 369 | Train Loss: 0.426 Vali Loss: 0.705 Vali Acc: 0.662 Test Loss: 0.705 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.8690786
	speed: 0.4261s/iter; left time: 14267.1679s
	iters: 200, epoch: 10 | loss: 0.5078954
	speed: 0.1264s/iter; left time: 4217.7359s
	iters: 300, epoch: 10 | loss: 0.4382665
	speed: 0.0977s/iter; left time: 3250.8702s
Epoch: 10 cost time: 44.17665886878967
Epoch: 10, Steps: 369 | Train Loss: 0.391 Vali Loss: 0.755 Vali Acc: 0.653 Test Loss: 0.755 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2210388
	speed: 0.4378s/iter; left time: 14495.5852s
	iters: 200, epoch: 11 | loss: 0.3426412
	speed: 0.1263s/iter; left time: 4168.5085s
	iters: 300, epoch: 11 | loss: 0.4576032
	speed: 0.0849s/iter; left time: 2795.1635s
Epoch: 11 cost time: 40.8655161857605
Epoch: 11, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.894 Vali Acc: 0.649 Test Loss: 0.894 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1996901
	speed: 0.3900s/iter; left time: 12769.8592s
	iters: 200, epoch: 12 | loss: 0.3195087
	speed: 0.1065s/iter; left time: 3475.3892s
	iters: 300, epoch: 12 | loss: 0.3400820
	speed: 0.0961s/iter; left time: 3125.9345s
Epoch: 12 cost time: 41.604016065597534
Epoch: 12, Steps: 369 | Train Loss: 0.346 Vali Loss: 0.751 Vali Acc: 0.649 Test Loss: 0.751 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2101105
	speed: 0.4007s/iter; left time: 12970.2550s
	iters: 200, epoch: 13 | loss: 0.4169959
	speed: 0.1156s/iter; left time: 3729.4123s
	iters: 300, epoch: 13 | loss: 0.3485060
	speed: 0.1290s/iter; left time: 4150.6969s
Epoch: 13 cost time: 44.502042293548584
Epoch: 13, Steps: 369 | Train Loss: 0.328 Vali Loss: 0.854 Vali Acc: 0.658 Test Loss: 0.854 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.3597761
	speed: 0.4039s/iter; left time: 12925.9714s
	iters: 200, epoch: 14 | loss: 0.7555190
	speed: 0.1169s/iter; left time: 3728.5355s
	iters: 300, epoch: 14 | loss: 0.2384332
	speed: 0.1121s/iter; left time: 3566.7634s
Epoch: 14 cost time: 41.32466745376587
Epoch: 14, Steps: 369 | Train Loss: 0.301 Vali Loss: 0.922 Vali Acc: 0.657 Test Loss: 0.922 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.3453879
	speed: 0.4112s/iter; left time: 13008.0318s
	iters: 200, epoch: 15 | loss: 0.2189377
	speed: 0.1062s/iter; left time: 3350.4445s
	iters: 300, epoch: 15 | loss: 0.1112484
	speed: 0.1000s/iter; left time: 3142.6178s
Epoch: 15 cost time: 39.582797050476074
Epoch: 15, Steps: 369 | Train Loss: 0.287 Vali Loss: 0.824 Vali Acc: 0.653 Test Loss: 0.824 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.4513172
	speed: 0.3758s/iter; left time: 11748.9857s
	iters: 200, epoch: 16 | loss: 0.1333760
	speed: 0.0994s/iter; left time: 3098.7265s
	iters: 300, epoch: 16 | loss: 0.4488355
	speed: 0.0992s/iter; left time: 3080.6018s
Epoch: 16 cost time: 40.52664875984192
Epoch: 16, Steps: 369 | Train Loss: 0.259 Vali Loss: 0.868 Vali Acc: 0.667 Test Loss: 0.868 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0183309
	speed: 0.4065s/iter; left time: 12560.3286s
	iters: 200, epoch: 17 | loss: 0.3340806
	speed: 0.1245s/iter; left time: 3833.5066s
	iters: 300, epoch: 17 | loss: 0.1429133
	speed: 0.1110s/iter; left time: 3407.1492s
Epoch: 17 cost time: 42.355839252471924
Epoch: 17, Steps: 369 | Train Loss: 0.221 Vali Loss: 1.191 Vali Acc: 0.652 Test Loss: 1.191 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0604948
	speed: 0.4001s/iter; left time: 12215.4941s
	iters: 200, epoch: 18 | loss: 0.1180014
	speed: 0.1094s/iter; left time: 3329.6862s
	iters: 300, epoch: 18 | loss: 0.2825029
	speed: 0.1085s/iter; left time: 3290.9796s
Epoch: 18 cost time: 41.71732473373413
Epoch: 18, Steps: 369 | Train Loss: 0.230 Vali Loss: 1.145 Vali Acc: 0.651 Test Loss: 1.145 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6733825198637912
model parameter : 636658
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7634433
	speed: 0.1294s/iter; left time: 4762.6860s
	iters: 200, epoch: 1 | loss: 0.7677540
	speed: 0.0935s/iter; left time: 3432.2790s
	iters: 300, epoch: 1 | loss: 1.1406859
	speed: 0.1076s/iter; left time: 3938.8528s
Epoch: 1 cost time: 41.765509605407715
Epoch: 1, Steps: 369 | Train Loss: 0.728 Vali Loss: 0.749 Vali Acc: 0.612 Test Loss: 0.749 Test Acc: 0.612
Validation loss decreased (inf --> -0.611514).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3938766
	speed: 0.3903s/iter; left time: 14218.6167s
	iters: 200, epoch: 2 | loss: 0.4130478
	speed: 0.1096s/iter; left time: 3983.0318s
	iters: 300, epoch: 2 | loss: 0.5256563
	speed: 0.0942s/iter; left time: 3414.6113s
Epoch: 2 cost time: 38.40165328979492
Epoch: 2, Steps: 369 | Train Loss: 0.658 Vali Loss: 0.988 Vali Acc: 0.540 Test Loss: 0.988 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4319167
	speed: 0.3691s/iter; left time: 13309.7387s
	iters: 200, epoch: 3 | loss: 1.3544924
	speed: 0.1064s/iter; left time: 3824.7420s
	iters: 300, epoch: 3 | loss: 0.5638605
	speed: 0.1038s/iter; left time: 3721.8792s
Epoch: 3 cost time: 39.22909116744995
Epoch: 3, Steps: 369 | Train Loss: 0.657 Vali Loss: 0.678 Vali Acc: 0.635 Test Loss: 0.678 Test Acc: 0.635
Validation loss decreased (-0.611514 --> -0.634783).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4413132
	speed: 0.3662s/iter; left time: 13070.6116s
	iters: 200, epoch: 4 | loss: 0.3929736
	speed: 0.0957s/iter; left time: 3404.8020s
	iters: 300, epoch: 4 | loss: 0.3731976
	speed: 0.0977s/iter; left time: 3468.4037s
Epoch: 4 cost time: 38.489633083343506
Epoch: 4, Steps: 369 | Train Loss: 0.596 Vali Loss: 0.706 Vali Acc: 0.655 Test Loss: 0.706 Test Acc: 0.655
Validation loss decreased (-0.634783 --> -0.654931).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4145829
	speed: 0.3530s/iter; left time: 12470.1286s
	iters: 200, epoch: 5 | loss: 0.3783596
	speed: 0.1024s/iter; left time: 3607.7032s
	iters: 300, epoch: 5 | loss: 0.6396394
	speed: 0.0967s/iter; left time: 3398.2715s
Epoch: 5 cost time: 38.13160014152527
Epoch: 5, Steps: 369 | Train Loss: 0.552 Vali Loss: 0.652 Vali Acc: 0.639 Test Loss: 0.652 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4694957
	speed: 0.3515s/iter; left time: 12288.7777s
	iters: 200, epoch: 6 | loss: 0.4769714
	speed: 0.0854s/iter; left time: 2975.0674s
	iters: 300, epoch: 6 | loss: 0.5422593
	speed: 0.1182s/iter; left time: 4106.7599s
Epoch: 6 cost time: 37.35662269592285
Epoch: 6, Steps: 369 | Train Loss: 0.498 Vali Loss: 0.638 Vali Acc: 0.653 Test Loss: 0.638 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4811184
	speed: 0.4005s/iter; left time: 13851.8909s
	iters: 200, epoch: 7 | loss: 0.6664007
	speed: 0.1152s/iter; left time: 3971.7399s
	iters: 300, epoch: 7 | loss: 0.4450650
	speed: 0.1126s/iter; left time: 3873.1612s
Epoch: 7 cost time: 42.52951741218567
Epoch: 7, Steps: 369 | Train Loss: 0.470 Vali Loss: 0.756 Vali Acc: 0.628 Test Loss: 0.756 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4450959
	speed: 0.3764s/iter; left time: 12878.7710s
	iters: 200, epoch: 8 | loss: 0.3374383
	speed: 0.1076s/iter; left time: 3670.1438s
	iters: 300, epoch: 8 | loss: 0.3035043
	speed: 0.0930s/iter; left time: 3164.0614s
Epoch: 8 cost time: 38.115559101104736
Epoch: 8, Steps: 369 | Train Loss: 0.456 Vali Loss: 0.689 Vali Acc: 0.675 Test Loss: 0.689 Test Acc: 0.675
Validation loss decreased (-0.654931 --> -0.674511).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4033488
	speed: 0.3537s/iter; left time: 11972.7845s
	iters: 200, epoch: 9 | loss: 0.3963522
	speed: 0.1095s/iter; left time: 3695.8399s
	iters: 300, epoch: 9 | loss: 0.3027017
	speed: 0.1130s/iter; left time: 3802.7334s
Epoch: 9 cost time: 40.159343957901
Epoch: 9, Steps: 369 | Train Loss: 0.434 Vali Loss: 0.654 Vali Acc: 0.667 Test Loss: 0.654 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3893486
	speed: 0.3873s/iter; left time: 12967.5559s
	iters: 200, epoch: 10 | loss: 0.5186281
	speed: 0.1047s/iter; left time: 3495.4105s
	iters: 300, epoch: 10 | loss: 0.3112428
	speed: 0.0940s/iter; left time: 3129.3450s
Epoch: 10 cost time: 39.782684326171875
Epoch: 10, Steps: 369 | Train Loss: 0.409 Vali Loss: 0.720 Vali Acc: 0.660 Test Loss: 0.720 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.4034429
	speed: 0.3758s/iter; left time: 12444.6850s
	iters: 200, epoch: 11 | loss: 0.4828030
	speed: 0.1064s/iter; left time: 3511.1477s
	iters: 300, epoch: 11 | loss: 0.1662846
	speed: 0.1030s/iter; left time: 3389.9417s
Epoch: 11 cost time: 40.025848150253296
Epoch: 11, Steps: 369 | Train Loss: 0.385 Vali Loss: 0.739 Vali Acc: 0.655 Test Loss: 0.739 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.3873929
	speed: 0.3886s/iter; left time: 12723.1197s
	iters: 200, epoch: 12 | loss: 0.1196847
	speed: 0.1160s/iter; left time: 3786.6991s
	iters: 300, epoch: 12 | loss: 0.4748183
	speed: 0.1181s/iter; left time: 3842.2758s
Epoch: 12 cost time: 41.98288893699646
Epoch: 12, Steps: 369 | Train Loss: 0.360 Vali Loss: 0.778 Vali Acc: 0.661 Test Loss: 0.778 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2376466
	speed: 0.3674s/iter; left time: 11893.1009s
	iters: 200, epoch: 13 | loss: 0.0994511
	speed: 0.0898s/iter; left time: 2897.3115s
	iters: 300, epoch: 13 | loss: 0.2009304
	speed: 0.0904s/iter; left time: 2908.0950s
Epoch: 13 cost time: 34.83458948135376
Epoch: 13, Steps: 369 | Train Loss: 0.349 Vali Loss: 0.856 Vali Acc: 0.665 Test Loss: 0.856 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.2131655
	speed: 0.3515s/iter; left time: 11250.3108s
	iters: 200, epoch: 14 | loss: 0.1967562
	speed: 0.1124s/iter; left time: 3585.0142s
	iters: 300, epoch: 14 | loss: 0.3038629
	speed: 0.0957s/iter; left time: 3043.1749s
Epoch: 14 cost time: 39.90752553939819
Epoch: 14, Steps: 369 | Train Loss: 0.323 Vali Loss: 0.842 Vali Acc: 0.649 Test Loss: 0.842 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.2491024
	speed: 0.3604s/iter; left time: 11400.1680s
	iters: 200, epoch: 15 | loss: 0.8200712
	speed: 0.0933s/iter; left time: 2941.3761s
	iters: 300, epoch: 15 | loss: 0.3322088
	speed: 0.0777s/iter; left time: 2443.0571s
Epoch: 15 cost time: 33.18557953834534
Epoch: 15, Steps: 369 | Train Loss: 0.294 Vali Loss: 0.906 Vali Acc: 0.665 Test Loss: 0.906 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.3626025
	speed: 0.3400s/iter; left time: 10630.2091s
	iters: 200, epoch: 16 | loss: 0.2422673
	speed: 0.1080s/iter; left time: 3366.7885s
	iters: 300, epoch: 16 | loss: 0.5230535
	speed: 0.1022s/iter; left time: 3174.9691s
Epoch: 16 cost time: 39.45901346206665
Epoch: 16, Steps: 369 | Train Loss: 0.270 Vali Loss: 1.006 Vali Acc: 0.638 Test Loss: 1.006 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.2077932
	speed: 0.3694s/iter; left time: 11414.0937s
	iters: 200, epoch: 17 | loss: 0.0671098
	speed: 0.0888s/iter; left time: 2734.5765s
	iters: 300, epoch: 17 | loss: 0.2172707
	speed: 0.1057s/iter; left time: 3245.7858s
Epoch: 17 cost time: 39.51065802574158
Epoch: 17, Steps: 369 | Train Loss: 0.248 Vali Loss: 1.036 Vali Acc: 0.652 Test Loss: 1.036 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.3850380
	speed: 0.3638s/iter; left time: 11106.2033s
	iters: 200, epoch: 18 | loss: 0.0400467
	speed: 0.0970s/iter; left time: 2952.0554s
	iters: 300, epoch: 18 | loss: 0.4476845
	speed: 0.0868s/iter; left time: 2632.7531s
Epoch: 18 cost time: 35.74997663497925
Epoch: 18, Steps: 369 | Train Loss: 0.225 Vali Loss: 1.056 Vali Acc: 0.651 Test Loss: 1.056 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6745175936435869
model parameter : 636306
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7978563
	speed: 0.1302s/iter; left time: 4791.6356s
	iters: 200, epoch: 1 | loss: 0.7165310
	speed: 0.1089s/iter; left time: 3995.1404s
	iters: 300, epoch: 1 | loss: 0.6898052
	speed: 0.0877s/iter; left time: 3208.7979s
Epoch: 1 cost time: 38.40674448013306
Epoch: 1, Steps: 369 | Train Loss: 0.751 Vali Loss: 0.757 Vali Acc: 0.621 Test Loss: 0.757 Test Acc: 0.621
Validation loss decreased (inf --> -0.620594).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8785266
	speed: 0.3517s/iter; left time: 12814.6947s
	iters: 200, epoch: 2 | loss: 0.7837501
	speed: 0.1038s/iter; left time: 3770.8339s
	iters: 300, epoch: 2 | loss: 0.7302681
	speed: 0.1174s/iter; left time: 4254.5987s
Epoch: 2 cost time: 41.03692626953125
Epoch: 2, Steps: 369 | Train Loss: 0.641 Vali Loss: 0.646 Vali Acc: 0.663 Test Loss: 0.646 Test Acc: 0.663
Validation loss decreased (-0.620594 --> -0.663444).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0658994
	speed: 0.3569s/iter; left time: 12870.2044s
	iters: 200, epoch: 3 | loss: 0.3205960
	speed: 0.0815s/iter; left time: 2930.1672s
	iters: 300, epoch: 3 | loss: 0.3580832
	speed: 0.0905s/iter; left time: 3246.9311s
Epoch: 3 cost time: 34.9456992149353
Epoch: 3, Steps: 369 | Train Loss: 0.613 Vali Loss: 0.689 Vali Acc: 0.668 Test Loss: 0.689 Test Acc: 0.668
Validation loss decreased (-0.663444 --> -0.667700).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7583514
	speed: 0.3669s/iter; left time: 13094.9661s
	iters: 200, epoch: 4 | loss: 0.6284607
	speed: 0.1132s/iter; left time: 4030.8967s
	iters: 300, epoch: 4 | loss: 0.5559165
	speed: 0.1024s/iter; left time: 3635.9739s
Epoch: 4 cost time: 40.643250942230225
Epoch: 4, Steps: 369 | Train Loss: 0.589 Vali Loss: 0.636 Vali Acc: 0.671 Test Loss: 0.636 Test Acc: 0.671
Validation loss decreased (-0.667700 --> -0.671106).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5017033
	speed: 0.3546s/iter; left time: 12527.0253s
	iters: 200, epoch: 5 | loss: 0.5477003
	speed: 0.1063s/iter; left time: 3743.8581s
	iters: 300, epoch: 5 | loss: 0.6942603
	speed: 0.1004s/iter; left time: 3524.9356s
Epoch: 5 cost time: 37.805828332901
Epoch: 5, Steps: 369 | Train Loss: 0.553 Vali Loss: 0.621 Vali Acc: 0.673 Test Loss: 0.621 Test Acc: 0.673
Validation loss decreased (-0.671106 --> -0.672525).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5709668
	speed: 0.3320s/iter; left time: 11606.3000s
	iters: 200, epoch: 6 | loss: 0.6227885
	speed: 0.0922s/iter; left time: 3214.0340s
	iters: 300, epoch: 6 | loss: 0.7359470
	speed: 0.1170s/iter; left time: 4066.7232s
Epoch: 6 cost time: 37.615572452545166
Epoch: 6, Steps: 369 | Train Loss: 0.502 Vali Loss: 0.723 Vali Acc: 0.644 Test Loss: 0.723 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4379111
	speed: 0.3724s/iter; left time: 12880.0715s
	iters: 200, epoch: 7 | loss: 0.5379234
	speed: 0.0994s/iter; left time: 3426.3596s
	iters: 300, epoch: 7 | loss: 0.5931572
	speed: 0.1090s/iter; left time: 3746.8396s
Epoch: 7 cost time: 37.20661783218384
Epoch: 7, Steps: 369 | Train Loss: 0.474 Vali Loss: 0.634 Vali Acc: 0.671 Test Loss: 0.634 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.5531338
	speed: 0.3657s/iter; left time: 12512.1814s
	iters: 200, epoch: 8 | loss: 0.4008638
	speed: 0.1117s/iter; left time: 3809.3177s
	iters: 300, epoch: 8 | loss: 0.4744963
	speed: 0.1034s/iter; left time: 3516.6952s
Epoch: 8 cost time: 41.159077644348145
Epoch: 8, Steps: 369 | Train Loss: 0.443 Vali Loss: 0.688 Vali Acc: 0.680 Test Loss: 0.688 Test Acc: 0.680
Validation loss decreased (-0.672525 --> -0.679902).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3696310
	speed: 0.3717s/iter; left time: 12582.4249s
	iters: 200, epoch: 9 | loss: 0.4897005
	speed: 0.1009s/iter; left time: 3404.1062s
	iters: 300, epoch: 9 | loss: 0.1767854
	speed: 0.0987s/iter; left time: 3322.0781s
Epoch: 9 cost time: 38.023630142211914
Epoch: 9, Steps: 369 | Train Loss: 0.415 Vali Loss: 0.711 Vali Acc: 0.653 Test Loss: 0.711 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2595387
	speed: 0.3737s/iter; left time: 12510.5821s
	iters: 200, epoch: 10 | loss: 0.2683617
	speed: 0.1077s/iter; left time: 3595.5149s
	iters: 300, epoch: 10 | loss: 0.5872316
	speed: 0.0887s/iter; left time: 2951.3800s
Epoch: 10 cost time: 38.49784469604492
Epoch: 10, Steps: 369 | Train Loss: 0.390 Vali Loss: 0.721 Vali Acc: 0.659 Test Loss: 0.721 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1967850
	speed: 0.3488s/iter; left time: 11550.0258s
	iters: 200, epoch: 11 | loss: 0.1663972
	speed: 0.0879s/iter; left time: 2901.2756s
	iters: 300, epoch: 11 | loss: 0.2185104
	speed: 0.0973s/iter; left time: 3201.4091s
Epoch: 11 cost time: 34.77925157546997
Epoch: 11, Steps: 369 | Train Loss: 0.368 Vali Loss: 0.841 Vali Acc: 0.657 Test Loss: 0.841 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1790132
	speed: 0.3480s/iter; left time: 11395.5857s
	iters: 200, epoch: 12 | loss: 0.1721836
	speed: 0.0873s/iter; left time: 2849.7821s
	iters: 300, epoch: 12 | loss: 0.3592339
	speed: 0.0843s/iter; left time: 2743.7021s
Epoch: 12 cost time: 35.52679085731506
Epoch: 12, Steps: 369 | Train Loss: 0.348 Vali Loss: 0.811 Vali Acc: 0.672 Test Loss: 0.811 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.4536974
	speed: 0.3449s/iter; left time: 11166.3440s
	iters: 200, epoch: 13 | loss: 0.3449250
	speed: 0.0908s/iter; left time: 2930.1573s
	iters: 300, epoch: 13 | loss: 0.5037315
	speed: 0.1088s/iter; left time: 3498.9760s
Epoch: 13 cost time: 37.27645206451416
Epoch: 13, Steps: 369 | Train Loss: 0.323 Vali Loss: 0.818 Vali Acc: 0.665 Test Loss: 0.818 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.3957791
	speed: 0.3454s/iter; left time: 11055.5513s
	iters: 200, epoch: 14 | loss: 0.2473669
	speed: 0.0995s/iter; left time: 3175.4779s
	iters: 300, epoch: 14 | loss: 0.2864237
	speed: 0.1043s/iter; left time: 3317.7311s
Epoch: 14 cost time: 37.23515248298645
Epoch: 14, Steps: 369 | Train Loss: 0.303 Vali Loss: 0.798 Vali Acc: 0.678 Test Loss: 0.798 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.3612949
	speed: 0.3270s/iter; left time: 10344.5088s
	iters: 200, epoch: 15 | loss: 0.1437590
	speed: 0.0851s/iter; left time: 2682.4355s
	iters: 300, epoch: 15 | loss: 0.1448485
	speed: 0.1050s/iter; left time: 3299.8725s
Epoch: 15 cost time: 35.51878619194031
Epoch: 15, Steps: 369 | Train Loss: 0.267 Vali Loss: 0.902 Vali Acc: 0.659 Test Loss: 0.902 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0989044
	speed: 0.3669s/iter; left time: 11472.8222s
	iters: 200, epoch: 16 | loss: 0.3361565
	speed: 0.1001s/iter; left time: 3118.3135s
	iters: 300, epoch: 16 | loss: 0.2619525
	speed: 0.0983s/iter; left time: 3052.7000s
Epoch: 16 cost time: 38.174591064453125
Epoch: 16, Steps: 369 | Train Loss: 0.258 Vali Loss: 0.901 Vali Acc: 0.672 Test Loss: 0.901 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0997612
	speed: 0.3874s/iter; left time: 11968.9506s
	iters: 200, epoch: 17 | loss: 0.3924501
	speed: 0.1158s/iter; left time: 3565.8835s
	iters: 300, epoch: 17 | loss: 0.0576335
	speed: 0.0883s/iter; left time: 2709.2846s
Epoch: 17 cost time: 39.572633028030396
Epoch: 17, Steps: 369 | Train Loss: 0.238 Vali Loss: 0.884 Vali Acc: 0.658 Test Loss: 0.884 Test Acc: 0.658
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.1710582
	speed: 0.3639s/iter; left time: 11110.0688s
	iters: 200, epoch: 18 | loss: 0.1102375
	speed: 0.0882s/iter; left time: 2684.6529s
	iters: 300, epoch: 18 | loss: 0.2688428
	speed: 0.0929s/iter; left time: 2816.7048s
Epoch: 18 cost time: 35.65995526313782
Epoch: 18, Steps: 369 | Train Loss: 0.208 Vali Loss: 1.152 Vali Acc: 0.663 Test Loss: 1.152 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6799091940976163
model parameter : 635954
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7360468
	speed: 0.1128s/iter; left time: 4152.7336s
	iters: 200, epoch: 1 | loss: 0.6406655
	speed: 0.0913s/iter; left time: 3349.6033s
	iters: 300, epoch: 1 | loss: 0.2758801
	speed: 0.0822s/iter; left time: 3010.2205s
Epoch: 1 cost time: 34.20322823524475
Epoch: 1, Steps: 369 | Train Loss: 0.729 Vali Loss: 0.723 Vali Acc: 0.618 Test Loss: 0.723 Test Acc: 0.618
Validation loss decreased (inf --> -0.618324).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5111074
	speed: 0.3408s/iter; left time: 12415.6705s
	iters: 200, epoch: 2 | loss: 0.8281561
	speed: 0.0946s/iter; left time: 3438.1977s
	iters: 300, epoch: 2 | loss: 0.4469680
	speed: 0.1003s/iter; left time: 3632.7650s
Epoch: 2 cost time: 38.05455255508423
Epoch: 2, Steps: 369 | Train Loss: 0.671 Vali Loss: 0.698 Vali Acc: 0.654 Test Loss: 0.698 Test Acc: 0.654
Validation loss decreased (-0.618324 --> -0.654363).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8615427
	speed: 0.3660s/iter; left time: 13199.1348s
	iters: 200, epoch: 3 | loss: 0.5298543
	speed: 0.1020s/iter; left time: 3668.9196s
	iters: 300, epoch: 3 | loss: 0.5766847
	speed: 0.0944s/iter; left time: 3384.0508s
Epoch: 3 cost time: 36.250946283340454
Epoch: 3, Steps: 369 | Train Loss: 0.620 Vali Loss: 0.823 Vali Acc: 0.545 Test Loss: 0.823 Test Acc: 0.545
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5741027
	speed: 0.3495s/iter; left time: 12475.1052s
	iters: 200, epoch: 4 | loss: 0.5020033
	speed: 0.0826s/iter; left time: 2939.7992s
	iters: 300, epoch: 4 | loss: 0.5471634
	speed: 0.0848s/iter; left time: 3009.8710s
Epoch: 4 cost time: 34.13262748718262
Epoch: 4, Steps: 369 | Train Loss: 0.596 Vali Loss: 0.625 Vali Acc: 0.674 Test Loss: 0.625 Test Acc: 0.674
Validation loss decreased (-0.654363 --> -0.673944).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5244459
	speed: 0.3663s/iter; left time: 12938.3449s
	iters: 200, epoch: 5 | loss: 0.5938125
	speed: 0.0880s/iter; left time: 3099.5915s
	iters: 300, epoch: 5 | loss: 0.6453521
	speed: 0.0845s/iter; left time: 2967.0974s
Epoch: 5 cost time: 33.75305366516113
Epoch: 5, Steps: 369 | Train Loss: 0.541 Vali Loss: 0.641 Vali Acc: 0.682 Test Loss: 0.641 Test Acc: 0.682
Validation loss decreased (-0.673944 --> -0.681605).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3158944
	speed: 0.3595s/iter; left time: 12565.4483s
	iters: 200, epoch: 6 | loss: 0.3594201
	speed: 0.0897s/iter; left time: 3128.0155s
	iters: 300, epoch: 6 | loss: 0.2928239
	speed: 0.0754s/iter; left time: 2620.5925s
Epoch: 6 cost time: 32.312129497528076
Epoch: 6, Steps: 369 | Train Loss: 0.510 Vali Loss: 0.637 Vali Acc: 0.653 Test Loss: 0.637 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6145222
	speed: 0.3290s/iter; left time: 11379.0073s
	iters: 200, epoch: 7 | loss: 0.9366684
	speed: 0.0884s/iter; left time: 3049.9730s
	iters: 300, epoch: 7 | loss: 0.4600755
	speed: 0.0967s/iter; left time: 3324.8410s
Epoch: 7 cost time: 36.772465467453
Epoch: 7, Steps: 369 | Train Loss: 0.476 Vali Loss: 0.667 Vali Acc: 0.652 Test Loss: 0.667 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6383313
	speed: 0.3465s/iter; left time: 11857.7060s
	iters: 200, epoch: 8 | loss: 0.3019907
	speed: 0.0942s/iter; left time: 3214.8763s
	iters: 300, epoch: 8 | loss: 0.5835915
	speed: 0.0958s/iter; left time: 3258.5499s
Epoch: 8 cost time: 35.63679075241089
Epoch: 8, Steps: 369 | Train Loss: 0.454 Vali Loss: 0.704 Vali Acc: 0.644 Test Loss: 0.704 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6158460
	speed: 0.3394s/iter; left time: 11486.8726s
	iters: 200, epoch: 9 | loss: 0.3216532
	speed: 0.1082s/iter; left time: 3650.6270s
	iters: 300, epoch: 9 | loss: 0.4255247
	speed: 0.1063s/iter; left time: 3575.2743s
Epoch: 9 cost time: 37.79563069343567
Epoch: 9, Steps: 369 | Train Loss: 0.423 Vali Loss: 0.750 Vali Acc: 0.677 Test Loss: 0.750 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4305403
	speed: 0.3363s/iter; left time: 11260.3680s
	iters: 200, epoch: 10 | loss: 0.4915429
	speed: 0.0889s/iter; left time: 2967.9336s
	iters: 300, epoch: 10 | loss: 0.6392988
	speed: 0.1022s/iter; left time: 3402.5165s
Epoch: 10 cost time: 36.29975509643555
Epoch: 10, Steps: 369 | Train Loss: 0.402 Vali Loss: 0.765 Vali Acc: 0.662 Test Loss: 0.765 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2557205
	speed: 0.3846s/iter; left time: 12733.1990s
	iters: 200, epoch: 11 | loss: 0.4743168
	speed: 0.1075s/iter; left time: 3550.3062s
	iters: 300, epoch: 11 | loss: 0.4063437
	speed: 0.0876s/iter; left time: 2883.4916s
Epoch: 11 cost time: 39.05533051490784
Epoch: 11, Steps: 369 | Train Loss: 0.381 Vali Loss: 0.835 Vali Acc: 0.646 Test Loss: 0.835 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.4147008
	speed: 0.3367s/iter; left time: 11023.7086s
	iters: 200, epoch: 12 | loss: 0.2014492
	speed: 0.0926s/iter; left time: 3021.6132s
	iters: 300, epoch: 12 | loss: 0.2991370
	speed: 0.1015s/iter; left time: 3304.6184s
Epoch: 12 cost time: 36.11991214752197
Epoch: 12, Steps: 369 | Train Loss: 0.356 Vali Loss: 0.685 Vali Acc: 0.671 Test Loss: 0.685 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.4109248
	speed: 0.3644s/iter; left time: 11795.5808s
	iters: 200, epoch: 13 | loss: 0.3250371
	speed: 0.0998s/iter; left time: 3221.9716s
	iters: 300, epoch: 13 | loss: 0.1174453
	speed: 0.0902s/iter; left time: 2903.4859s
Epoch: 13 cost time: 37.965330839157104
Epoch: 13, Steps: 369 | Train Loss: 0.330 Vali Loss: 0.770 Vali Acc: 0.647 Test Loss: 0.770 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1360920
	speed: 0.3489s/iter; left time: 11167.6778s
	iters: 200, epoch: 14 | loss: 0.2710406
	speed: 0.0956s/iter; left time: 3049.8963s
	iters: 300, epoch: 14 | loss: 0.2568628
	speed: 0.0905s/iter; left time: 2879.1904s
Epoch: 14 cost time: 36.61365365982056
Epoch: 14, Steps: 369 | Train Loss: 0.311 Vali Loss: 0.796 Vali Acc: 0.668 Test Loss: 0.796 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.2129913
	speed: 0.3322s/iter; left time: 10508.8546s
	iters: 200, epoch: 15 | loss: 0.1344530
	speed: 0.0815s/iter; left time: 2570.3239s
	iters: 300, epoch: 15 | loss: 0.3546828
	speed: 0.0939s/iter; left time: 2952.2707s
Epoch: 15 cost time: 35.394346952438354
Epoch: 15, Steps: 369 | Train Loss: 0.285 Vali Loss: 0.850 Vali Acc: 0.660 Test Loss: 0.850 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6816118047673099
model parameter : 635602
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6976832
	speed: 0.1318s/iter; left time: 4851.5376s
	iters: 200, epoch: 1 | loss: 0.4231734
	speed: 0.0958s/iter; left time: 3515.3435s
	iters: 300, epoch: 1 | loss: 0.7274738
	speed: 0.0948s/iter; left time: 3471.5443s
Epoch: 1 cost time: 38.71624445915222
Epoch: 1, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.711 Vali Acc: 0.628 Test Loss: 0.711 Test Acc: 0.628
Validation loss decreased (inf --> -0.628256).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3676437
	speed: 0.3693s/iter; left time: 13456.1521s
	iters: 200, epoch: 2 | loss: 1.2031072
	speed: 0.0940s/iter; left time: 3415.5288s
	iters: 300, epoch: 2 | loss: 0.5755447
	speed: 0.0920s/iter; left time: 3334.0736s
Epoch: 2 cost time: 35.26785182952881
Epoch: 2, Steps: 369 | Train Loss: 0.613 Vali Loss: 0.679 Vali Acc: 0.671 Test Loss: 0.679 Test Acc: 0.671
Validation loss decreased (-0.628256 --> -0.670538).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0921774
	speed: 0.3322s/iter; left time: 11981.6711s
	iters: 200, epoch: 3 | loss: 0.3571011
	speed: 0.0945s/iter; left time: 3396.9132s
	iters: 300, epoch: 3 | loss: 0.5778391
	speed: 0.0956s/iter; left time: 3429.6960s
Epoch: 3 cost time: 36.34466528892517
Epoch: 3, Steps: 369 | Train Loss: 0.591 Vali Loss: 0.618 Vali Acc: 0.672 Test Loss: 0.618 Test Acc: 0.672
Validation loss decreased (-0.670538 --> -0.672241).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6440271
	speed: 0.3726s/iter; left time: 13298.1201s
	iters: 200, epoch: 4 | loss: 0.6403558
	speed: 0.1054s/iter; left time: 3751.6342s
	iters: 300, epoch: 4 | loss: 0.5642930
	speed: 0.1021s/iter; left time: 3622.6862s
Epoch: 4 cost time: 39.533470153808594
Epoch: 4, Steps: 369 | Train Loss: 0.559 Vali Loss: 0.691 Vali Acc: 0.669 Test Loss: 0.691 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5735235
	speed: 0.3560s/iter; left time: 12577.0734s
	iters: 200, epoch: 5 | loss: 0.4513783
	speed: 0.1025s/iter; left time: 3609.7164s
	iters: 300, epoch: 5 | loss: 0.7018139
	speed: 0.0880s/iter; left time: 3090.5895s
Epoch: 5 cost time: 35.35010886192322
Epoch: 5, Steps: 369 | Train Loss: 0.527 Vali Loss: 0.670 Vali Acc: 0.671 Test Loss: 0.670 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5140115
	speed: 0.3571s/iter; left time: 12481.4857s
	iters: 200, epoch: 6 | loss: 0.3531684
	speed: 0.0971s/iter; left time: 3385.7418s
	iters: 300, epoch: 6 | loss: 0.4850073
	speed: 0.0976s/iter; left time: 3391.1281s
Epoch: 6 cost time: 38.26313257217407
Epoch: 6, Steps: 369 | Train Loss: 0.485 Vali Loss: 0.625 Vali Acc: 0.669 Test Loss: 0.625 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.3790813
	speed: 0.3558s/iter; left time: 12306.5526s
	iters: 200, epoch: 7 | loss: 0.4326325
	speed: 0.1230s/iter; left time: 4240.7628s
	iters: 300, epoch: 7 | loss: 0.8276060
	speed: 0.1320s/iter; left time: 4539.8133s
Epoch: 7 cost time: 45.06647205352783
Epoch: 7, Steps: 369 | Train Loss: 0.438 Vali Loss: 0.641 Vali Acc: 0.686 Test Loss: 0.641 Test Acc: 0.686
Validation loss decreased (-0.672241 --> -0.686429).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7995433
	speed: 0.3435s/iter; left time: 11754.2972s
	iters: 200, epoch: 8 | loss: 0.2921108
	speed: 0.0998s/iter; left time: 3405.3455s
	iters: 300, epoch: 8 | loss: 0.1827830
	speed: 0.0933s/iter; left time: 3173.4190s
Epoch: 8 cost time: 33.11386680603027
Epoch: 8, Steps: 369 | Train Loss: 0.402 Vali Loss: 0.708 Vali Acc: 0.672 Test Loss: 0.708 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3033483
	speed: 0.3403s/iter; left time: 11520.4876s
	iters: 200, epoch: 9 | loss: 0.3295946
	speed: 0.0928s/iter; left time: 3131.3592s
	iters: 300, epoch: 9 | loss: 0.2698940
	speed: 0.1079s/iter; left time: 3630.7337s
Epoch: 9 cost time: 37.8830361366272
Epoch: 9, Steps: 369 | Train Loss: 0.380 Vali Loss: 0.733 Vali Acc: 0.663 Test Loss: 0.733 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1709185
	speed: 0.3441s/iter; left time: 11518.9680s
	iters: 200, epoch: 10 | loss: 0.1287179
	speed: 0.0765s/iter; left time: 2553.0939s
	iters: 300, epoch: 10 | loss: 0.2841622
	speed: 0.0805s/iter; left time: 2679.4155s
Epoch: 10 cost time: 31.920937538146973
Epoch: 10, Steps: 369 | Train Loss: 0.356 Vali Loss: 0.867 Vali Acc: 0.642 Test Loss: 0.867 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.4622457
	speed: 0.3296s/iter; left time: 10913.5685s
	iters: 200, epoch: 11 | loss: 0.3219010
	speed: 0.0921s/iter; left time: 3040.9770s
	iters: 300, epoch: 11 | loss: 0.1942966
	speed: 0.0975s/iter; left time: 3209.1517s
Epoch: 11 cost time: 33.69672679901123
Epoch: 11, Steps: 369 | Train Loss: 0.326 Vali Loss: 0.779 Vali Acc: 0.665 Test Loss: 0.779 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2397116
	speed: 0.3388s/iter; left time: 11094.0984s
	iters: 200, epoch: 12 | loss: 0.4046656
	speed: 0.0835s/iter; left time: 2725.3651s
	iters: 300, epoch: 12 | loss: 0.2044012
	speed: 0.1078s/iter; left time: 3509.2306s
Epoch: 12 cost time: 36.07048463821411
Epoch: 12, Steps: 369 | Train Loss: 0.295 Vali Loss: 0.855 Vali Acc: 0.674 Test Loss: 0.855 Test Acc: 0.674
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1149716
	speed: 0.3576s/iter; left time: 11578.0087s
	iters: 200, epoch: 13 | loss: 0.1499292
	speed: 0.0860s/iter; left time: 2775.5876s
	iters: 300, epoch: 13 | loss: 0.1816328
	speed: 0.0852s/iter; left time: 2742.0546s
Epoch: 13 cost time: 33.542452812194824
Epoch: 13, Steps: 369 | Train Loss: 0.266 Vali Loss: 1.102 Vali Acc: 0.643 Test Loss: 1.102 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1734137
	speed: 0.3381s/iter; left time: 10819.7014s
	iters: 200, epoch: 14 | loss: 0.3735896
	speed: 0.1064s/iter; left time: 3395.1632s
	iters: 300, epoch: 14 | loss: 0.3022527
	speed: 0.1132s/iter; left time: 3599.6753s
Epoch: 14 cost time: 38.643234968185425
Epoch: 14, Steps: 369 | Train Loss: 0.240 Vali Loss: 0.976 Vali Acc: 0.654 Test Loss: 0.976 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1690634
	speed: 0.3547s/iter; left time: 11221.8627s
	iters: 200, epoch: 15 | loss: 0.1323651
	speed: 0.0938s/iter; left time: 2957.1277s
	iters: 300, epoch: 15 | loss: 0.1839598
	speed: 0.0904s/iter; left time: 2841.3405s
Epoch: 15 cost time: 35.26062369346619
Epoch: 15, Steps: 369 | Train Loss: 0.216 Vali Loss: 1.138 Vali Acc: 0.669 Test Loss: 1.138 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2137131
	speed: 0.3530s/iter; left time: 11037.6620s
	iters: 200, epoch: 16 | loss: 0.0544721
	speed: 0.0890s/iter; left time: 2774.9377s
	iters: 300, epoch: 16 | loss: 0.1943544
	speed: 0.0932s/iter; left time: 2894.2074s
Epoch: 16 cost time: 35.736987590789795
Epoch: 16, Steps: 369 | Train Loss: 0.187 Vali Loss: 1.122 Vali Acc: 0.671 Test Loss: 1.122 Test Acc: 0.671
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.4255296
	speed: 0.3380s/iter; left time: 10443.8314s
	iters: 200, epoch: 17 | loss: 0.1806766
	speed: 0.1017s/iter; left time: 3131.9043s
	iters: 300, epoch: 17 | loss: 0.5097712
	speed: 0.0972s/iter; left time: 2983.9314s
Epoch: 17 cost time: 36.231587171554565
Epoch: 17, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.186 Vali Acc: 0.662 Test Loss: 1.186 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6864358683314415
model parameter : 403698
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6496336
	speed: 0.1138s/iter; left time: 4187.3345s
	iters: 200, epoch: 1 | loss: 0.5524075
	speed: 0.0859s/iter; left time: 3152.9433s
	iters: 300, epoch: 1 | loss: 0.8377553
	speed: 0.0769s/iter; left time: 2814.0583s
Epoch: 1 cost time: 32.61697840690613
Epoch: 1, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.763 Vali Acc: 0.638 Test Loss: 0.763 Test Acc: 0.638
Validation loss decreased (inf --> -0.637620).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5346509
	speed: 0.3121s/iter; left time: 11371.0070s
	iters: 200, epoch: 2 | loss: 1.1173259
	speed: 0.0902s/iter; left time: 3276.9889s
	iters: 300, epoch: 2 | loss: 0.4433945
	speed: 0.0977s/iter; left time: 3539.6847s
Epoch: 2 cost time: 36.62531876564026
Epoch: 2, Steps: 369 | Train Loss: 0.671 Vali Loss: 0.720 Vali Acc: 0.651 Test Loss: 0.720 Test Acc: 0.651
Validation loss decreased (-0.637620 --> -0.650674).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9487731
	speed: 0.3385s/iter; left time: 12206.4320s
	iters: 200, epoch: 3 | loss: 0.3980146
	speed: 0.0887s/iter; left time: 3190.6980s
	iters: 300, epoch: 3 | loss: 0.8099192
	speed: 0.0825s/iter; left time: 2958.5874s
Epoch: 3 cost time: 34.48202180862427
Epoch: 3, Steps: 369 | Train Loss: 0.633 Vali Loss: 0.719 Vali Acc: 0.675 Test Loss: 0.719 Test Acc: 0.675
Validation loss decreased (-0.650674 --> -0.675362).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7572002
	speed: 0.3252s/iter; left time: 11608.5439s
	iters: 200, epoch: 4 | loss: 0.2026211
	speed: 0.0926s/iter; left time: 3295.6258s
	iters: 300, epoch: 4 | loss: 0.8910471
	speed: 0.1135s/iter; left time: 4028.8686s
Epoch: 4 cost time: 37.54103231430054
Epoch: 4, Steps: 369 | Train Loss: 0.572 Vali Loss: 0.594 Vali Acc: 0.686 Test Loss: 0.594 Test Acc: 0.686
Validation loss decreased (-0.675362 --> -0.686430).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2658236
	speed: 0.3529s/iter; left time: 12464.9944s
	iters: 200, epoch: 5 | loss: 0.6050870
	speed: 0.0876s/iter; left time: 3084.2913s
	iters: 300, epoch: 5 | loss: 0.4847291
	speed: 0.0873s/iter; left time: 3066.1157s
Epoch: 5 cost time: 34.48395538330078
Epoch: 5, Steps: 369 | Train Loss: 0.527 Vali Loss: 0.639 Vali Acc: 0.657 Test Loss: 0.639 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4510162
	speed: 0.3530s/iter; left time: 12339.0206s
	iters: 200, epoch: 6 | loss: 0.5482135
	speed: 0.1028s/iter; left time: 3581.6738s
	iters: 300, epoch: 6 | loss: 0.2417013
	speed: 0.1050s/iter; left time: 3649.8740s
Epoch: 6 cost time: 38.20082998275757
Epoch: 6, Steps: 369 | Train Loss: 0.477 Vali Loss: 0.705 Vali Acc: 0.648 Test Loss: 0.705 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3795508
	speed: 0.3461s/iter; left time: 11969.0481s
	iters: 200, epoch: 7 | loss: 0.3546807
	speed: 0.0980s/iter; left time: 3380.9486s
	iters: 300, epoch: 7 | loss: 0.2936913
	speed: 0.0962s/iter; left time: 3307.9021s
Epoch: 7 cost time: 34.937164306640625
Epoch: 7, Steps: 369 | Train Loss: 0.445 Vali Loss: 0.713 Vali Acc: 0.657 Test Loss: 0.713 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.3359447
	speed: 0.3515s/iter; left time: 12029.2471s
	iters: 200, epoch: 8 | loss: 0.3844093
	speed: 0.1020s/iter; left time: 3481.3197s
	iters: 300, epoch: 8 | loss: 0.3452587
	speed: 0.0947s/iter; left time: 3222.6922s
Epoch: 8 cost time: 38.32380270957947
Epoch: 8, Steps: 369 | Train Loss: 0.414 Vali Loss: 0.674 Vali Acc: 0.675 Test Loss: 0.674 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.4467109
	speed: 0.3465s/iter; left time: 11729.6612s
	iters: 200, epoch: 9 | loss: 0.1785470
	speed: 0.1011s/iter; left time: 3412.3748s
	iters: 300, epoch: 9 | loss: 0.4292359
	speed: 0.0934s/iter; left time: 3141.6340s
Epoch: 9 cost time: 36.95294761657715
Epoch: 9, Steps: 369 | Train Loss: 0.379 Vali Loss: 0.746 Vali Acc: 0.661 Test Loss: 0.746 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.3116541
	speed: 0.3260s/iter; left time: 10913.7829s
	iters: 200, epoch: 10 | loss: 0.2483228
	speed: 0.0923s/iter; left time: 3082.2186s
	iters: 300, epoch: 10 | loss: 0.3127302
	speed: 0.1001s/iter; left time: 3332.4316s
Epoch: 10 cost time: 34.5642511844635
Epoch: 10, Steps: 369 | Train Loss: 0.355 Vali Loss: 0.739 Vali Acc: 0.659 Test Loss: 0.739 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.2212733
	speed: 0.3273s/iter; left time: 10837.6750s
	iters: 200, epoch: 11 | loss: 0.3814510
	speed: 0.0892s/iter; left time: 2945.6105s
	iters: 300, epoch: 11 | loss: 0.5127124
	speed: 0.1216s/iter; left time: 4001.7432s
Epoch: 11 cost time: 35.30047798156738
Epoch: 11, Steps: 369 | Train Loss: 0.319 Vali Loss: 0.925 Vali Acc: 0.637 Test Loss: 0.925 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.2775226
	speed: 0.3493s/iter; left time: 11437.8621s
	iters: 200, epoch: 12 | loss: 0.3805311
	speed: 0.0823s/iter; left time: 2686.6709s
	iters: 300, epoch: 12 | loss: 0.2604425
	speed: 0.0893s/iter; left time: 2907.0488s
Epoch: 12 cost time: 35.13976526260376
Epoch: 12, Steps: 369 | Train Loss: 0.289 Vali Loss: 0.885 Vali Acc: 0.661 Test Loss: 0.885 Test Acc: 0.661
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1268818
	speed: 0.3474s/iter; left time: 11245.6339s
	iters: 200, epoch: 13 | loss: 0.4309003
	speed: 0.1133s/iter; left time: 3656.5104s
	iters: 300, epoch: 13 | loss: 0.2168073
	speed: 0.1014s/iter; left time: 3262.3833s
Epoch: 13 cost time: 37.591649293899536
Epoch: 13, Steps: 369 | Train Loss: 0.267 Vali Loss: 1.074 Vali Acc: 0.640 Test Loss: 1.074 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0726674
	speed: 0.3293s/iter; left time: 10539.2641s
	iters: 200, epoch: 14 | loss: 0.3162893
	speed: 0.0894s/iter; left time: 2850.6651s
	iters: 300, epoch: 14 | loss: 0.2977917
	speed: 0.0931s/iter; left time: 2961.3772s
Epoch: 14 cost time: 35.12518239021301
Epoch: 14, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.043 Vali Acc: 0.659 Test Loss: 1.043 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6864358683314415
model parameter : 403346
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6855441
	speed: 0.1104s/iter; left time: 4064.0105s
	iters: 200, epoch: 1 | loss: 0.6898507
	speed: 0.0935s/iter; left time: 3430.3400s
	iters: 300, epoch: 1 | loss: 0.6923658
	speed: 0.0927s/iter; left time: 3392.4672s
Epoch: 1 cost time: 36.24506235122681
Epoch: 1, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.790 Vali Acc: 0.607 Test Loss: 0.790 Test Acc: 0.607
Validation loss decreased (inf --> -0.606689).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5875002
	speed: 0.3665s/iter; left time: 13353.4251s
	iters: 200, epoch: 2 | loss: 0.6761304
	speed: 0.0939s/iter; left time: 3412.9010s
	iters: 300, epoch: 2 | loss: 0.7144065
	speed: 0.0785s/iter; left time: 2843.0190s
Epoch: 2 cost time: 36.30266880989075
Epoch: 2, Steps: 369 | Train Loss: 0.622 Vali Loss: 0.696 Vali Acc: 0.638 Test Loss: 0.696 Test Acc: 0.638
Validation loss decreased (-0.606689 --> -0.638472).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6918612
	speed: 0.3239s/iter; left time: 11681.1207s
	iters: 200, epoch: 3 | loss: 0.7673414
	speed: 0.0843s/iter; left time: 3033.0906s
	iters: 300, epoch: 3 | loss: 0.6294958
	speed: 0.0855s/iter; left time: 3067.0683s
Epoch: 3 cost time: 31.549402475357056
Epoch: 3, Steps: 369 | Train Loss: 0.612 Vali Loss: 0.784 Vali Acc: 0.624 Test Loss: 0.784 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9795628
	speed: 0.3306s/iter; left time: 11798.7527s
	iters: 200, epoch: 4 | loss: 0.7670125
	speed: 0.0876s/iter; left time: 3119.6938s
	iters: 300, epoch: 4 | loss: 0.5857903
	speed: 0.0802s/iter; left time: 2845.8701s
Epoch: 4 cost time: 35.27086424827576
Epoch: 4, Steps: 369 | Train Loss: 0.580 Vali Loss: 0.679 Vali Acc: 0.679 Test Loss: 0.679 Test Acc: 0.679
Validation loss decreased (-0.638472 --> -0.679335).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5207415
	speed: 0.3333s/iter; left time: 11772.5408s
	iters: 200, epoch: 5 | loss: 0.4333382
	speed: 0.0920s/iter; left time: 3240.0476s
	iters: 300, epoch: 5 | loss: 0.5974646
	speed: 0.1061s/iter; left time: 3727.7656s
Epoch: 5 cost time: 36.91285967826843
Epoch: 5, Steps: 369 | Train Loss: 0.520 Vali Loss: 0.743 Vali Acc: 0.613 Test Loss: 0.743 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4131507
	speed: 0.3188s/iter; left time: 11145.1538s
	iters: 200, epoch: 6 | loss: 0.3293476
	speed: 0.0763s/iter; left time: 2660.1605s
	iters: 300, epoch: 6 | loss: 0.4564375
	speed: 0.1014s/iter; left time: 3524.9353s
Epoch: 6 cost time: 31.65152406692505
Epoch: 6, Steps: 369 | Train Loss: 0.483 Vali Loss: 0.654 Vali Acc: 0.665 Test Loss: 0.654 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.0539923
	speed: 0.3268s/iter; left time: 11302.8596s
	iters: 200, epoch: 7 | loss: 0.3892443
	speed: 0.0887s/iter; left time: 3060.6996s
	iters: 300, epoch: 7 | loss: 0.6147731
	speed: 0.0821s/iter; left time: 2821.7379s
Epoch: 7 cost time: 34.99268198013306
Epoch: 7, Steps: 369 | Train Loss: 0.445 Vali Loss: 0.742 Vali Acc: 0.656 Test Loss: 0.742 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.3486246
	speed: 0.3252s/iter; left time: 11128.2018s
	iters: 200, epoch: 8 | loss: 0.4521060
	speed: 0.0847s/iter; left time: 2890.1266s
	iters: 300, epoch: 8 | loss: 0.4872204
	speed: 0.0947s/iter; left time: 3222.0856s
Epoch: 8 cost time: 32.76747369766235
Epoch: 8, Steps: 369 | Train Loss: 0.412 Vali Loss: 0.720 Vali Acc: 0.676 Test Loss: 0.720 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3211084
	speed: 0.3443s/iter; left time: 11655.4882s
	iters: 200, epoch: 9 | loss: 0.5876980
	speed: 0.1089s/iter; left time: 3676.9368s
	iters: 300, epoch: 9 | loss: 0.2475965
	speed: 0.0930s/iter; left time: 3129.6197s
Epoch: 9 cost time: 38.02504563331604
Epoch: 9, Steps: 369 | Train Loss: 0.384 Vali Loss: 0.707 Vali Acc: 0.671 Test Loss: 0.707 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.4216810
	speed: 0.3183s/iter; left time: 10657.4008s
	iters: 200, epoch: 10 | loss: 0.5368174
	speed: 0.0931s/iter; left time: 3108.0640s
	iters: 300, epoch: 10 | loss: 0.2817963
	speed: 0.0897s/iter; left time: 2986.2016s
Epoch: 10 cost time: 34.69338512420654
Epoch: 10, Steps: 369 | Train Loss: 0.345 Vali Loss: 0.725 Vali Acc: 0.669 Test Loss: 0.725 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1906942
	speed: 0.3274s/iter; left time: 10840.2841s
	iters: 200, epoch: 11 | loss: 0.6171339
	speed: 0.1012s/iter; left time: 3339.4671s
	iters: 300, epoch: 11 | loss: 0.4653309
	speed: 0.0987s/iter; left time: 3247.0346s
Epoch: 11 cost time: 37.41683387756348
Epoch: 11, Steps: 369 | Train Loss: 0.330 Vali Loss: 0.740 Vali Acc: 0.666 Test Loss: 0.740 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0657626
	speed: 0.3075s/iter; left time: 10069.2852s
	iters: 200, epoch: 12 | loss: 0.3054465
	speed: 0.0910s/iter; left time: 2969.4410s
	iters: 300, epoch: 12 | loss: 0.4129458
	speed: 0.0915s/iter; left time: 2978.2724s
Epoch: 12 cost time: 34.84799361228943
Epoch: 12, Steps: 369 | Train Loss: 0.293 Vali Loss: 0.893 Vali Acc: 0.655 Test Loss: 0.893 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1128900
	speed: 0.3254s/iter; left time: 10533.7128s
	iters: 200, epoch: 13 | loss: 0.3004523
	speed: 0.0983s/iter; left time: 3173.3821s
	iters: 300, epoch: 13 | loss: 0.4163229
	speed: 0.0876s/iter; left time: 2818.0627s
Epoch: 13 cost time: 33.14352512359619
Epoch: 13, Steps: 369 | Train Loss: 0.264 Vali Loss: 0.940 Vali Acc: 0.647 Test Loss: 0.940 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.2568654
	speed: 0.3207s/iter; left time: 10264.3038s
	iters: 200, epoch: 14 | loss: 0.0514619
	speed: 0.0783s/iter; left time: 2498.4522s
	iters: 300, epoch: 14 | loss: 0.0779918
	speed: 0.0992s/iter; left time: 3155.2399s
Epoch: 14 cost time: 36.0088267326355
Epoch: 14, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.160 Vali Acc: 0.648 Test Loss: 1.160 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6793416572077186
model parameter : 402994
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7049002
	speed: 0.1169s/iter; left time: 4300.3481s
	iters: 200, epoch: 1 | loss: 0.8186628
	speed: 0.0893s/iter; left time: 3278.1367s
	iters: 300, epoch: 1 | loss: 0.3187077
	speed: 0.1036s/iter; left time: 3791.4161s
Epoch: 1 cost time: 38.915783405303955
Epoch: 1, Steps: 369 | Train Loss: 0.732 Vali Loss: 0.773 Vali Acc: 0.640 Test Loss: 0.773 Test Acc: 0.640
Validation loss decreased (inf --> -0.639606).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9722248
	speed: 0.3351s/iter; left time: 12207.6157s
	iters: 200, epoch: 2 | loss: 0.4884132
	speed: 0.0986s/iter; left time: 3581.7595s
	iters: 300, epoch: 2 | loss: 0.8623624
	speed: 0.0899s/iter; left time: 3256.5199s
Epoch: 2 cost time: 33.92331027984619
Epoch: 2, Steps: 369 | Train Loss: 0.697 Vali Loss: 0.706 Vali Acc: 0.627 Test Loss: 0.706 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4789006
	speed: 0.3132s/iter; left time: 11294.8289s
	iters: 200, epoch: 3 | loss: 0.6580796
	speed: 0.1004s/iter; left time: 3610.1893s
	iters: 300, epoch: 3 | loss: 0.5002286
	speed: 0.0977s/iter; left time: 3504.9548s
Epoch: 3 cost time: 36.546778440475464
Epoch: 3, Steps: 369 | Train Loss: 0.647 Vali Loss: 0.726 Vali Acc: 0.635 Test Loss: 0.726 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6034192
	speed: 0.3186s/iter; left time: 11370.9912s
	iters: 200, epoch: 4 | loss: 0.2726077
	speed: 0.0789s/iter; left time: 2808.2216s
	iters: 300, epoch: 4 | loss: 0.4081543
	speed: 0.0777s/iter; left time: 2757.6863s
Epoch: 4 cost time: 30.808929204940796
Epoch: 4, Steps: 369 | Train Loss: 0.554 Vali Loss: 0.651 Vali Acc: 0.657 Test Loss: 0.651 Test Acc: 0.657
Validation loss decreased (-0.639606 --> -0.657201).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7797716
	speed: 0.3360s/iter; left time: 11870.0223s
	iters: 200, epoch: 5 | loss: 0.3055482
	speed: 0.1097s/iter; left time: 3864.6348s
	iters: 300, epoch: 5 | loss: 0.6296096
	speed: 0.0864s/iter; left time: 3033.8526s
Epoch: 5 cost time: 35.448418378829956
Epoch: 5, Steps: 369 | Train Loss: 0.515 Vali Loss: 0.601 Vali Acc: 0.684 Test Loss: 0.601 Test Acc: 0.684
Validation loss decreased (-0.657201 --> -0.684160).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5865723
	speed: 0.3076s/iter; left time: 10750.9279s
	iters: 200, epoch: 6 | loss: 0.8391460
	speed: 0.0811s/iter; left time: 2826.0243s
	iters: 300, epoch: 6 | loss: 0.4023795
	speed: 0.0918s/iter; left time: 3189.6519s
Epoch: 6 cost time: 32.787386894226074
Epoch: 6, Steps: 369 | Train Loss: 0.480 Vali Loss: 0.654 Vali Acc: 0.664 Test Loss: 0.654 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4225168
	speed: 0.3372s/iter; left time: 11664.1632s
	iters: 200, epoch: 7 | loss: 0.2537876
	speed: 0.0946s/iter; left time: 3263.1405s
	iters: 300, epoch: 7 | loss: 0.4053527
	speed: 0.0830s/iter; left time: 2853.1422s
Epoch: 7 cost time: 34.03452229499817
Epoch: 7, Steps: 369 | Train Loss: 0.451 Vali Loss: 0.669 Vali Acc: 0.673 Test Loss: 0.669 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4153974
	speed: 0.3201s/iter; left time: 10953.1647s
	iters: 200, epoch: 8 | loss: 0.3904802
	speed: 0.0903s/iter; left time: 3082.2364s
	iters: 300, epoch: 8 | loss: 0.3316061
	speed: 0.1057s/iter; left time: 3594.1614s
Epoch: 8 cost time: 36.22255277633667
Epoch: 8, Steps: 369 | Train Loss: 0.418 Vali Loss: 0.684 Vali Acc: 0.663 Test Loss: 0.684 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4065191
	speed: 0.3247s/iter; left time: 10989.4893s
	iters: 200, epoch: 9 | loss: 0.2173095
	speed: 0.0905s/iter; left time: 3053.8785s
	iters: 300, epoch: 9 | loss: 0.3360742
	speed: 0.0979s/iter; left time: 3293.6097s
Epoch: 9 cost time: 34.440245628356934
Epoch: 9, Steps: 369 | Train Loss: 0.392 Vali Loss: 0.694 Vali Acc: 0.677 Test Loss: 0.694 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4260080
	speed: 0.3319s/iter; left time: 11111.5205s
	iters: 200, epoch: 10 | loss: 0.4488786
	speed: 0.0751s/iter; left time: 2506.3369s
	iters: 300, epoch: 10 | loss: 0.4340768
	speed: 0.0908s/iter; left time: 3022.9095s
Epoch: 10 cost time: 32.59375834465027
Epoch: 10, Steps: 369 | Train Loss: 0.361 Vali Loss: 0.832 Vali Acc: 0.652 Test Loss: 0.832 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4730032
	speed: 0.3298s/iter; left time: 10920.6422s
	iters: 200, epoch: 11 | loss: 0.2764305
	speed: 0.0879s/iter; left time: 2902.7720s
	iters: 300, epoch: 11 | loss: 0.2921419
	speed: 0.0805s/iter; left time: 2650.6445s
Epoch: 11 cost time: 31.59589409828186
Epoch: 11, Steps: 369 | Train Loss: 0.342 Vali Loss: 0.778 Vali Acc: 0.659 Test Loss: 0.778 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3450040
	speed: 0.3140s/iter; left time: 10279.5541s
	iters: 200, epoch: 12 | loss: 0.4217821
	speed: 0.0990s/iter; left time: 3230.6375s
	iters: 300, epoch: 12 | loss: 0.3366702
	speed: 0.0899s/iter; left time: 2924.3318s
Epoch: 12 cost time: 33.95853662490845
Epoch: 12, Steps: 369 | Train Loss: 0.306 Vali Loss: 0.824 Vali Acc: 0.662 Test Loss: 0.824 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0917201
	speed: 0.3025s/iter; left time: 9792.1818s
	iters: 200, epoch: 13 | loss: 0.4555115
	speed: 0.0782s/iter; left time: 2523.1406s
	iters: 300, epoch: 13 | loss: 0.2678724
	speed: 0.0795s/iter; left time: 2557.2361s
Epoch: 13 cost time: 31.519099712371826
Epoch: 13, Steps: 369 | Train Loss: 0.270 Vali Loss: 0.947 Vali Acc: 0.649 Test Loss: 0.947 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0730906
	speed: 0.2828s/iter; left time: 9049.2706s
	iters: 200, epoch: 14 | loss: 0.4562003
	speed: 0.0767s/iter; left time: 2446.6230s
	iters: 300, epoch: 14 | loss: 0.2424828
	speed: 0.0724s/iter; left time: 2301.6743s
Epoch: 14 cost time: 28.746419191360474
Epoch: 14, Steps: 369 | Train Loss: 0.259 Vali Loss: 0.988 Vali Acc: 0.639 Test Loss: 0.988 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.3379862
	speed: 0.2947s/iter; left time: 9323.8417s
	iters: 200, epoch: 15 | loss: 0.1883312
	speed: 0.0805s/iter; left time: 2537.0084s
	iters: 300, epoch: 15 | loss: 0.1939150
	speed: 0.0741s/iter; left time: 2328.9656s
Epoch: 15 cost time: 31.063621044158936
Epoch: 15, Steps: 369 | Train Loss: 0.238 Vali Loss: 1.078 Vali Acc: 0.651 Test Loss: 1.078 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6841657207718501
model parameter : 402642
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7794200
	speed: 0.1134s/iter; left time: 4172.5576s
	iters: 200, epoch: 1 | loss: 0.5827929
	speed: 0.0828s/iter; left time: 3040.6533s
	iters: 300, epoch: 1 | loss: 0.7455689
	speed: 0.0796s/iter; left time: 2913.3837s
Epoch: 1 cost time: 33.074546098709106
Epoch: 1, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.688 Vali Acc: 0.627 Test Loss: 0.688 Test Acc: 0.627
Validation loss decreased (inf --> -0.626838).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3033974
	speed: 0.3083s/iter; left time: 11233.4878s
	iters: 200, epoch: 2 | loss: 0.6881208
	speed: 0.0812s/iter; left time: 2948.6620s
	iters: 300, epoch: 2 | loss: 0.8210278
	speed: 0.0889s/iter; left time: 3221.5078s
Epoch: 2 cost time: 32.55436944961548
Epoch: 2, Steps: 369 | Train Loss: 0.631 Vali Loss: 0.843 Vali Acc: 0.586 Test Loss: 0.843 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2938018
	speed: 0.3071s/iter; left time: 11073.6323s
	iters: 200, epoch: 3 | loss: 0.3985155
	speed: 0.0857s/iter; left time: 3080.5799s
	iters: 300, epoch: 3 | loss: 0.4203372
	speed: 0.0811s/iter; left time: 2909.4720s
Epoch: 3 cost time: 31.95732283592224
Epoch: 3, Steps: 369 | Train Loss: 0.594 Vali Loss: 0.642 Vali Acc: 0.677 Test Loss: 0.642 Test Acc: 0.677
Validation loss decreased (-0.626838 --> -0.677349).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5477520
	speed: 0.2797s/iter; left time: 9984.6209s
	iters: 200, epoch: 4 | loss: 0.5977810
	speed: 0.0825s/iter; left time: 2937.5153s
	iters: 300, epoch: 4 | loss: 0.6270345
	speed: 0.0799s/iter; left time: 2836.0333s
Epoch: 4 cost time: 30.80150079727173
Epoch: 4, Steps: 369 | Train Loss: 0.547 Vali Loss: 0.669 Vali Acc: 0.619 Test Loss: 0.669 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5486893
	speed: 0.2990s/iter; left time: 10563.2262s
	iters: 200, epoch: 5 | loss: 0.5085204
	speed: 0.0808s/iter; left time: 2845.5719s
	iters: 300, epoch: 5 | loss: 0.3705775
	speed: 0.0728s/iter; left time: 2557.3552s
Epoch: 5 cost time: 31.02071213722229
Epoch: 5, Steps: 369 | Train Loss: 0.496 Vali Loss: 0.642 Vali Acc: 0.673 Test Loss: 0.642 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3898495
	speed: 0.2955s/iter; left time: 10329.8857s
	iters: 200, epoch: 6 | loss: 0.5200525
	speed: 0.0806s/iter; left time: 2810.1958s
	iters: 300, epoch: 6 | loss: 0.4138815
	speed: 0.0837s/iter; left time: 2909.7713s
Epoch: 6 cost time: 29.757394790649414
Epoch: 6, Steps: 369 | Train Loss: 0.457 Vali Loss: 0.626 Vali Acc: 0.680 Test Loss: 0.626 Test Acc: 0.680
Validation loss decreased (-0.677349 --> -0.680187).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6088245
	speed: 0.3201s/iter; left time: 11072.1970s
	iters: 200, epoch: 7 | loss: 0.3312593
	speed: 0.0862s/iter; left time: 2974.2738s
	iters: 300, epoch: 7 | loss: 0.1914896
	speed: 0.0782s/iter; left time: 2690.4191s
Epoch: 7 cost time: 32.53659772872925
Epoch: 7, Steps: 369 | Train Loss: 0.426 Vali Loss: 0.691 Vali Acc: 0.674 Test Loss: 0.691 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2742414
	speed: 0.3010s/iter; left time: 10299.2046s
	iters: 200, epoch: 8 | loss: 0.1728566
	speed: 0.0875s/iter; left time: 2986.5070s
	iters: 300, epoch: 8 | loss: 0.5660456
	speed: 0.0782s/iter; left time: 2659.5522s
Epoch: 8 cost time: 30.989200592041016
Epoch: 8, Steps: 369 | Train Loss: 0.390 Vali Loss: 0.734 Vali Acc: 0.659 Test Loss: 0.734 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1777259
	speed: 0.2750s/iter; left time: 9309.0188s
	iters: 200, epoch: 9 | loss: 0.3379285
	speed: 0.0701s/iter; left time: 2366.9371s
	iters: 300, epoch: 9 | loss: 0.3869424
	speed: 0.0791s/iter; left time: 2660.8277s
Epoch: 9 cost time: 28.160969495773315
Epoch: 9, Steps: 369 | Train Loss: 0.360 Vali Loss: 0.728 Vali Acc: 0.665 Test Loss: 0.728 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6019793
	speed: 0.2889s/iter; left time: 9672.1750s
	iters: 200, epoch: 10 | loss: 0.1662323
	speed: 0.0844s/iter; left time: 2816.7097s
	iters: 300, epoch: 10 | loss: 0.4199075
	speed: 0.0751s/iter; left time: 2497.8069s
Epoch: 10 cost time: 30.19653630256653
Epoch: 10, Steps: 369 | Train Loss: 0.328 Vali Loss: 0.783 Vali Acc: 0.676 Test Loss: 0.783 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4454342
	speed: 0.2886s/iter; left time: 9556.7172s
	iters: 200, epoch: 11 | loss: 0.1140229
	speed: 0.0798s/iter; left time: 2635.3987s
	iters: 300, epoch: 11 | loss: 0.2414381
	speed: 0.0784s/iter; left time: 2581.7891s
Epoch: 11 cost time: 31.617416620254517
Epoch: 11, Steps: 369 | Train Loss: 0.291 Vali Loss: 0.911 Vali Acc: 0.674 Test Loss: 0.911 Test Acc: 0.674
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0951215
	speed: 0.2980s/iter; left time: 9755.8500s
	iters: 200, epoch: 12 | loss: 0.3038670
	speed: 0.0807s/iter; left time: 2634.7094s
	iters: 300, epoch: 12 | loss: 0.3820781
	speed: 0.0773s/iter; left time: 2515.5152s
Epoch: 12 cost time: 29.484062671661377
Epoch: 12, Steps: 369 | Train Loss: 0.262 Vali Loss: 0.905 Vali Acc: 0.649 Test Loss: 0.905 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2923753
	speed: 0.3081s/iter; left time: 9975.0071s
	iters: 200, epoch: 13 | loss: 0.3783625
	speed: 0.0836s/iter; left time: 2697.7573s
	iters: 300, epoch: 13 | loss: 0.1234984
	speed: 0.0867s/iter; left time: 2790.3065s
Epoch: 13 cost time: 32.27860975265503
Epoch: 13, Steps: 369 | Train Loss: 0.230 Vali Loss: 1.067 Vali Acc: 0.666 Test Loss: 1.067 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2336378
	speed: 0.3348s/iter; left time: 10715.4984s
	iters: 200, epoch: 14 | loss: 0.1862566
	speed: 0.1025s/iter; left time: 3269.0310s
	iters: 300, epoch: 14 | loss: 0.2756596
	speed: 0.0649s/iter; left time: 2064.1480s
Epoch: 14 cost time: 33.0138955116272
Epoch: 14, Steps: 369 | Train Loss: 0.204 Vali Loss: 1.149 Vali Acc: 0.648 Test Loss: 1.149 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.4074009
	speed: 0.2686s/iter; left time: 8497.4020s
	iters: 200, epoch: 15 | loss: 0.0843436
	speed: 0.0775s/iter; left time: 2442.9916s
	iters: 300, epoch: 15 | loss: 0.1269139
	speed: 0.0877s/iter; left time: 2757.7970s
Epoch: 15 cost time: 32.010701179504395
Epoch: 15, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.162 Vali Acc: 0.670 Test Loss: 1.162 Test Acc: 0.670
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0691989
	speed: 0.3110s/iter; left time: 9724.6247s
	iters: 200, epoch: 16 | loss: 0.1037328
	speed: 0.0864s/iter; left time: 2691.4905s
	iters: 300, epoch: 16 | loss: 0.0391785
	speed: 0.0812s/iter; left time: 2521.1292s
Epoch: 16 cost time: 32.95811223983765
Epoch: 16, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.267 Vali Acc: 0.656 Test Loss: 1.267 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6801929625425652
model parameter : 287218
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7292966
	speed: 0.1102s/iter; left time: 4055.9039s
	iters: 200, epoch: 1 | loss: 1.2884183
	speed: 0.0891s/iter; left time: 3269.6496s
	iters: 300, epoch: 1 | loss: 0.6854462
	speed: 0.0773s/iter; left time: 2828.3283s
Epoch: 1 cost time: 32.943683385849
Epoch: 1, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.671 Vali Acc: 0.650 Test Loss: 0.671 Test Acc: 0.650
Validation loss decreased (inf --> -0.650391).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5577103
	speed: 0.3011s/iter; left time: 10968.2511s
	iters: 200, epoch: 2 | loss: 0.5471093
	speed: 0.0737s/iter; left time: 2676.3025s
	iters: 300, epoch: 2 | loss: 0.5945056
	speed: 0.0766s/iter; left time: 2775.5294s
Epoch: 2 cost time: 30.467058658599854
Epoch: 2, Steps: 369 | Train Loss: 0.674 Vali Loss: 1.102 Vali Acc: 0.561 Test Loss: 1.102 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5972118
	speed: 0.3113s/iter; left time: 11227.8789s
	iters: 200, epoch: 3 | loss: 0.6633124
	speed: 0.0676s/iter; left time: 2429.3358s
	iters: 300, epoch: 3 | loss: 0.6896910
	speed: 0.0686s/iter; left time: 2460.3300s
Epoch: 3 cost time: 27.580780506134033
Epoch: 3, Steps: 369 | Train Loss: 0.634 Vali Loss: 0.738 Vali Acc: 0.636 Test Loss: 0.738 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7348713
	speed: 0.2947s/iter; left time: 10519.7638s
	iters: 200, epoch: 4 | loss: 0.3839857
	speed: 0.0863s/iter; left time: 3071.7265s
	iters: 300, epoch: 4 | loss: 0.5610929
	speed: 0.0855s/iter; left time: 3033.0585s
Epoch: 4 cost time: 31.646178722381592
Epoch: 4, Steps: 369 | Train Loss: 0.542 Vali Loss: 0.626 Vali Acc: 0.660 Test Loss: 0.626 Test Acc: 0.660
Validation loss decreased (-0.650391 --> -0.659755).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2687737
	speed: 0.3001s/iter; left time: 10602.7683s
	iters: 200, epoch: 5 | loss: 0.3350905
	speed: 0.0717s/iter; left time: 2525.4565s
	iters: 300, epoch: 5 | loss: 0.3848055
	speed: 0.0793s/iter; left time: 2784.9966s
Epoch: 5 cost time: 29.635767221450806
Epoch: 5, Steps: 369 | Train Loss: 0.503 Vali Loss: 0.629 Vali Acc: 0.678 Test Loss: 0.629 Test Acc: 0.678
Validation loss decreased (-0.659755 --> -0.678200).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3064979
	speed: 0.2960s/iter; left time: 10347.7118s
	iters: 200, epoch: 6 | loss: 0.4357262
	speed: 0.0902s/iter; left time: 3144.0659s
	iters: 300, epoch: 6 | loss: 0.4922984
	speed: 0.0860s/iter; left time: 2988.9140s
Epoch: 6 cost time: 32.42337918281555
Epoch: 6, Steps: 369 | Train Loss: 0.456 Vali Loss: 0.700 Vali Acc: 0.673 Test Loss: 0.700 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3434971
	speed: 0.3090s/iter; left time: 10686.2132s
	iters: 200, epoch: 7 | loss: 0.3108903
	speed: 0.0786s/iter; left time: 2709.6531s
	iters: 300, epoch: 7 | loss: 0.3380429
	speed: 0.0870s/iter; left time: 2992.3417s
Epoch: 7 cost time: 32.072065353393555
Epoch: 7, Steps: 369 | Train Loss: 0.418 Vali Loss: 0.736 Vali Acc: 0.659 Test Loss: 0.736 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3120019
	speed: 0.3271s/iter; left time: 11191.6319s
	iters: 200, epoch: 8 | loss: 0.1682633
	speed: 0.0804s/iter; left time: 2744.0231s
	iters: 300, epoch: 8 | loss: 0.5099824
	speed: 0.0767s/iter; left time: 2610.4480s
Epoch: 8 cost time: 31.106921911239624
Epoch: 8, Steps: 369 | Train Loss: 0.392 Vali Loss: 0.755 Vali Acc: 0.663 Test Loss: 0.755 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4806307
	speed: 0.3088s/iter; left time: 10453.5438s
	iters: 200, epoch: 9 | loss: 0.2685330
	speed: 0.0810s/iter; left time: 2732.4735s
	iters: 300, epoch: 9 | loss: 0.5007909
	speed: 0.0882s/iter; left time: 2966.3542s
Epoch: 9 cost time: 32.29045796394348
Epoch: 9, Steps: 369 | Train Loss: 0.358 Vali Loss: 0.854 Vali Acc: 0.666 Test Loss: 0.854 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3359799
	speed: 0.3106s/iter; left time: 10398.3861s
	iters: 200, epoch: 10 | loss: 0.1640858
	speed: 0.0801s/iter; left time: 2674.7764s
	iters: 300, epoch: 10 | loss: 0.6051096
	speed: 0.0849s/iter; left time: 2825.3151s
Epoch: 10 cost time: 31.515811681747437
Epoch: 10, Steps: 369 | Train Loss: 0.342 Vali Loss: 0.751 Vali Acc: 0.668 Test Loss: 0.751 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4202478
	speed: 0.3079s/iter; left time: 10195.6947s
	iters: 200, epoch: 11 | loss: 0.2703112
	speed: 0.0892s/iter; left time: 2944.0134s
	iters: 300, epoch: 11 | loss: 0.0767141
	speed: 0.0843s/iter; left time: 2775.6627s
Epoch: 11 cost time: 33.25638198852539
Epoch: 11, Steps: 369 | Train Loss: 0.299 Vali Loss: 0.863 Vali Acc: 0.659 Test Loss: 0.863 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1046074
	speed: 0.2950s/iter; left time: 9657.8734s
	iters: 200, epoch: 12 | loss: 0.2690126
	speed: 0.0814s/iter; left time: 2656.8632s
	iters: 300, epoch: 12 | loss: 0.4041872
	speed: 0.0867s/iter; left time: 2821.8871s
Epoch: 12 cost time: 31.673661470413208
Epoch: 12, Steps: 369 | Train Loss: 0.272 Vali Loss: 0.968 Vali Acc: 0.655 Test Loss: 0.968 Test Acc: 0.655
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0916249
	speed: 0.3247s/iter; left time: 10510.5723s
	iters: 200, epoch: 13 | loss: 0.1004349
	speed: 0.0906s/iter; left time: 2924.6955s
	iters: 300, epoch: 13 | loss: 0.1471781
	speed: 0.0866s/iter; left time: 2787.3942s
Epoch: 13 cost time: 33.222466230392456
Epoch: 13, Steps: 369 | Train Loss: 0.231 Vali Loss: 1.046 Vali Acc: 0.657 Test Loss: 1.046 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0544258
	speed: 0.3240s/iter; left time: 10370.6591s
	iters: 200, epoch: 14 | loss: 0.1471339
	speed: 0.0873s/iter; left time: 2786.7761s
	iters: 300, epoch: 14 | loss: 0.2814337
	speed: 0.0836s/iter; left time: 2659.0836s
Epoch: 14 cost time: 31.552536725997925
Epoch: 14, Steps: 369 | Train Loss: 0.215 Vali Loss: 1.112 Vali Acc: 0.657 Test Loss: 1.112 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1031749
	speed: 0.3340s/iter; left time: 10565.1982s
	iters: 200, epoch: 15 | loss: 0.2197947
	speed: 0.0948s/iter; left time: 2989.2747s
	iters: 300, epoch: 15 | loss: 0.3834151
	speed: 0.0915s/iter; left time: 2876.6037s
Epoch: 15 cost time: 34.25081539154053
Epoch: 15, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.208 Vali Acc: 0.669 Test Loss: 1.208 Test Acc: 0.669
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6782065834279228
model parameter : 286866
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8260930
	speed: 0.1061s/iter; left time: 3905.6022s
	iters: 200, epoch: 1 | loss: 0.6131070
	speed: 0.0918s/iter; left time: 3368.0917s
	iters: 300, epoch: 1 | loss: 0.6500834
	speed: 0.0875s/iter; left time: 3202.3652s
Epoch: 1 cost time: 34.32058787345886
Epoch: 1, Steps: 369 | Train Loss: 0.736 Vali Loss: 0.880 Vali Acc: 0.565 Test Loss: 0.880 Test Acc: 0.565
Validation loss decreased (inf --> -0.565258).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3037906
	speed: 0.2854s/iter; left time: 10396.5804s
	iters: 200, epoch: 2 | loss: 0.8445776
	speed: 0.0755s/iter; left time: 2744.6250s
	iters: 300, epoch: 2 | loss: 0.9715209
	speed: 0.0823s/iter; left time: 2981.1988s
Epoch: 2 cost time: 29.62693691253662
Epoch: 2, Steps: 369 | Train Loss: 0.675 Vali Loss: 0.728 Vali Acc: 0.664 Test Loss: 0.728 Test Acc: 0.664
Validation loss decreased (-0.565258 --> -0.663727).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8674621
	speed: 0.3230s/iter; left time: 11649.0623s
	iters: 200, epoch: 3 | loss: 0.8158615
	speed: 0.0855s/iter; left time: 3074.7698s
	iters: 300, epoch: 3 | loss: 0.2932215
	speed: 0.0782s/iter; left time: 2804.5904s
Epoch: 3 cost time: 32.97331929206848
Epoch: 3, Steps: 369 | Train Loss: 0.601 Vali Loss: 0.635 Vali Acc: 0.655 Test Loss: 0.635 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9273701
	speed: 0.3152s/iter; left time: 11250.5303s
	iters: 200, epoch: 4 | loss: 0.9250252
	speed: 0.0836s/iter; left time: 2975.8948s
	iters: 300, epoch: 4 | loss: 0.9024127
	speed: 0.0839s/iter; left time: 2976.6934s
Epoch: 4 cost time: 30.4000506401062
Epoch: 4, Steps: 369 | Train Loss: 0.558 Vali Loss: 0.610 Vali Acc: 0.676 Test Loss: 0.610 Test Acc: 0.676
Validation loss decreased (-0.663727 --> -0.676214).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7940282
	speed: 0.3215s/iter; left time: 11358.5325s
	iters: 200, epoch: 5 | loss: 0.3771642
	speed: 0.0895s/iter; left time: 3151.7095s
	iters: 300, epoch: 5 | loss: 0.7881981
	speed: 0.0847s/iter; left time: 2973.4074s
Epoch: 5 cost time: 33.01871848106384
Epoch: 5, Steps: 369 | Train Loss: 0.487 Vali Loss: 0.646 Vali Acc: 0.667 Test Loss: 0.646 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5164217
	speed: 0.3181s/iter; left time: 11121.1104s
	iters: 200, epoch: 6 | loss: 0.4931556
	speed: 0.0807s/iter; left time: 2813.9225s
	iters: 300, epoch: 6 | loss: 0.3364060
	speed: 0.0827s/iter; left time: 2873.5127s
Epoch: 6 cost time: 31.911359071731567
Epoch: 6, Steps: 369 | Train Loss: 0.453 Vali Loss: 0.727 Vali Acc: 0.669 Test Loss: 0.727 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3125024
	speed: 0.2996s/iter; left time: 10363.5334s
	iters: 200, epoch: 7 | loss: 0.2672089
	speed: 0.0890s/iter; left time: 3068.2411s
	iters: 300, epoch: 7 | loss: 0.1973045
	speed: 0.0846s/iter; left time: 2908.2411s
Epoch: 7 cost time: 32.26771545410156
Epoch: 7, Steps: 369 | Train Loss: 0.420 Vali Loss: 0.682 Vali Acc: 0.662 Test Loss: 0.682 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2957990
	speed: 0.3029s/iter; left time: 10366.2521s
	iters: 200, epoch: 8 | loss: 0.1865686
	speed: 0.0820s/iter; left time: 2796.4806s
	iters: 300, epoch: 8 | loss: 0.7769725
	speed: 0.0871s/iter; left time: 2963.7442s
Epoch: 8 cost time: 32.01232624053955
Epoch: 8, Steps: 369 | Train Loss: 0.388 Vali Loss: 0.668 Vali Acc: 0.677 Test Loss: 0.668 Test Acc: 0.677
Validation loss decreased (-0.676214 --> -0.677065).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2170017
	speed: 0.3120s/iter; left time: 10561.0184s
	iters: 200, epoch: 9 | loss: 0.0964493
	speed: 0.0771s/iter; left time: 2601.0984s
	iters: 300, epoch: 9 | loss: 0.3058718
	speed: 0.0741s/iter; left time: 2494.4116s
Epoch: 9 cost time: 29.241970539093018
Epoch: 9, Steps: 369 | Train Loss: 0.353 Vali Loss: 0.713 Vali Acc: 0.668 Test Loss: 0.713 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1476736
	speed: 0.2910s/iter; left time: 9744.2780s
	iters: 200, epoch: 10 | loss: 0.1686353
	speed: 0.0780s/iter; left time: 2603.7538s
	iters: 300, epoch: 10 | loss: 0.5227388
	speed: 0.0678s/iter; left time: 2256.7676s
Epoch: 10 cost time: 27.52837896347046
Epoch: 10, Steps: 369 | Train Loss: 0.323 Vali Loss: 0.726 Vali Acc: 0.664 Test Loss: 0.726 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3185549
	speed: 0.2751s/iter; left time: 9107.5425s
	iters: 200, epoch: 11 | loss: 0.1828207
	speed: 0.0790s/iter; left time: 2608.3313s
	iters: 300, epoch: 11 | loss: 0.5992681
	speed: 0.0745s/iter; left time: 2451.0840s
Epoch: 11 cost time: 30.456804275512695
Epoch: 11, Steps: 369 | Train Loss: 0.297 Vali Loss: 0.881 Vali Acc: 0.663 Test Loss: 0.881 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2512146
	speed: 0.2847s/iter; left time: 9322.7892s
	iters: 200, epoch: 12 | loss: 0.2670885
	speed: 0.0798s/iter; left time: 2603.8771s
	iters: 300, epoch: 12 | loss: 0.1720666
	speed: 0.0840s/iter; left time: 2733.5329s
Epoch: 12 cost time: 30.898420572280884
Epoch: 12, Steps: 369 | Train Loss: 0.265 Vali Loss: 0.862 Vali Acc: 0.653 Test Loss: 0.862 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1835973
	speed: 0.2730s/iter; left time: 8838.1572s
	iters: 200, epoch: 13 | loss: 0.2879284
	speed: 0.0789s/iter; left time: 2546.8679s
	iters: 300, epoch: 13 | loss: 0.2779305
	speed: 0.0832s/iter; left time: 2675.2832s
Epoch: 13 cost time: 30.427197217941284
Epoch: 13, Steps: 369 | Train Loss: 0.235 Vali Loss: 0.840 Vali Acc: 0.657 Test Loss: 0.840 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0671958
	speed: 0.3118s/iter; left time: 9980.3042s
	iters: 200, epoch: 14 | loss: 0.2602426
	speed: 0.0887s/iter; left time: 2830.9441s
	iters: 300, epoch: 14 | loss: 0.2844843
	speed: 0.0826s/iter; left time: 2625.7597s
Epoch: 14 cost time: 30.98659920692444
Epoch: 14, Steps: 369 | Train Loss: 0.206 Vali Loss: 1.146 Vali Acc: 0.647 Test Loss: 1.146 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1631900
	speed: 0.2755s/iter; left time: 8715.3194s
	iters: 200, epoch: 15 | loss: 0.4870516
	speed: 0.0747s/iter; left time: 2355.6579s
	iters: 300, epoch: 15 | loss: 0.1797733
	speed: 0.0750s/iter; left time: 2357.5913s
Epoch: 15 cost time: 28.553642749786377
Epoch: 15, Steps: 369 | Train Loss: 0.187 Vali Loss: 1.099 Vali Acc: 0.649 Test Loss: 1.099 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1897551
	speed: 0.2993s/iter; left time: 9358.5652s
	iters: 200, epoch: 16 | loss: 0.0293049
	speed: 0.0767s/iter; left time: 2389.3755s
	iters: 300, epoch: 16 | loss: 0.0269779
	speed: 0.0782s/iter; left time: 2430.8394s
Epoch: 16 cost time: 30.12538719177246
Epoch: 16, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.357 Vali Acc: 0.656 Test Loss: 1.357 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.2160319
	speed: 0.2696s/iter; left time: 8328.2944s
	iters: 200, epoch: 17 | loss: 0.1925583
	speed: 0.0735s/iter; left time: 2264.1720s
	iters: 300, epoch: 17 | loss: 0.0624262
	speed: 0.0822s/iter; left time: 2522.3890s
Epoch: 17 cost time: 29.73689079284668
Epoch: 17, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.327 Vali Acc: 0.651 Test Loss: 1.327 Test Acc: 0.651
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0112733
	speed: 0.2907s/iter; left time: 8874.4089s
	iters: 200, epoch: 18 | loss: 0.0265538
	speed: 0.0853s/iter; left time: 2594.0018s
	iters: 300, epoch: 18 | loss: 0.1932900
	speed: 0.0803s/iter; left time: 2436.0931s
Epoch: 18 cost time: 30.959882974624634
Epoch: 18, Steps: 369 | Train Loss: 0.141 Vali Loss: 1.471 Vali Acc: 0.662 Test Loss: 1.471 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6770715096481271
model parameter : 286514
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7383518
	speed: 0.0948s/iter; left time: 3489.6873s
	iters: 200, epoch: 1 | loss: 0.6658711
	speed: 0.0713s/iter; left time: 2615.9509s
	iters: 300, epoch: 1 | loss: 0.6492076
	speed: 0.0688s/iter; left time: 2518.8234s
Epoch: 1 cost time: 29.39651608467102
Epoch: 1, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.735 Vali Acc: 0.612 Test Loss: 0.735 Test Acc: 0.612
Validation loss decreased (inf --> -0.612365).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9045118
	speed: 0.3090s/iter; left time: 11256.7817s
	iters: 200, epoch: 2 | loss: 0.4424124
	speed: 0.0722s/iter; left time: 2623.5949s
	iters: 300, epoch: 2 | loss: 0.5806782
	speed: 0.0735s/iter; left time: 2662.3581s
Epoch: 2 cost time: 28.204158544540405
Epoch: 2, Steps: 369 | Train Loss: 0.686 Vali Loss: 0.708 Vali Acc: 0.636 Test Loss: 0.708 Test Acc: 0.636
Validation loss decreased (-0.612365 --> -0.635918).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2456506
	speed: 0.2849s/iter; left time: 10272.7034s
	iters: 200, epoch: 3 | loss: 0.5224883
	speed: 0.0740s/iter; left time: 2659.6081s
	iters: 300, epoch: 3 | loss: 0.7144409
	speed: 0.0812s/iter; left time: 2911.8890s
Epoch: 3 cost time: 29.18901824951172
Epoch: 3, Steps: 369 | Train Loss: 0.632 Vali Loss: 1.058 Vali Acc: 0.569 Test Loss: 1.058 Test Acc: 0.569
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7662596
	speed: 0.2940s/iter; left time: 10492.3938s
	iters: 200, epoch: 4 | loss: 0.6830133
	speed: 0.0807s/iter; left time: 2873.0307s
	iters: 300, epoch: 4 | loss: 0.5555789
	speed: 0.0746s/iter; left time: 2648.0660s
Epoch: 4 cost time: 30.10154891014099
Epoch: 4, Steps: 369 | Train Loss: 0.548 Vali Loss: 0.658 Vali Acc: 0.676 Test Loss: 0.658 Test Acc: 0.676
Validation loss decreased (-0.635918 --> -0.676214).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4955965
	speed: 0.2781s/iter; left time: 9823.9282s
	iters: 200, epoch: 5 | loss: 0.3757447
	speed: 0.0794s/iter; left time: 2797.9534s
	iters: 300, epoch: 5 | loss: 0.6368901
	speed: 0.0773s/iter; left time: 2716.8547s
Epoch: 5 cost time: 30.03024649620056
Epoch: 5, Steps: 369 | Train Loss: 0.516 Vali Loss: 0.616 Vali Acc: 0.688 Test Loss: 0.616 Test Acc: 0.688
Validation loss decreased (-0.676214 --> -0.688132).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4931816
	speed: 0.2998s/iter; left time: 10480.8987s
	iters: 200, epoch: 6 | loss: 0.9251822
	speed: 0.0763s/iter; left time: 2660.9619s
	iters: 300, epoch: 6 | loss: 0.4038305
	speed: 0.0836s/iter; left time: 2905.1954s
Epoch: 6 cost time: 30.989563941955566
Epoch: 6, Steps: 369 | Train Loss: 0.452 Vali Loss: 0.673 Vali Acc: 0.671 Test Loss: 0.673 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2164302
	speed: 0.2985s/iter; left time: 10324.8590s
	iters: 200, epoch: 7 | loss: 0.6549870
	speed: 0.0764s/iter; left time: 2634.1728s
	iters: 300, epoch: 7 | loss: 0.3784467
	speed: 0.0749s/iter; left time: 2577.2374s
Epoch: 7 cost time: 28.292242765426636
Epoch: 7, Steps: 369 | Train Loss: 0.433 Vali Loss: 0.712 Vali Acc: 0.670 Test Loss: 0.712 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2763340
	speed: 0.2895s/iter; left time: 9906.0113s
	iters: 200, epoch: 8 | loss: 0.3315679
	speed: 0.0690s/iter; left time: 2354.7428s
	iters: 300, epoch: 8 | loss: 0.4762987
	speed: 0.0730s/iter; left time: 2482.5414s
Epoch: 8 cost time: 28.036842107772827
Epoch: 8, Steps: 369 | Train Loss: 0.401 Vali Loss: 0.638 Vali Acc: 0.682 Test Loss: 0.638 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2633029
	speed: 0.2918s/iter; left time: 9875.7581s
	iters: 200, epoch: 9 | loss: 0.3693573
	speed: 0.0813s/iter; left time: 2743.2826s
	iters: 300, epoch: 9 | loss: 0.2142718
	speed: 0.0748s/iter; left time: 2517.4270s
Epoch: 9 cost time: 30.439656972885132
Epoch: 9, Steps: 369 | Train Loss: 0.365 Vali Loss: 0.679 Vali Acc: 0.678 Test Loss: 0.679 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2861930
	speed: 0.2858s/iter; left time: 9569.8551s
	iters: 200, epoch: 10 | loss: 0.1559135
	speed: 0.0731s/iter; left time: 2441.6897s
	iters: 300, epoch: 10 | loss: 0.6455388
	speed: 0.0803s/iter; left time: 2670.9465s
Epoch: 10 cost time: 30.158644199371338
Epoch: 10, Steps: 369 | Train Loss: 0.333 Vali Loss: 0.818 Vali Acc: 0.670 Test Loss: 0.818 Test Acc: 0.670
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1916530
	speed: 0.2936s/iter; left time: 9720.1613s
	iters: 200, epoch: 11 | loss: 0.1605920
	speed: 0.0734s/iter; left time: 2423.4771s
	iters: 300, epoch: 11 | loss: 0.2961743
	speed: 0.0698s/iter; left time: 2297.8035s
Epoch: 11 cost time: 28.714335680007935
Epoch: 11, Steps: 369 | Train Loss: 0.296 Vali Loss: 0.810 Vali Acc: 0.664 Test Loss: 0.810 Test Acc: 0.664
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2347033
	speed: 0.2855s/iter; left time: 9346.7671s
	iters: 200, epoch: 12 | loss: 0.1904247
	speed: 0.0726s/iter; left time: 2371.3630s
	iters: 300, epoch: 12 | loss: 0.2568510
	speed: 0.0845s/iter; left time: 2749.8096s
Epoch: 12 cost time: 30.57559370994568
Epoch: 12, Steps: 369 | Train Loss: 0.268 Vali Loss: 0.942 Vali Acc: 0.660 Test Loss: 0.942 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2432879
	speed: 0.2997s/iter; left time: 9702.5168s
	iters: 200, epoch: 13 | loss: 0.1114722
	speed: 0.0775s/iter; left time: 2501.3846s
	iters: 300, epoch: 13 | loss: 0.2515718
	speed: 0.0717s/iter; left time: 2307.7801s
Epoch: 13 cost time: 28.35183358192444
Epoch: 13, Steps: 369 | Train Loss: 0.252 Vali Loss: 0.985 Vali Acc: 0.654 Test Loss: 0.985 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0251998
	speed: 0.2966s/iter; left time: 9492.3706s
	iters: 200, epoch: 14 | loss: 0.2054884
	speed: 0.0774s/iter; left time: 2470.0770s
	iters: 300, epoch: 14 | loss: 0.1302486
	speed: 0.0757s/iter; left time: 2408.0235s
Epoch: 14 cost time: 28.49293565750122
Epoch: 14, Steps: 369 | Train Loss: 0.217 Vali Loss: 1.166 Vali Acc: 0.660 Test Loss: 1.166 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.2536533
	speed: 0.2935s/iter; left time: 9286.0513s
	iters: 200, epoch: 15 | loss: 0.1045284
	speed: 0.0769s/iter; left time: 2424.5927s
	iters: 300, epoch: 15 | loss: 0.1170728
	speed: 0.0712s/iter; left time: 2236.6676s
Epoch: 15 cost time: 30.301278352737427
Epoch: 15, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.074 Vali Acc: 0.667 Test Loss: 1.074 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6881384790011351
model parameter : 286162
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8132601
	speed: 0.1073s/iter; left time: 3948.6687s
	iters: 200, epoch: 1 | loss: 0.8026179
	speed: 0.0873s/iter; left time: 3203.3261s
	iters: 300, epoch: 1 | loss: 0.4937454
	speed: 0.0791s/iter; left time: 2894.0626s
Epoch: 1 cost time: 33.07886791229248
Epoch: 1, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.735 Vali Acc: 0.630 Test Loss: 0.735 Test Acc: 0.630
Validation loss decreased (inf --> -0.629959).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4220893
	speed: 0.2804s/iter; left time: 10213.9544s
	iters: 200, epoch: 2 | loss: 0.6773196
	speed: 0.0759s/iter; left time: 2756.1193s
	iters: 300, epoch: 2 | loss: 0.4682658
	speed: 0.0805s/iter; left time: 2916.9649s
Epoch: 2 cost time: 30.111883401870728
Epoch: 2, Steps: 369 | Train Loss: 0.658 Vali Loss: 0.780 Vali Acc: 0.666 Test Loss: 0.780 Test Acc: 0.666
Validation loss decreased (-0.629959 --> -0.665713).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4152233
	speed: 0.3093s/iter; left time: 11152.6020s
	iters: 200, epoch: 3 | loss: 0.3926656
	speed: 0.0809s/iter; left time: 2909.6464s
	iters: 300, epoch: 3 | loss: 0.6901596
	speed: 0.0735s/iter; left time: 2637.0363s
Epoch: 3 cost time: 30.006676197052002
Epoch: 3, Steps: 369 | Train Loss: 0.647 Vali Loss: 0.811 Vali Acc: 0.652 Test Loss: 0.811 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4838652
	speed: 0.2941s/iter; left time: 10496.0861s
	iters: 200, epoch: 4 | loss: 0.7145137
	speed: 0.0781s/iter; left time: 2781.0101s
	iters: 300, epoch: 4 | loss: 0.4565239
	speed: 0.0787s/iter; left time: 2793.4155s
Epoch: 4 cost time: 28.995864391326904
Epoch: 4, Steps: 369 | Train Loss: 0.575 Vali Loss: 0.781 Vali Acc: 0.629 Test Loss: 0.781 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4137099
	speed: 0.2931s/iter; left time: 10355.2109s
	iters: 200, epoch: 5 | loss: 0.2717465
	speed: 0.0819s/iter; left time: 2885.9358s
	iters: 300, epoch: 5 | loss: 0.5214576
	speed: 0.0753s/iter; left time: 2644.0219s
Epoch: 5 cost time: 30.408589124679565
Epoch: 5, Steps: 369 | Train Loss: 0.498 Vali Loss: 0.684 Vali Acc: 0.629 Test Loss: 0.684 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.4654638
	speed: 0.2945s/iter; left time: 10293.2445s
	iters: 200, epoch: 6 | loss: 0.4522491
	speed: 0.0816s/iter; left time: 2845.2992s
	iters: 300, epoch: 6 | loss: 0.4429614
	speed: 0.0841s/iter; left time: 2923.3245s
Epoch: 6 cost time: 30.740597248077393
Epoch: 6, Steps: 369 | Train Loss: 0.452 Vali Loss: 0.653 Vali Acc: 0.647 Test Loss: 0.653 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2671812
	speed: 0.2950s/iter; left time: 10203.0854s
	iters: 200, epoch: 7 | loss: 0.4433889
	speed: 0.0782s/iter; left time: 2698.5829s
	iters: 300, epoch: 7 | loss: 0.3060938
	speed: 0.0728s/iter; left time: 2502.8163s
Epoch: 7 cost time: 29.991358757019043
Epoch: 7, Steps: 369 | Train Loss: 0.423 Vali Loss: 0.683 Vali Acc: 0.668 Test Loss: 0.683 Test Acc: 0.668
Validation loss decreased (-0.665713 --> -0.667984).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2733167
	speed: 0.2858s/iter; left time: 9779.5589s
	iters: 200, epoch: 8 | loss: 0.2808973
	speed: 0.0754s/iter; left time: 2572.3838s
	iters: 300, epoch: 8 | loss: 0.2652326
	speed: 0.0846s/iter; left time: 2879.1494s
Epoch: 8 cost time: 29.7114417552948
Epoch: 8, Steps: 369 | Train Loss: 0.388 Vali Loss: 0.772 Vali Acc: 0.669 Test Loss: 0.772 Test Acc: 0.669
Validation loss decreased (-0.667984 --> -0.669118).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5846547
	speed: 0.2997s/iter; left time: 10144.4958s
	iters: 200, epoch: 9 | loss: 0.6105729
	speed: 0.0866s/iter; left time: 2921.7200s
	iters: 300, epoch: 9 | loss: 0.2648462
	speed: 0.0747s/iter; left time: 2514.1550s
Epoch: 9 cost time: 31.254392623901367
Epoch: 9, Steps: 369 | Train Loss: 0.356 Vali Loss: 0.952 Vali Acc: 0.646 Test Loss: 0.952 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.4035043
	speed: 0.3103s/iter; left time: 10388.6909s
	iters: 200, epoch: 10 | loss: 0.3777801
	speed: 0.0788s/iter; left time: 2630.7618s
	iters: 300, epoch: 10 | loss: 0.5280153
	speed: 0.0774s/iter; left time: 2576.0933s
Epoch: 10 cost time: 29.537745475769043
Epoch: 10, Steps: 369 | Train Loss: 0.327 Vali Loss: 0.820 Vali Acc: 0.659 Test Loss: 0.820 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1204720
	speed: 0.2899s/iter; left time: 9599.2846s
	iters: 200, epoch: 11 | loss: 0.3593067
	speed: 0.0770s/iter; left time: 2542.9785s
	iters: 300, epoch: 11 | loss: 0.1258772
	speed: 0.0708s/iter; left time: 2330.4081s
Epoch: 11 cost time: 29.762551069259644
Epoch: 11, Steps: 369 | Train Loss: 0.284 Vali Loss: 0.956 Vali Acc: 0.656 Test Loss: 0.956 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.3285506
	speed: 0.2859s/iter; left time: 9361.1509s
	iters: 200, epoch: 12 | loss: 0.3697634
	speed: 0.0762s/iter; left time: 2486.7234s
	iters: 300, epoch: 12 | loss: 0.1384343
	speed: 0.0851s/iter; left time: 2768.1889s
Epoch: 12 cost time: 30.21042537689209
Epoch: 12, Steps: 369 | Train Loss: 0.263 Vali Loss: 0.988 Vali Acc: 0.677 Test Loss: 0.988 Test Acc: 0.677
Validation loss decreased (-0.669118 --> -0.676778).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1440921
	speed: 0.2934s/iter; left time: 9498.8468s
	iters: 200, epoch: 13 | loss: 0.1302327
	speed: 0.0816s/iter; left time: 2634.1042s
	iters: 300, epoch: 13 | loss: 0.3595346
	speed: 0.0833s/iter; left time: 2679.6309s
Epoch: 13 cost time: 31.452117204666138
Epoch: 13, Steps: 369 | Train Loss: 0.234 Vali Loss: 0.997 Vali Acc: 0.655 Test Loss: 0.997 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1800525
	speed: 0.3081s/iter; left time: 9858.9769s
	iters: 200, epoch: 14 | loss: 0.0918635
	speed: 0.0847s/iter; left time: 2703.4506s
	iters: 300, epoch: 14 | loss: 0.1124251
	speed: 0.0808s/iter; left time: 2570.1950s
Epoch: 14 cost time: 30.225456714630127
Epoch: 14, Steps: 369 | Train Loss: 0.204 Vali Loss: 1.119 Vali Acc: 0.666 Test Loss: 1.119 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.2132974
	speed: 0.3129s/iter; left time: 9899.8689s
	iters: 200, epoch: 15 | loss: 0.1933422
	speed: 0.0781s/iter; left time: 2463.9689s
	iters: 300, epoch: 15 | loss: 0.0664869
	speed: 0.0850s/iter; left time: 2673.4336s
Epoch: 15 cost time: 31.421963214874268
Epoch: 15, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.007 Vali Acc: 0.660 Test Loss: 1.007 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1818907
	speed: 0.3194s/iter; left time: 9985.9172s
	iters: 200, epoch: 16 | loss: 0.1044361
	speed: 0.0717s/iter; left time: 2234.7343s
	iters: 300, epoch: 16 | loss: 0.1279926
	speed: 0.0765s/iter; left time: 2375.0711s
Epoch: 16 cost time: 29.394048929214478
Epoch: 16, Steps: 369 | Train Loss: 0.158 Vali Loss: 1.244 Vali Acc: 0.676 Test Loss: 1.244 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0763422
	speed: 0.2943s/iter; left time: 9092.1670s
	iters: 200, epoch: 17 | loss: 0.0029411
	speed: 0.0767s/iter; left time: 2360.8475s
	iters: 300, epoch: 17 | loss: 0.0046494
	speed: 0.0862s/iter; left time: 2646.2995s
Epoch: 17 cost time: 30.866700887680054
Epoch: 17, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.149 Vali Acc: 0.650 Test Loss: 1.149 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0826501
	speed: 0.3159s/iter; left time: 9642.6655s
	iters: 200, epoch: 18 | loss: 0.2021101
	speed: 0.0837s/iter; left time: 2547.8930s
	iters: 300, epoch: 18 | loss: 0.1742551
	speed: 0.0898s/iter; left time: 2724.5175s
Epoch: 18 cost time: 32.79522728919983
Epoch: 18, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.521 Vali Acc: 0.671 Test Loss: 1.521 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0147718
	speed: 0.3094s/iter; left time: 9332.5187s
	iters: 200, epoch: 19 | loss: 0.0469350
	speed: 0.0731s/iter; left time: 2198.4186s
	iters: 300, epoch: 19 | loss: 0.0287241
	speed: 0.0702s/iter; left time: 2104.4090s
Epoch: 19 cost time: 28.241713762283325
Epoch: 19, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.534 Vali Acc: 0.665 Test Loss: 1.534 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0372997
	speed: 0.3010s/iter; left time: 8965.6986s
	iters: 200, epoch: 20 | loss: 0.1403479
	speed: 0.0819s/iter; left time: 2433.0272s
	iters: 300, epoch: 20 | loss: 0.2275875
	speed: 0.0829s/iter; left time: 2452.7751s
Epoch: 20 cost time: 30.60198998451233
Epoch: 20, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.638 Vali Acc: 0.650 Test Loss: 1.638 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0067885
	speed: 0.2887s/iter; left time: 8493.3789s
	iters: 200, epoch: 21 | loss: 0.0134353
	speed: 0.0734s/iter; left time: 2151.7670s
	iters: 300, epoch: 21 | loss: 0.0179018
	speed: 0.0752s/iter; left time: 2197.2326s
Epoch: 21 cost time: 28.611119270324707
Epoch: 21, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.602 Vali Acc: 0.652 Test Loss: 1.602 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.2390368
	speed: 0.3100s/iter; left time: 9005.7445s
	iters: 200, epoch: 22 | loss: 0.1188043
	speed: 0.0901s/iter; left time: 2609.1369s
	iters: 300, epoch: 22 | loss: 0.0774012
	speed: 0.0856s/iter; left time: 2470.1869s
Epoch: 22 cost time: 31.89001774787903
Epoch: 22, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.669 Vali Acc: 0.654 Test Loss: 1.669 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6767877412031782
model parameter : 228978
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6091681
	speed: 0.1012s/iter; left time: 3725.8281s
	iters: 200, epoch: 1 | loss: 0.6318852
	speed: 0.0833s/iter; left time: 3057.6395s
	iters: 300, epoch: 1 | loss: 0.6241522
	speed: 0.0860s/iter; left time: 3148.4572s
Epoch: 1 cost time: 32.91294813156128
Epoch: 1, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.933 Vali Acc: 0.584 Test Loss: 0.933 Test Acc: 0.584
Validation loss decreased (inf --> -0.583986).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3186845
	speed: 0.2986s/iter; left time: 10879.4497s
	iters: 200, epoch: 2 | loss: 0.4829609
	speed: 0.0756s/iter; left time: 2744.9129s
	iters: 300, epoch: 2 | loss: 0.6591601
	speed: 0.0788s/iter; left time: 2855.1496s
Epoch: 2 cost time: 29.538760662078857
Epoch: 2, Steps: 369 | Train Loss: 0.640 Vali Loss: 0.747 Vali Acc: 0.615 Test Loss: 0.747 Test Acc: 0.615
Validation loss decreased (-0.583986 --> -0.615486).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3753810
	speed: 0.2919s/iter; left time: 10525.6473s
	iters: 200, epoch: 3 | loss: 0.5192226
	speed: 0.0850s/iter; left time: 3056.4714s
	iters: 300, epoch: 3 | loss: 0.7305207
	speed: 0.0807s/iter; left time: 2894.1613s
Epoch: 3 cost time: 29.735896825790405
Epoch: 3, Steps: 369 | Train Loss: 0.595 Vali Loss: 0.668 Vali Acc: 0.656 Test Loss: 0.668 Test Acc: 0.656
Validation loss decreased (-0.615486 --> -0.656066).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6170886
	speed: 0.2924s/iter; left time: 10437.6746s
	iters: 200, epoch: 4 | loss: 0.5557638
	speed: 0.0741s/iter; left time: 2635.7493s
	iters: 300, epoch: 4 | loss: 0.2171372
	speed: 0.0748s/iter; left time: 2653.4230s
Epoch: 4 cost time: 28.54883050918579
Epoch: 4, Steps: 369 | Train Loss: 0.536 Vali Loss: 0.643 Vali Acc: 0.684 Test Loss: 0.643 Test Acc: 0.684
Validation loss decreased (-0.656066 --> -0.684159).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6445699
	speed: 0.2996s/iter; left time: 10584.1210s
	iters: 200, epoch: 5 | loss: 0.4318089
	speed: 0.0903s/iter; left time: 3180.5133s
	iters: 300, epoch: 5 | loss: 0.7417541
	speed: 0.0797s/iter; left time: 2798.6410s
Epoch: 5 cost time: 31.64238953590393
Epoch: 5, Steps: 369 | Train Loss: 0.484 Vali Loss: 0.700 Vali Acc: 0.677 Test Loss: 0.700 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4076654
	speed: 0.2845s/iter; left time: 9944.8394s
	iters: 200, epoch: 6 | loss: 0.4146270
	speed: 0.0720s/iter; left time: 2510.3450s
	iters: 300, epoch: 6 | loss: 0.4552498
	speed: 0.0820s/iter; left time: 2850.8416s
Epoch: 6 cost time: 29.375375270843506
Epoch: 6, Steps: 369 | Train Loss: 0.442 Vali Loss: 0.659 Vali Acc: 0.676 Test Loss: 0.659 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.5506459
	speed: 0.3036s/iter; left time: 10500.7764s
	iters: 200, epoch: 7 | loss: 0.4971725
	speed: 0.0865s/iter; left time: 2984.0959s
	iters: 300, epoch: 7 | loss: 0.4421329
	speed: 0.0864s/iter; left time: 2971.2022s
Epoch: 7 cost time: 31.83402919769287
Epoch: 7, Steps: 369 | Train Loss: 0.407 Vali Loss: 0.722 Vali Acc: 0.667 Test Loss: 0.722 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4992925
	speed: 0.2902s/iter; left time: 9928.5513s
	iters: 200, epoch: 8 | loss: 0.4036357
	speed: 0.0730s/iter; left time: 2489.1531s
	iters: 300, epoch: 8 | loss: 0.2009562
	speed: 0.0785s/iter; left time: 2668.9625s
Epoch: 8 cost time: 28.538761615753174
Epoch: 8, Steps: 369 | Train Loss: 0.389 Vali Loss: 0.683 Vali Acc: 0.669 Test Loss: 0.683 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3936559
	speed: 0.3180s/iter; left time: 10763.2995s
	iters: 200, epoch: 9 | loss: 0.4092717
	speed: 0.0804s/iter; left time: 2714.8108s
	iters: 300, epoch: 9 | loss: 0.6057227
	speed: 0.0747s/iter; left time: 2513.4994s
Epoch: 9 cost time: 30.71280837059021
Epoch: 9, Steps: 369 | Train Loss: 0.353 Vali Loss: 0.792 Vali Acc: 0.659 Test Loss: 0.792 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1258749
	speed: 0.2889s/iter; left time: 9673.9085s
	iters: 200, epoch: 10 | loss: 0.4156885
	speed: 0.0752s/iter; left time: 2509.5497s
	iters: 300, epoch: 10 | loss: 0.3161711
	speed: 0.0761s/iter; left time: 2532.8020s
Epoch: 10 cost time: 28.4064781665802
Epoch: 10, Steps: 369 | Train Loss: 0.326 Vali Loss: 0.838 Vali Acc: 0.647 Test Loss: 0.838 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.3790348
	speed: 0.2908s/iter; left time: 9629.1849s
	iters: 200, epoch: 11 | loss: 0.1845877
	speed: 0.0783s/iter; left time: 2585.6203s
	iters: 300, epoch: 11 | loss: 0.3267396
	speed: 0.0852s/iter; left time: 2804.9918s
Epoch: 11 cost time: 31.23124861717224
Epoch: 11, Steps: 369 | Train Loss: 0.291 Vali Loss: 0.809 Vali Acc: 0.650 Test Loss: 0.809 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.3484674
	speed: 0.2899s/iter; left time: 9493.2476s
	iters: 200, epoch: 12 | loss: 0.3770583
	speed: 0.0808s/iter; left time: 2637.9501s
	iters: 300, epoch: 12 | loss: 0.3037305
	speed: 0.0784s/iter; left time: 2550.8954s
Epoch: 12 cost time: 29.31083345413208
Epoch: 12, Steps: 369 | Train Loss: 0.263 Vali Loss: 0.915 Vali Acc: 0.632 Test Loss: 0.915 Test Acc: 0.632
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1778291
	speed: 0.2968s/iter; left time: 9607.8368s
	iters: 200, epoch: 13 | loss: 0.0613895
	speed: 0.0766s/iter; left time: 2472.2209s
	iters: 300, epoch: 13 | loss: 0.2534364
	speed: 0.0757s/iter; left time: 2435.0595s
Epoch: 13 cost time: 29.39191246032715
Epoch: 13, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.078 Vali Acc: 0.654 Test Loss: 1.078 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.2409237
	speed: 0.2941s/iter; left time: 9411.1247s
	iters: 200, epoch: 14 | loss: 0.1933212
	speed: 0.0795s/iter; left time: 2534.8232s
	iters: 300, epoch: 14 | loss: 0.2224932
	speed: 0.0704s/iter; left time: 2239.3932s
Epoch: 14 cost time: 29.547075986862183
Epoch: 14, Steps: 369 | Train Loss: 0.193 Vali Loss: 1.183 Vali Acc: 0.648 Test Loss: 1.183 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6841657207718501
model parameter : 228626
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8483443
	speed: 0.0993s/iter; left time: 3655.1816s
	iters: 200, epoch: 1 | loss: 0.7929670
	speed: 0.0771s/iter; left time: 2828.9540s
	iters: 300, epoch: 1 | loss: 0.7151595
	speed: 0.0847s/iter; left time: 3101.2703s
Epoch: 1 cost time: 31.860809803009033
Epoch: 1, Steps: 369 | Train Loss: 0.688 Vali Loss: 0.686 Vali Acc: 0.640 Test Loss: 0.686 Test Acc: 0.640
Validation loss decreased (inf --> -0.640459).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6912323
	speed: 0.3000s/iter; left time: 10928.5207s
	iters: 200, epoch: 2 | loss: 0.5235487
	speed: 0.0816s/iter; left time: 2964.0404s
	iters: 300, epoch: 2 | loss: 0.5301493
	speed: 0.0756s/iter; left time: 2738.5530s
Epoch: 2 cost time: 30.230023860931396
Epoch: 2, Steps: 369 | Train Loss: 0.667 Vali Loss: 0.681 Vali Acc: 0.672 Test Loss: 0.681 Test Acc: 0.672
Validation loss decreased (-0.640459 --> -0.671957).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9749500
	speed: 0.2886s/iter; left time: 10408.1988s
	iters: 200, epoch: 3 | loss: 0.5133215
	speed: 0.0825s/iter; left time: 2966.8906s
	iters: 300, epoch: 3 | loss: 0.5618823
	speed: 0.0826s/iter; left time: 2962.6463s
Epoch: 3 cost time: 31.62647294998169
Epoch: 3, Steps: 369 | Train Loss: 0.625 Vali Loss: 1.458 Vali Acc: 0.549 Test Loss: 1.458 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6151592
	speed: 0.3091s/iter; left time: 11033.8421s
	iters: 200, epoch: 4 | loss: 0.6766589
	speed: 0.0803s/iter; left time: 2859.8281s
	iters: 300, epoch: 4 | loss: 0.9620566
	speed: 0.0710s/iter; left time: 2518.6354s
Epoch: 4 cost time: 29.215304851531982
Epoch: 4, Steps: 369 | Train Loss: 0.564 Vali Loss: 0.708 Vali Acc: 0.642 Test Loss: 0.708 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6637908
	speed: 0.3032s/iter; left time: 10710.9742s
	iters: 200, epoch: 5 | loss: 0.4944872
	speed: 0.0806s/iter; left time: 2838.9315s
	iters: 300, epoch: 5 | loss: 0.4451776
	speed: 0.0769s/iter; left time: 2702.0717s
Epoch: 5 cost time: 29.914329051971436
Epoch: 5, Steps: 369 | Train Loss: 0.500 Vali Loss: 0.611 Vali Acc: 0.681 Test Loss: 0.611 Test Acc: 0.681
Validation loss decreased (-0.671957 --> -0.681322).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4610176
	speed: 0.3198s/iter; left time: 11177.3167s
	iters: 200, epoch: 6 | loss: 0.4925873
	speed: 0.0802s/iter; left time: 2797.0567s
	iters: 300, epoch: 6 | loss: 0.5602897
	speed: 0.0785s/iter; left time: 2727.8532s
Epoch: 6 cost time: 29.395158529281616
Epoch: 6, Steps: 369 | Train Loss: 0.450 Vali Loss: 0.663 Vali Acc: 0.681 Test Loss: 0.663 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5610736
	speed: 0.2716s/iter; left time: 9395.3791s
	iters: 200, epoch: 7 | loss: 0.3306404
	speed: 0.0734s/iter; left time: 2532.3650s
	iters: 300, epoch: 7 | loss: 0.5668703
	speed: 0.0801s/iter; left time: 2754.6151s
Epoch: 7 cost time: 30.483731746673584
Epoch: 7, Steps: 369 | Train Loss: 0.423 Vali Loss: 0.667 Vali Acc: 0.683 Test Loss: 0.667 Test Acc: 0.683
Validation loss decreased (-0.681322 --> -0.683308).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3124982
	speed: 0.3027s/iter; left time: 10358.8607s
	iters: 200, epoch: 8 | loss: 0.4424807
	speed: 0.0804s/iter; left time: 2743.3633s
	iters: 300, epoch: 8 | loss: 0.5975748
	speed: 0.0813s/iter; left time: 2765.7901s
Epoch: 8 cost time: 31.272817373275757
Epoch: 8, Steps: 369 | Train Loss: 0.378 Vali Loss: 0.693 Vali Acc: 0.646 Test Loss: 0.693 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1232214
	speed: 0.2875s/iter; left time: 9730.4912s
	iters: 200, epoch: 9 | loss: 0.3555182
	speed: 0.0823s/iter; left time: 2775.9348s
	iters: 300, epoch: 9 | loss: 0.2365673
	speed: 0.0810s/iter; left time: 2724.4316s
Epoch: 9 cost time: 30.269736528396606
Epoch: 9, Steps: 369 | Train Loss: 0.358 Vali Loss: 1.025 Vali Acc: 0.642 Test Loss: 1.025 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1641822
	speed: 0.3007s/iter; left time: 10066.9792s
	iters: 200, epoch: 10 | loss: 0.2671240
	speed: 0.0778s/iter; left time: 2595.6286s
	iters: 300, epoch: 10 | loss: 0.6584217
	speed: 0.0756s/iter; left time: 2517.0711s
Epoch: 10 cost time: 29.907662868499756
Epoch: 10, Steps: 369 | Train Loss: 0.336 Vali Loss: 0.877 Vali Acc: 0.666 Test Loss: 0.877 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0722701
	speed: 0.3070s/iter; left time: 10165.2532s
	iters: 200, epoch: 11 | loss: 0.3827271
	speed: 0.0813s/iter; left time: 2682.6793s
	iters: 300, epoch: 11 | loss: 0.2922208
	speed: 0.0786s/iter; left time: 2587.5308s
Epoch: 11 cost time: 29.27181887626648
Epoch: 11, Steps: 369 | Train Loss: 0.296 Vali Loss: 0.786 Vali Acc: 0.668 Test Loss: 0.786 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3628486
	speed: 0.3084s/iter; left time: 10096.8781s
	iters: 200, epoch: 12 | loss: 0.4435429
	speed: 0.0835s/iter; left time: 2726.6009s
	iters: 300, epoch: 12 | loss: 0.2324208
	speed: 0.0873s/iter; left time: 2840.4339s
Epoch: 12 cost time: 32.29958462715149
Epoch: 12, Steps: 369 | Train Loss: 0.258 Vali Loss: 1.029 Vali Acc: 0.663 Test Loss: 1.029 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2368148
	speed: 0.2919s/iter; left time: 9449.3945s
	iters: 200, epoch: 13 | loss: 0.0627446
	speed: 0.0788s/iter; left time: 2543.3273s
	iters: 300, epoch: 13 | loss: 0.1590965
	speed: 0.0794s/iter; left time: 2556.0705s
Epoch: 13 cost time: 29.2815580368042
Epoch: 13, Steps: 369 | Train Loss: 0.226 Vali Loss: 1.061 Vali Acc: 0.656 Test Loss: 1.061 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0450318
	speed: 0.2865s/iter; left time: 9170.4202s
	iters: 200, epoch: 14 | loss: 0.0501837
	speed: 0.0813s/iter; left time: 2592.6190s
	iters: 300, epoch: 14 | loss: 0.2338458
	speed: 0.0782s/iter; left time: 2486.9530s
Epoch: 14 cost time: 30.1238374710083
Epoch: 14, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.146 Vali Acc: 0.659 Test Loss: 1.146 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1338003
	speed: 0.2899s/iter; left time: 9170.5586s
	iters: 200, epoch: 15 | loss: 0.1098234
	speed: 0.0743s/iter; left time: 2343.1120s
	iters: 300, epoch: 15 | loss: 0.3047603
	speed: 0.0770s/iter; left time: 2419.4799s
Epoch: 15 cost time: 29.791847467422485
Epoch: 15, Steps: 369 | Train Loss: 0.187 Vali Loss: 1.067 Vali Acc: 0.651 Test Loss: 1.067 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2744559
	speed: 0.2964s/iter; left time: 9266.4754s
	iters: 200, epoch: 16 | loss: 0.2456503
	speed: 0.0817s/iter; left time: 2546.6154s
	iters: 300, epoch: 16 | loss: 0.1319888
	speed: 0.0783s/iter; left time: 2432.2166s
Epoch: 16 cost time: 30.167977809906006
Epoch: 16, Steps: 369 | Train Loss: 0.154 Vali Loss: 1.288 Vali Acc: 0.658 Test Loss: 1.288 Test Acc: 0.658
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.3317446
	speed: 0.2931s/iter; left time: 9056.3033s
	iters: 200, epoch: 17 | loss: 0.3198745
	speed: 0.0701s/iter; left time: 2159.1157s
	iters: 300, epoch: 17 | loss: 0.0771171
	speed: 0.0711s/iter; left time: 2182.9009s
Epoch: 17 cost time: 27.775411367416382
Epoch: 17, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.303 Vali Acc: 0.661 Test Loss: 1.303 Test Acc: 0.661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6833144154370034
model parameter : 228274
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6076983
	speed: 0.1020s/iter; left time: 3752.6372s
	iters: 200, epoch: 1 | loss: 0.7144181
	speed: 0.0801s/iter; left time: 2941.1847s
	iters: 300, epoch: 1 | loss: 0.7082299
	speed: 0.0799s/iter; left time: 2925.1130s
Epoch: 1 cost time: 31.422576665878296
Epoch: 1, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.790 Vali Acc: 0.620 Test Loss: 0.790 Test Acc: 0.620
Validation loss decreased (inf --> -0.620310).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4969378
	speed: 0.3031s/iter; left time: 11040.8397s
	iters: 200, epoch: 2 | loss: 0.6737499
	speed: 0.0827s/iter; left time: 3005.6077s
	iters: 300, epoch: 2 | loss: 0.8454406
	speed: 0.0799s/iter; left time: 2893.2361s
Epoch: 2 cost time: 31.41551661491394
Epoch: 2, Steps: 369 | Train Loss: 0.689 Vali Loss: 1.252 Vali Acc: 0.565 Test Loss: 1.252 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7275019
	speed: 0.3001s/iter; left time: 10820.8634s
	iters: 200, epoch: 3 | loss: 0.6817232
	speed: 0.0796s/iter; left time: 2863.6926s
	iters: 300, epoch: 3 | loss: 0.6439967
	speed: 0.0784s/iter; left time: 2812.5966s
Epoch: 3 cost time: 28.87833881378174
Epoch: 3, Steps: 369 | Train Loss: 0.643 Vali Loss: 0.708 Vali Acc: 0.677 Test Loss: 0.708 Test Acc: 0.677
Validation loss decreased (-0.620310 --> -0.676497).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4043679
	speed: 0.2990s/iter; left time: 10673.1836s
	iters: 200, epoch: 4 | loss: 0.8023939
	speed: 0.0765s/iter; left time: 2722.3028s
	iters: 300, epoch: 4 | loss: 0.1983677
	speed: 0.0731s/iter; left time: 2593.8523s
Epoch: 4 cost time: 28.95799446105957
Epoch: 4, Steps: 369 | Train Loss: 0.552 Vali Loss: 0.912 Vali Acc: 0.589 Test Loss: 0.912 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4423581
	speed: 0.2985s/iter; left time: 10543.4185s
	iters: 200, epoch: 5 | loss: 0.9686936
	speed: 0.0758s/iter; left time: 2670.2372s
	iters: 300, epoch: 5 | loss: 0.4762441
	speed: 0.0752s/iter; left time: 2642.0279s
Epoch: 5 cost time: 28.670225620269775
Epoch: 5, Steps: 369 | Train Loss: 0.499 Vali Loss: 0.721 Vali Acc: 0.670 Test Loss: 0.721 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.4673597
	speed: 0.2846s/iter; left time: 9947.3771s
	iters: 200, epoch: 6 | loss: 0.5317858
	speed: 0.0811s/iter; left time: 2826.0041s
	iters: 300, epoch: 6 | loss: 0.4920940
	speed: 0.0763s/iter; left time: 2653.6097s
Epoch: 6 cost time: 30.55307364463806
Epoch: 6, Steps: 369 | Train Loss: 0.445 Vali Loss: 0.868 Vali Acc: 0.602 Test Loss: 0.868 Test Acc: 0.602
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2604700
	speed: 0.3060s/iter; left time: 10584.8586s
	iters: 200, epoch: 7 | loss: 0.4889471
	speed: 0.0841s/iter; left time: 2900.8403s
	iters: 300, epoch: 7 | loss: 0.2102338
	speed: 0.0784s/iter; left time: 2694.3839s
Epoch: 7 cost time: 30.56381320953369
Epoch: 7, Steps: 369 | Train Loss: 0.416 Vali Loss: 0.653 Vali Acc: 0.675 Test Loss: 0.653 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.3583538
	speed: 0.2886s/iter; left time: 9875.9774s
	iters: 200, epoch: 8 | loss: 0.1236284
	speed: 0.0736s/iter; left time: 2511.4321s
	iters: 300, epoch: 8 | loss: 0.5036576
	speed: 0.0747s/iter; left time: 2540.9927s
Epoch: 8 cost time: 29.34680414199829
Epoch: 8, Steps: 369 | Train Loss: 0.387 Vali Loss: 0.822 Vali Acc: 0.650 Test Loss: 0.822 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1345985
	speed: 0.3050s/iter; left time: 10324.3566s
	iters: 200, epoch: 9 | loss: 0.3291748
	speed: 0.0797s/iter; left time: 2690.2412s
	iters: 300, epoch: 9 | loss: 0.1554578
	speed: 0.0774s/iter; left time: 2603.3379s
Epoch: 9 cost time: 29.642733573913574
Epoch: 9, Steps: 369 | Train Loss: 0.356 Vali Loss: 0.802 Vali Acc: 0.668 Test Loss: 0.802 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2132850
	speed: 0.2806s/iter; left time: 9395.6560s
	iters: 200, epoch: 10 | loss: 0.5888986
	speed: 0.0713s/iter; left time: 2379.7033s
	iters: 300, epoch: 10 | loss: 0.6852815
	speed: 0.0726s/iter; left time: 2414.8735s
Epoch: 10 cost time: 27.32095766067505
Epoch: 10, Steps: 369 | Train Loss: 0.324 Vali Loss: 0.782 Vali Acc: 0.667 Test Loss: 0.782 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1444351
	speed: 0.2946s/iter; left time: 9753.3924s
	iters: 200, epoch: 11 | loss: 0.1658199
	speed: 0.0825s/iter; left time: 2723.3872s
	iters: 300, epoch: 11 | loss: 0.2866536
	speed: 0.0802s/iter; left time: 2638.0465s
Epoch: 11 cost time: 30.201977729797363
Epoch: 11, Steps: 369 | Train Loss: 0.281 Vali Loss: 0.938 Vali Acc: 0.661 Test Loss: 0.938 Test Acc: 0.661
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1636472
	speed: 0.2845s/iter; left time: 9315.0931s
	iters: 200, epoch: 12 | loss: 0.1049181
	speed: 0.0726s/iter; left time: 2370.0887s
	iters: 300, epoch: 12 | loss: 0.1648345
	speed: 0.0739s/iter; left time: 2404.9666s
Epoch: 12 cost time: 28.086997985839844
Epoch: 12, Steps: 369 | Train Loss: 0.270 Vali Loss: 1.119 Vali Acc: 0.643 Test Loss: 1.119 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.3193125
	speed: 0.2866s/iter; left time: 9277.6658s
	iters: 200, epoch: 13 | loss: 0.2432534
	speed: 0.0858s/iter; left time: 2768.8176s
	iters: 300, epoch: 13 | loss: 0.0992668
	speed: 0.0794s/iter; left time: 2553.6523s
Epoch: 13 cost time: 30.9567391872406
Epoch: 13, Steps: 369 | Train Loss: 0.234 Vali Loss: 0.937 Vali Acc: 0.657 Test Loss: 0.937 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6765039727582293
model parameter : 227922
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1131809
	speed: 0.1329s/iter; left time: 4891.8677s
	iters: 200, epoch: 1 | loss: 1.1305847
	speed: 0.1219s/iter; left time: 4472.2689s
	iters: 300, epoch: 1 | loss: 0.5464854
	speed: 0.1246s/iter; left time: 4562.1513s
Epoch: 1 cost time: 46.98150324821472
Epoch: 1, Steps: 369 | Train Loss: 1.354 Vali Loss: 0.773 Vali Acc: 0.663 Test Loss: 0.773 Test Acc: 0.663
Validation loss decreased (inf --> -0.663443).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7850115
	speed: 0.4650s/iter; left time: 16941.4640s
	iters: 200, epoch: 2 | loss: 0.7105509
	speed: 0.1173s/iter; left time: 4262.1929s
	iters: 300, epoch: 2 | loss: 1.2812196
	speed: 0.1033s/iter; left time: 3741.0108s
Epoch: 2 cost time: 42.14730882644653
Epoch: 2, Steps: 369 | Train Loss: 0.971 Vali Loss: 0.650 Vali Acc: 0.650 Test Loss: 0.650 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8097895
	speed: 0.4175s/iter; left time: 15057.3062s
	iters: 200, epoch: 3 | loss: 1.0576761
	speed: 0.1110s/iter; left time: 3991.3888s
	iters: 300, epoch: 3 | loss: 3.9142876
	speed: 0.1092s/iter; left time: 3917.2362s
Epoch: 3 cost time: 40.94431972503662
Epoch: 3, Steps: 369 | Train Loss: 1.367 Vali Loss: 1.385 Vali Acc: 0.500 Test Loss: 1.385 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.2790840
	speed: 0.4150s/iter; left time: 14812.8783s
	iters: 200, epoch: 4 | loss: 1.4039528
	speed: 0.1001s/iter; left time: 3563.7966s
	iters: 300, epoch: 4 | loss: 1.1040078
	speed: 0.1154s/iter; left time: 4094.7049s
Epoch: 4 cost time: 40.77517223358154
Epoch: 4, Steps: 369 | Train Loss: 1.292 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.7798070
	speed: 0.4302s/iter; left time: 15195.7086s
	iters: 200, epoch: 5 | loss: 0.9811949
	speed: 0.1066s/iter; left time: 3755.6870s
	iters: 300, epoch: 5 | loss: 0.9936067
	speed: 0.1041s/iter; left time: 3657.0596s
Epoch: 5 cost time: 40.461153507232666
Epoch: 5, Steps: 369 | Train Loss: 1.122 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6931444
	speed: 0.4390s/iter; left time: 15347.4095s
	iters: 200, epoch: 6 | loss: 0.7279068
	speed: 0.1236s/iter; left time: 4306.9627s
	iters: 300, epoch: 6 | loss: 0.7806284
	speed: 0.1183s/iter; left time: 4111.1220s
Epoch: 6 cost time: 45.52105736732483
Epoch: 6, Steps: 369 | Train Loss: 0.967 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7696025
	speed: 0.4408s/iter; left time: 15245.8608s
	iters: 200, epoch: 7 | loss: 0.7820054
	speed: 0.1068s/iter; left time: 3682.1521s
	iters: 300, epoch: 7 | loss: 0.8407157
	speed: 0.1091s/iter; left time: 3750.7706s
Epoch: 7 cost time: 42.12675642967224
Epoch: 7, Steps: 369 | Train Loss: 0.858 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7963369
	speed: 0.4773s/iter; left time: 16333.9182s
	iters: 200, epoch: 8 | loss: 0.6950393
	speed: 0.1245s/iter; left time: 4247.0098s
	iters: 300, epoch: 8 | loss: 0.8116919
	speed: 0.0744s/iter; left time: 2529.9013s
Epoch: 8 cost time: 40.789979696273804
Epoch: 8, Steps: 369 | Train Loss: 0.819 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.9196645
	speed: 0.3772s/iter; left time: 12768.6987s
	iters: 200, epoch: 9 | loss: 0.7670732
	speed: 0.1127s/iter; left time: 3803.7924s
	iters: 300, epoch: 9 | loss: 0.6450473
	speed: 0.1084s/iter; left time: 3646.4058s
Epoch: 9 cost time: 40.69137954711914
Epoch: 9, Steps: 369 | Train Loss: 0.771 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.8722594
	speed: 0.4112s/iter; left time: 13766.1107s
	iters: 200, epoch: 10 | loss: 0.7363347
	speed: 0.1015s/iter; left time: 3387.8326s
	iters: 300, epoch: 10 | loss: 0.7081777
	speed: 0.1064s/iter; left time: 3540.6458s
Epoch: 10 cost time: 39.188798666000366
Epoch: 10, Steps: 369 | Train Loss: 0.746 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6717309
	speed: 0.4183s/iter; left time: 13850.2162s
	iters: 200, epoch: 11 | loss: 0.7595918
	speed: 0.1029s/iter; left time: 3395.2153s
	iters: 300, epoch: 11 | loss: 0.7223776
	speed: 0.1048s/iter; left time: 3448.1147s
Epoch: 11 cost time: 40.075114727020264
Epoch: 11, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6634506242905789
model parameter : 8370982
model size : 36.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2759683
	speed: 0.1293s/iter; left time: 4758.5910s
	iters: 200, epoch: 1 | loss: 0.9895687
	speed: 0.1062s/iter; left time: 3895.9412s
	iters: 300, epoch: 1 | loss: 0.6635785
	speed: 0.1056s/iter; left time: 3863.5878s
Epoch: 1 cost time: 41.86487340927124
Epoch: 1, Steps: 369 | Train Loss: 1.291 Vali Loss: 2.750 Vali Acc: 0.500 Test Loss: 2.750 Test Acc: 0.500
Validation loss decreased (inf --> -0.499972).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3854665
	speed: 0.4230s/iter; left time: 15411.4153s
	iters: 200, epoch: 2 | loss: 2.7265654
	speed: 0.1096s/iter; left time: 3983.6206s
	iters: 300, epoch: 2 | loss: 0.9162462
	speed: 0.1105s/iter; left time: 4004.4812s
Epoch: 2 cost time: 41.41821765899658
Epoch: 2, Steps: 369 | Train Loss: 0.981 Vali Loss: 0.980 Vali Acc: 0.501 Test Loss: 0.980 Test Acc: 0.501
Validation loss decreased (-0.499972 --> -0.500558).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6869913
	speed: 0.4045s/iter; left time: 14587.7232s
	iters: 200, epoch: 3 | loss: 1.1492168
	speed: 0.1058s/iter; left time: 3803.1826s
	iters: 300, epoch: 3 | loss: 0.8143690
	speed: 0.1058s/iter; left time: 3795.8946s
Epoch: 3 cost time: 39.18820023536682
Epoch: 3, Steps: 369 | Train Loss: 0.999 Vali Loss: 2.043 Vali Acc: 0.500 Test Loss: 2.043 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7023978
	speed: 0.4125s/iter; left time: 14723.2910s
	iters: 200, epoch: 4 | loss: 0.7290072
	speed: 0.0988s/iter; left time: 3516.0888s
	iters: 300, epoch: 4 | loss: 1.4760174
	speed: 0.1080s/iter; left time: 3833.8731s
Epoch: 4 cost time: 39.56685137748718
Epoch: 4, Steps: 369 | Train Loss: 1.087 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8015006
	speed: 0.4133s/iter; left time: 14600.3749s
	iters: 200, epoch: 5 | loss: 0.8733585
	speed: 0.1062s/iter; left time: 3740.1222s
	iters: 300, epoch: 5 | loss: 0.6897569
	speed: 0.1062s/iter; left time: 3731.8932s
Epoch: 5 cost time: 39.7843222618103
Epoch: 5, Steps: 369 | Train Loss: 1.078 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7577655
	speed: 0.4189s/iter; left time: 14644.6122s
	iters: 200, epoch: 6 | loss: 0.8653728
	speed: 0.1169s/iter; left time: 4073.0390s
	iters: 300, epoch: 6 | loss: 0.9327318
	speed: 0.1063s/iter; left time: 3693.8073s
Epoch: 6 cost time: 42.532713174819946
Epoch: 6, Steps: 369 | Train Loss: 0.803 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7398458
	speed: 0.4159s/iter; left time: 14384.7103s
	iters: 200, epoch: 7 | loss: 0.6908144
	speed: 0.1099s/iter; left time: 3791.2120s
	iters: 300, epoch: 7 | loss: 0.6727440
	speed: 0.1020s/iter; left time: 3505.9120s
Epoch: 7 cost time: 39.08610653877258
Epoch: 7, Steps: 369 | Train Loss: 0.738 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7461013
	speed: 0.4123s/iter; left time: 14106.6009s
	iters: 200, epoch: 8 | loss: 0.6949139
	speed: 0.1057s/iter; left time: 3607.5363s
	iters: 300, epoch: 8 | loss: 0.6834337
	speed: 0.1003s/iter; left time: 3411.3085s
Epoch: 8 cost time: 39.56131982803345
Epoch: 8, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6963308
	speed: 0.4040s/iter; left time: 13674.3341s
	iters: 200, epoch: 9 | loss: 0.7362390
	speed: 0.1063s/iter; left time: 3585.9486s
	iters: 300, epoch: 9 | loss: 0.7099251
	speed: 0.1108s/iter; left time: 3729.2176s
Epoch: 9 cost time: 39.716989040374756
Epoch: 9, Steps: 369 | Train Loss: 0.724 Vali Loss: 1.042 Vali Acc: 0.500 Test Loss: 1.042 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.1191887
	speed: 0.4043s/iter; left time: 13535.6220s
	iters: 200, epoch: 10 | loss: 1.1944509
	speed: 0.1001s/iter; left time: 3341.8735s
	iters: 300, epoch: 10 | loss: 1.1843082
	speed: 0.1008s/iter; left time: 3354.1800s
Epoch: 10 cost time: 38.20129203796387
Epoch: 10, Steps: 369 | Train Loss: 1.073 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.8671014
	speed: 0.4217s/iter; left time: 13962.9535s
	iters: 200, epoch: 11 | loss: 0.7725154
	speed: 0.1194s/iter; left time: 3941.9887s
	iters: 300, epoch: 11 | loss: 1.5388792
	speed: 0.1054s/iter; left time: 3467.5758s
Epoch: 11 cost time: 42.384361028671265
Epoch: 11, Steps: 369 | Train Loss: 0.987 Vali Loss: 0.927 Vali Acc: 0.500 Test Loss: 0.927 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.5836892
	speed: 0.4174s/iter; left time: 13667.9426s
	iters: 200, epoch: 12 | loss: 0.6288895
	speed: 0.1038s/iter; left time: 3387.0146s
	iters: 300, epoch: 12 | loss: 0.7798381
	speed: 0.1014s/iter; left time: 3299.3552s
Epoch: 12 cost time: 40.05659484863281
Epoch: 12, Steps: 369 | Train Loss: 0.851 Vali Loss: 0.772 Vali Acc: 0.500 Test Loss: 0.772 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5005675368898979
model parameter : 8368678
model size : 36.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 4.1591291
	speed: 0.1201s/iter; left time: 4421.1929s
	iters: 200, epoch: 1 | loss: 0.4130998
	speed: 0.1056s/iter; left time: 3876.3104s
	iters: 300, epoch: 1 | loss: 1.0281078
	speed: 0.1095s/iter; left time: 4007.4330s
Epoch: 1 cost time: 41.16882061958313
Epoch: 1, Steps: 369 | Train Loss: 1.438 Vali Loss: 0.694 Vali Acc: 0.645 Test Loss: 0.694 Test Acc: 0.645
Validation loss decreased (inf --> -0.645283).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6646702
	speed: 0.4064s/iter; left time: 14806.1889s
	iters: 200, epoch: 2 | loss: 1.1828380
	speed: 0.0975s/iter; left time: 3540.9622s
	iters: 300, epoch: 2 | loss: 1.6940550
	speed: 0.0964s/iter; left time: 3491.2510s
Epoch: 2 cost time: 37.61204648017883
Epoch: 2, Steps: 369 | Train Loss: 1.018 Vali Loss: 0.918 Vali Acc: 0.535 Test Loss: 0.918 Test Acc: 0.535
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.7507910
	speed: 0.4306s/iter; left time: 15528.2419s
	iters: 200, epoch: 3 | loss: 0.9246877
	speed: 0.1170s/iter; left time: 4206.6513s
	iters: 300, epoch: 3 | loss: 1.2452177
	speed: 0.1154s/iter; left time: 4138.0444s
Epoch: 3 cost time: 43.1148579120636
Epoch: 3, Steps: 369 | Train Loss: 1.234 Vali Loss: 1.003 Vali Acc: 0.500 Test Loss: 1.003 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.0587461
	speed: 0.4208s/iter; left time: 15019.9151s
	iters: 200, epoch: 4 | loss: 2.2453411
	speed: 0.1043s/iter; left time: 3713.0791s
	iters: 300, epoch: 4 | loss: 1.0858793
	speed: 0.1058s/iter; left time: 3755.8656s
Epoch: 4 cost time: 40.24445366859436
Epoch: 4, Steps: 369 | Train Loss: 1.010 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.7399575
	speed: 0.4165s/iter; left time: 14714.0635s
	iters: 200, epoch: 5 | loss: 0.7350989
	speed: 0.1076s/iter; left time: 3790.6045s
	iters: 300, epoch: 5 | loss: 0.6920800
	speed: 0.0991s/iter; left time: 3479.8976s
Epoch: 5 cost time: 38.85977911949158
Epoch: 5, Steps: 369 | Train Loss: 1.141 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7806466
	speed: 0.4019s/iter; left time: 14049.7290s
	iters: 200, epoch: 6 | loss: 0.6736789
	speed: 0.1085s/iter; left time: 3781.6075s
	iters: 300, epoch: 6 | loss: 0.8163437
	speed: 0.1117s/iter; left time: 3880.7925s
Epoch: 6 cost time: 40.18831205368042
Epoch: 6, Steps: 369 | Train Loss: 0.798 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6818944
	speed: 0.4141s/iter; left time: 14323.8349s
	iters: 200, epoch: 7 | loss: 0.9249423
	speed: 0.0973s/iter; left time: 3354.6695s
	iters: 300, epoch: 7 | loss: 0.7535402
	speed: 0.0988s/iter; left time: 3398.9454s
Epoch: 7 cost time: 38.464497327804565
Epoch: 7, Steps: 369 | Train Loss: 0.746 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6583872
	speed: 0.4303s/iter; left time: 14725.6742s
	iters: 200, epoch: 8 | loss: 0.7206308
	speed: 0.1116s/iter; left time: 3807.2313s
	iters: 300, epoch: 8 | loss: 0.7394504
	speed: 0.0975s/iter; left time: 3316.9151s
Epoch: 8 cost time: 40.68187594413757
Epoch: 8, Steps: 369 | Train Loss: 0.729 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7215189
	speed: 0.4189s/iter; left time: 14180.8934s
	iters: 200, epoch: 9 | loss: 0.7133767
	speed: 0.1004s/iter; left time: 3388.8803s
	iters: 300, epoch: 9 | loss: 0.7167529
	speed: 0.1041s/iter; left time: 3501.5929s
Epoch: 9 cost time: 39.85393238067627
Epoch: 9, Steps: 369 | Train Loss: 0.719 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.9085296
	speed: 0.4200s/iter; left time: 14062.8962s
	iters: 200, epoch: 10 | loss: 0.7087528
	speed: 0.1052s/iter; left time: 3512.4642s
	iters: 300, epoch: 10 | loss: 0.7185383
	speed: 0.1010s/iter; left time: 3360.2328s
Epoch: 10 cost time: 38.459933280944824
Epoch: 10, Steps: 369 | Train Loss: 0.728 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6372126
	speed: 0.4007s/iter; left time: 13266.7935s
	iters: 200, epoch: 11 | loss: 0.7302195
	speed: 0.1042s/iter; left time: 3439.3104s
	iters: 300, epoch: 11 | loss: 0.6791517
	speed: 0.1141s/iter; left time: 3755.9317s
Epoch: 11 cost time: 39.75013852119446
Epoch: 11, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6452894438138479
model parameter : 8366374
model size : 36.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6020229
	speed: 0.1250s/iter; left time: 4599.9939s
	iters: 200, epoch: 1 | loss: 3.9423277
	speed: 0.1059s/iter; left time: 3888.2697s
	iters: 300, epoch: 1 | loss: 0.3984250
	speed: 0.1020s/iter; left time: 3734.3776s
Epoch: 1 cost time: 40.14946484565735
Epoch: 1, Steps: 369 | Train Loss: 1.371 Vali Loss: 2.239 Vali Acc: 0.500 Test Loss: 2.239 Test Acc: 0.500
Validation loss decreased (inf --> -0.500261).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5565649
	speed: 0.4042s/iter; left time: 14724.9919s
	iters: 200, epoch: 2 | loss: 0.7229365
	speed: 0.0911s/iter; left time: 3309.4134s
	iters: 300, epoch: 2 | loss: 0.6181279
	speed: 0.0965s/iter; left time: 3497.8750s
Epoch: 2 cost time: 37.25018644332886
Epoch: 2, Steps: 369 | Train Loss: 1.026 Vali Loss: 3.284 Vali Acc: 0.500 Test Loss: 3.284 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9136091
	speed: 0.4289s/iter; left time: 15466.5027s
	iters: 200, epoch: 3 | loss: 0.4541718
	speed: 0.1194s/iter; left time: 4293.3471s
	iters: 300, epoch: 3 | loss: 0.6729742
	speed: 0.1057s/iter; left time: 3791.2772s
Epoch: 3 cost time: 42.2935106754303
Epoch: 3, Steps: 369 | Train Loss: 0.996 Vali Loss: 0.682 Vali Acc: 0.573 Test Loss: 0.682 Test Acc: 0.573
Validation loss decreased (-0.500261 --> -0.573489).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7919065
	speed: 0.4171s/iter; left time: 14889.3655s
	iters: 200, epoch: 4 | loss: 0.6757390
	speed: 0.0992s/iter; left time: 3529.9161s
	iters: 300, epoch: 4 | loss: 0.9825046
	speed: 0.0979s/iter; left time: 3473.4841s
Epoch: 4 cost time: 38.36148166656494
Epoch: 4, Steps: 369 | Train Loss: 1.031 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6209140
	speed: 0.4077s/iter; left time: 14401.4213s
	iters: 200, epoch: 5 | loss: 1.3396475
	speed: 0.1046s/iter; left time: 3683.6937s
	iters: 300, epoch: 5 | loss: 1.9697183
	speed: 0.0983s/iter; left time: 3453.9941s
Epoch: 5 cost time: 37.99835658073425
Epoch: 5, Steps: 369 | Train Loss: 1.440 Vali Loss: 0.875 Vali Acc: 0.500 Test Loss: 0.875 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8792979
	speed: 0.3937s/iter; left time: 13761.9720s
	iters: 200, epoch: 6 | loss: 1.7016772
	speed: 0.0968s/iter; left time: 3375.5096s
	iters: 300, epoch: 6 | loss: 0.7842172
	speed: 0.1116s/iter; left time: 3878.8725s
Epoch: 6 cost time: 39.75751185417175
Epoch: 6, Steps: 369 | Train Loss: 1.286 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6165067
	speed: 0.4197s/iter; left time: 14516.6335s
	iters: 200, epoch: 7 | loss: 0.5380159
	speed: 0.0984s/iter; left time: 3392.8973s
	iters: 300, epoch: 7 | loss: 1.0990510
	speed: 0.1002s/iter; left time: 3445.6607s
Epoch: 7 cost time: 39.34087157249451
Epoch: 7, Steps: 369 | Train Loss: 0.952 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7163818
	speed: 0.4189s/iter; left time: 14335.0236s
	iters: 200, epoch: 8 | loss: 0.7680612
	speed: 0.1129s/iter; left time: 3850.9673s
	iters: 300, epoch: 8 | loss: 0.5167565
	speed: 0.1148s/iter; left time: 3904.6523s
Epoch: 8 cost time: 42.28749418258667
Epoch: 8, Steps: 369 | Train Loss: 0.767 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.9598559
	speed: 0.4092s/iter; left time: 13851.7058s
	iters: 200, epoch: 9 | loss: 0.7800241
	speed: 0.0949s/iter; left time: 3204.1554s
	iters: 300, epoch: 9 | loss: 0.7545866
	speed: 0.0962s/iter; left time: 3237.0322s
Epoch: 9 cost time: 37.49069428443909
Epoch: 9, Steps: 369 | Train Loss: 0.743 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7445107
	speed: 0.4015s/iter; left time: 13440.5560s
	iters: 200, epoch: 10 | loss: 0.7366154
	speed: 0.1028s/iter; left time: 3432.5655s
	iters: 300, epoch: 10 | loss: 0.7175562
	speed: 0.1015s/iter; left time: 3376.5712s
Epoch: 10 cost time: 38.237255811691284
Epoch: 10, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.7033834
	speed: 0.3851s/iter; left time: 12749.4713s
	iters: 200, epoch: 11 | loss: 0.9242601
	speed: 0.0936s/iter; left time: 3088.2045s
	iters: 300, epoch: 11 | loss: 0.6521060
	speed: 0.1139s/iter; left time: 3749.3995s
Epoch: 11 cost time: 38.575181007385254
Epoch: 11, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.7092965
	speed: 0.4013s/iter; left time: 13138.9521s
	iters: 200, epoch: 12 | loss: 0.6987035
	speed: 0.1023s/iter; left time: 3337.8112s
	iters: 300, epoch: 12 | loss: 0.7575637
	speed: 0.0986s/iter; left time: 3209.3106s
Epoch: 12 cost time: 38.03120183944702
Epoch: 12, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6383212
	speed: 0.4769s/iter; left time: 15439.1126s
	iters: 200, epoch: 13 | loss: 0.6824219
	speed: 0.2248s/iter; left time: 7254.1589s
	iters: 300, epoch: 13 | loss: 0.6618500
	speed: 0.2077s/iter; left time: 6681.9947s
Epoch: 13 cost time: 72.59733366966248
Epoch: 13, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5734960272417707
model parameter : 8364070
model size : 36.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6401169
	speed: 0.2090s/iter; left time: 7691.8548s
	iters: 200, epoch: 1 | loss: 1.1154372
	speed: 0.1577s/iter; left time: 5788.5433s
	iters: 300, epoch: 1 | loss: 0.5236697
	speed: 0.1863s/iter; left time: 6818.3581s
Epoch: 1 cost time: 66.82339310646057
Epoch: 1, Steps: 369 | Train Loss: 1.442 Vali Loss: 1.001 Vali Acc: 0.577 Test Loss: 1.001 Test Acc: 0.577
Validation loss decreased (inf --> -0.576607).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1979741
	speed: 0.6220s/iter; left time: 22661.0090s
	iters: 200, epoch: 2 | loss: 0.7830880
	speed: 0.1767s/iter; left time: 6420.3765s
	iters: 300, epoch: 2 | loss: 3.3904326
	speed: 0.1873s/iter; left time: 6786.3037s
Epoch: 2 cost time: 67.77760982513428
Epoch: 2, Steps: 369 | Train Loss: 1.099 Vali Loss: 0.751 Vali Acc: 0.650 Test Loss: 0.751 Test Acc: 0.650
Validation loss decreased (-0.576607 --> -0.650390).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.2607036
	speed: 0.6234s/iter; left time: 22482.4312s
	iters: 200, epoch: 3 | loss: 0.8209019
	speed: 0.1570s/iter; left time: 5647.7174s
	iters: 300, epoch: 3 | loss: 0.9191933
	speed: 0.1879s/iter; left time: 6737.4559s
Epoch: 3 cost time: 63.64715600013733
Epoch: 3, Steps: 369 | Train Loss: 1.268 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0099958
	speed: 0.6348s/iter; left time: 22659.8596s
	iters: 200, epoch: 4 | loss: 1.1151350
	speed: 0.1831s/iter; left time: 6516.6585s
	iters: 300, epoch: 4 | loss: 2.2061744
	speed: 0.1974s/iter; left time: 7007.9917s
Epoch: 4 cost time: 70.97681927680969
Epoch: 4, Steps: 369 | Train Loss: 1.134 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.3699828
	speed: 0.6900s/iter; left time: 24374.3496s
	iters: 200, epoch: 5 | loss: 0.9283308
	speed: 0.1727s/iter; left time: 6084.9602s
	iters: 300, epoch: 5 | loss: 0.6697565
	speed: 0.1901s/iter; left time: 6676.7656s
Epoch: 5 cost time: 69.89953446388245
Epoch: 5, Steps: 369 | Train Loss: 0.954 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7788171
	speed: 0.6216s/iter; left time: 21730.1899s
	iters: 200, epoch: 6 | loss: 0.8497605
	speed: 0.1734s/iter; left time: 6045.0682s
	iters: 300, epoch: 6 | loss: 0.7753322
	speed: 0.1915s/iter; left time: 6656.0467s
Epoch: 6 cost time: 67.8443751335144
Epoch: 6, Steps: 369 | Train Loss: 0.838 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6406591
	speed: 0.6262s/iter; left time: 21658.0169s
	iters: 200, epoch: 7 | loss: 0.6111073
	speed: 0.1634s/iter; left time: 5634.6308s
	iters: 300, epoch: 7 | loss: 0.8864434
	speed: 0.1794s/iter; left time: 6168.5089s
Epoch: 7 cost time: 66.10519862174988
Epoch: 7, Steps: 369 | Train Loss: 0.755 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7590513
	speed: 0.6320s/iter; left time: 21627.1747s
	iters: 200, epoch: 8 | loss: 0.7136889
	speed: 0.1800s/iter; left time: 6141.4774s
	iters: 300, epoch: 8 | loss: 0.9602075
	speed: 0.1694s/iter; left time: 5762.7133s
Epoch: 8 cost time: 68.02208924293518
Epoch: 8, Steps: 369 | Train Loss: 0.740 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6938374
	speed: 0.6230s/iter; left time: 21086.5162s
	iters: 200, epoch: 9 | loss: 0.7289034
	speed: 0.1761s/iter; left time: 5941.5431s
	iters: 300, epoch: 9 | loss: 0.7343418
	speed: 0.1904s/iter; left time: 6407.9586s
Epoch: 9 cost time: 68.21657991409302
Epoch: 9, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.8416407
	speed: 0.6733s/iter; left time: 22543.7196s
	iters: 200, epoch: 10 | loss: 0.6708971
	speed: 0.1740s/iter; left time: 5808.6836s
	iters: 300, epoch: 10 | loss: 0.7602056
	speed: 0.1776s/iter; left time: 5909.3847s
Epoch: 10 cost time: 69.83111119270325
Epoch: 10, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6798029
	speed: 0.6557s/iter; left time: 21710.6770s
	iters: 200, epoch: 11 | loss: 0.7165118
	speed: 0.1696s/iter; left time: 5598.5476s
	iters: 300, epoch: 11 | loss: 0.7700723
	speed: 0.1586s/iter; left time: 5218.6591s
Epoch: 11 cost time: 59.38882327079773
Epoch: 11, Steps: 369 | Train Loss: 0.722 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.6849690
	speed: 0.3741s/iter; left time: 12248.6089s
	iters: 200, epoch: 12 | loss: 0.6728094
	speed: 0.0997s/iter; left time: 3254.9464s
	iters: 300, epoch: 12 | loss: 0.6452795
	speed: 0.0941s/iter; left time: 3061.3692s
Epoch: 12 cost time: 36.25156307220459
Epoch: 12, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6503972758229285
model parameter : 7057702
model size : 31.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1720299
	speed: 0.1130s/iter; left time: 4156.9691s
	iters: 200, epoch: 1 | loss: 1.2054738
	speed: 0.0970s/iter; left time: 3559.4802s
	iters: 300, epoch: 1 | loss: 0.6117952
	speed: 0.1056s/iter; left time: 3863.2810s
Epoch: 1 cost time: 38.254565715789795
Epoch: 1, Steps: 369 | Train Loss: 1.428 Vali Loss: 1.017 Vali Acc: 0.512 Test Loss: 1.017 Test Acc: 0.512
Validation loss decreased (inf --> -0.512476).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3187118
	speed: 0.3969s/iter; left time: 14459.2015s
	iters: 200, epoch: 2 | loss: 0.9005049
	speed: 0.0980s/iter; left time: 3559.3406s
	iters: 300, epoch: 2 | loss: 1.4823124
	speed: 0.0928s/iter; left time: 3360.8175s
Epoch: 2 cost time: 37.48594522476196
Epoch: 2, Steps: 369 | Train Loss: 0.900 Vali Loss: 0.627 Vali Acc: 0.659 Test Loss: 0.627 Test Acc: 0.659
Validation loss decreased (-0.512476 --> -0.658904).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0394812
	speed: 0.4136s/iter; left time: 14916.5760s
	iters: 200, epoch: 3 | loss: 0.6354578
	speed: 0.1116s/iter; left time: 4013.4452s
	iters: 300, epoch: 3 | loss: 0.6128786
	speed: 0.0981s/iter; left time: 3518.9833s
Epoch: 3 cost time: 38.99045920372009
Epoch: 3, Steps: 369 | Train Loss: 1.007 Vali Loss: 0.699 Vali Acc: 0.555 Test Loss: 0.699 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6672239
	speed: 0.3624s/iter; left time: 12936.9119s
	iters: 200, epoch: 4 | loss: 0.8934353
	speed: 0.0771s/iter; left time: 2744.9060s
	iters: 300, epoch: 4 | loss: 0.8992141
	speed: 0.1102s/iter; left time: 3910.8690s
Epoch: 4 cost time: 38.62420177459717
Epoch: 4, Steps: 369 | Train Loss: 0.932 Vali Loss: 1.407 Vali Acc: 0.500 Test Loss: 1.407 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6521590
	speed: 0.6215s/iter; left time: 21954.8567s
	iters: 200, epoch: 5 | loss: 0.7709900
	speed: 0.1740s/iter; left time: 6130.0015s
	iters: 300, epoch: 5 | loss: 1.0872952
	speed: 0.1698s/iter; left time: 5963.8903s
Epoch: 5 cost time: 67.14975833892822
Epoch: 5, Steps: 369 | Train Loss: 0.945 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6921623
	speed: 0.6379s/iter; left time: 22298.9685s
	iters: 200, epoch: 6 | loss: 0.9048775
	speed: 0.1817s/iter; left time: 6331.8468s
	iters: 300, epoch: 6 | loss: 0.8637398
	speed: 0.1507s/iter; left time: 5236.0991s
Epoch: 6 cost time: 63.201098918914795
Epoch: 6, Steps: 369 | Train Loss: 0.802 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.8291228
	speed: 0.6026s/iter; left time: 20843.6431s
	iters: 200, epoch: 7 | loss: 0.6419657
	speed: 0.1838s/iter; left time: 6339.2812s
	iters: 300, epoch: 7 | loss: 0.7343658
	speed: 0.1754s/iter; left time: 6032.0002s
Epoch: 7 cost time: 65.46991038322449
Epoch: 7, Steps: 369 | Train Loss: 0.820 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7114889
	speed: 0.6140s/iter; left time: 21009.4484s
	iters: 200, epoch: 8 | loss: 0.7220154
	speed: 0.1842s/iter; left time: 6283.8374s
	iters: 300, epoch: 8 | loss: 0.7642867
	speed: 0.1620s/iter; left time: 5511.3470s
Epoch: 8 cost time: 64.07881212234497
Epoch: 8, Steps: 369 | Train Loss: 0.769 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6762920
	speed: 0.6532s/iter; left time: 22109.3819s
	iters: 200, epoch: 9 | loss: 0.7850128
	speed: 0.2013s/iter; left time: 6792.6220s
	iters: 300, epoch: 9 | loss: 0.7000995
	speed: 0.1900s/iter; left time: 6394.4916s
Epoch: 9 cost time: 69.79163765907288
Epoch: 9, Steps: 369 | Train Loss: 0.746 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6707956
	speed: 0.6390s/iter; left time: 21392.8441s
	iters: 200, epoch: 10 | loss: 0.7937315
	speed: 0.2028s/iter; left time: 6768.6558s
	iters: 300, epoch: 10 | loss: 0.7248526
	speed: 0.1888s/iter; left time: 6283.3107s
Epoch: 10 cost time: 70.03631091117859
Epoch: 10, Steps: 369 | Train Loss: 0.743 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.8558226
	speed: 0.6300s/iter; left time: 20859.9604s
	iters: 200, epoch: 11 | loss: 1.0801259
	speed: 0.1886s/iter; left time: 6225.1780s
	iters: 300, epoch: 11 | loss: 0.8110101
	speed: 0.1886s/iter; left time: 6208.3620s
Epoch: 11 cost time: 69.02621269226074
Epoch: 11, Steps: 369 | Train Loss: 0.740 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.6529887
	speed: 0.6384s/iter; left time: 20903.2667s
	iters: 200, epoch: 12 | loss: 0.7180830
	speed: 0.1919s/iter; left time: 6263.4903s
	iters: 300, epoch: 12 | loss: 0.7180927
	speed: 0.1892s/iter; left time: 6156.1598s
Epoch: 12 cost time: 67.65216946601868
Epoch: 12, Steps: 369 | Train Loss: 0.730 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6589103291713961
model parameter : 7055398
model size : 31.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.6209280
	speed: 0.2002s/iter; left time: 7365.9642s
	iters: 200, epoch: 1 | loss: 1.7992492
	speed: 0.1813s/iter; left time: 6655.4809s
	iters: 300, epoch: 1 | loss: 0.7023876
	speed: 0.1847s/iter; left time: 6759.0353s
Epoch: 1 cost time: 69.7943503856659
Epoch: 1, Steps: 369 | Train Loss: 1.606 Vali Loss: 1.660 Vali Acc: 0.500 Test Loss: 1.660 Test Acc: 0.500
Validation loss decreased (inf --> -0.499983).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4595341
	speed: 0.6732s/iter; left time: 24527.4445s
	iters: 200, epoch: 2 | loss: 0.5699286
	speed: 0.1799s/iter; left time: 6535.2555s
	iters: 300, epoch: 2 | loss: 0.9633667
	speed: 0.2087s/iter; left time: 7560.0672s
Epoch: 2 cost time: 72.14307880401611
Epoch: 2, Steps: 369 | Train Loss: 0.975 Vali Loss: 1.279 Vali Acc: 0.552 Test Loss: 1.279 Test Acc: 0.552
Validation loss decreased (-0.499983 --> -0.551917).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2003109
	speed: 0.7049s/iter; left time: 25420.5488s
	iters: 200, epoch: 3 | loss: 0.8884907
	speed: 0.2016s/iter; left time: 7249.9382s
	iters: 300, epoch: 3 | loss: 0.7355115
	speed: 0.1995s/iter; left time: 7153.5546s
Epoch: 3 cost time: 75.07609748840332
Epoch: 3, Steps: 369 | Train Loss: 1.029 Vali Loss: 0.945 Vali Acc: 0.500 Test Loss: 0.945 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7057156
	speed: 0.6552s/iter; left time: 23388.4844s
	iters: 200, epoch: 4 | loss: 1.1910176
	speed: 0.1704s/iter; left time: 6066.7262s
	iters: 300, epoch: 4 | loss: 1.1873459
	speed: 0.1373s/iter; left time: 4873.7935s
Epoch: 4 cost time: 56.364983797073364
Epoch: 4, Steps: 369 | Train Loss: 1.027 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8506497
	speed: 0.5206s/iter; left time: 18390.9386s
	iters: 200, epoch: 5 | loss: 0.7310848
	speed: 0.1806s/iter; left time: 6362.8702s
	iters: 300, epoch: 5 | loss: 1.5181143
	speed: 0.1824s/iter; left time: 6406.7796s
Epoch: 5 cost time: 69.09620547294617
Epoch: 5, Steps: 369 | Train Loss: 0.844 Vali Loss: 1.060 Vali Acc: 0.500 Test Loss: 1.060 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7435194
	speed: 0.6739s/iter; left time: 23555.8441s
	iters: 200, epoch: 6 | loss: 0.6965055
	speed: 0.1900s/iter; left time: 6620.9544s
	iters: 300, epoch: 6 | loss: 0.6986679
	speed: 0.1771s/iter; left time: 6155.5465s
Epoch: 6 cost time: 71.97573900222778
Epoch: 6, Steps: 369 | Train Loss: 0.754 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6341442
	speed: 0.6422s/iter; left time: 22210.0448s
	iters: 200, epoch: 7 | loss: 0.6976508
	speed: 0.1847s/iter; left time: 6368.1039s
	iters: 300, epoch: 7 | loss: 0.6875017
	speed: 0.1837s/iter; left time: 6315.9137s
Epoch: 7 cost time: 70.92217946052551
Epoch: 7, Steps: 369 | Train Loss: 0.733 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6908190
	speed: 0.7056s/iter; left time: 24143.3540s
	iters: 200, epoch: 8 | loss: 0.6814263
	speed: 0.1907s/iter; left time: 6507.1904s
	iters: 300, epoch: 8 | loss: 0.6362564
	speed: 0.1705s/iter; left time: 5800.7285s
Epoch: 8 cost time: 71.64672374725342
Epoch: 8, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6997417
	speed: 0.7149s/iter; left time: 24199.9004s
	iters: 200, epoch: 9 | loss: 0.6828908
	speed: 0.2291s/iter; left time: 7730.3757s
	iters: 300, epoch: 9 | loss: 0.7191458
	speed: 0.1644s/iter; left time: 5533.3177s
Epoch: 9 cost time: 71.10055875778198
Epoch: 9, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.8840005
	speed: 0.5745s/iter; left time: 19234.8964s
	iters: 200, epoch: 10 | loss: 0.6904457
	speed: 0.1996s/iter; left time: 6662.9250s
	iters: 300, epoch: 10 | loss: 0.7544059
	speed: 0.1778s/iter; left time: 5916.2670s
Epoch: 10 cost time: 67.5835349559784
Epoch: 10, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.694 Vali Acc: 0.499 Test Loss: 0.694 Test Acc: 0.499
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6721297
	speed: 0.6391s/iter; left time: 21162.6776s
	iters: 200, epoch: 11 | loss: 0.6503035
	speed: 0.1892s/iter; left time: 6245.9641s
	iters: 300, epoch: 11 | loss: 0.7341906
	speed: 0.1989s/iter; left time: 6547.5884s
Epoch: 11 cost time: 70.032546043396
Epoch: 11, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7753017
	speed: 0.6297s/iter; left time: 20618.4087s
	iters: 200, epoch: 12 | loss: 0.7890105
	speed: 0.1784s/iter; left time: 5822.6397s
	iters: 300, epoch: 12 | loss: 0.7102996
	speed: 0.1872s/iter; left time: 6091.8620s
Epoch: 12 cost time: 65.54043436050415
Epoch: 12, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5519296254256527
model parameter : 7053094
model size : 31.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0046941
	speed: 0.2197s/iter; left time: 8085.0102s
	iters: 200, epoch: 1 | loss: 0.5489736
	speed: 0.1803s/iter; left time: 6618.9254s
	iters: 300, epoch: 1 | loss: 0.5244675
	speed: 0.2079s/iter; left time: 7609.1201s
Epoch: 1 cost time: 75.33688855171204
Epoch: 1, Steps: 369 | Train Loss: 1.259 Vali Loss: 0.729 Vali Acc: 0.595 Test Loss: 0.729 Test Acc: 0.595
Validation loss decreased (inf --> -0.595339).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6612834
	speed: 0.6935s/iter; left time: 25264.6815s
	iters: 200, epoch: 2 | loss: 0.9654031
	speed: 0.1802s/iter; left time: 6545.2682s
	iters: 300, epoch: 2 | loss: 0.8345934
	speed: 0.1456s/iter; left time: 5273.9504s
Epoch: 2 cost time: 59.73421788215637
Epoch: 2, Steps: 369 | Train Loss: 1.064 Vali Loss: 5.199 Vali Acc: 0.500 Test Loss: 5.199 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.4437995
	speed: 0.5061s/iter; left time: 18252.8742s
	iters: 200, epoch: 3 | loss: 1.6551419
	speed: 0.1743s/iter; left time: 6267.8347s
	iters: 300, epoch: 3 | loss: 1.9635457
	speed: 0.1706s/iter; left time: 6118.3376s
Epoch: 3 cost time: 66.79780697822571
Epoch: 3, Steps: 369 | Train Loss: 1.221 Vali Loss: 1.464 Vali Acc: 0.500 Test Loss: 1.464 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6836354
	speed: 0.6459s/iter; left time: 23054.5797s
	iters: 200, epoch: 4 | loss: 1.8537027
	speed: 0.1849s/iter; left time: 6581.9322s
	iters: 300, epoch: 4 | loss: 0.6846662
	speed: 0.1777s/iter; left time: 6307.4662s
Epoch: 4 cost time: 69.80645203590393
Epoch: 4, Steps: 369 | Train Loss: 0.974 Vali Loss: 2.269 Vali Acc: 0.500 Test Loss: 2.269 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.7429628
	speed: 0.6463s/iter; left time: 22831.7043s
	iters: 200, epoch: 5 | loss: 0.9681792
	speed: 0.1960s/iter; left time: 6904.7937s
	iters: 300, epoch: 5 | loss: 0.7815471
	speed: 0.1725s/iter; left time: 6058.4847s
Epoch: 5 cost time: 69.961843252182
Epoch: 5, Steps: 369 | Train Loss: 0.973 Vali Loss: 0.869 Vali Acc: 0.500 Test Loss: 0.869 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7454536
	speed: 0.6418s/iter; left time: 22435.8490s
	iters: 200, epoch: 6 | loss: 0.9608432
	speed: 0.1880s/iter; left time: 6551.7388s
	iters: 300, epoch: 6 | loss: 0.7254097
	speed: 0.1779s/iter; left time: 6182.9013s
Epoch: 6 cost time: 67.45021176338196
Epoch: 6, Steps: 369 | Train Loss: 0.787 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.8973984
	speed: 0.6350s/iter; left time: 21964.2136s
	iters: 200, epoch: 7 | loss: 0.6610496
	speed: 0.1962s/iter; left time: 6765.9449s
	iters: 300, epoch: 7 | loss: 0.7233240
	speed: 0.1661s/iter; left time: 5710.7416s
Epoch: 7 cost time: 69.75382280349731
Epoch: 7, Steps: 369 | Train Loss: 0.733 Vali Loss: 1.445 Vali Acc: 0.500 Test Loss: 1.445 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6843649
	speed: 0.6842s/iter; left time: 23412.4739s
	iters: 200, epoch: 8 | loss: 0.5933422
	speed: 0.2126s/iter; left time: 7255.0571s
	iters: 300, epoch: 8 | loss: 0.6862903
	speed: 0.2072s/iter; left time: 7048.3599s
Epoch: 8 cost time: 72.92228269577026
Epoch: 8, Steps: 369 | Train Loss: 0.742 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7560297
	speed: 0.6308s/iter; left time: 21353.2193s
	iters: 200, epoch: 9 | loss: 0.6513572
	speed: 0.1815s/iter; left time: 6127.0402s
	iters: 300, epoch: 9 | loss: 0.6925908
	speed: 0.1895s/iter; left time: 6375.5107s
Epoch: 9 cost time: 69.32553291320801
Epoch: 9, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7339683
	speed: 0.6407s/iter; left time: 21449.3577s
	iters: 200, epoch: 10 | loss: 0.5994787
	speed: 0.1859s/iter; left time: 6206.5752s
	iters: 300, epoch: 10 | loss: 0.6670291
	speed: 0.1870s/iter; left time: 6224.4267s
Epoch: 10 cost time: 67.70191955566406
Epoch: 10, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6721855
	speed: 0.6475s/iter; left time: 21438.3626s
	iters: 200, epoch: 11 | loss: 0.7378453
	speed: 0.1803s/iter; left time: 5953.3004s
	iters: 300, epoch: 11 | loss: 0.7315293
	speed: 0.1946s/iter; left time: 6403.7656s
Epoch: 11 cost time: 70.14622831344604
Epoch: 11, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5953461975028377
model parameter : 7050790
model size : 31.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.8020101
	speed: 0.2091s/iter; left time: 7696.4523s
	iters: 200, epoch: 1 | loss: 1.3319484
	speed: 0.1771s/iter; left time: 6499.5073s
	iters: 300, epoch: 1 | loss: 0.5330951
	speed: 0.1886s/iter; left time: 6901.1696s
Epoch: 1 cost time: 72.2246024608612
Epoch: 1, Steps: 369 | Train Loss: 1.783 Vali Loss: 0.848 Vali Acc: 0.634 Test Loss: 0.848 Test Acc: 0.634
Validation loss decreased (inf --> -0.633930).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5883800
	speed: 0.5387s/iter; left time: 19626.2705s
	iters: 200, epoch: 2 | loss: 0.4983216
	speed: 0.1713s/iter; left time: 6223.0545s
	iters: 300, epoch: 2 | loss: 0.5936940
	speed: 0.2081s/iter; left time: 7540.4090s
Epoch: 2 cost time: 62.091936111450195
Epoch: 2, Steps: 369 | Train Loss: 0.993 Vali Loss: 0.662 Vali Acc: 0.684 Test Loss: 0.662 Test Acc: 0.684
Validation loss decreased (-0.633930 --> -0.683875).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4295337
	speed: 0.6309s/iter; left time: 22751.6526s
	iters: 200, epoch: 3 | loss: 0.6452128
	speed: 0.1859s/iter; left time: 6687.2412s
	iters: 300, epoch: 3 | loss: 0.8988397
	speed: 0.2001s/iter; left time: 7174.7554s
Epoch: 3 cost time: 67.856041431427
Epoch: 3, Steps: 369 | Train Loss: 0.948 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7996874
	speed: 0.6147s/iter; left time: 21942.2456s
	iters: 200, epoch: 4 | loss: 1.1172266
	speed: 0.1737s/iter; left time: 6184.2471s
	iters: 300, epoch: 4 | loss: 0.9691368
	speed: 0.1915s/iter; left time: 6798.2667s
Epoch: 4 cost time: 68.89349722862244
Epoch: 4, Steps: 369 | Train Loss: 1.066 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7737232
	speed: 0.6201s/iter; left time: 21906.0136s
	iters: 200, epoch: 5 | loss: 0.6610431
	speed: 0.1698s/iter; left time: 5979.7374s
	iters: 300, epoch: 5 | loss: 1.6991901
	speed: 0.1877s/iter; left time: 6592.3110s
Epoch: 5 cost time: 67.12817597389221
Epoch: 5, Steps: 369 | Train Loss: 1.090 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.0367707
	speed: 0.6491s/iter; left time: 22690.2718s
	iters: 200, epoch: 6 | loss: 0.7366000
	speed: 0.1621s/iter; left time: 5649.3114s
	iters: 300, epoch: 6 | loss: 0.8153805
	speed: 0.1872s/iter; left time: 6506.0667s
Epoch: 6 cost time: 68.68150186538696
Epoch: 6, Steps: 369 | Train Loss: 0.942 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.1301461
	speed: 0.6120s/iter; left time: 21167.2142s
	iters: 200, epoch: 7 | loss: 0.7082084
	speed: 0.1949s/iter; left time: 6721.7436s
	iters: 300, epoch: 7 | loss: 0.7880325
	speed: 0.1938s/iter; left time: 6663.2696s
Epoch: 7 cost time: 71.86770915985107
Epoch: 7, Steps: 369 | Train Loss: 0.813 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7819917
	speed: 0.6737s/iter; left time: 23054.3070s
	iters: 200, epoch: 8 | loss: 0.7632979
	speed: 0.1876s/iter; left time: 6398.8592s
	iters: 300, epoch: 8 | loss: 0.9288884
	speed: 0.2090s/iter; left time: 7109.1871s
Epoch: 8 cost time: 74.10417938232422
Epoch: 8, Steps: 369 | Train Loss: 0.770 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7149801
	speed: 0.6419s/iter; left time: 21728.0664s
	iters: 200, epoch: 9 | loss: 0.7512485
	speed: 0.1745s/iter; left time: 5888.4258s
	iters: 300, epoch: 9 | loss: 0.7410698
	speed: 0.1624s/iter; left time: 5463.7406s
Epoch: 9 cost time: 65.86275506019592
Epoch: 9, Steps: 369 | Train Loss: 0.752 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.9201024
	speed: 0.6187s/iter; left time: 20715.3058s
	iters: 200, epoch: 10 | loss: 0.6630435
	speed: 0.1741s/iter; left time: 5809.8806s
	iters: 300, epoch: 10 | loss: 0.6756089
	speed: 0.1705s/iter; left time: 5674.9362s
Epoch: 10 cost time: 65.16241145133972
Epoch: 10, Steps: 369 | Train Loss: 0.740 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7575333
	speed: 0.6213s/iter; left time: 20571.4500s
	iters: 200, epoch: 11 | loss: 0.9309710
	speed: 0.1923s/iter; left time: 6349.6576s
	iters: 300, epoch: 11 | loss: 0.6203029
	speed: 0.1584s/iter; left time: 5213.7317s
Epoch: 11 cost time: 66.90871930122375
Epoch: 11, Steps: 369 | Train Loss: 0.730 Vali Loss: 0.763 Vali Acc: 0.500 Test Loss: 0.763 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7325608
	speed: 0.6102s/iter; left time: 19979.9112s
	iters: 200, epoch: 12 | loss: 0.7493916
	speed: 0.1865s/iter; left time: 6087.3122s
	iters: 300, epoch: 12 | loss: 0.6784981
	speed: 0.1875s/iter; left time: 6101.4550s
Epoch: 12 cost time: 67.76487946510315
Epoch: 12, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6838819523269013
model parameter : 6401062
model size : 29.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.5566247
	speed: 0.1979s/iter; left time: 7282.3284s
	iters: 200, epoch: 1 | loss: 1.6808565
	speed: 0.2103s/iter; left time: 7719.2848s
	iters: 300, epoch: 1 | loss: 0.5908782
	speed: 0.1975s/iter; left time: 7227.3416s
Epoch: 1 cost time: 73.9997181892395
Epoch: 1, Steps: 369 | Train Loss: 1.291 Vali Loss: 1.848 Vali Acc: 0.500 Test Loss: 1.848 Test Acc: 0.500
Validation loss decreased (inf --> -0.499982).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2047002
	speed: 0.6468s/iter; left time: 23562.8995s
	iters: 200, epoch: 2 | loss: 1.2205302
	speed: 0.1719s/iter; left time: 6244.1107s
	iters: 300, epoch: 2 | loss: 1.4135160
	speed: 0.1888s/iter; left time: 6842.2871s
Epoch: 2 cost time: 65.4651939868927
Epoch: 2, Steps: 369 | Train Loss: 0.911 Vali Loss: 0.974 Vali Acc: 0.549 Test Loss: 0.974 Test Acc: 0.549
Validation loss decreased (-0.499982 --> -0.549366).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8281247
	speed: 0.4525s/iter; left time: 16318.5609s
	iters: 200, epoch: 3 | loss: 0.6615354
	speed: 0.1579s/iter; left time: 5677.0821s
	iters: 300, epoch: 3 | loss: 1.0317457
	speed: 0.1769s/iter; left time: 6345.4294s
Epoch: 3 cost time: 54.42825651168823
Epoch: 3, Steps: 369 | Train Loss: 1.060 Vali Loss: 4.803 Vali Acc: 0.500 Test Loss: 4.803 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7225760
	speed: 0.5958s/iter; left time: 21264.9074s
	iters: 200, epoch: 4 | loss: 0.8802046
	speed: 0.1698s/iter; left time: 6043.0587s
	iters: 300, epoch: 4 | loss: 0.9406706
	speed: 0.1799s/iter; left time: 6386.6697s
Epoch: 4 cost time: 64.4755175113678
Epoch: 4, Steps: 369 | Train Loss: 1.202 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7765180
	speed: 0.6050s/iter; left time: 21372.2469s
	iters: 200, epoch: 5 | loss: 1.3490026
	speed: 0.1641s/iter; left time: 5778.7252s
	iters: 300, epoch: 5 | loss: 1.0905197
	speed: 0.1886s/iter; left time: 6623.9018s
Epoch: 5 cost time: 66.51696300506592
Epoch: 5, Steps: 369 | Train Loss: 1.228 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6337271
	speed: 0.5856s/iter; left time: 20471.3278s
	iters: 200, epoch: 6 | loss: 0.7082996
	speed: 0.1793s/iter; left time: 6250.2972s
	iters: 300, epoch: 6 | loss: 0.6970350
	speed: 0.1905s/iter; left time: 6620.2072s
Epoch: 6 cost time: 65.6432433128357
Epoch: 6, Steps: 369 | Train Loss: 0.788 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6821957
	speed: 0.6522s/iter; left time: 22557.3445s
	iters: 200, epoch: 7 | loss: 0.7207559
	speed: 0.1868s/iter; left time: 6440.5453s
	iters: 300, epoch: 7 | loss: 0.6968001
	speed: 0.2052s/iter; left time: 7057.7473s
Epoch: 7 cost time: 72.22735857963562
Epoch: 7, Steps: 369 | Train Loss: 0.732 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6674357
	speed: 0.6148s/iter; left time: 21035.6206s
	iters: 200, epoch: 8 | loss: 0.7129674
	speed: 0.1891s/iter; left time: 6451.2276s
	iters: 300, epoch: 8 | loss: 0.7048744
	speed: 0.1718s/iter; left time: 5843.2068s
Epoch: 8 cost time: 66.39664888381958
Epoch: 8, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6845701
	speed: 0.6139s/iter; left time: 20779.9878s
	iters: 200, epoch: 9 | loss: 1.3067666
	speed: 0.1753s/iter; left time: 5915.8638s
	iters: 300, epoch: 9 | loss: 2.3580337
	speed: 0.1986s/iter; left time: 6682.8243s
Epoch: 9 cost time: 67.58864140510559
Epoch: 9, Steps: 369 | Train Loss: 1.057 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.7960473
	speed: 0.5992s/iter; left time: 20061.2132s
	iters: 200, epoch: 10 | loss: 0.7236632
	speed: 0.1820s/iter; left time: 6075.6043s
	iters: 300, epoch: 10 | loss: 0.8082040
	speed: 0.1773s/iter; left time: 5901.0575s
Epoch: 10 cost time: 64.8549337387085
Epoch: 10, Steps: 369 | Train Loss: 0.887 Vali Loss: 1.008 Vali Acc: 0.500 Test Loss: 1.008 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.8052486
	speed: 0.6203s/iter; left time: 20537.3854s
	iters: 200, epoch: 11 | loss: 0.6117001
	speed: 0.1710s/iter; left time: 5646.4792s
	iters: 300, epoch: 11 | loss: 0.9295848
	speed: 0.1893s/iter; left time: 6230.4414s
Epoch: 11 cost time: 65.47279572486877
Epoch: 11, Steps: 369 | Train Loss: 0.744 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7491196
	speed: 0.6023s/iter; left time: 19720.8853s
	iters: 200, epoch: 12 | loss: 0.7629852
	speed: 0.1990s/iter; left time: 6497.2550s
	iters: 300, epoch: 12 | loss: 0.7188590
	speed: 0.1943s/iter; left time: 6322.5792s
Epoch: 12 cost time: 70.40911769866943
Epoch: 12, Steps: 369 | Train Loss: 0.731 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5493757094211124
model parameter : 6398758
model size : 29.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.2738330
	speed: 0.2281s/iter; left time: 8395.2231s
	iters: 200, epoch: 1 | loss: 1.3260622
	speed: 0.1777s/iter; left time: 6521.4428s
	iters: 300, epoch: 1 | loss: 4.8482628
	speed: 0.1873s/iter; left time: 6856.3838s
Epoch: 1 cost time: 71.06948781013489
Epoch: 1, Steps: 369 | Train Loss: 1.544 Vali Loss: 1.343 Vali Acc: 0.510 Test Loss: 1.343 Test Acc: 0.510
Validation loss decreased (inf --> -0.509635).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5305167
	speed: 0.6022s/iter; left time: 21938.3142s
	iters: 200, epoch: 2 | loss: 0.6750501
	speed: 0.1880s/iter; left time: 6831.7018s
	iters: 300, epoch: 2 | loss: 0.8057197
	speed: 0.1907s/iter; left time: 6907.6814s
Epoch: 2 cost time: 67.5668032169342
Epoch: 2, Steps: 369 | Train Loss: 0.941 Vali Loss: 2.204 Vali Acc: 0.512 Test Loss: 2.204 Test Acc: 0.512
Validation loss decreased (-0.509635 --> -0.511896).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6588281
	speed: 0.6092s/iter; left time: 21971.2990s
	iters: 200, epoch: 3 | loss: 0.4961873
	speed: 0.1348s/iter; left time: 4846.9893s
	iters: 300, epoch: 3 | loss: 0.8038187
	speed: 0.0756s/iter; left time: 2712.1083s
Epoch: 3 cost time: 44.70250391960144
Epoch: 3, Steps: 369 | Train Loss: 0.995 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0644597
	speed: 0.5173s/iter; left time: 18463.2429s
	iters: 200, epoch: 4 | loss: 0.5835186
	speed: 0.1804s/iter; left time: 6419.5927s
	iters: 300, epoch: 4 | loss: 0.9127288
	speed: 0.1842s/iter; left time: 6537.0788s
Epoch: 4 cost time: 67.07272553443909
Epoch: 4, Steps: 369 | Train Loss: 0.974 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.9780441
	speed: 0.5906s/iter; left time: 20862.5847s
	iters: 200, epoch: 5 | loss: 0.7667679
	speed: 0.1719s/iter; left time: 6056.4185s
	iters: 300, epoch: 5 | loss: 0.7159416
	speed: 0.1894s/iter; left time: 6654.0922s
Epoch: 5 cost time: 66.36310529708862
Epoch: 5, Steps: 369 | Train Loss: 0.903 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6604627
	speed: 0.6448s/iter; left time: 22539.3469s
	iters: 200, epoch: 6 | loss: 0.6686451
	speed: 0.1884s/iter; left time: 6567.7310s
	iters: 300, epoch: 6 | loss: 0.7680122
	speed: 0.1958s/iter; left time: 6803.7077s
Epoch: 6 cost time: 68.11400938034058
Epoch: 6, Steps: 369 | Train Loss: 0.752 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7151179
	speed: 0.6400s/iter; left time: 22136.3897s
	iters: 200, epoch: 7 | loss: 0.7462753
	speed: 0.1616s/iter; left time: 5574.4721s
	iters: 300, epoch: 7 | loss: 0.7009975
	speed: 0.1852s/iter; left time: 6367.0960s
Epoch: 7 cost time: 65.77806234359741
Epoch: 7, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6294276
	speed: 0.6123s/iter; left time: 20950.8290s
	iters: 200, epoch: 8 | loss: 0.6774880
	speed: 0.1858s/iter; left time: 6339.9349s
	iters: 300, epoch: 8 | loss: 0.7691591
	speed: 0.1877s/iter; left time: 6384.0269s
Epoch: 8 cost time: 67.08651328086853
Epoch: 8, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6960573
	speed: 0.5674s/iter; left time: 19205.3794s
	iters: 200, epoch: 9 | loss: 0.6895454
	speed: 0.1795s/iter; left time: 6057.5072s
	iters: 300, epoch: 9 | loss: 0.7095688
	speed: 0.1790s/iter; left time: 6024.2087s
Epoch: 9 cost time: 64.53406119346619
Epoch: 9, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6879424
	speed: 0.6132s/iter; left time: 20529.9443s
	iters: 200, epoch: 10 | loss: 0.6830277
	speed: 0.1675s/iter; left time: 5592.2048s
	iters: 300, epoch: 10 | loss: 0.6538721
	speed: 0.1813s/iter; left time: 6033.2168s
Epoch: 10 cost time: 64.2225432395935
Epoch: 10, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7968163
	speed: 0.6018s/iter; left time: 19925.9105s
	iters: 200, epoch: 11 | loss: 0.7139733
	speed: 0.1770s/iter; left time: 5842.5744s
	iters: 300, epoch: 11 | loss: 0.6801772
	speed: 0.1838s/iter; left time: 6049.5265s
Epoch: 11 cost time: 67.06699848175049
Epoch: 11, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7800887
	speed: 0.6655s/iter; left time: 21788.8713s
	iters: 200, epoch: 12 | loss: 0.6890085
	speed: 0.2088s/iter; left time: 6814.8111s
	iters: 300, epoch: 12 | loss: 0.7040976
	speed: 0.1979s/iter; left time: 6441.3219s
Epoch: 12 cost time: 73.17983651161194
Epoch: 12, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5119182746878547
model parameter : 6396454
model size : 29.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.6034982
	speed: 0.1997s/iter; left time: 7347.3444s
	iters: 200, epoch: 1 | loss: 1.8691214
	speed: 0.1717s/iter; left time: 6300.7922s
	iters: 300, epoch: 1 | loss: 0.5818866
	speed: 0.1582s/iter; left time: 5789.4221s
Epoch: 1 cost time: 62.861327171325684
Epoch: 1, Steps: 369 | Train Loss: 1.485 Vali Loss: 1.009 Vali Acc: 0.576 Test Loss: 1.009 Test Acc: 0.576
Validation loss decreased (inf --> -0.576040).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9731150
	speed: 0.3866s/iter; left time: 14083.3166s
	iters: 200, epoch: 2 | loss: 0.8059431
	speed: 0.1786s/iter; left time: 6490.3625s
	iters: 300, epoch: 2 | loss: 0.6443816
	speed: 0.1787s/iter; left time: 6476.0239s
Epoch: 2 cost time: 55.73708534240723
Epoch: 2, Steps: 369 | Train Loss: 1.009 Vali Loss: 0.850 Vali Acc: 0.600 Test Loss: 0.850 Test Acc: 0.600
Validation loss decreased (-0.576040 --> -0.600446).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7982255
	speed: 0.5744s/iter; left time: 20715.5114s
	iters: 200, epoch: 3 | loss: 1.0636133
	speed: 0.1752s/iter; left time: 6302.1319s
	iters: 300, epoch: 3 | loss: 1.5833297
	speed: 0.1717s/iter; left time: 6156.3121s
Epoch: 3 cost time: 62.44225716590881
Epoch: 3, Steps: 369 | Train Loss: 0.911 Vali Loss: 0.670 Vali Acc: 0.615 Test Loss: 0.670 Test Acc: 0.615
Validation loss decreased (-0.600446 --> -0.614920).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0911069
	speed: 0.5785s/iter; left time: 20649.0426s
	iters: 200, epoch: 4 | loss: 0.8619871
	speed: 0.1795s/iter; left time: 6388.5559s
	iters: 300, epoch: 4 | loss: 1.3690103
	speed: 0.1825s/iter; left time: 6477.5170s
Epoch: 4 cost time: 63.72127103805542
Epoch: 4, Steps: 369 | Train Loss: 1.010 Vali Loss: 2.902 Vali Acc: 0.500 Test Loss: 2.902 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1676731
	speed: 0.6090s/iter; left time: 21512.4544s
	iters: 200, epoch: 5 | loss: 0.9879855
	speed: 0.2096s/iter; left time: 7382.8080s
	iters: 300, epoch: 5 | loss: 0.7457712
	speed: 0.1868s/iter; left time: 6562.6488s
Epoch: 5 cost time: 69.08177495002747
Epoch: 5, Steps: 369 | Train Loss: 0.928 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6107896
	speed: 0.6087s/iter; left time: 21278.5257s
	iters: 200, epoch: 6 | loss: 0.6142691
	speed: 0.1762s/iter; left time: 6142.0413s
	iters: 300, epoch: 6 | loss: 0.6878217
	speed: 0.1896s/iter; left time: 6588.6780s
Epoch: 6 cost time: 65.25681257247925
Epoch: 6, Steps: 369 | Train Loss: 0.752 Vali Loss: 0.693 Vali Acc: 0.501 Test Loss: 0.693 Test Acc: 0.501
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.8411254
	speed: 0.5851s/iter; left time: 20235.7728s
	iters: 200, epoch: 7 | loss: 0.8136783
	speed: 0.1704s/iter; left time: 5876.1576s
	iters: 300, epoch: 7 | loss: 0.8901212
	speed: 0.1739s/iter; left time: 5980.5687s
Epoch: 7 cost time: 61.86029648780823
Epoch: 7, Steps: 369 | Train Loss: 0.738 Vali Loss: 0.872 Vali Acc: 0.500 Test Loss: 0.872 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7318611
	speed: 0.5898s/iter; left time: 20182.0073s
	iters: 200, epoch: 8 | loss: 0.7042677
	speed: 0.1716s/iter; left time: 5855.1436s
	iters: 300, epoch: 8 | loss: 0.6265604
	speed: 0.1774s/iter; left time: 6034.7076s
Epoch: 8 cost time: 62.0255331993103
Epoch: 8, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6938651
	speed: 0.6232s/iter; left time: 21094.8668s
	iters: 200, epoch: 9 | loss: 0.6267826
	speed: 0.1840s/iter; left time: 6211.3577s
	iters: 300, epoch: 9 | loss: 0.9536896
	speed: 0.1763s/iter; left time: 5932.5461s
Epoch: 9 cost time: 67.61993169784546
Epoch: 9, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7618326
	speed: 0.6303s/iter; left time: 21102.1378s
	iters: 200, epoch: 10 | loss: 0.5966694
	speed: 0.2183s/iter; left time: 7288.2375s
	iters: 300, epoch: 10 | loss: 0.7300879
	speed: 0.2153s/iter; left time: 7163.5853s
Epoch: 10 cost time: 74.56989407539368
Epoch: 10, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6657406
	speed: 0.6881s/iter; left time: 22783.6064s
	iters: 200, epoch: 11 | loss: 0.6552346
	speed: 0.2002s/iter; left time: 6609.3630s
	iters: 300, epoch: 11 | loss: 0.6424662
	speed: 0.2085s/iter; left time: 6860.6394s
Epoch: 11 cost time: 74.75946307182312
Epoch: 11, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.7171609
	speed: 0.6646s/iter; left time: 21759.4628s
	iters: 200, epoch: 12 | loss: 0.7447611
	speed: 0.1926s/iter; left time: 6285.7901s
	iters: 300, epoch: 12 | loss: 0.7029501
	speed: 0.1698s/iter; left time: 5525.9184s
Epoch: 12 cost time: 68.63059902191162
Epoch: 12, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.7747911
	speed: 0.6668s/iter; left time: 21587.2775s
	iters: 200, epoch: 13 | loss: 0.6438087
	speed: 0.2071s/iter; left time: 6684.8980s
	iters: 300, epoch: 13 | loss: 0.7198309
	speed: 0.1937s/iter; left time: 6230.3143s
Epoch: 13 cost time: 72.12271451950073
Epoch: 13, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6149262202043133
model parameter : 6394150
model size : 29.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6921970
	speed: 0.2268s/iter; left time: 8346.8348s
	iters: 200, epoch: 1 | loss: 1.6932846
	speed: 0.1995s/iter; left time: 7320.6365s
	iters: 300, epoch: 1 | loss: 1.2350506
	speed: 0.1662s/iter; left time: 6084.5443s
Epoch: 1 cost time: 71.38889861106873
Epoch: 1, Steps: 369 | Train Loss: 1.439 Vali Loss: 1.042 Vali Acc: 0.535 Test Loss: 1.042 Test Acc: 0.535
Validation loss decreased (inf --> -0.535461).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6114012
	speed: 0.6180s/iter; left time: 22513.9927s
	iters: 200, epoch: 2 | loss: 0.8576632
	speed: 0.1017s/iter; left time: 3695.0313s
	iters: 300, epoch: 2 | loss: 0.5198697
	speed: 0.0875s/iter; left time: 3170.3804s
Epoch: 2 cost time: 42.07251262664795
Epoch: 2, Steps: 369 | Train Loss: 0.953 Vali Loss: 1.594 Vali Acc: 0.528 Test Loss: 1.594 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2107160
	speed: 0.6138s/iter; left time: 22134.8292s
	iters: 200, epoch: 3 | loss: 0.7837532
	speed: 0.2104s/iter; left time: 7565.9120s
	iters: 300, epoch: 3 | loss: 0.7479495
	speed: 0.1987s/iter; left time: 7125.8071s
Epoch: 3 cost time: 71.75585126876831
Epoch: 3, Steps: 369 | Train Loss: 0.888 Vali Loss: 1.078 Vali Acc: 0.499 Test Loss: 1.078 Test Acc: 0.499
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.6423315
	speed: 0.6712s/iter; left time: 23959.5320s
	iters: 200, epoch: 4 | loss: 0.7817630
	speed: 0.2303s/iter; left time: 8196.6255s
	iters: 300, epoch: 4 | loss: 0.7289942
	speed: 0.2301s/iter; left time: 8167.6620s
Epoch: 4 cost time: 76.6520664691925
Epoch: 4, Steps: 369 | Train Loss: 0.987 Vali Loss: 0.885 Vali Acc: 0.500 Test Loss: 0.885 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8464760
	speed: 0.5708s/iter; left time: 20164.8959s
	iters: 200, epoch: 5 | loss: 0.8993289
	speed: 0.1877s/iter; left time: 6613.0001s
	iters: 300, epoch: 5 | loss: 0.6897013
	speed: 0.1987s/iter; left time: 6980.5267s
Epoch: 5 cost time: 65.87996530532837
Epoch: 5, Steps: 369 | Train Loss: 0.788 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7077534
	speed: 0.6470s/iter; left time: 22614.9818s
	iters: 200, epoch: 6 | loss: 0.7749320
	speed: 0.1915s/iter; left time: 6673.5564s
	iters: 300, epoch: 6 | loss: 0.6785626
	speed: 0.1829s/iter; left time: 6356.0091s
Epoch: 6 cost time: 67.14213728904724
Epoch: 6, Steps: 369 | Train Loss: 0.740 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7335752
	speed: 0.6396s/iter; left time: 22122.2141s
	iters: 200, epoch: 7 | loss: 0.7170787
	speed: 0.1984s/iter; left time: 6843.2690s
	iters: 300, epoch: 7 | loss: 0.7213940
	speed: 0.1681s/iter; left time: 5778.7603s
Epoch: 7 cost time: 68.6853883266449
Epoch: 7, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.8282981
	speed: 0.6578s/iter; left time: 22509.7261s
	iters: 200, epoch: 8 | loss: 0.7353565
	speed: 0.2047s/iter; left time: 6982.5675s
	iters: 300, epoch: 8 | loss: 0.7090582
	speed: 0.1907s/iter; left time: 6488.7651s
Epoch: 8 cost time: 70.92504477500916
Epoch: 8, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6879508
	speed: 0.6194s/iter; left time: 20965.8299s
	iters: 200, epoch: 9 | loss: 0.6936019
	speed: 0.1991s/iter; left time: 6719.6548s
	iters: 300, epoch: 9 | loss: 0.6881072
	speed: 0.1950s/iter; left time: 6561.5490s
Epoch: 9 cost time: 69.8627336025238
Epoch: 9, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7109184
	speed: 0.6899s/iter; left time: 23096.8526s
	iters: 200, epoch: 10 | loss: 0.7440276
	speed: 0.2045s/iter; left time: 6827.8451s
	iters: 300, epoch: 10 | loss: 0.6776119
	speed: 0.1702s/iter; left time: 5664.6771s
Epoch: 10 cost time: 71.46631026268005
Epoch: 10, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.5592596
	speed: 0.6846s/iter; left time: 22667.5162s
	iters: 200, epoch: 11 | loss: 0.7481929
	speed: 0.1755s/iter; left time: 5794.5845s
	iters: 300, epoch: 11 | loss: 0.7487823
	speed: 0.1596s/iter; left time: 5253.2394s
Epoch: 11 cost time: 67.18201184272766
Epoch: 11, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5354710556186152
model parameter : 6072742
model size : 28.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.7758609
	speed: 0.2162s/iter; left time: 7956.1972s
	iters: 200, epoch: 1 | loss: 1.9999999
	speed: 0.1682s/iter; left time: 6171.5541s
	iters: 300, epoch: 1 | loss: 0.7191293
	speed: 0.1708s/iter; left time: 6249.6481s
Epoch: 1 cost time: 68.44670987129211
Epoch: 1, Steps: 369 | Train Loss: 1.344 Vali Loss: 0.927 Vali Acc: 0.610 Test Loss: 0.927 Test Acc: 0.610
Validation loss decreased (inf --> -0.609809).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7353005
	speed: 0.6545s/iter; left time: 23843.2459s
	iters: 200, epoch: 2 | loss: 0.3567294
	speed: 0.1714s/iter; left time: 6228.3369s
	iters: 300, epoch: 2 | loss: 1.2218995
	speed: 0.1461s/iter; left time: 5292.0096s
Epoch: 2 cost time: 58.512715101242065
Epoch: 2, Steps: 369 | Train Loss: 0.898 Vali Loss: 1.260 Vali Acc: 0.513 Test Loss: 1.260 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8046939
	speed: 0.4749s/iter; left time: 17125.2729s
	iters: 200, epoch: 3 | loss: 1.1846544
	speed: 0.1882s/iter; left time: 6769.5277s
	iters: 300, epoch: 3 | loss: 0.9657028
	speed: 0.1619s/iter; left time: 5807.9762s
Epoch: 3 cost time: 68.66798448562622
Epoch: 3, Steps: 369 | Train Loss: 0.987 Vali Loss: 0.726 Vali Acc: 0.589 Test Loss: 0.726 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8832323
	speed: 0.6965s/iter; left time: 24862.2418s
	iters: 200, epoch: 4 | loss: 0.8371918
	speed: 0.1811s/iter; left time: 6444.7253s
	iters: 300, epoch: 4 | loss: 0.8063697
	speed: 0.1910s/iter; left time: 6779.9609s
Epoch: 4 cost time: 74.02022433280945
Epoch: 4, Steps: 369 | Train Loss: 0.952 Vali Loss: 0.693 Vali Acc: 0.498 Test Loss: 0.693 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6892602
	speed: 0.6886s/iter; left time: 24325.9435s
	iters: 200, epoch: 5 | loss: 0.6997353
	speed: 0.1566s/iter; left time: 5517.8312s
	iters: 300, epoch: 5 | loss: 0.6118442
	speed: 0.1996s/iter; left time: 7012.4517s
Epoch: 5 cost time: 67.2762062549591
Epoch: 5, Steps: 369 | Train Loss: 0.815 Vali Loss: 0.876 Vali Acc: 0.500 Test Loss: 0.876 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.9655917
	speed: 0.6259s/iter; left time: 21880.2636s
	iters: 200, epoch: 6 | loss: 0.7598785
	speed: 0.1537s/iter; left time: 5357.4188s
	iters: 300, epoch: 6 | loss: 0.6557924
	speed: 0.1825s/iter; left time: 6341.8058s
Epoch: 6 cost time: 65.7016339302063
Epoch: 6, Steps: 369 | Train Loss: 0.758 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6814794
	speed: 0.6427s/iter; left time: 22227.8478s
	iters: 200, epoch: 7 | loss: 0.7044853
	speed: 0.1841s/iter; left time: 6350.1992s
	iters: 300, epoch: 7 | loss: 0.7543073
	speed: 0.1872s/iter; left time: 6436.4974s
Epoch: 7 cost time: 68.6019959449768
Epoch: 7, Steps: 369 | Train Loss: 0.729 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7296058
	speed: 0.6199s/iter; left time: 21211.2672s
	iters: 200, epoch: 8 | loss: 0.7215297
	speed: 0.1981s/iter; left time: 6759.4871s
	iters: 300, epoch: 8 | loss: 0.7184644
	speed: 0.1903s/iter; left time: 6472.4139s
Epoch: 8 cost time: 69.31321835517883
Epoch: 8, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7706836
	speed: 0.6356s/iter; left time: 21514.3501s
	iters: 200, epoch: 9 | loss: 0.6000015
	speed: 0.1899s/iter; left time: 6408.5243s
	iters: 300, epoch: 9 | loss: 0.7309506
	speed: 0.1888s/iter; left time: 6354.2182s
Epoch: 9 cost time: 68.8720817565918
Epoch: 9, Steps: 369 | Train Loss: 0.745 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7061100
	speed: 0.6913s/iter; left time: 23144.9624s
	iters: 200, epoch: 10 | loss: 0.7072535
	speed: 0.1861s/iter; left time: 6211.8222s
	iters: 300, epoch: 10 | loss: 0.6992061
	speed: 0.1603s/iter; left time: 5333.9155s
Epoch: 10 cost time: 69.9584310054779
Epoch: 10, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6964064
	speed: 0.6912s/iter; left time: 22885.4986s
	iters: 200, epoch: 11 | loss: 0.7714353
	speed: 0.1743s/iter; left time: 5755.0616s
	iters: 300, epoch: 11 | loss: 0.7367941
	speed: 0.1876s/iter; left time: 6174.0779s
Epoch: 11 cost time: 69.07599258422852
Epoch: 11, Steps: 369 | Train Loss: 0.719 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6098183881952327
model parameter : 6070438
model size : 28.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1982388
	speed: 0.2147s/iter; left time: 7901.1318s
	iters: 200, epoch: 1 | loss: 0.7538207
	speed: 0.1563s/iter; left time: 5736.9432s
	iters: 300, epoch: 1 | loss: 1.2574414
	speed: 0.1783s/iter; left time: 6524.4821s
Epoch: 1 cost time: 67.11588835716248
Epoch: 1, Steps: 369 | Train Loss: 1.258 Vali Loss: 2.062 Vali Acc: 0.501 Test Loss: 2.062 Test Acc: 0.501
Validation loss decreased (inf --> -0.501114).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7660828
	speed: 0.6103s/iter; left time: 22234.5587s
	iters: 200, epoch: 2 | loss: 0.7882709
	speed: 0.1622s/iter; left time: 5894.2455s
	iters: 300, epoch: 2 | loss: 0.7858894
	speed: 0.1312s/iter; left time: 4752.8736s
Epoch: 2 cost time: 54.47467541694641
Epoch: 2, Steps: 369 | Train Loss: 0.925 Vali Loss: 0.606 Vali Acc: 0.673 Test Loss: 0.606 Test Acc: 0.673
Validation loss decreased (-0.501114 --> -0.673376).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3292341
	speed: 0.5253s/iter; left time: 18945.0651s
	iters: 200, epoch: 3 | loss: 1.1723132
	speed: 0.1669s/iter; left time: 6002.7137s
	iters: 300, epoch: 3 | loss: 2.3930244
	speed: 0.1966s/iter; left time: 7049.8040s
Epoch: 3 cost time: 67.1883807182312
Epoch: 3, Steps: 369 | Train Loss: 0.906 Vali Loss: 0.697 Vali Acc: 0.518 Test Loss: 0.697 Test Acc: 0.518
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9012251
	speed: 0.6595s/iter; left time: 23538.8938s
	iters: 200, epoch: 4 | loss: 1.0608540
	speed: 0.1904s/iter; left time: 6778.8508s
	iters: 300, epoch: 4 | loss: 0.7479958
	speed: 0.1952s/iter; left time: 6928.1987s
Epoch: 4 cost time: 71.99008202552795
Epoch: 4, Steps: 369 | Train Loss: 0.885 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.0537204
	speed: 0.6813s/iter; left time: 24065.1872s
	iters: 200, epoch: 5 | loss: 1.0357417
	speed: 0.2017s/iter; left time: 7104.3405s
	iters: 300, epoch: 5 | loss: 0.7007663
	speed: 0.1846s/iter; left time: 6483.7449s
Epoch: 5 cost time: 68.43271780014038
Epoch: 5, Steps: 369 | Train Loss: 0.857 Vali Loss: 0.781 Vali Acc: 0.500 Test Loss: 0.781 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7684281
	speed: 0.5881s/iter; left time: 20557.4611s
	iters: 200, epoch: 6 | loss: 0.5844114
	speed: 0.1912s/iter; left time: 6664.4347s
	iters: 300, epoch: 6 | loss: 0.8965323
	speed: 0.1756s/iter; left time: 6104.2448s
Epoch: 6 cost time: 65.55713868141174
Epoch: 6, Steps: 369 | Train Loss: 0.752 Vali Loss: 0.694 Vali Acc: 0.503 Test Loss: 0.694 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7565871
	speed: 0.6053s/iter; left time: 20934.5559s
	iters: 200, epoch: 7 | loss: 0.8283924
	speed: 0.1897s/iter; left time: 6541.4873s
	iters: 300, epoch: 7 | loss: 0.8050280
	speed: 0.1645s/iter; left time: 5657.6239s
Epoch: 7 cost time: 64.04036784172058
Epoch: 7, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.9931700
	speed: 0.6407s/iter; left time: 21922.0775s
	iters: 200, epoch: 8 | loss: 0.9096219
	speed: 0.1870s/iter; left time: 6381.4672s
	iters: 300, epoch: 8 | loss: 0.7805207
	speed: 0.1678s/iter; left time: 5707.8470s
Epoch: 8 cost time: 68.77568197250366
Epoch: 8, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.8412396
	speed: 0.6409s/iter; left time: 21693.0292s
	iters: 200, epoch: 9 | loss: 0.7059079
	speed: 0.1903s/iter; left time: 6423.5953s
	iters: 300, epoch: 9 | loss: 0.6999958
	speed: 0.1826s/iter; left time: 6143.5692s
Epoch: 9 cost time: 70.952951669693
Epoch: 9, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6666257
	speed: 0.6903s/iter; left time: 23111.7614s
	iters: 200, epoch: 10 | loss: 0.6926097
	speed: 0.1814s/iter; left time: 6053.5311s
	iters: 300, epoch: 10 | loss: 0.7212358
	speed: 0.1888s/iter; left time: 6283.9006s
Epoch: 10 cost time: 72.4180805683136
Epoch: 10, Steps: 369 | Train Loss: 0.719 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6660885
	speed: 0.6647s/iter; left time: 22010.2277s
	iters: 200, epoch: 11 | loss: 0.7424932
	speed: 0.1717s/iter; left time: 5669.6216s
	iters: 300, epoch: 11 | loss: 0.6978927
	speed: 0.1818s/iter; left time: 5983.4244s
Epoch: 11 cost time: 65.91010117530823
Epoch: 11, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.6573527
	speed: 0.6203s/iter; left time: 20311.1114s
	iters: 200, epoch: 12 | loss: 0.7245882
	speed: 0.1740s/iter; left time: 5679.9113s
	iters: 300, epoch: 12 | loss: 0.6836543
	speed: 0.0962s/iter; left time: 3131.6161s
Epoch: 12 cost time: 53.09743332862854
Epoch: 12, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6733825198637912
model parameter : 6068134
model size : 28.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.1873710
	speed: 0.2148s/iter; left time: 7906.5779s
	iters: 200, epoch: 1 | loss: 1.5609553
	speed: 0.1889s/iter; left time: 6932.8198s
	iters: 300, epoch: 1 | loss: 0.5874200
	speed: 0.1615s/iter; left time: 5910.6943s
Epoch: 1 cost time: 69.33349394798279
Epoch: 1, Steps: 369 | Train Loss: 1.342 Vali Loss: 1.237 Vali Acc: 0.505 Test Loss: 1.237 Test Acc: 0.505
Validation loss decreased (inf --> -0.505379).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4121604
	speed: 0.6286s/iter; left time: 22900.7845s
	iters: 200, epoch: 2 | loss: 1.0882007
	speed: 0.1741s/iter; left time: 6325.5518s
	iters: 300, epoch: 2 | loss: 0.7886692
	speed: 0.1584s/iter; left time: 5740.7833s
Epoch: 2 cost time: 65.7513678073883
Epoch: 2, Steps: 369 | Train Loss: 0.907 Vali Loss: 0.661 Vali Acc: 0.642 Test Loss: 0.661 Test Acc: 0.642
Validation loss decreased (-0.505379 --> -0.641594).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4071729
	speed: 0.6295s/iter; left time: 22700.9117s
	iters: 200, epoch: 3 | loss: 0.7951116
	speed: 0.1876s/iter; left time: 6747.6665s
	iters: 300, epoch: 3 | loss: 0.8988206
	speed: 0.1741s/iter; left time: 6243.6258s
Epoch: 3 cost time: 69.68937182426453
Epoch: 3, Steps: 369 | Train Loss: 0.919 Vali Loss: 0.751 Vali Acc: 0.556 Test Loss: 0.751 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7324340
	speed: 0.6751s/iter; left time: 24097.9953s
	iters: 200, epoch: 4 | loss: 0.7094722
	speed: 0.1657s/iter; left time: 5899.1470s
	iters: 300, epoch: 4 | loss: 1.2049606
	speed: 0.1550s/iter; left time: 5502.4091s
Epoch: 4 cost time: 66.07961320877075
Epoch: 4, Steps: 369 | Train Loss: 0.984 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6970047
	speed: 0.6145s/iter; left time: 21708.9215s
	iters: 200, epoch: 5 | loss: 1.0302682
	speed: 0.1808s/iter; left time: 6368.9208s
	iters: 300, epoch: 5 | loss: 0.7162379
	speed: 0.1658s/iter; left time: 5823.4328s
Epoch: 5 cost time: 66.57334518432617
Epoch: 5, Steps: 369 | Train Loss: 0.813 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6875767
	speed: 0.6235s/iter; left time: 21793.5424s
	iters: 200, epoch: 6 | loss: 0.8416307
	speed: 0.1671s/iter; left time: 5822.7220s
	iters: 300, epoch: 6 | loss: 0.9251435
	speed: 0.1751s/iter; left time: 6087.2151s
Epoch: 6 cost time: 66.84576201438904
Epoch: 6, Steps: 369 | Train Loss: 0.752 Vali Loss: 0.839 Vali Acc: 0.500 Test Loss: 0.839 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7088641
	speed: 0.6327s/iter; left time: 21884.4162s
	iters: 200, epoch: 7 | loss: 0.7480215
	speed: 0.1630s/iter; left time: 5620.1695s
	iters: 300, epoch: 7 | loss: 0.6765110
	speed: 0.1814s/iter; left time: 6237.2966s
Epoch: 7 cost time: 65.02707481384277
Epoch: 7, Steps: 369 | Train Loss: 0.731 Vali Loss: 0.725 Vali Acc: 0.500 Test Loss: 0.725 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7121637
	speed: 0.6209s/iter; left time: 21245.3780s
	iters: 200, epoch: 8 | loss: 0.7582238
	speed: 0.1880s/iter; left time: 6414.1173s
	iters: 300, epoch: 8 | loss: 0.6755827
	speed: 0.1753s/iter; left time: 5962.0585s
Epoch: 8 cost time: 67.41488552093506
Epoch: 8, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6936359
	speed: 0.6480s/iter; left time: 21932.7913s
	iters: 200, epoch: 9 | loss: 0.7127256
	speed: 0.1818s/iter; left time: 6134.1871s
	iters: 300, epoch: 9 | loss: 0.6864787
	speed: 0.1745s/iter; left time: 5872.4383s
Epoch: 9 cost time: 67.7670030593872
Epoch: 9, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.5836572
	speed: 0.6446s/iter; left time: 21580.4105s
	iters: 200, epoch: 10 | loss: 0.7381473
	speed: 0.1887s/iter; left time: 6299.8008s
	iters: 300, epoch: 10 | loss: 0.7528428
	speed: 0.1737s/iter; left time: 5780.9000s
Epoch: 10 cost time: 65.02887511253357
Epoch: 10, Steps: 369 | Train Loss: 0.722 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6677846
	speed: 0.4710s/iter; left time: 15596.2883s
	iters: 200, epoch: 11 | loss: 0.7270650
	speed: 0.1877s/iter; left time: 6194.7730s
	iters: 300, epoch: 11 | loss: 0.7263138
	speed: 0.1544s/iter; left time: 5082.0904s
Epoch: 11 cost time: 61.146721601486206
Epoch: 11, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7141528
	speed: 0.5980s/iter; left time: 19578.7331s
	iters: 200, epoch: 12 | loss: 0.6452827
	speed: 0.1776s/iter; left time: 5797.7514s
	iters: 300, epoch: 12 | loss: 0.7021885
	speed: 0.1746s/iter; left time: 5681.3968s
Epoch: 12 cost time: 67.55220246315002
Epoch: 12, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6416004540295119
model parameter : 6065830
model size : 28.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0619427
	speed: 0.1753s/iter; left time: 6450.2329s
	iters: 200, epoch: 1 | loss: 0.6548694
	speed: 0.1479s/iter; left time: 5429.5789s
	iters: 300, epoch: 1 | loss: 1.2010117
	speed: 0.1516s/iter; left time: 5547.0833s
Epoch: 1 cost time: 59.03981161117554
Epoch: 1, Steps: 369 | Train Loss: 0.984 Vali Loss: 1.047 Vali Acc: 0.557 Test Loss: 1.047 Test Acc: 0.557
Validation loss decreased (inf --> -0.557311).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4388924
	speed: 0.5564s/iter; left time: 20270.3552s
	iters: 200, epoch: 2 | loss: 0.3316248
	speed: 0.1820s/iter; left time: 6611.5010s
	iters: 300, epoch: 2 | loss: 0.6484590
	speed: 0.1536s/iter; left time: 5566.7052s
Epoch: 2 cost time: 64.32069039344788
Epoch: 2, Steps: 369 | Train Loss: 0.859 Vali Loss: 0.706 Vali Acc: 0.653 Test Loss: 0.706 Test Acc: 0.653
Validation loss decreased (-0.557311 --> -0.652944).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9684492
	speed: 0.5612s/iter; left time: 20237.8421s
	iters: 200, epoch: 3 | loss: 0.7311650
	speed: 0.1688s/iter; left time: 6068.7853s
	iters: 300, epoch: 3 | loss: 0.8022417
	speed: 0.1551s/iter; left time: 5563.8533s
Epoch: 3 cost time: 62.89827919006348
Epoch: 3, Steps: 369 | Train Loss: 0.763 Vali Loss: 0.940 Vali Acc: 0.573 Test Loss: 0.940 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0943913
	speed: 0.5409s/iter; left time: 19307.1140s
	iters: 200, epoch: 4 | loss: 0.5121310
	speed: 0.1562s/iter; left time: 5560.2833s
	iters: 300, epoch: 4 | loss: 0.9215485
	speed: 0.1305s/iter; left time: 4630.9270s
Epoch: 4 cost time: 58.165934562683105
Epoch: 4, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.785 Vali Acc: 0.581 Test Loss: 0.785 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7942295
	speed: 0.5495s/iter; left time: 19410.4070s
	iters: 200, epoch: 5 | loss: 1.3615808
	speed: 0.1560s/iter; left time: 5495.6128s
	iters: 300, epoch: 5 | loss: 1.0613382
	speed: 0.1487s/iter; left time: 5222.5430s
Epoch: 5 cost time: 59.48960280418396
Epoch: 5, Steps: 369 | Train Loss: 1.055 Vali Loss: 2.818 Vali Acc: 0.500 Test Loss: 2.818 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6369443
	speed: 0.5406s/iter; left time: 18897.4010s
	iters: 200, epoch: 6 | loss: 0.9095029
	speed: 0.1511s/iter; left time: 5266.1820s
	iters: 300, epoch: 6 | loss: 0.7867089
	speed: 0.1485s/iter; left time: 5162.4115s
Epoch: 6 cost time: 58.048442125320435
Epoch: 6, Steps: 369 | Train Loss: 0.886 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7936769
	speed: 0.5536s/iter; left time: 19146.8494s
	iters: 200, epoch: 7 | loss: 0.7356200
	speed: 0.1511s/iter; left time: 5210.4869s
	iters: 300, epoch: 7 | loss: 0.7421751
	speed: 0.1507s/iter; left time: 5181.5358s
Epoch: 7 cost time: 58.32591390609741
Epoch: 7, Steps: 369 | Train Loss: 0.732 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7329383
	speed: 0.5330s/iter; left time: 18237.2447s
	iters: 200, epoch: 8 | loss: 0.6361180
	speed: 0.1733s/iter; left time: 5911.2604s
	iters: 300, epoch: 8 | loss: 0.7278188
	speed: 0.1627s/iter; left time: 5534.6356s
Epoch: 8 cost time: 62.303181171417236
Epoch: 8, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6868961
	speed: 0.5773s/iter; left time: 19542.4067s
	iters: 200, epoch: 9 | loss: 0.7873090
	speed: 0.1584s/iter; left time: 5346.1588s
	iters: 300, epoch: 9 | loss: 0.6930938
	speed: 0.1393s/iter; left time: 4688.0594s
Epoch: 9 cost time: 57.68518304824829
Epoch: 9, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.7852087
	speed: 0.5728s/iter; left time: 19178.1894s
	iters: 200, epoch: 10 | loss: 0.7134973
	speed: 0.1642s/iter; left time: 5480.4758s
	iters: 300, epoch: 10 | loss: 0.6839178
	speed: 0.1417s/iter; left time: 4715.7755s
Epoch: 10 cost time: 56.25996208190918
Epoch: 10, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7301534
	speed: 0.3429s/iter; left time: 11352.6187s
	iters: 200, epoch: 11 | loss: 0.7312532
	speed: 0.0834s/iter; left time: 2754.0100s
	iters: 300, epoch: 11 | loss: 0.6768892
	speed: 0.1705s/iter; left time: 5610.6186s
Epoch: 11 cost time: 45.66704487800598
Epoch: 11, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7032843
	speed: 0.5425s/iter; left time: 17762.3708s
	iters: 200, epoch: 12 | loss: 0.7044421
	speed: 0.1431s/iter; left time: 4671.1542s
	iters: 300, epoch: 12 | loss: 0.7317502
	speed: 0.1685s/iter; left time: 5482.8646s
Epoch: 12 cost time: 58.26400089263916
Epoch: 12, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6529511918274687
model parameter : 2877350
model size : 13.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0259413
	speed: 0.1679s/iter; left time: 6180.7012s
	iters: 200, epoch: 1 | loss: 0.5298789
	speed: 0.1559s/iter; left time: 5722.9431s
	iters: 300, epoch: 1 | loss: 0.5987244
	speed: 0.1574s/iter; left time: 5759.2568s
Epoch: 1 cost time: 57.93760895729065
Epoch: 1, Steps: 369 | Train Loss: 1.001 Vali Loss: 0.924 Vali Acc: 0.535 Test Loss: 0.924 Test Acc: 0.535
Validation loss decreased (inf --> -0.535462).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6922456
	speed: 0.5621s/iter; left time: 20477.2664s
	iters: 200, epoch: 2 | loss: 0.9106272
	speed: 0.1651s/iter; left time: 5998.4491s
	iters: 300, epoch: 2 | loss: 1.1255225
	speed: 0.1669s/iter; left time: 6046.2046s
Epoch: 2 cost time: 61.71005654335022
Epoch: 2, Steps: 369 | Train Loss: 0.780 Vali Loss: 2.906 Vali Acc: 0.500 Test Loss: 2.906 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5139272
	speed: 0.5630s/iter; left time: 20302.1269s
	iters: 200, epoch: 3 | loss: 0.5448940
	speed: 0.1541s/iter; left time: 5541.4346s
	iters: 300, epoch: 3 | loss: 0.5729277
	speed: 0.1784s/iter; left time: 6396.2498s
Epoch: 3 cost time: 62.16676378250122
Epoch: 3, Steps: 369 | Train Loss: 0.856 Vali Loss: 1.129 Vali Acc: 0.524 Test Loss: 1.129 Test Acc: 0.524
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5314571
	speed: 0.5579s/iter; left time: 19915.1163s
	iters: 200, epoch: 4 | loss: 0.9324906
	speed: 0.1378s/iter; left time: 4904.8008s
	iters: 300, epoch: 4 | loss: 0.5987051
	speed: 0.1583s/iter; left time: 5618.4526s
Epoch: 4 cost time: 58.46330142021179
Epoch: 4, Steps: 369 | Train Loss: 0.710 Vali Loss: 2.664 Vali Acc: 0.500 Test Loss: 2.664 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.5381148
	speed: 0.5506s/iter; left time: 19450.2526s
	iters: 200, epoch: 5 | loss: 2.6689229
	speed: 0.1469s/iter; left time: 5174.3530s
	iters: 300, epoch: 5 | loss: 0.8597660
	speed: 0.1662s/iter; left time: 5838.4673s
Epoch: 5 cost time: 59.582635164260864
Epoch: 5, Steps: 369 | Train Loss: 1.214 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7772548
	speed: 0.5318s/iter; left time: 18588.4266s
	iters: 200, epoch: 6 | loss: 0.5673124
	speed: 0.1352s/iter; left time: 4713.8951s
	iters: 300, epoch: 6 | loss: 1.2378247
	speed: 0.1567s/iter; left time: 5446.7359s
Epoch: 6 cost time: 56.39496612548828
Epoch: 6, Steps: 369 | Train Loss: 0.915 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7259167
	speed: 0.5465s/iter; left time: 18903.0025s
	iters: 200, epoch: 7 | loss: 0.8064736
	speed: 0.1423s/iter; left time: 4907.5329s
	iters: 300, epoch: 7 | loss: 0.6652247
	speed: 0.1084s/iter; left time: 3726.2220s
Epoch: 7 cost time: 47.51405692100525
Epoch: 7, Steps: 369 | Train Loss: 0.744 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7219019
	speed: 0.4305s/iter; left time: 14730.5009s
	iters: 200, epoch: 8 | loss: 0.6565619
	speed: 0.1926s/iter; left time: 6571.9263s
	iters: 300, epoch: 8 | loss: 0.6924978
	speed: 0.1481s/iter; left time: 5037.1915s
Epoch: 8 cost time: 65.93269395828247
Epoch: 8, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7745188
	speed: 0.5926s/iter; left time: 20059.4509s
	iters: 200, epoch: 9 | loss: 0.6939520
	speed: 0.1743s/iter; left time: 5884.0269s
	iters: 300, epoch: 9 | loss: 0.8358131
	speed: 0.1354s/iter; left time: 4554.4872s
Epoch: 9 cost time: 60.443514823913574
Epoch: 9, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7532502
	speed: 0.5366s/iter; left time: 17966.1762s
	iters: 200, epoch: 10 | loss: 0.6783535
	speed: 0.1637s/iter; left time: 5462.6643s
	iters: 300, epoch: 10 | loss: 0.6801026
	speed: 0.1357s/iter; left time: 4516.2636s
Epoch: 10 cost time: 55.76896572113037
Epoch: 10, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.694 Vali Acc: 0.500 Test Loss: 0.694 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.8009534
	speed: 0.5105s/iter; left time: 16902.1230s
	iters: 200, epoch: 11 | loss: 0.6955240
	speed: 0.1609s/iter; left time: 5310.4460s
	iters: 300, epoch: 11 | loss: 0.6960726
	speed: 0.1520s/iter; left time: 5001.2920s
Epoch: 11 cost time: 55.75914192199707
Epoch: 11, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5354710556186152
model parameter : 2876198
model size : 13.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6621732
	speed: 0.1792s/iter; left time: 6595.9433s
	iters: 200, epoch: 1 | loss: 0.3693777
	speed: 0.1689s/iter; left time: 6199.4209s
	iters: 300, epoch: 1 | loss: 2.7308993
	speed: 0.1589s/iter; left time: 5814.1832s
Epoch: 1 cost time: 61.7995183467865
Epoch: 1, Steps: 369 | Train Loss: 1.162 Vali Loss: 1.939 Vali Acc: 0.500 Test Loss: 1.939 Test Acc: 0.500
Validation loss decreased (inf --> -0.499981).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8763499
	speed: 0.5163s/iter; left time: 18809.9486s
	iters: 200, epoch: 2 | loss: 0.7816563
	speed: 0.1544s/iter; left time: 5610.2479s
	iters: 300, epoch: 2 | loss: 1.7546747
	speed: 0.1551s/iter; left time: 5619.1013s
Epoch: 2 cost time: 54.33625769615173
Epoch: 2, Steps: 369 | Train Loss: 0.835 Vali Loss: 1.106 Vali Acc: 0.581 Test Loss: 1.106 Test Acc: 0.581
Validation loss decreased (-0.499981 --> -0.580579).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6800191
	speed: 0.5346s/iter; left time: 19279.1608s
	iters: 200, epoch: 3 | loss: 0.5166091
	speed: 0.1686s/iter; left time: 6061.6313s
	iters: 300, epoch: 3 | loss: 1.2468626
	speed: 0.1660s/iter; left time: 5952.4444s
Epoch: 3 cost time: 59.0078239440918
Epoch: 3, Steps: 369 | Train Loss: 0.773 Vali Loss: 0.673 Vali Acc: 0.652 Test Loss: 0.673 Test Acc: 0.652
Validation loss decreased (-0.580579 --> -0.651809).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7456337
	speed: 0.5465s/iter; left time: 19505.8251s
	iters: 200, epoch: 4 | loss: 0.6760942
	speed: 0.1498s/iter; left time: 5331.5011s
	iters: 300, epoch: 4 | loss: 0.5895563
	speed: 0.1736s/iter; left time: 6160.8267s
Epoch: 4 cost time: 59.677449464797974
Epoch: 4, Steps: 369 | Train Loss: 0.745 Vali Loss: 0.700 Vali Acc: 0.656 Test Loss: 0.700 Test Acc: 0.656
Validation loss decreased (-0.651809 --> -0.655782).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5851130
	speed: 0.5336s/iter; left time: 18850.6905s
	iters: 200, epoch: 5 | loss: 0.9864893
	speed: 0.1369s/iter; left time: 4820.7500s
	iters: 300, epoch: 5 | loss: 0.6214674
	speed: 0.1699s/iter; left time: 5966.2677s
Epoch: 5 cost time: 56.97366213798523
Epoch: 5, Steps: 369 | Train Loss: 0.643 Vali Loss: 0.713 Vali Acc: 0.591 Test Loss: 0.713 Test Acc: 0.591
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5167715
	speed: 0.5326s/iter; left time: 18617.9646s
	iters: 200, epoch: 6 | loss: 1.0384684
	speed: 0.1554s/iter; left time: 5415.4501s
	iters: 300, epoch: 6 | loss: 0.7044105
	speed: 0.1670s/iter; left time: 5804.7451s
Epoch: 6 cost time: 59.016648054122925
Epoch: 6, Steps: 369 | Train Loss: 0.664 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.7764404
	speed: 0.5229s/iter; left time: 18084.5881s
	iters: 200, epoch: 7 | loss: 0.7843903
	speed: 0.1310s/iter; left time: 4517.5655s
	iters: 300, epoch: 7 | loss: 0.7470807
	speed: 0.1654s/iter; left time: 5688.5479s
Epoch: 7 cost time: 57.0945942401886
Epoch: 7, Steps: 369 | Train Loss: 0.673 Vali Loss: 0.653 Vali Acc: 0.619 Test Loss: 0.653 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5319042
	speed: 0.5476s/iter; left time: 18736.4159s
	iters: 200, epoch: 8 | loss: 0.4375508
	speed: 0.1417s/iter; left time: 4833.0106s
	iters: 300, epoch: 8 | loss: 0.7390783
	speed: 0.1602s/iter; left time: 5447.9852s
Epoch: 8 cost time: 57.80666446685791
Epoch: 8, Steps: 369 | Train Loss: 0.621 Vali Loss: 0.693 Vali Acc: 0.636 Test Loss: 0.693 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6422032
	speed: 0.5543s/iter; left time: 18764.1365s
	iters: 200, epoch: 9 | loss: 0.6565435
	speed: 0.1797s/iter; left time: 6065.0730s
	iters: 300, epoch: 9 | loss: 0.5741813
	speed: 0.1578s/iter; left time: 5311.1897s
Epoch: 9 cost time: 63.654194355010986
Epoch: 9, Steps: 369 | Train Loss: 0.645 Vali Loss: 0.662 Vali Acc: 0.626 Test Loss: 0.662 Test Acc: 0.626
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6535254
	speed: 0.5511s/iter; left time: 18450.3027s
	iters: 200, epoch: 10 | loss: 0.5586221
	speed: 0.1591s/iter; left time: 5310.0539s
	iters: 300, epoch: 10 | loss: 0.5268530
	speed: 0.1671s/iter; left time: 5560.2256s
Epoch: 10 cost time: 63.56305909156799
Epoch: 10, Steps: 369 | Train Loss: 0.625 Vali Loss: 0.664 Vali Acc: 0.628 Test Loss: 0.664 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.5345175
	speed: 0.5369s/iter; left time: 17776.6800s
	iters: 200, epoch: 11 | loss: 0.7618956
	speed: 0.1120s/iter; left time: 3698.5412s
	iters: 300, epoch: 11 | loss: 0.5983133
	speed: 0.1540s/iter; left time: 5069.1063s
Epoch: 11 cost time: 49.71335029602051
Epoch: 11, Steps: 369 | Train Loss: 0.626 Vali Loss: 0.666 Vali Acc: 0.629 Test Loss: 0.666 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.4837854
	speed: 0.5354s/iter; left time: 17528.4357s
	iters: 200, epoch: 12 | loss: 0.6773638
	speed: 0.1677s/iter; left time: 5475.1200s
	iters: 300, epoch: 12 | loss: 0.5565636
	speed: 0.1684s/iter; left time: 5479.1443s
Epoch: 12 cost time: 64.21533298492432
Epoch: 12, Steps: 369 | Train Loss: 0.656 Vali Loss: 0.654 Vali Acc: 0.619 Test Loss: 0.654 Test Acc: 0.619
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.5125633
	speed: 0.5458s/iter; left time: 17668.1802s
	iters: 200, epoch: 13 | loss: 0.5943955
	speed: 0.1533s/iter; left time: 4945.9981s
	iters: 300, epoch: 13 | loss: 0.5248231
	speed: 0.1634s/iter; left time: 5256.3457s
Epoch: 13 cost time: 58.173455238342285
Epoch: 13, Steps: 369 | Train Loss: 0.628 Vali Loss: 0.719 Vali Acc: 0.640 Test Loss: 0.719 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.6462381
	speed: 0.5646s/iter; left time: 18068.5552s
	iters: 200, epoch: 14 | loss: 1.2244762
	speed: 0.1602s/iter; left time: 5110.3841s
	iters: 300, epoch: 14 | loss: 1.7486997
	speed: 0.1621s/iter; left time: 5156.5503s
Epoch: 14 cost time: 62.25116968154907
Epoch: 14, Steps: 369 | Train Loss: 1.316 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.655788876276958
model parameter : 2875046
model size : 13.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0342656
	speed: 0.2021s/iter; left time: 7437.8668s
	iters: 200, epoch: 1 | loss: 1.2180915
	speed: 0.1535s/iter; left time: 5635.0089s
	iters: 300, epoch: 1 | loss: 1.8312099
	speed: 0.1456s/iter; left time: 5328.7405s
Epoch: 1 cost time: 61.22330904006958
Epoch: 1, Steps: 369 | Train Loss: 1.119 Vali Loss: 0.679 Vali Acc: 0.636 Test Loss: 0.679 Test Acc: 0.636
Validation loss decreased (inf --> -0.635918).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6654904
	speed: 0.5520s/iter; left time: 20111.5198s
	iters: 200, epoch: 2 | loss: 1.3362169
	speed: 0.1728s/iter; left time: 6279.9178s
	iters: 300, epoch: 2 | loss: 1.4675430
	speed: 0.1390s/iter; left time: 5034.6586s
Epoch: 2 cost time: 62.89542579650879
Epoch: 2, Steps: 369 | Train Loss: 0.847 Vali Loss: 0.831 Vali Acc: 0.600 Test Loss: 0.831 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0874418
	speed: 0.5837s/iter; left time: 21050.1695s
	iters: 200, epoch: 3 | loss: 0.7118625
	speed: 0.1720s/iter; left time: 6185.7165s
	iters: 300, epoch: 3 | loss: 0.6810400
	speed: 0.1530s/iter; left time: 5488.7738s
Epoch: 3 cost time: 62.55531120300293
Epoch: 3, Steps: 369 | Train Loss: 0.793 Vali Loss: 0.949 Vali Acc: 0.589 Test Loss: 0.949 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4575385
	speed: 0.5452s/iter; left time: 19459.6668s
	iters: 200, epoch: 4 | loss: 0.9774853
	speed: 0.1706s/iter; left time: 6071.3965s
	iters: 300, epoch: 4 | loss: 0.6613564
	speed: 0.1517s/iter; left time: 5385.7149s
Epoch: 4 cost time: 59.47076368331909
Epoch: 4, Steps: 369 | Train Loss: 0.745 Vali Loss: 2.007 Vali Acc: 0.500 Test Loss: 2.007 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.4125390
	speed: 0.5506s/iter; left time: 19451.1098s
	iters: 200, epoch: 5 | loss: 0.7656825
	speed: 0.1684s/iter; left time: 5930.9546s
	iters: 300, epoch: 5 | loss: 0.4927768
	speed: 0.1306s/iter; left time: 4586.0791s
Epoch: 5 cost time: 57.6155788898468
Epoch: 5, Steps: 369 | Train Loss: 0.666 Vali Loss: 0.708 Vali Acc: 0.621 Test Loss: 0.708 Test Acc: 0.621
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.2925618
	speed: 0.5368s/iter; left time: 18763.8715s
	iters: 200, epoch: 6 | loss: 0.4648088
	speed: 0.1692s/iter; left time: 5898.8140s
	iters: 300, epoch: 6 | loss: 0.4106444
	speed: 0.1549s/iter; left time: 5382.5165s
Epoch: 6 cost time: 60.84250855445862
Epoch: 6, Steps: 369 | Train Loss: 0.620 Vali Loss: 0.849 Vali Acc: 0.500 Test Loss: 0.849 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.2809159
	speed: 0.5201s/iter; left time: 17987.6581s
	iters: 200, epoch: 7 | loss: 0.4382177
	speed: 0.1590s/iter; left time: 5484.9440s
	iters: 300, epoch: 7 | loss: 0.6609960
	speed: 0.1566s/iter; left time: 5384.9477s
Epoch: 7 cost time: 56.78386044502258
Epoch: 7, Steps: 369 | Train Loss: 0.599 Vali Loss: 0.663 Vali Acc: 0.646 Test Loss: 0.663 Test Acc: 0.646
Validation loss decreased (-0.635918 --> -0.645850).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5259667
	speed: 0.5253s/iter; left time: 17973.8257s
	iters: 200, epoch: 8 | loss: 0.5618340
	speed: 0.1521s/iter; left time: 5188.2704s
	iters: 300, epoch: 8 | loss: 0.5301893
	speed: 0.1503s/iter; left time: 5114.3296s
Epoch: 8 cost time: 54.34869861602783
Epoch: 8, Steps: 369 | Train Loss: 0.556 Vali Loss: 0.636 Vali Acc: 0.669 Test Loss: 0.636 Test Acc: 0.669
Validation loss decreased (-0.645850 --> -0.669120).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5826526
	speed: 0.5331s/iter; left time: 18043.3789s
	iters: 200, epoch: 9 | loss: 0.5068128
	speed: 0.1448s/iter; left time: 4887.6577s
	iters: 300, epoch: 9 | loss: 0.4701087
	speed: 0.0788s/iter; left time: 2652.1539s
Epoch: 9 cost time: 45.08166170120239
Epoch: 9, Steps: 369 | Train Loss: 0.538 Vali Loss: 0.641 Vali Acc: 0.646 Test Loss: 0.641 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.5721697
	speed: 0.3197s/iter; left time: 10703.7654s
	iters: 200, epoch: 10 | loss: 0.2919924
	speed: 0.0965s/iter; left time: 3221.7713s
	iters: 300, epoch: 10 | loss: 0.5330403
	speed: 0.1798s/iter; left time: 5984.8215s
Epoch: 10 cost time: 47.35434865951538
Epoch: 10, Steps: 369 | Train Loss: 0.550 Vali Loss: 0.655 Vali Acc: 0.616 Test Loss: 0.655 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3679426
	speed: 0.5523s/iter; left time: 18286.4048s
	iters: 200, epoch: 11 | loss: 0.6052137
	speed: 0.1333s/iter; left time: 4401.3164s
	iters: 300, epoch: 11 | loss: 0.4288108
	speed: 0.1736s/iter; left time: 5711.8861s
Epoch: 11 cost time: 59.61826968193054
Epoch: 11, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.662 Vali Acc: 0.634 Test Loss: 0.662 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.4363516
	speed: 0.5247s/iter; left time: 17179.6684s
	iters: 200, epoch: 12 | loss: 0.5757912
	speed: 0.1352s/iter; left time: 4414.4658s
	iters: 300, epoch: 12 | loss: 0.4659325
	speed: 0.1757s/iter; left time: 5718.5319s
Epoch: 12 cost time: 58.58382701873779
Epoch: 12, Steps: 369 | Train Loss: 0.524 Vali Loss: 0.678 Vali Acc: 0.667 Test Loss: 0.678 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.3436809
	speed: 0.5220s/iter; left time: 16898.6612s
	iters: 200, epoch: 13 | loss: 0.6636327
	speed: 0.1530s/iter; left time: 4938.1770s
	iters: 300, epoch: 13 | loss: 0.5993860
	speed: 0.1739s/iter; left time: 5595.2018s
Epoch: 13 cost time: 58.9343421459198
Epoch: 13, Steps: 369 | Train Loss: 0.507 Vali Loss: 0.692 Vali Acc: 0.635 Test Loss: 0.692 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.2984513
	speed: 0.5460s/iter; left time: 17474.5630s
	iters: 200, epoch: 14 | loss: 0.2375848
	speed: 0.1703s/iter; left time: 5434.7620s
	iters: 300, epoch: 14 | loss: 0.5630185
	speed: 0.1629s/iter; left time: 5180.5977s
Epoch: 14 cost time: 61.11882758140564
Epoch: 14, Steps: 369 | Train Loss: 0.499 Vali Loss: 0.703 Vali Acc: 0.597 Test Loss: 0.703 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6456901
	speed: 0.5365s/iter; left time: 16973.6653s
	iters: 200, epoch: 15 | loss: 0.5195919
	speed: 0.1501s/iter; left time: 4734.5323s
	iters: 300, epoch: 15 | loss: 0.5300165
	speed: 0.1470s/iter; left time: 4620.5006s
Epoch: 15 cost time: 60.34318232536316
Epoch: 15, Steps: 369 | Train Loss: 0.624 Vali Loss: 0.678 Vali Acc: 0.636 Test Loss: 0.678 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.4285872
	speed: 0.6039s/iter; left time: 18880.1920s
	iters: 200, epoch: 16 | loss: 0.3645369
	speed: 0.1469s/iter; left time: 4579.5552s
	iters: 300, epoch: 16 | loss: 0.5892826
	speed: 0.1776s/iter; left time: 5518.3414s
Epoch: 16 cost time: 64.93700504302979
Epoch: 16, Steps: 369 | Train Loss: 0.607 Vali Loss: 0.773 Vali Acc: 0.521 Test Loss: 0.773 Test Acc: 0.521
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.4852532
	speed: 0.5873s/iter; left time: 18146.3686s
	iters: 200, epoch: 17 | loss: 0.3197378
	speed: 0.1479s/iter; left time: 4556.2530s
	iters: 300, epoch: 17 | loss: 0.6052232
	speed: 0.1612s/iter; left time: 4948.1180s
Epoch: 17 cost time: 61.74764657020569
Epoch: 17, Steps: 369 | Train Loss: 0.596 Vali Loss: 0.659 Vali Acc: 0.672 Test Loss: 0.659 Test Acc: 0.672
Validation loss decreased (-0.669120 --> -0.672241).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.8403235
	speed: 0.5399s/iter; left time: 16483.2297s
	iters: 200, epoch: 18 | loss: 0.6495522
	speed: 0.1628s/iter; left time: 4952.5589s
	iters: 300, epoch: 18 | loss: 0.5655422
	speed: 0.1562s/iter; left time: 4737.7185s
Epoch: 18 cost time: 60.10517716407776
Epoch: 18, Steps: 369 | Train Loss: 0.516 Vali Loss: 0.646 Vali Acc: 0.656 Test Loss: 0.646 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.8838666
	speed: 0.5301s/iter; left time: 15985.8222s
	iters: 200, epoch: 19 | loss: 0.7187271
	speed: 0.1561s/iter; left time: 4693.0888s
	iters: 300, epoch: 19 | loss: 0.7367637
	speed: 0.1444s/iter; left time: 4327.2455s
Epoch: 19 cost time: 59.48056674003601
Epoch: 19, Steps: 369 | Train Loss: 0.630 Vali Loss: 0.703 Vali Acc: 0.501 Test Loss: 0.703 Test Acc: 0.501
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.7328504
	speed: 0.5410s/iter; left time: 16116.0637s
	iters: 200, epoch: 20 | loss: 0.6434709
	speed: 0.1395s/iter; left time: 4142.3845s
	iters: 300, epoch: 20 | loss: 0.8073545
	speed: 0.1470s/iter; left time: 4348.9533s
Epoch: 20 cost time: 58.121147871017456
Epoch: 20, Steps: 369 | Train Loss: 0.805 Vali Loss: 0.695 Vali Acc: 0.510 Test Loss: 0.695 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.0335444
	speed: 0.5535s/iter; left time: 16285.8085s
	iters: 200, epoch: 21 | loss: 0.6028765
	speed: 0.1662s/iter; left time: 4873.4381s
	iters: 300, epoch: 21 | loss: 0.7315249
	speed: 0.1496s/iter; left time: 4372.7696s
Epoch: 21 cost time: 60.19422173500061
Epoch: 21, Steps: 369 | Train Loss: 1.003 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.6214953
	speed: 0.5683s/iter; left time: 16509.7556s
	iters: 200, epoch: 22 | loss: 0.7354174
	speed: 0.1606s/iter; left time: 4650.0173s
	iters: 300, epoch: 22 | loss: 0.6208642
	speed: 0.1475s/iter; left time: 4254.6509s
Epoch: 22 cost time: 62.498753786087036
Epoch: 22, Steps: 369 | Train Loss: 0.692 Vali Loss: 0.788 Vali Acc: 0.525 Test Loss: 0.788 Test Acc: 0.525
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.4948843
	speed: 0.5604s/iter; left time: 16074.5746s
	iters: 200, epoch: 23 | loss: 0.6264775
	speed: 0.1857s/iter; left time: 5308.6177s
	iters: 300, epoch: 23 | loss: 0.6599280
	speed: 0.1553s/iter; left time: 4422.4481s
Epoch: 23 cost time: 63.036705493927
Epoch: 23, Steps: 369 | Train Loss: 0.644 Vali Loss: 0.701 Vali Acc: 0.584 Test Loss: 0.701 Test Acc: 0.584
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.6213961
	speed: 0.5522s/iter; left time: 15635.0342s
	iters: 200, epoch: 24 | loss: 0.6001247
	speed: 0.1530s/iter; left time: 4315.3400s
	iters: 300, epoch: 24 | loss: 0.7015052
	speed: 0.1491s/iter; left time: 4193.1862s
Epoch: 24 cost time: 58.97927522659302
Epoch: 24, Steps: 369 | Train Loss: 0.673 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.0280856
	speed: 0.5017s/iter; left time: 14021.4029s
	iters: 200, epoch: 25 | loss: 0.6873105
	speed: 0.0899s/iter; left time: 2502.5321s
	iters: 300, epoch: 25 | loss: 0.5951173
	speed: 0.0747s/iter; left time: 2073.6784s
Epoch: 25 cost time: 35.226030111312866
Epoch: 25, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.7424035
	speed: 0.4214s/iter; left time: 11619.5887s
	iters: 200, epoch: 26 | loss: 0.6996452
	speed: 0.1511s/iter; left time: 4151.9041s
	iters: 300, epoch: 26 | loss: 0.6430530
	speed: 0.1500s/iter; left time: 4105.2535s
Epoch: 26 cost time: 54.24711298942566
Epoch: 26, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.781 Vali Acc: 0.499 Test Loss: 0.781 Test Acc: 0.499
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.7583635
	speed: 0.4974s/iter; left time: 13533.8451s
	iters: 200, epoch: 27 | loss: 0.6896138
	speed: 0.1514s/iter; left time: 4104.2955s
	iters: 300, epoch: 27 | loss: 0.8403265
	speed: 0.1450s/iter; left time: 3915.5661s
Epoch: 27 cost time: 54.61992073059082
Epoch: 27, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6722474460839954
model parameter : 2873894
model size : 13.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6789795
	speed: 0.1857s/iter; left time: 6833.7226s
	iters: 200, epoch: 1 | loss: 0.5744131
	speed: 0.1575s/iter; left time: 5780.8929s
	iters: 300, epoch: 1 | loss: 0.5383699
	speed: 0.1540s/iter; left time: 5637.5390s
Epoch: 1 cost time: 59.79506802558899
Epoch: 1, Steps: 369 | Train Loss: 1.014 Vali Loss: 1.006 Vali Acc: 0.554 Test Loss: 1.006 Test Acc: 0.554
Validation loss decreased (inf --> -0.554473).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2456831
	speed: 0.4921s/iter; left time: 17929.8032s
	iters: 200, epoch: 2 | loss: 0.6822214
	speed: 0.1558s/iter; left time: 5660.6141s
	iters: 300, epoch: 2 | loss: 1.4204868
	speed: 0.1641s/iter; left time: 5944.7883s
Epoch: 2 cost time: 55.13592314720154
Epoch: 2, Steps: 369 | Train Loss: 0.810 Vali Loss: 0.643 Vali Acc: 0.641 Test Loss: 0.643 Test Acc: 0.641
Validation loss decreased (-0.554473 --> -0.641026).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8666514
	speed: 0.4721s/iter; left time: 17024.2522s
	iters: 200, epoch: 3 | loss: 0.4220164
	speed: 0.1518s/iter; left time: 5460.0501s
	iters: 300, epoch: 3 | loss: 1.1159081
	speed: 0.1365s/iter; left time: 4895.5057s
Epoch: 3 cost time: 52.42788624763489
Epoch: 3, Steps: 369 | Train Loss: 0.799 Vali Loss: 0.936 Vali Acc: 0.639 Test Loss: 0.936 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8161969
	speed: 0.5395s/iter; left time: 19257.7118s
	iters: 200, epoch: 4 | loss: 0.6105736
	speed: 0.1281s/iter; left time: 4560.3271s
	iters: 300, epoch: 4 | loss: 0.8207392
	speed: 0.1525s/iter; left time: 5414.5778s
Epoch: 4 cost time: 57.70116567611694
Epoch: 4, Steps: 369 | Train Loss: 0.678 Vali Loss: 1.115 Vali Acc: 0.530 Test Loss: 1.115 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7365827
	speed: 0.4945s/iter; left time: 17467.8731s
	iters: 200, epoch: 5 | loss: 0.6485958
	speed: 0.1247s/iter; left time: 4392.6244s
	iters: 300, epoch: 5 | loss: 0.5079873
	speed: 0.1625s/iter; left time: 5706.6493s
Epoch: 5 cost time: 56.608099699020386
Epoch: 5, Steps: 369 | Train Loss: 0.596 Vali Loss: 0.665 Vali Acc: 0.641 Test Loss: 0.665 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.4478376
	speed: 0.5156s/iter; left time: 18022.5612s
	iters: 200, epoch: 6 | loss: 0.7354786
	speed: 0.1422s/iter; left time: 4956.2732s
	iters: 300, epoch: 6 | loss: 0.6615080
	speed: 0.1627s/iter; left time: 5655.8107s
Epoch: 6 cost time: 54.80286169052124
Epoch: 6, Steps: 369 | Train Loss: 0.518 Vali Loss: 0.660 Vali Acc: 0.661 Test Loss: 0.660 Test Acc: 0.661
Validation loss decreased (-0.641026 --> -0.661458).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5426177
	speed: 0.4919s/iter; left time: 17011.6715s
	iters: 200, epoch: 7 | loss: 0.5145143
	speed: 0.1928s/iter; left time: 6648.0419s
	iters: 300, epoch: 7 | loss: 0.5791234
	speed: 0.1417s/iter; left time: 4873.2749s
Epoch: 7 cost time: 61.69825315475464
Epoch: 7, Steps: 369 | Train Loss: 0.492 Vali Loss: 0.639 Vali Acc: 0.671 Test Loss: 0.639 Test Acc: 0.671
Validation loss decreased (-0.661458 --> -0.671106).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2583981
	speed: 0.5770s/iter; left time: 19743.4499s
	iters: 200, epoch: 8 | loss: 0.3679073
	speed: 0.1323s/iter; left time: 4513.8415s
	iters: 300, epoch: 8 | loss: 0.5254036
	speed: 0.1840s/iter; left time: 6261.0111s
Epoch: 8 cost time: 61.05912780761719
Epoch: 8, Steps: 369 | Train Loss: 0.494 Vali Loss: 0.678 Vali Acc: 0.640 Test Loss: 0.678 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7119326
	speed: 0.4166s/iter; left time: 14102.9749s
	iters: 200, epoch: 9 | loss: 0.5875816
	speed: 0.0783s/iter; left time: 2643.0506s
	iters: 300, epoch: 9 | loss: 0.4867892
	speed: 0.1539s/iter; left time: 5177.3918s
Epoch: 9 cost time: 41.61053466796875
Epoch: 9, Steps: 369 | Train Loss: 0.465 Vali Loss: 0.663 Vali Acc: 0.670 Test Loss: 0.663 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3175230
	speed: 0.4902s/iter; left time: 16411.1475s
	iters: 200, epoch: 10 | loss: 0.5116344
	speed: 0.1558s/iter; left time: 5200.2970s
	iters: 300, epoch: 10 | loss: 0.3137722
	speed: 0.1650s/iter; left time: 5489.6036s
Epoch: 10 cost time: 57.18385148048401
Epoch: 10, Steps: 369 | Train Loss: 0.485 Vali Loss: 0.731 Vali Acc: 0.642 Test Loss: 0.731 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.6307683
	speed: 0.5112s/iter; left time: 16925.3949s
	iters: 200, epoch: 11 | loss: 0.5672995
	speed: 0.1505s/iter; left time: 4966.6422s
	iters: 300, epoch: 11 | loss: 0.6538433
	speed: 0.1417s/iter; left time: 4662.1357s
Epoch: 11 cost time: 54.94620180130005
Epoch: 11, Steps: 369 | Train Loss: 0.488 Vali Loss: 0.718 Vali Acc: 0.669 Test Loss: 0.718 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3490299
	speed: 0.5217s/iter; left time: 17080.5251s
	iters: 200, epoch: 12 | loss: 0.2542328
	speed: 0.1491s/iter; left time: 4868.1786s
	iters: 300, epoch: 12 | loss: 0.8250490
	speed: 0.1377s/iter; left time: 4480.7112s
Epoch: 12 cost time: 55.69036149978638
Epoch: 12, Steps: 369 | Train Loss: 0.471 Vali Loss: 0.689 Vali Acc: 0.667 Test Loss: 0.689 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.3030321
	speed: 0.4874s/iter; left time: 15777.4394s
	iters: 200, epoch: 13 | loss: 0.1419336
	speed: 0.1525s/iter; left time: 4920.6091s
	iters: 300, epoch: 13 | loss: 0.9404612
	speed: 0.1641s/iter; left time: 5279.5445s
Epoch: 13 cost time: 57.19170880317688
Epoch: 13, Steps: 369 | Train Loss: 0.459 Vali Loss: 0.775 Vali Acc: 0.659 Test Loss: 0.775 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.5272647
	speed: 0.5447s/iter; left time: 17433.7673s
	iters: 200, epoch: 14 | loss: 0.5287560
	speed: 0.1577s/iter; left time: 5032.5647s
	iters: 300, epoch: 14 | loss: 0.1860021
	speed: 0.1490s/iter; left time: 4740.0421s
Epoch: 14 cost time: 57.85758924484253
Epoch: 14, Steps: 369 | Train Loss: 0.450 Vali Loss: 0.757 Vali Acc: 0.655 Test Loss: 0.757 Test Acc: 0.655
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.3527809
	speed: 0.5468s/iter; left time: 17298.1940s
	iters: 200, epoch: 15 | loss: 0.3128090
	speed: 0.1755s/iter; left time: 5535.1053s
	iters: 300, epoch: 15 | loss: 0.4908955
	speed: 0.1584s/iter; left time: 4979.5360s
Epoch: 15 cost time: 61.79238533973694
Epoch: 15, Steps: 369 | Train Loss: 0.461 Vali Loss: 0.719 Vali Acc: 0.644 Test Loss: 0.719 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.6451880
	speed: 0.5351s/iter; left time: 16731.7885s
	iters: 200, epoch: 16 | loss: 0.3767164
	speed: 0.1393s/iter; left time: 4340.9204s
	iters: 300, epoch: 16 | loss: 0.4896365
	speed: 0.1523s/iter; left time: 4732.0962s
Epoch: 16 cost time: 55.68867826461792
Epoch: 16, Steps: 369 | Train Loss: 0.480 Vali Loss: 0.648 Vali Acc: 0.659 Test Loss: 0.648 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.5834941
	speed: 0.4911s/iter; left time: 15174.1521s
	iters: 200, epoch: 17 | loss: 0.6382820
	speed: 0.1602s/iter; left time: 4935.0719s
	iters: 300, epoch: 17 | loss: 0.5079317
	speed: 0.1373s/iter; left time: 4215.9778s
Epoch: 17 cost time: 54.72968554496765
Epoch: 17, Steps: 369 | Train Loss: 0.478 Vali Loss: 0.732 Vali Acc: 0.644 Test Loss: 0.732 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6711123723041997
model parameter : 2219430
model size : 11.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3851753
	speed: 0.1600s/iter; left time: 5887.4523s
	iters: 200, epoch: 1 | loss: 0.5759028
	speed: 0.1613s/iter; left time: 5921.3734s
	iters: 300, epoch: 1 | loss: 1.7596359
	speed: 0.1434s/iter; left time: 5247.4525s
Epoch: 1 cost time: 57.45304083824158
Epoch: 1, Steps: 369 | Train Loss: 1.184 Vali Loss: 2.151 Vali Acc: 0.501 Test Loss: 2.151 Test Acc: 0.501
Validation loss decreased (inf --> -0.500830).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1231977
	speed: 0.4932s/iter; left time: 17969.1643s
	iters: 200, epoch: 2 | loss: 3.4117594
	speed: 0.1539s/iter; left time: 5590.8602s
	iters: 300, epoch: 2 | loss: 1.0021242
	speed: 0.1471s/iter; left time: 5327.9223s
Epoch: 2 cost time: 57.04928135871887
Epoch: 2, Steps: 369 | Train Loss: 1.016 Vali Loss: 2.063 Vali Acc: 0.506 Test Loss: 2.063 Test Acc: 0.506
Validation loss decreased (-0.500830 --> -0.505939).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0306116
	speed: 0.5581s/iter; left time: 20127.5958s
	iters: 200, epoch: 3 | loss: 0.7790049
	speed: 0.1665s/iter; left time: 5987.5789s
	iters: 300, epoch: 3 | loss: 0.9514270
	speed: 0.1790s/iter; left time: 6420.1254s
Epoch: 3 cost time: 62.56360602378845
Epoch: 3, Steps: 369 | Train Loss: 0.776 Vali Loss: 0.691 Vali Acc: 0.624 Test Loss: 0.691 Test Acc: 0.624
Validation loss decreased (-0.505939 --> -0.623716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7103679
	speed: 0.5102s/iter; left time: 18211.7618s
	iters: 200, epoch: 4 | loss: 0.4210734
	speed: 0.1029s/iter; left time: 3661.2807s
	iters: 300, epoch: 4 | loss: 0.7807125
	speed: 0.0670s/iter; left time: 2378.4870s
Epoch: 4 cost time: 37.13785982131958
Epoch: 4, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.899 Vali Acc: 0.571 Test Loss: 0.899 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1463924
	speed: 0.4294s/iter; left time: 15169.5439s
	iters: 200, epoch: 5 | loss: 0.6219701
	speed: 0.1296s/iter; left time: 4564.0004s
	iters: 300, epoch: 5 | loss: 0.5150146
	speed: 0.1657s/iter; left time: 5821.0057s
Epoch: 5 cost time: 57.10061526298523
Epoch: 5, Steps: 369 | Train Loss: 0.623 Vali Loss: 0.711 Vali Acc: 0.595 Test Loss: 0.711 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6086078
	speed: 0.5013s/iter; left time: 17521.9152s
	iters: 200, epoch: 6 | loss: 0.6463106
	speed: 0.1556s/iter; left time: 5424.6261s
	iters: 300, epoch: 6 | loss: 0.7407559
	speed: 0.1503s/iter; left time: 5222.7056s
Epoch: 6 cost time: 57.00229096412659
Epoch: 6, Steps: 369 | Train Loss: 0.574 Vali Loss: 0.723 Vali Acc: 0.635 Test Loss: 0.723 Test Acc: 0.635
Validation loss decreased (-0.623716 --> -0.634499).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6947455
	speed: 0.5165s/iter; left time: 17865.5859s
	iters: 200, epoch: 7 | loss: 0.7565935
	speed: 0.1295s/iter; left time: 4464.4463s
	iters: 300, epoch: 7 | loss: 0.6577263
	speed: 0.1387s/iter; left time: 4769.8513s
Epoch: 7 cost time: 53.33630323410034
Epoch: 7, Steps: 369 | Train Loss: 0.620 Vali Loss: 0.663 Vali Acc: 0.648 Test Loss: 0.663 Test Acc: 0.648
Validation loss decreased (-0.634499 --> -0.648404).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9927741
	speed: 0.5300s/iter; left time: 18136.7954s
	iters: 200, epoch: 8 | loss: 0.6655618
	speed: 0.1340s/iter; left time: 4572.8265s
	iters: 300, epoch: 8 | loss: 0.7167211
	speed: 0.1632s/iter; left time: 5550.1028s
Epoch: 8 cost time: 59.626277923583984
Epoch: 8, Steps: 369 | Train Loss: 0.642 Vali Loss: 0.696 Vali Acc: 0.640 Test Loss: 0.696 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.9899416
	speed: 0.5409s/iter; left time: 18309.3558s
	iters: 200, epoch: 9 | loss: 0.4282435
	speed: 0.1522s/iter; left time: 5136.9989s
	iters: 300, epoch: 9 | loss: 0.6759543
	speed: 0.1577s/iter; left time: 5306.5960s
Epoch: 9 cost time: 58.094780683517456
Epoch: 9, Steps: 369 | Train Loss: 0.599 Vali Loss: 0.665 Vali Acc: 0.625 Test Loss: 0.665 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.4451639
	speed: 0.5402s/iter; left time: 18085.2318s
	iters: 200, epoch: 10 | loss: 0.5410202
	speed: 0.1518s/iter; left time: 5068.6381s
	iters: 300, epoch: 10 | loss: 0.5382850
	speed: 0.1371s/iter; left time: 4563.1024s
Epoch: 10 cost time: 56.764278173446655
Epoch: 10, Steps: 369 | Train Loss: 0.613 Vali Loss: 0.652 Vali Acc: 0.623 Test Loss: 0.652 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.5811043
	speed: 0.5247s/iter; left time: 17373.4450s
	iters: 200, epoch: 11 | loss: 0.5968948
	speed: 0.1343s/iter; left time: 4432.8853s
	iters: 300, epoch: 11 | loss: 0.6352687
	speed: 0.1682s/iter; left time: 5535.9633s
Epoch: 11 cost time: 57.75738835334778
Epoch: 11, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.5972049
	speed: 0.4755s/iter; left time: 15570.4317s
	iters: 200, epoch: 12 | loss: 0.6552974
	speed: 0.1486s/iter; left time: 4849.3865s
	iters: 300, epoch: 12 | loss: 0.6506926
	speed: 0.1585s/iter; left time: 5157.3336s
Epoch: 12 cost time: 55.038320779800415
Epoch: 12, Steps: 369 | Train Loss: 0.739 Vali Loss: 0.693 Vali Acc: 0.501 Test Loss: 0.693 Test Acc: 0.501
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.6836367
	speed: 0.4805s/iter; left time: 15555.7832s
	iters: 200, epoch: 13 | loss: 0.6985968
	speed: 0.1574s/iter; left time: 5080.7345s
	iters: 300, epoch: 13 | loss: 0.7011741
	speed: 0.1333s/iter; left time: 4287.9766s
Epoch: 13 cost time: 52.71252155303955
Epoch: 13, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.7708017
	speed: 0.5056s/iter; left time: 16180.9007s
	iters: 200, epoch: 14 | loss: 0.6813924
	speed: 0.1360s/iter; left time: 4339.6231s
	iters: 300, epoch: 14 | loss: 0.5919605
	speed: 0.1526s/iter; left time: 4852.1987s
Epoch: 14 cost time: 58.03480648994446
Epoch: 14, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.6470548
	speed: 0.5396s/iter; left time: 17069.9747s
	iters: 200, epoch: 15 | loss: 0.6206401
	speed: 0.1601s/iter; left time: 5047.8335s
	iters: 300, epoch: 15 | loss: 0.9428883
	speed: 0.1626s/iter; left time: 5109.7646s
Epoch: 15 cost time: 58.513325691223145
Epoch: 15, Steps: 369 | Train Loss: 0.758 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.1990904
	speed: 0.5490s/iter; left time: 17164.3077s
	iters: 200, epoch: 16 | loss: 0.6621436
	speed: 0.1598s/iter; left time: 4981.4518s
	iters: 300, epoch: 16 | loss: 0.7104787
	speed: 0.1399s/iter; left time: 4345.1476s
Epoch: 16 cost time: 59.12018895149231
Epoch: 16, Steps: 369 | Train Loss: 0.803 Vali Loss: 0.710 Vali Acc: 0.500 Test Loss: 0.710 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.6452900
	speed: 0.5033s/iter; left time: 15551.2607s
	iters: 200, epoch: 17 | loss: 0.7227376
	speed: 0.1404s/iter; left time: 4323.0834s
	iters: 300, epoch: 17 | loss: 0.8487488
	speed: 0.1608s/iter; left time: 4936.9682s
Epoch: 17 cost time: 56.77771759033203
Epoch: 17, Steps: 369 | Train Loss: 0.728 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.648410896708286
model parameter : 2218278
model size : 11.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4881372
	speed: 0.1834s/iter; left time: 6747.6783s
	iters: 200, epoch: 1 | loss: 1.8342655
	speed: 0.1427s/iter; left time: 5235.9954s
	iters: 300, epoch: 1 | loss: 0.8143771
	speed: 0.1233s/iter; left time: 4511.9014s
Epoch: 1 cost time: 50.92544221878052
Epoch: 1, Steps: 369 | Train Loss: 1.261 Vali Loss: 0.861 Vali Acc: 0.509 Test Loss: 0.861 Test Acc: 0.509
Validation loss decreased (inf --> -0.509356).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7470365
	speed: 0.4170s/iter; left time: 15191.3605s
	iters: 200, epoch: 2 | loss: 0.8449702
	speed: 0.1362s/iter; left time: 4946.6042s
	iters: 300, epoch: 2 | loss: 1.0752650
	speed: 0.1682s/iter; left time: 6093.7661s
Epoch: 2 cost time: 55.661211013793945
Epoch: 2, Steps: 369 | Train Loss: 0.722 Vali Loss: 1.087 Vali Acc: 0.526 Test Loss: 1.087 Test Acc: 0.526
Validation loss decreased (-0.509356 --> -0.525528).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8351454
	speed: 0.4965s/iter; left time: 17905.3952s
	iters: 200, epoch: 3 | loss: 0.7060989
	speed: 0.1719s/iter; left time: 6180.3581s
	iters: 300, epoch: 3 | loss: 0.4063935
	speed: 0.1599s/iter; left time: 5733.2447s
Epoch: 3 cost time: 59.4041588306427
Epoch: 3, Steps: 369 | Train Loss: 0.763 Vali Loss: 0.662 Vali Acc: 0.660 Test Loss: 0.662 Test Acc: 0.660
Validation loss decreased (-0.525528 --> -0.659755).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6085463
	speed: 0.5089s/iter; left time: 18166.4278s
	iters: 200, epoch: 4 | loss: 0.4560364
	speed: 0.1672s/iter; left time: 5951.4925s
	iters: 300, epoch: 4 | loss: 0.7422559
	speed: 0.1360s/iter; left time: 4826.6007s
Epoch: 4 cost time: 58.22934556007385
Epoch: 4, Steps: 369 | Train Loss: 0.689 Vali Loss: 0.702 Vali Acc: 0.607 Test Loss: 0.702 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6535593
	speed: 0.5453s/iter; left time: 19262.1561s
	iters: 200, epoch: 5 | loss: 0.5689158
	speed: 0.1405s/iter; left time: 4950.8190s
	iters: 300, epoch: 5 | loss: 0.6662051
	speed: 0.1430s/iter; left time: 5021.1597s
Epoch: 5 cost time: 55.61254262924194
Epoch: 5, Steps: 369 | Train Loss: 0.596 Vali Loss: 0.967 Vali Acc: 0.573 Test Loss: 0.967 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7323596
	speed: 0.4914s/iter; left time: 17176.1266s
	iters: 200, epoch: 6 | loss: 0.2697285
	speed: 0.1631s/iter; left time: 5684.4262s
	iters: 300, epoch: 6 | loss: 0.3077727
	speed: 0.1544s/iter; left time: 5367.2535s
Epoch: 6 cost time: 56.83509159088135
Epoch: 6, Steps: 369 | Train Loss: 0.518 Vali Loss: 0.611 Vali Acc: 0.671 Test Loss: 0.611 Test Acc: 0.671
Validation loss decreased (-0.659755 --> -0.670539).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6425836
	speed: 0.5080s/iter; left time: 17570.7933s
	iters: 200, epoch: 7 | loss: 0.5796301
	speed: 0.1476s/iter; left time: 5088.6297s
	iters: 300, epoch: 7 | loss: 0.2661521
	speed: 0.1311s/iter; left time: 4507.2723s
Epoch: 7 cost time: 52.936564207077026
Epoch: 7, Steps: 369 | Train Loss: 0.458 Vali Loss: 0.674 Vali Acc: 0.663 Test Loss: 0.674 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7577922
	speed: 0.4993s/iter; left time: 17085.7230s
	iters: 200, epoch: 8 | loss: 0.5409353
	speed: 0.1639s/iter; left time: 5592.8866s
	iters: 300, epoch: 8 | loss: 0.3669983
	speed: 0.1135s/iter; left time: 3862.0447s
Epoch: 8 cost time: 53.609853744506836
Epoch: 8, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.715 Vali Acc: 0.669 Test Loss: 0.715 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2108934
	speed: 0.5135s/iter; left time: 17379.7841s
	iters: 200, epoch: 9 | loss: 0.5570004
	speed: 0.1464s/iter; left time: 4939.6404s
	iters: 300, epoch: 9 | loss: 0.3475396
	speed: 0.1542s/iter; left time: 5190.1003s
Epoch: 9 cost time: 52.27011179924011
Epoch: 9, Steps: 369 | Train Loss: 0.447 Vali Loss: 0.848 Vali Acc: 0.646 Test Loss: 0.848 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3327433
	speed: 0.5242s/iter; left time: 17548.9351s
	iters: 200, epoch: 10 | loss: 0.2921637
	speed: 0.1525s/iter; left time: 5091.4614s
	iters: 300, epoch: 10 | loss: 0.4321557
	speed: 0.1394s/iter; left time: 4639.5125s
Epoch: 10 cost time: 54.866368532180786
Epoch: 10, Steps: 369 | Train Loss: 0.441 Vali Loss: 0.719 Vali Acc: 0.640 Test Loss: 0.719 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2186996
	speed: 0.5225s/iter; left time: 17301.1509s
	iters: 200, epoch: 11 | loss: 0.2054954
	speed: 0.1276s/iter; left time: 4213.1844s
	iters: 300, epoch: 11 | loss: 0.4494622
	speed: 0.1231s/iter; left time: 4050.8014s
Epoch: 11 cost time: 51.99150371551514
Epoch: 11, Steps: 369 | Train Loss: 0.427 Vali Loss: 0.887 Vali Acc: 0.647 Test Loss: 0.887 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2235149
	speed: 0.5820s/iter; left time: 19057.0012s
	iters: 200, epoch: 12 | loss: 0.4115224
	speed: 0.1623s/iter; left time: 5299.0932s
	iters: 300, epoch: 12 | loss: 0.2515355
	speed: 0.1303s/iter; left time: 4238.7004s
Epoch: 12 cost time: 54.81435179710388
Epoch: 12, Steps: 369 | Train Loss: 0.419 Vali Loss: 0.866 Vali Acc: 0.675 Test Loss: 0.866 Test Acc: 0.675
Validation loss decreased (-0.670539 --> -0.675360).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4010509
	speed: 0.3755s/iter; left time: 12155.7397s
	iters: 200, epoch: 13 | loss: 0.5387437
	speed: 0.0653s/iter; left time: 2106.5777s
	iters: 300, epoch: 13 | loss: 0.3137756
	speed: 0.0848s/iter; left time: 2726.7201s
Epoch: 13 cost time: 33.81810975074768
Epoch: 13, Steps: 369 | Train Loss: 0.385 Vali Loss: 0.785 Vali Acc: 0.648 Test Loss: 0.785 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.4284475
	speed: 0.5244s/iter; left time: 16781.7561s
	iters: 200, epoch: 14 | loss: 0.5215306
	speed: 0.1192s/iter; left time: 3803.9213s
	iters: 300, epoch: 14 | loss: 0.2567672
	speed: 0.1355s/iter; left time: 4308.5995s
Epoch: 14 cost time: 51.58419060707092
Epoch: 14, Steps: 369 | Train Loss: 0.432 Vali Loss: 1.054 Vali Acc: 0.623 Test Loss: 1.054 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6248296
	speed: 0.4907s/iter; left time: 15522.6629s
	iters: 200, epoch: 15 | loss: 2.2241530
	speed: 0.1350s/iter; left time: 4258.4065s
	iters: 300, epoch: 15 | loss: 1.5430459
	speed: 0.1230s/iter; left time: 3866.0257s
Epoch: 15 cost time: 47.44684648513794
Epoch: 15, Steps: 369 | Train Loss: 1.399 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.8352529
	speed: 0.5438s/iter; left time: 17003.3021s
	iters: 200, epoch: 16 | loss: 1.0607370
	speed: 0.1094s/iter; left time: 3408.2741s
	iters: 300, epoch: 16 | loss: 0.7675385
	speed: 0.1312s/iter; left time: 4074.9139s
Epoch: 16 cost time: 51.4136860370636
Epoch: 16, Steps: 369 | Train Loss: 0.827 Vali Loss: 0.903 Vali Acc: 0.499 Test Loss: 0.903 Test Acc: 0.499
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.7429378
	speed: 0.4974s/iter; left time: 15368.3967s
	iters: 200, epoch: 17 | loss: 0.9121672
	speed: 0.1074s/iter; left time: 3307.6859s
	iters: 300, epoch: 17 | loss: 0.6387219
	speed: 0.1261s/iter; left time: 3871.8734s
Epoch: 17 cost time: 43.983203172683716
Epoch: 17, Steps: 369 | Train Loss: 0.766 Vali Loss: 0.701 Vali Acc: 0.544 Test Loss: 0.701 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.9158160
	speed: 0.5076s/iter; left time: 15496.7425s
	iters: 200, epoch: 18 | loss: 0.6179538
	speed: 0.1469s/iter; left time: 4469.2569s
	iters: 300, epoch: 18 | loss: 0.6962936
	speed: 0.1147s/iter; left time: 3479.2774s
Epoch: 18 cost time: 48.97935676574707
Epoch: 18, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.746 Vali Acc: 0.530 Test Loss: 0.746 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.7218889
	speed: 0.5264s/iter; left time: 15875.9678s
	iters: 200, epoch: 19 | loss: 0.8409406
	speed: 0.1049s/iter; left time: 3153.5997s
	iters: 300, epoch: 19 | loss: 0.7326382
	speed: 0.1298s/iter; left time: 3888.6383s
Epoch: 19 cost time: 51.3705632686615
Epoch: 19, Steps: 369 | Train Loss: 0.744 Vali Loss: 0.714 Vali Acc: 0.520 Test Loss: 0.714 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6855461
	speed: 0.5182s/iter; left time: 15437.9797s
	iters: 200, epoch: 20 | loss: 0.6850038
	speed: 0.1530s/iter; left time: 4543.8494s
	iters: 300, epoch: 20 | loss: 0.7489849
	speed: 0.1230s/iter; left time: 3639.2206s
Epoch: 20 cost time: 51.62580966949463
Epoch: 20, Steps: 369 | Train Loss: 0.740 Vali Loss: 0.699 Vali Acc: 0.500 Test Loss: 0.699 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.7262225
	speed: 0.5293s/iter; left time: 15572.8651s
	iters: 200, epoch: 21 | loss: 0.7502135
	speed: 0.1215s/iter; left time: 3562.0880s
	iters: 300, epoch: 21 | loss: 0.6891285
	speed: 0.1351s/iter; left time: 3948.3087s
Epoch: 21 cost time: 51.65613341331482
Epoch: 21, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.7173756
	speed: 0.4994s/iter; left time: 14509.6444s
	iters: 200, epoch: 22 | loss: 0.7633235
	speed: 0.1010s/iter; left time: 2923.3415s
	iters: 300, epoch: 22 | loss: 0.6721898
	speed: 0.0701s/iter; left time: 2022.1843s
Epoch: 22 cost time: 36.02145838737488
Epoch: 22, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6753688989784336
model parameter : 2217126
model size : 11.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9094186
	speed: 0.2075s/iter; left time: 7635.3364s
	iters: 200, epoch: 1 | loss: 0.9745511
	speed: 0.1524s/iter; left time: 5594.9032s
	iters: 300, epoch: 1 | loss: 0.7800034
	speed: 0.1655s/iter; left time: 6057.4002s
Epoch: 1 cost time: 63.60311484336853
Epoch: 1, Steps: 369 | Train Loss: 1.127 Vali Loss: 0.847 Vali Acc: 0.615 Test Loss: 0.847 Test Acc: 0.615
Validation loss decreased (inf --> -0.615485).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6783243
	speed: 0.5156s/iter; left time: 18784.7927s
	iters: 200, epoch: 2 | loss: 3.8262820
	speed: 0.1533s/iter; left time: 5570.5627s
	iters: 300, epoch: 2 | loss: 1.1646947
	speed: 0.1394s/iter; left time: 5050.6857s
Epoch: 2 cost time: 52.20971322059631
Epoch: 2, Steps: 369 | Train Loss: 1.028 Vali Loss: 0.721 Vali Acc: 0.654 Test Loss: 0.721 Test Acc: 0.654
Validation loss decreased (-0.615485 --> -0.654079).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3638141
	speed: 0.4740s/iter; left time: 17094.5348s
	iters: 200, epoch: 3 | loss: 2.0485628
	speed: 0.1339s/iter; left time: 4816.1747s
	iters: 300, epoch: 3 | loss: 1.2071056
	speed: 0.1426s/iter; left time: 5112.7667s
Epoch: 3 cost time: 52.6368842124939
Epoch: 3, Steps: 369 | Train Loss: 0.769 Vali Loss: 1.101 Vali Acc: 0.514 Test Loss: 1.101 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5538942
	speed: 0.5120s/iter; left time: 18275.3490s
	iters: 200, epoch: 4 | loss: 0.4074015
	speed: 0.1242s/iter; left time: 4420.8010s
	iters: 300, epoch: 4 | loss: 0.9923791
	speed: 0.1407s/iter; left time: 4992.8402s
Epoch: 4 cost time: 46.523741006851196
Epoch: 4, Steps: 369 | Train Loss: 0.739 Vali Loss: 0.679 Vali Acc: 0.635 Test Loss: 0.679 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5381158
	speed: 0.5340s/iter; left time: 18863.0948s
	iters: 200, epoch: 5 | loss: 0.8561968
	speed: 0.1156s/iter; left time: 4071.1082s
	iters: 300, epoch: 5 | loss: 0.6697453
	speed: 0.1456s/iter; left time: 5114.8302s
Epoch: 5 cost time: 52.35864782333374
Epoch: 5, Steps: 369 | Train Loss: 0.660 Vali Loss: 0.887 Vali Acc: 0.601 Test Loss: 0.887 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6884002
	speed: 0.4879s/iter; left time: 17053.2897s
	iters: 200, epoch: 6 | loss: 0.9872130
	speed: 0.1511s/iter; left time: 5267.0142s
	iters: 300, epoch: 6 | loss: 0.9935133
	speed: 0.1188s/iter; left time: 4128.6650s
Epoch: 6 cost time: 48.69229745864868
Epoch: 6, Steps: 369 | Train Loss: 0.641 Vali Loss: 1.285 Vali Acc: 0.500 Test Loss: 1.285 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.9292877
	speed: 0.5427s/iter; left time: 18770.3143s
	iters: 200, epoch: 7 | loss: 0.6813035
	speed: 0.1329s/iter; left time: 4582.4781s
	iters: 300, epoch: 7 | loss: 0.3918974
	speed: 0.1507s/iter; left time: 5182.9356s
Epoch: 7 cost time: 52.444077491760254
Epoch: 7, Steps: 369 | Train Loss: 0.647 Vali Loss: 0.652 Vali Acc: 0.657 Test Loss: 0.652 Test Acc: 0.657
Validation loss decreased (-0.654079 --> -0.657201).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4847448
	speed: 0.5250s/iter; left time: 17965.6486s
	iters: 200, epoch: 8 | loss: 0.4751129
	speed: 0.1414s/iter; left time: 4823.4737s
	iters: 300, epoch: 8 | loss: 0.4538647
	speed: 0.1287s/iter; left time: 4377.6775s
Epoch: 8 cost time: 51.46177673339844
Epoch: 8, Steps: 369 | Train Loss: 0.582 Vali Loss: 0.666 Vali Acc: 0.642 Test Loss: 0.666 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.4667232
	speed: 0.5523s/iter; left time: 18696.1026s
	iters: 200, epoch: 9 | loss: 0.6048072
	speed: 0.1340s/iter; left time: 4521.6559s
	iters: 300, epoch: 9 | loss: 0.5776116
	speed: 0.1086s/iter; left time: 3654.3491s
Epoch: 9 cost time: 46.72642111778259
Epoch: 9, Steps: 369 | Train Loss: 0.580 Vali Loss: 0.659 Vali Acc: 0.648 Test Loss: 0.659 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.5287215
	speed: 0.5474s/iter; left time: 18327.0100s
	iters: 200, epoch: 10 | loss: 0.4944887
	speed: 0.1120s/iter; left time: 3738.3054s
	iters: 300, epoch: 10 | loss: 0.7148800
	speed: 0.1434s/iter; left time: 4772.2733s
Epoch: 10 cost time: 51.24957537651062
Epoch: 10, Steps: 369 | Train Loss: 0.636 Vali Loss: 0.677 Vali Acc: 0.540 Test Loss: 0.677 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.8785287
	speed: 0.5512s/iter; left time: 18250.2116s
	iters: 200, epoch: 11 | loss: 0.8011647
	speed: 0.1365s/iter; left time: 4507.1734s
	iters: 300, epoch: 11 | loss: 0.7059425
	speed: 0.1140s/iter; left time: 3751.0980s
Epoch: 11 cost time: 50.05004572868347
Epoch: 11, Steps: 369 | Train Loss: 0.675 Vali Loss: 0.655 Vali Acc: 0.635 Test Loss: 0.655 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.5604059
	speed: 0.5255s/iter; left time: 17205.2699s
	iters: 200, epoch: 12 | loss: 0.6574838
	speed: 0.1273s/iter; left time: 4156.4460s
	iters: 300, epoch: 12 | loss: 0.7798417
	speed: 0.1477s/iter; left time: 4806.1744s
Epoch: 12 cost time: 47.60252618789673
Epoch: 12, Steps: 369 | Train Loss: 0.619 Vali Loss: 0.647 Vali Acc: 0.634 Test Loss: 0.647 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.6388672
	speed: 0.4902s/iter; left time: 15870.0830s
	iters: 200, epoch: 13 | loss: 0.5481461
	speed: 0.1225s/iter; left time: 3953.7245s
	iters: 300, epoch: 13 | loss: 0.7987790
	speed: 0.1046s/iter; left time: 3366.3952s
Epoch: 13 cost time: 43.25649881362915
Epoch: 13, Steps: 369 | Train Loss: 0.592 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.7125484
	speed: 0.3848s/iter; left time: 12314.1843s
	iters: 200, epoch: 14 | loss: 0.6638451
	speed: 0.0676s/iter; left time: 2157.4053s
	iters: 300, epoch: 14 | loss: 0.6937685
	speed: 0.0686s/iter; left time: 2182.4428s
Epoch: 14 cost time: 26.949753284454346
Epoch: 14, Steps: 369 | Train Loss: 0.674 Vali Loss: 0.685 Vali Acc: 0.580 Test Loss: 0.685 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.4706308
	speed: 0.3723s/iter; left time: 11778.9195s
	iters: 200, epoch: 15 | loss: 0.5569090
	speed: 0.0727s/iter; left time: 2292.3434s
	iters: 300, epoch: 15 | loss: 0.6025208
	speed: 0.0730s/iter; left time: 2294.6912s
Epoch: 15 cost time: 27.94266366958618
Epoch: 15, Steps: 369 | Train Loss: 0.602 Vali Loss: 0.653 Vali Acc: 0.652 Test Loss: 0.653 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.5513248
	speed: 0.3909s/iter; left time: 12223.3425s
	iters: 200, epoch: 16 | loss: 0.3906685
	speed: 0.0726s/iter; left time: 2261.1031s
	iters: 300, epoch: 16 | loss: 0.5044213
	speed: 0.0868s/iter; left time: 2695.9664s
Epoch: 16 cost time: 30.583656549453735
Epoch: 16, Steps: 369 | Train Loss: 0.591 Vali Loss: 0.668 Vali Acc: 0.640 Test Loss: 0.668 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.7505736
	speed: 0.4252s/iter; left time: 13137.6792s
	iters: 200, epoch: 17 | loss: 0.6266007
	speed: 0.0805s/iter; left time: 2478.3376s
	iters: 300, epoch: 17 | loss: 0.8059773
	speed: 0.0891s/iter; left time: 2736.1716s
Epoch: 17 cost time: 34.91446495056152
Epoch: 17, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.660 Vali Acc: 0.633 Test Loss: 0.660 Test Acc: 0.633
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6572077185017026
model parameter : 2215974
model size : 11.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3006970
	speed: 0.1639s/iter; left time: 6032.1669s
	iters: 200, epoch: 1 | loss: 0.7097289
	speed: 0.1350s/iter; left time: 4954.4896s
	iters: 300, epoch: 1 | loss: 1.0044651
	speed: 0.1403s/iter; left time: 5134.0520s
Epoch: 1 cost time: 52.42323565483093
Epoch: 1, Steps: 369 | Train Loss: 1.118 Vali Loss: 0.674 Vali Acc: 0.646 Test Loss: 0.674 Test Acc: 0.646
Validation loss decreased (inf --> -0.645850).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4862767
	speed: 0.5847s/iter; left time: 21303.5311s
	iters: 200, epoch: 2 | loss: 1.5297930
	speed: 0.1110s/iter; left time: 4033.1596s
	iters: 300, epoch: 2 | loss: 0.6634835
	speed: 0.1535s/iter; left time: 5561.3251s
Epoch: 2 cost time: 49.85006880760193
Epoch: 2, Steps: 369 | Train Loss: 0.802 Vali Loss: 0.738 Vali Acc: 0.623 Test Loss: 0.738 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3788485
	speed: 0.6104s/iter; left time: 22014.4640s
	iters: 200, epoch: 3 | loss: 0.5016658
	speed: 0.1065s/iter; left time: 3828.7707s
	iters: 300, epoch: 3 | loss: 0.7031569
	speed: 0.1264s/iter; left time: 4533.8538s
Epoch: 3 cost time: 50.71315622329712
Epoch: 3, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.935 Vali Acc: 0.640 Test Loss: 0.935 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.3690263
	speed: 0.5653s/iter; left time: 20176.1128s
	iters: 200, epoch: 4 | loss: 0.5202358
	speed: 0.1497s/iter; left time: 5327.5913s
	iters: 300, epoch: 4 | loss: 0.5689537
	speed: 0.1237s/iter; left time: 4392.1089s
Epoch: 4 cost time: 48.37982797622681
Epoch: 4, Steps: 369 | Train Loss: 0.697 Vali Loss: 1.222 Vali Acc: 0.522 Test Loss: 1.222 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.2983160
	speed: 0.5457s/iter; left time: 19275.1777s
	iters: 200, epoch: 5 | loss: 0.7264101
	speed: 0.1299s/iter; left time: 4575.8102s
	iters: 300, epoch: 5 | loss: 0.5775303
	speed: 0.1341s/iter; left time: 4709.2692s
Epoch: 5 cost time: 48.00926208496094
Epoch: 5, Steps: 369 | Train Loss: 0.581 Vali Loss: 0.635 Vali Acc: 0.686 Test Loss: 0.635 Test Acc: 0.686
Validation loss decreased (-0.645850 --> -0.686430).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3096094
	speed: 0.5729s/iter; left time: 20027.1025s
	iters: 200, epoch: 6 | loss: 0.6416219
	speed: 0.1249s/iter; left time: 4354.6907s
	iters: 300, epoch: 6 | loss: 0.3537512
	speed: 0.1327s/iter; left time: 4613.8453s
Epoch: 6 cost time: 50.11583471298218
Epoch: 6, Steps: 369 | Train Loss: 0.481 Vali Loss: 0.658 Vali Acc: 0.656 Test Loss: 0.658 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7954662
	speed: 0.5820s/iter; left time: 20130.6184s
	iters: 200, epoch: 7 | loss: 0.5804256
	speed: 0.1374s/iter; left time: 4738.6292s
	iters: 300, epoch: 7 | loss: 0.4233168
	speed: 0.1167s/iter; left time: 4011.6837s
Epoch: 7 cost time: 51.38924050331116
Epoch: 7, Steps: 369 | Train Loss: 0.493 Vali Loss: 0.629 Vali Acc: 0.662 Test Loss: 0.629 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3428157
	speed: 0.5204s/iter; left time: 17805.4923s
	iters: 200, epoch: 8 | loss: 0.4595822
	speed: 0.1225s/iter; left time: 4178.5828s
	iters: 300, epoch: 8 | loss: 0.3596706
	speed: 0.1350s/iter; left time: 4592.2597s
Epoch: 8 cost time: 44.64219427108765
Epoch: 8, Steps: 369 | Train Loss: 0.500 Vali Loss: 0.792 Vali Acc: 0.661 Test Loss: 0.792 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4480613
	speed: 0.4772s/iter; left time: 16154.4142s
	iters: 200, epoch: 9 | loss: 0.4715838
	speed: 0.0934s/iter; left time: 3152.1885s
	iters: 300, epoch: 9 | loss: 0.7673426
	speed: 0.0742s/iter; left time: 2498.1390s
Epoch: 9 cost time: 32.525514364242554
Epoch: 9, Steps: 369 | Train Loss: 0.507 Vali Loss: 0.731 Vali Acc: 0.605 Test Loss: 0.731 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4879968
	speed: 0.4528s/iter; left time: 15160.7974s
	iters: 200, epoch: 10 | loss: 0.2997690
	speed: 0.1157s/iter; left time: 3860.8149s
	iters: 300, epoch: 10 | loss: 0.3620618
	speed: 0.1177s/iter; left time: 3917.7154s
Epoch: 10 cost time: 47.96732497215271
Epoch: 10, Steps: 369 | Train Loss: 0.490 Vali Loss: 0.766 Vali Acc: 0.647 Test Loss: 0.766 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4891961
	speed: 0.5226s/iter; left time: 17304.0554s
	iters: 200, epoch: 11 | loss: 0.5286174
	speed: 0.1419s/iter; left time: 4683.4868s
	iters: 300, epoch: 11 | loss: 0.5423378
	speed: 0.1195s/iter; left time: 3932.0867s
Epoch: 11 cost time: 48.992881536483765
Epoch: 11, Steps: 369 | Train Loss: 0.481 Vali Loss: 0.642 Vali Acc: 0.672 Test Loss: 0.642 Test Acc: 0.672
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.5476579
	speed: 0.5182s/iter; left time: 16965.9966s
	iters: 200, epoch: 12 | loss: 0.5414700
	speed: 0.1144s/iter; left time: 3733.2188s
	iters: 300, epoch: 12 | loss: 0.4697405
	speed: 0.1474s/iter; left time: 4795.8527s
Epoch: 12 cost time: 47.62289261817932
Epoch: 12, Steps: 369 | Train Loss: 0.492 Vali Loss: 0.874 Vali Acc: 0.631 Test Loss: 0.874 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.5855654
	speed: 0.4983s/iter; left time: 16131.8995s
	iters: 200, epoch: 13 | loss: 0.9420924
	speed: 0.1206s/iter; left time: 3892.0461s
	iters: 300, epoch: 13 | loss: 0.3965566
	speed: 0.0914s/iter; left time: 2939.2793s
Epoch: 13 cost time: 45.3688690662384
Epoch: 13, Steps: 369 | Train Loss: 0.492 Vali Loss: 0.733 Vali Acc: 0.655 Test Loss: 0.733 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.3752980
	speed: 0.5233s/iter; left time: 16747.7664s
	iters: 200, epoch: 14 | loss: 0.5558765
	speed: 0.1118s/iter; left time: 3567.2477s
	iters: 300, epoch: 14 | loss: 0.6096311
	speed: 0.1403s/iter; left time: 4463.1950s
Epoch: 14 cost time: 47.84004092216492
Epoch: 14, Steps: 369 | Train Loss: 0.513 Vali Loss: 0.777 Vali Acc: 0.610 Test Loss: 0.777 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.3791252
	speed: 0.4951s/iter; left time: 15661.2224s
	iters: 200, epoch: 15 | loss: 0.3042797
	speed: 0.1329s/iter; left time: 4192.5453s
	iters: 300, epoch: 15 | loss: 0.6724855
	speed: 0.1106s/iter; left time: 3475.7215s
Epoch: 15 cost time: 46.900007486343384
Epoch: 15, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.679 Vali Acc: 0.630 Test Loss: 0.679 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6864358683314415
model parameter : 1890470
model size : 9.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6671522
	speed: 0.1636s/iter; left time: 6020.8788s
	iters: 200, epoch: 1 | loss: 0.4033153
	speed: 0.1210s/iter; left time: 4440.2423s
	iters: 300, epoch: 1 | loss: 0.7871873
	speed: 0.0977s/iter; left time: 3577.3288s
Epoch: 1 cost time: 45.31059956550598
Epoch: 1, Steps: 369 | Train Loss: 1.470 Vali Loss: 1.363 Vali Acc: 0.594 Test Loss: 1.363 Test Acc: 0.594
Validation loss decreased (inf --> -0.594481).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9730988
	speed: 0.3662s/iter; left time: 13342.7553s
	iters: 200, epoch: 2 | loss: 0.5618073
	speed: 0.0759s/iter; left time: 2758.1265s
	iters: 300, epoch: 2 | loss: 0.8643764
	speed: 0.1476s/iter; left time: 5349.3932s
Epoch: 2 cost time: 38.02204251289368
Epoch: 2, Steps: 369 | Train Loss: 0.902 Vali Loss: 1.073 Vali Acc: 0.588 Test Loss: 1.073 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8331226
	speed: 0.4969s/iter; left time: 17919.0690s
	iters: 200, epoch: 3 | loss: 2.0886633
	speed: 0.1131s/iter; left time: 4066.0981s
	iters: 300, epoch: 3 | loss: 1.3359675
	speed: 0.0945s/iter; left time: 3388.9655s
Epoch: 3 cost time: 44.20946907997131
Epoch: 3, Steps: 369 | Train Loss: 0.734 Vali Loss: 1.503 Vali Acc: 0.544 Test Loss: 1.503 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2903978
	speed: 0.5157s/iter; left time: 18406.4379s
	iters: 200, epoch: 4 | loss: 0.4367382
	speed: 0.1292s/iter; left time: 4597.6906s
	iters: 300, epoch: 4 | loss: 0.8505616
	speed: 0.1307s/iter; left time: 4638.0018s
Epoch: 4 cost time: 47.8731210231781
Epoch: 4, Steps: 369 | Train Loss: 0.646 Vali Loss: 0.656 Vali Acc: 0.660 Test Loss: 0.656 Test Acc: 0.660
Validation loss decreased (-0.594481 --> -0.660323).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8652916
	speed: 0.4989s/iter; left time: 17623.0494s
	iters: 200, epoch: 5 | loss: 0.7370930
	speed: 0.1130s/iter; left time: 3978.7312s
	iters: 300, epoch: 5 | loss: 0.5224658
	speed: 0.1221s/iter; left time: 4289.0738s
Epoch: 5 cost time: 48.89249300956726
Epoch: 5, Steps: 369 | Train Loss: 0.533 Vali Loss: 0.646 Vali Acc: 0.678 Test Loss: 0.646 Test Acc: 0.678
Validation loss decreased (-0.660323 --> -0.678200).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5308474
	speed: 0.5427s/iter; left time: 18971.1183s
	iters: 200, epoch: 6 | loss: 0.6582119
	speed: 0.1386s/iter; left time: 4831.6663s
	iters: 300, epoch: 6 | loss: 0.5113980
	speed: 0.1276s/iter; left time: 4436.4033s
Epoch: 6 cost time: 49.306615352630615
Epoch: 6, Steps: 369 | Train Loss: 0.475 Vali Loss: 0.764 Vali Acc: 0.667 Test Loss: 0.764 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4283427
	speed: 0.4896s/iter; left time: 16935.0033s
	iters: 200, epoch: 7 | loss: 0.1772412
	speed: 0.1307s/iter; left time: 4507.9790s
	iters: 300, epoch: 7 | loss: 0.2173823
	speed: 0.1132s/iter; left time: 3892.2155s
Epoch: 7 cost time: 49.23218011856079
Epoch: 7, Steps: 369 | Train Loss: 0.420 Vali Loss: 0.853 Vali Acc: 0.644 Test Loss: 0.853 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3411095
	speed: 0.5040s/iter; left time: 17245.7775s
	iters: 200, epoch: 8 | loss: 0.6214927
	speed: 0.1570s/iter; left time: 5355.4975s
	iters: 300, epoch: 8 | loss: 0.3500004
	speed: 0.1250s/iter; left time: 4252.3183s
Epoch: 8 cost time: 50.52923917770386
Epoch: 8, Steps: 369 | Train Loss: 0.406 Vali Loss: 0.774 Vali Acc: 0.648 Test Loss: 0.774 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4838878
	speed: 0.4906s/iter; left time: 16606.2609s
	iters: 200, epoch: 9 | loss: 0.6993129
	speed: 0.1222s/iter; left time: 4124.8562s
	iters: 300, epoch: 9 | loss: 0.4626256
	speed: 0.1234s/iter; left time: 4151.0625s
Epoch: 9 cost time: 50.324267864227295
Epoch: 9, Steps: 369 | Train Loss: 0.410 Vali Loss: 0.702 Vali Acc: 0.662 Test Loss: 0.702 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2336610
	speed: 0.5127s/iter; left time: 17165.1036s
	iters: 200, epoch: 10 | loss: 0.4997279
	speed: 0.1328s/iter; left time: 4434.2831s
	iters: 300, epoch: 10 | loss: 0.5797441
	speed: 0.1651s/iter; left time: 5493.2457s
Epoch: 10 cost time: 51.987324714660645
Epoch: 10, Steps: 369 | Train Loss: 0.418 Vali Loss: 0.730 Vali Acc: 0.657 Test Loss: 0.730 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1941409
	speed: 0.5302s/iter; left time: 17554.7585s
	iters: 200, epoch: 11 | loss: 0.3478105
	speed: 0.1071s/iter; left time: 3535.0015s
	iters: 300, epoch: 11 | loss: 0.2257503
	speed: 0.1134s/iter; left time: 3730.5975s
Epoch: 11 cost time: 48.40520691871643
Epoch: 11, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.885 Vali Acc: 0.648 Test Loss: 0.885 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2287794
	speed: 0.4358s/iter; left time: 14268.8724s
	iters: 200, epoch: 12 | loss: 0.4761348
	speed: 0.0749s/iter; left time: 2445.9202s
	iters: 300, epoch: 12 | loss: 0.6216857
	speed: 0.0705s/iter; left time: 2294.1626s
Epoch: 12 cost time: 28.053844451904297
Epoch: 12, Steps: 369 | Train Loss: 0.409 Vali Loss: 0.740 Vali Acc: 0.661 Test Loss: 0.740 Test Acc: 0.661
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.3686734
	speed: 0.3430s/iter; left time: 11104.6310s
	iters: 200, epoch: 13 | loss: 0.3055483
	speed: 0.0776s/iter; left time: 2504.7533s
	iters: 300, epoch: 13 | loss: 0.2579834
	speed: 0.1505s/iter; left time: 4840.7016s
Epoch: 13 cost time: 40.592446088790894
Epoch: 13, Steps: 369 | Train Loss: 0.398 Vali Loss: 0.800 Vali Acc: 0.669 Test Loss: 0.800 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1973020
	speed: 0.5091s/iter; left time: 16294.7005s
	iters: 200, epoch: 14 | loss: 0.4037042
	speed: 0.1407s/iter; left time: 4490.3903s
	iters: 300, epoch: 14 | loss: 0.1193945
	speed: 0.1077s/iter; left time: 3426.2790s
Epoch: 14 cost time: 51.55944466590881
Epoch: 14, Steps: 369 | Train Loss: 0.386 Vali Loss: 0.886 Vali Acc: 0.648 Test Loss: 0.886 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.4146666
	speed: 0.5175s/iter; left time: 16370.1004s
	iters: 200, epoch: 15 | loss: 0.7003539
	speed: 0.1231s/iter; left time: 3883.0936s
	iters: 300, epoch: 15 | loss: 0.5165107
	speed: 0.1524s/iter; left time: 4790.0989s
Epoch: 15 cost time: 51.348047733306885
Epoch: 15, Steps: 369 | Train Loss: 0.405 Vali Loss: 0.800 Vali Acc: 0.655 Test Loss: 0.800 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6782065834279228
model parameter : 1889318
model size : 9.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.4413369
	speed: 0.1874s/iter; left time: 6897.7409s
	iters: 200, epoch: 1 | loss: 2.5955226
	speed: 0.1187s/iter; left time: 4355.0171s
	iters: 300, epoch: 1 | loss: 0.5556790
	speed: 0.1676s/iter; left time: 6133.1392s
Epoch: 1 cost time: 56.76518154144287
Epoch: 1, Steps: 369 | Train Loss: 1.179 Vali Loss: 0.787 Vali Acc: 0.625 Test Loss: 0.787 Test Acc: 0.625
Validation loss decreased (inf --> -0.624850).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1030258
	speed: 0.5026s/iter; left time: 18312.2874s
	iters: 200, epoch: 2 | loss: 1.4835148
	speed: 0.1518s/iter; left time: 5514.0892s
	iters: 300, epoch: 2 | loss: 0.9065764
	speed: 0.1233s/iter; left time: 4467.1404s
Epoch: 2 cost time: 52.213202476501465
Epoch: 2, Steps: 369 | Train Loss: 0.899 Vali Loss: 1.056 Vali Acc: 0.550 Test Loss: 1.056 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4999065
	speed: 0.5378s/iter; left time: 19393.8386s
	iters: 200, epoch: 3 | loss: 0.5652338
	speed: 0.1150s/iter; left time: 4136.2293s
	iters: 300, epoch: 3 | loss: 0.5984195
	speed: 0.1236s/iter; left time: 4434.0146s
Epoch: 3 cost time: 50.96493482589722
Epoch: 3, Steps: 369 | Train Loss: 0.756 Vali Loss: 0.652 Vali Acc: 0.662 Test Loss: 0.652 Test Acc: 0.662
Validation loss decreased (-0.624850 --> -0.662025).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3247310
	speed: 0.4724s/iter; left time: 16861.1190s
	iters: 200, epoch: 4 | loss: 0.6563361
	speed: 0.1314s/iter; left time: 4678.6817s
	iters: 300, epoch: 4 | loss: 0.5591013
	speed: 0.1356s/iter; left time: 4812.9259s
Epoch: 4 cost time: 50.22320914268494
Epoch: 4, Steps: 369 | Train Loss: 0.633 Vali Loss: 0.682 Vali Acc: 0.660 Test Loss: 0.682 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1448338
	speed: 0.5015s/iter; left time: 17716.4335s
	iters: 200, epoch: 5 | loss: 0.3309535
	speed: 0.1342s/iter; left time: 4727.1908s
	iters: 300, epoch: 5 | loss: 0.7686005
	speed: 0.1302s/iter; left time: 4574.2511s
Epoch: 5 cost time: 52.698784589767456
Epoch: 5, Steps: 369 | Train Loss: 0.554 Vali Loss: 0.649 Vali Acc: 0.680 Test Loss: 0.649 Test Acc: 0.680
Validation loss decreased (-0.662025 --> -0.680470).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4630656
	speed: 0.4789s/iter; left time: 16741.8537s
	iters: 200, epoch: 6 | loss: 0.3385566
	speed: 0.1404s/iter; left time: 4893.1361s
	iters: 300, epoch: 6 | loss: 0.3740214
	speed: 0.1373s/iter; left time: 4772.9318s
Epoch: 6 cost time: 48.29179835319519
Epoch: 6, Steps: 369 | Train Loss: 0.475 Vali Loss: 0.681 Vali Acc: 0.653 Test Loss: 0.681 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5547217
	speed: 0.4734s/iter; left time: 16374.9925s
	iters: 200, epoch: 7 | loss: 0.3394589
	speed: 0.1358s/iter; left time: 4684.7015s
	iters: 300, epoch: 7 | loss: 0.3806260
	speed: 0.1197s/iter; left time: 4115.2125s
Epoch: 7 cost time: 50.47199034690857
Epoch: 7, Steps: 369 | Train Loss: 0.438 Vali Loss: 0.667 Vali Acc: 0.673 Test Loss: 0.667 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3261304
	speed: 0.5137s/iter; left time: 17576.4120s
	iters: 200, epoch: 8 | loss: 0.6061846
	speed: 0.1412s/iter; left time: 4817.6295s
	iters: 300, epoch: 8 | loss: 0.3239919
	speed: 0.1534s/iter; left time: 5219.8829s
Epoch: 8 cost time: 54.438310384750366
Epoch: 8, Steps: 369 | Train Loss: 0.407 Vali Loss: 0.771 Vali Acc: 0.675 Test Loss: 0.771 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3745608
	speed: 0.4938s/iter; left time: 16715.7425s
	iters: 200, epoch: 9 | loss: 0.3490121
	speed: 0.1543s/iter; left time: 5205.8002s
	iters: 300, epoch: 9 | loss: 0.2706798
	speed: 0.1402s/iter; left time: 4717.8300s
Epoch: 9 cost time: 54.7529456615448
Epoch: 9, Steps: 369 | Train Loss: 0.383 Vali Loss: 0.795 Vali Acc: 0.664 Test Loss: 0.795 Test Acc: 0.664
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4567293
	speed: 0.4594s/iter; left time: 15380.9939s
	iters: 200, epoch: 10 | loss: 0.2663974
	speed: 0.0801s/iter; left time: 2674.0815s
	iters: 300, epoch: 10 | loss: 0.3322556
	speed: 0.0758s/iter; left time: 2521.9042s
Epoch: 10 cost time: 32.01297330856323
Epoch: 10, Steps: 369 | Train Loss: 0.423 Vali Loss: 0.709 Vali Acc: 0.650 Test Loss: 0.709 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.6040669
	speed: 0.4477s/iter; left time: 14824.6337s
	iters: 200, epoch: 11 | loss: 0.7853400
	speed: 0.1373s/iter; left time: 4531.7872s
	iters: 300, epoch: 11 | loss: 0.5619616
	speed: 0.1354s/iter; left time: 4455.0660s
Epoch: 11 cost time: 50.95087671279907
Epoch: 11, Steps: 369 | Train Loss: 0.411 Vali Loss: 1.018 Vali Acc: 0.597 Test Loss: 1.018 Test Acc: 0.597
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1576191
	speed: 0.4980s/iter; left time: 16304.4418s
	iters: 200, epoch: 12 | loss: 0.1162533
	speed: 0.1329s/iter; left time: 4337.6778s
	iters: 300, epoch: 12 | loss: 0.5794329
	speed: 0.1286s/iter; left time: 4183.5804s
Epoch: 12 cost time: 49.26946568489075
Epoch: 12, Steps: 369 | Train Loss: 0.398 Vali Loss: 0.896 Vali Acc: 0.654 Test Loss: 0.896 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.5056638
	speed: 0.5076s/iter; left time: 16431.6426s
	iters: 200, epoch: 13 | loss: 0.2634065
	speed: 0.1380s/iter; left time: 4454.8689s
	iters: 300, epoch: 13 | loss: 0.2928509
	speed: 0.1375s/iter; left time: 4422.7057s
Epoch: 13 cost time: 55.084574460983276
Epoch: 13, Steps: 369 | Train Loss: 0.368 Vali Loss: 0.847 Vali Acc: 0.649 Test Loss: 0.847 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.8175379
	speed: 0.4845s/iter; left time: 15504.7925s
	iters: 200, epoch: 14 | loss: 0.3363532
	speed: 0.1362s/iter; left time: 4343.8413s
	iters: 300, epoch: 14 | loss: 0.3714619
	speed: 0.1499s/iter; left time: 4767.8361s
Epoch: 14 cost time: 52.47026252746582
Epoch: 14, Steps: 369 | Train Loss: 0.353 Vali Loss: 0.803 Vali Acc: 0.662 Test Loss: 0.803 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.4708233
	speed: 0.5300s/iter; left time: 16767.1639s
	iters: 200, epoch: 15 | loss: 0.8716181
	speed: 0.1335s/iter; left time: 4211.0936s
	iters: 300, epoch: 15 | loss: 0.4396074
	speed: 0.1716s/iter; left time: 5394.4695s
Epoch: 15 cost time: 56.59396982192993
Epoch: 15, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.903 Vali Acc: 0.636 Test Loss: 0.903 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6804767309875142
model parameter : 1888166
model size : 9.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.6968441
	speed: 0.1602s/iter; left time: 5896.6601s
	iters: 200, epoch: 1 | loss: 1.3011055
	speed: 0.1201s/iter; left time: 4408.3709s
	iters: 300, epoch: 1 | loss: 2.1053047
	speed: 0.1456s/iter; left time: 5327.4324s
Epoch: 1 cost time: 51.85613250732422
Epoch: 1, Steps: 369 | Train Loss: 1.121 Vali Loss: 0.973 Vali Acc: 0.544 Test Loss: 0.973 Test Acc: 0.544
Validation loss decreased (inf --> -0.544258).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6212019
	speed: 0.4702s/iter; left time: 17131.4800s
	iters: 200, epoch: 2 | loss: 0.9045148
	speed: 0.1424s/iter; left time: 5173.9581s
	iters: 300, epoch: 2 | loss: 0.5050939
	speed: 0.1279s/iter; left time: 4634.7872s
Epoch: 2 cost time: 51.96239686012268
Epoch: 2, Steps: 369 | Train Loss: 0.798 Vali Loss: 0.634 Vali Acc: 0.654 Test Loss: 0.634 Test Acc: 0.654
Validation loss decreased (-0.544258 --> -0.654080).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5142086
	speed: 0.4964s/iter; left time: 17903.0541s
	iters: 200, epoch: 3 | loss: 0.8588811
	speed: 0.1282s/iter; left time: 4610.3935s
	iters: 300, epoch: 3 | loss: 0.6623746
	speed: 0.1609s/iter; left time: 5771.2552s
Epoch: 3 cost time: 51.59807896614075
Epoch: 3, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.727 Vali Acc: 0.615 Test Loss: 0.727 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2109210
	speed: 0.4470s/iter; left time: 15954.9287s
	iters: 200, epoch: 4 | loss: 0.2036001
	speed: 0.1482s/iter; left time: 5274.7920s
	iters: 300, epoch: 4 | loss: 0.5889971
	speed: 0.1196s/iter; left time: 4244.2645s
Epoch: 4 cost time: 50.049803733825684
Epoch: 4, Steps: 369 | Train Loss: 0.675 Vali Loss: 1.033 Vali Acc: 0.569 Test Loss: 1.033 Test Acc: 0.569
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8722236
	speed: 0.4802s/iter; left time: 16962.7996s
	iters: 200, epoch: 5 | loss: 0.5014591
	speed: 0.1484s/iter; left time: 5227.7203s
	iters: 300, epoch: 5 | loss: 0.7821790
	speed: 0.1714s/iter; left time: 6020.6581s
Epoch: 5 cost time: 56.30279850959778
Epoch: 5, Steps: 369 | Train Loss: 0.594 Vali Loss: 0.744 Vali Acc: 0.632 Test Loss: 0.744 Test Acc: 0.632
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.4198360
	speed: 0.5037s/iter; left time: 17605.8308s
	iters: 200, epoch: 6 | loss: 0.4758410
	speed: 0.1512s/iter; left time: 5270.0312s
	iters: 300, epoch: 6 | loss: 0.5010095
	speed: 0.1176s/iter; left time: 4086.7961s
Epoch: 6 cost time: 53.515460729599
Epoch: 6, Steps: 369 | Train Loss: 0.516 Vali Loss: 0.620 Vali Acc: 0.682 Test Loss: 0.620 Test Acc: 0.682
Validation loss decreased (-0.654080 --> -0.681606).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9948325
	speed: 0.5251s/iter; left time: 18162.3070s
	iters: 200, epoch: 7 | loss: 0.4370840
	speed: 0.1311s/iter; left time: 4520.5032s
	iters: 300, epoch: 7 | loss: 0.3365419
	speed: 0.1644s/iter; left time: 5651.7209s
Epoch: 7 cost time: 53.78315091133118
Epoch: 7, Steps: 369 | Train Loss: 0.476 Vali Loss: 0.686 Vali Acc: 0.675 Test Loss: 0.686 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6160297
	speed: 0.4497s/iter; left time: 15386.7288s
	iters: 200, epoch: 8 | loss: 0.6187189
	speed: 0.1557s/iter; left time: 5311.0727s
	iters: 300, epoch: 8 | loss: 0.6336021
	speed: 0.1261s/iter; left time: 4290.1820s
Epoch: 8 cost time: 50.18166375160217
Epoch: 8, Steps: 369 | Train Loss: 0.442 Vali Loss: 0.993 Vali Acc: 0.568 Test Loss: 0.993 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4540263
	speed: 0.5132s/iter; left time: 17371.6737s
	iters: 200, epoch: 9 | loss: 0.3784930
	speed: 0.1279s/iter; left time: 4317.6993s
	iters: 300, epoch: 9 | loss: 0.4249578
	speed: 0.1440s/iter; left time: 4846.9600s
Epoch: 9 cost time: 55.41764259338379
Epoch: 9, Steps: 369 | Train Loss: 0.438 Vali Loss: 0.797 Vali Acc: 0.673 Test Loss: 0.797 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4649669
	speed: 0.5000s/iter; left time: 16738.8229s
	iters: 200, epoch: 10 | loss: 0.4872400
	speed: 0.1364s/iter; left time: 4552.1707s
	iters: 300, epoch: 10 | loss: 0.4512282
	speed: 0.1449s/iter; left time: 4823.1878s
Epoch: 10 cost time: 53.35949492454529
Epoch: 10, Steps: 369 | Train Loss: 0.400 Vali Loss: 0.740 Vali Acc: 0.650 Test Loss: 0.740 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4135656
	speed: 0.4738s/iter; left time: 15689.1780s
	iters: 200, epoch: 11 | loss: 0.1542024
	speed: 0.1409s/iter; left time: 4649.7316s
	iters: 300, epoch: 11 | loss: 0.4724702
	speed: 0.1306s/iter; left time: 4297.6575s
Epoch: 11 cost time: 50.888145208358765
Epoch: 11, Steps: 369 | Train Loss: 0.372 Vali Loss: 0.858 Vali Acc: 0.639 Test Loss: 0.858 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1652910
	speed: 0.4626s/iter; left time: 15147.4805s
	iters: 200, epoch: 12 | loss: 0.2417525
	speed: 0.0812s/iter; left time: 2649.7962s
	iters: 300, epoch: 12 | loss: 0.4281775
	speed: 0.0762s/iter; left time: 2480.8326s
Epoch: 12 cost time: 32.76903033256531
Epoch: 12, Steps: 369 | Train Loss: 0.382 Vali Loss: 0.635 Vali Acc: 0.647 Test Loss: 0.635 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2119240
	speed: 0.4906s/iter; left time: 15882.2554s
	iters: 200, epoch: 13 | loss: 0.7780529
	speed: 0.1246s/iter; left time: 4021.0705s
	iters: 300, epoch: 13 | loss: 0.3556560
	speed: 0.1138s/iter; left time: 3659.9400s
Epoch: 13 cost time: 52.541176319122314
Epoch: 13, Steps: 369 | Train Loss: 0.402 Vali Loss: 1.108 Vali Acc: 0.599 Test Loss: 1.108 Test Acc: 0.599
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.4071956
	speed: 0.5405s/iter; left time: 17299.3220s
	iters: 200, epoch: 14 | loss: 0.6148533
	speed: 0.1736s/iter; left time: 5539.0703s
	iters: 300, epoch: 14 | loss: 0.3006102
	speed: 0.1518s/iter; left time: 4827.3898s
Epoch: 14 cost time: 56.93737077713013
Epoch: 14, Steps: 369 | Train Loss: 0.395 Vali Loss: 0.783 Vali Acc: 0.658 Test Loss: 0.783 Test Acc: 0.658
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.4712272
	speed: 0.4497s/iter; left time: 14225.9243s
	iters: 200, epoch: 15 | loss: 0.4230928
	speed: 0.1410s/iter; left time: 4445.9018s
	iters: 300, epoch: 15 | loss: 0.4214044
	speed: 0.1354s/iter; left time: 4256.1194s
Epoch: 15 cost time: 51.527260303497314
Epoch: 15, Steps: 369 | Train Loss: 0.372 Vali Loss: 0.862 Vali Acc: 0.635 Test Loss: 0.862 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.1988269
	speed: 0.5074s/iter; left time: 15863.2784s
	iters: 200, epoch: 16 | loss: 0.2824163
	speed: 0.1388s/iter; left time: 4326.8239s
	iters: 300, epoch: 16 | loss: 0.4417242
	speed: 0.1311s/iter; left time: 4072.9494s
Epoch: 16 cost time: 52.30810904502869
Epoch: 16, Steps: 369 | Train Loss: 0.348 Vali Loss: 0.840 Vali Acc: 0.664 Test Loss: 0.840 Test Acc: 0.664
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6816118047673099
model parameter : 1887014
model size : 9.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4610863
	speed: 0.1281s/iter; left time: 4715.4689s
	iters: 200, epoch: 1 | loss: 0.9815310
	speed: 0.1281s/iter; left time: 4699.8208s
	iters: 300, epoch: 1 | loss: 0.6309602
	speed: 0.1553s/iter; left time: 5683.7342s
Epoch: 1 cost time: 50.61588191986084
Epoch: 1, Steps: 369 | Train Loss: 1.022 Vali Loss: 2.851 Vali Acc: 0.500 Test Loss: 2.851 Test Acc: 0.500
Validation loss decreased (inf --> -0.500255).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8217242
	speed: 0.4750s/iter; left time: 17306.6014s
	iters: 200, epoch: 2 | loss: 0.5774002
	speed: 0.1338s/iter; left time: 4861.2953s
	iters: 300, epoch: 2 | loss: 0.6162079
	speed: 0.1281s/iter; left time: 4641.8337s
Epoch: 2 cost time: 51.12957978248596
Epoch: 2, Steps: 369 | Train Loss: 0.910 Vali Loss: 0.730 Vali Acc: 0.625 Test Loss: 0.730 Test Acc: 0.625
Validation loss decreased (-0.500255 --> -0.624851).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4172856
	speed: 0.4724s/iter; left time: 17036.5157s
	iters: 200, epoch: 3 | loss: 1.0411355
	speed: 0.1698s/iter; left time: 6107.5112s
	iters: 300, epoch: 3 | loss: 0.7466182
	speed: 0.1404s/iter; left time: 5035.2826s
Epoch: 3 cost time: 55.39453911781311
Epoch: 3, Steps: 369 | Train Loss: 0.734 Vali Loss: 1.420 Vali Acc: 0.525 Test Loss: 1.420 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1113174
	speed: 0.5137s/iter; left time: 18334.6219s
	iters: 200, epoch: 4 | loss: 0.5368375
	speed: 0.1275s/iter; left time: 4537.2845s
	iters: 300, epoch: 4 | loss: 0.6329418
	speed: 0.1404s/iter; left time: 4984.9920s
Epoch: 4 cost time: 55.58903193473816
Epoch: 4, Steps: 369 | Train Loss: 0.631 Vali Loss: 0.677 Vali Acc: 0.663 Test Loss: 0.677 Test Acc: 0.663
Validation loss decreased (-0.624851 --> -0.663444).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6510071
	speed: 0.4867s/iter; left time: 17193.5418s
	iters: 200, epoch: 5 | loss: 0.3991313
	speed: 0.1272s/iter; left time: 4481.6654s
	iters: 300, epoch: 5 | loss: 0.3520607
	speed: 0.1467s/iter; left time: 5151.5583s
Epoch: 5 cost time: 48.92341375350952
Epoch: 5, Steps: 369 | Train Loss: 0.545 Vali Loss: 0.630 Vali Acc: 0.663 Test Loss: 0.630 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8772675
	speed: 0.4334s/iter; left time: 15151.0561s
	iters: 200, epoch: 6 | loss: 0.3632782
	speed: 0.1487s/iter; left time: 5184.7803s
	iters: 300, epoch: 6 | loss: 0.3080674
	speed: 0.1527s/iter; left time: 5307.3584s
Epoch: 6 cost time: 53.03811454772949
Epoch: 6, Steps: 369 | Train Loss: 0.462 Vali Loss: 0.710 Vali Acc: 0.675 Test Loss: 0.710 Test Acc: 0.675
Validation loss decreased (-0.663444 --> -0.675362).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4160742
	speed: 0.4770s/iter; left time: 16498.0618s
	iters: 200, epoch: 7 | loss: 0.2187141
	speed: 0.1345s/iter; left time: 4637.0370s
	iters: 300, epoch: 7 | loss: 0.1493438
	speed: 0.1415s/iter; left time: 4866.1024s
Epoch: 7 cost time: 50.295185804367065
Epoch: 7, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.681 Vali Acc: 0.667 Test Loss: 0.681 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4029522
	speed: 0.4732s/iter; left time: 16191.5552s
	iters: 200, epoch: 8 | loss: 0.6940441
	speed: 0.1476s/iter; left time: 5036.7572s
	iters: 300, epoch: 8 | loss: 0.5877355
	speed: 0.1187s/iter; left time: 4036.2724s
Epoch: 8 cost time: 45.99291944503784
Epoch: 8, Steps: 369 | Train Loss: 0.382 Vali Loss: 0.747 Vali Acc: 0.661 Test Loss: 0.747 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2765626
	speed: 0.3946s/iter; left time: 13356.5734s
	iters: 200, epoch: 9 | loss: 0.8203505
	speed: 0.1175s/iter; left time: 3966.6778s
	iters: 300, epoch: 9 | loss: 0.3050805
	speed: 0.1561s/iter; left time: 5253.5142s
Epoch: 9 cost time: 53.49428582191467
Epoch: 9, Steps: 369 | Train Loss: 0.380 Vali Loss: 0.847 Vali Acc: 0.653 Test Loss: 0.847 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1930318
	speed: 0.5121s/iter; left time: 17146.4740s
	iters: 200, epoch: 10 | loss: 0.4532427
	speed: 0.1563s/iter; left time: 5216.7865s
	iters: 300, epoch: 10 | loss: 0.4604504
	speed: 0.1309s/iter; left time: 4356.0395s
Epoch: 10 cost time: 54.30793356895447
Epoch: 10, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.775 Vali Acc: 0.654 Test Loss: 0.775 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.6283231
	speed: 0.4981s/iter; left time: 16491.2072s
	iters: 200, epoch: 11 | loss: 0.1630103
	speed: 0.1374s/iter; left time: 4535.3771s
	iters: 300, epoch: 11 | loss: 0.6037046
	speed: 0.1367s/iter; left time: 4497.9600s
Epoch: 11 cost time: 49.49826669692993
Epoch: 11, Steps: 369 | Train Loss: 0.361 Vali Loss: 0.796 Vali Acc: 0.646 Test Loss: 0.796 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2021312
	speed: 0.4789s/iter; left time: 15679.3465s
	iters: 200, epoch: 12 | loss: 0.2548939
	speed: 0.1330s/iter; left time: 4341.7782s
	iters: 300, epoch: 12 | loss: 0.6004097
	speed: 0.1372s/iter; left time: 4464.0237s
Epoch: 12 cost time: 52.806926012039185
Epoch: 12, Steps: 369 | Train Loss: 0.346 Vali Loss: 0.818 Vali Acc: 0.643 Test Loss: 0.818 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1038475
	speed: 0.4834s/iter; left time: 15647.7548s
	iters: 200, epoch: 13 | loss: 0.1620500
	speed: 0.1410s/iter; left time: 4552.0878s
	iters: 300, epoch: 13 | loss: 0.2374591
	speed: 0.1433s/iter; left time: 4608.7879s
Epoch: 13 cost time: 51.91693949699402
Epoch: 13, Steps: 369 | Train Loss: 0.330 Vali Loss: 0.979 Vali Acc: 0.663 Test Loss: 0.979 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.4292273
	speed: 0.4902s/iter; left time: 15687.4682s
	iters: 200, epoch: 14 | loss: 0.3646945
	speed: 0.1179s/iter; left time: 3762.3930s
	iters: 300, epoch: 14 | loss: 0.4665918
	speed: 0.1519s/iter; left time: 4829.8155s
Epoch: 14 cost time: 50.11190962791443
Epoch: 14, Steps: 369 | Train Loss: 0.328 Vali Loss: 1.021 Vali Acc: 0.626 Test Loss: 1.021 Test Acc: 0.626
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.5777085
	speed: 0.4620s/iter; left time: 14615.2171s
	iters: 200, epoch: 15 | loss: 0.3106416
	speed: 0.1543s/iter; left time: 4864.7936s
	iters: 300, epoch: 15 | loss: 0.5466221
	speed: 0.1219s/iter; left time: 3832.8478s
Epoch: 15 cost time: 52.6972873210907
Epoch: 15, Steps: 369 | Train Loss: 0.313 Vali Loss: 0.946 Vali Acc: 0.637 Test Loss: 0.946 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2248109
	speed: 0.5198s/iter; left time: 16250.5175s
	iters: 200, epoch: 16 | loss: 0.3719749
	speed: 0.1383s/iter; left time: 4310.0610s
	iters: 300, epoch: 16 | loss: 0.3795390
	speed: 0.1494s/iter; left time: 4640.1524s
Epoch: 16 cost time: 54.16467070579529
Epoch: 16, Steps: 369 | Train Loss: 0.324 Vali Loss: 0.984 Vali Acc: 0.636 Test Loss: 0.984 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6753688989784336
model parameter : 1725990
model size : 9.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3375651
	speed: 0.1720s/iter; left time: 6331.3375s
	iters: 200, epoch: 1 | loss: 0.7329552
	speed: 0.1096s/iter; left time: 4022.8180s
	iters: 300, epoch: 1 | loss: 0.5751854
	speed: 0.0933s/iter; left time: 3413.6591s
Epoch: 1 cost time: 42.505210161209106
Epoch: 1, Steps: 369 | Train Loss: 1.280 Vali Loss: 2.196 Vali Acc: 0.501 Test Loss: 2.196 Test Acc: 0.501
Validation loss decreased (inf --> -0.500829).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8594716
	speed: 0.4064s/iter; left time: 14805.2158s
	iters: 200, epoch: 2 | loss: 0.8406121
	speed: 0.1333s/iter; left time: 4844.6149s
	iters: 300, epoch: 2 | loss: 1.1927623
	speed: 0.1477s/iter; left time: 5350.2261s
Epoch: 2 cost time: 51.54094672203064
Epoch: 2, Steps: 369 | Train Loss: 0.893 Vali Loss: 0.780 Vali Acc: 0.634 Test Loss: 0.780 Test Acc: 0.634
Validation loss decreased (-0.500829 --> -0.634215).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7530088
	speed: 0.4630s/iter; left time: 16696.4714s
	iters: 200, epoch: 3 | loss: 1.4669225
	speed: 0.1383s/iter; left time: 4973.1190s
	iters: 300, epoch: 3 | loss: 0.5729499
	speed: 0.1272s/iter; left time: 4563.4546s
Epoch: 3 cost time: 51.684709310531616
Epoch: 3, Steps: 369 | Train Loss: 0.795 Vali Loss: 0.820 Vali Acc: 0.619 Test Loss: 0.820 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7877463
	speed: 0.5111s/iter; left time: 18244.3314s
	iters: 200, epoch: 4 | loss: 0.5582301
	speed: 0.1332s/iter; left time: 4740.9549s
	iters: 300, epoch: 4 | loss: 0.4246563
	speed: 0.1371s/iter; left time: 4864.4820s
Epoch: 4 cost time: 53.066962242126465
Epoch: 4, Steps: 369 | Train Loss: 0.651 Vali Loss: 0.618 Vali Acc: 0.679 Test Loss: 0.618 Test Acc: 0.679
Validation loss decreased (-0.634215 --> -0.678768).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6539880
	speed: 0.4876s/iter; left time: 17224.6131s
	iters: 200, epoch: 5 | loss: 0.5382715
	speed: 0.1214s/iter; left time: 4277.1286s
	iters: 300, epoch: 5 | loss: 0.3088622
	speed: 0.1527s/iter; left time: 5365.1509s
Epoch: 5 cost time: 51.47722411155701
Epoch: 5, Steps: 369 | Train Loss: 0.547 Vali Loss: 0.802 Vali Acc: 0.663 Test Loss: 0.802 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7111687
	speed: 0.4833s/iter; left time: 16893.3402s
	iters: 200, epoch: 6 | loss: 0.3905716
	speed: 0.1647s/iter; left time: 5739.9935s
	iters: 300, epoch: 6 | loss: 0.6057349
	speed: 0.1520s/iter; left time: 5281.8141s
Epoch: 6 cost time: 57.87886905670166
Epoch: 6, Steps: 369 | Train Loss: 0.500 Vali Loss: 0.640 Vali Acc: 0.683 Test Loss: 0.640 Test Acc: 0.683
Validation loss decreased (-0.678768 --> -0.683024).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4117749
	speed: 0.5123s/iter; left time: 17720.1395s
	iters: 200, epoch: 7 | loss: 0.4917447
	speed: 0.1322s/iter; left time: 4558.2233s
	iters: 300, epoch: 7 | loss: 0.5673245
	speed: 0.1554s/iter; left time: 5344.6913s
Epoch: 7 cost time: 52.071725845336914
Epoch: 7, Steps: 369 | Train Loss: 0.494 Vali Loss: 0.649 Vali Acc: 0.680 Test Loss: 0.649 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4888464
	speed: 0.4902s/iter; left time: 16774.2349s
	iters: 200, epoch: 8 | loss: 0.3345310
	speed: 0.1485s/iter; left time: 5065.9741s
	iters: 300, epoch: 8 | loss: 0.4253078
	speed: 0.1457s/iter; left time: 4955.6863s
Epoch: 8 cost time: 55.726155519485474
Epoch: 8, Steps: 369 | Train Loss: 0.462 Vali Loss: 0.740 Vali Acc: 0.649 Test Loss: 0.740 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2989530
	speed: 0.4822s/iter; left time: 16322.6715s
	iters: 200, epoch: 9 | loss: 0.5348690
	speed: 0.1413s/iter; left time: 4769.9740s
	iters: 300, epoch: 9 | loss: 0.5175297
	speed: 0.1316s/iter; left time: 4428.7907s
Epoch: 9 cost time: 51.38194012641907
Epoch: 9, Steps: 369 | Train Loss: 0.448 Vali Loss: 0.819 Vali Acc: 0.655 Test Loss: 0.819 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1759765
	speed: 0.5019s/iter; left time: 16805.0586s
	iters: 200, epoch: 10 | loss: 0.1620466
	speed: 0.1432s/iter; left time: 4778.4475s
	iters: 300, epoch: 10 | loss: 0.4880654
	speed: 0.1430s/iter; left time: 4760.5917s
Epoch: 10 cost time: 53.142544746398926
Epoch: 10, Steps: 369 | Train Loss: 0.406 Vali Loss: 0.885 Vali Acc: 0.624 Test Loss: 0.885 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2762921
	speed: 0.4701s/iter; left time: 15566.2401s
	iters: 200, epoch: 11 | loss: 0.4786780
	speed: 0.0792s/iter; left time: 2615.2580s
	iters: 300, epoch: 11 | loss: 0.2195231
	speed: 0.0713s/iter; left time: 2344.9269s
Epoch: 11 cost time: 33.89796304702759
Epoch: 11, Steps: 369 | Train Loss: 0.391 Vali Loss: 0.831 Vali Acc: 0.672 Test Loss: 0.831 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1878764
	speed: 0.4532s/iter; left time: 14839.9442s
	iters: 200, epoch: 12 | loss: 0.4773621
	speed: 0.1344s/iter; left time: 4387.1423s
	iters: 300, epoch: 12 | loss: 0.3784885
	speed: 0.1449s/iter; left time: 4714.2618s
Epoch: 12 cost time: 55.35823035240173
Epoch: 12, Steps: 369 | Train Loss: 0.381 Vali Loss: 0.723 Vali Acc: 0.669 Test Loss: 0.723 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2819043
	speed: 0.5361s/iter; left time: 17356.3425s
	iters: 200, epoch: 13 | loss: 0.4112459
	speed: 0.1627s/iter; left time: 5250.3104s
	iters: 300, epoch: 13 | loss: 0.7649211
	speed: 0.1402s/iter; left time: 4510.1138s
Epoch: 13 cost time: 55.1590142250061
Epoch: 13, Steps: 369 | Train Loss: 0.386 Vali Loss: 0.791 Vali Acc: 0.665 Test Loss: 0.791 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2100525
	speed: 0.5149s/iter; left time: 16480.2146s
	iters: 200, epoch: 14 | loss: 0.2516578
	speed: 0.1266s/iter; left time: 4039.4815s
	iters: 300, epoch: 14 | loss: 0.5074295
	speed: 0.1481s/iter; left time: 4710.5116s
Epoch: 14 cost time: 54.49080991744995
Epoch: 14, Steps: 369 | Train Loss: 0.385 Vali Loss: 0.729 Vali Acc: 0.640 Test Loss: 0.729 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.4668212
	speed: 0.4830s/iter; left time: 15279.5384s
	iters: 200, epoch: 15 | loss: 0.5072178
	speed: 0.1619s/iter; left time: 5106.3278s
	iters: 300, epoch: 15 | loss: 0.1987302
	speed: 0.1177s/iter; left time: 3701.1574s
Epoch: 15 cost time: 53.068620920181274
Epoch: 15, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.793 Vali Acc: 0.643 Test Loss: 0.793 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2475554
	speed: 0.4791s/iter; left time: 14980.2307s
	iters: 200, epoch: 16 | loss: 0.2608023
	speed: 0.1218s/iter; left time: 3795.2162s
	iters: 300, epoch: 16 | loss: 0.4572459
	speed: 0.1534s/iter; left time: 4765.8938s
Epoch: 16 cost time: 50.91013503074646
Epoch: 16, Steps: 369 | Train Loss: 0.373 Vali Loss: 0.724 Vali Acc: 0.644 Test Loss: 0.724 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6830306469920545
model parameter : 1724838
model size : 9.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6258780
	speed: 0.1659s/iter; left time: 6105.7060s
	iters: 200, epoch: 1 | loss: 0.7358400
	speed: 0.1468s/iter; left time: 5389.4668s
	iters: 300, epoch: 1 | loss: 2.8898969
	speed: 0.1308s/iter; left time: 4789.1646s
Epoch: 1 cost time: 53.22536253929138
Epoch: 1, Steps: 369 | Train Loss: 1.284 Vali Loss: 0.943 Vali Acc: 0.642 Test Loss: 0.943 Test Acc: 0.642
Validation loss decreased (inf --> -0.642159).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8125261
	speed: 0.4849s/iter; left time: 17666.0035s
	iters: 200, epoch: 2 | loss: 0.6833832
	speed: 0.1325s/iter; left time: 4813.5910s
	iters: 300, epoch: 2 | loss: 0.5068208
	speed: 0.1562s/iter; left time: 5658.7431s
Epoch: 2 cost time: 56.586899518966675
Epoch: 2, Steps: 369 | Train Loss: 0.816 Vali Loss: 1.198 Vali Acc: 0.607 Test Loss: 1.198 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0456780
	speed: 0.5113s/iter; left time: 18440.5171s
	iters: 200, epoch: 3 | loss: 0.5140225
	speed: 0.1675s/iter; left time: 6024.7698s
	iters: 300, epoch: 3 | loss: 1.1025308
	speed: 0.1468s/iter; left time: 5263.6226s
Epoch: 3 cost time: 56.125279903411865
Epoch: 3, Steps: 369 | Train Loss: 0.728 Vali Loss: 1.509 Vali Acc: 0.513 Test Loss: 1.509 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.3374381
	speed: 0.4970s/iter; left time: 17740.3566s
	iters: 200, epoch: 4 | loss: 1.7486713
	speed: 0.1357s/iter; left time: 4830.7623s
	iters: 300, epoch: 4 | loss: 0.6887311
	speed: 0.1341s/iter; left time: 4758.0909s
Epoch: 4 cost time: 51.40006184577942
Epoch: 4, Steps: 369 | Train Loss: 0.691 Vali Loss: 0.683 Vali Acc: 0.639 Test Loss: 0.683 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.5582985
	speed: 0.4729s/iter; left time: 16706.6148s
	iters: 200, epoch: 5 | loss: 0.6930341
	speed: 0.1495s/iter; left time: 5265.2125s
	iters: 300, epoch: 5 | loss: 0.3655232
	speed: 0.1474s/iter; left time: 5176.1348s
Epoch: 5 cost time: 55.40416145324707
Epoch: 5, Steps: 369 | Train Loss: 0.583 Vali Loss: 0.619 Vali Acc: 0.672 Test Loss: 0.619 Test Acc: 0.672
Validation loss decreased (-0.642159 --> -0.672241).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6133083
	speed: 0.4892s/iter; left time: 17100.4766s
	iters: 200, epoch: 6 | loss: 0.3190466
	speed: 0.1404s/iter; left time: 4894.9000s
	iters: 300, epoch: 6 | loss: 0.8044248
	speed: 0.1456s/iter; left time: 5061.0354s
Epoch: 6 cost time: 51.47635245323181
Epoch: 6, Steps: 369 | Train Loss: 0.488 Vali Loss: 0.728 Vali Acc: 0.622 Test Loss: 0.728 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1681134
	speed: 0.4849s/iter; left time: 16771.1516s
	iters: 200, epoch: 7 | loss: 0.4422070
	speed: 0.1364s/iter; left time: 4705.2814s
	iters: 300, epoch: 7 | loss: 0.6027074
	speed: 0.1307s/iter; left time: 4493.3770s
Epoch: 7 cost time: 53.18870449066162
Epoch: 7, Steps: 369 | Train Loss: 0.453 Vali Loss: 0.721 Vali Acc: 0.662 Test Loss: 0.721 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3964655
	speed: 0.4754s/iter; left time: 16268.4675s
	iters: 200, epoch: 8 | loss: 0.6287029
	speed: 0.1384s/iter; left time: 4722.4594s
	iters: 300, epoch: 8 | loss: 0.2748944
	speed: 0.1628s/iter; left time: 5539.7476s
Epoch: 8 cost time: 54.02822971343994
Epoch: 8, Steps: 369 | Train Loss: 0.418 Vali Loss: 0.668 Vali Acc: 0.673 Test Loss: 0.668 Test Acc: 0.673
Validation loss decreased (-0.672241 --> -0.672808).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6013175
	speed: 0.5065s/iter; left time: 17145.3657s
	iters: 200, epoch: 9 | loss: 0.3331877
	speed: 0.1401s/iter; left time: 4728.2804s
	iters: 300, epoch: 9 | loss: 0.4115372
	speed: 0.1471s/iter; left time: 4949.0990s
Epoch: 9 cost time: 56.257488489151
Epoch: 9, Steps: 369 | Train Loss: 0.382 Vali Loss: 0.728 Vali Acc: 0.665 Test Loss: 0.728 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.4721485
	speed: 0.5372s/iter; left time: 17987.1031s
	iters: 200, epoch: 10 | loss: 0.2057436
	speed: 0.1585s/iter; left time: 5291.2806s
	iters: 300, epoch: 10 | loss: 0.5652716
	speed: 0.1551s/iter; left time: 5162.7539s
Epoch: 10 cost time: 58.74381709098816
Epoch: 10, Steps: 369 | Train Loss: 0.388 Vali Loss: 0.811 Vali Acc: 0.663 Test Loss: 0.811 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0909961
	speed: 0.4818s/iter; left time: 15954.4593s
	iters: 200, epoch: 11 | loss: 0.1634901
	speed: 0.1307s/iter; left time: 4313.7417s
	iters: 300, epoch: 11 | loss: 0.2468150
	speed: 0.1294s/iter; left time: 4257.3635s
Epoch: 11 cost time: 49.587008237838745
Epoch: 11, Steps: 369 | Train Loss: 0.348 Vali Loss: 0.896 Vali Acc: 0.650 Test Loss: 0.896 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2823511
	speed: 0.4380s/iter; left time: 14339.7890s
	iters: 200, epoch: 12 | loss: 0.6984722
	speed: 0.0802s/iter; left time: 2619.1821s
	iters: 300, epoch: 12 | loss: 0.5153206
	speed: 0.0792s/iter; left time: 2577.6377s
Epoch: 12 cost time: 30.958019971847534
Epoch: 12, Steps: 369 | Train Loss: 0.365 Vali Loss: 0.936 Vali Acc: 0.640 Test Loss: 0.936 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1358709
	speed: 0.4011s/iter; left time: 12985.8778s
	iters: 200, epoch: 13 | loss: 0.3633811
	speed: 0.1526s/iter; left time: 4925.9253s
	iters: 300, epoch: 13 | loss: 0.5528344
	speed: 0.1277s/iter; left time: 4107.9820s
Epoch: 13 cost time: 51.459789991378784
Epoch: 13, Steps: 369 | Train Loss: 0.359 Vali Loss: 0.788 Vali Acc: 0.659 Test Loss: 0.788 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.5207847
	speed: 0.4820s/iter; left time: 15425.6497s
	iters: 200, epoch: 14 | loss: 0.5146977
	speed: 0.1284s/iter; left time: 4095.5543s
	iters: 300, epoch: 14 | loss: 0.1636203
	speed: 0.1329s/iter; left time: 4226.1163s
Epoch: 14 cost time: 48.908576011657715
Epoch: 14, Steps: 369 | Train Loss: 0.315 Vali Loss: 1.008 Vali Acc: 0.659 Test Loss: 1.008 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1818168
	speed: 0.4744s/iter; left time: 15006.4797s
	iters: 200, epoch: 15 | loss: 0.2429621
	speed: 0.1443s/iter; left time: 4549.4490s
	iters: 300, epoch: 15 | loss: 0.0799846
	speed: 0.1591s/iter; left time: 5001.4295s
Epoch: 15 cost time: 56.55203604698181
Epoch: 15, Steps: 369 | Train Loss: 0.317 Vali Loss: 0.878 Vali Acc: 0.656 Test Loss: 0.878 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.3244790
	speed: 0.4851s/iter; left time: 15166.7452s
	iters: 200, epoch: 16 | loss: 0.3280166
	speed: 0.1529s/iter; left time: 4764.2965s
	iters: 300, epoch: 16 | loss: 0.5571000
	speed: 0.1304s/iter; left time: 4050.0947s
Epoch: 16 cost time: 50.451603174209595
Epoch: 16, Steps: 369 | Train Loss: 0.359 Vali Loss: 0.849 Vali Acc: 0.655 Test Loss: 0.849 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.4900850
	speed: 0.5227s/iter; left time: 16150.4951s
	iters: 200, epoch: 17 | loss: 0.6978006
	speed: 0.1302s/iter; left time: 4009.9275s
	iters: 300, epoch: 17 | loss: 0.2268476
	speed: 0.1384s/iter; left time: 4247.7528s
Epoch: 17 cost time: 54.22877836227417
Epoch: 17, Steps: 369 | Train Loss: 0.366 Vali Loss: 0.878 Vali Acc: 0.663 Test Loss: 0.878 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.5586025
	speed: 0.4493s/iter; left time: 13716.6961s
	iters: 200, epoch: 18 | loss: 0.2487230
	speed: 0.1373s/iter; left time: 4178.5869s
	iters: 300, epoch: 18 | loss: 0.3360562
	speed: 0.1230s/iter; left time: 3731.3998s
Epoch: 18 cost time: 49.843770265579224
Epoch: 18, Steps: 369 | Train Loss: 0.354 Vali Loss: 0.967 Vali Acc: 0.661 Test Loss: 0.967 Test Acc: 0.661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6728149829738933
model parameter : 1723686
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7352211
	speed: 0.1588s/iter; left time: 5843.0290s
	iters: 200, epoch: 1 | loss: 0.4849156
	speed: 0.1159s/iter; left time: 4252.0479s
	iters: 300, epoch: 1 | loss: 1.8608707
	speed: 0.1601s/iter; left time: 5861.3629s
Epoch: 1 cost time: 51.88036060333252
Epoch: 1, Steps: 369 | Train Loss: 1.278 Vali Loss: 2.547 Vali Acc: 0.508 Test Loss: 2.547 Test Acc: 0.508
Validation loss decreased (inf --> -0.507920).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6350403
	speed: 0.4778s/iter; left time: 17406.4307s
	iters: 200, epoch: 2 | loss: 1.0162666
	speed: 0.1684s/iter; left time: 6117.2218s
	iters: 300, epoch: 2 | loss: 0.4452986
	speed: 0.1304s/iter; left time: 4725.5756s
Epoch: 2 cost time: 55.079238176345825
Epoch: 2, Steps: 369 | Train Loss: 0.890 Vali Loss: 1.084 Vali Acc: 0.569 Test Loss: 1.084 Test Acc: 0.569
Validation loss decreased (-0.507920 --> -0.568661).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3809734
	speed: 0.4992s/iter; left time: 18003.8093s
	iters: 200, epoch: 3 | loss: 0.3790058
	speed: 0.1177s/iter; left time: 4231.7587s
	iters: 300, epoch: 3 | loss: 0.5761364
	speed: 0.1275s/iter; left time: 4573.9723s
Epoch: 3 cost time: 48.411617040634155
Epoch: 3, Steps: 369 | Train Loss: 0.736 Vali Loss: 0.693 Vali Acc: 0.666 Test Loss: 0.693 Test Acc: 0.666
Validation loss decreased (-0.568661 --> -0.666281).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6307645
	speed: 0.4878s/iter; left time: 17412.1352s
	iters: 200, epoch: 4 | loss: 1.1344578
	speed: 0.1216s/iter; left time: 4329.0785s
	iters: 300, epoch: 4 | loss: 0.2973131
	speed: 0.1447s/iter; left time: 5134.2469s
Epoch: 4 cost time: 50.89826226234436
Epoch: 4, Steps: 369 | Train Loss: 0.641 Vali Loss: 0.664 Vali Acc: 0.649 Test Loss: 0.664 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7743287
	speed: 0.4239s/iter; left time: 14975.5314s
	iters: 200, epoch: 5 | loss: 0.3678237
	speed: 0.1272s/iter; left time: 4480.0104s
	iters: 300, epoch: 5 | loss: 0.4044186
	speed: 0.1269s/iter; left time: 4458.7399s
Epoch: 5 cost time: 46.20820593833923
Epoch: 5, Steps: 369 | Train Loss: 0.546 Vali Loss: 0.643 Vali Acc: 0.682 Test Loss: 0.643 Test Acc: 0.682
Validation loss decreased (-0.666281 --> -0.681605).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3519839
	speed: 0.4926s/iter; left time: 17218.6295s
	iters: 200, epoch: 6 | loss: 0.4090160
	speed: 0.1337s/iter; left time: 4661.2697s
	iters: 300, epoch: 6 | loss: 0.3980468
	speed: 0.1574s/iter; left time: 5471.5702s
Epoch: 6 cost time: 55.61229157447815
Epoch: 6, Steps: 369 | Train Loss: 0.470 Vali Loss: 0.735 Vali Acc: 0.671 Test Loss: 0.735 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5227605
	speed: 0.5110s/iter; left time: 17674.0175s
	iters: 200, epoch: 7 | loss: 0.4806767
	speed: 0.1592s/iter; left time: 5491.2376s
	iters: 300, epoch: 7 | loss: 0.5515050
	speed: 0.1196s/iter; left time: 4113.3330s
Epoch: 7 cost time: 50.90951752662659
Epoch: 7, Steps: 369 | Train Loss: 0.438 Vali Loss: 0.783 Vali Acc: 0.648 Test Loss: 0.783 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3054846
	speed: 0.3321s/iter; left time: 11364.8294s
	iters: 200, epoch: 8 | loss: 0.2156091
	speed: 0.1310s/iter; left time: 4469.2174s
	iters: 300, epoch: 8 | loss: 0.4526888
	speed: 0.1609s/iter; left time: 5472.4903s
Epoch: 8 cost time: 47.3745698928833
Epoch: 8, Steps: 369 | Train Loss: 0.399 Vali Loss: 0.665 Vali Acc: 0.654 Test Loss: 0.665 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2975256
	speed: 0.5271s/iter; left time: 17841.2918s
	iters: 200, epoch: 9 | loss: 0.6175573
	speed: 0.1579s/iter; left time: 5330.1076s
	iters: 300, epoch: 9 | loss: 0.3502745
	speed: 0.1682s/iter; left time: 5661.0192s
Epoch: 9 cost time: 59.356908559799194
Epoch: 9, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.768 Vali Acc: 0.668 Test Loss: 0.768 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4578484
	speed: 0.4865s/iter; left time: 16286.5411s
	iters: 200, epoch: 10 | loss: 0.3951431
	speed: 0.1363s/iter; left time: 4549.7037s
	iters: 300, epoch: 10 | loss: 0.4397940
	speed: 0.1422s/iter; left time: 4732.0759s
Epoch: 10 cost time: 53.94693565368652
Epoch: 10, Steps: 369 | Train Loss: 0.358 Vali Loss: 0.825 Vali Acc: 0.653 Test Loss: 0.825 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.5500811
	speed: 0.5074s/iter; left time: 16800.5152s
	iters: 200, epoch: 11 | loss: 0.3497629
	speed: 0.1407s/iter; left time: 4643.5264s
	iters: 300, epoch: 11 | loss: 0.2839213
	speed: 0.1483s/iter; left time: 4881.5980s
Epoch: 11 cost time: 53.54955530166626
Epoch: 11, Steps: 369 | Train Loss: 0.349 Vali Loss: 0.786 Vali Acc: 0.657 Test Loss: 0.786 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3497137
	speed: 0.4901s/iter; left time: 16045.5635s
	iters: 200, epoch: 12 | loss: 0.4036182
	speed: 0.1386s/iter; left time: 4523.2623s
	iters: 300, epoch: 12 | loss: 1.1068015
	speed: 0.1542s/iter; left time: 5019.2146s
Epoch: 12 cost time: 54.54324269294739
Epoch: 12, Steps: 369 | Train Loss: 0.328 Vali Loss: 0.827 Vali Acc: 0.662 Test Loss: 0.827 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1221388
	speed: 0.4771s/iter; left time: 15444.4670s
	iters: 200, epoch: 13 | loss: 0.3123817
	speed: 0.1489s/iter; left time: 4805.1624s
	iters: 300, epoch: 13 | loss: 0.2148348
	speed: 0.1347s/iter; left time: 4333.4716s
Epoch: 13 cost time: 51.87997341156006
Epoch: 13, Steps: 369 | Train Loss: 0.322 Vali Loss: 0.888 Vali Acc: 0.636 Test Loss: 0.888 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.3393664
	speed: 0.4946s/iter; left time: 15829.4582s
	iters: 200, epoch: 14 | loss: 0.3520177
	speed: 0.1171s/iter; left time: 3736.0803s
	iters: 300, epoch: 14 | loss: 0.0681793
	speed: 0.1383s/iter; left time: 4398.3392s
Epoch: 14 cost time: 50.212655782699585
Epoch: 14, Steps: 369 | Train Loss: 0.297 Vali Loss: 0.991 Vali Acc: 0.657 Test Loss: 0.991 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1962282
	speed: 0.5073s/iter; left time: 16049.9735s
	iters: 200, epoch: 15 | loss: 0.3276379
	speed: 0.1412s/iter; left time: 4453.6456s
	iters: 300, epoch: 15 | loss: 0.1890438
	speed: 0.1635s/iter; left time: 5139.8671s
Epoch: 15 cost time: 57.83057761192322
Epoch: 15, Steps: 369 | Train Loss: 0.298 Vali Loss: 0.908 Vali Acc: 0.667 Test Loss: 0.908 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6816118047673099
model parameter : 1722534
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7391595
	speed: 0.1661s/iter; left time: 6111.5407s
	iters: 200, epoch: 1 | loss: 0.8841102
	speed: 0.1386s/iter; left time: 5087.2935s
	iters: 300, epoch: 1 | loss: 0.8210532
	speed: 0.1512s/iter; left time: 5533.1678s
Epoch: 1 cost time: 54.30458116531372
Epoch: 1, Steps: 369 | Train Loss: 0.845 Vali Loss: 0.638 Vali Acc: 0.652 Test Loss: 0.638 Test Acc: 0.652
Validation loss decreased (inf --> -0.652377).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4741044
	speed: 0.4876s/iter; left time: 17763.5675s
	iters: 200, epoch: 2 | loss: 0.7216672
	speed: 0.1549s/iter; left time: 5627.1514s
	iters: 300, epoch: 2 | loss: 0.8358096
	speed: 0.1248s/iter; left time: 4522.8486s
Epoch: 2 cost time: 49.98530983924866
Epoch: 2, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.746 Vali Acc: 0.664 Test Loss: 0.746 Test Acc: 0.664
Validation loss decreased (-0.652377 --> -0.664294).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1576489
	speed: 0.3435s/iter; left time: 12387.5031s
	iters: 200, epoch: 3 | loss: 1.0321398
	speed: 0.0821s/iter; left time: 2953.1412s
	iters: 300, epoch: 3 | loss: 0.8820183
	speed: 0.0937s/iter; left time: 3360.5521s
Epoch: 3 cost time: 37.78473496437073
Epoch: 3, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.704 Vali Acc: 0.584 Test Loss: 0.704 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4303528
	speed: 0.5421s/iter; left time: 19351.0018s
	iters: 200, epoch: 4 | loss: 0.5765529
	speed: 0.1581s/iter; left time: 5629.1731s
	iters: 300, epoch: 4 | loss: 0.4678821
	speed: 0.1468s/iter; left time: 5210.9768s
Epoch: 4 cost time: 57.6913902759552
Epoch: 4, Steps: 369 | Train Loss: 0.631 Vali Loss: 0.685 Vali Acc: 0.624 Test Loss: 0.685 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2367001
	speed: 0.5231s/iter; left time: 18477.3883s
	iters: 200, epoch: 5 | loss: 0.4607039
	speed: 0.1248s/iter; left time: 4396.1276s
	iters: 300, epoch: 5 | loss: 0.6452194
	speed: 0.1491s/iter; left time: 5237.6390s
Epoch: 5 cost time: 49.86579918861389
Epoch: 5, Steps: 369 | Train Loss: 0.524 Vali Loss: 0.634 Vali Acc: 0.663 Test Loss: 0.634 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1891879
	speed: 0.4540s/iter; left time: 15869.7215s
	iters: 200, epoch: 6 | loss: 0.4263651
	speed: 0.1455s/iter; left time: 5072.8029s
	iters: 300, epoch: 6 | loss: 0.3216840
	speed: 0.1338s/iter; left time: 4651.5406s
Epoch: 6 cost time: 54.73268246650696
Epoch: 6, Steps: 369 | Train Loss: 0.473 Vali Loss: 0.642 Vali Acc: 0.669 Test Loss: 0.642 Test Acc: 0.669
Validation loss decreased (-0.664294 --> -0.668552).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3106593
	speed: 0.4898s/iter; left time: 16939.0491s
	iters: 200, epoch: 7 | loss: 0.4281000
	speed: 0.1445s/iter; left time: 4982.2038s
	iters: 300, epoch: 7 | loss: 0.5328308
	speed: 0.1277s/iter; left time: 4390.5602s
Epoch: 7 cost time: 50.80831551551819
Epoch: 7, Steps: 369 | Train Loss: 0.428 Vali Loss: 0.641 Vali Acc: 0.684 Test Loss: 0.641 Test Acc: 0.684
Validation loss decreased (-0.668552 --> -0.684159).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2630073
	speed: 0.4841s/iter; left time: 16563.6755s
	iters: 200, epoch: 8 | loss: 0.9444339
	speed: 0.1346s/iter; left time: 4591.2817s
	iters: 300, epoch: 8 | loss: 1.8540416
	speed: 0.1386s/iter; left time: 4715.2191s
Epoch: 8 cost time: 51.11566519737244
Epoch: 8, Steps: 369 | Train Loss: 0.836 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.9656268
	speed: 0.4945s/iter; left time: 16739.8693s
	iters: 200, epoch: 9 | loss: 1.6220568
	speed: 0.1310s/iter; left time: 4421.2620s
	iters: 300, epoch: 9 | loss: 0.6501504
	speed: 0.1553s/iter; left time: 5224.3349s
Epoch: 9 cost time: 54.90936875343323
Epoch: 9, Steps: 369 | Train Loss: 0.917 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.7643750
	speed: 0.5031s/iter; left time: 16842.4222s
	iters: 200, epoch: 10 | loss: 0.7723381
	speed: 0.1520s/iter; left time: 5073.1807s
	iters: 300, epoch: 10 | loss: 0.7000173
	speed: 0.1379s/iter; left time: 4588.5558s
Epoch: 10 cost time: 55.400084018707275
Epoch: 10, Steps: 369 | Train Loss: 0.735 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.8337465
	speed: 0.5367s/iter; left time: 17769.7180s
	iters: 200, epoch: 11 | loss: 0.7801724
	speed: 0.1373s/iter; left time: 4532.4712s
	iters: 300, epoch: 11 | loss: 0.7946674
	speed: 0.1290s/iter; left time: 4245.8884s
Epoch: 11 cost time: 51.95995259284973
Epoch: 11, Steps: 369 | Train Loss: 0.722 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.7807227
	speed: 0.4902s/iter; left time: 16048.5854s
	iters: 200, epoch: 12 | loss: 0.6770127
	speed: 0.1314s/iter; left time: 4290.6435s
	iters: 300, epoch: 12 | loss: 0.7123377
	speed: 0.1515s/iter; left time: 4930.6195s
Epoch: 12 cost time: 52.24091410636902
Epoch: 12, Steps: 369 | Train Loss: 0.719 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.7275409
	speed: 0.4822s/iter; left time: 15611.3595s
	iters: 200, epoch: 13 | loss: 0.6441709
	speed: 0.1370s/iter; left time: 4422.6194s
	iters: 300, epoch: 13 | loss: 0.7355756
	speed: 0.1384s/iter; left time: 4453.1958s
Epoch: 13 cost time: 53.59222459793091
Epoch: 13, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.7126997
	speed: 0.4669s/iter; left time: 14941.9665s
	iters: 200, epoch: 14 | loss: 0.7252921
	speed: 0.1489s/iter; left time: 4749.8767s
	iters: 300, epoch: 14 | loss: 0.7181376
	speed: 0.1463s/iter; left time: 4654.4770s
Epoch: 14 cost time: 51.508188009262085
Epoch: 14, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.6931165
	speed: 0.4169s/iter; left time: 13188.2034s
	iters: 200, epoch: 15 | loss: 0.7723991
	speed: 0.0757s/iter; left time: 2385.7949s
	iters: 300, epoch: 15 | loss: 0.7334414
	speed: 0.0703s/iter; left time: 2209.5916s
Epoch: 15 cost time: 29.25172710418701
Epoch: 15, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.7028127
	speed: 0.4311s/iter; left time: 13479.0854s
	iters: 200, epoch: 16 | loss: 0.6978461
	speed: 0.1498s/iter; left time: 4669.0372s
	iters: 300, epoch: 16 | loss: 0.7101045
	speed: 0.1513s/iter; left time: 4699.6892s
Epoch: 16 cost time: 56.84768605232239
Epoch: 16, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.6530690
	speed: 0.4795s/iter; left time: 14815.2270s
	iters: 200, epoch: 17 | loss: 0.7201760
	speed: 0.1291s/iter; left time: 3975.0168s
	iters: 300, epoch: 17 | loss: 0.6823334
	speed: 0.1469s/iter; left time: 4508.5184s
Epoch: 17 cost time: 48.53294086456299
Epoch: 17, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6841657207718501
model parameter : 1113574
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0453987
	speed: 0.1404s/iter; left time: 5165.6032s
	iters: 200, epoch: 1 | loss: 0.4722190
	speed: 0.1489s/iter; left time: 5466.0223s
	iters: 300, epoch: 1 | loss: 0.6305990
	speed: 0.1413s/iter; left time: 5172.6135s
Epoch: 1 cost time: 52.99370074272156
Epoch: 1, Steps: 369 | Train Loss: 0.948 Vali Loss: 1.690 Vali Acc: 0.549 Test Loss: 1.690 Test Acc: 0.549
Validation loss decreased (inf --> -0.548791).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2986004
	speed: 0.4762s/iter; left time: 17348.8385s
	iters: 200, epoch: 2 | loss: 0.4108268
	speed: 0.1200s/iter; left time: 4360.1119s
	iters: 300, epoch: 2 | loss: 0.5961050
	speed: 0.1424s/iter; left time: 5159.1872s
Epoch: 2 cost time: 49.4308123588562
Epoch: 2, Steps: 369 | Train Loss: 0.776 Vali Loss: 0.763 Vali Acc: 0.644 Test Loss: 0.763 Test Acc: 0.644
Validation loss decreased (-0.548791 --> -0.644147).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8092074
	speed: 0.4600s/iter; left time: 16589.8027s
	iters: 200, epoch: 3 | loss: 0.9902654
	speed: 0.1535s/iter; left time: 5519.3729s
	iters: 300, epoch: 3 | loss: 0.6461607
	speed: 0.1414s/iter; left time: 5069.3298s
Epoch: 3 cost time: 53.624454975128174
Epoch: 3, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.950 Vali Acc: 0.619 Test Loss: 0.950 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4893779
	speed: 0.4657s/iter; left time: 16623.4117s
	iters: 200, epoch: 4 | loss: 0.3588242
	speed: 0.1218s/iter; left time: 4333.7659s
	iters: 300, epoch: 4 | loss: 0.4153946
	speed: 0.1354s/iter; left time: 4806.8295s
Epoch: 4 cost time: 48.98792886734009
Epoch: 4, Steps: 369 | Train Loss: 0.590 Vali Loss: 0.657 Vali Acc: 0.651 Test Loss: 0.657 Test Acc: 0.651
Validation loss decreased (-0.644147 --> -0.651242).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7631705
	speed: 0.5001s/iter; left time: 17667.0970s
	iters: 200, epoch: 5 | loss: 0.5808271
	speed: 0.1466s/iter; left time: 5164.5462s
	iters: 300, epoch: 5 | loss: 0.4511525
	speed: 0.1544s/iter; left time: 5424.2905s
Epoch: 5 cost time: 55.315759897232056
Epoch: 5, Steps: 369 | Train Loss: 0.529 Vali Loss: 0.726 Vali Acc: 0.677 Test Loss: 0.726 Test Acc: 0.677
Validation loss decreased (-0.651242 --> -0.676780).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4356109
	speed: 0.4646s/iter; left time: 16241.1274s
	iters: 200, epoch: 6 | loss: 0.5333067
	speed: 0.1454s/iter; left time: 5068.7912s
	iters: 300, epoch: 6 | loss: 0.4593788
	speed: 0.1419s/iter; left time: 4930.8791s
Epoch: 6 cost time: 53.8901743888855
Epoch: 6, Steps: 369 | Train Loss: 0.487 Vali Loss: 0.662 Vali Acc: 0.675 Test Loss: 0.662 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6143387
	speed: 0.5080s/iter; left time: 17569.7459s
	iters: 200, epoch: 7 | loss: 0.2614970
	speed: 0.1314s/iter; left time: 4530.5764s
	iters: 300, epoch: 7 | loss: 0.3798468
	speed: 0.1427s/iter; left time: 4906.4898s
Epoch: 7 cost time: 50.11663603782654
Epoch: 7, Steps: 369 | Train Loss: 0.442 Vali Loss: 0.813 Vali Acc: 0.639 Test Loss: 0.813 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3707796
	speed: 0.4772s/iter; left time: 16329.4094s
	iters: 200, epoch: 8 | loss: 0.3928976
	speed: 0.1242s/iter; left time: 4237.2745s
	iters: 300, epoch: 8 | loss: 0.4012941
	speed: 0.1007s/iter; left time: 3426.5609s
Epoch: 8 cost time: 42.637725591659546
Epoch: 8, Steps: 369 | Train Loss: 0.403 Vali Loss: 0.734 Vali Acc: 0.663 Test Loss: 0.734 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2457761
	speed: 0.4015s/iter; left time: 13590.9999s
	iters: 200, epoch: 9 | loss: 0.2690378
	speed: 0.1294s/iter; left time: 4367.2749s
	iters: 300, epoch: 9 | loss: 0.5033798
	speed: 0.1275s/iter; left time: 4290.7521s
Epoch: 9 cost time: 49.42914032936096
Epoch: 9, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.819 Vali Acc: 0.650 Test Loss: 0.819 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2615028
	speed: 0.4876s/iter; left time: 16326.0625s
	iters: 200, epoch: 10 | loss: 0.2395647
	speed: 0.1380s/iter; left time: 4605.7191s
	iters: 300, epoch: 10 | loss: 0.3257550
	speed: 0.1311s/iter; left time: 4364.5111s
Epoch: 10 cost time: 51.24376845359802
Epoch: 10, Steps: 369 | Train Loss: 0.330 Vali Loss: 0.809 Vali Acc: 0.653 Test Loss: 0.809 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1507666
	speed: 0.4585s/iter; left time: 15181.0719s
	iters: 200, epoch: 11 | loss: 0.0678981
	speed: 0.1189s/iter; left time: 3925.2019s
	iters: 300, epoch: 11 | loss: 0.2414975
	speed: 0.1439s/iter; left time: 4734.5691s
Epoch: 11 cost time: 50.97671961784363
Epoch: 11, Steps: 369 | Train Loss: 0.269 Vali Loss: 0.963 Vali Acc: 0.652 Test Loss: 0.963 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0804947
	speed: 0.5059s/iter; left time: 16565.4332s
	iters: 200, epoch: 12 | loss: 0.0613718
	speed: 0.1418s/iter; left time: 4629.0833s
	iters: 300, epoch: 12 | loss: 0.0554593
	speed: 0.1292s/iter; left time: 4205.5819s
Epoch: 12 cost time: 52.803746461868286
Epoch: 12, Steps: 369 | Train Loss: 0.250 Vali Loss: 0.992 Vali Acc: 0.641 Test Loss: 0.992 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6171708
	speed: 0.4925s/iter; left time: 15943.6157s
	iters: 200, epoch: 13 | loss: 0.1364313
	speed: 0.1355s/iter; left time: 4373.7449s
	iters: 300, epoch: 13 | loss: 0.2975927
	speed: 0.1731s/iter; left time: 5568.1934s
Epoch: 13 cost time: 57.12871336936951
Epoch: 13, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.200 Vali Acc: 0.658 Test Loss: 1.200 Test Acc: 0.658
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.3263900
	speed: 0.5109s/iter; left time: 16352.0948s
	iters: 200, epoch: 14 | loss: 0.0841623
	speed: 0.0885s/iter; left time: 2823.4335s
	iters: 300, epoch: 14 | loss: 0.0977823
	speed: 0.1312s/iter; left time: 4173.1714s
Epoch: 14 cost time: 43.21468114852905
Epoch: 14, Steps: 369 | Train Loss: 0.186 Vali Loss: 1.210 Vali Acc: 0.646 Test Loss: 1.210 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0568728
	speed: 0.4650s/iter; left time: 14709.8345s
	iters: 200, epoch: 15 | loss: 0.0727419
	speed: 0.1399s/iter; left time: 4412.1284s
	iters: 300, epoch: 15 | loss: 0.3154195
	speed: 0.1352s/iter; left time: 4250.2850s
Epoch: 15 cost time: 52.16893410682678
Epoch: 15, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.260 Vali Acc: 0.664 Test Loss: 1.260 Test Acc: 0.664
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6767877412031782
model parameter : 1112998
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3761609
	speed: 0.1518s/iter; left time: 5586.9263s
	iters: 200, epoch: 1 | loss: 0.9844218
	speed: 0.1265s/iter; left time: 4642.6212s
	iters: 300, epoch: 1 | loss: 0.9305432
	speed: 0.1182s/iter; left time: 4327.1400s
Epoch: 1 cost time: 48.715951442718506
Epoch: 1, Steps: 369 | Train Loss: 0.928 Vali Loss: 0.721 Vali Acc: 0.632 Test Loss: 0.721 Test Acc: 0.632
Validation loss decreased (inf --> -0.632229).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3778606
	speed: 0.4530s/iter; left time: 16504.5684s
	iters: 200, epoch: 2 | loss: 0.6709918
	speed: 0.1520s/iter; left time: 5521.9048s
	iters: 300, epoch: 2 | loss: 0.6016228
	speed: 0.1396s/iter; left time: 5056.7711s
Epoch: 2 cost time: 52.60857105255127
Epoch: 2, Steps: 369 | Train Loss: 0.730 Vali Loss: 1.168 Vali Acc: 0.540 Test Loss: 1.168 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2713098
	speed: 0.4736s/iter; left time: 17079.6977s
	iters: 200, epoch: 3 | loss: 0.5372053
	speed: 0.1206s/iter; left time: 4335.5159s
	iters: 300, epoch: 3 | loss: 0.4792796
	speed: 0.1344s/iter; left time: 4820.6188s
Epoch: 3 cost time: 48.93724203109741
Epoch: 3, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.931 Vali Acc: 0.537 Test Loss: 0.931 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4885207
	speed: 0.5101s/iter; left time: 18207.5677s
	iters: 200, epoch: 4 | loss: 0.7823674
	speed: 0.1319s/iter; left time: 4693.3890s
	iters: 300, epoch: 4 | loss: 0.7582929
	speed: 0.1576s/iter; left time: 5594.8068s
Epoch: 4 cost time: 55.827128648757935
Epoch: 4, Steps: 369 | Train Loss: 0.632 Vali Loss: 0.653 Vali Acc: 0.672 Test Loss: 0.653 Test Acc: 0.672
Validation loss decreased (-0.632229 --> -0.671957).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6770173
	speed: 0.4573s/iter; left time: 16153.1748s
	iters: 200, epoch: 5 | loss: 0.3876318
	speed: 0.1369s/iter; left time: 4820.5920s
	iters: 300, epoch: 5 | loss: 0.3847281
	speed: 0.1232s/iter; left time: 4326.9464s
Epoch: 5 cost time: 43.585917949676514
Epoch: 5, Steps: 369 | Train Loss: 0.561 Vali Loss: 0.760 Vali Acc: 0.640 Test Loss: 0.760 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5055428
	speed: 0.3897s/iter; left time: 13621.9321s
	iters: 200, epoch: 6 | loss: 0.7080483
	speed: 0.1287s/iter; left time: 4485.1091s
	iters: 300, epoch: 6 | loss: 0.5894738
	speed: 0.1380s/iter; left time: 4795.0703s
Epoch: 6 cost time: 51.091660022735596
Epoch: 6, Steps: 369 | Train Loss: 0.483 Vali Loss: 0.645 Vali Acc: 0.684 Test Loss: 0.645 Test Acc: 0.684
Validation loss decreased (-0.671957 --> -0.684159).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3074155
	speed: 0.4783s/iter; left time: 16543.2449s
	iters: 200, epoch: 7 | loss: 0.4338653
	speed: 0.1336s/iter; left time: 4606.0964s
	iters: 300, epoch: 7 | loss: 0.2548452
	speed: 0.1415s/iter; left time: 4864.7594s
Epoch: 7 cost time: 51.451738357543945
Epoch: 7, Steps: 369 | Train Loss: 0.426 Vali Loss: 0.872 Vali Acc: 0.634 Test Loss: 0.872 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1905691
	speed: 0.4784s/iter; left time: 16370.4307s
	iters: 200, epoch: 8 | loss: 0.3290888
	speed: 0.1199s/iter; left time: 4089.6113s
	iters: 300, epoch: 8 | loss: 0.4141195
	speed: 0.1416s/iter; left time: 4816.7140s
Epoch: 8 cost time: 50.526891469955444
Epoch: 8, Steps: 369 | Train Loss: 0.380 Vali Loss: 0.741 Vali Acc: 0.650 Test Loss: 0.741 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1116276
	speed: 0.4519s/iter; left time: 15295.7543s
	iters: 200, epoch: 9 | loss: 0.4862176
	speed: 0.1308s/iter; left time: 4413.2898s
	iters: 300, epoch: 9 | loss: 0.5093907
	speed: 0.1527s/iter; left time: 5138.5280s
Epoch: 9 cost time: 53.131452560424805
Epoch: 9, Steps: 369 | Train Loss: 0.344 Vali Loss: 0.851 Vali Acc: 0.642 Test Loss: 0.851 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2397406
	speed: 0.5127s/iter; left time: 17165.5541s
	iters: 200, epoch: 10 | loss: 0.2710157
	speed: 0.1268s/iter; left time: 4232.3188s
	iters: 300, epoch: 10 | loss: 0.2259217
	speed: 0.1038s/iter; left time: 3453.5193s
Epoch: 10 cost time: 48.94725275039673
Epoch: 10, Steps: 369 | Train Loss: 0.304 Vali Loss: 1.125 Vali Acc: 0.629 Test Loss: 1.125 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1931768
	speed: 0.4923s/iter; left time: 16302.1598s
	iters: 200, epoch: 11 | loss: 0.0704834
	speed: 0.1497s/iter; left time: 4941.6788s
	iters: 300, epoch: 11 | loss: 0.4019496
	speed: 0.1327s/iter; left time: 4366.9173s
Epoch: 11 cost time: 50.81759691238403
Epoch: 11, Steps: 369 | Train Loss: 0.258 Vali Loss: 0.931 Vali Acc: 0.648 Test Loss: 0.931 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1171656
	speed: 0.4625s/iter; left time: 15141.5704s
	iters: 200, epoch: 12 | loss: 0.2954300
	speed: 0.1195s/iter; left time: 3902.1596s
	iters: 300, epoch: 12 | loss: 0.4111358
	speed: 0.1382s/iter; left time: 4496.5559s
Epoch: 12 cost time: 48.236353397369385
Epoch: 12, Steps: 369 | Train Loss: 0.227 Vali Loss: 0.853 Vali Acc: 0.660 Test Loss: 0.853 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0966207
	speed: 0.4753s/iter; left time: 15385.8277s
	iters: 200, epoch: 13 | loss: 0.0465750
	speed: 0.1424s/iter; left time: 4596.7258s
	iters: 300, epoch: 13 | loss: 0.3017441
	speed: 0.1343s/iter; left time: 4319.5169s
Epoch: 13 cost time: 52.33971428871155
Epoch: 13, Steps: 369 | Train Loss: 0.186 Vali Loss: 1.063 Vali Acc: 0.653 Test Loss: 1.063 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1596775
	speed: 0.4661s/iter; left time: 14916.9758s
	iters: 200, epoch: 14 | loss: 0.0598738
	speed: 0.1245s/iter; left time: 3973.4758s
	iters: 300, epoch: 14 | loss: 0.4187497
	speed: 0.1362s/iter; left time: 4333.1676s
Epoch: 14 cost time: 49.73016095161438
Epoch: 14, Steps: 369 | Train Loss: 0.175 Vali Loss: 1.242 Vali Acc: 0.659 Test Loss: 1.242 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.5228825
	speed: 0.4624s/iter; left time: 14628.4444s
	iters: 200, epoch: 15 | loss: 0.0836745
	speed: 0.1292s/iter; left time: 4074.5099s
	iters: 300, epoch: 15 | loss: 0.1211947
	speed: 0.1483s/iter; left time: 4660.9185s
Epoch: 15 cost time: 51.05165934562683
Epoch: 15, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.338 Vali Acc: 0.642 Test Loss: 1.338 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0194142
	speed: 0.4737s/iter; left time: 14811.8678s
	iters: 200, epoch: 16 | loss: 0.2048309
	speed: 0.1437s/iter; left time: 4479.9411s
	iters: 300, epoch: 16 | loss: 0.4952182
	speed: 0.1568s/iter; left time: 4871.9051s
Epoch: 16 cost time: 56.36368203163147
Epoch: 16, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.294 Vali Acc: 0.638 Test Loss: 1.294 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6841657207718501
model parameter : 1112422
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9431038
	speed: 0.1425s/iter; left time: 5245.4111s
	iters: 200, epoch: 1 | loss: 0.4335750
	speed: 0.0972s/iter; left time: 3565.8652s
	iters: 300, epoch: 1 | loss: 0.6973116
	speed: 0.0820s/iter; left time: 3000.7480s
Epoch: 1 cost time: 37.87556576728821
Epoch: 1, Steps: 369 | Train Loss: 0.864 Vali Loss: 1.710 Vali Acc: 0.524 Test Loss: 1.710 Test Acc: 0.524
Validation loss decreased (inf --> -0.524103).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7631797
	speed: 0.3907s/iter; left time: 14235.5495s
	iters: 200, epoch: 2 | loss: 1.1289139
	speed: 0.1361s/iter; left time: 4943.7567s
	iters: 300, epoch: 2 | loss: 0.6478868
	speed: 0.1298s/iter; left time: 4703.7470s
Epoch: 2 cost time: 49.52682542800903
Epoch: 2, Steps: 369 | Train Loss: 0.910 Vali Loss: 1.417 Vali Acc: 0.550 Test Loss: 1.417 Test Acc: 0.550
Validation loss decreased (-0.524103 --> -0.549645).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8904022
	speed: 0.4537s/iter; left time: 16360.5051s
	iters: 200, epoch: 3 | loss: 0.6284882
	speed: 0.1272s/iter; left time: 4574.9396s
	iters: 300, epoch: 3 | loss: 0.4297580
	speed: 0.1302s/iter; left time: 4667.9915s
Epoch: 3 cost time: 47.48651623725891
Epoch: 3, Steps: 369 | Train Loss: 0.681 Vali Loss: 0.657 Vali Acc: 0.669 Test Loss: 0.657 Test Acc: 0.669
Validation loss decreased (-0.549645 --> -0.668552).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5526457
	speed: 0.4632s/iter; left time: 16533.0619s
	iters: 200, epoch: 4 | loss: 0.9562028
	speed: 0.1328s/iter; left time: 4725.4528s
	iters: 300, epoch: 4 | loss: 0.3292918
	speed: 0.1189s/iter; left time: 4219.7929s
Epoch: 4 cost time: 49.45321011543274
Epoch: 4, Steps: 369 | Train Loss: 0.621 Vali Loss: 0.680 Vali Acc: 0.660 Test Loss: 0.680 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4581842
	speed: 0.4698s/iter; left time: 16595.2930s
	iters: 200, epoch: 5 | loss: 0.4273919
	speed: 0.1363s/iter; left time: 4800.2349s
	iters: 300, epoch: 5 | loss: 0.8172066
	speed: 0.1218s/iter; left time: 4277.9796s
Epoch: 5 cost time: 47.84182953834534
Epoch: 5, Steps: 369 | Train Loss: 0.548 Vali Loss: 0.843 Vali Acc: 0.637 Test Loss: 0.843 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3803571
	speed: 0.4600s/iter; left time: 16081.1002s
	iters: 200, epoch: 6 | loss: 0.6816040
	speed: 0.1439s/iter; left time: 5014.1868s
	iters: 300, epoch: 6 | loss: 1.0746582
	speed: 0.1380s/iter; left time: 4796.8915s
Epoch: 6 cost time: 51.86964750289917
Epoch: 6, Steps: 369 | Train Loss: 0.485 Vali Loss: 0.710 Vali Acc: 0.672 Test Loss: 0.710 Test Acc: 0.672
Validation loss decreased (-0.668552 --> -0.671673).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5212271
	speed: 0.4900s/iter; left time: 16945.9453s
	iters: 200, epoch: 7 | loss: 0.3548923
	speed: 0.1291s/iter; left time: 4452.7943s
	iters: 300, epoch: 7 | loss: 0.4058092
	speed: 0.1354s/iter; left time: 4656.0043s
Epoch: 7 cost time: 48.79772400856018
Epoch: 7, Steps: 369 | Train Loss: 0.425 Vali Loss: 0.668 Vali Acc: 0.681 Test Loss: 0.668 Test Acc: 0.681
Validation loss decreased (-0.671673 --> -0.681038).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4961481
	speed: 0.4614s/iter; left time: 15789.4037s
	iters: 200, epoch: 8 | loss: 0.3106816
	speed: 0.1101s/iter; left time: 3756.4822s
	iters: 300, epoch: 8 | loss: 0.5475034
	speed: 0.1524s/iter; left time: 5185.7663s
Epoch: 8 cost time: 49.6006133556366
Epoch: 8, Steps: 369 | Train Loss: 0.383 Vali Loss: 0.728 Vali Acc: 0.671 Test Loss: 0.728 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6358566
	speed: 0.4545s/iter; left time: 15383.4478s
	iters: 200, epoch: 9 | loss: 0.2713881
	speed: 0.1223s/iter; left time: 4128.5533s
	iters: 300, epoch: 9 | loss: 0.2722626
	speed: 0.1297s/iter; left time: 4363.9478s
Epoch: 9 cost time: 47.39184594154358
Epoch: 9, Steps: 369 | Train Loss: 0.342 Vali Loss: 0.738 Vali Acc: 0.665 Test Loss: 0.738 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2783334
	speed: 0.4576s/iter; left time: 15321.6542s
	iters: 200, epoch: 10 | loss: 0.2046209
	speed: 0.1390s/iter; left time: 4639.3424s
	iters: 300, epoch: 10 | loss: 0.3357158
	speed: 0.1193s/iter; left time: 3970.9819s
Epoch: 10 cost time: 48.60864853858948
Epoch: 10, Steps: 369 | Train Loss: 0.296 Vali Loss: 0.839 Vali Acc: 0.657 Test Loss: 0.839 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1968514
	speed: 0.4286s/iter; left time: 14192.2061s
	iters: 200, epoch: 11 | loss: 0.1783047
	speed: 0.1383s/iter; left time: 4565.8941s
	iters: 300, epoch: 11 | loss: 0.0711484
	speed: 0.1186s/iter; left time: 3904.2579s
Epoch: 11 cost time: 47.80797004699707
Epoch: 11, Steps: 369 | Train Loss: 0.260 Vali Loss: 0.922 Vali Acc: 0.656 Test Loss: 0.922 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1694077
	speed: 0.4541s/iter; left time: 14869.6987s
	iters: 200, epoch: 12 | loss: 0.3819087
	speed: 0.1111s/iter; left time: 3626.1161s
	iters: 300, epoch: 12 | loss: 0.1777023
	speed: 0.1335s/iter; left time: 4344.2802s
Epoch: 12 cost time: 45.95150113105774
Epoch: 12, Steps: 369 | Train Loss: 0.216 Vali Loss: 1.114 Vali Acc: 0.651 Test Loss: 1.114 Test Acc: 0.651
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2219076
	speed: 0.4295s/iter; left time: 13903.0022s
	iters: 200, epoch: 13 | loss: 0.0252878
	speed: 0.0763s/iter; left time: 2463.9464s
	iters: 300, epoch: 13 | loss: 0.1542469
	speed: 0.0781s/iter; left time: 2513.0355s
Epoch: 13 cost time: 30.746986865997314
Epoch: 13, Steps: 369 | Train Loss: 0.177 Vali Loss: 1.485 Vali Acc: 0.638 Test Loss: 1.485 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0511630
	speed: 0.4513s/iter; left time: 14444.0057s
	iters: 200, epoch: 14 | loss: 0.3257033
	speed: 0.1206s/iter; left time: 3848.3016s
	iters: 300, epoch: 14 | loss: 0.1639088
	speed: 0.1301s/iter; left time: 4138.4054s
Epoch: 14 cost time: 48.45701766014099
Epoch: 14, Steps: 369 | Train Loss: 0.156 Vali Loss: 1.302 Vali Acc: 0.661 Test Loss: 1.302 Test Acc: 0.661
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0633969
	speed: 0.4514s/iter; left time: 14279.8300s
	iters: 200, epoch: 15 | loss: 0.0740977
	speed: 0.1292s/iter; left time: 4074.1620s
	iters: 300, epoch: 15 | loss: 0.6992150
	speed: 0.1452s/iter; left time: 4562.9176s
Epoch: 15 cost time: 49.504940032958984
Epoch: 15, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.407 Vali Acc: 0.648 Test Loss: 1.407 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0069048
	speed: 0.4555s/iter; left time: 14243.1278s
	iters: 200, epoch: 16 | loss: 0.1157322
	speed: 0.1157s/iter; left time: 3606.9171s
	iters: 300, epoch: 16 | loss: 0.2718320
	speed: 0.1279s/iter; left time: 3974.3999s
Epoch: 16 cost time: 47.09184241294861
Epoch: 16, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.833 Vali Acc: 0.622 Test Loss: 1.833 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0571318
	speed: 0.4538s/iter; left time: 14021.8555s
	iters: 200, epoch: 17 | loss: 0.3474846
	speed: 0.1421s/iter; left time: 4377.2373s
	iters: 300, epoch: 17 | loss: 0.0980626
	speed: 0.1108s/iter; left time: 3401.3296s
Epoch: 17 cost time: 48.61917304992676
Epoch: 17, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.683 Vali Acc: 0.643 Test Loss: 1.683 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.681044267877412
model parameter : 1111846
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0057092
	speed: 0.1582s/iter; left time: 5821.4260s
	iters: 200, epoch: 1 | loss: 0.9225761
	speed: 0.1422s/iter; left time: 5217.8347s
	iters: 300, epoch: 1 | loss: 1.9701885
	speed: 0.1267s/iter; left time: 4637.4528s
Epoch: 1 cost time: 52.22549104690552
Epoch: 1, Steps: 369 | Train Loss: 0.839 Vali Loss: 1.561 Vali Acc: 0.515 Test Loss: 1.561 Test Acc: 0.515
Validation loss decreased (inf --> -0.514740).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0240153
	speed: 0.4636s/iter; left time: 16891.4031s
	iters: 200, epoch: 2 | loss: 2.1011028
	speed: 0.1342s/iter; left time: 4875.9803s
	iters: 300, epoch: 2 | loss: 0.4237870
	speed: 0.1419s/iter; left time: 5140.2921s
Epoch: 2 cost time: 49.889071464538574
Epoch: 2, Steps: 369 | Train Loss: 0.819 Vali Loss: 1.248 Vali Acc: 0.521 Test Loss: 1.248 Test Acc: 0.521
Validation loss decreased (-0.514740 --> -0.520986).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9836590
	speed: 0.4216s/iter; left time: 15203.8755s
	iters: 200, epoch: 3 | loss: 0.6444502
	speed: 0.1080s/iter; left time: 3882.9783s
	iters: 300, epoch: 3 | loss: 0.3979853
	speed: 0.1329s/iter; left time: 4764.9922s
Epoch: 3 cost time: 46.02289128303528
Epoch: 3, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.916 Vali Acc: 0.529 Test Loss: 0.916 Test Acc: 0.529
Validation loss decreased (-0.520986 --> -0.528651).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6605170
	speed: 0.4374s/iter; left time: 15611.3718s
	iters: 200, epoch: 4 | loss: 0.6685690
	speed: 0.1400s/iter; left time: 4981.5712s
	iters: 300, epoch: 4 | loss: 0.9082714
	speed: 0.1361s/iter; left time: 4830.5947s
Epoch: 4 cost time: 50.327521324157715
Epoch: 4, Steps: 369 | Train Loss: 0.603 Vali Loss: 0.625 Vali Acc: 0.663 Test Loss: 0.625 Test Acc: 0.663
Validation loss decreased (-0.528651 --> -0.662877).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5376645
	speed: 0.4431s/iter; left time: 15654.0017s
	iters: 200, epoch: 5 | loss: 0.2504440
	speed: 0.1313s/iter; left time: 4626.5715s
	iters: 300, epoch: 5 | loss: 0.7005157
	speed: 0.1116s/iter; left time: 3920.9121s
Epoch: 5 cost time: 47.04232311248779
Epoch: 5, Steps: 369 | Train Loss: 0.507 Vali Loss: 0.630 Vali Acc: 0.671 Test Loss: 0.630 Test Acc: 0.671
Validation loss decreased (-0.662877 --> -0.671106).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2336982
	speed: 0.4452s/iter; left time: 15563.8072s
	iters: 200, epoch: 6 | loss: 0.5471929
	speed: 0.1337s/iter; left time: 4661.1050s
	iters: 300, epoch: 6 | loss: 0.1787370
	speed: 0.1339s/iter; left time: 4655.3413s
Epoch: 6 cost time: 49.632452726364136
Epoch: 6, Steps: 369 | Train Loss: 0.446 Vali Loss: 0.746 Vali Acc: 0.667 Test Loss: 0.746 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4042432
	speed: 0.4288s/iter; left time: 14831.7754s
	iters: 200, epoch: 7 | loss: 0.3273458
	speed: 0.1335s/iter; left time: 4604.7307s
	iters: 300, epoch: 7 | loss: 0.5359020
	speed: 0.1356s/iter; left time: 4662.4514s
Epoch: 7 cost time: 49.55217361450195
Epoch: 7, Steps: 369 | Train Loss: 0.392 Vali Loss: 0.796 Vali Acc: 0.627 Test Loss: 0.796 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1840960
	speed: 0.4660s/iter; left time: 15946.4419s
	iters: 200, epoch: 8 | loss: 0.4547358
	speed: 0.1177s/iter; left time: 4015.5326s
	iters: 300, epoch: 8 | loss: 0.2271291
	speed: 0.1406s/iter; left time: 4782.1360s
Epoch: 8 cost time: 50.79589104652405
Epoch: 8, Steps: 369 | Train Loss: 0.342 Vali Loss: 0.930 Vali Acc: 0.643 Test Loss: 0.930 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2628466
	speed: 0.4918s/iter; left time: 16648.0004s
	iters: 200, epoch: 9 | loss: 0.5812892
	speed: 0.1436s/iter; left time: 4846.4624s
	iters: 300, epoch: 9 | loss: 0.1685245
	speed: 0.1287s/iter; left time: 4330.5995s
Epoch: 9 cost time: 51.57320785522461
Epoch: 9, Steps: 369 | Train Loss: 0.306 Vali Loss: 0.836 Vali Acc: 0.639 Test Loss: 0.836 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1583278
	speed: 0.4150s/iter; left time: 13893.5399s
	iters: 200, epoch: 10 | loss: 0.2040626
	speed: 0.1271s/iter; left time: 4241.6198s
	iters: 300, epoch: 10 | loss: 0.2164325
	speed: 0.1146s/iter; left time: 3812.6480s
Epoch: 10 cost time: 42.528831243515015
Epoch: 10, Steps: 369 | Train Loss: 0.250 Vali Loss: 0.864 Vali Acc: 0.661 Test Loss: 0.864 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1552246
	speed: 0.3559s/iter; left time: 11784.7194s
	iters: 200, epoch: 11 | loss: 0.2337059
	speed: 0.1236s/iter; left time: 4081.1996s
	iters: 300, epoch: 11 | loss: 0.0430232
	speed: 0.1165s/iter; left time: 3834.5588s
Epoch: 11 cost time: 45.22664165496826
Epoch: 11, Steps: 369 | Train Loss: 0.216 Vali Loss: 1.116 Vali Acc: 0.665 Test Loss: 1.116 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3756959
	speed: 0.4136s/iter; left time: 13543.3702s
	iters: 200, epoch: 12 | loss: 0.1056504
	speed: 0.1104s/iter; left time: 3603.2900s
	iters: 300, epoch: 12 | loss: 0.0387155
	speed: 0.1248s/iter; left time: 4061.7307s
Epoch: 12 cost time: 44.455551862716675
Epoch: 12, Steps: 369 | Train Loss: 0.166 Vali Loss: 1.090 Vali Acc: 0.665 Test Loss: 1.090 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0814640
	speed: 0.4388s/iter; left time: 14206.1130s
	iters: 200, epoch: 13 | loss: 0.2091838
	speed: 0.1248s/iter; left time: 4028.4684s
	iters: 300, epoch: 13 | loss: 0.0360753
	speed: 0.1218s/iter; left time: 3919.4818s
Epoch: 13 cost time: 47.25686454772949
Epoch: 13, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.343 Vali Acc: 0.660 Test Loss: 1.343 Test Acc: 0.660
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.2970137
	speed: 0.4490s/iter; left time: 14368.2099s
	iters: 200, epoch: 14 | loss: 0.0472310
	speed: 0.1508s/iter; left time: 4811.1571s
	iters: 300, epoch: 14 | loss: 0.2618829
	speed: 0.1295s/iter; left time: 4119.8378s
Epoch: 14 cost time: 52.486106634140015
Epoch: 14, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.496 Vali Acc: 0.653 Test Loss: 1.496 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1843772
	speed: 0.4485s/iter; left time: 14188.6309s
	iters: 200, epoch: 15 | loss: 0.0759862
	speed: 0.1371s/iter; left time: 4322.8596s
	iters: 300, epoch: 15 | loss: 0.1433688
	speed: 0.1307s/iter; left time: 4109.9403s
Epoch: 15 cost time: 49.128235816955566
Epoch: 15, Steps: 369 | Train Loss: 0.121 Vali Loss: 1.762 Vali Acc: 0.650 Test Loss: 1.762 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6711123723041997
model parameter : 783334
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9064916
	speed: 0.1501s/iter; left time: 5523.0318s
	iters: 200, epoch: 1 | loss: 0.9286371
	speed: 0.1186s/iter; left time: 4354.5058s
	iters: 300, epoch: 1 | loss: 2.2674029
	speed: 0.1229s/iter; left time: 4499.1386s
Epoch: 1 cost time: 47.835352420806885
Epoch: 1, Steps: 369 | Train Loss: 0.992 Vali Loss: 1.717 Vali Acc: 0.505 Test Loss: 1.717 Test Acc: 0.505
Validation loss decreased (inf --> -0.504807).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5193471
	speed: 0.4367s/iter; left time: 15910.3977s
	iters: 200, epoch: 2 | loss: 0.5227996
	speed: 0.1296s/iter; left time: 4708.1035s
	iters: 300, epoch: 2 | loss: 0.3340341
	speed: 0.1337s/iter; left time: 4844.7283s
Epoch: 2 cost time: 47.30786323547363
Epoch: 2, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.919 Vali Acc: 0.582 Test Loss: 0.919 Test Acc: 0.582
Validation loss decreased (-0.504807 --> -0.581716).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6519561
	speed: 0.4045s/iter; left time: 14586.2464s
	iters: 200, epoch: 3 | loss: 0.6527096
	speed: 0.1249s/iter; left time: 4492.4050s
	iters: 300, epoch: 3 | loss: 0.2482906
	speed: 0.1357s/iter; left time: 4867.1975s
Epoch: 3 cost time: 48.1370267868042
Epoch: 3, Steps: 369 | Train Loss: 0.672 Vali Loss: 0.784 Vali Acc: 0.643 Test Loss: 0.784 Test Acc: 0.643
Validation loss decreased (-0.581716 --> -0.643011).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5152172
	speed: 0.4368s/iter; left time: 15591.4114s
	iters: 200, epoch: 4 | loss: 1.0642071
	speed: 0.1265s/iter; left time: 4503.2206s
	iters: 300, epoch: 4 | loss: 0.8291221
	speed: 0.1282s/iter; left time: 4551.8615s
Epoch: 4 cost time: 46.99234127998352
Epoch: 4, Steps: 369 | Train Loss: 0.597 Vali Loss: 0.728 Vali Acc: 0.621 Test Loss: 0.728 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4340024
	speed: 0.4404s/iter; left time: 15557.4894s
	iters: 200, epoch: 5 | loss: 0.3961924
	speed: 0.1318s/iter; left time: 4644.2487s
	iters: 300, epoch: 5 | loss: 0.6289369
	speed: 0.1142s/iter; left time: 4010.7181s
Epoch: 5 cost time: 48.046449422836304
Epoch: 5, Steps: 369 | Train Loss: 0.504 Vali Loss: 0.671 Vali Acc: 0.669 Test Loss: 0.671 Test Acc: 0.669
Validation loss decreased (-0.643011 --> -0.668552).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4443306
	speed: 0.4578s/iter; left time: 16002.9550s
	iters: 200, epoch: 6 | loss: 0.2753700
	speed: 0.1357s/iter; left time: 4728.9256s
	iters: 300, epoch: 6 | loss: 0.3114659
	speed: 0.1174s/iter; left time: 4080.7547s
Epoch: 6 cost time: 48.0015811920166
Epoch: 6, Steps: 369 | Train Loss: 0.454 Vali Loss: 0.679 Vali Acc: 0.686 Test Loss: 0.679 Test Acc: 0.686
Validation loss decreased (-0.668552 --> -0.685862).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3617392
	speed: 0.4710s/iter; left time: 16289.5268s
	iters: 200, epoch: 7 | loss: 0.2371062
	speed: 0.1325s/iter; left time: 4567.9153s
	iters: 300, epoch: 7 | loss: 0.3157221
	speed: 0.1160s/iter; left time: 3989.9397s
Epoch: 7 cost time: 47.95272183418274
Epoch: 7, Steps: 369 | Train Loss: 0.400 Vali Loss: 0.757 Vali Acc: 0.634 Test Loss: 0.757 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3462344
	speed: 0.4473s/iter; left time: 15304.7924s
	iters: 200, epoch: 8 | loss: 0.3672354
	speed: 0.1299s/iter; left time: 4432.6417s
	iters: 300, epoch: 8 | loss: 0.4893625
	speed: 0.1168s/iter; left time: 3973.3736s
Epoch: 8 cost time: 45.17451620101929
Epoch: 8, Steps: 369 | Train Loss: 0.360 Vali Loss: 0.683 Vali Acc: 0.663 Test Loss: 0.683 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3298651
	speed: 0.3522s/iter; left time: 11922.8509s
	iters: 200, epoch: 9 | loss: 0.4127648
	speed: 0.1204s/iter; left time: 4062.2682s
	iters: 300, epoch: 9 | loss: 0.5133789
	speed: 0.1302s/iter; left time: 4380.3733s
Epoch: 9 cost time: 46.48446607589722
Epoch: 9, Steps: 369 | Train Loss: 0.310 Vali Loss: 0.813 Vali Acc: 0.649 Test Loss: 0.813 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6888997
	speed: 0.4357s/iter; left time: 14585.7786s
	iters: 200, epoch: 10 | loss: 0.2115834
	speed: 0.1150s/iter; left time: 3839.7028s
	iters: 300, epoch: 10 | loss: 0.2194143
	speed: 0.1363s/iter; left time: 4534.7755s
Epoch: 10 cost time: 47.45724391937256
Epoch: 10, Steps: 369 | Train Loss: 0.270 Vali Loss: 0.860 Vali Acc: 0.661 Test Loss: 0.860 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1186823
	speed: 0.4320s/iter; left time: 14305.5843s
	iters: 200, epoch: 11 | loss: 0.1417401
	speed: 0.1178s/iter; left time: 3890.2315s
	iters: 300, epoch: 11 | loss: 0.1145429
	speed: 0.1362s/iter; left time: 4483.4858s
Epoch: 11 cost time: 46.86062932014465
Epoch: 11, Steps: 369 | Train Loss: 0.223 Vali Loss: 1.071 Vali Acc: 0.659 Test Loss: 1.071 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.4232849
	speed: 0.4676s/iter; left time: 15309.9587s
	iters: 200, epoch: 12 | loss: 0.0452802
	speed: 0.1381s/iter; left time: 4508.9219s
	iters: 300, epoch: 12 | loss: 0.0736969
	speed: 0.1375s/iter; left time: 4475.1756s
Epoch: 12 cost time: 52.78639531135559
Epoch: 12, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.154 Vali Acc: 0.652 Test Loss: 1.154 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1256446
	speed: 0.4629s/iter; left time: 14986.4766s
	iters: 200, epoch: 13 | loss: 0.0179972
	speed: 0.1148s/iter; left time: 3703.9990s
	iters: 300, epoch: 13 | loss: 0.0504716
	speed: 0.1378s/iter; left time: 4434.4553s
Epoch: 13 cost time: 48.15119385719299
Epoch: 13, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.307 Vali Acc: 0.654 Test Loss: 1.307 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.4634883
	speed: 0.4312s/iter; left time: 13798.8483s
	iters: 200, epoch: 14 | loss: 0.3225036
	speed: 0.1038s/iter; left time: 3312.3475s
	iters: 300, epoch: 14 | loss: 0.1494543
	speed: 0.1320s/iter; left time: 4198.7706s
Epoch: 14 cost time: 44.587831020355225
Epoch: 14, Steps: 369 | Train Loss: 0.143 Vali Loss: 1.522 Vali Acc: 0.641 Test Loss: 1.522 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1077245
	speed: 0.4265s/iter; left time: 13493.4530s
	iters: 200, epoch: 15 | loss: 0.0578998
	speed: 0.1153s/iter; left time: 3635.3385s
	iters: 300, epoch: 15 | loss: 0.0131037
	speed: 0.1449s/iter; left time: 4555.2218s
Epoch: 15 cost time: 48.71754550933838
Epoch: 15, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.294 Vali Acc: 0.644 Test Loss: 1.294 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0840158
	speed: 0.4417s/iter; left time: 13811.7266s
	iters: 200, epoch: 16 | loss: 0.0014521
	speed: 0.1250s/iter; left time: 3896.8873s
	iters: 300, epoch: 16 | loss: 0.3044178
	speed: 0.1305s/iter; left time: 4055.1807s
Epoch: 16 cost time: 46.984851121902466
Epoch: 16, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.430 Vali Acc: 0.645 Test Loss: 1.430 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6858683314415437
model parameter : 782758
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0514152
	speed: 0.1415s/iter; left time: 5205.7729s
	iters: 200, epoch: 1 | loss: 0.7887479
	speed: 0.1252s/iter; left time: 4594.3410s
	iters: 300, epoch: 1 | loss: 2.3873520
	speed: 0.1170s/iter; left time: 4280.7742s
Epoch: 1 cost time: 47.23897099494934
Epoch: 1, Steps: 369 | Train Loss: 0.991 Vali Loss: 2.001 Vali Acc: 0.519 Test Loss: 2.001 Test Acc: 0.519
Validation loss decreased (inf --> -0.519276).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8485790
	speed: 0.4287s/iter; left time: 15618.7636s
	iters: 200, epoch: 2 | loss: 0.7218511
	speed: 0.1442s/iter; left time: 5239.6104s
	iters: 300, epoch: 2 | loss: 1.9565704
	speed: 0.1476s/iter; left time: 5349.0561s
Epoch: 2 cost time: 50.865291595458984
Epoch: 2, Steps: 369 | Train Loss: 0.796 Vali Loss: 0.803 Vali Acc: 0.588 Test Loss: 0.803 Test Acc: 0.588
Validation loss decreased (-0.519276 --> -0.587960).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3689874
	speed: 0.4370s/iter; left time: 15757.7365s
	iters: 200, epoch: 3 | loss: 0.6436259
	speed: 0.1345s/iter; left time: 4838.6615s
	iters: 300, epoch: 3 | loss: 0.3886888
	speed: 0.1123s/iter; left time: 4027.4022s
Epoch: 3 cost time: 46.54676413536072
Epoch: 3, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.672 Vali Acc: 0.662 Test Loss: 0.672 Test Acc: 0.662
Validation loss decreased (-0.587960 --> -0.662309).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4858529
	speed: 0.4273s/iter; left time: 15252.9167s
	iters: 200, epoch: 4 | loss: 0.5516798
	speed: 0.1380s/iter; left time: 4912.7078s
	iters: 300, epoch: 4 | loss: 0.6479208
	speed: 0.1267s/iter; left time: 4497.1491s
Epoch: 4 cost time: 48.404170751571655
Epoch: 4, Steps: 369 | Train Loss: 0.585 Vali Loss: 0.695 Vali Acc: 0.671 Test Loss: 0.695 Test Acc: 0.671
Validation loss decreased (-0.662309 --> -0.671105).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4340149
	speed: 0.3522s/iter; left time: 12439.7855s
	iters: 200, epoch: 5 | loss: 1.1093931
	speed: 0.0659s/iter; left time: 2320.3405s
	iters: 300, epoch: 5 | loss: 0.3163444
	speed: 0.0734s/iter; left time: 2578.8478s
Epoch: 5 cost time: 30.403498649597168
Epoch: 5, Steps: 369 | Train Loss: 0.493 Vali Loss: 0.747 Vali Acc: 0.651 Test Loss: 0.747 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6280361
	speed: 0.4292s/iter; left time: 15002.9886s
	iters: 200, epoch: 6 | loss: 0.4053080
	speed: 0.1353s/iter; left time: 4715.7834s
	iters: 300, epoch: 6 | loss: 0.2300471
	speed: 0.1103s/iter; left time: 3832.7875s
Epoch: 6 cost time: 45.77518105506897
Epoch: 6, Steps: 369 | Train Loss: 0.447 Vali Loss: 0.703 Vali Acc: 0.677 Test Loss: 0.703 Test Acc: 0.677
Validation loss decreased (-0.671105 --> -0.677064).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3886282
	speed: 0.3720s/iter; left time: 12866.4633s
	iters: 200, epoch: 7 | loss: 0.3731163
	speed: 0.1220s/iter; left time: 4209.0163s
	iters: 300, epoch: 7 | loss: 0.2879119
	speed: 0.1173s/iter; left time: 4033.0970s
Epoch: 7 cost time: 45.50391912460327
Epoch: 7, Steps: 369 | Train Loss: 0.399 Vali Loss: 0.837 Vali Acc: 0.654 Test Loss: 0.837 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3487484
	speed: 0.4116s/iter; left time: 14084.5066s
	iters: 200, epoch: 8 | loss: 0.4231394
	speed: 0.1238s/iter; left time: 4223.1496s
	iters: 300, epoch: 8 | loss: 0.4738766
	speed: 0.1217s/iter; left time: 4139.3539s
Epoch: 8 cost time: 46.026108503341675
Epoch: 8, Steps: 369 | Train Loss: 0.355 Vali Loss: 0.864 Vali Acc: 0.678 Test Loss: 0.864 Test Acc: 0.678
Validation loss decreased (-0.677064 --> -0.678198).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0563533
	speed: 0.4325s/iter; left time: 14641.3689s
	iters: 200, epoch: 9 | loss: 0.3368340
	speed: 0.1277s/iter; left time: 4310.6602s
	iters: 300, epoch: 9 | loss: 0.2644791
	speed: 0.1385s/iter; left time: 4660.9837s
Epoch: 9 cost time: 49.41634774208069
Epoch: 9, Steps: 369 | Train Loss: 0.305 Vali Loss: 0.809 Vali Acc: 0.659 Test Loss: 0.809 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1313767
	speed: 0.4284s/iter; left time: 14344.2888s
	iters: 200, epoch: 10 | loss: 0.4626413
	speed: 0.1179s/iter; left time: 3934.8073s
	iters: 300, epoch: 10 | loss: 0.1106153
	speed: 0.1321s/iter; left time: 4395.0607s
Epoch: 10 cost time: 46.978013038635254
Epoch: 10, Steps: 369 | Train Loss: 0.265 Vali Loss: 1.076 Vali Acc: 0.655 Test Loss: 1.076 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3550623
	speed: 0.4128s/iter; left time: 13667.1802s
	iters: 200, epoch: 11 | loss: 0.1663992
	speed: 0.1265s/iter; left time: 4176.6471s
	iters: 300, epoch: 11 | loss: 0.1242202
	speed: 0.1328s/iter; left time: 4369.4313s
Epoch: 11 cost time: 47.680619955062866
Epoch: 11, Steps: 369 | Train Loss: 0.214 Vali Loss: 0.896 Vali Acc: 0.657 Test Loss: 0.896 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.3836116
	speed: 0.4156s/iter; left time: 13606.9685s
	iters: 200, epoch: 12 | loss: 0.0564977
	speed: 0.1125s/iter; left time: 3673.3746s
	iters: 300, epoch: 12 | loss: 0.3608562
	speed: 0.1133s/iter; left time: 3688.4576s
Epoch: 12 cost time: 43.96668028831482
Epoch: 12, Steps: 369 | Train Loss: 0.175 Vali Loss: 1.493 Vali Acc: 0.654 Test Loss: 1.493 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1202496
	speed: 0.3995s/iter; left time: 12932.2549s
	iters: 200, epoch: 13 | loss: 0.0575134
	speed: 0.1244s/iter; left time: 4015.0491s
	iters: 300, epoch: 13 | loss: 0.1222612
	speed: 0.1137s/iter; left time: 3658.7902s
Epoch: 13 cost time: 44.62769055366516
Epoch: 13, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.298 Vali Acc: 0.661 Test Loss: 1.298 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0760431
	speed: 0.3919s/iter; left time: 12542.2408s
	iters: 200, epoch: 14 | loss: 0.4171624
	speed: 0.1153s/iter; left time: 3677.6006s
	iters: 300, epoch: 14 | loss: 0.1416855
	speed: 0.1221s/iter; left time: 3883.6285s
Epoch: 14 cost time: 45.362389087677
Epoch: 14, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.492 Vali Acc: 0.655 Test Loss: 1.492 Test Acc: 0.655
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0366673
	speed: 0.4169s/iter; left time: 13188.8083s
	iters: 200, epoch: 15 | loss: 0.0363497
	speed: 0.1281s/iter; left time: 4040.6552s
	iters: 300, epoch: 15 | loss: 0.2756449
	speed: 0.1133s/iter; left time: 3560.7700s
Epoch: 15 cost time: 45.34181046485901
Epoch: 15, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.484 Vali Acc: 0.662 Test Loss: 1.484 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0990433
	speed: 0.4211s/iter; left time: 13167.1732s
	iters: 200, epoch: 16 | loss: 0.0863700
	speed: 0.1258s/iter; left time: 3920.1614s
	iters: 300, epoch: 16 | loss: 0.0280174
	speed: 0.1372s/iter; left time: 4261.9563s
Epoch: 16 cost time: 50.67620229721069
Epoch: 16, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.495 Vali Acc: 0.657 Test Loss: 1.495 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.4151052
	speed: 0.4426s/iter; left time: 13675.4361s
	iters: 200, epoch: 17 | loss: 0.1184182
	speed: 0.1104s/iter; left time: 3398.6984s
	iters: 300, epoch: 17 | loss: 0.2111657
	speed: 0.1228s/iter; left time: 3770.6246s
Epoch: 17 cost time: 45.27732229232788
Epoch: 17, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.678 Vali Acc: 0.655 Test Loss: 1.678 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0564998
	speed: 0.4087s/iter; left time: 12475.8938s
	iters: 200, epoch: 18 | loss: 0.0456593
	speed: 0.1273s/iter; left time: 3873.8494s
	iters: 300, epoch: 18 | loss: 0.0821224
	speed: 0.1291s/iter; left time: 3916.3158s
Epoch: 18 cost time: 45.95226740837097
Epoch: 18, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.417 Vali Acc: 0.648 Test Loss: 1.417 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6782065834279228
model parameter : 782182
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9327102
	speed: 0.1611s/iter; left time: 5927.1188s
	iters: 200, epoch: 1 | loss: 0.6727945
	speed: 0.1335s/iter; left time: 4898.2226s
	iters: 300, epoch: 1 | loss: 0.9207815
	speed: 0.1105s/iter; left time: 4045.0348s
Epoch: 1 cost time: 48.538421392440796
Epoch: 1, Steps: 369 | Train Loss: 0.933 Vali Loss: 1.127 Vali Acc: 0.594 Test Loss: 1.127 Test Acc: 0.594
Validation loss decreased (inf --> -0.593916).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0550449
	speed: 0.4099s/iter; left time: 14934.2262s
	iters: 200, epoch: 2 | loss: 0.5812865
	speed: 0.1169s/iter; left time: 4246.6621s
	iters: 300, epoch: 2 | loss: 0.6916181
	speed: 0.1290s/iter; left time: 4674.5915s
Epoch: 2 cost time: 45.34732103347778
Epoch: 2, Steps: 369 | Train Loss: 0.864 Vali Loss: 0.778 Vali Acc: 0.657 Test Loss: 0.778 Test Acc: 0.657
Validation loss decreased (-0.593916 --> -0.656916).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2949070
	speed: 0.4353s/iter; left time: 15697.7791s
	iters: 200, epoch: 3 | loss: 0.6071187
	speed: 0.1063s/iter; left time: 3821.7290s
	iters: 300, epoch: 3 | loss: 0.4158721
	speed: 0.1322s/iter; left time: 4742.6112s
Epoch: 3 cost time: 47.31423616409302
Epoch: 3, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.969 Vali Acc: 0.553 Test Loss: 0.969 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5065256
	speed: 0.4625s/iter; left time: 16506.8606s
	iters: 200, epoch: 4 | loss: 0.4960796
	speed: 0.1213s/iter; left time: 4319.0864s
	iters: 300, epoch: 4 | loss: 0.4481729
	speed: 0.1414s/iter; left time: 5018.5665s
Epoch: 4 cost time: 50.09197115898132
Epoch: 4, Steps: 369 | Train Loss: 0.585 Vali Loss: 0.663 Vali Acc: 0.642 Test Loss: 0.663 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5353005
	speed: 0.4598s/iter; left time: 16243.7322s
	iters: 200, epoch: 5 | loss: 0.2884355
	speed: 0.1454s/iter; left time: 5121.7230s
	iters: 300, epoch: 5 | loss: 0.7978146
	speed: 0.1379s/iter; left time: 4845.3761s
Epoch: 5 cost time: 50.35668754577637
Epoch: 5, Steps: 369 | Train Loss: 0.519 Vali Loss: 0.620 Vali Acc: 0.672 Test Loss: 0.620 Test Acc: 0.672
Validation loss decreased (-0.656916 --> -0.671674).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3636687
	speed: 0.3683s/iter; left time: 12874.2721s
	iters: 200, epoch: 6 | loss: 0.2013654
	speed: 0.1173s/iter; left time: 4088.6159s
	iters: 300, epoch: 6 | loss: 0.5836755
	speed: 0.1314s/iter; left time: 4566.3604s
Epoch: 6 cost time: 46.589826583862305
Epoch: 6, Steps: 369 | Train Loss: 0.454 Vali Loss: 0.732 Vali Acc: 0.681 Test Loss: 0.732 Test Acc: 0.681
Validation loss decreased (-0.671674 --> -0.680753).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4316266
	speed: 0.4159s/iter; left time: 14386.4146s
	iters: 200, epoch: 7 | loss: 0.4200305
	speed: 0.1264s/iter; left time: 4359.4857s
	iters: 300, epoch: 7 | loss: 0.3296846
	speed: 0.1127s/iter; left time: 3875.3162s
Epoch: 7 cost time: 44.660799503326416
Epoch: 7, Steps: 369 | Train Loss: 0.423 Vali Loss: 0.759 Vali Acc: 0.649 Test Loss: 0.759 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3853098
	speed: 0.3919s/iter; left time: 13410.7295s
	iters: 200, epoch: 8 | loss: 0.2871465
	speed: 0.1227s/iter; left time: 4185.8265s
	iters: 300, epoch: 8 | loss: 0.2879476
	speed: 0.1121s/iter; left time: 3814.9701s
Epoch: 8 cost time: 43.751442670822144
Epoch: 8, Steps: 369 | Train Loss: 0.359 Vali Loss: 0.872 Vali Acc: 0.669 Test Loss: 0.872 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5227318
	speed: 0.4165s/iter; left time: 14098.0330s
	iters: 200, epoch: 9 | loss: 0.3738951
	speed: 0.1228s/iter; left time: 4144.1585s
	iters: 300, epoch: 9 | loss: 0.3318044
	speed: 0.1179s/iter; left time: 3967.5364s
Epoch: 9 cost time: 43.8126962184906
Epoch: 9, Steps: 369 | Train Loss: 0.314 Vali Loss: 0.900 Vali Acc: 0.646 Test Loss: 0.900 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3465602
	speed: 0.4163s/iter; left time: 13936.4660s
	iters: 200, epoch: 10 | loss: 0.1430092
	speed: 0.1279s/iter; left time: 4270.2201s
	iters: 300, epoch: 10 | loss: 0.2948853
	speed: 0.1297s/iter; left time: 4316.2870s
Epoch: 10 cost time: 47.15953087806702
Epoch: 10, Steps: 369 | Train Loss: 0.282 Vali Loss: 0.928 Vali Acc: 0.669 Test Loss: 0.928 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2873397
	speed: 0.3871s/iter; left time: 12817.2840s
	iters: 200, epoch: 11 | loss: 0.5068361
	speed: 0.0569s/iter; left time: 1879.2142s
	iters: 300, epoch: 11 | loss: 0.1585552
	speed: 0.0599s/iter; left time: 1971.4427s
Epoch: 11 cost time: 25.55216360092163
Epoch: 11, Steps: 369 | Train Loss: 0.239 Vali Loss: 1.173 Vali Acc: 0.661 Test Loss: 1.173 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1695791
	speed: 0.4303s/iter; left time: 14088.1716s
	iters: 200, epoch: 12 | loss: 0.0634396
	speed: 0.1353s/iter; left time: 4417.7206s
	iters: 300, epoch: 12 | loss: 0.9483351
	speed: 0.1367s/iter; left time: 4448.8010s
Epoch: 12 cost time: 50.362112283706665
Epoch: 12, Steps: 369 | Train Loss: 0.199 Vali Loss: 0.951 Vali Acc: 0.660 Test Loss: 0.951 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0249689
	speed: 0.4255s/iter; left time: 13776.2090s
	iters: 200, epoch: 13 | loss: 0.1660047
	speed: 0.1193s/iter; left time: 3849.4102s
	iters: 300, epoch: 13 | loss: 0.4152649
	speed: 0.1270s/iter; left time: 4086.9546s
Epoch: 13 cost time: 44.526270151138306
Epoch: 13, Steps: 369 | Train Loss: 0.163 Vali Loss: 1.459 Vali Acc: 0.647 Test Loss: 1.459 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1276395
	speed: 0.4199s/iter; left time: 13439.5271s
	iters: 200, epoch: 14 | loss: 0.3661051
	speed: 0.1058s/iter; left time: 3375.7830s
	iters: 300, epoch: 14 | loss: 0.1213471
	speed: 0.1090s/iter; left time: 3465.6369s
Epoch: 14 cost time: 42.41269874572754
Epoch: 14, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.325 Vali Acc: 0.663 Test Loss: 1.325 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1944292
	speed: 0.3946s/iter; left time: 12482.0490s
	iters: 200, epoch: 15 | loss: 0.0543788
	speed: 0.1115s/iter; left time: 3515.8471s
	iters: 300, epoch: 15 | loss: 0.0325402
	speed: 0.1163s/iter; left time: 3656.5142s
Epoch: 15 cost time: 44.1018431186676
Epoch: 15, Steps: 369 | Train Loss: 0.119 Vali Loss: 2.037 Vali Acc: 0.647 Test Loss: 2.037 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0384793
	speed: 0.4025s/iter; left time: 12585.7981s
	iters: 200, epoch: 16 | loss: 0.0870319
	speed: 0.1176s/iter; left time: 3665.1016s
	iters: 300, epoch: 16 | loss: 0.0295888
	speed: 0.1215s/iter; left time: 3773.6755s
Epoch: 16 cost time: 43.293315172195435
Epoch: 16, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.585 Vali Acc: 0.651 Test Loss: 1.585 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6807604994324631
model parameter : 781606
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7718438
	speed: 0.1524s/iter; left time: 5608.8474s
	iters: 200, epoch: 1 | loss: 0.3049096
	speed: 0.0977s/iter; left time: 3586.2658s
	iters: 300, epoch: 1 | loss: 0.8252792
	speed: 0.1166s/iter; left time: 4269.3354s
Epoch: 1 cost time: 44.50581336021423
Epoch: 1, Steps: 369 | Train Loss: 0.804 Vali Loss: 1.657 Vali Acc: 0.530 Test Loss: 1.657 Test Acc: 0.530
Validation loss decreased (inf --> -0.530347).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0092897
	speed: 0.4016s/iter; left time: 14629.2862s
	iters: 200, epoch: 2 | loss: 0.2734374
	speed: 0.1208s/iter; left time: 4388.0590s
	iters: 300, epoch: 2 | loss: 1.4962251
	speed: 0.1410s/iter; left time: 5107.7421s
Epoch: 2 cost time: 47.116583585739136
Epoch: 2, Steps: 369 | Train Loss: 0.809 Vali Loss: 0.655 Vali Acc: 0.661 Test Loss: 0.655 Test Acc: 0.661
Validation loss decreased (-0.530347 --> -0.661458).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6598200
	speed: 0.3753s/iter; left time: 13535.9850s
	iters: 200, epoch: 3 | loss: 0.7392640
	speed: 0.1171s/iter; left time: 4212.1024s
	iters: 300, epoch: 3 | loss: 1.2054495
	speed: 0.1124s/iter; left time: 4031.0866s
Epoch: 3 cost time: 41.76943302154541
Epoch: 3, Steps: 369 | Train Loss: 0.723 Vali Loss: 1.406 Vali Acc: 0.512 Test Loss: 1.406 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6769720
	speed: 0.3898s/iter; left time: 13914.7529s
	iters: 200, epoch: 4 | loss: 0.6061194
	speed: 0.1199s/iter; left time: 4266.9309s
	iters: 300, epoch: 4 | loss: 0.3431877
	speed: 0.0906s/iter; left time: 3214.1734s
Epoch: 4 cost time: 39.07851243019104
Epoch: 4, Steps: 369 | Train Loss: 0.588 Vali Loss: 0.709 Vali Acc: 0.648 Test Loss: 0.709 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3571965
	speed: 0.2624s/iter; left time: 9270.1374s
	iters: 200, epoch: 5 | loss: 0.6061567
	speed: 0.0949s/iter; left time: 3341.9053s
	iters: 300, epoch: 5 | loss: 0.5310356
	speed: 0.1117s/iter; left time: 3923.1035s
Epoch: 5 cost time: 35.09725475311279
Epoch: 5, Steps: 369 | Train Loss: 0.505 Vali Loss: 0.651 Vali Acc: 0.649 Test Loss: 0.651 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.4914586
	speed: 0.3980s/iter; left time: 13912.8309s
	iters: 200, epoch: 6 | loss: 0.2903797
	speed: 0.1168s/iter; left time: 4071.7808s
	iters: 300, epoch: 6 | loss: 0.2079360
	speed: 0.1200s/iter; left time: 4170.0493s
Epoch: 6 cost time: 44.50843524932861
Epoch: 6, Steps: 369 | Train Loss: 0.442 Vali Loss: 0.744 Vali Acc: 0.646 Test Loss: 0.744 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.5927336
	speed: 0.4017s/iter; left time: 13892.5616s
	iters: 200, epoch: 7 | loss: 0.4634959
	speed: 0.1039s/iter; left time: 3582.6518s
	iters: 300, epoch: 7 | loss: 0.3031406
	speed: 0.1124s/iter; left time: 3866.4370s
Epoch: 7 cost time: 43.474072217941284
Epoch: 7, Steps: 369 | Train Loss: 0.395 Vali Loss: 0.675 Vali Acc: 0.675 Test Loss: 0.675 Test Acc: 0.675
Validation loss decreased (-0.661458 --> -0.674511).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2398571
	speed: 0.4091s/iter; left time: 13998.1934s
	iters: 200, epoch: 8 | loss: 0.3604037
	speed: 0.1316s/iter; left time: 4490.4706s
	iters: 300, epoch: 8 | loss: 0.4017858
	speed: 0.1225s/iter; left time: 4168.5515s
Epoch: 8 cost time: 46.381486892700195
Epoch: 8, Steps: 369 | Train Loss: 0.340 Vali Loss: 0.836 Vali Acc: 0.659 Test Loss: 0.836 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0799078
	speed: 0.4258s/iter; left time: 14412.8378s
	iters: 200, epoch: 9 | loss: 0.3918260
	speed: 0.1215s/iter; left time: 4099.7950s
	iters: 300, epoch: 9 | loss: 0.3221081
	speed: 0.1097s/iter; left time: 3691.0676s
Epoch: 9 cost time: 45.10097050666809
Epoch: 9, Steps: 369 | Train Loss: 0.292 Vali Loss: 0.884 Vali Acc: 0.663 Test Loss: 0.884 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2580082
	speed: 0.3945s/iter; left time: 13208.8630s
	iters: 200, epoch: 10 | loss: 0.2166216
	speed: 0.1198s/iter; left time: 4000.4000s
	iters: 300, epoch: 10 | loss: 0.0401916
	speed: 0.0877s/iter; left time: 2919.0473s
Epoch: 10 cost time: 39.3825101852417
Epoch: 10, Steps: 369 | Train Loss: 0.246 Vali Loss: 0.986 Vali Acc: 0.652 Test Loss: 0.986 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0474221
	speed: 0.3713s/iter; left time: 12293.1703s
	iters: 200, epoch: 11 | loss: 0.4340772
	speed: 0.1075s/iter; left time: 3547.9842s
	iters: 300, epoch: 11 | loss: 0.0548913
	speed: 0.1280s/iter; left time: 4213.2491s
Epoch: 11 cost time: 44.8066508769989
Epoch: 11, Steps: 369 | Train Loss: 0.196 Vali Loss: 1.008 Vali Acc: 0.666 Test Loss: 1.008 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1366806
	speed: 0.3905s/iter; left time: 12786.5870s
	iters: 200, epoch: 12 | loss: 0.1498461
	speed: 0.1104s/iter; left time: 3602.5665s
	iters: 300, epoch: 12 | loss: 0.2282402
	speed: 0.1182s/iter; left time: 3847.9826s
Epoch: 12 cost time: 42.48883271217346
Epoch: 12, Steps: 369 | Train Loss: 0.162 Vali Loss: 1.153 Vali Acc: 0.663 Test Loss: 1.153 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0033850
	speed: 0.3878s/iter; left time: 12552.6390s
	iters: 200, epoch: 13 | loss: 0.0519441
	speed: 0.1228s/iter; left time: 3964.0351s
	iters: 300, epoch: 13 | loss: 0.2909466
	speed: 0.1171s/iter; left time: 3767.4519s
Epoch: 13 cost time: 44.80245494842529
Epoch: 13, Steps: 369 | Train Loss: 0.141 Vali Loss: 1.621 Vali Acc: 0.651 Test Loss: 1.621 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.2101137
	speed: 0.3912s/iter; left time: 12519.8202s
	iters: 200, epoch: 14 | loss: 0.1510239
	speed: 0.1183s/iter; left time: 3772.7287s
	iters: 300, epoch: 14 | loss: 0.2807687
	speed: 0.1125s/iter; left time: 3579.0772s
Epoch: 14 cost time: 41.18679356575012
Epoch: 14, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.284 Vali Acc: 0.654 Test Loss: 1.284 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0250871
	speed: 0.3249s/iter; left time: 10278.4036s
	iters: 200, epoch: 15 | loss: 0.0640918
	speed: 0.1434s/iter; left time: 4521.8074s
	iters: 300, epoch: 15 | loss: 0.0799600
	speed: 0.1272s/iter; left time: 3999.0165s
Epoch: 15 cost time: 44.57207894325256
Epoch: 15, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.554 Vali Acc: 0.653 Test Loss: 1.554 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0004700
	speed: 0.4095s/iter; left time: 12803.9272s
	iters: 200, epoch: 16 | loss: 0.0730811
	speed: 0.1222s/iter; left time: 3807.3790s
	iters: 300, epoch: 16 | loss: 0.0471950
	speed: 0.1126s/iter; left time: 3496.7216s
Epoch: 16 cost time: 44.963040828704834
Epoch: 16, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.487 Vali Acc: 0.660 Test Loss: 1.487 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0035264
	speed: 0.4109s/iter; left time: 12696.3433s
	iters: 200, epoch: 17 | loss: 0.1375626
	speed: 0.1197s/iter; left time: 3686.7139s
	iters: 300, epoch: 17 | loss: 0.2125677
	speed: 0.0984s/iter; left time: 3021.8823s
Epoch: 17 cost time: 43.934861183166504
Epoch: 17, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.771 Vali Acc: 0.652 Test Loss: 1.771 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6745175936435869
model parameter : 618214
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9531559
	speed: 0.1447s/iter; left time: 5324.0299s
	iters: 200, epoch: 1 | loss: 0.7142739
	speed: 0.1115s/iter; left time: 4093.0661s
	iters: 300, epoch: 1 | loss: 0.8987201
	speed: 0.1310s/iter; left time: 4796.5295s
Epoch: 1 cost time: 46.440083265304565
Epoch: 1, Steps: 369 | Train Loss: 0.908 Vali Loss: 0.896 Vali Acc: 0.642 Test Loss: 0.896 Test Acc: 0.642
Validation loss decreased (inf --> -0.642443).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6777053
	speed: 0.4008s/iter; left time: 14602.7476s
	iters: 200, epoch: 2 | loss: 0.5611778
	speed: 0.1098s/iter; left time: 3989.6102s
	iters: 300, epoch: 2 | loss: 1.4711405
	speed: 0.1100s/iter; left time: 3985.8516s
Epoch: 2 cost time: 41.926544427871704
Epoch: 2, Steps: 369 | Train Loss: 0.788 Vali Loss: 0.698 Vali Acc: 0.630 Test Loss: 0.698 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9245198
	speed: 0.4015s/iter; left time: 14480.3844s
	iters: 200, epoch: 3 | loss: 0.7582785
	speed: 0.1189s/iter; left time: 4275.0199s
	iters: 300, epoch: 3 | loss: 0.7099828
	speed: 0.1186s/iter; left time: 4254.4395s
Epoch: 3 cost time: 44.08467626571655
Epoch: 3, Steps: 369 | Train Loss: 0.635 Vali Loss: 1.353 Vali Acc: 0.551 Test Loss: 1.353 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5415301
	speed: 0.4098s/iter; left time: 14628.9500s
	iters: 200, epoch: 4 | loss: 0.6277213
	speed: 0.1169s/iter; left time: 4161.6635s
	iters: 300, epoch: 4 | loss: 0.8361760
	speed: 0.1294s/iter; left time: 4592.9474s
Epoch: 4 cost time: 47.12993240356445
Epoch: 4, Steps: 369 | Train Loss: 0.579 Vali Loss: 0.844 Vali Acc: 0.587 Test Loss: 0.844 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6419415
	speed: 0.4369s/iter; left time: 15434.6175s
	iters: 200, epoch: 5 | loss: 0.5018393
	speed: 0.1269s/iter; left time: 4471.2573s
	iters: 300, epoch: 5 | loss: 0.4137671
	speed: 0.1191s/iter; left time: 4183.4060s
Epoch: 5 cost time: 46.47924518585205
Epoch: 5, Steps: 369 | Train Loss: 0.495 Vali Loss: 0.729 Vali Acc: 0.648 Test Loss: 0.729 Test Acc: 0.648
Validation loss decreased (-0.642443 --> -0.648404).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5304977
	speed: 0.4333s/iter; left time: 15145.5507s
	iters: 200, epoch: 6 | loss: 0.7743710
	speed: 0.1325s/iter; left time: 4617.2028s
	iters: 300, epoch: 6 | loss: 0.6503466
	speed: 0.1185s/iter; left time: 4117.1268s
Epoch: 6 cost time: 44.509061336517334
Epoch: 6, Steps: 369 | Train Loss: 0.449 Vali Loss: 0.639 Vali Acc: 0.677 Test Loss: 0.639 Test Acc: 0.677
Validation loss decreased (-0.648404 --> -0.676781).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1551733
	speed: 0.3606s/iter; left time: 12471.5089s
	iters: 200, epoch: 7 | loss: 0.2203825
	speed: 0.0730s/iter; left time: 2517.9307s
	iters: 300, epoch: 7 | loss: 0.2761657
	speed: 0.0627s/iter; left time: 2157.6426s
Epoch: 7 cost time: 28.702558040618896
Epoch: 7, Steps: 369 | Train Loss: 0.380 Vali Loss: 0.833 Vali Acc: 0.642 Test Loss: 0.833 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2028261
	speed: 0.3737s/iter; left time: 12786.1767s
	iters: 200, epoch: 8 | loss: 0.1578704
	speed: 0.1305s/iter; left time: 4452.8494s
	iters: 300, epoch: 8 | loss: 0.2090595
	speed: 0.1170s/iter; left time: 3979.4204s
Epoch: 8 cost time: 46.613282680511475
Epoch: 8, Steps: 369 | Train Loss: 0.333 Vali Loss: 1.011 Vali Acc: 0.625 Test Loss: 1.011 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1143428
	speed: 0.3955s/iter; left time: 13387.8668s
	iters: 200, epoch: 9 | loss: 0.0632241
	speed: 0.1254s/iter; left time: 4233.4901s
	iters: 300, epoch: 9 | loss: 0.2624961
	speed: 0.1178s/iter; left time: 3964.7068s
Epoch: 9 cost time: 45.05093955993652
Epoch: 9, Steps: 369 | Train Loss: 0.287 Vali Loss: 0.944 Vali Acc: 0.663 Test Loss: 0.944 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1499015
	speed: 0.4014s/iter; left time: 13437.8246s
	iters: 200, epoch: 10 | loss: 0.2117613
	speed: 0.1153s/iter; left time: 3850.2762s
	iters: 300, epoch: 10 | loss: 0.3905197
	speed: 0.1163s/iter; left time: 3869.9047s
Epoch: 10 cost time: 43.75591540336609
Epoch: 10, Steps: 369 | Train Loss: 0.241 Vali Loss: 1.109 Vali Acc: 0.659 Test Loss: 1.109 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4991589
	speed: 0.4387s/iter; left time: 14527.3018s
	iters: 200, epoch: 11 | loss: 0.0622334
	speed: 0.1427s/iter; left time: 4712.2661s
	iters: 300, epoch: 11 | loss: 0.2190071
	speed: 0.1309s/iter; left time: 4309.5232s
Epoch: 11 cost time: 50.88223361968994
Epoch: 11, Steps: 369 | Train Loss: 0.200 Vali Loss: 0.977 Vali Acc: 0.648 Test Loss: 0.977 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0775071
	speed: 0.4508s/iter; left time: 14760.5666s
	iters: 200, epoch: 12 | loss: 0.1318432
	speed: 0.1416s/iter; left time: 4621.1124s
	iters: 300, epoch: 12 | loss: 0.1810519
	speed: 0.1018s/iter; left time: 3313.1259s
Epoch: 12 cost time: 46.881348609924316
Epoch: 12, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.262 Vali Acc: 0.649 Test Loss: 1.262 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2462755
	speed: 0.4142s/iter; left time: 13410.3702s
	iters: 200, epoch: 13 | loss: 0.5024205
	speed: 0.1242s/iter; left time: 4007.2713s
	iters: 300, epoch: 13 | loss: 0.8042963
	speed: 0.1099s/iter; left time: 3536.5650s
Epoch: 13 cost time: 43.991676568984985
Epoch: 13, Steps: 369 | Train Loss: 0.154 Vali Loss: 1.422 Vali Acc: 0.651 Test Loss: 1.422 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0980112
	speed: 0.4041s/iter; left time: 12933.0440s
	iters: 200, epoch: 14 | loss: 0.0110261
	speed: 0.1151s/iter; left time: 3673.2619s
	iters: 300, epoch: 14 | loss: 0.2880787
	speed: 0.1210s/iter; left time: 3849.4049s
Epoch: 14 cost time: 45.23098397254944
Epoch: 14, Steps: 369 | Train Loss: 0.129 Vali Loss: 1.213 Vali Acc: 0.656 Test Loss: 1.213 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0349133
	speed: 0.4174s/iter; left time: 13203.9652s
	iters: 200, epoch: 15 | loss: 0.0533604
	speed: 0.1254s/iter; left time: 3953.8186s
	iters: 300, epoch: 15 | loss: 0.0450970
	speed: 0.1159s/iter; left time: 3642.4349s
Epoch: 15 cost time: 44.85931968688965
Epoch: 15, Steps: 369 | Train Loss: 0.121 Vali Loss: 1.555 Vali Acc: 0.666 Test Loss: 1.555 Test Acc: 0.666
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0335745
	speed: 0.4142s/iter; left time: 12948.8503s
	iters: 200, epoch: 16 | loss: 0.0028778
	speed: 0.1295s/iter; left time: 4037.2028s
	iters: 300, epoch: 16 | loss: 0.0495315
	speed: 0.1228s/iter; left time: 3814.2189s
Epoch: 16 cost time: 44.48961400985718
Epoch: 16, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.433 Vali Acc: 0.645 Test Loss: 1.433 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6767877412031782
model parameter : 617638
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7658800
	speed: 0.1555s/iter; left time: 5722.6777s
	iters: 200, epoch: 1 | loss: 1.1156386
	speed: 0.1299s/iter; left time: 4767.0455s
	iters: 300, epoch: 1 | loss: 0.1733803
	speed: 0.1312s/iter; left time: 4803.8737s
Epoch: 1 cost time: 51.59865617752075
Epoch: 1, Steps: 369 | Train Loss: 0.891 Vali Loss: 1.017 Vali Acc: 0.591 Test Loss: 1.017 Test Acc: 0.591
Validation loss decreased (inf --> -0.590796).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8571911
	speed: 0.4233s/iter; left time: 15422.3936s
	iters: 200, epoch: 2 | loss: 1.0624212
	speed: 0.1310s/iter; left time: 4758.2100s
	iters: 300, epoch: 2 | loss: 0.3898116
	speed: 0.1326s/iter; left time: 4803.0509s
Epoch: 2 cost time: 47.39760398864746
Epoch: 2, Steps: 369 | Train Loss: 0.800 Vali Loss: 0.724 Vali Acc: 0.638 Test Loss: 0.724 Test Acc: 0.638
Validation loss decreased (-0.590796 --> -0.637904).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7673429
	speed: 0.4000s/iter; left time: 14423.5646s
	iters: 200, epoch: 3 | loss: 0.7391465
	speed: 0.1129s/iter; left time: 4060.0349s
	iters: 300, epoch: 3 | loss: 0.3385638
	speed: 0.1140s/iter; left time: 4087.0884s
Epoch: 3 cost time: 44.117955684661865
Epoch: 3, Steps: 369 | Train Loss: 0.633 Vali Loss: 0.809 Vali Acc: 0.590 Test Loss: 0.809 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7752457
	speed: 0.4074s/iter; left time: 14542.8480s
	iters: 200, epoch: 4 | loss: 0.5314769
	speed: 0.0878s/iter; left time: 3123.8238s
	iters: 300, epoch: 4 | loss: 0.2752472
	speed: 0.1107s/iter; left time: 3927.4295s
Epoch: 4 cost time: 42.573527097702026
Epoch: 4, Steps: 369 | Train Loss: 0.553 Vali Loss: 0.719 Vali Acc: 0.655 Test Loss: 0.719 Test Acc: 0.655
Validation loss decreased (-0.637904 --> -0.654930).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4080223
	speed: 0.3805s/iter; left time: 13442.1235s
	iters: 200, epoch: 5 | loss: 0.4025095
	speed: 0.1232s/iter; left time: 4339.9959s
	iters: 300, epoch: 5 | loss: 0.7759232
	speed: 0.1308s/iter; left time: 4595.1030s
Epoch: 5 cost time: 45.31740379333496
Epoch: 5, Steps: 369 | Train Loss: 0.482 Vali Loss: 0.631 Vali Acc: 0.679 Test Loss: 0.631 Test Acc: 0.679
Validation loss decreased (-0.654930 --> -0.679052).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4820520
	speed: 0.3963s/iter; left time: 13852.9453s
	iters: 200, epoch: 6 | loss: 0.4710160
	speed: 0.1216s/iter; left time: 4239.2140s
	iters: 300, epoch: 6 | loss: 0.4306719
	speed: 0.1035s/iter; left time: 3597.6400s
Epoch: 6 cost time: 41.83522033691406
Epoch: 6, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.698 Vali Acc: 0.665 Test Loss: 0.698 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6717253
	speed: 0.4010s/iter; left time: 13868.0080s
	iters: 200, epoch: 7 | loss: 0.0814196
	speed: 0.1168s/iter; left time: 4026.4680s
	iters: 300, epoch: 7 | loss: 0.2944403
	speed: 0.1299s/iter; left time: 4467.6778s
Epoch: 7 cost time: 47.582109451293945
Epoch: 7, Steps: 369 | Train Loss: 0.387 Vali Loss: 0.681 Vali Acc: 0.653 Test Loss: 0.681 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3842452
	speed: 0.4280s/iter; left time: 14646.5442s
	iters: 200, epoch: 8 | loss: 0.4946395
	speed: 0.1286s/iter; left time: 4386.7791s
	iters: 300, epoch: 8 | loss: 0.3764265
	speed: 0.1395s/iter; left time: 4745.8963s
Epoch: 8 cost time: 47.93540978431702
Epoch: 8, Steps: 369 | Train Loss: 0.329 Vali Loss: 0.762 Vali Acc: 0.655 Test Loss: 0.762 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1562053
	speed: 0.4197s/iter; left time: 14206.6175s
	iters: 200, epoch: 9 | loss: 0.2070483
	speed: 0.1273s/iter; left time: 4297.7575s
	iters: 300, epoch: 9 | loss: 0.1659694
	speed: 0.1208s/iter; left time: 4065.7679s
Epoch: 9 cost time: 47.55228281021118
Epoch: 9, Steps: 369 | Train Loss: 0.284 Vali Loss: 0.882 Vali Acc: 0.658 Test Loss: 0.882 Test Acc: 0.658
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0614600
	speed: 0.3917s/iter; left time: 13114.1361s
	iters: 200, epoch: 10 | loss: 0.0808840
	speed: 0.1152s/iter; left time: 3845.6359s
	iters: 300, epoch: 10 | loss: 0.2436721
	speed: 0.1223s/iter; left time: 4070.9821s
Epoch: 10 cost time: 45.21658897399902
Epoch: 10, Steps: 369 | Train Loss: 0.234 Vali Loss: 1.006 Vali Acc: 0.658 Test Loss: 1.006 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0293543
	speed: 0.3877s/iter; left time: 12837.6663s
	iters: 200, epoch: 11 | loss: 0.2357859
	speed: 0.0655s/iter; left time: 2161.8816s
	iters: 300, epoch: 11 | loss: 0.3134677
	speed: 0.0667s/iter; left time: 2195.0108s
Epoch: 11 cost time: 29.70605707168579
Epoch: 11, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.655 Vali Acc: 0.645 Test Loss: 1.655 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1894721
	speed: 0.3718s/iter; left time: 12174.8858s
	iters: 200, epoch: 12 | loss: 0.0657851
	speed: 0.1163s/iter; left time: 3796.5700s
	iters: 300, epoch: 12 | loss: 0.2704552
	speed: 0.1435s/iter; left time: 4669.2768s
Epoch: 12 cost time: 47.07774233818054
Epoch: 12, Steps: 369 | Train Loss: 0.172 Vali Loss: 1.238 Vali Acc: 0.633 Test Loss: 1.238 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1986850
	speed: 0.3868s/iter; left time: 12522.7804s
	iters: 200, epoch: 13 | loss: 0.0678026
	speed: 0.1117s/iter; left time: 3606.4212s
	iters: 300, epoch: 13 | loss: 0.0400991
	speed: 0.1247s/iter; left time: 4013.4039s
Epoch: 13 cost time: 43.49866342544556
Epoch: 13, Steps: 369 | Train Loss: 0.134 Vali Loss: 1.261 Vali Acc: 0.653 Test Loss: 1.261 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0497282
	speed: 0.3908s/iter; left time: 12508.5624s
	iters: 200, epoch: 14 | loss: 0.1590654
	speed: 0.1198s/iter; left time: 3822.9365s
	iters: 300, epoch: 14 | loss: 0.1646906
	speed: 0.1524s/iter; left time: 4848.1603s
Epoch: 14 cost time: 48.98958492279053
Epoch: 14, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.426 Vali Acc: 0.640 Test Loss: 1.426 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0845181
	speed: 0.4308s/iter; left time: 13629.0819s
	iters: 200, epoch: 15 | loss: 0.1340414
	speed: 0.1125s/iter; left time: 3546.3269s
	iters: 300, epoch: 15 | loss: 0.1788436
	speed: 0.1380s/iter; left time: 4336.6091s
Epoch: 15 cost time: 46.74413466453552
Epoch: 15, Steps: 369 | Train Loss: 0.105 Vali Loss: 1.495 Vali Acc: 0.653 Test Loss: 1.495 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6790578887627696
model parameter : 617062
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6679437
	speed: 0.1519s/iter; left time: 5589.3944s
	iters: 200, epoch: 1 | loss: 1.6808048
	speed: 0.1091s/iter; left time: 4004.9241s
	iters: 300, epoch: 1 | loss: 1.1611387
	speed: 0.1307s/iter; left time: 4785.2557s
Epoch: 1 cost time: 46.78525161743164
Epoch: 1, Steps: 369 | Train Loss: 0.983 Vali Loss: 0.991 Vali Acc: 0.635 Test Loss: 0.991 Test Acc: 0.635
Validation loss decreased (inf --> -0.635348).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8779691
	speed: 0.4098s/iter; left time: 14930.2395s
	iters: 200, epoch: 2 | loss: 0.1733243
	speed: 0.1149s/iter; left time: 4174.3443s
	iters: 300, epoch: 2 | loss: 1.0696810
	speed: 0.1264s/iter; left time: 4579.7683s
Epoch: 2 cost time: 45.084214210510254
Epoch: 2, Steps: 369 | Train Loss: 0.871 Vali Loss: 0.923 Vali Acc: 0.596 Test Loss: 0.923 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5823824
	speed: 0.3771s/iter; left time: 13599.3710s
	iters: 200, epoch: 3 | loss: 0.9142373
	speed: 0.1151s/iter; left time: 4141.0931s
	iters: 300, epoch: 3 | loss: 0.3361834
	speed: 0.1256s/iter; left time: 4504.8710s
Epoch: 3 cost time: 43.25374460220337
Epoch: 3, Steps: 369 | Train Loss: 0.637 Vali Loss: 1.237 Vali Acc: 0.541 Test Loss: 1.237 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4299187
	speed: 0.4037s/iter; left time: 14410.8624s
	iters: 200, epoch: 4 | loss: 0.4624061
	speed: 0.1057s/iter; left time: 3763.7562s
	iters: 300, epoch: 4 | loss: 0.5595058
	speed: 0.1214s/iter; left time: 4309.2423s
Epoch: 4 cost time: 44.358471393585205
Epoch: 4, Steps: 369 | Train Loss: 0.551 Vali Loss: 0.699 Vali Acc: 0.659 Test Loss: 0.699 Test Acc: 0.659
Validation loss decreased (-0.635348 --> -0.658903).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1539216
	speed: 0.4180s/iter; left time: 14765.8875s
	iters: 200, epoch: 5 | loss: 0.2810355
	speed: 0.1184s/iter; left time: 4169.9292s
	iters: 300, epoch: 5 | loss: 0.6794496
	speed: 0.1392s/iter; left time: 4890.3785s
Epoch: 5 cost time: 46.70028209686279
Epoch: 5, Steps: 369 | Train Loss: 0.476 Vali Loss: 0.651 Vali Acc: 0.681 Test Loss: 0.651 Test Acc: 0.681
Validation loss decreased (-0.658903 --> -0.681322).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2060342
	speed: 0.4184s/iter; left time: 14624.1941s
	iters: 200, epoch: 6 | loss: 0.5248221
	speed: 0.1308s/iter; left time: 4559.2684s
	iters: 300, epoch: 6 | loss: 0.3858294
	speed: 0.1283s/iter; left time: 4459.5024s
Epoch: 6 cost time: 47.509361267089844
Epoch: 6, Steps: 369 | Train Loss: 0.422 Vali Loss: 0.745 Vali Acc: 0.667 Test Loss: 0.745 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3642190
	speed: 0.3881s/iter; left time: 13423.5482s
	iters: 200, epoch: 7 | loss: 0.1247225
	speed: 0.0665s/iter; left time: 2293.7250s
	iters: 300, epoch: 7 | loss: 0.3748902
	speed: 0.0602s/iter; left time: 2071.1318s
Epoch: 7 cost time: 29.189743518829346
Epoch: 7, Steps: 369 | Train Loss: 0.369 Vali Loss: 0.831 Vali Acc: 0.652 Test Loss: 0.831 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1970899
	speed: 0.3798s/iter; left time: 12994.3581s
	iters: 200, epoch: 8 | loss: 0.3102370
	speed: 0.1194s/iter; left time: 4075.2269s
	iters: 300, epoch: 8 | loss: 0.1423788
	speed: 0.1144s/iter; left time: 3891.5677s
Epoch: 8 cost time: 42.81835722923279
Epoch: 8, Steps: 369 | Train Loss: 0.330 Vali Loss: 0.798 Vali Acc: 0.654 Test Loss: 0.798 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1533550
	speed: 0.4092s/iter; left time: 13851.9818s
	iters: 200, epoch: 9 | loss: 0.1780066
	speed: 0.1227s/iter; left time: 4140.7689s
	iters: 300, epoch: 9 | loss: 0.3875766
	speed: 0.1064s/iter; left time: 3581.3538s
Epoch: 9 cost time: 44.62081217765808
Epoch: 9, Steps: 369 | Train Loss: 0.267 Vali Loss: 0.907 Vali Acc: 0.650 Test Loss: 0.907 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1680778
	speed: 0.4100s/iter; left time: 13725.4425s
	iters: 200, epoch: 10 | loss: 0.3069139
	speed: 0.1254s/iter; left time: 4186.4846s
	iters: 300, epoch: 10 | loss: 0.5985602
	speed: 0.1211s/iter; left time: 4031.3522s
Epoch: 10 cost time: 46.652021169662476
Epoch: 10, Steps: 369 | Train Loss: 0.237 Vali Loss: 1.139 Vali Acc: 0.660 Test Loss: 1.139 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.7139026
	speed: 0.3970s/iter; left time: 13143.5801s
	iters: 200, epoch: 11 | loss: 0.1790200
	speed: 0.1184s/iter; left time: 3907.6974s
	iters: 300, epoch: 11 | loss: 0.0394369
	speed: 0.1135s/iter; left time: 3737.0315s
Epoch: 11 cost time: 41.54865765571594
Epoch: 11, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.182 Vali Acc: 0.653 Test Loss: 1.182 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1278696
	speed: 0.3888s/iter; left time: 12730.5442s
	iters: 200, epoch: 12 | loss: 0.0365050
	speed: 0.1167s/iter; left time: 3807.9302s
	iters: 300, epoch: 12 | loss: 0.0416345
	speed: 0.1254s/iter; left time: 4080.3771s
Epoch: 12 cost time: 45.09883213043213
Epoch: 12, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.232 Vali Acc: 0.657 Test Loss: 1.232 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0313390
	speed: 0.4434s/iter; left time: 14352.9192s
	iters: 200, epoch: 13 | loss: 0.2501676
	speed: 0.1262s/iter; left time: 4071.4971s
	iters: 300, epoch: 13 | loss: 0.1690934
	speed: 0.1248s/iter; left time: 4016.2355s
Epoch: 13 cost time: 46.49369931221008
Epoch: 13, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.423 Vali Acc: 0.659 Test Loss: 1.423 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1038533
	speed: 0.4263s/iter; left time: 13643.9663s
	iters: 200, epoch: 14 | loss: 0.0217030
	speed: 0.1232s/iter; left time: 3929.9180s
	iters: 300, epoch: 14 | loss: 0.0375114
	speed: 0.1176s/iter; left time: 3740.6519s
Epoch: 14 cost time: 45.50290513038635
Epoch: 14, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.402 Vali Acc: 0.657 Test Loss: 1.402 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1545758
	speed: 0.3959s/iter; left time: 12525.5973s
	iters: 200, epoch: 15 | loss: 0.0236706
	speed: 0.1142s/iter; left time: 3599.8989s
	iters: 300, epoch: 15 | loss: 0.1230886
	speed: 0.1302s/iter; left time: 4091.5111s
Epoch: 15 cost time: 45.06266522407532
Epoch: 15, Steps: 369 | Train Loss: 0.122 Vali Loss: 1.681 Vali Acc: 0.650 Test Loss: 1.681 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6813280363223609
model parameter : 616486
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2274119
	speed: 0.1273s/iter; left time: 4683.8618s
	iters: 200, epoch: 1 | loss: 0.7117953
	speed: 0.1177s/iter; left time: 4320.4366s
	iters: 300, epoch: 1 | loss: 0.6676631
	speed: 0.1268s/iter; left time: 4642.5602s
Epoch: 1 cost time: 45.35720157623291
Epoch: 1, Steps: 369 | Train Loss: 0.888 Vali Loss: 0.677 Vali Acc: 0.654 Test Loss: 0.677 Test Acc: 0.654
Validation loss decreased (inf --> -0.653796).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3632489
	speed: 0.3890s/iter; left time: 14173.8383s
	iters: 200, epoch: 2 | loss: 0.6691906
	speed: 0.1123s/iter; left time: 4081.5713s
	iters: 300, epoch: 2 | loss: 0.6008765
	speed: 0.0869s/iter; left time: 3149.4434s
Epoch: 2 cost time: 37.31323957443237
Epoch: 2, Steps: 369 | Train Loss: 0.894 Vali Loss: 0.654 Vali Acc: 0.664 Test Loss: 0.654 Test Acc: 0.664
Validation loss decreased (-0.653796 --> -0.664295).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9149855
	speed: 0.2901s/iter; left time: 10462.5488s
	iters: 200, epoch: 3 | loss: 1.0955529
	speed: 0.1199s/iter; left time: 4312.3383s
	iters: 300, epoch: 3 | loss: 0.7211567
	speed: 0.1310s/iter; left time: 4697.6567s
Epoch: 3 cost time: 44.94800662994385
Epoch: 3, Steps: 369 | Train Loss: 0.683 Vali Loss: 0.770 Vali Acc: 0.631 Test Loss: 0.770 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8227677
	speed: 0.3996s/iter; left time: 14262.4666s
	iters: 200, epoch: 4 | loss: 0.8144733
	speed: 0.1217s/iter; left time: 4330.1196s
	iters: 300, epoch: 4 | loss: 0.3889779
	speed: 0.1257s/iter; left time: 4460.8566s
Epoch: 4 cost time: 45.74155259132385
Epoch: 4, Steps: 369 | Train Loss: 0.573 Vali Loss: 0.636 Vali Acc: 0.676 Test Loss: 0.636 Test Acc: 0.676
Validation loss decreased (-0.664295 --> -0.675930).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6481966
	speed: 0.4330s/iter; left time: 15294.5236s
	iters: 200, epoch: 5 | loss: 0.3519673
	speed: 0.1528s/iter; left time: 5381.6438s
	iters: 300, epoch: 5 | loss: 0.7400494
	speed: 0.1030s/iter; left time: 3619.3296s
Epoch: 5 cost time: 47.73440384864807
Epoch: 5, Steps: 369 | Train Loss: 0.492 Vali Loss: 0.625 Vali Acc: 0.675 Test Loss: 0.625 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6380155
	speed: 0.3922s/iter; left time: 13709.7105s
	iters: 200, epoch: 6 | loss: 0.4999968
	speed: 0.1203s/iter; left time: 4193.6693s
	iters: 300, epoch: 6 | loss: 0.6688622
	speed: 0.1019s/iter; left time: 3541.5571s
Epoch: 6 cost time: 43.69188666343689
Epoch: 6, Steps: 369 | Train Loss: 0.425 Vali Loss: 0.828 Vali Acc: 0.652 Test Loss: 0.828 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2254001
	speed: 0.4086s/iter; left time: 14132.8643s
	iters: 200, epoch: 7 | loss: 0.3843673
	speed: 0.1105s/iter; left time: 3809.8391s
	iters: 300, epoch: 7 | loss: 0.4206547
	speed: 0.1190s/iter; left time: 4093.5217s
Epoch: 7 cost time: 43.45661783218384
Epoch: 7, Steps: 369 | Train Loss: 0.383 Vali Loss: 0.739 Vali Acc: 0.677 Test Loss: 0.739 Test Acc: 0.677
Validation loss decreased (-0.675930 --> -0.676780).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2195308
	speed: 0.3861s/iter; left time: 13211.6535s
	iters: 200, epoch: 8 | loss: 0.3500705
	speed: 0.1045s/iter; left time: 3564.7283s
	iters: 300, epoch: 8 | loss: 0.5870236
	speed: 0.1113s/iter; left time: 3784.8711s
Epoch: 8 cost time: 42.47144865989685
Epoch: 8, Steps: 369 | Train Loss: 0.348 Vali Loss: 0.752 Vali Acc: 0.670 Test Loss: 0.752 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1552811
	speed: 0.4034s/iter; left time: 13654.1279s
	iters: 200, epoch: 9 | loss: 0.2811277
	speed: 0.1025s/iter; left time: 3458.7858s
	iters: 300, epoch: 9 | loss: 0.2914433
	speed: 0.1205s/iter; left time: 4054.2769s
Epoch: 9 cost time: 43.06748580932617
Epoch: 9, Steps: 369 | Train Loss: 0.274 Vali Loss: 0.912 Vali Acc: 0.659 Test Loss: 0.912 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2961218
	speed: 0.4021s/iter; left time: 13461.4211s
	iters: 200, epoch: 10 | loss: 0.4897807
	speed: 0.1129s/iter; left time: 3768.9115s
	iters: 300, epoch: 10 | loss: 0.2017905
	speed: 0.1398s/iter; left time: 4652.1408s
Epoch: 10 cost time: 46.55101227760315
Epoch: 10, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.096 Vali Acc: 0.654 Test Loss: 1.096 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1592752
	speed: 0.4120s/iter; left time: 13641.8286s
	iters: 200, epoch: 11 | loss: 0.1227005
	speed: 0.1117s/iter; left time: 3688.8477s
	iters: 300, epoch: 11 | loss: 0.1961827
	speed: 0.1319s/iter; left time: 4340.4645s
Epoch: 11 cost time: 46.2186222076416
Epoch: 11, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.273 Vali Acc: 0.654 Test Loss: 1.273 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1125322
	speed: 0.4199s/iter; left time: 13748.0746s
	iters: 200, epoch: 12 | loss: 0.0393390
	speed: 0.1288s/iter; left time: 4204.2977s
	iters: 300, epoch: 12 | loss: 0.2569849
	speed: 0.1081s/iter; left time: 3518.7302s
Epoch: 12 cost time: 45.967713356018066
Epoch: 12, Steps: 369 | Train Loss: 0.162 Vali Loss: 1.407 Vali Acc: 0.647 Test Loss: 1.407 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0251149
	speed: 0.3255s/iter; left time: 10537.4068s
	iters: 200, epoch: 13 | loss: 0.3639604
	speed: 0.0571s/iter; left time: 1843.8458s
	iters: 300, epoch: 13 | loss: 0.3880465
	speed: 0.0619s/iter; left time: 1990.1342s
Epoch: 13 cost time: 27.390300512313843
Epoch: 13, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.953 Vali Acc: 0.651 Test Loss: 1.953 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1024875
	speed: 0.3664s/iter; left time: 11725.1851s
	iters: 200, epoch: 14 | loss: 0.0624555
	speed: 0.1296s/iter; left time: 4135.4362s
	iters: 300, epoch: 14 | loss: 0.0738690
	speed: 0.1073s/iter; left time: 3414.1447s
Epoch: 14 cost time: 43.393094301223755
Epoch: 14, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.464 Vali Acc: 0.670 Test Loss: 1.464 Test Acc: 0.670
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0092689
	speed: 0.3889s/iter; left time: 12302.2736s
	iters: 200, epoch: 15 | loss: 0.3255517
	speed: 0.1219s/iter; left time: 3843.0454s
	iters: 300, epoch: 15 | loss: 0.1879466
	speed: 0.0971s/iter; left time: 3052.0430s
Epoch: 15 cost time: 42.16865539550781
Epoch: 15, Steps: 369 | Train Loss: 0.110 Vali Loss: 1.390 Vali Acc: 0.667 Test Loss: 1.390 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0242862
	speed: 0.4008s/iter; left time: 12530.3102s
	iters: 200, epoch: 16 | loss: 0.0416342
	speed: 0.1261s/iter; left time: 3928.5155s
	iters: 300, epoch: 16 | loss: 0.2303377
	speed: 0.1129s/iter; left time: 3505.9399s
Epoch: 16 cost time: 45.1444787979126
Epoch: 16, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.938 Vali Acc: 0.658 Test Loss: 1.938 Test Acc: 0.658
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0445472
	speed: 0.3758s/iter; left time: 11611.8093s
	iters: 200, epoch: 17 | loss: 0.0368356
	speed: 0.1393s/iter; left time: 4289.2116s
	iters: 300, epoch: 17 | loss: 0.0778136
	speed: 0.1102s/iter; left time: 3384.3122s
Epoch: 17 cost time: 45.14966034889221
Epoch: 17, Steps: 369 | Train Loss: 0.097 Vali Loss: 1.789 Vali Acc: 0.652 Test Loss: 1.789 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6767877412031782
model parameter : 535654
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.3346029
	speed: 0.1532s/iter; left time: 5638.8716s
	iters: 200, epoch: 1 | loss: 2.3698523
	speed: 0.1146s/iter; left time: 4207.0739s
	iters: 300, epoch: 1 | loss: 0.7516575
	speed: 0.1228s/iter; left time: 4495.6134s
Epoch: 1 cost time: 45.89456391334534
Epoch: 1, Steps: 369 | Train Loss: 0.878 Vali Loss: 0.785 Vali Acc: 0.641 Test Loss: 0.785 Test Acc: 0.641
Validation loss decreased (inf --> -0.641309).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0437366
	speed: 0.4026s/iter; left time: 14667.3039s
	iters: 200, epoch: 2 | loss: 0.2789457
	speed: 0.1114s/iter; left time: 4048.2449s
	iters: 300, epoch: 2 | loss: 1.5535023
	speed: 0.1184s/iter; left time: 4288.8964s
Epoch: 2 cost time: 44.1245641708374
Epoch: 2, Steps: 369 | Train Loss: 0.918 Vali Loss: 0.925 Vali Acc: 0.632 Test Loss: 0.925 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4280311
	speed: 0.3942s/iter; left time: 14215.6877s
	iters: 200, epoch: 3 | loss: 0.6950544
	speed: 0.1091s/iter; left time: 3922.1388s
	iters: 300, epoch: 3 | loss: 0.3883191
	speed: 0.1142s/iter; left time: 4095.0134s
Epoch: 3 cost time: 43.444495677948
Epoch: 3, Steps: 369 | Train Loss: 0.766 Vali Loss: 0.738 Vali Acc: 0.669 Test Loss: 0.738 Test Acc: 0.669
Validation loss decreased (-0.641309 --> -0.668835).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3209670
	speed: 0.4090s/iter; left time: 14597.5879s
	iters: 200, epoch: 4 | loss: 0.6650899
	speed: 0.1186s/iter; left time: 4222.7111s
	iters: 300, epoch: 4 | loss: 0.6239268
	speed: 0.1143s/iter; left time: 4058.2155s
Epoch: 4 cost time: 44.051456451416016
Epoch: 4, Steps: 369 | Train Loss: 0.560 Vali Loss: 0.644 Vali Acc: 0.664 Test Loss: 0.644 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5867083
	speed: 0.4019s/iter; left time: 14196.8918s
	iters: 200, epoch: 5 | loss: 0.4281557
	speed: 0.1225s/iter; left time: 4316.4614s
	iters: 300, epoch: 5 | loss: 0.5245646
	speed: 0.1268s/iter; left time: 4455.0162s
Epoch: 5 cost time: 46.64272117614746
Epoch: 5, Steps: 369 | Train Loss: 0.492 Vali Loss: 0.646 Vali Acc: 0.665 Test Loss: 0.646 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6412668
	speed: 0.3997s/iter; left time: 13972.8081s
	iters: 200, epoch: 6 | loss: 0.3844422
	speed: 0.1328s/iter; left time: 4628.5732s
	iters: 300, epoch: 6 | loss: 0.8546942
	speed: 0.1082s/iter; left time: 3760.2308s
Epoch: 6 cost time: 44.92257046699524
Epoch: 6, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.695 Vali Acc: 0.654 Test Loss: 0.695 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.3507795
	speed: 0.4228s/iter; left time: 14621.7640s
	iters: 200, epoch: 7 | loss: 0.5163344
	speed: 0.1244s/iter; left time: 4291.4994s
	iters: 300, epoch: 7 | loss: 0.5902842
	speed: 0.1175s/iter; left time: 4041.9740s
Epoch: 7 cost time: 44.27844190597534
Epoch: 7, Steps: 369 | Train Loss: 0.372 Vali Loss: 0.909 Vali Acc: 0.623 Test Loss: 0.909 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2216551
	speed: 0.4182s/iter; left time: 14310.0143s
	iters: 200, epoch: 8 | loss: 0.2055947
	speed: 0.0702s/iter; left time: 2396.2712s
	iters: 300, epoch: 8 | loss: 0.2540959
	speed: 0.0568s/iter; left time: 1933.4449s
Epoch: 8 cost time: 28.24238133430481
Epoch: 8, Steps: 369 | Train Loss: 0.335 Vali Loss: 0.863 Vali Acc: 0.658 Test Loss: 0.863 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.3852126
	speed: 0.3458s/iter; left time: 11705.0892s
	iters: 200, epoch: 9 | loss: 0.3064176
	speed: 0.1138s/iter; left time: 3839.8037s
	iters: 300, epoch: 9 | loss: 0.1378946
	speed: 0.1166s/iter; left time: 3922.6899s
Epoch: 9 cost time: 43.055325746536255
Epoch: 9, Steps: 369 | Train Loss: 0.272 Vali Loss: 0.941 Vali Acc: 0.654 Test Loss: 0.941 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2627654
	speed: 0.4017s/iter; left time: 13449.9385s
	iters: 200, epoch: 10 | loss: 0.3112173
	speed: 0.1085s/iter; left time: 3621.1705s
	iters: 300, epoch: 10 | loss: 0.1273288
	speed: 0.1276s/iter; left time: 4246.0822s
Epoch: 10 cost time: 44.103606939315796
Epoch: 10, Steps: 369 | Train Loss: 0.236 Vali Loss: 1.055 Vali Acc: 0.648 Test Loss: 1.055 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0434928
	speed: 0.3831s/iter; left time: 12685.3596s
	iters: 200, epoch: 11 | loss: 0.2766239
	speed: 0.1052s/iter; left time: 3474.2105s
	iters: 300, epoch: 11 | loss: 0.2356685
	speed: 0.1161s/iter; left time: 3821.2104s
Epoch: 11 cost time: 41.444939613342285
Epoch: 11, Steps: 369 | Train Loss: 0.183 Vali Loss: 1.316 Vali Acc: 0.655 Test Loss: 1.316 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1341936
	speed: 0.3982s/iter; left time: 13037.9153s
	iters: 200, epoch: 12 | loss: 0.2915923
	speed: 0.1361s/iter; left time: 4442.0407s
	iters: 300, epoch: 12 | loss: 0.0350117
	speed: 0.1070s/iter; left time: 3481.2386s
Epoch: 12 cost time: 44.814640045166016
Epoch: 12, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.469 Vali Acc: 0.653 Test Loss: 1.469 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0076896
	speed: 0.4019s/iter; left time: 13012.1407s
	iters: 200, epoch: 13 | loss: 0.2161999
	speed: 0.1059s/iter; left time: 3417.5729s
	iters: 300, epoch: 13 | loss: 0.3117556
	speed: 0.1254s/iter; left time: 4034.8016s
Epoch: 13 cost time: 45.29971361160278
Epoch: 13, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.460 Vali Acc: 0.645 Test Loss: 1.460 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6688422247446084
model parameter : 535078
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6526624
	speed: 0.1403s/iter; left time: 5162.4520s
	iters: 200, epoch: 1 | loss: 1.0143408
	speed: 0.1170s/iter; left time: 4292.3127s
	iters: 300, epoch: 1 | loss: 1.5426234
	speed: 0.1228s/iter; left time: 4494.3381s
Epoch: 1 cost time: 44.25370192527771
Epoch: 1, Steps: 369 | Train Loss: 0.858 Vali Loss: 1.428 Vali Acc: 0.542 Test Loss: 1.428 Test Acc: 0.542
Validation loss decreased (inf --> -0.542267).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6263806
	speed: 0.3696s/iter; left time: 13466.1217s
	iters: 200, epoch: 2 | loss: 0.8608009
	speed: 0.1137s/iter; left time: 4129.6168s
	iters: 300, epoch: 2 | loss: 0.4627386
	speed: 0.1080s/iter; left time: 3914.8486s
Epoch: 2 cost time: 42.09507966041565
Epoch: 2, Steps: 369 | Train Loss: 0.753 Vali Loss: 0.683 Vali Acc: 0.659 Test Loss: 0.683 Test Acc: 0.659
Validation loss decreased (-0.542267 --> -0.659471).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4046677
	speed: 0.3699s/iter; left time: 13338.0363s
	iters: 200, epoch: 3 | loss: 0.6678246
	speed: 0.1114s/iter; left time: 4005.2829s
	iters: 300, epoch: 3 | loss: 0.6173415
	speed: 0.1061s/iter; left time: 3805.7593s
Epoch: 3 cost time: 42.950812339782715
Epoch: 3, Steps: 369 | Train Loss: 0.641 Vali Loss: 0.629 Vali Acc: 0.657 Test Loss: 0.629 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9689524
	speed: 0.3654s/iter; left time: 13043.1201s
	iters: 200, epoch: 4 | loss: 0.4193942
	speed: 0.0724s/iter; left time: 2578.6732s
	iters: 300, epoch: 4 | loss: 0.6474662
	speed: 0.0614s/iter; left time: 2178.3915s
Epoch: 4 cost time: 27.73909044265747
Epoch: 4, Steps: 369 | Train Loss: 0.571 Vali Loss: 0.901 Vali Acc: 0.562 Test Loss: 0.901 Test Acc: 0.562
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2947431
	speed: 0.2991s/iter; left time: 10564.1742s
	iters: 200, epoch: 5 | loss: 0.4956304
	speed: 0.1211s/iter; left time: 4264.4765s
	iters: 300, epoch: 5 | loss: 0.3682440
	speed: 0.1152s/iter; left time: 4046.3295s
Epoch: 5 cost time: 43.12071394920349
Epoch: 5, Steps: 369 | Train Loss: 0.492 Vali Loss: 0.753 Vali Acc: 0.652 Test Loss: 0.753 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5238822
	speed: 0.3873s/iter; left time: 13537.7538s
	iters: 200, epoch: 6 | loss: 0.2998769
	speed: 0.1073s/iter; left time: 3739.8229s
	iters: 300, epoch: 6 | loss: 0.4660839
	speed: 0.1020s/iter; left time: 3543.9360s
Epoch: 6 cost time: 38.53980112075806
Epoch: 6, Steps: 369 | Train Loss: 0.419 Vali Loss: 0.703 Vali Acc: 0.659 Test Loss: 0.703 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2179819
	speed: 0.3827s/iter; left time: 13235.8442s
	iters: 200, epoch: 7 | loss: 0.2365836
	speed: 0.1140s/iter; left time: 3930.8341s
	iters: 300, epoch: 7 | loss: 0.4543296
	speed: 0.1409s/iter; left time: 4844.2856s
Epoch: 7 cost time: 48.29357290267944
Epoch: 7, Steps: 369 | Train Loss: 0.374 Vali Loss: 0.828 Vali Acc: 0.654 Test Loss: 0.828 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.2906628
	speed: 0.4014s/iter; left time: 13735.8871s
	iters: 200, epoch: 8 | loss: 0.2374829
	speed: 0.1244s/iter; left time: 4243.7541s
	iters: 300, epoch: 8 | loss: 0.8151915
	speed: 0.1132s/iter; left time: 3849.2638s
Epoch: 8 cost time: 44.72453045845032
Epoch: 8, Steps: 369 | Train Loss: 0.324 Vali Loss: 0.733 Vali Acc: 0.659 Test Loss: 0.733 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.2332506
	speed: 0.3748s/iter; left time: 12687.0957s
	iters: 200, epoch: 9 | loss: 0.0745430
	speed: 0.1242s/iter; left time: 4192.0784s
	iters: 300, epoch: 9 | loss: 0.1277085
	speed: 0.1093s/iter; left time: 3678.5537s
Epoch: 9 cost time: 42.288583517074585
Epoch: 9, Steps: 369 | Train Loss: 0.261 Vali Loss: 0.867 Vali Acc: 0.665 Test Loss: 0.867 Test Acc: 0.665
Validation loss decreased (-0.659471 --> -0.665145).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0606144
	speed: 0.3615s/iter; left time: 12101.7782s
	iters: 200, epoch: 10 | loss: 0.1473709
	speed: 0.1058s/iter; left time: 3530.7145s
	iters: 300, epoch: 10 | loss: 0.0979152
	speed: 0.1145s/iter; left time: 3811.1117s
Epoch: 10 cost time: 40.5942759513855
Epoch: 10, Steps: 369 | Train Loss: 0.219 Vali Loss: 0.919 Vali Acc: 0.666 Test Loss: 0.919 Test Acc: 0.666
Validation loss decreased (-0.665145 --> -0.665712).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0355907
	speed: 0.3690s/iter; left time: 12216.5383s
	iters: 200, epoch: 11 | loss: 0.1947912
	speed: 0.1116s/iter; left time: 3683.6624s
	iters: 300, epoch: 11 | loss: 0.5691347
	speed: 0.1164s/iter; left time: 3831.7473s
Epoch: 11 cost time: 40.85849976539612
Epoch: 11, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.044 Vali Acc: 0.658 Test Loss: 1.044 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0597866
	speed: 0.3613s/iter; left time: 11831.1841s
	iters: 200, epoch: 12 | loss: 0.0629938
	speed: 0.1139s/iter; left time: 3719.5473s
	iters: 300, epoch: 12 | loss: 0.1234413
	speed: 0.1122s/iter; left time: 3652.8124s
Epoch: 12 cost time: 43.48773670196533
Epoch: 12, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.379 Vali Acc: 0.650 Test Loss: 1.379 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0493784
	speed: 0.3796s/iter; left time: 12287.2099s
	iters: 200, epoch: 13 | loss: 0.2635884
	speed: 0.1165s/iter; left time: 3760.8462s
	iters: 300, epoch: 13 | loss: 0.0372148
	speed: 0.1049s/iter; left time: 3375.5199s
Epoch: 13 cost time: 41.810763359069824
Epoch: 13, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.656 Vali Acc: 0.649 Test Loss: 1.656 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0226375
	speed: 0.3971s/iter; left time: 12707.5471s
	iters: 200, epoch: 14 | loss: 0.0078118
	speed: 0.1316s/iter; left time: 4200.1026s
	iters: 300, epoch: 14 | loss: 0.0837955
	speed: 0.1445s/iter; left time: 4594.4211s
Epoch: 14 cost time: 47.54832887649536
Epoch: 14, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.644 Vali Acc: 0.655 Test Loss: 1.644 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0701705
	speed: 0.4092s/iter; left time: 12943.4754s
	iters: 200, epoch: 15 | loss: 0.8113030
	speed: 0.0830s/iter; left time: 2616.3823s
	iters: 300, epoch: 15 | loss: 0.0300693
	speed: 0.0716s/iter; left time: 2252.0403s
Epoch: 15 cost time: 33.67755699157715
Epoch: 15, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.538 Vali Acc: 0.647 Test Loss: 1.538 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0110885
	speed: 0.3214s/iter; left time: 10047.9083s
	iters: 200, epoch: 16 | loss: 0.1883804
	speed: 0.1183s/iter; left time: 3685.9358s
	iters: 300, epoch: 16 | loss: 0.0212719
	speed: 0.1050s/iter; left time: 3263.2432s
Epoch: 16 cost time: 44.774930477142334
Epoch: 16, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.455 Vali Acc: 0.661 Test Loss: 1.455 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.3655658
	speed: 0.3567s/iter; left time: 11021.1918s
	iters: 200, epoch: 17 | loss: 0.0146947
	speed: 0.1150s/iter; left time: 3542.7361s
	iters: 300, epoch: 17 | loss: 0.4743123
	speed: 0.1106s/iter; left time: 3394.9622s
Epoch: 17 cost time: 39.13497734069824
Epoch: 17, Steps: 369 | Train Loss: 0.081 Vali Loss: 1.685 Vali Acc: 0.660 Test Loss: 1.685 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0390677
	speed: 0.3679s/iter; left time: 11231.7044s
	iters: 200, epoch: 18 | loss: 0.3313250
	speed: 0.1081s/iter; left time: 3289.0246s
	iters: 300, epoch: 18 | loss: 0.0370238
	speed: 0.1085s/iter; left time: 3290.9773s
Epoch: 18 cost time: 40.360798835754395
Epoch: 18, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.849 Vali Acc: 0.645 Test Loss: 1.849 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1547114
	speed: 0.3741s/iter; left time: 11283.0497s
	iters: 200, epoch: 19 | loss: 0.2332567
	speed: 0.1095s/iter; left time: 3290.0930s
	iters: 300, epoch: 19 | loss: 0.0365288
	speed: 0.1095s/iter; left time: 3280.4292s
Epoch: 19 cost time: 42.06941223144531
Epoch: 19, Steps: 369 | Train Loss: 0.089 Vali Loss: 1.866 Vali Acc: 0.653 Test Loss: 1.866 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0594801
	speed: 0.3823s/iter; left time: 11388.7205s
	iters: 200, epoch: 20 | loss: 0.2591537
	speed: 0.1052s/iter; left time: 3123.1368s
	iters: 300, epoch: 20 | loss: 0.0021618
	speed: 0.1180s/iter; left time: 3491.4665s
Epoch: 20 cost time: 41.62144064903259
Epoch: 20, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.084 Vali Acc: 0.646 Test Loss: 2.084 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6657207718501703
model parameter : 534502
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8132086
	speed: 0.1387s/iter; left time: 5105.4313s
	iters: 200, epoch: 1 | loss: 0.6257553
	speed: 0.1294s/iter; left time: 4750.8656s
	iters: 300, epoch: 1 | loss: 1.2971251
	speed: 0.1136s/iter; left time: 4158.2465s
Epoch: 1 cost time: 46.74598145484924
Epoch: 1, Steps: 369 | Train Loss: 0.870 Vali Loss: 0.999 Vali Acc: 0.606 Test Loss: 0.999 Test Acc: 0.606
Validation loss decreased (inf --> -0.606119).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1270851
	speed: 0.3985s/iter; left time: 14519.6380s
	iters: 200, epoch: 2 | loss: 1.1793153
	speed: 0.1196s/iter; left time: 4344.0535s
	iters: 300, epoch: 2 | loss: 0.7801827
	speed: 0.1135s/iter; left time: 4113.8709s
Epoch: 2 cost time: 43.6939811706543
Epoch: 2, Steps: 369 | Train Loss: 0.923 Vali Loss: 0.959 Vali Acc: 0.581 Test Loss: 0.959 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5796448
	speed: 0.3944s/iter; left time: 14223.5835s
	iters: 200, epoch: 3 | loss: 0.9830133
	speed: 0.1003s/iter; left time: 3605.6152s
	iters: 300, epoch: 3 | loss: 0.6191447
	speed: 0.1106s/iter; left time: 3967.6437s
Epoch: 3 cost time: 40.267844676971436
Epoch: 3, Steps: 369 | Train Loss: 0.626 Vali Loss: 0.999 Vali Acc: 0.570 Test Loss: 0.999 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7000018
	speed: 0.3883s/iter; left time: 13861.6109s
	iters: 200, epoch: 4 | loss: 0.8156698
	speed: 0.1050s/iter; left time: 3736.4394s
	iters: 300, epoch: 4 | loss: 0.3492427
	speed: 0.1182s/iter; left time: 4194.1230s
Epoch: 4 cost time: 41.185264110565186
Epoch: 4, Steps: 369 | Train Loss: 0.569 Vali Loss: 0.655 Vali Acc: 0.696 Test Loss: 0.655 Test Acc: 0.696
Validation loss decreased (-0.606119 --> -0.696077).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3862052
	speed: 0.2882s/iter; left time: 10179.3117s
	iters: 200, epoch: 5 | loss: 0.5454419
	speed: 0.0886s/iter; left time: 3119.6476s
	iters: 300, epoch: 5 | loss: 0.5577378
	speed: 0.1107s/iter; left time: 3889.8826s
Epoch: 5 cost time: 35.10204195976257
Epoch: 5, Steps: 369 | Train Loss: 0.466 Vali Loss: 0.695 Vali Acc: 0.680 Test Loss: 0.695 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2618876
	speed: 0.3939s/iter; left time: 13769.8974s
	iters: 200, epoch: 6 | loss: 0.3514669
	speed: 0.1120s/iter; left time: 3904.4351s
	iters: 300, epoch: 6 | loss: 0.3965252
	speed: 0.1081s/iter; left time: 3756.5136s
Epoch: 6 cost time: 42.58012008666992
Epoch: 6, Steps: 369 | Train Loss: 0.425 Vali Loss: 0.725 Vali Acc: 0.669 Test Loss: 0.725 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4564422
	speed: 0.4264s/iter; left time: 14748.2537s
	iters: 200, epoch: 7 | loss: 0.3008235
	speed: 0.0964s/iter; left time: 3324.6568s
	iters: 300, epoch: 7 | loss: 0.4435930
	speed: 0.1234s/iter; left time: 4242.0731s
Epoch: 7 cost time: 42.65086364746094
Epoch: 7, Steps: 369 | Train Loss: 0.380 Vali Loss: 0.712 Vali Acc: 0.665 Test Loss: 0.712 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1676807
	speed: 0.3917s/iter; left time: 13404.0808s
	iters: 200, epoch: 8 | loss: 0.1845821
	speed: 0.1091s/iter; left time: 3723.3768s
	iters: 300, epoch: 8 | loss: 0.2544327
	speed: 0.1406s/iter; left time: 4783.3549s
Epoch: 8 cost time: 46.298059701919556
Epoch: 8, Steps: 369 | Train Loss: 0.334 Vali Loss: 0.900 Vali Acc: 0.655 Test Loss: 0.900 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.4025903
	speed: 0.3936s/iter; left time: 13323.0863s
	iters: 200, epoch: 9 | loss: 0.0501547
	speed: 0.1255s/iter; left time: 4237.1059s
	iters: 300, epoch: 9 | loss: 0.4105389
	speed: 0.0859s/iter; left time: 2890.6352s
Epoch: 9 cost time: 38.48198938369751
Epoch: 9, Steps: 369 | Train Loss: 0.288 Vali Loss: 1.042 Vali Acc: 0.659 Test Loss: 1.042 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2899522
	speed: 0.3840s/iter; left time: 12856.1828s
	iters: 200, epoch: 10 | loss: 0.2883935
	speed: 0.1164s/iter; left time: 3885.1444s
	iters: 300, epoch: 10 | loss: 0.2365575
	speed: 0.1180s/iter; left time: 3928.2360s
Epoch: 10 cost time: 42.997881174087524
Epoch: 10, Steps: 369 | Train Loss: 0.236 Vali Loss: 1.159 Vali Acc: 0.632 Test Loss: 1.159 Test Acc: 0.632
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0261679
	speed: 0.3878s/iter; left time: 12839.1046s
	iters: 200, epoch: 11 | loss: 0.0331824
	speed: 0.0965s/iter; left time: 3185.9805s
	iters: 300, epoch: 11 | loss: 0.0597607
	speed: 0.1106s/iter; left time: 3640.6464s
Epoch: 11 cost time: 41.34211349487305
Epoch: 11, Steps: 369 | Train Loss: 0.199 Vali Loss: 1.259 Vali Acc: 0.658 Test Loss: 1.259 Test Acc: 0.658
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.2338945
	speed: 0.3864s/iter; left time: 12650.2228s
	iters: 200, epoch: 12 | loss: 0.2147398
	speed: 0.1116s/iter; left time: 3643.8839s
	iters: 300, epoch: 12 | loss: 0.1355145
	speed: 0.1078s/iter; left time: 3509.6384s
Epoch: 12 cost time: 41.04885959625244
Epoch: 12, Steps: 369 | Train Loss: 0.185 Vali Loss: 1.143 Vali Acc: 0.638 Test Loss: 1.143 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.2861412
	speed: 0.3868s/iter; left time: 12521.6316s
	iters: 200, epoch: 13 | loss: 0.1322129
	speed: 0.1101s/iter; left time: 3554.0507s
	iters: 300, epoch: 13 | loss: 0.0561975
	speed: 0.1079s/iter; left time: 3470.4734s
Epoch: 13 cost time: 43.642478466033936
Epoch: 13, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.413 Vali Acc: 0.650 Test Loss: 1.413 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1639263
	speed: 0.4222s/iter; left time: 13511.8043s
	iters: 200, epoch: 14 | loss: 0.4728249
	speed: 0.1225s/iter; left time: 3907.6214s
	iters: 300, epoch: 14 | loss: 0.0824603
	speed: 0.1014s/iter; left time: 3225.1831s
Epoch: 14 cost time: 42.882179975509644
Epoch: 14, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.506 Vali Acc: 0.654 Test Loss: 1.506 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6960839954597049
model parameter : 533926
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7829866
	speed: 0.1375s/iter; left time: 5058.6736s
	iters: 200, epoch: 1 | loss: 0.4853508
	speed: 0.1055s/iter; left time: 3872.9197s
	iters: 300, epoch: 1 | loss: 0.8689384
	speed: 0.1045s/iter; left time: 3826.3199s
Epoch: 1 cost time: 42.78170442581177
Epoch: 1, Steps: 369 | Train Loss: 0.803 Vali Loss: 0.689 Vali Acc: 0.653 Test Loss: 0.689 Test Acc: 0.653
Validation loss decreased (inf --> -0.653228).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4493619
	speed: 0.3622s/iter; left time: 13195.2923s
	iters: 200, epoch: 2 | loss: 0.8558015
	speed: 0.1187s/iter; left time: 4310.8854s
	iters: 300, epoch: 2 | loss: 0.5120757
	speed: 0.1188s/iter; left time: 4306.1646s
Epoch: 2 cost time: 42.409318685531616
Epoch: 2, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.905 Vali Acc: 0.593 Test Loss: 0.905 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4193330
	speed: 0.3652s/iter; left time: 13170.2213s
	iters: 200, epoch: 3 | loss: 0.8864315
	speed: 0.0990s/iter; left time: 3561.8748s
	iters: 300, epoch: 3 | loss: 1.0116035
	speed: 0.1157s/iter; left time: 4150.0791s
Epoch: 3 cost time: 39.063504457473755
Epoch: 3, Steps: 369 | Train Loss: 0.697 Vali Loss: 0.955 Vali Acc: 0.581 Test Loss: 0.955 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5862618
	speed: 0.3609s/iter; left time: 12882.5091s
	iters: 200, epoch: 4 | loss: 0.5946001
	speed: 0.1166s/iter; left time: 4149.8418s
	iters: 300, epoch: 4 | loss: 0.6739438
	speed: 0.1046s/iter; left time: 3712.4400s
Epoch: 4 cost time: 40.9163601398468
Epoch: 4, Steps: 369 | Train Loss: 0.588 Vali Loss: 0.667 Vali Acc: 0.660 Test Loss: 0.667 Test Acc: 0.660
Validation loss decreased (-0.653228 --> -0.660323).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4804060
	speed: 0.3492s/iter; left time: 12335.4237s
	iters: 200, epoch: 5 | loss: 1.0620301
	speed: 0.1139s/iter; left time: 4013.0273s
	iters: 300, epoch: 5 | loss: 0.4083579
	speed: 0.0950s/iter; left time: 3337.7838s
Epoch: 5 cost time: 40.286977767944336
Epoch: 5, Steps: 369 | Train Loss: 0.537 Vali Loss: 0.715 Vali Acc: 0.679 Test Loss: 0.715 Test Acc: 0.679
Validation loss decreased (-0.660323 --> -0.679051).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8950729
	speed: 0.3830s/iter; left time: 13387.7886s
	iters: 200, epoch: 6 | loss: 0.3645730
	speed: 0.1206s/iter; left time: 4205.2847s
	iters: 300, epoch: 6 | loss: 0.7625425
	speed: 0.0970s/iter; left time: 3372.1249s
Epoch: 6 cost time: 44.50712203979492
Epoch: 6, Steps: 369 | Train Loss: 0.483 Vali Loss: 0.650 Vali Acc: 0.674 Test Loss: 0.650 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2710595
	speed: 0.4076s/iter; left time: 14098.1238s
	iters: 200, epoch: 7 | loss: 0.4581483
	speed: 0.1144s/iter; left time: 3946.3067s
	iters: 300, epoch: 7 | loss: 0.2288498
	speed: 0.1257s/iter; left time: 4322.6754s
Epoch: 7 cost time: 45.458812952041626
Epoch: 7, Steps: 369 | Train Loss: 0.442 Vali Loss: 0.642 Vali Acc: 0.664 Test Loss: 0.642 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3409326
	speed: 0.4245s/iter; left time: 14524.2694s
	iters: 200, epoch: 8 | loss: 0.4087819
	speed: 0.1385s/iter; left time: 4726.5055s
	iters: 300, epoch: 8 | loss: 0.4256599
	speed: 0.1263s/iter; left time: 4295.5775s
Epoch: 8 cost time: 48.648590087890625
Epoch: 8, Steps: 369 | Train Loss: 0.406 Vali Loss: 0.708 Vali Acc: 0.675 Test Loss: 0.708 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2651853
	speed: 0.3078s/iter; left time: 10417.5095s
	iters: 200, epoch: 9 | loss: 0.3006060
	speed: 0.1064s/iter; left time: 3591.3076s
	iters: 300, epoch: 9 | loss: 0.5471840
	speed: 0.1169s/iter; left time: 3933.5884s
Epoch: 9 cost time: 38.96020436286926
Epoch: 9, Steps: 369 | Train Loss: 0.373 Vali Loss: 0.887 Vali Acc: 0.661 Test Loss: 0.887 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3481223
	speed: 0.3547s/iter; left time: 11875.9143s
	iters: 200, epoch: 10 | loss: 0.3904640
	speed: 0.0882s/iter; left time: 2942.4777s
	iters: 300, epoch: 10 | loss: 0.5098637
	speed: 0.1160s/iter; left time: 3860.7677s
Epoch: 10 cost time: 38.03740906715393
Epoch: 10, Steps: 369 | Train Loss: 0.340 Vali Loss: 0.805 Vali Acc: 0.652 Test Loss: 0.805 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4638863
	speed: 0.3651s/iter; left time: 12090.3603s
	iters: 200, epoch: 11 | loss: 0.2610066
	speed: 0.1148s/iter; left time: 3789.3056s
	iters: 300, epoch: 11 | loss: 0.3652148
	speed: 0.1054s/iter; left time: 3467.2938s
Epoch: 11 cost time: 42.50740146636963
Epoch: 11, Steps: 369 | Train Loss: 0.300 Vali Loss: 0.832 Vali Acc: 0.672 Test Loss: 0.832 Test Acc: 0.672
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0731189
	speed: 0.3572s/iter; left time: 11696.8423s
	iters: 200, epoch: 12 | loss: 0.9613847
	speed: 0.1108s/iter; left time: 3616.3087s
	iters: 300, epoch: 12 | loss: 0.2589234
	speed: 0.0989s/iter; left time: 3218.9488s
Epoch: 12 cost time: 38.74840259552002
Epoch: 12, Steps: 369 | Train Loss: 0.272 Vali Loss: 0.925 Vali Acc: 0.653 Test Loss: 0.925 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0807361
	speed: 0.3430s/iter; left time: 11104.1285s
	iters: 200, epoch: 13 | loss: 0.4829601
	speed: 0.1065s/iter; left time: 3437.7767s
	iters: 300, epoch: 13 | loss: 0.1060697
	speed: 0.0994s/iter; left time: 3198.2946s
Epoch: 13 cost time: 37.84461998939514
Epoch: 13, Steps: 369 | Train Loss: 0.241 Vali Loss: 1.031 Vali Acc: 0.649 Test Loss: 1.031 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0633627
	speed: 0.3460s/iter; left time: 11074.1077s
	iters: 200, epoch: 14 | loss: 0.3843966
	speed: 0.0989s/iter; left time: 3154.1568s
	iters: 300, epoch: 14 | loss: 0.1164392
	speed: 0.0909s/iter; left time: 2891.6440s
Epoch: 14 cost time: 34.84169340133667
Epoch: 14, Steps: 369 | Train Loss: 0.209 Vali Loss: 1.254 Vali Acc: 0.651 Test Loss: 1.254 Test Acc: 0.651
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.2225895
	speed: 0.3240s/iter; left time: 10249.9933s
	iters: 200, epoch: 15 | loss: 0.1308312
	speed: 0.1005s/iter; left time: 3170.7157s
	iters: 300, epoch: 15 | loss: 0.2688291
	speed: 0.1153s/iter; left time: 3625.3498s
Epoch: 15 cost time: 42.983607053756714
Epoch: 15, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.224 Vali Acc: 0.652 Test Loss: 1.224 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6790578887627696
model parameter : 477446
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3971676
	speed: 0.1309s/iter; left time: 4815.9185s
	iters: 200, epoch: 1 | loss: 0.7234125
	speed: 0.1015s/iter; left time: 3726.5441s
	iters: 300, epoch: 1 | loss: 0.7271690
	speed: 0.1057s/iter; left time: 3869.2871s
Epoch: 1 cost time: 39.46941781044006
Epoch: 1, Steps: 369 | Train Loss: 0.751 Vali Loss: 1.593 Vali Acc: 0.534 Test Loss: 1.593 Test Acc: 0.534
Validation loss decreased (inf --> -0.534320).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5952022
	speed: 0.3206s/iter; left time: 11678.6251s
	iters: 200, epoch: 2 | loss: 0.5811197
	speed: 0.0819s/iter; left time: 2974.5967s
	iters: 300, epoch: 2 | loss: 0.5239142
	speed: 0.0929s/iter; left time: 3367.5974s
Epoch: 2 cost time: 35.42943215370178
Epoch: 2, Steps: 369 | Train Loss: 0.688 Vali Loss: 0.725 Vali Acc: 0.628 Test Loss: 0.725 Test Acc: 0.628
Validation loss decreased (-0.534320 --> -0.627972).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4881173
	speed: 0.3399s/iter; left time: 12258.7886s
	iters: 200, epoch: 3 | loss: 0.4442221
	speed: 0.0989s/iter; left time: 3558.2237s
	iters: 300, epoch: 3 | loss: 0.4500219
	speed: 0.1003s/iter; left time: 3597.3681s
Epoch: 3 cost time: 38.17246222496033
Epoch: 3, Steps: 369 | Train Loss: 0.638 Vali Loss: 0.762 Vali Acc: 0.623 Test Loss: 0.762 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3739414
	speed: 0.3209s/iter; left time: 11453.0829s
	iters: 200, epoch: 4 | loss: 0.4414678
	speed: 0.1002s/iter; left time: 3566.2179s
	iters: 300, epoch: 4 | loss: 0.4783831
	speed: 0.1086s/iter; left time: 3853.4504s
Epoch: 4 cost time: 39.42475938796997
Epoch: 4, Steps: 369 | Train Loss: 0.568 Vali Loss: 0.728 Vali Acc: 0.623 Test Loss: 0.728 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5389532
	speed: 0.3368s/iter; left time: 11897.2645s
	iters: 200, epoch: 5 | loss: 0.5834876
	speed: 0.1128s/iter; left time: 3972.9805s
	iters: 300, epoch: 5 | loss: 0.5492705
	speed: 0.0959s/iter; left time: 3368.7189s
Epoch: 5 cost time: 37.6090350151062
Epoch: 5, Steps: 369 | Train Loss: 0.515 Vali Loss: 0.682 Vali Acc: 0.646 Test Loss: 0.682 Test Acc: 0.646
Validation loss decreased (-0.627972 --> -0.645566).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2183511
	speed: 0.3440s/iter; left time: 12024.4386s
	iters: 200, epoch: 6 | loss: 0.3477858
	speed: 0.1169s/iter; left time: 4075.7031s
	iters: 300, epoch: 6 | loss: 0.4768558
	speed: 0.1277s/iter; left time: 4438.7469s
Epoch: 6 cost time: 40.622530460357666
Epoch: 6, Steps: 369 | Train Loss: 0.461 Vali Loss: 0.647 Vali Acc: 0.664 Test Loss: 0.647 Test Acc: 0.664
Validation loss decreased (-0.645566 --> -0.664295).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4908163
	speed: 0.3216s/iter; left time: 11124.0126s
	iters: 200, epoch: 7 | loss: 0.5166035
	speed: 0.0525s/iter; left time: 1811.7271s
	iters: 300, epoch: 7 | loss: 0.4245331
	speed: 0.0548s/iter; left time: 1884.7000s
Epoch: 7 cost time: 22.885976314544678
Epoch: 7, Steps: 369 | Train Loss: 0.431 Vali Loss: 0.751 Vali Acc: 0.654 Test Loss: 0.751 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1910725
	speed: 0.3068s/iter; left time: 10496.9506s
	iters: 200, epoch: 8 | loss: 0.5372924
	speed: 0.1027s/iter; left time: 3504.8630s
	iters: 300, epoch: 8 | loss: 0.2435647
	speed: 0.1002s/iter; left time: 3408.7136s
Epoch: 8 cost time: 37.37104368209839
Epoch: 8, Steps: 369 | Train Loss: 0.384 Vali Loss: 0.771 Vali Acc: 0.651 Test Loss: 0.771 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1096216
	speed: 0.3677s/iter; left time: 12446.8562s
	iters: 200, epoch: 9 | loss: 0.2565780
	speed: 0.0866s/iter; left time: 2921.3857s
	iters: 300, epoch: 9 | loss: 0.3838380
	speed: 0.1029s/iter; left time: 3462.7751s
Epoch: 9 cost time: 36.68791127204895
Epoch: 9, Steps: 369 | Train Loss: 0.353 Vali Loss: 0.983 Vali Acc: 0.610 Test Loss: 0.983 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2260808
	speed: 0.3589s/iter; left time: 12015.2731s
	iters: 200, epoch: 10 | loss: 0.3088761
	speed: 0.1002s/iter; left time: 3343.3594s
	iters: 300, epoch: 10 | loss: 0.2676159
	speed: 0.0898s/iter; left time: 2987.8558s
Epoch: 10 cost time: 37.04635691642761
Epoch: 10, Steps: 369 | Train Loss: 0.331 Vali Loss: 0.895 Vali Acc: 0.650 Test Loss: 0.895 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1595745
	speed: 0.3625s/iter; left time: 12001.8046s
	iters: 200, epoch: 11 | loss: 0.5490322
	speed: 0.1098s/iter; left time: 3625.1591s
	iters: 300, epoch: 11 | loss: 0.2368649
	speed: 0.0858s/iter; left time: 2824.4972s
Epoch: 11 cost time: 36.62727761268616
Epoch: 11, Steps: 369 | Train Loss: 0.301 Vali Loss: 0.873 Vali Acc: 0.662 Test Loss: 0.873 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1541663
	speed: 0.3678s/iter; left time: 12044.0486s
	iters: 200, epoch: 12 | loss: 0.1601340
	speed: 0.0890s/iter; left time: 2905.9798s
	iters: 300, epoch: 12 | loss: 0.2759129
	speed: 0.1046s/iter; left time: 3404.0308s
Epoch: 12 cost time: 36.63015842437744
Epoch: 12, Steps: 369 | Train Loss: 0.262 Vali Loss: 1.037 Vali Acc: 0.652 Test Loss: 1.037 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1394057
	speed: 0.3853s/iter; left time: 12472.3650s
	iters: 200, epoch: 13 | loss: 0.4801790
	speed: 0.1158s/iter; left time: 3736.6201s
	iters: 300, epoch: 13 | loss: 0.1010678
	speed: 0.0932s/iter; left time: 2997.1171s
Epoch: 13 cost time: 38.910911560058594
Epoch: 13, Steps: 369 | Train Loss: 0.244 Vali Loss: 0.953 Vali Acc: 0.652 Test Loss: 0.953 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2334502
	speed: 0.4198s/iter; left time: 13436.5441s
	iters: 200, epoch: 14 | loss: 0.1032558
	speed: 0.0831s/iter; left time: 2651.7975s
	iters: 300, epoch: 14 | loss: 0.2905953
	speed: 0.0975s/iter; left time: 3102.0244s
Epoch: 14 cost time: 36.492225646972656
Epoch: 14, Steps: 369 | Train Loss: 0.214 Vali Loss: 1.051 Vali Acc: 0.652 Test Loss: 1.051 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0649470
	speed: 0.3749s/iter; left time: 11859.4856s
	iters: 200, epoch: 15 | loss: 0.0823071
	speed: 0.1137s/iter; left time: 3586.1780s
	iters: 300, epoch: 15 | loss: 0.0498537
	speed: 0.0915s/iter; left time: 2875.3998s
Epoch: 15 cost time: 39.383076667785645
Epoch: 15, Steps: 369 | Train Loss: 0.183 Vali Loss: 1.143 Vali Acc: 0.652 Test Loss: 1.143 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2650042
	speed: 0.3658s/iter; left time: 11438.3636s
	iters: 200, epoch: 16 | loss: 0.3953971
	speed: 0.1032s/iter; left time: 3215.2445s
	iters: 300, epoch: 16 | loss: 0.2453321
	speed: 0.0923s/iter; left time: 2868.3578s
Epoch: 16 cost time: 36.15264821052551
Epoch: 16, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.246 Vali Acc: 0.648 Test Loss: 1.246 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6643019296254257
model parameter : 477158
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7633988
	speed: 0.0927s/iter; left time: 3410.1565s
	iters: 200, epoch: 1 | loss: 0.6989442
	speed: 0.0715s/iter; left time: 2625.8858s
	iters: 300, epoch: 1 | loss: 0.5943556
	speed: 0.0616s/iter; left time: 2254.8120s
Epoch: 1 cost time: 27.04632806777954
Epoch: 1, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.858 Vali Acc: 0.587 Test Loss: 0.858 Test Acc: 0.587
Validation loss decreased (inf --> -0.587392).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8028837
	speed: 0.2810s/iter; left time: 10238.2667s
	iters: 200, epoch: 2 | loss: 0.4853100
	speed: 0.0642s/iter; left time: 2331.1008s
	iters: 300, epoch: 2 | loss: 0.5426672
	speed: 0.0584s/iter; left time: 2115.9001s
Epoch: 2 cost time: 23.467223167419434
Epoch: 2, Steps: 369 | Train Loss: 0.758 Vali Loss: 0.979 Vali Acc: 0.630 Test Loss: 0.979 Test Acc: 0.630
Validation loss decreased (-0.587392 --> -0.629672).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3692622
	speed: 0.3058s/iter; left time: 11029.4002s
	iters: 200, epoch: 3 | loss: 0.5725264
	speed: 0.0594s/iter; left time: 2137.0001s
	iters: 300, epoch: 3 | loss: 0.4971299
	speed: 0.0649s/iter; left time: 2325.7987s
Epoch: 3 cost time: 24.058406352996826
Epoch: 3, Steps: 369 | Train Loss: 0.686 Vali Loss: 0.681 Vali Acc: 0.612 Test Loss: 0.681 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2528447
	speed: 0.3512s/iter; left time: 12536.7964s
	iters: 200, epoch: 4 | loss: 1.2301286
	speed: 0.0883s/iter; left time: 3143.7859s
	iters: 300, epoch: 4 | loss: 0.6124176
	speed: 0.0967s/iter; left time: 3431.4676s
Epoch: 4 cost time: 35.39280819892883
Epoch: 4, Steps: 369 | Train Loss: 0.585 Vali Loss: 0.688 Vali Acc: 0.667 Test Loss: 0.688 Test Acc: 0.667
Validation loss decreased (-0.629672 --> -0.667417).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3894520
	speed: 0.3749s/iter; left time: 13245.0498s
	iters: 200, epoch: 5 | loss: 0.3138329
	speed: 0.0793s/iter; left time: 2794.6679s
	iters: 300, epoch: 5 | loss: 0.7893075
	speed: 0.0982s/iter; left time: 3450.2530s
Epoch: 5 cost time: 34.539838552474976
Epoch: 5, Steps: 369 | Train Loss: 0.511 Vali Loss: 0.658 Vali Acc: 0.682 Test Loss: 0.658 Test Acc: 0.682
Validation loss decreased (-0.667417 --> -0.681605).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4709556
	speed: 0.3521s/iter; left time: 12309.5918s
	iters: 200, epoch: 6 | loss: 0.6529166
	speed: 0.0984s/iter; left time: 3428.2919s
	iters: 300, epoch: 6 | loss: 0.4308119
	speed: 0.0853s/iter; left time: 2964.6995s
Epoch: 6 cost time: 35.06803297996521
Epoch: 6, Steps: 369 | Train Loss: 0.470 Vali Loss: 0.692 Vali Acc: 0.654 Test Loss: 0.692 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4099406
	speed: 0.3394s/iter; left time: 11738.8408s
	iters: 200, epoch: 7 | loss: 0.3427238
	speed: 0.0952s/iter; left time: 3284.6890s
	iters: 300, epoch: 7 | loss: 0.5547279
	speed: 0.0810s/iter; left time: 2786.8296s
Epoch: 7 cost time: 33.342960834503174
Epoch: 7, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.689 Vali Acc: 0.673 Test Loss: 0.689 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4353611
	speed: 0.3564s/iter; left time: 12195.3049s
	iters: 200, epoch: 8 | loss: 0.3729606
	speed: 0.0936s/iter; left time: 3194.3597s
	iters: 300, epoch: 8 | loss: 0.3509991
	speed: 0.0796s/iter; left time: 2709.3913s
Epoch: 8 cost time: 34.4455361366272
Epoch: 8, Steps: 369 | Train Loss: 0.406 Vali Loss: 0.636 Vali Acc: 0.672 Test Loss: 0.636 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.5779815
	speed: 0.3575s/iter; left time: 12101.1528s
	iters: 200, epoch: 9 | loss: 0.2473872
	speed: 0.0943s/iter; left time: 3182.9585s
	iters: 300, epoch: 9 | loss: 0.3855807
	speed: 0.0989s/iter; left time: 3329.2599s
Epoch: 9 cost time: 34.93814969062805
Epoch: 9, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.794 Vali Acc: 0.659 Test Loss: 0.794 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3815537
	speed: 0.3640s/iter; left time: 12187.6211s
	iters: 200, epoch: 10 | loss: 0.4994305
	speed: 0.0789s/iter; left time: 2635.0399s
	iters: 300, epoch: 10 | loss: 0.5359938
	speed: 0.1145s/iter; left time: 3810.8830s
Epoch: 10 cost time: 37.12737703323364
Epoch: 10, Steps: 369 | Train Loss: 0.336 Vali Loss: 0.736 Vali Acc: 0.654 Test Loss: 0.736 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2762308
	speed: 0.3695s/iter; left time: 12234.9916s
	iters: 200, epoch: 11 | loss: 0.6038896
	speed: 0.0960s/iter; left time: 3169.7924s
	iters: 300, epoch: 11 | loss: 0.3794403
	speed: 0.0853s/iter; left time: 2806.7459s
Epoch: 11 cost time: 35.0284423828125
Epoch: 11, Steps: 369 | Train Loss: 0.306 Vali Loss: 0.899 Vali Acc: 0.656 Test Loss: 0.899 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.4883317
	speed: 0.3585s/iter; left time: 11737.0031s
	iters: 200, epoch: 12 | loss: 0.1498511
	speed: 0.1086s/iter; left time: 3543.5053s
	iters: 300, epoch: 12 | loss: 0.1301298
	speed: 0.0846s/iter; left time: 2752.6412s
Epoch: 12 cost time: 35.68366765975952
Epoch: 12, Steps: 369 | Train Loss: 0.273 Vali Loss: 1.083 Vali Acc: 0.648 Test Loss: 1.083 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0228268
	speed: 0.3446s/iter; left time: 11156.5489s
	iters: 200, epoch: 13 | loss: 0.6423748
	speed: 0.1024s/iter; left time: 3305.1491s
	iters: 300, epoch: 13 | loss: 0.1806448
	speed: 0.0849s/iter; left time: 2730.6872s
Epoch: 13 cost time: 35.18065047264099
Epoch: 13, Steps: 369 | Train Loss: 0.240 Vali Loss: 1.063 Vali Acc: 0.657 Test Loss: 1.063 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1314168
	speed: 0.3544s/iter; left time: 11342.0511s
	iters: 200, epoch: 14 | loss: 0.3458664
	speed: 0.0961s/iter; left time: 3066.1174s
	iters: 300, epoch: 14 | loss: 0.0324574
	speed: 0.1092s/iter; left time: 3473.2021s
Epoch: 14 cost time: 37.59709024429321
Epoch: 14, Steps: 369 | Train Loss: 0.222 Vali Loss: 1.063 Vali Acc: 0.646 Test Loss: 1.063 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0527116
	speed: 0.3235s/iter; left time: 10234.6113s
	iters: 200, epoch: 15 | loss: 0.1085038
	speed: 0.0791s/iter; left time: 2493.5740s
	iters: 300, epoch: 15 | loss: 0.1102442
	speed: 0.1078s/iter; left time: 3389.3018s
Epoch: 15 cost time: 36.000986099243164
Epoch: 15, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.093 Vali Acc: 0.646 Test Loss: 1.093 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6816118047673099
model parameter : 476870
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8093981
	speed: 0.1066s/iter; left time: 3921.5672s
	iters: 200, epoch: 1 | loss: 0.7255807
	speed: 0.1006s/iter; left time: 3693.7879s
	iters: 300, epoch: 1 | loss: 0.7132985
	speed: 0.0895s/iter; left time: 3275.5490s
Epoch: 1 cost time: 37.78201222419739
Epoch: 1, Steps: 369 | Train Loss: 0.741 Vali Loss: 1.854 Vali Acc: 0.505 Test Loss: 1.854 Test Acc: 0.505
Validation loss decreased (inf --> -0.505089).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6233541
	speed: 0.4264s/iter; left time: 15533.9785s
	iters: 200, epoch: 2 | loss: 0.5733078
	speed: 0.0857s/iter; left time: 3114.4821s
	iters: 300, epoch: 2 | loss: 0.3450612
	speed: 0.0979s/iter; left time: 3547.8070s
Epoch: 2 cost time: 35.881378412246704
Epoch: 2, Steps: 369 | Train Loss: 0.682 Vali Loss: 0.698 Vali Acc: 0.651 Test Loss: 0.698 Test Acc: 0.651
Validation loss decreased (-0.505089 --> -0.651242).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6867500
	speed: 0.4609s/iter; left time: 16621.4697s
	iters: 200, epoch: 3 | loss: 0.7081898
	speed: 0.0932s/iter; left time: 3350.2540s
	iters: 300, epoch: 3 | loss: 0.2705978
	speed: 0.1106s/iter; left time: 3968.1414s
Epoch: 3 cost time: 37.9210569858551
Epoch: 3, Steps: 369 | Train Loss: 0.616 Vali Loss: 0.765 Vali Acc: 0.573 Test Loss: 0.765 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9569981
	speed: 0.4710s/iter; left time: 16812.5547s
	iters: 200, epoch: 4 | loss: 0.7384445
	speed: 0.0901s/iter; left time: 3205.3197s
	iters: 300, epoch: 4 | loss: 0.3364208
	speed: 0.0995s/iter; left time: 3532.1168s
Epoch: 4 cost time: 37.36333131790161
Epoch: 4, Steps: 369 | Train Loss: 0.595 Vali Loss: 0.762 Vali Acc: 0.610 Test Loss: 0.762 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5082797
	speed: 0.4339s/iter; left time: 15326.0500s
	iters: 200, epoch: 5 | loss: 0.5585774
	speed: 0.0975s/iter; left time: 3433.9652s
	iters: 300, epoch: 5 | loss: 0.5949960
	speed: 0.0904s/iter; left time: 3174.3397s
Epoch: 5 cost time: 35.81364154815674
Epoch: 5, Steps: 369 | Train Loss: 0.538 Vali Loss: 0.623 Vali Acc: 0.666 Test Loss: 0.623 Test Acc: 0.666
Validation loss decreased (-0.651242 --> -0.666282).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8179246
	speed: 0.4331s/iter; left time: 15139.4022s
	iters: 200, epoch: 6 | loss: 0.2654955
	speed: 0.0919s/iter; left time: 3201.8001s
	iters: 300, epoch: 6 | loss: 0.6838289
	speed: 0.0876s/iter; left time: 3044.8903s
Epoch: 6 cost time: 35.66916561126709
Epoch: 6, Steps: 369 | Train Loss: 0.482 Vali Loss: 0.616 Vali Acc: 0.678 Test Loss: 0.616 Test Acc: 0.678
Validation loss decreased (-0.666282 --> -0.677633).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6040809
	speed: 0.4306s/iter; left time: 14891.6302s
	iters: 200, epoch: 7 | loss: 0.3887762
	speed: 0.1022s/iter; left time: 3523.6447s
	iters: 300, epoch: 7 | loss: 0.4171489
	speed: 0.0848s/iter; left time: 2914.5780s
Epoch: 7 cost time: 35.80461120605469
Epoch: 7, Steps: 369 | Train Loss: 0.438 Vali Loss: 0.654 Vali Acc: 0.668 Test Loss: 0.654 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2023914
	speed: 0.4511s/iter; left time: 15435.0476s
	iters: 200, epoch: 8 | loss: 0.2821387
	speed: 0.0913s/iter; left time: 3114.0996s
	iters: 300, epoch: 8 | loss: 0.1887634
	speed: 0.1004s/iter; left time: 3414.5660s
Epoch: 8 cost time: 37.780834436416626
Epoch: 8, Steps: 369 | Train Loss: 0.399 Vali Loss: 0.746 Vali Acc: 0.664 Test Loss: 0.746 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3675654
	speed: 0.4565s/iter; left time: 15453.7113s
	iters: 200, epoch: 9 | loss: 0.4303544
	speed: 0.0835s/iter; left time: 2818.3648s
	iters: 300, epoch: 9 | loss: 0.4271170
	speed: 0.0785s/iter; left time: 2641.2996s
Epoch: 9 cost time: 33.05669713020325
Epoch: 9, Steps: 369 | Train Loss: 0.367 Vali Loss: 0.765 Vali Acc: 0.662 Test Loss: 0.765 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2744085
	speed: 0.4598s/iter; left time: 15394.6016s
	iters: 200, epoch: 10 | loss: 0.6582258
	speed: 0.0861s/iter; left time: 2874.3274s
	iters: 300, epoch: 10 | loss: 0.3576250
	speed: 0.1029s/iter; left time: 3425.0093s
Epoch: 10 cost time: 37.411458253860474
Epoch: 10, Steps: 369 | Train Loss: 0.346 Vali Loss: 0.892 Vali Acc: 0.646 Test Loss: 0.892 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3775128
	speed: 0.4587s/iter; left time: 15186.7103s
	iters: 200, epoch: 11 | loss: 0.1047187
	speed: 0.1022s/iter; left time: 3375.2739s
	iters: 300, epoch: 11 | loss: 0.2674233
	speed: 0.1013s/iter; left time: 3334.7816s
Epoch: 11 cost time: 39.53910684585571
Epoch: 11, Steps: 369 | Train Loss: 0.315 Vali Loss: 0.784 Vali Acc: 0.665 Test Loss: 0.784 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2513300
	speed: 0.4683s/iter; left time: 15332.4517s
	iters: 200, epoch: 12 | loss: 0.3208703
	speed: 0.1045s/iter; left time: 3412.6271s
	iters: 300, epoch: 12 | loss: 0.5360376
	speed: 0.0910s/iter; left time: 2961.4117s
Epoch: 12 cost time: 37.451695919036865
Epoch: 12, Steps: 369 | Train Loss: 0.275 Vali Loss: 0.881 Vali Acc: 0.666 Test Loss: 0.881 Test Acc: 0.666
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1811734
	speed: 0.4170s/iter; left time: 13500.3345s
	iters: 200, epoch: 13 | loss: 0.1678530
	speed: 0.0936s/iter; left time: 3020.8670s
	iters: 300, epoch: 13 | loss: 0.2896851
	speed: 0.0956s/iter; left time: 3075.8736s
Epoch: 13 cost time: 34.22866368293762
Epoch: 13, Steps: 369 | Train Loss: 0.254 Vali Loss: 0.913 Vali Acc: 0.659 Test Loss: 0.913 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.6523823
	speed: 0.3918s/iter; left time: 12540.0853s
	iters: 200, epoch: 14 | loss: 0.1383589
	speed: 0.0976s/iter; left time: 3114.1270s
	iters: 300, epoch: 14 | loss: 0.4055220
	speed: 0.0847s/iter; left time: 2694.2910s
Epoch: 14 cost time: 34.90010714530945
Epoch: 14, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.032 Vali Acc: 0.650 Test Loss: 1.032 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1252854
	speed: 0.4190s/iter; left time: 13253.8786s
	iters: 200, epoch: 15 | loss: 0.4752532
	speed: 0.0886s/iter; left time: 2792.9885s
	iters: 300, epoch: 15 | loss: 0.2356749
	speed: 0.0867s/iter; left time: 2725.0252s
Epoch: 15 cost time: 34.99414038658142
Epoch: 15, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.156 Vali Acc: 0.654 Test Loss: 1.156 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2477362
	speed: 0.4440s/iter; left time: 13882.2360s
	iters: 200, epoch: 16 | loss: 0.5430315
	speed: 0.1020s/iter; left time: 3179.8244s
	iters: 300, epoch: 16 | loss: 0.1664119
	speed: 0.0996s/iter; left time: 3093.8907s
Epoch: 16 cost time: 37.66865563392639
Epoch: 16, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.389 Vali Acc: 0.640 Test Loss: 1.389 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.677639046538025
model parameter : 476582
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7749253
	speed: 0.1378s/iter; left time: 5073.0174s
	iters: 200, epoch: 1 | loss: 0.7717795
	speed: 0.1089s/iter; left time: 3995.3484s
	iters: 300, epoch: 1 | loss: 0.5765855
	speed: 0.0965s/iter; left time: 3531.3387s
Epoch: 1 cost time: 40.05192017555237
Epoch: 1, Steps: 369 | Train Loss: 0.749 Vali Loss: 1.121 Vali Acc: 0.557 Test Loss: 1.121 Test Acc: 0.557
Validation loss decreased (inf --> -0.556742).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4288037
	speed: 0.4007s/iter; left time: 14596.5540s
	iters: 200, epoch: 2 | loss: 0.4293534
	speed: 0.0807s/iter; left time: 2930.4535s
	iters: 300, epoch: 2 | loss: 0.5424492
	speed: 0.0724s/iter; left time: 2624.6043s
Epoch: 2 cost time: 29.505670309066772
Epoch: 2, Steps: 369 | Train Loss: 0.660 Vali Loss: 1.580 Vali Acc: 0.547 Test Loss: 1.580 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8849403
	speed: 0.4583s/iter; left time: 16528.7661s
	iters: 200, epoch: 3 | loss: 0.6042301
	speed: 0.0791s/iter; left time: 2843.2812s
	iters: 300, epoch: 3 | loss: 0.9159384
	speed: 0.0957s/iter; left time: 3432.2284s
Epoch: 3 cost time: 33.51583480834961
Epoch: 3, Steps: 369 | Train Loss: 0.685 Vali Loss: 0.929 Vali Acc: 0.612 Test Loss: 0.929 Test Acc: 0.612
Validation loss decreased (-0.556742 --> -0.611795).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5379188
	speed: 0.4902s/iter; left time: 17497.1395s
	iters: 200, epoch: 4 | loss: 0.6684720
	speed: 0.1067s/iter; left time: 3796.2551s
	iters: 300, epoch: 4 | loss: 0.7876360
	speed: 0.1037s/iter; left time: 3682.1987s
Epoch: 4 cost time: 41.5671591758728
Epoch: 4, Steps: 369 | Train Loss: 0.590 Vali Loss: 0.779 Vali Acc: 0.654 Test Loss: 0.779 Test Acc: 0.654
Validation loss decreased (-0.611795 --> -0.654362).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3525477
	speed: 0.4865s/iter; left time: 17184.1280s
	iters: 200, epoch: 5 | loss: 0.4585151
	speed: 0.0861s/iter; left time: 3034.3003s
	iters: 300, epoch: 5 | loss: 0.5982606
	speed: 0.0953s/iter; left time: 3348.5244s
Epoch: 5 cost time: 35.07018303871155
Epoch: 5, Steps: 369 | Train Loss: 0.515 Vali Loss: 0.668 Vali Acc: 0.682 Test Loss: 0.668 Test Acc: 0.682
Validation loss decreased (-0.654362 --> -0.681605).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3176352
	speed: 0.4230s/iter; left time: 14785.3424s
	iters: 200, epoch: 6 | loss: 0.5239918
	speed: 0.0797s/iter; left time: 2776.9746s
	iters: 300, epoch: 6 | loss: 0.8588005
	speed: 0.0971s/iter; left time: 3374.5071s
Epoch: 6 cost time: 33.69703912734985
Epoch: 6, Steps: 369 | Train Loss: 0.457 Vali Loss: 0.642 Vali Acc: 0.680 Test Loss: 0.642 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3575446
	speed: 0.4724s/iter; left time: 16337.9878s
	iters: 200, epoch: 7 | loss: 0.3490877
	speed: 0.0954s/iter; left time: 3288.3572s
	iters: 300, epoch: 7 | loss: 0.4057747
	speed: 0.0997s/iter; left time: 3426.8558s
Epoch: 7 cost time: 38.21512722969055
Epoch: 7, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.705 Vali Acc: 0.668 Test Loss: 0.705 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2747444
	speed: 0.4592s/iter; left time: 15713.8139s
	iters: 200, epoch: 8 | loss: 0.3768509
	speed: 0.0924s/iter; left time: 3152.7505s
	iters: 300, epoch: 8 | loss: 0.6265698
	speed: 0.1035s/iter; left time: 3519.7130s
Epoch: 8 cost time: 37.53240919113159
Epoch: 8, Steps: 369 | Train Loss: 0.389 Vali Loss: 0.688 Vali Acc: 0.659 Test Loss: 0.688 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4638735
	speed: 0.4845s/iter; left time: 16399.6714s
	iters: 200, epoch: 9 | loss: 0.4726578
	speed: 0.0985s/iter; left time: 3323.0459s
	iters: 300, epoch: 9 | loss: 0.2026756
	speed: 0.1008s/iter; left time: 3391.2087s
Epoch: 9 cost time: 39.0013542175293
Epoch: 9, Steps: 369 | Train Loss: 0.357 Vali Loss: 0.752 Vali Acc: 0.668 Test Loss: 0.752 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2366409
	speed: 0.4999s/iter; left time: 16738.0805s
	iters: 200, epoch: 10 | loss: 0.1356603
	speed: 0.0876s/iter; left time: 2923.0887s
	iters: 300, epoch: 10 | loss: 0.5059279
	speed: 0.0668s/iter; left time: 2224.3878s
Epoch: 10 cost time: 31.201991081237793
Epoch: 10, Steps: 369 | Train Loss: 0.322 Vali Loss: 0.804 Vali Acc: 0.657 Test Loss: 0.804 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2291789
	speed: 0.4177s/iter; left time: 13830.8929s
	iters: 200, epoch: 11 | loss: 0.2399449
	speed: 0.0841s/iter; left time: 2776.8079s
	iters: 300, epoch: 11 | loss: 0.2516668
	speed: 0.0968s/iter; left time: 3184.8508s
Epoch: 11 cost time: 36.44871282577515
Epoch: 11, Steps: 369 | Train Loss: 0.280 Vali Loss: 0.811 Vali Acc: 0.673 Test Loss: 0.811 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.7805804
	speed: 0.5038s/iter; left time: 16494.3081s
	iters: 200, epoch: 12 | loss: 0.2956038
	speed: 0.0950s/iter; left time: 3099.6332s
	iters: 300, epoch: 12 | loss: 0.2059061
	speed: 0.0936s/iter; left time: 3045.1288s
Epoch: 12 cost time: 38.79275035858154
Epoch: 12, Steps: 369 | Train Loss: 0.256 Vali Loss: 0.918 Vali Acc: 0.665 Test Loss: 0.918 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.3087166
	speed: 0.4877s/iter; left time: 15789.8280s
	iters: 200, epoch: 13 | loss: 0.0804661
	speed: 0.1034s/iter; left time: 3336.8140s
	iters: 300, epoch: 13 | loss: 0.1504909
	speed: 0.1069s/iter; left time: 3439.0533s
Epoch: 13 cost time: 40.78429865837097
Epoch: 13, Steps: 369 | Train Loss: 0.210 Vali Loss: 1.269 Vali Acc: 0.634 Test Loss: 1.269 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0691890
	speed: 0.4944s/iter; left time: 15821.7621s
	iters: 200, epoch: 14 | loss: 0.3643800
	speed: 0.1000s/iter; left time: 3189.0456s
	iters: 300, epoch: 14 | loss: 0.1400449
	speed: 0.1002s/iter; left time: 3185.8166s
Epoch: 14 cost time: 37.69641661643982
Epoch: 14, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.206 Vali Acc: 0.638 Test Loss: 1.206 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1764304
	speed: 0.4440s/iter; left time: 14044.4104s
	iters: 200, epoch: 15 | loss: 0.5731930
	speed: 0.1000s/iter; left time: 3154.7230s
	iters: 300, epoch: 15 | loss: 0.2019702
	speed: 0.0868s/iter; left time: 2727.1732s
Epoch: 15 cost time: 35.777421951293945
Epoch: 15, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.298 Vali Acc: 0.657 Test Loss: 1.298 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6816118047673099
model parameter : 311046
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6659420
	speed: 0.1159s/iter; left time: 4266.7229s
	iters: 200, epoch: 1 | loss: 1.6957843
	speed: 0.0753s/iter; left time: 2762.3968s
	iters: 300, epoch: 1 | loss: 0.8480905
	speed: 0.0773s/iter; left time: 2830.6291s
Epoch: 1 cost time: 32.686683654785156
Epoch: 1, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.964 Vali Acc: 0.589 Test Loss: 0.964 Test Acc: 0.589
Validation loss decreased (inf --> -0.589377).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4260798
	speed: 0.4711s/iter; left time: 17161.3570s
	iters: 200, epoch: 2 | loss: 0.8350290
	speed: 0.1347s/iter; left time: 4892.8394s
	iters: 300, epoch: 2 | loss: 1.1476226
	speed: 0.1268s/iter; left time: 4594.7709s
Epoch: 2 cost time: 45.100088119506836
Epoch: 2, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.692 Vali Acc: 0.649 Test Loss: 0.692 Test Acc: 0.649
Validation loss decreased (-0.589377 --> -0.648688).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8545083
	speed: 0.4413s/iter; left time: 15915.7385s
	iters: 200, epoch: 3 | loss: 0.4074481
	speed: 0.1227s/iter; left time: 4414.2595s
	iters: 300, epoch: 3 | loss: 0.6441677
	speed: 0.1193s/iter; left time: 4278.5621s
Epoch: 3 cost time: 41.96423959732056
Epoch: 3, Steps: 369 | Train Loss: 0.614 Vali Loss: 0.745 Vali Acc: 0.614 Test Loss: 0.745 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3339790
	speed: 0.4657s/iter; left time: 16621.3736s
	iters: 200, epoch: 4 | loss: 0.2366412
	speed: 0.1103s/iter; left time: 3924.4196s
	iters: 300, epoch: 4 | loss: 0.8357964
	speed: 0.1389s/iter; left time: 4929.7957s
Epoch: 4 cost time: 44.66152763366699
Epoch: 4, Steps: 369 | Train Loss: 0.535 Vali Loss: 0.604 Vali Acc: 0.684 Test Loss: 0.604 Test Acc: 0.684
Validation loss decreased (-0.648688 --> -0.684443).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4923871
	speed: 0.5082s/iter; left time: 17952.3343s
	iters: 200, epoch: 5 | loss: 0.5832416
	speed: 0.1220s/iter; left time: 4296.8490s
	iters: 300, epoch: 5 | loss: 0.7034513
	speed: 0.1246s/iter; left time: 4377.9139s
Epoch: 5 cost time: 44.779303550720215
Epoch: 5, Steps: 369 | Train Loss: 0.497 Vali Loss: 0.615 Vali Acc: 0.675 Test Loss: 0.615 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5233540
	speed: 0.4951s/iter; left time: 17306.0830s
	iters: 200, epoch: 6 | loss: 0.3533952
	speed: 0.1348s/iter; left time: 4698.1881s
	iters: 300, epoch: 6 | loss: 0.3917691
	speed: 0.1097s/iter; left time: 3812.0642s
Epoch: 6 cost time: 44.79912209510803
Epoch: 6, Steps: 369 | Train Loss: 0.441 Vali Loss: 0.645 Vali Acc: 0.685 Test Loss: 0.645 Test Acc: 0.685
Validation loss decreased (-0.684443 --> -0.685011).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3070455
	speed: 0.5466s/iter; left time: 18905.7081s
	iters: 200, epoch: 7 | loss: 0.2827235
	speed: 0.1331s/iter; left time: 4589.9862s
	iters: 300, epoch: 7 | loss: 0.4327573
	speed: 0.1198s/iter; left time: 4118.2165s
Epoch: 7 cost time: 49.9164035320282
Epoch: 7, Steps: 369 | Train Loss: 0.405 Vali Loss: 0.799 Vali Acc: 0.665 Test Loss: 0.799 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2488611
	speed: 0.5863s/iter; left time: 20061.0286s
	iters: 200, epoch: 8 | loss: 0.2103811
	speed: 0.1251s/iter; left time: 4268.7689s
	iters: 300, epoch: 8 | loss: 0.2729332
	speed: 0.1195s/iter; left time: 4064.7312s
Epoch: 8 cost time: 50.41971278190613
Epoch: 8, Steps: 369 | Train Loss: 0.372 Vali Loss: 0.729 Vali Acc: 0.665 Test Loss: 0.729 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6001009
	speed: 0.6111s/iter; left time: 20683.9245s
	iters: 200, epoch: 9 | loss: 0.1824855
	speed: 0.1351s/iter; left time: 4558.9610s
	iters: 300, epoch: 9 | loss: 0.2769602
	speed: 0.1279s/iter; left time: 4305.1462s
Epoch: 9 cost time: 49.42086696624756
Epoch: 9, Steps: 369 | Train Loss: 0.331 Vali Loss: 0.810 Vali Acc: 0.660 Test Loss: 0.810 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3308985
	speed: 0.5190s/iter; left time: 17376.3471s
	iters: 200, epoch: 10 | loss: 0.2365478
	speed: 0.1255s/iter; left time: 4189.7066s
	iters: 300, epoch: 10 | loss: 0.1962343
	speed: 0.1202s/iter; left time: 4000.5596s
Epoch: 10 cost time: 47.23056387901306
Epoch: 10, Steps: 369 | Train Loss: 0.296 Vali Loss: 0.912 Vali Acc: 0.652 Test Loss: 0.912 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3071510
	speed: 0.5710s/iter; left time: 18906.3460s
	iters: 200, epoch: 11 | loss: 0.1464237
	speed: 0.1141s/iter; left time: 3767.5926s
	iters: 300, epoch: 11 | loss: 0.2535382
	speed: 0.1301s/iter; left time: 4282.8412s
Epoch: 11 cost time: 49.91684174537659
Epoch: 11, Steps: 369 | Train Loss: 0.265 Vali Loss: 0.968 Vali Acc: 0.652 Test Loss: 0.968 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2758835
	speed: 0.5492s/iter; left time: 17981.7942s
	iters: 200, epoch: 12 | loss: 0.0715694
	speed: 0.1166s/iter; left time: 3807.6326s
	iters: 300, epoch: 12 | loss: 0.3121560
	speed: 0.1344s/iter; left time: 4373.9515s
Epoch: 12 cost time: 46.64504313468933
Epoch: 12, Steps: 369 | Train Loss: 0.226 Vali Loss: 1.005 Vali Acc: 0.657 Test Loss: 1.005 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2394285
	speed: 0.5741s/iter; left time: 18585.7056s
	iters: 200, epoch: 13 | loss: 0.2493583
	speed: 0.1260s/iter; left time: 4067.7112s
	iters: 300, epoch: 13 | loss: 0.0757689
	speed: 0.1062s/iter; left time: 3417.6914s
Epoch: 13 cost time: 45.04598355293274
Epoch: 13, Steps: 369 | Train Loss: 0.202 Vali Loss: 1.162 Vali Acc: 0.649 Test Loss: 1.162 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.6890829
	speed: 0.4899s/iter; left time: 15678.0903s
	iters: 200, epoch: 14 | loss: 0.1026830
	speed: 0.0989s/iter; left time: 3156.5065s
	iters: 300, epoch: 14 | loss: 0.3345616
	speed: 0.0978s/iter; left time: 3109.0514s
Epoch: 14 cost time: 39.08099603652954
Epoch: 14, Steps: 369 | Train Loss: 0.179 Vali Loss: 1.380 Vali Acc: 0.663 Test Loss: 1.380 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0936965
	speed: 0.4673s/iter; left time: 14783.6200s
	iters: 200, epoch: 15 | loss: 0.2708331
	speed: 0.1001s/iter; left time: 3155.5590s
	iters: 300, epoch: 15 | loss: 0.2362241
	speed: 0.1080s/iter; left time: 3395.1464s
Epoch: 15 cost time: 39.30570197105408
Epoch: 15, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.337 Vali Acc: 0.646 Test Loss: 1.337 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0198367
	speed: 0.4378s/iter; left time: 13688.2462s
	iters: 200, epoch: 16 | loss: 0.0356396
	speed: 0.0891s/iter; left time: 2777.9657s
	iters: 300, epoch: 16 | loss: 0.0726532
	speed: 0.0924s/iter; left time: 2870.4645s
Epoch: 16 cost time: 36.60849165916443
Epoch: 16, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.284 Vali Acc: 0.651 Test Loss: 1.284 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6850170261066969
model parameter : 310758
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7930443
	speed: 0.1550s/iter; left time: 5704.3414s
	iters: 200, epoch: 1 | loss: 1.7245438
	speed: 0.1354s/iter; left time: 4969.9553s
	iters: 300, epoch: 1 | loss: 0.3307543
	speed: 0.1167s/iter; left time: 4269.8746s
Epoch: 1 cost time: 48.8893404006958
Epoch: 1, Steps: 369 | Train Loss: 0.784 Vali Loss: 0.759 Vali Acc: 0.632 Test Loss: 0.759 Test Acc: 0.632
Validation loss decreased (inf --> -0.631945).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6407784
	speed: 0.5289s/iter; left time: 19269.6152s
	iters: 200, epoch: 2 | loss: 0.9363819
	speed: 0.1148s/iter; left time: 4170.6131s
	iters: 300, epoch: 2 | loss: 0.5986093
	speed: 0.1144s/iter; left time: 4144.4832s
Epoch: 2 cost time: 44.083863735198975
Epoch: 2, Steps: 369 | Train Loss: 0.736 Vali Loss: 0.662 Vali Acc: 0.670 Test Loss: 0.662 Test Acc: 0.670
Validation loss decreased (-0.631945 --> -0.670254).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4052501
	speed: 0.5184s/iter; left time: 18695.2322s
	iters: 200, epoch: 3 | loss: 0.3835029
	speed: 0.1005s/iter; left time: 3613.8138s
	iters: 300, epoch: 3 | loss: 0.7415084
	speed: 0.0913s/iter; left time: 3275.4842s
Epoch: 3 cost time: 41.11179304122925
Epoch: 3, Steps: 369 | Train Loss: 0.609 Vali Loss: 0.691 Vali Acc: 0.663 Test Loss: 0.691 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4869007
	speed: 0.5226s/iter; left time: 18654.1127s
	iters: 200, epoch: 4 | loss: 0.7193615
	speed: 0.1046s/iter; left time: 3721.4555s
	iters: 300, epoch: 4 | loss: 0.4448994
	speed: 0.0887s/iter; left time: 3149.0191s
Epoch: 4 cost time: 42.519628047943115
Epoch: 4, Steps: 369 | Train Loss: 0.566 Vali Loss: 0.726 Vali Acc: 0.655 Test Loss: 0.726 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3350893
	speed: 0.5071s/iter; left time: 17913.6100s
	iters: 200, epoch: 5 | loss: 0.5381408
	speed: 0.1117s/iter; left time: 3934.2130s
	iters: 300, epoch: 5 | loss: 0.3142914
	speed: 0.0999s/iter; left time: 3509.6126s
Epoch: 5 cost time: 42.69504356384277
Epoch: 5, Steps: 369 | Train Loss: 0.508 Vali Loss: 0.667 Vali Acc: 0.664 Test Loss: 0.667 Test Acc: 0.664
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.4458915
	speed: 0.5094s/iter; left time: 17805.3540s
	iters: 200, epoch: 6 | loss: 0.4063175
	speed: 0.0948s/iter; left time: 3303.6946s
	iters: 300, epoch: 6 | loss: 0.5663980
	speed: 0.1032s/iter; left time: 3585.5354s
Epoch: 6 cost time: 42.376301765441895
Epoch: 6, Steps: 369 | Train Loss: 0.454 Vali Loss: 0.663 Vali Acc: 0.659 Test Loss: 0.663 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2926886
	speed: 0.5008s/iter; left time: 17320.8091s
	iters: 200, epoch: 7 | loss: 0.5431079
	speed: 0.0912s/iter; left time: 3145.6697s
	iters: 300, epoch: 7 | loss: 0.5628474
	speed: 0.0978s/iter; left time: 3364.6256s
Epoch: 7 cost time: 40.737597942352295
Epoch: 7, Steps: 369 | Train Loss: 0.420 Vali Loss: 0.724 Vali Acc: 0.653 Test Loss: 0.724 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.4405732
	speed: 0.4914s/iter; left time: 16813.2807s
	iters: 200, epoch: 8 | loss: 0.3885871
	speed: 0.0955s/iter; left time: 3258.4228s
	iters: 300, epoch: 8 | loss: 0.4954579
	speed: 0.1082s/iter; left time: 3680.2725s
Epoch: 8 cost time: 43.2706344127655
Epoch: 8, Steps: 369 | Train Loss: 0.387 Vali Loss: 0.905 Vali Acc: 0.651 Test Loss: 0.905 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.2053546
	speed: 0.4703s/iter; left time: 15920.6368s
	iters: 200, epoch: 9 | loss: 0.4253885
	speed: 0.1089s/iter; left time: 3674.3235s
	iters: 300, epoch: 9 | loss: 0.4044772
	speed: 0.1041s/iter; left time: 3503.9962s
Epoch: 9 cost time: 43.63532471656799
Epoch: 9, Steps: 369 | Train Loss: 0.360 Vali Loss: 0.801 Vali Acc: 0.670 Test Loss: 0.801 Test Acc: 0.670
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.4431453
	speed: 0.4853s/iter; left time: 16246.4995s
	iters: 200, epoch: 10 | loss: 0.2015211
	speed: 0.0761s/iter; left time: 2540.5552s
	iters: 300, epoch: 10 | loss: 0.4542723
	speed: 0.0687s/iter; left time: 2286.2486s
Epoch: 10 cost time: 30.06198000907898
Epoch: 10, Steps: 369 | Train Loss: 0.326 Vali Loss: 0.841 Vali Acc: 0.664 Test Loss: 0.841 Test Acc: 0.664
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.3275862
	speed: 0.3679s/iter; left time: 12181.4969s
	iters: 200, epoch: 11 | loss: 0.1644099
	speed: 0.0735s/iter; left time: 2426.7535s
	iters: 300, epoch: 11 | loss: 0.3528653
	speed: 0.0640s/iter; left time: 2106.1151s
Epoch: 11 cost time: 27.507917404174805
Epoch: 11, Steps: 369 | Train Loss: 0.290 Vali Loss: 0.863 Vali Acc: 0.649 Test Loss: 0.863 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.2236566
	speed: 0.3455s/iter; left time: 11312.2681s
	iters: 200, epoch: 12 | loss: 0.5522061
	speed: 0.0644s/iter; left time: 2101.2773s
	iters: 300, epoch: 12 | loss: 0.1630309
	speed: 0.0665s/iter; left time: 2165.5410s
Epoch: 12 cost time: 26.04094386100769
Epoch: 12, Steps: 369 | Train Loss: 0.253 Vali Loss: 0.896 Vali Acc: 0.650 Test Loss: 0.896 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6702610669693531
model parameter : 310470
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6621181
	speed: 0.1591s/iter; left time: 5855.3417s
	iters: 200, epoch: 1 | loss: 0.6416775
	speed: 0.0904s/iter; left time: 3317.8220s
	iters: 300, epoch: 1 | loss: 0.5920717
	speed: 0.0996s/iter; left time: 3644.4467s
Epoch: 1 cost time: 43.62367057800293
Epoch: 1, Steps: 369 | Train Loss: 0.760 Vali Loss: 0.669 Vali Acc: 0.665 Test Loss: 0.669 Test Acc: 0.665
Validation loss decreased (inf --> -0.664863).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4855415
	speed: 0.5354s/iter; left time: 19503.9061s
	iters: 200, epoch: 2 | loss: 0.5266647
	speed: 0.1163s/iter; left time: 4224.2677s
	iters: 300, epoch: 2 | loss: 0.4696563
	speed: 0.1227s/iter; left time: 4444.0851s
Epoch: 2 cost time: 46.25185966491699
Epoch: 2, Steps: 369 | Train Loss: 0.647 Vali Loss: 0.745 Vali Acc: 0.650 Test Loss: 0.745 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3260331
	speed: 0.4741s/iter; left time: 17098.3911s
	iters: 200, epoch: 3 | loss: 0.8702036
	speed: 0.1010s/iter; left time: 3631.8583s
	iters: 300, epoch: 3 | loss: 0.4298619
	speed: 0.1046s/iter; left time: 3750.8527s
Epoch: 3 cost time: 41.90179085731506
Epoch: 3, Steps: 369 | Train Loss: 0.620 Vali Loss: 0.932 Vali Acc: 0.614 Test Loss: 0.932 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.3647873
	speed: 0.4995s/iter; left time: 17829.0523s
	iters: 200, epoch: 4 | loss: 1.1114895
	speed: 0.0950s/iter; left time: 3381.5184s
	iters: 300, epoch: 4 | loss: 0.7934638
	speed: 0.1070s/iter; left time: 3799.1963s
Epoch: 4 cost time: 44.23264122009277
Epoch: 4, Steps: 369 | Train Loss: 0.557 Vali Loss: 0.634 Vali Acc: 0.674 Test Loss: 0.634 Test Acc: 0.674
Validation loss decreased (-0.664863 --> -0.673660).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5276971
	speed: 0.5194s/iter; left time: 18349.2730s
	iters: 200, epoch: 5 | loss: 0.6378678
	speed: 0.1041s/iter; left time: 3667.1583s
	iters: 300, epoch: 5 | loss: 0.4022299
	speed: 0.1024s/iter; left time: 3598.2283s
Epoch: 5 cost time: 43.99744963645935
Epoch: 5, Steps: 369 | Train Loss: 0.508 Vali Loss: 0.651 Vali Acc: 0.663 Test Loss: 0.651 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6492814
	speed: 0.4599s/iter; left time: 16076.9225s
	iters: 200, epoch: 6 | loss: 1.0434912
	speed: 0.1056s/iter; left time: 3680.1081s
	iters: 300, epoch: 6 | loss: 0.4746618
	speed: 0.0924s/iter; left time: 3210.0493s
Epoch: 6 cost time: 39.89133882522583
Epoch: 6, Steps: 369 | Train Loss: 0.448 Vali Loss: 0.725 Vali Acc: 0.670 Test Loss: 0.725 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1976656
	speed: 0.3963s/iter; left time: 13705.5970s
	iters: 200, epoch: 7 | loss: 0.2463860
	speed: 0.1174s/iter; left time: 4048.8361s
	iters: 300, epoch: 7 | loss: 0.5308123
	speed: 0.1082s/iter; left time: 3722.2658s
Epoch: 7 cost time: 39.30335450172424
Epoch: 7, Steps: 369 | Train Loss: 0.413 Vali Loss: 0.658 Vali Acc: 0.672 Test Loss: 0.658 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5078573
	speed: 0.4393s/iter; left time: 15033.3916s
	iters: 200, epoch: 8 | loss: 0.4040738
	speed: 0.1272s/iter; left time: 4338.4357s
	iters: 300, epoch: 8 | loss: 0.4127112
	speed: 0.1112s/iter; left time: 3783.0546s
Epoch: 8 cost time: 41.80133843421936
Epoch: 8, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.776 Vali Acc: 0.654 Test Loss: 0.776 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5867936
	speed: 0.4599s/iter; left time: 15566.7471s
	iters: 200, epoch: 9 | loss: 0.2674039
	speed: 0.1054s/iter; left time: 3556.7563s
	iters: 300, epoch: 9 | loss: 0.4841269
	speed: 0.1189s/iter; left time: 4000.6394s
Epoch: 9 cost time: 40.87391448020935
Epoch: 9, Steps: 369 | Train Loss: 0.338 Vali Loss: 0.791 Vali Acc: 0.666 Test Loss: 0.791 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0388245
	speed: 0.4493s/iter; left time: 15043.9936s
	iters: 200, epoch: 10 | loss: 0.3394691
	speed: 0.0918s/iter; left time: 3065.5630s
	iters: 300, epoch: 10 | loss: 0.2767727
	speed: 0.1254s/iter; left time: 4171.7090s
Epoch: 10 cost time: 39.69028973579407
Epoch: 10, Steps: 369 | Train Loss: 0.315 Vali Loss: 0.837 Vali Acc: 0.662 Test Loss: 0.837 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.4114324
	speed: 0.4472s/iter; left time: 14808.1100s
	iters: 200, epoch: 11 | loss: 0.2698132
	speed: 0.1034s/iter; left time: 3412.3259s
	iters: 300, epoch: 11 | loss: 0.1593238
	speed: 0.1034s/iter; left time: 3403.7406s
Epoch: 11 cost time: 41.944074869155884
Epoch: 11, Steps: 369 | Train Loss: 0.256 Vali Loss: 0.969 Vali Acc: 0.664 Test Loss: 0.969 Test Acc: 0.664
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1440925
	speed: 0.4795s/iter; left time: 15700.8684s
	iters: 200, epoch: 12 | loss: 0.3530643
	speed: 0.0956s/iter; left time: 3121.2806s
	iters: 300, epoch: 12 | loss: 0.0861145
	speed: 0.1041s/iter; left time: 3387.1286s
Epoch: 12 cost time: 42.458648443222046
Epoch: 12, Steps: 369 | Train Loss: 0.231 Vali Loss: 1.066 Vali Acc: 0.634 Test Loss: 1.066 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0811539
	speed: 0.4923s/iter; left time: 15936.0184s
	iters: 200, epoch: 13 | loss: 0.6453592
	speed: 0.1015s/iter; left time: 3276.2291s
	iters: 300, epoch: 13 | loss: 0.0596135
	speed: 0.1038s/iter; left time: 3340.8964s
Epoch: 13 cost time: 43.21583795547485
Epoch: 13, Steps: 369 | Train Loss: 0.210 Vali Loss: 0.974 Vali Acc: 0.649 Test Loss: 0.974 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1109991
	speed: 0.4842s/iter; left time: 15496.8318s
	iters: 200, epoch: 14 | loss: 0.0966596
	speed: 0.1005s/iter; left time: 3206.8841s
	iters: 300, epoch: 14 | loss: 0.0345476
	speed: 0.0958s/iter; left time: 3045.7111s
Epoch: 14 cost time: 41.70408391952515
Epoch: 14, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.149 Vali Acc: 0.654 Test Loss: 1.149 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6736662883087401
model parameter : 310182
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5324064
	speed: 0.1061s/iter; left time: 3903.0404s
	iters: 200, epoch: 1 | loss: 0.8501094
	speed: 0.0693s/iter; left time: 2544.9017s
	iters: 300, epoch: 1 | loss: 0.4558475
	speed: 0.0846s/iter; left time: 3098.1881s
Epoch: 1 cost time: 35.89225506782532
Epoch: 1, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.706 Vali Acc: 0.630 Test Loss: 0.706 Test Acc: 0.630
Validation loss decreased (inf --> -0.629675).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6155399
	speed: 0.4823s/iter; left time: 17572.7039s
	iters: 200, epoch: 2 | loss: 0.9407688
	speed: 0.1200s/iter; left time: 4361.3489s
	iters: 300, epoch: 2 | loss: 0.5942029
	speed: 0.1036s/iter; left time: 3754.6677s
Epoch: 2 cost time: 42.50715446472168
Epoch: 2, Steps: 369 | Train Loss: 0.748 Vali Loss: 1.045 Vali Acc: 0.568 Test Loss: 1.045 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3902126
	speed: 0.4066s/iter; left time: 14662.2025s
	iters: 200, epoch: 3 | loss: 0.5550294
	speed: 0.1189s/iter; left time: 4277.1890s
	iters: 300, epoch: 3 | loss: 0.6663789
	speed: 0.0993s/iter; left time: 3561.2848s
Epoch: 3 cost time: 38.72108459472656
Epoch: 3, Steps: 369 | Train Loss: 0.682 Vali Loss: 0.676 Vali Acc: 0.677 Test Loss: 0.676 Test Acc: 0.677
Validation loss decreased (-0.629675 --> -0.677065).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1591216
	speed: 0.3756s/iter; left time: 13407.1379s
	iters: 200, epoch: 4 | loss: 0.9209906
	speed: 0.0962s/iter; left time: 3422.9055s
	iters: 300, epoch: 4 | loss: 0.3691758
	speed: 0.1186s/iter; left time: 4208.3935s
Epoch: 4 cost time: 40.406930685043335
Epoch: 4, Steps: 369 | Train Loss: 0.549 Vali Loss: 0.688 Vali Acc: 0.669 Test Loss: 0.688 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5230463
	speed: 0.4114s/iter; left time: 14533.8514s
	iters: 200, epoch: 5 | loss: 0.6690258
	speed: 0.1065s/iter; left time: 3752.3462s
	iters: 300, epoch: 5 | loss: 0.4643932
	speed: 0.1006s/iter; left time: 3534.1602s
Epoch: 5 cost time: 43.18439698219299
Epoch: 5, Steps: 369 | Train Loss: 0.509 Vali Loss: 0.622 Vali Acc: 0.688 Test Loss: 0.622 Test Acc: 0.688
Validation loss decreased (-0.677065 --> -0.688132).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3449560
	speed: 0.4168s/iter; left time: 14570.4306s
	iters: 200, epoch: 6 | loss: 0.4153299
	speed: 0.1305s/iter; left time: 4548.8498s
	iters: 300, epoch: 6 | loss: 0.6210941
	speed: 0.1009s/iter; left time: 3505.7777s
Epoch: 6 cost time: 42.39486265182495
Epoch: 6, Steps: 369 | Train Loss: 0.451 Vali Loss: 0.702 Vali Acc: 0.677 Test Loss: 0.702 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3498751
	speed: 0.4044s/iter; left time: 13986.6129s
	iters: 200, epoch: 7 | loss: 0.3945179
	speed: 0.1232s/iter; left time: 4248.3631s
	iters: 300, epoch: 7 | loss: 0.5005410
	speed: 0.1114s/iter; left time: 3831.8256s
Epoch: 7 cost time: 40.569334506988525
Epoch: 7, Steps: 369 | Train Loss: 0.410 Vali Loss: 0.692 Vali Acc: 0.658 Test Loss: 0.692 Test Acc: 0.658
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3570807
	speed: 0.3793s/iter; left time: 12977.8054s
	iters: 200, epoch: 8 | loss: 0.2744260
	speed: 0.0868s/iter; left time: 2959.7452s
	iters: 300, epoch: 8 | loss: 0.3203615
	speed: 0.1112s/iter; left time: 3781.2349s
Epoch: 8 cost time: 38.71796679496765
Epoch: 8, Steps: 369 | Train Loss: 0.365 Vali Loss: 0.778 Vali Acc: 0.656 Test Loss: 0.778 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1819435
	speed: 0.4569s/iter; left time: 15466.9024s
	iters: 200, epoch: 9 | loss: 0.3012762
	speed: 0.1036s/iter; left time: 3497.9203s
	iters: 300, epoch: 9 | loss: 0.2905186
	speed: 0.0912s/iter; left time: 3069.4890s
Epoch: 9 cost time: 42.9702627658844
Epoch: 9, Steps: 369 | Train Loss: 0.348 Vali Loss: 0.810 Vali Acc: 0.660 Test Loss: 0.810 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3404267
	speed: 0.4287s/iter; left time: 14352.1746s
	iters: 200, epoch: 10 | loss: 0.2944568
	speed: 0.1224s/iter; left time: 4086.3986s
	iters: 300, epoch: 10 | loss: 0.3435020
	speed: 0.1075s/iter; left time: 3579.1283s
Epoch: 10 cost time: 41.92265439033508
Epoch: 10, Steps: 369 | Train Loss: 0.308 Vali Loss: 0.886 Vali Acc: 0.646 Test Loss: 0.886 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1156300
	speed: 0.4161s/iter; left time: 13776.6023s
	iters: 200, epoch: 11 | loss: 0.1245475
	speed: 0.1025s/iter; left time: 3383.2059s
	iters: 300, epoch: 11 | loss: 0.1586342
	speed: 0.1350s/iter; left time: 4442.7185s
Epoch: 11 cost time: 42.51716232299805
Epoch: 11, Steps: 369 | Train Loss: 0.264 Vali Loss: 0.975 Vali Acc: 0.670 Test Loss: 0.975 Test Acc: 0.670
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0846292
	speed: 0.4237s/iter; left time: 13873.0770s
	iters: 200, epoch: 12 | loss: 0.4675439
	speed: 0.0989s/iter; left time: 3227.6432s
	iters: 300, epoch: 12 | loss: 0.2113467
	speed: 0.1141s/iter; left time: 3713.5273s
Epoch: 12 cost time: 43.03738212585449
Epoch: 12, Steps: 369 | Train Loss: 0.243 Vali Loss: 0.933 Vali Acc: 0.656 Test Loss: 0.933 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0958398
	speed: 0.4360s/iter; left time: 14114.9387s
	iters: 200, epoch: 13 | loss: 0.1680377
	speed: 0.1164s/iter; left time: 3755.3241s
	iters: 300, epoch: 13 | loss: 0.0764679
	speed: 0.0964s/iter; left time: 3100.5928s
Epoch: 13 cost time: 44.072717905044556
Epoch: 13, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.051 Vali Acc: 0.661 Test Loss: 1.051 Test Acc: 0.661
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0281202
	speed: 0.3864s/iter; left time: 12365.3400s
	iters: 200, epoch: 14 | loss: 0.3170405
	speed: 0.1325s/iter; left time: 4226.2295s
	iters: 300, epoch: 14 | loss: 0.3433192
	speed: 0.1145s/iter; left time: 3641.8317s
Epoch: 14 cost time: 40.65326523780823
Epoch: 14, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.075 Vali Acc: 0.660 Test Loss: 1.075 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.2264707
	speed: 0.3931s/iter; left time: 12436.7949s
	iters: 200, epoch: 15 | loss: 0.3824438
	speed: 0.0987s/iter; left time: 3111.6929s
	iters: 300, epoch: 15 | loss: 0.5214084
	speed: 0.1205s/iter; left time: 3788.3383s
Epoch: 15 cost time: 43.320836782455444
Epoch: 15, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.389 Vali Acc: 0.646 Test Loss: 1.389 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6881384790011351
model parameter : 227846
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.4943649
	speed: 0.1652s/iter; left time: 6080.8406s
	iters: 200, epoch: 1 | loss: 0.5878316
	speed: 0.1017s/iter; left time: 3731.6196s
	iters: 300, epoch: 1 | loss: 0.8839840
	speed: 0.0998s/iter; left time: 3652.9428s
Epoch: 1 cost time: 44.01190686225891
Epoch: 1, Steps: 369 | Train Loss: 0.781 Vali Loss: 0.718 Vali Acc: 0.642 Test Loss: 0.718 Test Acc: 0.642
Validation loss decreased (inf --> -0.642445).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7876000
	speed: 0.3577s/iter; left time: 13030.6279s
	iters: 200, epoch: 2 | loss: 0.4790889
	speed: 0.1210s/iter; left time: 4397.6519s
	iters: 300, epoch: 2 | loss: 1.1320593
	speed: 0.1118s/iter; left time: 4051.1777s
Epoch: 2 cost time: 40.41472053527832
Epoch: 2, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.913 Vali Acc: 0.582 Test Loss: 0.913 Test Acc: 0.582
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6509135
	speed: 0.4505s/iter; left time: 16247.9343s
	iters: 200, epoch: 3 | loss: 0.3039905
	speed: 0.1274s/iter; left time: 4583.1195s
	iters: 300, epoch: 3 | loss: 0.4904422
	speed: 0.0977s/iter; left time: 3502.6242s
Epoch: 3 cost time: 41.102696657180786
Epoch: 3, Steps: 369 | Train Loss: 0.605 Vali Loss: 0.682 Vali Acc: 0.656 Test Loss: 0.682 Test Acc: 0.656
Validation loss decreased (-0.642445 --> -0.656066).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8514973
	speed: 0.3720s/iter; left time: 13277.7630s
	iters: 200, epoch: 4 | loss: 0.3337515
	speed: 0.1170s/iter; left time: 4166.1817s
	iters: 300, epoch: 4 | loss: 0.9453221
	speed: 0.1168s/iter; left time: 4145.5334s
Epoch: 4 cost time: 40.9909553527832
Epoch: 4, Steps: 369 | Train Loss: 0.559 Vali Loss: 0.648 Vali Acc: 0.677 Test Loss: 0.648 Test Acc: 0.677
Validation loss decreased (-0.656066 --> -0.677065).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3804059
	speed: 0.3999s/iter; left time: 14127.5593s
	iters: 200, epoch: 5 | loss: 0.3739176
	speed: 0.1024s/iter; left time: 3606.2488s
	iters: 300, epoch: 5 | loss: 0.3066072
	speed: 0.1309s/iter; left time: 4597.3820s
Epoch: 5 cost time: 41.689879179000854
Epoch: 5, Steps: 369 | Train Loss: 0.487 Vali Loss: 0.637 Vali Acc: 0.671 Test Loss: 0.637 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7730508
	speed: 0.4169s/iter; left time: 14571.8431s
	iters: 200, epoch: 6 | loss: 0.5308771
	speed: 0.0957s/iter; left time: 3335.9166s
	iters: 300, epoch: 6 | loss: 0.6135639
	speed: 0.1302s/iter; left time: 4524.4606s
Epoch: 6 cost time: 41.63159704208374
Epoch: 6, Steps: 369 | Train Loss: 0.442 Vali Loss: 0.725 Vali Acc: 0.666 Test Loss: 0.725 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3787869
	speed: 0.4177s/iter; left time: 14445.5507s
	iters: 200, epoch: 7 | loss: 0.3397471
	speed: 0.1038s/iter; left time: 3579.3385s
	iters: 300, epoch: 7 | loss: 0.3506570
	speed: 0.1306s/iter; left time: 4491.2927s
Epoch: 7 cost time: 45.45047307014465
Epoch: 7, Steps: 369 | Train Loss: 0.403 Vali Loss: 0.717 Vali Acc: 0.660 Test Loss: 0.717 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1171303
	speed: 0.4389s/iter; left time: 15019.7091s
	iters: 200, epoch: 8 | loss: 0.3689190
	speed: 0.1100s/iter; left time: 3754.2644s
	iters: 300, epoch: 8 | loss: 0.5680746
	speed: 0.1201s/iter; left time: 4084.1325s
Epoch: 8 cost time: 45.62011957168579
Epoch: 8, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.782 Vali Acc: 0.662 Test Loss: 0.782 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3012474
	speed: 0.4741s/iter; left time: 16047.8211s
	iters: 200, epoch: 9 | loss: 0.1145484
	speed: 0.0908s/iter; left time: 3063.7483s
	iters: 300, epoch: 9 | loss: 0.2707594
	speed: 0.1315s/iter; left time: 4424.7859s
Epoch: 9 cost time: 44.06182026863098
Epoch: 9, Steps: 369 | Train Loss: 0.330 Vali Loss: 1.017 Vali Acc: 0.648 Test Loss: 1.017 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.5107226
	speed: 0.4579s/iter; left time: 15329.0844s
	iters: 200, epoch: 10 | loss: 0.3118604
	speed: 0.1115s/iter; left time: 3721.6673s
	iters: 300, epoch: 10 | loss: 0.3370086
	speed: 0.1271s/iter; left time: 4228.5614s
Epoch: 10 cost time: 43.153382301330566
Epoch: 10, Steps: 369 | Train Loss: 0.293 Vali Loss: 0.956 Vali Acc: 0.647 Test Loss: 0.956 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.3708683
	speed: 0.4195s/iter; left time: 13890.9135s
	iters: 200, epoch: 11 | loss: 0.1871179
	speed: 0.0940s/iter; left time: 3104.2549s
	iters: 300, epoch: 11 | loss: 0.2216399
	speed: 0.1246s/iter; left time: 4100.9062s
Epoch: 11 cost time: 41.908226013183594
Epoch: 11, Steps: 369 | Train Loss: 0.274 Vali Loss: 0.845 Vali Acc: 0.662 Test Loss: 0.845 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1108063
	speed: 0.4248s/iter; left time: 13910.4131s
	iters: 200, epoch: 12 | loss: 0.1534046
	speed: 0.1046s/iter; left time: 3413.7200s
	iters: 300, epoch: 12 | loss: 0.2749336
	speed: 0.1207s/iter; left time: 3927.3828s
Epoch: 12 cost time: 42.94607400894165
Epoch: 12, Steps: 369 | Train Loss: 0.225 Vali Loss: 0.987 Vali Acc: 0.654 Test Loss: 0.987 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.3045407
	speed: 0.4152s/iter; left time: 13440.5825s
	iters: 200, epoch: 13 | loss: 0.0714969
	speed: 0.1062s/iter; left time: 3427.1515s
	iters: 300, epoch: 13 | loss: 0.2814943
	speed: 0.1277s/iter; left time: 4108.3241s
Epoch: 13 cost time: 43.84563875198364
Epoch: 13, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.322 Vali Acc: 0.645 Test Loss: 1.322 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.2290262
	speed: 0.4184s/iter; left time: 13389.6530s
	iters: 200, epoch: 14 | loss: 0.2585862
	speed: 0.0949s/iter; left time: 3028.4877s
	iters: 300, epoch: 14 | loss: 0.1808564
	speed: 0.0985s/iter; left time: 3132.3063s
Epoch: 14 cost time: 37.70683169364929
Epoch: 14, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.360 Vali Acc: 0.643 Test Loss: 1.360 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6770715096481271
model parameter : 227558
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5736689
	speed: 0.1585s/iter; left time: 5834.2568s
	iters: 200, epoch: 1 | loss: 0.6333196
	speed: 0.1203s/iter; left time: 4414.1112s
	iters: 300, epoch: 1 | loss: 1.0815537
	speed: 0.1100s/iter; left time: 4024.7419s
Epoch: 1 cost time: 47.985398054122925
Epoch: 1, Steps: 369 | Train Loss: 0.771 Vali Loss: 0.753 Vali Acc: 0.636 Test Loss: 0.753 Test Acc: 0.636
Validation loss decreased (inf --> -0.635634).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0622587
	speed: 0.4341s/iter; left time: 15814.2165s
	iters: 200, epoch: 2 | loss: 0.7239097
	speed: 0.1063s/iter; left time: 3863.7717s
	iters: 300, epoch: 2 | loss: 0.3276839
	speed: 0.1165s/iter; left time: 4220.9452s
Epoch: 2 cost time: 44.446763038635254
Epoch: 2, Steps: 369 | Train Loss: 0.732 Vali Loss: 1.568 Vali Acc: 0.547 Test Loss: 1.568 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2824199
	speed: 0.4207s/iter; left time: 15171.2558s
	iters: 200, epoch: 3 | loss: 0.7639521
	speed: 0.1210s/iter; left time: 4353.2591s
	iters: 300, epoch: 3 | loss: 0.7999972
	speed: 0.1068s/iter; left time: 3831.3491s
Epoch: 3 cost time: 45.22261309623718
Epoch: 3, Steps: 369 | Train Loss: 0.688 Vali Loss: 1.365 Vali Acc: 0.600 Test Loss: 1.365 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9426586
	speed: 0.3901s/iter; left time: 13923.1179s
	iters: 200, epoch: 4 | loss: 0.5231845
	speed: 0.1204s/iter; left time: 4285.7834s
	iters: 300, epoch: 4 | loss: 0.2154072
	speed: 0.1038s/iter; left time: 3683.0618s
Epoch: 4 cost time: 40.72878575325012
Epoch: 4, Steps: 369 | Train Loss: 0.640 Vali Loss: 0.982 Vali Acc: 0.625 Test Loss: 0.982 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6071841
	speed: 0.3757s/iter; left time: 13270.8414s
	iters: 200, epoch: 5 | loss: 0.1982778
	speed: 0.1343s/iter; left time: 4731.7270s
	iters: 300, epoch: 5 | loss: 0.5901427
	speed: 0.1151s/iter; left time: 4044.4142s
Epoch: 5 cost time: 43.583269357681274
Epoch: 5, Steps: 369 | Train Loss: 0.504 Vali Loss: 0.620 Vali Acc: 0.684 Test Loss: 0.620 Test Acc: 0.684
Validation loss decreased (-0.635634 --> -0.683876).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5850918
	speed: 0.3655s/iter; left time: 12776.8092s
	iters: 200, epoch: 6 | loss: 0.7442534
	speed: 0.1042s/iter; left time: 3633.5667s
	iters: 300, epoch: 6 | loss: 0.6857165
	speed: 0.1209s/iter; left time: 4201.8792s
Epoch: 6 cost time: 40.89189553260803
Epoch: 6, Steps: 369 | Train Loss: 0.451 Vali Loss: 0.717 Vali Acc: 0.648 Test Loss: 0.717 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2077489
	speed: 0.3827s/iter; left time: 13236.2023s
	iters: 200, epoch: 7 | loss: 0.4923770
	speed: 0.1124s/iter; left time: 3874.8266s
	iters: 300, epoch: 7 | loss: 0.4292540
	speed: 0.1163s/iter; left time: 4000.4106s
Epoch: 7 cost time: 44.7385094165802
Epoch: 7, Steps: 369 | Train Loss: 0.401 Vali Loss: 0.764 Vali Acc: 0.670 Test Loss: 0.764 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7505973
	speed: 0.4009s/iter; left time: 13716.6417s
	iters: 200, epoch: 8 | loss: 0.1444749
	speed: 0.0951s/iter; left time: 3245.5969s
	iters: 300, epoch: 8 | loss: 0.4599155
	speed: 0.0823s/iter; left time: 2799.5147s
Epoch: 8 cost time: 39.30533480644226
Epoch: 8, Steps: 369 | Train Loss: 0.366 Vali Loss: 0.751 Vali Acc: 0.643 Test Loss: 0.751 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3762669
	speed: 0.3759s/iter; left time: 12723.3985s
	iters: 200, epoch: 9 | loss: 0.2807452
	speed: 0.1360s/iter; left time: 4589.9022s
	iters: 300, epoch: 9 | loss: 0.4138040
	speed: 0.1088s/iter; left time: 3660.6127s
Epoch: 9 cost time: 41.17508602142334
Epoch: 9, Steps: 369 | Train Loss: 0.338 Vali Loss: 0.868 Vali Acc: 0.639 Test Loss: 0.868 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4090860
	speed: 0.3713s/iter; left time: 12432.6842s
	iters: 200, epoch: 10 | loss: 0.4834876
	speed: 0.0994s/iter; left time: 3317.9874s
	iters: 300, epoch: 10 | loss: 0.4492044
	speed: 0.1437s/iter; left time: 4782.2707s
Epoch: 10 cost time: 43.64692568778992
Epoch: 10, Steps: 369 | Train Loss: 0.299 Vali Loss: 0.907 Vali Acc: 0.648 Test Loss: 0.907 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1340159
	speed: 0.4227s/iter; left time: 13994.4055s
	iters: 200, epoch: 11 | loss: 0.2272881
	speed: 0.1085s/iter; left time: 3582.4777s
	iters: 300, epoch: 11 | loss: 0.3310709
	speed: 0.1281s/iter; left time: 4216.1516s
Epoch: 11 cost time: 47.268253326416016
Epoch: 11, Steps: 369 | Train Loss: 0.258 Vali Loss: 1.165 Vali Acc: 0.631 Test Loss: 1.165 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1080242
	speed: 0.3818s/iter; left time: 12501.0428s
	iters: 200, epoch: 12 | loss: 0.3608997
	speed: 0.1029s/iter; left time: 3357.2623s
	iters: 300, epoch: 12 | loss: 0.1276194
	speed: 0.0894s/iter; left time: 2908.6897s
Epoch: 12 cost time: 38.581597328186035
Epoch: 12, Steps: 369 | Train Loss: 0.219 Vali Loss: 1.127 Vali Acc: 0.658 Test Loss: 1.127 Test Acc: 0.658
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2362437
	speed: 0.3515s/iter; left time: 11379.6230s
	iters: 200, epoch: 13 | loss: 0.1139943
	speed: 0.1099s/iter; left time: 3548.3718s
	iters: 300, epoch: 13 | loss: 0.4456623
	speed: 0.0894s/iter; left time: 2877.3439s
Epoch: 13 cost time: 35.60909605026245
Epoch: 13, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.306 Vali Acc: 0.651 Test Loss: 1.306 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0839566
	speed: 0.3378s/iter; left time: 10811.3786s
	iters: 200, epoch: 14 | loss: 0.2813402
	speed: 0.1003s/iter; left time: 3201.3416s
	iters: 300, epoch: 14 | loss: 0.1714218
	speed: 0.1159s/iter; left time: 3686.0800s
Epoch: 14 cost time: 36.529181241989136
Epoch: 14, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.127 Vali Acc: 0.646 Test Loss: 1.127 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1699122
	speed: 0.3288s/iter; left time: 10400.2126s
	iters: 200, epoch: 15 | loss: 0.1487718
	speed: 0.0892s/iter; left time: 2812.5488s
	iters: 300, epoch: 15 | loss: 0.0482987
	speed: 0.1023s/iter; left time: 3215.9024s
Epoch: 15 cost time: 37.77794885635376
Epoch: 15, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.348 Vali Acc: 0.647 Test Loss: 1.348 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6838819523269013
model parameter : 227270
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7350591
	speed: 0.1557s/iter; left time: 5730.6862s
	iters: 200, epoch: 1 | loss: 0.6364332
	speed: 0.0944s/iter; left time: 3466.3046s
	iters: 300, epoch: 1 | loss: 1.2563964
	speed: 0.1037s/iter; left time: 3796.1068s
Epoch: 1 cost time: 44.439810037612915
Epoch: 1, Steps: 369 | Train Loss: 0.760 Vali Loss: 1.112 Vali Acc: 0.556 Test Loss: 1.112 Test Acc: 0.556
Validation loss decreased (inf --> -0.555891).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5442121
	speed: 0.4131s/iter; left time: 15050.1594s
	iters: 200, epoch: 2 | loss: 0.7700592
	speed: 0.1098s/iter; left time: 3990.2888s
	iters: 300, epoch: 2 | loss: 0.5714064
	speed: 0.0933s/iter; left time: 3380.2731s
Epoch: 2 cost time: 41.45054244995117
Epoch: 2, Steps: 369 | Train Loss: 0.773 Vali Loss: 1.130 Vali Acc: 0.610 Test Loss: 1.130 Test Acc: 0.610
Validation loss decreased (-0.555891 --> -0.609523).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8576426
	speed: 0.4045s/iter; left time: 14587.0227s
	iters: 200, epoch: 3 | loss: 2.1663537
	speed: 0.1191s/iter; left time: 4282.3962s
	iters: 300, epoch: 3 | loss: 0.7405979
	speed: 0.0878s/iter; left time: 3148.2512s
Epoch: 3 cost time: 38.58873009681702
Epoch: 3, Steps: 369 | Train Loss: 0.699 Vali Loss: 0.953 Vali Acc: 0.576 Test Loss: 0.953 Test Acc: 0.576
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5079942
	speed: 0.2832s/iter; left time: 10109.8726s
	iters: 200, epoch: 4 | loss: 0.4094979
	speed: 0.0536s/iter; left time: 1907.5214s
	iters: 300, epoch: 4 | loss: 0.5535211
	speed: 0.0877s/iter; left time: 3113.7072s
Epoch: 4 cost time: 28.365335941314697
Epoch: 4, Steps: 369 | Train Loss: 0.562 Vali Loss: 0.683 Vali Acc: 0.649 Test Loss: 0.683 Test Acc: 0.649
Validation loss decreased (-0.609523 --> -0.649255).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6283303
	speed: 0.4165s/iter; left time: 14713.1764s
	iters: 200, epoch: 5 | loss: 0.4427731
	speed: 0.1180s/iter; left time: 4157.5222s
	iters: 300, epoch: 5 | loss: 0.3939353
	speed: 0.0933s/iter; left time: 3276.7762s
Epoch: 5 cost time: 43.375741481781006
Epoch: 5, Steps: 369 | Train Loss: 0.480 Vali Loss: 0.692 Vali Acc: 0.655 Test Loss: 0.692 Test Acc: 0.655
Validation loss decreased (-0.649255 --> -0.655214).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3590927
	speed: 0.4541s/iter; left time: 15872.5190s
	iters: 200, epoch: 6 | loss: 0.3890159
	speed: 0.1153s/iter; left time: 4020.4524s
	iters: 300, epoch: 6 | loss: 1.2273145
	speed: 0.0979s/iter; left time: 3402.6928s
Epoch: 6 cost time: 43.83737373352051
Epoch: 6, Steps: 369 | Train Loss: 0.453 Vali Loss: 0.718 Vali Acc: 0.664 Test Loss: 0.718 Test Acc: 0.664
Validation loss decreased (-0.655214 --> -0.663727).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2982931
	speed: 0.4397s/iter; left time: 15206.3235s
	iters: 200, epoch: 7 | loss: 0.4211580
	speed: 0.1244s/iter; left time: 4290.2434s
	iters: 300, epoch: 7 | loss: 0.4148678
	speed: 0.1046s/iter; left time: 3595.4124s
Epoch: 7 cost time: 42.12722086906433
Epoch: 7, Steps: 369 | Train Loss: 0.405 Vali Loss: 0.680 Vali Acc: 0.665 Test Loss: 0.680 Test Acc: 0.665
Validation loss decreased (-0.663727 --> -0.665430).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2619551
	speed: 0.3884s/iter; left time: 13289.7003s
	iters: 200, epoch: 8 | loss: 0.5264564
	speed: 0.1244s/iter; left time: 4244.0541s
	iters: 300, epoch: 8 | loss: 0.2028937
	speed: 0.1078s/iter; left time: 3668.8186s
Epoch: 8 cost time: 41.130143880844116
Epoch: 8, Steps: 369 | Train Loss: 0.373 Vali Loss: 0.824 Vali Acc: 0.658 Test Loss: 0.824 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3490047
	speed: 0.3744s/iter; left time: 12673.1519s
	iters: 200, epoch: 9 | loss: 0.4759443
	speed: 0.1007s/iter; left time: 3398.5863s
	iters: 300, epoch: 9 | loss: 0.2457860
	speed: 0.1310s/iter; left time: 4409.0142s
Epoch: 9 cost time: 40.37454319000244
Epoch: 9, Steps: 369 | Train Loss: 0.337 Vali Loss: 0.800 Vali Acc: 0.657 Test Loss: 0.800 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.4350784
	speed: 0.3873s/iter; left time: 12965.4003s
	iters: 200, epoch: 10 | loss: 0.0932784
	speed: 0.0941s/iter; left time: 3141.6520s
	iters: 300, epoch: 10 | loss: 0.1835758
	speed: 0.1264s/iter; left time: 4207.7171s
Epoch: 10 cost time: 41.87550473213196
Epoch: 10, Steps: 369 | Train Loss: 0.307 Vali Loss: 0.957 Vali Acc: 0.661 Test Loss: 0.957 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2542559
	speed: 0.3988s/iter; left time: 13206.3060s
	iters: 200, epoch: 11 | loss: 0.2844748
	speed: 0.1031s/iter; left time: 3403.7796s
	iters: 300, epoch: 11 | loss: 0.3334047
	speed: 0.1046s/iter; left time: 3443.7812s
Epoch: 11 cost time: 42.84801506996155
Epoch: 11, Steps: 369 | Train Loss: 0.269 Vali Loss: 0.905 Vali Acc: 0.663 Test Loss: 0.905 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0377429
	speed: 0.4154s/iter; left time: 13600.9281s
	iters: 200, epoch: 12 | loss: 0.1149213
	speed: 0.1088s/iter; left time: 3552.8716s
	iters: 300, epoch: 12 | loss: 0.1692832
	speed: 0.0900s/iter; left time: 2929.5409s
Epoch: 12 cost time: 41.956275939941406
Epoch: 12, Steps: 369 | Train Loss: 0.226 Vali Loss: 1.180 Vali Acc: 0.647 Test Loss: 1.180 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2679005
	speed: 0.3951s/iter; left time: 12790.7846s
	iters: 200, epoch: 13 | loss: 0.1582222
	speed: 0.1382s/iter; left time: 4459.0511s
	iters: 300, epoch: 13 | loss: 0.2483756
	speed: 0.1023s/iter; left time: 3291.3891s
Epoch: 13 cost time: 43.44859528541565
Epoch: 13, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.167 Vali Acc: 0.659 Test Loss: 1.167 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1030452
	speed: 0.3844s/iter; left time: 12302.3727s
	iters: 200, epoch: 14 | loss: 0.1864808
	speed: 0.1345s/iter; left time: 4291.3316s
	iters: 300, epoch: 14 | loss: 0.0666096
	speed: 0.1129s/iter; left time: 3590.7028s
Epoch: 14 cost time: 41.99449682235718
Epoch: 14, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.043 Vali Acc: 0.656 Test Loss: 1.043 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1065356
	speed: 0.4044s/iter; left time: 12794.6060s
	iters: 200, epoch: 15 | loss: 0.1579899
	speed: 0.1197s/iter; left time: 3775.0529s
	iters: 300, epoch: 15 | loss: 0.1008848
	speed: 0.1238s/iter; left time: 3893.0778s
Epoch: 15 cost time: 44.5070321559906
Epoch: 15, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.438 Vali Acc: 0.654 Test Loss: 1.438 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0071676
	speed: 0.3756s/iter; left time: 11744.3661s
	iters: 200, epoch: 16 | loss: 0.0697769
	speed: 0.0816s/iter; left time: 2543.5112s
	iters: 300, epoch: 16 | loss: 0.1930079
	speed: 0.1173s/iter; left time: 3642.7408s
Epoch: 16 cost time: 38.22514772415161
Epoch: 16, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.637 Vali Acc: 0.642 Test Loss: 1.637 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0312663
	speed: 0.3987s/iter; left time: 12318.9283s
	iters: 200, epoch: 17 | loss: 0.0816175
	speed: 0.1048s/iter; left time: 3226.6371s
	iters: 300, epoch: 17 | loss: 0.0598879
	speed: 0.0813s/iter; left time: 2497.0939s
Epoch: 17 cost time: 34.556185722351074
Epoch: 17, Steps: 369 | Train Loss: 0.134 Vali Loss: 1.572 Vali Acc: 0.656 Test Loss: 1.572 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6654370034052214
model parameter : 226982
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6930760
	speed: 0.1514s/iter; left time: 5571.0673s
	iters: 200, epoch: 1 | loss: 0.5241702
	speed: 0.1090s/iter; left time: 3999.2152s
	iters: 300, epoch: 1 | loss: 0.7620246
	speed: 0.0977s/iter; left time: 3576.4291s
Epoch: 1 cost time: 43.59143948554993
Epoch: 1, Steps: 369 | Train Loss: 0.753 Vali Loss: 0.797 Vali Acc: 0.629 Test Loss: 0.797 Test Acc: 0.629
Validation loss decreased (inf --> -0.628823).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5908273
	speed: 0.3608s/iter; left time: 13143.9673s
	iters: 200, epoch: 2 | loss: 0.2778946
	speed: 0.1250s/iter; left time: 4543.2818s
	iters: 300, epoch: 2 | loss: 0.8796766
	speed: 0.1112s/iter; left time: 4029.4553s
Epoch: 2 cost time: 40.74277186393738
Epoch: 2, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.914 Vali Acc: 0.602 Test Loss: 0.914 Test Acc: 0.602
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3450737
	speed: 0.3686s/iter; left time: 13292.0981s
	iters: 200, epoch: 3 | loss: 0.7314679
	speed: 0.0966s/iter; left time: 3472.7255s
	iters: 300, epoch: 3 | loss: 0.3250729
	speed: 0.1247s/iter; left time: 4473.8442s
Epoch: 3 cost time: 43.203267097473145
Epoch: 3, Steps: 369 | Train Loss: 0.628 Vali Loss: 0.809 Vali Acc: 0.659 Test Loss: 0.809 Test Acc: 0.659
Validation loss decreased (-0.628823 --> -0.659186).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4040281
	speed: 0.4172s/iter; left time: 14890.2265s
	iters: 200, epoch: 4 | loss: 0.4973062
	speed: 0.1205s/iter; left time: 4288.9273s
	iters: 300, epoch: 4 | loss: 0.6151037
	speed: 0.1042s/iter; left time: 3698.2299s
Epoch: 4 cost time: 45.886106729507446
Epoch: 4, Steps: 369 | Train Loss: 0.548 Vali Loss: 0.691 Vali Acc: 0.673 Test Loss: 0.691 Test Acc: 0.673
Validation loss decreased (-0.659186 --> -0.673092).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3855087
	speed: 0.4252s/iter; left time: 15019.3545s
	iters: 200, epoch: 5 | loss: 0.3313629
	speed: 0.1250s/iter; left time: 4403.1835s
	iters: 300, epoch: 5 | loss: 0.4614308
	speed: 0.1017s/iter; left time: 3573.2948s
Epoch: 5 cost time: 43.47001647949219
Epoch: 5, Steps: 369 | Train Loss: 0.471 Vali Loss: 0.699 Vali Acc: 0.661 Test Loss: 0.699 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4926789
	speed: 0.3581s/iter; left time: 12518.7945s
	iters: 200, epoch: 6 | loss: 0.2846996
	speed: 0.1222s/iter; left time: 4258.1190s
	iters: 300, epoch: 6 | loss: 0.5918627
	speed: 0.1123s/iter; left time: 3902.0537s
Epoch: 6 cost time: 40.88287138938904
Epoch: 6, Steps: 369 | Train Loss: 0.431 Vali Loss: 0.632 Vali Acc: 0.680 Test Loss: 0.632 Test Acc: 0.680
Validation loss decreased (-0.673092 --> -0.680470).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2922922
	speed: 0.3739s/iter; left time: 12932.1334s
	iters: 200, epoch: 7 | loss: 0.3624705
	speed: 0.1078s/iter; left time: 3718.7201s
	iters: 300, epoch: 7 | loss: 0.3516976
	speed: 0.1246s/iter; left time: 4284.5631s
Epoch: 7 cost time: 41.05532383918762
Epoch: 7, Steps: 369 | Train Loss: 0.396 Vali Loss: 0.675 Vali Acc: 0.671 Test Loss: 0.675 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3067469
	speed: 0.3703s/iter; left time: 12671.1377s
	iters: 200, epoch: 8 | loss: 1.0952063
	speed: 0.1173s/iter; left time: 4003.3933s
	iters: 300, epoch: 8 | loss: 0.2595239
	speed: 0.0936s/iter; left time: 3184.7752s
Epoch: 8 cost time: 42.16533398628235
Epoch: 8, Steps: 369 | Train Loss: 0.358 Vali Loss: 0.842 Vali Acc: 0.660 Test Loss: 0.842 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1561849
	speed: 0.3825s/iter; left time: 12947.5467s
	iters: 200, epoch: 9 | loss: 0.2172319
	speed: 0.1113s/iter; left time: 3755.9263s
	iters: 300, epoch: 9 | loss: 0.0980242
	speed: 0.0822s/iter; left time: 2765.2352s
Epoch: 9 cost time: 40.47837567329407
Epoch: 9, Steps: 369 | Train Loss: 0.322 Vali Loss: 0.790 Vali Acc: 0.671 Test Loss: 0.790 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3136074
	speed: 0.3575s/iter; left time: 11969.9988s
	iters: 200, epoch: 10 | loss: 0.3677053
	speed: 0.1340s/iter; left time: 4472.4670s
	iters: 300, epoch: 10 | loss: 0.4142859
	speed: 0.1092s/iter; left time: 3633.0251s
Epoch: 10 cost time: 41.680787563323975
Epoch: 10, Steps: 369 | Train Loss: 0.298 Vali Loss: 0.942 Vali Acc: 0.652 Test Loss: 0.942 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2031775
	speed: 0.4004s/iter; left time: 13257.8853s
	iters: 200, epoch: 11 | loss: 0.1467349
	speed: 0.1167s/iter; left time: 3851.8762s
	iters: 300, epoch: 11 | loss: 0.2333753
	speed: 0.1277s/iter; left time: 4203.6708s
Epoch: 11 cost time: 44.10562300682068
Epoch: 11, Steps: 369 | Train Loss: 0.244 Vali Loss: 1.055 Vali Acc: 0.657 Test Loss: 1.055 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0920124
	speed: 0.4062s/iter; left time: 13299.0175s
	iters: 200, epoch: 12 | loss: 0.0492117
	speed: 0.1119s/iter; left time: 3652.4768s
	iters: 300, epoch: 12 | loss: 0.3417380
	speed: 0.1327s/iter; left time: 4319.3049s
Epoch: 12 cost time: 45.47707271575928
Epoch: 12, Steps: 369 | Train Loss: 0.221 Vali Loss: 1.172 Vali Acc: 0.671 Test Loss: 1.172 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1193176
	speed: 0.3992s/iter; left time: 12924.1940s
	iters: 200, epoch: 13 | loss: 0.0414275
	speed: 0.0987s/iter; left time: 3185.3320s
	iters: 300, epoch: 13 | loss: 0.2085886
	speed: 0.1235s/iter; left time: 3972.7883s
Epoch: 13 cost time: 44.46965026855469
Epoch: 13, Steps: 369 | Train Loss: 0.186 Vali Loss: 1.225 Vali Acc: 0.651 Test Loss: 1.225 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0495297
	speed: 0.3350s/iter; left time: 10720.9957s
	iters: 200, epoch: 14 | loss: 0.2505549
	speed: 0.0539s/iter; left time: 1719.1656s
	iters: 300, epoch: 14 | loss: 0.2868934
	speed: 0.0556s/iter; left time: 1767.1971s
Epoch: 14 cost time: 21.158029317855835
Epoch: 14, Steps: 369 | Train Loss: 0.161 Vali Loss: 1.337 Vali Acc: 0.655 Test Loss: 1.337 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0352479
	speed: 0.3224s/iter; left time: 10199.7609s
	iters: 200, epoch: 15 | loss: 0.0708513
	speed: 0.0910s/iter; left time: 2868.9211s
	iters: 300, epoch: 15 | loss: 0.1542154
	speed: 0.1333s/iter; left time: 4188.8254s
Epoch: 15 cost time: 41.71433687210083
Epoch: 15, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.360 Vali Acc: 0.640 Test Loss: 1.360 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0915018
	speed: 0.3934s/iter; left time: 12298.9029s
	iters: 200, epoch: 16 | loss: 0.5131353
	speed: 0.1018s/iter; left time: 3172.6892s
	iters: 300, epoch: 16 | loss: 0.0389258
	speed: 0.1080s/iter; left time: 3354.7684s
Epoch: 16 cost time: 42.966022968292236
Epoch: 16, Steps: 369 | Train Loss: 0.129 Vali Loss: 1.467 Vali Acc: 0.651 Test Loss: 1.467 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6804767309875142
model parameter : 186246
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5879085
	speed: 0.1478s/iter; left time: 5437.5980s
	iters: 200, epoch: 1 | loss: 0.5276252
	speed: 0.1124s/iter; left time: 4125.7836s
	iters: 300, epoch: 1 | loss: 0.8274141
	speed: 0.1184s/iter; left time: 4335.0293s
Epoch: 1 cost time: 47.55385637283325
Epoch: 1, Steps: 369 | Train Loss: 0.775 Vali Loss: 0.697 Vali Acc: 0.640 Test Loss: 0.697 Test Acc: 0.640
Validation loss decreased (inf --> -0.640458).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3878534
	speed: 0.4388s/iter; left time: 15985.6659s
	iters: 200, epoch: 2 | loss: 1.1286725
	speed: 0.1199s/iter; left time: 4356.4253s
	iters: 300, epoch: 2 | loss: 0.8139864
	speed: 0.0996s/iter; left time: 3608.7577s
Epoch: 2 cost time: 46.032837867736816
Epoch: 2, Steps: 369 | Train Loss: 0.725 Vali Loss: 1.018 Vali Acc: 0.599 Test Loss: 1.018 Test Acc: 0.599
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6335785
	speed: 0.4337s/iter; left time: 15639.7044s
	iters: 200, epoch: 3 | loss: 0.9295552
	speed: 0.1303s/iter; left time: 4685.0350s
	iters: 300, epoch: 3 | loss: 0.4592658
	speed: 0.0951s/iter; left time: 3411.8599s
Epoch: 3 cost time: 44.703556299209595
Epoch: 3, Steps: 369 | Train Loss: 0.659 Vali Loss: 0.812 Vali Acc: 0.646 Test Loss: 0.812 Test Acc: 0.646
Validation loss decreased (-0.640458 --> -0.646416).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2818272
	speed: 0.3523s/iter; left time: 12576.3251s
	iters: 200, epoch: 4 | loss: 0.4195009
	speed: 0.1306s/iter; left time: 4647.1288s
	iters: 300, epoch: 4 | loss: 0.4267994
	speed: 0.1038s/iter; left time: 3684.3740s
Epoch: 4 cost time: 40.168291091918945
Epoch: 4, Steps: 369 | Train Loss: 0.546 Vali Loss: 0.714 Vali Acc: 0.646 Test Loss: 0.714 Test Acc: 0.646
Validation loss decreased (-0.646416 --> -0.646417).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3470115
	speed: 0.3445s/iter; left time: 12168.7174s
	iters: 200, epoch: 5 | loss: 0.4738577
	speed: 0.1017s/iter; left time: 3582.9267s
	iters: 300, epoch: 5 | loss: 0.3400798
	speed: 0.1237s/iter; left time: 4345.2416s
Epoch: 5 cost time: 41.42077898979187
Epoch: 5, Steps: 369 | Train Loss: 0.470 Vali Loss: 0.667 Vali Acc: 0.669 Test Loss: 0.667 Test Acc: 0.669
Validation loss decreased (-0.646417 --> -0.669403).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3675930
	speed: 0.3603s/iter; left time: 12594.8872s
	iters: 200, epoch: 6 | loss: 0.3587772
	speed: 0.1025s/iter; left time: 3574.0115s
	iters: 300, epoch: 6 | loss: 0.8949436
	speed: 0.1018s/iter; left time: 3537.4924s
Epoch: 6 cost time: 41.293333530426025
Epoch: 6, Steps: 369 | Train Loss: 0.428 Vali Loss: 0.762 Vali Acc: 0.652 Test Loss: 0.762 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3120459
	speed: 0.3891s/iter; left time: 13456.6812s
	iters: 200, epoch: 7 | loss: 0.4898305
	speed: 0.1142s/iter; left time: 3940.0838s
	iters: 300, epoch: 7 | loss: 0.3206445
	speed: 0.0932s/iter; left time: 3204.1650s
Epoch: 7 cost time: 42.856637954711914
Epoch: 7, Steps: 369 | Train Loss: 0.395 Vali Loss: 0.641 Vali Acc: 0.672 Test Loss: 0.641 Test Acc: 0.672
Validation loss decreased (-0.669403 --> -0.672241).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1379640
	speed: 0.3744s/iter; left time: 12812.4561s
	iters: 200, epoch: 8 | loss: 0.4732792
	speed: 0.1308s/iter; left time: 4463.5456s
	iters: 300, epoch: 8 | loss: 0.2118554
	speed: 0.1037s/iter; left time: 3527.2521s
Epoch: 8 cost time: 41.98223066329956
Epoch: 8, Steps: 369 | Train Loss: 0.360 Vali Loss: 0.913 Vali Acc: 0.645 Test Loss: 0.913 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.4533584
	speed: 0.3529s/iter; left time: 11944.6299s
	iters: 200, epoch: 9 | loss: 0.4514382
	speed: 0.1139s/iter; left time: 3844.9784s
	iters: 300, epoch: 9 | loss: 0.2726980
	speed: 0.1343s/iter; left time: 4518.6374s
Epoch: 9 cost time: 42.73176574707031
Epoch: 9, Steps: 369 | Train Loss: 0.313 Vali Loss: 0.887 Vali Acc: 0.657 Test Loss: 0.887 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1093870
	speed: 0.3895s/iter; left time: 13040.7491s
	iters: 200, epoch: 10 | loss: 0.1934952
	speed: 0.0972s/iter; left time: 3245.7102s
	iters: 300, epoch: 10 | loss: 0.1641185
	speed: 0.1441s/iter; left time: 4797.0615s
Epoch: 10 cost time: 46.33789873123169
Epoch: 10, Steps: 369 | Train Loss: 0.285 Vali Loss: 0.834 Vali Acc: 0.660 Test Loss: 0.834 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3965173
	speed: 0.4134s/iter; left time: 13688.7407s
	iters: 200, epoch: 11 | loss: 0.2080925
	speed: 0.0998s/iter; left time: 3293.3996s
	iters: 300, epoch: 11 | loss: 0.4084999
	speed: 0.1170s/iter; left time: 3851.2950s
Epoch: 11 cost time: 44.3905143737793
Epoch: 11, Steps: 369 | Train Loss: 0.253 Vali Loss: 1.017 Vali Acc: 0.662 Test Loss: 1.017 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1763716
	speed: 0.4050s/iter; left time: 13261.5296s
	iters: 200, epoch: 12 | loss: 0.2381877
	speed: 0.1132s/iter; left time: 3696.2389s
	iters: 300, epoch: 12 | loss: 0.2145413
	speed: 0.1108s/iter; left time: 3604.4071s
Epoch: 12 cost time: 44.71054458618164
Epoch: 12, Steps: 369 | Train Loss: 0.208 Vali Loss: 1.130 Vali Acc: 0.646 Test Loss: 1.130 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0422665
	speed: 0.3761s/iter; left time: 12176.1285s
	iters: 200, epoch: 13 | loss: 0.4215708
	speed: 0.1264s/iter; left time: 4078.7825s
	iters: 300, epoch: 13 | loss: 0.2870577
	speed: 0.0945s/iter; left time: 3040.3098s
Epoch: 13 cost time: 41.113070487976074
Epoch: 13, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.145 Vali Acc: 0.658 Test Loss: 1.145 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.2459641
	speed: 0.3534s/iter; left time: 11311.7159s
	iters: 200, epoch: 14 | loss: 0.2001272
	speed: 0.0789s/iter; left time: 2518.3895s
	iters: 300, epoch: 14 | loss: 0.1099818
	speed: 0.0523s/iter; left time: 1664.0550s
Epoch: 14 cost time: 28.291308879852295
Epoch: 14, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.292 Vali Acc: 0.642 Test Loss: 1.292 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0283058
	speed: 0.2043s/iter; left time: 6464.1505s
	iters: 200, epoch: 15 | loss: 0.0633359
	speed: 0.0989s/iter; left time: 3120.1099s
	iters: 300, epoch: 15 | loss: 0.2009630
	speed: 0.1179s/iter; left time: 3706.9967s
Epoch: 15 cost time: 35.24268865585327
Epoch: 15, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.417 Vali Acc: 0.645 Test Loss: 1.417 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1015114
	speed: 0.3707s/iter; left time: 11589.4554s
	iters: 200, epoch: 16 | loss: 0.2938489
	speed: 0.0952s/iter; left time: 2967.3772s
	iters: 300, epoch: 16 | loss: 0.0102160
	speed: 0.1290s/iter; left time: 4006.6616s
Epoch: 16 cost time: 43.16645836830139
Epoch: 16, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.545 Vali Acc: 0.644 Test Loss: 1.545 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0454447
	speed: 0.4003s/iter; left time: 12368.8513s
	iters: 200, epoch: 17 | loss: 0.4266808
	speed: 0.0994s/iter; left time: 3062.2531s
	iters: 300, epoch: 17 | loss: 0.4062732
	speed: 0.1189s/iter; left time: 3649.8793s
Epoch: 17 cost time: 45.33963656425476
Epoch: 17, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.703 Vali Acc: 0.635 Test Loss: 1.703 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6722474460839954
model parameter : 185958
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7006608
	speed: 0.1371s/iter; left time: 5047.1868s
	iters: 200, epoch: 1 | loss: 1.8597188
	speed: 0.1136s/iter; left time: 4170.9964s
	iters: 300, epoch: 1 | loss: 1.2946665
	speed: 0.1281s/iter; left time: 4688.3033s
Epoch: 1 cost time: 45.92843151092529
Epoch: 1, Steps: 369 | Train Loss: 0.727 Vali Loss: 1.193 Vali Acc: 0.539 Test Loss: 1.193 Test Acc: 0.539
Validation loss decreased (inf --> -0.538864).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9252714
	speed: 0.3647s/iter; left time: 13287.7959s
	iters: 200, epoch: 2 | loss: 0.4718319
	speed: 0.0993s/iter; left time: 3606.2418s
	iters: 300, epoch: 2 | loss: 1.0074323
	speed: 0.1199s/iter; left time: 4345.5159s
Epoch: 2 cost time: 42.11544585227966
Epoch: 2, Steps: 369 | Train Loss: 0.696 Vali Loss: 0.757 Vali Acc: 0.655 Test Loss: 0.757 Test Acc: 0.655
Validation loss decreased (-0.538864 --> -0.654930).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1153327
	speed: 0.3840s/iter; left time: 13849.4808s
	iters: 200, epoch: 3 | loss: 0.3775584
	speed: 0.1093s/iter; left time: 3931.0719s
	iters: 300, epoch: 3 | loss: 1.1978937
	speed: 0.1143s/iter; left time: 4098.3529s
Epoch: 3 cost time: 45.064377307891846
Epoch: 3, Steps: 369 | Train Loss: 0.621 Vali Loss: 0.884 Vali Acc: 0.602 Test Loss: 0.884 Test Acc: 0.602
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7294121
	speed: 0.4015s/iter; left time: 14330.2340s
	iters: 200, epoch: 4 | loss: 0.2742805
	speed: 0.1048s/iter; left time: 3730.6806s
	iters: 300, epoch: 4 | loss: 1.1917334
	speed: 0.0993s/iter; left time: 3523.8413s
Epoch: 4 cost time: 42.150017976760864
Epoch: 4, Steps: 369 | Train Loss: 0.673 Vali Loss: 1.168 Vali Acc: 0.572 Test Loss: 1.168 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8362508
	speed: 0.3598s/iter; left time: 12711.1240s
	iters: 200, epoch: 5 | loss: 0.3403115
	speed: 0.1288s/iter; left time: 4535.2230s
	iters: 300, epoch: 5 | loss: 0.6904243
	speed: 0.0921s/iter; left time: 3235.4438s
Epoch: 5 cost time: 41.953404903411865
Epoch: 5, Steps: 369 | Train Loss: 0.532 Vali Loss: 0.697 Vali Acc: 0.668 Test Loss: 0.697 Test Acc: 0.668
Validation loss decreased (-0.654930 --> -0.668268).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2872013
	speed: 0.3677s/iter; left time: 12851.9989s
	iters: 200, epoch: 6 | loss: 0.2630554
	speed: 0.1326s/iter; left time: 4623.3181s
	iters: 300, epoch: 6 | loss: 0.2533102
	speed: 0.1203s/iter; left time: 4180.4161s
Epoch: 6 cost time: 43.64801645278931
Epoch: 6, Steps: 369 | Train Loss: 0.456 Vali Loss: 0.685 Vali Acc: 0.659 Test Loss: 0.685 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4018072
	speed: 0.3822s/iter; left time: 13219.1089s
	iters: 200, epoch: 7 | loss: 0.4136979
	speed: 0.0997s/iter; left time: 3439.9294s
	iters: 300, epoch: 7 | loss: 0.4628134
	speed: 0.1406s/iter; left time: 4834.3448s
Epoch: 7 cost time: 44.70429086685181
Epoch: 7, Steps: 369 | Train Loss: 0.405 Vali Loss: 0.739 Vali Acc: 0.659 Test Loss: 0.739 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4724626
	speed: 0.3750s/iter; left time: 12830.5559s
	iters: 200, epoch: 8 | loss: 0.3722071
	speed: 0.1007s/iter; left time: 3435.1433s
	iters: 300, epoch: 8 | loss: 0.4575877
	speed: 0.1205s/iter; left time: 4098.8605s
Epoch: 8 cost time: 42.809083223342896
Epoch: 8, Steps: 369 | Train Loss: 0.380 Vali Loss: 0.748 Vali Acc: 0.667 Test Loss: 0.748 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4507767
	speed: 0.3767s/iter; left time: 12752.4986s
	iters: 200, epoch: 9 | loss: 0.4607476
	speed: 0.1116s/iter; left time: 3766.1919s
	iters: 300, epoch: 9 | loss: 0.6073598
	speed: 0.1002s/iter; left time: 3370.4320s
Epoch: 9 cost time: 42.260589361190796
Epoch: 9, Steps: 369 | Train Loss: 0.339 Vali Loss: 0.887 Vali Acc: 0.661 Test Loss: 0.887 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5822276
	speed: 0.3595s/iter; left time: 12037.6577s
	iters: 200, epoch: 10 | loss: 0.3319055
	speed: 0.1173s/iter; left time: 3915.3370s
	iters: 300, epoch: 10 | loss: 0.3451050
	speed: 0.1155s/iter; left time: 3844.2439s
Epoch: 10 cost time: 42.89987277984619
Epoch: 10, Steps: 369 | Train Loss: 0.298 Vali Loss: 0.884 Vali Acc: 0.659 Test Loss: 0.884 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.3100372
	speed: 0.3751s/iter; left time: 12418.6337s
	iters: 200, epoch: 11 | loss: 0.1639301
	speed: 0.1228s/iter; left time: 4054.1320s
	iters: 300, epoch: 11 | loss: 0.1724629
	speed: 0.1015s/iter; left time: 3341.3004s
Epoch: 11 cost time: 41.27046799659729
Epoch: 11, Steps: 369 | Train Loss: 0.256 Vali Loss: 1.045 Vali Acc: 0.652 Test Loss: 1.045 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1726933
	speed: 0.3462s/iter; left time: 11334.4179s
	iters: 200, epoch: 12 | loss: 0.2691616
	speed: 0.1159s/iter; left time: 3782.4186s
	iters: 300, epoch: 12 | loss: 0.1994382
	speed: 0.1273s/iter; left time: 4141.7678s
Epoch: 12 cost time: 42.23918652534485
Epoch: 12, Steps: 369 | Train Loss: 0.238 Vali Loss: 1.118 Vali Acc: 0.652 Test Loss: 1.118 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1362353
	speed: 0.3461s/iter; left time: 11204.0925s
	iters: 200, epoch: 13 | loss: 0.2149309
	speed: 0.1104s/iter; left time: 3562.9758s
	iters: 300, epoch: 13 | loss: 0.2651147
	speed: 0.1328s/iter; left time: 4271.9712s
Epoch: 13 cost time: 42.910545110702515
Epoch: 13, Steps: 369 | Train Loss: 0.209 Vali Loss: 1.149 Vali Acc: 0.643 Test Loss: 1.149 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0834499
	speed: 0.3787s/iter; left time: 12121.3927s
	iters: 200, epoch: 14 | loss: 0.2888404
	speed: 0.0959s/iter; left time: 3058.0123s
	iters: 300, epoch: 14 | loss: 0.2663058
	speed: 0.1302s/iter; left time: 4139.5749s
Epoch: 14 cost time: 44.380414724349976
Epoch: 14, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.526 Vali Acc: 0.637 Test Loss: 1.526 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1183895
	speed: 0.3483s/iter; left time: 11019.8092s
	iters: 200, epoch: 15 | loss: 0.2050214
	speed: 0.0595s/iter; left time: 1875.9565s
	iters: 300, epoch: 15 | loss: 0.2912851
	speed: 0.0558s/iter; left time: 1752.5891s
Epoch: 15 cost time: 23.323254346847534
Epoch: 15, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.429 Vali Acc: 0.649 Test Loss: 1.429 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6682746878547106
model parameter : 185670
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6628354
	speed: 0.1340s/iter; left time: 4931.1594s
	iters: 200, epoch: 1 | loss: 0.7710065
	speed: 0.1118s/iter; left time: 4103.1577s
	iters: 300, epoch: 1 | loss: 1.1356524
	speed: 0.1195s/iter; left time: 4372.6563s
Epoch: 1 cost time: 43.990569829940796
Epoch: 1, Steps: 369 | Train Loss: 0.721 Vali Loss: 1.554 Vali Acc: 0.510 Test Loss: 1.554 Test Acc: 0.510
Validation loss decreased (inf --> -0.509916).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6159095
	speed: 0.3736s/iter; left time: 13610.0578s
	iters: 200, epoch: 2 | loss: 1.3338664
	speed: 0.0998s/iter; left time: 3626.9762s
	iters: 300, epoch: 2 | loss: 1.2596176
	speed: 0.1164s/iter; left time: 4215.9390s
Epoch: 2 cost time: 41.23841834068298
Epoch: 2, Steps: 369 | Train Loss: 0.786 Vali Loss: 0.857 Vali Acc: 0.641 Test Loss: 0.857 Test Acc: 0.641
Validation loss decreased (-0.509916 --> -0.641308).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7822559
	speed: 0.3754s/iter; left time: 13537.4708s
	iters: 200, epoch: 3 | loss: 0.4897226
	speed: 0.1070s/iter; left time: 3847.2483s
	iters: 300, epoch: 3 | loss: 0.6471449
	speed: 0.1038s/iter; left time: 3721.5658s
Epoch: 3 cost time: 42.77516198158264
Epoch: 3, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.795 Vali Acc: 0.669 Test Loss: 0.795 Test Acc: 0.669
Validation loss decreased (-0.641308 --> -0.668834).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4441174
	speed: 0.3879s/iter; left time: 13847.4752s
	iters: 200, epoch: 4 | loss: 1.2306916
	speed: 0.0976s/iter; left time: 3473.7908s
	iters: 300, epoch: 4 | loss: 1.7309653
	speed: 0.0910s/iter; left time: 3228.4640s
Epoch: 4 cost time: 40.94006037712097
Epoch: 4, Steps: 369 | Train Loss: 0.641 Vali Loss: 0.687 Vali Acc: 0.679 Test Loss: 0.687 Test Acc: 0.679
Validation loss decreased (-0.668834 --> -0.679051).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8871158
	speed: 0.3575s/iter; left time: 12629.9777s
	iters: 200, epoch: 5 | loss: 1.3332981
	speed: 0.1212s/iter; left time: 4269.1726s
	iters: 300, epoch: 5 | loss: 0.7539536
	speed: 0.1123s/iter; left time: 3945.6690s
Epoch: 5 cost time: 41.35693645477295
Epoch: 5, Steps: 369 | Train Loss: 0.535 Vali Loss: 0.759 Vali Acc: 0.664 Test Loss: 0.759 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3979853
	speed: 0.3732s/iter; left time: 13047.3210s
	iters: 200, epoch: 6 | loss: 0.4705124
	speed: 0.1293s/iter; left time: 4507.1629s
	iters: 300, epoch: 6 | loss: 0.5045773
	speed: 0.1190s/iter; left time: 4134.9239s
Epoch: 6 cost time: 42.33802008628845
Epoch: 6, Steps: 369 | Train Loss: 0.446 Vali Loss: 0.674 Vali Acc: 0.667 Test Loss: 0.674 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3989909
	speed: 0.3748s/iter; left time: 12963.2017s
	iters: 200, epoch: 7 | loss: 0.5966172
	speed: 0.1116s/iter; left time: 3849.4948s
	iters: 300, epoch: 7 | loss: 0.2446169
	speed: 0.1243s/iter; left time: 4273.0916s
Epoch: 7 cost time: 40.50091242790222
Epoch: 7, Steps: 369 | Train Loss: 0.413 Vali Loss: 0.762 Vali Acc: 0.651 Test Loss: 0.762 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2451303
	speed: 0.3628s/iter; left time: 12415.6613s
	iters: 200, epoch: 8 | loss: 0.8118421
	speed: 0.0965s/iter; left time: 3293.2320s
	iters: 300, epoch: 8 | loss: 0.1664254
	speed: 0.1263s/iter; left time: 4296.7842s
Epoch: 8 cost time: 41.58269119262695
Epoch: 8, Steps: 369 | Train Loss: 0.364 Vali Loss: 0.722 Vali Acc: 0.659 Test Loss: 0.722 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.2946449
	speed: 0.3716s/iter; left time: 12578.1827s
	iters: 200, epoch: 9 | loss: 0.4999416
	speed: 0.1033s/iter; left time: 3484.8895s
	iters: 300, epoch: 9 | loss: 0.1678943
	speed: 0.0991s/iter; left time: 3335.2455s
Epoch: 9 cost time: 40.29342794418335
Epoch: 9, Steps: 369 | Train Loss: 0.334 Vali Loss: 0.769 Vali Acc: 0.656 Test Loss: 0.769 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1695185
	speed: 0.3751s/iter; left time: 12557.0334s
	iters: 200, epoch: 10 | loss: 0.4595315
	speed: 0.1049s/iter; left time: 3502.9001s
	iters: 300, epoch: 10 | loss: 0.2594220
	speed: 0.0917s/iter; left time: 3052.8952s
Epoch: 10 cost time: 35.932401180267334
Epoch: 10, Steps: 369 | Train Loss: 0.290 Vali Loss: 0.796 Vali Acc: 0.656 Test Loss: 0.796 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.4206048
	speed: 0.2290s/iter; left time: 7582.3727s
	iters: 200, epoch: 11 | loss: 0.0881806
	speed: 0.0495s/iter; left time: 1635.6015s
	iters: 300, epoch: 11 | loss: 0.2694459
	speed: 0.1201s/iter; left time: 3952.7052s
Epoch: 11 cost time: 31.647661447525024
Epoch: 11, Steps: 369 | Train Loss: 0.265 Vali Loss: 0.869 Vali Acc: 0.664 Test Loss: 0.869 Test Acc: 0.664
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.3446394
	speed: 0.3918s/iter; left time: 12827.7562s
	iters: 200, epoch: 12 | loss: 0.1142679
	speed: 0.0969s/iter; left time: 3161.8421s
	iters: 300, epoch: 12 | loss: 0.1360251
	speed: 0.1096s/iter; left time: 3566.4854s
Epoch: 12 cost time: 44.59502983093262
Epoch: 12, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.082 Vali Acc: 0.659 Test Loss: 1.082 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0642741
	speed: 0.4387s/iter; left time: 14202.2685s
	iters: 200, epoch: 13 | loss: 0.0566851
	speed: 0.1087s/iter; left time: 3506.5816s
	iters: 300, epoch: 13 | loss: 0.1037904
	speed: 0.0958s/iter; left time: 3082.1814s
Epoch: 13 cost time: 44.930490016937256
Epoch: 13, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.170 Vali Acc: 0.654 Test Loss: 1.170 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1137793
	speed: 0.4231s/iter; left time: 13540.7392s
	iters: 200, epoch: 14 | loss: 0.0665539
	speed: 0.1180s/iter; left time: 3764.0841s
	iters: 300, epoch: 14 | loss: 0.0897093
	speed: 0.0994s/iter; left time: 3162.3082s
Epoch: 14 cost time: 45.332016468048096
Epoch: 14, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.493 Vali Acc: 0.650 Test Loss: 1.493 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6790578887627696
model parameter : 185382
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0043679
	speed: 0.1326s/iter; left time: 4880.0205s
	iters: 200, epoch: 1 | loss: 5.5049624
	speed: 0.1134s/iter; left time: 4163.4029s
	iters: 300, epoch: 1 | loss: 2.9881749
	speed: 0.0977s/iter; left time: 3577.2106s
Epoch: 1 cost time: 41.05441331863403
Epoch: 1, Steps: 369 | Train Loss: 2.932 Vali Loss: 1.279 Vali Acc: 0.577 Test Loss: 1.279 Test Acc: 0.577
Validation loss decreased (inf --> -0.577172).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6089288
	speed: 0.4349s/iter; left time: 15842.6084s
	iters: 200, epoch: 2 | loss: 0.5312844
	speed: 0.1041s/iter; left time: 3781.0111s
	iters: 300, epoch: 2 | loss: 1.2880782
	speed: 0.1138s/iter; left time: 4123.3008s
Epoch: 2 cost time: 41.376354694366455
Epoch: 2, Steps: 369 | Train Loss: 1.704 Vali Loss: 2.323 Vali Acc: 0.500 Test Loss: 2.323 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5488318
	speed: 0.4226s/iter; left time: 15241.3531s
	iters: 200, epoch: 3 | loss: 0.4119087
	speed: 0.1105s/iter; left time: 3972.2837s
	iters: 300, epoch: 3 | loss: 0.3607811
	speed: 0.1006s/iter; left time: 3608.8244s
Epoch: 3 cost time: 38.731109380722046
Epoch: 3, Steps: 369 | Train Loss: 1.407 Vali Loss: 0.716 Vali Acc: 0.635 Test Loss: 0.716 Test Acc: 0.635
Validation loss decreased (-0.577172 --> -0.635067).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0686965
	speed: 0.4148s/iter; left time: 14805.9580s
	iters: 200, epoch: 4 | loss: 0.2917243
	speed: 0.1193s/iter; left time: 4244.7188s
	iters: 300, epoch: 4 | loss: 0.6103665
	speed: 0.1130s/iter; left time: 4009.9969s
Epoch: 4 cost time: 39.578115463256836
Epoch: 4, Steps: 369 | Train Loss: 0.997 Vali Loss: 3.020 Vali Acc: 0.500 Test Loss: 3.020 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.6394315
	speed: 0.4150s/iter; left time: 14660.0335s
	iters: 200, epoch: 5 | loss: 2.1145122
	speed: 0.1034s/iter; left time: 3643.2159s
	iters: 300, epoch: 5 | loss: 0.8388844
	speed: 0.1029s/iter; left time: 3613.9905s
Epoch: 5 cost time: 39.26376128196716
Epoch: 5, Steps: 369 | Train Loss: 0.958 Vali Loss: 0.639 Vali Acc: 0.643 Test Loss: 0.639 Test Acc: 0.643
Validation loss decreased (-0.635067 --> -0.643297).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4703678
	speed: 0.4507s/iter; left time: 15755.6113s
	iters: 200, epoch: 6 | loss: 1.4225935
	speed: 0.1272s/iter; left time: 4433.7627s
	iters: 300, epoch: 6 | loss: 0.8910088
	speed: 0.1160s/iter; left time: 4032.9889s
Epoch: 6 cost time: 42.746278285980225
Epoch: 6, Steps: 369 | Train Loss: 0.810 Vali Loss: 0.674 Vali Acc: 0.623 Test Loss: 0.674 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3856930
	speed: 0.4474s/iter; left time: 15474.0787s
	iters: 200, epoch: 7 | loss: 1.2989212
	speed: 0.1149s/iter; left time: 3963.3001s
	iters: 300, epoch: 7 | loss: 1.8002163
	speed: 0.1265s/iter; left time: 4351.6235s
Epoch: 7 cost time: 43.96592164039612
Epoch: 7, Steps: 369 | Train Loss: 0.797 Vali Loss: 0.687 Vali Acc: 0.640 Test Loss: 0.687 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.9261376
	speed: 0.4643s/iter; left time: 15886.2073s
	iters: 200, epoch: 8 | loss: 0.6524131
	speed: 0.1030s/iter; left time: 3513.3503s
	iters: 300, epoch: 8 | loss: 1.2326417
	speed: 0.0891s/iter; left time: 3030.7114s
Epoch: 8 cost time: 39.6501350402832
Epoch: 8, Steps: 369 | Train Loss: 0.769 Vali Loss: 0.794 Vali Acc: 0.634 Test Loss: 0.794 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.5660964
	speed: 0.4307s/iter; left time: 14578.5340s
	iters: 200, epoch: 9 | loss: 1.1472867
	speed: 0.1137s/iter; left time: 3835.9984s
	iters: 300, epoch: 9 | loss: 0.4593272
	speed: 0.1135s/iter; left time: 3817.5233s
Epoch: 9 cost time: 41.58046793937683
Epoch: 9, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.776 Vali Acc: 0.623 Test Loss: 0.776 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5121166
	speed: 0.4307s/iter; left time: 14418.6468s
	iters: 200, epoch: 10 | loss: 0.8876867
	speed: 0.0964s/iter; left time: 3216.4827s
	iters: 300, epoch: 10 | loss: 0.4573317
	speed: 0.1112s/iter; left time: 3701.2857s
Epoch: 10 cost time: 38.772223472595215
Epoch: 10, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.774 Vali Acc: 0.569 Test Loss: 0.774 Test Acc: 0.569
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.7658480
	speed: 0.4243s/iter; left time: 14048.0973s
	iters: 200, epoch: 11 | loss: 0.5332808
	speed: 0.1057s/iter; left time: 3489.9427s
	iters: 300, epoch: 11 | loss: 0.4847277
	speed: 0.1073s/iter; left time: 3530.0565s
Epoch: 11 cost time: 40.94736862182617
Epoch: 11, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.671 Vali Acc: 0.609 Test Loss: 0.671 Test Acc: 0.609
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.6958949
	speed: 0.3146s/iter; left time: 10301.8003s
	iters: 200, epoch: 12 | loss: 0.7380165
	speed: 0.1132s/iter; left time: 3695.2055s
	iters: 300, epoch: 12 | loss: 0.4664373
	speed: 0.1112s/iter; left time: 3617.9937s
Epoch: 12 cost time: 37.66894197463989
Epoch: 12, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.646 Vali Acc: 0.654 Test Loss: 0.646 Test Acc: 0.654
Validation loss decreased (-0.643297 --> -0.653796).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6766527
	speed: 0.4470s/iter; left time: 14470.1798s
	iters: 200, epoch: 13 | loss: 0.6099710
	speed: 0.0934s/iter; left time: 3014.0281s
	iters: 300, epoch: 13 | loss: 0.6595301
	speed: 0.1157s/iter; left time: 3721.3139s
Epoch: 13 cost time: 41.29426074028015
Epoch: 13, Steps: 369 | Train Loss: 0.652 Vali Loss: 0.882 Vali Acc: 0.600 Test Loss: 0.882 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2969932
	speed: 0.4573s/iter; left time: 14633.8574s
	iters: 200, epoch: 14 | loss: 1.4647595
	speed: 0.1096s/iter; left time: 3496.5943s
	iters: 300, epoch: 14 | loss: 0.6744313
	speed: 0.1150s/iter; left time: 3657.9901s
Epoch: 14 cost time: 43.71022605895996
Epoch: 14, Steps: 369 | Train Loss: 1.064 Vali Loss: 0.920 Vali Acc: 0.500 Test Loss: 0.920 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6332850
	speed: 0.4805s/iter; left time: 15201.9649s
	iters: 200, epoch: 15 | loss: 0.7111805
	speed: 0.1298s/iter; left time: 4094.5042s
	iters: 300, epoch: 15 | loss: 0.5950655
	speed: 0.1230s/iter; left time: 3866.8422s
Epoch: 15 cost time: 45.87460136413574
Epoch: 15, Steps: 369 | Train Loss: 0.775 Vali Loss: 0.837 Vali Acc: 0.500 Test Loss: 0.837 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.7268829
	speed: 0.4452s/iter; left time: 13919.1475s
	iters: 200, epoch: 16 | loss: 0.6940847
	speed: 0.1067s/iter; left time: 3324.7257s
	iters: 300, epoch: 16 | loss: 0.7577181
	speed: 0.1059s/iter; left time: 3291.2713s
Epoch: 16 cost time: 38.93291449546814
Epoch: 16, Steps: 369 | Train Loss: 0.735 Vali Loss: 0.692 Vali Acc: 0.500 Test Loss: 0.692 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.7633282
	speed: 0.4357s/iter; left time: 13461.5673s
	iters: 200, epoch: 17 | loss: 0.8339218
	speed: 0.1049s/iter; left time: 3231.1631s
	iters: 300, epoch: 17 | loss: 0.7249785
	speed: 0.0953s/iter; left time: 2925.8896s
Epoch: 17 cost time: 39.43200659751892
Epoch: 17, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.631 Vali Acc: 0.644 Test Loss: 0.631 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.5595655
	speed: 0.4379s/iter; left time: 13366.7420s
	iters: 200, epoch: 18 | loss: 0.6505943
	speed: 0.1102s/iter; left time: 3354.6128s
	iters: 300, epoch: 18 | loss: 0.5737473
	speed: 0.1075s/iter; left time: 3260.4453s
Epoch: 18 cost time: 40.16149568557739
Epoch: 18, Steps: 369 | Train Loss: 0.665 Vali Loss: 0.650 Vali Acc: 0.625 Test Loss: 0.650 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.6730425
	speed: 0.4301s/iter; left time: 12971.3882s
	iters: 200, epoch: 19 | loss: 0.7355862
	speed: 0.1127s/iter; left time: 3388.4130s
	iters: 300, epoch: 19 | loss: 0.7420264
	speed: 0.1127s/iter; left time: 3376.6591s
Epoch: 19 cost time: 40.786109924316406
Epoch: 19, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.669 Vali Acc: 0.610 Test Loss: 0.669 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.8288615
	speed: 0.4281s/iter; left time: 12752.8441s
	iters: 200, epoch: 20 | loss: 0.6894583
	speed: 0.0985s/iter; left time: 2923.4361s
	iters: 300, epoch: 20 | loss: 0.6121408
	speed: 0.1076s/iter; left time: 3183.4408s
Epoch: 20 cost time: 39.51659154891968
Epoch: 20, Steps: 369 | Train Loss: 0.647 Vali Loss: 0.700 Vali Acc: 0.600 Test Loss: 0.700 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.4802938
	speed: 0.4255s/iter; left time: 12519.9807s
	iters: 200, epoch: 21 | loss: 0.4485348
	speed: 0.1126s/iter; left time: 3301.5579s
	iters: 300, epoch: 21 | loss: 0.5085269
	speed: 0.1170s/iter; left time: 3420.0385s
Epoch: 21 cost time: 40.91328144073486
Epoch: 21, Steps: 369 | Train Loss: 0.615 Vali Loss: 0.700 Vali Acc: 0.625 Test Loss: 0.700 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.8921353
	speed: 0.4191s/iter; left time: 12176.8350s
	iters: 200, epoch: 22 | loss: 0.5566886
	speed: 0.1188s/iter; left time: 3440.6522s
	iters: 300, epoch: 22 | loss: 0.4681203
	speed: 0.1225s/iter; left time: 3534.7999s
Epoch: 22 cost time: 42.25813102722168
Epoch: 22, Steps: 369 | Train Loss: 0.617 Vali Loss: 0.646 Vali Acc: 0.634 Test Loss: 0.646 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6538024971623155
model parameter : 5423130
model size : 25.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.6267054
	speed: 0.1436s/iter; left time: 5285.5975s
	iters: 200, epoch: 1 | loss: 7.2280416
	speed: 0.1140s/iter; left time: 4185.3519s
	iters: 300, epoch: 1 | loss: 7.8333840
	speed: 0.1209s/iter; left time: 4423.9511s
Epoch: 1 cost time: 45.87043809890747
Epoch: 1, Steps: 369 | Train Loss: 3.492 Vali Loss: 3.164 Vali Acc: 0.551 Test Loss: 3.164 Test Acc: 0.551
Validation loss decreased (inf --> -0.551047).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7594662
	speed: 0.3676s/iter; left time: 13390.9833s
	iters: 200, epoch: 2 | loss: 0.9152942
	speed: 0.0606s/iter; left time: 2201.0221s
	iters: 300, epoch: 2 | loss: 0.7564335
	speed: 0.0563s/iter; left time: 2040.1908s
Epoch: 2 cost time: 25.34356117248535
Epoch: 2, Steps: 369 | Train Loss: 1.393 Vali Loss: 5.215 Vali Acc: 0.500 Test Loss: 5.215 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3761913
	speed: 0.4215s/iter; left time: 15199.0390s
	iters: 200, epoch: 3 | loss: 0.6015923
	speed: 0.1145s/iter; left time: 4116.7725s
	iters: 300, epoch: 3 | loss: 1.2121490
	speed: 0.1089s/iter; left time: 3904.5460s
Epoch: 3 cost time: 40.388431787490845
Epoch: 3, Steps: 369 | Train Loss: 1.301 Vali Loss: 1.200 Vali Acc: 0.600 Test Loss: 1.200 Test Acc: 0.600
Validation loss decreased (-0.551047 --> -0.600442).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8396457
	speed: 0.4184s/iter; left time: 14934.2238s
	iters: 200, epoch: 4 | loss: 1.0841980
	speed: 0.1034s/iter; left time: 3679.8058s
	iters: 300, epoch: 4 | loss: 0.6988573
	speed: 0.1035s/iter; left time: 3673.0153s
Epoch: 4 cost time: 39.99397015571594
Epoch: 4, Steps: 369 | Train Loss: 1.138 Vali Loss: 1.411 Vali Acc: 0.596 Test Loss: 1.411 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3278857
	speed: 0.4276s/iter; left time: 15104.2699s
	iters: 200, epoch: 5 | loss: 0.9467756
	speed: 0.1093s/iter; left time: 3851.0070s
	iters: 300, epoch: 5 | loss: 1.3139743
	speed: 0.0965s/iter; left time: 3388.2776s
Epoch: 5 cost time: 39.18599343299866
Epoch: 5, Steps: 369 | Train Loss: 1.411 Vali Loss: 0.699 Vali Acc: 0.499 Test Loss: 0.699 Test Acc: 0.499
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.2819371
	speed: 0.4259s/iter; left time: 14889.2104s
	iters: 200, epoch: 6 | loss: 0.7508262
	speed: 0.1054s/iter; left time: 3673.3256s
	iters: 300, epoch: 6 | loss: 1.4324827
	speed: 0.1084s/iter; left time: 3768.3352s
Epoch: 6 cost time: 40.005199670791626
Epoch: 6, Steps: 369 | Train Loss: 1.003 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.9620411
	speed: 0.4386s/iter; left time: 15171.2459s
	iters: 200, epoch: 7 | loss: 0.8518494
	speed: 0.0976s/iter; left time: 3366.1609s
	iters: 300, epoch: 7 | loss: 0.7882178
	speed: 0.1047s/iter; left time: 3598.7348s
Epoch: 7 cost time: 40.09025502204895
Epoch: 7, Steps: 369 | Train Loss: 0.828 Vali Loss: 1.026 Vali Acc: 0.500 Test Loss: 1.026 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.0872965
	speed: 0.4520s/iter; left time: 15467.4214s
	iters: 200, epoch: 8 | loss: 0.8722355
	speed: 0.1185s/iter; left time: 4043.3026s
	iters: 300, epoch: 8 | loss: 0.7676049
	speed: 0.1043s/iter; left time: 3548.7856s
Epoch: 8 cost time: 43.176828145980835
Epoch: 8, Steps: 369 | Train Loss: 0.780 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.8226657
	speed: 0.4671s/iter; left time: 15810.3717s
	iters: 200, epoch: 9 | loss: 0.7783419
	speed: 0.1090s/iter; left time: 3679.2571s
	iters: 300, epoch: 9 | loss: 0.8761846
	speed: 0.1125s/iter; left time: 3785.2945s
Epoch: 9 cost time: 42.93438005447388
Epoch: 9, Steps: 369 | Train Loss: 0.767 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7461975
	speed: 0.4691s/iter; left time: 15703.8875s
	iters: 200, epoch: 10 | loss: 0.7167272
	speed: 0.0993s/iter; left time: 3314.2567s
	iters: 300, epoch: 10 | loss: 0.6736681
	speed: 0.1025s/iter; left time: 3411.2549s
Epoch: 10 cost time: 40.24582028388977
Epoch: 10, Steps: 369 | Train Loss: 0.738 Vali Loss: 0.693 Vali Acc: 0.501 Test Loss: 0.693 Test Acc: 0.501
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.0124004
	speed: 0.4404s/iter; left time: 14580.7162s
	iters: 200, epoch: 11 | loss: 0.8161408
	speed: 0.1124s/iter; left time: 3710.3275s
	iters: 300, epoch: 11 | loss: 0.6390570
	speed: 0.0979s/iter; left time: 3221.0368s
Epoch: 11 cost time: 40.04005837440491
Epoch: 11, Steps: 369 | Train Loss: 0.729 Vali Loss: 0.742 Vali Acc: 0.519 Test Loss: 0.742 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.6015434
	speed: 0.4316s/iter; left time: 14130.0305s
	iters: 200, epoch: 12 | loss: 0.7255274
	speed: 0.1058s/iter; left time: 3452.0513s
	iters: 300, epoch: 12 | loss: 0.7078570
	speed: 0.1119s/iter; left time: 3641.6531s
Epoch: 12 cost time: 40.59274172782898
Epoch: 12, Steps: 369 | Train Loss: 0.691 Vali Loss: 0.665 Vali Acc: 0.606 Test Loss: 0.665 Test Acc: 0.606
Validation loss decreased (-0.600442 --> -0.605839).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6663955
	speed: 0.4415s/iter; left time: 14291.6775s
	iters: 200, epoch: 13 | loss: 0.7449002
	speed: 0.1017s/iter; left time: 3280.6467s
	iters: 300, epoch: 13 | loss: 0.5987760
	speed: 0.1094s/iter; left time: 3520.6600s
Epoch: 13 cost time: 40.28932046890259
Epoch: 13, Steps: 369 | Train Loss: 0.666 Vali Loss: 0.812 Vali Acc: 0.546 Test Loss: 0.812 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7709189
	speed: 0.4211s/iter; left time: 13475.9313s
	iters: 200, epoch: 14 | loss: 0.6792724
	speed: 0.1072s/iter; left time: 3421.0833s
	iters: 300, epoch: 14 | loss: 0.7226913
	speed: 0.0974s/iter; left time: 3099.0627s
Epoch: 14 cost time: 39.45601224899292
Epoch: 14, Steps: 369 | Train Loss: 0.658 Vali Loss: 0.657 Vali Acc: 0.603 Test Loss: 0.657 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6957933
	speed: 0.4404s/iter; left time: 13933.4647s
	iters: 200, epoch: 15 | loss: 0.5979707
	speed: 0.1094s/iter; left time: 3451.0982s
	iters: 300, epoch: 15 | loss: 0.4615158
	speed: 0.1014s/iter; left time: 3188.2500s
Epoch: 15 cost time: 40.11825489997864
Epoch: 15, Steps: 369 | Train Loss: 0.634 Vali Loss: 0.639 Vali Acc: 0.639 Test Loss: 0.639 Test Acc: 0.639
Validation loss decreased (-0.605839 --> -0.639040).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5320004
	speed: 0.3541s/iter; left time: 11070.3579s
	iters: 200, epoch: 16 | loss: 0.9423740
	speed: 0.0688s/iter; left time: 2144.5814s
	iters: 300, epoch: 16 | loss: 0.6507249
	speed: 0.1034s/iter; left time: 3211.6555s
Epoch: 16 cost time: 34.09957265853882
Epoch: 16, Steps: 369 | Train Loss: 0.653 Vali Loss: 0.695 Vali Acc: 0.596 Test Loss: 0.695 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6118490
	speed: 0.4772s/iter; left time: 14743.8005s
	iters: 200, epoch: 17 | loss: 0.8916651
	speed: 0.1248s/iter; left time: 3843.2288s
	iters: 300, epoch: 17 | loss: 0.6182030
	speed: 0.1053s/iter; left time: 3231.8571s
Epoch: 17 cost time: 43.68640327453613
Epoch: 17, Steps: 369 | Train Loss: 0.665 Vali Loss: 0.696 Vali Acc: 0.589 Test Loss: 0.696 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7769442
	speed: 0.4648s/iter; left time: 14189.6129s
	iters: 200, epoch: 18 | loss: 0.4752981
	speed: 0.1177s/iter; left time: 3580.7189s
	iters: 300, epoch: 18 | loss: 0.4530313
	speed: 0.1149s/iter; left time: 3484.9951s
Epoch: 18 cost time: 41.883403062820435
Epoch: 18, Steps: 369 | Train Loss: 0.648 Vali Loss: 0.696 Vali Acc: 0.593 Test Loss: 0.696 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.8639845
	speed: 0.4396s/iter; left time: 13257.8664s
	iters: 200, epoch: 19 | loss: 0.9040760
	speed: 0.0941s/iter; left time: 2829.8740s
	iters: 300, epoch: 19 | loss: 0.6595798
	speed: 0.1097s/iter; left time: 3287.1532s
Epoch: 19 cost time: 40.467856884002686
Epoch: 19, Steps: 369 | Train Loss: 0.642 Vali Loss: 0.684 Vali Acc: 0.591 Test Loss: 0.684 Test Acc: 0.591
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.7648580
	speed: 0.4351s/iter; left time: 12962.3495s
	iters: 200, epoch: 20 | loss: 0.5734342
	speed: 0.1157s/iter; left time: 3435.6858s
	iters: 300, epoch: 20 | loss: 0.5438685
	speed: 0.0991s/iter; left time: 2931.6858s
Epoch: 20 cost time: 39.963454246520996
Epoch: 20, Steps: 369 | Train Loss: 0.643 Vali Loss: 0.720 Vali Acc: 0.544 Test Loss: 0.720 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.5083213
	speed: 0.4181s/iter; left time: 12301.8506s
	iters: 200, epoch: 21 | loss: 0.6871372
	speed: 0.1131s/iter; left time: 3316.9642s
	iters: 300, epoch: 21 | loss: 0.7204668
	speed: 0.1105s/iter; left time: 3227.6438s
Epoch: 21 cost time: 39.55923080444336
Epoch: 21, Steps: 369 | Train Loss: 0.658 Vali Loss: 0.744 Vali Acc: 0.587 Test Loss: 0.744 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.4554372
	speed: 0.4259s/iter; left time: 12372.3036s
	iters: 200, epoch: 22 | loss: 0.5677505
	speed: 0.1074s/iter; left time: 3108.0533s
	iters: 300, epoch: 22 | loss: 0.6100283
	speed: 0.1106s/iter; left time: 3192.0479s
Epoch: 22 cost time: 40.64506268501282
Epoch: 22, Steps: 369 | Train Loss: 0.670 Vali Loss: 0.678 Vali Acc: 0.592 Test Loss: 0.678 Test Acc: 0.592
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.7764611
	speed: 0.4238s/iter; left time: 12155.8768s
	iters: 200, epoch: 23 | loss: 0.4504874
	speed: 0.1087s/iter; left time: 3107.1147s
	iters: 300, epoch: 23 | loss: 0.5327172
	speed: 0.0908s/iter; left time: 2586.7622s
Epoch: 23 cost time: 38.422568798065186
Epoch: 23, Steps: 369 | Train Loss: 0.642 Vali Loss: 0.701 Vali Acc: 0.599 Test Loss: 0.701 Test Acc: 0.599
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.8106731
	speed: 0.4298s/iter; left time: 12170.5459s
	iters: 200, epoch: 24 | loss: 0.5071402
	speed: 0.1127s/iter; left time: 3179.8462s
	iters: 300, epoch: 24 | loss: 0.8819499
	speed: 0.1152s/iter; left time: 3239.6630s
Epoch: 24 cost time: 42.127795696258545
Epoch: 24, Steps: 369 | Train Loss: 0.644 Vali Loss: 0.699 Vali Acc: 0.580 Test Loss: 0.699 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.7076446
	speed: 0.4589s/iter; left time: 12825.0591s
	iters: 200, epoch: 25 | loss: 0.5858210
	speed: 0.1096s/iter; left time: 3050.8085s
	iters: 300, epoch: 25 | loss: 0.5800809
	speed: 0.1220s/iter; left time: 3384.4454s
Epoch: 25 cost time: 43.40478730201721
Epoch: 25, Steps: 369 | Train Loss: 0.626 Vali Loss: 0.733 Vali Acc: 0.570 Test Loss: 0.733 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6390465380249716
model parameter : 5421594
model size : 25.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.6229300
	speed: 0.1303s/iter; left time: 4793.4933s
	iters: 200, epoch: 1 | loss: 5.7915568
	speed: 0.0933s/iter; left time: 3423.1879s
	iters: 300, epoch: 1 | loss: 3.1187735
	speed: 0.0993s/iter; left time: 3633.5067s
Epoch: 1 cost time: 39.46927762031555
Epoch: 1, Steps: 369 | Train Loss: 3.401 Vali Loss: 1.872 Vali Acc: 0.500 Test Loss: 1.872 Test Acc: 0.500
Validation loss decreased (inf --> -0.499981).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3864114
	speed: 0.4412s/iter; left time: 16075.5066s
	iters: 200, epoch: 2 | loss: 2.1697631
	speed: 0.1112s/iter; left time: 4041.6822s
	iters: 300, epoch: 2 | loss: 0.3171765
	speed: 0.1110s/iter; left time: 4022.8035s
Epoch: 2 cost time: 42.251526832580566
Epoch: 2, Steps: 369 | Train Loss: 1.465 Vali Loss: 1.295 Vali Acc: 0.535 Test Loss: 1.295 Test Acc: 0.535
Validation loss decreased (-0.499981 --> -0.534607).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8007444
	speed: 0.4236s/iter; left time: 15277.4767s
	iters: 200, epoch: 3 | loss: 1.2982075
	speed: 0.1001s/iter; left time: 3599.4041s
	iters: 300, epoch: 3 | loss: 1.5248915
	speed: 0.1023s/iter; left time: 3669.7559s
Epoch: 3 cost time: 37.970032930374146
Epoch: 3, Steps: 369 | Train Loss: 1.257 Vali Loss: 1.676 Vali Acc: 0.504 Test Loss: 1.676 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8278841
	speed: 0.4427s/iter; left time: 15803.3143s
	iters: 200, epoch: 4 | loss: 1.2386471
	speed: 0.1103s/iter; left time: 3924.2752s
	iters: 300, epoch: 4 | loss: 0.5765927
	speed: 0.0985s/iter; left time: 3495.9397s
Epoch: 4 cost time: 41.92364478111267
Epoch: 4, Steps: 369 | Train Loss: 1.030 Vali Loss: 3.614 Vali Acc: 0.500 Test Loss: 3.614 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7378784
	speed: 0.4326s/iter; left time: 15282.5571s
	iters: 200, epoch: 5 | loss: 1.4259691
	speed: 0.1167s/iter; left time: 4110.2899s
	iters: 300, epoch: 5 | loss: 1.5165443
	speed: 0.0992s/iter; left time: 3483.1199s
Epoch: 5 cost time: 39.84477472305298
Epoch: 5, Steps: 369 | Train Loss: 0.958 Vali Loss: 0.708 Vali Acc: 0.600 Test Loss: 0.708 Test Acc: 0.600
Validation loss decreased (-0.534607 --> -0.600163).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6800134
	speed: 0.4380s/iter; left time: 15312.3844s
	iters: 200, epoch: 6 | loss: 0.3952208
	speed: 0.0959s/iter; left time: 3344.2186s
	iters: 300, epoch: 6 | loss: 0.3512647
	speed: 0.1215s/iter; left time: 4222.7937s
Epoch: 6 cost time: 41.45112490653992
Epoch: 6, Steps: 369 | Train Loss: 0.788 Vali Loss: 0.748 Vali Acc: 0.635 Test Loss: 0.748 Test Acc: 0.635
Validation loss decreased (-0.600163 --> -0.634783).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2957084
	speed: 0.4491s/iter; left time: 15534.3299s
	iters: 200, epoch: 7 | loss: 0.6326521
	speed: 0.1193s/iter; left time: 4114.9234s
	iters: 300, epoch: 7 | loss: 0.4106335
	speed: 0.1122s/iter; left time: 3858.2395s
Epoch: 7 cost time: 45.004146337509155
Epoch: 7, Steps: 369 | Train Loss: 0.647 Vali Loss: 0.900 Vali Acc: 0.606 Test Loss: 0.900 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4599796
	speed: 0.4786s/iter; left time: 16375.6100s
	iters: 200, epoch: 8 | loss: 0.5373563
	speed: 0.1320s/iter; left time: 4504.6105s
	iters: 300, epoch: 8 | loss: 0.3685425
	speed: 0.1110s/iter; left time: 3776.5737s
Epoch: 8 cost time: 44.233145236968994
Epoch: 8, Steps: 369 | Train Loss: 0.570 Vali Loss: 1.171 Vali Acc: 0.524 Test Loss: 1.171 Test Acc: 0.524
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3630489
	speed: 0.4562s/iter; left time: 15441.4798s
	iters: 200, epoch: 9 | loss: 0.6138402
	speed: 0.0874s/iter; left time: 2950.1309s
	iters: 300, epoch: 9 | loss: 0.5235650
	speed: 0.0960s/iter; left time: 3229.2253s
Epoch: 9 cost time: 34.54752326011658
Epoch: 9, Steps: 369 | Train Loss: 0.508 Vali Loss: 0.689 Vali Acc: 0.655 Test Loss: 0.689 Test Acc: 0.655
Validation loss decreased (-0.634783 --> -0.654931).  Saving model ...
	iters: 100, epoch: 10 | loss: 9.5314484
	speed: 0.3542s/iter; left time: 11860.1195s
	iters: 200, epoch: 10 | loss: 0.8653959
	speed: 0.1118s/iter; left time: 3733.1018s
	iters: 300, epoch: 10 | loss: 0.7085176
	speed: 0.0986s/iter; left time: 3282.9197s
Epoch: 10 cost time: 40.77004384994507
Epoch: 10, Steps: 369 | Train Loss: 2.063 Vali Loss: 0.675 Vali Acc: 0.577 Test Loss: 0.675 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.8468943
	speed: 0.4402s/iter; left time: 14576.6380s
	iters: 200, epoch: 11 | loss: 0.6670580
	speed: 0.1139s/iter; left time: 3758.7687s
	iters: 300, epoch: 11 | loss: 0.8808926
	speed: 0.1221s/iter; left time: 4017.5174s
Epoch: 11 cost time: 42.63209891319275
Epoch: 11, Steps: 369 | Train Loss: 0.746 Vali Loss: 0.710 Vali Acc: 0.575 Test Loss: 0.710 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.9399253
	speed: 0.4245s/iter; left time: 13900.0988s
	iters: 200, epoch: 12 | loss: 0.6860480
	speed: 0.0959s/iter; left time: 3131.3328s
	iters: 300, epoch: 12 | loss: 0.3673984
	speed: 0.1239s/iter; left time: 4030.5110s
Epoch: 12 cost time: 41.13280415534973
Epoch: 12, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.740 Vali Acc: 0.588 Test Loss: 0.740 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.6415471
	speed: 0.4342s/iter; left time: 14055.3659s
	iters: 200, epoch: 13 | loss: 0.7730463
	speed: 0.1182s/iter; left time: 3816.1353s
	iters: 300, epoch: 13 | loss: 0.8809033
	speed: 0.1027s/iter; left time: 3303.1428s
Epoch: 13 cost time: 42.27188539505005
Epoch: 13, Steps: 369 | Train Loss: 0.667 Vali Loss: 0.732 Vali Acc: 0.595 Test Loss: 0.732 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.5821464
	speed: 0.4334s/iter; left time: 13870.4891s
	iters: 200, epoch: 14 | loss: 0.6288528
	speed: 0.1132s/iter; left time: 3610.3670s
	iters: 300, epoch: 14 | loss: 1.1745238
	speed: 0.1061s/iter; left time: 3373.6475s
Epoch: 14 cost time: 41.04401397705078
Epoch: 14, Steps: 369 | Train Loss: 0.671 Vali Loss: 0.734 Vali Acc: 0.578 Test Loss: 0.734 Test Acc: 0.578
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.5558956
	speed: 0.4230s/iter; left time: 13381.2998s
	iters: 200, epoch: 15 | loss: 0.5255731
	speed: 0.1296s/iter; left time: 4085.6432s
	iters: 300, epoch: 15 | loss: 0.6425762
	speed: 0.1294s/iter; left time: 4068.3472s
Epoch: 15 cost time: 45.48544478416443
Epoch: 15, Steps: 369 | Train Loss: 0.621 Vali Loss: 0.682 Vali Acc: 0.586 Test Loss: 0.682 Test Acc: 0.586
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.7957675
	speed: 0.4769s/iter; left time: 14911.2170s
	iters: 200, epoch: 16 | loss: 0.7982976
	speed: 0.1192s/iter; left time: 3715.9624s
	iters: 300, epoch: 16 | loss: 0.5943855
	speed: 0.1041s/iter; left time: 3233.7514s
Epoch: 16 cost time: 44.75446176528931
Epoch: 16, Steps: 369 | Train Loss: 0.649 Vali Loss: 0.789 Vali Acc: 0.574 Test Loss: 0.789 Test Acc: 0.574
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.7005472
	speed: 0.4829s/iter; left time: 14919.9998s
	iters: 200, epoch: 17 | loss: 0.4090389
	speed: 0.1128s/iter; left time: 3473.9518s
	iters: 300, epoch: 17 | loss: 0.8762206
	speed: 0.1111s/iter; left time: 3410.7383s
Epoch: 17 cost time: 41.39924097061157
Epoch: 17, Steps: 369 | Train Loss: 0.658 Vali Loss: 0.675 Vali Acc: 0.594 Test Loss: 0.675 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.7953945
	speed: 0.4300s/iter; left time: 13127.6849s
	iters: 200, epoch: 18 | loss: 0.7905447
	speed: 0.1119s/iter; left time: 3404.3242s
	iters: 300, epoch: 18 | loss: 0.5854250
	speed: 0.1150s/iter; left time: 3486.3562s
Epoch: 18 cost time: 41.646212100982666
Epoch: 18, Steps: 369 | Train Loss: 0.682 Vali Loss: 0.738 Vali Acc: 0.543 Test Loss: 0.738 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.5676624
	speed: 0.4275s/iter; left time: 12893.5682s
	iters: 200, epoch: 19 | loss: 0.4618541
	speed: 0.1135s/iter; left time: 3411.5065s
	iters: 300, epoch: 19 | loss: 0.8145514
	speed: 0.1057s/iter; left time: 3167.4907s
Epoch: 19 cost time: 42.15204906463623
Epoch: 19, Steps: 369 | Train Loss: 0.675 Vali Loss: 0.708 Vali Acc: 0.573 Test Loss: 0.708 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6549375709421112
model parameter : 5420058
model size : 25.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9620727
	speed: 0.1314s/iter; left time: 4835.2872s
	iters: 200, epoch: 1 | loss: 2.3282490
	speed: 0.1126s/iter; left time: 4133.8324s
	iters: 300, epoch: 1 | loss: 3.7932508
	speed: 0.1124s/iter; left time: 4113.5069s
Epoch: 1 cost time: 43.25555396080017
Epoch: 1, Steps: 369 | Train Loss: 2.852 Vali Loss: 2.123 Vali Acc: 0.502 Test Loss: 2.123 Test Acc: 0.502
Validation loss decreased (inf --> -0.501681).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0614125
	speed: 0.4131s/iter; left time: 15049.0597s
	iters: 200, epoch: 2 | loss: 2.4135633
	speed: 0.1183s/iter; left time: 4297.5925s
	iters: 300, epoch: 2 | loss: 1.6860976
	speed: 0.1034s/iter; left time: 3744.8595s
Epoch: 2 cost time: 39.442222356796265
Epoch: 2, Steps: 369 | Train Loss: 1.469 Vali Loss: 2.471 Vali Acc: 0.500 Test Loss: 2.471 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1031902
	speed: 0.4260s/iter; left time: 15361.3056s
	iters: 200, epoch: 3 | loss: 0.8193658
	speed: 0.0996s/iter; left time: 3582.6717s
	iters: 300, epoch: 3 | loss: 0.4918703
	speed: 0.1176s/iter; left time: 4216.6845s
Epoch: 3 cost time: 40.72777462005615
Epoch: 3, Steps: 369 | Train Loss: 1.267 Vali Loss: 1.126 Vali Acc: 0.519 Test Loss: 1.126 Test Acc: 0.519
Validation loss decreased (-0.501681 --> -0.519001).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7480801
	speed: 0.4496s/iter; left time: 16048.6468s
	iters: 200, epoch: 4 | loss: 0.9927766
	speed: 0.1208s/iter; left time: 4298.8791s
	iters: 300, epoch: 4 | loss: 0.7466779
	speed: 0.1100s/iter; left time: 3902.9699s
Epoch: 4 cost time: 44.10704159736633
Epoch: 4, Steps: 369 | Train Loss: 1.156 Vali Loss: 0.752 Vali Acc: 0.665 Test Loss: 0.752 Test Acc: 0.665
Validation loss decreased (-0.519001 --> -0.665429).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4701225
	speed: 0.4552s/iter; left time: 16079.3862s
	iters: 200, epoch: 5 | loss: 2.2756381
	speed: 0.0919s/iter; left time: 3236.3876s
	iters: 300, epoch: 5 | loss: 2.1107204
	speed: 0.0646s/iter; left time: 2269.3844s
Epoch: 5 cost time: 31.614010334014893
Epoch: 5, Steps: 369 | Train Loss: 2.483 Vali Loss: 0.808 Vali Acc: 0.500 Test Loss: 0.808 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7838698
	speed: 0.3887s/iter; left time: 13587.6236s
	iters: 200, epoch: 6 | loss: 0.8704353
	speed: 0.1091s/iter; left time: 3803.5668s
	iters: 300, epoch: 6 | loss: 0.7142376
	speed: 0.1020s/iter; left time: 3544.0336s
Epoch: 6 cost time: 39.34454154968262
Epoch: 6, Steps: 369 | Train Loss: 1.182 Vali Loss: 1.077 Vali Acc: 0.500 Test Loss: 1.077 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.7860371
	speed: 0.4185s/iter; left time: 14475.7942s
	iters: 200, epoch: 7 | loss: 1.6746780
	speed: 0.1106s/iter; left time: 3813.7463s
	iters: 300, epoch: 7 | loss: 0.7384478
	speed: 0.1156s/iter; left time: 3975.9041s
Epoch: 7 cost time: 40.30697250366211
Epoch: 7, Steps: 369 | Train Loss: 0.874 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.7919378
	speed: 0.4123s/iter; left time: 14109.5815s
	iters: 200, epoch: 8 | loss: 0.6882653
	speed: 0.1054s/iter; left time: 3596.8877s
	iters: 300, epoch: 8 | loss: 0.8597786
	speed: 0.1094s/iter; left time: 3721.7338s
Epoch: 8 cost time: 39.52697682380676
Epoch: 8, Steps: 369 | Train Loss: 0.791 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.7434385
	speed: 0.4064s/iter; left time: 13757.7090s
	iters: 200, epoch: 9 | loss: 0.7203034
	speed: 0.1004s/iter; left time: 3386.8780s
	iters: 300, epoch: 9 | loss: 1.0316968
	speed: 0.0979s/iter; left time: 3295.7006s
Epoch: 9 cost time: 36.69732332229614
Epoch: 9, Steps: 369 | Train Loss: 0.961 Vali Loss: 1.065 Vali Acc: 0.500 Test Loss: 1.065 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.7761691
	speed: 0.3984s/iter; left time: 13339.5479s
	iters: 200, epoch: 10 | loss: 0.7133418
	speed: 0.0929s/iter; left time: 3102.6308s
	iters: 300, epoch: 10 | loss: 0.6820515
	speed: 0.1136s/iter; left time: 3779.5602s
Epoch: 10 cost time: 38.2890625
Epoch: 10, Steps: 369 | Train Loss: 0.786 Vali Loss: 0.695 Vali Acc: 0.502 Test Loss: 0.695 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.7979826
	speed: 0.4214s/iter; left time: 13954.2023s
	iters: 200, epoch: 11 | loss: 0.6523948
	speed: 0.1113s/iter; left time: 3672.7708s
	iters: 300, epoch: 11 | loss: 0.7131933
	speed: 0.1085s/iter; left time: 3570.7082s
Epoch: 11 cost time: 41.12167525291443
Epoch: 11, Steps: 369 | Train Loss: 0.738 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.7682865
	speed: 0.4199s/iter; left time: 13749.8374s
	iters: 200, epoch: 12 | loss: 0.7005967
	speed: 0.1010s/iter; left time: 3295.2512s
	iters: 300, epoch: 12 | loss: 0.6563808
	speed: 0.1265s/iter; left time: 4117.3063s
Epoch: 12 cost time: 42.264678716659546
Epoch: 12, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.6949568
	speed: 0.4790s/iter; left time: 15505.7216s
	iters: 200, epoch: 13 | loss: 0.7729188
	speed: 0.1079s/iter; left time: 3482.7980s
	iters: 300, epoch: 13 | loss: 0.7909830
	speed: 0.1277s/iter; left time: 4107.4940s
Epoch: 13 cost time: 45.40485072135925
Epoch: 13, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.693 Vali Acc: 0.499 Test Loss: 0.693 Test Acc: 0.499
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.6897336
	speed: 0.4654s/iter; left time: 14894.0296s
	iters: 200, epoch: 14 | loss: 0.6692410
	speed: 0.1107s/iter; left time: 3531.3302s
	iters: 300, epoch: 14 | loss: 0.7317409
	speed: 0.1109s/iter; left time: 3527.9598s
Epoch: 14 cost time: 42.55480599403381
Epoch: 14, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6654370034052214
model parameter : 5418522
model size : 25.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 4.2758427
	speed: 0.1181s/iter; left time: 4345.1577s
	iters: 200, epoch: 1 | loss: 1.5519876
	speed: 0.1049s/iter; left time: 3849.2191s
	iters: 300, epoch: 1 | loss: 8.3074112
	speed: 0.1021s/iter; left time: 3738.6186s
Epoch: 1 cost time: 39.80930757522583
Epoch: 1, Steps: 369 | Train Loss: 3.536 Vali Loss: 15.818 Vali Acc: 0.500 Test Loss: 15.818 Test Acc: 0.500
Validation loss decreased (inf --> -0.499842).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0243841
	speed: 0.4126s/iter; left time: 15031.7042s
	iters: 200, epoch: 2 | loss: 0.5190011
	speed: 0.0862s/iter; left time: 3130.8504s
	iters: 300, epoch: 2 | loss: 0.5991813
	speed: 0.0604s/iter; left time: 2189.3796s
Epoch: 2 cost time: 29.487188577651978
Epoch: 2, Steps: 369 | Train Loss: 2.906 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
Validation loss decreased (-0.499842 --> -0.600444).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1782097
	speed: 0.3442s/iter; left time: 12411.3561s
	iters: 200, epoch: 3 | loss: 0.6760067
	speed: 0.0886s/iter; left time: 3185.7920s
	iters: 300, epoch: 3 | loss: 1.2259061
	speed: 0.1031s/iter; left time: 3699.0968s
Epoch: 3 cost time: 36.8789279460907
Epoch: 3, Steps: 369 | Train Loss: 1.150 Vali Loss: 0.717 Vali Acc: 0.653 Test Loss: 0.717 Test Acc: 0.653
Validation loss decreased (-0.600444 --> -0.653228).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6846543
	speed: 0.4142s/iter; left time: 14783.7773s
	iters: 200, epoch: 4 | loss: 0.0903974
	speed: 0.0859s/iter; left time: 3057.0070s
	iters: 300, epoch: 4 | loss: 1.0708680
	speed: 0.0949s/iter; left time: 3368.8670s
Epoch: 4 cost time: 36.932047843933105
Epoch: 4, Steps: 369 | Train Loss: 0.993 Vali Loss: 1.516 Vali Acc: 0.510 Test Loss: 1.516 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9968104
	speed: 0.4196s/iter; left time: 14822.8178s
	iters: 200, epoch: 5 | loss: 1.0470859
	speed: 0.1040s/iter; left time: 3661.8119s
	iters: 300, epoch: 5 | loss: 0.6177534
	speed: 0.1043s/iter; left time: 3662.1634s
Epoch: 5 cost time: 39.305431842803955
Epoch: 5, Steps: 369 | Train Loss: 0.781 Vali Loss: 0.757 Vali Acc: 0.623 Test Loss: 0.757 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8687319
	speed: 0.4478s/iter; left time: 15651.8820s
	iters: 200, epoch: 6 | loss: 0.7008597
	speed: 0.1129s/iter; left time: 3933.8792s
	iters: 300, epoch: 6 | loss: 1.0569454
	speed: 0.1100s/iter; left time: 3823.0382s
Epoch: 6 cost time: 43.68395185470581
Epoch: 6, Steps: 369 | Train Loss: 0.844 Vali Loss: 0.690 Vali Acc: 0.645 Test Loss: 0.690 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.5844520
	speed: 0.4515s/iter; left time: 15616.6939s
	iters: 200, epoch: 7 | loss: 1.2462066
	speed: 0.1197s/iter; left time: 4128.2864s
	iters: 300, epoch: 7 | loss: 1.0175312
	speed: 0.1114s/iter; left time: 3831.5816s
Epoch: 7 cost time: 43.78935527801514
Epoch: 7, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.810 Vali Acc: 0.613 Test Loss: 0.810 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7642676
	speed: 0.4422s/iter; left time: 15131.7543s
	iters: 200, epoch: 8 | loss: 0.6702153
	speed: 0.1069s/iter; left time: 3645.7517s
	iters: 300, epoch: 8 | loss: 0.7070985
	speed: 0.1010s/iter; left time: 3436.7654s
Epoch: 8 cost time: 37.74505257606506
Epoch: 8, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.720 Vali Acc: 0.648 Test Loss: 0.720 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.4637890
	speed: 0.4085s/iter; left time: 13828.1473s
	iters: 200, epoch: 9 | loss: 0.6297669
	speed: 0.1113s/iter; left time: 3757.5850s
	iters: 300, epoch: 9 | loss: 1.0470835
	speed: 0.1073s/iter; left time: 3609.5476s
Epoch: 9 cost time: 40.3590829372406
Epoch: 9, Steps: 369 | Train Loss: 0.608 Vali Loss: 0.683 Vali Acc: 0.661 Test Loss: 0.683 Test Acc: 0.661
Validation loss decreased (-0.653228 --> -0.661174).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5236476
	speed: 0.4076s/iter; left time: 13645.8103s
	iters: 200, epoch: 10 | loss: 0.6294231
	speed: 0.1106s/iter; left time: 3690.8508s
	iters: 300, epoch: 10 | loss: 0.5385298
	speed: 0.0971s/iter; left time: 3232.6684s
Epoch: 10 cost time: 37.10829734802246
Epoch: 10, Steps: 369 | Train Loss: 0.600 Vali Loss: 0.701 Vali Acc: 0.656 Test Loss: 0.701 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5694175
	speed: 0.4057s/iter; left time: 13431.7211s
	iters: 200, epoch: 11 | loss: 1.8817720
	speed: 0.1042s/iter; left time: 3439.4212s
	iters: 300, epoch: 11 | loss: 0.9411131
	speed: 0.1159s/iter; left time: 3815.8858s
Epoch: 11 cost time: 39.508986711502075
Epoch: 11, Steps: 369 | Train Loss: 1.476 Vali Loss: 1.398 Vali Acc: 0.502 Test Loss: 1.398 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.7023339
	speed: 0.4075s/iter; left time: 13343.0008s
	iters: 200, epoch: 12 | loss: 0.6988127
	speed: 0.1010s/iter; left time: 3298.0936s
	iters: 300, epoch: 12 | loss: 0.9777706
	speed: 0.1045s/iter; left time: 3400.8144s
Epoch: 12 cost time: 37.98551321029663
Epoch: 12, Steps: 369 | Train Loss: 0.716 Vali Loss: 1.128 Vali Acc: 0.526 Test Loss: 1.128 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.5768256
	speed: 0.4159s/iter; left time: 13464.1927s
	iters: 200, epoch: 13 | loss: 0.6275442
	speed: 0.0991s/iter; left time: 3198.1591s
	iters: 300, epoch: 13 | loss: 0.6232499
	speed: 0.1085s/iter; left time: 3491.3534s
Epoch: 13 cost time: 38.78220462799072
Epoch: 13, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.624 Vali Acc: 0.663 Test Loss: 0.624 Test Acc: 0.663
Validation loss decreased (-0.661174 --> -0.662877).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8897982
	speed: 0.4155s/iter; left time: 13297.4681s
	iters: 200, epoch: 14 | loss: 0.5763307
	speed: 0.1004s/iter; left time: 3203.5790s
	iters: 300, epoch: 14 | loss: 0.8013632
	speed: 0.1240s/iter; left time: 3942.6881s
Epoch: 14 cost time: 42.54868531227112
Epoch: 14, Steps: 369 | Train Loss: 0.616 Vali Loss: 0.793 Vali Acc: 0.642 Test Loss: 0.793 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9022267
	speed: 0.4514s/iter; left time: 14280.9256s
	iters: 200, epoch: 15 | loss: 0.5352633
	speed: 0.1096s/iter; left time: 3455.3515s
	iters: 300, epoch: 15 | loss: 0.5814242
	speed: 0.1161s/iter; left time: 3649.8114s
Epoch: 15 cost time: 43.58486771583557
Epoch: 15, Steps: 369 | Train Loss: 0.609 Vali Loss: 0.634 Vali Acc: 0.659 Test Loss: 0.634 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4505355
	speed: 0.3888s/iter; left time: 12155.9473s
	iters: 200, epoch: 16 | loss: 0.3176444
	speed: 0.0592s/iter; left time: 1845.5665s
	iters: 300, epoch: 16 | loss: 0.5876580
	speed: 0.0836s/iter; left time: 2597.3933s
Epoch: 16 cost time: 28.741960048675537
Epoch: 16, Steps: 369 | Train Loss: 0.597 Vali Loss: 0.637 Vali Acc: 0.648 Test Loss: 0.637 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.5329157
	speed: 0.4194s/iter; left time: 12958.0173s
	iters: 200, epoch: 17 | loss: 0.3863721
	speed: 0.1034s/iter; left time: 3183.5000s
	iters: 300, epoch: 17 | loss: 0.6679795
	speed: 0.0945s/iter; left time: 2902.0732s
Epoch: 17 cost time: 39.573979139328
Epoch: 17, Steps: 369 | Train Loss: 0.603 Vali Loss: 0.697 Vali Acc: 0.645 Test Loss: 0.697 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.6223621
	speed: 0.4240s/iter; left time: 12943.4992s
	iters: 200, epoch: 18 | loss: 0.6527869
	speed: 0.1131s/iter; left time: 3441.6866s
	iters: 300, epoch: 18 | loss: 0.7614723
	speed: 0.1004s/iter; left time: 3046.2692s
Epoch: 18 cost time: 40.018994092941284
Epoch: 18, Steps: 369 | Train Loss: 0.587 Vali Loss: 0.664 Vali Acc: 0.621 Test Loss: 0.664 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.5895445
	speed: 0.4220s/iter; left time: 12725.9193s
	iters: 200, epoch: 19 | loss: 0.6965420
	speed: 0.0980s/iter; left time: 2946.4785s
	iters: 300, epoch: 19 | loss: 0.5588484
	speed: 0.0966s/iter; left time: 2893.1727s
Epoch: 19 cost time: 38.99059820175171
Epoch: 19, Steps: 369 | Train Loss: 0.585 Vali Loss: 0.679 Vali Acc: 0.617 Test Loss: 0.679 Test Acc: 0.617
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.6628196
	speed: 0.4237s/iter; left time: 12623.1882s
	iters: 200, epoch: 20 | loss: 0.4612257
	speed: 0.1135s/iter; left time: 3370.5373s
	iters: 300, epoch: 20 | loss: 0.4576164
	speed: 0.1020s/iter; left time: 3018.0145s
Epoch: 20 cost time: 40.46378755569458
Epoch: 20, Steps: 369 | Train Loss: 0.631 Vali Loss: 0.649 Vali Acc: 0.632 Test Loss: 0.649 Test Acc: 0.632
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.8157442
	speed: 0.4110s/iter; left time: 12090.9477s
	iters: 200, epoch: 21 | loss: 0.7353278
	speed: 0.1037s/iter; left time: 3041.6105s
	iters: 300, epoch: 21 | loss: 0.6873425
	speed: 0.0951s/iter; left time: 2780.1628s
Epoch: 21 cost time: 37.184099435806274
Epoch: 21, Steps: 369 | Train Loss: 0.676 Vali Loss: 0.688 Vali Acc: 0.571 Test Loss: 0.688 Test Acc: 0.571
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.7924091
	speed: 0.4069s/iter; left time: 11820.1800s
	iters: 200, epoch: 22 | loss: 0.6646177
	speed: 0.1065s/iter; left time: 3083.2373s
	iters: 300, epoch: 22 | loss: 0.6094359
	speed: 0.0985s/iter; left time: 2840.7511s
Epoch: 22 cost time: 39.01565074920654
Epoch: 22, Steps: 369 | Train Loss: 0.633 Vali Loss: 0.691 Vali Acc: 0.625 Test Loss: 0.691 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.5113720
	speed: 0.4326s/iter; left time: 12408.0191s
	iters: 200, epoch: 23 | loss: 0.6320011
	speed: 0.1255s/iter; left time: 3586.6146s
	iters: 300, epoch: 23 | loss: 0.6203826
	speed: 0.0987s/iter; left time: 2810.2711s
Epoch: 23 cost time: 41.399343729019165
Epoch: 23, Steps: 369 | Train Loss: 0.676 Vali Loss: 0.679 Vali Acc: 0.598 Test Loss: 0.679 Test Acc: 0.598
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.662883087400681
model parameter : 4635162
model size : 22.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.5425150
	speed: 0.1245s/iter; left time: 4581.8231s
	iters: 200, epoch: 1 | loss: 1.6380080
	speed: 0.1176s/iter; left time: 4315.2779s
	iters: 300, epoch: 1 | loss: 17.5647469
	speed: 0.1176s/iter; left time: 4304.7780s
Epoch: 1 cost time: 44.502331018447876
Epoch: 1, Steps: 369 | Train Loss: 3.481 Vali Loss: 1.071 Vali Acc: 0.627 Test Loss: 1.071 Test Acc: 0.627
Validation loss decreased (inf --> -0.626550).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2310573
	speed: 0.4512s/iter; left time: 16436.6002s
	iters: 200, epoch: 2 | loss: 2.0614870
	speed: 0.0999s/iter; left time: 3628.4320s
	iters: 300, epoch: 2 | loss: 0.9167772
	speed: 0.0875s/iter; left time: 3169.5993s
Epoch: 2 cost time: 35.03133296966553
Epoch: 2, Steps: 369 | Train Loss: 1.395 Vali Loss: 1.075 Vali Acc: 0.628 Test Loss: 1.075 Test Acc: 0.628
Validation loss decreased (-0.626550 --> -0.627969).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0061785
	speed: 0.3896s/iter; left time: 14051.4835s
	iters: 200, epoch: 3 | loss: 0.9029226
	speed: 0.1067s/iter; left time: 3838.7136s
	iters: 300, epoch: 3 | loss: 0.8561504
	speed: 0.1051s/iter; left time: 3767.9759s
Epoch: 3 cost time: 38.336992263793945
Epoch: 3, Steps: 369 | Train Loss: 1.343 Vali Loss: 2.894 Vali Acc: 0.501 Test Loss: 2.894 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1841142
	speed: 0.4012s/iter; left time: 14321.4392s
	iters: 200, epoch: 4 | loss: 1.3154651
	speed: 0.1035s/iter; left time: 3683.5692s
	iters: 300, epoch: 4 | loss: 0.2962147
	speed: 0.1044s/iter; left time: 3707.0330s
Epoch: 4 cost time: 38.08579397201538
Epoch: 4, Steps: 369 | Train Loss: 1.027 Vali Loss: 0.878 Vali Acc: 0.500 Test Loss: 0.878 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8317235
	speed: 0.4164s/iter; left time: 14710.9349s
	iters: 200, epoch: 5 | loss: 0.9959012
	speed: 0.0984s/iter; left time: 3465.5216s
	iters: 300, epoch: 5 | loss: 1.0082258
	speed: 0.1121s/iter; left time: 3939.0946s
Epoch: 5 cost time: 38.637239933013916
Epoch: 5, Steps: 369 | Train Loss: 1.033 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.8478833
	speed: 0.3925s/iter; left time: 13718.9266s
	iters: 200, epoch: 6 | loss: 1.0054493
	speed: 0.1039s/iter; left time: 3622.9927s
	iters: 300, epoch: 6 | loss: 0.9026661
	speed: 0.1040s/iter; left time: 3616.1389s
Epoch: 6 cost time: 38.99617671966553
Epoch: 6, Steps: 369 | Train Loss: 0.867 Vali Loss: 0.867 Vali Acc: 0.500 Test Loss: 0.867 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.9038504
	speed: 0.4034s/iter; left time: 13953.2587s
	iters: 200, epoch: 7 | loss: 0.7570783
	speed: 0.0899s/iter; left time: 3101.6074s
	iters: 300, epoch: 7 | loss: 0.8534929
	speed: 0.1146s/iter; left time: 3941.8564s
Epoch: 7 cost time: 37.446871757507324
Epoch: 7, Steps: 369 | Train Loss: 0.815 Vali Loss: 0.841 Vali Acc: 0.500 Test Loss: 0.841 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.5816283
	speed: 0.4013s/iter; left time: 13732.8854s
	iters: 200, epoch: 8 | loss: 0.5872408
	speed: 0.0987s/iter; left time: 3368.2436s
	iters: 300, epoch: 8 | loss: 0.5998868
	speed: 0.1120s/iter; left time: 3809.1040s
Epoch: 8 cost time: 40.099783420562744
Epoch: 8, Steps: 369 | Train Loss: 0.729 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.3807358
	speed: 0.4331s/iter; left time: 14658.7156s
	iters: 200, epoch: 9 | loss: 0.6262395
	speed: 0.1112s/iter; left time: 3754.0762s
	iters: 300, epoch: 9 | loss: 0.8692049
	speed: 0.1131s/iter; left time: 3805.7709s
Epoch: 9 cost time: 43.26482653617859
Epoch: 9, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.678 Vali Acc: 0.581 Test Loss: 0.678 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.5897922
	speed: 0.4634s/iter; left time: 15514.2085s
	iters: 200, epoch: 10 | loss: 0.6709670
	speed: 0.1194s/iter; left time: 3984.2590s
	iters: 300, epoch: 10 | loss: 0.6904329
	speed: 0.1148s/iter; left time: 3819.4213s
Epoch: 10 cost time: 44.3258273601532
Epoch: 10, Steps: 369 | Train Loss: 0.730 Vali Loss: 0.697 Vali Acc: 0.501 Test Loss: 0.697 Test Acc: 0.501
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7284302
	speed: 0.4419s/iter; left time: 14631.1752s
	iters: 200, epoch: 11 | loss: 0.6200764
	speed: 0.0934s/iter; left time: 3084.6119s
	iters: 300, epoch: 11 | loss: 0.7784463
	speed: 0.0916s/iter; left time: 3014.4413s
Epoch: 11 cost time: 34.9855637550354
Epoch: 11, Steps: 369 | Train Loss: 0.738 Vali Loss: 0.684 Vali Acc: 0.552 Test Loss: 0.684 Test Acc: 0.552
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7178947
	speed: 0.3172s/iter; left time: 10386.0355s
	iters: 200, epoch: 12 | loss: 0.8116776
	speed: 0.1043s/iter; left time: 3403.1468s
	iters: 300, epoch: 12 | loss: 0.6463578
	speed: 0.0928s/iter; left time: 3021.4450s
Epoch: 12 cost time: 38.04099798202515
Epoch: 12, Steps: 369 | Train Loss: 0.737 Vali Loss: 0.705 Vali Acc: 0.511 Test Loss: 0.705 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6279795686719637
model parameter : 4633626
model size : 22.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.6458988
	speed: 0.1254s/iter; left time: 4613.3012s
	iters: 200, epoch: 1 | loss: 16.2504978
	speed: 0.1057s/iter; left time: 3879.0452s
	iters: 300, epoch: 1 | loss: 5.0374227
	speed: 0.0999s/iter; left time: 3654.8273s
Epoch: 1 cost time: 40.45233511924744
Epoch: 1, Steps: 369 | Train Loss: 4.029 Vali Loss: 4.361 Vali Acc: 0.609 Test Loss: 4.361 Test Acc: 0.609
Validation loss decreased (inf --> -0.608923).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5779970
	speed: 0.4162s/iter; left time: 15163.6211s
	iters: 200, epoch: 2 | loss: 1.7173094
	speed: 0.0976s/iter; left time: 3545.4149s
	iters: 300, epoch: 2 | loss: 0.8521289
	speed: 0.0996s/iter; left time: 3607.1303s
Epoch: 2 cost time: 38.531017541885376
Epoch: 2, Steps: 369 | Train Loss: 1.499 Vali Loss: 4.765 Vali Acc: 0.500 Test Loss: 4.765 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7755298
	speed: 0.4207s/iter; left time: 15172.8853s
	iters: 200, epoch: 3 | loss: 1.0809183
	speed: 0.1075s/iter; left time: 3866.1757s
	iters: 300, epoch: 3 | loss: 0.7930508
	speed: 0.0913s/iter; left time: 3273.0159s
Epoch: 3 cost time: 39.172460079193115
Epoch: 3, Steps: 369 | Train Loss: 1.306 Vali Loss: 1.242 Vali Acc: 0.531 Test Loss: 1.242 Test Acc: 0.531
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1091180
	speed: 0.4141s/iter; left time: 14779.6014s
	iters: 200, epoch: 4 | loss: 0.6902218
	speed: 0.0982s/iter; left time: 3495.1997s
	iters: 300, epoch: 4 | loss: 0.5425357
	speed: 0.0983s/iter; left time: 3488.4526s
Epoch: 4 cost time: 38.23754906654358
Epoch: 4, Steps: 369 | Train Loss: 1.006 Vali Loss: 0.664 Vali Acc: 0.647 Test Loss: 0.664 Test Acc: 0.647
Validation loss decreased (-0.608923 --> -0.646985).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.5969439
	speed: 0.4509s/iter; left time: 15929.2725s
	iters: 200, epoch: 5 | loss: 0.2901314
	speed: 0.1164s/iter; left time: 4099.2826s
	iters: 300, epoch: 5 | loss: 0.5482271
	speed: 0.1089s/iter; left time: 3826.1431s
Epoch: 5 cost time: 42.146299839019775
Epoch: 5, Steps: 369 | Train Loss: 0.785 Vali Loss: 0.961 Vali Acc: 0.622 Test Loss: 0.961 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3540690
	speed: 0.4373s/iter; left time: 15285.1118s
	iters: 200, epoch: 6 | loss: 0.6159043
	speed: 0.1196s/iter; left time: 4168.9622s
	iters: 300, epoch: 6 | loss: 0.8817382
	speed: 0.1132s/iter; left time: 3932.9319s
Epoch: 6 cost time: 42.104275703430176
Epoch: 6, Steps: 369 | Train Loss: 0.645 Vali Loss: 0.666 Vali Acc: 0.642 Test Loss: 0.666 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3840264
	speed: 0.4235s/iter; left time: 14647.6350s
	iters: 200, epoch: 7 | loss: 0.6978464
	speed: 0.1028s/iter; left time: 3543.8932s
	iters: 300, epoch: 7 | loss: 0.2840535
	speed: 0.1039s/iter; left time: 3572.7085s
Epoch: 7 cost time: 37.81341862678528
Epoch: 7, Steps: 369 | Train Loss: 0.557 Vali Loss: 0.880 Vali Acc: 0.571 Test Loss: 0.880 Test Acc: 0.571
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.3907698
	speed: 0.3880s/iter; left time: 13276.1643s
	iters: 200, epoch: 8 | loss: 0.5078618
	speed: 0.1122s/iter; left time: 3827.6710s
	iters: 300, epoch: 8 | loss: 0.5147333
	speed: 0.1062s/iter; left time: 3611.3599s
Epoch: 8 cost time: 39.149280309677124
Epoch: 8, Steps: 369 | Train Loss: 0.497 Vali Loss: 0.870 Vali Acc: 0.602 Test Loss: 0.870 Test Acc: 0.602
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0949020
	speed: 0.4129s/iter; left time: 13977.2237s
	iters: 200, epoch: 9 | loss: 0.4535342
	speed: 0.1093s/iter; left time: 3688.0454s
	iters: 300, epoch: 9 | loss: 0.2168275
	speed: 0.1030s/iter; left time: 3464.6646s
Epoch: 9 cost time: 38.0578088760376
Epoch: 9, Steps: 369 | Train Loss: 0.463 Vali Loss: 1.161 Vali Acc: 0.564 Test Loss: 1.161 Test Acc: 0.564
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.4771110
	speed: 0.4034s/iter; left time: 13505.0821s
	iters: 200, epoch: 10 | loss: 0.2819713
	speed: 0.1086s/iter; left time: 3625.5214s
	iters: 300, epoch: 10 | loss: 0.6238052
	speed: 0.1126s/iter; left time: 3748.5449s
Epoch: 10 cost time: 39.78846001625061
Epoch: 10, Steps: 369 | Train Loss: 0.476 Vali Loss: 1.263 Vali Acc: 0.607 Test Loss: 1.263 Test Acc: 0.607
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.2563120
	speed: 0.3839s/iter; left time: 12711.5993s
	iters: 200, epoch: 11 | loss: 0.2552547
	speed: 0.1091s/iter; left time: 3601.9528s
	iters: 300, epoch: 11 | loss: 4.0108409
	speed: 0.0958s/iter; left time: 3152.4650s
Epoch: 11 cost time: 36.56205224990845
Epoch: 11, Steps: 369 | Train Loss: 1.224 Vali Loss: 10.219 Vali Acc: 0.500 Test Loss: 10.219 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.5247386
	speed: 0.4028s/iter; left time: 13187.6429s
	iters: 200, epoch: 12 | loss: 1.6235201
	speed: 0.1062s/iter; left time: 3466.7229s
	iters: 300, epoch: 12 | loss: 1.6064522
	speed: 0.1063s/iter; left time: 3460.7363s
Epoch: 12 cost time: 37.881479024887085
Epoch: 12, Steps: 369 | Train Loss: 1.688 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.3024906
	speed: 0.3775s/iter; left time: 12222.2223s
	iters: 200, epoch: 13 | loss: 1.3186367
	speed: 0.1055s/iter; left time: 3404.4331s
	iters: 300, epoch: 13 | loss: 0.6080968
	speed: 0.1155s/iter; left time: 3717.3321s
Epoch: 13 cost time: 39.82140803337097
Epoch: 13, Steps: 369 | Train Loss: 0.976 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.5752375
	speed: 0.4377s/iter; left time: 14006.9236s
	iters: 200, epoch: 14 | loss: 0.7111669
	speed: 0.1147s/iter; left time: 3659.0875s
	iters: 300, epoch: 14 | loss: 0.8407431
	speed: 0.1204s/iter; left time: 3829.6115s
Epoch: 14 cost time: 41.84581804275513
Epoch: 14, Steps: 369 | Train Loss: 0.761 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6469920544835415
model parameter : 4632090
model size : 22.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2285086
	speed: 0.1164s/iter; left time: 4284.4105s
	iters: 200, epoch: 1 | loss: 3.2252290
	speed: 0.1111s/iter; left time: 4077.8018s
	iters: 300, epoch: 1 | loss: 4.1180906
	speed: 0.0996s/iter; left time: 3646.4435s
Epoch: 1 cost time: 38.82511925697327
Epoch: 1, Steps: 369 | Train Loss: 4.686 Vali Loss: 4.800 Vali Acc: 0.637 Test Loss: 4.800 Test Acc: 0.637
Validation loss decreased (inf --> -0.636728).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6977673
	speed: 0.4029s/iter; left time: 14678.8556s
	iters: 200, epoch: 2 | loss: 0.2593682
	speed: 0.1008s/iter; left time: 3663.1843s
	iters: 300, epoch: 2 | loss: 1.3470106
	speed: 0.0931s/iter; left time: 3374.5818s
Epoch: 2 cost time: 37.44179034233093
Epoch: 2, Steps: 369 | Train Loss: 1.972 Vali Loss: 4.863 Vali Acc: 0.500 Test Loss: 4.863 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8550566
	speed: 0.4090s/iter; left time: 14749.2377s
	iters: 200, epoch: 3 | loss: 0.6274405
	speed: 0.1051s/iter; left time: 3781.0587s
	iters: 300, epoch: 3 | loss: 2.0063851
	speed: 0.0893s/iter; left time: 3203.4590s
Epoch: 3 cost time: 37.83664512634277
Epoch: 3, Steps: 369 | Train Loss: 1.227 Vali Loss: 2.287 Vali Acc: 0.500 Test Loss: 2.287 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5808191
	speed: 0.4051s/iter; left time: 14459.5673s
	iters: 200, epoch: 4 | loss: 1.3064605
	speed: 0.0999s/iter; left time: 3556.0058s
	iters: 300, epoch: 4 | loss: 0.5879519
	speed: 0.1001s/iter; left time: 3551.2283s
Epoch: 4 cost time: 38.46638822555542
Epoch: 4, Steps: 369 | Train Loss: 0.952 Vali Loss: 1.438 Vali Acc: 0.531 Test Loss: 1.438 Test Acc: 0.531
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.4630689
	speed: 0.4178s/iter; left time: 14759.6914s
	iters: 200, epoch: 5 | loss: 0.5337441
	speed: 0.0914s/iter; left time: 3218.1445s
	iters: 300, epoch: 5 | loss: 0.5049974
	speed: 0.0871s/iter; left time: 3061.0985s
Epoch: 5 cost time: 37.16752505302429
Epoch: 5, Steps: 369 | Train Loss: 0.745 Vali Loss: 1.116 Vali Acc: 0.565 Test Loss: 1.116 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.5119705
	speed: 0.4040s/iter; left time: 14121.3960s
	iters: 200, epoch: 6 | loss: 0.5813005
	speed: 0.0985s/iter; left time: 3431.8671s
	iters: 300, epoch: 6 | loss: 0.6281459
	speed: 0.1006s/iter; left time: 3495.1578s
Epoch: 6 cost time: 38.42577624320984
Epoch: 6, Steps: 369 | Train Loss: 0.574 Vali Loss: 0.666 Vali Acc: 0.670 Test Loss: 0.666 Test Acc: 0.670
Validation loss decreased (-0.636728 --> -0.669971).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4873457
	speed: 0.4106s/iter; left time: 14202.9486s
	iters: 200, epoch: 7 | loss: 0.5397484
	speed: 0.0981s/iter; left time: 3383.5105s
	iters: 300, epoch: 7 | loss: 0.3384774
	speed: 0.1091s/iter; left time: 3750.6921s
Epoch: 7 cost time: 40.45334601402283
Epoch: 7, Steps: 369 | Train Loss: 0.471 Vali Loss: 0.717 Vali Acc: 0.662 Test Loss: 0.717 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1781435
	speed: 0.4417s/iter; left time: 15112.7231s
	iters: 200, epoch: 8 | loss: 0.3581688
	speed: 0.1119s/iter; left time: 3816.6660s
	iters: 300, epoch: 8 | loss: 0.1175398
	speed: 0.1163s/iter; left time: 3955.8843s
Epoch: 8 cost time: 44.10994815826416
Epoch: 8, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.722 Vali Acc: 0.646 Test Loss: 0.722 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0973197
	speed: 0.4436s/iter; left time: 15015.7058s
	iters: 200, epoch: 9 | loss: 0.7332216
	speed: 0.0909s/iter; left time: 3068.0221s
	iters: 300, epoch: 9 | loss: 0.5013571
	speed: 0.0875s/iter; left time: 2945.1980s
Epoch: 9 cost time: 35.8437340259552
Epoch: 9, Steps: 369 | Train Loss: 0.346 Vali Loss: 0.880 Vali Acc: 0.657 Test Loss: 0.880 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1057342
	speed: 0.3980s/iter; left time: 13323.3730s
	iters: 200, epoch: 10 | loss: 0.7014579
	speed: 0.0982s/iter; left time: 3279.5598s
	iters: 300, epoch: 10 | loss: 0.0968045
	speed: 0.1065s/iter; left time: 3543.9266s
Epoch: 10 cost time: 39.661924839019775
Epoch: 10, Steps: 369 | Train Loss: 0.313 Vali Loss: 1.026 Vali Acc: 0.666 Test Loss: 1.026 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3593039
	speed: 0.4063s/iter; left time: 13452.4133s
	iters: 200, epoch: 11 | loss: 0.1778476
	speed: 0.0930s/iter; left time: 3070.4651s
	iters: 300, epoch: 11 | loss: 0.5805527
	speed: 0.1047s/iter; left time: 3444.9807s
Epoch: 11 cost time: 37.36940622329712
Epoch: 11, Steps: 369 | Train Loss: 0.295 Vali Loss: 1.140 Vali Acc: 0.638 Test Loss: 1.140 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1089057
	speed: 0.4117s/iter; left time: 13478.8438s
	iters: 200, epoch: 12 | loss: 0.4449477
	speed: 0.1012s/iter; left time: 3303.5783s
	iters: 300, epoch: 12 | loss: 0.2210485
	speed: 0.1096s/iter; left time: 3567.2644s
Epoch: 12 cost time: 38.29543614387512
Epoch: 12, Steps: 369 | Train Loss: 0.253 Vali Loss: 1.375 Vali Acc: 0.651 Test Loss: 1.375 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.4602438
	speed: 0.3076s/iter; left time: 9959.2697s
	iters: 200, epoch: 13 | loss: 0.1185100
	speed: 0.0592s/iter; left time: 1908.9536s
	iters: 300, epoch: 13 | loss: 0.3297511
	speed: 0.0902s/iter; left time: 2901.5057s
Epoch: 13 cost time: 27.927051067352295
Epoch: 13, Steps: 369 | Train Loss: 0.252 Vali Loss: 1.194 Vali Acc: 0.638 Test Loss: 1.194 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0980439
	speed: 0.4074s/iter; left time: 13038.6862s
	iters: 200, epoch: 14 | loss: 0.2252467
	speed: 0.0942s/iter; left time: 3003.7857s
	iters: 300, epoch: 14 | loss: 0.5283232
	speed: 0.0944s/iter; left time: 3002.7558s
Epoch: 14 cost time: 37.517937660217285
Epoch: 14, Steps: 369 | Train Loss: 0.183 Vali Loss: 1.528 Vali Acc: 0.637 Test Loss: 1.528 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.4385710
	speed: 0.3939s/iter; left time: 12462.0325s
	iters: 200, epoch: 15 | loss: 0.1594122
	speed: 0.0876s/iter; left time: 2763.3158s
	iters: 300, epoch: 15 | loss: 0.3557135
	speed: 0.1179s/iter; left time: 3707.4047s
Epoch: 15 cost time: 39.27293086051941
Epoch: 15, Steps: 369 | Train Loss: 0.218 Vali Loss: 1.384 Vali Acc: 0.647 Test Loss: 1.384 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0327056
	speed: 0.4577s/iter; left time: 14311.2757s
	iters: 200, epoch: 16 | loss: 0.6487837
	speed: 0.1068s/iter; left time: 3329.3243s
	iters: 300, epoch: 16 | loss: 0.1005307
	speed: 0.1148s/iter; left time: 3566.6604s
Epoch: 16 cost time: 42.066070556640625
Epoch: 16, Steps: 369 | Train Loss: 0.185 Vali Loss: 1.663 Vali Acc: 0.632 Test Loss: 1.663 Test Acc: 0.632
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6699772985244041
model parameter : 4630554
model size : 22.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 4.3196030
	speed: 0.1189s/iter; left time: 4376.2176s
	iters: 200, epoch: 1 | loss: 1.2743688
	speed: 0.1065s/iter; left time: 3907.1323s
	iters: 300, epoch: 1 | loss: 20.2732811
	speed: 0.0998s/iter; left time: 3652.9013s
Epoch: 1 cost time: 38.83536434173584
Epoch: 1, Steps: 369 | Train Loss: 4.635 Vali Loss: 7.377 Vali Acc: 0.551 Test Loss: 7.377 Test Acc: 0.551
Validation loss decreased (inf --> -0.551005).  Saving model ...
	iters: 100, epoch: 2 | loss: 10.5622015
	speed: 0.3864s/iter; left time: 14078.7804s
	iters: 200, epoch: 2 | loss: 6.7921057
	speed: 0.1049s/iter; left time: 3811.5582s
	iters: 300, epoch: 2 | loss: 0.5078875
	speed: 0.0920s/iter; left time: 3334.7220s
Epoch: 2 cost time: 36.31743359565735
Epoch: 2, Steps: 369 | Train Loss: 2.923 Vali Loss: 0.790 Vali Acc: 0.657 Test Loss: 0.790 Test Acc: 0.657
Validation loss decreased (-0.551005 --> -0.656632).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.5172246
	speed: 0.4049s/iter; left time: 14603.6200s
	iters: 200, epoch: 3 | loss: 1.6150026
	speed: 0.1021s/iter; left time: 3670.1256s
	iters: 300, epoch: 3 | loss: 1.9649558
	speed: 0.0980s/iter; left time: 3514.7525s
Epoch: 3 cost time: 37.98685264587402
Epoch: 3, Steps: 369 | Train Loss: 1.193 Vali Loss: 2.086 Vali Acc: 0.531 Test Loss: 2.086 Test Acc: 0.531
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0212030
	speed: 0.3894s/iter; left time: 13899.8028s
	iters: 200, epoch: 4 | loss: 0.5722996
	speed: 0.1088s/iter; left time: 3872.3364s
	iters: 300, epoch: 4 | loss: 1.3871145
	speed: 0.0917s/iter; left time: 3253.6141s
Epoch: 4 cost time: 37.03628969192505
Epoch: 4, Steps: 369 | Train Loss: 1.033 Vali Loss: 1.822 Vali Acc: 0.533 Test Loss: 1.822 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.0823015
	speed: 0.3920s/iter; left time: 13845.7989s
	iters: 200, epoch: 5 | loss: 1.4876474
	speed: 0.0948s/iter; left time: 3337.7053s
	iters: 300, epoch: 5 | loss: 1.3034633
	speed: 0.0997s/iter; left time: 3500.2264s
Epoch: 5 cost time: 37.90395188331604
Epoch: 5, Steps: 369 | Train Loss: 1.127 Vali Loss: 0.970 Vali Acc: 0.530 Test Loss: 0.970 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.0344012
	speed: 0.3989s/iter; left time: 13944.7243s
	iters: 200, epoch: 6 | loss: 0.7512700
	speed: 0.1044s/iter; left time: 3639.5730s
	iters: 300, epoch: 6 | loss: 0.4314444
	speed: 0.0941s/iter; left time: 3269.1261s
Epoch: 6 cost time: 38.49409627914429
Epoch: 6, Steps: 369 | Train Loss: 0.880 Vali Loss: 1.274 Vali Acc: 0.503 Test Loss: 1.274 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6312515
	speed: 0.4053s/iter; left time: 14016.4473s
	iters: 200, epoch: 7 | loss: 0.8317647
	speed: 0.1028s/iter; left time: 3544.4337s
	iters: 300, epoch: 7 | loss: 0.4895016
	speed: 0.1126s/iter; left time: 3871.5400s
Epoch: 7 cost time: 40.443422079086304
Epoch: 7, Steps: 369 | Train Loss: 0.778 Vali Loss: 0.701 Vali Acc: 0.571 Test Loss: 0.701 Test Acc: 0.571
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6952422
	speed: 0.4396s/iter; left time: 15042.6606s
	iters: 200, epoch: 8 | loss: 0.8405398
	speed: 0.1012s/iter; left time: 3453.1958s
	iters: 300, epoch: 8 | loss: 0.7552660
	speed: 0.1089s/iter; left time: 3703.5948s
Epoch: 8 cost time: 42.13220238685608
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.846 Vali Acc: 0.504 Test Loss: 0.846 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.5759178
	speed: 0.4423s/iter; left time: 14972.0467s
	iters: 200, epoch: 9 | loss: 0.7277995
	speed: 0.1197s/iter; left time: 4039.7154s
	iters: 300, epoch: 9 | loss: 0.7275345
	speed: 0.1050s/iter; left time: 3532.2847s
Epoch: 9 cost time: 41.43848896026611
Epoch: 9, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.672 Vali Acc: 0.591 Test Loss: 0.672 Test Acc: 0.591
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6435768
	speed: 0.4043s/iter; left time: 13536.9296s
	iters: 200, epoch: 10 | loss: 1.0451875
	speed: 0.0899s/iter; left time: 3000.1465s
	iters: 300, epoch: 10 | loss: 1.0084515
	speed: 0.1080s/iter; left time: 3594.1888s
Epoch: 10 cost time: 37.40939664840698
Epoch: 10, Steps: 369 | Train Loss: 0.725 Vali Loss: 0.666 Vali Acc: 0.600 Test Loss: 0.666 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.5656275
	speed: 0.3870s/iter; left time: 12815.6061s
	iters: 200, epoch: 11 | loss: 0.7432720
	speed: 0.1039s/iter; left time: 3429.9721s
	iters: 300, epoch: 11 | loss: 0.8571232
	speed: 0.1004s/iter; left time: 3303.8154s
Epoch: 11 cost time: 38.061728715896606
Epoch: 11, Steps: 369 | Train Loss: 0.813 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.7494100
	speed: 0.3114s/iter; left time: 10195.9040s
	iters: 200, epoch: 12 | loss: 0.8378079
	speed: 0.0488s/iter; left time: 1592.4871s
	iters: 300, epoch: 12 | loss: 0.7687343
	speed: 0.0811s/iter; left time: 2640.3506s
Epoch: 12 cost time: 27.03328537940979
Epoch: 12, Steps: 369 | Train Loss: 0.763 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6566401816118048
model parameter : 4241178
model size : 21.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5737053
	speed: 0.1126s/iter; left time: 4143.8336s
	iters: 200, epoch: 1 | loss: 2.0709496
	speed: 0.1004s/iter; left time: 3684.6714s
	iters: 300, epoch: 1 | loss: 4.4588099
	speed: 0.1014s/iter; left time: 3712.7367s
Epoch: 1 cost time: 38.33373475074768
Epoch: 1, Steps: 369 | Train Loss: 3.775 Vali Loss: 14.704 Vali Acc: 0.503 Test Loss: 14.704 Test Acc: 0.503
Validation loss decreased (inf --> -0.502407).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1620570
	speed: 0.3900s/iter; left time: 14207.6662s
	iters: 200, epoch: 2 | loss: 0.5130647
	speed: 0.0983s/iter; left time: 3570.0127s
	iters: 300, epoch: 2 | loss: 0.7700387
	speed: 0.1033s/iter; left time: 3741.9236s
Epoch: 2 cost time: 37.0123176574707
Epoch: 2, Steps: 369 | Train Loss: 2.197 Vali Loss: 0.815 Vali Acc: 0.640 Test Loss: 0.815 Test Acc: 0.640
Validation loss decreased (-0.502407 --> -0.639890).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7895944
	speed: 0.4088s/iter; left time: 14743.6646s
	iters: 200, epoch: 3 | loss: 0.6201940
	speed: 0.1018s/iter; left time: 3659.4558s
	iters: 300, epoch: 3 | loss: 2.2280104
	speed: 0.1200s/iter; left time: 4302.0472s
Epoch: 3 cost time: 40.68507957458496
Epoch: 3, Steps: 369 | Train Loss: 1.194 Vali Loss: 2.076 Vali Acc: 0.530 Test Loss: 2.076 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8272170
	speed: 0.4169s/iter; left time: 14882.0781s
	iters: 200, epoch: 4 | loss: 1.2770513
	speed: 0.1173s/iter; left time: 4174.0581s
	iters: 300, epoch: 4 | loss: 0.5494604
	speed: 0.1114s/iter; left time: 3954.6387s
Epoch: 4 cost time: 41.443968057632446
Epoch: 4, Steps: 369 | Train Loss: 1.034 Vali Loss: 1.209 Vali Acc: 0.501 Test Loss: 1.209 Test Acc: 0.501
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4179489
	speed: 0.4168s/iter; left time: 14722.3469s
	iters: 200, epoch: 5 | loss: 0.6940962
	speed: 0.1031s/iter; left time: 3630.3362s
	iters: 300, epoch: 5 | loss: 1.5251344
	speed: 0.0977s/iter; left time: 3432.8358s
Epoch: 5 cost time: 36.87477707862854
Epoch: 5, Steps: 369 | Train Loss: 0.793 Vali Loss: 0.624 Vali Acc: 0.671 Test Loss: 0.624 Test Acc: 0.671
Validation loss decreased (-0.639890 --> -0.671106).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3687140
	speed: 0.3973s/iter; left time: 13887.2557s
	iters: 200, epoch: 6 | loss: 0.5816971
	speed: 0.1023s/iter; left time: 3564.2351s
	iters: 300, epoch: 6 | loss: 0.6156065
	speed: 0.1028s/iter; left time: 3572.6500s
Epoch: 6 cost time: 37.43400979042053
Epoch: 6, Steps: 369 | Train Loss: 0.655 Vali Loss: 0.673 Vali Acc: 0.655 Test Loss: 0.673 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3381702
	speed: 0.3813s/iter; left time: 13188.6153s
	iters: 200, epoch: 7 | loss: 0.4423462
	speed: 0.1078s/iter; left time: 3716.3051s
	iters: 300, epoch: 7 | loss: 0.2559099
	speed: 0.1031s/iter; left time: 3544.3426s
Epoch: 7 cost time: 36.71744990348816
Epoch: 7, Steps: 369 | Train Loss: 0.565 Vali Loss: 0.732 Vali Acc: 0.672 Test Loss: 0.732 Test Acc: 0.672
Validation loss decreased (-0.671106 --> -0.671673).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5648654
	speed: 0.3875s/iter; left time: 13258.7038s
	iters: 200, epoch: 8 | loss: 0.1279019
	speed: 0.1004s/iter; left time: 3423.9864s
	iters: 300, epoch: 8 | loss: 0.6278097
	speed: 0.1006s/iter; left time: 3421.0824s
Epoch: 8 cost time: 35.979564905166626
Epoch: 8, Steps: 369 | Train Loss: 0.535 Vali Loss: 0.680 Vali Acc: 0.641 Test Loss: 0.680 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3945877
	speed: 0.3727s/iter; left time: 12613.9116s
	iters: 200, epoch: 9 | loss: 0.9441739
	speed: 0.1100s/iter; left time: 3713.5041s
	iters: 300, epoch: 9 | loss: 0.4460359
	speed: 0.0990s/iter; left time: 3331.9056s
Epoch: 9 cost time: 36.65559792518616
Epoch: 9, Steps: 369 | Train Loss: 0.500 Vali Loss: 1.136 Vali Acc: 0.631 Test Loss: 1.136 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3261610
	speed: 0.3919s/iter; left time: 13119.4634s
	iters: 200, epoch: 10 | loss: 0.4028233
	speed: 0.1009s/iter; left time: 3368.3627s
	iters: 300, epoch: 10 | loss: 0.7245196
	speed: 0.0980s/iter; left time: 3259.9443s
Epoch: 10 cost time: 36.61951494216919
Epoch: 10, Steps: 369 | Train Loss: 0.489 Vali Loss: 0.850 Vali Acc: 0.651 Test Loss: 0.850 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3260919
	speed: 0.3829s/iter; left time: 12678.8368s
	iters: 200, epoch: 11 | loss: 0.4281835
	speed: 0.1126s/iter; left time: 3717.5168s
	iters: 300, epoch: 11 | loss: 0.5417834
	speed: 0.0916s/iter; left time: 3015.8208s
Epoch: 11 cost time: 37.55025625228882
Epoch: 11, Steps: 369 | Train Loss: 0.477 Vali Loss: 0.739 Vali Acc: 0.634 Test Loss: 0.739 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2828729
	speed: 0.4259s/iter; left time: 13944.5116s
	iters: 200, epoch: 12 | loss: 0.4043173
	speed: 0.1117s/iter; left time: 3647.0182s
	iters: 300, epoch: 12 | loss: 0.4895548
	speed: 0.1039s/iter; left time: 3381.7584s
Epoch: 12 cost time: 41.13430166244507
Epoch: 12, Steps: 369 | Train Loss: 0.472 Vali Loss: 0.778 Vali Acc: 0.656 Test Loss: 0.778 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.6171807
	speed: 0.4350s/iter; left time: 14081.1706s
	iters: 200, epoch: 13 | loss: 0.4571411
	speed: 0.1247s/iter; left time: 4023.1537s
	iters: 300, epoch: 13 | loss: 0.4029534
	speed: 0.0962s/iter; left time: 3096.1488s
Epoch: 13 cost time: 40.736294746398926
Epoch: 13, Steps: 369 | Train Loss: 0.502 Vali Loss: 0.825 Vali Acc: 0.636 Test Loss: 0.825 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.4581669
	speed: 0.3790s/iter; left time: 12128.2187s
	iters: 200, epoch: 14 | loss: 0.7022314
	speed: 0.0951s/iter; left time: 3033.3407s
	iters: 300, epoch: 14 | loss: 0.4411314
	speed: 0.0987s/iter; left time: 3139.7634s
Epoch: 14 cost time: 34.92181348800659
Epoch: 14, Steps: 369 | Train Loss: 0.507 Vali Loss: 0.821 Vali Acc: 0.637 Test Loss: 0.821 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.4879895
	speed: 0.3913s/iter; left time: 12377.8610s
	iters: 200, epoch: 15 | loss: 0.3549720
	speed: 0.1043s/iter; left time: 3287.5970s
	iters: 300, epoch: 15 | loss: 0.8988342
	speed: 0.0854s/iter; left time: 2684.2592s
Epoch: 15 cost time: 36.45488500595093
Epoch: 15, Steps: 369 | Train Loss: 0.516 Vali Loss: 0.864 Vali Acc: 0.642 Test Loss: 0.864 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.8138152
	speed: 0.3823s/iter; left time: 11953.9599s
	iters: 200, epoch: 16 | loss: 0.4819842
	speed: 0.1018s/iter; left time: 3171.5223s
	iters: 300, epoch: 16 | loss: 0.3453438
	speed: 0.0944s/iter; left time: 2932.3946s
Epoch: 16 cost time: 36.179484605789185
Epoch: 16, Steps: 369 | Train Loss: 0.504 Vali Loss: 0.797 Vali Acc: 0.654 Test Loss: 0.797 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.3319540
	speed: 0.3903s/iter; left time: 12060.5309s
	iters: 200, epoch: 17 | loss: 0.4291405
	speed: 0.0989s/iter; left time: 3046.9327s
	iters: 300, epoch: 17 | loss: 0.4061784
	speed: 0.0862s/iter; left time: 2645.5261s
Epoch: 17 cost time: 35.26181626319885
Epoch: 17, Steps: 369 | Train Loss: 0.522 Vali Loss: 0.899 Vali Acc: 0.646 Test Loss: 0.899 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6716799091940976
model parameter : 4239642
model size : 21.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.0278964
	speed: 0.1255s/iter; left time: 4619.1111s
	iters: 200, epoch: 1 | loss: 1.8830283
	speed: 0.0948s/iter; left time: 3477.6302s
	iters: 300, epoch: 1 | loss: 1.9761342
	speed: 0.0770s/iter; left time: 2817.1724s
Epoch: 1 cost time: 33.81897830963135
Epoch: 1, Steps: 369 | Train Loss: 3.195 Vali Loss: 1.725 Vali Acc: 0.503 Test Loss: 1.725 Test Acc: 0.503
Validation loss decreased (inf --> -0.502537).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2341621
	speed: 0.2943s/iter; left time: 10722.2039s
	iters: 200, epoch: 2 | loss: 0.6133571
	speed: 0.1043s/iter; left time: 3788.1686s
	iters: 300, epoch: 2 | loss: 2.4267578
	speed: 0.0994s/iter; left time: 3602.7406s
Epoch: 2 cost time: 39.54340314865112
Epoch: 2, Steps: 369 | Train Loss: 1.736 Vali Loss: 3.037 Vali Acc: 0.500 Test Loss: 3.037 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3531369
	speed: 0.4463s/iter; left time: 16094.4305s
	iters: 200, epoch: 3 | loss: 0.8865640
	speed: 0.1113s/iter; left time: 4003.9929s
	iters: 300, epoch: 3 | loss: 1.2229372
	speed: 0.1103s/iter; left time: 3955.4721s
Epoch: 3 cost time: 42.11021161079407
Epoch: 3, Steps: 369 | Train Loss: 1.254 Vali Loss: 0.722 Vali Acc: 0.660 Test Loss: 0.722 Test Acc: 0.660
Validation loss decreased (-0.502537 --> -0.659754).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4273119
	speed: 0.4538s/iter; left time: 16199.1562s
	iters: 200, epoch: 4 | loss: 1.2656893
	speed: 0.0890s/iter; left time: 3168.3718s
	iters: 300, epoch: 4 | loss: 2.1803191
	speed: 0.0926s/iter; left time: 3287.6675s
Epoch: 4 cost time: 38.50713872909546
Epoch: 4, Steps: 369 | Train Loss: 1.168 Vali Loss: 1.410 Vali Acc: 0.509 Test Loss: 1.410 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8840975
	speed: 0.4004s/iter; left time: 14144.3718s
	iters: 200, epoch: 5 | loss: 1.4979937
	speed: 0.0957s/iter; left time: 3369.3642s
	iters: 300, epoch: 5 | loss: 1.1618754
	speed: 0.0972s/iter; left time: 3413.0508s
Epoch: 5 cost time: 36.69420504570007
Epoch: 5, Steps: 369 | Train Loss: 0.953 Vali Loss: 0.711 Vali Acc: 0.570 Test Loss: 0.711 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.0103849
	speed: 0.3912s/iter; left time: 13673.5580s
	iters: 200, epoch: 6 | loss: 0.9004096
	speed: 0.0752s/iter; left time: 2622.6066s
	iters: 300, epoch: 6 | loss: 0.6138418
	speed: 0.1128s/iter; left time: 3919.5825s
Epoch: 6 cost time: 35.64307641983032
Epoch: 6, Steps: 369 | Train Loss: 0.796 Vali Loss: 0.751 Vali Acc: 0.599 Test Loss: 0.751 Test Acc: 0.599
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6353067
	speed: 0.3996s/iter; left time: 13820.0427s
	iters: 200, epoch: 7 | loss: 0.9877067
	speed: 0.0996s/iter; left time: 3433.2381s
	iters: 300, epoch: 7 | loss: 0.9043376
	speed: 0.0996s/iter; left time: 3426.4654s
Epoch: 7 cost time: 37.17127203941345
Epoch: 7, Steps: 369 | Train Loss: 0.728 Vali Loss: 0.780 Vali Acc: 0.532 Test Loss: 0.780 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.0684443
	speed: 0.3897s/iter; left time: 13335.8660s
	iters: 200, epoch: 8 | loss: 0.6472861
	speed: 0.1045s/iter; left time: 3566.5021s
	iters: 300, epoch: 8 | loss: 0.5261220
	speed: 0.1006s/iter; left time: 3422.2142s
Epoch: 8 cost time: 37.43390250205994
Epoch: 8, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.695 Vali Acc: 0.564 Test Loss: 0.695 Test Acc: 0.564
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.7330689
	speed: 0.4058s/iter; left time: 13737.2693s
	iters: 200, epoch: 9 | loss: 0.6443440
	speed: 0.1016s/iter; left time: 3429.4423s
	iters: 300, epoch: 9 | loss: 0.7615052
	speed: 0.0983s/iter; left time: 3307.8664s
Epoch: 9 cost time: 37.04760479927063
Epoch: 9, Steps: 369 | Train Loss: 0.825 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.6205542
	speed: 0.3986s/iter; left time: 13345.5807s
	iters: 200, epoch: 10 | loss: 0.8027958
	speed: 0.1113s/iter; left time: 3715.3148s
	iters: 300, epoch: 10 | loss: 0.7921042
	speed: 0.0936s/iter; left time: 3116.5904s
Epoch: 10 cost time: 37.75802254676819
Epoch: 10, Steps: 369 | Train Loss: 0.792 Vali Loss: 0.698 Vali Acc: 0.500 Test Loss: 0.698 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.7544886
	speed: 0.4414s/iter; left time: 14615.4117s
	iters: 200, epoch: 11 | loss: 0.8030852
	speed: 0.1077s/iter; left time: 3555.5511s
	iters: 300, epoch: 11 | loss: 0.6464236
	speed: 0.1097s/iter; left time: 3610.2354s
Epoch: 11 cost time: 41.88870716094971
Epoch: 11, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.697 Vali Acc: 0.582 Test Loss: 0.697 Test Acc: 0.582
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.7905380
	speed: 0.4423s/iter; left time: 14482.3526s
	iters: 200, epoch: 12 | loss: 0.6619795
	speed: 0.1138s/iter; left time: 3715.8863s
	iters: 300, epoch: 12 | loss: 0.6535535
	speed: 0.1064s/iter; left time: 3461.4589s
Epoch: 12 cost time: 42.41067814826965
Epoch: 12, Steps: 369 | Train Loss: 0.678 Vali Loss: 0.840 Vali Acc: 0.502 Test Loss: 0.840 Test Acc: 0.502
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.8916794
	speed: 0.3960s/iter; left time: 12821.1722s
	iters: 200, epoch: 13 | loss: 0.5781758
	speed: 0.0916s/iter; left time: 2955.6351s
	iters: 300, epoch: 13 | loss: 0.5833096
	speed: 0.1018s/iter; left time: 3274.8399s
Epoch: 13 cost time: 36.48254871368408
Epoch: 13, Steps: 369 | Train Loss: 0.676 Vali Loss: 0.710 Vali Acc: 0.621 Test Loss: 0.710 Test Acc: 0.621
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6597616345062429
model parameter : 4238106
model size : 21.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1472332
	speed: 0.1089s/iter; left time: 4008.8444s
	iters: 200, epoch: 1 | loss: 13.4234829
	speed: 0.1027s/iter; left time: 3769.1293s
	iters: 300, epoch: 1 | loss: 1.8872147
	speed: 0.0920s/iter; left time: 3366.5066s
Epoch: 1 cost time: 36.18616557121277
Epoch: 1, Steps: 369 | Train Loss: 4.775 Vali Loss: 21.963 Vali Acc: 0.503 Test Loss: 21.963 Test Acc: 0.503
Validation loss decreased (inf --> -0.502334).  Saving model ...
	iters: 100, epoch: 2 | loss: 8.6637592
	speed: 0.3706s/iter; left time: 13501.9922s
	iters: 200, epoch: 2 | loss: 0.5888613
	speed: 0.1044s/iter; left time: 3794.1411s
	iters: 300, epoch: 2 | loss: 1.1767745
	speed: 0.0970s/iter; left time: 3515.7415s
Epoch: 2 cost time: 37.51535248756409
Epoch: 2, Steps: 369 | Train Loss: 3.494 Vali Loss: 2.125 Vali Acc: 0.559 Test Loss: 2.125 Test Acc: 0.559
Validation loss decreased (-0.502334 --> -0.559003).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0355897
	speed: 0.3890s/iter; left time: 14029.4835s
	iters: 200, epoch: 3 | loss: 2.1024079
	speed: 0.0995s/iter; left time: 3579.9511s
	iters: 300, epoch: 3 | loss: 0.8499752
	speed: 0.0945s/iter; left time: 3388.8822s
Epoch: 3 cost time: 36.400818824768066
Epoch: 3, Steps: 369 | Train Loss: 1.315 Vali Loss: 2.845 Vali Acc: 0.500 Test Loss: 2.845 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6974582
	speed: 0.3995s/iter; left time: 14259.2016s
	iters: 200, epoch: 4 | loss: 1.1429070
	speed: 0.0980s/iter; left time: 3487.1341s
	iters: 300, epoch: 4 | loss: 0.8055645
	speed: 0.0919s/iter; left time: 3261.4190s
Epoch: 4 cost time: 37.785319805145264
Epoch: 4, Steps: 369 | Train Loss: 1.004 Vali Loss: 2.477 Vali Acc: 0.500 Test Loss: 2.477 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6472006
	speed: 0.3887s/iter; left time: 13729.3638s
	iters: 200, epoch: 5 | loss: 0.7309480
	speed: 0.1001s/iter; left time: 3525.5055s
	iters: 300, epoch: 5 | loss: 0.6833330
	speed: 0.0775s/iter; left time: 2723.4906s
Epoch: 5 cost time: 33.82480716705322
Epoch: 5, Steps: 369 | Train Loss: 0.737 Vali Loss: 0.935 Vali Acc: 0.606 Test Loss: 0.935 Test Acc: 0.606
Validation loss decreased (-0.559003 --> -0.606120).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4859109
	speed: 0.3185s/iter; left time: 11133.1036s
	iters: 200, epoch: 6 | loss: 0.2072025
	speed: 0.1154s/iter; left time: 4023.9762s
	iters: 300, epoch: 6 | loss: 0.7867895
	speed: 0.0939s/iter; left time: 3263.8291s
Epoch: 6 cost time: 39.121612548828125
Epoch: 6, Steps: 369 | Train Loss: 0.609 Vali Loss: 0.658 Vali Acc: 0.662 Test Loss: 0.658 Test Acc: 0.662
Validation loss decreased (-0.606120 --> -0.662309).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7102485
	speed: 0.4322s/iter; left time: 14948.0745s
	iters: 200, epoch: 7 | loss: 0.6750300
	speed: 0.1081s/iter; left time: 3728.2972s
	iters: 300, epoch: 7 | loss: 0.3594938
	speed: 0.1036s/iter; left time: 3564.0184s
Epoch: 7 cost time: 41.955002784729004
Epoch: 7, Steps: 369 | Train Loss: 0.556 Vali Loss: 0.674 Vali Acc: 0.670 Test Loss: 0.674 Test Acc: 0.670
Validation loss decreased (-0.662309 --> -0.670254).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5590826
	speed: 0.4626s/iter; left time: 15828.8695s
	iters: 200, epoch: 8 | loss: 0.3886383
	speed: 0.0801s/iter; left time: 2733.1206s
	iters: 300, epoch: 8 | loss: 0.5354313
	speed: 0.0718s/iter; left time: 2444.0324s
Epoch: 8 cost time: 34.877480268478394
Epoch: 8, Steps: 369 | Train Loss: 0.497 Vali Loss: 0.732 Vali Acc: 0.654 Test Loss: 0.732 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6133513
	speed: 0.3728s/iter; left time: 12618.1336s
	iters: 200, epoch: 9 | loss: 0.2675052
	speed: 0.0908s/iter; left time: 3065.3526s
	iters: 300, epoch: 9 | loss: 0.3739889
	speed: 0.0995s/iter; left time: 3348.4593s
Epoch: 9 cost time: 36.78996014595032
Epoch: 9, Steps: 369 | Train Loss: 0.483 Vali Loss: 0.961 Vali Acc: 0.633 Test Loss: 0.961 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2192340
	speed: 0.3782s/iter; left time: 12661.6354s
	iters: 200, epoch: 10 | loss: 0.4864403
	speed: 0.0936s/iter; left time: 3126.0271s
	iters: 300, epoch: 10 | loss: 0.5768594
	speed: 0.0937s/iter; left time: 3117.3633s
Epoch: 10 cost time: 37.420897483825684
Epoch: 10, Steps: 369 | Train Loss: 0.453 Vali Loss: 0.900 Vali Acc: 0.644 Test Loss: 0.900 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1042054
	speed: 0.3815s/iter; left time: 12631.1592s
	iters: 200, epoch: 11 | loss: 0.4354208
	speed: 0.0908s/iter; left time: 2995.8331s
	iters: 300, epoch: 11 | loss: 1.0895088
	speed: 0.1008s/iter; left time: 3318.8308s
Epoch: 11 cost time: 36.0936176776886
Epoch: 11, Steps: 369 | Train Loss: 0.409 Vali Loss: 0.921 Vali Acc: 0.656 Test Loss: 0.921 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.5450166
	speed: 0.3895s/iter; left time: 12752.3986s
	iters: 200, epoch: 12 | loss: 0.3018966
	speed: 0.0995s/iter; left time: 3247.1616s
	iters: 300, epoch: 12 | loss: 0.3530285
	speed: 0.1034s/iter; left time: 3364.9356s
Epoch: 12 cost time: 38.03499889373779
Epoch: 12, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.810 Vali Acc: 0.654 Test Loss: 0.810 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1111759
	speed: 0.3832s/iter; left time: 12406.1744s
	iters: 200, epoch: 13 | loss: 0.2185822
	speed: 0.0961s/iter; left time: 3100.0442s
	iters: 300, epoch: 13 | loss: 0.3693120
	speed: 0.0996s/iter; left time: 3203.0202s
Epoch: 13 cost time: 34.52226138114929
Epoch: 13, Steps: 369 | Train Loss: 0.338 Vali Loss: 1.009 Vali Acc: 0.650 Test Loss: 1.009 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.3635385
	speed: 0.3822s/iter; left time: 12231.9206s
	iters: 200, epoch: 14 | loss: 0.2700044
	speed: 0.1036s/iter; left time: 3306.5463s
	iters: 300, epoch: 14 | loss: 0.5092223
	speed: 0.1016s/iter; left time: 3231.8004s
Epoch: 14 cost time: 37.51587128639221
Epoch: 14, Steps: 369 | Train Loss: 0.305 Vali Loss: 1.125 Vali Acc: 0.657 Test Loss: 1.125 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.5015593
	speed: 0.3885s/iter; left time: 12289.4271s
	iters: 200, epoch: 15 | loss: 0.3249051
	speed: 0.1167s/iter; left time: 3680.2787s
	iters: 300, epoch: 15 | loss: 0.2714109
	speed: 0.0988s/iter; left time: 3104.5636s
Epoch: 15 cost time: 39.402252197265625
Epoch: 15, Steps: 369 | Train Loss: 0.292 Vali Loss: 1.111 Vali Acc: 0.638 Test Loss: 1.111 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.4350390
	speed: 0.4400s/iter; left time: 13756.9338s
	iters: 200, epoch: 16 | loss: 0.0823072
	speed: 0.1113s/iter; left time: 3469.3782s
	iters: 300, epoch: 16 | loss: 0.3556235
	speed: 0.1083s/iter; left time: 3365.6460s
Epoch: 16 cost time: 42.37807297706604
Epoch: 16, Steps: 369 | Train Loss: 0.282 Vali Loss: 1.299 Vali Acc: 0.630 Test Loss: 1.299 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.2723269
	speed: 0.4118s/iter; left time: 12724.9011s
	iters: 200, epoch: 17 | loss: 0.1353023
	speed: 0.0913s/iter; left time: 2810.5911s
	iters: 300, epoch: 17 | loss: 0.2877803
	speed: 0.0908s/iter; left time: 2787.7113s
Epoch: 17 cost time: 36.09824347496033
Epoch: 17, Steps: 369 | Train Loss: 0.253 Vali Loss: 1.200 Vali Acc: 0.659 Test Loss: 1.200 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6702610669693531
model parameter : 4236570
model size : 21.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.8476655
	speed: 0.0997s/iter; left time: 3670.8891s
	iters: 200, epoch: 1 | loss: 1.9831007
	speed: 0.0905s/iter; left time: 3322.6957s
	iters: 300, epoch: 1 | loss: 0.7115214
	speed: 0.0984s/iter; left time: 3601.5899s
Epoch: 1 cost time: 34.621042251586914
Epoch: 1, Steps: 369 | Train Loss: 3.556 Vali Loss: 4.242 Vali Acc: 0.593 Test Loss: 4.242 Test Acc: 0.593
Validation loss decreased (inf --> -0.593317).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6420016
	speed: 0.3818s/iter; left time: 13909.7592s
	iters: 200, epoch: 2 | loss: 2.2728076
	speed: 0.1006s/iter; left time: 3653.7341s
	iters: 300, epoch: 2 | loss: 0.5000643
	speed: 0.1031s/iter; left time: 3736.1556s
Epoch: 2 cost time: 37.481507301330566
Epoch: 2, Steps: 369 | Train Loss: 2.913 Vali Loss: 0.771 Vali Acc: 0.659 Test Loss: 0.771 Test Acc: 0.659
Validation loss decreased (-0.593317 --> -0.659470).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6795996
	speed: 0.3806s/iter; left time: 13727.3147s
	iters: 200, epoch: 3 | loss: 0.4250893
	speed: 0.1076s/iter; left time: 3870.8290s
	iters: 300, epoch: 3 | loss: 1.1146919
	speed: 0.0890s/iter; left time: 3192.1501s
Epoch: 3 cost time: 35.78879976272583
Epoch: 3, Steps: 369 | Train Loss: 1.325 Vali Loss: 1.317 Vali Acc: 0.552 Test Loss: 1.317 Test Acc: 0.552
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9345924
	speed: 0.3704s/iter; left time: 13220.3709s
	iters: 200, epoch: 4 | loss: 0.8578676
	speed: 0.0549s/iter; left time: 1954.7935s
	iters: 300, epoch: 4 | loss: 1.3026745
	speed: 0.0566s/iter; left time: 2009.3966s
Epoch: 4 cost time: 24.351495265960693
Epoch: 4, Steps: 369 | Train Loss: 1.061 Vali Loss: 0.693 Vali Acc: 0.511 Test Loss: 0.693 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.9906921
	speed: 0.3486s/iter; left time: 12315.7235s
	iters: 200, epoch: 5 | loss: 0.9010764
	speed: 0.0963s/iter; left time: 3393.6484s
	iters: 300, epoch: 5 | loss: 0.8023535
	speed: 0.0967s/iter; left time: 3396.7512s
Epoch: 5 cost time: 34.34653115272522
Epoch: 5, Steps: 369 | Train Loss: 0.905 Vali Loss: 1.287 Vali Acc: 0.500 Test Loss: 1.287 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.9837598
	speed: 0.4099s/iter; left time: 14328.7466s
	iters: 200, epoch: 6 | loss: 1.1011833
	speed: 0.1081s/iter; left time: 3767.0711s
	iters: 300, epoch: 6 | loss: 0.7850966
	speed: 0.0987s/iter; left time: 3430.3688s
Epoch: 6 cost time: 41.15559196472168
Epoch: 6, Steps: 369 | Train Loss: 0.817 Vali Loss: 0.723 Vali Acc: 0.504 Test Loss: 0.723 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7887230
	speed: 0.4277s/iter; left time: 14792.9918s
	iters: 200, epoch: 7 | loss: 0.6787146
	speed: 0.1091s/iter; left time: 3763.2864s
	iters: 300, epoch: 7 | loss: 0.7422427
	speed: 0.1036s/iter; left time: 3561.1702s
Epoch: 7 cost time: 39.99402618408203
Epoch: 7, Steps: 369 | Train Loss: 0.786 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.7651072
	speed: 0.4182s/iter; left time: 14309.8906s
	iters: 200, epoch: 8 | loss: 0.9489399
	speed: 0.0935s/iter; left time: 3191.5986s
	iters: 300, epoch: 8 | loss: 1.1966281
	speed: 0.0983s/iter; left time: 3342.7324s
Epoch: 8 cost time: 37.68322682380676
Epoch: 8, Steps: 369 | Train Loss: 0.770 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.8067402
	speed: 0.3831s/iter; left time: 12968.2535s
	iters: 200, epoch: 9 | loss: 0.6089683
	speed: 0.0968s/iter; left time: 3268.0356s
	iters: 300, epoch: 9 | loss: 0.7658942
	speed: 0.0960s/iter; left time: 3230.4615s
Epoch: 9 cost time: 36.112805128097534
Epoch: 9, Steps: 369 | Train Loss: 0.765 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6892905
	speed: 0.3842s/iter; left time: 12861.7844s
	iters: 200, epoch: 10 | loss: 0.6511919
	speed: 0.0949s/iter; left time: 3168.3682s
	iters: 300, epoch: 10 | loss: 0.8588476
	speed: 0.1086s/iter; left time: 3615.3373s
Epoch: 10 cost time: 37.47209692001343
Epoch: 10, Steps: 369 | Train Loss: 0.766 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7119915
	speed: 0.3854s/iter; left time: 12759.4160s
	iters: 200, epoch: 11 | loss: 0.7561268
	speed: 0.1051s/iter; left time: 3468.6966s
	iters: 300, epoch: 11 | loss: 0.7710060
	speed: 0.0964s/iter; left time: 3174.1379s
Epoch: 11 cost time: 37.38974714279175
Epoch: 11, Steps: 369 | Train Loss: 0.723 Vali Loss: 0.699 Vali Acc: 0.522 Test Loss: 0.699 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.6967884
	speed: 0.3932s/iter; left time: 12874.0780s
	iters: 200, epoch: 12 | loss: 0.7566260
	speed: 0.1054s/iter; left time: 3442.0552s
	iters: 300, epoch: 12 | loss: 0.6703258
	speed: 0.0918s/iter; left time: 2986.5812s
Epoch: 12 cost time: 35.49428677558899
Epoch: 12, Steps: 369 | Train Loss: 0.728 Vali Loss: 0.703 Vali Acc: 0.515 Test Loss: 0.703 Test Acc: 0.515
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.659477866061294
model parameter : 4044186
model size : 20.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.0635507
	speed: 0.1244s/iter; left time: 4579.1886s
	iters: 200, epoch: 1 | loss: 1.3418806
	speed: 0.1080s/iter; left time: 3961.9119s
	iters: 300, epoch: 1 | loss: 2.5650790
	speed: 0.0972s/iter; left time: 3558.9583s
Epoch: 1 cost time: 40.49321722984314
Epoch: 1, Steps: 369 | Train Loss: 2.830 Vali Loss: 4.753 Vali Acc: 0.500 Test Loss: 4.753 Test Acc: 0.500
Validation loss decreased (inf --> -0.499952).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7149981
	speed: 0.4342s/iter; left time: 15817.4856s
	iters: 200, epoch: 2 | loss: 1.4578425
	speed: 0.0979s/iter; left time: 3557.8728s
	iters: 300, epoch: 2 | loss: 0.6426479
	speed: 0.1156s/iter; left time: 4188.2344s
Epoch: 2 cost time: 41.4328989982605
Epoch: 2, Steps: 369 | Train Loss: 1.453 Vali Loss: 3.041 Vali Acc: 0.500 Test Loss: 3.041 Test Acc: 0.500
Validation loss decreased (-0.499952 --> -0.500253).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6597397
	speed: 0.4356s/iter; left time: 15709.8151s
	iters: 200, epoch: 3 | loss: 0.5389276
	speed: 0.0917s/iter; left time: 3297.0607s
	iters: 300, epoch: 3 | loss: 0.9900947
	speed: 0.1012s/iter; left time: 3630.3636s
Epoch: 3 cost time: 37.85188102722168
Epoch: 3, Steps: 369 | Train Loss: 1.185 Vali Loss: 1.987 Vali Acc: 0.501 Test Loss: 1.987 Test Acc: 0.501
Validation loss decreased (-0.500253 --> -0.501399).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8434471
	speed: 0.3924s/iter; left time: 14006.2752s
	iters: 200, epoch: 4 | loss: 0.5432659
	speed: 0.0987s/iter; left time: 3513.7281s
	iters: 300, epoch: 4 | loss: 1.3453269
	speed: 0.1025s/iter; left time: 3636.5144s
Epoch: 4 cost time: 35.714826345443726
Epoch: 4, Steps: 369 | Train Loss: 1.039 Vali Loss: 1.243 Vali Acc: 0.501 Test Loss: 1.243 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0384151
	speed: 0.3773s/iter; left time: 13327.0438s
	iters: 200, epoch: 5 | loss: 0.7569224
	speed: 0.0930s/iter; left time: 3277.3801s
	iters: 300, epoch: 5 | loss: 1.5063188
	speed: 0.0989s/iter; left time: 3475.3075s
Epoch: 5 cost time: 36.564785957336426
Epoch: 5, Steps: 369 | Train Loss: 0.948 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.9299968
	speed: 0.3852s/iter; left time: 13465.4879s
	iters: 200, epoch: 6 | loss: 0.8716760
	speed: 0.1071s/iter; left time: 3731.9921s
	iters: 300, epoch: 6 | loss: 0.7599389
	speed: 0.1004s/iter; left time: 3488.6415s
Epoch: 6 cost time: 36.67587685585022
Epoch: 6, Steps: 369 | Train Loss: 0.854 Vali Loss: 0.809 Vali Acc: 0.500 Test Loss: 0.809 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7649525
	speed: 0.3843s/iter; left time: 13292.4361s
	iters: 200, epoch: 7 | loss: 0.9701447
	speed: 0.0941s/iter; left time: 3244.9781s
	iters: 300, epoch: 7 | loss: 0.7760749
	speed: 0.0938s/iter; left time: 3225.2653s
Epoch: 7 cost time: 34.70888423919678
Epoch: 7, Steps: 369 | Train Loss: 0.830 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7797709
	speed: 0.3923s/iter; left time: 13425.3765s
	iters: 200, epoch: 8 | loss: 0.8679506
	speed: 0.1053s/iter; left time: 3591.8688s
	iters: 300, epoch: 8 | loss: 0.7604153
	speed: 0.0914s/iter; left time: 3108.3292s
Epoch: 8 cost time: 38.107292890548706
Epoch: 8, Steps: 369 | Train Loss: 0.798 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.5092003
	speed: 0.3930s/iter; left time: 13301.9023s
	iters: 200, epoch: 9 | loss: 0.8013000
	speed: 0.0914s/iter; left time: 3083.4993s
	iters: 300, epoch: 9 | loss: 0.7863015
	speed: 0.0986s/iter; left time: 3316.3238s
Epoch: 9 cost time: 37.08808493614197
Epoch: 9, Steps: 369 | Train Loss: 0.767 Vali Loss: 0.831 Vali Acc: 0.500 Test Loss: 0.831 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.5038622
	speed: 0.4311s/iter; left time: 14431.9926s
	iters: 200, epoch: 10 | loss: 0.6763629
	speed: 0.0984s/iter; left time: 3286.1723s
	iters: 300, epoch: 10 | loss: 0.6663628
	speed: 0.1151s/iter; left time: 3830.2588s
Epoch: 10 cost time: 41.14358878135681
Epoch: 10, Steps: 369 | Train Loss: 0.760 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6790291
	speed: 0.4069s/iter; left time: 13474.4074s
	iters: 200, epoch: 11 | loss: 0.6693638
	speed: 0.1107s/iter; left time: 3655.2063s
	iters: 300, epoch: 11 | loss: 0.6345041
	speed: 0.1074s/iter; left time: 3534.3809s
Epoch: 11 cost time: 38.423473834991455
Epoch: 11, Steps: 369 | Train Loss: 0.739 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.8165665
	speed: 0.3751s/iter; left time: 12279.9591s
	iters: 200, epoch: 12 | loss: 0.7189686
	speed: 0.1027s/iter; left time: 3353.4597s
	iters: 300, epoch: 12 | loss: 0.6706324
	speed: 0.1009s/iter; left time: 3284.6066s
Epoch: 12 cost time: 37.00032567977905
Epoch: 12, Steps: 369 | Train Loss: 0.714 Vali Loss: 0.651 Vali Acc: 0.621 Test Loss: 0.651 Test Acc: 0.621
Validation loss decreased (-0.501399 --> -0.620595).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5424206
	speed: 0.3861s/iter; left time: 12498.4224s
	iters: 200, epoch: 13 | loss: 0.6909770
	speed: 0.1023s/iter; left time: 3302.0787s
	iters: 300, epoch: 13 | loss: 0.7823220
	speed: 0.0887s/iter; left time: 2853.5542s
Epoch: 13 cost time: 35.831501722335815
Epoch: 13, Steps: 369 | Train Loss: 0.696 Vali Loss: 0.670 Vali Acc: 0.590 Test Loss: 0.670 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7065904
	speed: 0.3860s/iter; left time: 12354.9083s
	iters: 200, epoch: 14 | loss: 0.7467602
	speed: 0.1038s/iter; left time: 3311.3120s
	iters: 300, epoch: 14 | loss: 0.6180341
	speed: 0.0895s/iter; left time: 2845.6441s
Epoch: 14 cost time: 36.15737199783325
Epoch: 14, Steps: 369 | Train Loss: 0.673 Vali Loss: 0.642 Vali Acc: 0.637 Test Loss: 0.642 Test Acc: 0.637
Validation loss decreased (-0.620595 --> -0.637054).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6660554
	speed: 0.3934s/iter; left time: 12444.6582s
	iters: 200, epoch: 15 | loss: 0.4630024
	speed: 0.0889s/iter; left time: 2803.1817s
	iters: 300, epoch: 15 | loss: 0.7792843
	speed: 0.0826s/iter; left time: 2595.8955s
Epoch: 15 cost time: 34.077337980270386
Epoch: 15, Steps: 369 | Train Loss: 0.643 Vali Loss: 0.650 Vali Acc: 0.632 Test Loss: 0.650 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4829699
	speed: 0.3019s/iter; left time: 9437.9068s
	iters: 200, epoch: 16 | loss: 0.6279042
	speed: 0.1009s/iter; left time: 3144.8632s
	iters: 300, epoch: 16 | loss: 0.7521028
	speed: 0.0898s/iter; left time: 2788.2065s
Epoch: 16 cost time: 35.37747383117676
Epoch: 16, Steps: 369 | Train Loss: 0.639 Vali Loss: 0.650 Vali Acc: 0.629 Test Loss: 0.650 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6305391
	speed: 0.3906s/iter; left time: 12067.4885s
	iters: 200, epoch: 17 | loss: 0.5753245
	speed: 0.0960s/iter; left time: 2956.3396s
	iters: 300, epoch: 17 | loss: 0.6427844
	speed: 0.0935s/iter; left time: 2871.6154s
Epoch: 17 cost time: 37.3292510509491
Epoch: 17, Steps: 369 | Train Loss: 0.646 Vali Loss: 0.689 Vali Acc: 0.579 Test Loss: 0.689 Test Acc: 0.579
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.5513492
	speed: 0.4192s/iter; left time: 12796.4275s
	iters: 200, epoch: 18 | loss: 0.5803092
	speed: 0.1130s/iter; left time: 3438.5254s
	iters: 300, epoch: 18 | loss: 0.7751549
	speed: 0.1021s/iter; left time: 3095.7716s
Epoch: 18 cost time: 40.85094141960144
Epoch: 18, Steps: 369 | Train Loss: 0.674 Vali Loss: 0.669 Vali Acc: 0.597 Test Loss: 0.669 Test Acc: 0.597
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.6270918
	speed: 0.4318s/iter; left time: 13023.1357s
	iters: 200, epoch: 19 | loss: 0.6172873
	speed: 0.0926s/iter; left time: 2783.1557s
	iters: 300, epoch: 19 | loss: 0.7415972
	speed: 0.1137s/iter; left time: 3404.9603s
Epoch: 19 cost time: 38.50900101661682
Epoch: 19, Steps: 369 | Train Loss: 0.679 Vali Loss: 0.814 Vali Acc: 0.516 Test Loss: 0.814 Test Acc: 0.516
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.6864505
	speed: 0.3896s/iter; left time: 11606.5851s
	iters: 200, epoch: 20 | loss: 0.5072415
	speed: 0.0828s/iter; left time: 2458.4227s
	iters: 300, epoch: 20 | loss: 0.5639649
	speed: 0.0989s/iter; left time: 2925.8917s
Epoch: 20 cost time: 34.26424813270569
Epoch: 20, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.676 Vali Acc: 0.573 Test Loss: 0.676 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.6963595
	speed: 0.3992s/iter; left time: 11744.7111s
	iters: 200, epoch: 21 | loss: 0.5148572
	speed: 0.1076s/iter; left time: 3155.0044s
	iters: 300, epoch: 21 | loss: 0.7501996
	speed: 0.1060s/iter; left time: 3097.5605s
Epoch: 21 cost time: 38.393293142318726
Epoch: 21, Steps: 369 | Train Loss: 0.689 Vali Loss: 0.732 Vali Acc: 0.545 Test Loss: 0.732 Test Acc: 0.545
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.6589451
	speed: 0.4001s/iter; left time: 11624.2466s
	iters: 200, epoch: 22 | loss: 0.7893663
	speed: 0.1064s/iter; left time: 3080.6056s
	iters: 300, epoch: 22 | loss: 0.7526602
	speed: 0.0954s/iter; left time: 2751.9255s
Epoch: 22 cost time: 37.34931993484497
Epoch: 22, Steps: 369 | Train Loss: 0.673 Vali Loss: 0.674 Vali Acc: 0.594 Test Loss: 0.674 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.8560343
	speed: 0.3946s/iter; left time: 11316.9792s
	iters: 200, epoch: 23 | loss: 0.6079960
	speed: 0.1046s/iter; left time: 2989.4223s
	iters: 300, epoch: 23 | loss: 0.7403933
	speed: 0.1048s/iter; left time: 2985.6139s
Epoch: 23 cost time: 39.59898853302002
Epoch: 23, Steps: 369 | Train Loss: 0.672 Vali Loss: 0.660 Vali Acc: 0.615 Test Loss: 0.660 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.7934033
	speed: 0.4185s/iter; left time: 11850.2410s
	iters: 200, epoch: 24 | loss: 0.8040671
	speed: 0.0975s/iter; left time: 2749.8604s
	iters: 300, epoch: 24 | loss: 0.6669580
	speed: 0.1039s/iter; left time: 2921.3913s
Epoch: 24 cost time: 38.62683081626892
Epoch: 24, Steps: 369 | Train Loss: 0.667 Vali Loss: 0.686 Vali Acc: 0.581 Test Loss: 0.686 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6370601589103292
model parameter : 4042650
model size : 20.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 6.4000273
	speed: 0.1140s/iter; left time: 4195.6082s
	iters: 200, epoch: 1 | loss: 0.8982251
	speed: 0.1061s/iter; left time: 3895.3128s
	iters: 300, epoch: 1 | loss: 4.2495270
	speed: 0.1039s/iter; left time: 3802.9818s
Epoch: 1 cost time: 39.403852701187134
Epoch: 1, Steps: 369 | Train Loss: 3.769 Vali Loss: 1.932 Vali Acc: 0.640 Test Loss: 1.932 Test Acc: 0.640
Validation loss decreased (inf --> -0.639595).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4243919
	speed: 0.4357s/iter; left time: 15873.0441s
	iters: 200, epoch: 2 | loss: 0.9693318
	speed: 0.1236s/iter; left time: 4490.6812s
	iters: 300, epoch: 2 | loss: 1.4518518
	speed: 0.1129s/iter; left time: 4091.6642s
Epoch: 2 cost time: 43.75917601585388
Epoch: 2, Steps: 369 | Train Loss: 3.309 Vali Loss: 2.202 Vali Acc: 0.504 Test Loss: 2.202 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4825246
	speed: 0.4153s/iter; left time: 14978.6681s
	iters: 200, epoch: 3 | loss: 0.4776179
	speed: 0.0660s/iter; left time: 2375.3508s
	iters: 300, epoch: 3 | loss: 3.0530059
	speed: 0.0671s/iter; left time: 2407.8634s
Epoch: 3 cost time: 29.583611965179443
Epoch: 3, Steps: 369 | Train Loss: 1.315 Vali Loss: 2.568 Vali Acc: 0.515 Test Loss: 2.568 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6240051
	speed: 0.4161s/iter; left time: 14853.7522s
	iters: 200, epoch: 4 | loss: 0.4568695
	speed: 0.1069s/iter; left time: 3803.5199s
	iters: 300, epoch: 4 | loss: 1.0138485
	speed: 0.1038s/iter; left time: 3685.8564s
Epoch: 4 cost time: 39.81971883773804
Epoch: 4, Steps: 369 | Train Loss: 0.978 Vali Loss: 0.847 Vali Acc: 0.583 Test Loss: 0.847 Test Acc: 0.583
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6915511
	speed: 0.4128s/iter; left time: 14581.1096s
	iters: 200, epoch: 5 | loss: 0.3412948
	speed: 0.0974s/iter; left time: 3431.5631s
	iters: 300, epoch: 5 | loss: 1.1747564
	speed: 0.0987s/iter; left time: 3466.4260s
Epoch: 5 cost time: 38.094757080078125
Epoch: 5, Steps: 369 | Train Loss: 0.795 Vali Loss: 0.670 Vali Acc: 0.657 Test Loss: 0.670 Test Acc: 0.657
Validation loss decreased (-0.639595 --> -0.657201).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6548782
	speed: 0.4101s/iter; left time: 14336.4759s
	iters: 200, epoch: 6 | loss: 0.4769171
	speed: 0.0975s/iter; left time: 3397.9827s
	iters: 300, epoch: 6 | loss: 0.6599854
	speed: 0.1022s/iter; left time: 3552.1368s
Epoch: 6 cost time: 38.22666335105896
Epoch: 6, Steps: 369 | Train Loss: 0.685 Vali Loss: 0.654 Vali Acc: 0.648 Test Loss: 0.654 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7665396
	speed: 0.4027s/iter; left time: 13926.6899s
	iters: 200, epoch: 7 | loss: 0.8466152
	speed: 0.1040s/iter; left time: 3587.4976s
	iters: 300, epoch: 7 | loss: 0.7457024
	speed: 0.1075s/iter; left time: 3696.7858s
Epoch: 7 cost time: 38.50396776199341
Epoch: 7, Steps: 369 | Train Loss: 0.631 Vali Loss: 0.908 Vali Acc: 0.558 Test Loss: 0.908 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7200296
	speed: 0.3948s/iter; left time: 13510.0704s
	iters: 200, epoch: 8 | loss: 0.4220177
	speed: 0.1076s/iter; left time: 3671.5985s
	iters: 300, epoch: 8 | loss: 0.6027635
	speed: 0.1043s/iter; left time: 3547.0163s
Epoch: 8 cost time: 38.34580183029175
Epoch: 8, Steps: 369 | Train Loss: 0.644 Vali Loss: 0.668 Vali Acc: 0.598 Test Loss: 0.668 Test Acc: 0.598
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6257835
	speed: 0.4070s/iter; left time: 13775.9751s
	iters: 200, epoch: 9 | loss: 0.3279671
	speed: 0.1028s/iter; left time: 3470.7124s
	iters: 300, epoch: 9 | loss: 0.6167241
	speed: 0.0931s/iter; left time: 3132.4092s
Epoch: 9 cost time: 37.04720449447632
Epoch: 9, Steps: 369 | Train Loss: 0.617 Vali Loss: 0.681 Vali Acc: 0.649 Test Loss: 0.681 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.9162993
	speed: 0.4234s/iter; left time: 14175.6425s
	iters: 200, epoch: 10 | loss: 0.5557653
	speed: 0.1069s/iter; left time: 3569.9340s
	iters: 300, epoch: 10 | loss: 0.5319589
	speed: 0.1079s/iter; left time: 3590.5684s
Epoch: 10 cost time: 41.28328347206116
Epoch: 10, Steps: 369 | Train Loss: 0.640 Vali Loss: 0.817 Vali Acc: 0.588 Test Loss: 0.817 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4790953
	speed: 0.4576s/iter; left time: 15150.9963s
	iters: 200, epoch: 11 | loss: 0.5966119
	speed: 0.1057s/iter; left time: 3489.4853s
	iters: 300, epoch: 11 | loss: 0.6366698
	speed: 0.1149s/iter; left time: 3780.1103s
Epoch: 11 cost time: 42.720341205596924
Epoch: 11, Steps: 369 | Train Loss: 0.611 Vali Loss: 0.705 Vali Acc: 0.617 Test Loss: 0.705 Test Acc: 0.617
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.4680907
	speed: 0.4552s/iter; left time: 14903.2559s
	iters: 200, epoch: 12 | loss: 0.4565808
	speed: 0.1169s/iter; left time: 3816.7903s
	iters: 300, epoch: 12 | loss: 0.4857107
	speed: 0.1121s/iter; left time: 3648.6565s
Epoch: 12 cost time: 41.36905264854431
Epoch: 12, Steps: 369 | Train Loss: 0.612 Vali Loss: 0.737 Vali Acc: 0.618 Test Loss: 0.737 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.5588602
	speed: 0.4016s/iter; left time: 13000.3334s
	iters: 200, epoch: 13 | loss: 0.7240629
	speed: 0.1043s/iter; left time: 3367.0792s
	iters: 300, epoch: 13 | loss: 0.5834603
	speed: 0.0986s/iter; left time: 3171.4353s
Epoch: 13 cost time: 36.38112211227417
Epoch: 13, Steps: 369 | Train Loss: 0.623 Vali Loss: 0.641 Vali Acc: 0.638 Test Loss: 0.641 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.7622055
	speed: 0.4011s/iter; left time: 12837.5090s
	iters: 200, epoch: 14 | loss: 0.7289453
	speed: 0.1064s/iter; left time: 3394.3301s
	iters: 300, epoch: 14 | loss: 0.7667412
	speed: 0.1022s/iter; left time: 3250.4368s
Epoch: 14 cost time: 38.74719595909119
Epoch: 14, Steps: 369 | Train Loss: 0.629 Vali Loss: 0.649 Vali Acc: 0.621 Test Loss: 0.649 Test Acc: 0.621
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.4657962
	speed: 0.4062s/iter; left time: 12850.7028s
	iters: 200, epoch: 15 | loss: 0.4975972
	speed: 0.0986s/iter; left time: 3110.0012s
	iters: 300, epoch: 15 | loss: 0.6381600
	speed: 0.0906s/iter; left time: 2846.9070s
Epoch: 15 cost time: 34.60562086105347
Epoch: 15, Steps: 369 | Train Loss: 0.653 Vali Loss: 0.741 Vali Acc: 0.635 Test Loss: 0.741 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6572077185017026
model parameter : 4041114
model size : 20.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.0804148
	speed: 0.1212s/iter; left time: 4459.2822s
	iters: 200, epoch: 1 | loss: 12.1658192
	speed: 0.0967s/iter; left time: 3550.2972s
	iters: 300, epoch: 1 | loss: 4.1217885
	speed: 0.1033s/iter; left time: 3781.8744s
Epoch: 1 cost time: 39.5198757648468
Epoch: 1, Steps: 369 | Train Loss: 3.350 Vali Loss: 4.192 Vali Acc: 0.508 Test Loss: 4.192 Test Acc: 0.508
Validation loss decreased (inf --> -0.507620).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4167665
	speed: 0.4070s/iter; left time: 14828.3072s
	iters: 200, epoch: 2 | loss: 2.8495102
	speed: 0.0978s/iter; left time: 3554.4193s
	iters: 300, epoch: 2 | loss: 0.8167661
	speed: 0.1053s/iter; left time: 3815.0385s
Epoch: 2 cost time: 38.30020093917847
Epoch: 2, Steps: 369 | Train Loss: 1.582 Vali Loss: 0.857 Vali Acc: 0.655 Test Loss: 0.857 Test Acc: 0.655
Validation loss decreased (-0.507620 --> -0.654929).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4372247
	speed: 0.4202s/iter; left time: 15153.2212s
	iters: 200, epoch: 3 | loss: 0.5519460
	speed: 0.1087s/iter; left time: 3908.1794s
	iters: 300, epoch: 3 | loss: 0.4903343
	speed: 0.1149s/iter; left time: 4118.8819s
Epoch: 3 cost time: 41.5304217338562
Epoch: 3, Steps: 369 | Train Loss: 1.324 Vali Loss: 0.654 Vali Acc: 0.657 Test Loss: 0.654 Test Acc: 0.657
Validation loss decreased (-0.654929 --> -0.657201).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7101444
	speed: 0.4427s/iter; left time: 15800.4291s
	iters: 200, epoch: 4 | loss: 0.4053902
	speed: 0.1182s/iter; left time: 4208.9724s
	iters: 300, epoch: 4 | loss: 0.9524044
	speed: 0.1105s/iter; left time: 3921.6336s
Epoch: 4 cost time: 42.217536211013794
Epoch: 4, Steps: 369 | Train Loss: 1.094 Vali Loss: 0.967 Vali Acc: 0.606 Test Loss: 0.967 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6351381
	speed: 0.4074s/iter; left time: 14393.0157s
	iters: 200, epoch: 5 | loss: 0.5513378
	speed: 0.0894s/iter; left time: 3148.2976s
	iters: 300, epoch: 5 | loss: 1.0242870
	speed: 0.0915s/iter; left time: 3212.3072s
Epoch: 5 cost time: 35.06388545036316
Epoch: 5, Steps: 369 | Train Loss: 0.759 Vali Loss: 0.611 Vali Acc: 0.667 Test Loss: 0.611 Test Acc: 0.667
Validation loss decreased (-0.657201 --> -0.666850).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5682381
	speed: 0.4122s/iter; left time: 14410.3788s
	iters: 200, epoch: 6 | loss: 0.4968757
	speed: 0.0996s/iter; left time: 3472.9819s
	iters: 300, epoch: 6 | loss: 0.2596260
	speed: 0.0950s/iter; left time: 3301.1905s
Epoch: 6 cost time: 38.23428726196289
Epoch: 6, Steps: 369 | Train Loss: 0.679 Vali Loss: 1.055 Vali Acc: 0.567 Test Loss: 1.055 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7552221
	speed: 0.4129s/iter; left time: 14282.5920s
	iters: 200, epoch: 7 | loss: 0.8731943
	speed: 0.0984s/iter; left time: 3394.4957s
	iters: 300, epoch: 7 | loss: 0.6863542
	speed: 0.1089s/iter; left time: 3746.1560s
Epoch: 7 cost time: 39.56289839744568
Epoch: 7, Steps: 369 | Train Loss: 0.604 Vali Loss: 0.692 Vali Acc: 0.657 Test Loss: 0.692 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3553377
	speed: 0.4046s/iter; left time: 13844.3037s
	iters: 200, epoch: 8 | loss: 0.3198505
	speed: 0.0980s/iter; left time: 3342.9912s
	iters: 300, epoch: 8 | loss: 0.2246201
	speed: 0.1039s/iter; left time: 3533.3455s
Epoch: 8 cost time: 38.29237771034241
Epoch: 8, Steps: 369 | Train Loss: 0.544 Vali Loss: 0.701 Vali Acc: 0.666 Test Loss: 0.701 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2374613
	speed: 0.4086s/iter; left time: 13831.5572s
	iters: 200, epoch: 9 | loss: 0.5294940
	speed: 0.1021s/iter; left time: 3445.7465s
	iters: 300, epoch: 9 | loss: 0.7500579
	speed: 0.1115s/iter; left time: 3750.8672s
Epoch: 9 cost time: 39.089163303375244
Epoch: 9, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.778 Vali Acc: 0.657 Test Loss: 0.778 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6888303
	speed: 0.4057s/iter; left time: 13581.6813s
	iters: 200, epoch: 10 | loss: 0.5129730
	speed: 0.1051s/iter; left time: 3507.7765s
	iters: 300, epoch: 10 | loss: 0.8310379
	speed: 0.1064s/iter; left time: 3539.4254s
Epoch: 10 cost time: 38.109946727752686
Epoch: 10, Steps: 369 | Train Loss: 0.480 Vali Loss: 0.992 Vali Acc: 0.626 Test Loss: 0.992 Test Acc: 0.626
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2983144
	speed: 0.4077s/iter; left time: 13499.2788s
	iters: 200, epoch: 11 | loss: 0.4153561
	speed: 0.1085s/iter; left time: 3581.1020s
	iters: 300, epoch: 11 | loss: 0.4832466
	speed: 0.1100s/iter; left time: 3620.9352s
Epoch: 11 cost time: 40.7722601890564
Epoch: 11, Steps: 369 | Train Loss: 0.432 Vali Loss: 1.022 Vali Acc: 0.642 Test Loss: 1.022 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.4506484
	speed: 0.4427s/iter; left time: 14496.4387s
	iters: 200, epoch: 12 | loss: 0.2093668
	speed: 0.1114s/iter; left time: 3637.0568s
	iters: 300, epoch: 12 | loss: 0.5443571
	speed: 0.1124s/iter; left time: 3659.2904s
Epoch: 12 cost time: 42.3464469909668
Epoch: 12, Steps: 369 | Train Loss: 0.419 Vali Loss: 0.754 Vali Acc: 0.653 Test Loss: 0.754 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2162316
	speed: 0.4580s/iter; left time: 14826.9485s
	iters: 200, epoch: 13 | loss: 0.4266382
	speed: 0.1118s/iter; left time: 3609.7290s
	iters: 300, epoch: 13 | loss: 0.4343864
	speed: 0.1017s/iter; left time: 3271.9472s
Epoch: 13 cost time: 41.51088094711304
Epoch: 13, Steps: 369 | Train Loss: 0.393 Vali Loss: 0.886 Vali Acc: 0.653 Test Loss: 0.886 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.3929007
	speed: 0.4038s/iter; left time: 12923.2794s
	iters: 200, epoch: 14 | loss: 0.1602456
	speed: 0.0944s/iter; left time: 3012.1415s
	iters: 300, epoch: 14 | loss: 0.5378379
	speed: 0.1080s/iter; left time: 3434.4980s
Epoch: 14 cost time: 37.950074911117554
Epoch: 14, Steps: 369 | Train Loss: 0.346 Vali Loss: 0.976 Vali Acc: 0.638 Test Loss: 0.976 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.3247887
	speed: 0.4012s/iter; left time: 12693.5133s
	iters: 200, epoch: 15 | loss: 0.3541289
	speed: 0.1009s/iter; left time: 3183.0985s
	iters: 300, epoch: 15 | loss: 0.2604757
	speed: 0.1087s/iter; left time: 3417.5757s
Epoch: 15 cost time: 37.97679352760315
Epoch: 15, Steps: 369 | Train Loss: 0.365 Vali Loss: 0.964 Vali Acc: 0.628 Test Loss: 0.964 Test Acc: 0.628
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6668558456299659
model parameter : 4039578
model size : 20.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.5711865
	speed: 0.1105s/iter; left time: 4067.4504s
	iters: 200, epoch: 1 | loss: 5.1000180
	speed: 0.1023s/iter; left time: 3755.5678s
	iters: 300, epoch: 1 | loss: 0.8492560
	speed: 0.0879s/iter; left time: 3218.9014s
Epoch: 1 cost time: 36.08923530578613
Epoch: 1, Steps: 369 | Train Loss: 2.011 Vali Loss: 0.754 Vali Acc: 0.596 Test Loss: 0.754 Test Acc: 0.596
Validation loss decreased (inf --> -0.596190).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8399764
	speed: 0.3483s/iter; left time: 12690.4180s
	iters: 200, epoch: 2 | loss: 1.3293362
	speed: 0.0973s/iter; left time: 3534.5290s
	iters: 300, epoch: 2 | loss: 0.2936584
	speed: 0.0867s/iter; left time: 3142.8147s
Epoch: 2 cost time: 33.9080376625061
Epoch: 2, Steps: 369 | Train Loss: 1.136 Vali Loss: 1.164 Vali Acc: 0.572 Test Loss: 1.164 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6557526
	speed: 0.3289s/iter; left time: 11861.1248s
	iters: 200, epoch: 3 | loss: 1.0765001
	speed: 0.1007s/iter; left time: 3620.1432s
	iters: 300, epoch: 3 | loss: 0.9058328
	speed: 0.0894s/iter; left time: 3206.9706s
Epoch: 3 cost time: 33.60527324676514
Epoch: 3, Steps: 369 | Train Loss: 0.919 Vali Loss: 1.069 Vali Acc: 0.531 Test Loss: 1.069 Test Acc: 0.531
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.0412042
	speed: 0.3495s/iter; left time: 12473.6424s
	iters: 200, epoch: 4 | loss: 1.3303107
	speed: 0.0946s/iter; left time: 3366.9680s
	iters: 300, epoch: 4 | loss: 0.8191788
	speed: 0.0898s/iter; left time: 3187.1081s
Epoch: 4 cost time: 34.52234077453613
Epoch: 4, Steps: 369 | Train Loss: 0.762 Vali Loss: 0.653 Vali Acc: 0.669 Test Loss: 0.653 Test Acc: 0.669
Validation loss decreased (-0.596190 --> -0.669403).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6828835
	speed: 0.3915s/iter; left time: 13829.0650s
	iters: 200, epoch: 5 | loss: 0.5309218
	speed: 0.1116s/iter; left time: 3930.8661s
	iters: 300, epoch: 5 | loss: 0.8596038
	speed: 0.1047s/iter; left time: 3676.2205s
Epoch: 5 cost time: 39.82063937187195
Epoch: 5, Steps: 369 | Train Loss: 0.585 Vali Loss: 0.628 Vali Acc: 0.674 Test Loss: 0.628 Test Acc: 0.674
Validation loss decreased (-0.669403 --> -0.673944).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2305554
	speed: 0.3999s/iter; left time: 13977.7696s
	iters: 200, epoch: 6 | loss: 0.5021098
	speed: 0.1073s/iter; left time: 3741.3452s
	iters: 300, epoch: 6 | loss: 0.6730309
	speed: 0.0988s/iter; left time: 3434.2077s
Epoch: 6 cost time: 38.29267191886902
Epoch: 6, Steps: 369 | Train Loss: 0.474 Vali Loss: 0.665 Vali Acc: 0.653 Test Loss: 0.665 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4395278
	speed: 0.3525s/iter; left time: 12190.2635s
	iters: 200, epoch: 7 | loss: 0.1825020
	speed: 0.0572s/iter; left time: 1972.3425s
	iters: 300, epoch: 7 | loss: 0.4533975
	speed: 0.0550s/iter; left time: 1890.9680s
Epoch: 7 cost time: 23.377070665359497
Epoch: 7, Steps: 369 | Train Loss: 0.386 Vali Loss: 0.805 Vali Acc: 0.663 Test Loss: 0.805 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3343309
	speed: 0.3432s/iter; left time: 11743.8636s
	iters: 200, epoch: 8 | loss: 0.0842175
	speed: 0.0955s/iter; left time: 3257.0139s
	iters: 300, epoch: 8 | loss: 0.1869806
	speed: 0.0896s/iter; left time: 3049.2331s
Epoch: 8 cost time: 34.50744366645813
Epoch: 8, Steps: 369 | Train Loss: 0.321 Vali Loss: 1.027 Vali Acc: 0.652 Test Loss: 1.027 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0929588
	speed: 0.3629s/iter; left time: 12283.7829s
	iters: 200, epoch: 9 | loss: 0.1228220
	speed: 0.1014s/iter; left time: 3422.2705s
	iters: 300, epoch: 9 | loss: 0.1215798
	speed: 0.0991s/iter; left time: 3335.8144s
Epoch: 9 cost time: 36.07075047492981
Epoch: 9, Steps: 369 | Train Loss: 0.245 Vali Loss: 1.080 Vali Acc: 0.637 Test Loss: 1.080 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3573804
	speed: 0.3562s/iter; left time: 11925.6674s
	iters: 200, epoch: 10 | loss: 0.4822854
	speed: 0.0987s/iter; left time: 3293.5011s
	iters: 300, epoch: 10 | loss: 0.0223313
	speed: 0.0953s/iter; left time: 3172.2765s
Epoch: 10 cost time: 34.59079337120056
Epoch: 10, Steps: 369 | Train Loss: 0.217 Vali Loss: 1.239 Vali Acc: 0.648 Test Loss: 1.239 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0134673
	speed: 0.3620s/iter; left time: 11986.5833s
	iters: 200, epoch: 11 | loss: 0.2220120
	speed: 0.1044s/iter; left time: 3447.1492s
	iters: 300, epoch: 11 | loss: 0.2690720
	speed: 0.0931s/iter; left time: 3064.7876s
Epoch: 11 cost time: 35.77623105049133
Epoch: 11, Steps: 369 | Train Loss: 0.165 Vali Loss: 1.146 Vali Acc: 0.648 Test Loss: 1.146 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0646713
	speed: 0.3568s/iter; left time: 11682.4204s
	iters: 200, epoch: 12 | loss: 0.2976001
	speed: 0.0993s/iter; left time: 3242.6379s
	iters: 300, epoch: 12 | loss: 0.0695927
	speed: 0.0930s/iter; left time: 3027.9330s
Epoch: 12 cost time: 34.63265681266785
Epoch: 12, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.901 Vali Acc: 0.650 Test Loss: 1.901 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0068371
	speed: 0.3666s/iter; left time: 11867.7365s
	iters: 200, epoch: 13 | loss: 0.0159037
	speed: 0.0981s/iter; left time: 3164.9340s
	iters: 300, epoch: 13 | loss: 0.1778393
	speed: 0.0995s/iter; left time: 3200.8729s
Epoch: 13 cost time: 36.422372579574585
Epoch: 13, Steps: 369 | Train Loss: 0.125 Vali Loss: 1.689 Vali Acc: 0.645 Test Loss: 1.689 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0292036
	speed: 0.3887s/iter; left time: 12440.4474s
	iters: 200, epoch: 14 | loss: 0.4264168
	speed: 0.1046s/iter; left time: 3336.7268s
	iters: 300, epoch: 14 | loss: 0.1102134
	speed: 0.1091s/iter; left time: 3469.6437s
Epoch: 14 cost time: 38.681524991989136
Epoch: 14, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.728 Vali Acc: 0.650 Test Loss: 1.728 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1693289
	speed: 0.4002s/iter; left time: 12660.3821s
	iters: 200, epoch: 15 | loss: 0.0054815
	speed: 0.1049s/iter; left time: 3306.7809s
	iters: 300, epoch: 15 | loss: 0.1830436
	speed: 0.1129s/iter; left time: 3548.2593s
Epoch: 15 cost time: 39.830546379089355
Epoch: 15, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.771 Vali Acc: 0.652 Test Loss: 1.771 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.673950056753689
model parameter : 1926682
model size : 9.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.9537845
	speed: 0.1152s/iter; left time: 4240.5713s
	iters: 200, epoch: 1 | loss: 5.9312854
	speed: 0.0984s/iter; left time: 3611.8815s
	iters: 300, epoch: 1 | loss: 8.5195255
	speed: 0.0929s/iter; left time: 3400.8603s
Epoch: 1 cost time: 37.749220848083496
Epoch: 1, Steps: 369 | Train Loss: 1.979 Vali Loss: 2.121 Vali Acc: 0.633 Test Loss: 2.121 Test Acc: 0.633
Validation loss decreased (inf --> -0.633066).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0699743
	speed: 0.3678s/iter; left time: 13399.0643s
	iters: 200, epoch: 2 | loss: 0.8683205
	speed: 0.0975s/iter; left time: 3542.8548s
	iters: 300, epoch: 2 | loss: 0.6227580
	speed: 0.0887s/iter; left time: 3213.0935s
Epoch: 2 cost time: 35.79951810836792
Epoch: 2, Steps: 369 | Train Loss: 1.592 Vali Loss: 2.044 Vali Acc: 0.501 Test Loss: 2.044 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8952722
	speed: 0.3752s/iter; left time: 13530.0465s
	iters: 200, epoch: 3 | loss: 0.9697372
	speed: 0.1001s/iter; left time: 3598.2485s
	iters: 300, epoch: 3 | loss: 0.3156794
	speed: 0.0966s/iter; left time: 3464.2126s
Epoch: 3 cost time: 37.629353523254395
Epoch: 3, Steps: 369 | Train Loss: 0.867 Vali Loss: 1.124 Vali Acc: 0.593 Test Loss: 1.124 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5951428
	speed: 0.3768s/iter; left time: 13450.3960s
	iters: 200, epoch: 4 | loss: 0.6172906
	speed: 0.0972s/iter; left time: 3458.0887s
	iters: 300, epoch: 4 | loss: 0.5512480
	speed: 0.0881s/iter; left time: 3128.5662s
Epoch: 4 cost time: 35.817039489746094
Epoch: 4, Steps: 369 | Train Loss: 0.732 Vali Loss: 0.701 Vali Acc: 0.627 Test Loss: 0.701 Test Acc: 0.627
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6148108
	speed: 0.3701s/iter; left time: 13073.8826s
	iters: 200, epoch: 5 | loss: 0.5259365
	speed: 0.0943s/iter; left time: 3323.0512s
	iters: 300, epoch: 5 | loss: 0.7529165
	speed: 0.0890s/iter; left time: 3124.6696s
Epoch: 5 cost time: 35.76637625694275
Epoch: 5, Steps: 369 | Train Loss: 0.624 Vali Loss: 0.741 Vali Acc: 0.652 Test Loss: 0.741 Test Acc: 0.652
Validation loss decreased (-0.633066 --> -0.651809).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2601506
	speed: 0.3769s/iter; left time: 13174.6050s
	iters: 200, epoch: 6 | loss: 0.9904790
	speed: 0.1003s/iter; left time: 3495.8756s
	iters: 300, epoch: 6 | loss: 0.7308374
	speed: 0.0912s/iter; left time: 3168.2879s
Epoch: 6 cost time: 36.842740535736084
Epoch: 6, Steps: 369 | Train Loss: 0.500 Vali Loss: 0.668 Vali Acc: 0.677 Test Loss: 0.668 Test Acc: 0.677
Validation loss decreased (-0.651809 --> -0.676497).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2785009
	speed: 0.3762s/iter; left time: 13012.4978s
	iters: 200, epoch: 7 | loss: 0.5088137
	speed: 0.1056s/iter; left time: 3642.4112s
	iters: 300, epoch: 7 | loss: 0.4873229
	speed: 0.1037s/iter; left time: 3567.6276s
Epoch: 7 cost time: 38.82526445388794
Epoch: 7, Steps: 369 | Train Loss: 0.416 Vali Loss: 0.796 Vali Acc: 0.655 Test Loss: 0.796 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5900452
	speed: 0.4123s/iter; left time: 14106.6962s
	iters: 200, epoch: 8 | loss: 0.1617416
	speed: 0.0992s/iter; left time: 3384.4360s
	iters: 300, epoch: 8 | loss: 0.5032426
	speed: 0.0926s/iter; left time: 3149.8997s
Epoch: 8 cost time: 38.49823760986328
Epoch: 8, Steps: 369 | Train Loss: 0.307 Vali Loss: 0.835 Vali Acc: 0.650 Test Loss: 0.835 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0758917
	speed: 0.4018s/iter; left time: 13602.0239s
	iters: 200, epoch: 9 | loss: 0.9856067
	speed: 0.1027s/iter; left time: 3467.5136s
	iters: 300, epoch: 9 | loss: 0.0818870
	speed: 0.0919s/iter; left time: 3093.0750s
Epoch: 9 cost time: 37.73380446434021
Epoch: 9, Steps: 369 | Train Loss: 0.264 Vali Loss: 1.454 Vali Acc: 0.621 Test Loss: 1.454 Test Acc: 0.621
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3049352
	speed: 0.3782s/iter; left time: 12662.8045s
	iters: 200, epoch: 10 | loss: 0.0150331
	speed: 0.0967s/iter; left time: 3228.7961s
	iters: 300, epoch: 10 | loss: 0.1798028
	speed: 0.0907s/iter; left time: 3017.0022s
Epoch: 10 cost time: 36.49475121498108
Epoch: 10, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.084 Vali Acc: 0.654 Test Loss: 1.084 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0548613
	speed: 0.3775s/iter; left time: 12499.8483s
	iters: 200, epoch: 11 | loss: 0.1067291
	speed: 0.0958s/iter; left time: 3162.0118s
	iters: 300, epoch: 11 | loss: 0.0537099
	speed: 0.0896s/iter; left time: 2947.8177s
Epoch: 11 cost time: 36.338539361953735
Epoch: 11, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.936 Vali Acc: 0.635 Test Loss: 1.936 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0003766
	speed: 0.3804s/iter; left time: 12456.3119s
	iters: 200, epoch: 12 | loss: 0.1187057
	speed: 0.0937s/iter; left time: 3060.1483s
	iters: 300, epoch: 12 | loss: 0.2152862
	speed: 0.0831s/iter; left time: 2704.4140s
Epoch: 12 cost time: 35.63900017738342
Epoch: 12, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.615 Vali Acc: 0.644 Test Loss: 1.615 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0305434
	speed: 0.3714s/iter; left time: 12024.8930s
	iters: 200, epoch: 13 | loss: 0.2910308
	speed: 0.0925s/iter; left time: 2986.2147s
	iters: 300, epoch: 13 | loss: 0.6048542
	speed: 0.0853s/iter; left time: 2744.4563s
Epoch: 13 cost time: 35.53094410896301
Epoch: 13, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.744 Vali Acc: 0.637 Test Loss: 1.744 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0017389
	speed: 0.3386s/iter; left time: 10836.6366s
	iters: 200, epoch: 14 | loss: 0.0043985
	speed: 0.0502s/iter; left time: 1603.1110s
	iters: 300, epoch: 14 | loss: 0.1401601
	speed: 0.0493s/iter; left time: 1569.1620s
Epoch: 14 cost time: 21.87332010269165
Epoch: 14, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.666 Vali Acc: 0.650 Test Loss: 1.666 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0142675
	speed: 0.3230s/iter; left time: 10217.0470s
	iters: 200, epoch: 15 | loss: 0.0008903
	speed: 0.0886s/iter; left time: 2794.0496s
	iters: 300, epoch: 15 | loss: 0.0036631
	speed: 0.0977s/iter; left time: 3071.1931s
Epoch: 15 cost time: 34.51926612854004
Epoch: 15, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.341 Vali Acc: 0.646 Test Loss: 2.341 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.1201507
	speed: 0.3650s/iter; left time: 11412.4842s
	iters: 200, epoch: 16 | loss: 0.0022673
	speed: 0.1104s/iter; left time: 3441.1998s
	iters: 300, epoch: 16 | loss: 0.0308916
	speed: 0.1107s/iter; left time: 3437.9401s
Epoch: 16 cost time: 38.89534521102905
Epoch: 16, Steps: 369 | Train Loss: 0.090 Vali Loss: 1.956 Vali Acc: 0.629 Test Loss: 1.956 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6765039727582293
model parameter : 1925914
model size : 9.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.4734002
	speed: 0.1245s/iter; left time: 4583.4325s
	iters: 200, epoch: 1 | loss: 0.7420706
	speed: 0.1129s/iter; left time: 4141.8692s
	iters: 300, epoch: 1 | loss: 8.4344845
	speed: 0.1033s/iter; left time: 3781.0711s
Epoch: 1 cost time: 41.383355379104614
Epoch: 1, Steps: 369 | Train Loss: 1.900 Vali Loss: 2.512 Vali Acc: 0.537 Test Loss: 2.512 Test Acc: 0.537
Validation loss decreased (inf --> -0.537149).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4956650
	speed: 0.3652s/iter; left time: 13306.3222s
	iters: 200, epoch: 2 | loss: 1.6374609
	speed: 0.0961s/iter; left time: 3493.0168s
	iters: 300, epoch: 2 | loss: 1.2047207
	speed: 0.0877s/iter; left time: 3177.4826s
Epoch: 2 cost time: 32.78536677360535
Epoch: 2, Steps: 369 | Train Loss: 1.344 Vali Loss: 0.831 Vali Acc: 0.630 Test Loss: 0.831 Test Acc: 0.630
Validation loss decreased (-0.537149 --> -0.629674).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5865352
	speed: 0.3553s/iter; left time: 12812.7693s
	iters: 200, epoch: 3 | loss: 0.5460669
	speed: 0.1036s/iter; left time: 3727.2645s
	iters: 300, epoch: 3 | loss: 1.5109596
	speed: 0.0942s/iter; left time: 3379.3349s
Epoch: 3 cost time: 35.97092819213867
Epoch: 3, Steps: 369 | Train Loss: 0.901 Vali Loss: 0.709 Vali Acc: 0.660 Test Loss: 0.709 Test Acc: 0.660
Validation loss decreased (-0.629674 --> -0.660038).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8809169
	speed: 0.3659s/iter; left time: 13059.4867s
	iters: 200, epoch: 4 | loss: 0.3300009
	speed: 0.0983s/iter; left time: 3497.8708s
	iters: 300, epoch: 4 | loss: 0.8168861
	speed: 0.0874s/iter; left time: 3101.9673s
Epoch: 4 cost time: 34.37360692024231
Epoch: 4, Steps: 369 | Train Loss: 0.759 Vali Loss: 0.651 Vali Acc: 0.642 Test Loss: 0.651 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3919427
	speed: 0.3683s/iter; left time: 13008.6561s
	iters: 200, epoch: 5 | loss: 0.3875778
	speed: 0.1008s/iter; left time: 3549.0850s
	iters: 300, epoch: 5 | loss: 0.6371910
	speed: 0.0958s/iter; left time: 3364.6001s
Epoch: 5 cost time: 36.042335748672485
Epoch: 5, Steps: 369 | Train Loss: 0.573 Vali Loss: 0.665 Vali Acc: 0.668 Test Loss: 0.665 Test Acc: 0.668
Validation loss decreased (-0.660038 --> -0.668268).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9074432
	speed: 0.3647s/iter; left time: 12747.8697s
	iters: 200, epoch: 6 | loss: 0.5528468
	speed: 0.0939s/iter; left time: 3272.5959s
	iters: 300, epoch: 6 | loss: 0.4502400
	speed: 0.0896s/iter; left time: 3114.3169s
Epoch: 6 cost time: 33.99745988845825
Epoch: 6, Steps: 369 | Train Loss: 0.478 Vali Loss: 0.686 Vali Acc: 0.687 Test Loss: 0.686 Test Acc: 0.687
Validation loss decreased (-0.668268 --> -0.687280).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4425129
	speed: 0.3789s/iter; left time: 13103.4820s
	iters: 200, epoch: 7 | loss: 0.4283122
	speed: 0.0981s/iter; left time: 3382.7921s
	iters: 300, epoch: 7 | loss: 0.1153173
	speed: 0.0945s/iter; left time: 3247.9203s
Epoch: 7 cost time: 37.21735334396362
Epoch: 7, Steps: 369 | Train Loss: 0.403 Vali Loss: 0.679 Vali Acc: 0.674 Test Loss: 0.679 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2505986
	speed: 0.3697s/iter; left time: 12650.2383s
	iters: 200, epoch: 8 | loss: 0.6190054
	speed: 0.0937s/iter; left time: 3195.9768s
	iters: 300, epoch: 8 | loss: 0.9866532
	speed: 0.0930s/iter; left time: 3164.0447s
Epoch: 8 cost time: 35.54173254966736
Epoch: 8, Steps: 369 | Train Loss: 0.327 Vali Loss: 0.935 Vali Acc: 0.646 Test Loss: 0.935 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3098933
	speed: 0.4048s/iter; left time: 13701.7074s
	iters: 200, epoch: 9 | loss: 0.2323555
	speed: 0.1130s/iter; left time: 3813.4436s
	iters: 300, epoch: 9 | loss: 0.3326504
	speed: 0.1117s/iter; left time: 3757.0523s
Epoch: 9 cost time: 42.18651485443115
Epoch: 9, Steps: 369 | Train Loss: 0.257 Vali Loss: 1.045 Vali Acc: 0.664 Test Loss: 1.045 Test Acc: 0.664
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0638687
	speed: 0.4101s/iter; left time: 13730.9450s
	iters: 200, epoch: 10 | loss: 0.0872389
	speed: 0.0963s/iter; left time: 3215.8703s
	iters: 300, epoch: 10 | loss: 0.1335093
	speed: 0.1055s/iter; left time: 3510.6271s
Epoch: 10 cost time: 39.44232201576233
Epoch: 10, Steps: 369 | Train Loss: 0.212 Vali Loss: 1.041 Vali Acc: 0.658 Test Loss: 1.041 Test Acc: 0.658
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1496764
	speed: 0.4000s/iter; left time: 13245.2175s
	iters: 200, epoch: 11 | loss: 0.3612069
	speed: 0.0942s/iter; left time: 3110.2496s
	iters: 300, epoch: 11 | loss: 0.1990442
	speed: 0.0876s/iter; left time: 2883.7286s
Epoch: 11 cost time: 32.775755643844604
Epoch: 11, Steps: 369 | Train Loss: 0.160 Vali Loss: 1.545 Vali Acc: 0.634 Test Loss: 1.545 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0043824
	speed: 0.2835s/iter; left time: 9282.6880s
	iters: 200, epoch: 12 | loss: 0.4450525
	speed: 0.0920s/iter; left time: 3004.1800s
	iters: 300, epoch: 12 | loss: 0.0853313
	speed: 0.0927s/iter; left time: 3015.9707s
Epoch: 12 cost time: 34.990697383880615
Epoch: 12, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.480 Vali Acc: 0.660 Test Loss: 1.480 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.3490124
	speed: 0.3726s/iter; left time: 12061.5963s
	iters: 200, epoch: 13 | loss: 0.0600343
	speed: 0.0974s/iter; left time: 3142.8374s
	iters: 300, epoch: 13 | loss: 0.1162792
	speed: 0.0996s/iter; left time: 3204.5995s
Epoch: 13 cost time: 36.92942476272583
Epoch: 13, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.798 Vali Acc: 0.642 Test Loss: 1.798 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0088098
	speed: 0.3713s/iter; left time: 11883.6097s
	iters: 200, epoch: 14 | loss: 0.0321944
	speed: 0.0932s/iter; left time: 2972.8055s
	iters: 300, epoch: 14 | loss: 0.0017796
	speed: 0.0936s/iter; left time: 2975.3223s
Epoch: 14 cost time: 35.18602776527405
Epoch: 14, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.647 Vali Acc: 0.637 Test Loss: 1.647 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0280097
	speed: 0.3533s/iter; left time: 11176.2427s
	iters: 200, epoch: 15 | loss: 0.0175746
	speed: 0.0925s/iter; left time: 2917.1179s
	iters: 300, epoch: 15 | loss: 0.1900324
	speed: 0.0952s/iter; left time: 2993.0521s
Epoch: 15 cost time: 34.41882944107056
Epoch: 15, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.890 Vali Acc: 0.646 Test Loss: 1.890 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0447564
	speed: 0.3568s/iter; left time: 11154.5922s
	iters: 200, epoch: 16 | loss: 0.0050956
	speed: 0.0877s/iter; left time: 2731.8086s
	iters: 300, epoch: 16 | loss: 0.0146473
	speed: 0.0943s/iter; left time: 2928.6705s
Epoch: 16 cost time: 33.76006507873535
Epoch: 16, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.897 Vali Acc: 0.654 Test Loss: 1.897 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6872871736662883
model parameter : 1925146
model size : 9.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.7172520
	speed: 0.1194s/iter; left time: 4394.5202s
	iters: 200, epoch: 1 | loss: 3.3871503
	speed: 0.1013s/iter; left time: 3718.9047s
	iters: 300, epoch: 1 | loss: 1.9636662
	speed: 0.0983s/iter; left time: 3598.6962s
Epoch: 1 cost time: 38.67156481742859
Epoch: 1, Steps: 369 | Train Loss: 2.120 Vali Loss: 3.847 Vali Acc: 0.538 Test Loss: 3.847 Test Acc: 0.538
Validation loss decreased (inf --> -0.537703).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8659194
	speed: 0.3819s/iter; left time: 13913.9066s
	iters: 200, epoch: 2 | loss: 0.5500348
	speed: 0.0968s/iter; left time: 3516.8995s
	iters: 300, epoch: 2 | loss: 1.1747541
	speed: 0.1031s/iter; left time: 3736.8700s
Epoch: 2 cost time: 38.283018827438354
Epoch: 2, Steps: 369 | Train Loss: 1.851 Vali Loss: 0.900 Vali Acc: 0.636 Test Loss: 0.900 Test Acc: 0.636
Validation loss decreased (-0.537703 --> -0.635632).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3645993
	speed: 0.3878s/iter; left time: 13985.0404s
	iters: 200, epoch: 3 | loss: 0.8680134
	speed: 0.0913s/iter; left time: 3282.0494s
	iters: 300, epoch: 3 | loss: 0.5317275
	speed: 0.0880s/iter; left time: 3156.4009s
Epoch: 3 cost time: 34.41418385505676
Epoch: 3, Steps: 369 | Train Loss: 1.047 Vali Loss: 0.680 Vali Acc: 0.645 Test Loss: 0.680 Test Acc: 0.645
Validation loss decreased (-0.635632 --> -0.644715).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5251012
	speed: 0.3602s/iter; left time: 12857.2475s
	iters: 200, epoch: 4 | loss: 0.9527254
	speed: 0.0925s/iter; left time: 3291.8388s
	iters: 300, epoch: 4 | loss: 0.6020421
	speed: 0.0888s/iter; left time: 3151.7629s
Epoch: 4 cost time: 34.9036910533905
Epoch: 4, Steps: 369 | Train Loss: 0.773 Vali Loss: 1.097 Vali Acc: 0.551 Test Loss: 1.097 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2949129
	speed: 0.3623s/iter; left time: 12798.4074s
	iters: 200, epoch: 5 | loss: 1.2001342
	speed: 0.0882s/iter; left time: 3106.0030s
	iters: 300, epoch: 5 | loss: 0.3468845
	speed: 0.0879s/iter; left time: 3087.5692s
Epoch: 5 cost time: 34.06558895111084
Epoch: 5, Steps: 369 | Train Loss: 0.609 Vali Loss: 1.230 Vali Acc: 0.572 Test Loss: 1.230 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5000237
	speed: 0.3485s/iter; left time: 12181.4652s
	iters: 200, epoch: 6 | loss: 0.7107237
	speed: 0.0870s/iter; left time: 3033.1166s
	iters: 300, epoch: 6 | loss: 0.6043099
	speed: 0.0909s/iter; left time: 3158.4780s
Epoch: 6 cost time: 35.1774423122406
Epoch: 6, Steps: 369 | Train Loss: 0.490 Vali Loss: 0.635 Vali Acc: 0.677 Test Loss: 0.635 Test Acc: 0.677
Validation loss decreased (-0.644715 --> -0.677065).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0020423
	speed: 0.3691s/iter; left time: 12767.2912s
	iters: 200, epoch: 7 | loss: 0.2422252
	speed: 0.0907s/iter; left time: 3127.4303s
	iters: 300, epoch: 7 | loss: 0.1940234
	speed: 0.0733s/iter; left time: 2519.1297s
Epoch: 7 cost time: 30.146783351898193
Epoch: 7, Steps: 369 | Train Loss: 0.396 Vali Loss: 0.749 Vali Acc: 0.665 Test Loss: 0.749 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2681694
	speed: 0.2831s/iter; left time: 9685.7921s
	iters: 200, epoch: 8 | loss: 0.5506232
	speed: 0.0905s/iter; left time: 3086.9975s
	iters: 300, epoch: 8 | loss: 0.3998059
	speed: 0.0824s/iter; left time: 2804.6589s
Epoch: 8 cost time: 34.3136203289032
Epoch: 8, Steps: 369 | Train Loss: 0.318 Vali Loss: 0.904 Vali Acc: 0.638 Test Loss: 0.904 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4249212
	speed: 0.3685s/iter; left time: 12472.3492s
	iters: 200, epoch: 9 | loss: 0.2038495
	speed: 0.0918s/iter; left time: 3097.2690s
	iters: 300, epoch: 9 | loss: 0.0918510
	speed: 0.0930s/iter; left time: 3127.7745s
Epoch: 9 cost time: 35.15087914466858
Epoch: 9, Steps: 369 | Train Loss: 0.262 Vali Loss: 1.039 Vali Acc: 0.639 Test Loss: 1.039 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2714256
	speed: 0.3810s/iter; left time: 12755.2099s
	iters: 200, epoch: 10 | loss: 0.2616541
	speed: 0.1011s/iter; left time: 3374.1648s
	iters: 300, epoch: 10 | loss: 0.1711291
	speed: 0.0978s/iter; left time: 3253.1353s
Epoch: 10 cost time: 38.742886781692505
Epoch: 10, Steps: 369 | Train Loss: 0.206 Vali Loss: 1.194 Vali Acc: 0.656 Test Loss: 1.194 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0339958
	speed: 0.4025s/iter; left time: 13327.0230s
	iters: 200, epoch: 11 | loss: 0.1436897
	speed: 0.1028s/iter; left time: 3393.5268s
	iters: 300, epoch: 11 | loss: 0.0680711
	speed: 0.1047s/iter; left time: 3444.7210s
Epoch: 11 cost time: 38.32394504547119
Epoch: 11, Steps: 369 | Train Loss: 0.156 Vali Loss: 1.336 Vali Acc: 0.636 Test Loss: 1.336 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0303956
	speed: 0.3942s/iter; left time: 12907.7490s
	iters: 200, epoch: 12 | loss: 0.0798357
	speed: 0.0772s/iter; left time: 2518.4651s
	iters: 300, epoch: 12 | loss: 0.0457539
	speed: 0.0798s/iter; left time: 2595.2696s
Epoch: 12 cost time: 31.8827064037323
Epoch: 12, Steps: 369 | Train Loss: 0.141 Vali Loss: 1.636 Vali Acc: 0.627 Test Loss: 1.636 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0693487
	speed: 0.3546s/iter; left time: 11478.9652s
	iters: 200, epoch: 13 | loss: 0.1259280
	speed: 0.0834s/iter; left time: 2692.9835s
	iters: 300, epoch: 13 | loss: 0.0954687
	speed: 0.0959s/iter; left time: 3084.7448s
Epoch: 13 cost time: 33.64523196220398
Epoch: 13, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.695 Vali Acc: 0.650 Test Loss: 1.695 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0001785
	speed: 0.3464s/iter; left time: 11086.9115s
	iters: 200, epoch: 14 | loss: 0.0011370
	speed: 0.0874s/iter; left time: 2789.4356s
	iters: 300, epoch: 14 | loss: 0.1539978
	speed: 0.0958s/iter; left time: 3045.2334s
Epoch: 14 cost time: 33.933836698532104
Epoch: 14, Steps: 369 | Train Loss: 0.097 Vali Loss: 1.988 Vali Acc: 0.643 Test Loss: 1.988 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2311326
	speed: 0.3568s/iter; left time: 11288.5193s
	iters: 200, epoch: 15 | loss: 0.0497311
	speed: 0.0922s/iter; left time: 2907.8057s
	iters: 300, epoch: 15 | loss: 0.3066788
	speed: 0.0969s/iter; left time: 3046.5259s
Epoch: 15 cost time: 34.94237184524536
Epoch: 15, Steps: 369 | Train Loss: 0.111 Vali Loss: 2.220 Vali Acc: 0.638 Test Loss: 2.220 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0052910
	speed: 0.3493s/iter; left time: 10919.8155s
	iters: 200, epoch: 16 | loss: 0.0511503
	speed: 0.0915s/iter; left time: 2852.0842s
	iters: 300, epoch: 16 | loss: 0.0573652
	speed: 0.0957s/iter; left time: 2972.8754s
Epoch: 16 cost time: 33.87844443321228
Epoch: 16, Steps: 369 | Train Loss: 0.096 Vali Loss: 2.077 Vali Acc: 0.636 Test Loss: 2.077 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6770715096481271
model parameter : 1924378
model size : 9.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.1559436
	speed: 0.1092s/iter; left time: 4017.4645s
	iters: 200, epoch: 1 | loss: 3.1321037
	speed: 0.0888s/iter; left time: 3260.7361s
	iters: 300, epoch: 1 | loss: 0.4207673
	speed: 0.0811s/iter; left time: 2969.2049s
Epoch: 1 cost time: 33.97989559173584
Epoch: 1, Steps: 369 | Train Loss: 2.267 Vali Loss: 2.167 Vali Acc: 0.629 Test Loss: 2.167 Test Acc: 0.629
Validation loss decreased (inf --> -0.629093).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4184079
	speed: 0.3037s/iter; left time: 11063.3201s
	iters: 200, epoch: 2 | loss: 1.6841477
	speed: 0.0541s/iter; left time: 1965.3908s
	iters: 300, epoch: 2 | loss: 1.7667214
	speed: 0.0643s/iter; left time: 2331.2477s
Epoch: 2 cost time: 23.154865264892578
Epoch: 2, Steps: 369 | Train Loss: 1.822 Vali Loss: 3.853 Vali Acc: 0.500 Test Loss: 3.853 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9380431
	speed: 0.3362s/iter; left time: 12125.6772s
	iters: 200, epoch: 3 | loss: 0.5402510
	speed: 0.1043s/iter; left time: 3752.1041s
	iters: 300, epoch: 3 | loss: 1.0075215
	speed: 0.1045s/iter; left time: 3748.2631s
Epoch: 3 cost time: 37.35621190071106
Epoch: 3, Steps: 369 | Train Loss: 0.930 Vali Loss: 0.964 Vali Acc: 0.617 Test Loss: 0.964 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2830707
	speed: 0.3887s/iter; left time: 13875.0984s
	iters: 200, epoch: 4 | loss: 0.4421831
	speed: 0.1100s/iter; left time: 3915.7366s
	iters: 300, epoch: 4 | loss: 0.5644595
	speed: 0.1005s/iter; left time: 3566.1460s
Epoch: 4 cost time: 38.61797213554382
Epoch: 4, Steps: 369 | Train Loss: 0.672 Vali Loss: 0.629 Vali Acc: 0.652 Test Loss: 0.629 Test Acc: 0.652
Validation loss decreased (-0.629093 --> -0.651810).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4078590
	speed: 0.3584s/iter; left time: 12661.9195s
	iters: 200, epoch: 5 | loss: 0.3199213
	speed: 0.0919s/iter; left time: 3238.8406s
	iters: 300, epoch: 5 | loss: 0.5658496
	speed: 0.0855s/iter; left time: 3004.7425s
Epoch: 5 cost time: 33.46080183982849
Epoch: 5, Steps: 369 | Train Loss: 0.579 Vali Loss: 0.858 Vali Acc: 0.623 Test Loss: 0.858 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4304633
	speed: 0.3501s/iter; left time: 12236.4000s
	iters: 200, epoch: 6 | loss: 0.6324298
	speed: 0.0922s/iter; left time: 3213.0811s
	iters: 300, epoch: 6 | loss: 0.3389826
	speed: 0.0905s/iter; left time: 3145.3601s
Epoch: 6 cost time: 34.49128437042236
Epoch: 6, Steps: 369 | Train Loss: 0.450 Vali Loss: 0.657 Vali Acc: 0.672 Test Loss: 0.657 Test Acc: 0.672
Validation loss decreased (-0.651810 --> -0.671673).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7682377
	speed: 0.3447s/iter; left time: 11921.3563s
	iters: 200, epoch: 7 | loss: 0.1303598
	speed: 0.0907s/iter; left time: 3128.0082s
	iters: 300, epoch: 7 | loss: 0.1875780
	speed: 0.0861s/iter; left time: 2960.2420s
Epoch: 7 cost time: 32.94231367111206
Epoch: 7, Steps: 369 | Train Loss: 0.389 Vali Loss: 0.974 Vali Acc: 0.641 Test Loss: 0.974 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2287137
	speed: 0.3451s/iter; left time: 11809.6417s
	iters: 200, epoch: 8 | loss: 0.1314984
	speed: 0.0939s/iter; left time: 3203.5565s
	iters: 300, epoch: 8 | loss: 0.3704161
	speed: 0.0928s/iter; left time: 3156.2599s
Epoch: 8 cost time: 34.89595699310303
Epoch: 8, Steps: 369 | Train Loss: 0.299 Vali Loss: 0.901 Vali Acc: 0.648 Test Loss: 0.901 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0910760
	speed: 0.3582s/iter; left time: 12126.0334s
	iters: 200, epoch: 9 | loss: 0.3717897
	speed: 0.0926s/iter; left time: 3123.6869s
	iters: 300, epoch: 9 | loss: 0.1856625
	speed: 0.0871s/iter; left time: 2932.4918s
Epoch: 9 cost time: 34.120450019836426
Epoch: 9, Steps: 369 | Train Loss: 0.231 Vali Loss: 1.384 Vali Acc: 0.652 Test Loss: 1.384 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1632130
	speed: 0.3533s/iter; left time: 11829.4175s
	iters: 200, epoch: 10 | loss: 0.2487881
	speed: 0.0912s/iter; left time: 3044.0217s
	iters: 300, epoch: 10 | loss: 0.5307521
	speed: 0.0868s/iter; left time: 2890.0160s
Epoch: 10 cost time: 34.145822525024414
Epoch: 10, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.942 Vali Acc: 0.615 Test Loss: 1.942 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0503829
	speed: 0.3206s/iter; left time: 10615.4464s
	iters: 200, epoch: 11 | loss: 0.2844468
	speed: 0.0886s/iter; left time: 2926.2315s
	iters: 300, epoch: 11 | loss: 0.4341735
	speed: 0.0894s/iter; left time: 2941.9981s
Epoch: 11 cost time: 33.86756372451782
Epoch: 11, Steps: 369 | Train Loss: 0.136 Vali Loss: 1.317 Vali Acc: 0.656 Test Loss: 1.317 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2004057
	speed: 0.3839s/iter; left time: 12569.5802s
	iters: 200, epoch: 12 | loss: 0.7519336
	speed: 0.0936s/iter; left time: 3053.7504s
	iters: 300, epoch: 12 | loss: 0.0670582
	speed: 0.0970s/iter; left time: 3155.0418s
Epoch: 12 cost time: 37.199042081832886
Epoch: 12, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.612 Vali Acc: 0.642 Test Loss: 1.612 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0640156
	speed: 0.3800s/iter; left time: 12301.1834s
	iters: 200, epoch: 13 | loss: 0.0855654
	speed: 0.1012s/iter; left time: 3266.1843s
	iters: 300, epoch: 13 | loss: 0.0261196
	speed: 0.1047s/iter; left time: 3369.2129s
Epoch: 13 cost time: 39.27783155441284
Epoch: 13, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.952 Vali Acc: 0.640 Test Loss: 1.952 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0074933
	speed: 0.3625s/iter; left time: 11600.2759s
	iters: 200, epoch: 14 | loss: 0.0201940
	speed: 0.0873s/iter; left time: 2784.4998s
	iters: 300, epoch: 14 | loss: 0.0338384
	speed: 0.0898s/iter; left time: 2857.0557s
Epoch: 14 cost time: 33.85261678695679
Epoch: 14, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.631 Vali Acc: 0.647 Test Loss: 1.631 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0272614
	speed: 0.3462s/iter; left time: 10953.3094s
	iters: 200, epoch: 15 | loss: 0.0101725
	speed: 0.0922s/iter; left time: 2908.4600s
	iters: 300, epoch: 15 | loss: 0.0434605
	speed: 0.0930s/iter; left time: 2922.8215s
Epoch: 15 cost time: 35.17708683013916
Epoch: 15, Steps: 369 | Train Loss: 0.093 Vali Loss: 2.146 Vali Acc: 0.643 Test Loss: 2.146 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0417579
	speed: 0.3483s/iter; left time: 10890.1924s
	iters: 200, epoch: 16 | loss: 0.5079449
	speed: 0.0835s/iter; left time: 2601.3692s
	iters: 300, epoch: 16 | loss: 0.1109354
	speed: 0.0664s/iter; left time: 2063.5750s
Epoch: 16 cost time: 27.949485778808594
Epoch: 16, Steps: 369 | Train Loss: 0.102 Vali Loss: 2.045 Vali Acc: 0.646 Test Loss: 2.045 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6716799091940976
model parameter : 1531930
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6973222
	speed: 0.1121s/iter; left time: 4124.6984s
	iters: 200, epoch: 1 | loss: 3.0760005
	speed: 0.0915s/iter; left time: 3358.3051s
	iters: 300, epoch: 1 | loss: 0.8947324
	speed: 0.0838s/iter; left time: 3068.7429s
Epoch: 1 cost time: 35.337475061416626
Epoch: 1, Steps: 369 | Train Loss: 1.833 Vali Loss: 1.752 Vali Acc: 0.589 Test Loss: 1.752 Test Acc: 0.589
Validation loss decreased (inf --> -0.588802).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2541611
	speed: 0.3244s/iter; left time: 11818.5082s
	iters: 200, epoch: 2 | loss: 1.3759961
	speed: 0.0857s/iter; left time: 3114.4640s
	iters: 300, epoch: 2 | loss: 0.4637361
	speed: 0.0933s/iter; left time: 3381.7476s
Epoch: 2 cost time: 33.94170045852661
Epoch: 2, Steps: 369 | Train Loss: 1.701 Vali Loss: 3.734 Vali Acc: 0.500 Test Loss: 3.734 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8335298
	speed: 0.3510s/iter; left time: 12658.7948s
	iters: 200, epoch: 3 | loss: 0.5313518
	speed: 0.0905s/iter; left time: 3253.2415s
	iters: 300, epoch: 3 | loss: 0.6372489
	speed: 0.0905s/iter; left time: 3244.9405s
Epoch: 3 cost time: 34.361273527145386
Epoch: 3, Steps: 369 | Train Loss: 0.908 Vali Loss: 2.270 Vali Acc: 0.508 Test Loss: 2.270 Test Acc: 0.508
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8676431
	speed: 0.3570s/iter; left time: 12742.8712s
	iters: 200, epoch: 4 | loss: 0.5532551
	speed: 0.0992s/iter; left time: 3532.2120s
	iters: 300, epoch: 4 | loss: 0.6233774
	speed: 0.1007s/iter; left time: 3574.0428s
Epoch: 4 cost time: 36.99914479255676
Epoch: 4, Steps: 369 | Train Loss: 0.798 Vali Loss: 0.754 Vali Acc: 0.605 Test Loss: 0.754 Test Acc: 0.605
Validation loss decreased (-0.588802 --> -0.605271).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2682005
	speed: 0.3747s/iter; left time: 13234.7787s
	iters: 200, epoch: 5 | loss: 0.6050183
	speed: 0.1033s/iter; left time: 3639.2830s
	iters: 300, epoch: 5 | loss: 0.3005145
	speed: 0.1065s/iter; left time: 3740.7615s
Epoch: 5 cost time: 37.9472918510437
Epoch: 5, Steps: 369 | Train Loss: 0.583 Vali Loss: 0.665 Vali Acc: 0.652 Test Loss: 0.665 Test Acc: 0.652
Validation loss decreased (-0.605271 --> -0.651526).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3302989
	speed: 0.3606s/iter; left time: 12603.4998s
	iters: 200, epoch: 6 | loss: 0.2435087
	speed: 0.0918s/iter; left time: 3200.6140s
	iters: 300, epoch: 6 | loss: 0.4317198
	speed: 0.0913s/iter; left time: 3173.0402s
Epoch: 6 cost time: 33.69160795211792
Epoch: 6, Steps: 369 | Train Loss: 0.457 Vali Loss: 0.740 Vali Acc: 0.669 Test Loss: 0.740 Test Acc: 0.669
Validation loss decreased (-0.651526 --> -0.669119).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7546543
	speed: 0.3435s/iter; left time: 11881.0632s
	iters: 200, epoch: 7 | loss: 0.3089185
	speed: 0.0977s/iter; left time: 3367.6662s
	iters: 300, epoch: 7 | loss: 0.1903458
	speed: 0.0926s/iter; left time: 3183.8073s
Epoch: 7 cost time: 33.66113257408142
Epoch: 7, Steps: 369 | Train Loss: 0.386 Vali Loss: 0.795 Vali Acc: 0.667 Test Loss: 0.795 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4549403
	speed: 0.3203s/iter; left time: 10959.5986s
	iters: 200, epoch: 8 | loss: 0.2877142
	speed: 0.0917s/iter; left time: 3129.4704s
	iters: 300, epoch: 8 | loss: 0.5838311
	speed: 0.0880s/iter; left time: 2992.5793s
Epoch: 8 cost time: 31.840043544769287
Epoch: 8, Steps: 369 | Train Loss: 0.306 Vali Loss: 0.981 Vali Acc: 0.648 Test Loss: 0.981 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2188278
	speed: 0.3452s/iter; left time: 11686.0244s
	iters: 200, epoch: 9 | loss: 0.7046757
	speed: 0.0921s/iter; left time: 3109.3171s
	iters: 300, epoch: 9 | loss: 0.1872956
	speed: 0.0880s/iter; left time: 2961.1949s
Epoch: 9 cost time: 34.33884859085083
Epoch: 9, Steps: 369 | Train Loss: 0.241 Vali Loss: 0.979 Vali Acc: 0.643 Test Loss: 0.979 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.5951868
	speed: 0.3455s/iter; left time: 11567.7449s
	iters: 200, epoch: 10 | loss: 0.2385426
	speed: 0.0851s/iter; left time: 2839.6350s
	iters: 300, epoch: 10 | loss: 0.0268306
	speed: 0.0838s/iter; left time: 2788.0968s
Epoch: 10 cost time: 33.19643831253052
Epoch: 10, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.454 Vali Acc: 0.627 Test Loss: 1.454 Test Acc: 0.627
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4001664
	speed: 0.3524s/iter; left time: 11669.9084s
	iters: 200, epoch: 11 | loss: 0.0904147
	speed: 0.0879s/iter; left time: 2901.9015s
	iters: 300, epoch: 11 | loss: 0.2009255
	speed: 0.0941s/iter; left time: 3096.6423s
Epoch: 11 cost time: 34.887868881225586
Epoch: 11, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.662 Vali Acc: 0.636 Test Loss: 1.662 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1702925
	speed: 0.3493s/iter; left time: 11437.8417s
	iters: 200, epoch: 12 | loss: 0.0125768
	speed: 0.0821s/iter; left time: 2679.8589s
	iters: 300, epoch: 12 | loss: 0.0255117
	speed: 0.0898s/iter; left time: 2921.3491s
Epoch: 12 cost time: 33.57920002937317
Epoch: 12, Steps: 369 | Train Loss: 0.126 Vali Loss: 1.535 Vali Acc: 0.644 Test Loss: 1.535 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.3215249
	speed: 0.3483s/iter; left time: 11274.7170s
	iters: 200, epoch: 13 | loss: 0.2625341
	speed: 0.1054s/iter; left time: 3402.3085s
	iters: 300, epoch: 13 | loss: 0.7728840
	speed: 0.1064s/iter; left time: 3423.5672s
Epoch: 13 cost time: 37.83407640457153
Epoch: 13, Steps: 369 | Train Loss: 0.111 Vali Loss: 2.528 Vali Acc: 0.619 Test Loss: 2.528 Test Acc: 0.619
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0115315
	speed: 0.3734s/iter; left time: 11951.6048s
	iters: 200, epoch: 14 | loss: 0.1036188
	speed: 0.0957s/iter; left time: 3054.7791s
	iters: 300, epoch: 14 | loss: 0.0380276
	speed: 0.1004s/iter; left time: 3194.5189s
Epoch: 14 cost time: 37.09488534927368
Epoch: 14, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.819 Vali Acc: 0.634 Test Loss: 1.819 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0554873
	speed: 0.3651s/iter; left time: 11550.9962s
	iters: 200, epoch: 15 | loss: 0.4545062
	speed: 0.0904s/iter; left time: 2850.0731s
	iters: 300, epoch: 15 | loss: 0.0854920
	speed: 0.0739s/iter; left time: 2324.1385s
Epoch: 15 cost time: 30.41575050354004
Epoch: 15, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.937 Vali Acc: 0.645 Test Loss: 1.937 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0091163
	speed: 0.2832s/iter; left time: 8854.8950s
	iters: 200, epoch: 16 | loss: 0.0085094
	speed: 0.0837s/iter; left time: 2610.0367s
	iters: 300, epoch: 16 | loss: 0.4348020
	speed: 0.0893s/iter; left time: 2774.0617s
Epoch: 16 cost time: 33.28669762611389
Epoch: 16, Steps: 369 | Train Loss: 0.079 Vali Loss: 2.384 Vali Acc: 0.648 Test Loss: 2.384 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6691259931895573
model parameter : 1531162
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.8411230
	speed: 0.1033s/iter; left time: 3802.3846s
	iters: 200, epoch: 1 | loss: 5.2749619
	speed: 0.0900s/iter; left time: 3301.7065s
	iters: 300, epoch: 1 | loss: 7.5326443
	speed: 0.0887s/iter; left time: 3245.7868s
Epoch: 1 cost time: 33.69841980934143
Epoch: 1, Steps: 369 | Train Loss: 1.799 Vali Loss: 2.791 Vali Acc: 0.540 Test Loss: 2.791 Test Acc: 0.540
Validation loss decreased (inf --> -0.539700).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3751768
	speed: 0.3303s/iter; left time: 12032.0761s
	iters: 200, epoch: 2 | loss: 0.6653077
	speed: 0.0899s/iter; left time: 3266.8098s
	iters: 300, epoch: 2 | loss: 0.3642491
	speed: 0.0846s/iter; left time: 3066.0669s
Epoch: 2 cost time: 32.78009796142578
Epoch: 2, Steps: 369 | Train Loss: 1.340 Vali Loss: 1.416 Vali Acc: 0.568 Test Loss: 1.416 Test Acc: 0.568
Validation loss decreased (-0.539700 --> -0.567806).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7135592
	speed: 0.3384s/iter; left time: 12204.5324s
	iters: 200, epoch: 3 | loss: 0.8720006
	speed: 0.0890s/iter; left time: 3199.8458s
	iters: 300, epoch: 3 | loss: 0.2529555
	speed: 0.0821s/iter; left time: 2945.7397s
Epoch: 3 cost time: 32.999823808670044
Epoch: 3, Steps: 369 | Train Loss: 0.911 Vali Loss: 0.822 Vali Acc: 0.583 Test Loss: 0.822 Test Acc: 0.583
Validation loss decreased (-0.567806 --> -0.583136).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2082781
	speed: 0.3206s/iter; left time: 11443.2373s
	iters: 200, epoch: 4 | loss: 0.8387901
	speed: 0.0886s/iter; left time: 3154.3455s
	iters: 300, epoch: 4 | loss: 0.4375629
	speed: 0.0790s/iter; left time: 2804.4221s
Epoch: 4 cost time: 32.98184013366699
Epoch: 4, Steps: 369 | Train Loss: 0.689 Vali Loss: 0.930 Vali Acc: 0.590 Test Loss: 0.930 Test Acc: 0.590
Validation loss decreased (-0.583136 --> -0.589945).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5466338
	speed: 0.3442s/iter; left time: 12159.3132s
	iters: 200, epoch: 5 | loss: 0.7457036
	speed: 0.0892s/iter; left time: 3143.5391s
	iters: 300, epoch: 5 | loss: 0.5481199
	speed: 0.0857s/iter; left time: 3011.8591s
Epoch: 5 cost time: 33.915016412734985
Epoch: 5, Steps: 369 | Train Loss: 0.545 Vali Loss: 0.919 Vali Acc: 0.606 Test Loss: 0.919 Test Acc: 0.606
Validation loss decreased (-0.589945 --> -0.605836).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3070688
	speed: 0.3506s/iter; left time: 12254.7723s
	iters: 200, epoch: 6 | loss: 0.3476168
	speed: 0.0950s/iter; left time: 3312.8180s
	iters: 300, epoch: 6 | loss: 0.3499386
	speed: 0.1012s/iter; left time: 3517.8867s
Epoch: 6 cost time: 36.8080735206604
Epoch: 6, Steps: 369 | Train Loss: 0.446 Vali Loss: 0.806 Vali Acc: 0.672 Test Loss: 0.806 Test Acc: 0.672
Validation loss decreased (-0.605836 --> -0.671956).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3368609
	speed: 0.3691s/iter; left time: 12765.2677s
	iters: 200, epoch: 7 | loss: 0.4078185
	speed: 0.0989s/iter; left time: 3411.3698s
	iters: 300, epoch: 7 | loss: 0.4416500
	speed: 0.1024s/iter; left time: 3521.0841s
Epoch: 7 cost time: 37.35860729217529
Epoch: 7, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.761 Vali Acc: 0.666 Test Loss: 0.761 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1891271
	speed: 0.3464s/iter; left time: 11854.2314s
	iters: 200, epoch: 8 | loss: 0.2094049
	speed: 0.0861s/iter; left time: 2937.1445s
	iters: 300, epoch: 8 | loss: 0.5748814
	speed: 0.0925s/iter; left time: 3146.2258s
Epoch: 8 cost time: 32.98943877220154
Epoch: 8, Steps: 369 | Train Loss: 0.323 Vali Loss: 1.083 Vali Acc: 0.644 Test Loss: 1.083 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0904187
	speed: 0.3326s/iter; left time: 11258.5080s
	iters: 200, epoch: 9 | loss: 0.3131583
	speed: 0.0915s/iter; left time: 3089.6566s
	iters: 300, epoch: 9 | loss: 0.0964861
	speed: 0.0914s/iter; left time: 3075.3388s
Epoch: 9 cost time: 33.68379807472229
Epoch: 9, Steps: 369 | Train Loss: 0.249 Vali Loss: 1.215 Vali Acc: 0.634 Test Loss: 1.215 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1868679
	speed: 0.3232s/iter; left time: 10821.0753s
	iters: 200, epoch: 10 | loss: 0.3498381
	speed: 0.0884s/iter; left time: 2949.7507s
	iters: 300, epoch: 10 | loss: 0.2467174
	speed: 0.0786s/iter; left time: 2614.4797s
Epoch: 10 cost time: 30.829869031906128
Epoch: 10, Steps: 369 | Train Loss: 0.205 Vali Loss: 1.381 Vali Acc: 0.644 Test Loss: 1.381 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0486122
	speed: 0.3363s/iter; left time: 11136.7763s
	iters: 200, epoch: 11 | loss: 0.4726321
	speed: 0.0935s/iter; left time: 3086.7507s
	iters: 300, epoch: 11 | loss: 0.1433752
	speed: 0.0848s/iter; left time: 2791.2490s
Epoch: 11 cost time: 33.1435432434082
Epoch: 11, Steps: 369 | Train Loss: 0.162 Vali Loss: 1.545 Vali Acc: 0.657 Test Loss: 1.545 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1555816
	speed: 0.3311s/iter; left time: 10840.2976s
	iters: 200, epoch: 12 | loss: 0.0191092
	speed: 0.0857s/iter; left time: 2799.0396s
	iters: 300, epoch: 12 | loss: 0.0291289
	speed: 0.0793s/iter; left time: 2581.3608s
Epoch: 12 cost time: 32.272236347198486
Epoch: 12, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.785 Vali Acc: 0.646 Test Loss: 1.785 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0126581
	speed: 0.3331s/iter; left time: 10782.0618s
	iters: 200, epoch: 13 | loss: 0.0699806
	speed: 0.0840s/iter; left time: 2709.6327s
	iters: 300, epoch: 13 | loss: 0.5106545
	speed: 0.0917s/iter; left time: 2951.6288s
Epoch: 13 cost time: 33.60696339607239
Epoch: 13, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.615 Vali Acc: 0.635 Test Loss: 1.615 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0820304
	speed: 0.3295s/iter; left time: 10545.4449s
	iters: 200, epoch: 14 | loss: 0.1348794
	speed: 0.0801s/iter; left time: 2555.6431s
	iters: 300, epoch: 14 | loss: 0.1944129
	speed: 0.0833s/iter; left time: 2650.1787s
Epoch: 14 cost time: 31.88285231590271
Epoch: 14, Steps: 369 | Train Loss: 0.109 Vali Loss: 2.171 Vali Acc: 0.632 Test Loss: 2.171 Test Acc: 0.632
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0988253
	speed: 0.3396s/iter; left time: 10741.7520s
	iters: 200, epoch: 15 | loss: 0.1644603
	speed: 0.0847s/iter; left time: 2669.8903s
	iters: 300, epoch: 15 | loss: 0.0019287
	speed: 0.1052s/iter; left time: 3306.8147s
Epoch: 15 cost time: 35.94782304763794
Epoch: 15, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.952 Vali Acc: 0.642 Test Loss: 1.952 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2752956
	speed: 0.3606s/iter; left time: 11276.0607s
	iters: 200, epoch: 16 | loss: 0.0019791
	speed: 0.0985s/iter; left time: 3070.7169s
	iters: 300, epoch: 16 | loss: 0.1430745
	speed: 0.0916s/iter; left time: 2845.4268s
Epoch: 16 cost time: 33.76232624053955
Epoch: 16, Steps: 369 | Train Loss: 0.098 Vali Loss: 2.261 Vali Acc: 0.640 Test Loss: 2.261 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6719636776390465
model parameter : 1530394
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9163806
	speed: 0.1087s/iter; left time: 4001.7347s
	iters: 200, epoch: 1 | loss: 2.5513246
	speed: 0.0876s/iter; left time: 3214.4001s
	iters: 300, epoch: 1 | loss: 1.8782362
	speed: 0.0772s/iter; left time: 2826.6272s
Epoch: 1 cost time: 33.21702480316162
Epoch: 1, Steps: 369 | Train Loss: 1.765 Vali Loss: 1.385 Vali Acc: 0.624 Test Loss: 1.385 Test Acc: 0.624
Validation loss decreased (inf --> -0.623993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2101151
	speed: 0.3146s/iter; left time: 11459.6951s
	iters: 200, epoch: 2 | loss: 1.3800879
	speed: 0.0892s/iter; left time: 3239.9926s
	iters: 300, epoch: 2 | loss: 2.4304667
	speed: 0.0797s/iter; left time: 2887.3787s
Epoch: 2 cost time: 30.858261108398438
Epoch: 2, Steps: 369 | Train Loss: 1.521 Vali Loss: 3.138 Vali Acc: 0.504 Test Loss: 3.138 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5471990
	speed: 0.3309s/iter; left time: 11932.2554s
	iters: 200, epoch: 3 | loss: 0.8385729
	speed: 0.0916s/iter; left time: 3294.5472s
	iters: 300, epoch: 3 | loss: 0.4129264
	speed: 0.0778s/iter; left time: 2790.7440s
Epoch: 3 cost time: 32.42004060745239
Epoch: 3, Steps: 369 | Train Loss: 0.967 Vali Loss: 0.710 Vali Acc: 0.616 Test Loss: 0.710 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.3879754
	speed: 0.3296s/iter; left time: 11764.6171s
	iters: 200, epoch: 4 | loss: 1.1191257
	speed: 0.0780s/iter; left time: 2776.7019s
	iters: 300, epoch: 4 | loss: 0.4475931
	speed: 0.0859s/iter; left time: 3049.5031s
Epoch: 4 cost time: 31.772587537765503
Epoch: 4, Steps: 369 | Train Loss: 0.691 Vali Loss: 0.776 Vali Acc: 0.593 Test Loss: 0.776 Test Acc: 0.593
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3750615
	speed: 0.3234s/iter; left time: 11424.3240s
	iters: 200, epoch: 5 | loss: 0.5235018
	speed: 0.0851s/iter; left time: 2997.3437s
	iters: 300, epoch: 5 | loss: 0.5614232
	speed: 0.0923s/iter; left time: 3241.9564s
Epoch: 5 cost time: 33.06482672691345
Epoch: 5, Steps: 369 | Train Loss: 0.549 Vali Loss: 0.750 Vali Acc: 0.632 Test Loss: 0.750 Test Acc: 0.632
Validation loss decreased (-0.623993 --> -0.631945).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8465606
	speed: 0.3339s/iter; left time: 11671.3109s
	iters: 200, epoch: 6 | loss: 0.3290644
	speed: 0.0734s/iter; left time: 2557.3504s
	iters: 300, epoch: 6 | loss: 0.5489140
	speed: 0.0876s/iter; left time: 3043.2085s
Epoch: 6 cost time: 30.427253007888794
Epoch: 6, Steps: 369 | Train Loss: 0.451 Vali Loss: 0.679 Vali Acc: 0.666 Test Loss: 0.679 Test Acc: 0.666
Validation loss decreased (-0.631945 --> -0.666282).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8448577
	speed: 0.3300s/iter; left time: 11413.3232s
	iters: 200, epoch: 7 | loss: 0.6563131
	speed: 0.0885s/iter; left time: 3050.6925s
	iters: 300, epoch: 7 | loss: 0.3389055
	speed: 0.0843s/iter; left time: 2897.9007s
Epoch: 7 cost time: 32.14485549926758
Epoch: 7, Steps: 369 | Train Loss: 0.382 Vali Loss: 0.827 Vali Acc: 0.680 Test Loss: 0.827 Test Acc: 0.680
Validation loss decreased (-0.666282 --> -0.680185).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0935885
	speed: 0.3195s/iter; left time: 10931.3052s
	iters: 200, epoch: 8 | loss: 0.2577815
	speed: 0.0927s/iter; left time: 3162.2250s
	iters: 300, epoch: 8 | loss: 0.0415234
	speed: 0.0823s/iter; left time: 2800.9826s
Epoch: 8 cost time: 31.518843412399292
Epoch: 8, Steps: 369 | Train Loss: 0.297 Vali Loss: 0.899 Vali Acc: 0.663 Test Loss: 0.899 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0439841
	speed: 0.3351s/iter; left time: 11341.7546s
	iters: 200, epoch: 9 | loss: 0.2543480
	speed: 0.0965s/iter; left time: 3257.4364s
	iters: 300, epoch: 9 | loss: 0.4505120
	speed: 0.0954s/iter; left time: 3211.6752s
Epoch: 9 cost time: 33.58722448348999
Epoch: 9, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.300 Vali Acc: 0.617 Test Loss: 1.300 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2063929
	speed: 0.3428s/iter; left time: 11475.7195s
	iters: 200, epoch: 10 | loss: 0.2380868
	speed: 0.0960s/iter; left time: 3205.4825s
	iters: 300, epoch: 10 | loss: 0.1435809
	speed: 0.0907s/iter; left time: 3019.9628s
Epoch: 10 cost time: 33.98371195793152
Epoch: 10, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.403 Vali Acc: 0.659 Test Loss: 1.403 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0692696
	speed: 0.3281s/iter; left time: 10862.3967s
	iters: 200, epoch: 11 | loss: 0.1675272
	speed: 0.0848s/iter; left time: 2800.8579s
	iters: 300, epoch: 11 | loss: 0.1449447
	speed: 0.0685s/iter; left time: 2254.0245s
Epoch: 11 cost time: 29.821950912475586
Epoch: 11, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.646 Vali Acc: 0.660 Test Loss: 1.646 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0894145
	speed: 0.2988s/iter; left time: 9783.9775s
	iters: 200, epoch: 12 | loss: 0.0374952
	speed: 0.0754s/iter; left time: 2460.4812s
	iters: 300, epoch: 12 | loss: 0.1791175
	speed: 0.0755s/iter; left time: 2455.7045s
Epoch: 12 cost time: 28.361233234405518
Epoch: 12, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.441 Vali Acc: 0.641 Test Loss: 1.441 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1601646
	speed: 0.3117s/iter; left time: 10090.9638s
	iters: 200, epoch: 13 | loss: 0.0019822
	speed: 0.0819s/iter; left time: 2643.2790s
	iters: 300, epoch: 13 | loss: 0.3505252
	speed: 0.0805s/iter; left time: 2590.5747s
Epoch: 13 cost time: 31.08960485458374
Epoch: 13, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.734 Vali Acc: 0.646 Test Loss: 1.734 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0048231
	speed: 0.3260s/iter; left time: 10434.8135s
	iters: 200, epoch: 14 | loss: 0.1326308
	speed: 0.0804s/iter; left time: 2565.7955s
	iters: 300, epoch: 14 | loss: 0.3391589
	speed: 0.0689s/iter; left time: 2191.3976s
Epoch: 14 cost time: 30.49955129623413
Epoch: 14, Steps: 369 | Train Loss: 0.090 Vali Loss: 1.667 Vali Acc: 0.646 Test Loss: 1.667 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0312518
	speed: 0.3282s/iter; left time: 10381.5343s
	iters: 200, epoch: 15 | loss: 0.0223886
	speed: 0.0823s/iter; left time: 2594.1382s
	iters: 300, epoch: 15 | loss: 0.0561630
	speed: 0.0765s/iter; left time: 2403.4217s
Epoch: 15 cost time: 31.60527229309082
Epoch: 15, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.726 Vali Acc: 0.649 Test Loss: 1.726 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0076337
	speed: 0.3310s/iter; left time: 10348.6196s
	iters: 200, epoch: 16 | loss: 0.0795517
	speed: 0.0765s/iter; left time: 2384.3225s
	iters: 300, epoch: 16 | loss: 0.0068938
	speed: 0.0805s/iter; left time: 2500.3815s
Epoch: 16 cost time: 30.91911792755127
Epoch: 16, Steps: 369 | Train Loss: 0.091 Vali Loss: 2.005 Vali Acc: 0.626 Test Loss: 2.005 Test Acc: 0.626
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0118800
	speed: 0.3317s/iter; left time: 10248.2192s
	iters: 200, epoch: 17 | loss: 0.5047416
	speed: 0.0814s/iter; left time: 2506.2459s
	iters: 300, epoch: 17 | loss: 0.0161796
	speed: 0.0869s/iter; left time: 2668.2221s
Epoch: 17 cost time: 31.28949522972107
Epoch: 17, Steps: 369 | Train Loss: 0.083 Vali Loss: 2.166 Vali Acc: 0.654 Test Loss: 2.166 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6801929625425652
model parameter : 1529626
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.0372937
	speed: 0.1110s/iter; left time: 4083.7620s
	iters: 200, epoch: 1 | loss: 1.3351135
	speed: 0.0934s/iter; left time: 3428.0466s
	iters: 300, epoch: 1 | loss: 2.0973530
	speed: 0.0922s/iter; left time: 3376.1507s
Epoch: 1 cost time: 35.61062812805176
Epoch: 1, Steps: 369 | Train Loss: 2.136 Vali Loss: 1.676 Vali Acc: 0.644 Test Loss: 1.676 Test Acc: 0.644
Validation loss decreased (inf --> -0.643570).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9944671
	speed: 0.2689s/iter; left time: 9796.5503s
	iters: 200, epoch: 2 | loss: 0.7097832
	speed: 0.0957s/iter; left time: 3477.6752s
	iters: 300, epoch: 2 | loss: 0.9890705
	speed: 0.0891s/iter; left time: 3226.7982s
Epoch: 2 cost time: 30.781023025512695
Epoch: 2, Steps: 369 | Train Loss: 1.498 Vali Loss: 1.077 Vali Acc: 0.580 Test Loss: 1.077 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5011352
	speed: 0.3322s/iter; left time: 11980.7333s
	iters: 200, epoch: 3 | loss: 0.9245831
	speed: 0.0854s/iter; left time: 3070.4687s
	iters: 300, epoch: 3 | loss: 0.6107657
	speed: 0.0732s/iter; left time: 2624.7425s
Epoch: 3 cost time: 30.575568437576294
Epoch: 3, Steps: 369 | Train Loss: 0.954 Vali Loss: 3.492 Vali Acc: 0.500 Test Loss: 3.492 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.1401196
	speed: 0.3219s/iter; left time: 11491.4216s
	iters: 200, epoch: 4 | loss: 0.5082040
	speed: 0.0843s/iter; left time: 3000.9985s
	iters: 300, epoch: 4 | loss: 0.6833520
	speed: 0.0788s/iter; left time: 2796.2283s
Epoch: 4 cost time: 31.036071062088013
Epoch: 4, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.645 Vali Acc: 0.652 Test Loss: 0.645 Test Acc: 0.652
Validation loss decreased (-0.643570 --> -0.651526).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5915437
	speed: 0.3353s/iter; left time: 11843.8605s
	iters: 200, epoch: 5 | loss: 0.6883437
	speed: 0.0800s/iter; left time: 2816.8855s
	iters: 300, epoch: 5 | loss: 0.4829006
	speed: 0.0740s/iter; left time: 2597.8714s
Epoch: 5 cost time: 30.880547046661377
Epoch: 5, Steps: 369 | Train Loss: 0.557 Vali Loss: 0.873 Vali Acc: 0.571 Test Loss: 0.873 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4932188
	speed: 0.3266s/iter; left time: 11416.9385s
	iters: 200, epoch: 6 | loss: 0.3178509
	speed: 0.0833s/iter; left time: 2904.2171s
	iters: 300, epoch: 6 | loss: 0.5448966
	speed: 0.0770s/iter; left time: 2677.2353s
Epoch: 6 cost time: 31.485628604888916
Epoch: 6, Steps: 369 | Train Loss: 0.448 Vali Loss: 0.680 Vali Acc: 0.665 Test Loss: 0.680 Test Acc: 0.665
Validation loss decreased (-0.651526 --> -0.664863).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2785805
	speed: 0.3236s/iter; left time: 11192.5690s
	iters: 200, epoch: 7 | loss: 0.3830363
	speed: 0.0803s/iter; left time: 2769.4617s
	iters: 300, epoch: 7 | loss: 0.1320602
	speed: 0.0835s/iter; left time: 2870.0332s
Epoch: 7 cost time: 31.586141109466553
Epoch: 7, Steps: 369 | Train Loss: 0.363 Vali Loss: 0.973 Vali Acc: 0.603 Test Loss: 0.973 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0890041
	speed: 0.3229s/iter; left time: 11049.2515s
	iters: 200, epoch: 8 | loss: 0.0878641
	speed: 0.0860s/iter; left time: 2932.9353s
	iters: 300, epoch: 8 | loss: 0.3707536
	speed: 0.0828s/iter; left time: 2815.4975s
Epoch: 8 cost time: 32.10722589492798
Epoch: 8, Steps: 369 | Train Loss: 0.281 Vali Loss: 0.872 Vali Acc: 0.656 Test Loss: 0.872 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3524008
	speed: 0.3181s/iter; left time: 10768.4252s
	iters: 200, epoch: 9 | loss: 0.3291552
	speed: 0.0771s/iter; left time: 2601.8778s
	iters: 300, epoch: 9 | loss: 0.2698707
	speed: 0.0876s/iter; left time: 2946.7227s
Epoch: 9 cost time: 30.793790340423584
Epoch: 9, Steps: 369 | Train Loss: 0.219 Vali Loss: 1.293 Vali Acc: 0.661 Test Loss: 1.293 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1038594
	speed: 0.3244s/iter; left time: 10859.9261s
	iters: 200, epoch: 10 | loss: 0.3128431
	speed: 0.0917s/iter; left time: 3061.4863s
	iters: 300, epoch: 10 | loss: 0.0568930
	speed: 0.1006s/iter; left time: 3349.3846s
Epoch: 10 cost time: 33.96010994911194
Epoch: 10, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.186 Vali Acc: 0.656 Test Loss: 1.186 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2044541
	speed: 0.3315s/iter; left time: 10974.7558s
	iters: 200, epoch: 11 | loss: 0.6253008
	speed: 0.0934s/iter; left time: 3082.7313s
	iters: 300, epoch: 11 | loss: 0.0988968
	speed: 0.0889s/iter; left time: 2927.1647s
Epoch: 11 cost time: 32.700722455978394
Epoch: 11, Steps: 369 | Train Loss: 0.122 Vali Loss: 1.621 Vali Acc: 0.641 Test Loss: 1.621 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0019581
	speed: 0.3333s/iter; left time: 10911.3395s
	iters: 200, epoch: 12 | loss: 0.6903421
	speed: 0.1022s/iter; left time: 3337.5443s
	iters: 300, epoch: 12 | loss: 0.0122928
	speed: 0.0930s/iter; left time: 3026.7145s
Epoch: 12 cost time: 35.377951860427856
Epoch: 12, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.765 Vali Acc: 0.650 Test Loss: 1.765 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0808439
	speed: 0.3569s/iter; left time: 11552.4541s
	iters: 200, epoch: 13 | loss: 0.0095497
	speed: 0.1033s/iter; left time: 3332.6951s
	iters: 300, epoch: 13 | loss: 0.0156281
	speed: 0.0994s/iter; left time: 3197.4034s
Epoch: 13 cost time: 37.7336802482605
Epoch: 13, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.627 Vali Acc: 0.648 Test Loss: 1.627 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1626389
	speed: 0.3287s/iter; left time: 10518.9396s
	iters: 200, epoch: 14 | loss: 0.0014959
	speed: 0.0849s/iter; left time: 2709.3257s
	iters: 300, epoch: 14 | loss: 0.0185644
	speed: 0.0855s/iter; left time: 2719.5273s
Epoch: 14 cost time: 32.57969784736633
Epoch: 14, Steps: 369 | Train Loss: 0.097 Vali Loss: 1.945 Vali Acc: 0.643 Test Loss: 1.945 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0210508
	speed: 0.3298s/iter; left time: 10432.7065s
	iters: 200, epoch: 15 | loss: 0.0068730
	speed: 0.0754s/iter; left time: 2377.9140s
	iters: 300, epoch: 15 | loss: 0.0884312
	speed: 0.0804s/iter; left time: 2526.0821s
Epoch: 15 cost time: 30.545148611068726
Epoch: 15, Steps: 369 | Train Loss: 0.092 Vali Loss: 2.074 Vali Acc: 0.657 Test Loss: 2.074 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0155849
	speed: 0.3216s/iter; left time: 10056.0548s
	iters: 200, epoch: 16 | loss: 0.0299061
	speed: 0.0738s/iter; left time: 2300.7087s
	iters: 300, epoch: 16 | loss: 0.2187050
	speed: 0.0688s/iter; left time: 2137.1060s
Epoch: 16 cost time: 26.3805251121521
Epoch: 16, Steps: 369 | Train Loss: 0.083 Vali Loss: 2.086 Vali Acc: 0.668 Test Loss: 2.086 Test Acc: 0.668
Validation loss decreased (-0.664863 --> -0.668254).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0060226
	speed: 0.2547s/iter; left time: 7870.2340s
	iters: 200, epoch: 17 | loss: 0.1542404
	speed: 0.0808s/iter; left time: 2488.8272s
	iters: 300, epoch: 17 | loss: 0.0242432
	speed: 0.0799s/iter; left time: 2453.0359s
Epoch: 17 cost time: 31.37863564491272
Epoch: 17, Steps: 369 | Train Loss: 0.073 Vali Loss: 2.403 Vali Acc: 0.654 Test Loss: 2.403 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0662169
	speed: 0.3221s/iter; left time: 9831.5593s
	iters: 200, epoch: 18 | loss: 0.0006611
	speed: 0.0783s/iter; left time: 2383.4413s
	iters: 300, epoch: 18 | loss: 0.0574731
	speed: 0.0880s/iter; left time: 2669.5809s
Epoch: 18 cost time: 31.461133241653442
Epoch: 18, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.377 Vali Acc: 0.655 Test Loss: 2.377 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1144073
	speed: 0.3281s/iter; left time: 9896.2603s
	iters: 200, epoch: 19 | loss: 0.1145536
	speed: 0.0814s/iter; left time: 2448.1375s
	iters: 300, epoch: 19 | loss: 0.6164196
	speed: 0.0873s/iter; left time: 2615.0159s
Epoch: 19 cost time: 30.297827005386353
Epoch: 19, Steps: 369 | Train Loss: 0.067 Vali Loss: 2.570 Vali Acc: 0.642 Test Loss: 2.570 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0099759
	speed: 0.3064s/iter; left time: 9126.4858s
	iters: 200, epoch: 20 | loss: 0.0059047
	speed: 0.0860s/iter; left time: 2552.1946s
	iters: 300, epoch: 20 | loss: 0.0044306
	speed: 0.0842s/iter; left time: 2490.2434s
Epoch: 20 cost time: 30.492828845977783
Epoch: 20, Steps: 369 | Train Loss: 0.058 Vali Loss: 2.154 Vali Acc: 0.671 Test Loss: 2.154 Test Acc: 0.671
Validation loss decreased (-0.668254 --> -0.671375).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0076085
	speed: 0.3215s/iter; left time: 9458.9129s
	iters: 200, epoch: 21 | loss: 0.0026454
	speed: 0.0944s/iter; left time: 2767.0236s
	iters: 300, epoch: 21 | loss: 0.0601284
	speed: 0.0904s/iter; left time: 2641.0363s
Epoch: 21 cost time: 34.424357652664185
Epoch: 21, Steps: 369 | Train Loss: 0.066 Vali Loss: 2.144 Vali Acc: 0.660 Test Loss: 2.144 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0369115
	speed: 0.3589s/iter; left time: 10427.3991s
	iters: 200, epoch: 22 | loss: 0.0005408
	speed: 0.0922s/iter; left time: 2670.5432s
	iters: 300, epoch: 22 | loss: 0.0001111
	speed: 0.0842s/iter; left time: 2429.0803s
Epoch: 22 cost time: 34.88286304473877
Epoch: 22, Steps: 369 | Train Loss: 0.058 Vali Loss: 2.419 Vali Acc: 0.651 Test Loss: 2.419 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0020003
	speed: 0.3637s/iter; left time: 10433.1614s
	iters: 200, epoch: 23 | loss: 0.0207606
	speed: 0.0882s/iter; left time: 2521.2056s
	iters: 300, epoch: 23 | loss: 0.0254263
	speed: 0.0961s/iter; left time: 2736.4410s
Epoch: 23 cost time: 35.0556058883667
Epoch: 23, Steps: 369 | Train Loss: 0.053 Vali Loss: 2.449 Vali Acc: 0.668 Test Loss: 2.449 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.2295653
	speed: 0.3303s/iter; left time: 9353.5019s
	iters: 200, epoch: 24 | loss: 0.0488837
	speed: 0.0813s/iter; left time: 2293.1644s
	iters: 300, epoch: 24 | loss: 0.1144671
	speed: 0.0812s/iter; left time: 2282.5280s
Epoch: 24 cost time: 30.517504692077637
Epoch: 24, Steps: 369 | Train Loss: 0.054 Vali Loss: 2.407 Vali Acc: 0.654 Test Loss: 2.407 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0006656
	speed: 0.3158s/iter; left time: 8824.7442s
	iters: 200, epoch: 25 | loss: 0.0493977
	speed: 0.0871s/iter; left time: 2425.9065s
	iters: 300, epoch: 25 | loss: 0.2266027
	speed: 0.0827s/iter; left time: 2294.8859s
Epoch: 25 cost time: 30.923973083496094
Epoch: 25, Steps: 369 | Train Loss: 0.059 Vali Loss: 2.352 Vali Acc: 0.654 Test Loss: 2.352 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0016591
	speed: 0.3206s/iter; left time: 8839.5353s
	iters: 200, epoch: 26 | loss: 0.0002725
	speed: 0.0816s/iter; left time: 2242.1048s
	iters: 300, epoch: 26 | loss: 0.3843861
	speed: 0.0765s/iter; left time: 2095.1893s
Epoch: 26 cost time: 30.409329175949097
Epoch: 26, Steps: 369 | Train Loss: 0.063 Vali Loss: 2.079 Vali Acc: 0.654 Test Loss: 2.079 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0020103
	speed: 0.3274s/iter; left time: 8906.2173s
	iters: 200, epoch: 27 | loss: 0.0002538
	speed: 0.0836s/iter; left time: 2267.0911s
	iters: 300, epoch: 27 | loss: 0.0007037
	speed: 0.0864s/iter; left time: 2332.5771s
Epoch: 27 cost time: 32.936070919036865
Epoch: 27, Steps: 369 | Train Loss: 0.056 Vali Loss: 2.540 Vali Acc: 0.647 Test Loss: 2.540 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000013
	speed: 0.3212s/iter; left time: 8621.0280s
	iters: 200, epoch: 28 | loss: 0.0033134
	speed: 0.0737s/iter; left time: 1970.2797s
	iters: 300, epoch: 28 | loss: 0.0433346
	speed: 0.0871s/iter; left time: 2318.9981s
Epoch: 28 cost time: 30.321576356887817
Epoch: 28, Steps: 369 | Train Loss: 0.044 Vali Loss: 2.581 Vali Acc: 0.650 Test Loss: 2.581 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.6582307
	speed: 0.3292s/iter; left time: 8714.1977s
	iters: 200, epoch: 29 | loss: 0.0575246
	speed: 0.0907s/iter; left time: 2392.6908s
	iters: 300, epoch: 29 | loss: 0.0024093
	speed: 0.0891s/iter; left time: 2339.9112s
Epoch: 29 cost time: 32.22607088088989
Epoch: 29, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.292 Vali Acc: 0.652 Test Loss: 2.292 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0035458
	speed: 0.3145s/iter; left time: 8209.3779s
	iters: 200, epoch: 30 | loss: 0.0007414
	speed: 0.0860s/iter; left time: 2235.2592s
	iters: 300, epoch: 30 | loss: 0.0274294
	speed: 0.0775s/iter; left time: 2007.7355s
Epoch: 30 cost time: 30.83534336090088
Epoch: 30, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.438 Vali Acc: 0.658 Test Loss: 2.438 Test Acc: 0.658
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6713961407491487
model parameter : 1334554
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.7530148
	speed: 0.0722s/iter; left time: 2657.5379s
	iters: 200, epoch: 1 | loss: 0.7784600
	speed: 0.0574s/iter; left time: 2105.7578s
	iters: 300, epoch: 1 | loss: 1.2339023
	speed: 0.0815s/iter; left time: 2982.9314s
Epoch: 1 cost time: 27.645928621292114
Epoch: 1, Steps: 369 | Train Loss: 1.828 Vali Loss: 6.200 Vali Acc: 0.504 Test Loss: 6.200 Test Acc: 0.504
Validation loss decreased (inf --> -0.504195).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4148998
	speed: 0.3517s/iter; left time: 12811.6092s
	iters: 200, epoch: 2 | loss: 1.6996689
	speed: 0.0846s/iter; left time: 3075.4943s
	iters: 300, epoch: 2 | loss: 0.5555828
	speed: 0.0939s/iter; left time: 3401.1612s
Epoch: 2 cost time: 34.305179834365845
Epoch: 2, Steps: 369 | Train Loss: 1.703 Vali Loss: 2.336 Vali Acc: 0.520 Test Loss: 2.336 Test Acc: 0.520
Validation loss decreased (-0.504195 --> -0.519840).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5931287
	speed: 0.3085s/iter; left time: 11125.2350s
	iters: 200, epoch: 3 | loss: 0.8100250
	speed: 0.0839s/iter; left time: 3016.3392s
	iters: 300, epoch: 3 | loss: 0.6124657
	speed: 0.0835s/iter; left time: 2995.1778s
Epoch: 3 cost time: 31.916924953460693
Epoch: 3, Steps: 369 | Train Loss: 0.829 Vali Loss: 0.757 Vali Acc: 0.657 Test Loss: 0.757 Test Acc: 0.657
Validation loss decreased (-0.519840 --> -0.656633).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5505312
	speed: 0.3211s/iter; left time: 11460.4167s
	iters: 200, epoch: 4 | loss: 0.6986846
	speed: 0.0865s/iter; left time: 3079.6678s
	iters: 300, epoch: 4 | loss: 0.7297748
	speed: 0.0772s/iter; left time: 2740.9909s
Epoch: 4 cost time: 30.224347591400146
Epoch: 4, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.782 Vali Acc: 0.656 Test Loss: 0.782 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1831135
	speed: 0.3209s/iter; left time: 11334.8519s
	iters: 200, epoch: 5 | loss: 0.7140840
	speed: 0.0836s/iter; left time: 2944.8027s
	iters: 300, epoch: 5 | loss: 0.4761834
	speed: 0.0866s/iter; left time: 3043.3107s
Epoch: 5 cost time: 32.556496381759644
Epoch: 5, Steps: 369 | Train Loss: 0.534 Vali Loss: 0.627 Vali Acc: 0.680 Test Loss: 0.627 Test Acc: 0.680
Validation loss decreased (-0.656633 --> -0.679903).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3082247
	speed: 0.3155s/iter; left time: 11027.5593s
	iters: 200, epoch: 6 | loss: 0.1338600
	speed: 0.0740s/iter; left time: 2580.9391s
	iters: 300, epoch: 6 | loss: 0.6375600
	speed: 0.0843s/iter; left time: 2928.9975s
Epoch: 6 cost time: 30.098093032836914
Epoch: 6, Steps: 369 | Train Loss: 0.431 Vali Loss: 0.815 Vali Acc: 0.671 Test Loss: 0.815 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3529314
	speed: 0.3186s/iter; left time: 11018.7528s
	iters: 200, epoch: 7 | loss: 0.8061374
	speed: 0.0727s/iter; left time: 2505.8651s
	iters: 300, epoch: 7 | loss: 0.5815169
	speed: 0.0873s/iter; left time: 3001.8821s
Epoch: 7 cost time: 30.031381845474243
Epoch: 7, Steps: 369 | Train Loss: 0.349 Vali Loss: 0.855 Vali Acc: 0.667 Test Loss: 0.855 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3349991
	speed: 0.3125s/iter; left time: 10691.6850s
	iters: 200, epoch: 8 | loss: 0.0230397
	speed: 0.0861s/iter; left time: 2937.6147s
	iters: 300, epoch: 8 | loss: 0.1927595
	speed: 0.0835s/iter; left time: 2840.3957s
Epoch: 8 cost time: 30.87549638748169
Epoch: 8, Steps: 369 | Train Loss: 0.253 Vali Loss: 0.828 Vali Acc: 0.661 Test Loss: 0.828 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0124683
	speed: 0.3131s/iter; left time: 10597.9857s
	iters: 200, epoch: 9 | loss: 0.0213415
	speed: 0.0883s/iter; left time: 2979.0956s
	iters: 300, epoch: 9 | loss: 0.4131151
	speed: 0.0833s/iter; left time: 2804.1301s
Epoch: 9 cost time: 31.286065340042114
Epoch: 9, Steps: 369 | Train Loss: 0.195 Vali Loss: 1.138 Vali Acc: 0.664 Test Loss: 1.138 Test Acc: 0.664
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0885214
	speed: 0.3350s/iter; left time: 11216.8797s
	iters: 200, epoch: 10 | loss: 0.2510716
	speed: 0.0877s/iter; left time: 2927.8318s
	iters: 300, epoch: 10 | loss: 0.3347180
	speed: 0.0929s/iter; left time: 3091.6318s
Epoch: 10 cost time: 35.366424560546875
Epoch: 10, Steps: 369 | Train Loss: 0.168 Vali Loss: 1.241 Vali Acc: 0.657 Test Loss: 1.241 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0208984
	speed: 0.3612s/iter; left time: 11959.1411s
	iters: 200, epoch: 11 | loss: 0.1006575
	speed: 0.0880s/iter; left time: 2903.4884s
	iters: 300, epoch: 11 | loss: 0.0826264
	speed: 0.0976s/iter; left time: 3213.0030s
Epoch: 11 cost time: 35.21041488647461
Epoch: 11, Steps: 369 | Train Loss: 0.134 Vali Loss: 1.341 Vali Acc: 0.661 Test Loss: 1.341 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0290997
	speed: 0.3676s/iter; left time: 12036.3362s
	iters: 200, epoch: 12 | loss: 0.1496105
	speed: 0.0936s/iter; left time: 3056.0738s
	iters: 300, epoch: 12 | loss: 0.0060316
	speed: 0.0763s/iter; left time: 2483.7699s
Epoch: 12 cost time: 33.4964919090271
Epoch: 12, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.633 Vali Acc: 0.661 Test Loss: 1.633 Test Acc: 0.661
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.3529565
	speed: 0.3064s/iter; left time: 9920.6615s
	iters: 200, epoch: 13 | loss: 0.1906131
	speed: 0.0851s/iter; left time: 2745.5197s
	iters: 300, epoch: 13 | loss: 0.0129969
	speed: 0.0770s/iter; left time: 2476.7043s
Epoch: 13 cost time: 29.24310326576233
Epoch: 13, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.763 Vali Acc: 0.640 Test Loss: 1.763 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0502183
	speed: 0.3223s/iter; left time: 10314.2509s
	iters: 200, epoch: 14 | loss: 0.3740278
	speed: 0.0855s/iter; left time: 2728.8080s
	iters: 300, epoch: 14 | loss: 0.0155217
	speed: 0.0872s/iter; left time: 2772.6781s
Epoch: 14 cost time: 32.41378831863403
Epoch: 14, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.957 Vali Acc: 0.665 Test Loss: 1.957 Test Acc: 0.665
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1460888
	speed: 0.3086s/iter; left time: 9763.9808s
	iters: 200, epoch: 15 | loss: 0.0105846
	speed: 0.0662s/iter; left time: 2088.2687s
	iters: 300, epoch: 15 | loss: 0.0113238
	speed: 0.0822s/iter; left time: 2584.7671s
Epoch: 15 cost time: 28.481350660324097
Epoch: 15, Steps: 369 | Train Loss: 0.087 Vali Loss: 1.896 Vali Acc: 0.645 Test Loss: 1.896 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6799091940976163
model parameter : 1333786
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9596764
	speed: 0.1022s/iter; left time: 3760.0313s
	iters: 200, epoch: 1 | loss: 2.2753606
	speed: 0.0845s/iter; left time: 3102.5207s
	iters: 300, epoch: 1 | loss: 1.0759876
	speed: 0.0856s/iter; left time: 3132.5059s
Epoch: 1 cost time: 33.53988480567932
Epoch: 1, Steps: 369 | Train Loss: 1.726 Vali Loss: 6.359 Vali Acc: 0.500 Test Loss: 6.359 Test Acc: 0.500
Validation loss decreased (inf --> -0.500220).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3149297
	speed: 0.3201s/iter; left time: 11661.3734s
	iters: 200, epoch: 2 | loss: 0.2900714
	speed: 0.0745s/iter; left time: 2707.6011s
	iters: 300, epoch: 2 | loss: 0.3962903
	speed: 0.0817s/iter; left time: 2961.4700s
Epoch: 2 cost time: 30.032275438308716
Epoch: 2, Steps: 369 | Train Loss: 1.907 Vali Loss: 1.122 Vali Acc: 0.614 Test Loss: 1.122 Test Acc: 0.614
Validation loss decreased (-0.500220 --> -0.613496).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2649882
	speed: 0.3133s/iter; left time: 11296.7746s
	iters: 200, epoch: 3 | loss: 1.5038534
	speed: 0.0826s/iter; left time: 2970.4618s
	iters: 300, epoch: 3 | loss: 0.6138251
	speed: 0.0843s/iter; left time: 3023.8194s
Epoch: 3 cost time: 31.102628231048584
Epoch: 3, Steps: 369 | Train Loss: 0.990 Vali Loss: 1.485 Vali Acc: 0.525 Test Loss: 1.485 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3064305
	speed: 0.3335s/iter; left time: 11905.6495s
	iters: 200, epoch: 4 | loss: 0.4920229
	speed: 0.0706s/iter; left time: 2511.8554s
	iters: 300, epoch: 4 | loss: 0.8315129
	speed: 0.0494s/iter; left time: 1754.4159s
Epoch: 4 cost time: 24.217363595962524
Epoch: 4, Steps: 369 | Train Loss: 0.650 Vali Loss: 1.198 Vali Acc: 0.579 Test Loss: 1.198 Test Acc: 0.579
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5984769
	speed: 0.3008s/iter; left time: 10626.7203s
	iters: 200, epoch: 5 | loss: 0.3718659
	speed: 0.0901s/iter; left time: 3172.2343s
	iters: 300, epoch: 5 | loss: 0.9666821
	speed: 0.0959s/iter; left time: 3370.1669s
Epoch: 5 cost time: 33.150041341781616
Epoch: 5, Steps: 369 | Train Loss: 0.542 Vali Loss: 0.741 Vali Acc: 0.662 Test Loss: 0.741 Test Acc: 0.662
Validation loss decreased (-0.613496 --> -0.662024).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2892652
	speed: 0.3576s/iter; left time: 12500.9899s
	iters: 200, epoch: 6 | loss: 0.3822686
	speed: 0.0950s/iter; left time: 3312.8790s
	iters: 300, epoch: 6 | loss: 0.4076392
	speed: 0.0777s/iter; left time: 2699.0706s
Epoch: 6 cost time: 32.799678564071655
Epoch: 6, Steps: 369 | Train Loss: 0.430 Vali Loss: 0.736 Vali Acc: 0.664 Test Loss: 0.736 Test Acc: 0.664
Validation loss decreased (-0.662024 --> -0.663727).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0935351
	speed: 0.3185s/iter; left time: 11015.1192s
	iters: 200, epoch: 7 | loss: 0.7587039
	speed: 0.0781s/iter; left time: 2694.7178s
	iters: 300, epoch: 7 | loss: 0.4239137
	speed: 0.0751s/iter; left time: 2582.3102s
Epoch: 7 cost time: 30.49884581565857
Epoch: 7, Steps: 369 | Train Loss: 0.361 Vali Loss: 1.004 Vali Acc: 0.648 Test Loss: 1.004 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2036863
	speed: 0.3296s/iter; left time: 11278.1121s
	iters: 200, epoch: 8 | loss: 0.2499633
	speed: 0.0837s/iter; left time: 2855.2735s
	iters: 300, epoch: 8 | loss: 0.4370316
	speed: 0.0849s/iter; left time: 2889.7281s
Epoch: 8 cost time: 31.009257316589355
Epoch: 8, Steps: 369 | Train Loss: 0.274 Vali Loss: 0.921 Vali Acc: 0.649 Test Loss: 0.921 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2166384
	speed: 0.3076s/iter; left time: 10412.6363s
	iters: 200, epoch: 9 | loss: 0.0219559
	speed: 0.0809s/iter; left time: 2729.1733s
	iters: 300, epoch: 9 | loss: 0.3118013
	speed: 0.0775s/iter; left time: 2607.1423s
Epoch: 9 cost time: 29.54954957962036
Epoch: 9, Steps: 369 | Train Loss: 0.209 Vali Loss: 1.203 Vali Acc: 0.651 Test Loss: 1.203 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0550549
	speed: 0.3171s/iter; left time: 10616.1923s
	iters: 200, epoch: 10 | loss: 0.5275971
	speed: 0.0880s/iter; left time: 2937.8542s
	iters: 300, epoch: 10 | loss: 0.2119058
	speed: 0.0829s/iter; left time: 2759.8431s
Epoch: 10 cost time: 31.513205528259277
Epoch: 10, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.484 Vali Acc: 0.642 Test Loss: 1.484 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1886667
	speed: 0.3217s/iter; left time: 10652.7612s
	iters: 200, epoch: 11 | loss: 0.0100124
	speed: 0.0705s/iter; left time: 2328.6937s
	iters: 300, epoch: 11 | loss: 0.1618104
	speed: 0.0724s/iter; left time: 2381.5286s
Epoch: 11 cost time: 29.365719318389893
Epoch: 11, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.762 Vali Acc: 0.669 Test Loss: 1.762 Test Acc: 0.669
Validation loss decreased (-0.663727 --> -0.669108).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2450804
	speed: 0.3219s/iter; left time: 10540.1251s
	iters: 200, epoch: 12 | loss: 0.0613645
	speed: 0.0757s/iter; left time: 2470.8510s
	iters: 300, epoch: 12 | loss: 0.1812720
	speed: 0.0877s/iter; left time: 2853.9765s
Epoch: 12 cost time: 31.096592903137207
Epoch: 12, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.544 Vali Acc: 0.648 Test Loss: 1.544 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0029295
	speed: 0.3123s/iter; left time: 10111.3888s
	iters: 200, epoch: 13 | loss: 0.0753700
	speed: 0.0808s/iter; left time: 2607.8040s
	iters: 300, epoch: 13 | loss: 0.2291393
	speed: 0.0841s/iter; left time: 2707.2289s
Epoch: 13 cost time: 29.551987648010254
Epoch: 13, Steps: 369 | Train Loss: 0.105 Vali Loss: 2.084 Vali Acc: 0.629 Test Loss: 2.084 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0194340
	speed: 0.3285s/iter; left time: 10514.8351s
	iters: 200, epoch: 14 | loss: 0.3191611
	speed: 0.0919s/iter; left time: 2932.3160s
	iters: 300, epoch: 14 | loss: 0.0146564
	speed: 0.0907s/iter; left time: 2886.0208s
Epoch: 14 cost time: 33.335100412368774
Epoch: 14, Steps: 369 | Train Loss: 0.086 Vali Loss: 2.055 Vali Acc: 0.636 Test Loss: 2.055 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0041306
	speed: 0.3536s/iter; left time: 11187.0760s
	iters: 200, epoch: 15 | loss: 0.0006903
	speed: 0.0948s/iter; left time: 2988.8980s
	iters: 300, epoch: 15 | loss: 0.0328825
	speed: 0.0858s/iter; left time: 2697.2579s
Epoch: 15 cost time: 35.033303022384644
Epoch: 15, Steps: 369 | Train Loss: 0.086 Vali Loss: 2.178 Vali Acc: 0.644 Test Loss: 2.178 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0083477
	speed: 0.3402s/iter; left time: 10636.4272s
	iters: 200, epoch: 16 | loss: 0.0774647
	speed: 0.0814s/iter; left time: 2538.1429s
	iters: 300, epoch: 16 | loss: 0.0541898
	speed: 0.0786s/iter; left time: 2443.1246s
Epoch: 16 cost time: 30.909644603729248
Epoch: 16, Steps: 369 | Train Loss: 0.104 Vali Loss: 2.222 Vali Acc: 0.634 Test Loss: 2.222 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0756141
	speed: 0.3225s/iter; left time: 9965.6901s
	iters: 200, epoch: 17 | loss: 0.1826288
	speed: 0.0803s/iter; left time: 2471.4655s
	iters: 300, epoch: 17 | loss: 0.0395499
	speed: 0.0870s/iter; left time: 2670.8904s
Epoch: 17 cost time: 31.32414722442627
Epoch: 17, Steps: 369 | Train Loss: 0.087 Vali Loss: 2.086 Vali Acc: 0.649 Test Loss: 2.086 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0014347
	speed: 0.3107s/iter; left time: 9485.2165s
	iters: 200, epoch: 18 | loss: 0.0006347
	speed: 0.0864s/iter; left time: 2627.6093s
	iters: 300, epoch: 18 | loss: 0.0348641
	speed: 0.0843s/iter; left time: 2556.7799s
Epoch: 18 cost time: 30.03988027572632
Epoch: 18, Steps: 369 | Train Loss: 0.067 Vali Loss: 2.131 Vali Acc: 0.647 Test Loss: 2.131 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0541552
	speed: 0.3178s/iter; left time: 9584.4638s
	iters: 200, epoch: 19 | loss: 0.0050926
	speed: 0.0872s/iter; left time: 2620.6700s
	iters: 300, epoch: 19 | loss: 0.0472849
	speed: 0.0804s/iter; left time: 2407.4562s
Epoch: 19 cost time: 31.920610427856445
Epoch: 19, Steps: 369 | Train Loss: 0.057 Vali Loss: 2.636 Vali Acc: 0.640 Test Loss: 2.636 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0096951
	speed: 0.3223s/iter; left time: 9600.5900s
	iters: 200, epoch: 20 | loss: 0.0020636
	speed: 0.0736s/iter; left time: 2186.5711s
	iters: 300, epoch: 20 | loss: 0.6243095
	speed: 0.0750s/iter; left time: 2218.4654s
Epoch: 20 cost time: 29.73626136779785
Epoch: 20, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.435 Vali Acc: 0.634 Test Loss: 2.435 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0002302
	speed: 0.2753s/iter; left time: 8099.1229s
	iters: 200, epoch: 21 | loss: 0.0172786
	speed: 0.0556s/iter; left time: 1630.5889s
	iters: 300, epoch: 21 | loss: 0.0050201
	speed: 0.0657s/iter; left time: 1919.7008s
Epoch: 21 cost time: 24.048004150390625
Epoch: 21, Steps: 369 | Train Loss: 0.063 Vali Loss: 2.589 Vali Acc: 0.660 Test Loss: 2.589 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6691259931895573
model parameter : 1333018
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8520775
	speed: 0.0949s/iter; left time: 3492.5510s
	iters: 200, epoch: 1 | loss: 0.9034224
	speed: 0.0949s/iter; left time: 3483.1937s
	iters: 300, epoch: 1 | loss: 2.1592419
	speed: 0.0831s/iter; left time: 3040.9289s
Epoch: 1 cost time: 34.04086756706238
Epoch: 1, Steps: 369 | Train Loss: 1.822 Vali Loss: 2.289 Vali Acc: 0.584 Test Loss: 2.289 Test Acc: 0.584
Validation loss decreased (inf --> -0.583689).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3797503
	speed: 0.3602s/iter; left time: 13122.0004s
	iters: 200, epoch: 2 | loss: 0.2920684
	speed: 0.0939s/iter; left time: 3412.0092s
	iters: 300, epoch: 2 | loss: 2.7489665
	speed: 0.0962s/iter; left time: 3485.0050s
Epoch: 2 cost time: 36.20100474357605
Epoch: 2, Steps: 369 | Train Loss: 1.891 Vali Loss: 0.678 Vali Acc: 0.669 Test Loss: 0.678 Test Acc: 0.669
Validation loss decreased (-0.583689 --> -0.669403).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4599360
	speed: 0.3551s/iter; left time: 12807.6669s
	iters: 200, epoch: 3 | loss: 0.8506551
	speed: 0.0809s/iter; left time: 2910.4666s
	iters: 300, epoch: 3 | loss: 0.5579508
	speed: 0.0937s/iter; left time: 3360.3247s
Epoch: 3 cost time: 33.28177762031555
Epoch: 3, Steps: 369 | Train Loss: 0.922 Vali Loss: 0.932 Vali Acc: 0.527 Test Loss: 0.932 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4047281
	speed: 0.3099s/iter; left time: 11062.0895s
	iters: 200, epoch: 4 | loss: 0.6896920
	speed: 0.0782s/iter; left time: 2782.0662s
	iters: 300, epoch: 4 | loss: 0.6680688
	speed: 0.0828s/iter; left time: 2940.0994s
Epoch: 4 cost time: 28.733983516693115
Epoch: 4, Steps: 369 | Train Loss: 0.740 Vali Loss: 0.790 Vali Acc: 0.596 Test Loss: 0.790 Test Acc: 0.596
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5279608
	speed: 0.3126s/iter; left time: 11041.5089s
	iters: 200, epoch: 5 | loss: 0.3716181
	speed: 0.0762s/iter; left time: 2684.5404s
	iters: 300, epoch: 5 | loss: 0.8978252
	speed: 0.0723s/iter; left time: 2541.1931s
Epoch: 5 cost time: 29.55514359474182
Epoch: 5, Steps: 369 | Train Loss: 0.548 Vali Loss: 0.671 Vali Acc: 0.656 Test Loss: 0.671 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6763922
	speed: 0.3162s/iter; left time: 11051.3567s
	iters: 200, epoch: 6 | loss: 0.3458652
	speed: 0.0829s/iter; left time: 2891.2817s
	iters: 300, epoch: 6 | loss: 0.5756714
	speed: 0.0825s/iter; left time: 2865.7816s
Epoch: 6 cost time: 31.80822443962097
Epoch: 6, Steps: 369 | Train Loss: 0.466 Vali Loss: 0.745 Vali Acc: 0.670 Test Loss: 0.745 Test Acc: 0.670
Validation loss decreased (-0.669403 --> -0.670254).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4763385
	speed: 0.3171s/iter; left time: 10967.3547s
	iters: 200, epoch: 7 | loss: 0.3091761
	speed: 0.0762s/iter; left time: 2628.3632s
	iters: 300, epoch: 7 | loss: 0.3324603
	speed: 0.0825s/iter; left time: 2836.0504s
Epoch: 7 cost time: 30.147855520248413
Epoch: 7, Steps: 369 | Train Loss: 0.383 Vali Loss: 0.733 Vali Acc: 0.662 Test Loss: 0.733 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2622591
	speed: 0.3068s/iter; left time: 10496.7111s
	iters: 200, epoch: 8 | loss: 0.2521373
	speed: 0.0829s/iter; left time: 2826.7372s
	iters: 300, epoch: 8 | loss: 0.2705560
	speed: 0.0856s/iter; left time: 2910.8220s
Epoch: 8 cost time: 31.29303550720215
Epoch: 8, Steps: 369 | Train Loss: 0.299 Vali Loss: 0.864 Vali Acc: 0.654 Test Loss: 0.864 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1466258
	speed: 0.3171s/iter; left time: 10733.7493s
	iters: 200, epoch: 9 | loss: 0.0257085
	speed: 0.0796s/iter; left time: 2687.0663s
	iters: 300, epoch: 9 | loss: 0.1315873
	speed: 0.0776s/iter; left time: 2609.5021s
Epoch: 9 cost time: 30.384894371032715
Epoch: 9, Steps: 369 | Train Loss: 0.224 Vali Loss: 1.091 Vali Acc: 0.648 Test Loss: 1.091 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0949689
	speed: 0.3200s/iter; left time: 10712.5299s
	iters: 200, epoch: 10 | loss: 0.0835963
	speed: 0.0818s/iter; left time: 2728.8293s
	iters: 300, epoch: 10 | loss: 0.0919374
	speed: 0.0833s/iter; left time: 2771.6982s
Epoch: 10 cost time: 31.978362798690796
Epoch: 10, Steps: 369 | Train Loss: 0.162 Vali Loss: 1.528 Vali Acc: 0.628 Test Loss: 1.528 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1164785
	speed: 0.3384s/iter; left time: 11206.0024s
	iters: 200, epoch: 11 | loss: 0.2246182
	speed: 0.0858s/iter; left time: 2832.6982s
	iters: 300, epoch: 11 | loss: 0.1501213
	speed: 0.0919s/iter; left time: 3023.3095s
Epoch: 11 cost time: 34.07493352890015
Epoch: 11, Steps: 369 | Train Loss: 0.158 Vali Loss: 1.503 Vali Acc: 0.645 Test Loss: 1.503 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0361115
	speed: 0.3370s/iter; left time: 11034.2603s
	iters: 200, epoch: 12 | loss: 0.0693876
	speed: 0.0978s/iter; left time: 3192.3960s
	iters: 300, epoch: 12 | loss: 0.1666816
	speed: 0.0966s/iter; left time: 3144.2159s
Epoch: 12 cost time: 34.881789684295654
Epoch: 12, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.592 Vali Acc: 0.655 Test Loss: 1.592 Test Acc: 0.655
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.3675214
	speed: 0.3480s/iter; left time: 11266.9282s
	iters: 200, epoch: 13 | loss: 0.0447720
	speed: 0.0848s/iter; left time: 2735.3374s
	iters: 300, epoch: 13 | loss: 0.0096241
	speed: 0.0799s/iter; left time: 2569.9142s
Epoch: 13 cost time: 29.97245979309082
Epoch: 13, Steps: 369 | Train Loss: 0.110 Vali Loss: 1.709 Vali Acc: 0.637 Test Loss: 1.709 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0145897
	speed: 0.2197s/iter; left time: 7031.6193s
	iters: 200, epoch: 14 | loss: 0.0258645
	speed: 0.0622s/iter; left time: 1983.3869s
	iters: 300, epoch: 14 | loss: 0.0818715
	speed: 0.0863s/iter; left time: 2744.9671s
Epoch: 14 cost time: 25.69885778427124
Epoch: 14, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.783 Vali Acc: 0.643 Test Loss: 1.783 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1321829
	speed: 0.2839s/iter; left time: 8981.7773s
	iters: 200, epoch: 15 | loss: 0.0041272
	speed: 0.0722s/iter; left time: 2276.1029s
	iters: 300, epoch: 15 | loss: 0.0286794
	speed: 0.0700s/iter; left time: 2201.3374s
Epoch: 15 cost time: 26.170565128326416
Epoch: 15, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.811 Vali Acc: 0.656 Test Loss: 1.811 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.1291891
	speed: 0.2969s/iter; left time: 9282.8178s
	iters: 200, epoch: 16 | loss: 0.0006766
	speed: 0.0752s/iter; left time: 2344.9462s
	iters: 300, epoch: 16 | loss: 0.0446054
	speed: 0.0701s/iter; left time: 2178.7275s
Epoch: 16 cost time: 28.746057748794556
Epoch: 16, Steps: 369 | Train Loss: 0.083 Vali Loss: 1.957 Vali Acc: 0.646 Test Loss: 1.957 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6702610669693531
model parameter : 1332250
model size : 7.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 3.5723672
	speed: 0.0955s/iter; left time: 3513.3910s
	iters: 200, epoch: 1 | loss: 0.9095240
	speed: 0.0815s/iter; left time: 2991.1247s
	iters: 300, epoch: 1 | loss: 1.9279369
	speed: 0.0724s/iter; left time: 2648.7778s
Epoch: 1 cost time: 29.737597703933716
Epoch: 1, Steps: 369 | Train Loss: 1.904 Vali Loss: 2.446 Vali Acc: 0.563 Test Loss: 2.446 Test Acc: 0.563
Validation loss decreased (inf --> -0.562972).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7539577
	speed: 0.3014s/iter; left time: 10981.2197s
	iters: 200, epoch: 2 | loss: 3.3637133
	speed: 0.0730s/iter; left time: 2653.2111s
	iters: 300, epoch: 2 | loss: 0.5241503
	speed: 0.0751s/iter; left time: 2720.1703s
Epoch: 2 cost time: 29.633069276809692
Epoch: 2, Steps: 369 | Train Loss: 2.364 Vali Loss: 1.246 Vali Acc: 0.547 Test Loss: 1.246 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8028995
	speed: 0.3027s/iter; left time: 10915.6763s
	iters: 200, epoch: 3 | loss: 1.2199029
	speed: 0.0727s/iter; left time: 2614.0563s
	iters: 300, epoch: 3 | loss: 1.2048265
	speed: 0.0802s/iter; left time: 2876.3126s
Epoch: 3 cost time: 28.55752682685852
Epoch: 3, Steps: 369 | Train Loss: 0.867 Vali Loss: 1.126 Vali Acc: 0.540 Test Loss: 1.126 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4650882
	speed: 0.3187s/iter; left time: 11374.3459s
	iters: 200, epoch: 4 | loss: 0.5789278
	speed: 0.0864s/iter; left time: 3077.0760s
	iters: 300, epoch: 4 | loss: 0.5513076
	speed: 0.0912s/iter; left time: 3236.5566s
Epoch: 4 cost time: 33.56980299949646
Epoch: 4, Steps: 369 | Train Loss: 0.672 Vali Loss: 0.730 Vali Acc: 0.635 Test Loss: 0.730 Test Acc: 0.635
Validation loss decreased (-0.562972 --> -0.634783).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6048751
	speed: 0.3445s/iter; left time: 12168.4687s
	iters: 200, epoch: 5 | loss: 0.4706647
	speed: 0.0858s/iter; left time: 3020.6452s
	iters: 300, epoch: 5 | loss: 0.6107471
	speed: 0.0803s/iter; left time: 2820.6660s
Epoch: 5 cost time: 31.693961143493652
Epoch: 5, Steps: 369 | Train Loss: 0.506 Vali Loss: 0.681 Vali Acc: 0.664 Test Loss: 0.681 Test Acc: 0.664
Validation loss decreased (-0.634783 --> -0.664011).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3212886
	speed: 0.3209s/iter; left time: 11216.9306s
	iters: 200, epoch: 6 | loss: 0.6131171
	speed: 0.0710s/iter; left time: 2473.9612s
	iters: 300, epoch: 6 | loss: 0.3989321
	speed: 0.0803s/iter; left time: 2790.1785s
Epoch: 6 cost time: 29.538745880126953
Epoch: 6, Steps: 369 | Train Loss: 0.416 Vali Loss: 0.764 Vali Acc: 0.669 Test Loss: 0.764 Test Acc: 0.669
Validation loss decreased (-0.664011 --> -0.669402).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3004710
	speed: 0.2987s/iter; left time: 10331.3971s
	iters: 200, epoch: 7 | loss: 0.4764860
	speed: 0.0684s/iter; left time: 2357.5476s
	iters: 300, epoch: 7 | loss: 0.2815577
	speed: 0.0818s/iter; left time: 2811.5163s
Epoch: 7 cost time: 28.12991714477539
Epoch: 7, Steps: 369 | Train Loss: 0.348 Vali Loss: 0.884 Vali Acc: 0.640 Test Loss: 0.884 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1250818
	speed: 0.2904s/iter; left time: 9938.5870s
	iters: 200, epoch: 8 | loss: 0.4387490
	speed: 0.0755s/iter; left time: 2575.1040s
	iters: 300, epoch: 8 | loss: 0.1985308
	speed: 0.0810s/iter; left time: 2756.6833s
Epoch: 8 cost time: 28.92859172821045
Epoch: 8, Steps: 369 | Train Loss: 0.272 Vali Loss: 0.947 Vali Acc: 0.659 Test Loss: 0.947 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1074876
	speed: 0.2917s/iter; left time: 9873.3939s
	iters: 200, epoch: 9 | loss: 0.2822310
	speed: 0.0817s/iter; left time: 2755.6115s
	iters: 300, epoch: 9 | loss: 0.1482660
	speed: 0.0756s/iter; left time: 2544.3635s
Epoch: 9 cost time: 28.679993152618408
Epoch: 9, Steps: 369 | Train Loss: 0.199 Vali Loss: 1.078 Vali Acc: 0.649 Test Loss: 1.078 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4203092
	speed: 0.3059s/iter; left time: 10242.5094s
	iters: 200, epoch: 10 | loss: 0.2471623
	speed: 0.0689s/iter; left time: 2298.9328s
	iters: 300, epoch: 10 | loss: 0.2813744
	speed: 0.0753s/iter; left time: 2505.7595s
Epoch: 10 cost time: 28.91898465156555
Epoch: 10, Steps: 369 | Train Loss: 0.165 Vali Loss: 1.300 Vali Acc: 0.648 Test Loss: 1.300 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3997171
	speed: 0.3099s/iter; left time: 10262.5597s
	iters: 200, epoch: 11 | loss: 0.0496223
	speed: 0.0734s/iter; left time: 2421.5189s
	iters: 300, epoch: 11 | loss: 0.0577704
	speed: 0.0824s/iter; left time: 2710.9667s
Epoch: 11 cost time: 29.87259292602539
Epoch: 11, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.313 Vali Acc: 0.654 Test Loss: 1.313 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0008213
	speed: 0.3035s/iter; left time: 9937.0268s
	iters: 200, epoch: 12 | loss: 0.4809507
	speed: 0.0810s/iter; left time: 2644.7469s
	iters: 300, epoch: 12 | loss: 0.3789130
	speed: 0.0739s/iter; left time: 2404.6277s
Epoch: 12 cost time: 28.677388668060303
Epoch: 12, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.311 Vali Acc: 0.663 Test Loss: 1.311 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1282496
	speed: 0.3042s/iter; left time: 9848.3350s
	iters: 200, epoch: 13 | loss: 0.0307011
	speed: 0.0799s/iter; left time: 2577.2192s
	iters: 300, epoch: 13 | loss: 0.0321155
	speed: 0.0910s/iter; left time: 2926.8136s
Epoch: 13 cost time: 31.532861948013306
Epoch: 13, Steps: 369 | Train Loss: 0.097 Vali Loss: 1.856 Vali Acc: 0.665 Test Loss: 1.856 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0040094
	speed: 0.3372s/iter; left time: 10791.9262s
	iters: 200, epoch: 14 | loss: 0.1268176
	speed: 0.0822s/iter; left time: 2621.0586s
	iters: 300, epoch: 14 | loss: 0.0016572
	speed: 0.0866s/iter; left time: 2754.5145s
Epoch: 14 cost time: 31.214593648910522
Epoch: 14, Steps: 369 | Train Loss: 0.096 Vali Loss: 2.339 Vali Acc: 0.646 Test Loss: 2.339 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0241408
	speed: 0.3129s/iter; left time: 9899.0004s
	iters: 200, epoch: 15 | loss: 0.4192510
	speed: 0.0631s/iter; left time: 1988.5578s
	iters: 300, epoch: 15 | loss: 0.0088856
	speed: 0.0466s/iter; left time: 1464.0492s
Epoch: 15 cost time: 23.085536003112793
Epoch: 15, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.771 Vali Acc: 0.650 Test Loss: 1.771 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0143024
	speed: 0.2735s/iter; left time: 8550.7597s
	iters: 200, epoch: 16 | loss: 0.0450071
	speed: 0.0849s/iter; left time: 2647.0197s
	iters: 300, epoch: 16 | loss: 0.0117735
	speed: 0.0797s/iter; left time: 2475.5400s
Epoch: 16 cost time: 30.156127214431763
Epoch: 16, Steps: 369 | Train Loss: 0.075 Vali Loss: 1.719 Vali Acc: 0.648 Test Loss: 1.719 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6694097616345063
model parameter : 1235866
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.5247710
	speed: 0.0989s/iter; left time: 3638.3000s
	iters: 200, epoch: 1 | loss: 4.9201403
	speed: 0.0778s/iter; left time: 2855.6909s
	iters: 300, epoch: 1 | loss: 2.1385398
	speed: 0.0839s/iter; left time: 3069.1055s
Epoch: 1 cost time: 31.898956298828125
Epoch: 1, Steps: 369 | Train Loss: 1.987 Vali Loss: 1.450 Vali Acc: 0.641 Test Loss: 1.450 Test Acc: 0.641
Validation loss decreased (inf --> -0.640735).  Saving model ...
	iters: 100, epoch: 2 | loss: 6.7168012
	speed: 0.2993s/iter; left time: 10902.7228s
	iters: 200, epoch: 2 | loss: 1.2103993
	speed: 0.0809s/iter; left time: 2939.9789s
	iters: 300, epoch: 2 | loss: 0.7072880
	speed: 0.0785s/iter; left time: 2844.2362s
Epoch: 2 cost time: 28.872706174850464
Epoch: 2, Steps: 369 | Train Loss: 1.642 Vali Loss: 0.842 Vali Acc: 0.654 Test Loss: 0.842 Test Acc: 0.654
Validation loss decreased (-0.640735 --> -0.654078).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2213420
	speed: 0.2983s/iter; left time: 10756.1131s
	iters: 200, epoch: 3 | loss: 1.5517422
	speed: 0.0801s/iter; left time: 2880.6516s
	iters: 300, epoch: 3 | loss: 0.6743987
	speed: 0.0806s/iter; left time: 2888.7685s
Epoch: 3 cost time: 30.141674041748047
Epoch: 3, Steps: 369 | Train Loss: 0.844 Vali Loss: 0.873 Vali Acc: 0.595 Test Loss: 0.873 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8700262
	speed: 0.3066s/iter; left time: 10945.3749s
	iters: 200, epoch: 4 | loss: 0.9455208
	speed: 0.0763s/iter; left time: 2715.7593s
	iters: 300, epoch: 4 | loss: 0.7082766
	speed: 0.0796s/iter; left time: 2825.8346s
Epoch: 4 cost time: 30.020210027694702
Epoch: 4, Steps: 369 | Train Loss: 0.621 Vali Loss: 1.187 Vali Acc: 0.533 Test Loss: 1.187 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2668295
	speed: 0.3110s/iter; left time: 10985.5740s
	iters: 200, epoch: 5 | loss: 0.6418769
	speed: 0.0779s/iter; left time: 2744.5928s
	iters: 300, epoch: 5 | loss: 0.4556248
	speed: 0.0839s/iter; left time: 2948.0833s
Epoch: 5 cost time: 30.257508754730225
Epoch: 5, Steps: 369 | Train Loss: 0.524 Vali Loss: 0.654 Vali Acc: 0.667 Test Loss: 0.654 Test Acc: 0.667
Validation loss decreased (-0.654078 --> -0.667133).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1744778
	speed: 0.3038s/iter; left time: 10618.5159s
	iters: 200, epoch: 6 | loss: 0.2893012
	speed: 0.0827s/iter; left time: 2882.4745s
	iters: 300, epoch: 6 | loss: 0.7847088
	speed: 0.0741s/iter; left time: 2574.3837s
Epoch: 6 cost time: 30.189687967300415
Epoch: 6, Steps: 369 | Train Loss: 0.427 Vali Loss: 0.795 Vali Acc: 0.663 Test Loss: 0.795 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4034317
	speed: 0.3437s/iter; left time: 11887.1781s
	iters: 200, epoch: 7 | loss: 0.4179580
	speed: 0.0806s/iter; left time: 2780.0011s
	iters: 300, epoch: 7 | loss: 0.1715009
	speed: 0.0724s/iter; left time: 2489.4574s
Epoch: 7 cost time: 31.922581434249878
Epoch: 7, Steps: 369 | Train Loss: 0.339 Vali Loss: 0.913 Vali Acc: 0.643 Test Loss: 0.913 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3477347
	speed: 0.3567s/iter; left time: 12207.0472s
	iters: 200, epoch: 8 | loss: 0.3623199
	speed: 0.0913s/iter; left time: 3115.1687s
	iters: 300, epoch: 8 | loss: 0.1897349
	speed: 0.0903s/iter; left time: 3072.5912s
Epoch: 8 cost time: 34.28669214248657
Epoch: 8, Steps: 369 | Train Loss: 0.279 Vali Loss: 1.061 Vali Acc: 0.635 Test Loss: 1.061 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1887190
	speed: 0.3164s/iter; left time: 10710.9836s
	iters: 200, epoch: 9 | loss: 0.1293474
	speed: 0.0802s/iter; left time: 2707.1450s
	iters: 300, epoch: 9 | loss: 0.0826958
	speed: 0.0760s/iter; left time: 2556.5733s
Epoch: 9 cost time: 28.72460436820984
Epoch: 9, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.196 Vali Acc: 0.661 Test Loss: 1.196 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0837844
	speed: 0.3056s/iter; left time: 10232.5626s
	iters: 200, epoch: 10 | loss: 0.0585652
	speed: 0.0821s/iter; left time: 2740.1335s
	iters: 300, epoch: 10 | loss: 0.1877525
	speed: 0.0755s/iter; left time: 2511.1172s
Epoch: 10 cost time: 30.08674931526184
Epoch: 10, Steps: 369 | Train Loss: 0.154 Vali Loss: 1.466 Vali Acc: 0.653 Test Loss: 1.466 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1382036
	speed: 0.3073s/iter; left time: 10173.4233s
	iters: 200, epoch: 11 | loss: 0.0234777
	speed: 0.0694s/iter; left time: 2291.0756s
	iters: 300, epoch: 11 | loss: 0.0064027
	speed: 0.0766s/iter; left time: 2521.1330s
Epoch: 11 cost time: 29.265080451965332
Epoch: 11, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.437 Vali Acc: 0.660 Test Loss: 1.437 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0840502
	speed: 0.3135s/iter; left time: 10265.0171s
	iters: 200, epoch: 12 | loss: 0.1772554
	speed: 0.0700s/iter; left time: 2284.6890s
	iters: 300, epoch: 12 | loss: 0.0024052
	speed: 0.0793s/iter; left time: 2581.6577s
Epoch: 12 cost time: 28.899176359176636
Epoch: 12, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.868 Vali Acc: 0.647 Test Loss: 1.868 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0003407
	speed: 0.2507s/iter; left time: 8115.1518s
	iters: 200, epoch: 13 | loss: 0.0565921
	speed: 0.0451s/iter; left time: 1455.5101s
	iters: 300, epoch: 13 | loss: 0.0713036
	speed: 0.0517s/iter; left time: 1663.5169s
Epoch: 13 cost time: 20.96744132041931
Epoch: 13, Steps: 369 | Train Loss: 0.093 Vali Loss: 1.850 Vali Acc: 0.663 Test Loss: 1.850 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0536866
	speed: 0.3103s/iter; left time: 9930.8972s
	iters: 200, epoch: 14 | loss: 0.0828499
	speed: 0.0780s/iter; left time: 2487.0559s
	iters: 300, epoch: 14 | loss: 0.1000402
	speed: 0.0828s/iter; left time: 2633.2643s
Epoch: 14 cost time: 30.058997869491577
Epoch: 14, Steps: 369 | Train Loss: 0.096 Vali Loss: 2.106 Vali Acc: 0.661 Test Loss: 2.106 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0036810
	speed: 0.2940s/iter; left time: 9301.5144s
	iters: 200, epoch: 15 | loss: 0.0305050
	speed: 0.0762s/iter; left time: 2403.9807s
	iters: 300, epoch: 15 | loss: 0.0823733
	speed: 0.0788s/iter; left time: 2476.5744s
Epoch: 15 cost time: 28.21349000930786
Epoch: 15, Steps: 369 | Train Loss: 0.091 Vali Loss: 2.015 Vali Acc: 0.648 Test Loss: 2.015 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6671396140749148
model parameter : 1235098
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.3315377
	speed: 0.1080s/iter; left time: 3973.3642s
	iters: 200, epoch: 1 | loss: 2.2062130
	speed: 0.0890s/iter; left time: 3267.7276s
	iters: 300, epoch: 1 | loss: 1.3962719
	speed: 0.0873s/iter; left time: 3196.4263s
Epoch: 1 cost time: 33.797847270965576
Epoch: 1, Steps: 369 | Train Loss: 1.889 Vali Loss: 2.385 Vali Acc: 0.583 Test Loss: 2.385 Test Acc: 0.583
Validation loss decreased (inf --> -0.583120).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7217834
	speed: 0.3172s/iter; left time: 11557.1491s
	iters: 200, epoch: 2 | loss: 5.6537495
	speed: 0.0832s/iter; left time: 3024.1490s
	iters: 300, epoch: 2 | loss: 2.3543074
	speed: 0.0899s/iter; left time: 3255.9334s
Epoch: 2 cost time: 31.941280364990234
Epoch: 2, Steps: 369 | Train Loss: 2.257 Vali Loss: 1.004 Vali Acc: 0.600 Test Loss: 1.004 Test Acc: 0.600
Validation loss decreased (-0.583120 --> -0.600444).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6957569
	speed: 0.3445s/iter; left time: 12424.9621s
	iters: 200, epoch: 3 | loss: 0.7588195
	speed: 0.0972s/iter; left time: 3497.2886s
	iters: 300, epoch: 3 | loss: 0.7398824
	speed: 0.0938s/iter; left time: 3364.0633s
Epoch: 3 cost time: 35.923569440841675
Epoch: 3, Steps: 369 | Train Loss: 0.952 Vali Loss: 1.293 Vali Acc: 0.527 Test Loss: 1.293 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6617112
	speed: 0.2926s/iter; left time: 10443.6679s
	iters: 200, epoch: 4 | loss: 0.5519045
	speed: 0.0691s/iter; left time: 2459.9770s
	iters: 300, epoch: 4 | loss: 0.3464495
	speed: 0.0740s/iter; left time: 2627.1155s
Epoch: 4 cost time: 27.514302253723145
Epoch: 4, Steps: 369 | Train Loss: 0.667 Vali Loss: 0.741 Vali Acc: 0.626 Test Loss: 0.741 Test Acc: 0.626
Validation loss decreased (-0.600444 --> -0.625986).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3748131
	speed: 0.3027s/iter; left time: 10691.2693s
	iters: 200, epoch: 5 | loss: 0.3935465
	speed: 0.0773s/iter; left time: 2723.2115s
	iters: 300, epoch: 5 | loss: 0.3994038
	speed: 0.0765s/iter; left time: 2687.7484s
Epoch: 5 cost time: 28.95373249053955
Epoch: 5, Steps: 369 | Train Loss: 0.523 Vali Loss: 0.634 Vali Acc: 0.673 Test Loss: 0.634 Test Acc: 0.673
Validation loss decreased (-0.625986 --> -0.672525).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3347942
	speed: 0.2930s/iter; left time: 10241.6759s
	iters: 200, epoch: 6 | loss: 0.5856498
	speed: 0.0788s/iter; left time: 2746.2239s
	iters: 300, epoch: 6 | loss: 0.3676848
	speed: 0.0715s/iter; left time: 2485.8269s
Epoch: 6 cost time: 27.5826632976532
Epoch: 6, Steps: 369 | Train Loss: 0.440 Vali Loss: 0.754 Vali Acc: 0.666 Test Loss: 0.754 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1384679
	speed: 0.3011s/iter; left time: 10415.1026s
	iters: 200, epoch: 7 | loss: 0.1888969
	speed: 0.0804s/iter; left time: 2773.6004s
	iters: 300, epoch: 7 | loss: 0.4657901
	speed: 0.0779s/iter; left time: 2677.7385s
Epoch: 7 cost time: 30.371692657470703
Epoch: 7, Steps: 369 | Train Loss: 0.353 Vali Loss: 0.814 Vali Acc: 0.656 Test Loss: 0.814 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1839314
	speed: 0.2984s/iter; left time: 10210.0544s
	iters: 200, epoch: 8 | loss: 0.2190796
	speed: 0.0779s/iter; left time: 2656.8392s
	iters: 300, epoch: 8 | loss: 0.1441347
	speed: 0.0771s/iter; left time: 2621.3694s
Epoch: 8 cost time: 27.722564697265625
Epoch: 8, Steps: 369 | Train Loss: 0.270 Vali Loss: 0.944 Vali Acc: 0.660 Test Loss: 0.944 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1109111
	speed: 0.2390s/iter; left time: 8090.1017s
	iters: 200, epoch: 9 | loss: 0.1159914
	speed: 0.0472s/iter; left time: 1594.2781s
	iters: 300, epoch: 9 | loss: 0.3433671
	speed: 0.0770s/iter; left time: 2592.5349s
Epoch: 9 cost time: 23.44873571395874
Epoch: 9, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.143 Vali Acc: 0.647 Test Loss: 1.143 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1869096
	speed: 0.3036s/iter; left time: 10163.2395s
	iters: 200, epoch: 10 | loss: 0.0796858
	speed: 0.0745s/iter; left time: 2487.4899s
	iters: 300, epoch: 10 | loss: 0.0465097
	speed: 0.0773s/iter; left time: 2573.5161s
Epoch: 10 cost time: 28.383399963378906
Epoch: 10, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.607 Vali Acc: 0.643 Test Loss: 1.607 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1318362
	speed: 0.3123s/iter; left time: 10340.7039s
	iters: 200, epoch: 11 | loss: 0.4344703
	speed: 0.0871s/iter; left time: 2876.0523s
	iters: 300, epoch: 11 | loss: 0.0353340
	speed: 0.0809s/iter; left time: 2661.9845s
Epoch: 11 cost time: 32.72034192085266
Epoch: 11, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.728 Vali Acc: 0.648 Test Loss: 1.728 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0108768
	speed: 0.3393s/iter; left time: 11110.8323s
	iters: 200, epoch: 12 | loss: 0.1856962
	speed: 0.0770s/iter; left time: 2513.0314s
	iters: 300, epoch: 12 | loss: 0.0098446
	speed: 0.0803s/iter; left time: 2612.4681s
Epoch: 12 cost time: 31.409764528274536
Epoch: 12, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.654 Vali Acc: 0.654 Test Loss: 1.654 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.3518888
	speed: 0.3263s/iter; left time: 10563.2135s
	iters: 200, epoch: 13 | loss: 0.2121951
	speed: 0.0846s/iter; left time: 2730.4946s
	iters: 300, epoch: 13 | loss: 0.0201669
	speed: 0.0786s/iter; left time: 2527.4628s
Epoch: 13 cost time: 30.615644216537476
Epoch: 13, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.835 Vali Acc: 0.641 Test Loss: 1.835 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1491368
	speed: 0.2918s/iter; left time: 9338.7878s
	iters: 200, epoch: 14 | loss: 0.0057192
	speed: 0.0789s/iter; left time: 2515.7613s
	iters: 300, epoch: 14 | loss: 0.1455089
	speed: 0.0732s/iter; left time: 2327.8325s
Epoch: 14 cost time: 28.150732040405273
Epoch: 14, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.709 Vali Acc: 0.644 Test Loss: 1.709 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.2022824
	speed: 0.3058s/iter; left time: 9673.5476s
	iters: 200, epoch: 15 | loss: 0.0557853
	speed: 0.0699s/iter; left time: 2203.0732s
	iters: 300, epoch: 15 | loss: 0.0037382
	speed: 0.0716s/iter; left time: 2251.4189s
Epoch: 15 cost time: 28.24428105354309
Epoch: 15, Steps: 369 | Train Loss: 0.092 Vali Loss: 2.109 Vali Acc: 0.648 Test Loss: 2.109 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6725312145289444
model parameter : 1234330
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2843421
	speed: 0.0862s/iter; left time: 3173.5795s
	iters: 200, epoch: 1 | loss: 0.9867889
	speed: 0.0764s/iter; left time: 2803.1712s
	iters: 300, epoch: 1 | loss: 0.6179317
	speed: 0.0676s/iter; left time: 2473.2498s
Epoch: 1 cost time: 28.720603466033936
Epoch: 1, Steps: 369 | Train Loss: 1.771 Vali Loss: 7.524 Vali Acc: 0.502 Test Loss: 7.524 Test Acc: 0.502
Validation loss decreased (inf --> -0.501911).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.1777952
	speed: 0.3196s/iter; left time: 11642.0190s
	iters: 200, epoch: 2 | loss: 0.7244835
	speed: 0.0742s/iter; left time: 2694.9661s
	iters: 300, epoch: 2 | loss: 0.3472437
	speed: 0.0851s/iter; left time: 3083.0365s
Epoch: 2 cost time: 30.56694507598877
Epoch: 2, Steps: 369 | Train Loss: 1.719 Vali Loss: 1.235 Vali Acc: 0.531 Test Loss: 1.235 Test Acc: 0.531
Validation loss decreased (-0.501911 --> -0.530635).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3530807
	speed: 0.3010s/iter; left time: 10854.2691s
	iters: 200, epoch: 3 | loss: 0.6228608
	speed: 0.0779s/iter; left time: 2801.0306s
	iters: 300, epoch: 3 | loss: 0.4943308
	speed: 0.0749s/iter; left time: 2684.7793s
Epoch: 3 cost time: 27.62930417060852
Epoch: 3, Steps: 369 | Train Loss: 0.826 Vali Loss: 1.126 Vali Acc: 0.559 Test Loss: 1.126 Test Acc: 0.559
Validation loss decreased (-0.530635 --> -0.558729).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5888236
	speed: 0.2913s/iter; left time: 10396.9063s
	iters: 200, epoch: 4 | loss: 0.3405498
	speed: 0.0864s/iter; left time: 3074.9521s
	iters: 300, epoch: 4 | loss: 0.7116331
	speed: 0.0713s/iter; left time: 2530.1546s
Epoch: 4 cost time: 29.23850679397583
Epoch: 4, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.674 Vali Acc: 0.667 Test Loss: 0.674 Test Acc: 0.667
Validation loss decreased (-0.558729 --> -0.667133).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6736437
	speed: 0.3325s/iter; left time: 11745.5154s
	iters: 200, epoch: 5 | loss: 0.3584264
	speed: 0.0725s/iter; left time: 2552.9158s
	iters: 300, epoch: 5 | loss: 0.3116516
	speed: 0.0737s/iter; left time: 2590.4139s
Epoch: 5 cost time: 31.047377109527588
Epoch: 5, Steps: 369 | Train Loss: 0.539 Vali Loss: 0.690 Vali Acc: 0.656 Test Loss: 0.690 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2170407
	speed: 0.3297s/iter; left time: 11523.6452s
	iters: 200, epoch: 6 | loss: 0.3062382
	speed: 0.0782s/iter; left time: 2725.6902s
	iters: 300, epoch: 6 | loss: 0.3551397
	speed: 0.0936s/iter; left time: 3252.8607s
Epoch: 6 cost time: 31.737494468688965
Epoch: 6, Steps: 369 | Train Loss: 0.461 Vali Loss: 0.769 Vali Acc: 0.656 Test Loss: 0.769 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.5782298
	speed: 0.3273s/iter; left time: 11321.8802s
	iters: 200, epoch: 7 | loss: 0.4314325
	speed: 0.0783s/iter; left time: 2700.0226s
	iters: 300, epoch: 7 | loss: 0.5371302
	speed: 0.0731s/iter; left time: 2515.3983s
Epoch: 7 cost time: 28.76298999786377
Epoch: 7, Steps: 369 | Train Loss: 0.376 Vali Loss: 0.774 Vali Acc: 0.659 Test Loss: 0.774 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4163994
	speed: 0.2985s/iter; left time: 10215.1016s
	iters: 200, epoch: 8 | loss: 0.4581932
	speed: 0.0800s/iter; left time: 2730.4234s
	iters: 300, epoch: 8 | loss: 0.5286672
	speed: 0.0638s/iter; left time: 2170.4407s
Epoch: 8 cost time: 27.49637269973755
Epoch: 8, Steps: 369 | Train Loss: 0.280 Vali Loss: 1.298 Vali Acc: 0.633 Test Loss: 1.298 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.2536703
	speed: 0.3024s/iter; left time: 10234.3495s
	iters: 200, epoch: 9 | loss: 0.0578236
	speed: 0.0747s/iter; left time: 2521.6111s
	iters: 300, epoch: 9 | loss: 0.3597977
	speed: 0.0714s/iter; left time: 2402.3732s
Epoch: 9 cost time: 28.219098567962646
Epoch: 9, Steps: 369 | Train Loss: 0.210 Vali Loss: 1.213 Vali Acc: 0.650 Test Loss: 1.213 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0755083
	speed: 0.2194s/iter; left time: 7345.4905s
	iters: 200, epoch: 10 | loss: 0.1704635
	speed: 0.0508s/iter; left time: 1696.1337s
	iters: 300, epoch: 10 | loss: 0.0617396
	speed: 0.0811s/iter; left time: 2698.9590s
Epoch: 10 cost time: 23.191898345947266
Epoch: 10, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.236 Vali Acc: 0.644 Test Loss: 1.236 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1922790
	speed: 0.2970s/iter; left time: 9834.3793s
	iters: 200, epoch: 11 | loss: 0.0553007
	speed: 0.0859s/iter; left time: 2834.5943s
	iters: 300, epoch: 11 | loss: 0.0356277
	speed: 0.0729s/iter; left time: 2398.0307s
Epoch: 11 cost time: 28.124893188476562
Epoch: 11, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.619 Vali Acc: 0.662 Test Loss: 1.619 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0260724
	speed: 0.2958s/iter; left time: 9686.2840s
	iters: 200, epoch: 12 | loss: 0.0073429
	speed: 0.0724s/iter; left time: 2363.9587s
	iters: 300, epoch: 12 | loss: 0.0692153
	speed: 0.0687s/iter; left time: 2236.4980s
Epoch: 12 cost time: 28.40584421157837
Epoch: 12, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.672 Vali Acc: 0.656 Test Loss: 1.672 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.2701124
	speed: 0.3101s/iter; left time: 10037.9919s
	iters: 200, epoch: 13 | loss: 0.0015146
	speed: 0.0702s/iter; left time: 2265.7187s
	iters: 300, epoch: 13 | loss: 0.3686394
	speed: 0.0774s/iter; left time: 2490.1718s
Epoch: 13 cost time: 28.55372643470764
Epoch: 13, Steps: 369 | Train Loss: 0.092 Vali Loss: 1.880 Vali Acc: 0.646 Test Loss: 1.880 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1918489
	speed: 0.2843s/iter; left time: 9099.8358s
	iters: 200, epoch: 14 | loss: 0.0509549
	speed: 0.0837s/iter; left time: 2670.9388s
	iters: 300, epoch: 14 | loss: 0.2437385
	speed: 0.0760s/iter; left time: 2418.4215s
Epoch: 14 cost time: 28.102582693099976
Epoch: 14, Steps: 369 | Train Loss: 0.083 Vali Loss: 1.672 Vali Acc: 0.641 Test Loss: 1.672 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6671396140749148
model parameter : 1233562
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6494258
	speed: 0.1009s/iter; left time: 3713.2037s
	iters: 200, epoch: 1 | loss: 0.7646613
	speed: 0.0812s/iter; left time: 2978.8779s
	iters: 300, epoch: 1 | loss: 1.4702973
	speed: 0.0882s/iter; left time: 3228.7980s
Epoch: 1 cost time: 32.112255811691284
Epoch: 1, Steps: 369 | Train Loss: 1.255 Vali Loss: 2.515 Vali Acc: 0.536 Test Loss: 2.515 Test Acc: 0.536
Validation loss decreased (inf --> -0.535730).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6832008
	speed: 0.3152s/iter; left time: 11483.0730s
	iters: 200, epoch: 2 | loss: 0.7236691
	speed: 0.0797s/iter; left time: 2897.0054s
	iters: 300, epoch: 2 | loss: 0.8870143
	speed: 0.0634s/iter; left time: 2296.4750s
Epoch: 2 cost time: 27.45512890815735
Epoch: 2, Steps: 369 | Train Loss: 1.363 Vali Loss: 0.765 Vali Acc: 0.638 Test Loss: 0.765 Test Acc: 0.638
Validation loss decreased (-0.535730 --> -0.638188).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0184996
	speed: 0.3020s/iter; left time: 10892.3456s
	iters: 200, epoch: 3 | loss: 0.6204658
	speed: 0.0789s/iter; left time: 2838.4337s
	iters: 300, epoch: 3 | loss: 0.8969015
	speed: 0.0776s/iter; left time: 2782.7946s
Epoch: 3 cost time: 29.156636238098145
Epoch: 3, Steps: 369 | Train Loss: 0.752 Vali Loss: 0.756 Vali Acc: 0.633 Test Loss: 0.756 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4404162
	speed: 0.2940s/iter; left time: 10493.6743s
	iters: 200, epoch: 4 | loss: 0.6621011
	speed: 0.0747s/iter; left time: 2657.8807s
	iters: 300, epoch: 4 | loss: 0.5875177
	speed: 0.0692s/iter; left time: 2456.5989s
Epoch: 4 cost time: 27.416439533233643
Epoch: 4, Steps: 369 | Train Loss: 0.617 Vali Loss: 0.641 Vali Acc: 0.662 Test Loss: 0.641 Test Acc: 0.662
Validation loss decreased (-0.638188 --> -0.662309).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3796223
	speed: 0.3077s/iter; left time: 10868.1308s
	iters: 200, epoch: 5 | loss: 0.3060721
	speed: 0.0734s/iter; left time: 2584.7301s
	iters: 300, epoch: 5 | loss: 0.7799017
	speed: 0.0742s/iter; left time: 2606.2661s
Epoch: 5 cost time: 28.33033776283264
Epoch: 5, Steps: 369 | Train Loss: 0.500 Vali Loss: 0.717 Vali Acc: 0.672 Test Loss: 0.717 Test Acc: 0.672
Validation loss decreased (-0.662309 --> -0.671673).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4384417
	speed: 0.2873s/iter; left time: 10043.3780s
	iters: 200, epoch: 6 | loss: 0.3467369
	speed: 0.0809s/iter; left time: 2820.4815s
	iters: 300, epoch: 6 | loss: 0.7836792
	speed: 0.0744s/iter; left time: 2586.2214s
Epoch: 6 cost time: 28.815155506134033
Epoch: 6, Steps: 369 | Train Loss: 0.431 Vali Loss: 0.683 Vali Acc: 0.652 Test Loss: 0.683 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5219977
	speed: 0.3015s/iter; left time: 10428.1094s
	iters: 200, epoch: 7 | loss: 0.2844218
	speed: 0.0714s/iter; left time: 2461.0241s
	iters: 300, epoch: 7 | loss: 0.0612714
	speed: 0.0702s/iter; left time: 2415.0521s
Epoch: 7 cost time: 27.910114288330078
Epoch: 7, Steps: 369 | Train Loss: 0.384 Vali Loss: 0.776 Vali Acc: 0.656 Test Loss: 0.776 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.5328176
	speed: 0.3022s/iter; left time: 10342.3660s
	iters: 200, epoch: 8 | loss: 0.1837655
	speed: 0.0704s/iter; left time: 2401.0519s
	iters: 300, epoch: 8 | loss: 0.1772625
	speed: 0.0856s/iter; left time: 2911.7623s
Epoch: 8 cost time: 28.571418046951294
Epoch: 8, Steps: 369 | Train Loss: 0.329 Vali Loss: 0.810 Vali Acc: 0.650 Test Loss: 0.810 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3752002
	speed: 0.2935s/iter; left time: 9933.8479s
	iters: 200, epoch: 9 | loss: 0.2159170
	speed: 0.0787s/iter; left time: 2656.5839s
	iters: 300, epoch: 9 | loss: 0.4003765
	speed: 0.0788s/iter; left time: 2651.2124s
Epoch: 9 cost time: 28.737483501434326
Epoch: 9, Steps: 369 | Train Loss: 0.271 Vali Loss: 0.823 Vali Acc: 0.651 Test Loss: 0.823 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3047494
	speed: 0.3278s/iter; left time: 10975.1287s
	iters: 200, epoch: 10 | loss: 0.3464667
	speed: 0.0750s/iter; left time: 2503.1100s
	iters: 300, epoch: 10 | loss: 0.3748282
	speed: 0.0723s/iter; left time: 2405.6230s
Epoch: 10 cost time: 30.43082618713379
Epoch: 10, Steps: 369 | Train Loss: 0.215 Vali Loss: 1.084 Vali Acc: 0.644 Test Loss: 1.084 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0135621
	speed: 0.3400s/iter; left time: 11257.9916s
	iters: 200, epoch: 11 | loss: 0.5943984
	speed: 0.0770s/iter; left time: 2542.4412s
	iters: 300, epoch: 11 | loss: 0.2506662
	speed: 0.0851s/iter; left time: 2800.5284s
Epoch: 11 cost time: 30.66672444343567
Epoch: 11, Steps: 369 | Train Loss: 0.179 Vali Loss: 1.371 Vali Acc: 0.642 Test Loss: 1.371 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0312189
	speed: 0.2430s/iter; left time: 7955.4821s
	iters: 200, epoch: 12 | loss: 0.2372988
	speed: 0.0397s/iter; left time: 1296.1386s
	iters: 300, epoch: 12 | loss: 0.1363216
	speed: 0.0460s/iter; left time: 1495.9116s
Epoch: 12 cost time: 17.344341039657593
Epoch: 12, Steps: 369 | Train Loss: 0.143 Vali Loss: 1.405 Vali Acc: 0.638 Test Loss: 1.405 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1100684
	speed: 0.2960s/iter; left time: 9582.5985s
	iters: 200, epoch: 13 | loss: 0.0716822
	speed: 0.0695s/iter; left time: 2244.3311s
	iters: 300, epoch: 13 | loss: 0.0014622
	speed: 0.0694s/iter; left time: 2231.2021s
Epoch: 13 cost time: 28.071030616760254
Epoch: 13, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.958 Vali Acc: 0.639 Test Loss: 1.958 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0916745
	speed: 0.2975s/iter; left time: 9521.0061s
	iters: 200, epoch: 14 | loss: 0.0464078
	speed: 0.0766s/iter; left time: 2444.2802s
	iters: 300, epoch: 14 | loss: 0.1243376
	speed: 0.0704s/iter; left time: 2240.4388s
Epoch: 14 cost time: 27.627597332000732
Epoch: 14, Steps: 369 | Train Loss: 0.105 Vali Loss: 1.672 Vali Acc: 0.644 Test Loss: 1.672 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0147505
	speed: 0.3117s/iter; left time: 9861.9777s
	iters: 200, epoch: 15 | loss: 0.0081941
	speed: 0.0753s/iter; left time: 2375.7979s
	iters: 300, epoch: 15 | loss: 0.0481410
	speed: 0.0799s/iter; left time: 2510.1148s
Epoch: 15 cost time: 30.402364492416382
Epoch: 15, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.855 Vali Acc: 0.648 Test Loss: 1.855 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6716799091940976
model parameter : 768282
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8664237
	speed: 0.1039s/iter; left time: 3824.5650s
	iters: 200, epoch: 1 | loss: 1.0506153
	speed: 0.0717s/iter; left time: 2631.6457s
	iters: 300, epoch: 1 | loss: 0.4532991
	speed: 0.0700s/iter; left time: 2561.5173s
Epoch: 1 cost time: 30.35991597175598
Epoch: 1, Steps: 369 | Train Loss: 1.032 Vali Loss: 1.436 Vali Acc: 0.574 Test Loss: 1.436 Test Acc: 0.574
Validation loss decreased (inf --> -0.574049).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6861205
	speed: 0.3076s/iter; left time: 11206.8436s
	iters: 200, epoch: 2 | loss: 1.3832650
	speed: 0.0774s/iter; left time: 2810.8021s
	iters: 300, epoch: 2 | loss: 1.0071942
	speed: 0.0776s/iter; left time: 2811.9823s
Epoch: 2 cost time: 28.083608627319336
Epoch: 2, Steps: 369 | Train Loss: 1.356 Vali Loss: 4.342 Vali Acc: 0.500 Test Loss: 4.342 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3894131
	speed: 0.2971s/iter; left time: 10715.3810s
	iters: 200, epoch: 3 | loss: 0.5704617
	speed: 0.0856s/iter; left time: 3078.0216s
	iters: 300, epoch: 3 | loss: 0.7681010
	speed: 0.0845s/iter; left time: 3031.7746s
Epoch: 3 cost time: 31.230992794036865
Epoch: 3, Steps: 369 | Train Loss: 0.925 Vali Loss: 0.987 Vali Acc: 0.565 Test Loss: 0.987 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5578645
	speed: 0.3186s/iter; left time: 11373.1922s
	iters: 200, epoch: 4 | loss: 1.2241629
	speed: 0.0880s/iter; left time: 3131.3973s
	iters: 300, epoch: 4 | loss: 0.5063702
	speed: 0.0883s/iter; left time: 3133.1542s
Epoch: 4 cost time: 30.818251848220825
Epoch: 4, Steps: 369 | Train Loss: 0.624 Vali Loss: 0.854 Vali Acc: 0.641 Test Loss: 0.854 Test Acc: 0.641
Validation loss decreased (-0.574049 --> -0.640741).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3311985
	speed: 0.3293s/iter; left time: 11630.8570s
	iters: 200, epoch: 5 | loss: 0.6323913
	speed: 0.0767s/iter; left time: 2703.3125s
	iters: 300, epoch: 5 | loss: 0.4718041
	speed: 0.0639s/iter; left time: 2245.6056s
Epoch: 5 cost time: 29.05107593536377
Epoch: 5, Steps: 369 | Train Loss: 0.541 Vali Loss: 0.675 Vali Acc: 0.655 Test Loss: 0.675 Test Acc: 0.655
Validation loss decreased (-0.640741 --> -0.655215).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5208036
	speed: 0.3095s/iter; left time: 10819.4256s
	iters: 200, epoch: 6 | loss: 0.3398407
	speed: 0.0748s/iter; left time: 2605.7278s
	iters: 300, epoch: 6 | loss: 0.4532524
	speed: 0.0837s/iter; left time: 2908.3015s
Epoch: 6 cost time: 29.659996509552002
Epoch: 6, Steps: 369 | Train Loss: 0.444 Vali Loss: 0.808 Vali Acc: 0.654 Test Loss: 0.808 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8680879
	speed: 0.2879s/iter; left time: 9956.0172s
	iters: 200, epoch: 7 | loss: 0.2467812
	speed: 0.0796s/iter; left time: 2746.0610s
	iters: 300, epoch: 7 | loss: 0.3165683
	speed: 0.0607s/iter; left time: 2085.9828s
Epoch: 7 cost time: 26.671170711517334
Epoch: 7, Steps: 369 | Train Loss: 0.388 Vali Loss: 0.687 Vali Acc: 0.677 Test Loss: 0.687 Test Acc: 0.677
Validation loss decreased (-0.655215 --> -0.677348).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2494820
	speed: 0.3027s/iter; left time: 10357.6580s
	iters: 200, epoch: 8 | loss: 0.3489987
	speed: 0.0676s/iter; left time: 2306.7980s
	iters: 300, epoch: 8 | loss: 0.3994626
	speed: 0.0802s/iter; left time: 2727.5195s
Epoch: 8 cost time: 28.938631534576416
Epoch: 8, Steps: 369 | Train Loss: 0.337 Vali Loss: 0.768 Vali Acc: 0.666 Test Loss: 0.768 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3862132
	speed: 0.2410s/iter; left time: 8157.6151s
	iters: 200, epoch: 9 | loss: 0.1916976
	speed: 0.0383s/iter; left time: 1291.9548s
	iters: 300, epoch: 9 | loss: 0.4094548
	speed: 0.0447s/iter; left time: 1502.5292s
Epoch: 9 cost time: 16.824055910110474
Epoch: 9, Steps: 369 | Train Loss: 0.284 Vali Loss: 0.881 Vali Acc: 0.648 Test Loss: 0.881 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1190954
	speed: 0.2934s/iter; left time: 9822.7671s
	iters: 200, epoch: 10 | loss: 0.2464819
	speed: 0.0648s/iter; left time: 2161.8786s
	iters: 300, epoch: 10 | loss: 0.2570198
	speed: 0.0731s/iter; left time: 2433.0493s
Epoch: 10 cost time: 27.75133991241455
Epoch: 10, Steps: 369 | Train Loss: 0.218 Vali Loss: 1.301 Vali Acc: 0.645 Test Loss: 1.301 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2672346
	speed: 0.3003s/iter; left time: 9942.0181s
	iters: 200, epoch: 11 | loss: 0.5505759
	speed: 0.0860s/iter; left time: 2840.3843s
	iters: 300, epoch: 11 | loss: 0.0922649
	speed: 0.0666s/iter; left time: 2192.6804s
Epoch: 11 cost time: 26.896090507507324
Epoch: 11, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.391 Vali Acc: 0.625 Test Loss: 1.391 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1219225
	speed: 0.2878s/iter; left time: 9424.6466s
	iters: 200, epoch: 12 | loss: 0.0660189
	speed: 0.0747s/iter; left time: 2439.7954s
	iters: 300, epoch: 12 | loss: 0.1077878
	speed: 0.0721s/iter; left time: 2345.4512s
Epoch: 12 cost time: 29.400096893310547
Epoch: 12, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.470 Vali Acc: 0.634 Test Loss: 1.470 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1418510
	speed: 0.3297s/iter; left time: 10672.9981s
	iters: 200, epoch: 13 | loss: 0.0188654
	speed: 0.0798s/iter; left time: 2573.9119s
	iters: 300, epoch: 13 | loss: 0.0243027
	speed: 0.0932s/iter; left time: 2999.9355s
Epoch: 13 cost time: 31.28345561027527
Epoch: 13, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.387 Vali Acc: 0.650 Test Loss: 1.387 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1192416
	speed: 0.3153s/iter; left time: 10091.5005s
	iters: 200, epoch: 14 | loss: 0.0343610
	speed: 0.0801s/iter; left time: 2554.1164s
	iters: 300, epoch: 14 | loss: 0.2756049
	speed: 0.0751s/iter; left time: 2388.4577s
Epoch: 14 cost time: 30.03992199897766
Epoch: 14, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.597 Vali Acc: 0.648 Test Loss: 1.597 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0118716
	speed: 0.3104s/iter; left time: 9819.7911s
	iters: 200, epoch: 15 | loss: 0.0058157
	speed: 0.0743s/iter; left time: 2343.6031s
	iters: 300, epoch: 15 | loss: 0.3924051
	speed: 0.0791s/iter; left time: 2488.0300s
Epoch: 15 cost time: 28.22611117362976
Epoch: 15, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.880 Vali Acc: 0.635 Test Loss: 1.880 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0625153
	speed: 0.2964s/iter; left time: 9265.7970s
	iters: 200, epoch: 16 | loss: 0.0363137
	speed: 0.0763s/iter; left time: 2377.5791s
	iters: 300, epoch: 16 | loss: 0.2733903
	speed: 0.0612s/iter; left time: 1900.2987s
Epoch: 16 cost time: 27.34052276611328
Epoch: 16, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.708 Vali Acc: 0.648 Test Loss: 1.708 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0916045
	speed: 0.3025s/iter; left time: 9347.5904s
	iters: 200, epoch: 17 | loss: 0.0262978
	speed: 0.0658s/iter; left time: 2027.6102s
	iters: 300, epoch: 17 | loss: 0.0460129
	speed: 0.0790s/iter; left time: 2424.6866s
Epoch: 17 cost time: 28.031068563461304
Epoch: 17, Steps: 369 | Train Loss: 0.089 Vali Loss: 2.175 Vali Acc: 0.645 Test Loss: 2.175 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.677355278093076
model parameter : 767898
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.7517397
	speed: 0.0856s/iter; left time: 3148.9282s
	iters: 200, epoch: 1 | loss: 2.9992409
	speed: 0.0724s/iter; left time: 2657.2734s
	iters: 300, epoch: 1 | loss: 0.7919509
	speed: 0.0621s/iter; left time: 2271.7760s
Epoch: 1 cost time: 26.476239442825317
Epoch: 1, Steps: 369 | Train Loss: 1.428 Vali Loss: 1.426 Vali Acc: 0.609 Test Loss: 1.426 Test Acc: 0.609
Validation loss decreased (inf --> -0.608953).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2770152
	speed: 0.2890s/iter; left time: 10530.2521s
	iters: 200, epoch: 2 | loss: 1.6320074
	speed: 0.0746s/iter; left time: 2711.6385s
	iters: 300, epoch: 2 | loss: 0.8105197
	speed: 0.0672s/iter; left time: 2435.5684s
Epoch: 2 cost time: 27.957255601882935
Epoch: 2, Steps: 369 | Train Loss: 1.388 Vali Loss: 0.987 Vali Acc: 0.598 Test Loss: 0.987 Test Acc: 0.598
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6052983
	speed: 0.2977s/iter; left time: 10734.8172s
	iters: 200, epoch: 3 | loss: 1.0057888
	speed: 0.0626s/iter; left time: 2250.6976s
	iters: 300, epoch: 3 | loss: 0.7655393
	speed: 0.0805s/iter; left time: 2886.1437s
Epoch: 3 cost time: 26.631822109222412
Epoch: 3, Steps: 369 | Train Loss: 0.817 Vali Loss: 0.612 Vali Acc: 0.673 Test Loss: 0.612 Test Acc: 0.673
Validation loss decreased (-0.608953 --> -0.672809).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6576737
	speed: 0.2786s/iter; left time: 9943.2422s
	iters: 200, epoch: 4 | loss: 0.4712953
	speed: 0.0813s/iter; left time: 2892.4024s
	iters: 300, epoch: 4 | loss: 0.6015471
	speed: 0.0767s/iter; left time: 2723.9944s
Epoch: 4 cost time: 28.583876132965088
Epoch: 4, Steps: 369 | Train Loss: 0.630 Vali Loss: 0.618 Vali Acc: 0.680 Test Loss: 0.618 Test Acc: 0.680
Validation loss decreased (-0.672809 --> -0.679619).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6581289
	speed: 0.2840s/iter; left time: 10033.2042s
	iters: 200, epoch: 5 | loss: 0.6037301
	speed: 0.0404s/iter; left time: 1424.1330s
	iters: 300, epoch: 5 | loss: 0.5866430
	speed: 0.0386s/iter; left time: 1356.5301s
Epoch: 5 cost time: 16.071971654891968
Epoch: 5, Steps: 369 | Train Loss: 0.514 Vali Loss: 0.686 Vali Acc: 0.687 Test Loss: 0.686 Test Acc: 0.687
Validation loss decreased (-0.679619 --> -0.687280).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3516226
	speed: 0.2767s/iter; left time: 9671.7550s
	iters: 200, epoch: 6 | loss: 0.3549442
	speed: 0.0863s/iter; left time: 3007.1186s
	iters: 300, epoch: 6 | loss: 0.5049640
	speed: 0.0636s/iter; left time: 2209.0060s
Epoch: 6 cost time: 27.61472749710083
Epoch: 6, Steps: 369 | Train Loss: 0.440 Vali Loss: 0.856 Vali Acc: 0.633 Test Loss: 0.856 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1971137
	speed: 0.3074s/iter; left time: 10631.4379s
	iters: 200, epoch: 7 | loss: 0.3984285
	speed: 0.0805s/iter; left time: 2777.8454s
	iters: 300, epoch: 7 | loss: 0.3895311
	speed: 0.0770s/iter; left time: 2648.9947s
Epoch: 7 cost time: 30.112897872924805
Epoch: 7, Steps: 369 | Train Loss: 0.395 Vali Loss: 0.781 Vali Acc: 0.666 Test Loss: 0.781 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4457277
	speed: 0.2993s/iter; left time: 10242.9428s
	iters: 200, epoch: 8 | loss: 1.0190444
	speed: 0.0718s/iter; left time: 2448.2427s
	iters: 300, epoch: 8 | loss: 0.4237940
	speed: 0.0740s/iter; left time: 2518.1610s
Epoch: 8 cost time: 26.64543056488037
Epoch: 8, Steps: 369 | Train Loss: 0.332 Vali Loss: 0.914 Vali Acc: 0.663 Test Loss: 0.914 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1593132
	speed: 0.3027s/iter; left time: 10245.1380s
	iters: 200, epoch: 9 | loss: 0.3533391
	speed: 0.0753s/iter; left time: 2541.8674s
	iters: 300, epoch: 9 | loss: 0.1231460
	speed: 0.0795s/iter; left time: 2674.2347s
Epoch: 9 cost time: 29.559425830841064
Epoch: 9, Steps: 369 | Train Loss: 0.274 Vali Loss: 0.945 Vali Acc: 0.654 Test Loss: 0.945 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1753270
	speed: 0.2999s/iter; left time: 10041.6945s
	iters: 200, epoch: 10 | loss: 0.2125297
	speed: 0.0744s/iter; left time: 2483.8617s
	iters: 300, epoch: 10 | loss: 0.0557433
	speed: 0.0695s/iter; left time: 2313.8732s
Epoch: 10 cost time: 27.317033767700195
Epoch: 10, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.005 Vali Acc: 0.650 Test Loss: 1.005 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2159057
	speed: 0.3102s/iter; left time: 10271.8075s
	iters: 200, epoch: 11 | loss: 0.2529691
	speed: 0.0683s/iter; left time: 2253.7551s
	iters: 300, epoch: 11 | loss: 0.2407498
	speed: 0.0748s/iter; left time: 2461.7066s
Epoch: 11 cost time: 28.900512218475342
Epoch: 11, Steps: 369 | Train Loss: 0.172 Vali Loss: 1.205 Vali Acc: 0.633 Test Loss: 1.205 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3777410
	speed: 0.3045s/iter; left time: 9970.3200s
	iters: 200, epoch: 12 | loss: 0.7667837
	speed: 0.0678s/iter; left time: 2213.3879s
	iters: 300, epoch: 12 | loss: 0.0692046
	speed: 0.0784s/iter; left time: 2551.2518s
Epoch: 12 cost time: 27.222874641418457
Epoch: 12, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.465 Vali Acc: 0.626 Test Loss: 1.465 Test Acc: 0.626
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2701742
	speed: 0.2875s/iter; left time: 9308.1068s
	iters: 200, epoch: 13 | loss: 0.0449386
	speed: 0.0782s/iter; left time: 2522.4979s
	iters: 300, epoch: 13 | loss: 0.0688521
	speed: 0.0631s/iter; left time: 2030.5134s
Epoch: 13 cost time: 27.510172605514526
Epoch: 13, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.591 Vali Acc: 0.653 Test Loss: 1.591 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0105468
	speed: 0.3153s/iter; left time: 10090.5858s
	iters: 200, epoch: 14 | loss: 0.0480373
	speed: 0.0710s/iter; left time: 2263.6032s
	iters: 300, epoch: 14 | loss: 0.2586450
	speed: 0.0862s/iter; left time: 2741.1328s
Epoch: 14 cost time: 30.76252794265747
Epoch: 14, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.620 Vali Acc: 0.649 Test Loss: 1.620 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0418414
	speed: 0.3059s/iter; left time: 9677.6652s
	iters: 200, epoch: 15 | loss: 0.1073075
	speed: 0.0716s/iter; left time: 2258.5135s
	iters: 300, epoch: 15 | loss: 0.0106641
	speed: 0.0827s/iter; left time: 2600.5898s
Epoch: 15 cost time: 27.539937257766724
Epoch: 15, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.626 Vali Acc: 0.649 Test Loss: 1.626 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6872871736662883
model parameter : 767514
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6578543
	speed: 0.0874s/iter; left time: 3216.5009s
	iters: 200, epoch: 1 | loss: 0.5820594
	speed: 0.0712s/iter; left time: 2612.6623s
	iters: 300, epoch: 1 | loss: 1.0624865
	speed: 0.0671s/iter; left time: 2456.7664s
Epoch: 1 cost time: 26.529340744018555
Epoch: 1, Steps: 369 | Train Loss: 1.159 Vali Loss: 1.206 Vali Acc: 0.617 Test Loss: 1.206 Test Acc: 0.617
Validation loss decreased (inf --> -0.616901).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5890083
	speed: 0.2702s/iter; left time: 9845.1616s
	iters: 200, epoch: 2 | loss: 1.3503131
	speed: 0.0768s/iter; left time: 2788.9824s
	iters: 300, epoch: 2 | loss: 2.6032803
	speed: 0.0705s/iter; left time: 2552.6293s
Epoch: 2 cost time: 27.74126434326172
Epoch: 2, Steps: 369 | Train Loss: 1.303 Vali Loss: 0.817 Vali Acc: 0.635 Test Loss: 0.817 Test Acc: 0.635
Validation loss decreased (-0.616901 --> -0.634498).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6961085
	speed: 0.2949s/iter; left time: 10634.3881s
	iters: 200, epoch: 3 | loss: 0.7130425
	speed: 0.0663s/iter; left time: 2386.0466s
	iters: 300, epoch: 3 | loss: 0.4692879
	speed: 0.0649s/iter; left time: 2328.7453s
Epoch: 3 cost time: 26.930205821990967
Epoch: 3, Steps: 369 | Train Loss: 0.774 Vali Loss: 1.007 Vali Acc: 0.544 Test Loss: 1.007 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9743794
	speed: 0.2898s/iter; left time: 10343.7886s
	iters: 200, epoch: 4 | loss: 0.6500170
	speed: 0.0702s/iter; left time: 2498.5006s
	iters: 300, epoch: 4 | loss: 0.8211709
	speed: 0.0684s/iter; left time: 2428.1450s
Epoch: 4 cost time: 26.077991247177124
Epoch: 4, Steps: 369 | Train Loss: 0.633 Vali Loss: 0.715 Vali Acc: 0.643 Test Loss: 0.715 Test Acc: 0.643
Validation loss decreased (-0.634498 --> -0.643012).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4859435
	speed: 0.2823s/iter; left time: 9970.5950s
	iters: 200, epoch: 5 | loss: 0.4127806
	speed: 0.0385s/iter; left time: 1357.1954s
	iters: 300, epoch: 5 | loss: 0.4440362
	speed: 0.0413s/iter; left time: 1451.2678s
Epoch: 5 cost time: 18.011584758758545
Epoch: 5, Steps: 369 | Train Loss: 0.524 Vali Loss: 0.895 Vali Acc: 0.634 Test Loss: 0.895 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3681854
	speed: 0.2516s/iter; left time: 8794.2045s
	iters: 200, epoch: 6 | loss: 0.4854566
	speed: 0.0698s/iter; left time: 2433.2127s
	iters: 300, epoch: 6 | loss: 0.1365380
	speed: 0.0705s/iter; left time: 2451.3540s
Epoch: 6 cost time: 26.691539764404297
Epoch: 6, Steps: 369 | Train Loss: 0.451 Vali Loss: 0.697 Vali Acc: 0.672 Test Loss: 0.697 Test Acc: 0.672
Validation loss decreased (-0.643012 --> -0.671673).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6994606
	speed: 0.2983s/iter; left time: 10317.8920s
	iters: 200, epoch: 7 | loss: 0.4765457
	speed: 0.0760s/iter; left time: 2620.9438s
	iters: 300, epoch: 7 | loss: 0.2282012
	speed: 0.0745s/iter; left time: 2560.6675s
Epoch: 7 cost time: 28.944514513015747
Epoch: 7, Steps: 369 | Train Loss: 0.396 Vali Loss: 0.686 Vali Acc: 0.664 Test Loss: 0.686 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2998524
	speed: 0.2950s/iter; left time: 10095.6627s
	iters: 200, epoch: 8 | loss: 0.2914540
	speed: 0.0828s/iter; left time: 2826.3344s
	iters: 300, epoch: 8 | loss: 0.1846895
	speed: 0.0687s/iter; left time: 2337.5783s
Epoch: 8 cost time: 28.18651056289673
Epoch: 8, Steps: 369 | Train Loss: 0.333 Vali Loss: 0.774 Vali Acc: 0.654 Test Loss: 0.774 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0866209
	speed: 0.3268s/iter; left time: 11062.1759s
	iters: 200, epoch: 9 | loss: 0.4397468
	speed: 0.0665s/iter; left time: 2244.4967s
	iters: 300, epoch: 9 | loss: 0.5901267
	speed: 0.0839s/iter; left time: 2823.4275s
Epoch: 9 cost time: 30.592941761016846
Epoch: 9, Steps: 369 | Train Loss: 0.296 Vali Loss: 1.039 Vali Acc: 0.642 Test Loss: 1.039 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0926457
	speed: 0.3022s/iter; left time: 10118.7062s
	iters: 200, epoch: 10 | loss: 0.4155332
	speed: 0.0876s/iter; left time: 2924.7208s
	iters: 300, epoch: 10 | loss: 0.1154766
	speed: 0.0846s/iter; left time: 2815.0947s
Epoch: 10 cost time: 29.565659999847412
Epoch: 10, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.211 Vali Acc: 0.650 Test Loss: 1.211 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2280573
	speed: 0.3013s/iter; left time: 9975.7380s
	iters: 200, epoch: 11 | loss: 0.1290152
	speed: 0.0674s/iter; left time: 2225.8973s
	iters: 300, epoch: 11 | loss: 0.2170068
	speed: 0.0671s/iter; left time: 2209.0995s
Epoch: 11 cost time: 27.328834533691406
Epoch: 11, Steps: 369 | Train Loss: 0.196 Vali Loss: 1.209 Vali Acc: 0.653 Test Loss: 1.209 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1321850
	speed: 0.2951s/iter; left time: 9661.2184s
	iters: 200, epoch: 12 | loss: 0.2137824
	speed: 0.0791s/iter; left time: 2581.1477s
	iters: 300, epoch: 12 | loss: 0.0197700
	speed: 0.0733s/iter; left time: 2383.9379s
Epoch: 12 cost time: 28.3462553024292
Epoch: 12, Steps: 369 | Train Loss: 0.160 Vali Loss: 1.557 Vali Acc: 0.649 Test Loss: 1.557 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0347819
	speed: 0.2944s/iter; left time: 9530.9173s
	iters: 200, epoch: 13 | loss: 0.0267975
	speed: 0.0691s/iter; left time: 2229.9322s
	iters: 300, epoch: 13 | loss: 0.0766403
	speed: 0.0780s/iter; left time: 2508.7869s
Epoch: 13 cost time: 26.39194416999817
Epoch: 13, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.649 Vali Acc: 0.648 Test Loss: 1.649 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1661558
	speed: 0.2871s/iter; left time: 9189.3069s
	iters: 200, epoch: 14 | loss: 0.1560084
	speed: 0.0722s/iter; left time: 2302.6327s
	iters: 300, epoch: 14 | loss: 0.0968139
	speed: 0.0649s/iter; left time: 2064.6820s
Epoch: 14 cost time: 27.53081965446472
Epoch: 14, Steps: 369 | Train Loss: 0.121 Vali Loss: 1.677 Vali Acc: 0.657 Test Loss: 1.677 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0053832
	speed: 0.3057s/iter; left time: 9669.7934s
	iters: 200, epoch: 15 | loss: 0.0130804
	speed: 0.0534s/iter; left time: 1685.5392s
	iters: 300, epoch: 15 | loss: 0.1328000
	speed: 0.0722s/iter; left time: 2270.7661s
Epoch: 15 cost time: 25.422651290893555
Epoch: 15, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.884 Vali Acc: 0.646 Test Loss: 1.884 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2117920
	speed: 0.2909s/iter; left time: 9096.4001s
	iters: 200, epoch: 16 | loss: 0.0557098
	speed: 0.0775s/iter; left time: 2415.3134s
	iters: 300, epoch: 16 | loss: 0.1653622
	speed: 0.0681s/iter; left time: 2115.3889s
Epoch: 16 cost time: 27.80138325691223
Epoch: 16, Steps: 369 | Train Loss: 0.103 Vali Loss: 2.696 Vali Acc: 0.636 Test Loss: 2.696 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6716799091940976
model parameter : 767130
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.5005647
	speed: 0.0976s/iter; left time: 3590.5346s
	iters: 200, epoch: 1 | loss: 2.6290917
	speed: 0.0676s/iter; left time: 2481.3531s
	iters: 300, epoch: 1 | loss: 0.8428666
	speed: 0.0853s/iter; left time: 3122.8113s
Epoch: 1 cost time: 30.362319946289062
Epoch: 1, Steps: 369 | Train Loss: 1.108 Vali Loss: 1.330 Vali Acc: 0.599 Test Loss: 1.330 Test Acc: 0.599
Validation loss decreased (inf --> -0.598738).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7297624
	speed: 0.2971s/iter; left time: 10824.9488s
	iters: 200, epoch: 2 | loss: 0.6682889
	speed: 0.0956s/iter; left time: 3475.1416s
	iters: 300, epoch: 2 | loss: 0.8981939
	speed: 0.0777s/iter; left time: 2816.7528s
Epoch: 2 cost time: 29.82267999649048
Epoch: 2, Steps: 369 | Train Loss: 1.388 Vali Loss: 1.052 Vali Acc: 0.601 Test Loss: 1.052 Test Acc: 0.601
Validation loss decreased (-0.598738 --> -0.601295).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4657750
	speed: 0.3149s/iter; left time: 11356.3296s
	iters: 200, epoch: 3 | loss: 0.4669093
	speed: 0.0681s/iter; left time: 2449.0932s
	iters: 300, epoch: 3 | loss: 0.2603560
	speed: 0.0488s/iter; left time: 1751.3190s
Epoch: 3 cost time: 23.172853708267212
Epoch: 3, Steps: 369 | Train Loss: 0.829 Vali Loss: 0.994 Vali Acc: 0.520 Test Loss: 0.994 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5470054
	speed: 0.1725s/iter; left time: 6157.9583s
	iters: 200, epoch: 4 | loss: 0.6491942
	speed: 0.0729s/iter; left time: 2593.2467s
	iters: 300, epoch: 4 | loss: 0.4038810
	speed: 0.0639s/iter; left time: 2267.1369s
Epoch: 4 cost time: 22.63961887359619
Epoch: 4, Steps: 369 | Train Loss: 0.611 Vali Loss: 1.061 Vali Acc: 0.585 Test Loss: 1.061 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3453797
	speed: 0.2854s/iter; left time: 10081.6729s
	iters: 200, epoch: 5 | loss: 0.5865525
	speed: 0.0624s/iter; left time: 2197.6539s
	iters: 300, epoch: 5 | loss: 0.1981980
	speed: 0.0586s/iter; left time: 2059.3389s
Epoch: 5 cost time: 25.683927536010742
Epoch: 5, Steps: 369 | Train Loss: 0.488 Vali Loss: 0.803 Vali Acc: 0.638 Test Loss: 0.803 Test Acc: 0.638
Validation loss decreased (-0.601295 --> -0.638187).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5700423
	speed: 0.2786s/iter; left time: 9739.7684s
	iters: 200, epoch: 6 | loss: 0.3268034
	speed: 0.0747s/iter; left time: 2602.4060s
	iters: 300, epoch: 6 | loss: 0.3327740
	speed: 0.0534s/iter; left time: 1854.7916s
Epoch: 6 cost time: 24.62841773033142
Epoch: 6, Steps: 369 | Train Loss: 0.430 Vali Loss: 0.679 Vali Acc: 0.665 Test Loss: 0.679 Test Acc: 0.665
Validation loss decreased (-0.638187 --> -0.664863).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3686290
	speed: 0.2823s/iter; left time: 9764.1038s
	iters: 200, epoch: 7 | loss: 0.5821297
	speed: 0.0642s/iter; left time: 2213.5653s
	iters: 300, epoch: 7 | loss: 0.1929487
	speed: 0.0743s/iter; left time: 2554.0615s
Epoch: 7 cost time: 27.22835373878479
Epoch: 7, Steps: 369 | Train Loss: 0.374 Vali Loss: 0.918 Vali Acc: 0.636 Test Loss: 0.918 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4225252
	speed: 0.2662s/iter; left time: 9110.5239s
	iters: 200, epoch: 8 | loss: 0.2321985
	speed: 0.0699s/iter; left time: 2385.7461s
	iters: 300, epoch: 8 | loss: 0.2283707
	speed: 0.0670s/iter; left time: 2277.8381s
Epoch: 8 cost time: 24.54543685913086
Epoch: 8, Steps: 369 | Train Loss: 0.336 Vali Loss: 0.801 Vali Acc: 0.652 Test Loss: 0.801 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0245949
	speed: 0.2763s/iter; left time: 9351.2490s
	iters: 200, epoch: 9 | loss: 0.5160479
	speed: 0.0630s/iter; left time: 2125.0355s
	iters: 300, epoch: 9 | loss: 0.2704302
	speed: 0.0781s/iter; left time: 2626.5529s
Epoch: 9 cost time: 27.002163648605347
Epoch: 9, Steps: 369 | Train Loss: 0.265 Vali Loss: 0.984 Vali Acc: 0.642 Test Loss: 0.984 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2276465
	speed: 0.2759s/iter; left time: 9235.7616s
	iters: 200, epoch: 10 | loss: 0.3500923
	speed: 0.0748s/iter; left time: 2497.8545s
	iters: 300, epoch: 10 | loss: 0.1079344
	speed: 0.0527s/iter; left time: 1754.3286s
Epoch: 10 cost time: 24.2781982421875
Epoch: 10, Steps: 369 | Train Loss: 0.213 Vali Loss: 0.978 Vali Acc: 0.650 Test Loss: 0.978 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0859363
	speed: 0.2959s/iter; left time: 9797.2972s
	iters: 200, epoch: 11 | loss: 0.2657329
	speed: 0.0682s/iter; left time: 2251.8978s
	iters: 300, epoch: 11 | loss: 0.1040738
	speed: 0.0693s/iter; left time: 2280.4685s
Epoch: 11 cost time: 26.621776819229126
Epoch: 11, Steps: 369 | Train Loss: 0.171 Vali Loss: 1.245 Vali Acc: 0.649 Test Loss: 1.245 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0156310
	speed: 0.3003s/iter; left time: 9833.1158s
	iters: 200, epoch: 12 | loss: 0.0172945
	speed: 0.0810s/iter; left time: 2644.6636s
	iters: 300, epoch: 12 | loss: 0.0628142
	speed: 0.0598s/iter; left time: 1946.7262s
Epoch: 12 cost time: 27.105459928512573
Epoch: 12, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.531 Vali Acc: 0.665 Test Loss: 1.531 Test Acc: 0.665
Validation loss decreased (-0.664863 --> -0.665422).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0326889
	speed: 0.2923s/iter; left time: 9461.6843s
	iters: 200, epoch: 13 | loss: 0.0270188
	speed: 0.0589s/iter; left time: 1901.9282s
	iters: 300, epoch: 13 | loss: 0.1523821
	speed: 0.0746s/iter; left time: 2398.9487s
Epoch: 13 cost time: 26.106162548065186
Epoch: 13, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.909 Vali Acc: 0.627 Test Loss: 1.909 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1130408
	speed: 0.2822s/iter; left time: 9031.8285s
	iters: 200, epoch: 14 | loss: 0.1000322
	speed: 0.0708s/iter; left time: 2257.7903s
	iters: 300, epoch: 14 | loss: 0.1237222
	speed: 0.0730s/iter; left time: 2320.4458s
Epoch: 14 cost time: 27.56604552268982
Epoch: 14, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.577 Vali Acc: 0.652 Test Loss: 1.577 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.2237162
	speed: 0.2732s/iter; left time: 8643.6934s
	iters: 200, epoch: 15 | loss: 0.0294314
	speed: 0.0656s/iter; left time: 2069.0175s
	iters: 300, epoch: 15 | loss: 0.0109129
	speed: 0.0706s/iter; left time: 2220.8245s
Epoch: 15 cost time: 24.89732551574707
Epoch: 15, Steps: 369 | Train Loss: 0.091 Vali Loss: 2.154 Vali Acc: 0.638 Test Loss: 2.154 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0120297
	speed: 0.2656s/iter; left time: 8302.8888s
	iters: 200, epoch: 16 | loss: 0.0644793
	speed: 0.0781s/iter; left time: 2432.6635s
	iters: 300, epoch: 16 | loss: 0.3124962
	speed: 0.0685s/iter; left time: 2128.0963s
Epoch: 16 cost time: 26.920128107070923
Epoch: 16, Steps: 369 | Train Loss: 0.085 Vali Loss: 2.036 Vali Acc: 0.643 Test Loss: 2.036 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0732501
	speed: 0.2746s/iter; left time: 8484.2501s
	iters: 200, epoch: 17 | loss: 0.6682258
	speed: 0.0729s/iter; left time: 2245.8302s
	iters: 300, epoch: 17 | loss: 0.0977093
	speed: 0.0672s/iter; left time: 2063.1611s
Epoch: 17 cost time: 24.262542486190796
Epoch: 17, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.993 Vali Acc: 0.650 Test Loss: 1.993 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.2949733
	speed: 0.2012s/iter; left time: 6140.7437s
	iters: 200, epoch: 18 | loss: 0.9234051
	speed: 0.0374s/iter; left time: 1138.3131s
	iters: 300, epoch: 18 | loss: 0.1276831
	speed: 0.0455s/iter; left time: 1380.4600s
Epoch: 18 cost time: 17.958340883255005
Epoch: 18, Steps: 369 | Train Loss: 0.091 Vali Loss: 2.020 Vali Acc: 0.650 Test Loss: 2.020 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1352892
	speed: 0.2804s/iter; left time: 8457.3787s
	iters: 200, epoch: 19 | loss: 0.0372434
	speed: 0.0718s/iter; left time: 2158.4729s
	iters: 300, epoch: 19 | loss: 0.0116303
	speed: 0.0650s/iter; left time: 1946.1674s
Epoch: 19 cost time: 25.064838886260986
Epoch: 19, Steps: 369 | Train Loss: 0.074 Vali Loss: 2.406 Vali Acc: 0.611 Test Loss: 2.406 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0009611
	speed: 0.2809s/iter; left time: 8367.4831s
	iters: 200, epoch: 20 | loss: 0.0342411
	speed: 0.0758s/iter; left time: 2250.7533s
	iters: 300, epoch: 20 | loss: 0.0067106
	speed: 0.0743s/iter; left time: 2199.4872s
Epoch: 20 cost time: 28.257400274276733
Epoch: 20, Steps: 369 | Train Loss: 0.072 Vali Loss: 1.911 Vali Acc: 0.641 Test Loss: 1.911 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0001769
	speed: 0.2872s/iter; left time: 8448.6502s
	iters: 200, epoch: 21 | loss: 0.0064042
	speed: 0.0877s/iter; left time: 2572.0483s
	iters: 300, epoch: 21 | loss: 0.0102363
	speed: 0.0750s/iter; left time: 2192.8712s
Epoch: 21 cost time: 28.632760286331177
Epoch: 21, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.093 Vali Acc: 0.650 Test Loss: 2.093 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.2959714
	speed: 0.2968s/iter; left time: 8623.5659s
	iters: 200, epoch: 22 | loss: 0.0011796
	speed: 0.0658s/iter; left time: 1903.7568s
	iters: 300, epoch: 22 | loss: 0.2332111
	speed: 0.0775s/iter; left time: 2237.0962s
Epoch: 22 cost time: 26.47801160812378
Epoch: 22, Steps: 369 | Train Loss: 0.054 Vali Loss: 2.593 Vali Acc: 0.624 Test Loss: 2.593 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6654370034052214
model parameter : 570138
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5395569
	speed: 0.0808s/iter; left time: 2974.6476s
	iters: 200, epoch: 1 | loss: 1.2207342
	speed: 0.0712s/iter; left time: 2613.7435s
	iters: 300, epoch: 1 | loss: 1.1674165
	speed: 0.0642s/iter; left time: 2351.5275s
Epoch: 1 cost time: 26.65557861328125
Epoch: 1, Steps: 369 | Train Loss: 1.328 Vali Loss: 1.338 Vali Acc: 0.621 Test Loss: 1.338 Test Acc: 0.621
Validation loss decreased (inf --> -0.621156).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3913978
	speed: 0.2539s/iter; left time: 9251.2649s
	iters: 200, epoch: 2 | loss: 1.7136209
	speed: 0.0561s/iter; left time: 2038.7996s
	iters: 300, epoch: 2 | loss: 0.8667858
	speed: 0.0768s/iter; left time: 2782.7292s
Epoch: 2 cost time: 23.720927715301514
Epoch: 2, Steps: 369 | Train Loss: 1.304 Vali Loss: 0.815 Vali Acc: 0.654 Test Loss: 0.815 Test Acc: 0.654
Validation loss decreased (-0.621156 --> -0.654078).  Saving model ...
	iters: 100, epoch: 3 | loss: 4.1103563
	speed: 0.2587s/iter; left time: 9331.0004s
	iters: 200, epoch: 3 | loss: 0.7050045
	speed: 0.0795s/iter; left time: 2859.6192s
	iters: 300, epoch: 3 | loss: 1.1418350
	speed: 0.0604s/iter; left time: 2165.9747s
Epoch: 3 cost time: 25.548038721084595
Epoch: 3, Steps: 369 | Train Loss: 0.869 Vali Loss: 0.672 Vali Acc: 0.636 Test Loss: 0.672 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5655362
	speed: 0.2657s/iter; left time: 9482.4622s
	iters: 200, epoch: 4 | loss: 0.6726231
	speed: 0.0582s/iter; left time: 2070.6781s
	iters: 300, epoch: 4 | loss: 0.5000246
	speed: 0.0630s/iter; left time: 2234.9065s
Epoch: 4 cost time: 24.810417890548706
Epoch: 4, Steps: 369 | Train Loss: 0.596 Vali Loss: 0.670 Vali Acc: 0.678 Test Loss: 0.670 Test Acc: 0.678
Validation loss decreased (-0.654078 --> -0.677916).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5536160
	speed: 0.2709s/iter; left time: 9568.7114s
	iters: 200, epoch: 5 | loss: 0.1472388
	speed: 0.0752s/iter; left time: 2649.1243s
	iters: 300, epoch: 5 | loss: 0.5882810
	speed: 0.0615s/iter; left time: 2161.3941s
Epoch: 5 cost time: 26.006861925125122
Epoch: 5, Steps: 369 | Train Loss: 0.525 Vali Loss: 0.691 Vali Acc: 0.677 Test Loss: 0.691 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5236884
	speed: 0.2616s/iter; left time: 9144.3945s
	iters: 200, epoch: 6 | loss: 0.6892591
	speed: 0.0589s/iter; left time: 2052.1717s
	iters: 300, epoch: 6 | loss: 0.3298111
	speed: 0.0687s/iter; left time: 2388.5112s
Epoch: 6 cost time: 24.48784327507019
Epoch: 6, Steps: 369 | Train Loss: 0.437 Vali Loss: 0.701 Vali Acc: 0.667 Test Loss: 0.701 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.5670114
	speed: 0.2615s/iter; left time: 9044.7830s
	iters: 200, epoch: 7 | loss: 0.6496984
	speed: 0.0784s/iter; left time: 2705.1573s
	iters: 300, epoch: 7 | loss: 0.5191157
	speed: 0.0838s/iter; left time: 2881.8748s
Epoch: 7 cost time: 26.86258363723755
Epoch: 7, Steps: 369 | Train Loss: 0.396 Vali Loss: 0.934 Vali Acc: 0.657 Test Loss: 0.934 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2525105
	speed: 0.2983s/iter; left time: 10207.5100s
	iters: 200, epoch: 8 | loss: 0.5527959
	speed: 0.0619s/iter; left time: 2110.3070s
	iters: 300, epoch: 8 | loss: 0.1879541
	speed: 0.0729s/iter; left time: 2480.7440s
Epoch: 8 cost time: 27.708444833755493
Epoch: 8, Steps: 369 | Train Loss: 0.341 Vali Loss: 0.916 Vali Acc: 0.654 Test Loss: 0.916 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.2019702
	speed: 0.2980s/iter; left time: 10088.5683s
	iters: 200, epoch: 9 | loss: 0.1531306
	speed: 0.0757s/iter; left time: 2554.3130s
	iters: 300, epoch: 9 | loss: 0.1970809
	speed: 0.0657s/iter; left time: 2209.9020s
Epoch: 9 cost time: 25.838728666305542
Epoch: 9, Steps: 369 | Train Loss: 0.264 Vali Loss: 1.039 Vali Acc: 0.656 Test Loss: 1.039 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.3804281
	speed: 0.2456s/iter; left time: 8222.7504s
	iters: 200, epoch: 10 | loss: 0.0049299
	speed: 0.0444s/iter; left time: 1481.6100s
	iters: 300, epoch: 10 | loss: 0.1148427
	speed: 0.0352s/iter; left time: 1172.5319s
Epoch: 10 cost time: 16.303457021713257
Epoch: 10, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.296 Vali Acc: 0.639 Test Loss: 1.296 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.4428266
	speed: 0.2111s/iter; left time: 6989.9476s
	iters: 200, epoch: 11 | loss: 0.0796071
	speed: 0.0663s/iter; left time: 2188.5555s
	iters: 300, epoch: 11 | loss: 0.3312415
	speed: 0.0719s/iter; left time: 2365.9967s
Epoch: 11 cost time: 23.656575202941895
Epoch: 11, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.470 Vali Acc: 0.656 Test Loss: 1.470 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0265149
	speed: 0.2830s/iter; left time: 9266.9360s
	iters: 200, epoch: 12 | loss: 0.2498322
	speed: 0.0725s/iter; left time: 2365.4251s
	iters: 300, epoch: 12 | loss: 0.0605056
	speed: 0.0729s/iter; left time: 2373.0261s
Epoch: 12 cost time: 28.20171308517456
Epoch: 12, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.677 Vali Acc: 0.650 Test Loss: 1.677 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0779930
	speed: 0.2781s/iter; left time: 9002.0180s
	iters: 200, epoch: 13 | loss: 0.4011899
	speed: 0.0718s/iter; left time: 2316.4995s
	iters: 300, epoch: 13 | loss: 0.0291529
	speed: 0.0706s/iter; left time: 2270.5554s
Epoch: 13 cost time: 26.142653703689575
Epoch: 13, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.735 Vali Acc: 0.652 Test Loss: 1.735 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.2851050
	speed: 0.2801s/iter; left time: 8963.3034s
	iters: 200, epoch: 14 | loss: 0.0240321
	speed: 0.0668s/iter; left time: 2132.3842s
	iters: 300, epoch: 14 | loss: 0.1963700
	speed: 0.0806s/iter; left time: 2561.9179s
Epoch: 14 cost time: 26.35462975502014
Epoch: 14, Steps: 369 | Train Loss: 0.105 Vali Loss: 1.965 Vali Acc: 0.654 Test Loss: 1.965 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6779228149829739
model parameter : 569754
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 2.0615821
	speed: 0.0806s/iter; left time: 2967.2534s
	iters: 200, epoch: 1 | loss: 0.6536614
	speed: 0.0720s/iter; left time: 2642.7664s
	iters: 300, epoch: 1 | loss: 1.1606877
	speed: 0.0656s/iter; left time: 2401.9319s
Epoch: 1 cost time: 27.33132576942444
Epoch: 1, Steps: 369 | Train Loss: 1.184 Vali Loss: 3.656 Vali Acc: 0.500 Test Loss: 3.656 Test Acc: 0.500
Validation loss decreased (inf --> -0.499680).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6362470
	speed: 0.2897s/iter; left time: 10552.5766s
	iters: 200, epoch: 2 | loss: 0.5782194
	speed: 0.0585s/iter; left time: 2124.5144s
	iters: 300, epoch: 2 | loss: 0.4505963
	speed: 0.0867s/iter; left time: 3142.1992s
Epoch: 2 cost time: 27.136152505874634
Epoch: 2, Steps: 369 | Train Loss: 1.322 Vali Loss: 0.841 Vali Acc: 0.648 Test Loss: 0.841 Test Acc: 0.648
Validation loss decreased (-0.499680 --> -0.647835).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1815425
	speed: 0.2855s/iter; left time: 10297.0208s
	iters: 200, epoch: 3 | loss: 0.4866819
	speed: 0.0754s/iter; left time: 2712.3785s
	iters: 300, epoch: 3 | loss: 1.0262027
	speed: 0.0598s/iter; left time: 2143.0562s
Epoch: 3 cost time: 25.76677680015564
Epoch: 3, Steps: 369 | Train Loss: 0.819 Vali Loss: 1.003 Vali Acc: 0.595 Test Loss: 1.003 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7880886
	speed: 0.2982s/iter; left time: 10644.0195s
	iters: 200, epoch: 4 | loss: 0.5459287
	speed: 0.0753s/iter; left time: 2679.8841s
	iters: 300, epoch: 4 | loss: 0.6145996
	speed: 0.0770s/iter; left time: 2732.5821s
Epoch: 4 cost time: 28.369163990020752
Epoch: 4, Steps: 369 | Train Loss: 0.590 Vali Loss: 0.830 Vali Acc: 0.591 Test Loss: 0.830 Test Acc: 0.591
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1981074
	speed: 0.2694s/iter; left time: 9517.7342s
	iters: 200, epoch: 5 | loss: 0.2919867
	speed: 0.0655s/iter; left time: 2308.7042s
	iters: 300, epoch: 5 | loss: 0.9418532
	speed: 0.0560s/iter; left time: 1967.6501s
Epoch: 5 cost time: 25.192466974258423
Epoch: 5, Steps: 369 | Train Loss: 0.484 Vali Loss: 0.716 Vali Acc: 0.651 Test Loss: 0.716 Test Acc: 0.651
Validation loss decreased (-0.647835 --> -0.650958).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8236792
	speed: 0.2826s/iter; left time: 9879.7190s
	iters: 200, epoch: 6 | loss: 0.4649767
	speed: 0.0630s/iter; left time: 2194.8379s
	iters: 300, epoch: 6 | loss: 0.6613215
	speed: 0.0787s/iter; left time: 2734.4445s
Epoch: 6 cost time: 26.94909358024597
Epoch: 6, Steps: 369 | Train Loss: 0.428 Vali Loss: 0.776 Vali Acc: 0.667 Test Loss: 0.776 Test Acc: 0.667
Validation loss decreased (-0.650958 --> -0.667416).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2453515
	speed: 0.2708s/iter; left time: 9366.4538s
	iters: 200, epoch: 7 | loss: 0.5139651
	speed: 0.0630s/iter; left time: 2171.0639s
	iters: 300, epoch: 7 | loss: 0.4180650
	speed: 0.0544s/iter; left time: 1870.3100s
Epoch: 7 cost time: 23.747514486312866
Epoch: 7, Steps: 369 | Train Loss: 0.377 Vali Loss: 0.793 Vali Acc: 0.668 Test Loss: 0.793 Test Acc: 0.668
Validation loss decreased (-0.667416 --> -0.668267).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3507764
	speed: 0.2661s/iter; left time: 9105.0542s
	iters: 200, epoch: 8 | loss: 0.6571430
	speed: 0.0740s/iter; left time: 2523.9890s
	iters: 300, epoch: 8 | loss: 0.3268517
	speed: 0.0720s/iter; left time: 2447.8298s
Epoch: 8 cost time: 25.85316228866577
Epoch: 8, Steps: 369 | Train Loss: 0.313 Vali Loss: 1.027 Vali Acc: 0.655 Test Loss: 1.027 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1280834
	speed: 0.2870s/iter; left time: 9714.5236s
	iters: 200, epoch: 9 | loss: 0.2240581
	speed: 0.0598s/iter; left time: 2016.7356s
	iters: 300, epoch: 9 | loss: 0.1449180
	speed: 0.0611s/iter; left time: 2054.5999s
Epoch: 9 cost time: 25.827599048614502
Epoch: 9, Steps: 369 | Train Loss: 0.281 Vali Loss: 0.878 Vali Acc: 0.669 Test Loss: 0.878 Test Acc: 0.669
Validation loss decreased (-0.668267 --> -0.668550).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1865023
	speed: 0.2406s/iter; left time: 8054.2996s
	iters: 200, epoch: 10 | loss: 0.2673225
	speed: 0.0397s/iter; left time: 1323.5595s
	iters: 300, epoch: 10 | loss: 0.2675065
	speed: 0.0361s/iter; left time: 1200.2035s
Epoch: 10 cost time: 16.003033876419067
Epoch: 10, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.470 Vali Acc: 0.627 Test Loss: 1.470 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5953273
	speed: 0.2518s/iter; left time: 8336.5498s
	iters: 200, epoch: 11 | loss: 0.2805941
	speed: 0.0565s/iter; left time: 1864.3890s
	iters: 300, epoch: 11 | loss: 0.0472116
	speed: 0.0793s/iter; left time: 2608.9446s
Epoch: 11 cost time: 26.281962394714355
Epoch: 11, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.190 Vali Acc: 0.656 Test Loss: 1.190 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0201681
	speed: 0.3019s/iter; left time: 9883.6252s
	iters: 200, epoch: 12 | loss: 0.0096336
	speed: 0.0694s/iter; left time: 2265.8992s
	iters: 300, epoch: 12 | loss: 0.0154407
	speed: 0.0756s/iter; left time: 2458.9578s
Epoch: 12 cost time: 27.872916221618652
Epoch: 12, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.407 Vali Acc: 0.652 Test Loss: 1.407 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0605407
	speed: 0.2771s/iter; left time: 8972.0314s
	iters: 200, epoch: 13 | loss: 0.0099209
	speed: 0.0863s/iter; left time: 2785.4269s
	iters: 300, epoch: 13 | loss: 0.0243548
	speed: 0.0696s/iter; left time: 2239.0367s
Epoch: 13 cost time: 27.0052809715271
Epoch: 13, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.659 Vali Acc: 0.650 Test Loss: 1.659 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.2833352
	speed: 0.2932s/iter; left time: 9384.0209s
	iters: 200, epoch: 14 | loss: 0.0251864
	speed: 0.0746s/iter; left time: 2379.7551s
	iters: 300, epoch: 14 | loss: 0.0697234
	speed: 0.0646s/iter; left time: 2055.1882s
Epoch: 14 cost time: 25.97180461883545
Epoch: 14, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.766 Vali Acc: 0.656 Test Loss: 1.766 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0628891
	speed: 0.2782s/iter; left time: 8800.6975s
	iters: 200, epoch: 15 | loss: 0.0114043
	speed: 0.0626s/iter; left time: 1973.7197s
	iters: 300, epoch: 15 | loss: 0.2812643
	speed: 0.0708s/iter; left time: 2225.2376s
Epoch: 15 cost time: 25.552621841430664
Epoch: 15, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.659 Vali Acc: 0.644 Test Loss: 1.659 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0344696
	speed: 0.2802s/iter; left time: 8759.8414s
	iters: 200, epoch: 16 | loss: 0.4286319
	speed: 0.0636s/iter; left time: 1982.5148s
	iters: 300, epoch: 16 | loss: 0.0251555
	speed: 0.0788s/iter; left time: 2446.7667s
Epoch: 16 cost time: 27.299112558364868
Epoch: 16, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.772 Vali Acc: 0.642 Test Loss: 1.772 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2187973
	speed: 0.2712s/iter; left time: 8380.6826s
	iters: 200, epoch: 17 | loss: 0.0538517
	speed: 0.0646s/iter; left time: 1988.2035s
	iters: 300, epoch: 17 | loss: 0.1662496
	speed: 0.0699s/iter; left time: 2144.7841s
Epoch: 17 cost time: 25.52965021133423
Epoch: 17, Steps: 369 | Train Loss: 0.091 Vali Loss: 2.115 Vali Acc: 0.651 Test Loss: 2.115 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0206121
	speed: 0.2750s/iter; left time: 8395.6016s
	iters: 200, epoch: 18 | loss: 0.0201873
	speed: 0.0748s/iter; left time: 2275.1197s
	iters: 300, epoch: 18 | loss: 0.0576408
	speed: 0.0573s/iter; left time: 1737.6052s
Epoch: 18 cost time: 24.2975013256073
Epoch: 18, Steps: 369 | Train Loss: 0.075 Vali Loss: 2.552 Vali Acc: 0.628 Test Loss: 2.552 Test Acc: 0.628
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0010270
	speed: 0.1894s/iter; left time: 5711.9596s
	iters: 200, epoch: 19 | loss: 0.0261766
	speed: 0.0679s/iter; left time: 2040.4717s
	iters: 300, epoch: 19 | loss: 0.0017255
	speed: 0.0660s/iter; left time: 1977.6962s
Epoch: 19 cost time: 21.8133225440979
Epoch: 19, Steps: 369 | Train Loss: 0.054 Vali Loss: 2.672 Vali Acc: 0.640 Test Loss: 2.672 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6685584562996595
model parameter : 569370
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5191791
	speed: 0.0927s/iter; left time: 3411.8965s
	iters: 200, epoch: 1 | loss: 0.9037284
	speed: 0.0649s/iter; left time: 2380.1935s
	iters: 300, epoch: 1 | loss: 0.4998135
	speed: 0.0733s/iter; left time: 2681.5290s
Epoch: 1 cost time: 27.143516302108765
Epoch: 1, Steps: 369 | Train Loss: 1.098 Vali Loss: 2.548 Vali Acc: 0.525 Test Loss: 2.548 Test Acc: 0.525
Validation loss decreased (inf --> -0.525230).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5375328
	speed: 0.2754s/iter; left time: 10031.7201s
	iters: 200, epoch: 2 | loss: 1.7675120
	speed: 0.0707s/iter; left time: 2570.2610s
	iters: 300, epoch: 2 | loss: 1.5281829
	speed: 0.0752s/iter; left time: 2726.2027s
Epoch: 2 cost time: 28.37671971321106
Epoch: 2, Steps: 369 | Train Loss: 1.267 Vali Loss: 0.714 Vali Acc: 0.647 Test Loss: 0.714 Test Acc: 0.647
Validation loss decreased (-0.525230 --> -0.646701).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3593164
	speed: 0.2883s/iter; left time: 10395.9468s
	iters: 200, epoch: 3 | loss: 1.3066452
	speed: 0.0766s/iter; left time: 2756.1471s
	iters: 300, epoch: 3 | loss: 0.6951769
	speed: 0.0830s/iter; left time: 2977.7204s
Epoch: 3 cost time: 27.949829578399658
Epoch: 3, Steps: 369 | Train Loss: 0.773 Vali Loss: 0.645 Vali Acc: 0.649 Test Loss: 0.645 Test Acc: 0.649
Validation loss decreased (-0.646701 --> -0.648972).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2182481
	speed: 0.2636s/iter; left time: 9408.2330s
	iters: 200, epoch: 4 | loss: 0.4234524
	speed: 0.0559s/iter; left time: 1988.9246s
	iters: 300, epoch: 4 | loss: 0.7583944
	speed: 0.0727s/iter; left time: 2581.5209s
Epoch: 4 cost time: 24.668128967285156
Epoch: 4, Steps: 369 | Train Loss: 0.614 Vali Loss: 0.620 Vali Acc: 0.671 Test Loss: 0.620 Test Acc: 0.671
Validation loss decreased (-0.648972 --> -0.671390).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8498579
	speed: 0.2480s/iter; left time: 8762.2690s
	iters: 200, epoch: 5 | loss: 0.2535178
	speed: 0.0746s/iter; left time: 2626.2275s
	iters: 300, epoch: 5 | loss: 0.6745328
	speed: 0.0632s/iter; left time: 2221.6176s
Epoch: 5 cost time: 24.41358232498169
Epoch: 5, Steps: 369 | Train Loss: 0.505 Vali Loss: 0.707 Vali Acc: 0.659 Test Loss: 0.707 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6293147
	speed: 0.2601s/iter; left time: 9093.0997s
	iters: 200, epoch: 6 | loss: 0.3233525
	speed: 0.0618s/iter; left time: 2155.4908s
	iters: 300, epoch: 6 | loss: 0.3500796
	speed: 0.0714s/iter; left time: 2480.1817s
Epoch: 6 cost time: 24.77484369277954
Epoch: 6, Steps: 369 | Train Loss: 0.446 Vali Loss: 0.750 Vali Acc: 0.645 Test Loss: 0.750 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3191421
	speed: 0.2381s/iter; left time: 8234.5916s
	iters: 200, epoch: 7 | loss: 0.2110603
	speed: 0.0716s/iter; left time: 2470.0639s
	iters: 300, epoch: 7 | loss: 0.4043176
	speed: 0.0569s/iter; left time: 1955.5468s
Epoch: 7 cost time: 23.756531238555908
Epoch: 7, Steps: 369 | Train Loss: 0.385 Vali Loss: 0.753 Vali Acc: 0.667 Test Loss: 0.753 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0461192
	speed: 0.2604s/iter; left time: 8911.5176s
	iters: 200, epoch: 8 | loss: 0.2167122
	speed: 0.0570s/iter; left time: 1944.8902s
	iters: 300, epoch: 8 | loss: 0.2775919
	speed: 0.0729s/iter; left time: 2479.1427s
Epoch: 8 cost time: 25.354185342788696
Epoch: 8, Steps: 369 | Train Loss: 0.323 Vali Loss: 0.867 Vali Acc: 0.656 Test Loss: 0.867 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1596632
	speed: 0.2535s/iter; left time: 8581.2063s
	iters: 200, epoch: 9 | loss: 0.2614149
	speed: 0.0668s/iter; left time: 2252.8714s
	iters: 300, epoch: 9 | loss: 0.1188357
	speed: 0.0529s/iter; left time: 1779.7793s
Epoch: 9 cost time: 22.89931893348694
Epoch: 9, Steps: 369 | Train Loss: 0.266 Vali Loss: 0.942 Vali Acc: 0.660 Test Loss: 0.942 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0999591
	speed: 0.2583s/iter; left time: 8647.4453s
	iters: 200, epoch: 10 | loss: 0.5300122
	speed: 0.0596s/iter; left time: 1990.5678s
	iters: 300, epoch: 10 | loss: 0.3256221
	speed: 0.0739s/iter; left time: 2460.1858s
Epoch: 10 cost time: 25.744380474090576
Epoch: 10, Steps: 369 | Train Loss: 0.218 Vali Loss: 1.282 Vali Acc: 0.649 Test Loss: 1.282 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0631076
	speed: 0.2705s/iter; left time: 8955.7618s
	iters: 200, epoch: 11 | loss: 0.2086110
	speed: 0.0756s/iter; left time: 2496.3402s
	iters: 300, epoch: 11 | loss: 0.2060719
	speed: 0.0682s/iter; left time: 2244.6356s
Epoch: 11 cost time: 26.26750659942627
Epoch: 11, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.287 Vali Acc: 0.636 Test Loss: 1.287 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0071823
	speed: 0.2809s/iter; left time: 9196.3820s
	iters: 200, epoch: 12 | loss: 0.3559036
	speed: 0.0559s/iter; left time: 1823.8471s
	iters: 300, epoch: 12 | loss: 0.4564075
	speed: 0.0735s/iter; left time: 2390.8117s
Epoch: 12 cost time: 26.15389370918274
Epoch: 12, Steps: 369 | Train Loss: 0.134 Vali Loss: 1.432 Vali Acc: 0.659 Test Loss: 1.432 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1142063
	speed: 0.2855s/iter; left time: 9241.3027s
	iters: 200, epoch: 13 | loss: 0.0862717
	speed: 0.0818s/iter; left time: 2641.0914s
	iters: 300, epoch: 13 | loss: 0.0367608
	speed: 0.0540s/iter; left time: 1738.9079s
Epoch: 13 cost time: 24.415852308273315
Epoch: 13, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.679 Vali Acc: 0.637 Test Loss: 1.679 Test Acc: 0.637
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1432841
	speed: 0.1832s/iter; left time: 5862.1673s
	iters: 200, epoch: 14 | loss: 0.0165870
	speed: 0.0364s/iter; left time: 1161.4700s
	iters: 300, epoch: 14 | loss: 0.0346604
	speed: 0.0580s/iter; left time: 1844.4136s
Epoch: 14 cost time: 18.686580419540405
Epoch: 14, Steps: 369 | Train Loss: 0.090 Vali Loss: 2.134 Vali Acc: 0.648 Test Loss: 2.134 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6713961407491487
model parameter : 568986
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9726371
	speed: 0.0705s/iter; left time: 2594.8015s
	iters: 200, epoch: 1 | loss: 1.4097170
	speed: 0.0716s/iter; left time: 2626.6153s
	iters: 300, epoch: 1 | loss: 2.3270111
	speed: 0.0561s/iter; left time: 2054.3425s
Epoch: 1 cost time: 23.96929669380188
Epoch: 1, Steps: 369 | Train Loss: 1.118 Vali Loss: 2.228 Vali Acc: 0.528 Test Loss: 2.228 Test Acc: 0.528
Validation loss decreased (inf --> -0.527787).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7909111
	speed: 0.2529s/iter; left time: 9212.6133s
	iters: 200, epoch: 2 | loss: 1.6067137
	speed: 0.0534s/iter; left time: 1941.1878s
	iters: 300, epoch: 2 | loss: 1.2010273
	speed: 0.0654s/iter; left time: 2368.3677s
Epoch: 2 cost time: 23.821808576583862
Epoch: 2, Steps: 369 | Train Loss: 1.558 Vali Loss: 4.121 Vali Acc: 0.500 Test Loss: 4.121 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9599825
	speed: 0.2509s/iter; left time: 9047.0714s
	iters: 200, epoch: 3 | loss: 0.6748322
	speed: 0.0737s/iter; left time: 2649.7722s
	iters: 300, epoch: 3 | loss: 0.7281074
	speed: 0.0525s/iter; left time: 1881.5269s
Epoch: 3 cost time: 23.97475266456604
Epoch: 3, Steps: 369 | Train Loss: 0.822 Vali Loss: 0.713 Vali Acc: 0.635 Test Loss: 0.713 Test Acc: 0.635
Validation loss decreased (-0.527787 --> -0.634783).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3400106
	speed: 0.2535s/iter; left time: 9047.0071s
	iters: 200, epoch: 4 | loss: 0.4313605
	speed: 0.0641s/iter; left time: 2281.4031s
	iters: 300, epoch: 4 | loss: 0.5752391
	speed: 0.0629s/iter; left time: 2232.2968s
Epoch: 4 cost time: 23.278741121292114
Epoch: 4, Steps: 369 | Train Loss: 0.580 Vali Loss: 0.679 Vali Acc: 0.635 Test Loss: 0.679 Test Acc: 0.635
Validation loss decreased (-0.634783 --> -0.634783).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3152616
	speed: 0.2412s/iter; left time: 8518.8027s
	iters: 200, epoch: 5 | loss: 0.3201921
	speed: 0.0689s/iter; left time: 2427.1844s
	iters: 300, epoch: 5 | loss: 0.5459136
	speed: 0.0647s/iter; left time: 2273.2457s
Epoch: 5 cost time: 24.9476056098938
Epoch: 5, Steps: 369 | Train Loss: 0.489 Vali Loss: 0.679 Vali Acc: 0.675 Test Loss: 0.679 Test Acc: 0.675
Validation loss decreased (-0.634783 --> -0.675362).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1783737
	speed: 0.2682s/iter; left time: 9373.6294s
	iters: 200, epoch: 6 | loss: 0.1623783
	speed: 0.0678s/iter; left time: 2364.6651s
	iters: 300, epoch: 6 | loss: 0.3649486
	speed: 0.0598s/iter; left time: 2077.2946s
Epoch: 6 cost time: 24.50822925567627
Epoch: 6, Steps: 369 | Train Loss: 0.407 Vali Loss: 0.724 Vali Acc: 0.669 Test Loss: 0.724 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5024518
	speed: 0.2785s/iter; left time: 9633.4446s
	iters: 200, epoch: 7 | loss: 0.0442791
	speed: 0.0617s/iter; left time: 2128.0531s
	iters: 300, epoch: 7 | loss: 0.5191733
	speed: 0.0764s/iter; left time: 2627.2106s
Epoch: 7 cost time: 25.884673595428467
Epoch: 7, Steps: 369 | Train Loss: 0.381 Vali Loss: 0.749 Vali Acc: 0.666 Test Loss: 0.749 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2926112
	speed: 0.2771s/iter; left time: 9481.9762s
	iters: 200, epoch: 8 | loss: 0.3382094
	speed: 0.0727s/iter; left time: 2481.7544s
	iters: 300, epoch: 8 | loss: 0.1578401
	speed: 0.0698s/iter; left time: 2373.0327s
Epoch: 8 cost time: 26.896884202957153
Epoch: 8, Steps: 369 | Train Loss: 0.314 Vali Loss: 1.067 Vali Acc: 0.654 Test Loss: 1.067 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2920106
	speed: 0.2577s/iter; left time: 8721.3148s
	iters: 200, epoch: 9 | loss: 0.3684600
	speed: 0.0599s/iter; left time: 2022.8111s
	iters: 300, epoch: 9 | loss: 0.2190147
	speed: 0.0626s/iter; left time: 2106.8098s
Epoch: 9 cost time: 23.108875036239624
Epoch: 9, Steps: 369 | Train Loss: 0.245 Vali Loss: 1.252 Vali Acc: 0.645 Test Loss: 1.252 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3851762
	speed: 0.2600s/iter; left time: 8703.3289s
	iters: 200, epoch: 10 | loss: 0.2239323
	speed: 0.0556s/iter; left time: 1857.3115s
	iters: 300, epoch: 10 | loss: 0.1020634
	speed: 0.0668s/iter; left time: 2222.4261s
Epoch: 10 cost time: 23.330049514770508
Epoch: 10, Steps: 369 | Train Loss: 0.209 Vali Loss: 1.443 Vali Acc: 0.649 Test Loss: 1.443 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1085854
	speed: 0.2474s/iter; left time: 8191.9627s
	iters: 200, epoch: 11 | loss: 0.1808772
	speed: 0.0695s/iter; left time: 2295.8669s
	iters: 300, epoch: 11 | loss: 0.0523878
	speed: 0.0579s/iter; left time: 1904.4147s
Epoch: 11 cost time: 24.31957197189331
Epoch: 11, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.076 Vali Acc: 0.637 Test Loss: 1.076 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0944751
	speed: 0.2210s/iter; left time: 7237.3685s
	iters: 200, epoch: 12 | loss: 0.0968327
	speed: 0.0347s/iter; left time: 1133.0681s
	iters: 300, epoch: 12 | loss: 0.1333779
	speed: 0.0414s/iter; left time: 1347.1457s
Epoch: 12 cost time: 14.519729375839233
Epoch: 12, Steps: 369 | Train Loss: 0.141 Vali Loss: 1.499 Vali Acc: 0.646 Test Loss: 1.499 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1367703
	speed: 0.2480s/iter; left time: 8027.8883s
	iters: 200, epoch: 13 | loss: 0.0343000
	speed: 0.0668s/iter; left time: 2155.4845s
	iters: 300, epoch: 13 | loss: 0.0828989
	speed: 0.0700s/iter; left time: 2252.7728s
Epoch: 13 cost time: 26.110100030899048
Epoch: 13, Steps: 369 | Train Loss: 0.110 Vali Loss: 1.521 Vali Acc: 0.653 Test Loss: 1.521 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0927217
	speed: 0.2557s/iter; left time: 8184.3301s
	iters: 200, epoch: 14 | loss: 0.1055255
	speed: 0.0740s/iter; left time: 2360.1817s
	iters: 300, epoch: 14 | loss: 0.0191090
	speed: 0.0545s/iter; left time: 1732.3418s
Epoch: 14 cost time: 23.574833154678345
Epoch: 14, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.581 Vali Acc: 0.653 Test Loss: 1.581 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0046205
	speed: 0.2592s/iter; left time: 8199.8877s
	iters: 200, epoch: 15 | loss: 0.0086334
	speed: 0.0702s/iter; left time: 2213.7714s
	iters: 300, epoch: 15 | loss: 0.0523863
	speed: 0.0721s/iter; left time: 2267.4558s
Epoch: 15 cost time: 26.58646249771118
Epoch: 15, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.179 Vali Acc: 0.646 Test Loss: 2.179 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6753688989784336
model parameter : 471066
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1972038
	speed: 0.0781s/iter; left time: 2872.8055s
	iters: 200, epoch: 1 | loss: 0.3538701
	speed: 0.0762s/iter; left time: 2797.0822s
	iters: 300, epoch: 1 | loss: 0.9304423
	speed: 0.0677s/iter; left time: 2476.7356s
Epoch: 1 cost time: 26.98655343055725
Epoch: 1, Steps: 369 | Train Loss: 1.232 Vali Loss: 1.570 Vali Acc: 0.608 Test Loss: 1.570 Test Acc: 0.608
Validation loss decreased (inf --> -0.607816).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0052094
	speed: 0.2801s/iter; left time: 10204.5516s
	iters: 200, epoch: 2 | loss: 1.8094329
	speed: 0.0664s/iter; left time: 2410.9419s
	iters: 300, epoch: 2 | loss: 1.1106135
	speed: 0.0855s/iter; left time: 3099.1167s
Epoch: 2 cost time: 26.427457571029663
Epoch: 2, Steps: 369 | Train Loss: 1.602 Vali Loss: 1.450 Vali Acc: 0.590 Test Loss: 1.450 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 4.0791597
	speed: 0.2496s/iter; left time: 9002.6150s
	iters: 200, epoch: 3 | loss: 1.4272267
	speed: 0.0659s/iter; left time: 2369.9035s
	iters: 300, epoch: 3 | loss: 0.8287647
	speed: 0.0538s/iter; left time: 1930.3705s
Epoch: 3 cost time: 23.384387493133545
Epoch: 3, Steps: 369 | Train Loss: 1.316 Vali Loss: 0.898 Vali Acc: 0.602 Test Loss: 0.898 Test Acc: 0.602
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9454983
	speed: 0.2560s/iter; left time: 9136.5087s
	iters: 200, epoch: 4 | loss: 0.3282383
	speed: 0.0687s/iter; left time: 2446.5810s
	iters: 300, epoch: 4 | loss: 0.6971744
	speed: 0.0670s/iter; left time: 2378.1129s
Epoch: 4 cost time: 25.041945695877075
Epoch: 4, Steps: 369 | Train Loss: 0.582 Vali Loss: 0.657 Vali Acc: 0.664 Test Loss: 0.657 Test Acc: 0.664
Validation loss decreased (-0.607816 --> -0.664295).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2252814
	speed: 0.2507s/iter; left time: 8856.3062s
	iters: 200, epoch: 5 | loss: 0.2607483
	speed: 0.0666s/iter; left time: 2346.1929s
	iters: 300, epoch: 5 | loss: 0.6595531
	speed: 0.0579s/iter; left time: 2032.2422s
Epoch: 5 cost time: 24.59440040588379
Epoch: 5, Steps: 369 | Train Loss: 0.482 Vali Loss: 0.858 Vali Acc: 0.584 Test Loss: 0.858 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1830903
	speed: 0.2563s/iter; left time: 8959.5664s
	iters: 200, epoch: 6 | loss: 0.4441288
	speed: 0.0560s/iter; left time: 1952.5816s
	iters: 300, epoch: 6 | loss: 0.3890643
	speed: 0.0710s/iter; left time: 2467.8458s
Epoch: 6 cost time: 24.530744552612305
Epoch: 6, Steps: 369 | Train Loss: 0.414 Vali Loss: 0.713 Vali Acc: 0.674 Test Loss: 0.713 Test Acc: 0.674
Validation loss decreased (-0.664295 --> -0.673659).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4263417
	speed: 0.2613s/iter; left time: 9037.3351s
	iters: 200, epoch: 7 | loss: 0.5175083
	speed: 0.0661s/iter; left time: 2281.2225s
	iters: 300, epoch: 7 | loss: 0.1819600
	speed: 0.0575s/iter; left time: 1977.2458s
Epoch: 7 cost time: 25.211292505264282
Epoch: 7, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.796 Vali Acc: 0.656 Test Loss: 0.796 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2108442
	speed: 0.2611s/iter; left time: 8933.8005s
	iters: 200, epoch: 8 | loss: 0.4569453
	speed: 0.0674s/iter; left time: 2299.8789s
	iters: 300, epoch: 8 | loss: 0.5476465
	speed: 0.0653s/iter; left time: 2221.0102s
Epoch: 8 cost time: 23.433757305145264
Epoch: 8, Steps: 369 | Train Loss: 0.302 Vali Loss: 1.078 Vali Acc: 0.653 Test Loss: 1.078 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1742502
	speed: 0.2385s/iter; left time: 8072.5253s
	iters: 200, epoch: 9 | loss: 0.5575123
	speed: 0.0708s/iter; left time: 2388.3771s
	iters: 300, epoch: 9 | loss: 0.3264188
	speed: 0.0691s/iter; left time: 2325.7926s
Epoch: 9 cost time: 25.328561067581177
Epoch: 9, Steps: 369 | Train Loss: 0.260 Vali Loss: 1.002 Vali Acc: 0.653 Test Loss: 1.002 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1004740
	speed: 0.2385s/iter; left time: 7985.9004s
	iters: 200, epoch: 10 | loss: 0.0370189
	speed: 0.0816s/iter; left time: 2722.2446s
	iters: 300, epoch: 10 | loss: 0.4237609
	speed: 0.0668s/iter; left time: 2221.7433s
Epoch: 10 cost time: 26.26016354560852
Epoch: 10, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.134 Vali Acc: 0.647 Test Loss: 1.134 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0557871
	speed: 0.2784s/iter; left time: 9217.7210s
	iters: 200, epoch: 11 | loss: 0.1565831
	speed: 0.0621s/iter; left time: 2050.7653s
	iters: 300, epoch: 11 | loss: 0.1109916
	speed: 0.0800s/iter; left time: 2631.6692s
Epoch: 11 cost time: 27.670576810836792
Epoch: 11, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.412 Vali Acc: 0.646 Test Loss: 1.412 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2283252
	speed: 0.2998s/iter; left time: 9814.5077s
	iters: 200, epoch: 12 | loss: 0.1271715
	speed: 0.0674s/iter; left time: 2200.6364s
	iters: 300, epoch: 12 | loss: 0.0603983
	speed: 0.0520s/iter; left time: 1690.5803s
Epoch: 12 cost time: 24.942376613616943
Epoch: 12, Steps: 369 | Train Loss: 0.134 Vali Loss: 1.601 Vali Acc: 0.636 Test Loss: 1.601 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0420738
	speed: 0.1947s/iter; left time: 6303.3952s
	iters: 200, epoch: 13 | loss: 0.0048035
	speed: 0.0674s/iter; left time: 2176.4185s
	iters: 300, epoch: 13 | loss: 0.1339118
	speed: 0.0547s/iter; left time: 1761.4073s
Epoch: 13 cost time: 21.030872106552124
Epoch: 13, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.619 Vali Acc: 0.646 Test Loss: 1.619 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0518311
	speed: 0.2576s/iter; left time: 8243.0044s
	iters: 200, epoch: 14 | loss: 0.0286025
	speed: 0.0654s/iter; left time: 2087.1981s
	iters: 300, epoch: 14 | loss: 0.4852175
	speed: 0.0748s/iter; left time: 2377.3635s
Epoch: 14 cost time: 25.852768898010254
Epoch: 14, Steps: 369 | Train Loss: 0.102 Vali Loss: 2.751 Vali Acc: 0.621 Test Loss: 2.751 Test Acc: 0.621
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0469507
	speed: 0.2602s/iter; left time: 8231.4412s
	iters: 200, epoch: 15 | loss: 0.0717615
	speed: 0.0576s/iter; left time: 1815.6101s
	iters: 300, epoch: 15 | loss: 0.0384409
	speed: 0.0692s/iter; left time: 2175.1987s
Epoch: 15 cost time: 24.65290665626526
Epoch: 15, Steps: 369 | Train Loss: 0.100 Vali Loss: 2.140 Vali Acc: 0.650 Test Loss: 2.140 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.1289549
	speed: 0.2578s/iter; left time: 8060.5225s
	iters: 200, epoch: 16 | loss: 0.4516111
	speed: 0.0711s/iter; left time: 2217.3214s
	iters: 300, epoch: 16 | loss: 0.4830547
	speed: 0.0695s/iter; left time: 2159.1135s
Epoch: 16 cost time: 25.977052688598633
Epoch: 16, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.856 Vali Acc: 0.651 Test Loss: 1.856 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6736662883087401
model parameter : 470682
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8578218
	speed: 0.0768s/iter; left time: 2825.9330s
	iters: 200, epoch: 1 | loss: 0.3227709
	speed: 0.0656s/iter; left time: 2407.8664s
	iters: 300, epoch: 1 | loss: 3.8342507
	speed: 0.0550s/iter; left time: 2014.5928s
Epoch: 1 cost time: 24.645869493484497
Epoch: 1, Steps: 369 | Train Loss: 1.249 Vali Loss: 1.905 Vali Acc: 0.565 Test Loss: 1.905 Test Acc: 0.565
Validation loss decreased (inf --> -0.564964).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5701048
	speed: 0.2537s/iter; left time: 9243.1104s
	iters: 200, epoch: 2 | loss: 2.3319054
	speed: 0.0541s/iter; left time: 1966.5140s
	iters: 300, epoch: 2 | loss: 1.4855517
	speed: 0.0646s/iter; left time: 2342.0620s
Epoch: 2 cost time: 23.777562379837036
Epoch: 2, Steps: 369 | Train Loss: 1.460 Vali Loss: 1.269 Vali Acc: 0.539 Test Loss: 1.269 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5642852
	speed: 0.2706s/iter; left time: 9757.9320s
	iters: 200, epoch: 3 | loss: 1.5673988
	speed: 0.0641s/iter; left time: 2303.5028s
	iters: 300, epoch: 3 | loss: 0.7581274
	speed: 0.0782s/iter; left time: 2803.0292s
Epoch: 3 cost time: 28.024812936782837
Epoch: 3, Steps: 369 | Train Loss: 0.774 Vali Loss: 1.548 Vali Acc: 0.562 Test Loss: 1.548 Test Acc: 0.562
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5060531
	speed: 0.2768s/iter; left time: 9881.4513s
	iters: 200, epoch: 4 | loss: 0.6918259
	speed: 0.0631s/iter; left time: 2247.6848s
	iters: 300, epoch: 4 | loss: 0.5493937
	speed: 0.0548s/iter; left time: 1943.8243s
Epoch: 4 cost time: 24.124043226242065
Epoch: 4, Steps: 369 | Train Loss: 0.599 Vali Loss: 0.646 Vali Acc: 0.644 Test Loss: 0.646 Test Acc: 0.644
Validation loss decreased (-0.564964 --> -0.644148).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6410296
	speed: 0.2883s/iter; left time: 10185.2660s
	iters: 200, epoch: 5 | loss: 0.4824808
	speed: 0.0814s/iter; left time: 2866.2621s
	iters: 300, epoch: 5 | loss: 0.9144501
	speed: 0.0699s/iter; left time: 2454.3119s
Epoch: 5 cost time: 26.578124046325684
Epoch: 5, Steps: 369 | Train Loss: 0.496 Vali Loss: 0.642 Vali Acc: 0.681 Test Loss: 0.642 Test Acc: 0.681
Validation loss decreased (-0.644148 --> -0.680754).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3753731
	speed: 0.2549s/iter; left time: 8909.3267s
	iters: 200, epoch: 6 | loss: 0.4031771
	speed: 0.0626s/iter; left time: 2183.0067s
	iters: 300, epoch: 6 | loss: 0.4062693
	speed: 0.0678s/iter; left time: 2357.6168s
Epoch: 6 cost time: 23.205177545547485
Epoch: 6, Steps: 369 | Train Loss: 0.433 Vali Loss: 0.664 Vali Acc: 0.669 Test Loss: 0.664 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2466733
	speed: 0.2388s/iter; left time: 8258.4936s
	iters: 200, epoch: 7 | loss: 0.3565268
	speed: 0.0665s/iter; left time: 2294.4798s
	iters: 300, epoch: 7 | loss: 0.2981336
	speed: 0.0502s/iter; left time: 1726.5530s
Epoch: 7 cost time: 21.415630340576172
Epoch: 7, Steps: 369 | Train Loss: 0.381 Vali Loss: 0.965 Vali Acc: 0.642 Test Loss: 0.965 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2378510
	speed: 0.1879s/iter; left time: 6429.0384s
	iters: 200, epoch: 8 | loss: 0.2266409
	speed: 0.0716s/iter; left time: 2442.1621s
	iters: 300, epoch: 8 | loss: 0.4371943
	speed: 0.0671s/iter; left time: 2282.6277s
Epoch: 8 cost time: 22.525461435317993
Epoch: 8, Steps: 369 | Train Loss: 0.323 Vali Loss: 0.818 Vali Acc: 0.662 Test Loss: 0.818 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1534138
	speed: 0.2604s/iter; left time: 8815.7175s
	iters: 200, epoch: 9 | loss: 0.2210795
	speed: 0.0536s/iter; left time: 1807.8506s
	iters: 300, epoch: 9 | loss: 0.0981876
	speed: 0.0638s/iter; left time: 2146.0163s
Epoch: 9 cost time: 22.765172481536865
Epoch: 9, Steps: 369 | Train Loss: 0.257 Vali Loss: 1.101 Vali Acc: 0.641 Test Loss: 1.101 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3030025
	speed: 0.2561s/iter; left time: 8574.3625s
	iters: 200, epoch: 10 | loss: 0.2244177
	speed: 0.0708s/iter; left time: 2363.1765s
	iters: 300, epoch: 10 | loss: 0.1613513
	speed: 0.0659s/iter; left time: 2191.9700s
Epoch: 10 cost time: 26.16000533103943
Epoch: 10, Steps: 369 | Train Loss: 0.225 Vali Loss: 1.210 Vali Acc: 0.649 Test Loss: 1.210 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1707232
	speed: 0.2585s/iter; left time: 8558.2237s
	iters: 200, epoch: 11 | loss: 0.0138741
	speed: 0.0705s/iter; left time: 2327.6461s
	iters: 300, epoch: 11 | loss: 0.3186894
	speed: 0.0638s/iter; left time: 2100.4058s
Epoch: 11 cost time: 24.450323820114136
Epoch: 11, Steps: 369 | Train Loss: 0.171 Vali Loss: 1.381 Vali Acc: 0.641 Test Loss: 1.381 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0246669
	speed: 0.2633s/iter; left time: 8621.9673s
	iters: 200, epoch: 12 | loss: 0.1003423
	speed: 0.0550s/iter; left time: 1794.1772s
	iters: 300, epoch: 12 | loss: 0.0660966
	speed: 0.0726s/iter; left time: 2361.7337s
Epoch: 12 cost time: 24.708935022354126
Epoch: 12, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.487 Vali Acc: 0.652 Test Loss: 1.487 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0358600
	speed: 0.2942s/iter; left time: 9524.6111s
	iters: 200, epoch: 13 | loss: 0.2689905
	speed: 0.0665s/iter; left time: 2144.9822s
	iters: 300, epoch: 13 | loss: 0.3468149
	speed: 0.0799s/iter; left time: 2569.4014s
Epoch: 13 cost time: 28.256676197052002
Epoch: 13, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.707 Vali Acc: 0.639 Test Loss: 1.707 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0125159
	speed: 0.2685s/iter; left time: 8592.5526s
	iters: 200, epoch: 14 | loss: 0.1055698
	speed: 0.0768s/iter; left time: 2450.3175s
	iters: 300, epoch: 14 | loss: 0.0128701
	speed: 0.0622s/iter; left time: 1979.6224s
Epoch: 14 cost time: 25.199814081192017
Epoch: 14, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.692 Vali Acc: 0.649 Test Loss: 1.692 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1209679
	speed: 0.2827s/iter; left time: 8943.9400s
	iters: 200, epoch: 15 | loss: 0.0834286
	speed: 0.0702s/iter; left time: 2215.3019s
	iters: 300, epoch: 15 | loss: 0.0057905
	speed: 0.0707s/iter; left time: 2221.5119s
Epoch: 15 cost time: 25.539474964141846
Epoch: 15, Steps: 369 | Train Loss: 0.087 Vali Loss: 2.140 Vali Acc: 0.630 Test Loss: 2.140 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6807604994324631
model parameter : 470298
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8301705
	speed: 0.0872s/iter; left time: 3208.6970s
	iters: 200, epoch: 1 | loss: 1.8506796
	speed: 0.0610s/iter; left time: 2238.4341s
	iters: 300, epoch: 1 | loss: 1.9219240
	speed: 0.0614s/iter; left time: 2247.1679s
Epoch: 1 cost time: 25.996310234069824
Epoch: 1, Steps: 369 | Train Loss: 1.227 Vali Loss: 4.421 Vali Acc: 0.504 Test Loss: 4.421 Test Acc: 0.504
Validation loss decreased (inf --> -0.503929).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8667018
	speed: 0.2613s/iter; left time: 9518.8854s
	iters: 200, epoch: 2 | loss: 1.3381113
	speed: 0.0658s/iter; left time: 2389.7660s
	iters: 300, epoch: 2 | loss: 6.0279951
	speed: 0.0614s/iter; left time: 2225.5495s
Epoch: 2 cost time: 23.311567544937134
Epoch: 2, Steps: 369 | Train Loss: 1.824 Vali Loss: 0.855 Vali Acc: 0.606 Test Loss: 0.855 Test Acc: 0.606
Validation loss decreased (-0.503929 --> -0.606405).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8065447
	speed: 0.2479s/iter; left time: 8938.6608s
	iters: 200, epoch: 3 | loss: 0.4568031
	speed: 0.0544s/iter; left time: 1956.8493s
	iters: 300, epoch: 3 | loss: 0.3037832
	speed: 0.0576s/iter; left time: 2064.3097s
Epoch: 3 cost time: 23.196242332458496
Epoch: 3, Steps: 369 | Train Loss: 0.753 Vali Loss: 0.859 Vali Acc: 0.627 Test Loss: 0.859 Test Acc: 0.627
Validation loss decreased (-0.606405 --> -0.626836).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6970701
	speed: 0.2493s/iter; left time: 8897.3441s
	iters: 200, epoch: 4 | loss: 1.0146546
	speed: 0.0697s/iter; left time: 2480.5807s
	iters: 300, epoch: 4 | loss: 0.7709169
	speed: 0.0668s/iter; left time: 2371.8385s
Epoch: 4 cost time: 24.519209623336792
Epoch: 4, Steps: 369 | Train Loss: 0.640 Vali Loss: 0.631 Vali Acc: 0.669 Test Loss: 0.631 Test Acc: 0.669
Validation loss decreased (-0.626836 --> -0.669403).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4571563
	speed: 0.2503s/iter; left time: 8840.7955s
	iters: 200, epoch: 5 | loss: 0.5375929
	speed: 0.0582s/iter; left time: 2049.5926s
	iters: 300, epoch: 5 | loss: 0.4178212
	speed: 0.0688s/iter; left time: 2416.0905s
Epoch: 5 cost time: 23.42016363143921
Epoch: 5, Steps: 369 | Train Loss: 0.484 Vali Loss: 0.638 Vali Acc: 0.675 Test Loss: 0.638 Test Acc: 0.675
Validation loss decreased (-0.669403 --> -0.674795).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4249698
	speed: 0.2008s/iter; left time: 7019.4763s
	iters: 200, epoch: 6 | loss: 0.5403047
	speed: 0.0358s/iter; left time: 1249.5359s
	iters: 300, epoch: 6 | loss: 0.6625642
	speed: 0.0379s/iter; left time: 1317.9249s
Epoch: 6 cost time: 14.914341688156128
Epoch: 6, Steps: 369 | Train Loss: 0.433 Vali Loss: 0.818 Vali Acc: 0.630 Test Loss: 0.818 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7318395
	speed: 0.2686s/iter; left time: 9290.3452s
	iters: 200, epoch: 7 | loss: 0.2877550
	speed: 0.0573s/iter; left time: 1974.5952s
	iters: 300, epoch: 7 | loss: 0.3010979
	speed: 0.0827s/iter; left time: 2842.5910s
Epoch: 7 cost time: 26.773484468460083
Epoch: 7, Steps: 369 | Train Loss: 0.374 Vali Loss: 0.848 Vali Acc: 0.633 Test Loss: 0.848 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4718384
	speed: 0.2819s/iter; left time: 9644.5856s
	iters: 200, epoch: 8 | loss: 0.1373843
	speed: 0.0607s/iter; left time: 2071.6507s
	iters: 300, epoch: 8 | loss: 0.2384367
	speed: 0.0730s/iter; left time: 2483.9632s
Epoch: 8 cost time: 26.617035627365112
Epoch: 8, Steps: 369 | Train Loss: 0.316 Vali Loss: 0.795 Vali Acc: 0.669 Test Loss: 0.795 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4599454
	speed: 0.2876s/iter; left time: 9733.7067s
	iters: 200, epoch: 9 | loss: 0.2738982
	speed: 0.0791s/iter; left time: 2668.5942s
	iters: 300, epoch: 9 | loss: 0.2835298
	speed: 0.0597s/iter; left time: 2007.2887s
Epoch: 9 cost time: 27.2035129070282
Epoch: 9, Steps: 369 | Train Loss: 0.263 Vali Loss: 1.021 Vali Acc: 0.646 Test Loss: 1.021 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1494309
	speed: 0.2958s/iter; left time: 9901.9991s
	iters: 200, epoch: 10 | loss: 0.1314466
	speed: 0.0807s/iter; left time: 2694.1477s
	iters: 300, epoch: 10 | loss: 0.3973085
	speed: 0.0578s/iter; left time: 1925.0803s
Epoch: 10 cost time: 25.277667760849
Epoch: 10, Steps: 369 | Train Loss: 0.212 Vali Loss: 1.257 Vali Acc: 0.658 Test Loss: 1.257 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2823053
	speed: 0.2372s/iter; left time: 7855.3071s
	iters: 200, epoch: 11 | loss: 0.1185380
	speed: 0.0559s/iter; left time: 1846.4139s
	iters: 300, epoch: 11 | loss: 0.1625599
	speed: 0.0592s/iter; left time: 1946.9190s
Epoch: 11 cost time: 23.099130392074585
Epoch: 11, Steps: 369 | Train Loss: 0.161 Vali Loss: 1.286 Vali Acc: 0.654 Test Loss: 1.286 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0500613
	speed: 0.2437s/iter; left time: 7978.8857s
	iters: 200, epoch: 12 | loss: 0.1021935
	speed: 0.0755s/iter; left time: 2465.1875s
	iters: 300, epoch: 12 | loss: 0.0784611
	speed: 0.0567s/iter; left time: 1846.6608s
Epoch: 12 cost time: 23.948877573013306
Epoch: 12, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.506 Vali Acc: 0.647 Test Loss: 1.506 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2480944
	speed: 0.2526s/iter; left time: 8175.9474s
	iters: 200, epoch: 13 | loss: 0.1951785
	speed: 0.0660s/iter; left time: 2131.1988s
	iters: 300, epoch: 13 | loss: 0.0919999
	speed: 0.0587s/iter; left time: 1889.3231s
Epoch: 13 cost time: 23.063699960708618
Epoch: 13, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.584 Vali Acc: 0.633 Test Loss: 1.584 Test Acc: 0.633
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.2414404
	speed: 0.2566s/iter; left time: 8212.2170s
	iters: 200, epoch: 14 | loss: 0.0427778
	speed: 0.0669s/iter; left time: 2133.3320s
	iters: 300, epoch: 14 | loss: 0.3561028
	speed: 0.0660s/iter; left time: 2098.0737s
Epoch: 14 cost time: 25.45359969139099
Epoch: 14, Steps: 369 | Train Loss: 0.097 Vali Loss: 1.708 Vali Acc: 0.631 Test Loss: 1.708 Test Acc: 0.631
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0007863
	speed: 0.2474s/iter; left time: 7825.5302s
	iters: 200, epoch: 15 | loss: 0.1032002
	speed: 0.0639s/iter; left time: 2015.7432s
	iters: 300, epoch: 15 | loss: 0.0093609
	speed: 0.0500s/iter; left time: 1570.4743s
Epoch: 15 cost time: 22.49773097038269
Epoch: 15, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.706 Vali Acc: 0.647 Test Loss: 1.706 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6748013620885358
model parameter : 469914
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.2439129
	speed: 0.0783s/iter; left time: 2882.8975s
	iters: 200, epoch: 1 | loss: 1.9090320
	speed: 0.0651s/iter; left time: 2390.8083s
	iters: 300, epoch: 1 | loss: 1.0854789
	speed: 0.0664s/iter; left time: 2429.7027s
Epoch: 1 cost time: 25.226815462112427
Epoch: 1, Steps: 369 | Train Loss: 1.245 Vali Loss: 4.313 Vali Acc: 0.503 Test Loss: 4.313 Test Acc: 0.503
Validation loss decreased (inf --> -0.502795).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.3592987
	speed: 0.2469s/iter; left time: 8996.1580s
	iters: 200, epoch: 2 | loss: 1.2320259
	speed: 0.0534s/iter; left time: 1940.1351s
	iters: 300, epoch: 2 | loss: 1.1841401
	speed: 0.0697s/iter; left time: 2526.6286s
Epoch: 2 cost time: 23.369296312332153
Epoch: 2, Steps: 369 | Train Loss: 1.587 Vali Loss: 1.236 Vali Acc: 0.647 Test Loss: 1.236 Test Acc: 0.647
Validation loss decreased (-0.502795 --> -0.647263).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7217273
	speed: 0.2763s/iter; left time: 9964.0261s
	iters: 200, epoch: 3 | loss: 0.6418629
	speed: 0.0720s/iter; left time: 2590.8962s
	iters: 300, epoch: 3 | loss: 1.7238736
	speed: 0.0668s/iter; left time: 2396.9923s
Epoch: 3 cost time: 24.204949855804443
Epoch: 3, Steps: 369 | Train Loss: 1.342 Vali Loss: 0.677 Vali Acc: 0.642 Test Loss: 0.677 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8874528
	speed: 0.2048s/iter; left time: 7309.9586s
	iters: 200, epoch: 4 | loss: 0.3331608
	speed: 0.0721s/iter; left time: 2568.0144s
	iters: 300, epoch: 4 | loss: 0.6590518
	speed: 0.0596s/iter; left time: 2114.2749s
Epoch: 4 cost time: 24.28923749923706
Epoch: 4, Steps: 369 | Train Loss: 0.615 Vali Loss: 0.616 Vali Acc: 0.667 Test Loss: 0.616 Test Acc: 0.667
Validation loss decreased (-0.647263 --> -0.666566).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6617618
	speed: 0.2683s/iter; left time: 9477.5712s
	iters: 200, epoch: 5 | loss: 0.3525798
	speed: 0.0671s/iter; left time: 2365.1711s
	iters: 300, epoch: 5 | loss: 0.4821554
	speed: 0.0719s/iter; left time: 2524.7508s
Epoch: 5 cost time: 23.500259160995483
Epoch: 5, Steps: 369 | Train Loss: 0.499 Vali Loss: 0.766 Vali Acc: 0.661 Test Loss: 0.766 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4452076
	speed: 0.2456s/iter; left time: 8586.7410s
	iters: 200, epoch: 6 | loss: 0.9110757
	speed: 0.0724s/iter; left time: 2524.5584s
	iters: 300, epoch: 6 | loss: 0.2238959
	speed: 0.0651s/iter; left time: 2262.1577s
Epoch: 6 cost time: 25.785590648651123
Epoch: 6, Steps: 369 | Train Loss: 0.427 Vali Loss: 0.719 Vali Acc: 0.665 Test Loss: 0.719 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6115052
	speed: 0.2491s/iter; left time: 8615.1329s
	iters: 200, epoch: 7 | loss: 0.4388127
	speed: 0.0587s/iter; left time: 2026.1061s
	iters: 300, epoch: 7 | loss: 0.2367143
	speed: 0.0620s/iter; left time: 2130.5215s
Epoch: 7 cost time: 21.803825855255127
Epoch: 7, Steps: 369 | Train Loss: 0.378 Vali Loss: 0.850 Vali Acc: 0.665 Test Loss: 0.850 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4575161
	speed: 0.2367s/iter; left time: 8098.1071s
	iters: 200, epoch: 8 | loss: 0.3330431
	speed: 0.0658s/iter; left time: 2243.9331s
	iters: 300, epoch: 8 | loss: 0.4259233
	speed: 0.0656s/iter; left time: 2231.6807s
Epoch: 8 cost time: 24.220268964767456
Epoch: 8, Steps: 369 | Train Loss: 0.331 Vali Loss: 0.929 Vali Acc: 0.660 Test Loss: 0.929 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0848249
	speed: 0.2511s/iter; left time: 8499.7493s
	iters: 200, epoch: 9 | loss: 0.1755079
	speed: 0.0647s/iter; left time: 2185.1146s
	iters: 300, epoch: 9 | loss: 0.2087383
	speed: 0.0648s/iter; left time: 2179.5715s
Epoch: 9 cost time: 22.42673087120056
Epoch: 9, Steps: 369 | Train Loss: 0.270 Vali Loss: 0.946 Vali Acc: 0.640 Test Loss: 0.946 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0574714
	speed: 0.2511s/iter; left time: 8405.6636s
	iters: 200, epoch: 10 | loss: 0.1420765
	speed: 0.0595s/iter; left time: 1987.1663s
	iters: 300, epoch: 10 | loss: 0.3832237
	speed: 0.0618s/iter; left time: 2056.3188s
Epoch: 10 cost time: 24.312047719955444
Epoch: 10, Steps: 369 | Train Loss: 0.212 Vali Loss: 1.017 Vali Acc: 0.662 Test Loss: 1.017 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0180484
	speed: 0.2589s/iter; left time: 8574.0707s
	iters: 200, epoch: 11 | loss: 0.2115607
	speed: 0.0737s/iter; left time: 2431.4838s
	iters: 300, epoch: 11 | loss: 0.2227965
	speed: 0.0585s/iter; left time: 1924.6357s
Epoch: 11 cost time: 23.772511959075928
Epoch: 11, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.270 Vali Acc: 0.657 Test Loss: 1.270 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.2069298
	speed: 0.2595s/iter; left time: 8495.8184s
	iters: 200, epoch: 12 | loss: 0.1309102
	speed: 0.0596s/iter; left time: 1946.2862s
	iters: 300, epoch: 12 | loss: 0.0898670
	speed: 0.0582s/iter; left time: 1893.1731s
Epoch: 12 cost time: 24.229618549346924
Epoch: 12, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.718 Vali Acc: 0.653 Test Loss: 1.718 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0946431
	speed: 0.2717s/iter; left time: 8797.0133s
	iters: 200, epoch: 13 | loss: 0.2652551
	speed: 0.0753s/iter; left time: 2430.0122s
	iters: 300, epoch: 13 | loss: 0.2567308
	speed: 0.0617s/iter; left time: 1985.0739s
Epoch: 13 cost time: 24.02848529815674
Epoch: 13, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.761 Vali Acc: 0.630 Test Loss: 1.761 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1065568
	speed: 0.2863s/iter; left time: 9161.8549s
	iters: 200, epoch: 14 | loss: 0.0780888
	speed: 0.0519s/iter; left time: 1657.1553s
	iters: 300, epoch: 14 | loss: 0.0188666
	speed: 0.0587s/iter; left time: 1868.1884s
Epoch: 14 cost time: 25.06838345527649
Epoch: 14, Steps: 369 | Train Loss: 0.092 Vali Loss: 1.807 Vali Acc: 0.641 Test Loss: 1.807 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.666572077185017
model parameter : 421530
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5440961
	speed: 0.0666s/iter; left time: 2451.0416s
	iters: 200, epoch: 1 | loss: 1.1078821
	speed: 0.0679s/iter; left time: 2491.9050s
	iters: 300, epoch: 1 | loss: 1.0470192
	speed: 0.0555s/iter; left time: 2033.0651s
Epoch: 1 cost time: 23.190473794937134
Epoch: 1, Steps: 369 | Train Loss: 1.274 Vali Loss: 1.537 Vali Acc: 0.597 Test Loss: 1.537 Test Acc: 0.597
Validation loss decreased (inf --> -0.597033).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9565524
	speed: 0.2623s/iter; left time: 9554.5273s
	iters: 200, epoch: 2 | loss: 1.2779884
	speed: 0.0553s/iter; left time: 2010.0000s
	iters: 300, epoch: 2 | loss: 0.9508677
	speed: 0.0432s/iter; left time: 1566.3359s
Epoch: 2 cost time: 19.886645317077637
Epoch: 2, Steps: 369 | Train Loss: 1.387 Vali Loss: 0.699 Vali Acc: 0.650 Test Loss: 0.699 Test Acc: 0.650
Validation loss decreased (-0.597033 --> -0.650390).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7103480
	speed: 0.1764s/iter; left time: 6362.9734s
	iters: 200, epoch: 3 | loss: 0.4660810
	speed: 0.0533s/iter; left time: 1916.4967s
	iters: 300, epoch: 3 | loss: 0.6006678
	speed: 0.0646s/iter; left time: 2316.3157s
Epoch: 3 cost time: 19.46997880935669
Epoch: 3, Steps: 369 | Train Loss: 0.767 Vali Loss: 1.174 Vali Acc: 0.517 Test Loss: 1.174 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4708042
	speed: 0.2457s/iter; left time: 8769.8020s
	iters: 200, epoch: 4 | loss: 0.6447676
	speed: 0.0579s/iter; left time: 2061.4934s
	iters: 300, epoch: 4 | loss: 0.6136892
	speed: 0.0634s/iter; left time: 2251.7991s
Epoch: 4 cost time: 24.22950553894043
Epoch: 4, Steps: 369 | Train Loss: 0.579 Vali Loss: 0.651 Vali Acc: 0.659 Test Loss: 0.651 Test Acc: 0.659
Validation loss decreased (-0.650390 --> -0.659188).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3857673
	speed: 0.2523s/iter; left time: 8913.2472s
	iters: 200, epoch: 5 | loss: 0.3350639
	speed: 0.0550s/iter; left time: 1938.1038s
	iters: 300, epoch: 5 | loss: 0.7579155
	speed: 0.0542s/iter; left time: 1905.1117s
Epoch: 5 cost time: 22.459306716918945
Epoch: 5, Steps: 369 | Train Loss: 0.503 Vali Loss: 0.702 Vali Acc: 0.646 Test Loss: 0.702 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2167345
	speed: 0.2492s/iter; left time: 8710.6701s
	iters: 200, epoch: 6 | loss: 0.2824295
	speed: 0.0692s/iter; left time: 2412.6864s
	iters: 300, epoch: 6 | loss: 0.4203962
	speed: 0.0652s/iter; left time: 2266.3501s
Epoch: 6 cost time: 24.427680253982544
Epoch: 6, Steps: 369 | Train Loss: 0.443 Vali Loss: 0.679 Vali Acc: 0.643 Test Loss: 0.679 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3969013
	speed: 0.2525s/iter; left time: 8732.7824s
	iters: 200, epoch: 7 | loss: 0.2643444
	speed: 0.0613s/iter; left time: 2115.3299s
	iters: 300, epoch: 7 | loss: 0.4703954
	speed: 0.0613s/iter; left time: 2108.7582s
Epoch: 7 cost time: 22.83380651473999
Epoch: 7, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.856 Vali Acc: 0.644 Test Loss: 0.856 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2778228
	speed: 0.2602s/iter; left time: 8903.5995s
	iters: 200, epoch: 8 | loss: 0.4273908
	speed: 0.0577s/iter; left time: 1968.8425s
	iters: 300, epoch: 8 | loss: 0.0867652
	speed: 0.0715s/iter; left time: 2431.4133s
Epoch: 8 cost time: 26.077381134033203
Epoch: 8, Steps: 369 | Train Loss: 0.325 Vali Loss: 0.830 Vali Acc: 0.666 Test Loss: 0.830 Test Acc: 0.666
Validation loss decreased (-0.659188 --> -0.666280).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2193115
	speed: 0.2788s/iter; left time: 9435.6037s
	iters: 200, epoch: 9 | loss: 0.8623379
	speed: 0.0591s/iter; left time: 1994.4103s
	iters: 300, epoch: 9 | loss: 0.1404716
	speed: 0.0595s/iter; left time: 2003.5907s
Epoch: 9 cost time: 24.625508546829224
Epoch: 9, Steps: 369 | Train Loss: 0.259 Vali Loss: 0.921 Vali Acc: 0.650 Test Loss: 0.921 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2565613
	speed: 0.2831s/iter; left time: 9476.7224s
	iters: 200, epoch: 10 | loss: 0.3337017
	speed: 0.0624s/iter; left time: 2081.4517s
	iters: 300, epoch: 10 | loss: 0.1549693
	speed: 0.0605s/iter; left time: 2015.0746s
Epoch: 10 cost time: 24.714083671569824
Epoch: 10, Steps: 369 | Train Loss: 0.210 Vali Loss: 1.141 Vali Acc: 0.645 Test Loss: 1.141 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1275808
	speed: 0.2619s/iter; left time: 8671.3254s
	iters: 200, epoch: 11 | loss: 0.0861232
	speed: 0.0571s/iter; left time: 1885.0632s
	iters: 300, epoch: 11 | loss: 0.1564495
	speed: 0.0720s/iter; left time: 2368.9398s
Epoch: 11 cost time: 24.359581232070923
Epoch: 11, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.169 Vali Acc: 0.654 Test Loss: 1.169 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0144417
	speed: 0.2541s/iter; left time: 8318.8462s
	iters: 200, epoch: 12 | loss: 0.4382780
	speed: 0.0554s/iter; left time: 1807.2711s
	iters: 300, epoch: 12 | loss: 0.3790491
	speed: 0.0626s/iter; left time: 2036.4102s
Epoch: 12 cost time: 23.49559259414673
Epoch: 12, Steps: 369 | Train Loss: 0.136 Vali Loss: 1.439 Vali Acc: 0.648 Test Loss: 1.439 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0054071
	speed: 0.2548s/iter; left time: 8248.8260s
	iters: 200, epoch: 13 | loss: 0.1170022
	speed: 0.0601s/iter; left time: 1938.6480s
	iters: 300, epoch: 13 | loss: 0.1569747
	speed: 0.0464s/iter; left time: 1492.2698s
Epoch: 13 cost time: 20.848809003829956
Epoch: 13, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.694 Vali Acc: 0.653 Test Loss: 1.694 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0042855
	speed: 0.1752s/iter; left time: 5606.6060s
	iters: 200, epoch: 14 | loss: 0.2423854
	speed: 0.0486s/iter; left time: 1550.4394s
	iters: 300, epoch: 14 | loss: 0.1794581
	speed: 0.0816s/iter; left time: 2596.2108s
Epoch: 14 cost time: 23.752673625946045
Epoch: 14, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.788 Vali Acc: 0.644 Test Loss: 1.788 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0691306
	speed: 0.3182s/iter; left time: 10066.9898s
	iters: 200, epoch: 15 | loss: 0.0734555
	speed: 0.0774s/iter; left time: 2439.2795s
	iters: 300, epoch: 15 | loss: 0.0939110
	speed: 0.0762s/iter; left time: 2395.0794s
Epoch: 15 cost time: 30.023301601409912
Epoch: 15, Steps: 369 | Train Loss: 0.081 Vali Loss: 2.007 Vali Acc: 0.631 Test Loss: 2.007 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0108913
	speed: 0.2994s/iter; left time: 9360.9454s
	iters: 200, epoch: 16 | loss: 0.0602489
	speed: 0.0685s/iter; left time: 2134.5012s
	iters: 300, epoch: 16 | loss: 0.0050279
	speed: 0.0685s/iter; left time: 2127.9830s
Epoch: 16 cost time: 26.7838773727417
Epoch: 16, Steps: 369 | Train Loss: 0.078 Vali Loss: 2.156 Vali Acc: 0.655 Test Loss: 2.156 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0073065
	speed: 0.2817s/iter; left time: 8703.5097s
	iters: 200, epoch: 17 | loss: 0.0625865
	speed: 0.0702s/iter; left time: 2161.5594s
	iters: 300, epoch: 17 | loss: 0.0168648
	speed: 0.0656s/iter; left time: 2013.0949s
Epoch: 17 cost time: 26.770246028900146
Epoch: 17, Steps: 369 | Train Loss: 0.079 Vali Loss: 2.544 Vali Acc: 0.646 Test Loss: 2.544 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0200280
	speed: 0.2896s/iter; left time: 8840.6953s
	iters: 200, epoch: 18 | loss: 0.0667549
	speed: 0.0882s/iter; left time: 2683.7586s
	iters: 300, epoch: 18 | loss: 0.0238925
	speed: 0.0798s/iter; left time: 2421.1385s
Epoch: 18 cost time: 30.158234119415283
Epoch: 18, Steps: 369 | Train Loss: 0.084 Vali Loss: 1.932 Vali Acc: 0.651 Test Loss: 1.932 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6662883087400681
model parameter : 421146
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.8878448
	speed: 0.1012s/iter; left time: 3723.1268s
	iters: 200, epoch: 1 | loss: 1.1306555
	speed: 0.0868s/iter; left time: 3184.5835s
	iters: 300, epoch: 1 | loss: 2.3784308
	speed: 0.0858s/iter; left time: 3140.4167s
Epoch: 1 cost time: 32.843549966812134
Epoch: 1, Steps: 369 | Train Loss: 1.402 Vali Loss: 4.529 Vali Acc: 0.504 Test Loss: 4.529 Test Acc: 0.504
Validation loss decreased (inf --> -0.504211).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9123725
	speed: 0.2988s/iter; left time: 10885.2202s
	iters: 200, epoch: 2 | loss: 1.1450847
	speed: 0.0786s/iter; left time: 2854.7144s
	iters: 300, epoch: 2 | loss: 2.0191255
	speed: 0.0662s/iter; left time: 2398.5377s
Epoch: 2 cost time: 27.453124284744263
Epoch: 2, Steps: 369 | Train Loss: 1.479 Vali Loss: 1.260 Vali Acc: 0.644 Test Loss: 1.260 Test Acc: 0.644
Validation loss decreased (-0.504211 --> -0.643858).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4985017
	speed: 0.2684s/iter; left time: 9677.5613s
	iters: 200, epoch: 3 | loss: 1.0596882
	speed: 0.0737s/iter; left time: 2650.9837s
	iters: 300, epoch: 3 | loss: 1.0770706
	speed: 0.0756s/iter; left time: 2711.6458s
Epoch: 3 cost time: 27.996689796447754
Epoch: 3, Steps: 369 | Train Loss: 0.850 Vali Loss: 1.011 Vali Acc: 0.539 Test Loss: 1.011 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5819684
	speed: 0.2791s/iter; left time: 9963.0475s
	iters: 200, epoch: 4 | loss: 0.3551335
	speed: 0.0645s/iter; left time: 2295.4822s
	iters: 300, epoch: 4 | loss: 0.6521538
	speed: 0.0797s/iter; left time: 2829.2717s
Epoch: 4 cost time: 26.536739826202393
Epoch: 4, Steps: 369 | Train Loss: 0.563 Vali Loss: 0.841 Vali Acc: 0.624 Test Loss: 0.841 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3460660
	speed: 0.2907s/iter; left time: 10269.6638s
	iters: 200, epoch: 5 | loss: 0.3715527
	speed: 0.0860s/iter; left time: 3030.6978s
	iters: 300, epoch: 5 | loss: 0.5792612
	speed: 0.0755s/iter; left time: 2651.7804s
Epoch: 5 cost time: 29.821475505828857
Epoch: 5, Steps: 369 | Train Loss: 0.487 Vali Loss: 0.660 Vali Acc: 0.673 Test Loss: 0.660 Test Acc: 0.673
Validation loss decreased (-0.643858 --> -0.673092).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7510506
	speed: 0.2822s/iter; left time: 9865.2862s
	iters: 200, epoch: 6 | loss: 0.5062488
	speed: 0.0691s/iter; left time: 2407.5948s
	iters: 300, epoch: 6 | loss: 0.3651464
	speed: 0.0666s/iter; left time: 2315.5368s
Epoch: 6 cost time: 25.869325876235962
Epoch: 6, Steps: 369 | Train Loss: 0.420 Vali Loss: 0.645 Vali Acc: 0.673 Test Loss: 0.645 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4180399
	speed: 0.2653s/iter; left time: 9176.4601s
	iters: 200, epoch: 7 | loss: 0.6010390
	speed: 0.0609s/iter; left time: 2098.9588s
	iters: 300, epoch: 7 | loss: 0.5127811
	speed: 0.0779s/iter; left time: 2677.3251s
Epoch: 7 cost time: 27.578625917434692
Epoch: 7, Steps: 369 | Train Loss: 0.373 Vali Loss: 0.764 Vali Acc: 0.661 Test Loss: 0.764 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2467168
	speed: 0.2869s/iter; left time: 9815.6169s
	iters: 200, epoch: 8 | loss: 0.1074763
	speed: 0.0671s/iter; left time: 2290.7561s
	iters: 300, epoch: 8 | loss: 0.4724516
	speed: 0.0835s/iter; left time: 2839.3660s
Epoch: 8 cost time: 28.29063057899475
Epoch: 8, Steps: 369 | Train Loss: 0.314 Vali Loss: 0.730 Vali Acc: 0.663 Test Loss: 0.730 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1766127
	speed: 0.2837s/iter; left time: 9603.9391s
	iters: 200, epoch: 9 | loss: 0.3307090
	speed: 0.0858s/iter; left time: 2895.5623s
	iters: 300, epoch: 9 | loss: 0.0788581
	speed: 0.0727s/iter; left time: 2446.8507s
Epoch: 9 cost time: 28.618690490722656
Epoch: 9, Steps: 369 | Train Loss: 0.250 Vali Loss: 0.932 Vali Acc: 0.657 Test Loss: 0.932 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2131394
	speed: 0.2972s/iter; left time: 9951.1130s
	iters: 200, epoch: 10 | loss: 0.4811063
	speed: 0.0826s/iter; left time: 2757.7954s
	iters: 300, epoch: 10 | loss: 0.3940676
	speed: 0.0636s/iter; left time: 2115.6914s
Epoch: 10 cost time: 30.03896427154541
Epoch: 10, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.100 Vali Acc: 0.646 Test Loss: 1.100 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.3444239
	speed: 0.3144s/iter; left time: 10411.0288s
	iters: 200, epoch: 11 | loss: 0.2438706
	speed: 0.0702s/iter; left time: 2318.5195s
	iters: 300, epoch: 11 | loss: 0.0213904
	speed: 0.0888s/iter; left time: 2921.8215s
Epoch: 11 cost time: 30.269633531570435
Epoch: 11, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.221 Vali Acc: 0.654 Test Loss: 1.221 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0276360
	speed: 0.3274s/iter; left time: 10719.9182s
	iters: 200, epoch: 12 | loss: 0.0536851
	speed: 0.0935s/iter; left time: 3052.3036s
	iters: 300, epoch: 12 | loss: 0.0173261
	speed: 0.1001s/iter; left time: 3255.9331s
Epoch: 12 cost time: 34.168644189834595
Epoch: 12, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.405 Vali Acc: 0.657 Test Loss: 1.405 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1281921
	speed: 0.3017s/iter; left time: 9766.6267s
	iters: 200, epoch: 13 | loss: 0.0055515
	speed: 0.0763s/iter; left time: 2462.7108s
	iters: 300, epoch: 13 | loss: 0.0930391
	speed: 0.0689s/iter; left time: 2217.2476s
Epoch: 13 cost time: 27.57522177696228
Epoch: 13, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.847 Vali Acc: 0.627 Test Loss: 1.847 Test Acc: 0.627
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0177611
	speed: 0.2873s/iter; left time: 9193.7345s
	iters: 200, epoch: 14 | loss: 0.0103220
	speed: 0.0670s/iter; left time: 2136.1217s
	iters: 300, epoch: 14 | loss: 0.0010044
	speed: 0.0621s/iter; left time: 1973.8842s
Epoch: 14 cost time: 22.434304237365723
Epoch: 14, Steps: 369 | Train Loss: 0.093 Vali Loss: 2.139 Vali Acc: 0.652 Test Loss: 2.139 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0737531
	speed: 0.1570s/iter; left time: 4968.2284s
	iters: 200, epoch: 15 | loss: 0.0052845
	speed: 0.0458s/iter; left time: 1443.3317s
	iters: 300, epoch: 15 | loss: 0.0973773
	speed: 0.0769s/iter; left time: 2418.5468s
Epoch: 15 cost time: 21.338069438934326
Epoch: 15, Steps: 369 | Train Loss: 0.084 Vali Loss: 2.168 Vali Acc: 0.657 Test Loss: 2.168 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6730987514188422
model parameter : 420762
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6197543
	speed: 0.0809s/iter; left time: 2977.4780s
	iters: 200, epoch: 1 | loss: 0.6428385
	speed: 0.0802s/iter; left time: 2941.7078s
	iters: 300, epoch: 1 | loss: 0.6269769
	speed: 0.0813s/iter; left time: 2974.3203s
Epoch: 1 cost time: 29.61977219581604
Epoch: 1, Steps: 369 | Train Loss: 1.090 Vali Loss: 2.116 Vali Acc: 0.545 Test Loss: 2.116 Test Acc: 0.545
Validation loss decreased (inf --> -0.545382).  Saving model ...
	iters: 100, epoch: 2 | loss: 3.2468266
	speed: 0.2845s/iter; left time: 10365.9656s
	iters: 200, epoch: 2 | loss: 1.7442241
	speed: 0.0770s/iter; left time: 2795.8107s
	iters: 300, epoch: 2 | loss: 0.8064582
	speed: 0.0786s/iter; left time: 2849.1251s
Epoch: 2 cost time: 28.5047345161438
Epoch: 2, Steps: 369 | Train Loss: 1.250 Vali Loss: 4.835 Vali Acc: 0.501 Test Loss: 4.835 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.4631426
	speed: 0.2720s/iter; left time: 9807.7191s
	iters: 200, epoch: 3 | loss: 1.5339086
	speed: 0.0704s/iter; left time: 2531.9644s
	iters: 300, epoch: 3 | loss: 0.9410214
	speed: 0.0746s/iter; left time: 2676.1818s
Epoch: 3 cost time: 28.552126169204712
Epoch: 3, Steps: 369 | Train Loss: 1.206 Vali Loss: 1.704 Vali Acc: 0.529 Test Loss: 1.704 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6394038
	speed: 0.2731s/iter; left time: 9749.5543s
	iters: 200, epoch: 4 | loss: 0.3728930
	speed: 0.0612s/iter; left time: 2179.7995s
	iters: 300, epoch: 4 | loss: 0.3886568
	speed: 0.0786s/iter; left time: 2788.4162s
Epoch: 4 cost time: 28.069044828414917
Epoch: 4, Steps: 369 | Train Loss: 0.638 Vali Loss: 0.703 Vali Acc: 0.656 Test Loss: 0.703 Test Acc: 0.656
Validation loss decreased (-0.545382 --> -0.656349).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3907597
	speed: 0.2799s/iter; left time: 9889.1254s
	iters: 200, epoch: 5 | loss: 1.2176619
	speed: 0.0892s/iter; left time: 3141.2472s
	iters: 300, epoch: 5 | loss: 0.5501587
	speed: 0.0864s/iter; left time: 3034.9463s
Epoch: 5 cost time: 30.324129819869995
Epoch: 5, Steps: 369 | Train Loss: 0.511 Vali Loss: 0.642 Vali Acc: 0.665 Test Loss: 0.642 Test Acc: 0.665
Validation loss decreased (-0.656349 --> -0.665147).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3066327
	speed: 0.3228s/iter; left time: 11284.9754s
	iters: 200, epoch: 6 | loss: 0.3301602
	speed: 0.0894s/iter; left time: 3115.4708s
	iters: 300, epoch: 6 | loss: 0.1964040
	speed: 0.0818s/iter; left time: 2844.5669s
Epoch: 6 cost time: 32.66084861755371
Epoch: 6, Steps: 369 | Train Loss: 0.437 Vali Loss: 0.712 Vali Acc: 0.682 Test Loss: 0.712 Test Acc: 0.682
Validation loss decreased (-0.665147 --> -0.682172).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6410984
	speed: 0.3208s/iter; left time: 11097.0730s
	iters: 200, epoch: 7 | loss: 0.1478301
	speed: 0.0819s/iter; left time: 2823.3862s
	iters: 300, epoch: 7 | loss: 0.4072317
	speed: 0.0586s/iter; left time: 2015.9445s
Epoch: 7 cost time: 28.277829885482788
Epoch: 7, Steps: 369 | Train Loss: 0.369 Vali Loss: 0.689 Vali Acc: 0.653 Test Loss: 0.689 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3857170
	speed: 0.2875s/iter; left time: 9839.3696s
	iters: 200, epoch: 8 | loss: 0.1719324
	speed: 0.0759s/iter; left time: 2588.5399s
	iters: 300, epoch: 8 | loss: 0.2824129
	speed: 0.0824s/iter; left time: 2803.9705s
Epoch: 8 cost time: 29.646228551864624
Epoch: 8, Steps: 369 | Train Loss: 0.324 Vali Loss: 0.920 Vali Acc: 0.663 Test Loss: 0.920 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2707916
	speed: 0.2901s/iter; left time: 9819.2627s
	iters: 200, epoch: 9 | loss: 0.3465192
	speed: 0.0725s/iter; left time: 2447.7354s
	iters: 300, epoch: 9 | loss: 0.3792748
	speed: 0.0797s/iter; left time: 2681.5408s
Epoch: 9 cost time: 28.293149709701538
Epoch: 9, Steps: 369 | Train Loss: 0.265 Vali Loss: 0.803 Vali Acc: 0.659 Test Loss: 0.803 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4344398
	speed: 0.2905s/iter; left time: 9727.1678s
	iters: 200, epoch: 10 | loss: 0.1077236
	speed: 0.0788s/iter; left time: 2630.6699s
	iters: 300, epoch: 10 | loss: 0.0283879
	speed: 0.0705s/iter; left time: 2346.6628s
Epoch: 10 cost time: 28.64055061340332
Epoch: 10, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.138 Vali Acc: 0.644 Test Loss: 1.138 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1927297
	speed: 0.2750s/iter; left time: 9106.0363s
	iters: 200, epoch: 11 | loss: 0.0342995
	speed: 0.0657s/iter; left time: 2168.0844s
	iters: 300, epoch: 11 | loss: 0.5852575
	speed: 0.0737s/iter; left time: 2424.5512s
Epoch: 11 cost time: 26.16361665725708
Epoch: 11, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.667 Vali Acc: 0.643 Test Loss: 1.667 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0530915
	speed: 0.2788s/iter; left time: 9128.3084s
	iters: 200, epoch: 12 | loss: 0.0690544
	speed: 0.0775s/iter; left time: 2529.4277s
	iters: 300, epoch: 12 | loss: 0.0580964
	speed: 0.0770s/iter; left time: 2504.4663s
Epoch: 12 cost time: 28.096668481826782
Epoch: 12, Steps: 369 | Train Loss: 0.129 Vali Loss: 1.583 Vali Acc: 0.649 Test Loss: 1.583 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0663286
	speed: 0.2780s/iter; left time: 8999.3017s
	iters: 200, epoch: 13 | loss: 0.0118187
	speed: 0.0773s/iter; left time: 2496.2713s
	iters: 300, epoch: 13 | loss: 0.1257486
	speed: 0.0709s/iter; left time: 2281.5267s
Epoch: 13 cost time: 28.326464891433716
Epoch: 13, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.471 Vali Acc: 0.649 Test Loss: 1.471 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0819840
	speed: 0.2759s/iter; left time: 8828.8817s
	iters: 200, epoch: 14 | loss: 0.0495191
	speed: 0.0632s/iter; left time: 2016.4269s
	iters: 300, epoch: 14 | loss: 0.1829191
	speed: 0.0687s/iter; left time: 2186.3715s
Epoch: 14 cost time: 26.066176414489746
Epoch: 14, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.895 Vali Acc: 0.655 Test Loss: 1.895 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2522155
	speed: 0.2776s/iter; left time: 8780.9220s
	iters: 200, epoch: 15 | loss: 0.3967900
	speed: 0.0700s/iter; left time: 2206.6909s
	iters: 300, epoch: 15 | loss: 0.1451449
	speed: 0.0863s/iter; left time: 2712.7672s
Epoch: 15 cost time: 28.262657642364502
Epoch: 15, Steps: 369 | Train Loss: 0.098 Vali Loss: 2.217 Vali Acc: 0.641 Test Loss: 2.217 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0014942
	speed: 0.3027s/iter; left time: 9465.3750s
	iters: 200, epoch: 16 | loss: 0.2672366
	speed: 0.0942s/iter; left time: 2937.2044s
	iters: 300, epoch: 16 | loss: 0.0711220
	speed: 0.0809s/iter; left time: 2513.6549s
Epoch: 16 cost time: 31.1989586353302
Epoch: 16, Steps: 369 | Train Loss: 0.075 Vali Loss: 2.163 Vali Acc: 0.635 Test Loss: 2.163 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6821793416572077
model parameter : 420378
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8856616
	speed: 0.1054s/iter; left time: 3878.4225s
	iters: 200, epoch: 1 | loss: 0.8186836
	speed: 0.0743s/iter; left time: 2726.5950s
	iters: 300, epoch: 1 | loss: 0.2720350
	speed: 0.0776s/iter; left time: 2842.0414s
Epoch: 1 cost time: 29.781066417694092
Epoch: 1, Steps: 369 | Train Loss: 0.900 Vali Loss: 0.741 Vali Acc: 0.652 Test Loss: 0.741 Test Acc: 0.652
Validation loss decreased (inf --> -0.651525).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2333109
	speed: 0.2567s/iter; left time: 9352.5254s
	iters: 200, epoch: 2 | loss: 1.3575395
	speed: 0.0715s/iter; left time: 2599.1618s
	iters: 300, epoch: 2 | loss: 1.1896498
	speed: 0.0643s/iter; left time: 2329.8605s
Epoch: 2 cost time: 26.166457176208496
Epoch: 2, Steps: 369 | Train Loss: 0.953 Vali Loss: 1.333 Vali Acc: 0.561 Test Loss: 1.333 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0588355
	speed: 0.2533s/iter; left time: 9135.5556s
	iters: 200, epoch: 3 | loss: 0.8362265
	speed: 0.0675s/iter; left time: 2428.9175s
	iters: 300, epoch: 3 | loss: 0.4712474
	speed: 0.0740s/iter; left time: 2655.0523s
Epoch: 3 cost time: 27.57327437400818
Epoch: 3, Steps: 369 | Train Loss: 0.734 Vali Loss: 2.469 Vali Acc: 0.503 Test Loss: 2.469 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.2919439
	speed: 0.2536s/iter; left time: 9053.1075s
	iters: 200, epoch: 4 | loss: 1.0649056
	speed: 0.0449s/iter; left time: 1598.4680s
	iters: 300, epoch: 4 | loss: 0.3407165
	speed: 0.0509s/iter; left time: 1805.8072s
Epoch: 4 cost time: 19.300415992736816
Epoch: 4, Steps: 369 | Train Loss: 0.587 Vali Loss: 1.074 Vali Acc: 0.596 Test Loss: 1.074 Test Acc: 0.596
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6807418
	speed: 0.1558s/iter; left time: 5503.9385s
	iters: 200, epoch: 5 | loss: 0.3585756
	speed: 0.0513s/iter; left time: 1805.5990s
	iters: 300, epoch: 5 | loss: 0.7067544
	speed: 0.0702s/iter; left time: 2466.5375s
Epoch: 5 cost time: 21.57348346710205
Epoch: 5, Steps: 369 | Train Loss: 0.527 Vali Loss: 0.695 Vali Acc: 0.649 Test Loss: 0.695 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.1438957
	speed: 0.2551s/iter; left time: 8918.3104s
	iters: 200, epoch: 6 | loss: 0.4620820
	speed: 0.0768s/iter; left time: 2678.2396s
	iters: 300, epoch: 6 | loss: 0.4941884
	speed: 0.0742s/iter; left time: 2580.5357s
Epoch: 6 cost time: 27.723108291625977
Epoch: 6, Steps: 369 | Train Loss: 0.441 Vali Loss: 0.729 Vali Acc: 0.668 Test Loss: 0.729 Test Acc: 0.668
Validation loss decreased (-0.651525 --> -0.668267).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2295550
	speed: 0.2597s/iter; left time: 8981.7553s
	iters: 200, epoch: 7 | loss: 0.2339332
	speed: 0.0763s/iter; left time: 2632.8466s
	iters: 300, epoch: 7 | loss: 0.4063225
	speed: 0.0675s/iter; left time: 2321.2602s
Epoch: 7 cost time: 27.120365858078003
Epoch: 7, Steps: 369 | Train Loss: 0.398 Vali Loss: 0.819 Vali Acc: 0.674 Test Loss: 0.819 Test Acc: 0.674
Validation loss decreased (-0.668267 --> -0.673942).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8919027
	speed: 0.2601s/iter; left time: 8899.0548s
	iters: 200, epoch: 8 | loss: 0.3320309
	speed: 0.0776s/iter; left time: 2647.8701s
	iters: 300, epoch: 8 | loss: 0.4238729
	speed: 0.0633s/iter; left time: 2153.5197s
Epoch: 8 cost time: 25.850473165512085
Epoch: 8, Steps: 369 | Train Loss: 0.356 Vali Loss: 0.800 Vali Acc: 0.659 Test Loss: 0.800 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7907598
	speed: 0.2503s/iter; left time: 8473.8644s
	iters: 200, epoch: 9 | loss: 0.4001766
	speed: 0.0646s/iter; left time: 2180.9247s
	iters: 300, epoch: 9 | loss: 0.8349575
	speed: 0.0594s/iter; left time: 2000.4119s
Epoch: 9 cost time: 24.882088899612427
Epoch: 9, Steps: 369 | Train Loss: 0.310 Vali Loss: 0.740 Vali Acc: 0.669 Test Loss: 0.740 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1017108
	speed: 0.2503s/iter; left time: 8378.6013s
	iters: 200, epoch: 10 | loss: 0.3863808
	speed: 0.0674s/iter; left time: 2251.4328s
	iters: 300, epoch: 10 | loss: 0.3421845
	speed: 0.0609s/iter; left time: 2026.0904s
Epoch: 10 cost time: 26.91307258605957
Epoch: 10, Steps: 369 | Train Loss: 0.262 Vali Loss: 0.984 Vali Acc: 0.648 Test Loss: 0.984 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2826003
	speed: 0.2937s/iter; left time: 9723.3208s
	iters: 200, epoch: 11 | loss: 0.2481802
	speed: 0.0686s/iter; left time: 2264.8030s
	iters: 300, epoch: 11 | loss: 0.1246013
	speed: 0.0854s/iter; left time: 2810.9490s
Epoch: 11 cost time: 30.05724811553955
Epoch: 11, Steps: 369 | Train Loss: 0.250 Vali Loss: 0.869 Vali Acc: 0.647 Test Loss: 0.869 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1744670
	speed: 0.2600s/iter; left time: 8513.5151s
	iters: 200, epoch: 12 | loss: 0.0700337
	speed: 0.0835s/iter; left time: 2724.8854s
	iters: 300, epoch: 12 | loss: 0.1875586
	speed: 0.0855s/iter; left time: 2782.5199s
Epoch: 12 cost time: 28.673903703689575
Epoch: 12, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.236 Vali Acc: 0.642 Test Loss: 1.236 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0350185
	speed: 0.2774s/iter; left time: 8979.6789s
	iters: 200, epoch: 13 | loss: 0.0936972
	speed: 0.0759s/iter; left time: 2448.0790s
	iters: 300, epoch: 13 | loss: 0.1231258
	speed: 0.0720s/iter; left time: 2316.2957s
Epoch: 13 cost time: 28.08622145652771
Epoch: 13, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.067 Vali Acc: 0.649 Test Loss: 1.067 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0587972
	speed: 0.2657s/iter; left time: 8502.2597s
	iters: 200, epoch: 14 | loss: 0.4537860
	speed: 0.0684s/iter; left time: 2182.6018s
	iters: 300, epoch: 14 | loss: 0.0714526
	speed: 0.0628s/iter; left time: 1998.4743s
Epoch: 14 cost time: 25.312198400497437
Epoch: 14, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.324 Vali Acc: 0.654 Test Loss: 1.324 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0734497
	speed: 0.2520s/iter; left time: 7972.8246s
	iters: 200, epoch: 15 | loss: 0.2563337
	speed: 0.0576s/iter; left time: 1817.7406s
	iters: 300, epoch: 15 | loss: 0.1086083
	speed: 0.0648s/iter; left time: 2036.1633s
Epoch: 15 cost time: 25.53908085823059
Epoch: 15, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.703 Vali Acc: 0.650 Test Loss: 1.703 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0915385
	speed: 0.2631s/iter; left time: 8225.6689s
	iters: 200, epoch: 16 | loss: 0.2802372
	speed: 0.0550s/iter; left time: 1714.4659s
	iters: 300, epoch: 16 | loss: 0.0627036
	speed: 0.0689s/iter; left time: 2141.8589s
Epoch: 16 cost time: 25.358885526657104
Epoch: 16, Steps: 369 | Train Loss: 0.125 Vali Loss: 1.624 Vali Acc: 0.645 Test Loss: 1.624 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0553819
	speed: 0.2487s/iter; left time: 7684.2491s
	iters: 200, epoch: 17 | loss: 0.0710469
	speed: 0.0554s/iter; left time: 1704.7156s
	iters: 300, epoch: 17 | loss: 0.0251302
	speed: 0.0674s/iter; left time: 2069.1445s
Epoch: 17 cost time: 24.165652751922607
Epoch: 17, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.732 Vali Acc: 0.646 Test Loss: 1.732 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.673950056753689
model parameter : 336538
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6706055
	speed: 0.0826s/iter; left time: 3039.9330s
	iters: 200, epoch: 1 | loss: 1.1188501
	speed: 0.0623s/iter; left time: 2284.9016s
	iters: 300, epoch: 1 | loss: 0.5104715
	speed: 0.0758s/iter; left time: 2775.7199s
Epoch: 1 cost time: 27.301559925079346
Epoch: 1, Steps: 369 | Train Loss: 0.854 Vali Loss: 1.199 Vali Acc: 0.578 Test Loss: 1.199 Test Acc: 0.578
Validation loss decreased (inf --> -0.578308).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4050034
	speed: 0.2370s/iter; left time: 8634.4096s
	iters: 200, epoch: 2 | loss: 0.5718282
	speed: 0.0690s/iter; left time: 2507.5453s
	iters: 300, epoch: 2 | loss: 0.6018679
	speed: 0.0735s/iter; left time: 2664.2739s
Epoch: 2 cost time: 25.000643014907837
Epoch: 2, Steps: 369 | Train Loss: 0.894 Vali Loss: 0.985 Vali Acc: 0.622 Test Loss: 0.985 Test Acc: 0.622
Validation loss decreased (-0.578308 --> -0.621727).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4581448
	speed: 0.2361s/iter; left time: 8514.6819s
	iters: 200, epoch: 3 | loss: 0.5920714
	speed: 0.0774s/iter; left time: 2784.2773s
	iters: 300, epoch: 3 | loss: 1.2487018
	speed: 0.0662s/iter; left time: 2374.6549s
Epoch: 3 cost time: 26.736839294433594
Epoch: 3, Steps: 369 | Train Loss: 0.777 Vali Loss: 0.864 Vali Acc: 0.642 Test Loss: 0.864 Test Acc: 0.642
Validation loss decreased (-0.621727 --> -0.642443).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8104590
	speed: 0.2114s/iter; left time: 7544.1456s
	iters: 200, epoch: 4 | loss: 0.1235740
	speed: 0.0324s/iter; left time: 1151.5107s
	iters: 300, epoch: 4 | loss: 0.4083611
	speed: 0.0330s/iter; left time: 1172.1769s
Epoch: 4 cost time: 12.439459562301636
Epoch: 4, Steps: 369 | Train Loss: 0.633 Vali Loss: 0.676 Vali Acc: 0.667 Test Loss: 0.676 Test Acc: 0.667
Validation loss decreased (-0.642443 --> -0.667417).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3457967
	speed: 0.2405s/iter; left time: 8494.4798s
	iters: 200, epoch: 5 | loss: 0.5840112
	speed: 0.0795s/iter; left time: 2800.8098s
	iters: 300, epoch: 5 | loss: 0.5603136
	speed: 0.0627s/iter; left time: 2203.0674s
Epoch: 5 cost time: 28.64292073249817
Epoch: 5, Steps: 369 | Train Loss: 0.537 Vali Loss: 0.651 Vali Acc: 0.670 Test Loss: 0.651 Test Acc: 0.670
Validation loss decreased (-0.667417 --> -0.670255).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3093863
	speed: 0.2977s/iter; left time: 10405.4855s
	iters: 200, epoch: 6 | loss: 0.5222910
	speed: 0.0774s/iter; left time: 2697.2855s
	iters: 300, epoch: 6 | loss: 0.2489542
	speed: 0.0576s/iter; left time: 2003.0655s
Epoch: 6 cost time: 27.873013973236084
Epoch: 6, Steps: 369 | Train Loss: 0.470 Vali Loss: 0.693 Vali Acc: 0.673 Test Loss: 0.693 Test Acc: 0.673
Validation loss decreased (-0.670255 --> -0.673092).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2287000
	speed: 0.2652s/iter; left time: 9173.8890s
	iters: 200, epoch: 7 | loss: 0.2217524
	speed: 0.0620s/iter; left time: 2136.6138s
	iters: 300, epoch: 7 | loss: 0.6048232
	speed: 0.0558s/iter; left time: 1920.1101s
Epoch: 7 cost time: 24.767577171325684
Epoch: 7, Steps: 369 | Train Loss: 0.405 Vali Loss: 0.812 Vali Acc: 0.667 Test Loss: 0.812 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2482696
	speed: 0.2538s/iter; left time: 8685.8695s
	iters: 200, epoch: 8 | loss: 0.2404735
	speed: 0.0533s/iter; left time: 1817.0127s
	iters: 300, epoch: 8 | loss: 0.2213232
	speed: 0.0806s/iter; left time: 2740.4374s
Epoch: 8 cost time: 26.585237503051758
Epoch: 8, Steps: 369 | Train Loss: 0.377 Vali Loss: 0.764 Vali Acc: 0.659 Test Loss: 0.764 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0964060
	speed: 0.2473s/iter; left time: 8371.3764s
	iters: 200, epoch: 9 | loss: 0.4106676
	speed: 0.0605s/iter; left time: 2041.5276s
	iters: 300, epoch: 9 | loss: 0.3616166
	speed: 0.0774s/iter; left time: 2604.5436s
Epoch: 9 cost time: 25.643555164337158
Epoch: 9, Steps: 369 | Train Loss: 0.318 Vali Loss: 0.861 Vali Acc: 0.665 Test Loss: 0.861 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2326947
	speed: 0.2412s/iter; left time: 8075.7656s
	iters: 200, epoch: 10 | loss: 0.3570551
	speed: 0.0798s/iter; left time: 2664.7509s
	iters: 300, epoch: 10 | loss: 0.4199595
	speed: 0.0745s/iter; left time: 2478.3387s
Epoch: 10 cost time: 27.269254207611084
Epoch: 10, Steps: 369 | Train Loss: 0.279 Vali Loss: 0.958 Vali Acc: 0.654 Test Loss: 0.958 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4935277
	speed: 0.2463s/iter; left time: 8156.7518s
	iters: 200, epoch: 11 | loss: 0.0810788
	speed: 0.0782s/iter; left time: 2580.4404s
	iters: 300, epoch: 11 | loss: 0.2199305
	speed: 0.0678s/iter; left time: 2229.9197s
Epoch: 11 cost time: 27.53679347038269
Epoch: 11, Steps: 369 | Train Loss: 0.250 Vali Loss: 1.226 Vali Acc: 0.646 Test Loss: 1.226 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0359530
	speed: 0.2579s/iter; left time: 8443.8440s
	iters: 200, epoch: 12 | loss: 0.1818459
	speed: 0.0719s/iter; left time: 2347.3744s
	iters: 300, epoch: 12 | loss: 0.3325638
	speed: 0.0612s/iter; left time: 1991.5936s
Epoch: 12 cost time: 26.68999409675598
Epoch: 12, Steps: 369 | Train Loss: 0.223 Vali Loss: 1.040 Vali Acc: 0.652 Test Loss: 1.040 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6470994
	speed: 0.2498s/iter; left time: 8086.2611s
	iters: 200, epoch: 13 | loss: 0.1786917
	speed: 0.0653s/iter; left time: 2108.7018s
	iters: 300, epoch: 13 | loss: 0.1875014
	speed: 0.0540s/iter; left time: 1738.4825s
Epoch: 13 cost time: 24.26974081993103
Epoch: 13, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.312 Vali Acc: 0.654 Test Loss: 1.312 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.3099410
	speed: 0.2508s/iter; left time: 8026.7024s
	iters: 200, epoch: 14 | loss: 0.1779792
	speed: 0.0629s/iter; left time: 2006.3252s
	iters: 300, epoch: 14 | loss: 0.1047951
	speed: 0.0772s/iter; left time: 2453.8107s
Epoch: 14 cost time: 27.010169506072998
Epoch: 14, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.258 Vali Acc: 0.656 Test Loss: 1.258 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1990378
	speed: 0.2467s/iter; left time: 7803.3346s
	iters: 200, epoch: 15 | loss: 0.2139029
	speed: 0.0752s/iter; left time: 2370.8431s
	iters: 300, epoch: 15 | loss: 0.0777831
	speed: 0.0789s/iter; left time: 2481.2983s
Epoch: 15 cost time: 27.963979482650757
Epoch: 15, Steps: 369 | Train Loss: 0.145 Vali Loss: 1.418 Vali Acc: 0.652 Test Loss: 1.418 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.3689651
	speed: 0.2918s/iter; left time: 9124.6112s
	iters: 200, epoch: 16 | loss: 0.0081314
	speed: 0.0796s/iter; left time: 2479.3181s
	iters: 300, epoch: 16 | loss: 0.1493567
	speed: 0.0733s/iter; left time: 2275.9823s
Epoch: 16 cost time: 30.713346004486084
Epoch: 16, Steps: 369 | Train Loss: 0.125 Vali Loss: 1.860 Vali Acc: 0.657 Test Loss: 1.860 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6730987514188422
model parameter : 336346
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6791673
	speed: 0.0977s/iter; left time: 3596.4458s
	iters: 200, epoch: 1 | loss: 0.6107396
	speed: 0.0812s/iter; left time: 2980.4279s
	iters: 300, epoch: 1 | loss: 0.5542657
	speed: 0.0637s/iter; left time: 2330.6539s
Epoch: 1 cost time: 28.540937900543213
Epoch: 1, Steps: 369 | Train Loss: 0.797 Vali Loss: 0.798 Vali Acc: 0.637 Test Loss: 0.798 Test Acc: 0.637
Validation loss decreased (inf --> -0.636768).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3774692
	speed: 0.2545s/iter; left time: 9270.1549s
	iters: 200, epoch: 2 | loss: 0.5556348
	speed: 0.0630s/iter; left time: 2287.6775s
	iters: 300, epoch: 2 | loss: 0.3716880
	speed: 0.0640s/iter; left time: 2317.3180s
Epoch: 2 cost time: 25.479252338409424
Epoch: 2, Steps: 369 | Train Loss: 0.816 Vali Loss: 0.714 Vali Acc: 0.644 Test Loss: 0.714 Test Acc: 0.644
Validation loss decreased (-0.636768 --> -0.643580).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2408419
	speed: 0.2428s/iter; left time: 8754.3388s
	iters: 200, epoch: 3 | loss: 0.4997499
	speed: 0.0571s/iter; left time: 2052.3506s
	iters: 300, epoch: 3 | loss: 0.9229974
	speed: 0.0586s/iter; left time: 2100.8256s
Epoch: 3 cost time: 23.7448468208313
Epoch: 3, Steps: 369 | Train Loss: 0.765 Vali Loss: 0.703 Vali Acc: 0.603 Test Loss: 0.703 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3820698
	speed: 0.2369s/iter; left time: 8457.6380s
	iters: 200, epoch: 4 | loss: 0.7399310
	speed: 0.0615s/iter; left time: 2188.5561s
	iters: 300, epoch: 4 | loss: 0.8195310
	speed: 0.0814s/iter; left time: 2890.5968s
Epoch: 4 cost time: 26.433452367782593
Epoch: 4, Steps: 369 | Train Loss: 0.613 Vali Loss: 0.716 Vali Acc: 0.636 Test Loss: 0.716 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6482745
	speed: 0.2437s/iter; left time: 8609.2768s
	iters: 200, epoch: 5 | loss: 0.4521336
	speed: 0.0614s/iter; left time: 2164.0062s
	iters: 300, epoch: 5 | loss: 0.2940939
	speed: 0.0774s/iter; left time: 2717.0332s
Epoch: 5 cost time: 25.929685592651367
Epoch: 5, Steps: 369 | Train Loss: 0.517 Vali Loss: 0.666 Vali Acc: 0.649 Test Loss: 0.666 Test Acc: 0.649
Validation loss decreased (-0.643580 --> -0.648972).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6798787
	speed: 0.2402s/iter; left time: 8398.0043s
	iters: 200, epoch: 6 | loss: 0.6328318
	speed: 0.0805s/iter; left time: 2804.6668s
	iters: 300, epoch: 6 | loss: 0.6901019
	speed: 0.0742s/iter; left time: 2578.8442s
Epoch: 6 cost time: 26.367115020751953
Epoch: 6, Steps: 369 | Train Loss: 0.456 Vali Loss: 0.701 Vali Acc: 0.668 Test Loss: 0.701 Test Acc: 0.668
Validation loss decreased (-0.648972 --> -0.667984).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4940627
	speed: 0.2457s/iter; left time: 8498.0750s
	iters: 200, epoch: 7 | loss: 0.3581964
	speed: 0.0824s/iter; left time: 2842.6680s
	iters: 300, epoch: 7 | loss: 0.5747207
	speed: 0.0683s/iter; left time: 2349.7202s
Epoch: 7 cost time: 28.09540867805481
Epoch: 7, Steps: 369 | Train Loss: 0.401 Vali Loss: 0.784 Vali Acc: 0.662 Test Loss: 0.784 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3388211
	speed: 0.2442s/iter; left time: 8356.4690s
	iters: 200, epoch: 8 | loss: 0.3343033
	speed: 0.0709s/iter; left time: 2418.6984s
	iters: 300, epoch: 8 | loss: 0.1765888
	speed: 0.0596s/iter; left time: 2027.0863s
Epoch: 8 cost time: 25.59971857070923
Epoch: 8, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.742 Vali Acc: 0.665 Test Loss: 0.742 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3241766
	speed: 0.2536s/iter; left time: 8584.6993s
	iters: 200, epoch: 9 | loss: 0.1791114
	speed: 0.0622s/iter; left time: 2097.8544s
	iters: 300, epoch: 9 | loss: 0.2805676
	speed: 0.0631s/iter; left time: 2123.0258s
Epoch: 9 cost time: 25.844167947769165
Epoch: 9, Steps: 369 | Train Loss: 0.315 Vali Loss: 0.802 Vali Acc: 0.659 Test Loss: 0.802 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1416396
	speed: 0.2467s/iter; left time: 8258.8070s
	iters: 200, epoch: 10 | loss: 0.2824691
	speed: 0.0614s/iter; left time: 2047.9971s
	iters: 300, epoch: 10 | loss: 0.1174276
	speed: 0.0725s/iter; left time: 2414.1928s
Epoch: 10 cost time: 25.67979335784912
Epoch: 10, Steps: 369 | Train Loss: 0.294 Vali Loss: 0.995 Vali Acc: 0.647 Test Loss: 0.995 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1217522
	speed: 0.2645s/iter; left time: 8758.9606s
	iters: 200, epoch: 11 | loss: 0.1308160
	speed: 0.0741s/iter; left time: 2446.3509s
	iters: 300, epoch: 11 | loss: 0.4364532
	speed: 0.0852s/iter; left time: 2802.6195s
Epoch: 11 cost time: 28.66791796684265
Epoch: 11, Steps: 369 | Train Loss: 0.255 Vali Loss: 1.088 Vali Acc: 0.657 Test Loss: 1.088 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2263823
	speed: 0.2824s/iter; left time: 9247.0385s
	iters: 200, epoch: 12 | loss: 0.2148666
	speed: 0.0906s/iter; left time: 2958.1887s
	iters: 300, epoch: 12 | loss: 0.2216052
	speed: 0.0907s/iter; left time: 2950.2164s
Epoch: 12 cost time: 31.340192317962646
Epoch: 12, Steps: 369 | Train Loss: 0.224 Vali Loss: 1.144 Vali Acc: 0.639 Test Loss: 1.144 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.3394396
	speed: 0.2721s/iter; left time: 8809.1227s
	iters: 200, epoch: 13 | loss: 0.0871336
	speed: 0.0856s/iter; left time: 2762.5392s
	iters: 300, epoch: 13 | loss: 0.0402659
	speed: 0.0602s/iter; left time: 1936.7551s
Epoch: 13 cost time: 28.182052850723267
Epoch: 13, Steps: 369 | Train Loss: 0.185 Vali Loss: 1.277 Vali Acc: 0.641 Test Loss: 1.277 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0188077
	speed: 0.2579s/iter; left time: 8254.0013s
	iters: 200, epoch: 14 | loss: 0.0640884
	speed: 0.0653s/iter; left time: 2082.9268s
	iters: 300, epoch: 14 | loss: 0.1160346
	speed: 0.0650s/iter; left time: 2065.8603s
Epoch: 14 cost time: 26.026707649230957
Epoch: 14, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.372 Vali Acc: 0.644 Test Loss: 1.372 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.4373749
	speed: 0.2595s/iter; left time: 8210.3367s
	iters: 200, epoch: 15 | loss: 0.1261148
	speed: 0.0659s/iter; left time: 2079.1406s
	iters: 300, epoch: 15 | loss: 0.2535275
	speed: 0.0561s/iter; left time: 1763.1981s
Epoch: 15 cost time: 24.995566368103027
Epoch: 15, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.396 Vali Acc: 0.651 Test Loss: 1.396 Test Acc: 0.651
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.3026390
	speed: 0.2358s/iter; left time: 7373.5829s
	iters: 200, epoch: 16 | loss: 0.1185843
	speed: 0.0612s/iter; left time: 1908.6563s
	iters: 300, epoch: 16 | loss: 0.3204532
	speed: 0.0579s/iter; left time: 1800.0416s
Epoch: 16 cost time: 21.748416662216187
Epoch: 16, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.506 Vali Acc: 0.649 Test Loss: 1.506 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6679909194097616
model parameter : 336154
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5116867
	speed: 0.0796s/iter; left time: 2928.6716s
	iters: 200, epoch: 1 | loss: 0.6983154
	speed: 0.0602s/iter; left time: 2209.7717s
	iters: 300, epoch: 1 | loss: 0.8202947
	speed: 0.0764s/iter; left time: 2795.4192s
Epoch: 1 cost time: 26.556265830993652
Epoch: 1, Steps: 369 | Train Loss: 0.805 Vali Loss: 1.640 Vali Acc: 0.533 Test Loss: 1.640 Test Acc: 0.533
Validation loss decreased (inf --> -0.532617).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7846435
	speed: 0.2344s/iter; left time: 8539.6324s
	iters: 200, epoch: 2 | loss: 1.3112086
	speed: 0.0646s/iter; left time: 2346.8059s
	iters: 300, epoch: 2 | loss: 0.3852949
	speed: 0.0771s/iter; left time: 2794.8313s
Epoch: 2 cost time: 25.516497373580933
Epoch: 2, Steps: 369 | Train Loss: 1.040 Vali Loss: 0.857 Vali Acc: 0.656 Test Loss: 0.857 Test Acc: 0.656
Validation loss decreased (-0.532617 --> -0.655497).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3441550
	speed: 0.2517s/iter; left time: 9078.3560s
	iters: 200, epoch: 3 | loss: 0.4231695
	speed: 0.0742s/iter; left time: 2668.7936s
	iters: 300, epoch: 3 | loss: 0.6909708
	speed: 0.0690s/iter; left time: 2473.5771s
Epoch: 3 cost time: 26.093175411224365
Epoch: 3, Steps: 369 | Train Loss: 0.816 Vali Loss: 0.735 Vali Acc: 0.633 Test Loss: 0.735 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0292751
	speed: 0.2275s/iter; left time: 8120.0043s
	iters: 200, epoch: 4 | loss: 0.6068282
	speed: 0.0718s/iter; left time: 2556.0498s
	iters: 300, epoch: 4 | loss: 0.4413095
	speed: 0.0612s/iter; left time: 2170.8551s
Epoch: 4 cost time: 25.1959388256073
Epoch: 4, Steps: 369 | Train Loss: 0.594 Vali Loss: 0.965 Vali Acc: 0.604 Test Loss: 0.965 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2918671
	speed: 0.2674s/iter; left time: 9446.6606s
	iters: 200, epoch: 5 | loss: 0.4882975
	speed: 0.0703s/iter; left time: 2476.9347s
	iters: 300, epoch: 5 | loss: 0.3777399
	speed: 0.0806s/iter; left time: 2831.7779s
Epoch: 5 cost time: 29.69870162010193
Epoch: 5, Steps: 369 | Train Loss: 0.506 Vali Loss: 0.791 Vali Acc: 0.647 Test Loss: 0.791 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3359669
	speed: 0.2653s/iter; left time: 9275.3381s
	iters: 200, epoch: 6 | loss: 0.5279329
	speed: 0.0685s/iter; left time: 2386.7245s
	iters: 300, epoch: 6 | loss: 0.4998842
	speed: 0.0829s/iter; left time: 2881.3040s
Epoch: 6 cost time: 27.668826580047607
Epoch: 6, Steps: 369 | Train Loss: 0.460 Vali Loss: 0.732 Vali Acc: 0.669 Test Loss: 0.732 Test Acc: 0.669
Validation loss decreased (-0.655497 --> -0.668551).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1476804
	speed: 0.2627s/iter; left time: 9086.2501s
	iters: 200, epoch: 7 | loss: 0.5459338
	speed: 0.0858s/iter; left time: 2960.1147s
	iters: 300, epoch: 7 | loss: 0.3061519
	speed: 0.0830s/iter; left time: 2854.1839s
Epoch: 7 cost time: 28.31575846672058
Epoch: 7, Steps: 369 | Train Loss: 0.402 Vali Loss: 0.748 Vali Acc: 0.658 Test Loss: 0.748 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1774808
	speed: 0.2352s/iter; left time: 8049.0664s
	iters: 200, epoch: 8 | loss: 0.5940113
	speed: 0.0797s/iter; left time: 2717.5188s
	iters: 300, epoch: 8 | loss: 0.6480948
	speed: 0.0653s/iter; left time: 2221.1150s
Epoch: 8 cost time: 25.766735553741455
Epoch: 8, Steps: 369 | Train Loss: 0.350 Vali Loss: 0.738 Vali Acc: 0.666 Test Loss: 0.738 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3291340
	speed: 0.2300s/iter; left time: 7785.7662s
	iters: 200, epoch: 9 | loss: 0.4434555
	speed: 0.0671s/iter; left time: 2263.9613s
	iters: 300, epoch: 9 | loss: 0.2570674
	speed: 0.0589s/iter; left time: 1982.5350s
Epoch: 9 cost time: 24.014796018600464
Epoch: 9, Steps: 369 | Train Loss: 0.315 Vali Loss: 1.060 Vali Acc: 0.616 Test Loss: 1.060 Test Acc: 0.616
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1227208
	speed: 0.2292s/iter; left time: 7674.0004s
	iters: 200, epoch: 10 | loss: 0.4276643
	speed: 0.0678s/iter; left time: 2263.8640s
	iters: 300, epoch: 10 | loss: 0.3880678
	speed: 0.0665s/iter; left time: 2213.7210s
Epoch: 10 cost time: 25.47635793685913
Epoch: 10, Steps: 369 | Train Loss: 0.281 Vali Loss: 1.223 Vali Acc: 0.655 Test Loss: 1.223 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1277885
	speed: 0.2369s/iter; left time: 7843.9368s
	iters: 200, epoch: 11 | loss: 0.2358306
	speed: 0.0566s/iter; left time: 1868.1326s
	iters: 300, epoch: 11 | loss: 0.2247626
	speed: 0.0686s/iter; left time: 2257.0624s
Epoch: 11 cost time: 23.45214533805847
Epoch: 11, Steps: 369 | Train Loss: 0.246 Vali Loss: 0.932 Vali Acc: 0.649 Test Loss: 0.932 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1105320
	speed: 0.2319s/iter; left time: 7594.1311s
	iters: 200, epoch: 12 | loss: 0.1491170
	speed: 0.0638s/iter; left time: 2081.4894s
	iters: 300, epoch: 12 | loss: 0.1289267
	speed: 0.0788s/iter; left time: 2564.0642s
Epoch: 12 cost time: 25.565059185028076
Epoch: 12, Steps: 369 | Train Loss: 0.205 Vali Loss: 1.218 Vali Acc: 0.654 Test Loss: 1.218 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1726943
	speed: 0.2223s/iter; left time: 7195.6526s
	iters: 200, epoch: 13 | loss: 0.1162236
	speed: 0.0737s/iter; left time: 2378.6893s
	iters: 300, epoch: 13 | loss: 0.1175472
	speed: 0.0677s/iter; left time: 2179.3379s
Epoch: 13 cost time: 23.102118492126465
Epoch: 13, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.180 Vali Acc: 0.646 Test Loss: 1.180 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2325526
	speed: 0.2348s/iter; left time: 7515.3971s
	iters: 200, epoch: 14 | loss: 0.0186350
	speed: 0.0686s/iter; left time: 2189.7961s
	iters: 300, epoch: 14 | loss: 0.1474858
	speed: 0.0579s/iter; left time: 1840.0570s
Epoch: 14 cost time: 24.165785312652588
Epoch: 14, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.381 Vali Acc: 0.647 Test Loss: 1.381 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2576639
	speed: 0.2406s/iter; left time: 7610.1227s
	iters: 200, epoch: 15 | loss: 0.1375226
	speed: 0.0711s/iter; left time: 2242.7857s
	iters: 300, epoch: 15 | loss: 0.1182003
	speed: 0.0631s/iter; left time: 1982.2229s
Epoch: 15 cost time: 25.776304960250854
Epoch: 15, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.442 Vali Acc: 0.648 Test Loss: 1.442 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0770209
	speed: 0.2297s/iter; left time: 7181.1955s
	iters: 200, epoch: 16 | loss: 0.0028987
	speed: 0.0650s/iter; left time: 2024.3620s
	iters: 300, epoch: 16 | loss: 0.0215338
	speed: 0.0668s/iter; left time: 2073.6935s
Epoch: 16 cost time: 25.268280744552612
Epoch: 16, Steps: 369 | Train Loss: 0.114 Vali Loss: 2.054 Vali Acc: 0.651 Test Loss: 2.054 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6685584562996595
model parameter : 335962
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.3278315
	speed: 0.0897s/iter; left time: 3299.4957s
	iters: 200, epoch: 1 | loss: 0.9981863
	speed: 0.0732s/iter; left time: 2686.4562s
	iters: 300, epoch: 1 | loss: 1.0342027
	speed: 0.0845s/iter; left time: 3094.2100s
Epoch: 1 cost time: 30.631171464920044
Epoch: 1, Steps: 369 | Train Loss: 0.830 Vali Loss: 2.301 Vali Acc: 0.507 Test Loss: 2.301 Test Acc: 0.507
Validation loss decreased (inf --> -0.506504).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9056104
	speed: 0.2687s/iter; left time: 9788.2679s
	iters: 200, epoch: 2 | loss: 3.5874710
	speed: 0.0796s/iter; left time: 2892.2438s
	iters: 300, epoch: 2 | loss: 1.0466354
	speed: 0.0702s/iter; left time: 2543.1428s
Epoch: 2 cost time: 26.71489381790161
Epoch: 2, Steps: 369 | Train Loss: 0.945 Vali Loss: 0.852 Vali Acc: 0.651 Test Loss: 0.852 Test Acc: 0.651
Validation loss decreased (-0.506504 --> -0.650673).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2165280
	speed: 0.2300s/iter; left time: 8296.1193s
	iters: 200, epoch: 3 | loss: 0.8398609
	speed: 0.0729s/iter; left time: 2622.6838s
	iters: 300, epoch: 3 | loss: 0.8865635
	speed: 0.0638s/iter; left time: 2286.9708s
Epoch: 3 cost time: 25.938236951828003
Epoch: 3, Steps: 369 | Train Loss: 0.727 Vali Loss: 0.851 Vali Acc: 0.608 Test Loss: 0.851 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6791962
	speed: 0.2415s/iter; left time: 8619.5191s
	iters: 200, epoch: 4 | loss: 0.3957500
	speed: 0.0636s/iter; left time: 2263.7532s
	iters: 300, epoch: 4 | loss: 0.9428554
	speed: 0.0596s/iter; left time: 2115.3492s
Epoch: 4 cost time: 24.66362714767456
Epoch: 4, Steps: 369 | Train Loss: 0.574 Vali Loss: 0.801 Vali Acc: 0.622 Test Loss: 0.801 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6968796
	speed: 0.2316s/iter; left time: 8179.6707s
	iters: 200, epoch: 5 | loss: 0.4434306
	speed: 0.0652s/iter; left time: 2295.2159s
	iters: 300, epoch: 5 | loss: 0.4399150
	speed: 0.0572s/iter; left time: 2008.6519s
Epoch: 5 cost time: 24.18790602684021
Epoch: 5, Steps: 369 | Train Loss: 0.512 Vali Loss: 0.679 Vali Acc: 0.673 Test Loss: 0.679 Test Acc: 0.673
Validation loss decreased (-0.650673 --> -0.672524).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3074023
	speed: 0.2327s/iter; left time: 8135.0776s
	iters: 200, epoch: 6 | loss: 0.3930830
	speed: 0.0641s/iter; left time: 2233.4382s
	iters: 300, epoch: 6 | loss: 0.2848354
	speed: 0.0740s/iter; left time: 2573.1085s
Epoch: 6 cost time: 26.175286769866943
Epoch: 6, Steps: 369 | Train Loss: 0.432 Vali Loss: 0.679 Vali Acc: 0.677 Test Loss: 0.679 Test Acc: 0.677
Validation loss decreased (-0.672524 --> -0.677065).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4610005
	speed: 0.2306s/iter; left time: 7975.9645s
	iters: 200, epoch: 7 | loss: 0.4308628
	speed: 0.0701s/iter; left time: 2417.2310s
	iters: 300, epoch: 7 | loss: 0.1544796
	speed: 0.0728s/iter; left time: 2504.1743s
Epoch: 7 cost time: 25.32412052154541
Epoch: 7, Steps: 369 | Train Loss: 0.394 Vali Loss: 0.726 Vali Acc: 0.671 Test Loss: 0.726 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4245881
	speed: 0.2328s/iter; left time: 7964.5745s
	iters: 200, epoch: 8 | loss: 0.5288916
	speed: 0.0719s/iter; left time: 2451.5365s
	iters: 300, epoch: 8 | loss: 0.5528249
	speed: 0.0721s/iter; left time: 2451.5041s
Epoch: 8 cost time: 26.797117948532104
Epoch: 8, Steps: 369 | Train Loss: 0.351 Vali Loss: 0.881 Vali Acc: 0.652 Test Loss: 0.881 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1104015
	speed: 0.2426s/iter; left time: 8212.4647s
	iters: 200, epoch: 9 | loss: 0.4024851
	speed: 0.0600s/iter; left time: 2024.3055s
	iters: 300, epoch: 9 | loss: 0.2662067
	speed: 0.0561s/iter; left time: 1887.3967s
Epoch: 9 cost time: 24.861091375350952
Epoch: 9, Steps: 369 | Train Loss: 0.315 Vali Loss: 0.812 Vali Acc: 0.664 Test Loss: 0.812 Test Acc: 0.664
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1092889
	speed: 0.2380s/iter; left time: 7967.6050s
	iters: 200, epoch: 10 | loss: 0.3558726
	speed: 0.0597s/iter; left time: 1992.4573s
	iters: 300, epoch: 10 | loss: 0.0517718
	speed: 0.0726s/iter; left time: 2417.6829s
Epoch: 10 cost time: 24.86100745201111
Epoch: 10, Steps: 369 | Train Loss: 0.257 Vali Loss: 1.112 Vali Acc: 0.644 Test Loss: 1.112 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1013362
	speed: 0.2321s/iter; left time: 7684.9434s
	iters: 200, epoch: 11 | loss: 0.2098131
	speed: 0.0651s/iter; left time: 2149.6771s
	iters: 300, epoch: 11 | loss: 0.4214505
	speed: 0.0316s/iter; left time: 1038.6788s
Epoch: 11 cost time: 18.73917555809021
Epoch: 11, Steps: 369 | Train Loss: 0.235 Vali Loss: 0.992 Vali Acc: 0.652 Test Loss: 0.992 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1162957
	speed: 0.1609s/iter; left time: 5266.7829s
	iters: 200, epoch: 12 | loss: 0.3568759
	speed: 0.0764s/iter; left time: 2494.8754s
	iters: 300, epoch: 12 | loss: 0.1306271
	speed: 0.0798s/iter; left time: 2596.4262s
Epoch: 12 cost time: 24.468416213989258
Epoch: 12, Steps: 369 | Train Loss: 0.204 Vali Loss: 1.104 Vali Acc: 0.641 Test Loss: 1.104 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1746212
	speed: 0.2580s/iter; left time: 8353.3005s
	iters: 200, epoch: 13 | loss: 0.0946859
	speed: 0.0780s/iter; left time: 2518.6811s
	iters: 300, epoch: 13 | loss: 0.3654223
	speed: 0.0784s/iter; left time: 2521.9984s
Epoch: 13 cost time: 29.087151050567627
Epoch: 13, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.404 Vali Acc: 0.632 Test Loss: 1.404 Test Acc: 0.632
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0450754
	speed: 0.2741s/iter; left time: 8773.7042s
	iters: 200, epoch: 14 | loss: 0.0948104
	speed: 0.0659s/iter; left time: 2101.8229s
	iters: 300, epoch: 14 | loss: 0.0641618
	speed: 0.0617s/iter; left time: 1962.7954s
Epoch: 14 cost time: 24.538276433944702
Epoch: 14, Steps: 369 | Train Loss: 0.129 Vali Loss: 1.517 Vali Acc: 0.642 Test Loss: 1.517 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2641067
	speed: 0.2201s/iter; left time: 6961.8337s
	iters: 200, epoch: 15 | loss: 0.0070189
	speed: 0.0595s/iter; left time: 1875.5125s
	iters: 300, epoch: 15 | loss: 0.0755204
	speed: 0.0646s/iter; left time: 2029.6216s
Epoch: 15 cost time: 24.026376247406006
Epoch: 15, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.542 Vali Acc: 0.650 Test Loss: 1.542 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0163652
	speed: 0.2301s/iter; left time: 7193.5394s
	iters: 200, epoch: 16 | loss: 0.0355364
	speed: 0.0683s/iter; left time: 2129.8650s
	iters: 300, epoch: 16 | loss: 0.2423411
	speed: 0.0773s/iter; left time: 2401.3519s
Epoch: 16 cost time: 26.398181438446045
Epoch: 16, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.602 Vali Acc: 0.659 Test Loss: 1.602 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6770715096481271
model parameter : 236698
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6123042
	speed: 0.0781s/iter; left time: 2874.9964s
	iters: 200, epoch: 1 | loss: 0.6348751
	speed: 0.0650s/iter; left time: 2387.0793s
	iters: 300, epoch: 1 | loss: 1.9111289
	speed: 0.0681s/iter; left time: 2491.3815s
Epoch: 1 cost time: 25.98062753677368
Epoch: 1, Steps: 369 | Train Loss: 0.938 Vali Loss: 3.377 Vali Acc: 0.503 Test Loss: 3.377 Test Acc: 0.503
Validation loss decreased (inf --> -0.503371).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4562142
	speed: 0.2446s/iter; left time: 8911.1420s
	iters: 200, epoch: 2 | loss: 2.0903294
	speed: 0.0708s/iter; left time: 2572.8708s
	iters: 300, epoch: 2 | loss: 1.0217310
	speed: 0.0637s/iter; left time: 2309.4531s
Epoch: 2 cost time: 25.8450186252594
Epoch: 2, Steps: 369 | Train Loss: 0.868 Vali Loss: 2.282 Vali Acc: 0.530 Test Loss: 2.282 Test Acc: 0.530
Validation loss decreased (-0.503371 --> -0.529489).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2852548
	speed: 0.2392s/iter; left time: 8625.5838s
	iters: 200, epoch: 3 | loss: 0.7639254
	speed: 0.0605s/iter; left time: 2174.4868s
	iters: 300, epoch: 3 | loss: 0.2592918
	speed: 0.0586s/iter; left time: 2102.9827s
Epoch: 3 cost time: 24.403504610061646
Epoch: 3, Steps: 369 | Train Loss: 0.948 Vali Loss: 1.416 Vali Acc: 0.572 Test Loss: 1.416 Test Acc: 0.572
Validation loss decreased (-0.529489 --> -0.572063).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8226663
	speed: 0.2396s/iter; left time: 8552.2048s
	iters: 200, epoch: 4 | loss: 0.5243189
	speed: 0.0646s/iter; left time: 2300.1791s
	iters: 300, epoch: 4 | loss: 0.4026708
	speed: 0.0732s/iter; left time: 2597.4820s
Epoch: 4 cost time: 25.624394178390503
Epoch: 4, Steps: 369 | Train Loss: 0.586 Vali Loss: 0.779 Vali Acc: 0.632 Test Loss: 0.779 Test Acc: 0.632
Validation loss decreased (-0.572063 --> -0.632228).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6013918
	speed: 0.2330s/iter; left time: 8229.8726s
	iters: 200, epoch: 5 | loss: 0.5775343
	speed: 0.0734s/iter; left time: 2585.0828s
	iters: 300, epoch: 5 | loss: 0.2700171
	speed: 0.0683s/iter; left time: 2400.3435s
Epoch: 5 cost time: 26.12083339691162
Epoch: 5, Steps: 369 | Train Loss: 0.495 Vali Loss: 0.744 Vali Acc: 0.652 Test Loss: 0.744 Test Acc: 0.652
Validation loss decreased (-0.632228 --> -0.651809).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6015245
	speed: 0.2472s/iter; left time: 8639.6727s
	iters: 200, epoch: 6 | loss: 0.8781984
	speed: 0.0696s/iter; left time: 2427.6841s
	iters: 300, epoch: 6 | loss: 0.3857918
	speed: 0.0717s/iter; left time: 2492.4754s
Epoch: 6 cost time: 26.168982982635498
Epoch: 6, Steps: 369 | Train Loss: 0.431 Vali Loss: 0.684 Vali Acc: 0.666 Test Loss: 0.684 Test Acc: 0.666
Validation loss decreased (-0.651809 --> -0.665998).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4152394
	speed: 0.2632s/iter; left time: 9104.8666s
	iters: 200, epoch: 7 | loss: 0.2706881
	speed: 0.0596s/iter; left time: 2054.8011s
	iters: 300, epoch: 7 | loss: 0.4329611
	speed: 0.0704s/iter; left time: 2421.1861s
Epoch: 7 cost time: 26.880566120147705
Epoch: 7, Steps: 369 | Train Loss: 0.395 Vali Loss: 0.691 Vali Acc: 0.662 Test Loss: 0.691 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5087144
	speed: 0.2732s/iter; left time: 9347.3597s
	iters: 200, epoch: 8 | loss: 0.3275966
	speed: 0.0719s/iter; left time: 2453.2009s
	iters: 300, epoch: 8 | loss: 0.4416717
	speed: 0.0824s/iter; left time: 2801.8954s
Epoch: 8 cost time: 29.044255256652832
Epoch: 8, Steps: 369 | Train Loss: 0.338 Vali Loss: 0.871 Vali Acc: 0.652 Test Loss: 0.871 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2577219
	speed: 0.2697s/iter; left time: 9127.7426s
	iters: 200, epoch: 9 | loss: 0.2886963
	speed: 0.0704s/iter; left time: 2374.9116s
	iters: 300, epoch: 9 | loss: 0.5428302
	speed: 0.0680s/iter; left time: 2288.2960s
Epoch: 9 cost time: 25.0626482963562
Epoch: 9, Steps: 369 | Train Loss: 0.283 Vali Loss: 1.075 Vali Acc: 0.660 Test Loss: 1.075 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1972893
	speed: 0.2321s/iter; left time: 7770.4321s
	iters: 200, epoch: 10 | loss: 0.1564540
	speed: 0.0726s/iter; left time: 2422.1471s
	iters: 300, epoch: 10 | loss: 0.2223466
	speed: 0.0674s/iter; left time: 2244.5939s
Epoch: 10 cost time: 24.486401796340942
Epoch: 10, Steps: 369 | Train Loss: 0.266 Vali Loss: 1.057 Vali Acc: 0.652 Test Loss: 1.057 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0536375
	speed: 0.2224s/iter; left time: 7362.4137s
	iters: 200, epoch: 11 | loss: 0.0662506
	speed: 0.0699s/iter; left time: 2305.9756s
	iters: 300, epoch: 11 | loss: 0.1460620
	speed: 0.0641s/iter; left time: 2110.3409s
Epoch: 11 cost time: 24.66209125518799
Epoch: 11, Steps: 369 | Train Loss: 0.218 Vali Loss: 1.300 Vali Acc: 0.643 Test Loss: 1.300 Test Acc: 0.643
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.4956276
	speed: 0.2340s/iter; left time: 7663.0432s
	iters: 200, epoch: 12 | loss: 0.1247976
	speed: 0.0705s/iter; left time: 2300.1006s
	iters: 300, epoch: 12 | loss: 0.0222491
	speed: 0.0728s/iter; left time: 2368.5500s
Epoch: 12 cost time: 25.28718590736389
Epoch: 12, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.301 Vali Acc: 0.655 Test Loss: 1.301 Test Acc: 0.655
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2826191
	speed: 0.2403s/iter; left time: 7777.9087s
	iters: 200, epoch: 13 | loss: 0.1573760
	speed: 0.0742s/iter; left time: 2393.1979s
	iters: 300, epoch: 13 | loss: 0.3184803
	speed: 0.0628s/iter; left time: 2019.0266s
Epoch: 13 cost time: 25.491915941238403
Epoch: 13, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.551 Vali Acc: 0.642 Test Loss: 1.551 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0137846
	speed: 0.2373s/iter; left time: 7593.3931s
	iters: 200, epoch: 14 | loss: 0.4010853
	speed: 0.0580s/iter; left time: 1850.3088s
	iters: 300, epoch: 14 | loss: 0.3226632
	speed: 0.0558s/iter; left time: 1775.5560s
Epoch: 14 cost time: 24.03405523300171
Epoch: 14, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.452 Vali Acc: 0.646 Test Loss: 1.452 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0667817
	speed: 0.2400s/iter; left time: 7590.8270s
	iters: 200, epoch: 15 | loss: 0.0440808
	speed: 0.0685s/iter; left time: 2160.1139s
	iters: 300, epoch: 15 | loss: 0.0575430
	speed: 0.0700s/iter; left time: 2199.8069s
Epoch: 15 cost time: 26.23026442527771
Epoch: 15, Steps: 369 | Train Loss: 0.121 Vali Loss: 1.768 Vali Acc: 0.644 Test Loss: 1.768 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.1724251
	speed: 0.2431s/iter; left time: 7599.4800s
	iters: 200, epoch: 16 | loss: 0.0137041
	speed: 0.0726s/iter; left time: 2261.4709s
	iters: 300, epoch: 16 | loss: 0.0070108
	speed: 0.0634s/iter; left time: 1970.8606s
Epoch: 16 cost time: 25.40560817718506
Epoch: 16, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.434 Vali Acc: 0.644 Test Loss: 1.434 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6660045402951191
model parameter : 236506
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1463614
	speed: 0.1008s/iter; left time: 3709.5159s
	iters: 200, epoch: 1 | loss: 0.9569563
	speed: 0.0756s/iter; left time: 2773.8708s
	iters: 300, epoch: 1 | loss: 0.9343956
	speed: 0.0665s/iter; left time: 2435.4300s
Epoch: 1 cost time: 28.553053617477417
Epoch: 1, Steps: 369 | Train Loss: 0.888 Vali Loss: 0.902 Vali Acc: 0.615 Test Loss: 0.902 Test Acc: 0.615
Validation loss decreased (inf --> -0.615485).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4911327
	speed: 0.1894s/iter; left time: 6899.6537s
	iters: 200, epoch: 2 | loss: 0.4529904
	speed: 0.0306s/iter; left time: 1111.7920s
	iters: 300, epoch: 2 | loss: 1.0965652
	speed: 0.0284s/iter; left time: 1030.0405s
Epoch: 2 cost time: 12.224334239959717
Epoch: 2, Steps: 369 | Train Loss: 0.963 Vali Loss: 0.897 Vali Acc: 0.641 Test Loss: 0.897 Test Acc: 0.641
Validation loss decreased (-0.615485 --> -0.641024).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5033085
	speed: 0.2368s/iter; left time: 8540.8812s
	iters: 200, epoch: 3 | loss: 0.2306187
	speed: 0.0746s/iter; left time: 2682.6561s
	iters: 300, epoch: 3 | loss: 0.3820275
	speed: 0.0634s/iter; left time: 2272.9728s
Epoch: 3 cost time: 27.439775705337524
Epoch: 3, Steps: 369 | Train Loss: 0.894 Vali Loss: 2.952 Vali Acc: 0.514 Test Loss: 2.952 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5700381
	speed: 0.2741s/iter; left time: 9784.8066s
	iters: 200, epoch: 4 | loss: 0.3153377
	speed: 0.0510s/iter; left time: 1814.1860s
	iters: 300, epoch: 4 | loss: 0.2902191
	speed: 0.0662s/iter; left time: 2351.2218s
Epoch: 4 cost time: 23.894063711166382
Epoch: 4, Steps: 369 | Train Loss: 0.720 Vali Loss: 0.704 Vali Acc: 0.659 Test Loss: 0.704 Test Acc: 0.659
Validation loss decreased (-0.641024 --> -0.658903).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8319241
	speed: 0.2384s/iter; left time: 8421.0312s
	iters: 200, epoch: 5 | loss: 0.5513756
	speed: 0.0714s/iter; left time: 2513.5954s
	iters: 300, epoch: 5 | loss: 0.4652671
	speed: 0.0668s/iter; left time: 2346.8452s
Epoch: 5 cost time: 25.194451332092285
Epoch: 5, Steps: 369 | Train Loss: 0.485 Vali Loss: 0.633 Vali Acc: 0.675 Test Loss: 0.633 Test Acc: 0.675
Validation loss decreased (-0.658903 --> -0.675079).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4906262
	speed: 0.2376s/iter; left time: 8305.7980s
	iters: 200, epoch: 6 | loss: 0.2887351
	speed: 0.0741s/iter; left time: 2583.2012s
	iters: 300, epoch: 6 | loss: 0.5886305
	speed: 0.0634s/iter; left time: 2202.9307s
Epoch: 6 cost time: 26.053913354873657
Epoch: 6, Steps: 369 | Train Loss: 0.438 Vali Loss: 0.765 Vali Acc: 0.642 Test Loss: 0.765 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3468867
	speed: 0.2286s/iter; left time: 7907.4670s
	iters: 200, epoch: 7 | loss: 0.4017344
	speed: 0.0650s/iter; left time: 2239.9483s
	iters: 300, epoch: 7 | loss: 0.4238117
	speed: 0.0588s/iter; left time: 2021.7234s
Epoch: 7 cost time: 24.13561224937439
Epoch: 7, Steps: 369 | Train Loss: 0.381 Vali Loss: 0.803 Vali Acc: 0.659 Test Loss: 0.803 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2185932
	speed: 0.2344s/iter; left time: 8021.2723s
	iters: 200, epoch: 8 | loss: 0.4863389
	speed: 0.0610s/iter; left time: 2080.9794s
	iters: 300, epoch: 8 | loss: 0.1960177
	speed: 0.0553s/iter; left time: 1881.7822s
Epoch: 8 cost time: 23.959664583206177
Epoch: 8, Steps: 369 | Train Loss: 0.351 Vali Loss: 0.805 Vali Acc: 0.668 Test Loss: 0.805 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0858407
	speed: 0.2425s/iter; left time: 8208.8633s
	iters: 200, epoch: 9 | loss: 0.5879286
	speed: 0.0625s/iter; left time: 2108.8295s
	iters: 300, epoch: 9 | loss: 0.1887029
	speed: 0.0720s/iter; left time: 2422.2297s
Epoch: 9 cost time: 25.44550347328186
Epoch: 9, Steps: 369 | Train Loss: 0.295 Vali Loss: 0.926 Vali Acc: 0.658 Test Loss: 0.926 Test Acc: 0.658
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2186029
	speed: 0.2324s/iter; left time: 7781.3566s
	iters: 200, epoch: 10 | loss: 0.1147439
	speed: 0.0720s/iter; left time: 2404.5632s
	iters: 300, epoch: 10 | loss: 0.1068003
	speed: 0.0622s/iter; left time: 2071.5240s
Epoch: 10 cost time: 24.915082454681396
Epoch: 10, Steps: 369 | Train Loss: 0.249 Vali Loss: 1.189 Vali Acc: 0.654 Test Loss: 1.189 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1046342
	speed: 0.2512s/iter; left time: 8317.1179s
	iters: 200, epoch: 11 | loss: 0.0517877
	speed: 0.0654s/iter; left time: 2158.3637s
	iters: 300, epoch: 11 | loss: 0.3078119
	speed: 0.0709s/iter; left time: 2334.8260s
Epoch: 11 cost time: 25.295900106430054
Epoch: 11, Steps: 369 | Train Loss: 0.218 Vali Loss: 1.134 Vali Acc: 0.660 Test Loss: 1.134 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1292588
	speed: 0.2315s/iter; left time: 7578.4256s
	iters: 200, epoch: 12 | loss: 0.3910435
	speed: 0.0608s/iter; left time: 1983.3309s
	iters: 300, epoch: 12 | loss: 0.2296773
	speed: 0.0585s/iter; left time: 1902.8569s
Epoch: 12 cost time: 24.29298710823059
Epoch: 12, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.328 Vali Acc: 0.644 Test Loss: 1.328 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1097532
	speed: 0.2584s/iter; left time: 8365.2813s
	iters: 200, epoch: 13 | loss: 0.0175045
	speed: 0.0718s/iter; left time: 2317.5277s
	iters: 300, epoch: 13 | loss: 0.4364826
	speed: 0.0830s/iter; left time: 2670.6886s
Epoch: 13 cost time: 28.813096046447754
Epoch: 13, Steps: 369 | Train Loss: 0.168 Vali Loss: 1.405 Vali Acc: 0.643 Test Loss: 1.405 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1398222
	speed: 0.2770s/iter; left time: 8863.8727s
	iters: 200, epoch: 14 | loss: 0.0875254
	speed: 0.0748s/iter; left time: 2385.4080s
	iters: 300, epoch: 14 | loss: 0.0371446
	speed: 0.0724s/iter; left time: 2301.7553s
Epoch: 14 cost time: 27.961238384246826
Epoch: 14, Steps: 369 | Train Loss: 0.145 Vali Loss: 1.375 Vali Acc: 0.653 Test Loss: 1.375 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0578497
	speed: 0.2689s/iter; left time: 8505.3542s
	iters: 200, epoch: 15 | loss: 0.0758024
	speed: 0.0669s/iter; left time: 2110.5908s
	iters: 300, epoch: 15 | loss: 0.0044997
	speed: 0.0627s/iter; left time: 1970.2142s
Epoch: 15 cost time: 25.310669898986816
Epoch: 15, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.626 Vali Acc: 0.661 Test Loss: 1.626 Test Acc: 0.661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6750851305334846
model parameter : 236314
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.1174725
	speed: 0.0844s/iter; left time: 3106.4787s
	iters: 200, epoch: 1 | loss: 0.4137844
	speed: 0.0639s/iter; left time: 2346.7088s
	iters: 300, epoch: 1 | loss: 0.7068436
	speed: 0.0511s/iter; left time: 1870.9141s
Epoch: 1 cost time: 24.531468391418457
Epoch: 1, Steps: 369 | Train Loss: 0.834 Vali Loss: 0.895 Vali Acc: 0.631 Test Loss: 0.895 Test Acc: 0.631
Validation loss decreased (inf --> -0.630525).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7680193
	speed: 0.2381s/iter; left time: 8676.1246s
	iters: 200, epoch: 2 | loss: 1.7948786
	speed: 0.0613s/iter; left time: 2228.7645s
	iters: 300, epoch: 2 | loss: 0.4855627
	speed: 0.0668s/iter; left time: 2421.1777s
Epoch: 2 cost time: 24.127342462539673
Epoch: 2, Steps: 369 | Train Loss: 0.930 Vali Loss: 2.893 Vali Acc: 0.511 Test Loss: 2.893 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4812441
	speed: 0.2314s/iter; left time: 8344.8189s
	iters: 200, epoch: 3 | loss: 0.3136336
	speed: 0.0741s/iter; left time: 2664.7297s
	iters: 300, epoch: 3 | loss: 0.8266174
	speed: 0.0662s/iter; left time: 2374.2858s
Epoch: 3 cost time: 24.904829025268555
Epoch: 3, Steps: 369 | Train Loss: 0.749 Vali Loss: 0.681 Vali Acc: 0.679 Test Loss: 0.681 Test Acc: 0.679
Validation loss decreased (-0.630525 --> -0.679335).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4618687
	speed: 0.2275s/iter; left time: 8118.6573s
	iters: 200, epoch: 4 | loss: 0.6483582
	speed: 0.0722s/iter; left time: 2570.6053s
	iters: 300, epoch: 4 | loss: 1.1707720
	speed: 0.0602s/iter; left time: 2135.2282s
Epoch: 4 cost time: 24.74238872528076
Epoch: 4, Steps: 369 | Train Loss: 0.612 Vali Loss: 0.689 Vali Acc: 0.665 Test Loss: 0.689 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3618778
	speed: 0.2304s/iter; left time: 8140.6037s
	iters: 200, epoch: 5 | loss: 0.5112966
	speed: 0.0627s/iter; left time: 2208.8496s
	iters: 300, epoch: 5 | loss: 0.2750160
	speed: 0.0535s/iter; left time: 1880.1880s
Epoch: 5 cost time: 23.995460033416748
Epoch: 5, Steps: 369 | Train Loss: 0.489 Vali Loss: 0.648 Vali Acc: 0.676 Test Loss: 0.648 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2610746
	speed: 0.2375s/iter; left time: 8303.0380s
	iters: 200, epoch: 6 | loss: 0.5068470
	speed: 0.0541s/iter; left time: 1887.3250s
	iters: 300, epoch: 6 | loss: 0.3842835
	speed: 0.0659s/iter; left time: 2291.6113s
Epoch: 6 cost time: 22.92452335357666
Epoch: 6, Steps: 369 | Train Loss: 0.444 Vali Loss: 0.947 Vali Acc: 0.632 Test Loss: 0.947 Test Acc: 0.632
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2491131
	speed: 0.2242s/iter; left time: 7753.8496s
	iters: 200, epoch: 7 | loss: 0.2221187
	speed: 0.0600s/iter; left time: 2069.8576s
	iters: 300, epoch: 7 | loss: 0.3495667
	speed: 0.0680s/iter; left time: 2338.8668s
Epoch: 7 cost time: 23.356873989105225
Epoch: 7, Steps: 369 | Train Loss: 0.393 Vali Loss: 0.718 Vali Acc: 0.667 Test Loss: 0.718 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.3777336
	speed: 0.2441s/iter; left time: 8353.7185s
	iters: 200, epoch: 8 | loss: 0.3211175
	speed: 0.0755s/iter; left time: 2576.6529s
	iters: 300, epoch: 8 | loss: 0.6162089
	speed: 0.0629s/iter; left time: 2139.9599s
Epoch: 8 cost time: 25.314175367355347
Epoch: 8, Steps: 369 | Train Loss: 0.352 Vali Loss: 0.763 Vali Acc: 0.663 Test Loss: 0.763 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.2713069
	speed: 0.2552s/iter; left time: 8639.8084s
	iters: 200, epoch: 9 | loss: 0.2982362
	speed: 0.0632s/iter; left time: 2131.8958s
	iters: 300, epoch: 9 | loss: 0.4736512
	speed: 0.0595s/iter; left time: 2001.2036s
Epoch: 9 cost time: 24.22231125831604
Epoch: 9, Steps: 369 | Train Loss: 0.314 Vali Loss: 0.902 Vali Acc: 0.668 Test Loss: 0.902 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0572570
	speed: 0.2524s/iter; left time: 8449.9349s
	iters: 200, epoch: 10 | loss: 0.4125254
	speed: 0.0618s/iter; left time: 2062.9950s
	iters: 300, epoch: 10 | loss: 0.2554631
	speed: 0.0622s/iter; left time: 2070.5585s
Epoch: 10 cost time: 25.548582077026367
Epoch: 10, Steps: 369 | Train Loss: 0.274 Vali Loss: 0.935 Vali Acc: 0.657 Test Loss: 0.935 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1787500
	speed: 0.2590s/iter; left time: 8575.2777s
	iters: 200, epoch: 11 | loss: 0.1298812
	speed: 0.0742s/iter; left time: 2448.7738s
	iters: 300, epoch: 11 | loss: 0.1770333
	speed: 0.0705s/iter; left time: 2319.1280s
Epoch: 11 cost time: 26.47535228729248
Epoch: 11, Steps: 369 | Train Loss: 0.243 Vali Loss: 1.211 Vali Acc: 0.646 Test Loss: 1.211 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1084016
	speed: 0.2393s/iter; left time: 7836.0109s
	iters: 200, epoch: 12 | loss: 0.0383317
	speed: 0.0673s/iter; left time: 2195.7572s
	iters: 300, epoch: 12 | loss: 0.2598401
	speed: 0.0580s/iter; left time: 1886.0505s
Epoch: 12 cost time: 23.665581226348877
Epoch: 12, Steps: 369 | Train Loss: 0.196 Vali Loss: 1.237 Vali Acc: 0.639 Test Loss: 1.237 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0596841
	speed: 0.2313s/iter; left time: 7487.4169s
	iters: 200, epoch: 13 | loss: 0.0424471
	speed: 0.0633s/iter; left time: 2042.4191s
	iters: 300, epoch: 13 | loss: 0.0940448
	speed: 0.0663s/iter; left time: 2133.1845s
Epoch: 13 cost time: 24.902511596679688
Epoch: 13, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.320 Vali Acc: 0.645 Test Loss: 1.320 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6793416572077186
model parameter : 236122
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7831733
	speed: 0.0811s/iter; left time: 2986.2213s
	iters: 200, epoch: 1 | loss: 0.6475887
	speed: 0.0567s/iter; left time: 2081.0062s
	iters: 300, epoch: 1 | loss: 0.4416322
	speed: 0.0441s/iter; left time: 1612.7202s
Epoch: 1 cost time: 22.637794733047485
Epoch: 1, Steps: 369 | Train Loss: 0.844 Vali Loss: 0.784 Vali Acc: 0.644 Test Loss: 0.784 Test Acc: 0.644
Validation loss decreased (inf --> -0.644147).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5358213
	speed: 0.1667s/iter; left time: 6072.5961s
	iters: 200, epoch: 2 | loss: 1.2283164
	speed: 0.0311s/iter; left time: 1129.8321s
	iters: 300, epoch: 2 | loss: 1.6495205
	speed: 0.0381s/iter; left time: 1379.8414s
Epoch: 2 cost time: 15.458139419555664
Epoch: 2, Steps: 369 | Train Loss: 1.029 Vali Loss: 2.796 Vali Acc: 0.522 Test Loss: 2.796 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2820043
	speed: 0.2394s/iter; left time: 8632.9431s
	iters: 200, epoch: 3 | loss: 1.2897140
	speed: 0.0540s/iter; left time: 1941.8910s
	iters: 300, epoch: 3 | loss: 0.6865961
	speed: 0.0654s/iter; left time: 2344.7467s
Epoch: 3 cost time: 24.04835844039917
Epoch: 3, Steps: 369 | Train Loss: 0.835 Vali Loss: 0.911 Vali Acc: 0.637 Test Loss: 0.911 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8148504
	speed: 0.2183s/iter; left time: 7791.4628s
	iters: 200, epoch: 4 | loss: 1.1566275
	speed: 0.0692s/iter; left time: 2462.8788s
	iters: 300, epoch: 4 | loss: 1.5880762
	speed: 0.0668s/iter; left time: 2371.1676s
Epoch: 4 cost time: 22.672078847885132
Epoch: 4, Steps: 369 | Train Loss: 0.722 Vali Loss: 1.372 Vali Acc: 0.515 Test Loss: 1.372 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.7532708
	speed: 0.2239s/iter; left time: 7909.5847s
	iters: 200, epoch: 5 | loss: 0.8461460
	speed: 0.0722s/iter; left time: 2543.7251s
	iters: 300, epoch: 5 | loss: 0.4136862
	speed: 0.0620s/iter; left time: 2178.4258s
Epoch: 5 cost time: 25.10394263267517
Epoch: 5, Steps: 369 | Train Loss: 0.490 Vali Loss: 0.756 Vali Acc: 0.665 Test Loss: 0.756 Test Acc: 0.665
Validation loss decreased (-0.644147 --> -0.664578).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3484095
	speed: 0.2512s/iter; left time: 8781.3289s
	iters: 200, epoch: 6 | loss: 0.6966628
	speed: 0.0730s/iter; left time: 2544.8014s
	iters: 300, epoch: 6 | loss: 0.5654891
	speed: 0.0614s/iter; left time: 2135.0078s
Epoch: 6 cost time: 26.308473587036133
Epoch: 6, Steps: 369 | Train Loss: 0.441 Vali Loss: 0.708 Vali Acc: 0.667 Test Loss: 0.708 Test Acc: 0.667
Validation loss decreased (-0.664578 --> -0.666849).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2169455
	speed: 0.2503s/iter; left time: 8656.7983s
	iters: 200, epoch: 7 | loss: 0.1790729
	speed: 0.0662s/iter; left time: 2283.8638s
	iters: 300, epoch: 7 | loss: 0.7573563
	speed: 0.0805s/iter; left time: 2769.5068s
Epoch: 7 cost time: 27.461289167404175
Epoch: 7, Steps: 369 | Train Loss: 0.399 Vali Loss: 0.721 Vali Acc: 0.666 Test Loss: 0.721 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0970621
	speed: 0.2599s/iter; left time: 8894.6865s
	iters: 200, epoch: 8 | loss: 0.1445342
	speed: 0.0792s/iter; left time: 2703.7533s
	iters: 300, epoch: 8 | loss: 0.5881258
	speed: 0.0761s/iter; left time: 2587.5511s
Epoch: 8 cost time: 26.43279528617859
Epoch: 8, Steps: 369 | Train Loss: 0.352 Vali Loss: 0.810 Vali Acc: 0.669 Test Loss: 0.810 Test Acc: 0.669
Validation loss decreased (-0.666849 --> -0.668834).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3151437
	speed: 0.2474s/iter; left time: 8372.9733s
	iters: 200, epoch: 9 | loss: 0.1233109
	speed: 0.0713s/iter; left time: 2406.2814s
	iters: 300, epoch: 9 | loss: 0.1133758
	speed: 0.0557s/iter; left time: 1874.0106s
Epoch: 9 cost time: 24.656830072402954
Epoch: 9, Steps: 369 | Train Loss: 0.302 Vali Loss: 0.934 Vali Acc: 0.656 Test Loss: 0.934 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3652087
	speed: 0.2286s/iter; left time: 7654.2420s
	iters: 200, epoch: 10 | loss: 0.4846367
	speed: 0.0665s/iter; left time: 2220.6845s
	iters: 300, epoch: 10 | loss: 0.0754404
	speed: 0.0643s/iter; left time: 2139.2595s
Epoch: 10 cost time: 25.163494348526
Epoch: 10, Steps: 369 | Train Loss: 0.257 Vali Loss: 1.201 Vali Acc: 0.645 Test Loss: 1.201 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0432401
	speed: 0.2356s/iter; left time: 7800.4208s
	iters: 200, epoch: 11 | loss: 0.0529065
	speed: 0.0547s/iter; left time: 1805.0197s
	iters: 300, epoch: 11 | loss: 0.2071019
	speed: 0.0457s/iter; left time: 1504.1358s
Epoch: 11 cost time: 21.97648334503174
Epoch: 11, Steps: 369 | Train Loss: 0.238 Vali Loss: 1.170 Vali Acc: 0.656 Test Loss: 1.170 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1660221
	speed: 0.2153s/iter; left time: 7049.0360s
	iters: 200, epoch: 12 | loss: 0.1163654
	speed: 0.0577s/iter; left time: 1884.4218s
	iters: 300, epoch: 12 | loss: 0.3017497
	speed: 0.0679s/iter; left time: 2209.6711s
Epoch: 12 cost time: 23.781710386276245
Epoch: 12, Steps: 369 | Train Loss: 0.183 Vali Loss: 1.155 Vali Acc: 0.650 Test Loss: 1.155 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0960044
	speed: 0.2014s/iter; left time: 6521.5316s
	iters: 200, epoch: 13 | loss: 0.1990065
	speed: 0.0624s/iter; left time: 2013.3062s
	iters: 300, epoch: 13 | loss: 0.0415716
	speed: 0.0656s/iter; left time: 2111.4077s
Epoch: 13 cost time: 21.814935207366943
Epoch: 13, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.489 Vali Acc: 0.646 Test Loss: 1.489 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0502670
	speed: 0.2188s/iter; left time: 7001.7048s
	iters: 200, epoch: 14 | loss: 0.0895982
	speed: 0.0642s/iter; left time: 2046.6630s
	iters: 300, epoch: 14 | loss: 0.1905010
	speed: 0.0542s/iter; left time: 1722.4775s
Epoch: 14 cost time: 22.506629943847656
Epoch: 14, Steps: 369 | Train Loss: 0.134 Vali Loss: 1.531 Vali Acc: 0.643 Test Loss: 1.531 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0130965
	speed: 0.2150s/iter; left time: 6802.1590s
	iters: 200, epoch: 15 | loss: 0.3054250
	speed: 0.0637s/iter; left time: 2007.2966s
	iters: 300, epoch: 15 | loss: 0.0673822
	speed: 0.0592s/iter; left time: 1861.3597s
Epoch: 15 cost time: 23.168065309524536
Epoch: 15, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.432 Vali Acc: 0.645 Test Loss: 1.432 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1548325
	speed: 0.2133s/iter; left time: 6668.7819s
	iters: 200, epoch: 16 | loss: 0.0888285
	speed: 0.0544s/iter; left time: 1696.8675s
	iters: 300, epoch: 16 | loss: 0.0077057
	speed: 0.0550s/iter; left time: 1709.9625s
Epoch: 16 cost time: 21.708173513412476
Epoch: 16, Steps: 369 | Train Loss: 0.102 Vali Loss: 2.015 Vali Acc: 0.640 Test Loss: 2.015 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0631383
	speed: 0.2103s/iter; left time: 6498.9522s
	iters: 200, epoch: 17 | loss: 0.0258188
	speed: 0.0546s/iter; left time: 1681.3329s
	iters: 300, epoch: 17 | loss: 0.0020136
	speed: 0.0637s/iter; left time: 1955.8626s
Epoch: 17 cost time: 21.975043058395386
Epoch: 17, Steps: 369 | Train Loss: 0.108 Vali Loss: 1.991 Vali Acc: 0.647 Test Loss: 1.991 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0926428
	speed: 0.2277s/iter; left time: 6950.3068s
	iters: 200, epoch: 18 | loss: 0.1395783
	speed: 0.0673s/iter; left time: 2046.5507s
	iters: 300, epoch: 18 | loss: 0.0145229
	speed: 0.0727s/iter; left time: 2204.3562s
Epoch: 18 cost time: 25.00807499885559
Epoch: 18, Steps: 369 | Train Loss: 0.110 Vali Loss: 2.056 Vali Acc: 0.640 Test Loss: 2.056 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6688422247446084
model parameter : 186778
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0163227
	speed: 0.0876s/iter; left time: 3222.7663s
	iters: 200, epoch: 1 | loss: 0.6024276
	speed: 0.0757s/iter; left time: 2779.6127s
	iters: 300, epoch: 1 | loss: 1.3719693
	speed: 0.0597s/iter; left time: 2185.7428s
Epoch: 1 cost time: 27.371399879455566
Epoch: 1, Steps: 369 | Train Loss: 0.919 Vali Loss: 1.552 Vali Acc: 0.551 Test Loss: 1.552 Test Acc: 0.551
Validation loss decreased (inf --> -0.551347).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5812301
	speed: 0.2199s/iter; left time: 8009.9258s
	iters: 200, epoch: 2 | loss: 0.6093045
	speed: 0.0620s/iter; left time: 2251.9020s
	iters: 300, epoch: 2 | loss: 0.4790170
	speed: 0.0549s/iter; left time: 1989.7627s
Epoch: 2 cost time: 22.524208545684814
Epoch: 2, Steps: 369 | Train Loss: 0.801 Vali Loss: 2.395 Vali Acc: 0.521 Test Loss: 2.395 Test Acc: 0.521
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5175844
	speed: 0.2186s/iter; left time: 7881.9281s
	iters: 200, epoch: 3 | loss: 1.0334405
	speed: 0.0540s/iter; left time: 1941.3999s
	iters: 300, epoch: 3 | loss: 0.4163673
	speed: 0.0529s/iter; left time: 1896.3134s
Epoch: 3 cost time: 21.679762363433838
Epoch: 3, Steps: 369 | Train Loss: 0.957 Vali Loss: 1.647 Vali Acc: 0.584 Test Loss: 1.647 Test Acc: 0.584
Validation loss decreased (-0.551347 --> -0.584263).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4119906
	speed: 0.2169s/iter; left time: 7740.8416s
	iters: 200, epoch: 4 | loss: 0.7843994
	speed: 0.0529s/iter; left time: 1883.9700s
	iters: 300, epoch: 4 | loss: 0.5567744
	speed: 0.0575s/iter; left time: 2042.0671s
Epoch: 4 cost time: 21.57474994659424
Epoch: 4, Steps: 369 | Train Loss: 0.673 Vali Loss: 0.799 Vali Acc: 0.640 Test Loss: 0.799 Test Acc: 0.640
Validation loss decreased (-0.584263 --> -0.640174).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3113843
	speed: 0.2185s/iter; left time: 7719.0011s
	iters: 200, epoch: 5 | loss: 0.3311620
	speed: 0.0579s/iter; left time: 2040.8008s
	iters: 300, epoch: 5 | loss: 0.4062126
	speed: 0.0670s/iter; left time: 2353.6329s
Epoch: 5 cost time: 23.698591947555542
Epoch: 5, Steps: 369 | Train Loss: 0.505 Vali Loss: 0.684 Vali Acc: 0.670 Test Loss: 0.684 Test Acc: 0.670
Validation loss decreased (-0.640174 --> -0.669687).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2527532
	speed: 0.2317s/iter; left time: 8099.4862s
	iters: 200, epoch: 6 | loss: 0.3831390
	speed: 0.0635s/iter; left time: 2212.5588s
	iters: 300, epoch: 6 | loss: 0.6881762
	speed: 0.0550s/iter; left time: 1913.0033s
Epoch: 6 cost time: 23.167914390563965
Epoch: 6, Steps: 369 | Train Loss: 0.438 Vali Loss: 0.862 Vali Acc: 0.653 Test Loss: 0.862 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4605493
	speed: 0.2207s/iter; left time: 7633.8434s
	iters: 200, epoch: 7 | loss: 0.7347668
	speed: 0.0568s/iter; left time: 1958.9526s
	iters: 300, epoch: 7 | loss: 0.3032006
	speed: 0.0579s/iter; left time: 1990.2706s
Epoch: 7 cost time: 22.72219467163086
Epoch: 7, Steps: 369 | Train Loss: 0.388 Vali Loss: 0.749 Vali Acc: 0.656 Test Loss: 0.749 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3471360
	speed: 0.1592s/iter; left time: 5446.5394s
	iters: 200, epoch: 8 | loss: 0.4962479
	speed: 0.0260s/iter; left time: 886.7846s
	iters: 300, epoch: 8 | loss: 0.1951615
	speed: 0.0256s/iter; left time: 871.1089s
Epoch: 8 cost time: 10.393049001693726
Epoch: 8, Steps: 369 | Train Loss: 0.339 Vali Loss: 0.933 Vali Acc: 0.642 Test Loss: 0.933 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0955369
	speed: 0.1895s/iter; left time: 6413.1969s
	iters: 200, epoch: 9 | loss: 0.2162525
	speed: 0.0620s/iter; left time: 2090.8172s
	iters: 300, epoch: 9 | loss: 0.3236276
	speed: 0.0525s/iter; left time: 1768.1427s
Epoch: 9 cost time: 21.51262617111206
Epoch: 9, Steps: 369 | Train Loss: 0.309 Vali Loss: 0.921 Vali Acc: 0.654 Test Loss: 0.921 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1188537
	speed: 0.2063s/iter; left time: 6905.3147s
	iters: 200, epoch: 10 | loss: 0.0700483
	speed: 0.0627s/iter; left time: 2093.9402s
	iters: 300, epoch: 10 | loss: 0.3168150
	speed: 0.0633s/iter; left time: 2105.8791s
Epoch: 10 cost time: 24.697635889053345
Epoch: 10, Steps: 369 | Train Loss: 0.280 Vali Loss: 1.090 Vali Acc: 0.640 Test Loss: 1.090 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1608246
	speed: 0.2500s/iter; left time: 8279.2337s
	iters: 200, epoch: 11 | loss: 0.3453989
	speed: 0.0638s/iter; left time: 2107.6859s
	iters: 300, epoch: 11 | loss: 0.0836565
	speed: 0.0693s/iter; left time: 2279.9175s
Epoch: 11 cost time: 24.802769660949707
Epoch: 11, Steps: 369 | Train Loss: 0.246 Vali Loss: 1.056 Vali Acc: 0.640 Test Loss: 1.056 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0789118
	speed: 0.2478s/iter; left time: 8112.1970s
	iters: 200, epoch: 12 | loss: 0.1255251
	speed: 0.0811s/iter; left time: 2646.5059s
	iters: 300, epoch: 12 | loss: 0.3082849
	speed: 0.0703s/iter; left time: 2286.6482s
Epoch: 12 cost time: 27.12697148323059
Epoch: 12, Steps: 369 | Train Loss: 0.193 Vali Loss: 1.360 Vali Acc: 0.653 Test Loss: 1.360 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0371938
	speed: 0.2455s/iter; left time: 7948.7799s
	iters: 200, epoch: 13 | loss: 0.0697186
	speed: 0.0555s/iter; left time: 1790.6532s
	iters: 300, epoch: 13 | loss: 0.0721621
	speed: 0.0553s/iter; left time: 1780.3842s
Epoch: 13 cost time: 21.449875116348267
Epoch: 13, Steps: 369 | Train Loss: 0.161 Vali Loss: 1.478 Vali Acc: 0.651 Test Loss: 1.478 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1486582
	speed: 0.2030s/iter; left time: 6497.0151s
	iters: 200, epoch: 14 | loss: 0.2169559
	speed: 0.0580s/iter; left time: 1850.1998s
	iters: 300, epoch: 14 | loss: 0.0415526
	speed: 0.0521s/iter; left time: 1658.5276s
Epoch: 14 cost time: 22.119065046310425
Epoch: 14, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.464 Vali Acc: 0.652 Test Loss: 1.464 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1350984
	speed: 0.2140s/iter; left time: 6768.9011s
	iters: 200, epoch: 15 | loss: 0.0640934
	speed: 0.0518s/iter; left time: 1632.3913s
	iters: 300, epoch: 15 | loss: 0.0681942
	speed: 0.0698s/iter; left time: 2195.5856s
Epoch: 15 cost time: 22.997671842575073
Epoch: 15, Steps: 369 | Train Loss: 0.122 Vali Loss: 1.647 Vali Acc: 0.654 Test Loss: 1.647 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6696935300794552
model parameter : 186586
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5194365
	speed: 0.0617s/iter; left time: 2270.1741s
	iters: 200, epoch: 1 | loss: 1.4209298
	speed: 0.0720s/iter; left time: 2644.1214s
	iters: 300, epoch: 1 | loss: 0.4893723
	speed: 0.0682s/iter; left time: 2496.6620s
Epoch: 1 cost time: 23.81395411491394
Epoch: 1, Steps: 369 | Train Loss: 1.033 Vali Loss: 1.145 Vali Acc: 0.578 Test Loss: 1.145 Test Acc: 0.578
Validation loss decreased (inf --> -0.577741).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6389126
	speed: 0.2114s/iter; left time: 7701.5485s
	iters: 200, epoch: 2 | loss: 0.7279425
	speed: 0.0649s/iter; left time: 2358.4192s
	iters: 300, epoch: 2 | loss: 0.7165947
	speed: 0.0527s/iter; left time: 1910.3814s
Epoch: 2 cost time: 22.170835971832275
Epoch: 2, Steps: 369 | Train Loss: 0.890 Vali Loss: 2.810 Vali Acc: 0.514 Test Loss: 2.810 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5313278
	speed: 0.2171s/iter; left time: 7829.6758s
	iters: 200, epoch: 3 | loss: 0.7770856
	speed: 0.0524s/iter; left time: 1884.2329s
	iters: 300, epoch: 3 | loss: 0.6804081
	speed: 0.0485s/iter; left time: 1739.9320s
Epoch: 3 cost time: 20.897695779800415
Epoch: 3, Steps: 369 | Train Loss: 0.994 Vali Loss: 0.891 Vali Acc: 0.679 Test Loss: 0.891 Test Acc: 0.679
Validation loss decreased (-0.577741 --> -0.679049).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6034132
	speed: 0.2164s/iter; left time: 7723.5729s
	iters: 200, epoch: 4 | loss: 0.2971463
	speed: 0.0540s/iter; left time: 1920.5640s
	iters: 300, epoch: 4 | loss: 0.6921343
	speed: 0.0656s/iter; left time: 2329.9544s
Epoch: 4 cost time: 22.71806573867798
Epoch: 4, Steps: 369 | Train Loss: 0.603 Vali Loss: 0.719 Vali Acc: 0.641 Test Loss: 0.719 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2487668
	speed: 0.2102s/iter; left time: 7424.8973s
	iters: 200, epoch: 5 | loss: 0.3983965
	speed: 0.0666s/iter; left time: 2344.4959s
	iters: 300, epoch: 5 | loss: 0.6780204
	speed: 0.0619s/iter; left time: 2175.5030s
Epoch: 5 cost time: 22.315793991088867
Epoch: 5, Steps: 369 | Train Loss: 0.467 Vali Loss: 0.689 Vali Acc: 0.690 Test Loss: 0.689 Test Acc: 0.690
Validation loss decreased (-0.679049 --> -0.689834).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6048396
	speed: 0.2293s/iter; left time: 8013.6748s
	iters: 200, epoch: 6 | loss: 0.5874412
	speed: 0.0751s/iter; left time: 2616.3210s
	iters: 300, epoch: 6 | loss: 0.4122876
	speed: 0.0568s/iter; left time: 1973.5093s
Epoch: 6 cost time: 25.762343883514404
Epoch: 6, Steps: 369 | Train Loss: 0.422 Vali Loss: 0.812 Vali Acc: 0.664 Test Loss: 0.812 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4061027
	speed: 0.2514s/iter; left time: 8694.7496s
	iters: 200, epoch: 7 | loss: 0.6433476
	speed: 0.0557s/iter; left time: 1919.5948s
	iters: 300, epoch: 7 | loss: 0.3819472
	speed: 0.0555s/iter; left time: 1909.6646s
Epoch: 7 cost time: 23.37471652030945
Epoch: 7, Steps: 369 | Train Loss: 0.374 Vali Loss: 0.706 Vali Acc: 0.672 Test Loss: 0.706 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3677765
	speed: 0.2376s/iter; left time: 8129.4648s
	iters: 200, epoch: 8 | loss: 0.2577505
	speed: 0.0544s/iter; left time: 1856.4112s
	iters: 300, epoch: 8 | loss: 0.1452854
	speed: 0.0721s/iter; left time: 2452.9209s
Epoch: 8 cost time: 23.77929711341858
Epoch: 8, Steps: 369 | Train Loss: 0.330 Vali Loss: 0.895 Vali Acc: 0.658 Test Loss: 0.895 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2138427
	speed: 0.2248s/iter; left time: 7609.3414s
	iters: 200, epoch: 9 | loss: 0.2579958
	speed: 0.0522s/iter; left time: 1763.1921s
	iters: 300, epoch: 9 | loss: 0.2160203
	speed: 0.0307s/iter; left time: 1031.7448s
Epoch: 9 cost time: 15.731839179992676
Epoch: 9, Steps: 369 | Train Loss: 0.285 Vali Loss: 1.012 Vali Acc: 0.650 Test Loss: 1.012 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.7167423
	speed: 0.1197s/iter; left time: 4008.8946s
	iters: 200, epoch: 10 | loss: 0.1253289
	speed: 0.0274s/iter; left time: 915.2829s
	iters: 300, epoch: 10 | loss: 0.7354801
	speed: 0.0583s/iter; left time: 1941.8581s
Epoch: 10 cost time: 16.314355611801147
Epoch: 10, Steps: 369 | Train Loss: 0.269 Vali Loss: 0.990 Vali Acc: 0.661 Test Loss: 0.990 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1466903
	speed: 0.2043s/iter; left time: 6763.0930s
	iters: 200, epoch: 11 | loss: 0.0500645
	speed: 0.0678s/iter; left time: 2236.5115s
	iters: 300, epoch: 11 | loss: 0.2154794
	speed: 0.0682s/iter; left time: 2244.3823s
Epoch: 11 cost time: 23.127315044403076
Epoch: 11, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.189 Vali Acc: 0.646 Test Loss: 1.189 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.4095260
	speed: 0.2118s/iter; left time: 6935.9842s
	iters: 200, epoch: 12 | loss: 0.1220102
	speed: 0.0701s/iter; left time: 2288.3779s
	iters: 300, epoch: 12 | loss: 0.6280701
	speed: 0.0597s/iter; left time: 1941.4880s
Epoch: 12 cost time: 23.702594757080078
Epoch: 12, Steps: 369 | Train Loss: 0.206 Vali Loss: 1.262 Vali Acc: 0.645 Test Loss: 1.262 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2316923
	speed: 0.2183s/iter; left time: 7065.5000s
	iters: 200, epoch: 13 | loss: 0.2507461
	speed: 0.0602s/iter; left time: 1942.5557s
	iters: 300, epoch: 13 | loss: 0.0794731
	speed: 0.0565s/iter; left time: 1818.0547s
Epoch: 13 cost time: 22.626354932785034
Epoch: 13, Steps: 369 | Train Loss: 0.162 Vali Loss: 1.540 Vali Acc: 0.645 Test Loss: 1.540 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.5081812
	speed: 0.2129s/iter; left time: 6815.1877s
	iters: 200, epoch: 14 | loss: 0.0344512
	speed: 0.0538s/iter; left time: 1717.5882s
	iters: 300, epoch: 14 | loss: 0.3986771
	speed: 0.0602s/iter; left time: 1913.9325s
Epoch: 14 cost time: 22.485052585601807
Epoch: 14, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.547 Vali Acc: 0.642 Test Loss: 1.547 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0044879
	speed: 0.2127s/iter; left time: 6727.1955s
	iters: 200, epoch: 15 | loss: 0.0231658
	speed: 0.0501s/iter; left time: 1580.6181s
	iters: 300, epoch: 15 | loss: 0.7321212
	speed: 0.0671s/iter; left time: 2108.5160s
Epoch: 15 cost time: 22.20927929878235
Epoch: 15, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.673 Vali Acc: 0.633 Test Loss: 1.673 Test Acc: 0.633
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6898410896708286
model parameter : 186394
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5148904
	speed: 0.0798s/iter; left time: 2935.0068s
	iters: 200, epoch: 1 | loss: 0.8967260
	speed: 0.0677s/iter; left time: 2485.3823s
	iters: 300, epoch: 1 | loss: 0.9478602
	speed: 0.0670s/iter; left time: 2451.4729s
Epoch: 1 cost time: 25.441315412521362
Epoch: 1, Steps: 369 | Train Loss: 0.858 Vali Loss: 0.844 Vali Acc: 0.626 Test Loss: 0.844 Test Acc: 0.626
Validation loss decreased (inf --> -0.625985).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1205055
	speed: 0.2420s/iter; left time: 8815.8813s
	iters: 200, epoch: 2 | loss: 0.8986011
	speed: 0.0719s/iter; left time: 2613.8849s
	iters: 300, epoch: 2 | loss: 1.9596577
	speed: 0.0593s/iter; left time: 2147.6173s
Epoch: 2 cost time: 24.32350754737854
Epoch: 2, Steps: 369 | Train Loss: 0.966 Vali Loss: 1.290 Vali Acc: 0.592 Test Loss: 1.290 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9576706
	speed: 0.2346s/iter; left time: 8459.8487s
	iters: 200, epoch: 3 | loss: 0.8744707
	speed: 0.0614s/iter; left time: 2206.7502s
	iters: 300, epoch: 3 | loss: 1.2665876
	speed: 0.0711s/iter; left time: 2550.0522s
Epoch: 3 cost time: 25.587035179138184
Epoch: 3, Steps: 369 | Train Loss: 0.749 Vali Loss: 0.787 Vali Acc: 0.651 Test Loss: 0.787 Test Acc: 0.651
Validation loss decreased (-0.625985 --> -0.650957).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7937645
	speed: 0.2649s/iter; left time: 9454.3936s
	iters: 200, epoch: 4 | loss: 0.5715399
	speed: 0.0695s/iter; left time: 2475.4834s
	iters: 300, epoch: 4 | loss: 0.4952828
	speed: 0.0740s/iter; left time: 2625.8374s
Epoch: 4 cost time: 25.88647985458374
Epoch: 4, Steps: 369 | Train Loss: 0.650 Vali Loss: 0.677 Vali Acc: 0.652 Test Loss: 0.677 Test Acc: 0.652
Validation loss decreased (-0.650957 --> -0.652377).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2798905
	speed: 0.2148s/iter; left time: 7586.8438s
	iters: 200, epoch: 5 | loss: 0.5236552
	speed: 0.0691s/iter; left time: 2432.7857s
	iters: 300, epoch: 5 | loss: 0.5843421
	speed: 0.0571s/iter; left time: 2004.5627s
Epoch: 5 cost time: 23.0270893573761
Epoch: 5, Steps: 369 | Train Loss: 0.499 Vali Loss: 0.699 Vali Acc: 0.665 Test Loss: 0.699 Test Acc: 0.665
Validation loss decreased (-0.652377 --> -0.665430).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2682712
	speed: 0.2260s/iter; left time: 7900.6674s
	iters: 200, epoch: 6 | loss: 0.2441433
	speed: 0.0564s/iter; left time: 1966.1589s
	iters: 300, epoch: 6 | loss: 0.2329739
	speed: 0.0544s/iter; left time: 1891.1976s
Epoch: 6 cost time: 23.923880338668823
Epoch: 6, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.699 Vali Acc: 0.666 Test Loss: 0.699 Test Acc: 0.666
Validation loss decreased (-0.665430 --> -0.666281).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3353749
	speed: 0.2297s/iter; left time: 7945.8299s
	iters: 200, epoch: 7 | loss: 0.3137927
	speed: 0.0553s/iter; left time: 1905.8741s
	iters: 300, epoch: 7 | loss: 0.4872039
	speed: 0.0668s/iter; left time: 2297.7494s
Epoch: 7 cost time: 23.631174087524414
Epoch: 7, Steps: 369 | Train Loss: 0.396 Vali Loss: 0.683 Vali Acc: 0.667 Test Loss: 0.683 Test Acc: 0.667
Validation loss decreased (-0.666281 --> -0.666849).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2024033
	speed: 0.2245s/iter; left time: 7682.3209s
	iters: 200, epoch: 8 | loss: 0.3718809
	speed: 0.0638s/iter; left time: 2176.2327s
	iters: 300, epoch: 8 | loss: 1.1641568
	speed: 0.0595s/iter; left time: 2022.9926s
Epoch: 8 cost time: 23.278660774230957
Epoch: 8, Steps: 369 | Train Loss: 0.347 Vali Loss: 0.831 Vali Acc: 0.668 Test Loss: 0.831 Test Acc: 0.668
Validation loss decreased (-0.666849 --> -0.667983).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2975580
	speed: 0.2277s/iter; left time: 7706.8416s
	iters: 200, epoch: 9 | loss: 0.2876393
	speed: 0.0670s/iter; left time: 2262.0896s
	iters: 300, epoch: 9 | loss: 0.6902958
	speed: 0.0468s/iter; left time: 1575.4013s
Epoch: 9 cost time: 21.741552114486694
Epoch: 9, Steps: 369 | Train Loss: 0.298 Vali Loss: 0.936 Vali Acc: 0.634 Test Loss: 0.936 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0278054
	speed: 0.2042s/iter; left time: 6837.7592s
	iters: 200, epoch: 10 | loss: 0.2922552
	speed: 0.0619s/iter; left time: 2067.1890s
	iters: 300, epoch: 10 | loss: 0.1002462
	speed: 0.0516s/iter; left time: 1718.2975s
Epoch: 10 cost time: 21.9139301776886
Epoch: 10, Steps: 369 | Train Loss: 0.269 Vali Loss: 0.968 Vali Acc: 0.650 Test Loss: 0.968 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0796292
	speed: 0.2244s/iter; left time: 7428.5009s
	iters: 200, epoch: 11 | loss: 0.3413896
	speed: 0.0561s/iter; left time: 1851.2352s
	iters: 300, epoch: 11 | loss: 0.1829561
	speed: 0.0659s/iter; left time: 2167.6185s
Epoch: 11 cost time: 23.777787685394287
Epoch: 11, Steps: 369 | Train Loss: 0.233 Vali Loss: 1.204 Vali Acc: 0.648 Test Loss: 1.204 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0980105
	speed: 0.2056s/iter; left time: 6732.0571s
	iters: 200, epoch: 12 | loss: 0.2921419
	speed: 0.0650s/iter; left time: 2121.0460s
	iters: 300, epoch: 12 | loss: 0.1900013
	speed: 0.0594s/iter; left time: 1933.6415s
Epoch: 12 cost time: 23.542069911956787
Epoch: 12, Steps: 369 | Train Loss: 0.197 Vali Loss: 1.143 Vali Acc: 0.653 Test Loss: 1.143 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.4015190
	speed: 0.1940s/iter; left time: 6281.2814s
	iters: 200, epoch: 13 | loss: 0.0163530
	speed: 0.0273s/iter; left time: 882.2683s
	iters: 300, epoch: 13 | loss: 0.0562577
	speed: 0.0256s/iter; left time: 822.8060s
Epoch: 13 cost time: 10.826702356338501
Epoch: 13, Steps: 369 | Train Loss: 0.163 Vali Loss: 1.499 Vali Acc: 0.636 Test Loss: 1.499 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0359199
	speed: 0.2084s/iter; left time: 6668.4226s
	iters: 200, epoch: 14 | loss: 0.2424917
	speed: 0.0660s/iter; left time: 2104.6874s
	iters: 300, epoch: 14 | loss: 0.1907334
	speed: 0.0675s/iter; left time: 2145.4279s
Epoch: 14 cost time: 27.027270793914795
Epoch: 14, Steps: 369 | Train Loss: 0.172 Vali Loss: 1.480 Vali Acc: 0.642 Test Loss: 1.480 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0849250
	speed: 0.2573s/iter; left time: 8140.7089s
	iters: 200, epoch: 15 | loss: 0.0976551
	speed: 0.0609s/iter; left time: 1919.5156s
	iters: 300, epoch: 15 | loss: 0.0706810
	speed: 0.0454s/iter; left time: 1425.8058s
Epoch: 15 cost time: 22.34263277053833
Epoch: 15, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.574 Vali Acc: 0.650 Test Loss: 1.574 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0431920
	speed: 0.2426s/iter; left time: 7585.2053s
	iters: 200, epoch: 16 | loss: 0.0037123
	speed: 0.0507s/iter; left time: 1580.7145s
	iters: 300, epoch: 16 | loss: 0.0767343
	speed: 0.0672s/iter; left time: 2088.1854s
Epoch: 16 cost time: 22.614190101623535
Epoch: 16, Steps: 369 | Train Loss: 0.121 Vali Loss: 1.872 Vali Acc: 0.649 Test Loss: 1.872 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0640219
	speed: 0.2051s/iter; left time: 6338.0802s
	iters: 200, epoch: 17 | loss: 0.1254458
	speed: 0.0653s/iter; left time: 2010.0742s
	iters: 300, epoch: 17 | loss: 0.0186953
	speed: 0.0643s/iter; left time: 1973.7382s
Epoch: 17 cost time: 22.37082862854004
Epoch: 17, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.942 Vali Acc: 0.644 Test Loss: 1.942 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0710758
	speed: 0.2162s/iter; left time: 6600.9995s
	iters: 200, epoch: 18 | loss: 0.1193721
	speed: 0.0625s/iter; left time: 1901.9164s
	iters: 300, epoch: 18 | loss: 0.1477389
	speed: 0.0656s/iter; left time: 1989.0636s
Epoch: 18 cost time: 23.282748222351074
Epoch: 18, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.888 Vali Acc: 0.647 Test Loss: 1.888 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6679909194097616
model parameter : 186202
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6476355
	speed: 0.0823s/iter; left time: 3030.1856s
	iters: 200, epoch: 1 | loss: 0.3620955
	speed: 0.0580s/iter; left time: 2130.3588s
	iters: 300, epoch: 1 | loss: 0.5486382
	speed: 0.0566s/iter; left time: 2072.6527s
Epoch: 1 cost time: 23.21752381324768
Epoch: 1, Steps: 369 | Train Loss: 0.884 Vali Loss: 1.492 Vali Acc: 0.530 Test Loss: 1.492 Test Acc: 0.530
Validation loss decreased (inf --> -0.529781).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8043513
	speed: 0.2152s/iter; left time: 7840.1230s
	iters: 200, epoch: 2 | loss: 0.6859620
	speed: 0.0490s/iter; left time: 1781.8247s
	iters: 300, epoch: 2 | loss: 0.9226018
	speed: 0.0573s/iter; left time: 2076.6675s
Epoch: 2 cost time: 21.796449184417725
Epoch: 2, Steps: 369 | Train Loss: 0.857 Vali Loss: 1.682 Vali Acc: 0.550 Test Loss: 1.682 Test Acc: 0.550
Validation loss decreased (-0.529781 --> -0.549643).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5026057
	speed: 0.2197s/iter; left time: 7923.8135s
	iters: 200, epoch: 3 | loss: 0.4258205
	speed: 0.0554s/iter; left time: 1991.2435s
	iters: 300, epoch: 3 | loss: 0.3565760
	speed: 0.0475s/iter; left time: 1702.1036s
Epoch: 3 cost time: 20.683562517166138
Epoch: 3, Steps: 369 | Train Loss: 0.938 Vali Loss: 2.752 Vali Acc: 0.511 Test Loss: 2.752 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3386796
	speed: 0.2261s/iter; left time: 8071.7210s
	iters: 200, epoch: 4 | loss: 0.3260140
	speed: 0.0557s/iter; left time: 1981.8291s
	iters: 300, epoch: 4 | loss: 0.5528870
	speed: 0.0659s/iter; left time: 2340.1426s
Epoch: 4 cost time: 23.555280923843384
Epoch: 4, Steps: 369 | Train Loss: 0.690 Vali Loss: 0.947 Vali Acc: 0.622 Test Loss: 0.947 Test Acc: 0.622
Validation loss decreased (-0.549643 --> -0.622011).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6511953
	speed: 0.2305s/iter; left time: 8142.1936s
	iters: 200, epoch: 5 | loss: 0.4667041
	speed: 0.0676s/iter; left time: 2380.7409s
	iters: 300, epoch: 5 | loss: 0.4919538
	speed: 0.0669s/iter; left time: 2351.0049s
Epoch: 5 cost time: 24.74515175819397
Epoch: 5, Steps: 369 | Train Loss: 0.487 Vali Loss: 0.742 Vali Acc: 0.677 Test Loss: 0.742 Test Acc: 0.677
Validation loss decreased (-0.622011 --> -0.676497).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6407852
	speed: 0.2241s/iter; left time: 7833.8298s
	iters: 200, epoch: 6 | loss: 0.2975670
	speed: 0.0732s/iter; left time: 2552.0869s
	iters: 300, epoch: 6 | loss: 0.5297199
	speed: 0.0609s/iter; left time: 2117.8819s
Epoch: 6 cost time: 24.725545167922974
Epoch: 6, Steps: 369 | Train Loss: 0.446 Vali Loss: 0.731 Vali Acc: 0.669 Test Loss: 0.731 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6158494
	speed: 0.2521s/iter; left time: 8718.5296s
	iters: 200, epoch: 7 | loss: 0.4714932
	speed: 0.0629s/iter; left time: 2168.1222s
	iters: 300, epoch: 7 | loss: 0.3226155
	speed: 0.0648s/iter; left time: 2229.2821s
Epoch: 7 cost time: 26.694361448287964
Epoch: 7, Steps: 369 | Train Loss: 0.389 Vali Loss: 0.758 Vali Acc: 0.663 Test Loss: 0.758 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.5840247
	speed: 0.2705s/iter; left time: 9256.4404s
	iters: 200, epoch: 8 | loss: 0.5025910
	speed: 0.0640s/iter; left time: 2185.0514s
	iters: 300, epoch: 8 | loss: 0.6968619
	speed: 0.0814s/iter; left time: 2768.7316s
Epoch: 8 cost time: 26.65779399871826
Epoch: 8, Steps: 369 | Train Loss: 0.335 Vali Loss: 0.911 Vali Acc: 0.658 Test Loss: 0.911 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3404962
	speed: 0.2337s/iter; left time: 7911.7751s
	iters: 200, epoch: 9 | loss: 0.5408783
	speed: 0.0640s/iter; left time: 2158.8427s
	iters: 300, epoch: 9 | loss: 0.1740747
	speed: 0.0508s/iter; left time: 1710.6248s
Epoch: 9 cost time: 21.98514986038208
Epoch: 9, Steps: 369 | Train Loss: 0.302 Vali Loss: 0.994 Vali Acc: 0.665 Test Loss: 0.994 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5504282
	speed: 0.2318s/iter; left time: 7759.1175s
	iters: 200, epoch: 10 | loss: 0.4589513
	speed: 0.0624s/iter; left time: 2082.2732s
	iters: 300, epoch: 10 | loss: 0.1680291
	speed: 0.0533s/iter; left time: 1774.6476s
Epoch: 10 cost time: 24.455963373184204
Epoch: 10, Steps: 369 | Train Loss: 0.260 Vali Loss: 0.988 Vali Acc: 0.648 Test Loss: 0.988 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1693320
	speed: 0.2334s/iter; left time: 7729.0792s
	iters: 200, epoch: 11 | loss: 0.4620010
	speed: 0.0548s/iter; left time: 1808.8184s
	iters: 300, epoch: 11 | loss: 0.3112029
	speed: 0.0663s/iter; left time: 2181.7199s
Epoch: 11 cost time: 23.4712495803833
Epoch: 11, Steps: 369 | Train Loss: 0.246 Vali Loss: 0.989 Vali Acc: 0.641 Test Loss: 0.989 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1699642
	speed: 0.2155s/iter; left time: 7054.7304s
	iters: 200, epoch: 12 | loss: 0.1270577
	speed: 0.0666s/iter; left time: 2175.0581s
	iters: 300, epoch: 12 | loss: 0.2940817
	speed: 0.0641s/iter; left time: 2086.2750s
Epoch: 12 cost time: 22.91897940635681
Epoch: 12, Steps: 369 | Train Loss: 0.211 Vali Loss: 1.267 Vali Acc: 0.652 Test Loss: 1.267 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1906578
	speed: 0.2293s/iter; left time: 7422.7145s
	iters: 200, epoch: 13 | loss: 0.3731369
	speed: 0.0636s/iter; left time: 2052.9317s
	iters: 300, epoch: 13 | loss: 0.1482090
	speed: 0.0468s/iter; left time: 1506.6931s
Epoch: 13 cost time: 23.381346225738525
Epoch: 13, Steps: 369 | Train Loss: 0.172 Vali Loss: 1.396 Vali Acc: 0.650 Test Loss: 1.396 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0970302
	speed: 0.2296s/iter; left time: 7347.7918s
	iters: 200, epoch: 14 | loss: 0.0241145
	speed: 0.0498s/iter; left time: 1589.4400s
	iters: 300, epoch: 14 | loss: 0.2696465
	speed: 0.0435s/iter; left time: 1383.3429s
Epoch: 14 cost time: 20.93041753768921
Epoch: 14, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.266 Vali Acc: 0.642 Test Loss: 1.266 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.3920012
	speed: 0.2390s/iter; left time: 7559.7489s
	iters: 200, epoch: 15 | loss: 0.0116458
	speed: 0.0554s/iter; left time: 1747.4790s
	iters: 300, epoch: 15 | loss: 0.1129012
	speed: 0.0709s/iter; left time: 2227.3236s
Epoch: 15 cost time: 24.901170015335083
Epoch: 15, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.483 Vali Acc: 0.656 Test Loss: 1.483 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6765039727582293
model parameter : 161818
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7667890
	speed: 0.0807s/iter; left time: 2971.0606s
	iters: 200, epoch: 1 | loss: 0.7787687
	speed: 0.0670s/iter; left time: 2457.7091s
	iters: 300, epoch: 1 | loss: 2.1912732
	speed: 0.0645s/iter; left time: 2359.5253s
Epoch: 1 cost time: 24.890788793563843
Epoch: 1, Steps: 369 | Train Loss: 0.842 Vali Loss: 0.841 Vali Acc: 0.631 Test Loss: 0.841 Test Acc: 0.631
Validation loss decreased (inf --> -0.631093).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7487257
	speed: 0.2440s/iter; left time: 8888.9022s
	iters: 200, epoch: 2 | loss: 0.7485996
	speed: 0.0773s/iter; left time: 2807.1360s
	iters: 300, epoch: 2 | loss: 1.1166118
	speed: 0.0581s/iter; left time: 2103.3341s
Epoch: 2 cost time: 25.09810996055603
Epoch: 2, Steps: 369 | Train Loss: 0.892 Vali Loss: 1.950 Vali Acc: 0.540 Test Loss: 1.950 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3197114
	speed: 0.2346s/iter; left time: 8460.3764s
	iters: 200, epoch: 3 | loss: 0.6494331
	speed: 0.0605s/iter; left time: 2176.2348s
	iters: 300, epoch: 3 | loss: 0.7386171
	speed: 0.0655s/iter; left time: 2348.0249s
Epoch: 3 cost time: 24.485471487045288
Epoch: 3, Steps: 369 | Train Loss: 0.866 Vali Loss: 2.683 Vali Acc: 0.513 Test Loss: 2.683 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7433838
	speed: 0.2547s/iter; left time: 9092.4318s
	iters: 200, epoch: 4 | loss: 1.3235619
	speed: 0.0726s/iter; left time: 2583.4111s
	iters: 300, epoch: 4 | loss: 1.0296882
	speed: 0.0657s/iter; left time: 2331.0820s
Epoch: 4 cost time: 25.04132390022278
Epoch: 4, Steps: 369 | Train Loss: 0.800 Vali Loss: 0.840 Vali Acc: 0.644 Test Loss: 0.840 Test Acc: 0.644
Validation loss decreased (-0.631093 --> -0.643862).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3878409
	speed: 0.2143s/iter; left time: 7571.1119s
	iters: 200, epoch: 5 | loss: 0.4371509
	speed: 0.0618s/iter; left time: 2177.7429s
	iters: 300, epoch: 5 | loss: 0.2942997
	speed: 0.0543s/iter; left time: 1908.7022s
Epoch: 5 cost time: 23.391791582107544
Epoch: 5, Steps: 369 | Train Loss: 0.478 Vali Loss: 0.663 Vali Acc: 0.688 Test Loss: 0.663 Test Acc: 0.688
Validation loss decreased (-0.643862 --> -0.687848).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2845577
	speed: 0.2268s/iter; left time: 7928.7835s
	iters: 200, epoch: 6 | loss: 0.2460246
	speed: 0.0554s/iter; left time: 1932.5723s
	iters: 300, epoch: 6 | loss: 0.7321008
	speed: 0.0466s/iter; left time: 1620.5410s
Epoch: 6 cost time: 20.522170305252075
Epoch: 6, Steps: 369 | Train Loss: 0.439 Vali Loss: 0.734 Vali Acc: 0.672 Test Loss: 0.734 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4430627
	speed: 0.1381s/iter; left time: 4776.2931s
	iters: 200, epoch: 7 | loss: 0.5145364
	speed: 0.0238s/iter; left time: 820.7499s
	iters: 300, epoch: 7 | loss: 0.3503380
	speed: 0.0248s/iter; left time: 852.8217s
Epoch: 7 cost time: 9.790010929107666
Epoch: 7, Steps: 369 | Train Loss: 0.364 Vali Loss: 0.795 Vali Acc: 0.671 Test Loss: 0.795 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1740067
	speed: 0.1993s/iter; left time: 6819.5654s
	iters: 200, epoch: 8 | loss: 0.2641517
	speed: 0.0593s/iter; left time: 2024.0672s
	iters: 300, epoch: 8 | loss: 0.1378023
	speed: 0.0577s/iter; left time: 1963.1760s
Epoch: 8 cost time: 22.34119415283203
Epoch: 8, Steps: 369 | Train Loss: 0.331 Vali Loss: 0.873 Vali Acc: 0.665 Test Loss: 0.873 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2072165
	speed: 0.1999s/iter; left time: 6766.7330s
	iters: 200, epoch: 9 | loss: 0.4769183
	speed: 0.0546s/iter; left time: 1843.9214s
	iters: 300, epoch: 9 | loss: 0.4570451
	speed: 0.0544s/iter; left time: 1831.8486s
Epoch: 9 cost time: 22.448612689971924
Epoch: 9, Steps: 369 | Train Loss: 0.295 Vali Loss: 1.080 Vali Acc: 0.656 Test Loss: 1.080 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0877208
	speed: 0.2208s/iter; left time: 7390.8907s
	iters: 200, epoch: 10 | loss: 0.0698833
	speed: 0.0321s/iter; left time: 1070.0412s
	iters: 300, epoch: 10 | loss: 0.1573373
	speed: 0.0664s/iter; left time: 2210.4773s
Epoch: 10 cost time: 20.231255292892456
Epoch: 10, Steps: 369 | Train Loss: 0.265 Vali Loss: 1.156 Vali Acc: 0.653 Test Loss: 1.156 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2328804
	speed: 0.2220s/iter; left time: 7349.6601s
	iters: 200, epoch: 11 | loss: 0.4012817
	speed: 0.0698s/iter; left time: 2305.2468s
	iters: 300, epoch: 11 | loss: 0.5292481
	speed: 0.0654s/iter; left time: 2152.1146s
Epoch: 11 cost time: 24.145012140274048
Epoch: 11, Steps: 369 | Train Loss: 0.223 Vali Loss: 1.222 Vali Acc: 0.643 Test Loss: 1.222 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1678399
	speed: 0.2165s/iter; left time: 7087.3548s
	iters: 200, epoch: 12 | loss: 0.1602917
	speed: 0.0625s/iter; left time: 2039.5934s
	iters: 300, epoch: 12 | loss: 0.3277400
	speed: 0.0528s/iter; left time: 1719.3587s
Epoch: 12 cost time: 21.984845399856567
Epoch: 12, Steps: 369 | Train Loss: 0.193 Vali Loss: 1.202 Vali Acc: 0.656 Test Loss: 1.202 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0635123
	speed: 0.2405s/iter; left time: 7785.0041s
	iters: 200, epoch: 13 | loss: 0.1014548
	speed: 0.0633s/iter; left time: 2042.0489s
	iters: 300, epoch: 13 | loss: 0.0154100
	speed: 0.0602s/iter; left time: 1936.1463s
Epoch: 13 cost time: 24.17418360710144
Epoch: 13, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.639 Vali Acc: 0.654 Test Loss: 1.639 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.2279787
	speed: 0.2610s/iter; left time: 8354.2072s
	iters: 200, epoch: 14 | loss: 0.1495479
	speed: 0.0754s/iter; left time: 2404.5801s
	iters: 300, epoch: 14 | loss: 0.2692419
	speed: 0.0679s/iter; left time: 2160.6962s
Epoch: 14 cost time: 25.461230993270874
Epoch: 14, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.617 Vali Acc: 0.648 Test Loss: 1.617 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1737241
	speed: 0.2601s/iter; left time: 8228.7557s
	iters: 200, epoch: 15 | loss: 0.0387651
	speed: 0.0615s/iter; left time: 1938.5349s
	iters: 300, epoch: 15 | loss: 0.1974712
	speed: 0.0585s/iter; left time: 1837.8506s
Epoch: 15 cost time: 24.804614543914795
Epoch: 15, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.743 Vali Acc: 0.631 Test Loss: 1.743 Test Acc: 0.631
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6878547105561862
model parameter : 161626
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5616684
	speed: 0.0783s/iter; left time: 2881.1690s
	iters: 200, epoch: 1 | loss: 1.3796098
	speed: 0.0435s/iter; left time: 1594.7504s
	iters: 300, epoch: 1 | loss: 0.4540787
	speed: 0.0409s/iter; left time: 1496.9106s
Epoch: 1 cost time: 19.147640228271484
Epoch: 1, Steps: 369 | Train Loss: 0.914 Vali Loss: 1.887 Vali Acc: 0.527 Test Loss: 1.887 Test Acc: 0.527
Validation loss decreased (inf --> -0.527223).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9132352
	speed: 0.2018s/iter; left time: 7351.8116s
	iters: 200, epoch: 2 | loss: 1.5236089
	speed: 0.0557s/iter; left time: 2022.0465s
	iters: 300, epoch: 2 | loss: 1.5019600
	speed: 0.0343s/iter; left time: 1243.7770s
Epoch: 2 cost time: 18.56231427192688
Epoch: 2, Steps: 369 | Train Loss: 0.972 Vali Loss: 1.701 Vali Acc: 0.543 Test Loss: 1.701 Test Acc: 0.543
Validation loss decreased (-0.527223 --> -0.543116).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9899443
	speed: 0.2094s/iter; left time: 7550.0107s
	iters: 200, epoch: 3 | loss: 0.5876077
	speed: 0.0534s/iter; left time: 1920.4436s
	iters: 300, epoch: 3 | loss: 1.0719004
	speed: 0.0550s/iter; left time: 1973.1368s
Epoch: 3 cost time: 22.30440664291382
Epoch: 3, Steps: 369 | Train Loss: 0.823 Vali Loss: 2.046 Vali Acc: 0.509 Test Loss: 2.046 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3928718
	speed: 0.2190s/iter; left time: 7817.9177s
	iters: 200, epoch: 4 | loss: 0.6903549
	speed: 0.0577s/iter; left time: 2052.4555s
	iters: 300, epoch: 4 | loss: 0.6589363
	speed: 0.0645s/iter; left time: 2290.6265s
Epoch: 4 cost time: 22.698904752731323
Epoch: 4, Steps: 369 | Train Loss: 0.676 Vali Loss: 0.692 Vali Acc: 0.644 Test Loss: 0.692 Test Acc: 0.644
Validation loss decreased (-0.543116 --> -0.644431).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4027070
	speed: 0.2170s/iter; left time: 7667.0547s
	iters: 200, epoch: 5 | loss: 0.6298630
	speed: 0.0604s/iter; left time: 2128.6532s
	iters: 300, epoch: 5 | loss: 0.3138863
	speed: 0.0621s/iter; left time: 2181.7542s
Epoch: 5 cost time: 21.572380542755127
Epoch: 5, Steps: 369 | Train Loss: 0.482 Vali Loss: 0.637 Vali Acc: 0.669 Test Loss: 0.637 Test Acc: 0.669
Validation loss decreased (-0.644431 --> -0.669403).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4052099
	speed: 0.2046s/iter; left time: 7153.3998s
	iters: 200, epoch: 6 | loss: 0.4675036
	speed: 0.0673s/iter; left time: 2345.5370s
	iters: 300, epoch: 6 | loss: 0.2309827
	speed: 0.0549s/iter; left time: 1909.8098s
Epoch: 6 cost time: 22.61559295654297
Epoch: 6, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.743 Vali Acc: 0.672 Test Loss: 0.743 Test Acc: 0.672
Validation loss decreased (-0.669403 --> -0.671672).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4429664
	speed: 0.2077s/iter; left time: 7182.8182s
	iters: 200, epoch: 7 | loss: 0.1653679
	speed: 0.0575s/iter; left time: 1984.0781s
	iters: 300, epoch: 7 | loss: 0.6104586
	speed: 0.0416s/iter; left time: 1431.8455s
Epoch: 7 cost time: 19.93291664123535
Epoch: 7, Steps: 369 | Train Loss: 0.374 Vali Loss: 1.024 Vali Acc: 0.597 Test Loss: 1.024 Test Acc: 0.597
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2130452
	speed: 0.2006s/iter; left time: 6864.0620s
	iters: 200, epoch: 8 | loss: 0.4037840
	speed: 0.0549s/iter; left time: 1872.5087s
	iters: 300, epoch: 8 | loss: 0.3370200
	speed: 0.0701s/iter; left time: 2384.6336s
Epoch: 8 cost time: 22.279688835144043
Epoch: 8, Steps: 369 | Train Loss: 0.346 Vali Loss: 0.823 Vali Acc: 0.657 Test Loss: 0.823 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1404262
	speed: 0.2149s/iter; left time: 7273.7705s
	iters: 200, epoch: 9 | loss: 0.2147283
	speed: 0.0679s/iter; left time: 2292.6657s
	iters: 300, epoch: 9 | loss: 0.2538351
	speed: 0.0574s/iter; left time: 1931.6104s
Epoch: 9 cost time: 22.977614641189575
Epoch: 9, Steps: 369 | Train Loss: 0.293 Vali Loss: 0.945 Vali Acc: 0.665 Test Loss: 0.945 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3670397
	speed: 0.2270s/iter; left time: 7598.2924s
	iters: 200, epoch: 10 | loss: 0.3010943
	speed: 0.0555s/iter; left time: 1851.9976s
	iters: 300, epoch: 10 | loss: 0.1814558
	speed: 0.0544s/iter; left time: 1811.9893s
Epoch: 10 cost time: 23.09856605529785
Epoch: 10, Steps: 369 | Train Loss: 0.261 Vali Loss: 0.939 Vali Acc: 0.657 Test Loss: 0.939 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0748280
	speed: 0.2566s/iter; left time: 8497.4824s
	iters: 200, epoch: 11 | loss: 0.6508733
	speed: 0.0564s/iter; left time: 1862.1878s
	iters: 300, epoch: 11 | loss: 0.1244089
	speed: 0.0612s/iter; left time: 2014.4542s
Epoch: 11 cost time: 25.39496612548828
Epoch: 11, Steps: 369 | Train Loss: 0.236 Vali Loss: 1.010 Vali Acc: 0.663 Test Loss: 1.010 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0383512
	speed: 0.2438s/iter; left time: 7983.2187s
	iters: 200, epoch: 12 | loss: 0.4755488
	speed: 0.0573s/iter; left time: 1869.3325s
	iters: 300, epoch: 12 | loss: 0.2027583
	speed: 0.0723s/iter; left time: 2353.0780s
Epoch: 12 cost time: 24.03684163093567
Epoch: 12, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.443 Vali Acc: 0.641 Test Loss: 1.443 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2196649
	speed: 0.2453s/iter; left time: 7940.0545s
	iters: 200, epoch: 13 | loss: 0.0379560
	speed: 0.0652s/iter; left time: 2105.5257s
	iters: 300, epoch: 13 | loss: 0.1350652
	speed: 0.0543s/iter; left time: 1746.5052s
Epoch: 13 cost time: 22.356157302856445
Epoch: 13, Steps: 369 | Train Loss: 0.165 Vali Loss: 1.577 Vali Acc: 0.648 Test Loss: 1.577 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0299039
	speed: 0.2196s/iter; left time: 7027.7759s
	iters: 200, epoch: 14 | loss: 0.0995898
	speed: 0.0664s/iter; left time: 2117.4872s
	iters: 300, epoch: 14 | loss: 0.3551350
	speed: 0.0505s/iter; left time: 1605.9700s
Epoch: 14 cost time: 21.79071617126465
Epoch: 14, Steps: 369 | Train Loss: 0.160 Vali Loss: 1.297 Vali Acc: 0.651 Test Loss: 1.297 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1036860
	speed: 0.2040s/iter; left time: 6454.3876s
	iters: 200, epoch: 15 | loss: 0.1667849
	speed: 0.0508s/iter; left time: 1601.7004s
	iters: 300, epoch: 15 | loss: 0.1694620
	speed: 0.0308s/iter; left time: 967.4578s
Epoch: 15 cost time: 17.703179121017456
Epoch: 15, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.588 Vali Acc: 0.648 Test Loss: 1.588 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2689830
	speed: 0.1456s/iter; left time: 4551.9660s
	iters: 200, epoch: 16 | loss: 0.0554288
	speed: 0.0258s/iter; left time: 803.7110s
	iters: 300, epoch: 16 | loss: 0.0423803
	speed: 0.0285s/iter; left time: 884.6144s
Epoch: 16 cost time: 10.354783296585083
Epoch: 16, Steps: 369 | Train Loss: 0.122 Vali Loss: 1.647 Vali Acc: 0.647 Test Loss: 1.647 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6716799091940976
model parameter : 161434
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
>>>>>>>start training : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8443180
	speed: 0.0720s/iter; left time: 2649.3866s
	iters: 200, epoch: 1 | loss: 0.6202939
	speed: 0.0346s/iter; left time: 1270.3418s
	iters: 300, epoch: 1 | loss: 0.5862652
	speed: 0.0603s/iter; left time: 2208.3806s
Epoch: 1 cost time: 21.653873682022095
Epoch: 1, Steps: 369 | Train Loss: 0.815 Vali Loss: 0.889 Vali Acc: 0.617 Test Loss: 0.889 Test Acc: 0.617
Validation loss decreased (inf --> -0.616904).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2667508
	speed: 0.2017s/iter; left time: 7346.8655s
	iters: 200, epoch: 2 | loss: 1.3522127
	speed: 0.0622s/iter; left time: 2259.3639s
	iters: 300, epoch: 2 | loss: 0.7339305
	speed: 0.0706s/iter; left time: 2558.9634s
Epoch: 2 cost time: 22.046754837036133
Epoch: 2, Steps: 369 | Train Loss: 0.886 Vali Loss: 0.819 Vali Acc: 0.659 Test Loss: 0.819 Test Acc: 0.659
Validation loss decreased (-0.616904 --> -0.659470).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3146036
	speed: 0.1917s/iter; left time: 6914.7956s
	iters: 200, epoch: 3 | loss: 0.7475040
	speed: 0.0556s/iter; left time: 1998.9013s
	iters: 300, epoch: 3 | loss: 1.2538829
	speed: 0.0506s/iter; left time: 1814.8026s
Epoch: 3 cost time: 19.908925771713257
Epoch: 3, Steps: 369 | Train Loss: 0.967 Vali Loss: 0.825 Vali Acc: 0.663 Test Loss: 0.825 Test Acc: 0.663
Validation loss decreased (-0.659470 --> -0.662591).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5455338
	speed: 0.2100s/iter; left time: 7494.0755s
	iters: 200, epoch: 4 | loss: 0.2913220
	speed: 0.0539s/iter; left time: 1916.9219s
	iters: 300, epoch: 4 | loss: 0.3854723
	speed: 0.0670s/iter; left time: 2378.1182s
Epoch: 4 cost time: 23.649311304092407
Epoch: 4, Steps: 369 | Train Loss: 0.596 Vali Loss: 0.624 Vali Acc: 0.672 Test Loss: 0.624 Test Acc: 0.672
Validation loss decreased (-0.662591 --> -0.671957).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3793968
	speed: 0.2375s/iter; left time: 8390.7495s
	iters: 200, epoch: 5 | loss: 0.5302213
	speed: 0.0524s/iter; left time: 1847.1150s
	iters: 300, epoch: 5 | loss: 0.4460542
	speed: 0.0479s/iter; left time: 1681.5576s
Epoch: 5 cost time: 19.101473808288574
Epoch: 5, Steps: 369 | Train Loss: 0.489 Vali Loss: 0.659 Vali Acc: 0.676 Test Loss: 0.659 Test Acc: 0.676
Validation loss decreased (-0.671957 --> -0.675646).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3817703
	speed: 0.2172s/iter; left time: 7593.5671s
	iters: 200, epoch: 6 | loss: 1.2496810
	speed: 0.0531s/iter; left time: 1850.8045s
	iters: 300, epoch: 6 | loss: 0.5095938
	speed: 0.0628s/iter; left time: 2182.6857s
Epoch: 6 cost time: 22.634977102279663
Epoch: 6, Steps: 369 | Train Loss: 0.432 Vali Loss: 0.706 Vali Acc: 0.643 Test Loss: 0.706 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3082855
	speed: 0.2212s/iter; left time: 7649.1191s
	iters: 200, epoch: 7 | loss: 0.2526703
	speed: 0.0454s/iter; left time: 1565.7932s
	iters: 300, epoch: 7 | loss: 0.3326349
	speed: 0.0674s/iter; left time: 2317.9596s
Epoch: 7 cost time: 21.55732488632202
Epoch: 7, Steps: 369 | Train Loss: 0.396 Vali Loss: 0.746 Vali Acc: 0.661 Test Loss: 0.746 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3797986
	speed: 0.2114s/iter; left time: 7232.5359s
	iters: 200, epoch: 8 | loss: 0.2373513
	speed: 0.0667s/iter; left time: 2277.0542s
	iters: 300, epoch: 8 | loss: 0.1882830
	speed: 0.0613s/iter; left time: 2086.1064s
Epoch: 8 cost time: 21.67966651916504
Epoch: 8, Steps: 369 | Train Loss: 0.340 Vali Loss: 0.804 Vali Acc: 0.677 Test Loss: 0.804 Test Acc: 0.677
Validation loss decreased (-0.675646 --> -0.677063).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3707633
	speed: 0.2198s/iter; left time: 7440.4516s
	iters: 200, epoch: 9 | loss: 0.3312126
	speed: 0.0576s/iter; left time: 1944.9294s
	iters: 300, epoch: 9 | loss: 0.6894554
	speed: 0.0508s/iter; left time: 1709.9982s
Epoch: 9 cost time: 22.966041088104248
Epoch: 9, Steps: 369 | Train Loss: 0.292 Vali Loss: 0.942 Vali Acc: 0.658 Test Loss: 0.942 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1881251
	speed: 0.2226s/iter; left time: 7452.0226s
	iters: 200, epoch: 10 | loss: 0.3915619
	speed: 0.0583s/iter; left time: 1947.1090s
	iters: 300, epoch: 10 | loss: 0.1156290
	speed: 0.0465s/iter; left time: 1547.2295s
Epoch: 10 cost time: 20.97430729866028
Epoch: 10, Steps: 369 | Train Loss: 0.282 Vali Loss: 1.061 Vali Acc: 0.662 Test Loss: 1.061 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2561616
	speed: 0.2090s/iter; left time: 6920.6815s
	iters: 200, epoch: 11 | loss: 0.3967449
	speed: 0.0509s/iter; left time: 1680.0553s
	iters: 300, epoch: 11 | loss: 0.1793070
	speed: 0.0675s/iter; left time: 2220.3717s
Epoch: 11 cost time: 21.370970726013184
Epoch: 11, Steps: 369 | Train Loss: 0.216 Vali Loss: 1.503 Vali Acc: 0.639 Test Loss: 1.503 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0681515
	speed: 0.2098s/iter; left time: 6869.4363s
	iters: 200, epoch: 12 | loss: 0.2066920
	speed: 0.0723s/iter; left time: 2359.6101s
	iters: 300, epoch: 12 | loss: 0.2928628
	speed: 0.0658s/iter; left time: 2141.4284s
Epoch: 12 cost time: 23.814590215682983
Epoch: 12, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.204 Vali Acc: 0.645 Test Loss: 1.204 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0172946
	speed: 0.2046s/iter; left time: 6622.8747s
	iters: 200, epoch: 13 | loss: 0.1153019
	speed: 0.0615s/iter; left time: 1985.8443s
	iters: 300, epoch: 13 | loss: 0.2454076
	speed: 0.0551s/iter; left time: 1774.3072s
Epoch: 13 cost time: 22.51072907447815
Epoch: 13, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.467 Vali Acc: 0.647 Test Loss: 1.467 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0083544
	speed: 0.2149s/iter; left time: 6876.6809s
	iters: 200, epoch: 14 | loss: 0.3160517
	speed: 0.0525s/iter; left time: 1673.4858s
	iters: 300, epoch: 14 | loss: 0.2436430
	speed: 0.0502s/iter; left time: 1596.1572s
Epoch: 14 cost time: 20.66482186317444
Epoch: 14, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.556 Vali Acc: 0.645 Test Loss: 1.556 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0172764
	speed: 0.2053s/iter; left time: 6493.6835s
	iters: 200, epoch: 15 | loss: 0.5116188
	speed: 0.0659s/iter; left time: 2078.3713s
	iters: 300, epoch: 15 | loss: 0.2471530
	speed: 0.0550s/iter; left time: 1727.3997s
Epoch: 15 cost time: 22.926491022109985
Epoch: 15, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.597 Vali Acc: 0.649 Test Loss: 1.597 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0037406
	speed: 0.2339s/iter; left time: 7314.3842s
	iters: 200, epoch: 16 | loss: 0.0523954
	speed: 0.0450s/iter; left time: 1401.3851s
	iters: 300, epoch: 16 | loss: 0.0661287
	speed: 0.0640s/iter; left time: 1987.9591s
Epoch: 16 cost time: 21.49539589881897
Epoch: 16, Steps: 369 | Train Loss: 0.121 Vali Loss: 1.830 Vali Acc: 0.623 Test Loss: 1.830 Test Acc: 0.623
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0120114
	speed: 0.2420s/iter; left time: 7476.1856s
	iters: 200, epoch: 17 | loss: 0.0720570
	speed: 0.0784s/iter; left time: 2414.9469s
	iters: 300, epoch: 17 | loss: 0.0262992
	speed: 0.0721s/iter; left time: 2213.7373s
Epoch: 17 cost time: 25.81274700164795
Epoch: 17, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.409 Vali Acc: 0.651 Test Loss: 1.409 Test Acc: 0.651
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0372188
	speed: 0.2195s/iter; left time: 6700.4739s
	iters: 200, epoch: 18 | loss: 0.2675513
	speed: 0.0602s/iter; left time: 1832.6518s
	iters: 300, epoch: 18 | loss: 0.0031094
	speed: 0.0549s/iter; left time: 1663.8109s
Epoch: 18 cost time: 22.483630657196045
Epoch: 18, Steps: 369 | Train Loss: 0.076 Vali Loss: 1.882 Vali Acc: 0.654 Test Loss: 1.882 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_Crossformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6770715096481271
model parameter : 161242
model size : 1.29MB
